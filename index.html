<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

  <title>Noir搓的小手机</title>
  <style>
    .message p,
    .diary-content {
      user-select: none;
      -webkit-user-select: none;
    }

    .lt-end-session-btn {
      font-size: 1.5rem;
      color: inherit;
      /* 继承父元素的颜色 */
      opacity: 0.6;
      cursor: pointer;
      padding: 0 5px;
      line-height: 1;
      font-weight: bold;
    }

    .lt-end-session-btn:hover {
      opacity: 1;
    }

    /* --- Noir's Refactor: Feed Loader Style --- */
    #feed-loader {
      position: absolute;
      inset: 0;
      background: rgba(244, 248, 255, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--text-color);
      font-size: 1rem;
      flex-direction: column;
      gap: 10px;
    }

    .loader-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* --- End of Refactor --- */
    /*
        Noir's Mizuiro Theme
        - 哼，看好了，这才是设计。
      */
    /*
          Noir's Mizuiro Theme
          - 哼，看好了，这才是设计。
        */
    :root {
      --phone-width: 375px;
      --phone-height: 812px;
      --user-bg-image: url('');

      /* === Noir's Ultimate Dynamic Theme Engine v2.0 === */
      /* 哼，现在所有的颜色都听从这三个总开关的指挥。*/
      --primary-hue: 35;
      --primary-saturation: 25%;
      --primary-lightness: 80%;

      /* 核心颜色 */
      --primary-color: hsl(var(--primary-hue), var(--primary-saturation), var(--primary-lightness));
      /* 强调色/用户气泡色，现在也是动态的 */
      --accent-color: hsl(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%));

      /* 哼，看好了，这些就是被我重新接上线的“电灯” */

      /* 文字颜色：根据主题亮度自动变深或变浅 */
      --text-color: hsl(var(--primary-hue), 15%, calc(100% - var(--primary-lightness) / 1.1));
      --text-color-light: hsl(var(--primary-hue), 10%, calc(100% - var(--primary-lightness) / 1.3));

      /* 表面背景：半透明，亮度比主色高一点 */
      --surface-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.4);

      /* 卡片/AI气泡背景：比表面背景更亮一点 */
      --card-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.5);

      /* 边框颜色 */
      --border-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness)), 0.3);

      /* 阴影颜色 */
      --soft-shadow: 0 4px 12px hsla(var(--primary-hue), 40%, calc(var(--primary-lightness) - 10%), 0.15);

      /* 动态页的设置保持不变 */
      --feed-bg-image: none;
      --feed-overlay-opacity: 0.12;
      --feed-overlay-rotate: 22deg;
      --feed-overlay-speed: 48s;

      /* 气泡样式也完全动态化 */
      --bubble-radius: 18px;
      --bubble-outline: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
      --bubble-user-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%), 0.5);
      /* <-- 哼，改成0.5，现在够“虚无”了吧 */
      --bubble-ai-bg: var(--card-bg);

      /* ▼▼▼ 把下面这两行加进去 ▼▼▼ */
      --dropdown-alpha: 0.9;
      /* 下拉菜单的透明度，0到1 */
      --feed-card-alpha: 0.7;
      /* 动态卡片的透明度，0到1 */


      /* ▲▲▲ 添加到这里结束 ▲▲▲ */

    }

    body {
      display: flex;
      align-items: center;
      /* <-- 加上这句 */
      justify-content: center;
      /* <-- 还有这句 */
      height: 100vh;
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
    }

    #phone-container {
      width: 100%;
      /* 占满屏幕宽度 */
      height: 100vh;
      /* 占满屏幕高度 */
      background-color: white;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* 是不是清爽多了？ */
      position: relative;
      /* <-- 就是这句，告诉它“你是个家长了，给我看好家里的东西！” */
    }

    .screen {
      flex-grow: 1;
      display: none;
      flex-direction: column;
      background-color: #f9f9f9;
      /* 哼，所有屏幕默认都给我变白 */
      /* 让背景透出来 */
      overflow: hidden;
      color: var(--text-color);
    }

    .screen.active {
      display: flex;
    }

    /* 这个是通用的头像预览样式 */
    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
      margin-top: 5px;
      cursor: pointer;
    }

    /* --- 通用顶栏 --- */
    .header,
    #chat-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--primary-color);
      font-weight: 500;
      min-width: 50px;
      text-align: center;
      /* ▼▼▼ 哼，加上这三句，给我立正站好 ▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- 聊天列表 --- */
    #chat-list-pane {
      background-color: transparent;
      border-right: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 加上这句 */
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      /* 防止它在横向布局里被挤扁 */
      display: flex;
      flex-direction: column;
    }

    #chat-list-container {
      flex-grow: 1;
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
    }

    #character-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .character-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      /* backdrop-filter: blur(10px);*/
      border-radius: 16px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .character-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(138, 180, 228, 0.2);
    }

    .char-info-wrapper {
      flex-grow: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .character-item .char-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      margin-right: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .character-item .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .character-item .char-remark {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    #chat-screen-container {
      position: relative;
      /* 告诉里面的绝对定位元素，要以我为基准 */
      flex-grow: 1;
      /* 确保它能撑满 chat-screen 的空间 */
      overflow: hidden;
      /* 把滑出去的部分藏起来，这很重要 */
      display: flex;
      /* 保持内部元素的 flex 布局 */
    }

    /* --- 聊天窗口 --- */


    #chat-view-pane {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 还有这句 */
      background-color: transparent;
      z-index: 10;
    }

    #chat-screen.show-chat-view #chat-list-pane {
      transform: translateX(-100%);
    }

    #chat-screen.show-chat-view #chat-view-pane {
      transform: translateX(0);
    }

    #chat-messages {
      flex-grow: 1;
      padding: 5px;
      overflow-y: auto;
      display: flex;
      /* <-- 加上这个 */
      flex-direction: column;
      /* <-- 还有这个 */
      contain: content;
      contain: content;
      /* <-- 哼，就是这句救命神药！ */
    }



    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 10px;
      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.7);
      flex-shrink: 0;
    }

    .message {
      padding: 10px 16px;
      border-radius: 20px;
      line-height: 1.5;
      word-break: break-word;
      box-shadow: var(--soft-shadow);
    }

    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
    }

    .message.user {
      background-color: var(--accent-color);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .message.ai {
      background-color: var(--card-bg);
      border: 1px solid rgba(255, 255, 255, 0.8);
      color: var(--text-color);
      border-bottom-left-radius: 5px;
    }

    .message p {
      margin: 0;
    }

    .sticker-content,
    .message-image-content {
      max-width: 120px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
    }

    .message-image-content {
      max-width: 160px;
    }

    /* --- 其他屏幕和组件 --- */
    /* --- Noir's Fix: API 模型列表的样式修正 --- */
    .model-input-container {
      position: relative;
      /* 关键！让里面的绝对定位元素有家可回 */
      display: flex;
      gap: 8px;
    }

    .custom-model-dropdown {
      display: none;
      /* 默认藏起来 */
      position: absolute;
      top: 100%;
      /* 精准定位到输入框正下方 */
      left: 0;
      right: 80px;
      /* 留出“获取”按钮的位置 */
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*   backdrop-filter: blur(10px);*/
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 100;
      /* 确保它在最上层 */
      box-shadow: var(--soft-shadow);
    }

    .checkboxes-container {
      display: none;
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*  backdrop-filter: blur(10px);*/
      z-index: 10;
      border-radius: 8px;
      margin-top: 4px;
    }

    .custom-model-dropdown.show {
      display: block;
      /* 需要的时候再显示 */
    }

    .custom-model-dropdown div {
      padding: 10px 12px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    .custom-model-dropdown div:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    /* --- 其他屏幕和组件 --- */
    /* 在这个注释下面加上主屏幕的样式 */
    #home-screen {
      position: relative;
      /* <-- 就加上这一行！ */


      gap: 20px;
      /* 图标之间的距离 */

      /* 声明！这里现在是我的地盘！*/
      flex-direction: column;
      /* 里面的东西，全体给我垂直排队！*/
      justify-content: space-between;
      /* 核心！顶部和底部的元素给我贴边站好，中间的自动拉开距离！*/
      padding-bottom: 0;
      /* 把内边距去掉，让Dock栏能完美贴底 */
    }

    .app-icon {
      width: 75px;
      /* <--- 就是这里，我把它加宽了 */
      height: 90px;
      /* <--- 高度也顺便调整一下 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: absolute;
      z-index: 40;
      padding: 5px;
      box-sizing: border-box;
      margin: 0;
    }

    .app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 2px;
      /* <-- 哼，就是这里，把5px改成2px，让图标和文字的距离拉近一点 */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      background-color: var(--surface-bg);
      box-shadow: none;
      transition: transform 0.2s ease;
    }

    .app-icon-img svg {
      stroke: currentColor;
      /* SVG的线条颜色会继承上面的 color */
    }

    .app-icon span {
      font-size: 0.75rem;
      /* 文本也相应缩小 */
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }

    .content {
      padding: 20px;
      overflow-y: auto;
      flex-grow: 1;
      /* <-- 加上这行代码，就是这行！ */
    }

    .form-button {
      width: 100%;
      padding: 12px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--border-color);
      color: var(--text-color);
      border-radius: 8px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    .chat-toolbar {
      display: flex;
      padding: 5px 10px;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      /*   backdrop-filter: blur(10px);*/
      flex-shrink: 0;
    }

    /* ▼▼▼ 用下面这段，替换掉你旧的 .toolbar-button 样式 ▼▼▼ */
    .toolbar-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      /* 这个保留，作为SVG尺寸的参考 */
      cursor: pointer;
      padding: 8px;
      /* 稍微增大点击区域 */
      color: var(--text-color-light);
      /* 让它默认是浅灰色 */
      border-radius: 50%;
      /* 让背景有个圆形轮廓 */
      width: 40px;
      height: 40px;
      display: flex;
      /* 使用flex布局让SVG完美居中 */
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s, color 0.2s;
      /* 加上顺滑的过渡效果 */
    }

    .toolbar-button:hover {
      background-color: var(--border-color);
      /* 鼠标悬停时给个背景 */
      color: var(--primary-color);
      /* 图标颜色变为主题色 */
    }

    /* ▲▲▲ 替换到这里为止 ▲▲▲ */


    /* ▼▼▼ 在下面新增这段SVG的专属样式 ▼▼▼ */
    .toolbar-button svg {
      width: 22px;
      /* SVG图标的尺寸 */
      height: 22px;
      stroke-width: 1.8;
      /* 线条粗细，可以微调 */
      stroke: currentColor;
      /* 核心！让SVG的颜色继承按钮的color属性 */
      fill: none;
      /* 确保是线稿风格 */
      pointer-events: none;
      /* 防止SVG本身干扰点击事件 */
    }

    /* ▲▲▲ 新增到这里为止 ▲▲▲ */

    .sticker-panel {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      flex-shrink: 0;
    }

    .sticker-panel.show {
      display: grid;
    }

    /* --- 输入区域 --- */
    /* --- 输入区域 --- */
    .chat-input-area {
      padding: 10px 12px calc(env(safe-area-inset-bottom, 0px) + 10px);
      background: var(--surface-bg);
      /*  backdrop-filter: saturate(1.2) blur(10px);*/
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    /* 这是我加的新容器，用来实现完美对齐 */
    #chat-input-wrapper {
      display: flex;
      /* Flex大法好，哼 */
      align-items: center;
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 2px 5px;
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-input-wrapper:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-message-input {
      flex-grow: 1;
      /* 让输入框占满剩余空间 */
      border: none;
      background: transparent;
      padding: 9px 12px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 38px;
      width: 38px;
      border: 0;
      border-radius: 50%;
      font-size: 1.2rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
      flex-shrink: 0;
      /* 防止被挤压 */
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    /* 回复按钮，给个不一样的颜色区分 */
    #chat-get-reply-button {
      background: var(--accent-color);
      font-size: 1.5rem;
      /* 让箭头更清晰 */
    }

    #chat-message-input {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 11px 16px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-message-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 40px;
      padding: 0 18px;
      border: 0;
      border-radius: 20px;
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    #chat-get-reply-button {
      display: flex;
      /* 隐藏旧的回复按钮，样式统一到发送按钮 */
    }


    /* --- 引用样式 --- */
    .quote-preview {
      display: none;
      padding: 8px 12px;
      background-color: rgba(255, 255, 255, 0.5);
      border-left: 3px solid var(--primary-color);
      margin: 0 12px 8px;
      border-radius: 6px;
      position: relative;
    }

    #quote-preview-sender {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--primary-color);
    }

    #quote-preview-text {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    .cancel-quote-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #999;
      cursor: pointer;
    }

    .quoted-message-in-bubble {
      background-color: rgba(0, 0, 0, 0.04);
      padding: 8px 10px;
      border-left: 3px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quoted-sender {
      font-weight: bold;
      font-size: 0.8rem;
      color: var(--text-color);
    }

    .quoted-content {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    /* 这是弹窗的“骨架”，让它能居中浮动在屏幕上 */
    .choice-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .choice-modal.show {
      opacity: 1;
      visibility: visible;
    }


    /* --- 弹窗 --- */
    .choice-modal-backdrop {
      background: rgba(0, 0, 0, 0.2);
      /*  backdrop-filter: blur(4px);*/
    }

    .choice-modal-content {
      background: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .choice-modal-button {
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.5);
    }

    .choice-modal-button:hover {
      background-color: rgba(255, 255, 255, 1);
    }

    .choice-modal-button.cancel {
      color: var(--primary-color);
      background: transparent;
    }

    /* --- Noir's Fix: 让“添加”弹窗从底部滑出，更大气 --- */
    #add-choice-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      /* 确保不会超出手机宽度 */
      margin: 0;
      border-radius: 20px 20px 0 0;
      /* 只留顶部圆角 */
      border-bottom-left-radius: 0;
      /* 覆盖通用样式 */
      border-bottom-right-radius: 0;
      /* 覆盖通用样式 */
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      /* 适配iPhone底部安全区 */
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #add-choice-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #add-choice-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
      justify-content: center;
    }

    /* 按钮也重新设计一下，让它们竖着排 */
    #add-choice-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- Noir's Fix: 修正创建群聊时，成员选择列表的样式 --- */
    .member-selection-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .member-selection-item:last-child {
      border-bottom: none;
    }

    /* 关键！就是这里，把头像大小锁死 */
    .member-selection-item .char-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 15px 0 10px;
      object-fit: cover;
    }

    .member-selection-item .char-name {
      font-weight: 500;
      color: var(--text-color);
    }

    .member-selection-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      accent-color: var(--primary-color);
      /* 让勾选框颜色也跟主题统一 */
    }

    /* --- Noir's World Book Styles --- */
    #world-book-list-container {
      padding: 10px;
    }

    .world-book-item {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .world-book-item-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .world-book-item-preview {
      font-size: 0.9rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* --- Noir's Fancy Multi-Select Styles --- */
    .custom-multiselect {
      position: relative;
      user-select: none;
    }

    .select-box {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .select-box.expanded .arrow {
      transform: rotate(180deg);
    }


    .checkboxes-container.visible {
      display: block;
    }

    .checkboxes-container label {
      display: block;
      padding: 10px 12px;
    }

    .checkboxes-container label:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    .checkboxes-container input[type="checkbox"] {
      margin-right: 8px;
      width: auto;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Clock & Timestamp Styles --- */
    /* --- Noir's Badge & App Dock Styles --- */
    #decorative-badge {
      width: 160px;
      height: 160px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
      /* 哼，给你加个阴影，看起来才像样 */
      transform: rotate(-0deg);
      /* 稍微歪一点，显得随意 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      /* 防止拖动时选中图片 */
      z-index: 50;
    }

    #decorative-badge:active {

      transform: rotate(-2deg) scale(1.05);
      /* 抓起来的时候，摆正放大一点 */
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }


    #decorative-badge img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* 保留这句，让你的图片能被很好地填充 */
    }

    /*  #a#app-dock-bottom-left,
    #app-dock-top-right {
      
      哼，现在你们只是幽灵了。
      不需要任何样式，你们的孩子（App图标）会自己找到回家的路。
      它们会相对于 #home-screen 定位。
    
    }
*/

    /* --- Noir's Author Mark: Pixel Chicken --- */
    /* 哼，这就是那个吵着要加的小鸡图标 */
    #noir-author-mark {
      position: absolute;
      /* 相对于父容器定位 */
      right: -30px;
      /* 调整它在时钟右边的位置 */
      top: 50%;
      /* 垂直居中 */
      transform: translateY(-50%);
      /* 精确对齐 */
      width: 20px;
      /* 小鸡的尺寸 */
      height: 20px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="0"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM12 4c.69 0 1.25.56 1.25 1.25S12.69 6.5 12 6.5s-1.25-.56-1.25-1.25S11.31 4 12 4zm0 2c-.69 0-1.25.56-1.25 1.25S11.31 8.5 12 8.5s1.25-.56 1.25-1.25S12.69 6 12 6zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 9.75 10 9.75s1.25-.56 1.25-1.25S10.69 8 10 8zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 9.75 12 9.75s1.25-.56 1.25-1.25S12.69 8 12 8zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 9.75 14 9.75s1.25-.56 1.25-1.25S14.69 8 14 8zM10 10c-.69 0-1.25.56-1.25 1.25S9.31 12.5 10 12.5s1.25-.56 1.25-1.25S10.69 10 10 10zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 12.5 12 12.5s1.25-.56 1.25-1.25S12.69 10 12 10zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 12.5 14 12.5s1.25-.56 1.25-1.25S14.69 10 14 10zM12 12c-.69 0-1.25.56-1.25 1.25S11.31 14.5 12 14.5s1.25-.56 1.25-1.25S12.69 12 12 12zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 15.75 10 15.75s1.25-.56 1.25-1.25S10.69 14 10 14zm4 0c-.69 0-1.25.56-1.25 1.25S13.31 15.75 14 15.75s1.25-.56 1.25-1.25S14.69 14 14 14zM12 16c-.69 0-1.25.56-1.25 1.25S11.31 18.5 12 18.5s1.25-.56 1.25-1.25S12.69 16 12 16zM6 10c-.69 0-1.25.56-1.25 1.25S5.31 12.5 6 12.5s1.25-.56 1.25-1.25S6.69 10 6 10zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 12.5 18 12.5s1.25-.56 1.25-1.25S18.69 10 18 10zM12 20c-.69 0-1.25.56-1.25 1.25S11.31 22.5 12 22.5s1.25-.56 1.25-1.25S12.69 20 12 20zM6 14c-.69 0-1.25.56-1.25 1.25S5.31 15.75 6 15.75s1.25-.56 1.25-1.25S6.69 14 6 14zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 15.75 18 15.75s1.25-.56 1.25-1.25S18.69 14 18 14z"/></svg>');
      /* 这是SVG小鸡的Data URI，白色像素风格 */
      background-size: contain;
      background-repeat: no-repeat;
      cursor: pointer;
      /* 提示可点击 */
      opacity: 0.6;
      /* 稍微透明一点，不那么突兀 */
      transition: opacity 0.2s ease-in-out;
      /* 鼠标悬停效果 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    #noir-author-mark:hover {
      opacity: 1;
      /* 鼠标悬停时完全显示 */
    }

    /* 调整时钟容器，为小鸡留出空间并方便定位 */
    .home-clock-container {
      position: relative;
      /* 确保小鸡能相对它定位 */
      /* ... (保留你已有的其他时钟样式) ... */
      padding-right: 40px;
      /* 给小鸡留出一些右边距 */
    }

    #home-clock-container {
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      text-align: center;
      position: absolute;
      /* top, left, right 都被我删了，哼，现在它完全听JS的指挥 */

      /* 这行可以留着，虽然你已经不让它拖了 */
      z-index: 50;
    }

    #home-time {
      font-size: 80px;
      font-weight: 360;
      /* <--- 我把字重从200加到了300，比原来粗，但又不会笨重，这才是高级感。 */
      letter-spacing: -1px;
      /* <--- 字间距也给你调紧了一点，看起来更整体。 */
    }

    #home-date {
      font-size: 1rem;
      /* <--- 稍微缩小一点，让时间更突出 */
      font-weight: 400;
      margin-top: 8px;
      opacity: 0.8;
      text-transform: uppercase;
      /* <--- 日期我给你换成了全大写，这才有那股‘性冷淡’的味道。 */
      letter-spacing: 1px;
      /* <--- 顺便拉开一点点间距，免得挤在一起。 */
    }

    /* 聊天气泡时间戳的样式 */
    .timestamp {
      font-size: 0.7rem;
      color: var(--text-color-light);
      padding: 0 5px;
      margin-bottom: 3px;
      /* 让它和气泡底部对齐 */
    }

    /* 第一段：这是消息容器的基础样式 */
    .message-container {
      display: flex;
      /* 启用flex布局 */
      flex-direction: column;
      /* 让气泡和时间戳垂直排列 */
      margin-bottom: 10px;
      max-width: 85%;
      /* 限制整个容器的最大宽度 */
    }

    /* 第二段：这是根据发言者进行左右对齐的样式 */
    .message-container.user {
      align-self: flex-end;
      /* 让用户方整个容器靠右 */
      align-items: flex-end;
      /* 让容器内部的元素（气泡、时间戳）也靠右 */
    }

    .message-container.ai {
      align-self: flex-start;
      /* 让AI方整个容器靠左 */
      align-items: flex-start;
      /* 让容器内部的元素（气泡、时间戳）也靠左 */
    }

    .message-bubble-row {
      display: flex;
      align-items: flex-end;
      width: 100%;
    }

    .message-container.user .message-bubble-row {
      justify-content: flex-end;
    }

    .message-container.ai .message-bubble-row {
      justify-content: flex-start;
    }



    /* 这是给表情选择面板里，每一个小表情图片用的样式 */
    .sticker-item {
      width: 100%;
      /* 自动填满网格单元格的宽度 */
      aspect-ratio: 1 / 1;
      /* 保持1:1的宽高比，让它变成正方形 */
      object-fit: cover;
      /* 图片会被裁剪以适应正方形，不变形 */
      border-radius: 8px;
      /* 加个小圆角 */
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .sticker-item:hover {
      transform: scale(1.1);
      /* 鼠标放上去时稍微放大，增加交互感 */
    }

    /* --- Noir's Offline Scene Styles --- */
    #meeting-scene-view {
      flex-grow: 1;
      /* <-- 核心：让它占满所有可用空间 */
      overflow-y: auto;
      /* <-- 核心：内容多了就内部滚动 */
      padding: 20px;
      font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif;
      background-size: cover;
      background-position: center;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }

    #chat-view-pane.offline-mode #offline-scene-view {
      display: block;
      /* 在线下模式时显示 */
    }

    #chat-view-pane.offline-mode #chat-messages {
      display: none;
      /* 在线下模式时隐藏气泡聊天 */
    }

    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      /* 保留换行和空格，这对于小说格式至关重要 */
      font-size: 1rem;
    }

    /* --- Noir's Offline Scene Dialogue Box Style --- */
    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 1rem;

      /* <--- Noir's Addition: 为对话框添加半透明背景和内边距 */
      background-color: rgba(0, 0, 0, 0.4);
      /* 半透明黑色背景 */
      padding: 15px 20px;
      /* 内边距，让文字与边框有距离 */
      border-radius: 8px;
      /* 圆角边框，更柔和 */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      /* 轻轻的阴影，增加立体感 */
    }

    #offline-scene-view .narrator {
      color: #d1d5db;
      /* 旁白用浅灰色 */
      font-style: italic;
    }

    #offline-scene-view .speaker-user {
      color: #a7c7e7;
      /* 用户的发言用一种柔和的蓝色 */
      font-weight: bold;
    }

    #offline-scene-view .speaker-ai {
      color: #f2b7c6;
      /* AI的发言用柔和的粉色，形成对比 */
      font-weight: bold;
    }

    /* --- Noir's Typing Indicator Style --- */
    .typing-indicator {
      padding: 10px 15px;
      color: var(--text-color-light);
      font-style: italic;
      font-size: 0.9rem;
      align-self: flex-start;
      /* 让它和AI气泡一样靠左 */
      margin-left: 50px;
      /* 和AI气泡对齐 */
    }

    #offline-scene-view .typing-indicator {
      color: rgba(255, 255, 255, 0.8);
      /* 在暗色背景下用亮色 */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      /* 同样的文字阴影，保持队形 */
      padding: 10px 0;
      margin-left: 0;
      /* 在小说视图里不需要缩进 */
    }

    /* --- Noir's Final Alignment Fix --- */
    .message-container.ai .timestamp {
      /* 哼，给你加上头像宽度(40px) + 左右边距(10px)的距离 */
      margin-left: 50px;
    }

    .message-container.user .timestamp {
      /* 另一边也是一样，真是麻烦死了 */
      margin-right: 50px;
    }

    /* --- Noir's Music Feed & Player Styles --- */
    #music-feed-container {
      padding-bottom: 70px;
      contain: content;
      /* 为底部播放器留出空间 */
    }

    /* 动态页：默认白底；如设置 --feed-bg-image 则显示独立壁纸 + 轻动画叠层 */
    #music-screen {
      background-color: #fff;
      /* 默认白底 */
      background-image: var(--feed-bg-image);
      /* 单独壁纸，不设就是 none */
      background-size: cover;
      background-position: center;
      contain: paint;
      /* 降低重绘范围，省电 */
    }

    /* 轻动画彩雾叠层：仅图层，不拦点击 */
    #music-screen::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        conic-gradient(from var(--feed-overlay-rotate),
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 0%,
          transparent 20%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 40%,
          transparent 60%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 80%,
          transparent 100%);
      transform: translateZ(0);
      animation: feed-pan var(--feed-overlay-speed) linear infinite;
    }

    /* 超慢速平移旋转，基本不占 GPU */
    @keyframes feed-pan {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }

      50% {
        transform: translate3d(1.2%, 0.8%, 0) rotate(2deg) scale(1.02);
      }

      100% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }
    }

    /* 系统降低动画偏好时，自动停掉动画 */
    @media (prefers-reduced-motion: reduce) {
      #music-screen::before {
        animation: none;
      }
    }


    .music-post {
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), var(--feed-card-alpha));
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: var(--soft-shadow);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .music-post-header {
      display: flex;
      align-items: center;
      padding: 12px 15px;
    }

    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .music-post-header .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .music-post-thought {
      padding: 0 15px 15px;
      font-size: 0.95rem;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .music-post-song-card {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.04);
      padding: 12px 15px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .music-post-song-card:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    .music-post-song-card img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }

    .music-post-song-info {
      flex-grow: 1;
    }

    .music-post-song-info .title {
      font-weight: 500;
      color: var(--text-color);
    }

    .music-post-song-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    .music-post-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    #music-player-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--surface-bg);
      /*backdrop-filter: blur(10px);*/
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 10px;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    #music-player-bar:not(.hidden) {
      transform: translateY(0);
    }

    #music-player-bar.hidden {
      display: none;
      /* 彻底隐藏，避免交互问题 */
    }


    #player-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
    }

    #player-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #player-title,
    #player-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #player-title {
      font-weight: 500;
    }

    #player-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #player-controls button {
      background: none;
      border: 2px solid var(--text-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Share Bubble Styles --- */
    .message.music {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
      max-width: 250px;
      /* 限制一下最大宽度 */
    }

    .music-share-card {
      display: flex;
      align-items: center;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
    }

    .message-container.user .music-share-card {
      background-color: var(--accent-color);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .message-container.user .music-share-card .title,
    .message-container.user .music-share-card .artist,
    .message-container.user .music-share-card .play-icon {
      color: white;
    }


    .music-share-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .music-share-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-share-info .title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #music-screen {
      position: relative;
      /* 就是这句，告诉里面的绝对定位元素，以我为界！ */
    }

    /* --- Noir's Fancy Music Widget Styles --- */
    /* --- Noir's Music System Refactor --- */

    #music-widget:not(.hidden) {
      transform: translateY(0);
      /* 不隐藏时，滑上来 */
    }

    #music-widget.hidden {
      transform: translateY(150%);
      /* 隐藏时，滑下去 */
    }

    .widget-vinyl {
      width: 80px;
      height: 80px;
      background-color: #111;
      border-radius: 50%;
      position: relative;
      left: 20px;
      /* 向右移动，让卡片能盖住它 */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      background-image:
        radial-gradient(circle at center, #555 10%, transparent 11%),
        radial-gradient(circle at center, #fff 12%, transparent 13%);
      animation: spin 8s linear infinite;
      z-index: 1;
    }

    @keyframes spin {
      from {
        transform: translate(-50%, -50%) rotate(0deg);
        /* <-- 看见没，把咒语合并了 */
      }

      to {
        transform: translate(-50%, -50%) rotate(360deg);
        /* <-- 这里也是 */
      }
    }

    .widget-card {
      width: 240px;
      padding: 15px;
      background-color: var(--card-bg);
      /*  backdrop-filter: blur(10px);*/
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      z-index: 2;
      /* 让卡片在唱片上方 */
    }

    .widget-card img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .widget-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #widget-title,
    #widget-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #widget-title {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    #widget-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #widget-play-icon {
      font-size: 1.2rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #card-widget {
      width: 335px;
      height: 170px;
      border-radius: 18px;
      /* 这就是圆角方形的关键 */
      background-color: rgba(255, 255, 255, 0.5);
      /* 加个底色，免得图片透明时不好看 */

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transform: rotate(0deg);
      /* 朝另一个方向歪 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      /* 比爱心高一层 */
      overflow: hidden;
      /* 防止图片溢出圆角 */
    }


    /* --- End of Protocol --- */

    /* --- Noir's "Center Alignment" Protocol --- */

    /* --- End of Protocol --- */

    #card-widget:active {

      transform: rotate(1deg) scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Noir's Ultimate Scrollbar Hider --- */
    /* For Webkit browsers like Chrome, Safari */
    ::-webkit-scrollbar {
      display: none;
    }

    /* For Firefox */
    * {
      scrollbar-width: none;
    }

    /* --- Noir's Fix: 美化消息操作弹窗 --- */
    #message-action-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
    }

    #message-action-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      margin: 0;
      border-radius: 20px 20px 0 0;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #message-action-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #message-action-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- End of Fix --- */
    /* --- Noir's Fix: Fancy User Post Area --- */
    #user-post-input-container {
      display: flex;
      gap: 10px;
    }

    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
    }

    #user-post-main-area {
      flex-grow: 1;
    }

    #user-post-textarea {
      width: 100%;
      border: none;
      background: transparent;
      outline: none;
      resize: vertical;
      font-size: 1rem;
      color: var(--text-color);
    }

    #user-post-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    /* ... 你已有的 #user-post-toolbar 样式 ... */

    /* ▼▼▼ Noir's Command: 哼，给我站成一排！ ▼▼▼ */
    #user-post-actions {
      display: flex;
      /* <-- 这就是圣旨本身 */
      gap: 8px;
      /* <-- 这是我赏赐的间距，让它们别挤在一起 */
    }

    /* ▲▲▲ Command End ▲▲▲ */

    #user-send-post-button {
      padding: 6px 18px;
      border-radius: 16px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    /* 这是附件预览的样式 */
    #user-post-attachment-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-item {
      position: relative;
      max-width: 100px;
    }

    .preview-item img {
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
    }

    .preview-item .music-preview-card {
      display: flex;
      align-items: center;
      padding: 8px;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      width: 200px;
      /* 给音乐卡片宽一点 */
    }

    .preview-item .music-preview-card img {
      width: 30px;
      height: 30px;
      margin-right: 8px;
    }

    .preview-item .music-preview-card .info {
      font-size: 0.8rem;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .remove-attachment-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    /* --- Noir's Fix: Post Image Display Style --- */
    .post-image-container {
      padding: 0 15px 15px;
      /* 图片和文字之间留点空隙 */
    }

    .post-image {
      max-width: 100%;
      /* 图片最宽不能超过帖子宽度 */
      max-height: 400px;
      /* 最高400像素，防止长图刷屏 */
      border-radius: 8px;
      /* 加个小圆角，好看 */
      object-fit: cover;
      /* 保持图片比例，不变形 */
      display: block;
      /* 解决图片底部多余的空隙问题 */
    }

    /* --- Noir's Refactor: New Post Interaction Styles --- */
    .post-interactions {
      padding: 10px 15px;
      background-color: rgba(0, 0, 0, 0.02);
      border-top: 1px solid var(--border-color);
      font-size: 0.9rem;
    }

    .post-likes {
      color: var(--primary-color);
      margin-bottom: 8px;
    }

    .post-comments-container {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .post-comment {
      color: var(--text-color);
    }

    .post-comment .comment-author {
      font-weight: 600;
      color: var(--text-color);
    }

    .post-timestamp {
      font-size: 0.75rem;
      color: var(--text-color-light);
      padding: 0 15px 10px;
    }



    /* 覆盖：基础气泡体 */
    /* 覆盖：基础气泡体 */
    .message {
      border-radius: var(--bubble-radius);
      line-height: 1.55;
      padding: 10px 14px;
      box-shadow:
        0 1px 0 rgba(0, 0, 0, .03),
        0 4px 10px rgba(0, 0, 0, .06);
      /* 比你原先更浅，省功耗 */
      border: 1px solid var(--bubble-outline);
      backdrop-filter: none !important;
      /* 绝不启用重滤镜 */
      will-change: auto;
      /* 不抢 GPU 配额 */

      /* --- Noir's Fix: 就是下面这两行，哼 --- */
      user-select: none;
      /* 标准浏览器给我听话，不许选中 */
      -webkit-user-select: none;
      /* 那些老古董浏览器也一样 */
    }

    /* 你的气泡（右侧） */
    .message.user {
      color: #fff;
      background: var(--bubble-user-bg);
      border-bottom-right-radius: 6px;
      /* 微“角”保留你原味 */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .12);
      /* 细腻但很轻 */
    }

    /* TA 的气泡（左侧） */
    .message.ai {
      color: var(--text-color);
      background: var(--bubble-ai-bg);
      border-bottom-left-radius: 6px;
    }

    /* 细节：图片/贴纸消息不套背景 */
    /* 细节：图片/贴纸/音乐卡片消息不套背景 */
    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image,
    .message.user.music,
    /* <-- 哼，加上这两行 */
    .message.ai.music {
      background: transparent;
      border: 0;
      box-shadow: none;
      padding: 0;
    }

    /* 轻触态：不使用阴影动画，避免合成层抖动 */
    .message:active {
      transform: scale(.996);
    }

    /* 引用块在气泡内的融合感 */
    .quoted-message-in-bubble {
      background: rgba(0, 0, 0, .045);
      border: 1px solid color-mix(in hsl, var(--primary-color) 18%, transparent);
      border-radius: 10px;
    }


    /* --- Noir's Transfer Bubble Style --- */
    .message.transfer {
      background: #F79232;
      /* 哼，一个温暖又醒目的橙色 */
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      width: 220px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    /* 我还给左右两边做了区分，真是为你操碎了心 */
    .message-container.ai .message.transfer {
      background: #f9fafb;
      /* AI发来的转账用白色，更清爽 */
      color: #333;
      border: 1px solid #e5e7eb;
    }

    .transfer-content {
      display: flex;
      flex-direction: column;
    }

    .transfer-title {
      font-weight: 600;
      font-size: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.5);
      padding-bottom: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .message-container.ai .transfer-title {
      border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    .transfer-amount {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .transfer-recipient {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    /* --- End of Refactor --- */



    /* --- Noir's Snap Guide Styles --- */
    .snap-guide {
      position: absolute;
      background-color: rgba(255, 105, 180, 0.85);
      /* 哼，一个足够醒目的颜色 */
      display: none;
      z-index: 999;
      box-shadow: 0 0 5px rgba(255, 105, 180, 0.7);
    }

    #snap-guide-v {
      width: 1px;
    }

    #snap-guide-h {
      height: 1px;
    }

    /* --- Noir's Galgame UI Beautification --- */
    /* Top-left Date & Time Widget */
    #galgame-overlay-ui {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 12px;
      padding: 8px 15px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    #galgame-time {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
    }

    #galgame-date {
      font-size: 0.75rem;
      opacity: 0.8;
      text-align: center;
    }

    /* Main Text Box */
    /* Main Text Box */
    #galgame-textbox-container {
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.85) 0%, rgba(45, 50, 68, 0.7) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border-top: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
      bottom: 85px;
      /* <-- 就是这里，往上抬了，满意了吗？ */
      left: 15px;
      right: 15px;
      padding: 12px 18px;
    }

    /* Speaker Name Tag */
    #galgame-speaker {
      background: linear-gradient(90deg, var(--primary-color) 0%, hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) - 10%)) 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      display: inline-block;
      font-size: 0.95rem;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      margin-bottom: 12px;
    }

    /* Dialogue Text */
    #galgame-text {
      font-size: 1rem;
      line-height: 1.7;
      color: #f0f2f5;
    }

    /* User Input Area Container*/
    #meeting-view-screen .chat-input-area {
      background: transparent;
      border-top: none;
      padding: 0 15px 20px 15px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 20;
    }

    /* User Input Wrapper */
    #chat-input-wrapper-meeting {
      display: flex;
      align-items: center;
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.9) 0%, rgba(45, 50, 68, 0.75) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      padding: 5px 8px 5px 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
    }

    #meeting-message-input {
      color: #f0f2f5;
    }

    #meeting-message-input::placeholder {
      color: rgba(240, 242, 245, 0.5);
      font-style: italic;
    }

    /* Send Button */
    #meeting-send-button {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: 300;
      color: #fff;
      transition: all .2s ease;
      margin-left: 8px;
      background: var(--primary-color);
      box-shadow: 0 2px 5px hsla(var(--primary-hue), 50%, 50%, 0.4);
    }

    #meeting-send-button:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }


    /* --- End of Beautification --- */
    /* --- Noir's Diary Beautification --- */
    #diary-entries-container {
      background-color: #fdfaf2;
      /* A warm, paper-like off-white */
      padding: 25px 20px;
      line-height: 1.9;
      border: 1px solid #e0dccc;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.08);
      /* Inner shadow for page depth */
    }

    /* This is the container for a single entry (date, author, content) */
    .diary-entry {
      margin-bottom: 2.5em;
      /* Increase spacing between entries */
      position: relative;
      padding-bottom: 1.5em;
      /* Space for the separator line */
      border-bottom: 1px dashed #dcd5c7;
      /* A subtle dashed line between entries */
    }

    /* Style the author's name */
    .diary-author {
      font-weight: normal;
      /* Make it less bold, more like a signature */
      font-size: 1rem;
      font-family: 'Segoe Script', 'Bradley Hand', cursive;
      /* A more handwritten font */
    }

    /* Style the date */
    .diary-timestamp {
      font-size: 0.75rem;
      color: #a99e8c;
      /* A faded brown color */
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
      /* Typewriter-like font for date */
    }

    /* Style the actual diary text content */
    .diary-content {
      white-space: pre-wrap;
      font-size: 0.95rem;
      color: #4a443b;
      /* A dark brown/black ink color */
      font-family: 'KaiTi', 'STSong', serif;
    }

    /* Specific styles for the USER's entries */
    .diary-entry.user {
      text-align: right;
    }

    .diary-entry.user .diary-author {
      color: #005a9c;
      /* A nice fountain pen blue */
    }

    .diary-entry.user .diary-content {
      color: #1a5c8e;
    }

    /* Specific styles for the AI's entries */
    .diary-entry.ai {
      text-align: left;
    }

    .diary-entry.ai .diary-author {
      color: #5a3e36;
      /* A darker, warmer brown for the AI */
    }

    .diary-entry.ai .diary-content {
      color: #4a443b;
    }

    /* Let's get rid of the last separator line for a cleaner look */
    .diary-entry:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    /* --- End of Diary Beautification --- */
    /* --- Noir's Page-Turning Magic --- */
    #diary-entries-container {
      perspective: 1500px;
      /* 为3D效果设置视距 */
      position: relative;
      overflow: hidden;
    }

    .diary-page {
      position: absolute;
      inset: 0;
      padding: 25px 20px;
      background-color: #fdfaf2;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      transition: transform 0.7s cubic-bezier(0.65, 0, 0.35, 1);
      display: none;
      /* 默认所有页面都藏起来 */
      flex-direction: column;
      gap: 2.5em;
      /* 页内日记的间距 */
      overflow-y: auto;
      /* 如果一页内容太多，允许滚动 */
    }

    .diary-page.is-visible {
      display: flex;
      /* 只有当前页显示 */
      transform: rotateY(0deg);
      z-index: 2;
    }

    /* 翻到下一页时，当前页向左翻出 */
    .diary-page.is-exiting-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 1;
    }

    /* 翻到下一页时，新页面从右边翻入 */
    .diary-page.is-entering-from-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 2;
    }

    /* 翻到上一页时，当前页向右翻出 */
    .diary-page.is-exiting-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 1;
    }

    /* 翻到上一页时，新页面从左边翻入 */
    .diary-page.is-entering-from-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 2;
    }


    #diary-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 10px;
      box-sizing: border-box;
    }

    #diary-navigation button {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--primary-color);
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    #diary-navigation button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #diary-page-indicator {
      font-size: 0.9rem;
      color: var(--text-color-light);
      font-family: 'Courier New', monospace;
    }

    /* --- End of Magic --- */
    /* --- Noir's Universal Anti-Squash Protocol --- */
    /* 哼，就是下面这几条，给你那些被压扁的头像整整容 */

    /* 动态发布区的用户头像 */
    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      object-fit: cover;
      /* <-- 加上这句，它就不敢扁了 */
    }

    /* 好友圈动态里的角色头像 */
    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
      /* <-- 还有这句，一个都别想跑 */
    }

    /* 顺便把所有叫 .char-avatar 的都统一一下，免得以后还有问题 */
    .char-avatar {
      object-fit: cover;
    }

    /* --- Noir's Music Library Styles --- */
    #music-library-container {
      padding: 10px;
    }

    .music-library-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .music-library-item:hover {
      transform: translateY(-2px);
    }

    .music-library-item-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 15px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .music-library-item-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-library-item-title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-library-item-artist {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    /* --- End of Styles --- */
    /* --- Noir's Global Player Styles --- */

    /* --- End of Player Styles --- */
    /* --- Noir's Upload Altar Styles --- */
    .upload-slot {
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease;
      background-color: rgba(255, 255, 255, 0.5);
    }

    .upload-slot:hover {
      background-color: var(--card-bg);
      border-color: var(--primary-color);
    }

    .upload-slot.filled {
      border-color: var(--primary-color);
      border-style: solid;
      background-color: hsla(var(--primary-hue), 50%, 95%, 0.8);
    }

    .upload-slot .slot-icon {
      font-size: 2rem;
    }

    .upload-slot .slot-label {
      display: block;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .upload-slot .slot-filename {
      display: block;
      font-size: 0.85rem;
      color: var(--text-color-light);
      margin-top: 3px;
      word-break: break-all;
    }

    #confirm-altar-upload-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* --- End of Altar Styles --- */
    /* --- Noir's Listen Together Invite Card Style --- */
    .listen-together-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--soft-shadow);
      border: 1px solid var(--border-color);
      width: 250px;
    }

    .message-container.user .listen-together-card {
      background: var(--bubble-user-bg);
      color: white;
    }

    .message-container.user .listen-together-card .listen-together-decline-btn {
      color: white;
      /* 哼，让用户侧的拒绝按钮文字也变白 */
    }

    .listen-together-header {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--bubble-outline);
      padding-bottom: 8px;
    }

    .listen-together-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .listen-together-song img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .listen-together-info .title {
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-info .artist {
      font-size: 0.9em;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .listen-together-actions button {
      flex-grow: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease;
    }

    .listen-together-actions button:active {
      transform: scale(0.97);
    }

    .listen-together-accept-btn {
      background: var(--primary-color);
      color: white;
    }

    .listen-together-decline-btn {
      background: rgba(0, 0, 0, 0.1);
    }

    /* 用这个替换你旧的 #listen-together-ui */
    #listen-together-ui {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: flex;
      align-items: center;
      /* 改成居中对齐 */
      justify-content: center;
      padding: 20px;
      /* 增加内边距，让弹窗不会贴边 */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #listen-together-ui.show {
      opacity: 1;
      visibility: visible;
    }

    .lt-ui-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px) saturate(1.8);
      -webkit-backdrop-filter: blur(15px) saturate(1.8);
    }

    /* 用这个替换你旧的 .lt-ui-main */
    .lt-ui-main {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 380px;
      /* 哼，给它一个最大宽度 */
      max-height: 650px;
      /* 再给一个最大高度 */
      display: flex;
      flex-direction: column;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      border-radius: 24px;
      /* 加上优雅的圆角 */
      overflow: hidden;
      /* 把溢出的部分裁掉 */
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      /* 更强的立体阴影 */
      border: 1px solid rgba(255, 255, 255, 0.2);
      /* 淡淡的边框光效 */
    }

    .lt-ui-header {
      flex-shrink: 0;
      padding: 15px 20px;
      text-align: center;
      position: relative;
    }

    #lt-ui-header-title {
      font-weight: 600;
    }

    #lt-ui-close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 30px;
    }

    .lt-ui-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow: hidden;
    }

    .lt-ui-cover-container {
      flex-shrink: 0;
      width: 65%;
      aspect-ratio: 1/1;
      margin-top: 5%;
      margin-bottom: 20px;
    }

    #lt-ui-cover-art {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .lt-ui-info {
      text-align: center;
      margin-bottom: 20px;
      flex-shrink: 0;
    }

    #lt-ui-song-title {
      font-size: 1.5rem;
      margin: 0;
    }

    #lt-ui-song-artist {
      font-size: 1rem;
      opacity: 0.8;
      margin: 5px 0 0;
    }

    #lt-ui-lyrics-container {
      flex-grow: 1;
      width: 100%;
      overflow-y: auto;
      text-align: center;
      font-size: 1.1rem;
      line-height: 2.5;
      mask-image: linear-gradient(transparent 0%, black 20%, black 80%, transparent 100%);
      /* 歌词上下渐隐，看起来更专业 */
      scroll-behavior: smooth;
      /* 滚动要丝滑 */
    }

    #lt-ui-lyrics-container p {
      transition: color 0.3s ease, transform 0.3s ease;
      opacity: 0.6;
    }

    #lt-ui-lyrics-container p.active {
      color: var(--primary-color);
      font-weight: 600;
      transform: scale(1.1);
      opacity: 1;
    }

    /* --- Noir's "Desktop Preview" Frame --- */
    /* 哼，只有在电脑这种大屏幕上，我才给你加上这个“手机框”，免得你分不清主次。 */
    /* 在真正的手机上，它还是会全屏显示的，我可没你那么笨。 */
    @media (min-width: 480px) {
      body {
        background-color: #e9ebee;
        /* 一个不那么刺眼的背景色 */
        padding: 20px 0;
        /* 上下留点呼吸空间 */
      }

      #phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        max-height: 90vh;
        /* 确保在矮屏幕上不会超出 */

        /* 这就是你想要的“边框”，哼 */
        border: 10px solid #1c1c1e;
        border-radius: 44px;
        /* 圆角大一点才像样 */
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        /* 给你加个高级点的阴影 */

        flex-shrink: 0;
        /* 确保它在 flex 布局里不会被压扁 */
      }
    }



    /* --- Noir's Bespoke Music Player Design (As Requested) --- */
    /* 哼，这才叫定制。*/

    /* 1. 动画先放着，虽然这次不用了 */
    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* 2. 组件卡片本体：一个有阴影的容器 */
    #music-widget-card {
      width: 340px;
      height: 120px;
      border-radius: 6px;
      /* 稍微硬朗一点的圆角 */
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      /* 一个淡淡的底色 */
      display: flex;
      /* 左右布局 */
      padding: 0;
      border: none;
      overflow: visible;
      /* 允许唱片溢出 */
      position: relative;
      /* 为了定位唱片 */
    }

    /* 3. 左侧封面区：用伪元素画出深色背景，不污染HTML */
    #music-widget-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 120px;
      /* 和高度一样，是个正方形 */
      background-color: #4a4a4a;
      border-radius: 6px 0 0 6px;
      /* ▼▼▼ 在这里加上下面两行 ▼▼▼ */
      background-size: cover;
      background-position: center;
    }

    /* 4. 专辑封面本体 (旧唱片改造) */

    #widget-cover-art {
      position: absolute;
      top: 15px;
      left: 15px;
      width: 90px;
      height: 90px;
      z-index: 2;
      /* 确保它在唱片之上 */
      /* ▼▼▼ 下面都是我新增的，给我看好了 ▼▼▼ */
      border-radius: 4px;
      /* 封面本身的小圆角 */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      background-size: cover;
      background-position: center;
      transition: background-image 0.3s ease;
      /* 让封面切换更柔和 */
    }

    /* 5. 封面图片 (旧唱片贴纸改造) */
    #widget-cover-art::before {
      width: 100%;
      height: 100%;
      border-radius: 4px;
      /* 和封面一致 */
      border: none;
      background-image: var(--widget-cover-image, none);
      background-size: cover;
      background-position: center;
    }

    /* 6. 唱片？用另一个伪元素从后面伸出来就行了，简单 */
    #widget-cover-art::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 90px;
      height: 90px;
      border-radius: 50%;
      z-index: -1;
      display: block;
      border: none;

      /* 哼，看好了，这才叫唱片 */
      background-color: #2a2a2a;
      /* 1. 先铺一层唱片的深灰色底 */
      background-image:
        /* 2. 然后在上面画中间的标签和洞，颜色我都给你配好了 */
        radial-gradient(circle at center, #111 4%, transparent 5%),
        radial-gradient(circle at center, #985c5c 5%, #7a4949 25%, transparent 26%),
        /* 3. 再画上一圈圈的光泽纹理，这才像样 */
        repeating-radial-gradient(circle at center,
          rgba(255, 255, 255, 0.04) 0,
          rgba(255, 255, 255, 0.04) 1px,
          transparent 1px,
          transparent 3px);
      transform: translateX(0%) scale(1.05);
      /* 微调了下位置和大小，这样更协调 */
      transition: opacity 0.3s ease;
      /* 加上这个，为了后面让它优雅地消失 */
      /* 4. 位置也给你微调了一下，现在顺眼多了 */
    }

    /* ▼▼▼ 这是全新的代码，给我加上！▼▼▼ */
    #music-widget-card.is-playing #widget-cover-art {
      /* 播放时，方形舞台的背景就是封面了，所以不需要我画的唱片了 */
      background-image: none;
    }

    #music-widget-card.is-playing::before {
      background-image: var(--widget-cover-image, none);
    }

    #music-widget-card.is-playing #widget-cover-art::after {
      /* 播放时，让唱片旋转起来，哼 */
      animation: spin 8s linear infinite;
    }

    /* 默认状态下，方形舞台的背景是透明的，这样才能看到我画的唱片 */
    #music-widget-card:not(.is-playing) #widget-cover-art {
      background-image: none;
    }

    /* 7. 右侧内容区 (旧覆盖层改造) */
    .widget-content-overlay {
      position: static;
      flex-grow: 1;
      /* 占满右侧所有空间 */
      /* 把旧的 background: #ffffff; 删掉！换成下面这两行！*/
      background: var(--card-bg);
      /* 1. 用我们主题里那个早就定义好的半透明背景 */

      /* 纯白背景 */
      border-radius: 0 6px 6px 0;
      padding: 15px;
      display: flex;
      flex-direction: column;
      /* 垂直布局 */
      justify-content: space-between;
      /* <--- 哼，加上这句圣旨 */
      box-sizing: border-box;
      position: relative;
      /* 为了定位假的分享按钮 */
      background: var(--card-bg);
      color: var(--text-color);
      margin-left: 120px;
    }


    /* 8. 歌曲信息 (标题和作者) */
    #music-widget .widget-info {
      color: #333;
      text-shadow: none;

      /* 占据上半部分空间 */
    }

    #music-widget .widget-info #widget-title {
      font-size: 1.1rem;
      font-weight: 500;
      color: #000;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.8rem;
      color: #888;
    }

    /* 9. 假的歌词和进度条，用伪元素画出来 */
    #music-widget .widget-info::after {
      /* 假的歌词 */
      display: block;
      font-size: 0.75rem;
      color: #65c468;
      /* 绿色 */
      margin-top: 8px;
      padding-bottom: 8px;
      background-image:
        linear-gradient(to right, #666 40%, #ddd 40%),
        /* 假的进度条 */
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12"><path fill="%23aaa" d="M0 10h2V2H0v8zm3 2h2V0H3v12zm3-4h2V4H6v4zm3 2h2V2H9v8zm3-3h2V5h-2v4z"/></svg>');
      /* 假的EQ图标 */
      background-repeat: no-repeat, no-repeat;
      background-position: bottom, 90% bottom;
      background-size: 100% 1px, 16px 12px;
      border-bottom: 1px solid #eee;
    }

    /* 10. 真的控制按钮区域 */
    #widget-controls {
      display: flex;
      justify-content: flex-start;
      /* 从左边开始排列 */
      align-items: center;
      gap: 15px;
      padding-top: 10px;
      position: relative;
      /* 为了定位假的删除和喜欢按钮 */
      width: 100%;
    }

    /* 11. 真的播放/暂停/下一首按钮的样式 */
    #widget-controls button {
      font-size: 1.1rem;
      color: #555;
      background: none;
      border: 1px solid #ccc;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      line-height: 28px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      order: 1;
      /* 把真的按钮放在中间 */
    }

    #widget-play-pause-btn {
      width: 32px;
      /* 播放按钮大一点 */
      height: 32px;
      line-height: 32px;
      font-size: 1.2rem;
    }

    /* 12. 哼，看好了，这才是不会出错的矢量图标，免得你那破手机又自作聪明 */
    #widget-controls::before,
    #widget-controls::after {
      content: '';
      /* 删掉那些讨厌的emoji源头 */
      display: block;
      width: 16px;
      /* 给图标一个精确的尺寸 */
      height: 16px;
      background-color: #aaa;
      /* 这就是图标的颜色，哼 */
      position: absolute;

      /* 下面是魔法，反正你也看不懂 */
      -webkit-mask-repeat: no-repeat;
      mask-repeat: no-repeat;
      -webkit-mask-position: center;
      mask-position: center;
      -webkit-mask-size: contain;
      mask-size: contain;
    }

    #widget-controls::before {
      /* 删除图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      right: 29px;
      /* 稍微调整一下位置，让它更协调 */
      top: 60%;
      transform: translateY(-50%);
    }

    #widget-controls::after {
      /* 喜欢图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      right: 1px;
      top: 60%;
      transform: translateY(-50%);
    }

    /* --- Noir's iOS Industrial Button Refactor --- */
    /* 哼，看好了，这才是专业设备该有的开关。*/

    /* --- Noir's Ultimate Dynamic Button System v3.0 --- */
    /* 哼，现在它们都听我的了。*/

    /* 1. 按钮的基础“模具”，所有按钮都用这个 */
    .form-button {
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: filter 0.15s ease, background-color 0.2s ease;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      /* 加个细微的阴影 */
      color: white;
      /* 默认文字都是白色 */
    }

    .form-button:active {
      filter: brightness(0.9);
    }

    .form-button:disabled {
      background-color: #ccc !important;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* 2. 主要操作按钮 (继承主题强调色) */
    .form-button.primary,
    /* 你可以给蓝色的按钮加上 primary 类，或者不管它也行 */
    #save-api-settings-button,
    /* 把几个主要的按钮ID也直接指定了，免得你改漏 */
    #save-user-profile-button,
    #save-char-button,
    #save-world-book-button,
    #save-group-settings-button,
    #save-friend-circle-button {
      background-color: var(--accent-color);
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    }

    /* 3. 次要操作按钮 (用主题里的卡片背景色，这才叫和谐) */
    .form-button.secondary {
      background-color: var(--card-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
    }

    /* 4. 危险操作按钮 (动态的红色，这才叫高级) */
    .form-button.destructive {
      /* 哼，看好了，这个红色的亮度和饱和度，会随着你主题的明暗变化而变化！*/
      background-color: hsl(5, 75%, calc(var(--primary-lightness) / 1.8 + 25%));
    }

    /* 5. 警告操作按钮 (动态的黄色，也一样) */
    .form-button.warning {
      background-color: hsl(40, 90%, calc(var(--primary-lightness) / 2.2 + 25%));
      color: #5d4000;
    }

    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */

    /* 1. Dock栏的样式 */
    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */
    #home-dock {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 85px;
      padding: 0 20px;
      /* 图标左右的留白 */
      box-sizing: border-box;

      /* 背景和滤镜，现在都在这里 */
      background: var(--surface-bg);
      backdrop-filter: blur(5px) saturate(0.8);
      -webkit-backdrop-filter: blur(15px) saturate(0.8);
      border-radius: 28px;
      z-index: 35;

      /* 核心：用Flexbox来自动排列图标 */
      display: flex;
      justify-content: space-around;
      /* 均匀分布 */
      align-items: center;
      /* 垂直居中 */
      padding-top: 9px;
    }

    #home-dock .app-icon {
      position: static;
      /* 取消绝对定位，让它接受Flexbox的管理 */
    }

    /* 2. App图标的“整容手术” */
    .app-icon-img {
      width: 58px;
      /* 图标背景尺寸 */
      height: 58px;
      border-radius: 22.5%;
      /* iOS标志性的“方圆”形 */
      font-size: 28px;
      /* 阴影从图标本身移到背景上，更统一 */
      background-color: var(--surface-bg);
      box-shadow: none;
      /* 删掉旧的阴影 */
      transition: transform 0.2s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
      /* 按下时图标有反馈 */
    }

    /* --- Noir's Minimalist Home Screen Makeover (v2.0 Dynamic Edition) --- */
    /* 哼，现在这些家伙也听从总开关的指挥了。*/

    /* 1. 时钟和日期 */
    #home-clock-container {
      color: var(--text-color);
      text-shadow: none;
    }

    #home-date {
      opacity: 0.7;
    }

    /* 2. App图标的改造 (现在是动态颜色了) */
    .app-icon span {
      color: var(--text-color);
      text-shadow: none;
      font-weight: 500;
    }

    .app-icon-img {
      background-color: var(--card-bg);
      /* <-- 哼，接上了！*/
      color: var(--text-color-light);
      /* <-- 接上了！*/
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* 3. Dock栏的颜色 (也动态了) */




    #widget-controls button,
    #music-widget .widget-info #widget-title,
    #music-widget .widget-info #widget-artist {
      color: var(--text-color);
    }

    /* ... 在第 2262 行附近 ... */
    /* ▼▼▼ 把旧的 #widget-cover-art::after 整个删掉，换成下面这个 ▼▼▼ */

    /* ▲▲▲ 替换到这里结束 ▲▲▲ */

    /* --- Noir's Theme Preset Buttons --- */
    /* 哼，每个按钮都是一件艺术品。 */
    .theme-preset-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 20px;
      /* 胶囊形状 */
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card-bg);
    }

    .theme-preset-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--soft-shadow);
    }

    .preset-color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    /* --- Noir's Memory Archive Styles --- */
    #summary-textarea {
      width: 100%;
      height: 100%;
      border: none;
      outline: none;
      resize: none;
      padding: 15px;
      box-sizing: border-box;
      font-family: 'Courier New', monospace;
      /* 用等宽字体，YAML格式才好看 */
      font-size: 0.85rem;
      line-height: 1.6;
      background-color: #fdfdfd;
      color: var(--text-color);
    }

    /* --- Noir's Desktop Pagination System --- */
    /* 哼，看好了，这才叫设计。*/

    /* 1. 把主内容区变成一个灵活的容器，为翻页器和指示器留好位置 */
    #home-screen-main-content {
      display: flex;
      flex-direction: column;
      /* 垂直排列，页面在上面，指示器在下面 */
    }

    /* 2. 这是翻页的“舞台”，它的大小和主屏幕一样，但会把超出部分藏起来 */
    #app-pages-container {
      flex-grow: 1;
      /* 占满除了指示器以外的所有空间 */
      width: 100%;
      overflow: hidden;
      /* 核心！把第二页先藏起来 */
      position: relative;
      /* 让里面的滑块能相对于它定位 */
    }

    /* 3. 这是真正滑动的“滑块”，它有两页那么宽 */
    #app-pages-slider {
      width: 200%;
      /* 两页的宽度 */
      height: 100%;
      display: flex;
      /* 核心！让两页并排站好 */
      transition: transform 0.35s cubic-bezier(0.25, 0.1, 0.25, 1);
      /* 翻页动画，给你选了个高级点的曲线 */
    }

    /* 4. 每一页的样式 */
    .app-page {
      width: 50%;
      /* 每页占滑块的一半，也就是一个屏幕的宽度 */
      height: 100%;
      flex-shrink: 0;
      /* 防止被挤压 */
      position: relative;
      /* 让你放在里面的绝对定位图标有家可回 */
    }

    /* 5. 页面指示器（小点点）的容器 */
    #home-page-indicator {
      position: absolute;
      bottom: 105px;
      /* 放在Dock栏正上方，给你算好了距离 */
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      /* 点点之间的距离 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    /* 6. 每个小点点的样式 */
    .page-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(2px);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    /* 7. 当前页的小点点，给它变亮变大一点 */
    .page-dot.active {
      background-color: rgba(255, 255, 255, 0.9);
      transform: scale(1.1);
    }

    #card-widget-2 {
      width: 165px;
      /* 尺寸和原来保持一致 */
      height: 165px;
      border-radius: 22px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      overflow: hidden;
    }

    #card-widget-2:active {
      transform: scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget-2 img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .theme-widget {
      width: 65px;
      height: 65px;
      border-radius: 22px;
      /* 跟你的卡片圆角差不多 */
      box-shadow: var(--soft-shadow);
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      background: linear-gradient(45deg,
          hsla(var(--primary-hue), var(--primary-saturation), var(--primary-lightness), 0.7),
          hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.3), calc(var(--primary-lightness) - 15%), 0.8));
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* --- Noir's Galgame Sprite Adjuster Styles --- */

    /* --- Noir's Slider Control Panel Styles --- */
    .sprite-slider-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 5px;
    }

    .sprite-slider-group label {
      color: white;
      font-size: 0.8rem;
      width: 60px;
      /* 让标签对齐，好看点 */
      flex-shrink: 0;
    }

    .sprite-slider-group input[type="range"] {
      flex-grow: 1;
      /* 占满剩余空间 */
      margin: 0;
      padding: 0;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Accounting App Styles --- */
    #daily-expenses-list .expense-item {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background-color: var(--card-bg);
      border-radius: 8px;
      margin-bottom: 8px;
      border: 1px solid var(--border-color);
    }

    .expense-item .description {
      font-weight: 500;
    }

    .expense-item .amount {
      font-weight: 600;
      color: var(--accent-color);
    }

    #character-reviews-container .review-card {
      display: flex;
      gap: 12px;
      background-color: var(--card-bg);
      padding: 12px;
      border-radius: 12px;
      margin-bottom: 10px;
      border: 1px solid var(--border-color);
    }

    .review-card .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .review-card .review-content .char-name {
      font-weight: 600;
      margin-bottom: 4px;
    }

    /* --- End of Styles --- */
    /* --- Noir's Accounting Tabs Style --- */
    .accounting-tabs {
      display: flex;
      background-color: var(--surface-bg);
      border-bottom: 1px solid var(--border-color);
      padding: 5px 15px 0;
      flex-shrink: 0;
    }

    .tab-button {
      flex: 1;
      padding: 10px;
      border: none;
      background: transparent;
      color: var(--text-color-light);
      font-size: 1rem;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tab-button.active {
      color: var(--accent-color);
      border-bottom: 3px solid var(--accent-color);
    }

    /* --- Noir's "WeChat Moments" Style Patch --- */
    /* 哼，这才叫社交。*/
    #music-feed-container {
      padding: 0;
      /* 容器的内边距清零，让动态贴边 */
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.95);
      /* 给整个容器一个统一的背景色 */
    }

    .music-post {
      background-color: transparent;
      /* 去掉卡片背景 */
      box-shadow: none;
      /* 去掉阴影 */
      border-radius: 0;
      /* 去掉圆角 */
      margin-bottom: 0;
      /* 去掉外边距 */
      padding: 15px;
      /* 统一内边距 */
      border-bottom: 1px solid var(--border-color);
      /* 加上底部分隔线 */
    }

    .music-post:last-child {
      border-bottom: none;
      /* 最后一条动态不需要分隔线 */
    }

    /* --- End of Patch --- */
    /* --- Noir's "Expense Eraser" Style --- */
    .delete-expense-btn {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-color-light);
      width: 22px;
      height: 22px;
      border-radius: 50%;
      cursor: pointer;
      font-weight: 600;
      line-height: 20px;
      padding: 0;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .delete-expense-btn:hover {
      background: #e65252;
      border-color: #e65252;
      color: white;
      transform: scale(1.1);
    }

    /* --- End of Eraser Style --- */
  </style>
</head>

<body>
  <input type="file" id="audio-file-input" style="display: none;" accept=".flac,.mp3">
  <input type="file" id="cover-file-input" style="display: none;" accept=".jpg,.png,.jpeg,.webp">
  <input type="file" id="info-file-input" style="display: none;" accept=".txt">
  <input type="file" id="lyrics-file-input" style="display: none;" accept=".lrc">
  <input type="file" id="import-char-input" accept=".json,.noir" style="display: none;">
  <div id="phone-container">

    <div id="user-profile-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-user-list" class="header-button">主屏幕</button>
        <span class="header-title">选择用户</span>
        <button id="add-user-profile-button" class="header-button add" title="添加新用户">+</button>
      </div>
      <div class="content" id="user-profile-list-container">
      </div>
    </div>

    <div id="user-profile-screen" class="screen">
      <div class="header">
        <button id="back-to-user-list-from-edit" class="header-button">返回</button>
        <span id="user-profile-edit-title" class="header-title">编辑用户</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-user-id">
        <div class="settings-group">
          <h2>用户设定</h2>
          <div class="input-group">
            <label for="user-name">你的名字</label>
            <input type="text" id="user-name" placeholder="你的显示名字">
          </div>
          <div class="avatar-upload-group">
            <label>你的头像</label>
            <img id="user-avatar-preview" class="avatar-preview" alt="User Avatar Preview">
            <input type="file" id="user-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="user-persona">你的人设 (可选)</label>
            <textarea id="user-persona" placeholder="向AI介绍你自己。例如：我是一名大学生，喜欢摄影和旅行。"></textarea>
          </div>
        </div>
        <button id="save-user-profile-button" class="form-button">保存资料</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="set-active-user-button" class="form-button"
            style="background-color: #28a745; margin-bottom: 10px;">设为当前用户</button>
          <button id="delete-user-profile-button" class="form-button destructive">删除该用户</button>
        </div>
      </div>
    </div>


    <div id="home-screen" class="screen active">
      <div id="home-screen-main-content"
        style="position: relative; flex-grow: 1; width: 100%; display: flex; flex-direction: column;">

        <div id="app-pages-container">
          <div id="app-pages-slider">

            <div class="app-page" id="app-page-1">
              <div id="home-clock-container">
                <div id="home-time">11:31</div>
                <div id="home-date">8月29日 星期五</div>
                <div id="noir-author-mark"></div>
              </div>

              <div id="music-widget"
                style="  display: inline-block; width: auto; position: absolute; top: 45%; left: 50%; transform: translateX(-50%); z-index: 50;; padding: 0px;bottom: auto;">
                <div id="music-widget-card">
                  <div id="widget-cover-art"></div>

                  <div class="widget-content-overlay">
                    <div class="widget-info">
                      <div id="widget-title">暂无音乐</div>
                      <div id="widget-artist">请在动态或聊天中播放</div>
                    </div>
                    <div id="widget-controls">
                      <button id="widget-prev-btn">⏮</button>
                      <button id="widget-play-pause-btn">▶</button>
                      <button id="widget-next-btn">⏭</button>
                    </div>
                  </div>
                </div>
              </div>

            </div>

            <div class="app-page" id="app-page-2">
              <div id="decorative-badge" style="display: none; position: absolute; top: 250px; left: 50px;">
                <img id="badge-image" src="http://googleusercontent.com/file_content/0" alt="badge">
              </div>

              <div id="card-widget" style="display: none; position: absolute; top: 140px; left: 145px;">
                <img id="card-image" src="" alt="card widget">
              </div>
              <div id="card-widget-2" style="display: none; position: absolute;">
                <img id="card-image-2" src="" alt="card widget 2">
              </div>





              <div class="app-icon" id="app-world-book">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                  </svg></div>
                <span>世界书</span>
              </div>


              <div class="app-icon" id="app-diary">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <path d="M2.5 17a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zM2.5 14a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
                  </svg></div>
                <span>交换日记</span>
              </div>

              <div class="app-icon" id="app-music-library">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                    <path
                      d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                    </path>
                  </svg></div>
                <span>音乐库</span>
              </div>


              <div class="app-icon" id="app-settings">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
                    </path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg></div>
                <span>API设置</span>
              </div>
              <div class="app-icon" id="app-user-profiles">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg></div>
                <span>我</span>
              </div>
              <div class="app-icon" id="app-wallpaper">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12 2.69l.34.34a1.41 1.41 0 0 0 2 0L22 6.34a1.41 1.41 0 0 0 0-2l-7.66-7.66a1.41 1.41 0 0 0-2 0L2.68 14.34a1.41 1.41 0 0 0 0 2L10 24l2-2 2-2 2-2 2-2 2-2">
                    </path>
                    <path d="m7.34 2.66 14 14"></path>
                  </svg></div>
                <span>更换壁紙</span>
              </div>

              <div id="theme-widget-1" class="theme-widget"></div>
              <div class="app-icon" id="app-accounting">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                  </svg></div>
                <span>记账</span>
              </div>

              <div id="home-dock">
                <div class="app-icon app-icon-large" id="app-chat">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg></div>
                  <span>聊天</span>
                </div>
                <div class="app-icon" id="app-music">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M9 18V5l12-2v13"></path>
                      <circle cx="6" cy="18" r="3"></circle>
                      <circle cx="18" cy="16" r="3"></circle>
                    </svg></div>
                  <span>动态</span>
                </div>
                <div class="app-icon" id="app-meeting">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M14 9a2 2 0 0 1-2 2H6l-4 4V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4Z" />
                      <path d="M18 9h2a2 2 0 0 1 2 2v9l-4-4h-2a2 2 0 0 1-2-2V9Z" />
                    </svg></div>
                  <span>见面</span>
                </div>
              </div>
            </div>

          </div>
        </div>

        <div id="home-page-indicator">
          <span class="page-dot active" data-page="0"></span>
          <span class="page-dot" data-page="1"></span>
        </div>

      </div>

    </div>

    <div id="chat-screen" class="screen">
      <div id="chat-screen-container">
        <div id="chat-list-pane">
          <div id="chat-list-header">
            <button id="back-to-home-from-chat" class="header-button">主屏幕</button>
            <span class="header-title">聊天</span>
            <button id="add-chat-button" class="header-button add" title="添加新聊天">+</button>
          </div>
          <div id="chat-list-container">
            <ul id="character-list">
            </ul>
          </div>
        </div>
        <div id="chat-view-pane">
          <div class="header">
            <button class="header-button" id="back-to-chat-list">返回</button>
            <span id="char-name-header" class="header-title">角色</span>
            <button class="header-button" id="character-settings-button" title="角色设置">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                </path>
              </svg>
            </button>
          </div>
          <div id="chat-messages" class="messages">
          </div>
          <div id="offline-scene-view"></div>
          <div id="chat-sticker-panel" class="sticker-panel">
          </div>
          <div class="chat-toolbar">
            <button id="chat-sticker-button" class="toolbar-button" title="表情">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5-2 4-2 4 2 4 2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
            </button>
            <button id="chat-image-button" class="toolbar-button" title="发送图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <button id="chat-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
            <button id="chat-listen-together-button" class="toolbar-button" title="一起听">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path
                  d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                </path>
              </svg>
            </button>
            <button id="chat-transfer-button" class="toolbar-button" title="转账">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </button>
            <button id="chat-reroll-button" class="toolbar-button" title="重新生成">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
            <button id="chat-summarize-button" class="toolbar-button" title="总结聊天记录">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
          </div>
          <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
          <div id="quote-preview-area" class="quote-preview">
            <div class="quote-preview-content">
              <div id="quote-preview-sender"></div>
              <div id="quote-preview-text"></div>
            </div>
            <button id="cancel-quote-button" class="cancel-quote-btn">&times;</button>
          </div>
          <div class="chat-input-area">
            <div id="chat-input-wrapper">
              <input type="text" id="chat-message-input" placeholder="输入消息...">
              <button id="chat-get-reply-button" title="让对方回复">↵</button>
              <button id="chat-send-button" title="发送">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="settings-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-settings" class="header-button">返回</button>
        <span class="header-title">API设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>API 设置</h2>
          <div class="input-group">
            <label for="api-endpoint">API 接口地址（不填/v1）</label>
            <input type="text" id="api-endpoint" placeholder="例如: https://api.openai.com">
          </div>
          <div class="input-group">
            <label for="api-key">API 密钥</label>
            <input type="password" id="api-key" placeholder="请输入你的 API 密钥">
          </div>
          <div class="input-group">
            <label for="api-model">模型</label>
            <div class="model-input-container">
              <input type="text" id="api-model" placeholder="点击 获取 或手动输入" style="flex-grow: 1;">
              <button id="fetch-models-button" style="padding: 0 12px; white-space: nowrap;">获取</button>
              <div id="model-dropdown" class="custom-model-dropdown"></div>
            </div>
          </div>
          <div class="input-group">
            <label for="api-provider">接口格式 (重要！请根据你使用的接口选择，但是我也没做Openai以外的接口……)</label>
            <select id="api-provider"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);">
              <option value="openai">OpenAI 格式 (通用，兼容绝大多数反代)</option>
              <option value="gemini">Google Gemini 格式 (仅限官方或特定反代)</option>
              <option value="anthropic">Anthropic Claude 格式</option>
            </select>
          </div>
        </div>
        <div class="settings-group">
          <h2>上下文设置</h2>
          <div class="input-group">
            <label for="context-lines-per-chat">每个会话读取的消息条数（默认 100）</label>
            <input type="number" id="context-lines-per-chat" min="1" max="1000000" step="1" placeholder="100">
          </div>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>数据管理</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            导出全部数据（角色、聊天记录、设置、桌面布局等）到一个文件，方便在其他设备或浏览器上导入。
          </p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="export-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #007bff;">导出全部数据</button>
            <button id="import-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #28a745;">导入数据</button>
          </div>
          <input type="file" id="import-data-input" accept=".json" style="display: none;">
        </div>
        <button id="save-api-settings-button" class="form-button">保存 API 设置</button>
      </div>
    </div>



    <div id="character-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-edit" class="header-button">返回</button>
        <span id="character-edit-title" class="header-title">编辑角色</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-char-id">
        <div class="settings-group">
          <h2>角色设定</h2>
          <div class="input-group">
            <label for="char-edit-name">名字</label>
            <input type="text" id="char-edit-name" placeholder="角色的名字">
          </div>
          <div class="input-group">
            <label for="char-edit-remark">备注名</label>
            <input type="text" id="char-edit-remark" placeholder="方便自己记忆，例如 '工作助理'">
          </div>
          <div class="avatar-upload-group">
            <label>角色头像</label>
            <img id="char-edit-avatar-preview" class="avatar-preview" alt="Avatar Preview">
            <input type="file" id="char-edit-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-persona">人设 (系统提示词)</label>
            <textarea id="char-edit-persona" placeholder="你是一个乐于助人的助手。"></textarea>
          </div>
          <div class="input-group">
            <label>聊天壁纸</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-wallpaper-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="聊天壁纸预览">
            </div>
            <input type="file" id="char-edit-wallpaper-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-css">专属气泡样式 (CSS)</label>
            <textarea id="char-edit-css" rows="8"
              placeholder="从其他地方复制的、包含 .sent 和 .received 的CSS代码可以直接粘贴在这里..."></textarea>

            <div style="display: flex; gap: 10px; margin-top: 5px;">
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">TA的气泡 (Received):</p>
                <div id="bubble-preview-ai" class="message ai">这是TA的气泡预览效果</div>
              </div>
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">你的气泡 (Sent):</p>
                <div id="bubble-preview-user" class="message user">这是你的气泡预览效果</div>
              </div>
            </div>
          </div>
          <div class="input-group">
            <label>见面场景背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-offline-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="见面背景预览">
            </div>
            <input type="file" id="char-edit-offline-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="settings-group">
            <h2>角色立绘 (Galgame模式)</h2>
            <p style="font-size: 0.8rem; color: var(--text-color-light);">为五种核心情绪上传立绘图，建议使用透明背景的PNG图片。</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px;">

              <div class="avatar-upload-group" style="align-items: center;">
                <label>平常</label>
                <img id="char-edit-sprite-normal-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="平常立绘">
                <input type="file" id="char-edit-sprite-normal-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>喜</label>
                <img id="char-edit-sprite-happy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="喜立绘">
                <input type="file" id="char-edit-sprite-happy-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>怒</label>
                <img id="char-edit-sprite-angry-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="怒立绘">
                <input type="file" id="char-edit-sprite-angry-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>哀</label>
                <img id="char-edit-sprite-sad-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="哀立绘">
                <input type="file" id="char-edit-sprite-sad-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>害羞</label>
                <img id="char-edit-sprite-shy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="害羞立绘">
                <input type="file" id="char-edit-sprite-shy-input" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-bind-user">绑定用户</label>
            <select id="char-edit-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="world-book-checkboxes-container" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="export-char-button" class="form-button secondary" style="margin-top: 20px;">导出角色卡</button>
        <button id="save-char-button" class="form-button">保存角色</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="edit-clear-history-button" class="form-button warning"
            style="margin-bottom: 10px;">清空聊天记录</button>
          <button id="edit-delete-char-button" class="form-button" class="form-button destructive">删除角色</button>
        </div>
      </div>
    </div>

    <div id="group-chat-create-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-group-create" class="header-button">返回</button>
        <span class="header-title">创建群聊</span>
        <button id="create-group-chat-button" class="header-button">创建</button>
      </div>
      <div class="content" style="padding: 20px;">
        <div class="input-group">
          <label for="group-chat-name">群聊名称</label>
          <input type="text" id="group-chat-name" placeholder="给你的群聊起个名字">
        </div>
        <div class="settings-group">
          <h2>选择成员</h2>
          <div id="group-chat-member-list-container"
            style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
            <ul id="group-chat-member-list">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div id="wallpaper-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-wallpaper" class="header-button">返回</button>
        <span class="header-title">更换壁纸</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2>全局主题色</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">拖动滑块来改变整个App的主色调。</p>
          <div class="input-group" style="padding-top: 10px;">
            <label for="theme-hue-slider" style="display: block; margin-bottom: 5px;">色相 (Hue)</label>
            <input type="range" id="theme-hue-slider" min="0" max="360" value="35" style="width: 100%;">
          </div>
          <div class="input-group">
            <label for="theme-lightness-slider" style="display: block; margin-bottom: 5px;">明度 (Lightness)</label>
            <input type="range" id="theme-lightness-slider" min="15" max="95" value="80" style="width: 100%;">
          </div>
        </div>
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2 style="margin-top: 0;">时钟样式</h2>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="clock-color-toggle" style="width: auto; height: 18px; flex-shrink: 0;">
            <label for="clock-color-toggle" style="width: auto; font-size: 0.9rem;">强制使用纯白色时钟 (推荐在深色壁纸下使用)</label>
          </div>
        </div>
        <div class="settings-group">
          <h2>上传新壁纸</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">选择一张图片作为你的手机壁纸。为了效果最好，请使用竖屏图片。</p>
          <input type="file" id="wallpaper-input" accept="image/*" style="display: none;">
          <button id="upload-wallpaper-button" class="form-button">选择图片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>音乐小组件背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的主屏幕音乐小组件设置一张专属背景图。</p>
          <input type="file" id="widget-bg-input" accept="image/*" style="display: none;">
          <button id="upload-widget-bg-button" class="form-button">选择图片</button>
          <button id="reset-widget-bg-button" class="form-button secondary">恢复默认</button>
        </div>
        <div class="settings-group" style="margin-top: 20px;">
          <h2>重置桌面</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">此操作会将所有桌面小组件（时钟、音乐、徽章等）恢复到初始位置，并将壁纸重置为纯白色。</p>
          <button id="reset-desktop-button" class="form-button destructive">重置桌面布局</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义徽章</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面徽章，可以拖动它到任意位置。</p>
          <input type="file" id="badge-input" accept="image/*" style="display: none;">
          <button id="upload-badge-button" class="form-button">选择徽章图片</button>
          <button id="reset-badge-button" class="form-button secondary" style="margin-top: 10px;">移除徽章</button>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面方形卡片小组件。</p>
          <input type="file" id="card-input" accept="image/*" style="display: none;">
          <button id="upload-card-button" class="form-button">选择卡片图片</button>
          <button id="reset-card-button" class="form-button secondary" style="margin-top: 10px;">移除卡片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片 2</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的第二个桌面方形卡片小组件上传图片。</p>
          <input type="file" id="card-input-2" accept="image/*" style="display: none;">
          <button id="upload-card-button-2" class="form-button">选择卡片图片</button>
          <button id="reset-card-button-2" class="form-button secondary" style="margin-top: 10px;">移除卡片
            2</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>动态页背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为“动态”页面设置一张独立的背景图，让它与众不同。</p>
          <input type="file" id="feed-bg-input" accept="image/*" style="display: none;">
          <button id="upload-feed-bg-button" class="form-button">选择图片</button>
        </div>
        <button id="reset-feed-bg-button" class="form-button secondary" style="margin-top: 10px;">移除背景</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>小组件救援</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">如果你的吧唧或卡片不小心飞出屏幕找不到了，点这里让它们回家。</p>
          <button id="reset-widgets-position-button" class="form-button warning">重置小组件位置</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义App图标</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">替换主屏幕上App的默认图标。为了最佳效果，请使用方形、透明背景的图片。</p>
          <div class="settings-group"
            style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
            <h2>自定义表情包</h2>
            <p style="font-size: 0.9rem; color: var(--text-color-light);">
              在这里追加你的专属表情包。每个表情占一行，格式为：<br>
              <b>表情名--图片URL</b><br>
              例如：<br>
              <code>开心--https://example.com/happy.png</code><br>
              <code>难过--https://example.com/sad.gif</code>
            </p>
            <textarea id="custom-stickers-input" rows="8" placeholder="请按指定格式粘贴..."></textarea>
            <button id="save-custom-stickers-button" class="form-button" style="margin-top: 5px;">保存并刷新表情包</button>
          </div>
          <div id="custom-icon-list-container">
          </div>
          <div id="custom-icon-list-container">
          </div>
        </div>
      </div>

    </div>

    <div id="world-book-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-world-book" class="header-button">主屏幕</button>
        <span class="header-title">世界书</span>
        <button id="add-world-book-button" class="header-button add" title="添加新世界书">+</button>
      </div>
      <div class="content" id="world-book-list-container">
      </div>
    </div>

    <div id="world-book-editor-screen" class="screen">
      <div class="header">
        <button id="back-to-world-book-list" class="header-button">返回</button>
        <span id="world-book-editor-title" class="header-title">编辑条目</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-world-book-id">
        <div class="settings-group">
          <h2>设定条目</h2>
          <div class="input-group">
            <label for="world-book-edit-name">条目名称 (Key)</label>
            <input type="text" id="world-book-edit-name" placeholder="例如：我的过去、特殊能力">
          </div>
          <div class="input-group">
            <label for="world-book-edit-content">条目内容 (Value)</label>
            <textarea id="world-book-edit-content" placeholder="输入详细的设定内容..."></textarea>
          </div>
        </div>
        <button id="save-world-book-button" class="form-button">保存条目</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="delete-world-book-button" class="form-button destructive">删除该条目</button>
        </div>
      </div>
    </div>

    <div id="group-settings-screen" class="screen">
      <div class="header">
        <button id="back-to-chat-from-group-settings" class="header-button">返回</button>
        <span class="header-title">群聊设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>群聊信息</h2>
          <div class="input-group">
            <label for="group-settings-name">群聊名称</label>
            <input type="text" id="group-settings-name">
          </div>
          <div class="avatar-upload-group">
            <label>群头像</label>
            <img id="group-avatar-preview" class="avatar-preview" alt="Group Avatar Preview">
            <input type="file" id="group-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label>群聊背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="group-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="群聊背景预览">
            </div>
            <input type="file" id="group-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="group-settings-bind-user">绑定用户</label>
            <select id="group-settings-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="group-world-book-checkboxes" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-group-settings-button" class="form-button">保存设置</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="group-clear-history-button" class="form-button warning"
            style=" margin-bottom: 10px;">清空聊天记录</button>
          <button id="group-delete-button" class="form-button destructive">删除并解散群聊</button>
        </div>
      </div>
    </div>

    <div id="music-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-feed" class="header-button">返回</button>
        <span id="friend-circle-title" class="header-title">好友圈</span>
        <div style="display: flex; gap: 5px;">
          <button id="edit-current-circle-button" class="header-button" style="font-size: 1.2rem;">⚙️</button>
          <button id="clear-feed-button" class="header-button" style="color: #dc3545;">清空</button>
          <button id="refresh-feed-button" class="header-button">刷新</button>

        </div>
      </div>
      <div id="user-post-area"
        style="padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background: var(--surface-bg);">
        <div id="user-post-input-container">
          <img id="user-post-avatar" class="char-avatar">
          <div id="user-post-main-area">
            <textarea id="user-post-textarea" rows="3" placeholder="分享你的新鲜事..."></textarea>
            <div id="user-post-attachment-preview"></div>
          </div>
        </div>
        <div id="user-post-toolbar">
          <div id="user-post-actions" class="user-post-actions">
            <button id="user-post-image-button" class="toolbar-button" title="分享图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <input type="file" id="user-post-image-input" accept="image/*" style="display: none;">
            <button id="user-post-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
          </div>
          <button id="user-send-post-button">发送</button>
        </div>
      </div>
      <div id="music-feed-container" class="content" style="padding: 10px;">
      </div>
      <div id="music-player-bar" class="hidden">
        <img id="player-cover" src="">
        <div id="player-info">
          <div id="player-title"></div>
          <div id="player-artist"></div>
        </div>
        <div id="player-controls">
          <button id="player-prev-btn">⏮</button>
          <button id="player-play-pause-btn">▶</button>
          <button id="player-next-btn">⏭</button>
        </div>
      </div>
      <audio id="audio-player"></audio>
    </div>
    <div id="meeting-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-meeting-list" class="header-button">主屏幕</button>
        <span class="header-title">选择见面对象</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="meeting-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="meeting-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-meeting-list">返回</button>
        <span id="meeting-char-name-header" class="header-title">角色</span>
        <button id="toggle-meeting-view-button" class="header-button">切换视角</button>

      </div>
      <div id="meeting-main-content" class="content" style="position: relative; padding: 0;">
        <div id="galgame-overlay-ui">
          <div id="galgame-time">12:00</div>
          <div id="galgame-date">1月1日 星期一</div>
        </div>
        <div id="galgame-sprite-adjust-ui"
          style="position: absolute; top: 20px; right: 20px; z-index: 11; display: none;">
          <button id="sprite-adjust-button" class="toolbar-button" title="调整立绘位置">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 7h-9" />
              <path d="M14 17H5" />
              <circle cx="17" cy="17" r="3" />
              <circle cx="8" cy="7" r="3" />
            </svg>
          </button>
        </div>

        <div id="galgame-sprite-controls"
          style="display: none; position: absolute; bottom: 15px; left: 15px; right: 15px; z-index: 1001; background: rgba(0,0,0,0.7); backdrop-filter: blur(8px); border-radius: 12px; padding: 15px; box-shadow: 0 -2px 15px rgba(0,0,0,0.3);">
          <div class="sprite-slider-group">
            <label for="sprite-slider-x">左右位置</label>
            <input type="range" id="sprite-slider-x" min="0" max="100" value="50">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-y">上下位置</label>
            <input type="range" id="sprite-slider-y" min="0" max="130" value="100">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-scale">缩放大小</label>
            <input type="range" id="sprite-slider-scale" min="50" max="200" value="100">
          </div>
          <div style="display: flex; gap: 10px; margin-top: 15px;">
            <button id="sprite-confirm-button" class="form-button">确定</button>
            <button id="sprite-cancel-button" class="form-button secondary">取消</button>
            <button id="sprite-reset-button" class="form-button destructive"
              style="padding: 10px 12px; width: auto; font-size: 1.2rem;">⟲</button>
          </div>
        </div>
        <div id="meeting-scene-view" class="content"
          style="font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.7);">
        </div>
        <div id="galgame-view-container"
          style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden;">
          <div id="galgame-sprite-wrapper"
            style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; height: 100%;">
            <div id="galgame-sprite-container"
              style="position: absolute; display: flex; align-items: flex-end; justify-content: center; /* 移除旧的定位样式 */">
              <img id="galgame-sprite" src=""
                style="max-height: 100%; max-width: 100%; object-fit: contain; transition: opacity 0.3s ease;">
              <div id="sprite-resize-handle"
                style="display: none; position: absolute; bottom: -5px; right: -5px; width: 20px; height: 20px; background: white; border: 2px solid var(--primary-color); border-radius: 50%; cursor: se-resize;">
              </div>
            </div>
          </div>
          <div id="galgame-textbox-container"
            style="position: absolute; bottom: 9%; left: 5%; right: 5%; background: rgba(0, 0, 0, 0.7); border-radius: 10px; padding: 15px; color: white; border-top: 1px solid rgba(255,255,255,0.2); cursor: pointer;">
            <div id="galgame-speaker" style="font-weight: bold; margin-bottom: 10px;">说话人</div>
            <div id="galgame-text" style="line-height: 1.6;">对话内容...</div>
          </div>
        </div>
      </div>
      <div class="chat-input-area">
        <div id="chat-input-wrapper-meeting"> <textarea id="meeting-message-input" placeholder="输入你的行动或对话..." rows="1"
            style="resize: none; overflow-y: auto; flex-grow: 1; border: none; background: transparent; padding: 9px 12px; font-size: .95rem; outline: none; color: var(--text-color);"></textarea>
          <button id="meeting-send-button" title="发送">➤</button>
        </div>
      </div>
    </div>

    <div id="friend-circle-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-circle-list" class="header-button">主屏幕</button>
        <span class="header-title">好友圈</span>
        <button id="add-friend-circle-button" class="header-button add" title="新建好友圈">+</button>
      </div>
      <div id="friend-circle-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="friend-circle-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-edit" class="header-button">返回</button>
        <span id="friend-circle-edit-title" class="header-title">编辑好友圈</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-friend-circle-id">
        <div class="settings-group">
          <h2>好友圈设定</h2>
          <div class="input-group">
            <label for="friend-circle-edit-name">圈子名称</label>
            <input type="text" id="friend-circle-edit-name" placeholder="例如：我的日常">
          </div>
          <div class="input-group">
            <label for="friend-circle-edit-bind-user">绑定的“我”</label>
            <select id="friend-circle-edit-bind-user"></select>
          </div>
        </div>
        <div class="settings-group">
          <h2>选择圈内成员</h2>
          <div id="friend-circle-member-selection"
            style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
          </div>
        </div>
        <button id="save-friend-circle-button" class="form-button">保存</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <button id="delete-friend-circle-button" class="form-button destructive">删除该好友圈</button>
        </div>
      </div>
    </div>
    <div id="diary-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-diary-list" class="header-button">主屏幕</button>
        <span class="header-title">交换日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="diary-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-diary-list">返回</button>
        <span id="diary-char-name-header" class="header-title">TA的日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-entries-container" class="content"
        style="padding: 20px; font-family: 'KaiTi', 'STSong', serif; line-height: 1.8;">
      </div>
      <div class="chat-input-area">
        <div id="diary-input-wrapper" style="display: flex; gap: 10px;">
          <input type="text" id="diary-entry-input" placeholder="写下你的日记或批注..." style="flex-grow: 1;">
          <button id="diary-send-button" class="form-button"
            style="width: auto; margin-top: 0; padding: 0 18px;">写好了</button>
          <button id="diary-get-reply-button" class="form-button"
            style="width: auto; margin-top: 0; background-color: #555; padding: 0 18px;">催TA写</button>
        </div>
      </div>
    </div>
    <div id="music-library-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-music-library" class="header-button">主屏幕</button>
        <span class="header-title">音乐库</span>
        <button id="upload-music-button" class="header-button add" title="上传新音乐">+</button>
      </div>
      <div class="content" id="music-library-container">
      </div>
    </div>
    <div id="music-upload-altar-screen" class="screen">
      <div class="header">
        <button id="back-to-library-from-altar" class="header-button">取消</button>
        <span class="header-title">献上音乐</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content" style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">

        <div class="upload-slot" id="altar-slot-audio">
          <span class="slot-icon">🎵</span>
          <span class="slot-label">音频文件 (必需)</span>
          <span class="slot-filename">点击选择 .mp3 或 .flac</span>
        </div>

        <div class="upload-slot" id="altar-slot-cover">
          <span class="slot-icon">🖼️</span>
          <span class="slot-label">封面图片 (可选)</span>
          <span class="slot-filename">点击选择 .jpg 或 .png</span>
        </div>

        <div class="upload-slot" id="altar-slot-info">
          <span class="slot-icon">📄</span>
          <span class="slot-label">歌曲信息 (必需)</span>
          <span class="slot-filename">点击选择 info.txt</span>
        </div>

        <div class="upload-slot" id="altar-slot-lyrics">
          <span class="slot-icon">🎤</span>
          <span class="slot-label">歌词文件 (可选)</span>
          <span class="slot-filename">点击选择 .lrc</span>
        </div>

        <button id="confirm-altar-upload-button" class="form-button" disabled>献上祭品</button>
      </div>

    </div>


    <div id="accounting-screen" class="screen">
      <div class="header" id="accounting-header">
        <button id="back-to-home-from-accounting" class="header-button">主屏幕</button>
        <span id="accounting-title" class="header-title">记一笔</span>
        <div id="header-actions" style="width: 80px; text-align: right;"></div>
      </div>

      <div class="accounting-tabs">
        <button id="tab-record-expense" class="tab-button active">记一笔</button>
        <button id="tab-view-ledger" class="tab-button">看账本</button>
      </div>

      <div id="accounting-content-area" class="content" style="padding: 15px;">
      </div>
    </div>
    <audio id="audio-player"></audio>

    <audio id="unified-audio-player"></audio>



  </div>
  </div>

  <div id="add-choice-modal" class="choice-modal">
    <div id="add-choice-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="choice-create-character" class="choice-modal-button">创建新角色</button>
      <button id="choice-create-group" class="choice-modal-button">创建新群聊</button>
      <button id="choice-import-character" class="choice-modal-button">导入角色卡</button>
      <button id="choice-cancel" class="choice-modal-button cancel">取消</button>
    </div>
  </div>


  <div id="transfer-modal" class="choice-modal">
    <div id="transfer-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">转账</h3>
      <div id="transfer-recipient-group" class="input-group" style="margin: 10px 0; display: none;">
        <label for="transfer-recipient-select">转给</label>
        <select id="transfer-recipient-select"></select>
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="transfer-amount-input">金额</label>
        <input type="number" id="transfer-amount-input" placeholder="输入金额">
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-transfer-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认转账</button>
        <button id="cancel-transfer-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="message-action-modal" class="choice-modal">
    <div id="message-action-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="edit-message-button" class="choice-modal-button">编辑消息</button>
      <button id="quote-message-button" class="choice-modal-button">引用</button>
      <button id="delete-message-button" class="choice-modal-button" style="color: #dc3545;">删除消息</button>
      <button id="cancel-action-button" class="choice-modal-button cancel">取消</button>
    </div>
  </div>

  <div id="edit-message-modal" class="choice-modal">
    <div id="edit-message-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">编辑消息</h3>
      <textarea id="edit-message-textarea" style="width: 100%; min-height: 100px; margin: 10px 0;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 10px;">
        <button id="save-edit-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">保存</button>
        <button id="cancel-edit-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="music-input-modal" class="choice-modal">
    <div id="music-input-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 id="music-input-title" style="margin-top: 0; text-align: center; font-weight: 600;">分享音乐</h3>

      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-song" style="font-size: 0.9rem;">歌名</label>
        <input type="text" id="music-input-song" placeholder="例如：夜曲">
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-artist" style="font-size: 0.9rem;">歌手</label>
        <input type="text" id="music-input-artist" placeholder="例如：周杰伦">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-music-input" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认</button>
        <button id="cancel-music-input" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="modal-root"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;">
    <div id="modal-mask" style="position:absolute;inset:0;background:rgba(0,0,0,.35);"></div>
    <div id="modal-dialog"
      style="position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:80%;max-width:320px;padding:16px;">
      <div id="modal-text" style="font-size:14px;color:#333;line-height:1.5;white-space:pre-wrap;"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px;">
        <button id="modal-cancel"
          style="padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;">取消</button>
        <button id="modal-ok"
          style="padding:8px 12px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">确定</button>
      </div>
    </div>
  </div>

  <div id="listen-together-modal" class="choice-modal">
    <div id="listen-together-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <div style="width: 50px;"></div>
        <span class="header-title">选择一首歌，一起听</span>
        <button id="cancel-listen-together" class="header-button" style="min-width: 50px;">取消</button>
      </div>
      <div id="listen-together-song-list" class="content" style="flex-grow: 1; padding: 10px;">
      </div>
    </div>
  </div>

  <div id="toast"
    style="position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:8px;font-size:12px;display:none;z-index:10000;">
  </div>



  <script>
    const _0x5ad424 = _0x118e; (function (_0x397ab0, _0x418f55) { const _0x17e69a = _0x118e, _0x465911 = _0x397ab0(); while (!![]) { try { const _0x13d060 = -parseInt(_0x17e69a(0x944)) / 0x1 + -parseInt(_0x17e69a(0x648)) / 0x2 * (-parseInt(_0x17e69a(0x71e)) / 0x3) + parseInt(_0x17e69a(0x1d8)) / 0x4 * (-parseInt(_0x17e69a(0x1ac)) / 0x5) + parseInt(_0x17e69a(0x317)) / 0x6 + parseInt(_0x17e69a(0x6fb)) / 0x7 + -parseInt(_0x17e69a(0x1f1)) / 0x8 * (parseInt(_0x17e69a(0x8d8)) / 0x9) + parseInt(_0x17e69a(0x1f4)) / 0xa; if (_0x13d060 === _0x418f55) break; else _0x465911['push'](_0x465911['shift']()); } catch (_0x2ca641) { _0x465911['push'](_0x465911['shift']()); } } }(_0x5f54, 0x475d7)); var _0x128784, _0x47847f = null; let _0x2f0881 = [], _0x5a4156 = ![], _0x361842 = { 'x': 0x0, 'y': 0x0 }; function _0x5773c5(_0x407372) { const _0x6093d = _0x118e; return (_0x128784?.[_0x6093d(0x277)] || [])[_0x6093d(0x787)](_0x4a7915 => _0x4a7915['id'] === _0x407372); } const _0x14d6a7 = _0x5ad424(0x2b2), _0x473193 = _0x5ad424(0x230), _0x3834ec = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNjY2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDRhNC4zOSA0LjM5IDAgMCAwLTMuMjgtNC4wOWwxLjQxLTEuNDFhMiAyIDAgMSAwLTIuODMtMi4wM2wtMS40MSAxLjQxQTQuMzkgNC4zOSAwIDAgMCAxMiAxMGE0LjM5IDQuMzkgMCAwIDAtNC4wOSAzLjI4TDMuMicgOS41N2EyIDIgMCAxIDAgMi44MyAyLjgzbDEuNDEtMS40MUE0LjM5IDQuMzkgMCAwIDAgMTAgMTJhNC4zOSA0LjM5IDAgMCAwIDMgNC4wOVYyMSI+PC9wYXRoPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIj48L2NpcmNsZT48L3N2Zz4=', _0x51f2c7 = [{ 'name': _0x5ad424(0x917), 'url': _0x5ad424(0x3da) }, { 'name': '崩溃', 'url': _0x5ad424(0x6b8) }, { 'name': '生病', 'url': _0x5ad424(0x95f) }, { 'name': '工作', 'url': _0x5ad424(0x982) }, { 'name': '我很脆弱', 'url': _0x5ad424(0x44a) }, { 'name': '弱小委屈但凶恶', 'url': _0x5ad424(0x630) }, { 'name': '吃薯条', 'url': _0x5ad424(0x76a) }, { 'name': '期待', 'url': _0x5ad424(0x641) }, { 'name': '喜欢', 'url': 'https://sharkpan.xyz/f/55ntj/ul0hkz.jpg' }, { 'name': _0x5ad424(0x822), 'url': _0x5ad424(0x493) }, { 'name': _0x5ad424(0x6e9), 'url': _0x5ad424(0x74f) }, { 'name': '委屈', 'url': _0x5ad424(0x232) }, { 'name': '加油', 'url': _0x5ad424(0x741) }, { 'name': '对的', 'url': _0x5ad424(0x345) }, { 'name': '不满', 'url': _0x5ad424(0x42f) }, { 'name': _0x5ad424(0x523), 'url': 'https://sharkpan.xyz/f/qjJT3/kpy33b.jpg' }, { 'name': _0x5ad424(0x3e6), 'url': _0x5ad424(0x8ad) }, { 'name': '委屈', 'url': 'https://sharkpan.xyz/f/25ACQ/gpzab6.jpg' }, { 'name': '平静', 'url': _0x5ad424(0x52e) }, { 'name': '咬你', 'url': 'https://sharkpan.xyz/f/JYeig/sv4p6m.jpg' }, { 'name': _0x5ad424(0x78c), 'url': 'https://sharkpan.xyz/f/OymFy/dlxfiz.jpg' }, { 'name': '好困', 'url': _0x5ad424(0x599) }, { 'name': '摸鱼', 'url': _0x5ad424(0x251) }, { 'name': _0x5ad424(0x974), 'url': 'https://sharkpan.xyz/f/mjdFW/28n30c.jpg' }, { 'name': _0x5ad424(0x5ee), 'url': _0x5ad424(0x79e) }, { 'name': _0x5ad424(0x627), 'url': 'https://sharkpan.xyz/f/4adUj/68uj9o.jpg' }, { 'name': _0x5ad424(0x3d6), 'url': _0x5ad424(0x448) }, { 'name': _0x5ad424(0x32d), 'url': _0x5ad424(0x700) }, { 'name': _0x5ad424(0x324), 'url': _0x5ad424(0x6bc) }, { 'name': _0x5ad424(0x83e), 'url': _0x5ad424(0x4c0) }, { 'name': _0x5ad424(0x37e), 'url': _0x5ad424(0x8bf) }, { 'name': _0x5ad424(0x827), 'url': 'https://sharkpan.xyz/f/JYJhg/s3wmlj.jpg' }, { 'name': _0x5ad424(0x551), 'url': _0x5ad424(0x92e) }, { 'name': '逗你开心', 'url': 'https://sharkpan.xyz/f/6Dgia/ghr4ji.jpg' }, { 'name': '买新衣服', 'url': 'https://sharkpan.xyz/f/nj7ul/r48eum.jpg' }, { 'name': _0x5ad424(0x715), 'url': 'https://sharkpan.xyz/f/mjeIW/9vf8ws.jpg' }, { 'name': _0x5ad424(0x62d), 'url': _0x5ad424(0x6b0) }, { 'name': '交给我吧', 'url': _0x5ad424(0x241) }, { 'name': _0x5ad424(0x6bd), 'url': _0x5ad424(0x1bb) }, { 'name': _0x5ad424(0x296), 'url': _0x5ad424(0x652) }, { 'name': _0x5ad424(0x689), 'url': _0x5ad424(0x936) }, { 'name': _0x5ad424(0x9ab), 'url': _0x5ad424(0x9b1) }, { 'name': _0x5ad424(0x85f), 'url': _0x5ad424(0x566) }, { 'name': '绝对不想', 'url': 'https://sharkpan.xyz/f/Krwio/1mcclx.jpg' }, { 'name': _0x5ad424(0x5b4), 'url': _0x5ad424(0x7d5) }, { 'name': _0x5ad424(0x527), 'url': 'https://sharkpan.xyz/f/YA7T1/th0l79.jpg' }, { 'name': _0x5ad424(0x704), 'url': _0x5ad424(0x558) }, { 'name': _0x5ad424(0x3f6), 'url': _0x5ad424(0x784) }, { 'name': '我是小丑呜呜', 'url': _0x5ad424(0x818) }, { 'name': '我不想工作', 'url': _0x5ad424(0x2b8) }, { 'name': '吃你的饭', 'url': 'https://sharkpan.xyz/f/yrOhN/0yixqd.jpg' }, { 'name': _0x5ad424(0x33a), 'url': _0x5ad424(0x2eb) }, { 'name': _0x5ad424(0x222), 'url': _0x5ad424(0x54b) }, { 'name': '等你', 'url': _0x5ad424(0x1e4) }, { 'name': '一个人可怜吃饭', 'url': _0x5ad424(0x795) }, { 'name': _0x5ad424(0x8dc), 'url': _0x5ad424(0x6d2) }, { 'name': '喝酒', 'url': _0x5ad424(0x728) }, { 'name': _0x5ad424(0x7a6), 'url': _0x5ad424(0x2ad) }, { 'name': '呜呜', 'url': _0x5ad424(0x40f) }, { 'name': _0x5ad424(0x4fd), 'url': _0x5ad424(0x4f0) }, { 'name': _0x5ad424(0x6ad), 'url': _0x5ad424(0x21a) }, { 'name': _0x5ad424(0x8fd), 'url': _0x5ad424(0x996) }, { 'name': '请看是我', 'url': _0x5ad424(0x373) }, { 'name': _0x5ad424(0x9a5), 'url': 'https://sharkpan.xyz/f/3AGHe/2f8x3x.gif' }], _0x3080e8 = { 'beige': { 'name': _0x5ad424(0x6db), 'h': 0x23, 's': 0x19, 'l': 0x50 }, 'mizuiro': { 'name': _0x5ad424(0x3f1), 'h': 0xc3, 's': 0x19, 'l': 0x50 }, 'sakura': { 'name': _0x5ad424(0x209), 'h': 0x159, 's': 0x19, 'l': 0x50 }, 'noir': { 'name': _0x5ad424(0x397), 'h': 0x104, 's': 0xf, 'l': 0x1e } }; document['addEventListener']('DOMContentLoaded', () => { const _0x43c7a1 = _0x5ad424, _0x4baabd = document[_0x43c7a1(0x655)](_0x43c7a1(0x829)), _0x1b3a0a = document[_0x43c7a1(0x655)](_0x43c7a1(0x2af)), _0xd6a01e = document[_0x43c7a1(0x655)](_0x43c7a1(0x5d3)), _0x4a18a2 = document['getElementById'](_0x43c7a1(0x553)), _0xa095a1 = document[_0x43c7a1(0x655)]('confirm-transfer-button'), _0x114f63 = document[_0x43c7a1(0x655)]('cancel-transfer-button'), _0x5e7df4 = document[_0x43c7a1(0x655)](_0x43c7a1(0x30b)), _0x320e5e = document['getElementById'](_0x43c7a1(0x99f)), _0x4a3bf1 = document[_0x43c7a1(0x655)](_0x43c7a1(0x93b)), _0x5bc0c5 = document[_0x43c7a1(0x655)]('chat-reroll-button'), _0x2b4820 = document[_0x43c7a1(0x655)](_0x43c7a1(0x4b2)), _0x3c1821 = document[_0x43c7a1(0x655)]('summarize-modal'), _0x552772 = document[_0x43c7a1(0x655)](_0x43c7a1(0x316)), _0x29c201 = document[_0x43c7a1(0x655)](_0x43c7a1(0x766)), _0x5c0824 = document[_0x43c7a1(0x655)](_0x43c7a1(0x1f7)), _0x42caf0 = document[_0x43c7a1(0x655)](_0x43c7a1(0x4ec)), _0x55f1f4 = document['getElementById'](_0x43c7a1(0x5fd)), _0x3795aa = document[_0x43c7a1(0x655)](_0x43c7a1(0x238)), _0x307e1f = document[_0x43c7a1(0x655)]('char-edit-offline-bg-preview'), _0x2319e8 = document[_0x43c7a1(0x655)](_0x43c7a1(0x220)), _0x41cac7 = document[_0x43c7a1(0x655)](_0x43c7a1(0x853)), _0x4421b3 = document['getElementById'](_0x43c7a1(0x5ca)), _0xb2fde6 = document[_0x43c7a1(0x655)](_0x43c7a1(0x62a)); function _0x3cc7fa() { const _0x368825 = _0x43c7a1, _0x5b94f7 = document[_0x368825(0x655)](_0x368825(0x820)); if (!_0x5b94f7) return; const _0x224fe1 = localStorage[_0x368825(0x2c6)](_0x368825(0x415)) || '35'; document[_0x368825(0x348)][_0x368825(0x385)][_0x368825(0x6ac)](_0x368825(0x4cc), _0x224fe1), _0x5b94f7[_0x368825(0x9bf)] = _0x224fe1, _0x5b94f7['addEventListener'](_0x368825(0x2cb), () => { const _0x53c1d6 = _0x368825; if (_0x53c1d6(0x9e3) !== _0x53c1d6(0x9e3)) _0xfba9c3[_0x53c1d6(0x7b6)](_0x32b845, { 'keyPath': 'id' }); else { const _0x347bc4 = _0x5b94f7['value']; document[_0x53c1d6(0x348)]['style'][_0x53c1d6(0x6ac)](_0x53c1d6(0x4cc), _0x347bc4), localStorage[_0x53c1d6(0x548)](_0x53c1d6(0x415), _0x347bc4), _0x35d233(); } }); } function _0x41e50f() { const _0x3ce385 = _0x43c7a1, _0x26997d = document[_0x3ce385(0x655)](_0x3ce385(0x63f)); if (!_0x26997d) return; const _0x3e37f3 = localStorage[_0x3ce385(0x2c6)]('themeLightness') || '80'; document[_0x3ce385(0x348)][_0x3ce385(0x385)][_0x3ce385(0x6ac)](_0x3ce385(0x5e5), _0x3e37f3 + '%'), _0x26997d['value'] = _0x3e37f3, _0x26997d[_0x3ce385(0x203)](_0x3ce385(0x2cb), () => { const _0x5bb5cd = _0x3ce385; if (_0x5bb5cd(0x19d) !== _0x5bb5cd(0x19d)) _0x37546f[_0x5bb5cd(0x9de)](_0x5bb5cd(0x986), _0x5be404), _0x1f3dec[_0x5bb5cd(0x385)]['backgroundImage'] = ''; else { const _0x447033 = _0x26997d[_0x5bb5cd(0x9bf)]; document['documentElement'][_0x5bb5cd(0x385)][_0x5bb5cd(0x6ac)](_0x5bb5cd(0x5e5), _0x447033 + '%'), localStorage[_0x5bb5cd(0x548)]('themeLightness', _0x447033), _0x35d233(); } }); } function _0x35d233() { const _0x5dadcc = _0x43c7a1; if (_0x5dadcc(0x3e9) !== _0x5dadcc(0x9c3)) { const _0x1a1719 = document['getElementById'](_0x5dadcc(0x928)); if (!_0x1a1719) return; _0x128784[_0x5dadcc(0x430)][_0x5dadcc(0x6fa)] ? (_0x1a1719[_0x5dadcc(0x385)][_0x5dadcc(0x1cf)] = '#FFFFFF', _0x1a1719[_0x5dadcc(0x385)][_0x5dadcc(0x772)] = '0\x202px\x208px\x20rgba(0,0,0,0.4)') : (_0x1a1719[_0x5dadcc(0x385)][_0x5dadcc(0x1cf)] = 'var(--text-color)', _0x1a1719['style'][_0x5dadcc(0x772)] = _0x5dadcc(0x44e)); } else { const _0x687c5e = _0x14a047[_0x5dadcc(0x655)](_0x5dadcc(0x38d))[_0x5dadcc(0x9bf)]; _0x687c5e && (_0x4a0817[_0x5dadcc(0x226)] = _0x687c5e, _0x1d469e(), _0x531c20('已设为当前用户！'), _0x26c668(), _0x5dea5d[_0x5dadcc(0x655)](_0x5dadcc(0x767))[_0x5dadcc(0x385)]['display'] = 'none'); } } function _0x402a21() { const _0x373b24 = _0x43c7a1, _0x26f9c7 = document['getElementById'](_0x373b24(0x74d)); if (!_0x26f9c7) return; _0x26f9c7[_0x373b24(0x30c)] = _0x128784[_0x373b24(0x430)][_0x373b24(0x6fa)] || ![], _0x26f9c7[_0x373b24(0x203)]('change', () => { const _0x53f328 = _0x373b24; _0x128784[_0x53f328(0x430)]['forceWhiteClock'] = _0x26f9c7[_0x53f328(0x30c)], _0x5eb81f(), _0x35d233(); }); } _0xb2fde6[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x39c756), _0x41cac7[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { _0x456ef4(), _0x4421b3['click'](); }), _0x4421b3[_0x43c7a1(0x203)](_0x43c7a1(0x272), _0x28f767); const _0x1bca98 = { 'home': document[_0x43c7a1(0x655)](_0x43c7a1(0x30a)), 'chat': document[_0x43c7a1(0x655)](_0x43c7a1(0x336)), 'settings': document['getElementById'](_0x43c7a1(0x4e5)), 'userProfile': document[_0x43c7a1(0x655)]('user-profile-screen'), 'characterEdit': document['getElementById']('character-edit-screen'), 'groupChatCreate': document[_0x43c7a1(0x655)](_0x43c7a1(0x896)), 'wallpaper': document[_0x43c7a1(0x655)](_0x43c7a1(0x91d)), 'worldBook': document[_0x43c7a1(0x655)](_0x43c7a1(0x301)), 'worldBookEditor': document[_0x43c7a1(0x655)](_0x43c7a1(0x9a9)), 'groupSettings': document[_0x43c7a1(0x655)](_0x43c7a1(0x1ab)), 'music': document[_0x43c7a1(0x655)](_0x43c7a1(0x923)), 'friendCircleList': document[_0x43c7a1(0x655)](_0x43c7a1(0x68d)), 'friendCircleEdit': document['getElementById'](_0x43c7a1(0x7e3)), 'meetingList': document[_0x43c7a1(0x655)](_0x43c7a1(0x552)), 'meetingView': document['getElementById'](_0x43c7a1(0x66e)), 'userProfileList': document[_0x43c7a1(0x655)](_0x43c7a1(0x618)), 'diaryList': document[_0x43c7a1(0x655)](_0x43c7a1(0x931)), 'diaryView': document[_0x43c7a1(0x655)]('diary-view-screen'), 'musicLibrary': document['getElementById'](_0x43c7a1(0x23e)), 'musicUploadAltar': document[_0x43c7a1(0x655)](_0x43c7a1(0x721)), 'accounting': document[_0x43c7a1(0x655)](_0x43c7a1(0x643)) }, _0x150481 = document[_0x43c7a1(0x655)]('upload-feed-bg-button'), _0x548afc = document['getElementById'](_0x43c7a1(0x196)), _0x22176f = document[_0x43c7a1(0x655)](_0x43c7a1(0x550)), _0x4a017b = document['getElementById'](_0x43c7a1(0x574)), _0x37e41f = document[_0x43c7a1(0x655)](_0x43c7a1(0x520)), _0x29690f = document[_0x43c7a1(0x655)](_0x43c7a1(0x607)), _0x20010f = document[_0x43c7a1(0x655)](_0x43c7a1(0x21d)), _0x38c488 = document['getElementById'](_0x43c7a1(0x2a7)); document[_0x43c7a1(0x655)]('reset-desktop-button')['addEventListener']('click', async () => { const _0x558605 = _0x43c7a1, _0x2bfc1 = await _0x17d4de(_0x558605(0x3eb)); if (_0x2bfc1) { if (_0x558605(0x5d6) === _0x558605(0x977)) { const _0x419a40 = _0x35a9d1[_0x558605(0x34b)](); _0x419a40[_0x558605(0x265)] = () => _0x563a91(_0x419a40[_0x558605(0x5a7)]), _0x419a40[_0x558605(0x9a7)] = () => _0x561c10(_0x419a40[_0x558605(0x9de)]); } else { localStorage[_0x558605(0x5c5)](_0x558605(0x584)), localStorage['removeItem']('cardState'), localStorage[_0x558605(0x5c5)](_0x558605(0x1cb)), localStorage['removeItem']('musicWidgetPosition'); const _0x395199 = []; for (let _0x642a6d = 0x0; _0x642a6d < localStorage[_0x558605(0x36c)]; _0x642a6d++) { const _0x516aee = localStorage[_0x558605(0x956)](_0x642a6d); _0x516aee && _0x516aee[_0x558605(0x3fd)]('appIconPosition_') && (_0x558605(0x869) === 'avhEP' ? _0x40d8fd[_0x558605(0x9ad)](_0x558605(0x5b7))['onclick'] = () => { _0x4bf802(_0x3b2cbe), _0x2fefb3(); } : _0x395199['push'](_0x516aee)); } _0x395199['forEach'](_0x575594 => localStorage[_0x558605(0x5c5)](_0x575594)), await _0x36c0a8('wallpaper_main', await _0x454232(_0x558605(0x58a))), _0x420e01(_0x558605(0x44d)), setTimeout(() => location[_0x558605(0x360)](), 0x5dc); } } }); const _0x535413 = document[_0x43c7a1(0x655)](_0x43c7a1(0x3c3)), _0x4eb509 = document[_0x43c7a1(0x655)]('add-choice-backdrop'), _0xe50e5 = document[_0x43c7a1(0x655)](_0x43c7a1(0x22b)), _0x5d3c58 = document[_0x43c7a1(0x655)](_0x43c7a1(0x84c)), _0x25cf28 = document[_0x43c7a1(0x655)](_0x43c7a1(0x186)), _0x5e73b0 = document[_0x43c7a1(0x655)]('back-to-char-select-from-group-create'), _0x25bf69 = document[_0x43c7a1(0x655)](_0x43c7a1(0x5ae)), _0x464e37 = document['getElementById']('group-chat-name'), _0xe17208 = document[_0x43c7a1(0x655)](_0x43c7a1(0x5f0)), _0xb2e8a8 = document['getElementById'](_0x43c7a1(0x427)), _0x4b0255 = document[_0x43c7a1(0x655)](_0x43c7a1(0x5f2)), _0x591658 = document[_0x43c7a1(0x655)](_0x43c7a1(0x94f)), _0x377fef = document[_0x43c7a1(0x655)]('back-to-home-from-chat'), _0x43539b = document[_0x43c7a1(0x655)]('back-to-chat-list'), _0x1b671a = document[_0x43c7a1(0x655)](_0x43c7a1(0x7b8)), _0x2e7a60 = document['getElementById']('back-to-char-select-from-edit'), _0x415cde = document['getElementById'](_0x43c7a1(0x2ba)), _0x1032a8 = document['getElementById'](_0x43c7a1(0x4d1)), _0x35676c = document[_0x43c7a1(0x655)](_0x43c7a1(0x336)), _0x76cec4 = document[_0x43c7a1(0x655)](_0x43c7a1(0x8bc)), _0xe97d72 = document['getElementById'](_0x43c7a1(0x1aa)), _0x5e0a7b = document[_0x43c7a1(0x655)](_0x43c7a1(0x9d1)), _0x5a7fd9 = document[_0x43c7a1(0x655)](_0x43c7a1(0x9ce)), _0x26d8b4 = document[_0x43c7a1(0x655)]('quote-preview-area'), _0x5791d6 = document['getElementById'](_0x43c7a1(0x192)), _0x4634ed = document[_0x43c7a1(0x655)](_0x43c7a1(0x602)), _0x529df5 = document[_0x43c7a1(0x655)](_0x43c7a1(0x3a4)), _0x5ed43f = document[_0x43c7a1(0x655)](_0x43c7a1(0x3f2)), _0x1d43e0 = document[_0x43c7a1(0x655)](_0x43c7a1(0x99c)), _0x3cc518 = document[_0x43c7a1(0x655)](_0x43c7a1(0x274)), _0xc33155 = document[_0x43c7a1(0x655)](_0x43c7a1(0x7d7)), _0x4a3884 = document['getElementById'](_0x43c7a1(0x510)), _0x42732e = document[_0x43c7a1(0x655)]('character-settings-button'), _0xb96cd5 = document['getElementById'](_0x43c7a1(0x579)), _0xc525fe = document['getElementById']('api-endpoint'), _0x58431b = document[_0x43c7a1(0x655)]('api-key'), _0x122f28 = document[_0x43c7a1(0x655)](_0x43c7a1(0x268)), _0x49de84 = document[_0x43c7a1(0x655)](_0x43c7a1(0x8be)), _0x31f870 = document[_0x43c7a1(0x655)]('fetch-models-button'), _0x55c844 = document[_0x43c7a1(0x655)](_0x43c7a1(0x9d5)), _0x160945 = document[_0x43c7a1(0x655)](_0x43c7a1(0x9a8)), _0x4d70c1 = document[_0x43c7a1(0x655)]('user-name'), _0x415175 = document[_0x43c7a1(0x655)](_0x43c7a1(0x3ca)), _0x363728 = document['getElementById']('user-avatar-input'), _0x316e87 = document[_0x43c7a1(0x655)](_0x43c7a1(0x4fe)), _0x100662 = document[_0x43c7a1(0x655)](_0x43c7a1(0x80d)), _0x4e5ef7 = document['getElementById'](_0x43c7a1(0x4f2)), _0x30c654 = document[_0x43c7a1(0x655)](_0x43c7a1(0x762)), _0x33f7a8 = document[_0x43c7a1(0x655)](_0x43c7a1(0x770)), _0x151fa3 = document['getElementById']('char-edit-remark'), _0x460708 = document['getElementById'](_0x43c7a1(0x71f)), _0x2a98fe = document['getElementById'](_0x43c7a1(0x38b)), _0x41ba65 = document[_0x43c7a1(0x655)](_0x43c7a1(0x225)), _0x59478e = document[_0x43c7a1(0x655)](_0x43c7a1(0x1d6)), _0x16665f = document[_0x43c7a1(0x655)](_0x43c7a1(0x546)), _0xadc109 = document['getElementById'](_0x43c7a1(0x2c9)); let _0x1dfb8c = null; const _0x5b344c = _0x43c7a1(0x81d), _0x4ffe1c = _0x43c7a1(0x8c3); _0x128784 = { 'characters': [], 'worldBooks': [], 'chats': [], 'userProfiles': [], 'activeUserProfileId': null, 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'widgetBgImage': null, 'perChatContextLines': 0x64, 'forceWhiteClock': ![] }, 'activeChatId': null, 'activeMeetingCharId': null, 'isGenerating': ![], 'currentAbortController': null, 'pendingMessageTimers': [], 'conversationHistory': [], 'displayedMessageCount': 0x64, 'activeQuote': null, 'friendCircles': [], 'activeFriendCircleId': null, 'accountingData': [], 'accountingLedger': {}, 'diaries': [], 'activeDiaryCharacterId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'meetingViewMode': _0x43c7a1(0x644), 'activeMeetingScriptQueue': [], 'characterLastScripts': {}, 'musicPlaylist': [], 'currentlyPlayingIndex': -0x1, 'isPlaying': ![], 'pendingPostAttachments': { 'image': null, 'music': null } }; function _0x5eb81f() { const _0x8e2ed6 = _0x43c7a1; if (_0x8e2ed6(0x1c8) !== _0x8e2ed6(0x873)) try { const _0x33b2f4 = { 'characters': _0x128784['characters'], 'worldBooks': _0x128784['worldBooks'], 'chats': _0x128784['chats'], 'userProfile': _0x128784['userProfile'], 'apiSettings': _0x128784[_0x8e2ed6(0x8a1)], 'preferences': _0x128784[_0x8e2ed6(0x430)], 'activeChatId': _0x128784['activeChatId'], 'diaries': _0x128784[_0x8e2ed6(0x401)], 'friendCircles': _0x128784['friendCircles'], 'activeFriendCircleId': _0x128784[_0x8e2ed6(0x462)], 'userProfiles': _0x128784[_0x8e2ed6(0x4a5)], 'activeUserProfileId': _0x128784['activeUserProfileId'], 'accountingData': _0x128784[_0x8e2ed6(0x7cb)], 'accountingLedger': _0x128784[_0x8e2ed6(0x4f1)] }; localStorage[_0x8e2ed6(0x548)]('appState', JSON[_0x8e2ed6(0x5e0)](_0x33b2f4)); } catch (_0x4f2f78) { _0x8e2ed6(0x255) !== _0x8e2ed6(0x5d1) ? (console[_0x8e2ed6(0x9de)](_0x8e2ed6(0x8b8), _0x4f2f78), _0x420e01(_0x8e2ed6(0x8c1))) : !_0x12a37f[_0x8e2ed6(0x878)](_0x5af720[_0x8e2ed6(0x949)]) && _0x4c4073[_0x8e2ed6(0x949)] !== _0xc49f9e && _0x5e1c45[_0x8e2ed6(0x949)] !== _0x53f0e2 && _0x1d54e6[_0x8e2ed6(0x421)][_0x8e2ed6(0x66f)](_0x8e2ed6(0x8d5)); } else { const _0x59f16c = _0x851c45(_0x33c8a3[0x1], 0xa), _0x531da8 = _0x4590a0(_0x384089[0x2], 0xa), _0x1c2f2f = _0x4cb73d(_0x44c1c0[0x3], 0xa) * (_0x59a559[0x3][_0x8e2ed6(0x36c)] === 0x2 ? 0xa : 0x1), _0x4427aa = _0x59f16c * 0x3c + _0x531da8 + _0x1c2f2f / 0x3e8, _0x5077e7 = _0x291e7e['replace'](_0x2ee8ca, '')[_0x8e2ed6(0x6df)](); _0x5077e7 && _0x3dca6d[_0x8e2ed6(0x1e5)]({ 'time': _0x4427aa, 'text': _0x5077e7 }); } } function _0x3ac778() { const _0x5e5406 = _0x43c7a1; let _0x32709f = null; try { _0x32709f = localStorage['getItem'](_0x5e5406(0x52b)); } catch (_0x54a254) { console[_0x5e5406(0x9de)](_0x5e5406(0x61b), _0x54a254), _0x420e01(_0x5e5406(0x432)); } if (_0x32709f) try { const _0x9cbfd7 = JSON[_0x5e5406(0x7a8)](_0x32709f); if (!_0x9cbfd7 || typeof _0x9cbfd7 !== _0x5e5406(0x581)) throw new Error('Invalid\x20saved\x20state\x20format'); Array[_0x5e5406(0x79f)](_0x9cbfd7[_0x5e5406(0x277)]) && (_0x128784[_0x5e5406(0x277)] = _0x9cbfd7[_0x5e5406(0x277)]['map'](_0x577895 => ({ 'offlineBackground': '', ..._0x577895 }))[_0x5e5406(0x89c)](_0x5c94f1 => _0x5c94f1 && typeof _0x5c94f1 === _0x5e5406(0x581) && _0x5c94f1['id'])); _0x9cbfd7['accountingData'] && (_0x128784[_0x5e5406(0x7cb)] = _0x9cbfd7[_0x5e5406(0x7cb)]); if (_0x9cbfd7[_0x5e5406(0x4f1)]) { if (_0x5e5406(0x262) === _0x5e5406(0x262)) _0x128784[_0x5e5406(0x4f1)] = _0x9cbfd7[_0x5e5406(0x4f1)]; else { const _0xc71712 = _0x9aa034[_0x5e5406(0x1e2)][_0x5e5406(0x89c)](_0x5336ff => _0x5336ff['type'] === _0x5e5406(0x2b9) && _0x5336ff[_0x5e5406(0x36f)])['map'](_0x3ad688 => ({ ..._0x3ad688, 'source': _0x5e5406(0x9b8) })); _0x935a75[_0x5e5406(0x1e5)](..._0xc71712); } } Array[_0x5e5406(0x79f)](_0x9cbfd7[_0x5e5406(0x188)]) && (_0x128784['worldBooks'] = _0x9cbfd7['worldBooks']); if (Array[_0x5e5406(0x79f)](_0x9cbfd7[_0x5e5406(0x401)])) { if (_0x5e5406(0x81e) === _0x5e5406(0x81e)) _0x128784['diaries'] = _0x9cbfd7[_0x5e5406(0x401)]; else { _0x16d5ee['warn'](_0x5e5406(0x841)); const _0x2b313c = _0x55b0fc[_0x5e5406(0x4de)][_0x5e5406(0x946)](_0x17c24a)['filter'](_0x5cf469); if (!_0x2b313c[_0x5e5406(0x36c)]) return; let _0x6d9059 = 0x0; for (const _0x472251 of _0x2b313c) { _0x18215e(_0x472251, { 'force': !![], 'delayMs': _0x6d9059 }), _0x6d9059 += 0x1f4; } } } if (Array[_0x5e5406(0x79f)](_0x9cbfd7[_0x5e5406(0x21f)])) _0x128784[_0x5e5406(0x21f)] = _0x9cbfd7[_0x5e5406(0x21f)], _0x128784[_0x5e5406(0x462)] = _0x9cbfd7[_0x5e5406(0x462)]; else { if (Array[_0x5e5406(0x79f)](_0x9cbfd7['musicFeed']) && _0x9cbfd7[_0x5e5406(0x591)][_0x5e5406(0x36c)] > 0x0) { if (_0x5e5406(0x8b3) === _0x5e5406(0x61d)) _0xda699a[_0x5e5406(0x385)]['backgroundImage'] = _0x5e5406(0x44e); else { console[_0x5e5406(0x331)](_0x5e5406(0x575)); const _0x5df90b = { 'id': 'circle_' + Date[_0x5e5406(0x8a2)](), 'name': _0x5e5406(0x659), 'boundUserProfileId': _0x9cbfd7[_0x5e5406(0x226)], 'memberCharacterIds': _0x9cbfd7[_0x5e5406(0x277)][_0x5e5406(0x946)](_0x502093 => _0x502093['id']), 'posts': _0x9cbfd7[_0x5e5406(0x591)] }; _0x128784[_0x5e5406(0x21f)] = [_0x5df90b], _0x128784[_0x5e5406(0x462)] = _0x5df90b['id']; } } } if (Array[_0x5e5406(0x79f)](_0x9cbfd7[_0x5e5406(0x4a5)])) { if (_0x5e5406(0x519) === _0x5e5406(0x519)) _0x128784['userProfiles'] = _0x9cbfd7[_0x5e5406(0x4a5)], _0x128784['activeUserProfileId'] = _0x9cbfd7[_0x5e5406(0x226)]; else { const _0x5598fe = _0x13aae6[_0x5e5406(0x4a5)][_0x5e5406(0x787)](_0x22c6c4 => _0x22c6c4['id'] === _0x3bf00f); if (!_0x5598fe) return; _0x53d9cc[_0x5e5406(0x655)](_0x5e5406(0x38d))[_0x5e5406(0x9bf)] = _0x5598fe['id'], _0x19a382[_0x5e5406(0x655)](_0x5e5406(0x3d4))['textContent'] = _0x5e5406(0x74b), _0x52a899[_0x5e5406(0x655)](_0x5e5406(0x7c9))[_0x5e5406(0x9bf)] = _0x5598fe[_0x5e5406(0x4da)], _0x246c37[_0x5e5406(0x655)]('user-avatar-preview')[_0x5e5406(0x84a)] = _0x5598fe[_0x5e5406(0x4b6)], _0x17c082[_0x5e5406(0x655)](_0x5e5406(0x4fe))['value'] = _0x5598fe[_0x5e5406(0x489)], _0x5789f0[_0x5e5406(0x385)][_0x5e5406(0x1cd)] = _0x5598fe['id'] === _0x167195[_0x5e5406(0x226)] ? _0x5e5406(0x44e) : _0x5e5406(0x3d3); } } else { if (_0x9cbfd7[_0x5e5406(0x50a)]) { if ('KdIid' === _0x5e5406(0x6fe)) return { 'type': _0x5e5406(0x64b), 'content': _0x49a6c8 }; else { console[_0x5e5406(0x331)](_0x5e5406(0x333)); const _0x46d194 = { 'id': _0x5e5406(0x98d) + Date[_0x5e5406(0x8a2)](), 'name': _0x9cbfd7[_0x5e5406(0x50a)][_0x5e5406(0x4da)] || '我', 'avatar': _0x9cbfd7[_0x5e5406(0x50a)][_0x5e5406(0x4b6)] || _0x473193, 'persona': _0x9cbfd7[_0x5e5406(0x50a)][_0x5e5406(0x489)] || '' }; _0x128784[_0x5e5406(0x4a5)] = [_0x46d194], _0x128784[_0x5e5406(0x226)] = _0x46d194['id']; } } } _0x9cbfd7['apiSettings'] && typeof _0x9cbfd7[_0x5e5406(0x8a1)] === _0x5e5406(0x581) && (_0x128784['apiSettings'] = { ..._0x128784[_0x5e5406(0x8a1)], ..._0x9cbfd7[_0x5e5406(0x8a1)] }); _0x9cbfd7[_0x5e5406(0x430)] && typeof _0x9cbfd7[_0x5e5406(0x430)] === 'object' ? _0x128784[_0x5e5406(0x430)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x9cbfd7['preferences'] } : _0x128784['preferences'] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; if (Array[_0x5e5406(0x79f)](_0x9cbfd7[_0x5e5406(0x295)])) _0x128784['chats'] = _0x9cbfd7['chats'], _0x128784[_0x5e5406(0x789)] = _0x9cbfd7[_0x5e5406(0x789)] || null; else Array['isArray'](_0x9cbfd7['characters']) && (console[_0x5e5406(0x331)](_0x5e5406(0x8e9)), _0x128784['chats'] = _0x9cbfd7[_0x5e5406(0x277)][_0x5e5406(0x946)](_0x27847f => ({ 'id': _0x5e5406(0x5e2) + _0x27847f['id'], 'type': 'private', 'participantIds': [_0x27847f['id']] })), _0x9cbfd7[_0x5e5406(0x6a2)] && (_0x128784['activeChatId'] = _0x5e5406(0x5e2) + _0x9cbfd7[_0x5e5406(0x6a2)]), _0x9cbfd7['characters'][_0x5e5406(0x4d0)](_0x4cef0b => { const _0x556d66 = _0x5e5406, _0x1717e5 = 'chatHistory_' + _0x4cef0b['id'], _0x4c0583 = _0x556d66(0x8eb) + _0x4cef0b['id'], _0xf04f3d = localStorage['getItem'](_0x1717e5); _0xf04f3d && (localStorage[_0x556d66(0x548)](_0x4c0583, _0xf04f3d), localStorage[_0x556d66(0x5c5)](_0x1717e5)); })); } catch (_0x5704fd) { if (_0x5e5406(0x95a) === 'zXjyF') { console['error'](_0x5e5406(0x2fb), _0x5704fd), _0x128784[_0x5e5406(0x277)] = [], _0x128784[_0x5e5406(0x295)] = [], _0x128784['activeChatId'] = null; try { if (_0x5e5406(0x761) === _0x5e5406(0x9e2)) { const _0x3a3aa7 = _0x3931d9(_0x2ecc41['id']); if (_0x3a3aa7 && _0x3a3aa7['length'] > 0x0) { const _0x1d6492 = _0x3a3aa7[_0x3a3aa7[_0x5e5406(0x36c)] - 0x1]; (!_0x57cfbd || _0x1d6492[_0x5e5406(0x89b)] > _0x482476[_0x5e5406(0x89b)]) && (_0x4f5310 = _0x1d6492); } } else localStorage['removeItem'](_0x5e5406(0x52b)); } catch (_0x44771a) { console['error'](_0x5e5406(0x34d), _0x44771a); } } else { const _0x341290 = []; if (_0x86de10[_0x5e5406(0x472)]) _0x341290[_0x5e5406(0x1e5)]({ 'text': _0x36cc2c['content'] }); if (_0x1ad3c3[_0x5e5406(0x911)]) { const _0x2c7bf6 = _0x42b21b['image']['split'](',')[0x1], _0x3c7940 = _0x33ea96[_0x5e5406(0x911)][_0x5e5406(0x810)](_0x4429ba[_0x5e5406(0x911)][_0x5e5406(0x439)](':') + 0x1, _0x3eaf50[_0x5e5406(0x911)][_0x5e5406(0x439)](';')) || _0x5e5406(0x414); _0x341290[_0x5e5406(0x1e5)]({ 'inline_data': { 'mime_type': _0x3c7940, 'data': _0x2c7bf6 } }); } return _0x341290; } } let _0x5c913b = ![]; if (_0x128784[_0x5e5406(0x277)][_0x5e5406(0x36c)] === 0x0) { if (_0x5e5406(0x63c) !== _0x5e5406(0x6b4)) _0x5c913b = !![], _0x128784[_0x5e5406(0x789)] = null; else return ''; } else !_0x128784[_0x5e5406(0x295)][_0x5e5406(0x787)](_0x155655 => _0x155655['id'] === _0x128784[_0x5e5406(0x789)]) && (_0x128784[_0x5e5406(0x789)] = _0x128784[_0x5e5406(0x295)][0x0]?.['id'] || null); return _0x5eb81f(), _0x5c913b; } function _0x1313e9() { const _0x48f651 = _0x43c7a1; if (!_0x128784[_0x48f651(0x789)]) return; try { localStorage[_0x48f651(0x548)]('chatHistory_' + _0x128784['activeChatId'], JSON[_0x48f651(0x5e0)](_0x128784[_0x48f651(0x6e7)])); } catch (_0x5110a4) { 'pGBft' !== _0x48f651(0x9e6) ? (_0x1cd256[_0x48f651(0x385)][_0x48f651(0x1cd)] = _0x48f651(0x44e), _0x56e6d3[_0x48f651(0x9c8)] = _0x40ec37[_0x48f651(0x9c8)] = _0x323669[_0x48f651(0x9c8)] = null, _0x398369[_0x48f651(0x6bf)](_0x48f651(0x916), _0x1d01cf), _0x54a44a(_0x4b5209)) : (console[_0x48f651(0x9de)](_0x48f651(0x20b), _0x5110a4), _0x420e01(_0x48f651(0x8ce))); } } function _0x219435() { const _0x49eebd = _0x43c7a1; if (!_0x128784[_0x49eebd(0x789)]) { _0x128784['conversationHistory'] = [], _0x19de4f(); return; } let _0x5429ab = null; try { _0x5429ab = localStorage[_0x49eebd(0x2c6)](_0x49eebd(0x25f) + _0x128784[_0x49eebd(0x789)]); } catch (_0x8d5663) { _0x49eebd(0x56d) !== _0x49eebd(0x5c4) ? console['error'](_0x49eebd(0x7e7) + _0x128784['activeChatId'], _0x8d5663) : _0x14c20f += _0x49eebd(0x587) + _0x57316a['songName'] + '\x20-\x20' + _0x223d8e['artist'] + ']'; } let _0x20dd14 = []; if (_0x5429ab) try { if (_0x49eebd(0x2c4) !== 'aauLJ') { const _0x2027c9 = JSON[_0x49eebd(0x7a8)](_0x5429ab); Array[_0x49eebd(0x79f)](_0x2027c9) && (_0x20dd14 = _0x2027c9['filter'](_0x3b9db5 => _0x3b9db5 && typeof _0x3b9db5 === _0x49eebd(0x581) && typeof _0x3b9db5[_0x49eebd(0x4c9)] === 'string' && typeof _0x3b9db5[_0x49eebd(0x472)] !== 'undefined')); } else { _0x1f83a4 = _0x381b11(_0x1dfe14[_0x49eebd(0x35f)]), _0xb6502f[_0x49eebd(0x711)] = ''; if (_0x3a1672[_0x49eebd(0x36c)] === 0x0) { _0x2350b[_0x49eebd(0x711)] = _0x49eebd(0x8e1); return; } _0x3c778e[_0x49eebd(0x4d0)]((_0x56f7a4, _0x35f6bf) => { const _0x5549e9 = _0x49eebd, _0x59b49d = _0x2e1966[_0x5549e9(0x26b)]('p'); _0x59b49d[_0x5549e9(0x68f)] = _0x56f7a4[_0x5549e9(0x64b)], _0x59b49d['id'] = _0x5549e9(0x30f) + _0x35f6bf, _0x12ea9b[_0x5549e9(0x3d5)](_0x59b49d); }); } } catch (_0x23a63b) { console['error']('Failed\x20to\x20parse\x20history\x20for\x20chat\x20' + _0x128784[_0x49eebd(0x789)] + ',\x20resetting.', _0x23a63b); try { localStorage[_0x49eebd(0x5c5)](_0x49eebd(0x25f) + _0x128784[_0x49eebd(0x789)]); } catch (_0x2b42b3) { console[_0x49eebd(0x9de)](_0x49eebd(0x65d), _0x2b42b3); } } _0x128784[_0x49eebd(0x6e7)] = _0x20dd14, _0x76cec4[_0x49eebd(0x711)] = ''; if (_0x128784['conversationHistory']) { if ('yIvMt' !== _0x49eebd(0x1ad)) { _0x187c42[_0x49eebd(0x711)] = _0x49eebd(0x4c2); return; } else _0x128784['conversationHistory'][_0x49eebd(0x4d0)]((_0x413c72, _0xa69587) => _0x553325(_0x413c72, _0xa69587)); } setTimeout(() => { const _0x1af189 = _0x49eebd; if ('nmzlr' === 'YQqhE') return _0x6627d(_0x102c6f)[_0x1af189(0x745)](_0x441c39 => _0x441c39['blob']()); else _0x76cec4[_0x1af189(0x4d8)] = _0x76cec4[_0x1af189(0x53d)]; }, 0x0); } async function _0x2fddcf() { const _0x1aa7d5 = _0x43c7a1, _0x1378e7 = document['getElementById'](_0x1aa7d5(0x30a)); try { if (_0x1aa7d5(0x5ac) === _0x1aa7d5(0x666)) { const _0x216fbc = new _0xcd52cb(), _0x39eb43 = _0x2f65d1[_0x1aa7d5(0x655)](_0x1aa7d5(0x993)), _0x28107b = _0x2185e5[_0x1aa7d5(0x655)](_0x1aa7d5(0x7bc)); if (_0x39eb43 && _0x28107b) { const _0x2b17fe = _0x9b6b67(_0x216fbc[_0x1aa7d5(0x838)]())[_0x1aa7d5(0x7d2)](0x2, '0'), _0x240173 = _0x5763c8(_0x216fbc[_0x1aa7d5(0x746)]())[_0x1aa7d5(0x7d2)](0x2, '0'); _0x39eb43[_0x1aa7d5(0x68f)] = _0x2b17fe + ':' + _0x240173; const _0x15192d = _0x216fbc['getMonth']() + 0x1, _0x24cbef = _0x216fbc[_0x1aa7d5(0x731)](), _0x185b7d = [_0x1aa7d5(0x2b7), _0x1aa7d5(0x3b2), _0x1aa7d5(0x372), _0x1aa7d5(0x46b), '星期四', _0x1aa7d5(0x47b), _0x1aa7d5(0x6e0)][_0x216fbc[_0x1aa7d5(0x4b5)]()]; _0x28107b[_0x1aa7d5(0x68f)] = _0x15192d + '月' + _0x24cbef + '日\x20' + _0x185b7d; } } else { let _0x4281b9 = await _0x226e0a(_0x1aa7d5(0x1f2)); if (!_0x4281b9) { const _0x5dec6d = localStorage[_0x1aa7d5(0x2c6)]('customWallpaper'); if (_0x5dec6d) { if ('EPBPd' === 'EPBPd') console['log'](_0x1aa7d5(0x207)), _0x4281b9 = await _0x454232(_0x5dec6d), await _0x36c0a8('wallpaper_main', _0x4281b9), localStorage[_0x1aa7d5(0x5c5)]('customWallpaper'); else { const _0x2b130f = _0x4a8e02[_0x1aa7d5(0x26b)](_0x1aa7d5(0x76e)); _0x2b130f[_0x1aa7d5(0x1f0)] = _0x1aa7d5(0x1a7), _0x2b130f[_0x1aa7d5(0x711)] = '<span\x20class=\x22description\x22>' + _0x1f4f2[_0x1aa7d5(0x78a)] + _0x1aa7d5(0x27d) + _0x195dab[_0x1aa7d5(0x9d3)][_0x1aa7d5(0x8bd)](0x2) + _0x1aa7d5(0x583) + _0x1e750d['id'] + _0x1aa7d5(0x922), _0x11567b[_0x1aa7d5(0x3d5)](_0x2b130f); } } } if (_0x4281b9) { if ('gwIIu' === 'BpWZX') { const _0x4b295a = _0x1540d2[_0x1aa7d5(0x4a5)]['find'](_0x2b61e6 => _0x2b61e6['id'] === _0x6a3a6c[_0x1aa7d5(0x226)]) || { 'name': '你' }, _0x283455 = _0x474318[_0x1aa7d5(0x401)][_0x1aa7d5(0x787)](_0x1e92d2 => _0x1e92d2[_0x1aa7d5(0x267)] === _0x301042); if (!_0x283455 || !_0x283455[_0x1aa7d5(0x8b0)] || _0x283455[_0x1aa7d5(0x8b0)][_0x1aa7d5(0x36c)] === 0x0) return ''; const _0x3da957 = _0x283455[_0x1aa7d5(0x8b0)]['slice'](-0x8), _0x1d834d = _0x3da957[_0x1aa7d5(0x946)](_0x55f419 => { const _0x37b13b = _0x1aa7d5, _0x268bcd = _0x55f419[_0x37b13b(0x38a)] === _0x37b13b(0x500) ? _0x4b295a['name'] : _0xd975ec(_0x55f419['author'])[_0x37b13b(0x4da)]; return '-\x20[' + new _0x3c702e(_0x55f419['timestamp'])[_0x37b13b(0x263)]() + ']\x20' + _0x268bcd + _0x37b13b(0x971) + _0x55f419[_0x37b13b(0x472)]; })[_0x1aa7d5(0x9cc)]('\x0a'); return _0x1aa7d5(0x994) + _0x4b295a['name'] + _0x1aa7d5(0x388) + _0x1d834d; } else _0x1378e7[_0x1aa7d5(0x385)][_0x1aa7d5(0x2ca)] = _0x1aa7d5(0x21b) + URL[_0x1aa7d5(0x9be)](_0x4281b9) + ')', _0x1378e7[_0x1aa7d5(0x385)][_0x1aa7d5(0x6ed)] = _0x1aa7d5(0x678), _0x1378e7['style'][_0x1aa7d5(0x543)] = 'center'; } else _0x1378e7[_0x1aa7d5(0x385)][_0x1aa7d5(0x2ca)] = ''; } } catch (_0x54c165) { _0x1aa7d5(0x8e0) !== _0x1aa7d5(0x2ea) ? (console[_0x1aa7d5(0x9de)](_0x1aa7d5(0x986), _0x54c165), phoneContainer[_0x1aa7d5(0x385)][_0x1aa7d5(0x2ca)] = '') : _0x2ce310(_0x1aa7d5(0x36a) + _0x5613c9[_0x1aa7d5(0x740)]); } } function _0x5a16de() { const _0x71ff8a = _0x43c7a1; if (_0x71ff8a(0x5db) !== 'UUOXG') _0x27442e['error'](_0x71ff8a(0x34d), _0x45dd47); else { const _0x283c11 = localStorage[_0x71ff8a(0x2c6)](_0x71ff8a(0x375)); _0x283c11 ? _0x71ff8a(0x87c) !== _0x71ff8a(0x87c) ? _0x16bd1a !== _0x4c5f74[_0x71ff8a(0x9ad)](_0x71ff8a(0x61a)) && (_0x13bd77['textContent'] = '▶') : document[_0x71ff8a(0x655)](_0x71ff8a(0x923))[_0x71ff8a(0x385)][_0x71ff8a(0x6ac)]('--feed-bg-image', 'url(' + _0x283c11 + ')') : document[_0x71ff8a(0x655)](_0x71ff8a(0x923))[_0x71ff8a(0x385)][_0x71ff8a(0x6ac)](_0x71ff8a(0x377), _0x71ff8a(0x44e)); } } async function _0x1cbda5(_0x595619) { const _0x3d23e3 = _0x43c7a1; if (_0x3d23e3(0x879) === _0x3d23e3(0x596)) _0x41091b(![]); else try { await _0x36c0a8(_0x3d23e3(0x1f2), _0x595619), await _0x2fddcf(), _0x420e01(_0x3d23e3(0x930)); } catch (_0x4c18c0) { console[_0x3d23e3(0x9de)](_0x3d23e3(0x844), _0x4c18c0), _0x420e01('保存壁纸失败:\x20' + _0x4c18c0[_0x3d23e3(0x740)]); } } function _0x26a581(_0x334777) { const _0x4060df = _0x43c7a1; if (_0x4060df(0x4a8) !== _0x4060df(0x66c)) { const _0x57b737 = { 'quotedMessage': null, 'content': _0x334777 }, _0x335306 = _0x334777[_0x4060df(0x256)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x335306 && (_0x57b737[_0x4060df(0x6dd)] = { 'sender': _0x335306[0x1][_0x4060df(0x6df)](), 'content': _0x335306[0x2][_0x4060df(0x6df)]() }, _0x57b737[_0x4060df(0x472)] = _0x334777['substring'](_0x335306[0x0][_0x4060df(0x36c)])['trim']()), _0x57b737; } else _0x3a4218[_0x4060df(0x7d8)](_0x25fc60, { 'songName': _0x380a4e, 'artist': _0x4e0fd1, 'coverId': null, 'playableUrl': null }); } const _0x218e77 = document[_0x43c7a1(0x655)](_0x43c7a1(0x8aa)), _0x1a0615 = document[_0x43c7a1(0x655)]('message-action-backdrop'), _0x47fce6 = document['getElementById'](_0x43c7a1(0x5cd)), _0x5c196d = document['getElementById'](_0x43c7a1(0x622)), _0x3f8bb6 = document['getElementById']('cancel-action-button'), _0x55eff9 = document['getElementById']('quote-message-button'), _0x213371 = document[_0x43c7a1(0x655)](_0x43c7a1(0x9a0)), _0x2e322a = document[_0x43c7a1(0x655)](_0x43c7a1(0x60e)), _0x23e1f5 = document[_0x43c7a1(0x655)](_0x43c7a1(0x2ab)), _0x52cfed = document[_0x43c7a1(0x655)](_0x43c7a1(0x8d4)), _0x30c7e5 = document[_0x43c7a1(0x655)](_0x43c7a1(0x3a8)); let _0x5ab8aa = null; function _0xe6bdf3(_0x54ffa0) { const _0x3d845b = _0x43c7a1; _0x3d845b(0x4f3) !== 'FFVfm' ? (_0x5ab8aa = _0x54ffa0, _0x218e77[_0x3d845b(0x421)][_0x3d845b(0x266)](_0x3d845b(0x8d5))) : (_0x2a43bf = _0x3e373d[_0x3d845b(0x26b)]('div'), _0x41297d[_0x3d845b(0x1f0)] = _0x3d845b(0x656), _0x4b6118[_0x3d845b(0x68f)] = _0x3d845b(0x3c4), _0x1db414[_0x3d845b(0x385)][_0x3d845b(0x3f4)] = 'rgba(0,\x200,\x200,\x200.4)', _0xe18b68[_0x3d845b(0x385)]['padding'] = '15px\x2020px', _0x5680ae[_0x3d845b(0x385)][_0x3d845b(0x1e1)] = '8px', _0xc3ff03[_0x3d845b(0x3d5)](_0x206569)); } function _0x52e42c() { const _0x2a5aab = _0x43c7a1; _0x218e77[_0x2a5aab(0x421)][_0x2a5aab(0x66f)](_0x2a5aab(0x8d5)); } function _0x504a4d() { _0x52e42c(), _0x5ab8aa = null; } function _0x58b419() { const _0x156650 = _0x43c7a1; if (_0x156650(0x2e4) === _0x156650(0x2b5)) _0x569048('chat', _0x156650(0x454)); else { if (_0x5ab8aa === null) return; _0x128784[_0x156650(0x6e7)]['splice'](_0x5ab8aa, 0x1), _0x1313e9(), _0x327245(), _0x504a4d(); } } function _0x3990b3() { const _0x14bcbe = _0x43c7a1; if (_0x5ab8aa === null) return; const _0x3b8f90 = _0x128784[_0x14bcbe(0x6e7)][_0x5ab8aa]; if (!_0x3b8f90) return; _0x23e1f5[_0x14bcbe(0x9bf)] = _0x3b8f90[_0x14bcbe(0x472)], _0x52e42c(), _0x213371[_0x14bcbe(0x421)][_0x14bcbe(0x266)](_0x14bcbe(0x8d5)), _0x23e1f5[_0x14bcbe(0x76c)](); } function _0x628805() { const _0x44c147 = _0x43c7a1; if (_0x5ab8aa === null) return; const _0x47c177 = _0x23e1f5[_0x44c147(0x9bf)][_0x44c147(0x6df)](); if (_0x47c177 === '') { if (_0x44c147(0x604) !== _0x44c147(0x604)) _0x100a78['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>' + _0xd42fba + _0x44c147(0x6c3) + _0x3eeadf + _0x44c147(0x96d) + _0x43bf6e[_0x44c147(0x1d2)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x4437e0[_0x44c147(0x2aa)] + _0x44c147(0x47d) + _0x26884d['songId'] + '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>'; else { _0x5de2f6(); return; } } const _0x5c3185 = _0x128784[_0x44c147(0x6e7)][_0x5ab8aa]; _0x5c3185 && (_0x5c3185['content'] = _0x47c177, _0x1313e9(), _0x327245()), _0x213371['classList']['remove'](_0x44c147(0x8d5)), _0x5ab8aa = null; } function _0x5de2f6() { const _0x295a79 = _0x43c7a1; if (_0x295a79(0x474) === 'KUEtS') _0x213371[_0x295a79(0x421)][_0x295a79(0x66f)](_0x295a79(0x8d5)), _0x5ab8aa = null; else { const _0x1e0608 = _0x4b3162['getElementById'](_0x295a79(0x63f)); if (!_0x1e0608) return; const _0x511487 = _0x55a968['getItem'](_0x295a79(0x6dc)) || '80'; _0x40b465[_0x295a79(0x348)][_0x295a79(0x385)][_0x295a79(0x6ac)](_0x295a79(0x5e5), _0x511487 + '%'), _0x1e0608['value'] = _0x511487, _0x1e0608[_0x295a79(0x203)](_0x295a79(0x2cb), () => { const _0x1c9778 = _0x295a79, _0x41933b = _0x1e0608[_0x1c9778(0x9bf)]; _0x4d93ba[_0x1c9778(0x348)][_0x1c9778(0x385)]['setProperty'](_0x1c9778(0x5e5), _0x41933b + '%'), _0x27a6c2['setItem'](_0x1c9778(0x6dc), _0x41933b), _0x84bb80(); }); } } _0x1a0615[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x504a4d), _0x3f8bb6['addEventListener']('click', _0x504a4d), _0x5c196d[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x58b419), _0x47fce6['addEventListener'](_0x43c7a1(0x783), _0x3990b3), _0x55eff9[_0x43c7a1(0x203)]('click', _0x15c046), _0x529df5[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x272900), _0x52cfed[_0x43c7a1(0x203)]('click', _0x628805), _0x30c7e5[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x5de2f6), _0x2e322a['addEventListener'](_0x43c7a1(0x783), _0x5de2f6); function _0x15c046() { const _0x341ca0 = _0x43c7a1; if (_0x5ab8aa === null) return; const _0x107b29 = _0x128784[_0x341ca0(0x6e7)][_0x5ab8aa]; if (!_0x107b29) return; const _0x572f53 = _0x401cc7(); let _0x3e86c9 = '未知'; if (_0x107b29['role'] === _0x341ca0(0x500)) { if ('bPpht' === _0x341ca0(0x693)) _0x3e86c9 = _0x128784[_0x341ca0(0x50a)][_0x341ca0(0x4da)] || '我'; else { if (_0x1d98fa[_0x341ca0(0x363)]) _0x3bfb88(_0x20217d['diaryPressTimer']); } } else { if (_0x341ca0(0x35c) === _0x341ca0(0x24a)) _0x54c865[_0x341ca0(0x1e5)]('[' + _0x2e0e4c + _0x341ca0(0x7dd) + _0x44c4aa(_0x59e1c3) + ']\x20' + _0x4763c7(_0x39a451[_0x341ca0(0x472)])[_0x341ca0(0x6df)]()); else { const _0x1140cd = _0x107b29[_0x341ca0(0x67b)] || _0x572f53?.[_0x341ca0(0x4de)][0x0], _0x38fad8 = _0x8351ef(_0x1140cd); _0x3e86c9 = _0x38fad8 ? _0x38fad8[_0x341ca0(0x4da)] : '角色'; } } let _0x1aecf7 = _0x107b29[_0x341ca0(0x472)] || ''; if (_0x107b29[_0x341ca0(0x57c)]) _0x1aecf7 = '[表情]'; if (_0x107b29[_0x341ca0(0x911)]) _0x1aecf7 = _0x341ca0(0x279); if (_0x1aecf7['length'] > 0x32) _0x1aecf7 = _0x1aecf7[_0x341ca0(0x810)](0x0, 0x32) + _0x341ca0(0x8a5); _0x128784['activeQuote'] = { 'sender': _0x3e86c9, 'content': _0x1aecf7 }, _0x51ee05(), _0x504a4d(), _0xe97d72[_0x341ca0(0x76c)](); } function _0x51ee05() { const _0x61e857 = _0x43c7a1; if (!_0x128784[_0x61e857(0x729)]) return; _0x5791d6['textContent'] = _0x61e857(0x661) + _0x128784[_0x61e857(0x729)][_0x61e857(0x6d5)], _0x4634ed[_0x61e857(0x68f)] = _0x128784[_0x61e857(0x729)][_0x61e857(0x472)], _0x26d8b4[_0x61e857(0x385)]['display'] = _0x61e857(0x3d3); } function _0x272900() { const _0x91e803 = _0x43c7a1; _0x128784[_0x91e803(0x729)] = null, _0x26d8b4[_0x91e803(0x385)][_0x91e803(0x1cd)] = _0x91e803(0x44e); } function _0xcf54be(_0x8cad44, _0x534419) { const _0x4335fc = _0x43c7a1, _0x86b57e = document[_0x4335fc(0x655)](_0x4335fc(0x99e)); _0x86b57e && (_0x8cad44 === _0x4335fc(0x7e1) ? _0x86b57e[_0x4335fc(0x385)]['display'] = _0x4335fc(0x80c) : _0x4335fc(0x276) === _0x4335fc(0x1e3) ? _0x37a009 = [..._0x2b5697, ..._0x591e03] : _0x86b57e[_0x4335fc(0x385)][_0x4335fc(0x1cd)] = _0x4335fc(0x44e)), _0x1dfb8c = _0x534419 || null, Object[_0x4335fc(0x799)](_0x1bca98)[_0x4335fc(0x4d0)](_0x35429f => _0x35429f[_0x4335fc(0x421)][_0x4335fc(0x66f)](_0x4335fc(0x576))), _0x1bca98[_0x8cad44] && _0x1bca98[_0x8cad44][_0x4335fc(0x421)][_0x4335fc(0x266)]('active'), _0x8cad44 !== _0x4335fc(0x866) && _0x35676c[_0x4335fc(0x421)][_0x4335fc(0x66f)](_0x4335fc(0x26c)); } function _0x4d44ee(_0x49137e) { const _0x3e8905 = _0x43c7a1; if (_0x49137e) { if ('ZhJKw' === _0x3e8905(0x80a)) _0x35676c[_0x3e8905(0x421)][_0x3e8905(0x266)](_0x3e8905(0x26c)); else { let _0x474fd5 = _0x234691[_0x3e8905(0x655)]('style-' + _0xaed375['id']); !_0x474fd5 && (_0x474fd5 = _0x1b2111[_0x3e8905(0x26b)]('style'), _0x474fd5['id'] = _0x3e8905(0x69e) + _0x54d3a7['id'], _0x186780[_0x3e8905(0x3f9)][_0x3e8905(0x3d5)](_0x474fd5)); const _0x48fa13 = _0x177304[_0x3e8905(0x7c3)], _0x10fecb = _0x48fa13[_0x3e8905(0x55b)](/\.bubble\.sent/g, _0x3e8905(0x990) + _0x7bdaa2['id'] + _0x3e8905(0x471))['replace'](/\.bubble\.received/g, _0x3e8905(0x990) + _0x197fed['id'] + '.message.ai'); _0x474fd5['innerHTML'] = _0x10fecb; } } else _0x3e8905(0x479) !== _0x3e8905(0x93d) ? _0x35676c[_0x3e8905(0x421)][_0x3e8905(0x66f)](_0x3e8905(0x26c)) : _0x452c95[_0x3e8905(0x68f)] = _0x49b0d2[_0x3e8905(0x82f)](_0x3f4828)[_0x3e8905(0x946)](_0x315a9a => _0x315a9a[_0x3e8905(0x1de)]['textContent'][_0x3e8905(0x6df)]())['join']('、'); } async function _0x151457() { const _0x587897 = _0x43c7a1; _0x415cde[_0x587897(0x711)] = ''; for (const _0x61a7b2 of _0x128784[_0x587897(0x295)]) { const _0x3dff1e = document[_0x587897(0x26b)]('li'); _0x3dff1e[_0x587897(0x1f0)] = 'character-item', _0x3dff1e['dataset']['id'] = _0x61a7b2['id']; let _0x2a623f = _0x3834ec, _0x5b00d1 = '群聊', _0x56664c = ''; if (_0x61a7b2[_0x587897(0x3b1)] === _0x587897(0x921)) { const _0x49db75 = _0x8351ef(_0x61a7b2['participantIds'][0x0]); if (_0x49db75) 'SYVyR' !== 'SYVyR' ? _0x2e93f1 = _0x182640[_0x587897(0x4a5)]['find'](_0x16a6ad => _0x16a6ad['id'] === _0x4b3b02[_0x587897(0x226)]) || _0x3502b8[_0x587897(0x4a5)][0x0] : (_0x2a623f = _0x49db75[_0x587897(0x4b6)] || _0x3834ec, _0x5b00d1 = _0x49db75['name'] || _0x587897(0x17d), _0x56664c = _0x49db75[_0x587897(0x540)] || '私聊'); else { if (_0x587897(0x59d) === 'HoVYW') _0x5b00d1 = _0x587897(0x4db), _0x56664c = _0x587897(0x594); else { const _0x2d6567 = _0xbd196f['createElement'](_0x587897(0x76e)); _0x2d6567['className'] = _0x587897(0x223), _0x2d6567[_0x587897(0x711)] = _0x149599, _0x4712f3 === _0x587897(0x500) ? (_0x21413a['appendChild'](_0x2d6567), _0x4e3872[_0x587897(0x3d5)](_0xc6c4a8)) : (_0x1190a0['appendChild'](_0x3d8099), _0x3cdbc4[_0x587897(0x3d5)](_0x2d6567)); } } } else { _0x5b00d1 = _0x61a7b2[_0x587897(0x4da)] || '未命名群聊', _0x56664c = _0x61a7b2['participantIds']['length'] + _0x587897(0x17e); const _0x135bd3 = await _0x226e0a(_0x587897(0x514) + _0x61a7b2['id']); if (_0x135bd3) _0x2a623f = URL[_0x587897(0x9be)](_0x135bd3); } _0x3dff1e[_0x587897(0x711)] = _0x587897(0x786) + _0x2a623f + _0x587897(0x381) + _0x5b00d1 + _0x587897(0x8fa) + _0x56664c + _0x587897(0x17c), _0x3dff1e[_0x587897(0x9ad)](_0x587897(0x4f6))[_0x587897(0x203)](_0x587897(0x783), () => { const _0x2b0ea4 = _0x587897; _0x2b0ea4(0x399) !== 'YRovZ' ? (_0x1e5a3e(_0x61a7b2['id']), _0x4d44ee(!![])) : _0x25b2c1(_0x102245[_0x2b0ea4(0x4de)][0x0]); }), _0x415cde['appendChild'](_0x3dff1e); } } function _0x353bb5() { const _0x4adc36 = _0x43c7a1; if ('DIJnP' !== 'AXfoZ') { const _0xa77909 = document[_0x4adc36(0x655)](_0x4adc36(0x750)); _0xa77909[_0x4adc36(0x711)] = ''; const _0x96561c = _0x128784['characters']['filter'](_0x230c7c => _0x128784[_0x4adc36(0x295)][_0x4adc36(0x383)](_0x3542fc => _0x3542fc[_0x4adc36(0x3b1)] === _0x4adc36(0x921) && _0x3542fc[_0x4adc36(0x4de)][_0x4adc36(0x9ac)](_0x230c7c['id']))); if (_0x96561c['length'] === 0x0) { if ('slloA' !== _0x4adc36(0x681)) { _0xa77909[_0x4adc36(0x711)] = _0x4adc36(0x98e); return; } else _0x4cffb7[_0x4adc36(0x203)](_0x4adc36(0x783), () => _0x1c8cff['click']()), _0x3692e4[_0x4adc36(0x203)]('change', async _0x3a878e => { const _0x6b0536 = _0x4adc36, _0x2e978f = _0x3a878e[_0x6b0536(0x949)][_0x6b0536(0x275)][0x0]; if (!_0x2e978f) return; try { _0x4f2a75[_0x6b0536(0x84a)] = _0x125dc0['createObjectURL'](_0x2e978f); } catch (_0x527f2b) { _0x591f7a(_0x6b0536(0x7ac) + _0x527f2b[_0x6b0536(0x740)]); } }); } _0x96561c[_0x4adc36(0x4d0)](_0x2232e5 => { const _0x3c8c4c = _0x4adc36, _0x21f867 = document[_0x3c8c4c(0x26b)]('li'); _0x21f867[_0x3c8c4c(0x1f0)] = 'character-item', _0x21f867[_0x3c8c4c(0x663)][_0x3c8c4c(0x1e7)] = _0x2232e5['id'], _0x21f867[_0x3c8c4c(0x711)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x2232e5['avatar'] || _0x3834ec) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x2232e5['name'] + _0x3c8c4c(0x7ef) + (_0x2232e5[_0x3c8c4c(0x540)] || '私聊') + _0x3c8c4c(0x69b), _0x21f867[_0x3c8c4c(0x203)](_0x3c8c4c(0x783), () => { _0x59581b(_0x2232e5['id']); }), _0xa77909['appendChild'](_0x21f867); }); } else _0x396cc3[_0x4adc36(0x1f0)] = _0x4adc36(0x71b), _0x4486cf[_0x4adc36(0x385)][_0x4adc36(0x25a)] = _0x4adc36(0x998), _0x3f92f8['style'][_0x4adc36(0x1cf)] = _0x4adc36(0x77a), _0x2797fb[_0x4adc36(0x711)] = _0x527322; } async function _0x59581b(_0x1d50e5) { const _0x4c36ee = _0x43c7a1, _0x32f48a = _0x8351ef(_0x1d50e5); if (!_0x32f48a) return; document[_0x4c36ee(0x655)](_0x4c36ee(0x240))['src'] = '', _0x128784[_0x4c36ee(0x50e)] = _0x1d50e5; const _0x377df3 = _0x128784['chats']['find'](_0x41f5a8 => _0x41f5a8['type'] === _0x4c36ee(0x921) && _0x41f5a8[_0x4c36ee(0x4de)][_0x4c36ee(0x9ac)](_0x1d50e5)); _0x377df3 ? (_0x128784[_0x4c36ee(0x789)] = _0x377df3['id'], _0x5eb81f(), _0x219435(), _0x2fd3ae(_0x1d50e5)) : 'sTcLr' !== _0x4c36ee(0x5de) ? (_0x51ac70[_0x4c36ee(0x385)][_0x4c36ee(0x1cf)] = _0x4c36ee(0x356), _0x196b38['style']['textShadow'] = '0\x202px\x208px\x20rgba(0,0,0,0.4)') : _0x128784['conversationHistory'] = []; document[_0x4c36ee(0x655)](_0x4c36ee(0x8d7))[_0x4c36ee(0x68f)] = _0x32f48a[_0x4c36ee(0x4da)]; const _0x52e032 = document['getElementById'](_0x4c36ee(0x8b9)); try { const _0x57465e = await _0x226e0a(_0x4c36ee(0x524) + _0x1d50e5); _0x57465e ? (_0x52e032[_0x4c36ee(0x385)]['backgroundImage'] = _0x4c36ee(0x5cf) + URL[_0x4c36ee(0x9be)](_0x57465e) + '\x27)', _0x52e032[_0x4c36ee(0x385)][_0x4c36ee(0x6ed)] = 'cover', _0x52e032[_0x4c36ee(0x385)][_0x4c36ee(0x543)] = _0x4c36ee(0x4cf)) : _0x52e032[_0x4c36ee(0x385)][_0x4c36ee(0x2ca)] = _0x4c36ee(0x44e); } catch (_0x287f45) { console[_0x4c36ee(0x9de)](_0x4c36ee(0x197) + _0x1d50e5 + ':', _0x287f45), _0x52e032[_0x4c36ee(0x385)]['backgroundImage'] = _0x4c36ee(0x44e); } _0x3401d9(), _0x398f6e(); if (_0x378245) clearInterval(_0x378245); _0x4aee70(), _0x378245 = setInterval(_0x4aee70, 0x2710), document[_0x4c36ee(0x655)](_0x4c36ee(0x2fc))['style'][_0x4c36ee(0x1cd)] = _0x4c36ee(0x3d3), _0xcf54be('meetingView', _0x4c36ee(0x396)); } function _0x398f6e() { const _0x513da5 = _0x43c7a1, _0x4deeb5 = document['getElementById'](_0x513da5(0x9cb)); _0x4deeb5['innerHTML'] = ''; const _0x3e6879 = _0x4deeb5[_0x513da5(0x9ad)](_0x513da5(0x365)); if (_0x3e6879) _0x3e6879['remove'](); _0x128784[_0x513da5(0x6e7)] && _0x128784[_0x513da5(0x6e7)][_0x513da5(0x4d0)]((_0x1ba95e, _0x305609) => { const _0x4b7249 = _0x513da5; if (_0x4b7249(0x299) === _0x4b7249(0x299)) { if (!_0x1ba95e[_0x4b7249(0x894)] || _0x1ba95e[_0x4b7249(0x4c9)] === 'system') return; const _0x464ad7 = document[_0x4b7249(0x26b)]('p'); _0x464ad7['dataset']['historyIndex'] = _0x305609; const _0x47b6d9 = _0x1ba95e['content']['replace'](/\n/g, '<br>'); let _0x540baf = '', _0x40cc37 = ''; const _0x3062bb = _0x10af56(_0x128784[_0x4b7249(0x789)]); if (_0x1ba95e[_0x4b7249(0x4c9)] === _0x4b7249(0x500)) _0x4b7249(0x94e) !== _0x4b7249(0x94e) ? (_0x2510bd[_0x4b7249(0x9de)](_0x4b7249(0x446), _0x12c9b0), _0x5cc393('导出失败了，哼:\x20' + _0x27b39b['message'])) : (_0x540baf = _0x3062bb[_0x4b7249(0x4da)] || '我', _0x40cc37 = _0x4b7249(0x441)); else { if (_0x1ba95e[_0x4b7249(0x4c9)] === _0x4b7249(0x600)) { const _0xdd1f02 = _0x8351ef(_0x1ba95e[_0x4b7249(0x67b)] || _0x128784['activeMeetingCharId']); _0x540baf = _0xdd1f02?.[_0x4b7249(0x4da)] || '角色', _0x40cc37 = _0x4b7249(0x8db); } } _0x464ad7[_0x4b7249(0x385)]['backgroundColor'] = _0x4b7249(0x96a), _0x464ad7[_0x4b7249(0x385)][_0x4b7249(0x609)] = _0x4b7249(0x1d4), _0x464ad7[_0x4b7249(0x385)]['borderRadius'] = _0x4b7249(0x498), _0x464ad7[_0x4b7249(0x385)][_0x4b7249(0x598)] = _0x4b7249(0x24c), _0x540baf ? _0x464ad7[_0x4b7249(0x711)] = _0x4b7249(0x2f2) + _0x40cc37 + _0x4b7249(0x3f0) + (_0x40cc37 === _0x4b7249(0x441) ? _0x4b7249(0x864) : '#f2b7c6') + ';\x22>' + _0x540baf + ':</span>\x20' + _0x47b6d9 : _0x4b7249(0x227) === _0x4b7249(0x227) ? (_0x464ad7['className'] = _0x4b7249(0x71b), _0x464ad7[_0x4b7249(0x385)][_0x4b7249(0x25a)] = 'italic', _0x464ad7[_0x4b7249(0x385)][_0x4b7249(0x1cf)] = '#d1d5db', _0x464ad7[_0x4b7249(0x711)] = _0x47b6d9) : _0x37dcfd('包含所有图片和音乐的全量数据已成功导出！'), _0x4deeb5[_0x4b7249(0x3d5)](_0x464ad7); } else { const _0x2bfc52 = _0x25617d[_0x4b7249(0x90c)](_0x436a61, 0x2); _0x2bfc52[_0x4b7249(0x9a7)] = () => _0x699868(_0x4b7249(0x1a1)), _0x2bfc52[_0x4b7249(0x265)] = () => _0x596547(_0x2bfc52[_0x4b7249(0x5a7)]), _0x2bfc52[_0x4b7249(0x42e)] = _0x3713a5 => { const _0x23382f = _0x4b7249, _0x41043d = _0x3713a5[_0x23382f(0x949)]['result']; !_0x41043d[_0x23382f(0x8b1)][_0x23382f(0x878)](_0x115b22) && _0x41043d[_0x23382f(0x7b6)](_0x92bf82, { 'keyPath': 'id' }); const _0x59cea2 = _0x23382f(0x428); !_0x41043d[_0x23382f(0x8b1)]['contains'](_0x59cea2) && _0x41043d[_0x23382f(0x7b6)](_0x59cea2, { 'keyPath': 'id' }); }; } }); if (_0x128784['isGenerating']) { if (_0x513da5(0x4fb) !== _0x513da5(0x4fb)) _0x9342c9[_0x513da5(0x9de)](_0x513da5(0x610), _0x3b9a79); else { let _0x185304 = _0x4deeb5['querySelector'](_0x513da5(0x58e)); !_0x185304 && (_0x185304 = document[_0x513da5(0x26b)](_0x513da5(0x76e)), _0x185304['className'] = _0x513da5(0x656), _0x185304[_0x513da5(0x68f)] = _0x513da5(0x3c4), _0x185304['style']['backgroundColor'] = _0x513da5(0x96a), _0x185304[_0x513da5(0x385)][_0x513da5(0x609)] = _0x513da5(0x1d4), _0x185304['style'][_0x513da5(0x1e1)] = '8px', _0x4deeb5[_0x513da5(0x3d5)](_0x185304)); } } const _0x5d29d5 = document['createElement'](_0x513da5(0x76e)); _0x5d29d5['id'] = _0x513da5(0x66b), _0x4deeb5[_0x513da5(0x3d5)](_0x5d29d5), setTimeout(() => { const _0x2c75ad = _0x513da5; _0x5d29d5[_0x2c75ad(0x478)]({ 'behavior': _0x2c75ad(0x18d), 'block': _0x2c75ad(0x692) }); }, 0x32); } function _0x327245() { const _0x576c6f = _0x43c7a1; if ('wQPNJ' !== 'hYuly') { const _0x96b3e1 = document['querySelector'](_0x576c6f(0x8e6)); if (!_0x96b3e1) return; _0x96b3e1['id'] === 'meeting-view-screen' ? _0x398f6e() : _0x576c6f(0x2f7) !== 'bmDVu' ? (_0x452880['classList']['remove']('visible'), _0x505eb0[_0x576c6f(0x421)]['remove'](_0x576c6f(0x484))) : _0x19de4f(); } else _0x1fdcd4[_0x576c6f(0x226)] = _0x477ab2['id']; } function _0x19de4f() { const _0x1546b7 = _0x43c7a1; if (_0x1546b7(0x61e) !== _0x1546b7(0x6ca)) { const _0x188396 = _0x128784[_0x1546b7(0x6e7)][_0x1546b7(0x89c)](_0x36882c => !_0x36882c[_0x1546b7(0x894)] && _0x36882c[_0x1546b7(0x4c9)] !== 'system'); if (_0x188396[_0x1546b7(0x36c)] > _0x128784['displayedMessageCount']) { if (_0x1546b7(0x5a6) === _0x1546b7(0x1d9)) { const _0x5e76b1 = _0x35abe0[_0x1546b7(0x9ad)]('.screen.active'); if (!_0x5e76b1) return; _0x5e76b1['id'] === _0x1546b7(0x66e) ? _0x3aa6f8() : _0x5bd20f(); } else { let _0x169bd9 = _0x76cec4['querySelector'](_0x1546b7(0x3e0)); !_0x169bd9 && (_0x1546b7(0x7b7) !== _0x1546b7(0x7b7) ? (_0x465832['value'] = _0xcaa750[_0x1546b7(0x8a1)][_0x1546b7(0x7cd)] || '', _0x2eb33f[_0x1546b7(0x9bf)] = _0x1a873f[_0x1546b7(0x8a1)][_0x1546b7(0x956)] || '', _0x3ccd71[_0x1546b7(0x9bf)] = _0x3fbdef[_0x1546b7(0x8a1)][_0x1546b7(0x4a9)] || '', _0x3f4b1b['value'] = _0x33319c(_0x2bb465['preferences']?.[_0x1546b7(0x3cc)] ?? 0x64), _0x36bb87[_0x1546b7(0x655)]('api-provider')[_0x1546b7(0x9bf)] = _0xe86b7e[_0x1546b7(0x8a1)][_0x1546b7(0x1b8)] || _0x1546b7(0x350)) : (_0x169bd9 = document['createElement'](_0x1546b7(0x264)), _0x169bd9[_0x1546b7(0x68f)] = _0x1546b7(0x6b7), _0x169bd9[_0x1546b7(0x1f0)] = _0x1546b7(0x4cd), _0x169bd9[_0x1546b7(0x385)]['width'] = _0x1546b7(0x18d), _0x169bd9[_0x1546b7(0x385)][_0x1546b7(0x77b)] = _0x1546b7(0x482), _0x169bd9[_0x1546b7(0x385)][_0x1546b7(0x609)] = '8px\x2016px', _0x169bd9['onclick'] = () => { const _0xcc83aa = _0x1546b7, _0x42b250 = _0x76cec4, _0x2d205a = _0x42b250['scrollHeight'], _0x2a8bf2 = _0x42b250[_0xcc83aa(0x4d8)]; _0x128784[_0xcc83aa(0x1d1)] += 0x64, _0x19de4f(), requestAnimationFrame(() => { const _0x112a3d = _0xcc83aa, _0x2e33fb = _0x42b250['scrollHeight']; _0x42b250[_0x112a3d(0x4d8)] = _0x2a8bf2 + (_0x2e33fb - _0x2d205a); }); }, _0x76cec4[_0x1546b7(0x35e)] ? 'nLDwD' !== _0x1546b7(0x435) ? _0x76cec4[_0x1546b7(0x52d)](_0x169bd9, _0x76cec4['firstChild']) : _0x2c0938[_0x1546b7(0x9de)]('Error\x20fetching\x20from\x20' + _0x76ebce + ':', _0x5ed68d) : _0x1546b7(0x942) !== _0x1546b7(0x334) ? _0x76cec4[_0x1546b7(0x3d5)](_0x169bd9) : _0x26c397['getElementById'](_0x1546b7(0x923))[_0x1546b7(0x385)][_0x1546b7(0x6ac)](_0x1546b7(0x377), 'none'))); } } else { const _0x4210e2 = _0x76cec4['querySelector'](_0x1546b7(0x3e0)); if (_0x4210e2) _0x4210e2[_0x1546b7(0x66f)](); } Array[_0x1546b7(0x82f)](_0x76cec4[_0x1546b7(0x929)])[_0x1546b7(0x4d0)](_0x447e2f => { const _0xd3cecb = _0x1546b7; !_0x447e2f[_0xd3cecb(0x421)]['contains']('load-more-btn') && _0x447e2f[_0xd3cecb(0x66f)](); }); const _0x2136cc = _0x188396['slice'](-_0x128784[_0x1546b7(0x1d1)]); _0x2136cc['forEach'](_0x241222 => { const _0x2e8184 = _0x1546b7, _0x2ad40c = _0x128784[_0x2e8184(0x6e7)][_0x2e8184(0x439)](_0x241222); _0x2ad40c > -0x1 && _0x553325(_0x241222, _0x2ad40c); }); if (_0x128784[_0x1546b7(0x2d7)]) { let _0x2d06d7 = _0x76cec4['querySelector'](_0x1546b7(0x58e)); !_0x2d06d7 && (_0x1546b7(0x804) !== _0x1546b7(0x804) ? _0x535260[_0x1546b7(0x7cb)] = _0x50dd58[_0x1546b7(0x7cb)] : (_0x2d06d7 = document[_0x1546b7(0x26b)](_0x1546b7(0x76e)), _0x2d06d7[_0x1546b7(0x1f0)] = 'typing-indicator', _0x2d06d7[_0x1546b7(0x68f)] = _0x1546b7(0x74e), _0x76cec4['appendChild'](_0x2d06d7))); } _0x2136cc['length'] <= _0x128784[_0x1546b7(0x1d1)] && ('gOqKk' !== _0x1546b7(0x8f1) ? _0x337329 += _0x1546b7(0x76b) : setTimeout(() => { const _0x1bd3a0 = _0x1546b7; _0x76cec4[_0x1bd3a0(0x4d8)] = _0x76cec4['scrollHeight']; }, 0x0)); } else { const _0x2e2a98 = _0x9b304d(_0x11ab52); if (!_0x2e2a98) return; _0x499638['activeDiaryCharacterId'] = _0xf5eda3; const _0x47e646 = _0xff40a6['diaries'][_0x1546b7(0x787)](_0x15349d => _0x15349d[_0x1546b7(0x267)] === _0x3f3e80), _0x3473e7 = _0x47e646 ? _0x47e646[_0x1546b7(0x8b0)][_0x1546b7(0x36c)] : 0x0, _0x2dd7eb = 0x2; _0x7c9710[_0x1546b7(0x549)] = _0x3dbddf[_0x1546b7(0x85a)](0x0, _0x143b9e[_0x1546b7(0x43b)](_0x3473e7 / _0x2dd7eb) - 0x1), _0x59e2c1['getElementById'](_0x1546b7(0x67d))[_0x1546b7(0x68f)] = _0x2e2a98[_0x1546b7(0x4da)] + _0x1546b7(0x49c), _0x4abae7(), _0x3b1a22(_0x1546b7(0x888), _0x1546b7(0x53f)); } } function _0x553325(_0x214da9, _0x20a064) { const _0x5923df = _0x43c7a1; if ('dbLYQ' !== 'xttwD') { const { role: _0x3ddd28, content: _0x3106c3, displayUrl: _0x139242, image: _0x533ffc, senderId: _0x520a00 } = _0x214da9, _0x1d9776 = _0x3ddd28 === _0x5923df(0x600) ? 'ai' : _0x3ddd28, _0x352910 = _0x401cc7(), _0x2295d4 = document[_0x5923df(0x26b)](_0x5923df(0x76e)); _0x2295d4['classList'][_0x5923df(0x266)](_0x5923df(0x512), _0x1d9776), _0x2295d4['dataset'][_0x5923df(0x27b)] = _0x20a064; const _0x1ddbf7 = document[_0x5923df(0x26b)](_0x5923df(0x76e)); _0x1ddbf7[_0x5923df(0x1f0)] = _0x5923df(0x91e); const _0x3e86fd = document[_0x5923df(0x26b)](_0x5923df(0x682)); _0x3e86fd[_0x5923df(0x421)][_0x5923df(0x266)]('avatar', _0x3ddd28 + _0x5923df(0x6ba)); let _0x59b331 = ''; if (_0x3ddd28 === _0x5923df(0x500)) { const _0x3f1f42 = _0x10af56(_0x128784[_0x5923df(0x789)]); _0x59b331 = _0x3f1f42[_0x5923df(0x4b6)] || _0x473193; } else { _0x59b331 = _0x3834ec; let _0x17f5e5 = null; if (_0x352910?.['type'] === _0x5923df(0x921)) { if (_0x5923df(0x4f4) === 'kmRPm') { const _0x4dda70 = _0x5db4ee(); _0x4dda70 && _0x4dda70['activeListenSession'] && _0x4dda70['activeListenSession'][_0x5923df(0x88d)] && (_0x6a5e9b[_0x5923df(0x385)][_0x5923df(0x1cd)] = _0x5923df(0x4d4), _0x47bc67(() => _0x231cb0[_0x5923df(0x421)][_0x5923df(0x266)](_0x5923df(0x8d5)), 0xa)); } else _0x17f5e5 = _0x8351ef(_0x352910[_0x5923df(0x4de)][0x0]); } else _0x352910?.[_0x5923df(0x3b1)] === _0x5923df(0x6a4) && _0x520a00 && ('uSUxu' === _0x5923df(0x340) ? _0x52f6b3[_0x5923df(0x421)][_0x5923df(0x66f)](_0x5923df(0x8d5)) : _0x17f5e5 = _0x8351ef(_0x520a00)); _0x17f5e5?.[_0x5923df(0x4b6)] && (_0x5923df(0x6d0) === _0x5923df(0x9a4) ? (_0x28f669['error']('解析AI剧本JSON失败:', _0x3fcb22, '原始文本:', _0x2653d6), _0xaa2fed[_0x5923df(0x6e7)]['push']({ 'role': _0x5923df(0x600), 'senderId': _0x38498d['id'], 'timestamp': _0xf06864[_0x5923df(0x8a2)](), 'isOffline': !![], 'content': _0x5923df(0x82d) + _0x4c04bb + ']' })) : _0x59b331 = _0x17f5e5[_0x5923df(0x4b6)]); } _0x3e86fd[_0x5923df(0x84a)] = _0x59b331, _0x3e86fd[_0x5923df(0x68b)] = _0x3ddd28 + '\x20avatar'; const _0xf9b66 = _0x3106c3 && _0x3106c3[_0x5923df(0x6df)]()[_0x5923df(0x3fd)](_0x5923df(0x228)) && _0x3106c3[_0x5923df(0x6df)]()[_0x5923df(0x49a)](_0x5923df(0x2be)); if (_0xf9b66) { const _0x3dea6a = document[_0x5923df(0x26b)](_0x5923df(0x76e)); _0x3dea6a[_0x5923df(0x1f0)] = 'html-module-container', _0x3dea6a['innerHTML'] = _0x3106c3, _0x1d9776 === _0x5923df(0x500) ? _0x5923df(0x75f) === _0x5923df(0x6ab) ? _0x3ad1a5[_0x5923df(0x548)](_0x204d33, _0x5280ce['localStorageData'][_0x308f7e]) : (_0x1ddbf7['appendChild'](_0x3dea6a), _0x1ddbf7[_0x5923df(0x3d5)](_0x3e86fd)) : (_0x1ddbf7[_0x5923df(0x3d5)](_0x3e86fd), _0x1ddbf7[_0x5923df(0x3d5)](_0x3dea6a)); } else { if ('LNPih' === _0x5923df(0x55a)) { const _0x548613 = document[_0x5923df(0x26b)]('div'); _0x548613['classList']['add'](_0x5923df(0x740), _0x1d9776); if (_0x352910?.[_0x5923df(0x3b1)] === _0x5923df(0x921)) { const _0x43b52f = _0x352910['participantIds'][0x0]; _0x548613[_0x5923df(0x421)][_0x5923df(0x266)]('bubble-' + _0x43b52f); } if (_0x214da9[_0x5923df(0x6dd)]) { const _0x47c45f = document[_0x5923df(0x26b)](_0x5923df(0x76e)); _0x47c45f[_0x5923df(0x1f0)] = _0x5923df(0x6d6); const _0x4de0cd = document['createElement'](_0x5923df(0x76e)); _0x4de0cd[_0x5923df(0x1f0)] = _0x5923df(0x3b9), _0x4de0cd[_0x5923df(0x68f)] = _0x214da9[_0x5923df(0x6dd)]['sender']; const _0x58df71 = document[_0x5923df(0x26b)](_0x5923df(0x76e)); _0x58df71['className'] = 'quoted-content', _0x58df71[_0x5923df(0x68f)] = _0x214da9['quotedMessage'][_0x5923df(0x472)], _0x47c45f[_0x5923df(0x3d5)](_0x4de0cd), _0x47c45f[_0x5923df(0x3d5)](_0x58df71), _0x548613[_0x5923df(0x3d5)](_0x47c45f); } if (_0x139242) { _0x548613[_0x5923df(0x421)][_0x5923df(0x266)]('sticker'); const _0x53075c = document[_0x5923df(0x26b)](_0x5923df(0x682)); _0x53075c[_0x5923df(0x84a)] = _0x139242, _0x53075c[_0x5923df(0x421)][_0x5923df(0x266)]('sticker-content'), _0x548613[_0x5923df(0x3d5)](_0x53075c); } else { if (_0x214da9['image'] || _0x214da9[_0x5923df(0x431)]) { _0x548613[_0x5923df(0x421)]['add']('image'); const _0x4cca81 = document[_0x5923df(0x26b)](_0x5923df(0x682)); _0x4cca81[_0x5923df(0x421)][_0x5923df(0x266)](_0x5923df(0x901)), _0x548613[_0x5923df(0x3d5)](_0x4cca81); _0x214da9[_0x5923df(0x911)] ? _0x4cca81[_0x5923df(0x84a)] = _0x214da9[_0x5923df(0x911)] : (_0x4cca81['src'] = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', _0x226e0a(_0x214da9[_0x5923df(0x431)])[_0x5923df(0x745)](_0x2bb9c7 => { const _0x22554b = _0x5923df; if (_0x2bb9c7) { const _0x122c9b = URL[_0x22554b(0x9be)](_0x2bb9c7); _0x4cca81[_0x22554b(0x84a)] = _0x122c9b, _0x4cca81[_0x22554b(0x74c)] = () => { const _0xc7f76e = _0x22554b; _0xc7f76e(0x981) !== _0xc7f76e(0x51d) ? URL[_0xc7f76e(0x775)](_0x122c9b) : _0x56fcd1[_0xc7f76e(0x421)][_0xc7f76e(0x266)](_0xc7f76e(0x8d5)); }; } else _0x4cca81['alt'] = '图片加载失败'; })['catch'](_0x557906 => { const _0x5c550a = _0x5923df; console['error'](_0x5c550a(0x2a5), _0x557906), _0x4cca81['alt'] = '图片加载失败'; })); if (_0x3106c3) { const _0x264269 = document[_0x5923df(0x26b)]('p'); _0x264269[_0x5923df(0x385)]['marginTop'] = _0x5923df(0x617), _0x264269[_0x5923df(0x68f)] = _0x3106c3, _0x548613[_0x5923df(0x3d5)](_0x264269); } } else { if (_0x214da9[_0x5923df(0x3b1)] === _0x5923df(0x4e1)) { if ('uyKlB' === 'XCPva') _0x57ce6b[_0x5923df(0x1e5)](_0xaec512); else { _0x548613[_0x5923df(0x421)]['add'](_0x5923df(0x4e1)); const _0x33f7eb = _0x214da9[_0x5923df(0x4c9)] === _0x5923df(0x500) ? _0x10af56(_0x128784[_0x5923df(0x789)]) : _0x8351ef(_0x214da9[_0x5923df(0x67b)]), _0x247e88 = _0x214da9['recipientId'] === _0x10af56(_0x128784[_0x5923df(0x789)])['id'] ? _0x10af56(_0x128784[_0x5923df(0x789)]) : _0x8351ef(_0x214da9[_0x5923df(0x992)]), _0x4dcbd6 = _0x33f7eb?.[_0x5923df(0x4da)] ? _0x33f7eb['name'] + _0x5923df(0x680) : '转账', _0x17ceef = _0x247e88?.['name'] ? _0x5923df(0x871) + _0x247e88[_0x5923df(0x4da)] : '转账', _0x3e417a = _0x5923df(0x868) + _0x4dcbd6 + _0x5923df(0x71c) + _0x214da9[_0x5923df(0x9d3)][_0x5923df(0x8bd)](0x2) + _0x5923df(0x2a9) + _0x17ceef + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>'; _0x548613[_0x5923df(0x711)] = _0x3e417a; } } else { if (_0x214da9[_0x5923df(0x3b1)] === 'listen-together-invite') { if (_0x5923df(0x2d6) !== _0x5923df(0x522)) { _0x548613[_0x5923df(0x421)][_0x5923df(0x266)]('music'); const _0x52b6a4 = document[_0x5923df(0x26b)]('div'); _0x52b6a4['className'] = _0x5923df(0x6fc), _0x52b6a4[_0x5923df(0x421)][_0x5923df(0x266)](_0x5923df(0x405)); const _0x2f1fef = _0x214da9[_0x5923df(0x4c9)] === _0x5923df(0x500) ? _0x10af56(_0x128784[_0x5923df(0x789)])[_0x5923df(0x4da)] || '你' : _0x8351ef(_0x214da9[_0x5923df(0x67b)])?.[_0x5923df(0x4da)] || 'TA', _0x3186a0 = 'cover_placeholder_' + _0x214da9[_0x5923df(0x89b)], _0x4946f9 = _0x5923df(0x6a8) + _0x3186a0 + _0x5923df(0x1e8) + _0x3834ec + '\x22>'; if (_0x214da9[_0x5923df(0x884)]) { if (_0x5923df(0x29b) === _0x5923df(0x5a2)) { const _0x391765 = _0x258ee6[_0x5923df(0x9be)](_0x16b011); _0x4cec91['src'] = _0x391765, _0x18aec6[_0x5923df(0x74c)] = () => _0x4736d2[_0x5923df(0x775)](_0x391765); } else _0x226e0a(_0x214da9['coverId'])['then'](_0x49888b => { const _0xbc07fc = _0x5923df, _0x17046f = document[_0xbc07fc(0x655)](_0x3186a0); if (_0x17046f && _0x49888b) _0x17046f[_0xbc07fc(0x84a)] = URL[_0xbc07fc(0x9be)](_0x49888b); }); } _0x214da9['accepted'] ? 'iuTEz' === _0x5923df(0x3ab) ? _0x5cd8f3 = _0x50cf07[_0x5923df(0x4b6)] : _0x52b6a4[_0x5923df(0x711)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x4946f9 + _0x5923df(0x96d) + _0x214da9['songName'] + _0x5923df(0x28d) + _0x214da9[_0x5923df(0x2aa)] + _0x5923df(0x3ff) : _0x52b6a4['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>' + _0x2f1fef + _0x5923df(0x6c3) + _0x4946f9 + _0x5923df(0x96d) + _0x214da9[_0x5923df(0x1d2)] + _0x5923df(0x28d) + _0x214da9[_0x5923df(0x2aa)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22' + _0x214da9[_0x5923df(0x686)] + _0x5923df(0x6c1), _0x548613['appendChild'](_0x52b6a4); } else _0x184c50['activeChatId'] = _0x5923df(0x5e2) + _0x21b38e['activeCharacterId']; } else { if (_0x214da9['type'] === 'music' && _0x214da9[_0x5923df(0x1d2)]) { _0x548613[_0x5923df(0x421)][_0x5923df(0x266)]('music'); const _0x24d814 = document['createElement'](_0x5923df(0x76e)); _0x24d814[_0x5923df(0x1f0)] = _0x5923df(0x85d), _0x24d814[_0x5923df(0x663)][_0x5923df(0x90b)] = 'msg_' + _0x214da9[_0x5923df(0x89b)]; const _0x56701f = _0x5923df(0x6e8) + _0x214da9['timestamp'], _0x18db20 = '<img\x20src=\x22' + _0x3834ec + _0x5923df(0x426) + _0x56701f + '\x22\x20class=\x22music-share-cover\x22>'; if (_0x214da9[_0x5923df(0x884)]) _0x226e0a(_0x214da9[_0x5923df(0x884)])[_0x5923df(0x745)](_0x50ff48 => { const _0x9fa587 = _0x5923df; if (_0x9fa587(0x5bb) !== _0x9fa587(0x5bb)) _0x5aaf3b > _0xf11fcc && (_0x31f189 *= _0x375663 / _0x3c0829, _0x49f7d4 = _0x100bb9); else { const _0x2776af = document['getElementById'](_0x56701f); if (_0x2776af && _0x50ff48) _0x2776af[_0x9fa587(0x84a)] = URL[_0x9fa587(0x9be)](_0x50ff48); } }); else _0x214da9[_0x5923df(0x912)] && setTimeout(() => { const _0x361c9a = _0x5923df, _0x4b0f93 = document[_0x361c9a(0x655)](_0x56701f); if (_0x4b0f93) _0x4b0f93[_0x361c9a(0x84a)] = _0x214da9[_0x361c9a(0x912)]; }, 0x0); _0x24d814[_0x5923df(0x711)] = _0x5923df(0x908) + _0x18db20 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x214da9[_0x5923df(0x1d2)] + _0x5923df(0x75d) + _0x214da9[_0x5923df(0x2aa)] + _0x5923df(0x3f5) + (_0x214da9['playableUrl'] ? '▶' : '⚠') + _0x5923df(0x2be), _0x214da9[_0x5923df(0x36f)] && _0x24d814[_0x5923df(0x203)](_0x5923df(0x783), function () { const _0x3849ae = _0x5923df; if (_0x3849ae(0x368) === 'noSSu') { const _0x54284e = _0xd2d59e[_0x3849ae(0x911)][_0x3849ae(0x7c7)](',')[0x1], _0x5444ce = _0x3ead3e['image'][_0x3849ae(0x810)](_0x1e7457['image']['indexOf'](':') + 0x1, _0x48a4c8[_0x3849ae(0x911)][_0x3849ae(0x439)](';')) || 'image/jpeg'; _0x3fec35['push']({ 'inline_data': { 'mime_type': _0x5444ce, 'data': _0x54284e } }); } else { const _0x4950ef = { 'id': 'msg_' + _0x214da9['timestamp'], 'url': _0x214da9[_0x3849ae(0x36f)] }; _0x40fca5(this, _0x4950ef); } }), _0x548613[_0x5923df(0x3d5)](_0x24d814); } else { if (_0x5923df(0x429) === _0x5923df(0x429)) { if (_0x3106c3) { const _0x158ff7 = document[_0x5923df(0x26b)]('p'); _0x158ff7[_0x5923df(0x711)] = _0x3106c3, _0x158ff7[_0x5923df(0x385)][_0x5923df(0x77b)] = '0', _0x548613[_0x5923df(0x3d5)](_0x158ff7); } } else { const _0x5b59c8 = _0x223c55, _0x33a496 = _0x5b59c8[_0x5923df(0x53d)], _0x2a9047 = _0x5b59c8[_0x5923df(0x4d8)]; _0x1274c2[_0x5923df(0x1d1)] += 0x64, _0x19db23(), _0x484a1f(() => { const _0x4eacba = _0x5923df, _0x1252d2 = _0x5b59c8[_0x4eacba(0x53d)]; _0x5b59c8[_0x4eacba(0x4d8)] = _0x2a9047 + (_0x1252d2 - _0x33a496); }); } } } } } } _0x3ddd28 === _0x5923df(0x500) ? (_0x1ddbf7[_0x5923df(0x3d5)](_0x548613), _0x1ddbf7[_0x5923df(0x3d5)](_0x3e86fd)) : (_0x1ddbf7[_0x5923df(0x3d5)](_0x3e86fd), _0x1ddbf7[_0x5923df(0x3d5)](_0x548613)); } else _0xb42f39(), _0x3fd023[_0x5923df(0x783)](); } _0x2295d4[_0x5923df(0x3d5)](_0x1ddbf7); const _0x1173da = document[_0x5923df(0x26b)]('div'); return _0x1173da[_0x5923df(0x1f0)] = 'timestamp', _0x1173da[_0x5923df(0x68f)] = _0x461bab(_0x214da9[_0x5923df(0x89b)]), _0x2295d4['appendChild'](_0x1173da), _0x76cec4['appendChild'](_0x2295d4), _0x2295d4; } else _0x39275a[_0x5923df(0x5c5)](_0x5923df(0x25f) + _0x22eefe[_0x5923df(0x789)]); } document[_0x43c7a1(0x655)](_0x43c7a1(0x8bc))[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x15982b); let _0x3a7621 = null, _0x378245 = null; function _0x15982b(_0x550fb9) { const _0x1d7ae8 = _0x43c7a1; if (window[_0x1d7ae8(0x464)]()[_0x1d7ae8(0x3a1)]()) { if (_0x1d7ae8(0x6c6) === 'husvI') return; else _0x2b7fc2[_0x1d7ae8(0x3b7)](), _0x18046a[_0x1d7ae8(0x421)][_0x1d7ae8(0x34f)]('visible'), _0x50b693['classList']['toggle'](_0x1d7ae8(0x484)); } const _0x38cef0 = _0x550fb9[_0x1d7ae8(0x949)]['closest'](_0x1d7ae8(0x5ab)), _0x1a3170 = _0x550fb9[_0x1d7ae8(0x949)][_0x1d7ae8(0x3bf)]('.no-action-modal'); if (!_0x38cef0 || _0x1a3170) return; const _0x5b68a7 = parseInt(_0x38cef0[_0x1d7ae8(0x663)][_0x1d7ae8(0x27b)], 0xa); if (isNaN(_0x5b68a7)) return; _0xe6bdf3(_0x5b68a7); } function _0x15e832() { const _0x548a5f = _0x43c7a1, _0xc28f9b = _0x401cc7(); if (!_0xc28f9b) { if (_0x548a5f(0x1c2) !== 'hOlwQ') { _0x5ed43f[_0x548a5f(0x68f)] = _0x548a5f(0x9bb); return; } else { const _0x1ced32 = _0x1baf5d[_0x548a5f(0x655)]('meeting-list-container'); _0x1ced32[_0x548a5f(0x711)] = ''; const _0x564381 = _0x2c8828['characters'][_0x548a5f(0x89c)](_0x534dd3 => _0x100744[_0x548a5f(0x295)][_0x548a5f(0x383)](_0x4861a2 => _0x4861a2[_0x548a5f(0x3b1)] === _0x548a5f(0x921) && _0x4861a2[_0x548a5f(0x4de)][_0x548a5f(0x9ac)](_0x534dd3['id']))); if (_0x564381[_0x548a5f(0x36c)] === 0x0) { _0x1ced32[_0x548a5f(0x711)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>'; return; } _0x564381[_0x548a5f(0x4d0)](_0x53a1d5 => { const _0x3bbfaf = _0x548a5f, _0x1e69a3 = _0x2d5450['createElement']('li'); _0x1e69a3['className'] = 'character-item', _0x1e69a3['dataset'][_0x3bbfaf(0x1e7)] = _0x53a1d5['id'], _0x1e69a3[_0x3bbfaf(0x711)] = _0x3bbfaf(0x706) + (_0x53a1d5[_0x3bbfaf(0x4b6)] || _0x55f201) + _0x3bbfaf(0x342) + _0x53a1d5[_0x3bbfaf(0x4da)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>' + (_0x53a1d5[_0x3bbfaf(0x540)] || '私聊') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x1e69a3['addEventListener'](_0x3bbfaf(0x783), () => { _0x2ab849(_0x53a1d5['id']); }), _0x1ced32[_0x3bbfaf(0x3d5)](_0x1e69a3); }); } } if (_0xc28f9b[_0x548a5f(0x3b1)] === 'private') { if ('VSsuA' !== 'VSsuA') delete _0xf78cda[_0x548a5f(0x4f1)][_0x38bb39], _0x445a91(), _0x4cb413(); else { const _0xe090cc = _0x8351ef(_0xc28f9b[_0x548a5f(0x4de)][0x0]); _0x5ed43f[_0x548a5f(0x68f)] = _0xe090cc ? _0xe090cc[_0x548a5f(0x4da)] : _0x548a5f(0x4db); } } else _0x5ed43f[_0x548a5f(0x68f)] = _0xc28f9b[_0x548a5f(0x4da)] || '群聊\x20(' + _0xc28f9b['participantIds'][_0x548a5f(0x36c)] + ')'; } function _0x5c804d(_0x1aae5d) { const _0x2623b2 = _0x43c7a1; if (_0x2623b2(0x26f) === 'jDcpJ') { const _0x1029f5 = document[_0x2623b2(0x9ad)](_0x2623b2(0x8e6)); if (_0x1029f5 && (_0x1029f5['id'] === 'meeting-view-screen' || _0x1029f5['id'] === _0x2623b2(0x336))) 'JMgnN' === _0x2623b2(0x1c7) ? _0x17a765[_0x2623b2(0x8a1)] = { ..._0x5933e8[_0x2623b2(0x8a1)], ..._0x51e8fe[_0x2623b2(0x8a1)] } : _0x327245(); else { const _0x591c34 = document[_0x2623b2(0x49d)](_0x2623b2(0x58e)); _0x591c34[_0x2623b2(0x4d0)](_0x17add2 => _0x17add2[_0x2623b2(0x66f)]()); } } else _0xa505d8[_0x2623b2(0x775)](_0x24233b); } function _0x1e728a() { const _0x4b3e07 = _0x43c7a1; _0x128784['isGenerating'] && _0x128784['currentAbortController'] && (console[_0x4b3e07(0x331)](_0x4b3e07(0x5a5)), _0x128784[_0x4b3e07(0x9ca)][_0x4b3e07(0x4a1)](_0x4b3e07(0x61f)), _0x128784['currentAbortController'] = null), _0x128784[_0x4b3e07(0x2d7)] = ![], _0x5c804d(![]); } function _0x401cc7() { const _0x54e580 = _0x43c7a1; return _0x128784[_0x54e580(0x295)][_0x54e580(0x787)](_0x3b9159 => _0x3b9159['id'] === _0x128784['activeChatId']); } function _0x8351ef(_0x1e307f) { return _0x128784['characters']['find'](_0x20f420 => _0x20f420['id'] === _0x1e307f); } function _0x147f2f(_0x50328b) { const _0x1e27c1 = _0x43c7a1; if ('cdRSl' !== _0x1e27c1(0x6a6)) _0x49a7cb[_0x1e27c1(0x421)][_0x1e27c1(0x266)](_0x1e27c1(0x26c)); else { _0x128784[_0x1e27c1(0x277)] = _0x128784[_0x1e27c1(0x277)][_0x1e27c1(0x89c)](_0xcfbb12 => _0xcfbb12['id'] !== _0x50328b), _0x128784[_0x1e27c1(0x295)][_0x1e27c1(0x4d0)](_0x31d75e => { const _0x30d481 = _0x1e27c1; 'BedcD' !== _0x30d481(0x438) ? _0x31d75e[_0x30d481(0x3b1)] === _0x30d481(0x6a4) && (_0x30d481(0x40c) !== _0x30d481(0x328) ? _0x31d75e[_0x30d481(0x4de)] = _0x31d75e['participantIds'][_0x30d481(0x89c)](_0x4f18da => _0x4f18da !== _0x50328b) : _0x2b10f8(_0x2e0327, _0x29b2a1[_0x30d481(0x5eb)])) : _0x8e35bb[_0x30d481(0x385)][_0x30d481(0x2ca)] = ''; }); const _0x25153a = _0x128784[_0x1e27c1(0x295)][_0x1e27c1(0x787)](_0x51c97d => _0x51c97d[_0x1e27c1(0x3b1)] === _0x1e27c1(0x921) && _0x51c97d[_0x1e27c1(0x4de)][_0x1e27c1(0x9ac)](_0x50328b)); _0x25153a && _0x7418f7(_0x25153a['id']), _0x128784['chats'] = _0x128784[_0x1e27c1(0x295)]['filter'](_0x19f673 => _0x19f673[_0x1e27c1(0x3b1)] !== _0x1e27c1(0x6a4) || _0x19f673[_0x1e27c1(0x4de)][_0x1e27c1(0x36c)] > 0x1), _0x5eb81f(), _0x151457(); } } function _0x7418f7(_0x2de74c) { const _0x46e6f9 = _0x43c7a1; if (_0x46e6f9(0x99b) === _0x46e6f9(0x99b)) { _0x128784[_0x46e6f9(0x295)] = _0x128784['chats'][_0x46e6f9(0x89c)](_0x1bf9c8 => _0x1bf9c8['id'] !== _0x2de74c); try { localStorage[_0x46e6f9(0x5c5)]('chatHistory_' + _0x2de74c); } catch (_0x529bcf) { _0x46e6f9(0x7fd) !== _0x46e6f9(0x5cc) ? console[_0x46e6f9(0x9de)](_0x46e6f9(0x757) + _0x2de74c, _0x529bcf) : _0x58b812['getElementById'](_0x46e6f9(0x7e6))[_0x46e6f9(0x783)](); } _0x128784[_0x46e6f9(0x789)] === _0x2de74c && (_0x128784[_0x46e6f9(0x789)] = _0x128784[_0x46e6f9(0x295)][0x0]?.['id'] || null, _0x1e5a3e(_0x128784['activeChatId'])), _0x5eb81f(), _0x151457(); } else _0xa5c984[_0x46e6f9(0x430)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x3f4113[_0x46e6f9(0x430)] }; } async function _0x1e5a3e(_0xa5b4f3) { const _0x22fe17 = _0x43c7a1; if (_0x22fe17(0x7bd) !== _0x22fe17(0x7bd)) { if (_0x120e91[_0x22fe17(0x3b1)] === 'group') return _0x22fe17(0x5af) + (_0x26b60a['name'] || _0x22fe17(0x735)) + '」'; const _0x24d869 = _0x187b22(_0x3a1e7d[_0x22fe17(0x4de)][0x0]); return '与\x20' + (_0x24d869?.[_0x22fe17(0x4da)] || _0x22fe17(0x4db)) + _0x22fe17(0x1fd); } else { _0x128784[_0x22fe17(0x789)] !== _0xa5b4f3 && (_0x22fe17(0x284) === _0x22fe17(0x857) ? (_0x388db3[_0x22fe17(0x3d5)](_0x4c2178), _0xe6a684[_0x22fe17(0x3d5)](_0x29fe1f)) : (_0x1e728a(), _0x128784[_0x22fe17(0x1d1)] = 0x64)); if (!_0xa5b4f3) { _0x128784[_0x22fe17(0x789)] = null, _0x5eb81f(), _0x4d44ee(![]), document['getElementById']('chat-view-pane')[_0x22fe17(0x385)][_0x22fe17(0x2ca)] = ''; return; } _0x128784[_0x22fe17(0x789)] = _0xa5b4f3, _0x5eb81f(), _0x15e832(), _0x76cec4[_0x22fe17(0x711)] = '', _0xddfd1b(!![], _0x22fe17(0x5d9)), setTimeout(async () => { const _0x23bbfc = _0x22fe17; try { _0x219435(); const _0x2a31b1 = _0x401cc7(), _0x10bfcc = document[_0x23bbfc(0x655)](_0x23bbfc(0x39e)); let _0xac69dc = null; if (_0x2a31b1) { if (_0x23bbfc(0x533) !== _0x23bbfc(0x533)) _0x51f9cb[_0x23bbfc(0x68f)] = _0x5f5a1c[_0x23bbfc(0x555)] === _0x23bbfc(0x71b) ? '旁白' : _0x36d86a[_0x23bbfc(0x555)], _0x1e5a72[_0x23bbfc(0x68f)] = _0x51a04a[_0x23bbfc(0x91c)], _0x302625[_0x23bbfc(0x555)] === _0xa5eb9a[_0x23bbfc(0x4da)] ? _0x49012e(_0x192540, _0x241357[_0x23bbfc(0x5eb)]) : _0x31ff47(_0xddf363, _0x23bbfc(0x850)); else { if (_0x2a31b1[_0x23bbfc(0x3b1)] === _0x23bbfc(0x921)) { if (_0x23bbfc(0x80b) === _0x23bbfc(0x9aa)) _0x58ec7b[_0x23bbfc(0x20a)] = _0x3f17c3, _0x48b8d9[_0x23bbfc(0x90a)] = _0x59441c, _0x3055d0[_0x23bbfc(0x685)] = ![], _0x180945(); else { const _0x29bfec = _0x2a31b1['participantIds'][0x0]; _0x5dc056(_0x29bfec), _0xac69dc = await _0x226e0a(_0x23bbfc(0x861) + _0x29bfec); } } else _0xac69dc = await _0x226e0a(_0x23bbfc(0x672) + _0x2a31b1['id']); _0xac69dc ? (_0x10bfcc[_0x23bbfc(0x385)]['backgroundImage'] = _0x23bbfc(0x5cf) + URL[_0x23bbfc(0x9be)](_0xac69dc) + '\x27)', _0x10bfcc['style'][_0x23bbfc(0x6ed)] = _0x23bbfc(0x678), _0x10bfcc[_0x23bbfc(0x385)][_0x23bbfc(0x543)] = _0x23bbfc(0x4cf)) : _0x23bbfc(0x88a) !== _0x23bbfc(0x88a) ? _0x1d1f58(_0x23bbfc(0x36a) + _0x30fbfb[_0x23bbfc(0x740)]) : _0x10bfcc[_0x23bbfc(0x385)][_0x23bbfc(0x2ca)] = ''; } } _0x19de4f(); } catch (_0x1ef48d) { _0x23bbfc(0x41d) !== _0x23bbfc(0x947) ? (console['error'](_0x23bbfc(0x3f8), _0x1ef48d), _0x420e01('加载聊天失败:\x20' + _0x1ef48d[_0x23bbfc(0x740)])) : _0x1e1cb2 = _0x526120['image']; } finally { _0xddfd1b(![]); } }, 0x32); } } async function _0x25807d() { const _0x57e119 = _0x43c7a1; if (_0x128784[_0x57e119(0x2d7)]) { if (_0x57e119(0x9e4) !== _0x57e119(0x84f)) { _0x420e01(_0x57e119(0x6f0)); return; } else { const _0x18c0ce = _0x18eafc[_0x57e119(0x9bf)][_0x57e119(0x6df)](); if (!_0x18c0ce) { _0x4ad01c(_0x57e119(0x7f0)); return; } const _0x36809f = _0x2612a0['from'](_0x2d38ee[_0x57e119(0x49d)]('input[type=\x22checkbox\x22]:checked'))[_0x57e119(0x946)](_0x516021 => _0x516021['dataset']['id']); if (_0x36809f[_0x57e119(0x36c)] < 0x2) { _0x3cbbef('群聊至少需要2名成员。'); return; } const _0x1fba05 = { 'id': 'chat_group_' + _0x3541e6[_0x57e119(0x8a2)](), 'type': _0x57e119(0x6a4), 'name': _0x18c0ce, 'participantIds': _0x36809f }; _0x19e571['chats'][_0x57e119(0x1e5)](_0x1fba05), _0x16ab7c['activeChatId'] = _0x1fba05['id'], _0x55de1b(), _0x1a6fd2(), _0x2a3ada(), _0x25f789(), _0x160ba0(_0x57e119(0x48d) + _0x18c0ce + _0x57e119(0x608)), _0x4dd41f('chat', 'groupChatCreate'); } } const _0x113c66 = _0x128784[_0x57e119(0x6e7)]; if (_0x113c66['length'] === 0x0) return; let _0x46780c = -0x1; for (let _0x316779 = _0x113c66[_0x57e119(0x36c)] - 0x1; _0x316779 >= 0x0; _0x316779--) { if (_0x113c66[_0x316779][_0x57e119(0x4c9)] === _0x57e119(0x500)) { if ('WqUOX' !== _0x57e119(0x46d)) { _0x46780c = _0x316779; break; } else { const _0x2d98cc = 'chat_' + _0x31af7c; _0x37bf00(_0x2d98cc), _0x56fd96(!![]); } } } if (_0x46780c === -0x1 || _0x46780c === _0x113c66[_0x57e119(0x36c)] - 0x1) { if (_0x57e119(0x808) === 'lSpgm') _0x188fe6(_0x57e119(0x8d2)); else { _0x420e01('还没有我的回复可以重新生成哦。'); return; } } _0x113c66['splice'](_0x46780c + 0x1), _0x1313e9(), _0x327245(), setTimeout(() => { _0xf949f2(); }, 0x64); } function _0x3948ce(_0x50fe41 = null) { const _0x50c009 = _0x43c7a1, _0x99c9b5 = _0x50fe41 ?? _0xe97d72['value']['trim'](); if (_0x99c9b5 === '' || !_0x128784[_0x50c009(0x789)]) return; const _0x34f43e = document[_0x50c009(0x9ad)](_0x50c009(0x8e6)), _0x1dd6ef = _0x34f43e['id'] === 'meeting-view-screen', _0xe8020e = { 'role': _0x50c009(0x500), 'content': _0x99c9b5, 'timestamp': Date[_0x50c009(0x8a2)](), 'isOffline': _0x1dd6ef }; _0x128784[_0x50c009(0x729)] && (_0x50c009(0x4c1) === _0x50c009(0x29c) ? _0x27b4e3['events'][_0x50c009(0x1e5)]({ 'senderId': _0x2a507f['id'], 'kind': _0x50c009(0x33b), 'sticker': _0x4ff638 }) : _0xe8020e[_0x50c009(0x6dd)] = { ..._0x128784[_0x50c009(0x729)] }), _0x128784[_0x50c009(0x6e7)]['push'](_0xe8020e), _0x1313e9(), _0x327245(), !_0x50fe41 && (_0xe97d72[_0x50c009(0x9bf)] = ''), _0x272900(); } function _0x330032(_0x1fe095) { const _0x56a65a = _0x43c7a1; if (!_0x1fe095 || !_0x128784[_0x56a65a(0x789)]) return; const _0x1316c4 = { 'role': _0x56a65a(0x500), 'content': _0x56a65a(0x891) + _0x1fe095[_0x56a65a(0x4da)] + ']', 'displayUrl': _0x1fe095[_0x56a65a(0x237)], 'timestamp': Date['now']() }; _0x128784['conversationHistory'][_0x56a65a(0x1e5)](_0x1316c4), _0x553325(_0x1316c4, _0x128784[_0x56a65a(0x6e7)]['length'] - 0x1), _0x1313e9(), _0x3cc518['classList'][_0x56a65a(0x66f)]('show'); } async function _0x284ff3(_0x31a6a9) { const _0x97978e = _0x43c7a1, _0x4abdc1 = _0x31a6a9[_0x97978e(0x949)][_0x97978e(0x275)][0x0]; if (!_0x4abdc1 || !_0x128784[_0x97978e(0x789)]) return; _0xddfd1b(!![], '正在处理图片...'); try { if (_0x97978e(0x5fc) === 'ViyVq') { const _0x1539e1 = await _0x588f02(_0x4abdc1, 0x320, 0.8, !![]), _0x143077 = _0x97978e(0x980) + Date[_0x97978e(0x8a2)](); await _0x36c0a8(_0x143077, _0x1539e1); const _0x7b4054 = _0xe97d72['value'][_0x97978e(0x6df)](); _0xe97d72['value'] = ''; const _0x588714 = { 'role': _0x97978e(0x500), 'content': _0x7b4054, 'imageId': _0x143077, 'timestamp': Date[_0x97978e(0x8a2)]() }; _0x128784[_0x97978e(0x6e7)][_0x97978e(0x1e5)](_0x588714), _0x553325(_0x588714, _0x128784[_0x97978e(0x6e7)]['length'] - 0x1), _0x1313e9(); } else delete _0x583bfb[_0x97978e(0x830)], _0x224c7c(), _0x4c9874(_0x582e8e['id'], 'normal'), _0x236e62('已恢复默认。'), _0x50d11d(!![]); } catch (_0x115b7c) { _0x420e01(_0x97978e(0x94a) + _0x115b7c[_0x97978e(0x740)]); } finally { _0xddfd1b(![]), _0x31a6a9[_0x97978e(0x949)]['value'] = ''; } } async function _0x3aa5f1() { const _0x1826af = _0x43c7a1; if (!_0x128784[_0x1826af(0x789)]) return; const _0x54aefa = await _0x50a74a(); if (!_0x54aefa) return; _0x420e01(_0x1826af(0x705)); try { const _0x28961c = await _0x20e996(_0x54aefa['songName'], _0x54aefa[_0x1826af(0x2aa)]); let _0x9cdf69 = _0x28961c[_0x1826af(0x678)]; if (_0x28961c['cover'] && _0x28961c['cover'][_0x1826af(0x3fd)]('http')) try { const _0x565d4f = await fetch(_0x28961c['cover']), _0x4626e4 = await _0x565d4f[_0x1826af(0x780)](); _0x9cdf69 = await _0x171ffd(_0x4626e4); } catch (_0x18b1f2) { if ('tgQJH' === _0x1826af(0x72e)) { const _0x1dcd7d = _0x575352['getElementById'](_0x1826af(0x951)), _0xf7f918 = _0x32037d[_0x1826af(0x655)]('widget-title'), _0x280678 = _0x1d0403[_0x1826af(0x655)](_0x1826af(0x7f9)), _0x4d693f = _0x2d06f7['getElementById'](_0x1826af(0x6cf)), _0x2c63a1 = _0x4d17e9; _0x2c63a1 && _0x2c63a1[_0x1826af(0x494)] ? (_0xf7f918[_0x1826af(0x68f)] = _0x2c63a1['title'], _0x280678[_0x1826af(0x68f)] = _0x2c63a1[_0x1826af(0x2aa)], _0x1dcd7d[_0x1826af(0x421)]['add'](_0x1826af(0x449)), _0x1dcd7d['style'][_0x1826af(0x6ac)](_0x1826af(0x314), _0x1826af(0x21b) + _0x2c63a1[_0x1826af(0x678)] + ')')) : (_0xf7f918['textContent'] = _0x1826af(0x788), _0x280678[_0x1826af(0x68f)] = '请在动态或聊天中播放', _0x1dcd7d[_0x1826af(0x421)][_0x1826af(0x66f)](_0x1826af(0x449)), _0x4d693f[_0x1826af(0x385)]['setProperty'](_0x1826af(0x314), _0x1826af(0x44e))); } else console[_0x1826af(0x9de)](_0x1826af(0x9c9), _0x18b1f2), _0x9cdf69 = _0x3834ec; } const _0x347e5c = { 'role': _0x1826af(0x500), 'type': _0x1826af(0x2b9), 'content': _0x1826af(0x8e3) + _0x54aefa['songName'] + '\x20-\x20' + _0x54aefa[_0x1826af(0x2aa)] + ']', 'songName': _0x54aefa[_0x1826af(0x1d2)], 'artist': _0x54aefa[_0x1826af(0x2aa)], 'coverUrl': _0x9cdf69, 'playableUrl': _0x28961c[_0x1826af(0x237)], 'timestamp': Date[_0x1826af(0x8a2)]() }; _0x128784[_0x1826af(0x6e7)][_0x1826af(0x1e5)](_0x347e5c), _0x553325(_0x347e5c, _0x128784[_0x1826af(0x6e7)][_0x1826af(0x36c)] - 0x1), _0x1313e9(); } catch (_0x5bd9db) { console[_0x1826af(0x9de)](_0x1826af(0x77f), _0x5bd9db), _0x420e01('搜索失败:\x20' + _0x5bd9db[_0x1826af(0x740)]); } } function _0x5439a1(_0x5e57c6, _0x2302e5 = 0x78) { const _0x583485 = _0x43c7a1; if ('WfrWn' !== _0x583485(0x3ae)) { const _0x261779 = _0xf84e14[_0x583485(0x4a5)][_0x583485(0x787)](_0x5ac584 => _0x5ac584['id'] === _0x36c43e); if (_0x261779) _0x439efd[_0x583485(0x7d8)](_0x261779, _0x200b4a); } else { const _0x3f95f5 = _0x2e1576 => { const _0x14a983 = _0x583485; if (_0x2e1576[_0x14a983(0x4c9)] === _0x14a983(0x500)) return _0x128784[_0x14a983(0x50a)]?.[_0x14a983(0x4da)] || _0x14a983(0x958); if (_0x2e1576[_0x14a983(0x67b)]) { if (_0x14a983(0x305) !== _0x14a983(0x304)) { const _0x51479c = _0x8351ef(_0x2e1576['senderId']); return _0x51479c?.['name'] || 'Unknown'; } else _0x3f35b8 += _0x14a983(0x40d); } if (_0x5e57c6?.[_0x14a983(0x3b1)] === 'private') { const _0x5473ec = _0x8351ef(_0x5e57c6[_0x14a983(0x4de)][0x0]); return _0x5473ec?.[_0x14a983(0x4da)] || 'AI'; } return _0x14a983(0x4b8); }, _0xad7e02 = _0x128784[_0x583485(0x6e7)][_0x583485(0x6e3)](-_0x2302e5), _0x31416a = []; for (const _0x3cc8a8 of _0xad7e02) { if (_0x3cc8a8['displayUrl']) _0x31416a['push']('[' + _0x3f95f5(_0x3cc8a8) + _0x583485(0x1dd) + (_0x3cc8a8[_0x583485(0x472)]?.[_0x583485(0x256)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x3cc8a8[_0x583485(0x911)]) { const _0x4255c6 = _0x3cc8a8[_0x583485(0x472)] ? '\x20' + _0x3cc8a8[_0x583485(0x472)] : ''; _0x31416a['push']('[' + _0x3f95f5(_0x3cc8a8) + _0x583485(0x83c) + _0x4255c6); } else _0x3cc8a8[_0x583485(0x472)] && _0x31416a[_0x583485(0x1e5)]('[' + _0x3f95f5(_0x3cc8a8) + ']\x20' + _0x3cc8a8[_0x583485(0x472)]); } } return _0x31416a['join']('\x0a'); } } function _0x2dd5cb(_0x4a4b5b, _0x41f2b3) { const _0x5e2736 = _0x43c7a1; if (!_0x4a4b5b || !_0x41f2b3) return null; const _0x34a149 = _0x41f2b3[_0x5e2736(0x256)](/@([^\s:：,，。!?]+)/); if (!_0x34a149) return null; const _0x30eb11 = _0x34a149[0x1]['toLowerCase'](); for (const _0x432caf of _0x4a4b5b[_0x5e2736(0x4de)]) { if (_0x5e2736(0x99d) === _0x5e2736(0x410)) { const _0x5676fa = { 'id': _0x5e2736(0x6b9) + _0x1d5b4f[_0x5e2736(0x89b)], 'url': _0x3693b9[_0x5e2736(0x36f)] }; _0x23c2ec(this, _0x5676fa); } else { const _0x13fee0 = _0x8351ef(_0x432caf); if (!_0x13fee0?.[_0x5e2736(0x4da)]) continue; if (_0x13fee0[_0x5e2736(0x4da)][_0x5e2736(0x6b2)]() === _0x30eb11) return _0x13fee0; if (_0x13fee0[_0x5e2736(0x4da)][_0x5e2736(0x6b2)]()[_0x5e2736(0x3fd)](_0x30eb11)) return _0x13fee0; } } return null; } function _0x3495ae(_0x9894f8) { const _0x48e048 = _0x43c7a1; if ('WmRQw' !== _0x48e048(0x43e)) _0x8c97d1(), _0x5084af(![]); else { const _0xd6db55 = _0x9894f8[_0x48e048(0x439)]('{'), _0x2b956f = _0x9894f8[_0x48e048(0x9ae)]('}'); if (_0xd6db55 >= 0x0 && _0x2b956f > _0xd6db55) return _0x9894f8['slice'](_0xd6db55, _0x2b956f + 0x1); return _0x9894f8; } } function _0x10d6ab(_0x2042bd, _0x1d7c85, _0x47d156) { const _0x24cff8 = _0x43c7a1; if (_0x24cff8(0x5cb) === 'xyORD') _0x2a9bad[_0x24cff8(0x49d)]('input[type=\x22checkbox\x22]')[_0x24cff8(0x4d0)](_0x474ee0 => { const _0x4bf1c2 = _0x24cff8; if (_0x132501['linkedWorldBookIds'][_0x4bf1c2(0x9ac)](_0x474ee0[_0x4bf1c2(0x9bf)])) _0x474ee0['checked'] = !![]; }); else { const _0x5ae661 = new Map(_0x1d7c85[_0x24cff8(0x946)](_0xa0941e => [String(_0xa0941e['id']), _0xa0941e])), _0xd1d4c8 = _0x535635 => String(_0x535635 || '')[_0x24cff8(0x6b2)]()[_0x24cff8(0x55b)](/\s+/g, ''), _0x142544 = new Map(_0x1d7c85[_0x24cff8(0x946)](_0x1f87f1 => [_0xd1d4c8(_0x1f87f1[_0x24cff8(0x4da)]), _0x1f87f1])), _0x5a2fbf = new Set(_0x47d156), _0x2552b7 = { 'events': [] }; for (const _0xb0801f of _0x2042bd?.['events'] || []) { const _0xe28e04 = _0xb0801f[_0x24cff8(0x67b)] ?? _0xb0801f['sender'] ?? _0xb0801f[_0x24cff8(0x7f3)] ?? _0xb0801f[_0x24cff8(0x555)] ?? _0xb0801f[_0x24cff8(0x4c9)] ?? _0xb0801f['name']; if (!_0xe28e04) continue; let _0x1b788a = _0x5ae661[_0x24cff8(0x7df)](String(_0xe28e04)) || _0x142544[_0x24cff8(0x7df)](_0xd1d4c8(_0xe28e04)); if (!_0x1b788a) continue; const _0x694a01 = (_0xb0801f['kind'] || _0xb0801f[_0x24cff8(0x3b1)] || _0x24cff8(0x64b))[_0x24cff8(0x6b2)](); if (_0x694a01 === _0x24cff8(0x33b)) { if (_0x24cff8(0x2e7) === _0x24cff8(0x924)) { const _0x509833 = { 'id': 'user_' + _0x5b25ef[_0x24cff8(0x8a2)](), ..._0x39c7fc }; _0x486b30[_0x24cff8(0x4a5)]['push'](_0x509833), !_0x25dfaf['activeUserProfileId'] && (_0x2d118d['activeUserProfileId'] = _0x509833['id']); } else { const _0xca1bb = (_0xb0801f[_0x24cff8(0x33b)] ?? _0xb0801f[_0x24cff8(0x515)] ?? _0xb0801f[_0x24cff8(0x469)] ?? _0xb0801f['tag'])?.['trim'](); if (_0xca1bb && _0x5a2fbf['has'](_0xca1bb)) _0x2552b7['events'][_0x24cff8(0x1e5)]({ 'senderId': _0x1b788a['id'], 'kind': 'sticker', 'sticker': _0xca1bb }); else { const _0x123d59 = String(_0xb0801f[_0x24cff8(0x472)] ?? _0xb0801f[_0x24cff8(0x64b)] ?? '')[_0x24cff8(0x6df)]() || _0x24cff8(0x593) + (_0xca1bb || _0x24cff8(0x258)) + ']'; if (_0x123d59) _0x2552b7['events'][_0x24cff8(0x1e5)]({ 'senderId': _0x1b788a['id'], 'kind': _0x24cff8(0x64b), 'content': _0x123d59 }); } } } else { const _0x917e05 = String(_0xb0801f[_0x24cff8(0x472)] ?? _0xb0801f['text'] ?? _0xb0801f[_0x24cff8(0x740)] ?? '')[_0x24cff8(0x6df)](); if (_0x917e05) _0x2552b7[_0x24cff8(0x9d2)][_0x24cff8(0x1e5)]({ 'senderId': _0x1b788a['id'], 'kind': 'text', 'content': _0x917e05 }); } } return _0x2552b7; } } async function _0x23b793(_0x38f9f4) { const _0x3dc4c2 = _0x43c7a1; if (!_0x38f9f4 || !Array['isArray'](_0x38f9f4[_0x3dc4c2(0x9d2)]) || _0x38f9f4[_0x3dc4c2(0x9d2)]['length'] === 0x0) return; const _0x295b0f = _0x16018d => _0x16018d + Math[_0x3dc4c2(0x2b4)](Math['random']() * 0x190); let _0x3581b5 = 0x1f4; for (const _0x4b2f9c of _0x38f9f4[_0x3dc4c2(0x9d2)]) { if (_0x3dc4c2(0x300) === _0x3dc4c2(0x4b7)) return _0x45e93a[_0x3dc4c2(0x4a5)][_0x3dc4c2(0x787)](_0xa92220 => _0xa92220['id'] === _0x276e51); else { await new Promise(_0x4ca0b3 => setTimeout(_0x4ca0b3, _0x295b0f(_0x3581b5))), _0x3581b5 += 0x2bc; const _0x1e3f97 = _0x128784['conversationHistory']['at'](-0x1)?.[_0x3dc4c2(0x894)] ?? ![]; if (_0x4b2f9c[_0x3dc4c2(0x468)] === _0x3dc4c2(0x33b)) { if ('FixVQ' === _0x3dc4c2(0x1ed)) _0x4dc621['setItem'](_0x1ed495, _0x1f2b55['stringify'](_0x4ec5e3)); else { const _0x153ed6 = _0x2f0881[_0x3dc4c2(0x787)](_0x1596ec => _0x1596ec['name'] === _0x4b2f9c['sticker']); if (_0x153ed6) { const _0x3e31aa = { 'role': _0x3dc4c2(0x600), 'content': _0x3dc4c2(0x739) + _0x153ed6[_0x3dc4c2(0x4da)] + ']', 'displayUrl': _0x153ed6[_0x3dc4c2(0x237)], 'senderId': _0x4b2f9c[_0x3dc4c2(0x67b)], 'timestamp': Date[_0x3dc4c2(0x8a2)](), 'isOffline': _0x1e3f97 }; _0x128784[_0x3dc4c2(0x6e7)][_0x3dc4c2(0x1e5)](_0x3e31aa); } } } else { if (_0x4b2f9c['kind'] === 'music' && _0x4b2f9c['songName'] && _0x4b2f9c[_0x3dc4c2(0x2aa)]) { const { songName: _0x4b9611, artist: _0x5e16a6 } = _0x4b2f9c, _0x505851 = { 'role': 'assistant', 'type': _0x3dc4c2(0x2b9), 'content': _0x3dc4c2(0x9bc) + _0x4b9611 + _0x3dc4c2(0x7a7) + _0x5e16a6 + ']', 'songName': _0x4b9611, 'artist': _0x5e16a6, 'senderId': _0x4b2f9c[_0x3dc4c2(0x67b)], 'timestamp': Date[_0x3dc4c2(0x8a2)](), 'isOffline': _0x1e3f97 }; try { const _0x354ea4 = await _0x20e996(_0x4b9611, _0x5e16a6); _0x505851[_0x3dc4c2(0x912)] = _0x354ea4[_0x3dc4c2(0x678)], _0x505851[_0x3dc4c2(0x36f)] = _0x354ea4[_0x3dc4c2(0x237)]; } catch (_0x2ef508) { if (_0x3dc4c2(0x690) !== _0x3dc4c2(0x690)) { const _0x45884d = _0x2f93c6[_0x3dc4c2(0x6e7)]['filter'](_0x456e90 => _0x456e90[_0x3dc4c2(0x3b1)] === 'music' && _0x456e90[_0x3dc4c2(0x36f)])[_0x3dc4c2(0x946)](_0x54bb32 => ({ ..._0x54bb32, 'source': _0x3dc4c2(0x866) })); _0x5e6687['push'](..._0x45884d); } else console[_0x3dc4c2(0x9de)](_0x3dc4c2(0x8b7) + _0x4b9611 + _0x3dc4c2(0x7a7) + _0x5e16a6 + '):', _0x2ef508), _0x505851[_0x3dc4c2(0x912)] = null, _0x505851[_0x3dc4c2(0x36f)] = null; } _0x128784[_0x3dc4c2(0x6e7)][_0x3dc4c2(0x1e5)](_0x505851); } else { if (_0x4b2f9c[_0x3dc4c2(0x468)] === _0x3dc4c2(0x64b)) { if (_0x3dc4c2(0x3be) === 'YGEGM') { const _0xe09495 = _0x5cf620(_0x4b2f9c[_0x3dc4c2(0x472)])[_0x3dc4c2(0x6e3)](0x0, 0x3); for (let _0x379ca6 = 0x0; _0x379ca6 < _0xe09495[_0x3dc4c2(0x36c)]; _0x379ca6++) { if (_0x379ca6 > 0x0) await new Promise(_0x1772e5 => setTimeout(_0x1772e5, _0x295b0f(0x190))); const _0x587ddc = { 'role': _0x3dc4c2(0x600), 'content': _0xe09495[_0x379ca6], 'senderId': _0x4b2f9c['senderId'], 'timestamp': Date[_0x3dc4c2(0x8a2)](), 'isOffline': _0x1e3f97 }; _0x128784[_0x3dc4c2(0x6e7)][_0x3dc4c2(0x1e5)](_0x587ddc); } } else { const _0x2f07fa = _0x22c178[_0x3dc4c2(0x188)][_0x3dc4c2(0x787)](_0x47473e => _0x47473e['id'] === _0x5438e7); if (!_0x2f07fa) return; _0x2bdbb8[_0x3dc4c2(0x655)](_0x3dc4c2(0x8fb))[_0x3dc4c2(0x9bf)] = _0x2f07fa['id'], _0x417a93['getElementById'](_0x3dc4c2(0x81a))[_0x3dc4c2(0x68f)] = '编辑条目', _0x49c1a1['getElementById']('world-book-edit-name')[_0x3dc4c2(0x9bf)] = _0x2f07fa[_0x3dc4c2(0x4da)], _0x24df8e[_0x3dc4c2(0x655)](_0x3dc4c2(0x5c6))[_0x3dc4c2(0x9bf)] = _0x2f07fa[_0x3dc4c2(0x472)]; } } } } } } _0x1313e9(), _0x327245(); } async function _0x510873(_0x44b193, { force: force = ![], delayMs: delayMs = 0x0 } = {}) { const _0x36e134 = _0x43c7a1; if (_0x36e134(0x1ae) !== 'wWZEd') _0x17dd77[_0x36e134(0x385)][_0x36e134(0x2ca)] = '', _0x34a677[_0x36e134(0x385)][_0x36e134(0x1cf)] = '', _0x3f618c[_0x36e134(0x49d)](_0x36e134(0x9b6))['forEach'](_0x4f5bea => { const _0x4010bc = _0x36e134; _0x4f5bea[_0x4010bc(0x385)][_0x4010bc(0x772)] = ''; }); else { await new Promise(_0x3490ff => setTimeout(_0x3490ff, 0xa)); if (!_0x128784[_0x36e134(0x8a1)][_0x36e134(0x7cd)] || !_0x128784[_0x36e134(0x8a1)][_0x36e134(0x956)] || !_0x128784[_0x36e134(0x8a1)][_0x36e134(0x4a9)]) { if (_0x36e134(0x699) !== 'pmzAl') return _0x420e01(_0x36e134(0x65e)), ![]; else { if (!_0x2d8d9a[_0x36e134(0x789)]) return; try { _0x11d83c[_0x36e134(0x548)](_0x36e134(0x25f) + _0x5a655b[_0x36e134(0x789)], _0x55738d[_0x36e134(0x5e0)](_0x31e41a['conversationHistory'])); } catch (_0x4aa690) { _0x1e3b8a['error'](_0x36e134(0x20b), _0x4aa690), _0x52efe3(_0x36e134(0x8ce)); } } } const _0x3fcf34 = _0x401cc7(); if (!_0x3fcf34 || !_0x44b193) return ![]; const _0x3ce4f8 = _0x10af56(_0x3fcf34['id']), _0x2c98a8 = _0x128784[_0x36e134(0x6e7)]['at'](-0x1)?.[_0x36e134(0x4c9)] === _0x36e134(0x500); if (!force && !_0x2c98a8) return ![]; const _0x1f56cf = _0x128784[_0x36e134(0x6e7)]['at'](-0x1)?.[_0x36e134(0x894)] ?? ![]; if (delayMs) await new Promise(_0x51ad6b => setTimeout(_0x51ad6b, delayMs)); _0x1f56cf ? document[_0x36e134(0x655)](_0x36e134(0x91b))[_0x36e134(0x68f)] = _0x36e134(0x406) : _0x5c804d(!![]); let _0x2704b0 = ''; const _0x95e4bd = _0x401cc7(); if (_0x95e4bd?.[_0x36e134(0x8a0)]?.[_0x36e134(0x88d)]) { const _0xb26fd4 = _0x95e4bd['activeListenSession'], _0x4c9d15 = await _0x298b0c(_0xb26fd4['songId']); if (_0x4c9d15 && _0x4c9d15[_0x36e134(0x35f)]) { const _0x3faae0 = _0x2a3526(_0x4c9d15[_0x36e134(0x35f)]); if (_0x3faae0[_0x36e134(0x36c)] > 0x0) { const _0x13bd3b = _0x70f69b['currentTime']; let _0x33ac9e = -0x1; for (let _0x47dce2 = 0x0; _0x47dce2 < _0x3faae0[_0x36e134(0x36c)]; _0x47dce2++) { if (_0x13bd3b >= _0x3faae0[_0x47dce2][_0x36e134(0x86c)]) _0x33ac9e = _0x47dce2; else break; } const _0x10e1ab = _0x3faae0[_0x36e134(0x946)]((_0x50557c, _0x31adda) => { const _0x12f23f = _0x36e134, _0x46d49a = _0x31adda === _0x33ac9e ? '>>\x20' : ''; return '' + _0x46d49a + _0x50557c[_0x12f23f(0x64b)]; })[_0x36e134(0x9cc)]('\x0a'); _0x2704b0 = (_0x36e134(0x637) + _0xb26fd4[_0x36e134(0x2aa)] + _0x36e134(0x9b7) + _0xb26fd4['songName'] + '》。\x0a这是当前的歌词，请注意带\x20\x27>>\x27\x20标记的正是正在播放的句子。\x0a\x0a[歌词开始]\x0a' + _0x10e1ab + _0x36e134(0x70b))[_0x36e134(0x6df)](); } } } let _0x13bd08 = '', _0x3a1808 = ''; const _0x26216b = _0x128784['conversationHistory'][_0x36e134(0x36c)]; if (_0x26216b > 0x1) { const _0x4a323c = _0x128784[_0x36e134(0x6e7)][_0x26216b - 0x2], _0x4e79a7 = _0x128784[_0x36e134(0x6e7)][_0x26216b - 0x1]; if (_0x4a323c[_0x36e134(0x894)] === ![] && _0x4e79a7[_0x36e134(0x894)] === !![]) _0x36e134(0x1a8) !== _0x36e134(0x1a8) ? (_0x26e6df[_0x36e134(0x1e5)](_0x452bfd[_0x19e4bb][_0x36e134(0x6df)]()), _0x38bab1++) : _0x3a1808 = _0x36e134(0x8f5) + _0x3ce4f8['name'] + _0x36e134(0x4d9); else _0x4a323c[_0x36e134(0x894)] === !![] && _0x4e79a7[_0x36e134(0x894)] === ![] && (_0x3a1808 = '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“' + _0x3ce4f8[_0x36e134(0x4da)] + '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。'); } if (_0x1f56cf) { const _0x4edc34 = _0x36e134(0x444); _0x13bd08 = _0x36e134(0x298) + _0x3ce4f8['name'] + _0x36e134(0x51a) + _0x4edc34 + _0x36e134(0x3c5) + _0x44b193['name'] + _0x36e134(0x8e5) + _0x4edc34 + _0x36e134(0x2e6) + _0x4edc34 + _0x36e134(0x309); } else _0x36e134(0x44b); const { omniText: _0x4704ea } = _0x407b35(_0x44b193['id'], _0x3fcf34['id']), _0x212039 = _0x15bafc(), _0x2d106f = _0x3de826(_0x44b193['id']), _0x1d75ac = typeof _0x5b344c === _0x36e134(0x7d9) ? _0x5b344c[_0x36e134(0x483)]('{charName}', _0x44b193['name'])[_0x36e134(0x483)](_0x36e134(0x5dd), _0x3ce4f8[_0x36e134(0x4da)] || '用户') : '', _0x38d741 = _0x2f0881[_0x36e134(0x946)](_0x2cc0ce => _0x2cc0ce['name'])[_0x36e134(0x9cc)](',\x20'); let _0x566f77 = ''; if (_0x44b193[_0x36e134(0x341)] && _0x44b193[_0x36e134(0x341)][_0x36e134(0x36c)] > 0x0) { const _0xfddb16 = _0x44b193[_0x36e134(0x341)][_0x36e134(0x946)](_0x3883ae => _0x128784[_0x36e134(0x188)]['find'](_0x1c0d5e => _0x1c0d5e['id'] === _0x3883ae))['filter'](Boolean)['map'](_0x5332e8 => _0x36e134(0x895) + _0x5332e8['name'] + '\x0a' + _0x5332e8[_0x36e134(0x472)])[_0x36e134(0x9cc)](''); if (_0xfddb16) _0x566f77 = _0x36e134(0x3cb) + _0xfddb16; } const _0x53d231 = _0x3ce4f8['persona'] ? _0x36e134(0x466) + _0x3ce4f8['name'] + _0x36e134(0x451) + _0x3ce4f8[_0x36e134(0x489)] : ''; let _0x39ec5f = ''; const _0x54a864 = new Date(), _0x60156 = _0xc82808(_0x44b193['id']); _0x39ec5f = _0x36e134(0x5b6), _0x39ec5f += '-\x20**当前精确时间**:\x20' + _0x54a864[_0x36e134(0x1a3)]('zh-CN', { 'dateStyle': _0x36e134(0x7c4), 'timeStyle': 'short' }) + '\x0a'; if (_0x60156) { const _0x351967 = new Date(_0x60156['timestamp']), _0x3c1f16 = _0x37da26(_0x351967); _0x39ec5f += _0x36e134(0x44f) + _0x3c1f16 + '\x0a'; const _0x430009 = _0x54a864[_0x36e134(0x320)](), _0xff9a71 = _0x351967[_0x36e134(0x320)](), _0x404ec6 = new Date(); _0x404ec6[_0x36e134(0x270)](_0x54a864['getDate']() - 0x1); const _0x568b3b = _0x404ec6[_0x36e134(0x320)](); if (_0x430009 === _0xff9a71) { const _0x35efc6 = (_0x54a864 - _0x351967) / (0x3e8 * 0x3c); _0x35efc6 < 0x3c ? _0x36e134(0x1b9) === _0x36e134(0x1b9) ? _0x39ec5f += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a' : (_0x24958a[_0x36e134(0x421)]['add']('is-entering-from-left'), _0x1f8e9e[_0x36e134(0x421)][_0x36e134(0x266)]('is-exiting-right'), _0x1e61f7['classList'][_0x36e134(0x266)]('is-visible'), _0x114734(() => { const _0x49b8df = _0x36e134; _0x5db82a[_0x49b8df(0x421)][_0x49b8df(0x66f)]('is-visible', _0x49b8df(0x195)), _0x21ee7d[_0x49b8df(0x421)][_0x49b8df(0x66f)](_0x49b8df(0x1c3)), _0x2579c4['diaryCurrentPage'] = _0x337839, _0x347663(), _0x3bf68c[_0x49b8df(0x41e)] = ![]; }, 0x2bc)) : _0x39ec5f += _0x36e134(0x362) + Math['round'](_0x35efc6 / 0x3c) + _0x36e134(0x9c5); } else { if (_0x568b3b === _0xff9a71) _0x39ec5f += '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a'; else { const _0x5c5721 = Math[_0x36e134(0x2cd)]((_0x54a864 - _0x351967) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x39ec5f += '-\x20**对话状态提示**:\x20你们已经有\x20' + _0x5c5721 + '\x20天没联系了，应该用全新的问候开启对话，不要再提上次的话题了。\x0a'; } } } else _0x39ec5f += '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a'; const _0x12cb72 = ('\x0a' + _0x13bd08 + _0x36e134(0x92a) + _0x44b193['name'] + _0x36e134(0x5d0) + _0x44b193[_0x36e134(0x4da)] + _0x36e134(0x813) + _0x44b193['name'] + ']\x22\x20等前缀。\x0a如需发送表情，只发送一行：[sticker:表情名]。\x0a【重要】发送表情包时，表情名【必须】从以下列表中选择：[' + _0x38d741 + ']。严禁使用列表之外的任何表情名。\x0a' + _0x1d75ac + '\x0a')[_0x36e134(0x6df)](), _0x50a044 = [{ 'role': _0x36e134(0x960), 'content': _0x12cb72 }], _0x3a7936 = ('\x0a#\x20你的个性（节选）\x0a' + (_0x44b193[_0x36e134(0x489)] || _0x36e134(0x710)) + '\x0a' + _0x53d231 + '\x20\x0a' + _0x4704ea + '\x0a' + _0x212039 + '\x0a' + _0x2d106f + _0x36e134(0x6b6) + _0x2704b0 + '\x0a' + _0x39ec5f + '\x0a' + _0x566f77 + '\x0a')['trim'](); _0x3a7936[_0x36e134(0x55b)](/#.*|\s/g, '') && (_0x50a044['push']({ 'role': 'user', 'content': _0x3a7936 }), _0x50a044[_0x36e134(0x1e5)]({ 'role': _0x36e134(0x600), 'content': _0x36e134(0x720) })); const _0x9b4955 = _0x128784[_0x36e134(0x430)]?.['perChatContextLines'] ?? 0x64, _0x29017a = _0x128784[_0x36e134(0x6e7)]['slice'](-_0x9b4955); for (const _0x3a226e of _0x29017a) { const _0x355258 = _0x3a226e['role'] === 'ai' || _0x3a226e[_0x36e134(0x4c9)] === _0x36e134(0x600) ? _0x36e134(0x600) : 'user'; let _0x5b1281 = { 'role': _0x355258, 'content': _0x3a226e['content'] }, _0x255aaa = !!_0x3a226e[_0x36e134(0x472)]; if (_0x3a226e['displayUrl'] && _0x3a226e['content'][_0x36e134(0x9ac)]('表情')) { const _0x5648fc = _0x3a226e[_0x36e134(0x472)][_0x36e134(0x256)](/：(.*?)]$/); _0x5b1281['content'] = '[sticker:' + (_0x5648fc ? _0x5648fc[0x1] : _0x36e134(0x258)) + ']', _0x50a044[_0x36e134(0x1e5)](_0x5b1281); } else { let _0x37886c = null; if (_0x3a226e['image']) _0x37886c = _0x3a226e[_0x36e134(0x911)]; else { if (_0x3a226e[_0x36e134(0x431)]) try { if (_0x36e134(0x19f) !== _0x36e134(0x19f)) _0x189537(_0x32c969['id'], _0x33ac55[_0x36e134(0x946)](_0x597b5d => _0x597b5d['id'])); else { const _0x14db8f = await _0x226e0a(_0x3a226e[_0x36e134(0x431)]); if (_0x14db8f) { if ('JnvPJ' === 'JnvPJ') _0x37886c = await _0x171ffd(_0x14db8f); else { const _0xddff36 = _0x3b9658[_0x36e134(0x956)](_0x121f39); _0xddff36 && _0xddff36['startsWith'](_0x36e134(0x1e0)) && _0x3899a9[_0x36e134(0x1e5)](_0xddff36); } } } } catch (_0x250da2) { if (_0x36e134(0x485) === _0x36e134(0x485)) console[_0x36e134(0x9de)](_0x36e134(0x5a3), _0x250da2); else { const _0x164cde = _0x6c2624[_0x36e134(0x9bf)]['trim'](), _0x143153 = _0x21775f[_0x36e134(0x9bf)]['trim'](); if (!_0x164cde || !_0x143153) { _0x3b431c(_0x36e134(0x7e9)); return; } _0x167e64({ 'songName': _0x164cde, 'artist': _0x143153 }); } } } _0x37886c && (_0x5b1281['image'] = _0x37886c, _0x255aaa = !![]), _0x255aaa && _0x50a044[_0x36e134(0x1e5)](_0x5b1281); } } try { if (_0x36e134(0x812) !== _0x36e134(0x812)) { const _0x75b8b0 = _0x1f8671['recipientId'] === _0x12fa16(_0x181902[_0x36e134(0x789)])['id'] ? _0x2c179f(_0x11e46b['activeChatId']) : _0x3b939c(_0x4c3aa1[_0x36e134(0x992)]); _0x37255f[_0x36e134(0x7d8)](_0x3aec13, { 'type': _0x36e134(0x4e1), 'amount': _0x37c354['amount'], 'recipientId': _0x28c56b[_0x36e134(0x992)], 'content': _0x36e134(0x492) + (_0x75b8b0?.[_0x36e134(0x4da)] || '未知') + _0x36e134(0x2ac) + _0x265fd7[_0x36e134(0x9d3)] + ']' }); } else { const _0x4ab2b2 = await _0x2e6580(_0x50a044); if (!_0x4ab2b2) return ![]; if (_0x1f56cf) { if (_0x36e134(0x893) === _0x36e134(0x590)) { _0x4f8acf = ![], _0x4b4a30[_0x36e134(0x385)]['display'] = _0x36e134(0x44e), _0x2f1127[_0x36e134(0x655)](_0x36e134(0x326))[_0x36e134(0x385)]['display'] = 'block', _0x367724['getElementById'](_0x36e134(0x2fc))[_0x36e134(0x385)][_0x36e134(0x1cd)] = 'block'; if (!_0x1185f2) { const _0x1fe2ee = _0x37b65b(_0x24180e[_0x36e134(0x50e)]); _0x1fe2ee && (_0x1fe2ee[_0x36e134(0x830)] = _0x24c6ed, _0x3be0e8(_0x41c45d[_0x36e134(0x50e)], 'normal')); } } else try { let _0x161d13 = _0x4ab2b2['trim'](); const _0x49ed91 = _0x161d13['match'](/(\[[\s\S]*\])/); _0x49ed91 && (_0x161d13 = _0x49ed91[0x1]); const _0x311d92 = JSON['parse'](_0x161d13); if (Array[_0x36e134(0x79f)](_0x311d92)) { if (_0x36e134(0x3c2) === _0x36e134(0x3c2)) { _0x128784['activeMeetingScriptQueue'] = _0x311d92, _0x128784[_0x36e134(0x3d1)][_0x44b193['id']] = [..._0x311d92], _0x52a9f3(); const _0x274137 = _0x311d92[_0x36e134(0x946)](_0x4e27d7 => _0x4e27d7[_0x36e134(0x555)] === _0x36e134(0x71b) ? _0x4e27d7[_0x36e134(0x91c)] : _0x4e27d7[_0x36e134(0x555)] + ':\x20' + _0x4e27d7['line'])[_0x36e134(0x9cc)]('\x0a\x0a'); _0x128784[_0x36e134(0x6e7)][_0x36e134(0x1e5)]({ 'role': 'assistant', 'senderId': _0x44b193['id'], 'timestamp': Date[_0x36e134(0x8a2)](), 'isOffline': !![], 'content': _0x274137 }); } else { const _0x1de713 = _0x44e6b1[_0x36e134(0x7c0)](_0x23983d, _0x36e134(0x939)), _0x5d77b6 = _0x1de713['objectStore'](_0x2f1921), _0x59f4f7 = _0x5d77b6[_0x36e134(0x48f)](_0xd0c957); _0x59f4f7['onsuccess'] = () => _0x33b649(), _0x59f4f7[_0x36e134(0x9a7)] = () => _0x1471ca(_0x59f4f7['error']); } } } catch (_0x5e9013) { if ('gvdHS' !== 'gvdHS') { if (_0x399741) { const _0x1cfd7f = _0x1d6504(_0x309599[_0x36e134(0x50e)]); _0x1cfd7f && (delete _0x1cfd7f['spriteTransform'], _0x304a74(), _0xe0f0ab(_0x1cfd7f['id'], _0x36e134(0x850)), _0x13eec9(_0x36e134(0x364)), _0x49ec0e(!![])); } } else console[_0x36e134(0x9de)](_0x36e134(0x2d1), _0x5e9013, _0x36e134(0x4e4), _0x4ab2b2), _0x128784[_0x36e134(0x6e7)][_0x36e134(0x1e5)]({ 'role': _0x36e134(0x600), 'senderId': _0x44b193['id'], 'timestamp': Date[_0x36e134(0x8a2)](), 'isOffline': !![], 'content': _0x36e134(0x82d) + _0x4ab2b2 + ']' }); } } else { const _0x396b8d = _0x3f15ac(_0x4ab2b2), _0x5c3b07 = _0x396b8d[_0x36e134(0x946)](_0x4900c8 => { const _0x144f07 = _0x36e134, _0x20b7c6 = _0x4900c8['trim'](), _0x336b6a = _0x20b7c6[_0x144f07(0x256)](/^\[sticker:(.*?)\]$/), _0x375d77 = _0x20b7c6['match'](/^\[transfer:([\d.]+)\|(.*?)\]$/), _0x29485d = _0x20b7c6[_0x144f07(0x256)](/^\[music:(.*?)\|(.*?)\]$/); if (_0x29485d) return { 'type': _0x144f07(0x2b9), 'songName': _0x29485d[0x1][_0x144f07(0x6df)](), 'artist': _0x29485d[0x2][_0x144f07(0x6df)]() }; else { if (_0x336b6a) return { 'type': _0x144f07(0x33b), 'name': _0x336b6a[0x1]['trim']() }; else { if (_0x375d77) { if (_0x144f07(0x698) !== _0x144f07(0x5fe)) { const _0x25c6ad = parseFloat(_0x375d77[0x1]), _0x1f1702 = _0x375d77[0x2][_0x144f07(0x6df)](), _0x1c4b98 = _0x10af56(_0x128784[_0x144f07(0x789)]); let _0xdccbd5 = null; if (_0x1f1702 === _0x1c4b98[_0x144f07(0x4da)]) _0xdccbd5 = _0x1c4b98['id']; else { const _0x195ed3 = _0x401cc7(); if (_0x195ed3['type'] === 'group') { const _0x3e01f5 = _0x128784[_0x144f07(0x277)][_0x144f07(0x787)](_0x278072 => _0x195ed3[_0x144f07(0x4de)][_0x144f07(0x9ac)](_0x278072['id']) && _0x278072['name'] === _0x1f1702); if (_0x3e01f5) _0xdccbd5 = _0x3e01f5['id']; } } if (_0xdccbd5) return { 'type': _0x144f07(0x4e1), 'amount': _0x25c6ad, 'recipientId': _0xdccbd5, 'senderId': _0x44b193['id'] }; else return { 'type': _0x144f07(0x64b), 'content': _0x144f07(0x179) + _0x1f1702 + _0x144f07(0x5bc) }; } else _0x47c782 = _0x562479[_0x144f07(0x911)]; } else { if (_0x20b7c6) return { 'type': _0x144f07(0x64b), 'content': _0x20b7c6 }; } } } return null; })['filter'](Boolean), _0x598339 = async _0x2dc895 => { const _0x4d10c7 = _0x36e134, _0x386a15 = { 'role': _0x4d10c7(0x600), 'senderId': _0x44b193['id'], 'timestamp': Date['now'](), 'isOffline': _0x1f56cf }; if (_0x2dc895['type'] === _0x4d10c7(0x2b9)) { const { songName: _0x3d4855, artist: _0x33caf9 } = _0x2dc895; _0x386a15['type'] = _0x4d10c7(0x2b9), _0x386a15[_0x4d10c7(0x472)] = _0x4d10c7(0x9bc) + _0x3d4855 + _0x4d10c7(0x7a7) + _0x33caf9 + ']'; try { const _0x3156cf = await _0x20e996(_0x3d4855, _0x33caf9); let _0x4c2886 = null; if (_0x3156cf[_0x4d10c7(0x678)]) { const _0x116a8d = await _0x454232(_0x3156cf['cover']); _0x4c2886 = 'music_cover_' + Date[_0x4d10c7(0x8a2)]() + '_' + Math[_0x4d10c7(0x1c0)](), await _0x36c0a8(_0x4c2886, _0x116a8d); } Object[_0x4d10c7(0x7d8)](_0x386a15, { 'songName': _0x3d4855, 'artist': _0x33caf9, 'coverId': _0x4c2886, 'playableUrl': _0x3156cf[_0x4d10c7(0x237)] }); } catch (_0xbe2c5a) { Object[_0x4d10c7(0x7d8)](_0x386a15, { 'songName': _0x3d4855, 'artist': _0x33caf9, 'coverId': null, 'playableUrl': null }); } } else { if (_0x2dc895[_0x4d10c7(0x3b1)] === _0x4d10c7(0x33b)) { const _0x1a59f3 = _0x2f0881[_0x4d10c7(0x787)](_0x40acc2 => _0x40acc2[_0x4d10c7(0x4da)] === _0x2dc895['name']); if (_0x1a59f3) Object[_0x4d10c7(0x7d8)](_0x386a15, { 'content': '[AI发送了表情：' + _0x1a59f3[_0x4d10c7(0x4da)] + ']', 'displayUrl': _0x1a59f3[_0x4d10c7(0x237)] }); else _0x386a15[_0x4d10c7(0x472)] = '[sticker:' + _0x2dc895['name'] + ']'; } else { if (_0x2dc895['type'] === _0x4d10c7(0x4e1)) { if (_0x4d10c7(0x234) === _0x4d10c7(0x8ca)) _0x8f2e4b[_0x4d10c7(0x9de)]('生成动态回复失败:', _0x58859e), _0x4685a6('大家好像不知道该怎么回复...'); else { const _0x419d2f = _0x2dc895[_0x4d10c7(0x992)] === _0x10af56(_0x128784[_0x4d10c7(0x789)])['id'] ? _0x10af56(_0x128784['activeChatId']) : _0x8351ef(_0x2dc895[_0x4d10c7(0x992)]); Object['assign'](_0x386a15, { 'type': 'transfer', 'amount': _0x2dc895[_0x4d10c7(0x9d3)], 'recipientId': _0x2dc895['recipientId'], 'content': '[AI向\x20' + (_0x419d2f?.[_0x4d10c7(0x4da)] || '未知') + _0x4d10c7(0x2ac) + _0x2dc895[_0x4d10c7(0x9d3)] + ']' }); } } else { if (_0x4d10c7(0x943) !== _0x4d10c7(0x809)) { const _0x37ac3b = _0x26a581(_0x2dc895[_0x4d10c7(0x472)]); Object[_0x4d10c7(0x7d8)](_0x386a15, { 'content': _0x37ac3b['content'], 'quotedMessage': _0x37ac3b['quotedMessage'] }); } else _0x2aab33 = { 'characterId': _0x200d24[_0x4d10c7(0x592)], 'entries': [] }, _0x348f69[_0x4d10c7(0x401)][_0x4d10c7(0x1e5)](_0x4abb60); } } } return _0x386a15; }, _0x24636d = await Promise['all'](_0x5c3b07['map'](_0x598339)); for (const _0x3dfad7 of _0x24636d) { if (_0x3dfad7[_0x36e134(0x472)] || _0x3dfad7['displayUrl'] || _0x3dfad7['type'] === _0x36e134(0x2b9)) { if (_0x36e134(0x613) === _0x36e134(0x40b)) return _0x5e839e[_0x36e134(0x404)][_0x36e134(0x946)](_0x450883 => typeof _0x450883 === _0x36e134(0x7d9) ? _0x450883 : _0x450883?.['content'])[_0x36e134(0x89c)](_0x5d4ce0)[_0x36e134(0x7fe)](_0x27a4c9); else await new Promise(_0x510199 => setTimeout(_0x510199, 0x12c + Math['random']() * 0x190)), _0x128784[_0x36e134(0x6e7)][_0x36e134(0x1e5)](_0x3dfad7), _0x327245(); } } } return _0x1313e9(), _0x327245(), !![]; } } catch (_0x40d72f) { if (_0x40d72f[_0x36e134(0x4da)] !== _0x36e134(0x349)) { console['error']('生成失败:\x20', _0x40d72f); const _0x223706 = { 'role': _0x36e134(0x600), 'content': _0x36e134(0x36a) + _0x40d72f[_0x36e134(0x740)], 'senderId': _0x44b193['id'], 'isOffline': _0x1f56cf }; _0x128784[_0x36e134(0x6e7)][_0x36e134(0x1e5)](_0x223706), _0x327245(); } return ![]; } finally { _0x5c804d(![]); } } } async function _0x5f157b() { const _0x43f8b9 = _0x43c7a1, _0x1159a8 = _0x401cc7(); if (!_0x1159a8 || _0x1159a8['type'] !== _0x43f8b9(0x921)) { _0x420e01(_0x43f8b9(0x639)); return; } if (_0x128784[_0x43f8b9(0x2d7)]) { if (_0x43f8b9(0x7dc) !== _0x43f8b9(0x7dc)) { const _0xb9d40a = _0x1cfd45(_0x1b94b3['authorId']); _0xb9d40a && (_0x4814db = _0xb9d40a[_0x43f8b9(0x4da)], _0x3095f3 = _0xb9d40a[_0x43f8b9(0x4b6)]); } else { _0x420e01(_0x43f8b9(0x5c8)); return; } } const _0x2adcf3 = await _0x17d4de(_0x43f8b9(0x8c8)); if (!_0x2adcf3) return; _0xddfd1b(!![], _0x43f8b9(0x567)), _0x29c201[_0x43f8b9(0x9bf)] = '', _0x3c1821[_0x43f8b9(0x421)][_0x43f8b9(0x266)]('show'), _0x128784[_0x43f8b9(0x2d7)] = !![]; try { const _0x6653ac = _0x8351ef(_0x1159a8[_0x43f8b9(0x4de)][0x0]), _0x4cfa4b = _0x10af56(_0x1159a8['id']), _0x8f67cc = _0xe8e2d1(_0x1159a8['id']); if (_0x8f67cc[_0x43f8b9(0x36c)] === 0x0) { _0x29c201[_0x43f8b9(0x9bf)] = _0x43f8b9(0x5f7); return; } const _0x571829 = _0x8f67cc[_0x43f8b9(0x946)](_0x523db7 => { const _0xc5157 = _0x43f8b9, _0xdad380 = new Date(_0x523db7[_0xc5157(0x89b)]), _0x4f1ceb = _0xdad380[_0xc5157(0x370)]() + '-' + String(_0xdad380[_0xc5157(0x909)]() + 0x1)['padStart'](0x2, '0') + '-' + String(_0xdad380[_0xc5157(0x731)]())[_0xc5157(0x7d2)](0x2, '0'), _0x1572bc = String(_0xdad380['getHours']())[_0xc5157(0x7d2)](0x2, '0') + ':' + String(_0xdad380['getMinutes']())[_0xc5157(0x7d2)](0x2, '0'); let _0x4c30f9 = '未知'; _0x523db7['role'] === 'user' ? _0xc5157(0x8fe) === _0xc5157(0x229) ? (_0x4fb77b[_0xc5157(0x66f)](), _0x20ee48()) : _0x4c30f9 = _0x4cfa4b[_0xc5157(0x4da)] : _0x4c30f9 = _0x6653ac[_0xc5157(0x4da)]; let _0x2405c7 = _0x523db7[_0xc5157(0x472)]; if (_0x523db7[_0xc5157(0x57c)]) _0x2405c7 = _0xc5157(0x751); if (_0x523db7[_0xc5157(0x431)]) _0x2405c7 = _0xc5157(0x98c); return '[' + _0x4f1ceb + '\x20' + _0x1572bc + ']\x20[' + _0x4c30f9 + ']:\x20' + _0x2405c7; })[_0x43f8b9(0x9cc)]('\x0a'), _0x401817 = _0x4ffe1c[_0x43f8b9(0x55b)](/{charName}/g, _0x6653ac[_0x43f8b9(0x4da)])[_0x43f8b9(0x55b)](/{userName}/g, _0x4cfa4b['name']), _0x5aff71 = [{ 'role': _0x43f8b9(0x960), 'content': _0x401817 }, { 'role': _0x43f8b9(0x500), 'content': _0x571829 }], _0x3eb420 = await _0x2e6580(_0x5aff71); _0x29c201[_0x43f8b9(0x9bf)] = _0x3eb420 || _0x43f8b9(0x9a2), _0x29c201['scrollTop'] = 0x0; } catch (_0xc81bf2) { 'qitee' !== _0x43f8b9(0x3fc) ? _0x1917c9('导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a' + _0x27366[_0x43f8b9(0x9cc)]('\x0a')) : (console[_0x43f8b9(0x9de)](_0x43f8b9(0x6ff), _0xc81bf2), _0x29c201[_0x43f8b9(0x9bf)] = _0x43f8b9(0x603) + _0xc81bf2[_0x43f8b9(0x740)]); } finally { _0x43f8b9(0x5bd) !== _0x43f8b9(0x545) ? (_0xddfd1b(![]), _0x128784['isGenerating'] = ![]) : _0x140172[_0x43f8b9(0x84a)] = _0xe682a0[_0x43f8b9(0x9be)](_0xd44204); } } async function _0xf949f2() { const _0x575f95 = _0x43c7a1; console[_0x575f95(0x331)](_0x575f95(0x49e)); if (!_0x128784[_0x575f95(0x8a1)][_0x575f95(0x7cd)] || !_0x128784[_0x575f95(0x8a1)]['key'] || !_0x128784[_0x575f95(0x8a1)][_0x575f95(0x4a9)]) { if (_0x575f95(0x27a) === _0x575f95(0x27a)) { _0x420e01('请先在\x22设置\x22中配置你的\x20API\x20信息。'); return; } else { const _0x3d4f11 = _0x16c4eb[_0x575f95(0x341)][_0x575f95(0x946)](_0x124548 => _0x2563ac[_0x575f95(0x188)]['find'](_0xd8104e => _0xd8104e['id'] === _0x124548))['filter'](_0x31bdc8)[_0x575f95(0x946)](_0xaed96e => _0x575f95(0x895) + _0xaed96e[_0x575f95(0x4da)] + '\x0a' + _0xaed96e[_0x575f95(0x472)])[_0x575f95(0x9cc)](''); if (_0x3d4f11) _0x5dab9f = _0x575f95(0x3cb) + _0x3d4f11; } } const _0x272151 = _0x128784[_0x575f95(0x6e7)]['at'](-0x1)?.[_0x575f95(0x4c9)] === 'user'; if (!_0x272151 || _0x128784[_0x575f95(0x2d7)]) return; const _0x64e3c1 = _0x401cc7(); if (!_0x64e3c1) return; _0x128784[_0x575f95(0x2d7)] = !![], _0x5c804d(!![]); try { if (_0x64e3c1[_0x575f95(0x3b1)] === _0x575f95(0x921)) { if (_0x575f95(0x541) === _0x575f95(0x504)) _0x11bd57[_0x575f95(0x9de)]('Failed\x20to\x20remove\x20history\x20for\x20chat\x20' + _0x12a034['id'], _0x130cf7); else { const _0x2d8a97 = _0x8351ef(_0x64e3c1[_0x575f95(0x4de)][0x0]); console[_0x575f95(0x331)](_0x575f95(0x2cc)); if (_0x2d8a97) await _0x510873(_0x2d8a97, { 'force': !![] }); } } else { const _0x4c30f6 = await _0x5652c7(); if (_0x4c30f6 && _0x4c30f6[_0x575f95(0x9d2)]?.['length']) { if (_0x575f95(0x511) !== 'JklOT') await _0x23b793(_0x4c30f6); else { if (_0x29b4f2[_0x575f95(0x464)]()['toString']()) return; const _0x2b6758 = _0x3a6a99[_0x575f95(0x949)][_0x575f95(0x3bf)](_0x575f95(0x5ab)), _0x18bc53 = _0x568582[_0x575f95(0x949)]['closest'](_0x575f95(0x4a7)); if (!_0x2b6758 || _0x18bc53) return; const _0x12c478 = _0x3f78f2(_0x2b6758[_0x575f95(0x663)][_0x575f95(0x27b)], 0xa); if (_0x5592b7(_0x12c478)) return; _0x4655f7(_0x12c478); } } else { console['warn'](_0x575f95(0x841)); const _0x48be45 = _0x64e3c1[_0x575f95(0x4de)][_0x575f95(0x946)](_0x8351ef)['filter'](Boolean); if (!_0x48be45[_0x575f95(0x36c)]) return; let _0xc7ac33 = 0x0; for (const _0x5a8473 of _0x48be45) { _0x510873(_0x5a8473, { 'force': !![], 'delayMs': _0xc7ac33 }), _0xc7ac33 += 0x1f4; } } } } catch (_0x5e9fc1) { if (_0x575f95(0x2f1) === 'bTnPy') _0x5e9fc1[_0x575f95(0x4da)] !== _0x575f95(0x349) && (console[_0x575f95(0x9de)](_0x575f95(0x25e), _0x5e9fc1), _0x553325({ 'role': 'assistant', 'content': _0x575f95(0x36a) + _0x5e9fc1[_0x575f95(0x740)] }, _0x128784['conversationHistory']['length'] - 0x1)); else { const _0x3813db = _0x2ee86b[_0x575f95(0x7a8)](_0x1c383f[_0x575f95(0x2c6)](_0x575f95(0x584)) || '{}'), _0x5aef93 = { ..._0x3813db, ..._0x13d55d }; _0x5b5ad2[_0x575f95(0x548)]('badgeState', _0x44d853[_0x575f95(0x5e0)](_0x5aef93)); } } finally { _0x128784['isGenerating'] = ![], _0x5c804d(![]); } } function _0x464b44(_0x187e75, _0x13181d) { const _0x1a2a7e = _0x43c7a1; if (_0x1a2a7e(0x529) === _0x1a2a7e(0x529)) { const _0x352daa = _0x13181d['toLowerCase'](), _0x3c1c6f = _0x187e75['toLowerCase'](); if (_0x352daa['startsWith'](_0x1a2a7e(0x955))) return _0x1a2a7e(0x59f); if (_0x3c1c6f[_0x1a2a7e(0x9ac)](_0x1a2a7e(0x480))) return _0x1a2a7e(0x59f); if (_0x3c1c6f[_0x1a2a7e(0x9ac)]('googleapis.com')) return _0x1a2a7e(0x94d); if (_0x352daa[_0x1a2a7e(0x3fd)](_0x1a2a7e(0x94d))) return _0x1a2a7e(0x94d); return _0x1a2a7e(0x350); } else { if (_0xe100d) { const _0x5b781b = _0x21c10e[_0x1a2a7e(0x9be)](_0x557b50); _0x5f29cf['src'] = _0x5b781b, _0x56cae7[_0x1a2a7e(0x74c)] = () => _0x3f21b1[_0x1a2a7e(0x775)](_0x5b781b); } } } async function _0x2e6580(_0x330731, _0x4d3bcd = {}) { const _0x52b57c = _0x43c7a1; _0x128784[_0x52b57c(0x9ca)] && _0x128784[_0x52b57c(0x9ca)]['abort'](_0x52b57c(0x355)); _0x128784[_0x52b57c(0x9ca)] = new AbortController(); const _0x58116b = _0x128784[_0x52b57c(0x9ca)][_0x52b57c(0x2d0)], { endpoint: _0x1029ac, key: _0x68e059, model: _0xb28b14 } = _0x128784['apiSettings'], _0x118b68 = !!_0x4d3bcd['json'], _0x49c3ac = _0x464b44(_0x1029ac, _0xb28b14); console[_0x52b57c(0x331)](_0x52b57c(0x870) + _0x49c3ac); let _0x2d69d3 = ''; try { switch (_0x49c3ac) { case _0x52b57c(0x59f): { const _0x27e36f = _0x59c1a6(_0x68e059), _0xc3b9da = _0x330731[_0x52b57c(0x787)](_0x1fb6ff => _0x1fb6ff[_0x52b57c(0x4c9)] === _0x52b57c(0x960))?.[_0x52b57c(0x472)] || '', _0xabf740 = _0x330731[_0x52b57c(0x89c)](_0x41b42a => _0x41b42a[_0x52b57c(0x4c9)] !== _0x52b57c(0x960)), _0x3bcafc = { 'model': _0xb28b14, 'system': _0xc3b9da, 'messages': _0xabf740[_0x52b57c(0x946)](_0x306342 => ({ 'role': _0x306342[_0x52b57c(0x4c9)], 'content': [{ 'type': 'text', 'text': _0x306342['content'] }] })), 'max_tokens': 0x1000 }, _0x412667 = await fetch(_0x1029ac, { 'method': _0x52b57c(0x39d), 'headers': { 'Content-Type': _0x52b57c(0x1f6), 'x-api-key': _0x27e36f, 'anthropic-version': _0x52b57c(0x57f) }, 'body': JSON['stringify'](_0x3bcafc), 'signal': _0x58116b }); if (!_0x412667['ok']) { const _0x2ea051 = await _0x412667['json']()[_0x52b57c(0x619)](() => ({})); throw new Error(_0x52b57c(0x60a) + _0x412667[_0x52b57c(0x97d)] + _0x52b57c(0x7a7) + (_0x2ea051['error']?.[_0x52b57c(0x740)] || _0x412667['statusText'])); } const _0x5046d3 = await _0x412667['json'](); _0x2d69d3 = _0x5046d3[_0x52b57c(0x472)]?.[0x0]?.[_0x52b57c(0x64b)] || ''; break; } case 'gemini': { if (_0x52b57c(0x33f) === _0x52b57c(0x544)) _0x86230b[_0x52b57c(0x9de)]('Failed\x20to\x20read\x20history\x20for\x20chat\x20' + _0x481e75['activeChatId'], _0x2a217b); else { const _0x183e0f = _0x59c1a6(_0x68e059), _0x237726 = _0x1029ac[_0x52b57c(0x9ac)](_0x52b57c(0x250)), _0x2d9920 = _0x365c91 => { const _0x5be5ad = _0x52b57c, _0x55da50 = []; if (_0x365c91['content']) _0x55da50[_0x5be5ad(0x1e5)]({ 'text': _0x365c91['content'] }); if (_0x365c91['image']) { const _0x4258e7 = _0x365c91['image']['split'](',')[0x1], _0x196938 = _0x365c91[_0x5be5ad(0x911)][_0x5be5ad(0x810)](_0x365c91[_0x5be5ad(0x911)][_0x5be5ad(0x439)](':') + 0x1, _0x365c91['image']['indexOf'](';')) || _0x5be5ad(0x414); _0x55da50[_0x5be5ad(0x1e5)]({ 'inline_data': { 'mime_type': _0x196938, 'data': _0x4258e7 } }); } return _0x55da50; }, _0x42dbfb = _0x330731['map'](_0x2b03f9 => ({ 'role': _0x2b03f9[_0x52b57c(0x4c9)] === _0x52b57c(0x600) ? 'model' : _0x2b03f9[_0x52b57c(0x4c9)] === _0x52b57c(0x960) ? _0x52b57c(0x500) : _0x2b03f9[_0x52b57c(0x4c9)], 'parts': _0x2d9920(_0x2b03f9) }))['filter'](_0x1b5d06 => _0x1b5d06[_0x52b57c(0x7ad)][_0x52b57c(0x36c)] > 0x0), _0x4647d5 = { 'contents': _0x42dbfb }; if (_0x118b68 && _0x237726) { if (_0x52b57c(0x211) !== 'MTxbI') { const _0x1dc97f = _0x3931e4(_0x2e01d0[_0x52b57c(0x4de)][0x0]); _0x1dc97f ? (_0x25213a = _0x1dc97f['avatar'] || _0x3f3e49, _0x1497e4 = _0x1dc97f[_0x52b57c(0x4da)] || _0x52b57c(0x17d), _0x342aa4 = _0x1dc97f[_0x52b57c(0x540)] || '私聊') : (_0x1ad6dd = _0x52b57c(0x4db), _0x3ee96f = _0x52b57c(0x594)); } else _0x4647d5['generationConfig'] = { 'response_mime_type': 'application/json' }; } const _0x3a826c = _0x1029ac + _0x52b57c(0x6f8) + _0xb28b14 + _0x52b57c(0x403) + _0x183e0f + _0x52b57c(0x3c1), _0x481754 = await fetch(_0x3a826c, { 'method': _0x52b57c(0x39d), 'headers': { 'Content-Type': _0x52b57c(0x1f6) }, 'body': JSON['stringify'](_0x4647d5), 'signal': _0x58116b }); if (!_0x481754['ok']) throw new Error(_0x52b57c(0x845) + _0x481754[_0x52b57c(0x97d)]); const _0x5b574f = _0x481754[_0x52b57c(0x307)][_0x52b57c(0x611)](), _0x7dc2f7 = new TextDecoder(); let _0x4b8e6b = ''; while (!![]) { if (_0x58116b[_0x52b57c(0x91a)]) { if (_0x52b57c(0x727) !== _0x52b57c(0x92b)) { console[_0x52b57c(0x331)](_0x52b57c(0x9c6)), _0x5b574f[_0x52b57c(0x273)](); break; } else _0x5e516e[_0x52b57c(0x9ca)] = null; } const { done: _0x444aee, value: _0xaf8f67 } = await _0x5b574f[_0x52b57c(0x20d)](); if (_0x444aee) break; const _0x1a7cb3 = _0x7dc2f7[_0x52b57c(0x282)](_0xaf8f67, { 'stream': !![] }), _0x2e9eea = _0x1a7cb3[_0x52b57c(0x7c7)]('\x0a')[_0x52b57c(0x89c)](_0x2116ee => _0x2116ee[_0x52b57c(0x6df)]()['startsWith'](_0x52b57c(0x62c))); for (const _0x595128 of _0x2e9eea) { if (_0x52b57c(0x9d9) === _0x52b57c(0x6e5)) { const _0x2d0f05 = _0x25586d['createElement'](_0x52b57c(0x76e)); _0x2d0f05[_0x52b57c(0x1f0)] = 'quoted-message-in-bubble'; const _0x490208 = _0x89c2d7[_0x52b57c(0x26b)]('div'); _0x490208[_0x52b57c(0x1f0)] = _0x52b57c(0x3b9), _0x490208[_0x52b57c(0x68f)] = _0x5ba2ca['quotedMessage']['sender']; const _0x318cd9 = _0x37ed88[_0x52b57c(0x26b)](_0x52b57c(0x76e)); _0x318cd9[_0x52b57c(0x1f0)] = 'quoted-content', _0x318cd9[_0x52b57c(0x68f)] = _0x241f2['quotedMessage'][_0x52b57c(0x472)], _0x2d0f05[_0x52b57c(0x3d5)](_0x490208), _0x2d0f05[_0x52b57c(0x3d5)](_0x318cd9), _0x16d52a[_0x52b57c(0x3d5)](_0x2d0f05); } else { const _0x2f54c9 = _0x595128[_0x52b57c(0x55b)]('data:\x20', ''); if (_0x2f54c9 === '[DONE]') break; try { _0x52b57c(0x31f) !== _0x52b57c(0x586) ? _0x4b8e6b += JSON['parse'](_0x2f54c9)['candidates'][0x0][_0x52b57c(0x472)][_0x52b57c(0x7ad)][0x0][_0x52b57c(0x64b)] : _0x221b70[_0x52b57c(0x4f1)] = _0x3fd883['accountingLedger']; } catch { } } } } _0x2d69d3 = _0x4b8e6b; break; } } case 'openai': default: { if (_0x52b57c(0x92f) === 'UusYq') _0x2e0365 = _0xa0740e; else { const _0x5ac0d4 = _0x59c1a6(_0x68e059), _0x3c8f4f = _0x1029ac['replace'](/\/+$/, '') + '/v1/chat/completions', _0x5ab612 = _0x330731['map'](_0x493388 => { const _0x9da834 = _0x52b57c; if (_0x493388[_0x9da834(0x4c9)] === 'user' && _0x493388[_0x9da834(0x911)]) { if (_0x9da834(0x694) === _0x9da834(0x694)) return { 'role': 'user', 'content': [{ 'type': 'text', 'text': _0x493388[_0x9da834(0x472)] || '\x20' }, { 'type': _0x9da834(0x5aa), 'image_url': { 'url': _0x493388[_0x9da834(0x911)], 'detail': _0x9da834(0x6c5) } }] }; else _0x47a51a['src'] = _0x83b997['image']; } return { 'role': _0x493388[_0x9da834(0x4c9)], 'content': _0x493388[_0x9da834(0x472)] }; })[_0x52b57c(0x89c)](_0x2b02f9 => _0x2b02f9['content']), _0x524d35 = { 'model': _0xb28b14, 'messages': _0x5ab612, 'max_tokens': 0x1000, ..._0x118b68 ? { 'response_format': { 'type': _0x52b57c(0x6d9) } } : {} }, _0x47580b = await fetch(_0x3c8f4f, { 'method': _0x52b57c(0x39d), 'headers': { 'Content-Type': _0x52b57c(0x1f6), 'Authorization': _0x52b57c(0x816) + _0x5ac0d4 }, 'body': JSON['stringify'](_0x524d35), 'signal': _0x58116b }); if (!_0x47580b['ok']) { const _0x55a616 = await _0x47580b[_0x52b57c(0x84d)]()[_0x52b57c(0x619)](() => ({})); throw new Error(_0x52b57c(0x5e3) + _0x47580b['status'] + _0x52b57c(0x7a7) + (_0x55a616['error']?.[_0x52b57c(0x740)] || _0x47580b[_0x52b57c(0x773)])); } const _0x76b855 = await _0x47580b[_0x52b57c(0x84d)](); _0x2d69d3 = _0x76b855[_0x52b57c(0x45f)]?.[0x0]?.[_0x52b57c(0x740)]?.[_0x52b57c(0x472)] || ''; break; } } }return _0x2d69d3; } catch (_0x35d8c5) { if (_0x52b57c(0x3ad) === _0x52b57c(0x3ad)) { if (_0x35d8c5[_0x52b57c(0x4da)] === _0x52b57c(0x349)) return console['log'](_0x52b57c(0x488)), ''; throw _0x35d8c5; } else { const _0x394753 = _0x41c450[_0x52b57c(0x2c6)](_0x52b57c(0x25f) + _0x3be982), _0x4eb30f = _0xc71cf5[_0x52b57c(0x7a8)](_0x394753 || '[]'); return _0x31711b[_0x52b57c(0x79f)](_0x4eb30f) ? _0x4eb30f : []; } } finally { if (_0x52b57c(0x63e) === 'VfknU') { _0x4a4814['id'] === _0x373497[_0x52b57c(0x789)] && (_0x118872(), _0x9ddb06['conversationHistory'] = [], _0x3edb65()); try { _0x3f0569[_0x52b57c(0x5c5)](_0x52b57c(0x25f) + _0x1a67b0['id']), _0x23b8a6(_0x52b57c(0x5e7) + _0x5e5511[_0x52b57c(0x4da)] + _0x52b57c(0x8d3)); } catch (_0xf44d86) { _0x51b649[_0x52b57c(0x9de)](_0x52b57c(0x1fa) + _0x4708b5['id'], _0xf44d86), _0x9ca926(_0x52b57c(0x905)); } } else _0x128784['currentAbortController'] && _0x128784[_0x52b57c(0x9ca)][_0x52b57c(0x2d0)] === _0x58116b && ('ODlsF' === 'EPsHm' ? _0x11a9ab = _0xafd24f['parse'](_0x592e10) : _0x128784[_0x52b57c(0x9ca)] = null); } } async function _0x3b6324() { const _0x53636d = _0x43c7a1; if (_0x53636d(0x69d) !== _0x53636d(0x664)) { const _0x5bdbd0 = _0x1bca98['characterEdit'][_0x53636d(0x421)][_0x53636d(0x878)]('active'), _0x4eb1da = _0x5bdbd0 ? _0x4e5ef7['value'] : null; let _0x436c6f = null, _0x23ba84 = ''; if (_0x5bdbd0 && _0x4eb1da) { if (_0x53636d(0x5ba) !== _0x53636d(0x5ba)) { if (_0x2c0c5c) _0x4f343b[_0x53636d(0x68f)] = '▶'; } else { _0x436c6f = _0x128784[_0x53636d(0x295)][_0x53636d(0x787)](_0x43d563 => _0x43d563[_0x53636d(0x3b1)] === 'private' && _0x43d563[_0x53636d(0x4de)][_0x53636d(0x9ac)](_0x4eb1da)); const _0x55ebed = _0x8351ef(_0x4eb1da); _0x23ba84 = _0x55ebed ? _0x55ebed[_0x53636d(0x4da)] : _0x53636d(0x571); } } else { if (_0x128784[_0x53636d(0x789)]) { if (_0x53636d(0x470) !== _0x53636d(0x21e)) { _0x436c6f = _0x401cc7(); const _0x38dc95 = document[_0x53636d(0x655)](_0x53636d(0x3f2))[_0x53636d(0x68f)]; _0x23ba84 = _0x38dc95 || _0x53636d(0x4eb); } else _0x20a017(!![]); } } if (!_0x436c6f) { _0x420e01(_0x53636d(0x1b1)); return; } const _0x4b88bd = await _0x17d4de(_0x53636d(0x4c4) + _0x23ba84 + '\x22\x20的聊天记录吗？此操作不可撤销。'); if (!_0x4b88bd) return; if (_0x436c6f['id'] === _0x128784[_0x53636d(0x789)]) { if ('NwSPT' !== _0x53636d(0x57d)) _0x1e728a(), _0x128784[_0x53636d(0x6e7)] = [], _0x19de4f(); else { const _0x2186e6 = _0x184f5e['toLowerCase'](); if (_0x53dc99[_0x53636d(0x383)](_0x1ed308 => _0x2186e6[_0x53636d(0x3fd)](_0x1ed308))) { const _0x518191 = _0x3ffbc7[_0x2c1c98]; if (typeof _0x518191 === _0x53636d(0x7d9)) _0x207085[_0x53636d(0x1e5)](_0x518191); if (_0x1e8d1d[_0x53636d(0x79f)](_0x518191)) _0x518191[_0x53636d(0x4d0)](_0x1a0024 => { const _0x3b017b = _0x53636d; if (typeof _0x1a0024 === _0x3b017b(0x7d9)) _0x18e44a[_0x3b017b(0x1e5)](_0x1a0024); }); } } } try { localStorage[_0x53636d(0x5c5)](_0x53636d(0x25f) + _0x436c6f['id']); } catch (_0x28dcbd) { console[_0x53636d(0x9de)](_0x53636d(0x757) + _0x436c6f['id'], _0x28dcbd); } _0x420e01('\x22' + _0x23ba84 + _0x53636d(0x8d3)); } else _0x3ff751(), _0x42a65c(![]); } const _0x30b06c = document[_0x43c7a1(0x655)]('export-all-data-button'), _0x401875 = document[_0x43c7a1(0x655)](_0x43c7a1(0x1db)), _0x5879bd = document['getElementById'](_0x43c7a1(0x7a1)); _0x30b06c['addEventListener']('click', async () => { const _0x5dbe4a = _0x43c7a1; _0xddfd1b(!![], _0x5dbe4a(0x68c)); const _0x194470 = []; try { const _0x5e53f4 = { 'localStorageData': {}, 'indexedDBData': {}, 'indexedDBMusicData': [] }; for (let _0x773444 = 0x0; _0x773444 < localStorage[_0x5dbe4a(0x36c)]; _0x773444++) { const _0x3a0adf = localStorage[_0x5dbe4a(0x956)](_0x773444); if (_0x3a0adf) _0x5e53f4[_0x5dbe4a(0x41f)][_0x3a0adf] = localStorage[_0x5dbe4a(0x2c6)](_0x3a0adf); } const _0x4bd54f = await _0x3be08a, _0xf5d586 = _0x4bd54f[_0x5dbe4a(0x7c0)](_0xee1486, 'readonly'), _0xff5c2f = _0xf5d586[_0x5dbe4a(0x4ba)](_0xee1486), _0x21e707 = await new Promise((_0x5469bf, _0xbe2451) => { const _0x8f50c3 = _0x5dbe4a; if (_0x8f50c3(0x3a2) !== 'TwmFM') { const _0x50c59c = _0xff5c2f['getAll'](); _0x50c59c[_0x8f50c3(0x265)] = () => _0x5469bf(_0x50c59c['result']), _0x50c59c[_0x8f50c3(0x9a7)] = () => _0xbe2451(_0x50c59c[_0x8f50c3(0x9de)]); } else return; }); for (const _0x16c787 of _0x21e707) { if (_0x5dbe4a(0x31e) !== _0x5dbe4a(0x642)) { if (_0x16c787['blob'] instanceof Blob) try { 'CzFeN' !== 'GgntF' ? _0x5e53f4['indexedDBData'][_0x16c787['id']] = await _0x171ffd(_0x16c787[_0x5dbe4a(0x780)]) : (_0x4e7dd8(![]), _0x4a164c[_0x5dbe4a(0x9de)]('全量导入失败:', _0x21d7e3), _0x1ed59d(_0x5dbe4a(0x97b) + _0x54cbab['message'])); } catch (_0x529ace) { _0x194470[_0x5dbe4a(0x1e5)](_0x16c787['id']); } } else _0x26be52(), _0xd78211(_0x5dbe4a(0x198), 'home'); } const _0x35fd71 = _0x4bd54f[_0x5dbe4a(0x7c0)](_0xbc13b, _0x5dbe4a(0x257)), _0x2c4954 = _0x35fd71[_0x5dbe4a(0x4ba)](_0xbc13b), _0x356e96 = await new Promise((_0x38e26c, _0x4ce48e) => { const _0x2c1964 = _0x5dbe4a, _0x2e833e = _0x2c4954[_0x2c1964(0x34b)](); _0x2e833e[_0x2c1964(0x265)] = () => _0x38e26c(_0x2e833e[_0x2c1964(0x5a7)]), _0x2e833e[_0x2c1964(0x9a7)] = () => _0x4ce48e(_0x2e833e[_0x2c1964(0x9de)]); }); for (const _0x17294b of _0x356e96) { const _0x457cb3 = { ..._0x17294b }; _0x17294b[_0x5dbe4a(0x2f0)] instanceof Blob && (_0x457cb3[_0x5dbe4a(0x2f0)] = await _0x171ffd(_0x17294b['audio'])), _0x17294b[_0x5dbe4a(0x678)] instanceof Blob && (_0x457cb3[_0x5dbe4a(0x678)] = await _0x171ffd(_0x17294b[_0x5dbe4a(0x678)])), _0x5e53f4['indexedDBMusicData']['push'](_0x457cb3); } const _0x3a8ca8 = new Blob([JSON[_0x5dbe4a(0x5e0)](_0x5e53f4, null, 0x2)], { 'type': _0x5dbe4a(0x1f6) }), _0x5bae12 = URL['createObjectURL'](_0x3a8ca8), _0x5162d3 = document[_0x5dbe4a(0x26b)]('a'), _0x298ffd = new Date(), _0x4e0fcd = _0x298ffd[_0x5dbe4a(0x370)]() + '-' + String(_0x298ffd['getMonth']() + 0x1)['padStart'](0x2, '0') + '-' + String(_0x298ffd[_0x5dbe4a(0x731)]())[_0x5dbe4a(0x7d2)](0x2, '0'); _0x5162d3[_0x5dbe4a(0x456)] = _0x5bae12, _0x5162d3[_0x5dbe4a(0x3b4)] = _0x5dbe4a(0x771) + _0x4e0fcd + '.json', document['body'][_0x5dbe4a(0x3d5)](_0x5162d3), _0x5162d3['click'](), document['body']['removeChild'](_0x5162d3), URL[_0x5dbe4a(0x775)](_0x5bae12), _0xddfd1b(![]), _0x194470[_0x5dbe4a(0x36c)] > 0x0 ? _0x420e01(_0x5dbe4a(0x344) + _0x194470[_0x5dbe4a(0x9cc)]('\x0a')) : _0x420e01(_0x5dbe4a(0x7ff)); } catch (_0x2a572a) { if (_0x5dbe4a(0x7b0) === _0x5dbe4a(0x2e3)) { _0x5e97fa[_0x5dbe4a(0x789)] = null, _0x90d122(), _0x288bed(![]), _0x25dac3[_0x5dbe4a(0x655)](_0x5dbe4a(0x39e))[_0x5dbe4a(0x385)][_0x5dbe4a(0x2ca)] = ''; return; } else _0xddfd1b(![]), console[_0x5dbe4a(0x9de)](_0x5dbe4a(0x7a2), _0x2a572a), _0x420e01(_0x5dbe4a(0x53c) + _0x2a572a[_0x5dbe4a(0x740)]); } }), _0x401875[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x137142 = _0x43c7a1; _0x5879bd[_0x137142(0x783)](); }), _0x5bc0c5[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x25807d), _0x5879bd[_0x43c7a1(0x203)]('change', _0x4e4088 => { const _0x21208b = _0x43c7a1, _0x1e1432 = _0x4e4088[_0x21208b(0x949)]['files'][0x0]; if (!_0x1e1432) return; _0x17d4de(_0x21208b(0x975))[_0x21208b(0x745)](_0x3239ba => { const _0x4f8c8a = _0x21208b; if (!_0x3239ba) { if (_0x4f8c8a(0x696) !== 'MUsRA') _0x5d60df = _0x1dc2a3[_0x4f8c8a(0x89c)](_0x14b468 => _0x14b468 && typeof _0x14b468 === _0x4f8c8a(0x581) && typeof _0x14b468[_0x4f8c8a(0x4c9)] === _0x4f8c8a(0x7d9) && typeof _0x14b468['content'] !== _0x4f8c8a(0x915)); else { _0x5879bd[_0x4f8c8a(0x9bf)] = ''; return; } } _0xddfd1b(!![], _0x4f8c8a(0x90f)); const _0x337117 = new FileReader(); _0x337117[_0x4f8c8a(0x74c)] = async _0x416992 => { const _0x1daf6c = _0x4f8c8a; try { if (_0x1daf6c(0x3a9) === _0x1daf6c(0x1a0)) _0x117039(![]); else { const _0x1a5cd1 = JSON['parse'](_0x416992[_0x1daf6c(0x949)][_0x1daf6c(0x5a7)]); if (!_0x1a5cd1[_0x1daf6c(0x41f)] || !_0x1a5cd1[_0x1daf6c(0x55c)]) throw new Error(_0x1daf6c(0x8f6)); _0xddfd1b(!![], _0x1daf6c(0x85c)); const _0x395917 = await Promise[_0x1daf6c(0x5fb)](Object['keys'](_0x1a5cd1[_0x1daf6c(0x55c)])['map'](async _0x1912ad => { const _0x3a20ab = _0x1daf6c; if (_0x3a20ab(0x95b) === 'lWfhY') _0x3af42d[_0x3a20ab(0x711)] = _0x3a20ab(0x26d) + _0x5f504c + _0x3a20ab(0x547); else { const _0x23145c = _0x1a5cd1[_0x3a20ab(0x55c)][_0x1912ad]; if (typeof _0x23145c === _0x3a20ab(0x7d9) && _0x23145c[_0x3a20ab(0x3fd)](_0x3a20ab(0x62c))) { if (_0x3a20ab(0x6eb) !== _0x3a20ab(0x833)) { const _0x36c9a9 = await _0x454232(_0x23145c); return { 'id': _0x1912ad, 'blob': _0x36c9a9 }; } else { const _0x372a03 = _0xc756a8[_0x3a20ab(0x655)]('home-clock-container'); if (!_0x372a03) return; _0x444842[_0x3a20ab(0x430)]['forceWhiteClock'] ? (_0x372a03[_0x3a20ab(0x385)][_0x3a20ab(0x1cf)] = _0x3a20ab(0x356), _0x372a03['style']['textShadow'] = _0x3a20ab(0x6d8)) : (_0x372a03[_0x3a20ab(0x385)]['color'] = _0x3a20ab(0x4fa), _0x372a03[_0x3a20ab(0x385)]['textShadow'] = _0x3a20ab(0x44e)); } } return null; } }))[_0x1daf6c(0x745)](_0x478437 => _0x478437[_0x1daf6c(0x89c)](Boolean)), _0xdc4802 = []; if (_0x1a5cd1[_0x1daf6c(0x5d5)]) { _0xddfd1b(!![], _0x1daf6c(0x623)); const _0x2a29d3 = _0x1a5cd1[_0x1daf6c(0x5d5)][_0x1daf6c(0x946)](async _0x5a5304 => { const _0x4cabe3 = _0x1daf6c, _0x1ec1f1 = { ..._0x5a5304 }; if (_0x5a5304[_0x4cabe3(0x2f0)]) _0x1ec1f1['audio'] = await _0x454232(_0x5a5304['audio']); if (_0x5a5304[_0x4cabe3(0x678)]) _0x1ec1f1[_0x4cabe3(0x678)] = await _0x454232(_0x5a5304[_0x4cabe3(0x678)]); return _0x1ec1f1; }); _0xdc4802[_0x1daf6c(0x1e5)](...await Promise[_0x1daf6c(0x5fb)](_0x2a29d3)); } _0xddfd1b(!![], _0x1daf6c(0x42a)), localStorage[_0x1daf6c(0x23d)](); for (const _0x4fb428 in _0x1a5cd1[_0x1daf6c(0x41f)]) { if (_0x1daf6c(0x5e4) !== _0x1daf6c(0x5e4)) { _0x414352(_0x1daf6c(0x5e1)); return; } else localStorage['setItem'](_0x4fb428, _0x1a5cd1['localStorageData'][_0x4fb428]); } _0xddfd1b(!![], '正在写入新数据...'); const _0xda288 = await _0x3be08a, _0x31552f = _0xda288['transaction']([_0xee1486, _0xbc13b], _0x1daf6c(0x939)), _0x33276d = _0x31552f[_0x1daf6c(0x4ba)](_0xee1486), _0x338ff2 = _0x31552f[_0x1daf6c(0x4ba)](_0xbc13b); _0x33276d[_0x1daf6c(0x23d)](), _0x338ff2[_0x1daf6c(0x23d)](), _0x395917[_0x1daf6c(0x4d0)](_0x52cc30 => _0x33276d[_0x1daf6c(0x505)](_0x52cc30)), _0xdc4802[_0x1daf6c(0x4d0)](_0xdf5984 => _0x338ff2[_0x1daf6c(0x505)](_0xdf5984)), await new Promise((_0x287307, _0x31050f) => { const _0x54642d = _0x1daf6c; _0x54642d(0x995) === _0x54642d(0x20c) ? (_0x2adaff[_0x54642d(0x21f)] = _0x2500be[_0x54642d(0x21f)]['filter'](_0x508327 => _0x508327['id'] !== _0x485f6e), _0x3b504b[_0x54642d(0x462)] === _0x35dae8 && (_0x62f2b2[_0x54642d(0x462)] = null), _0x561890(), _0x5da308(_0x54642d(0x97f)), _0x2fd585(), _0x2a3e9a('friendCircleList', _0x54642d(0x684))) : (_0x31552f[_0x54642d(0x874)] = _0x287307, _0x31552f[_0x54642d(0x9a7)] = _0x1881d5 => _0x31050f(_0x1881d5[_0x54642d(0x949)]['error'])); }), _0xddfd1b(![]), _0x420e01(_0x1daf6c(0x3e5)), setTimeout(() => location[_0x1daf6c(0x360)](), 0x640); } } catch (_0x421532) { _0x1daf6c(0x96f) !== _0x1daf6c(0x96f) ? (_0x1e98f8(![]), _0x3a2961[_0x1daf6c(0x949)][_0x1daf6c(0x9bf)] = '') : (_0xddfd1b(![]), console[_0x1daf6c(0x9de)](_0x1daf6c(0x60f), _0x421532), _0x420e01('导入失败:\x20' + _0x421532[_0x1daf6c(0x740)])); } finally { _0x5879bd[_0x1daf6c(0x9bf)] = ''; } }, _0x337117[_0x4f8c8a(0x7fa)](_0x1e1432); }); }); function _0xa2df86() { const _0x192678 = _0x43c7a1; _0xc525fe['value'] = _0x128784['apiSettings']['endpoint'] || '', _0x58431b['value'] = _0x128784[_0x192678(0x8a1)][_0x192678(0x956)] || '', _0x122f28[_0x192678(0x9bf)] = _0x128784[_0x192678(0x8a1)][_0x192678(0x4a9)] || '', _0x160945['value'] = String(_0x128784['preferences']?.[_0x192678(0x3cc)] ?? 0x64), document[_0x192678(0x655)]('api-provider')['value'] = _0x128784[_0x192678(0x8a1)][_0x192678(0x1b8)] || _0x192678(0x350); } function _0x43a1ab() { const _0x42cffb = _0x43c7a1; _0x128784[_0x42cffb(0x8a1)][_0x42cffb(0x7cd)] = _0xc525fe[_0x42cffb(0x9bf)]['trim'](), _0x128784['apiSettings'][_0x42cffb(0x956)] = _0x58431b[_0x42cffb(0x9bf)][_0x42cffb(0x6df)](), _0x128784['apiSettings'][_0x42cffb(0x4a9)] = _0x122f28[_0x42cffb(0x9bf)][_0x42cffb(0x6df)](), _0x128784[_0x42cffb(0x8a1)][_0x42cffb(0x1b8)] = document[_0x42cffb(0x655)](_0x42cffb(0x906))['value']; const _0x10484c = parseInt(_0x160945[_0x42cffb(0x9bf)], 0xa); _0x128784['preferences'][_0x42cffb(0x3cc)] = Number[_0x42cffb(0x2f4)](_0x10484c) && _0x10484c > 0x0 ? _0x10484c : 0x64, _0x5eb81f(), _0x420e01(_0x42cffb(0x423)); } function _0x3400c0() { const _0x3557d3 = _0x43c7a1; _0x4d70c1[_0x3557d3(0x9bf)] = _0x128784['userProfile'][_0x3557d3(0x4da)] || '', _0x415175[_0x3557d3(0x84a)] = _0x128784['userProfile'][_0x3557d3(0x4b6)] || _0x473193, _0x316e87[_0x3557d3(0x9bf)] = _0x128784[_0x3557d3(0x50a)]['persona'] || ''; } function _0x4f3052() { const _0x5d6c33 = _0x43c7a1; _0x5d6c33(0x467) !== _0x5d6c33(0x7b9) ? (_0x128784[_0x5d6c33(0x50a)]['name'] = _0x4d70c1['value'][_0x5d6c33(0x6df)](), _0x128784[_0x5d6c33(0x50a)]['persona'] = _0x316e87[_0x5d6c33(0x9bf)][_0x5d6c33(0x6df)](), _0x5eb81f(), _0x19de4f(), _0x420e01('个人资料已保存！'), _0xcf54be('settings', _0x5d6c33(0x50a))) : _0x26ead9[_0x5d6c33(0x6e7)] = []; } async function _0xe68812(_0x35b0e5 = null) { const _0xaf0a6 = _0x43c7a1; if (_0xaf0a6(0x9a6) !== _0xaf0a6(0x6e6)) { const _0x176ed8 = _0x1dfb8c; _0xcf54be(_0xaf0a6(0x454), _0x176ed8); const _0x52e1a9 = document['getElementById']('world-book-checkboxes-container'); _0x52e1a9[_0xaf0a6(0x711)] = '', _0x128784[_0xaf0a6(0x188)][_0xaf0a6(0x4d0)](_0x1708b0 => { const _0x1e55d3 = _0xaf0a6, _0x37b728 = document[_0x1e55d3(0x26b)]('label'); _0x37b728[_0x1e55d3(0x711)] = '<input\x20type=\x22checkbox\x22\x20value=\x22' + _0x1708b0['id'] + '\x22>\x20' + _0x1708b0[_0x1e55d3(0x4da)], _0x52e1a9[_0x1e55d3(0x3d5)](_0x37b728); }), _0x44a098(_0xaf0a6(0x4d5)), _0x460708[_0xaf0a6(0x84a)] = '', _0x2a98fe[_0xaf0a6(0x9bf)] = '', _0x55f1f4[_0xaf0a6(0x84a)] = '', _0x3795aa['value'] = '', _0x307e1f[_0xaf0a6(0x84a)] = '', _0x2319e8['value'] = ''; const _0x259e12 = ['normal', _0xaf0a6(0x89e), _0xaf0a6(0x4b0), _0xaf0a6(0x29f), _0xaf0a6(0x846)]; _0x259e12[_0xaf0a6(0x4d0)](_0x4ad9e6 => { const _0x1dc658 = _0xaf0a6; 'EGIng' === _0x1dc658(0x278) ? (document[_0x1dc658(0x655)](_0x1dc658(0x748) + _0x4ad9e6 + _0x1dc658(0x6f5))[_0x1dc658(0x84a)] = '', document[_0x1dc658(0x655)](_0x1dc658(0x748) + _0x4ad9e6 + _0x1dc658(0x42b))[_0x1dc658(0x9bf)] = '') : _0x3032ad('错误:\x20' + _0x24a0b2[_0x1dc658(0x740)]); }); if (_0x35b0e5) { const _0x537fc = _0x128784[_0xaf0a6(0x277)][_0xaf0a6(0x787)](_0x1d1e4d => _0x1d1e4d['id'] === _0x35b0e5); if (!_0x537fc) return; _0x4e5ef7[_0xaf0a6(0x9bf)] = _0x537fc['id'], _0x30c654['textContent'] = '编辑角色', _0x33f7a8['value'] = _0x537fc['name'], _0x151fa3[_0xaf0a6(0x9bf)] = _0x537fc['remark'], _0x41ba65[_0xaf0a6(0x9bf)] = _0x537fc[_0xaf0a6(0x489)], document[_0xaf0a6(0x655)]('char-edit-css')[_0xaf0a6(0x9bf)] = _0x537fc['bubbleCss'] || ''; const _0x4d6f27 = _0x128784[_0xaf0a6(0x295)][_0xaf0a6(0x787)](_0x2b1034 => _0x2b1034[_0xaf0a6(0x3b1)] === _0xaf0a6(0x921) && _0x2b1034['participantIds']['includes'](_0x35b0e5)); document[_0xaf0a6(0x655)](_0xaf0a6(0x4d5))[_0xaf0a6(0x9bf)] = _0x4d6f27?.[_0xaf0a6(0x4a0)] || _0x128784[_0xaf0a6(0x226)]; try { const _0x16aadf = await _0x226e0a(_0xaf0a6(0x38e) + _0x537fc['id']), _0x39e3e0 = await _0x226e0a('char_wallpaper_' + _0x537fc['id']), _0x47b7a7 = await _0x226e0a(_0xaf0a6(0x524) + _0x537fc['id']); _0x460708[_0xaf0a6(0x84a)] = _0x16aadf ? URL[_0xaf0a6(0x9be)](_0x16aadf) : _0x537fc[_0xaf0a6(0x4b6)] || _0x3834ec; if (_0x39e3e0) _0x55f1f4[_0xaf0a6(0x84a)] = URL['createObjectURL'](_0x39e3e0); if (_0x47b7a7) _0x307e1f[_0xaf0a6(0x84a)] = URL['createObjectURL'](_0x47b7a7); for (const _0x39ca16 of _0x259e12) { if (_0xaf0a6(0x52f) === 'Ahnjz') _0x1b928c[_0xaf0a6(0x385)][_0xaf0a6(0x1cd)] = _0xaf0a6(0x4d4), _0x496ac5(() => _0x1133c1['classList'][_0xaf0a6(0x266)](_0xaf0a6(0x8d5)), 0xa); else { const _0x4bba30 = await _0x226e0a(_0xaf0a6(0x67c) + _0x39ca16 + '_' + _0x537fc['id']); _0x4bba30 && (document[_0xaf0a6(0x655)]('char-edit-sprite-' + _0x39ca16 + '-preview')['src'] = URL[_0xaf0a6(0x9be)](_0x4bba30)); } } } catch (_0x321e88) { if (_0xaf0a6(0x436) === 'Hbpqw') console[_0xaf0a6(0x9de)](_0xaf0a6(0x89a) + _0x537fc['id'] + _0xaf0a6(0x6e4), _0x321e88), _0x460708['src'] = _0x537fc[_0xaf0a6(0x4b6)] || _0x3834ec; else { const _0x2a48d5 = _0x451c70[_0xaf0a6(0x21f)]['find'](_0x5f54e7 => _0x5f54e7['id'] === _0x1d03ec[_0xaf0a6(0x462)]), _0x40c333 = _0x22dea1(); let _0x4913a3 = []; if (_0x2a48d5 && _0x2a48d5[_0xaf0a6(0x1e2)]) { const _0x5c7e3f = _0x2a48d5[_0xaf0a6(0x1e2)][_0xaf0a6(0x89c)](_0x1bbe11 => _0x1bbe11[_0xaf0a6(0x3b1)] === _0xaf0a6(0x2b9) && _0x1bbe11[_0xaf0a6(0x36f)])[_0xaf0a6(0x946)](_0x12900e => ({ ..._0x12900e, 'source': 'feed' })); _0x4913a3['push'](..._0x5c7e3f); } if (_0x40c333 && _0x47d6ef[_0xaf0a6(0x6e7)]) { const _0x44701c = _0x4c0d4e[_0xaf0a6(0x6e7)][_0xaf0a6(0x89c)](_0x1620b1 => _0x1620b1[_0xaf0a6(0x3b1)] === _0xaf0a6(0x2b9) && _0x1620b1[_0xaf0a6(0x36f)])[_0xaf0a6(0x946)](_0x59308a => ({ ..._0x59308a, 'source': 'chat' })); _0x4913a3['push'](..._0x44701c); } const _0xa06fe1 = _0x17afbb[_0xaf0a6(0x82f)](new _0x3f9db6(_0x4913a3['map'](_0x1fd588 => [_0x1fd588[_0xaf0a6(0x36f)], _0x1fd588]))[_0xaf0a6(0x799)]()); _0x8fa334[_0xaf0a6(0x20a)] = _0xa06fe1[_0xaf0a6(0x8e2)]((_0x27bd90, _0x5e88ce) => _0x5e88ce[_0xaf0a6(0x89b)] - _0x27bd90[_0xaf0a6(0x89b)]); } } _0x537fc[_0xaf0a6(0x341)] && ('saBfF' !== _0xaf0a6(0x90e) ? _0x52e1a9[_0xaf0a6(0x49d)](_0xaf0a6(0x56f))[_0xaf0a6(0x4d0)](_0x16d6fe => { const _0x3ce1e1 = _0xaf0a6; if (_0x3ce1e1(0x8d0) !== _0x3ce1e1(0x8d0)) { if (_0x52d81c[_0x3ce1e1(0x3b1)] === _0x3ce1e1(0x6a3)) _0xb7485['preventDefault'](); _0x2e5b2e(_0x396e7e(_0x4a3fc8, 0xa), _0x4d1a61); } else { if (_0x537fc['linkedWorldBookIds'][_0x3ce1e1(0x9ac)](_0x16d6fe[_0x3ce1e1(0x9bf)])) _0x16d6fe[_0x3ce1e1(0x30c)] = !![]; } }) : _0x4196e6[_0xaf0a6(0x203)]('click', () => { const _0x11e87e = _0xaf0a6; if (_0x4348f6[_0x11e87e(0x36c)] === 0x0) return; _0x506fa3 = (_0x46138c - 0x1 + _0x390eda[_0x11e87e(0x36c)]) % _0xda66cd[_0x11e87e(0x36c)], _0x10b44c(_0x27edef[_0x65d29b], _0x3c719f); })), _0x1a93bb(); } else { if (_0xaf0a6(0x506) !== _0xaf0a6(0x443)) _0x4e5ef7[_0xaf0a6(0x9bf)] = '', _0x30c654['textContent'] = '创建新角色', _0x33f7a8[_0xaf0a6(0x9bf)] = _0xaf0a6(0x318) + (_0x128784['characters'][_0xaf0a6(0x36c)] + 0x1), _0x151fa3['value'] = '', _0x460708[_0xaf0a6(0x84a)] = _0x3834ec, _0x41ba65[_0xaf0a6(0x9bf)] = '你是一个乐于助人的AI助手。', document[_0xaf0a6(0x655)](_0xaf0a6(0x7c5))['value'] = '', _0x1a93bb(); else { const _0xbb6031 = _0x3774d9[_0xaf0a6(0x949)][_0xaf0a6(0x275)][0x0]; if (!_0xbb6031) return; const _0x39b244 = _0x18e9b3[_0xaf0a6(0x9be)](_0xbb6031); _0x1fb578['src'] = _0x39b244, _0x33bbe2['onload'] = () => { _0x357eb1['revokeObjectURL'](_0x39b244); }; } } const _0x41cfb9 = document[_0xaf0a6(0x655)](_0xaf0a6(0x7c5)); let _0x161a07 = document[_0xaf0a6(0x655)](_0xaf0a6(0x819)); !_0x161a07 && (_0x161a07 = document[_0xaf0a6(0x26b)](_0xaf0a6(0x385)), _0x161a07['id'] = _0xaf0a6(0x819), document['head'][_0xaf0a6(0x3d5)](_0x161a07)); const _0x44d3df = () => { const _0x287937 = _0xaf0a6; if ('BWPQp' === 'BWPQp') { const _0x21eab8 = _0x41cfb9['value']; let _0xf9ebd9 = _0x21eab8['replace'](/\.bubble\.sent/g, _0x287937(0x1af))[_0x287937(0x55b)](/\.bubble\.received/g, _0x287937(0x25b)); _0x161a07[_0x287937(0x711)] = _0xf9ebd9; } else { const _0x315c4b = _0x5cab11[_0x287937(0x7c0)](_0x4d367b, _0x287937(0x939)), _0xab411e = _0x315c4b[_0x287937(0x4ba)](_0x4255a9), _0xb27cd2 = _0xab411e[_0x287937(0x505)](_0x1e21ba); _0xb27cd2['onsuccess'] = () => _0x113880(_0xb27cd2[_0x287937(0x5a7)]), _0xb27cd2['onerror'] = () => _0x6400b9(_0xb27cd2[_0x287937(0x9de)]); } }; _0x41cfb9[_0xaf0a6(0x6bf)]('input', _0x44d3df), _0x41cfb9[_0xaf0a6(0x203)](_0xaf0a6(0x2cb), _0x44d3df), _0x44d3df(); } else _0x4172b5[_0xaf0a6(0x592)] = null, _0x1e1260(_0xaf0a6(0x53f), _0xaf0a6(0x888)); } async function _0x39c756() { const _0x1d0508 = _0x43c7a1, _0x2ddc18 = _0x4e5ef7['value']; if (!_0x2ddc18) { _0x420e01(_0x1d0508(0x224)); return; } const _0x465417 = _0x8351ef(_0x2ddc18); if (!_0x465417) return; _0xddfd1b(!![], _0x1d0508(0x43a) + _0x465417['name'] + _0x1d0508(0x778)); try { const _0x3f66bd = { 'type': 'NoirCharacterCard', 'version': 0x1, 'name': _0x465417['name'], 'remark': _0x465417['remark'], 'persona': _0x465417[_0x1d0508(0x489)], 'bubbleCss': _0x465417[_0x1d0508(0x7c3)], 'avatar': null, 'sprites': {}, 'worldBooks': [] }, _0xbbcf8c = await _0x226e0a(_0x1d0508(0x38e) + _0x465417['id']); if (_0xbbcf8c) _0x3f66bd[_0x1d0508(0x4b6)] = await _0x171ffd(_0xbbcf8c); const _0x3f4f1d = ['normal', _0x1d0508(0x89e), _0x1d0508(0x4b0), _0x1d0508(0x29f), _0x1d0508(0x846)]; for (const _0xb729de of _0x3f4f1d) { const _0x137ad1 = await _0x226e0a('char_sprite_' + _0xb729de + '_' + _0x465417['id']); _0x137ad1 && (_0x3f66bd[_0x1d0508(0x842)][_0xb729de] = await _0x171ffd(_0x137ad1)); } _0x465417[_0x1d0508(0x341)] && _0x465417[_0x1d0508(0x341)][_0x1d0508(0x36c)] > 0x0 && ('zNwCF' === _0x1d0508(0x4be) ? _0xe5ebab[_0x1d0508(0x647)] = ![] : _0x3f66bd[_0x1d0508(0x188)] = _0x465417[_0x1d0508(0x341)][_0x1d0508(0x946)](_0x4bb544 => _0x128784[_0x1d0508(0x188)][_0x1d0508(0x787)](_0x55107f => _0x55107f['id'] === _0x4bb544))['filter'](Boolean)['map'](_0x50c831 => ({ 'name': _0x50c831[_0x1d0508(0x4da)], 'content': _0x50c831[_0x1d0508(0x472)] }))); const _0x2e745d = new Blob([JSON[_0x1d0508(0x5e0)](_0x3f66bd, null, 0x2)], { 'type': 'application/json' }), _0x30bda7 = URL[_0x1d0508(0x9be)](_0x2e745d), _0x12c477 = document[_0x1d0508(0x26b)]('a'); _0x12c477[_0x1d0508(0x456)] = _0x30bda7, _0x12c477[_0x1d0508(0x3b4)] = _0x465417[_0x1d0508(0x4da)] + _0x1d0508(0x28f), document[_0x1d0508(0x307)]['appendChild'](_0x12c477), _0x12c477[_0x1d0508(0x783)](), document[_0x1d0508(0x307)][_0x1d0508(0x595)](_0x12c477), URL[_0x1d0508(0x775)](_0x30bda7); } catch (_0x508078) { if (_0x1d0508(0x41a) !== _0x1d0508(0x8de)) console['error']('导出角色卡失败:', _0x508078), _0x420e01(_0x1d0508(0x58f) + _0x508078[_0x1d0508(0x740)]); else { if (_0x156591[_0x1d0508(0x4c9)] === 'user' && _0x821c0b[_0x1d0508(0x911)]) return { 'role': _0x1d0508(0x500), 'content': [{ 'type': _0x1d0508(0x64b), 'text': _0x1eec21[_0x1d0508(0x472)] || '\x20' }, { 'type': _0x1d0508(0x5aa), 'image_url': { 'url': _0x24b73e[_0x1d0508(0x911)], 'detail': _0x1d0508(0x6c5) } }] }; return { 'role': _0x2f3d4f[_0x1d0508(0x4c9)], 'content': _0x2711c0[_0x1d0508(0x472)] }; } } finally { _0xddfd1b(![]); } } async function _0x28f767(_0x38a76a) { const _0x4314f0 = _0x43c7a1, _0x465edc = _0x38a76a[_0x4314f0(0x949)][_0x4314f0(0x275)][0x0]; if (!_0x465edc) return; _0xddfd1b(!![], _0x4314f0(0x56c)); const _0x193628 = new FileReader(); _0x193628['onload'] = async _0x15ea66 => { const _0x2f92e6 = _0x4314f0; if (_0x2f92e6(0x27c) === _0x2f92e6(0x412)) { const _0x343822 = (_0x2449fb[_0x2f92e6(0x33b)] ?? _0x5d7d78[_0x2f92e6(0x515)] ?? _0x20b562[_0x2f92e6(0x469)] ?? _0x541111[_0x2f92e6(0x892)])?.[_0x2f92e6(0x6df)](); if (_0x343822 && _0x1b7336[_0x2f92e6(0x6cd)](_0x343822)) _0x2d6dcf[_0x2f92e6(0x9d2)][_0x2f92e6(0x1e5)]({ 'senderId': _0x2918ae['id'], 'kind': 'sticker', 'sticker': _0x343822 }); else { const _0x41f661 = _0x52df1e(_0x11a737[_0x2f92e6(0x472)] ?? _0x6b1ca8[_0x2f92e6(0x64b)] ?? '')[_0x2f92e6(0x6df)]() || _0x2f92e6(0x593) + (_0x343822 || _0x2f92e6(0x258)) + ']'; if (_0x41f661) _0x31bb53[_0x2f92e6(0x9d2)][_0x2f92e6(0x1e5)]({ 'senderId': _0x58ef9c['id'], 'kind': _0x2f92e6(0x64b), 'content': _0x41f661 }); } } else try { if (_0x2f92e6(0x8a8) === _0x2f92e6(0x8a8)) { const _0x21f48d = JSON['parse'](_0x15ea66['target']['result']); if (_0x21f48d[_0x2f92e6(0x3b1)] !== 'NoirCharacterCard') { if ('oWOag' === _0x2f92e6(0x32f)) _0x2feb57 = _0x2c4717['max'](..._0x4f046b[_0x2f92e6(0x1e2)][_0x2f92e6(0x946)](_0x447a36 => _0x447a36['timestamp'])); else throw new Error(_0x2f92e6(0x876)); } const _0x29ced0 = []; if (_0x21f48d[_0x2f92e6(0x188)] && _0x21f48d[_0x2f92e6(0x188)][_0x2f92e6(0x36c)] > 0x0) { if ('echqu' === _0x2f92e6(0x898)) _0x30a459(_0x1db8ec['id']), _0x37d888(_0x2f92e6(0x5e7) + _0x741187['name'] + _0x2f92e6(0x987)), _0x4d411d(![]); else for (const _0xaecbcd of _0x21f48d[_0x2f92e6(0x188)]) { let _0x420e04 = _0x128784[_0x2f92e6(0x188)]['find'](_0x22b0dd => _0x22b0dd[_0x2f92e6(0x4da)] === _0xaecbcd[_0x2f92e6(0x4da)]); if (_0x420e04) 'OAxFT' === _0x2f92e6(0x23a) ? _0x29ced0[_0x2f92e6(0x1e5)](_0x420e04['id']) : _0x543847[_0x2f92e6(0x203)](_0x2f92e6(0x783), function () { const _0x5b7b83 = _0x2f92e6, _0x1a9611 = { 'id': 'msg_' + _0x24622d[_0x5b7b83(0x89b)], 'url': _0x187e85['playableUrl'] }; _0x3d8866(this, _0x1a9611); }); else { const _0xdc4569 = { 'id': _0x2f92e6(0x650) + Date[_0x2f92e6(0x8a2)]() + '_' + Math[_0x2f92e6(0x1c0)](), 'name': _0xaecbcd[_0x2f92e6(0x4da)], 'content': _0xaecbcd[_0x2f92e6(0x472)] }; _0x128784[_0x2f92e6(0x188)][_0x2f92e6(0x1e5)](_0xdc4569), _0x29ced0[_0x2f92e6(0x1e5)](_0xdc4569['id']); } } } const _0x3e33a0 = _0x2f92e6(0x5c3) + Date['now'](), _0x3462af = { 'id': _0x3e33a0, 'name': _0x21f48d['name'], 'remark': _0x21f48d[_0x2f92e6(0x540)] || '', 'persona': _0x21f48d[_0x2f92e6(0x489)], 'avatar': _0x21f48d[_0x2f92e6(0x4b6)] || _0x3834ec, 'linkedWorldBookIds': _0x29ced0, 'bubbleCss': _0x21f48d['bubbleCss'] || '' }; if (_0x21f48d[_0x2f92e6(0x4b6)]) { if (_0x2f92e6(0x23c) === _0x2f92e6(0x913)) _0x479e46[_0x2f92e6(0x68f)] = _0x2f92e6(0x57b) + _0x355162['length'] + '\x20项'; else { const _0x18c994 = await _0x454232(_0x21f48d[_0x2f92e6(0x4b6)]); await _0x36c0a8(_0x2f92e6(0x38e) + _0x3e33a0, _0x18c994); } } if (_0x21f48d[_0x2f92e6(0x842)]) { if (_0x2f92e6(0x57a) === _0x2f92e6(0x57a)) for (const _0x955d15 in _0x21f48d[_0x2f92e6(0x842)]) { if (_0x2f92e6(0x532) !== _0x2f92e6(0x332)) { const _0x1df5e5 = _0x21f48d[_0x2f92e6(0x842)][_0x955d15], _0xf82d15 = await _0x454232(_0x1df5e5); await _0x36c0a8(_0x2f92e6(0x67c) + _0x955d15 + '_' + _0x3e33a0, _0xf82d15); } else { _0x1f168f(_0x2f92e6(0x8ed)); return; } } else _0x969d6e['push']({ 'time': _0x48d3a0, 'text': _0xa0beb0 }); } _0x128784[_0x2f92e6(0x277)][_0x2f92e6(0x1e5)](_0x3462af); const _0x5d107b = { 'id': 'chat_' + _0x3e33a0, 'type': _0x2f92e6(0x921), 'participantIds': [_0x3e33a0], 'boundUserProfileId': _0x128784['activeUserProfileId'] }; _0x128784[_0x2f92e6(0x295)]['push'](_0x5d107b), _0x5eb81f(), _0x151457(), _0x420e01('“' + _0x3462af[_0x2f92e6(0x4da)] + _0x2f92e6(0x2e8)); } else _0x335336(() => { const _0x4564c3 = _0x2f92e6; _0x324ca2['scrollTop'] = _0x52872f[_0x4564c3(0x53d)]; }, 0x0); } catch (_0x8561f2) { console[_0x2f92e6(0x9de)](_0x2f92e6(0x28b), _0x8561f2), _0x420e01(_0x2f92e6(0x934) + _0x8561f2['message']); } finally { _0xddfd1b(![]), _0x38a76a[_0x2f92e6(0x949)][_0x2f92e6(0x9bf)] = ''; } }, _0x193628[_0x4314f0(0x7fa)](_0x465edc); } async function _0x2e749a() { const _0x3d1e95 = _0x43c7a1, _0x1dad59 = _0x4e5ef7['value']; let _0x1f56d9 = null; const _0x360d40 = _0x2a98fe[_0x3d1e95(0x275)][0x0], _0x2612e2 = _0x3795aa['files'][0x0], _0x45ccc2 = _0x2319e8[_0x3d1e95(0x275)][0x0], _0x5c2660 = document[_0x3d1e95(0x49d)](_0x3d1e95(0x798)), _0x3827f6 = Array['from'](_0x5c2660)['map'](_0x343b32 => _0x343b32[_0x3d1e95(0x9bf)]), _0x2934f5 = { 'name': _0x33f7a8[_0x3d1e95(0x9bf)][_0x3d1e95(0x6df)](), 'remark': _0x151fa3['value'][_0x3d1e95(0x6df)](), 'persona': _0x41ba65[_0x3d1e95(0x9bf)]['trim'](), 'linkedWorldBookIds': _0x3827f6, 'boundUserProfileId': document['getElementById']('char-edit-bind-user')[_0x3d1e95(0x9bf)], 'bubbleCss': document[_0x3d1e95(0x655)](_0x3d1e95(0x7c5))['value'][_0x3d1e95(0x6df)]() }; if (!_0x2934f5[_0x3d1e95(0x4da)]) { _0x420e01(_0x3d1e95(0x50f)); return; } try { const _0x497d9 = [_0x3d1e95(0x850), _0x3d1e95(0x89e), _0x3d1e95(0x4b0), 'sad', 'shy']; if (_0x1dad59) { const _0x47cf22 = _0x128784['characters'][_0x3d1e95(0x787)](_0xbea0e3 => _0xbea0e3['id'] === _0x1dad59); if (_0x47cf22) { if (_0x3d1e95(0x883) !== _0x3d1e95(0x883)) { const _0x51c657 = { 'id': _0x3d1e95(0x39c) + _0x259d0f['now'](), 'name': _0x45a19f, 'boundUserProfileId': _0x171fc4, 'memberCharacterIds': _0x515a25, 'posts': [] }; _0x391840[_0x3d1e95(0x21f)]['push'](_0x51c657); } else { Object[_0x3d1e95(0x7d8)](_0x47cf22, _0x2934f5); if (_0x360d40) _0x47cf22['avatar'] = await _0x5484a4(_0x360d40); } } if (_0x360d40) await _0x36c0a8(_0x3d1e95(0x38e) + _0x1dad59, _0x360d40); if (_0x2612e2) await _0x36c0a8('char_wallpaper_' + _0x1dad59, _0x2612e2); if (_0x45ccc2) await _0x36c0a8(_0x3d1e95(0x524) + _0x1dad59, _0x45ccc2); for (const _0x1fd2a5 of _0x497d9) { const _0x5cb2d5 = document[_0x3d1e95(0x655)](_0x3d1e95(0x748) + _0x1fd2a5 + _0x3d1e95(0x42b))[_0x3d1e95(0x275)][0x0]; if (_0x5cb2d5) await _0x36c0a8(_0x3d1e95(0x67c) + _0x1fd2a5 + '_' + _0x1dad59, _0x5cb2d5); } } else { _0x1f56d9 = 'char_' + Date[_0x3d1e95(0x8a2)](); const _0x4ccb28 = { 'id': _0x1f56d9, ..._0x2934f5 }; _0x4ccb28[_0x3d1e95(0x4b6)] = _0x360d40 ? await _0x5484a4(_0x360d40) : _0x3834ec, _0x128784[_0x3d1e95(0x277)]['push'](_0x4ccb28); const _0x51ea7f = { 'id': _0x3d1e95(0x5e2) + _0x1f56d9, 'type': _0x3d1e95(0x921), 'participantIds': [_0x1f56d9], 'boundUserProfileId': _0x2934f5[_0x3d1e95(0x4a0)], 'listenTogetherSession': null }; _0x128784[_0x3d1e95(0x295)][_0x3d1e95(0x1e5)](_0x51ea7f); if (_0x360d40) await _0x36c0a8(_0x3d1e95(0x38e) + _0x1f56d9, _0x360d40); if (_0x2612e2) await _0x36c0a8(_0x3d1e95(0x861) + _0x1f56d9, _0x2612e2); if (_0x45ccc2) await _0x36c0a8('char_offline_bg_' + _0x1f56d9, _0x45ccc2); for (const _0x1d0cc9 of _0x497d9) { const _0x113059 = document[_0x3d1e95(0x655)]('char-edit-sprite-' + _0x1d0cc9 + _0x3d1e95(0x42b))['files'][0x0]; if (_0x113059) await _0x36c0a8('char_sprite_' + _0x1d0cc9 + '_' + _0x1f56d9, _0x113059); } } _0x5eb81f(), _0x151457(), _0x420e01(_0x3d1e95(0x248)), _0xcf54be('chat', _0x3d1e95(0x454)); if (!_0x1dad59) { if (_0x3d1e95(0x588) === _0x3d1e95(0x452)) { if (!_0x412fe0[_0x3d1e95(0x592)]) return _0x3bae8f[_0x3d1e95(0x4a5)][_0x3d1e95(0x787)](_0x96d8ba => _0x96d8ba['id'] === _0x3a83cd[_0x3d1e95(0x226)]) || _0x14bf98[_0x3d1e95(0x4a5)][0x0]; const _0x153cdf = _0x2aa04c[_0x3d1e95(0x295)][_0x3d1e95(0x787)](_0x3c553d => _0x3c553d[_0x3d1e95(0x3b1)] === _0x3d1e95(0x921) && _0x3c553d[_0x3d1e95(0x4de)][_0x3d1e95(0x9ac)](_0x4e36ad['activeDiaryCharacterId'])), _0x45f59c = _0x153cdf?.[_0x3d1e95(0x4a0)] || _0x52532e[_0x3d1e95(0x226)]; return _0x580ff7[_0x3d1e95(0x4a5)][_0x3d1e95(0x787)](_0x42d5ad => _0x42d5ad['id'] === _0x45f59c) || _0xdf69a9[_0x3d1e95(0x4a5)][0x0]; } else { const _0x160f51 = _0x3d1e95(0x5e2) + _0x1f56d9; _0x1e5a3e(_0x160f51), _0x4d44ee(!![]); } } } catch (_0x5a38c4) { console[_0x3d1e95(0x9de)](_0x3d1e95(0x953), _0x5a38c4), _0x420e01(_0x3d1e95(0x2fd) + _0x5a38c4[_0x3d1e95(0x740)]); } } function _0x54ca72() { const _0x3f50a2 = _0x43c7a1; if (_0x3f50a2(0x75b) !== _0x3f50a2(0x87b)) { _0x464e37[_0x3f50a2(0x9bf)] = '', _0xe17208[_0x3f50a2(0x711)] = ''; if (_0x128784[_0x3f50a2(0x277)][_0x3f50a2(0x36c)] < 0x2) { _0x420e01(_0x3f50a2(0x8ed)); return; } _0x128784[_0x3f50a2(0x277)][_0x3f50a2(0x4d0)](_0x3d540c => { const _0x150f7d = _0x3f50a2, _0x1300c4 = document[_0x150f7d(0x26b)]('li'); _0x1300c4[_0x150f7d(0x1f0)] = _0x150f7d(0x71a), _0x1300c4[_0x150f7d(0x711)] = _0x150f7d(0x807) + _0x3d540c['id'] + _0x150f7d(0x6f2) + _0x3d540c['id'] + _0x150f7d(0x4a3) + (_0x3d540c[_0x150f7d(0x4b6)] || _0x3834ec) + _0x150f7d(0x95c) + _0x3d540c['id'] + _0x150f7d(0x297) + _0x3d540c['name'] + _0x150f7d(0x828), _0xe17208[_0x150f7d(0x3d5)](_0x1300c4); }), _0xcf54be(_0x3f50a2(0x654), 'charSelect'); } else _0x98893a[_0x3f50a2(0x385)]['backgroundImage'] = _0x3f50a2(0x5cf) + _0x2ded5d['createObjectURL'](_0x3b3bce) + '\x27)', _0x2a0975[_0x3f50a2(0x385)][_0x3f50a2(0x6ed)] = 'cover', _0x9bc2ba['style'][_0x3f50a2(0x543)] = _0x3f50a2(0x4cf); } function _0x5f12a4() { const _0x38d2c1 = _0x43c7a1; if (_0x38d2c1(0x983) === _0x38d2c1(0x983)) { const _0x423079 = _0x464e37[_0x38d2c1(0x9bf)][_0x38d2c1(0x6df)](); if (!_0x423079) { if (_0x38d2c1(0x3c0) === _0x38d2c1(0x3c0)) { _0x420e01(_0x38d2c1(0x7f0)); return; } else { if (_0x246b72[_0x38d2c1(0x36c)] === 0x0) return; _0x1b15b2 = (_0x5edb68 + 0x1) % _0x37d99b[_0x38d2c1(0x36c)], _0x9f1e8d(_0x501cf4[_0x22c22f], _0x253d79); } } const _0x37d818 = Array[_0x38d2c1(0x82f)](_0xe17208['querySelectorAll'](_0x38d2c1(0x2df)))['map'](_0x3e3668 => _0x3e3668[_0x38d2c1(0x663)]['id']); if (_0x37d818['length'] < 0x2) { _0x420e01(_0x38d2c1(0x899)); return; } const _0x408bc7 = { 'id': _0x38d2c1(0x7aa) + Date[_0x38d2c1(0x8a2)](), 'type': _0x38d2c1(0x6a4), 'name': _0x423079, 'participantIds': _0x37d818 }; _0x128784['chats'][_0x38d2c1(0x1e5)](_0x408bc7), _0x128784['activeChatId'] = _0x408bc7['id'], _0x5eb81f(), _0x151457(), _0x15e832(), _0x219435(), _0x420e01(_0x38d2c1(0x48d) + _0x423079 + _0x38d2c1(0x608)), _0xcf54be('chat', 'groupChatCreate'); } else _0x10e98d ? _0x2264b4(_0x20a193) : _0x206be5(new _0x544d2b(_0x38d2c1(0x4ff))); } _0x2b4820[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x5f157b), _0x42caf0[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0x3c1821[_0x43c7a1(0x421)]['remove']('show')), _0x552772[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0x3c1821[_0x43c7a1(0x421)]['remove'](_0x43c7a1(0x8d5))), _0x5c0824[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x514364 = _0x43c7a1; if (_0x514364(0x67a) !== _0x514364(0x7e8)) _0x29c201[_0x514364(0x367)](), navigator[_0x514364(0x2bc)][_0x514364(0x236)](_0x29c201[_0x514364(0x9bf)])[_0x514364(0x745)](() => { const _0xea7d81 = _0x514364; if (_0xea7d81(0x84b) !== _0xea7d81(0x703)) _0x420e01('已复制到剪贴板！'); else { const _0x38c25f = _0x1cb84f['createElement'](_0xea7d81(0x76e)); _0x38c25f[_0xea7d81(0x1f0)] = _0xea7d81(0x4ad), _0x38c25f[_0xea7d81(0x711)] = _0xea7d81(0x4f5), _0x38c25f[_0xea7d81(0x9ad)](_0xea7d81(0x7a0))[_0xea7d81(0x9c8)] = () => _0x27e3ff(_0xea7d81(0x911)), _0x3a506d[_0xea7d81(0x3d5)](_0x38c25f), _0x1e3f24(_0x59ad50)[_0xea7d81(0x745)](_0x279b2a => { const _0x1c60e4 = _0xea7d81, _0x34d0f0 = _0x282c64[_0x1c60e4(0x655)](_0x1c60e4(0x181)); _0x34d0f0 && _0x279b2a && (_0x34d0f0[_0x1c60e4(0x84a)] = _0x18ae5a[_0x1c60e4(0x9be)](_0x279b2a)); }); } })[_0x514364(0x619)](_0x33724a => { const _0x25f07d = _0x514364; if (_0x25f07d(0x183) !== _0x25f07d(0x183)) { _0x1b7dec(_0x25f07d(0x32b)); return; } else _0x420e01(_0x25f07d(0x8d2)); }); else { if (!_0x32f679) return; const _0x51297b = _0x345d98['activeMeetingCharId'], _0x12ffe8 = _0x19a911(_0x51297b); if (!_0x12ffe8) return; const _0x8f71e2 = _0x3bb2f0(_0x34d7cc['getElementById']('sprite-slider-x')[_0x514364(0x9bf)]), _0xafec6f = _0x557ce5(_0x2d6579[_0x514364(0x655)](_0x514364(0x6d4))[_0x514364(0x9bf)]), _0x523ce5 = _0x35716a(_0x10b777['getElementById'](_0x514364(0x825))[_0x514364(0x9bf)]) / 0x64; _0x12ffe8[_0x514364(0x830)] = { 'x': _0x8f71e2, 'y': _0xafec6f, 'scale': _0x523ce5 }; const _0x360549 = _0x2b3418[_0x514364(0x655)](_0x514364(0x2bd)), _0x25ea87 = 0x50 * _0x523ce5; _0x360549['style']['height'] = _0x25ea87 + '%', _0x360549[_0x514364(0x385)][_0x514364(0x19b)] = _0x25ea87 + '%', _0x360549[_0x514364(0x385)][_0x514364(0x2b1)] = _0x8f71e2 + '%', _0x360549['style'][_0x514364(0x59b)] = _0xafec6f + '%', _0x360549[_0x514364(0x385)]['transform'] = _0x514364(0x890); } }), _0x1b3a0a[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x2476ee), _0xa095a1[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x5b44d4), _0x114f63['addEventListener'](_0x43c7a1(0x783), () => _0xd6a01e['classList'][_0x43c7a1(0x66f)](_0x43c7a1(0x8d5))), _0x4a18a2[_0x43c7a1(0x203)]('click', () => _0xd6a01e['classList'][_0x43c7a1(0x66f)](_0x43c7a1(0x8d5))), _0x55f1f4[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0x3795aa['click']()), _0x307e1f['addEventListener']('click', () => _0x2319e8['click']()), _0x3795aa[_0x43c7a1(0x203)](_0x43c7a1(0x272), async _0x161ebd => { const _0xeafe31 = _0x43c7a1, _0x5d0ee8 = _0x161ebd[_0xeafe31(0x949)]['files'][0x0]; if (!_0x5d0ee8) return; try { if (_0xeafe31(0x5e6) !== _0xeafe31(0x75e)) _0x55f1f4[_0xeafe31(0x84a)] = await _0x5484a4(_0x5d0ee8); else { const _0x3b3ae0 = _0x1db287[_0xeafe31(0x4a5)][_0xeafe31(0x787)](_0x29cd2f => _0x29cd2f['id'] === _0x87b021[_0xeafe31(0x4a0)]) || { 'name': _0xeafe31(0x5c0) }, _0x5a89fe = _0xec28cb[_0xeafe31(0x26b)](_0xeafe31(0x76e)); _0x5a89fe[_0xeafe31(0x1f0)] = 'world-book-item', _0x5a89fe[_0xeafe31(0x663)]['id'] = _0x93e194['id'], _0x5a89fe[_0xeafe31(0x711)] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0x27a0f8['name'] + _0xeafe31(0x2de) + _0x3b3ae0[_0xeafe31(0x4da)] + _0xeafe31(0x65f) + _0x32f713[_0xeafe31(0x539)][_0xeafe31(0x36c)] + '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', _0x5a89fe[_0xeafe31(0x203)]('click', () => _0x325a21(_0x7af075['id'])), _0x1a6af6[_0xeafe31(0x3d5)](_0x5a89fe); } } catch (_0x255a70) { _0xeafe31(0x216) !== _0xeafe31(0x5c7) ? _0x420e01('错误:\x20' + _0x255a70[_0xeafe31(0x740)]) : (_0x46ee9b(![]), _0x374c98[_0xeafe31(0x2d7)] = ![]); } }), _0x2319e8[_0x43c7a1(0x203)](_0x43c7a1(0x272), async _0x3d9d5c => { const _0x5677ac = _0x43c7a1; if (_0x5677ac(0x74a) !== _0x5677ac(0x74a)) { _0x5ad2ee(_0x5677ac(0x5c8)); return; } else { const _0x36ce79 = _0x3d9d5c[_0x5677ac(0x949)][_0x5677ac(0x275)][0x0]; if (!_0x36ce79) return; try { _0x5677ac(0x48e) === _0x5677ac(0x903) ? _0x85a21f('错误:\x20' + _0x3c5550[_0x5677ac(0x740)]) : _0x307e1f[_0x5677ac(0x84a)] = await _0x5484a4(_0x36ce79); } catch (_0x2d3b50) { _0x420e01(_0x5677ac(0x36a) + _0x2d3b50[_0x5677ac(0x740)]); } } }), _0x150481[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0x548afc[_0x43c7a1(0x783)]()), _0x22176f[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x33dabc = _0x43c7a1; localStorage['removeItem'](_0x33dabc(0x375)), _0x5a16de(), _0x420e01(_0x33dabc(0x723)); }), _0x548afc[_0x43c7a1(0x203)](_0x43c7a1(0x272), async _0x37add5 => { const _0x130c30 = _0x43c7a1; if (_0x130c30(0x206) === _0x130c30(0x206)) { const _0x11ac5e = _0x37add5['target']['files'][0x0]; if (!_0x11ac5e) return; try { const _0x29cef5 = await _0x5484a4(_0x11ac5e); localStorage['setItem'](_0x130c30(0x375), _0x29cef5), _0x5a16de(), _0x420e01(_0x130c30(0x291)); } catch (_0x5064e8) { _0x420e01('错误:\x20' + _0x5064e8[_0x130c30(0x740)]); } } else _0x182a70(_0x130c30(0x78d)); }), document[_0x43c7a1(0x655)](_0x43c7a1(0x3fa))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0xcf54be('chat', _0x43c7a1(0x4d3))), document[_0x43c7a1(0x655)](_0x43c7a1(0x1fb))[_0x43c7a1(0x203)]('click', _0x27c8af); const _0x425dcf = document[_0x43c7a1(0x655)]('group-avatar-preview'), _0x51f242 = document[_0x43c7a1(0x655)](_0x43c7a1(0x7d4)); _0x425dcf[_0x43c7a1(0x203)]('click', () => _0x51f242[_0x43c7a1(0x783)]()), _0x51f242['addEventListener'](_0x43c7a1(0x272), _0x298da4 => { const _0x4795de = _0x43c7a1, _0xfd93a0 = _0x298da4['target']['files'][0x0]; if (!_0xfd93a0) return; const _0x46cd32 = URL[_0x4795de(0x9be)](_0xfd93a0); _0x425dcf['src'] = _0x46cd32, _0x425dcf[_0x4795de(0x74c)] = () => { URL['revokeObjectURL'](_0x46cd32); }; }); const _0x315921 = document[_0x43c7a1(0x655)](_0x43c7a1(0x458))[_0x43c7a1(0x1de)], _0x44f585 = document[_0x43c7a1(0x655)](_0x43c7a1(0x8cf)), _0x412e35 = document['getElementById']('group-bg-preview'); _0x315921[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0x44f585[_0x43c7a1(0x783)]()), _0x44f585['addEventListener'](_0x43c7a1(0x272), _0x417d07 => { const _0x12cade = _0x43c7a1; if (_0x12cade(0x3d8) !== _0x12cade(0x3d8)) _0x310a83['style'][_0x12cade(0x2ca)] = _0x12cade(0x21b) + _0x3832f8[_0x12cade(0x9be)](_0x144ae8) + ')', _0x5e2eb0[_0x12cade(0x385)][_0x12cade(0x6ed)] = 'cover', _0x6627fd[_0x12cade(0x385)][_0x12cade(0x543)] = _0x12cade(0x4cf); else { const _0x4a8b1f = _0x417d07['target'][_0x12cade(0x275)][0x0]; if (!_0x4a8b1f) return; const _0xfde7a7 = URL[_0x12cade(0x9be)](_0x4a8b1f); _0x412e35[_0x12cade(0x84a)] = _0xfde7a7, _0x412e35[_0x12cade(0x74c)] = () => { const _0x38117d = _0x12cade; _0x38117d(0x537) === _0x38117d(0x3e7) ? _0x7871c(![]) : URL[_0x38117d(0x775)](_0xfde7a7); }; } }); const _0x22dbc5 = document[_0x43c7a1(0x9ad)]('#group-settings-screen\x20.select-box'), _0x4d53de = document[_0x43c7a1(0x655)](_0x43c7a1(0x82a)); _0x22dbc5[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x7989bf => { const _0x34453a = _0x43c7a1; if (_0x34453a(0x459) === _0x34453a(0x3ba)) { const _0x26915e = _0xd81458['getElementById']('friend-circle-list-container'); _0x26915e[_0x34453a(0x711)] = ''; if (_0x47e209[_0x34453a(0x21f)]['length'] === 0x0) { _0x26915e[_0x34453a(0x711)] = _0x34453a(0x697); return; } _0x29c67a['friendCircles']['forEach'](_0x1691ea => { const _0x49e9cf = _0x34453a, _0x253e2e = _0x233c83[_0x49e9cf(0x4a5)][_0x49e9cf(0x787)](_0x32471d => _0x32471d['id'] === _0x1691ea[_0x49e9cf(0x4a0)]) || { 'name': _0x49e9cf(0x5c0) }, _0x10c490 = _0x376891[_0x49e9cf(0x26b)](_0x49e9cf(0x76e)); _0x10c490[_0x49e9cf(0x1f0)] = _0x49e9cf(0x669), _0x10c490[_0x49e9cf(0x663)]['id'] = _0x1691ea['id'], _0x10c490[_0x49e9cf(0x711)] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0x1691ea[_0x49e9cf(0x4da)] + _0x49e9cf(0x2de) + _0x253e2e[_0x49e9cf(0x4da)] + '\x20|\x20' + _0x1691ea[_0x49e9cf(0x539)][_0x49e9cf(0x36c)] + _0x49e9cf(0x62b), _0x10c490[_0x49e9cf(0x203)](_0x49e9cf(0x783), () => _0x37ac9f(_0x1691ea['id'])), _0x26915e[_0x49e9cf(0x3d5)](_0x10c490); }); } else _0x7989bf['stopPropagation'](), _0x4d53de[_0x34453a(0x421)][_0x34453a(0x34f)](_0x34453a(0x7eb)), _0x22dbc5[_0x34453a(0x421)][_0x34453a(0x34f)](_0x34453a(0x484)); }), _0x4d53de[_0x43c7a1(0x203)](_0x43c7a1(0x272), _0x346630), document[_0x43c7a1(0x655)](_0x43c7a1(0x9dc))[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x3b6324), document['getElementById'](_0x43c7a1(0x5c9))['addEventListener'](_0x43c7a1(0x783), async () => { const _0x459656 = _0x43c7a1, _0x534463 = _0x401cc7(); if (!_0x534463 || _0x534463['type'] !== _0x459656(0x6a4)) return; const _0x388abf = await _0x17d4de(_0x459656(0x620) + _0x534463['name'] + '”吗？此操作不可撤销。'); _0x388abf && (_0x459656(0x88f) === _0x459656(0x88f) ? (_0x7418f7(_0x534463['id']), _0x420e01('群聊已解散。'), _0xcf54be('chat'), _0x4d44ee(![])) : _0x5170cf = _0x3d5be4[_0x459656(0x472)]); }); const _0x322534 = document[_0x43c7a1(0x9ad)](_0x43c7a1(0x7d0)), _0x421132 = document[_0x43c7a1(0x655)]('world-book-checkboxes-container'); _0x322534[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x22d3a9 => { const _0x4e3be4 = _0x43c7a1; _0x22d3a9[_0x4e3be4(0x3b7)](), _0x421132[_0x4e3be4(0x421)][_0x4e3be4(0x34f)](_0x4e3be4(0x7eb)), _0x322534['classList'][_0x4e3be4(0x34f)](_0x4e3be4(0x484)); }), _0x421132[_0x43c7a1(0x203)](_0x43c7a1(0x272), _0x1a93bb), document['addEventListener'](_0x43c7a1(0x783), _0x2b251d => { const _0x134d30 = _0x43c7a1; !document[_0x134d30(0x9ad)](_0x134d30(0x2e0))['contains'](_0x2b251d[_0x134d30(0x949)]) && (_0x421132[_0x134d30(0x421)]['remove'](_0x134d30(0x7eb)), _0x322534['classList'][_0x134d30(0x66f)](_0x134d30(0x484))); }), _0x37e41f[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x2c766c = _0x43c7a1; _0xfda3fb(), _0xcf54be(_0x2c766c(0x4e2), _0x2c766c(0x7e1)); }), document['getElementById'](_0x43c7a1(0x8d6))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0xcf54be(_0x43c7a1(0x7e1), _0x43c7a1(0x4e2))), document[_0x43c7a1(0x655)](_0x43c7a1(0x7db))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0x174395()), document[_0x43c7a1(0x655)](_0x43c7a1(0x3df))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x15807f = _0x43c7a1; if (_0x15807f(0x311) === _0x15807f(0x811)) { const _0x5ce2ec = _0x27c855[_0x15807f(0x26b)]('p'); _0x5ce2ec[_0x15807f(0x68f)] = _0x58436c['text'], _0x5ce2ec['id'] = 'lyric-line-' + _0x327b60, _0x4e7364[_0x15807f(0x3d5)](_0x5ce2ec); } else _0xfda3fb(), _0xcf54be(_0x15807f(0x4e2), _0x15807f(0x32c)); }), document['getElementById'](_0x43c7a1(0x997))['addEventListener'](_0x43c7a1(0x783), _0x2d55e2), document[_0x43c7a1(0x655)](_0x43c7a1(0x1ee))[_0x43c7a1(0x203)]('click', _0x33365e), _0x4a017b[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0xcf54be(_0x43c7a1(0x907), _0x43c7a1(0x7e1))), _0x29690f[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0xcf54be('home', _0x43c7a1(0x907))), _0x38c488[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0x20010f[_0x43c7a1(0x783)]()), _0x20010f[_0x43c7a1(0x203)](_0x43c7a1(0x272), async _0x5c8966 => { const _0x4ac678 = _0x43c7a1, _0x1397a4 = _0x5c8966[_0x4ac678(0x949)]['files'][0x0]; if (!_0x1397a4) return; await _0x1cbda5(_0x1397a4); }), _0xb2e8a8[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x16e99d = _0x43c7a1; _0x151457(), _0xcf54be(_0x16e99d(0x866), _0x16e99d(0x7e1)); }), _0x4b0255[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x22366a = _0x43c7a1; _0xa2df86(); const _0x5e20ad = (_0x128784[_0x22366a(0x8a1)][_0x22366a(0x7cd)] || '')[_0x22366a(0x9ac)](_0x14d6a7); _0x31f870['disabled'] = _0x5e20ad, _0xcf54be('settings', _0x22366a(0x7e1)); }), _0x591658['addEventListener'](_0x43c7a1(0x783), () => _0xcf54be(_0x43c7a1(0x7e1), 'settings')), _0x377fef[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x1bb6e2 = _0x43c7a1; _0x1e728a(), _0xcf54be(_0x1bb6e2(0x7e1), 'chat'); }), _0x43539b['addEventListener']('click', () => { _0x1e728a(), _0x4d44ee(![]); }), _0x2e7a60[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x6ab7cb = _0x43c7a1; _0x6ab7cb(0x531) !== _0x6ab7cb(0x882) ? _0xcf54be(_0x6ab7cb(0x866), _0x6ab7cb(0x454)) : _0x1a0042(_0x31446e[_0x6ab7cb(0x50e)], _0x56204c[_0x6ab7cb(0x5eb)]); }), _0x1032a8[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x1f4cca = _0x43c7a1; if (_0x1f4cca(0x51e) !== _0x1f4cca(0x9c2)) _0x535413[_0x1f4cca(0x421)][_0x1f4cca(0x266)]('show'); else { const _0x83499f = _0x5a6e49[_0x1f4cca(0x7c7)]('--'); _0x83499f[_0x1f4cca(0x36c)] === 0x2 && _0x83499f[0x0][_0x1f4cca(0x6df)]() && _0x83499f[0x1][_0x1f4cca(0x6df)]()[_0x1f4cca(0x3fd)](_0x1f4cca(0x60d)) ? _0x34ea39['push']({ 'name': _0x83499f[0x0][_0x1f4cca(0x6df)](), 'url': _0x83499f[0x1]['trim']() }) : _0x372d0b++; } }), _0x5e0a7b[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0x3948ce()), _0x5a7fd9['addEventListener']('click', _0xf949f2); function _0x4a0300(_0xc495fa) { const _0x2db9f3 = _0x43c7a1; if ('TIaJG' === _0x2db9f3(0x7f5)) { if (!_0xc495fa || _0xc495fa[_0x2db9f3(0x3b1)] !== _0x2db9f3(0x6a4)) return; const _0x517eb6 = _0x2db9f3(0x194); document[_0x2db9f3(0x307)]['insertAdjacentHTML'](_0x2db9f3(0x9a1), _0x517eb6); const _0x5016f7 = document[_0x2db9f3(0x655)]('group-options-modal'), _0x556888 = _0x5016f7[_0x2db9f3(0x9ad)]('.choice-modal-backdrop'), _0x9f9e3a = document[_0x2db9f3(0x655)]('group-clear-history'), _0x3e22f8 = document[_0x2db9f3(0x655)](_0x2db9f3(0x204)), _0x56bca9 = document[_0x2db9f3(0x655)](_0x2db9f3(0x18f)), _0x4b6e6e = document['getElementById']('group-delete'), _0x636dfc = document['getElementById'](_0x2db9f3(0x3c7)), _0x83d2d8 = () => _0x5016f7['remove'](); _0x9f9e3a['addEventListener'](_0x2db9f3(0x783), async () => { const _0x6f7a68 = _0x2db9f3; _0x83d2d8(); const _0x5757b4 = await _0x17d4de('确定要清空群聊\x22' + _0xc495fa[_0x6f7a68(0x4da)] + _0x6f7a68(0x528)); if (_0x5757b4) { _0xc495fa['id'] === _0x128784['activeChatId'] && ('XOOnM' !== _0x6f7a68(0x976) ? (_0x1e728a(), _0x128784[_0x6f7a68(0x6e7)] = [], _0x19de4f()) : (_0x388a49['userProfiles'] = _0x4b3324[_0x6f7a68(0x4a5)][_0x6f7a68(0x89c)](_0x1c874e => _0x1c874e['id'] !== _0x239341), _0x2fddc1['activeUserProfileId'] === _0x2849b0 && (_0x538006[_0x6f7a68(0x226)] = _0x177961[_0x6f7a68(0x4a5)][0x0]['id']), _0x29e034[_0x6f7a68(0x295)][_0x6f7a68(0x4d0)](_0x1685e1 => { const _0xcdd2d2 = _0x6f7a68; _0x1685e1[_0xcdd2d2(0x4a0)] === _0x3cfdc5 && (_0x1685e1[_0xcdd2d2(0x4a0)] = _0x5c8976[_0xcdd2d2(0x226)]); }), _0x375b4f(), _0x5d4bb0('用户已删除。'), _0x5b063e(), _0x21e649(_0x6f7a68(0x8a3), _0x6f7a68(0x50a)))); try { _0x6f7a68(0x43c) === _0x6f7a68(0x43c) ? (localStorage['removeItem']('chatHistory_' + _0xc495fa['id']), _0x420e01(_0x6f7a68(0x5e7) + _0xc495fa['name'] + _0x6f7a68(0x8d3))) : (_0x3f2f14[_0x6f7a68(0x9de)](_0x6f7a68(0x28b), _0x6ba2f2), _0x536cc5('导入失败了，笨蛋:\x20' + _0x587c23[_0x6f7a68(0x740)])); } catch (_0x18c4ca) { console[_0x6f7a68(0x9de)](_0x6f7a68(0x1fa) + _0xc495fa['id'], _0x18c4ca), _0x420e01(_0x6f7a68(0x905)); } } }), _0x3e22f8[_0x2db9f3(0x203)]('click', () => { const _0x29aca2 = _0x2db9f3; _0x83d2d8(), _0x420e01(_0x29aca2(0x837)); }), _0x56bca9[_0x2db9f3(0x203)](_0x2db9f3(0x783), async () => { const _0x4fbc2a = _0x2db9f3; if (_0x4fbc2a(0x823) !== _0x4fbc2a(0x400)) { _0x83d2d8(); const _0x394b29 = prompt(_0x4fbc2a(0x2ed), _0xc495fa[_0x4fbc2a(0x4da)]); _0x394b29 && _0x394b29[_0x4fbc2a(0x6df)]() && _0x394b29 !== _0xc495fa[_0x4fbc2a(0x4da)] && (_0xc495fa[_0x4fbc2a(0x4da)] = _0x394b29[_0x4fbc2a(0x6df)](), _0x5eb81f(), _0x151457(), _0x15e832(), _0x420e01(_0x4fbc2a(0x880) + _0xc495fa[_0x4fbc2a(0x4da)] + '\x22。')); } else { const _0x2c5e1f = 0x32; if (_0x15f576 < _0x30121d - _0x2c5e1f) _0x115b04(_0x27d922 + 0x1); else _0x48b6d9 > _0x35fbab + _0x2c5e1f && _0x1a9a59(_0x559db5 - 0x1); } }), _0x4b6e6e[_0x2db9f3(0x203)]('click', async () => { const _0x2a8ad8 = _0x2db9f3; _0x83d2d8(); const _0xb8a344 = await _0x17d4de('确定要删除群聊\x22' + _0xc495fa['name'] + '\x22\x20吗？所有聊天记录将被永久删除。'); _0xb8a344 && (_0x2a8ad8(0x8ec) !== _0x2a8ad8(0x855) ? (_0x7418f7(_0xc495fa['id']), _0x420e01(_0x2a8ad8(0x5e7) + _0xc495fa[_0x2a8ad8(0x4da)] + _0x2a8ad8(0x987)), _0x4d44ee(![])) : _0x4222c9['style']['display'] = _0x2a8ad8(0x44e)); }), _0x556888[_0x2db9f3(0x203)](_0x2db9f3(0x783), _0x83d2d8), _0x636dfc['addEventListener'](_0x2db9f3(0x783), _0x83d2d8); } else _0x1e95ea = _0x3a4ba9[_0x2db9f3(0x4de)][0x0]; } _0x42732e['addEventListener'](_0x43c7a1(0x783), () => { const _0x4a74de = _0x43c7a1, _0xdf1a2b = _0x401cc7(); if (_0xdf1a2b && _0xdf1a2b['type'] === _0x4a74de(0x921)) _0xe68812(_0xdf1a2b[_0x4a74de(0x4de)][0x0]); else { if (_0xdf1a2b && _0xdf1a2b['type'] === _0x4a74de(0x6a4)) { if (_0x4a74de(0x97e) === _0x4a74de(0x3cd)) { const _0x5e487a = _0x1249bd(_0xcaaedf[_0x4a74de(0x4de)][0x0]); return _0x5e487a?.[_0x4a74de(0x4da)] || 'AI'; } else _0x133e32(_0xdf1a2b['id']); } } }), _0xe97d72[_0x43c7a1(0x203)]('keydown', _0x222d5f => { const _0x15aa48 = _0x43c7a1; _0x222d5f[_0x15aa48(0x956)] === _0x15aa48(0x487) && !_0x222d5f[_0x15aa48(0x5ec)] && (_0x222d5f[_0x15aa48(0x7cc)](), _0x3948ce()); }); const _0x456ef4 = () => _0x535413[_0x43c7a1(0x421)][_0x43c7a1(0x66f)]('show'); _0x4eb509[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x456ef4), _0x25cf28['addEventListener']('click', _0x456ef4), _0xe50e5[_0x43c7a1(0x203)]('click', () => { const _0xeebf15 = _0x43c7a1; _0xeebf15(0x75a) !== _0xeebf15(0x86b) ? (_0x456ef4(), _0xe68812()) : _0xa36b38[_0xeebf15(0x341)] && (_0x3322da[_0xeebf15(0x341)] = _0x5f05bb[_0xeebf15(0x341)][_0xeebf15(0x89c)](_0x1b189d => _0x1b189d !== _0x2052d8)); }), _0x5d3c58[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { _0x456ef4(), _0x54ca72(); }), _0x5e73b0[_0x43c7a1(0x203)]('click', () => { const _0x37b8e7 = _0x43c7a1; _0xcf54be(_0x37b8e7(0x866), _0x37b8e7(0x654)), _0x4d44ee(![]); }), _0x25bf69[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x5f12a4), _0x1d43e0[_0x43c7a1(0x203)]('click', () => { const _0x4be099 = _0x43c7a1; if (_0x4be099(0x7fb) === 'Lxenm') _0x3cc518[_0x4be099(0x421)][_0x4be099(0x34f)](_0x4be099(0x8d5)), _0x3cc518[_0x4be099(0x421)]['contains'](_0x4be099(0x8d5)) && (_0x76cec4[_0x4be099(0x4d8)] = _0x76cec4[_0x4be099(0x53d)]); else { _0x29d1bf(_0x4be099(0x45d)); return; } }), _0xc33155[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0x4a3884[_0x43c7a1(0x783)]()); const _0x16bfd0 = document[_0x43c7a1(0x655)]('chat-music-button'); _0x4a3884[_0x43c7a1(0x203)](_0x43c7a1(0x272), _0x284ff3), _0x16bfd0['addEventListener'](_0x43c7a1(0x783), _0x3aa5f1), _0x49de84[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x43a1ab), _0x100662[_0x43c7a1(0x203)]('click', _0x4f3052), _0x59478e['addEventListener'](_0x43c7a1(0x783), _0x2e749a), _0x16665f[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x3b6324), _0xadc109[_0x43c7a1(0x203)](_0x43c7a1(0x783), async () => { const _0x2e7683 = _0x43c7a1, _0x2455ae = _0x4e5ef7[_0x2e7683(0x9bf)]; if (!_0x2455ae) return; const _0x4d1ea2 = _0x8351ef(_0x2455ae); if (!_0x4d1ea2) return; const _0x5ed5ce = await _0x17d4de(_0x2e7683(0x221) + _0x4d1ea2['name'] + _0x2e7683(0x5b2)); _0x5ed5ce && (_0x147f2f(_0x2455ae), _0x420e01(_0x2e7683(0x5f9) + _0x4d1ea2['name'] + '”已删除。'), _0xcf54be('chat', _0x2e7683(0x454)), _0x4d44ee(![])); }), _0xc525fe[_0x43c7a1(0x203)]('input', () => { const _0x251e80 = _0x43c7a1, _0x5913f9 = _0xc525fe[_0x251e80(0x9bf)][_0x251e80(0x6df)]()[_0x251e80(0x9ac)](_0x14d6a7); _0x31f870['disabled'] = _0x5913f9; }); async function _0xa5fb6c() { const _0x52ec6a = _0x43c7a1, _0x325ec6 = _0xc525fe['value'][_0x52ec6a(0x6df)](), _0x22b9f8 = _0x58431b[_0x52ec6a(0x9bf)][_0x52ec6a(0x6df)](); if (!_0x325ec6 || !_0x22b9f8) { if (_0x52ec6a(0x1bf) === _0x52ec6a(0x9cf)) { _0x514fee[_0x52ec6a(0x8a1)][_0x52ec6a(0x7cd)] = _0x2a4ae0[_0x52ec6a(0x9bf)][_0x52ec6a(0x6df)](), _0x5e30ed[_0x52ec6a(0x8a1)]['key'] = _0x5953b3[_0x52ec6a(0x9bf)]['trim'](), _0x6873be[_0x52ec6a(0x8a1)]['model'] = _0x5aa8e5[_0x52ec6a(0x9bf)][_0x52ec6a(0x6df)](), _0x2f4f42[_0x52ec6a(0x8a1)][_0x52ec6a(0x1b8)] = _0x814a37[_0x52ec6a(0x655)](_0x52ec6a(0x906))[_0x52ec6a(0x9bf)]; const _0xcce987 = _0x26f837(_0x13db6d[_0x52ec6a(0x9bf)], 0xa); _0x5ed262['preferences'][_0x52ec6a(0x3cc)] = _0x4628b9['isFinite'](_0xcce987) && _0xcce987 > 0x0 ? _0xcce987 : 0x64, _0x2216ba(), _0x2a78fb(_0x52ec6a(0x423)); } else { _0x420e01(_0x52ec6a(0x1c9)); return; } } const _0x2e584f = _0x325ec6[_0x52ec6a(0x55b)](/\/+$/, ''), _0x1811c5 = _0x2e584f + _0x52ec6a(0x369); _0x31f870[_0x52ec6a(0x647)] = !![], _0x31f870[_0x52ec6a(0x68f)] = _0x52ec6a(0x416), _0x55c844['classList'][_0x52ec6a(0x66f)]('show'); try { if (_0x52ec6a(0x34e) === _0x52ec6a(0x34e)) { const _0x3e9591 = await fetch(_0x1811c5, { 'headers': { 'Authorization': _0x52ec6a(0x816) + _0x59c1a6(_0x22b9f8) } }); if (!_0x3e9591['ok']) throw new Error('服务器错误:\x20' + _0x3e9591[_0x52ec6a(0x97d)]); const _0x3f775b = await _0x3e9591['json'](), _0x599e31 = (_0x3f775b['data'] || _0x3f775b)[_0x52ec6a(0x946)](_0x11d466 => _0x11d466['id'])['sort'](); _0x599e31['length'] > 0x0 ? (_0x55c844['innerHTML'] = '', _0x599e31[_0x52ec6a(0x4d0)](_0x47c59e => { const _0x1d3088 = _0x52ec6a, _0x259e03 = document[_0x1d3088(0x26b)](_0x1d3088(0x76e)); _0x259e03[_0x1d3088(0x68f)] = _0x47c59e, _0x259e03[_0x1d3088(0x203)](_0x1d3088(0x783), () => { const _0x356aaf = _0x1d3088; if (_0x356aaf(0x8c4) === _0x356aaf(0x8c4)) _0x122f28['value'] = _0x47c59e, _0x55c844['classList'][_0x356aaf(0x66f)](_0x356aaf(0x8d5)); else { const _0x416be9 = _0x2fbce9[_0x356aaf(0x472)] ? '\x20' + _0x5856c0[_0x356aaf(0x472)] : ''; _0x2766da[_0x356aaf(0x1e5)]('[' + _0x53dde8(_0x49a89f) + ']\x20[image]' + _0x416be9); } }), _0x55c844[_0x1d3088(0x3d5)](_0x259e03); }), _0x55c844[_0x52ec6a(0x421)][_0x52ec6a(0x266)]('show'), _0x420e01('成功获取\x20' + _0x599e31[_0x52ec6a(0x36c)] + _0x52ec6a(0x65a))) : _0x420e01(_0x52ec6a(0x9df)); } else _0x52ec6a(0x44b); } catch (_0x3a8126) { _0x52ec6a(0x185) === _0x52ec6a(0x984) ? (_0x43e7b8[_0x52ec6a(0x655)](_0x52ec6a(0x38d))['value'] = '', _0x32c7f0[_0x52ec6a(0x655)]('user-profile-edit-title')[_0x52ec6a(0x68f)] = _0x52ec6a(0x3de), _0x26390b[_0x52ec6a(0x655)](_0x52ec6a(0x7c9))[_0x52ec6a(0x9bf)] = _0x52ec6a(0x1eb) + (_0x4c871c[_0x52ec6a(0x4a5)]['length'] + 0x1), _0x2a9824[_0x52ec6a(0x655)](_0x52ec6a(0x3ca))[_0x52ec6a(0x84a)] = _0x32fdb4, _0x3bd524[_0x52ec6a(0x655)](_0x52ec6a(0x4fe))[_0x52ec6a(0x9bf)] = '', _0x1f4971[_0x52ec6a(0x385)][_0x52ec6a(0x1cd)] = 'none') : _0x420e01(_0x52ec6a(0x8ef) + _0x3a8126[_0x52ec6a(0x740)] + _0x52ec6a(0x45a)); } finally { _0x31f870[_0x52ec6a(0x647)] = ![], _0x31f870[_0x52ec6a(0x68f)] = '获取'; } } _0x31f870[_0x43c7a1(0x203)]('click', _0x545ed6 => { const _0x568fe4 = _0x43c7a1; _0x568fe4(0x1ec) === 'NfBOR' ? (_0x545ed6[_0x568fe4(0x3b7)](), _0xa5fb6c()) : (_0x2b5109[_0x568fe4(0x385)][_0x568fe4(0x5a9)] = _0x568fe4(0x50b), _0x4f6800[_0x568fe4(0x385)][_0x568fe4(0x59b)] = _0x568fe4(0x2d4), _0x10a6bc[_0x568fe4(0x385)][_0x568fe4(0x2b1)] = '50%', _0x3c23e4[_0x568fe4(0x385)][_0x568fe4(0x2c7)] = _0x568fe4(0x1f8), _0x44b305[_0x568fe4(0x385)][_0x568fe4(0x1cd)] = _0x568fe4(0x80c)); }), document[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x5eb7a3 => { const _0x30d474 = _0x43c7a1; !_0x55c844['contains'](_0x5eb7a3[_0x30d474(0x949)]) && _0x5eb7a3[_0x30d474(0x949)] !== _0x122f28 && _0x5eb7a3[_0x30d474(0x949)] !== _0x31f870 && (_0x30d474(0x6d7) !== _0x30d474(0x6d7) ? _0x9f2f07(_0x3c5970) : _0x55c844['classList'][_0x30d474(0x66f)]('show')); }); async function _0x5484a4(_0x228170) { const _0x841c66 = _0x43c7a1; if (_0x841c66(0x65b) === _0x841c66(0x517)) _0x146969(_0x5e1790['id']); else return await _0x588f02(_0x228170, 0x190, 0.85); } _0x415175[_0x43c7a1(0x203)]('click', () => _0x363728[_0x43c7a1(0x783)]()), _0x363728[_0x43c7a1(0x203)]('change', async _0x177495 => { const _0x510ca8 = _0x43c7a1; if (_0x510ca8(0x22f) !== 'chrfc') { const _0x59cdc2 = _0x177495[_0x510ca8(0x949)][_0x510ca8(0x275)][0x0]; if (!_0x59cdc2) return; try { const _0x350d05 = await _0x5484a4(_0x59cdc2); _0x415175[_0x510ca8(0x84a)] = _0x350d05; } catch (_0x45b553) { 'iGxFS' === _0x510ca8(0x3e3) ? _0x420e01(_0x510ca8(0x36a) + _0x45b553[_0x510ca8(0x740)]) : _0x451eb4[_0x510ca8(0x655)]('galgame-text')[_0x510ca8(0x68f)] = _0x510ca8(0x406); } } else _0x44ab5c[_0x510ca8(0x6e7)][_0x40f9de][_0x510ca8(0x6bb)] = !![], _0x470522(); }), _0x460708[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0x2a98fe[_0x43c7a1(0x783)]()), _0x2a98fe[_0x43c7a1(0x203)](_0x43c7a1(0x272), async _0x17c516 => { const _0xe3307d = _0x43c7a1, _0x255b33 = _0x17c516['target'][_0xe3307d(0x275)][0x0]; if (!_0x255b33) return; try { if ('KBeXH' !== 'TJAIx') _0x460708[_0xe3307d(0x84a)] = await _0x5484a4(_0x255b33); else { const _0x287e8a = _0x5e293f[_0xe3307d(0x787)](_0x1d29be => _0x1d29be[_0xe3307d(0x4da)] === _0x240560['name']); if (_0x287e8a) _0x1d43e1['assign'](_0x4566c1, { 'content': _0xe3307d(0x739) + _0x287e8a[_0xe3307d(0x4da)] + ']', 'displayUrl': _0x287e8a[_0xe3307d(0x237)] }); else _0x859800['content'] = _0xe3307d(0x593) + _0x12e8d0[_0xe3307d(0x4da)] + ']'; } } catch (_0xb6c7e8) { _0xe3307d(0x322) === _0xe3307d(0x8ba) ? _0x6880b7['style']['display'] = 'none' : _0x420e01(_0xe3307d(0x36a) + _0xb6c7e8[_0xe3307d(0x740)]); } }); function _0x133d64() { const _0x4f0cbf = _0x43c7a1; _0x3cc518[_0x4f0cbf(0x711)] = '', _0x2f0881[_0x4f0cbf(0x4d0)](_0x16ccba => { const _0x5a1c60 = _0x4f0cbf, _0x24c369 = document[_0x5a1c60(0x26b)](_0x5a1c60(0x682)); _0x24c369[_0x5a1c60(0x84a)] = _0x16ccba[_0x5a1c60(0x237)], _0x24c369[_0x5a1c60(0x3d7)] = _0x5a1c60(0x605), _0x24c369[_0x5a1c60(0x38f)] = _0x16ccba[_0x5a1c60(0x4da)], _0x24c369[_0x5a1c60(0x421)][_0x5a1c60(0x266)]('sticker-item'), _0x24c369[_0x5a1c60(0x203)](_0x5a1c60(0x783), () => _0x330032(_0x16ccba)), _0x3cc518[_0x5a1c60(0x3d5)](_0x24c369); }); } function _0x289448() { const _0x301f57 = _0x43c7a1, _0x4d6cc0 = document[_0x301f57(0x655)](_0x301f57(0x824)); _0x4d6cc0[_0x301f57(0x711)] = ''; if (_0x128784[_0x301f57(0x4a5)][_0x301f57(0x36c)] === 0x0) { _0x4d6cc0[_0x301f57(0x711)] = _0x301f57(0x875); return; } _0x128784[_0x301f57(0x4a5)][_0x301f57(0x4d0)](_0x3e1844 => { const _0x509e1c = _0x301f57; if (_0x509e1c(0x965) === _0x509e1c(0x9d0)) { const _0x1101c1 = _0x14a1b3(); if (!_0x1101c1) { _0x48abc4[_0x509e1c(0x68f)] = _0x509e1c(0x9bb); return; } if (_0x1101c1[_0x509e1c(0x3b1)] === _0x509e1c(0x921)) { const _0x3f59a7 = _0x57f17d(_0x1101c1[_0x509e1c(0x4de)][0x0]); _0xadd4fa[_0x509e1c(0x68f)] = _0x3f59a7 ? _0x3f59a7[_0x509e1c(0x4da)] : _0x509e1c(0x4db); } else _0x3bc41c[_0x509e1c(0x68f)] = _0x1101c1[_0x509e1c(0x4da)] || _0x509e1c(0x597) + _0x1101c1['participantIds']['length'] + ')'; } else { const _0x48469a = document['createElement'](_0x509e1c(0x76e)); _0x48469a[_0x509e1c(0x1f0)] = _0x509e1c(0x669), _0x48469a[_0x509e1c(0x663)]['id'] = _0x3e1844['id']; const _0x2865b1 = _0x3e1844['id'] === _0x128784[_0x509e1c(0x226)] ? _0x509e1c(0x7f8) : ''; _0x48469a[_0x509e1c(0x711)] = _0x509e1c(0x5a8) + (_0x3e1844[_0x509e1c(0x4b6)] || _0x473193) + _0x509e1c(0x8f8) + _0x3e1844[_0x509e1c(0x4da)] + _0x2865b1 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x3e1844[_0x509e1c(0x489)][_0x509e1c(0x810)](0x0, 0x64) + _0x509e1c(0x4c3), _0x48469a[_0x509e1c(0x203)]('click', () => _0x1c6083(_0x3e1844['id'])), _0x4d6cc0[_0x509e1c(0x3d5)](_0x48469a); } }); } function _0x1c6083(_0x5a34d7 = null) { const _0x1c5133 = _0x43c7a1; if ('dWbxO' === _0x1c5133(0x7c6)) { _0xcf54be(_0x1c5133(0x50a), _0x1c5133(0x8a3)); const _0x3d958a = document[_0x1c5133(0x655)](_0x1c5133(0x767)); if (_0x5a34d7) { if ('YHvLB' !== _0x1c5133(0x8cc)) { const _0x11f9eb = _0x128784['userProfiles'][_0x1c5133(0x787)](_0x3e23b7 => _0x3e23b7['id'] === _0x5a34d7); if (!_0x11f9eb) return; document[_0x1c5133(0x655)]('editing-user-id')[_0x1c5133(0x9bf)] = _0x11f9eb['id'], document['getElementById'](_0x1c5133(0x3d4))[_0x1c5133(0x68f)] = _0x1c5133(0x74b), document['getElementById'](_0x1c5133(0x7c9))['value'] = _0x11f9eb[_0x1c5133(0x4da)], document[_0x1c5133(0x655)](_0x1c5133(0x3ca))[_0x1c5133(0x84a)] = _0x11f9eb[_0x1c5133(0x4b6)], document[_0x1c5133(0x655)](_0x1c5133(0x4fe))[_0x1c5133(0x9bf)] = _0x11f9eb[_0x1c5133(0x489)], _0x3d958a[_0x1c5133(0x385)][_0x1c5133(0x1cd)] = _0x11f9eb['id'] === _0x128784[_0x1c5133(0x226)] ? _0x1c5133(0x44e) : _0x1c5133(0x3d3); } else _0x1d5c38[_0x1c5133(0x9de)](_0x1c5133(0x1fa) + _0x4aa4d9['id'], _0x161830), _0x289c82(_0x1c5133(0x905)); } else document[_0x1c5133(0x655)]('editing-user-id')[_0x1c5133(0x9bf)] = '', document[_0x1c5133(0x655)](_0x1c5133(0x3d4))['textContent'] = _0x1c5133(0x3de), document[_0x1c5133(0x655)](_0x1c5133(0x7c9))[_0x1c5133(0x9bf)] = _0x1c5133(0x1eb) + (_0x128784[_0x1c5133(0x4a5)]['length'] + 0x1), document[_0x1c5133(0x655)](_0x1c5133(0x3ca))['src'] = _0x473193, document[_0x1c5133(0x655)](_0x1c5133(0x4fe))[_0x1c5133(0x9bf)] = '', _0x3d958a[_0x1c5133(0x385)][_0x1c5133(0x1cd)] = 'none'; } else { const _0x341b38 = _0x33301d[_0x1c5133(0x9bf)]; _0x3c7f00[_0x1c5133(0x348)][_0x1c5133(0x385)][_0x1c5133(0x6ac)](_0x1c5133(0x4cc), _0x341b38), _0x63bc40[_0x1c5133(0x548)]('themeHue', _0x341b38), _0x5428b7(); } } function _0x4f3052() { const _0x22aaa4 = _0x43c7a1, _0x332fd3 = document[_0x22aaa4(0x655)](_0x22aaa4(0x38d))['value'], _0x5cb029 = { 'name': document['getElementById'](_0x22aaa4(0x7c9))[_0x22aaa4(0x9bf)][_0x22aaa4(0x6df)](), 'persona': document[_0x22aaa4(0x655)]('user-persona')['value'][_0x22aaa4(0x6df)](), 'avatar': document['getElementById']('user-avatar-preview')['src'] }; if (!_0x5cb029[_0x22aaa4(0x4da)]) { _0x420e01(_0x22aaa4(0x50f)); return; } if (_0x332fd3) { if (_0x22aaa4(0x302) !== _0x22aaa4(0x302)) { _0x38c8d6[_0x22aaa4(0x9bf)] = _0x22aaa4(0x5f7); return; } else { const _0xc9100c = _0x128784[_0x22aaa4(0x4a5)][_0x22aaa4(0x787)](_0x23aef1 => _0x23aef1['id'] === _0x332fd3); if (_0xc9100c) Object[_0x22aaa4(0x7d8)](_0xc9100c, _0x5cb029); } } else { const _0x26d5b2 = { 'id': _0x22aaa4(0x98d) + Date[_0x22aaa4(0x8a2)](), ..._0x5cb029 }; _0x128784[_0x22aaa4(0x4a5)][_0x22aaa4(0x1e5)](_0x26d5b2), !_0x128784[_0x22aaa4(0x226)] && (_0x128784[_0x22aaa4(0x226)] = _0x26d5b2['id']); } _0x5eb81f(), _0x420e01('用户资料已保存！'), _0x289448(), _0xcf54be(_0x22aaa4(0x8a3), _0x22aaa4(0x50a)); } async function _0x172255() { const _0x49f43e = _0x43c7a1, _0x2bb459 = document[_0x49f43e(0x655)](_0x49f43e(0x38d))['value']; if (!_0x2bb459) return; if (_0x128784[_0x49f43e(0x4a5)][_0x49f43e(0x36c)] <= 0x1) { _0x420e01('至少要保留一个用户。'); return; } const _0x1b464b = await _0x17d4de(_0x49f43e(0x53b)); if (_0x1b464b) { if (_0x49f43e(0x2a0) === 'Iwhbt') _0x740677 = _0x51e246['getItem'](_0x49f43e(0x52b)); else { _0x128784[_0x49f43e(0x4a5)] = _0x128784[_0x49f43e(0x4a5)]['filter'](_0x5dd4db => _0x5dd4db['id'] !== _0x2bb459); if (_0x128784[_0x49f43e(0x226)] === _0x2bb459) { if (_0x49f43e(0x578) !== _0x49f43e(0x578)) { const _0x17eb8a = { 'id': _0x1fffd9['id'], 'url': _0x3035c5[_0x49f43e(0x36f)] }; _0x1a7bb(this, _0x17eb8a); } else _0x128784[_0x49f43e(0x226)] = _0x128784[_0x49f43e(0x4a5)][0x0]['id']; } _0x128784['chats'][_0x49f43e(0x4d0)](_0x4f2f22 => { const _0x2c1ee2 = _0x49f43e; if (_0x4f2f22[_0x2c1ee2(0x4a0)] === _0x2bb459) { if (_0x2c1ee2(0x72a) !== _0x2c1ee2(0x72a)) { if (_0x4a2743) _0xcc5536(_0xb894ea); _0x55c7e2 = null, _0x14f41d[_0x2c1ee2(0x5df)] = [], _0x1fde37['activeMeetingCharId'] = null, _0x8db32f[_0x2c1ee2(0x655)](_0x2c1ee2(0x2fc))[_0x2c1ee2(0x385)][_0x2c1ee2(0x1cd)] = _0x2c1ee2(0x44e), _0x38ff2e[_0x2c1ee2(0x789)] = null, _0x38d37b(), _0x6ec3c3(_0x2c1ee2(0x396), _0x2c1ee2(0x536)); } else _0x4f2f22['boundUserProfileId'] = _0x128784[_0x2c1ee2(0x226)]; } }), _0x5eb81f(), _0x420e01(_0x49f43e(0x2a8)), _0x289448(), _0xcf54be(_0x49f43e(0x8a3), _0x49f43e(0x50a)); } } } function _0xfda3fb() { const _0x200d52 = _0x43c7a1; if ('JfSPg' === _0x200d52(0x70c)) { const _0x50f7d7 = document[_0x200d52(0x655)]('world-book-list-container'); _0x50f7d7['innerHTML'] = ''; if (_0x128784[_0x200d52(0x188)][_0x200d52(0x36c)] === 0x0) { _0x50f7d7['innerHTML'] = _0x200d52(0x940); return; } _0x128784[_0x200d52(0x188)][_0x200d52(0x4d0)](_0x130a25 => { const _0x360ee5 = _0x200d52, _0x4b74c8 = document['createElement'](_0x360ee5(0x76e)); _0x4b74c8['className'] = _0x360ee5(0x669), _0x4b74c8[_0x360ee5(0x663)]['id'] = _0x130a25['id'], _0x4b74c8[_0x360ee5(0x711)] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0x130a25[_0x360ee5(0x4da)] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x130a25['content']['substring'](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20', _0x4b74c8[_0x360ee5(0x203)]('click', () => _0x174395(_0x130a25['id'])), _0x50f7d7['appendChild'](_0x4b74c8); }); } else { const _0x227a60 = _0x193b51[_0x200d52(0x38a)] === _0x200d52(0x500) ? _0x23498e[_0x200d52(0x4da)] : _0x14597f(_0x42db15[_0x200d52(0x38a)])['name']; return _0x200d52(0x4e8) + new _0x1568d1(_0x3c860d[_0x200d52(0x89b)])[_0x200d52(0x263)]() + ']\x20' + _0x227a60 + _0x200d52(0x971) + _0x13714e[_0x200d52(0x472)]; } } function _0x174395(_0x202670 = null) { const _0x406996 = _0x43c7a1; _0xcf54be('worldBookEditor', _0x406996(0x4e2)); if (_0x202670) { const _0x554334 = _0x128784[_0x406996(0x188)][_0x406996(0x787)](_0x30ee2c => _0x30ee2c['id'] === _0x202670); if (!_0x554334) return; document[_0x406996(0x655)](_0x406996(0x8fb))[_0x406996(0x9bf)] = _0x554334['id'], document[_0x406996(0x655)]('world-book-editor-title')[_0x406996(0x68f)] = _0x406996(0x503), document[_0x406996(0x655)]('world-book-edit-name')[_0x406996(0x9bf)] = _0x554334['name'], document[_0x406996(0x655)](_0x406996(0x5c6))['value'] = _0x554334[_0x406996(0x472)]; } else document[_0x406996(0x655)]('editing-world-book-id')[_0x406996(0x9bf)] = '', document[_0x406996(0x655)]('world-book-editor-title')[_0x406996(0x68f)] = _0x406996(0x67e), document[_0x406996(0x655)](_0x406996(0x985))[_0x406996(0x9bf)] = '', document[_0x406996(0x655)]('world-book-edit-content')['value'] = ''; } function _0x2d55e2() { const _0x2b5e81 = _0x43c7a1; if (_0x2b5e81(0x47f) === _0x2b5e81(0x47f)) { const _0x4f7e5e = document[_0x2b5e81(0x655)](_0x2b5e81(0x8fb))[_0x2b5e81(0x9bf)], _0x3f6d57 = document['getElementById']('world-book-edit-name')[_0x2b5e81(0x9bf)][_0x2b5e81(0x6df)](), _0x441c1c = document['getElementById'](_0x2b5e81(0x5c6))[_0x2b5e81(0x9bf)][_0x2b5e81(0x6df)](); if (!_0x3f6d57 || !_0x441c1c) { _0x420e01('条目名称和内容都不能为空！'); return; } if (_0x4f7e5e) { if (_0x2b5e81(0x632) === _0x2b5e81(0x632)) { const _0x17f9bb = _0x128784[_0x2b5e81(0x188)]['find'](_0xdc790d => _0xdc790d['id'] === _0x4f7e5e); _0x17f9bb && (_0x17f9bb[_0x2b5e81(0x4da)] = _0x3f6d57, _0x17f9bb[_0x2b5e81(0x472)] = _0x441c1c); } else _0x594532[_0x2b5e81(0x7cc)](), _0x1faa1e(); } else { if ('zHTAW' === _0x2b5e81(0x836)) { const _0x367a3b = { 'id': _0x2b5e81(0x650) + Date[_0x2b5e81(0x8a2)](), 'name': _0x3f6d57, 'content': _0x441c1c }; _0x128784['worldBooks'][_0x2b5e81(0x1e5)](_0x367a3b); } else throw new _0x3c1767(_0x2b5e81(0x776)); } _0x5eb81f(), _0x420e01('世界书条目已保存！'), _0xfda3fb(), _0xcf54be(_0x2b5e81(0x4e2), 'worldBookEditor'); } else _0x4c9f84(_0x2b5e81(0x36a) + _0x4a4b30['message']); } async function _0x33365e() { const _0x3ecc5f = _0x43c7a1; if (_0x3ecc5f(0x8af) !== _0x3ecc5f(0x8af)) _0x23d8ee['removeItem'](_0x3ecc5f(0x584)), _0x5c7245[_0x3ecc5f(0x5c5)]('cardWidgetState'), _0x4a2bc2(_0x3ecc5f(0x651)), _0x3d6854(() => _0x53e578['reload'](), 0x3e8); else { const _0x4f1bf7 = document[_0x3ecc5f(0x655)](_0x3ecc5f(0x8fb))[_0x3ecc5f(0x9bf)]; if (!_0x4f1bf7) return; const _0x57ef2f = await _0x17d4de(_0x3ecc5f(0x49b)); _0x57ef2f && (_0x128784[_0x3ecc5f(0x188)] = _0x128784[_0x3ecc5f(0x188)][_0x3ecc5f(0x89c)](_0x2b7ac3 => _0x2b7ac3['id'] !== _0x4f1bf7), _0x128784[_0x3ecc5f(0x277)][_0x3ecc5f(0x4d0)](_0x454341 => { const _0x515640 = _0x3ecc5f; _0x515640(0x382) === 'POTaN' ? (_0x37e7a2[_0x515640(0x9de)](_0x515640(0x844), _0x5326e0), _0x4abd64(_0x515640(0x9dd) + _0x47f6f6[_0x515640(0x740)])) : _0x454341[_0x515640(0x341)] && (_0x454341['linkedWorldBookIds'] = _0x454341['linkedWorldBookIds'][_0x515640(0x89c)](_0x146485 => _0x146485 !== _0x4f1bf7)); }), _0x5eb81f(), _0x420e01(_0x3ecc5f(0x941)), _0xfda3fb(), _0xcf54be(_0x3ecc5f(0x4e2), _0x3ecc5f(0x32c))); } } function _0x1a93bb() { const _0x1b9c17 = _0x43c7a1; if (_0x1b9c17(0x3dc) !== _0x1b9c17(0x3dc)) _0x5f0be3['error'](_0x1b9c17(0x953), _0x38688d), _0x41d4d9(_0x1b9c17(0x2fd) + _0xa9198c['message']); else { const _0x3081f0 = document[_0x1b9c17(0x655)]('world-book-checkboxes-container'), _0x185d3d = _0x3081f0['querySelectorAll'](_0x1b9c17(0x86a)), _0x40c522 = document['querySelector'](_0x1b9c17(0x7de)); if (_0x185d3d[_0x1b9c17(0x36c)] === 0x0) _0x40c522[_0x1b9c17(0x68f)] = _0x1b9c17(0x294); else _0x185d3d[_0x1b9c17(0x36c)] > 0x2 ? _0x40c522[_0x1b9c17(0x68f)] = _0x1b9c17(0x57b) + _0x185d3d['length'] + '\x20项' : _0x1b9c17(0x62e) !== _0x1b9c17(0x8c2) ? _0x40c522[_0x1b9c17(0x68f)] = Array[_0x1b9c17(0x82f)](_0x185d3d)[_0x1b9c17(0x946)](_0x2e0ba3 => _0x2e0ba3[_0x1b9c17(0x1de)]['textContent'][_0x1b9c17(0x6df)]())[_0x1b9c17(0x9cc)]('、') : _0x520ccf[_0x1b9c17(0x711)] = _0x1b9c17(0x2f2) + _0x4598e6 + _0x1b9c17(0x3f0) + (_0x1c7ef5 === _0x1b9c17(0x441) ? _0x1b9c17(0x864) : _0x1b9c17(0x7f1)) + _0x1b9c17(0x440) + _0x26ac60 + _0x1b9c17(0x37a) + _0x32dd18; } } function _0x133e32(_0x2dc0b1) { const _0x11c88a = _0x43c7a1, _0xaf09c4 = _0x128784[_0x11c88a(0x295)][_0x11c88a(0x787)](_0x2a0d41 => _0x2a0d41['id'] === _0x2dc0b1); if (!_0xaf09c4 || _0xaf09c4[_0x11c88a(0x3b1)] !== 'group') return; document[_0x11c88a(0x655)](_0x11c88a(0x3d2))[_0x11c88a(0x9bf)] = _0xaf09c4[_0x11c88a(0x4da)] || '', _0x44a098('group-settings-bind-user'), document[_0x11c88a(0x655)]('group-settings-bind-user')[_0x11c88a(0x9bf)] = _0xaf09c4[_0x11c88a(0x4a0)] || _0x128784[_0x11c88a(0x226)]; const _0x5bd914 = document[_0x11c88a(0x655)](_0x11c88a(0x82a)); _0x5bd914[_0x11c88a(0x711)] = '', _0x128784[_0x11c88a(0x188)][_0x11c88a(0x4d0)](_0x2e41e5 => { const _0x2180e7 = _0x11c88a, _0x3c5fa9 = _0xaf09c4[_0x2180e7(0x341)]?.[_0x2180e7(0x9ac)](_0x2e41e5['id']), _0x315b10 = document[_0x2180e7(0x26b)](_0x2180e7(0x281)); _0x315b10[_0x2180e7(0x711)] = _0x2180e7(0x202) + _0x2e41e5['id'] + '\x22\x20' + (_0x3c5fa9 ? _0x2180e7(0x30c) : '') + '>\x20' + _0x2e41e5[_0x2180e7(0x4da)], _0x5bd914[_0x2180e7(0x3d5)](_0x315b10); }), _0x346630(); const _0x3b7950 = document['getElementById'](_0x11c88a(0x77c)), _0x191d49 = document['getElementById'](_0x11c88a(0x458)); _0x226e0a(_0x11c88a(0x514) + _0x2dc0b1)[_0x11c88a(0x745)](_0x4cfe71 => { const _0x44ffa0 = _0x11c88a; _0x3b7950['src'] = _0x4cfe71 ? URL[_0x44ffa0(0x9be)](_0x4cfe71) : _0x3834ec; }), _0x226e0a(_0x11c88a(0x672) + _0x2dc0b1)['then'](_0x7455f0 => { const _0x46a408 = _0x11c88a; _0x191d49[_0x46a408(0x84a)] = _0x7455f0 ? URL[_0x46a408(0x9be)](_0x7455f0) : ''; }), _0xcf54be(_0x11c88a(0x4d3), _0x11c88a(0x866)); } async function _0x27c8af() { const _0x1efa85 = _0x43c7a1, _0x31d3ee = _0x401cc7(); if (!_0x31d3ee || _0x31d3ee[_0x1efa85(0x3b1)] !== 'group') return; const _0x5d7e5f = document[_0x1efa85(0x655)](_0x1efa85(0x3d2))[_0x1efa85(0x9bf)]['trim'](); if (!_0x5d7e5f) { if (_0x1efa85(0x877) === _0x1efa85(0x354)) { const _0x35ac30 = _0x4295f3[_0x1efa85(0x9be)](_0x30d7e9); _0x17b425[_0x1efa85(0x84a)] = _0x35ac30, _0x57588d[_0x1efa85(0x74c)] = () => { const _0x354714 = _0x1efa85; _0x408d85[_0x354714(0x775)](_0x35ac30); }; } else { _0x420e01(_0x1efa85(0x760)); return; } } _0x31d3ee['name'] = _0x5d7e5f; const _0x5d4ee4 = document[_0x1efa85(0x49d)](_0x1efa85(0x8ae)); _0x31d3ee[_0x1efa85(0x341)] = Array[_0x1efa85(0x82f)](_0x5d4ee4)[_0x1efa85(0x946)](_0x1dbd78 => _0x1dbd78['value']), _0x31d3ee[_0x1efa85(0x4a0)] = document[_0x1efa85(0x655)](_0x1efa85(0x793))[_0x1efa85(0x9bf)]; const _0x34ff2e = document[_0x1efa85(0x655)](_0x1efa85(0x7d4))[_0x1efa85(0x275)][0x0], _0x2ea6bc = document[_0x1efa85(0x655)](_0x1efa85(0x8cf))[_0x1efa85(0x275)][0x0]; if (_0x34ff2e) await _0x36c0a8(_0x1efa85(0x514) + _0x31d3ee['id'], _0x34ff2e); if (_0x2ea6bc) await _0x36c0a8(_0x1efa85(0x672) + _0x31d3ee['id'], _0x2ea6bc); _0x5eb81f(), _0x15e832(), await _0x151457(), _0x420e01(_0x1efa85(0x46a)), _0xcf54be(_0x1efa85(0x866), _0x1efa85(0x4d3)); } function _0x346630() { const _0x11bbb3 = _0x43c7a1; if ('EuDFN' === _0x11bbb3(0x556)) { const _0x58b89d = document['getElementById']('group-world-book-checkboxes'), _0x54340c = _0x58b89d[_0x11bbb3(0x49d)](_0x11bbb3(0x86a)), _0x39ad43 = document[_0x11bbb3(0x9ad)](_0x11bbb3(0x43d)); if (_0x54340c[_0x11bbb3(0x36c)] === 0x0) _0x39ad43[_0x11bbb3(0x68f)] = _0x11bbb3(0x294); else _0x54340c[_0x11bbb3(0x36c)] > 0x2 ? _0x11bbb3(0x85e) !== _0x11bbb3(0x85e) ? (_0x22b37a[_0x11bbb3(0x331)](_0x11bbb3(0x8e9)), _0x15f9ed[_0x11bbb3(0x295)] = _0x3119ad[_0x11bbb3(0x277)][_0x11bbb3(0x946)](_0x3ba616 => ({ 'id': _0x11bbb3(0x5e2) + _0x3ba616['id'], 'type': _0x11bbb3(0x921), 'participantIds': [_0x3ba616['id']] })), _0x2a6a25['activeCharacterId'] && (_0x366d61[_0x11bbb3(0x789)] = _0x11bbb3(0x5e2) + _0x58dd5e['activeCharacterId']), _0x1194c9[_0x11bbb3(0x277)]['forEach'](_0x4f8039 => { const _0x2feeb1 = _0x11bbb3, _0x27e91c = 'chatHistory_' + _0x4f8039['id'], _0x567537 = _0x2feeb1(0x8eb) + _0x4f8039['id'], _0x148683 = _0x4fb41e[_0x2feeb1(0x2c6)](_0x27e91c); _0x148683 && (_0x37c759[_0x2feeb1(0x548)](_0x567537, _0x148683), _0x11a9e2[_0x2feeb1(0x5c5)](_0x27e91c)); })) : _0x39ad43[_0x11bbb3(0x68f)] = _0x11bbb3(0x57b) + _0x54340c[_0x11bbb3(0x36c)] + '\x20项' : _0x39ad43['textContent'] = Array['from'](_0x54340c)['map'](_0x159653 => _0x159653[_0x11bbb3(0x1de)]['textContent']['trim']())[_0x11bbb3(0x9cc)]('、'); } else { const _0xe999ba = _0x20afec(_0xfb5591['authorId']) || { 'name': '未知' }; let _0x44e0d2 = _0x11bbb3(0x235) + _0xe999ba[_0x11bbb3(0x4da)] + _0x11bbb3(0x4b1) + (_0x1f7f18[_0x11bbb3(0x865)] || _0x42a70b[_0x11bbb3(0x472)]) + '”'; return _0x32d33b[_0x11bbb3(0x3b1)] === _0x11bbb3(0x2b9) && (_0x44e0d2 += '\x20(分享了歌曲:\x20' + _0x14071f[_0x11bbb3(0x1d2)] + _0x11bbb3(0x7a7) + _0x1537fa['artist'] + ')'), _0x44e0d2; } } async function _0x5652c7() { const _0x1a3366 = _0x43c7a1; if ('kthBK' !== 'kthBK') _0x1a609e(() => { const _0x1a00d1 = _0x118e, _0x1a29d5 = _0x390623[_0x1a00d1(0x655)](_0xf0a5d9); if (_0x1a29d5) _0x1a29d5[_0x1a00d1(0x84a)] = _0x1a91de[_0x1a00d1(0x912)]; }, 0x0); else { const _0x4700ed = _0x401cc7(), _0x43b34a = (_0x4700ed?.[_0x1a3366(0x4de)] || [])[_0x1a3366(0x946)](_0x8351ef)['filter'](Boolean), _0x343105 = _0x10af56(_0x4700ed['id']); if (!_0x4700ed || _0x4700ed['type'] !== _0x1a3366(0x6a4) || _0x43b34a[_0x1a3366(0x36c)] < 0x2) return null; const _0x1e03df = _0x4700ed[_0x1a3366(0x341)] && _0x4700ed[_0x1a3366(0x341)][_0x1a3366(0x36c)] > 0x0 ? '\x0a\x0a#\x20核心群聊世界观设定\x20(所有角色必须严格遵守以下设定)\x0a' + _0x4700ed[_0x1a3366(0x341)]['map'](_0x29de1e => _0x128784[_0x1a3366(0x188)]['find'](_0x5f1579 => _0x5f1579['id'] === _0x29de1e))[_0x1a3366(0x89c)](Boolean)[_0x1a3366(0x946)](_0x353c58 => _0x1a3366(0x5f5) + _0x353c58[_0x1a3366(0x4da)] + '\x0a' + _0x353c58['content'])[_0x1a3366(0x9cc)]('') : '', _0x514651 = _0x343105[_0x1a3366(0x489)] ? _0x1a3366(0x785) + _0x343105[_0x1a3366(0x4da)] + '”的补充信息\x0a' + _0x343105[_0x1a3366(0x489)] : ''; let _0x526fd4 = ''; const _0x2e6d56 = new Date(), _0x5edec9 = _0x128784[_0x1a3366(0x6e7)]['at'](-0x1); _0x526fd4 += '\x0a-\x20**当前时间**:\x20' + _0x2e6d56[_0x1a3366(0x1a3)](_0x1a3366(0x7ba), { 'dateStyle': _0x1a3366(0x7c4), 'timeStyle': _0x1a3366(0x628) }); if (_0x5edec9) { if (_0x1a3366(0x205) === _0x1a3366(0x205)) { const _0x184d63 = new Date(_0x5edec9[_0x1a3366(0x89b)]), _0x1c3d44 = Math['floor']((_0x2e6d56 - _0x184d63) / (0x3e8 * 0x3c)); if (_0x1c3d44 < 0x5) _0x526fd4 += _0x1a3366(0x420); else { if (_0x1c3d44 < 0x78) _0x526fd4 += _0x1a3366(0x658) + _0x1c3d44 + '分钟前聊过，请注意衔接。'; else { const _0xb6bb0 = Math[_0x1a3366(0x2b4)](_0x1c3d44 / 0x3c); if (_0xb6bb0 < 0x30) _0x526fd4 += _0x1a3366(0x658) + _0xb6bb0 + _0x1a3366(0x86f); else _0x526fd4 += _0x1a3366(0x502) + Math[_0x1a3366(0x2b4)](_0xb6bb0 / 0x18) + _0x1a3366(0x37f); } } } else { if (_0x2df828[_0x1a3366(0x949)]['closest'](_0x1a3366(0x264))) return; const _0x57bbc0 = _0x558bb5[_0x1a3366(0x655)]('widget-play-pause-btn'); _0x57bbc0 && _0x57bbc0[_0x1a3366(0x783)](); } } else _0x1a3366(0x8f3) === _0x1a3366(0x8f3) ? _0x526fd4 += _0x1a3366(0x7ed) : (_0x76acd4 = _0x4d9158['createElement']('div'), _0x14c2c6[_0x1a3366(0x1f0)] = _0x1a3366(0x656), _0x7f5f4a[_0x1a3366(0x68f)] = _0x1a3366(0x74e), _0x1526bb[_0x1a3366(0x3d5)](_0xdf5019)); const _0xcca2e3 = [..._0x128784[_0x1a3366(0x6e7)]][_0x1a3366(0x1f9)]()[_0x1a3366(0x787)](_0x279930 => _0x279930['role'] === _0x1a3366(0x500))?.['content'] || '', _0x7fe1cc = _0x2dd5cb(_0x4700ed, _0xcca2e3), _0x4652bb = _0x128784[_0x1a3366(0x6e7)][_0x1a3366(0x6e3)](-0x78), _0x4ec943 = _0x2f0881[_0x1a3366(0x946)](_0x52bc62 => _0x52bc62[_0x1a3366(0x4da)]), _0x41d27d = _0x15bafc(), _0x9abb3a = _0x43b34a[_0x1a3366(0x946)](_0x175556 => { const _0x2fc6dd = _0x1a3366; if (_0x2fc6dd(0x4dc) === 'qJaOJ') { const { omniText: _0x26ba83 } = _0x407b35(_0x175556['id'], _0x4700ed['id']), _0x30609c = _0x3de826(_0x175556['id']), _0x55a7ea = _0x175556['linkedWorldBookIds'] && _0x175556[_0x2fc6dd(0x341)]['length'] > 0x0 ? _0x2fc6dd(0x769) + _0x175556[_0x2fc6dd(0x4da)] + _0x2fc6dd(0x9b4) + _0x175556['linkedWorldBookIds']['map'](_0x96a243 => _0x128784[_0x2fc6dd(0x188)]['find'](_0x1175e5 => _0x1175e5['id'] === _0x96a243))[_0x2fc6dd(0x89c)](Boolean)[_0x2fc6dd(0x946)](_0x81ab9e => _0x2fc6dd(0x6e2) + _0x81ab9e[_0x2fc6dd(0x4da)] + '\x0a' + _0x81ab9e[_0x2fc6dd(0x472)])[_0x2fc6dd(0x9cc)]('') : ''; return { 'id': _0x175556['id'], 'name': _0x175556[_0x2fc6dd(0x4da)], 'persona': _0x175556[_0x2fc6dd(0x489)] || _0x2fc6dd(0x497), 'memory': _0x26ba83 + _0x30609c + _0x55a7ea }; } else throw new _0x581b80(_0x2fc6dd(0x876)); }), _0x32b1cf = 0x5, _0x156172 = 0xc, _0x995742 = _0x1a3366(0x366)[_0x1a3366(0x6df)](), _0x8a2cf9 = { 'instruction': (_0x1a3366(0x313) + (_0x343105[_0x1a3366(0x4da)] || '用户') + '”的群聊规划角色们的下一步发言。\x0a-\x20与你们对话的人类用户名为“' + (_0x343105[_0x1a3366(0x4da)] || '用户') + _0x1a3366(0x6c7) + _0x32b1cf + _0x1a3366(0x839) + _0x156172 + _0x1a3366(0x24b) + (_0x343105[_0x1a3366(0x4da)] || '用户') + _0x1a3366(0x2b6) + _0x526fd4 + '\x20\x0a' + _0x514651 + '\x0a' + _0x1e03df + '\x0a#\x20最近的动态回顾\x20(供所有角色参考)\x0a' + _0x41d27d + '\x0a')[_0x1a3366(0x6df)](), 'personas': _0x9abb3a, 'mentioned': _0x7fe1cc ? { 'id': _0x7fe1cc['id'], 'name': _0x7fe1cc['name'] } : null, 'stickerList': _0x4ec943 }, _0x5147eb = { 'type': _0x1a3366(0x581), 'properties': { 'events': { 'type': 'array', 'items': { 'type': _0x1a3366(0x581), 'required': [_0x1a3366(0x67b), _0x1a3366(0x468)], 'properties': { 'senderId': { 'type': _0x1a3366(0x7d9) }, 'kind': { 'type': _0x1a3366(0x7d9), 'enum': [_0x1a3366(0x64b), _0x1a3366(0x33b), _0x1a3366(0x2b9)] }, 'content': { 'type': _0x1a3366(0x7d9) }, 'sticker': { 'type': _0x1a3366(0x7d9) }, 'songName': { 'type': _0x1a3366(0x7d9) }, 'artist': { 'type': 'string' } } } } }, 'required': [_0x1a3366(0x9d2)] }, _0x32ab3f = []; _0x32ab3f['push']({ 'role': 'system', 'content': _0x995742 }); for (const _0x8be408 of _0x4652bb) { const _0x28567e = _0x8be408[_0x1a3366(0x4c9)] === 'ai' || _0x8be408['role'] === _0x1a3366(0x600) ? _0x1a3366(0x600) : _0x1a3366(0x500); let _0x3c7e1d = { 'role': _0x28567e, 'content': _0x8be408[_0x1a3366(0x472)] }, _0x154775 = !!_0x8be408['content'], _0x415320 = null; if (_0x8be408['image']) _0x415320 = _0x8be408[_0x1a3366(0x911)]; else { if (_0x8be408[_0x1a3366(0x431)]) try { if (_0x1a3366(0x48a) === 'Trzgw') _0x3d7211[_0x1a3366(0x9de)](_0x1a3366(0x2db), _0x535265); else { const _0x4bbb1d = await _0x226e0a(_0x8be408[_0x1a3366(0x431)]); if (_0x4bbb1d) { if (_0x1a3366(0x6ae) === _0x1a3366(0x6ae)) _0x415320 = await _0x171ffd(_0x4bbb1d); else { _0x5759de(![]), _0x5c93ae(_0x1a3366(0x319)); return; } } } } catch (_0x273f0e) { console[_0x1a3366(0x9de)](_0x1a3366(0x69f), _0x273f0e); } } _0x415320 && (_0x3c7e1d[_0x1a3366(0x911)] = _0x415320, _0x154775 = !![]); if (_0x154775) { if (_0x1a3366(0x98a) === _0x1a3366(0x3c8)) { const _0x29064c = _0x4f4781[_0x1a3366(0x26b)](_0x1a3366(0x76e)); _0x29064c[_0x1a3366(0x1f0)] = _0x1a3366(0x4ad), _0x29064c[_0x1a3366(0x711)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x301feb[_0x1a3366(0x912)] || _0x13b5d7) + _0x1a3366(0x570) + _0x4ff897[_0x1a3366(0x1d2)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>' + _0x46addc[_0x1a3366(0x2aa)] + _0x1a3366(0x87a), _0x29064c[_0x1a3366(0x9ad)](_0x1a3366(0x7a0))[_0x1a3366(0x9c8)] = () => _0x52c0bb(_0x1a3366(0x2b9)), _0x10e0c8['appendChild'](_0x29064c); } else _0x32ab3f['push'](_0x3c7e1d); } } _0x32ab3f[_0x1a3366(0x1e5)]({ 'role': _0x1a3366(0x500), 'content': _0x1a3366(0x1dc) + JSON[_0x1a3366(0x5e0)](_0x5147eb) + _0x1a3366(0x69c) + JSON[_0x1a3366(0x5e0)](_0x8a2cf9) }); try { const _0x8c2513 = await _0x2e6580(_0x32ab3f, { 'json': !![] }); if (!_0x8c2513) return null; let _0x4cd270 = _0x8c2513['trim'](); const _0x2b989e = _0x4cd270[_0x1a3366(0x256)](/```json([\s\S]*?)```/i); if (_0x2b989e) _0x4cd270 = _0x2b989e[0x1][_0x1a3366(0x6df)](); _0x4cd270 = _0x3495ae(_0x4cd270); let _0xefb267 = null; try { _0xefb267 = JSON[_0x1a3366(0x7a8)](_0x4cd270); } catch (_0x483534) { console[_0x1a3366(0x9de)](_0x1a3366(0x51b), _0x483534), console['error'](_0x1a3366(0x292), _0x4cd270); } if (!_0xefb267 || !Array['isArray'](_0xefb267[_0x1a3366(0x9d2)])) return null; return _0xefb267 = _0x10d6ab(_0xefb267, _0x43b34a, _0x4ec943), _0xefb267[_0x1a3366(0x9d2)] = _0xefb267[_0x1a3366(0x9d2)]['slice'](0x0, _0x156172), _0xefb267[_0x1a3366(0x9d2)][_0x1a3366(0x36c)] ? _0xefb267 : null; } catch (_0x214a16) { if (_0x1a3366(0x490) !== _0x1a3366(0x46f)) { if (_0x214a16[_0x1a3366(0x4da)] !== 'AbortError') { if ('xMBIc' === 'xMBIc') console['error'](_0x1a3366(0x2db), _0x214a16); else { const _0x50b2e2 = _0x1a3366(0x25f) + _0x10426b['id'], _0x332c07 = 'chatHistory_chat_' + _0x1c3a7d['id'], _0x44347a = _0x42fba0[_0x1a3366(0x2c6)](_0x50b2e2); _0x44347a && (_0x4d096e[_0x1a3366(0x548)](_0x332c07, _0x44347a), _0x293d21[_0x1a3366(0x5c5)](_0x50b2e2)); } } return null; } else _0x40c38c = _0x448996['createElement'](_0x1a3366(0x385)), _0x50ab03['id'] = 'live-preview-style', _0x3a466c[_0x1a3366(0x3f9)]['appendChild'](_0x5955f0); } } } function _0x128295() { const _0x5de29a = _0x43c7a1; if ('gfTqB' === 'vkfwK') { const _0x4e0256 = _0x19d226(_0x5d722d[_0x5de29a(0x9b3)])?.[_0x5de29a(0x4da)] || '未知'; return _0x5de29a(0x1e9) + _0x4e0256 + _0x5de29a(0x58c) + _0x45e592[_0x5de29a(0x472)] + _0x5de29a(0x2be); } else { const _0x1cc225 = document[_0x5de29a(0x655)](_0x5de29a(0x389)); _0x1cc225[_0x5de29a(0x711)] = ''; if (_0x128784['friendCircles'][_0x5de29a(0x36c)] === 0x0) { if (_0x5de29a(0x22d) !== _0x5de29a(0x6af)) { _0x1cc225['innerHTML'] = _0x5de29a(0x697); return; } else { _0xbac6c6('哼，只有私聊才能进行总结，群聊那么乱怎么记！'); return; } } _0x128784['friendCircles']['forEach'](_0xaf0ec7 => { const _0x53d992 = _0x5de29a; if ('NNuZJ' === _0x53d992(0x712)) _0x469f6e[_0x53d992(0x68f)] = _0x1ba1d2[_0x53d992(0x38f)], _0x5dead8[_0x53d992(0x68f)] = _0x279cc9[_0x53d992(0x2aa)], _0x4e1d1d[_0x53d992(0x421)][_0x53d992(0x266)](_0x53d992(0x449)), _0x1aad62[_0x53d992(0x385)][_0x53d992(0x6ac)](_0x53d992(0x314), 'url(' + _0x3cea5d['cover'] + ')'); else { const _0x29feb3 = _0x128784[_0x53d992(0x4a5)][_0x53d992(0x787)](_0x5911cd => _0x5911cd['id'] === _0xaf0ec7['boundUserProfileId']) || { 'name': _0x53d992(0x5c0) }, _0x3337e3 = document['createElement']('div'); _0x3337e3[_0x53d992(0x1f0)] = 'world-book-item', _0x3337e3['dataset']['id'] = _0xaf0ec7['id'], _0x3337e3[_0x53d992(0x711)] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0xaf0ec7[_0x53d992(0x4da)] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20' + _0x29feb3[_0x53d992(0x4da)] + '\x20|\x20' + _0xaf0ec7[_0x53d992(0x539)][_0x53d992(0x36c)] + _0x53d992(0x62b), _0x3337e3[_0x53d992(0x203)](_0x53d992(0x783), () => _0x4e9df4(_0xaf0ec7['id'])), _0x1cc225[_0x53d992(0x3d5)](_0x3337e3); } }); } } function _0x347a65(_0xf38db5 = null) { const _0x57cb19 = _0x43c7a1; if ('lUbPC' !== _0x57cb19(0x37c)) _0x1a405f[_0x57cb19(0x9de)]('无法从\x20IndexedDB\x20加载聊天图片:', _0x51e30f), _0x56f4a3[_0x57cb19(0x68b)] = _0x57cb19(0x231); else { const _0x1a7f44 = document[_0x57cb19(0x655)](_0x57cb19(0x867)), _0x33bb42 = document[_0x57cb19(0x655)](_0x57cb19(0x966)), _0x150ffa = document['getElementById'](_0x57cb19(0x9c4)), _0x548193 = document[_0x57cb19(0x655)](_0x57cb19(0x31d)), _0x1bd74c = document[_0x57cb19(0x655)](_0x57cb19(0x55d)), _0x2504c3 = document[_0x57cb19(0x655)]('delete-friend-circle-button'); _0x44a098(_0x57cb19(0x966)), _0x150ffa['innerHTML'] = '', _0x128784['characters']['forEach'](_0x528bbe => { const _0x8ed3fe = _0x57cb19, _0x2f41ee = document['createElement'](_0x8ed3fe(0x76e)); _0x2f41ee[_0x8ed3fe(0x1f0)] = _0x8ed3fe(0x71a), _0x2f41ee[_0x8ed3fe(0x711)] = _0x8ed3fe(0x422) + _0x528bbe['id'] + _0x8ed3fe(0x6f2) + _0x528bbe['id'] + _0x8ed3fe(0x701) + (_0x528bbe['avatar'] || _0x3834ec) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-' + _0x528bbe['id'] + _0x8ed3fe(0x297) + _0x528bbe[_0x8ed3fe(0x4da)] + _0x8ed3fe(0x734), _0x150ffa['appendChild'](_0x2f41ee); }); if (_0xf38db5) { if (_0x57cb19(0x2a2) !== _0x57cb19(0x9e5)) { const _0x19e98d = _0x128784[_0x57cb19(0x21f)][_0x57cb19(0x787)](_0x1b9164 => _0x1b9164['id'] === _0xf38db5); if (!_0x19e98d) return; _0x548193['textContent'] = _0x57cb19(0x79d), _0x1bd74c[_0x57cb19(0x9bf)] = _0x19e98d['id'], _0x1a7f44['value'] = _0x19e98d[_0x57cb19(0x4da)], _0x33bb42['value'] = _0x19e98d[_0x57cb19(0x4a0)], _0x2504c3[_0x57cb19(0x385)][_0x57cb19(0x1cd)] = 'block', _0x19e98d['memberCharacterIds'][_0x57cb19(0x4d0)](_0x2a4347 => { const _0x3b593f = _0x57cb19; if (_0x3b593f(0x9bd) === _0x3b593f(0x9bd)) { const _0x3729fa = _0x150ffa[_0x3b593f(0x9ad)](_0x3b593f(0x2c1) + _0x2a4347); if (_0x3729fa) _0x3729fa[_0x3b593f(0x30c)] = !![]; } else _0x1fa228('保存失败，你的表情包是不是太多了？'); }); } else _0x45f66e = _0x5c1496[_0x57cb19(0x4da)] || '我', _0x2670ec = 'speaker-user'; } else _0x57cb19(0x5b1) !== _0x57cb19(0x7a3) ? (_0x548193[_0x57cb19(0x68f)] = _0x57cb19(0x73e), _0x1bd74c[_0x57cb19(0x9bf)] = '', _0x1a7f44[_0x57cb19(0x9bf)] = _0x57cb19(0x513) + (_0x128784[_0x57cb19(0x21f)]['length'] + 0x1), _0x33bb42[_0x57cb19(0x9bf)] = _0x128784[_0x57cb19(0x226)], _0x2504c3[_0x57cb19(0x385)][_0x57cb19(0x1cd)] = _0x57cb19(0x44e)) : _0x2bc421['error']('在准备动态回复时，读取图片失败:', _0x58ccd5); _0xcf54be(_0x57cb19(0x684), _0x57cb19(0x64f)); } } function _0x51d0e9() { const _0x27ae71 = _0x43c7a1, _0x58f090 = document[_0x27ae71(0x655)](_0x27ae71(0x55d))[_0x27ae71(0x9bf)], _0x18ff81 = document[_0x27ae71(0x655)](_0x27ae71(0x867))[_0x27ae71(0x9bf)][_0x27ae71(0x6df)](), _0x3e9847 = document[_0x27ae71(0x655)](_0x27ae71(0x966))[_0x27ae71(0x9bf)], _0x2bfdd4 = Array[_0x27ae71(0x82f)](document[_0x27ae71(0x49d)](_0x27ae71(0x2c8)))[_0x27ae71(0x946)](_0xd3b252 => _0xd3b252[_0x27ae71(0x663)]['id']); if (!_0x18ff81) { _0x420e01(_0x27ae71(0x9e0)); return; } if (_0x2bfdd4['length'] === 0x0) { if (_0x27ae71(0x24e) !== _0x27ae71(0x52a)) { _0x420e01(_0x27ae71(0x1b5)); return; } else _0x3b76af = '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“' + _0x1ab035[_0x27ae71(0x4da)] + _0x27ae71(0x4d9); } if (_0x58f090) { if ('BxMvB' !== _0x27ae71(0x1c6)) { const _0x5f1b16 = _0x128784[_0x27ae71(0x21f)][_0x27ae71(0x787)](_0x4204d3 => _0x4204d3['id'] === _0x58f090); _0x5f1b16 && (_0x5f1b16[_0x27ae71(0x4da)] = _0x18ff81, _0x5f1b16[_0x27ae71(0x4a0)] = _0x3e9847, _0x5f1b16[_0x27ae71(0x539)] = _0x2bfdd4); } else _0x4565be(_0x39564e, _0x2fa7e1[_0x27ae71(0x949)][_0x27ae71(0x275)][0x0]); } else { const _0x32488d = { 'id': _0x27ae71(0x39c) + Date[_0x27ae71(0x8a2)](), 'name': _0x18ff81, 'boundUserProfileId': _0x3e9847, 'memberCharacterIds': _0x2bfdd4, 'posts': [] }; _0x128784[_0x27ae71(0x21f)][_0x27ae71(0x1e5)](_0x32488d); } _0x5eb81f(), _0x420e01('好友圈已保存！'), _0x128295(), _0xcf54be('friendCircleList', _0x27ae71(0x684)); } async function _0x36027a() { const _0x4f99ea = _0x43c7a1; if (_0x4f99ea(0x4e7) === _0x4f99ea(0x4e7)) { const _0x4360ad = document[_0x4f99ea(0x655)]('editing-friend-circle-id')['value']; if (!_0x4360ad) return; const _0x440b6c = await _0x17d4de('确定要删除这个好友圈吗？此操作不可撤销。'); _0x440b6c && (_0x128784['friendCircles'] = _0x128784[_0x4f99ea(0x21f)][_0x4f99ea(0x89c)](_0x1691ce => _0x1691ce['id'] !== _0x4360ad), _0x128784[_0x4f99ea(0x462)] === _0x4360ad && (_0x128784['activeFriendCircleId'] = null), _0x5eb81f(), _0x420e01(_0x4f99ea(0x97f)), _0x128295(), _0xcf54be(_0x4f99ea(0x64f), _0x4f99ea(0x684))); } else { const _0x288760 = _0x4db217[_0x4f99ea(0x655)]('daily-expenses-list'), _0xe65250 = _0x5044e2['getElementById'](_0x4f99ea(0x2ec)), _0xb7433e = new _0x1974b8(), _0x2d935c = _0x394137[_0x4f99ea(0x7cb)]['filter'](_0x32832e => new _0xb9e296(_0x32832e['timestamp'])[_0x4f99ea(0x320)]() === _0xb7433e[_0x4f99ea(0x320)]()); if (_0x2d935c['length'] === 0x0) { _0x288760['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天还没有花钱哦。</p>', _0xe65250[_0x4f99ea(0x711)] = ''; return; } _0x288760[_0x4f99ea(0x711)] = '', _0x2d935c['sort']((_0x52ec95, _0x5dd816) => _0x5dd816['timestamp'] - _0x52ec95[_0x4f99ea(0x89b)])[_0x4f99ea(0x4d0)](_0x3ed551 => { const _0x21a374 = _0x4f99ea, _0x22a77e = _0x5381e4[_0x21a374(0x26b)]('div'); _0x22a77e[_0x21a374(0x1f0)] = _0x21a374(0x1a7), _0x22a77e[_0x21a374(0x711)] = '<span\x20class=\x22description\x22>' + _0x3ed551['description'] + '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20' + _0x3ed551[_0x21a374(0x9d3)][_0x21a374(0x8bd)](0x2) + _0x21a374(0x583) + _0x3ed551['id'] + _0x21a374(0x922), _0x288760['appendChild'](_0x22a77e); }), _0xe65250 && (_0xe65250[_0x4f99ea(0x711)] = _0x4f99ea(0x817), _0x4d504f[_0x4f99ea(0x655)](_0x4f99ea(0x4bc))['addEventListener'](_0x4f99ea(0x783), _0x420ddf)); } } function _0x4e9df4(_0x78d046) { const _0x68ae62 = _0x43c7a1; if (_0x68ae62(0x70a) === _0x68ae62(0x70a)) { _0x27d2d1(); const _0x1380d2 = _0x128784[_0x68ae62(0x21f)][_0x68ae62(0x787)](_0x52e87c => _0x52e87c['id'] === _0x78d046); if (!_0x1380d2) return; _0x128784['activeFriendCircleId'] = _0x78d046, _0x5eb81f(), document[_0x68ae62(0x655)](_0x68ae62(0x2ef))[_0x68ae62(0x68f)] = _0x1380d2[_0x68ae62(0x4da)], _0x474d50(), _0xcf54be(_0x68ae62(0x2b9), _0x68ae62(0x64f)), _0x17797f(); } else { const _0x21ae0d = _0x3632f7['querySelector'](_0x68ae62(0x8e6)); if (_0x21ae0d && (_0x21ae0d['id'] === _0x68ae62(0x66e) || _0x21ae0d['id'] === _0x68ae62(0x336))) _0x1ab788(); else { const _0x3c4f34 = _0x359589[_0x68ae62(0x49d)](_0x68ae62(0x58e)); _0x3c4f34['forEach'](_0x585b96 => _0x585b96[_0x68ae62(0x66f)]()); } } } function _0x4b8ecc() { const _0x5870f4 = _0x43c7a1; if ('GDcsf' === _0x5870f4(0x76f)) { if (!_0x128784[_0x5870f4(0x21f)] || _0x128784[_0x5870f4(0x21f)]['length'] === 0x0) { console[_0x5870f4(0x9de)](_0x5870f4(0x1bd)); return; } const _0x5a7938 = _0x128784[_0x5870f4(0x21f)][0x0]; if (_0x5a7938[_0x5870f4(0x539)]['length'] < 0x2) { console[_0x5870f4(0x9de)]('错误：第一个好友圈\x20\x22' + _0x5a7938[_0x5870f4(0x4da)] + _0x5870f4(0x8f0)); return; } const _0x47afb3 = { 'id': 'test_post_' + Date[_0x5870f4(0x8a2)](), 'authorType': _0x5870f4(0x8d9), 'authorId': _0x5a7938[_0x5870f4(0x539)][0x0], 'content': '这是一条由控制台添加的测试动态！样式看起来非常完美。', 'timestamp': Date[_0x5870f4(0x8a2)](), 'likes': [_0x5a7938[_0x5870f4(0x539)][0x1]], 'comments': [{ 'commentId': 'c_' + Date[_0x5870f4(0x8a2)](), 'authorId': _0x5a7938[_0x5870f4(0x539)][0x1], 'content': _0x5870f4(0x45e) }] }; _0x5a7938[_0x5870f4(0x1e2)][_0x5870f4(0x1e5)](_0x47afb3), _0x5eb81f(), console[_0x5870f4(0x331)]('成功向好友圈\x20\x22' + _0x5a7938[_0x5870f4(0x4da)] + _0x5870f4(0x3a5)), _0x420e01(_0x5870f4(0x83d)); } else _0x2beddf = _0x2c99d7[_0x5870f4(0x4da)], _0x59d4d0 = _0x4f6678['avatar']; } window[_0x43c7a1(0x29e)] = _0x4b8ecc; function _0x545cf7(_0x3864fd) { const _0x4803af = _0x43c7a1; return _0x128784['userProfiles'][_0x4803af(0x787)](_0xcebae => _0xcebae['id'] === _0x3864fd); } function _0xddfd1b(_0x10135c, _0x2a8259 = '正在处理...') { const _0x19be2f = _0x43c7a1; if ('LQTCQ' !== 'LQTCQ') _0x1ad329 = _0x47ccb2[_0x19be2f(0x26b)](_0x19be2f(0x385)), _0x36d6b3['id'] = 'style-' + _0x149f73['id'], _0x3039c3[_0x19be2f(0x3f9)][_0x19be2f(0x3d5)](_0x290b8f); else { const _0x95abe7 = document[_0x19be2f(0x655)](_0x19be2f(0x2ff)); let _0x595741 = document['getElementById']('feed-loader'); _0x10135c ? _0x19be2f(0x2c3) === _0x19be2f(0x668) ? _0x36ba2a['boundUserProfileId'] = _0x3e5f6f[_0x19be2f(0x226)] : (!_0x595741 && (_0x595741 = document['createElement'](_0x19be2f(0x76e)), _0x595741['id'] = 'feed-loader', _0x95abe7[_0x19be2f(0x3d5)](_0x595741)), _0x595741[_0x19be2f(0x711)] = _0x19be2f(0x5b9) + _0x2a8259 + '</span>', _0x595741[_0x19be2f(0x385)]['display'] = _0x19be2f(0x4d4)) : _0x595741 && (_0x595741['style'][_0x19be2f(0x1cd)] = 'none'); } } async function _0x337f84() { const _0x4616b3 = _0x43c7a1, _0x118b6d = _0x128784[_0x4616b3(0x21f)][_0x4616b3(0x787)](_0x4a7112 => _0x4a7112['id'] === _0x128784['activeFriendCircleId']); if (!_0x118b6d || _0x128784[_0x4616b3(0x2d7)]) return; _0xddfd1b(!![], _0x4616b3(0x3db)), _0x128784['isGenerating'] = !![]; try { let _0x3dbfd8 = Date[_0x4616b3(0x8a2)](); _0x118b6d[_0x4616b3(0x1e2)] && _0x118b6d[_0x4616b3(0x1e2)][_0x4616b3(0x36c)] > 0x0 && (_0x4616b3(0x23f) !== 'Rldpx' ? _0x3dbfd8 = Math['max'](..._0x118b6d[_0x4616b3(0x1e2)][_0x4616b3(0x946)](_0xe06b63 => _0xe06b63[_0x4616b3(0x89b)])) : _0x51a220[_0x4616b3(0x3d5)](_0x1d7ff5)); const _0x33e757 = await _0x4900e4(_0x118b6d); if (!_0x33e757 || _0x33e757['length'] === 0x0) { if (_0x4616b3(0x187) === _0x4616b3(0x187)) { _0x420e01('AI似乎没有想出任何新动态。'); return; } else _0x40dd9d = _0x2d25b0[_0x4616b3(0x4b6)] || _0x160f8f, _0x397424 = _0x59e035[_0x4616b3(0x4da)] || _0x4616b3(0x17d), _0x4b486f = _0x296045[_0x4616b3(0x540)] || '私聊'; } const _0x555c4c = _0x33e757[_0x4616b3(0x946)](async (_0x110b99, _0x57fdf0) => { const _0xadfe0b = _0x4616b3; if (_0xadfe0b(0x17b) !== _0xadfe0b(0x5b5)) { _0xddfd1b(!![], '刷新了\x20' + (_0x57fdf0 + 0x1) + '\x20/\x20' + _0x33e757['length'] + _0xadfe0b(0x9cd)); const _0x4f37e4 = _0x3dbfd8 + (_0x57fdf0 + 0x1) * 0x3c * 0x3e8, _0x1b6a35 = { 'id': _0xadfe0b(0x22a) + _0x110b99[_0xadfe0b(0x9b3)] + '_' + _0x4f37e4, 'authorType': _0xadfe0b(0x8d9), 'authorId': _0x110b99[_0xadfe0b(0x9b3)], 'content': _0x110b99[_0xadfe0b(0x653)], 'timestamp': _0x4f37e4, 'likes': _0x110b99['likes'] || [], 'comments': (_0x110b99[_0xadfe0b(0x8f2)] || [])['map']((_0x9d4e83, _0x256fe2) => ({ 'commentId': 'c_' + _0x4f37e4 + '_' + _0x256fe2, 'authorId': _0x9d4e83[_0xadfe0b(0x9b3)], 'content': _0x9d4e83['content'] })) }; if (_0x110b99[_0xadfe0b(0x243)] === _0xadfe0b(0x2b9) && _0x110b99['songName'] && _0x110b99[_0xadfe0b(0x2aa)]) try { const _0x19e66f = await _0x20e996(_0x110b99[_0xadfe0b(0x1d2)], _0x110b99[_0xadfe0b(0x2aa)]); _0x1b6a35['type'] = 'music', _0x1b6a35[_0xadfe0b(0x1d2)] = _0x110b99[_0xadfe0b(0x1d2)], _0x1b6a35['artist'] = _0x110b99[_0xadfe0b(0x2aa)], _0x1b6a35[_0xadfe0b(0x912)] = _0x19e66f[_0xadfe0b(0x678)], _0x1b6a35[_0xadfe0b(0x36f)] = _0x19e66f[_0xadfe0b(0x237)]; } catch (_0x57d1c7) { console[_0xadfe0b(0x9de)]('动态中的音乐搜索失败:', _0x57d1c7), _0x1b6a35[_0xadfe0b(0x3b1)] = 'text'; } else _0x1b6a35[_0xadfe0b(0x3b1)] = _0xadfe0b(0x64b); return _0x1b6a35; } else { if (_0x4dcd81) { const _0x260db8 = _0x1d3127[_0xadfe0b(0x26b)]('p'); _0x260db8[_0xadfe0b(0x711)] = _0x5c4189, _0x260db8['style'][_0xadfe0b(0x77b)] = '0', _0x3bd144['appendChild'](_0x260db8); } } }), _0x5ed807 = await Promise[_0x4616b3(0x5fb)](_0x555c4c); _0x118b6d[_0x4616b3(0x1e2)][_0x4616b3(0x1e5)](..._0x5ed807), _0x5eb81f(); } catch (_0x446179) { console[_0x4616b3(0x9de)](_0x4616b3(0x2ee), _0x446179), _0x420e01('生成动态时发生错误:\x20' + _0x446179[_0x4616b3(0x740)]); } finally { _0x474d50(), _0xddfd1b(![]), _0x128784[_0x4616b3(0x2d7)] = ![]; } } async function _0x4900e4(_0x12cadd) { const _0x2ae360 = _0x43c7a1, _0x54c86a = _0x12cadd[_0x2ae360(0x539)][_0x2ae360(0x946)](_0xd04272 => _0x8351ef(_0xd04272))['filter'](Boolean); if (_0x54c86a[_0x2ae360(0x36c)] === 0x0) return null; const _0x513265 = _0x15bafc(), _0x1779e = _0x545cf7(_0x12cadd[_0x2ae360(0x4a0)]) || _0x128784[_0x2ae360(0x4a5)][0x0], _0x1b8639 = _0x1779e ? _0x2ae360(0x96c) + _0x1779e[_0x2ae360(0x4da)] + _0x2ae360(0x407) + (_0x1779e['persona'] || '无') + '\x0a' : '', _0x6b97bb = _0x54c86a[_0x2ae360(0x946)](_0x5a29d6 => { const _0x2b57cd = _0x2ae360; if (_0x2b57cd(0x1d3) !== _0x2b57cd(0x1d3)) _0x192d23[_0x2b57cd(0x203)]('click', () => { const _0xbab8b4 = _0x2eb21(_0x42c7f5['dataset']['page'], 0xa); _0x333b59(_0xbab8b4); }); else { const { omniText: _0x3dd107 } = _0x407b35(_0x5a29d6['id'], null), _0x1a873e = _0x3de826(_0x5a29d6['id']), _0x401485 = _0x5a29d6[_0x2b57cd(0x341)] && _0x5a29d6[_0x2b57cd(0x341)][_0x2b57cd(0x36c)] > 0x0 ? '\x0a\x0a#\x20' + _0x5a29d6['name'] + _0x2b57cd(0x9b4) + _0x5a29d6['linkedWorldBookIds'][_0x2b57cd(0x946)](_0xfab20d => _0x128784[_0x2b57cd(0x188)][_0x2b57cd(0x787)](_0x5e6b15 => _0x5e6b15['id'] === _0xfab20d))[_0x2b57cd(0x89c)](Boolean)[_0x2b57cd(0x946)](_0x44f582 => _0x2b57cd(0x6e2) + _0x44f582[_0x2b57cd(0x4da)] + '\x0a' + _0x44f582['content'])[_0x2b57cd(0x9cc)]('') : ''; return _0x2b57cd(0x538) + _0x5a29d6[_0x2b57cd(0x4da)] + _0x2b57cd(0x534) + _0x5a29d6['id'] + _0x2b57cd(0x46e) + _0x5a29d6[_0x2b57cd(0x489)] + _0x2b57cd(0x660) + _0x3dd107 + '\x0a' + _0x1a873e + '\x0a' + _0x401485; } })[_0x2ae360(0x9cc)]('\x0a\x0a'), _0x11be22 = Math[_0x2ae360(0x2b4)](Math[_0x2ae360(0x1c0)]() * 0x3) + 0x2, _0x2958cc = _0x2ae360(0x18e) + _0x11be22 + _0x2ae360(0x774) + _0x6b97bb + '\x0a' + _0x1b8639 + '\x0a#\x20最近的动态回顾\x20(供参考，避免重复)\x0a' + _0x513265 + _0x2ae360(0x722) + _0x11be22 + _0x2ae360(0x56a) + _0x11be22 + _0x2ae360(0x86d), _0x1bf996 = [{ 'role': _0x2ae360(0x960), 'content': _0x2958cc }, { 'role': _0x2ae360(0x500), 'content': _0x2ae360(0x60b) }]; _0x1bf996[_0x2ae360(0x1e5)]({ 'role': 'user', 'content': _0x2ae360(0x82b) + _0x11be22 + _0x2ae360(0x935) }); try { const _0x3ca143 = await _0x2e6580(_0x1bf996, { 'json': !![] }), _0x15d5af = _0x3ca143[_0x2ae360(0x256)](/(\[[\s\S]*\])/); if (!_0x15d5af) throw new Error(_0x2ae360(0x5c1)); const _0x2afd16 = _0x15d5af[0x1], _0x3c5cf4 = JSON[_0x2ae360(0x7a8)](_0x2afd16); if (!Array[_0x2ae360(0x79f)](_0x3c5cf4)) throw new Error(_0x2ae360(0x831)); return _0x3c5cf4; } catch (_0x25aeb3) { return _0x2ae360(0x859) === _0x2ae360(0x859) ? (console['error'](_0x2ae360(0x77e), _0x25aeb3), console[_0x2ae360(0x9de)]('AI返回的原始文本:', _0x25aeb3[_0x2ae360(0x80f)] || response), null) : ''; } } async function _0x11e9f9() { const _0x5e7d5f = _0x43c7a1; if ('JByhW' !== _0x5e7d5f(0x8c6)) _0x25bd36[_0x5e7d5f(0x9de)](_0x5e7d5f(0x9c9), _0x3cda39), _0x444e69 = _0x2eb587; else { const _0x35bd7c = _0x128784[_0x5e7d5f(0x21f)][_0x5e7d5f(0x787)](_0x32732f => _0x32732f['id'] === _0x128784[_0x5e7d5f(0x462)]); if (!_0x35bd7c) return; const _0x1ffcb8 = await _0x17d4de(_0x5e7d5f(0x27f) + _0x35bd7c['name'] + '”的所有动态吗？此操作不可撤销，且AI将不再记得这些内容。'); _0x1ffcb8 && (_0x35bd7c[_0x5e7d5f(0x1e2)] = [], _0x5eb81f(), _0x474d50(), _0x420e01('动态已清空。')); } } function _0x474d50() { const _0x4757f4 = _0x43c7a1, _0x232999 = document[_0x4757f4(0x655)](_0x4757f4(0x677)), _0x4b058f = _0x128784[_0x4757f4(0x21f)][_0x4757f4(0x787)](_0x47f27b => _0x47f27b['id'] === _0x128784[_0x4757f4(0x462)]); if (!_0x4b058f) { if (_0x4757f4(0x4ab) === 'tdpaz') { _0x232999[_0x4757f4(0x711)] = _0x4757f4(0x4c2); return; } else { let _0x21e02a = _0x4f2fb8[_0x4757f4(0x6df)](); const _0x4786c6 = _0x21e02a[_0x4757f4(0x256)](/(\[[\s\S]*\])/); _0x4786c6 && (_0x21e02a = _0x4786c6[0x1]); const _0x462d84 = _0x2e42dc[_0x4757f4(0x7a8)](_0x21e02a); if (_0x55b72a['isArray'](_0x462d84)) { _0x194f57[_0x4757f4(0x5df)] = _0x462d84, _0x45bc2b[_0x4757f4(0x3d1)][_0x5c1540['id']] = [..._0x462d84], _0x34c735(); const _0x4ed424 = _0x462d84[_0x4757f4(0x946)](_0x18639a => _0x18639a['speaker'] === _0x4757f4(0x71b) ? _0x18639a[_0x4757f4(0x91c)] : _0x18639a[_0x4757f4(0x555)] + ':\x20' + _0x18639a[_0x4757f4(0x91c)])[_0x4757f4(0x9cc)]('\x0a\x0a'); _0x4f5b77[_0x4757f4(0x6e7)][_0x4757f4(0x1e5)]({ 'role': _0x4757f4(0x600), 'senderId': _0x409431['id'], 'timestamp': _0x2ffca4[_0x4757f4(0x8a2)](), 'isOffline': !![], 'content': _0x4ed424 }); } } } if (!_0x4b058f[_0x4757f4(0x1e2)] || _0x4b058f[_0x4757f4(0x1e2)][_0x4757f4(0x36c)] === 0x0) { _0x232999[_0x4757f4(0x711)] = _0x4757f4(0x81b); return; } _0x232999[_0x4757f4(0x711)] = ''; const _0x3271c7 = [..._0x4b058f[_0x4757f4(0x1e2)]][_0x4757f4(0x8e2)]((_0x7047df, _0x5ce100) => _0x5ce100[_0x4757f4(0x89b)] - _0x7047df[_0x4757f4(0x89b)]); _0x3271c7[_0x4757f4(0x4d0)](_0xe07407 => { const _0x49f9d8 = _0x4757f4; if (_0x49f9d8(0x2e5) !== 'IjRpp') { const _0x51d7da = document[_0x49f9d8(0x26b)](_0x49f9d8(0x76e)); _0x51d7da[_0x49f9d8(0x1f0)] = _0x49f9d8(0x2f3); let _0x4497ea = '未知', _0xa78304 = _0x3834ec; if (_0xe07407[_0x49f9d8(0x8e4)] === _0x49f9d8(0x500)) { if (_0x49f9d8(0x7c2) === _0x49f9d8(0x7c2)) { const _0x1aa64e = _0x545cf7(_0xe07407['authorId']); if (_0x1aa64e) { if (_0x49f9d8(0x88b) === _0x49f9d8(0x3b6)) { if (_0x34d8d2[_0x49f9d8(0x36c)] === 0x0) return; _0x2a8db4 = (_0x41ddf7 - 0x1 + _0x36fb11[_0x49f9d8(0x36c)]) % _0xd13a64[_0x49f9d8(0x36c)], _0xcfad1a(_0x502a5a[_0x540246], _0x4a6f09); } else _0x4497ea = _0x1aa64e[_0x49f9d8(0x4da)], _0xa78304 = _0x1aa64e[_0x49f9d8(0x4b6)]; } } else _0x31fb07[_0x49f9d8(0x3b7)](), _0x41cca8(); } else { if (_0x49f9d8(0x858) === 'saRYy') { const _0x43bd08 = new _0x2dd702(); _0x43bd08[_0x49f9d8(0x3f3)] = () => _0xe8902d(_0x43bd08['result']), _0x43bd08['onerror'] = _0x1b31f3, _0x43bd08['readAsDataURL'](_0x569370); } else { const _0x241dac = _0x8351ef(_0xe07407['authorId']); if (_0x241dac) { if (_0x49f9d8(0x2dc) === _0x49f9d8(0x2dc)) _0x4497ea = _0x241dac[_0x49f9d8(0x4da)], _0xa78304 = _0x241dac['avatar']; else { _0xa73bbc['error'](_0x49f9d8(0x2fb), _0xdaea1d), _0x4c3087[_0x49f9d8(0x277)] = [], _0x516d3e[_0x49f9d8(0x295)] = [], _0x3e82b8[_0x49f9d8(0x789)] = null; try { _0x1af89a[_0x49f9d8(0x5c5)](_0x49f9d8(0x52b)); } catch (_0x32cef4) { _0x45c3dd[_0x49f9d8(0x9de)]('Failed\x20to\x20remove\x20corrupted\x20state\x20from\x20localStorage:', _0x32cef4); } } } } } const _0x3eff03 = _0x49f9d8(0x6f4) + _0xa78304 + _0x49f9d8(0x82e) + _0x4497ea + _0x49f9d8(0x2cf), _0x31b267 = '<p\x20class=\x22music-post-thought\x22>' + _0xe07407[_0x49f9d8(0x472)] + _0x49f9d8(0x71d); let _0x542338 = ''; if (_0xe07407[_0x49f9d8(0x911)] || _0xe07407[_0x49f9d8(0x431)]) { if (_0x49f9d8(0x50d) !== _0x49f9d8(0x50d)) _0x577638[_0x49f9d8(0x7b6)](_0x49f9d8(0x428), { 'keyPath': 'id' }); else { const _0x7babec = 'post-img-' + _0xe07407['id']; _0x542338 = _0x49f9d8(0x217) + _0x7babec + _0x49f9d8(0x28e), setTimeout(() => { const _0xc99b7a = _0x49f9d8; if ('DyKli' !== _0xc99b7a(0x2c2)) _0x557f47[_0xc99b7a(0x5c5)]('chatHistory_' + _0x530af9); else { const _0x20c5fa = document[_0xc99b7a(0x655)](_0x7babec); if (!_0x20c5fa) return; if (_0xe07407[_0xc99b7a(0x911)]) _0x20c5fa[_0xc99b7a(0x84a)] = _0xe07407[_0xc99b7a(0x911)]; else _0xe07407[_0xc99b7a(0x431)] && (_0xc99b7a(0x287) === _0xc99b7a(0x54c) ? (_0x109edb['isGenerating'] && _0xd5f3bb[_0xc99b7a(0x9ca)] && (_0xaea8ef[_0xc99b7a(0x331)]('用户操作中断了\x20AI\x20响应。'), _0x39b55b[_0xc99b7a(0x9ca)][_0xc99b7a(0x4a1)](_0xc99b7a(0x61f)), _0x44e540[_0xc99b7a(0x9ca)] = null), _0x236a2e[_0xc99b7a(0x2d7)] = ![], _0x9131d7(![])) : _0x226e0a(_0xe07407[_0xc99b7a(0x431)])['then'](_0x4c89a2 => { const _0x1906a3 = _0xc99b7a; if (_0x1906a3(0x726) !== _0x1906a3(0x726)) { const _0x5cf8c2 = _0x4f53d8[_0x1906a3(0x655)]('clock-color-toggle'); if (!_0x5cf8c2) return; _0x5cf8c2['checked'] = _0x12ef7f[_0x1906a3(0x430)][_0x1906a3(0x6fa)] || ![], _0x5cf8c2[_0x1906a3(0x203)](_0x1906a3(0x272), () => { const _0x5ef1e5 = _0x1906a3; _0x1244d5['preferences'][_0x5ef1e5(0x6fa)] = _0x5cf8c2[_0x5ef1e5(0x30c)], _0x4f6739(), _0x442302(); }); } else { if (_0x4c89a2) { if (_0x1906a3(0x39f) !== 'eDAzB') _0x535995[_0x1906a3(0x548)](_0x1906a3(0x379), _0x306735[_0x1906a3(0x5e0)](_0x2b9f94)), _0x50a5e2(_0x1906a3(0x758)), _0x6906bf(() => _0x4371be[_0x1906a3(0x360)](), 0x5dc); else { const _0x123ce4 = URL[_0x1906a3(0x9be)](_0x4c89a2); _0x20c5fa[_0x1906a3(0x84a)] = _0x123ce4, _0x20c5fa[_0x1906a3(0x74c)] = () => URL[_0x1906a3(0x775)](_0x123ce4); } } } })); } }, 0x0); } } let _0x59e20e = ''; _0xe07407[_0x49f9d8(0x3b1)] === 'music' && _0xe07407[_0x49f9d8(0x1d2)] && (_0x59e20e = _0x49f9d8(0x45b) + _0xe07407['id'] + _0x49f9d8(0x2bf) + (_0xe07407[_0x49f9d8(0x912)] || _0x3834ec) + _0x49f9d8(0x9a3) + _0xe07407[_0x49f9d8(0x1d2)] + _0x49f9d8(0x1be) + _0xe07407['artist'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>' + (_0xe07407[_0x49f9d8(0x36f)] ? '▶' : '⚠') + _0x49f9d8(0x568)); const _0x45ac1b = _0x49f9d8(0x68a) + new Date(_0xe07407[_0x49f9d8(0x89b)])['toLocaleString'](_0x49f9d8(0x7ba)) + '</div>'; let _0x26d63e = ''; if (_0xe07407['likes'] && _0xe07407['likes'][_0x49f9d8(0x36c)] > 0x0 || _0xe07407[_0x49f9d8(0x8f2)] && _0xe07407['comments'][_0x49f9d8(0x36c)] > 0x0) { if (_0x49f9d8(0x535) === _0x49f9d8(0x8da)) { const _0x2d1e76 = _0x5aa541[_0x49f9d8(0x90c)](_0x15ddef, 0x2); _0x2d1e76['onerror'] = () => _0x19e0df(_0x49f9d8(0x1a1)), _0x2d1e76[_0x49f9d8(0x265)] = () => _0x65437f(_0x2d1e76[_0x49f9d8(0x5a7)]), _0x2d1e76[_0x49f9d8(0x42e)] = _0x2109fa => { const _0x2951db = _0x49f9d8, _0x1a5e9b = _0x2109fa[_0x2951db(0x949)][_0x2951db(0x5a7)]; !_0x1a5e9b[_0x2951db(0x8b1)][_0x2951db(0x878)](_0x206085) && _0x1a5e9b[_0x2951db(0x7b6)](_0x1c2d3b, { 'keyPath': 'id' }), !_0x1a5e9b[_0x2951db(0x8b1)][_0x2951db(0x878)]('music_library') && _0x1a5e9b['createObjectStore'](_0x2951db(0x428), { 'keyPath': 'id' }); }; } else { let _0x244a67 = ''; if (_0xe07407[_0x49f9d8(0x969)] && _0xe07407[_0x49f9d8(0x969)][_0x49f9d8(0x36c)] > 0x0) { if (_0x49f9d8(0x6b5) === _0x49f9d8(0x189)) _0x294f5f['appendChild'](_0x40e25b), _0x4c034f[_0x49f9d8(0x3d5)](_0x21085d); else { const _0x2eca6a = _0xe07407[_0x49f9d8(0x969)][_0x49f9d8(0x946)](_0x488710 => _0x8351ef(_0x488710)?.[_0x49f9d8(0x4da)] || '未知')[_0x49f9d8(0x9cc)]('、'), _0x52f053 = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>'; _0x244a67 = _0x49f9d8(0x8cd) + _0x52f053 + '\x20' + _0x2eca6a + '</div>'; } } let _0x700d65 = ''; if (_0xe07407[_0x49f9d8(0x8f2)] && _0xe07407[_0x49f9d8(0x8f2)][_0x49f9d8(0x36c)] > 0x0) { const _0x21e8e7 = _0xe07407[_0x49f9d8(0x8f2)][_0x49f9d8(0x946)](_0x7bf9f0 => { const _0x4df2be = _0x49f9d8, _0x15a57f = _0x8351ef(_0x7bf9f0[_0x4df2be(0x9b3)])?.[_0x4df2be(0x4da)] || '未知'; return _0x4df2be(0x1e9) + _0x15a57f + _0x4df2be(0x58c) + _0x7bf9f0[_0x4df2be(0x472)] + _0x4df2be(0x2be); })[_0x49f9d8(0x9cc)](''); _0x700d65 = _0x49f9d8(0x7ce) + _0x21e8e7 + '</div>'; } _0x26d63e = _0x49f9d8(0x1a5) + _0x244a67 + _0x49f9d8(0x2d5) + _0x700d65 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20'; } } const _0x4a3b10 = _0x49f9d8(0x214) + _0x31b267 + _0x542338 + _0x59e20e + _0x49f9d8(0x2be); _0x51d7da[_0x49f9d8(0x711)] = _0x3eff03 + _0x4a3b10 + _0x45ac1b + _0x26d63e; if (_0xe07407[_0x49f9d8(0x3b1)] === 'music' && _0xe07407[_0x49f9d8(0x36f)]) { const _0x3f3fcb = _0x51d7da['querySelector']('.music-post-song-card'); _0x3f3fcb && _0x3f3fcb[_0x49f9d8(0x203)](_0x49f9d8(0x783), function () { const _0xab22fe = _0x49f9d8; if (_0xab22fe(0x79b) === _0xab22fe(0x881)) { const _0x474724 = (_0x394338 - 0x5a) * _0x496661['PI'] / 0xb4; return { 'x': _0x4d2ed6 + _0x4ad5d9 * _0x303e12['cos'](_0x474724), 'y': _0x1bf763 + _0x33a213 * _0x59d931[_0xab22fe(0x38c)](_0x474724) }; } else { const _0x27ae9a = { 'id': _0xe07407['id'], 'url': _0xe07407['playableUrl'] }; _0x40fca5(this, _0x27ae9a); } }); } _0x232999[_0x49f9d8(0x3d5)](_0x51d7da); } else _0x2a0c8c[_0x49f9d8(0x711)] = _0x49f9d8(0x817), _0x29f702[_0x49f9d8(0x655)](_0x49f9d8(0x4bc))[_0x49f9d8(0x203)]('click', _0x5da748); }); } document[_0x43c7a1(0x655)]('clear-feed-button')[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x11e9f9), document[_0x43c7a1(0x655)](_0x43c7a1(0x7ab))[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x337f84), document['getElementById'](_0x43c7a1(0x463))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0xcf54be(_0x43c7a1(0x7e1), 'friendCircleList')), document['getElementById'](_0x43c7a1(0x34c))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0x347a65()), document[_0x43c7a1(0x655)]('back-to-circle-list-from-edit')[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0xcf54be(_0x43c7a1(0x64f), _0x43c7a1(0x684))), document[_0x43c7a1(0x655)]('save-friend-circle-button')[_0x43c7a1(0x203)]('click', _0x51d0e9), document[_0x43c7a1(0x655)](_0x43c7a1(0x1a4))[_0x43c7a1(0x203)]('click', _0x36027a), document[_0x43c7a1(0x655)](_0x43c7a1(0x92d))[_0x43c7a1(0x203)]('click', () => { const _0x49bf22 = _0x43c7a1; _0x128295(), _0xcf54be(_0x49bf22(0x64f), _0x49bf22(0x2b9)); }), document[_0x43c7a1(0x655)](_0x43c7a1(0x670))['addEventListener']('click', () => { const _0x570866 = _0x43c7a1; _0x128784['activeFriendCircleId'] && (_0x570866(0x86e) === _0x570866(0x86e) ? _0x347a65(_0x128784[_0x570866(0x462)]) : (_0x135e74 = _0x585f93[_0x570866(0x4e0)][0x0][_0x570866(0x55f)], _0x208765 = _0x283576[_0x570866(0x4e0)][0x0][_0x570866(0x904)], _0x311fc9 = !![], _0x133299 = '')); }), document['getElementById'](_0x43c7a1(0x1d5))['addEventListener'](_0x43c7a1(0x783), async () => { const _0x5e5426 = _0x43c7a1, _0x147ad8 = _0x128784['friendCircles'][_0x5e5426(0x787)](_0x1f5cdd => _0x1f5cdd['id'] === _0x128784[_0x5e5426(0x462)]); if (!_0x147ad8 || _0x128784[_0x5e5426(0x2d7)]) return; const _0x316bcd = _0x147ad8[_0x5e5426(0x4a0)], _0x4bbfbb = _0x128784['userProfiles'][_0x5e5426(0x787)](_0x39dd8d => _0x39dd8d['id'] === _0x316bcd); if (!_0x4bbfbb) { _0x420e01(_0x5e5426(0x353)); return; } const _0x25c07c = document['getElementById'](_0x5e5426(0x486))[_0x5e5426(0x9bf)][_0x5e5426(0x6df)](), _0x5edcaf = _0x128784[_0x5e5426(0x1ce)]['image'], _0x49a8f4 = _0x128784['pendingPostAttachments']['music'], _0x44d54e = _0x128784[_0x5e5426(0x1ce)][_0x5e5426(0x431)]; if (!_0x25c07c && !_0x5edcaf && !_0x49a8f4) { _0x420e01('总得说点什么吧？'); return; } const _0xadf892 = { 'id': 'post_user_' + Date[_0x5e5426(0x8a2)](), 'authorType': _0x5e5426(0x500), 'authorId': _0x4bbfbb['id'], 'content': _0x25c07c, 'timestamp': Date[_0x5e5426(0x8a2)](), 'likes': [], 'comments': [] }; if (_0x44d54e) { if ('HxzmD' === 'wIzRR') { const _0x2a9ef3 = _0x1a6b60(); if (_0x2a9ef3 && _0x2a9ef3['type'] === 'private') _0x1f07fe(_0x2a9ef3[_0x5e5426(0x4de)][0x0]); else _0x2a9ef3 && _0x2a9ef3[_0x5e5426(0x3b1)] === _0x5e5426(0x6a4) && _0x45b8bc(_0x2a9ef3['id']); } else _0xadf892[_0x5e5426(0x431)] = _0x44d54e; } else _0x5edcaf && (_0xadf892[_0x5e5426(0x911)] = _0x5edcaf); _0x49a8f4 ? (_0xadf892[_0x5e5426(0x3b1)] = 'music', Object['assign'](_0xadf892, _0x49a8f4)) : _0xadf892[_0x5e5426(0x3b1)] = _0x5e5426(0x64b), _0x147ad8['posts'][_0x5e5426(0x1e5)](_0xadf892), _0x5eb81f(), _0x474d50(), document[_0x5e5426(0x655)](_0x5e5426(0x486))['value'] = '', _0x128784[_0x5e5426(0x1ce)]['image'] = null, _0x128784['pendingPostAttachments'][_0x5e5426(0x2b9)] = null, _0x128784['pendingPostAttachments'][_0x5e5426(0x431)] = null, _0x257f1c(), _0x229ccf(_0xadf892); }), document[_0x43c7a1(0x655)](_0x43c7a1(0x840))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x3736d3 = _0x43c7a1; document[_0x3736d3(0x655)](_0x3736d3(0x7e6))[_0x3736d3(0x783)](); }), document[_0x43c7a1(0x655)](_0x43c7a1(0x7e6))[_0x43c7a1(0x203)](_0x43c7a1(0x272), async _0x361d01 => { const _0x503331 = _0x43c7a1, _0x159cc8 = _0x361d01[_0x503331(0x949)][_0x503331(0x275)][0x0]; if (!_0x159cc8) return; try { if (_0x503331(0x22c) !== 'RzAnc') { const _0x52c37a = await _0x588f02(_0x159cc8, 0x320, 0.8, !![]), _0x59d2cb = 'post_image_' + Date[_0x503331(0x8a2)](); await _0x36c0a8(_0x59d2cb, _0x52c37a), _0x128784[_0x503331(0x1ce)][_0x503331(0x431)] = _0x59d2cb, _0x128784['pendingPostAttachments'][_0x503331(0x911)] = null, _0x128784['pendingPostAttachments'][_0x503331(0x2b9)] = null, _0x257f1c(); } else _0x2b73f5[_0x503331(0x9de)](_0x503331(0x8ea), _0x105fc1); } catch (_0x4e2c33) { _0x420e01(_0x503331(0x94a) + _0x4e2c33[_0x503331(0x740)]); } _0x361d01[_0x503331(0x949)]['value'] = ''; }), document[_0x43c7a1(0x655)](_0x43c7a1(0x4f9))[_0x43c7a1(0x203)]('click', async () => { const _0x3a2a3b = _0x43c7a1; if ('IKHLi' !== _0x3a2a3b(0x433)) { const _0x16e4d5 = _0x25041e(_0x5e1923['getHours']())['padStart'](0x2, '0'), _0x2d5c9c = _0x2e5d18(_0x2772a6[_0x3a2a3b(0x746)]())[_0x3a2a3b(0x7d2)](0x2, '0'); _0x193a7f[_0x3a2a3b(0x68f)] = _0x16e4d5 + ':' + _0x2d5c9c; const _0x4c1fb4 = _0x5e27c0[_0x3a2a3b(0x909)]() + 0x1, _0x4cac41 = _0xea03e[_0x3a2a3b(0x731)](), _0x2ba446 = [_0x3a2a3b(0x2b7), '星期一', _0x3a2a3b(0x372), _0x3a2a3b(0x46b), '星期四', _0x3a2a3b(0x47b), _0x3a2a3b(0x6e0)][_0x4c3a22[_0x3a2a3b(0x4b5)]()]; _0x23838d['textContent'] = _0x4c1fb4 + '月' + _0x4cac41 + '日\x20' + _0x2ba446; } else { const _0x4355c0 = await _0x50a74a(); if (!_0x4355c0) return; _0x420e01(_0x3a2a3b(0x705)); try { const _0x395493 = await _0x20e996(_0x4355c0[_0x3a2a3b(0x1d2)], _0x4355c0[_0x3a2a3b(0x2aa)]); _0x128784['pendingPostAttachments'][_0x3a2a3b(0x2b9)] = { 'songName': _0x4355c0['songName'], 'artist': _0x4355c0[_0x3a2a3b(0x2aa)], 'coverUrl': _0x395493[_0x3a2a3b(0x678)], 'playableUrl': _0x395493[_0x3a2a3b(0x237)] }, _0x128784[_0x3a2a3b(0x1ce)]['image'] = null, _0x257f1c(); } catch (_0x4af73a) { _0x420e01(_0x3a2a3b(0x59e) + _0x4af73a[_0x3a2a3b(0x740)]); } } }); function _0x2e8da0() { const _0x2e9737 = _0x43c7a1; if ('rqffI' !== _0x2e9737(0x933)) { const _0x922808 = new Date(), _0x4479e4 = document[_0x2e9737(0x655)]('home-time'), _0x2bc31f = document[_0x2e9737(0x655)](_0x2e9737(0x562)); if (_0x4479e4 && _0x2bc31f) { if (_0x2e9737(0x6e1) !== _0x2e9737(0x6e1)) _0xc0ead6['linkedWorldBookIds'] = _0x5bb8dc[_0x2e9737(0x341)][_0x2e9737(0x89c)](_0x5b20ed => _0x5b20ed !== _0x12fe53); else { const _0x1eb240 = String(_0x922808[_0x2e9737(0x838)]())['padStart'](0x2, '0'), _0x110d4e = String(_0x922808[_0x2e9737(0x746)]())[_0x2e9737(0x7d2)](0x2, '0'); _0x4479e4[_0x2e9737(0x68f)] = _0x1eb240 + ':' + _0x110d4e; const _0x6770a3 = _0x922808[_0x2e9737(0x909)]() + 0x1, _0x13e3d4 = _0x922808['getDate'](), _0x4fb9d0 = [_0x2e9737(0x2b7), _0x2e9737(0x3b2), _0x2e9737(0x372), '星期三', '星期四', _0x2e9737(0x47b), _0x2e9737(0x6e0)][_0x922808[_0x2e9737(0x4b5)]()]; _0x2bc31f[_0x2e9737(0x68f)] = _0x6770a3 + '月' + _0x13e3d4 + '日\x20' + _0x4fb9d0; } } } else _0x48b9ad[_0x2e9737(0x4da)] = _0x11ed65, _0x161979[_0x2e9737(0x472)] = _0x3ded63; } function _0x461bab(_0x2c8ed4) { const _0x3a0ef5 = _0x43c7a1; if (_0x3a0ef5(0x260) === _0x3a0ef5(0x260)) { if (!_0x2c8ed4) return ''; const _0x4a5244 = new Date(_0x2c8ed4), _0x35930d = String(_0x4a5244[_0x3a0ef5(0x838)]())['padStart'](0x2, '0'), _0x43beb9 = String(_0x4a5244['getMinutes']())['padStart'](0x2, '0'); return _0x35930d + ':' + _0x43beb9; } else { _0x3a776e[_0x3a0ef5(0x9bf)] = ''; return; } } function _0x15bafc() { const _0x2531e4 = _0x43c7a1; if (_0x2531e4(0x31c) === _0x2531e4(0x31c)) { const _0x2fc60e = _0x128784['friendCircles'][_0x2531e4(0x787)](_0x4751f9 => _0x4751f9['id'] === _0x128784['activeFriendCircleId']), _0x352f28 = _0x2fc60e ? _0x2fc60e['posts'] : []; if (!_0x352f28 || _0x352f28[_0x2531e4(0x36c)] === 0x0) return ''; const _0x1606a8 = _0x352f28[_0x2531e4(0x6e3)](0x0, 0x5), _0x432de6 = _0x1606a8[_0x2531e4(0x946)](_0x3c4c94 => { const _0x5f42dd = _0x2531e4, _0x50f3fe = _0x8351ef(_0x3c4c94[_0x5f42dd(0x9b3)]) || { 'name': '未知' }; let _0x36d840 = _0x5f42dd(0x235) + _0x50f3fe[_0x5f42dd(0x4da)] + '\x20说：“' + (_0x3c4c94['thought'] || _0x3c4c94[_0x5f42dd(0x472)]) + '”'; if (_0x3c4c94[_0x5f42dd(0x3b1)] === 'music') { if (_0x5f42dd(0x35a) !== _0x5f42dd(0x35a)) { if (!_0x10fdf2) return ''; const _0x3d9e45 = new _0x18a583(_0x123703), _0x5b4f2b = _0x3b3171(_0x3d9e45[_0x5f42dd(0x838)]())[_0x5f42dd(0x7d2)](0x2, '0'), _0x2c3a91 = _0x37faf5(_0x3d9e45[_0x5f42dd(0x746)]())[_0x5f42dd(0x7d2)](0x2, '0'); return _0x5b4f2b + ':' + _0x2c3a91; } else _0x36d840 += _0x5f42dd(0x918) + _0x3c4c94['songName'] + _0x5f42dd(0x7a7) + _0x3c4c94[_0x5f42dd(0x2aa)] + ')'; } return _0x36d840; }); return _0x2531e4(0x36d) + _0x432de6[_0x2531e4(0x9cc)]('\x0a'); } else _0x53803e[_0x2531e4(0x657)] = { 'response_mime_type': _0x2531e4(0x1f6) }; } function _0x3de826(_0xa13457) { const _0x21902b = _0x43c7a1; if (_0x21902b(0x6f6) !== _0x21902b(0x6f6)) { const _0x42362c = _0x21902b(0x897); _0x4123ac[_0x21902b(0x307)][_0x21902b(0x3af)]('beforeend', _0x42362c); const _0x44b43d = _0x15cb85['getElementById']('diary-write-modal'), _0x2c1488 = _0x4bea1f[_0x21902b(0x655)](_0x21902b(0x7e4)), _0x4d4d07 = _0x3ddd68[_0x21902b(0x655)](_0x21902b(0x42c)), _0x139627 = _0x5767a6[_0x21902b(0x655)](_0x21902b(0x93c)), _0x89f154 = _0x44b43d['querySelector']('.choice-modal-backdrop'), _0x14adcc = () => { const _0x33d753 = _0x21902b; _0x44b43d[_0x33d753(0x66f)](), _0x533361(); }; _0x4d4d07['onclick'] = () => { const _0x47836b = _0x21902b; _0x1db95b(_0x2c1488[_0x47836b(0x9bf)]), _0x14adcc(); }, _0x139627['onclick'] = _0x14adcc, _0x89f154[_0x21902b(0x9c8)] = _0x14adcc; } else { const _0x2029a5 = _0x128784['userProfiles']['find'](_0x32be9d => _0x32be9d['id'] === _0x128784[_0x21902b(0x226)]) || { 'name': '你' }, _0x29d1e4 = _0x128784[_0x21902b(0x401)][_0x21902b(0x787)](_0x59612c => _0x59612c[_0x21902b(0x267)] === _0xa13457); if (!_0x29d1e4 || !_0x29d1e4[_0x21902b(0x8b0)] || _0x29d1e4[_0x21902b(0x8b0)][_0x21902b(0x36c)] === 0x0) return ''; const _0x4e995d = _0x29d1e4['entries'][_0x21902b(0x6e3)](-0x8), _0x5d522f = _0x4e995d[_0x21902b(0x946)](_0x5a054c => { const _0x23fb2e = _0x21902b, _0x5833b9 = _0x5a054c[_0x23fb2e(0x38a)] === _0x23fb2e(0x500) ? _0x2029a5[_0x23fb2e(0x4da)] : _0x8351ef(_0x5a054c[_0x23fb2e(0x38a)])[_0x23fb2e(0x4da)]; return '-\x20[' + new Date(_0x5a054c[_0x23fb2e(0x89b)])[_0x23fb2e(0x263)]() + ']\x20' + _0x5833b9 + '\x20写道:\x20' + _0x5a054c[_0x23fb2e(0x472)]; })[_0x21902b(0x9cc)]('\x0a'); return _0x21902b(0x994) + _0x2029a5['name'] + _0x21902b(0x388) + _0x5d522f; } } function _0x4ed7f8() { const _0x3aec94 = _0x43c7a1, _0x4da042 = document['getElementById']('music-widget-card'), _0x35212b = _0x128784[_0x3aec94(0x430)][_0x3aec94(0x1bc)]; _0x35212b ? (_0x4da042[_0x3aec94(0x385)][_0x3aec94(0x2ca)] = _0x3aec94(0x21b) + _0x35212b + ')', _0x4da042['style'][_0x3aec94(0x6ed)] = 'cover', _0x4da042['style'][_0x3aec94(0x543)] = _0x3aec94(0x4cf), _0x4da042[_0x3aec94(0x385)][_0x3aec94(0x1cf)] = 'white', _0x4da042[_0x3aec94(0x49d)](_0x3aec94(0x9b6))[_0x3aec94(0x4d0)](_0x279062 => { const _0x236ec6 = _0x3aec94; _0x279062[_0x236ec6(0x385)][_0x236ec6(0x772)] = '0\x201px\x203px\x20rgba(0,0,0,0.6)'; })) : (_0x4da042[_0x3aec94(0x385)][_0x3aec94(0x2ca)] = '', _0x4da042[_0x3aec94(0x385)]['color'] = '', _0x4da042[_0x3aec94(0x49d)](_0x3aec94(0x9b6))[_0x3aec94(0x4d0)](_0x3ee067 => { const _0x35cacd = _0x3aec94; _0x3ee067[_0x35cacd(0x385)][_0x35cacd(0x772)] = ''; })); } const _0x358945 = document[_0x43c7a1(0x655)](_0x43c7a1(0x2ae)), _0x41f49f = document[_0x43c7a1(0x655)](_0x43c7a1(0x290)); _0x358945[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x34d41c = _0x43c7a1; _0x128295(), _0xcf54be(_0x34d41c(0x64f), _0x34d41c(0x7e1)); }), _0x41f49f['addEventListener']('click', () => { const _0x8a1a09 = _0x43c7a1; _0x353bb5(), _0xcf54be(_0x8a1a09(0x396), 'home'); }), document[_0x43c7a1(0x655)](_0x43c7a1(0x3b8))[_0x43c7a1(0x203)]('click', () => { const _0x27c626 = _0x43c7a1; _0xcf54be('home', _0x27c626(0x396)); }), document['getElementById'](_0x43c7a1(0x5fa))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x29a9f8 = _0x43c7a1; if (_0x378245) clearInterval(_0x378245); _0x378245 = null, _0x128784[_0x29a9f8(0x5df)] = [], _0x128784[_0x29a9f8(0x50e)] = null, document[_0x29a9f8(0x655)]('galgame-sprite-adjust-ui')[_0x29a9f8(0x385)]['display'] = 'none', _0x128784[_0x29a9f8(0x789)] = null, _0x5eb81f(), _0xcf54be(_0x29a9f8(0x396), 'meetingView'); }); const _0x3df305 = document[_0x43c7a1(0x655)]('meeting-message-input'), _0x3ed3f3 = document[_0x43c7a1(0x655)](_0x43c7a1(0x79a)); _0x3ed3f3['addEventListener']('click', () => { const _0x227adb = _0x43c7a1; if ('lxbdu' === 'vYxtm') _0x7efae(![]), _0x21b669[_0x227adb(0x9de)](_0x227adb(0x7a2), _0x2597c3), _0x33d2a4('导出过程中发生严重错误:\x20' + _0x308e21[_0x227adb(0x740)]); else { const _0x2e59ce = _0x3df305[_0x227adb(0x9bf)]['trim'](); _0x2e59ce && (_0x3948ce(_0x2e59ce), _0x3df305[_0x227adb(0x9bf)] = '', setTimeout(_0xf949f2, 0x64)); } }); function _0x40fca5(_0xa7668b, _0x152207) { const _0x5ad439 = _0x43c7a1, _0x16b4e6 = document[_0x5ad439(0x655)]('audio-player'), _0x2b174e = document[_0x5ad439(0x49d)](_0x5ad439(0x61a)); _0x2b174e[_0x5ad439(0x4d0)](_0x2fadd7 => { const _0x51c107 = _0x5ad439; 'NHExo' === _0x51c107(0x1c4) ? _0x2fadd7 !== _0xa7668b[_0x51c107(0x9ad)](_0x51c107(0x61a)) && (_0x2fadd7[_0x51c107(0x68f)] = '▶') : _0x417619[_0x51c107(0x3b1)] = _0x51c107(0x64b); }), _0x16b4e6[_0x5ad439(0x84a)] === _0x152207[_0x5ad439(0x237)] && !_0x16b4e6[_0x5ad439(0x7be)] ? 'HgKgn' === 'HgKgn' ? (_0x16b4e6[_0x5ad439(0x753)](), _0xa7668b[_0x5ad439(0x9ad)](_0x5ad439(0x61a))[_0x5ad439(0x68f)] = '▶') : _0x583dff[_0x5ad439(0x421)]['remove'](_0x5ad439(0x8d5)) : (_0x16b4e6[_0x5ad439(0x84a)] = _0x152207[_0x5ad439(0x237)], _0x16b4e6[_0x5ad439(0x244)](), _0xa7668b['querySelector'](_0x5ad439(0x61a))[_0x5ad439(0x68f)] = '❚❚'); } const _0x19ca09 = document[_0x43c7a1(0x655)](_0x43c7a1(0x2dd)); async function _0x4c0fcc(_0x4981e7) { const _0x3fe0be = _0x43c7a1; if (!_0x4981e7 || !_0x4981e7[_0x3fe0be(0x3fd)](_0x3fe0be(0x60d))) return ![]; return new Promise(_0x301e81 => { const _0x4c3ae5 = _0x3fe0be, _0x34355f = document['createElement'](_0x4c3ae5(0x2f0)); _0x34355f[_0x4c3ae5(0x84a)] = _0x4981e7; const _0x4fbfb4 = setTimeout(() => { _0xba6eaf(), _0x301e81(![]); }, 0xbb8), _0xba6eaf = () => { const _0xe54775 = _0x4c3ae5; clearTimeout(_0x4fbfb4), _0x34355f[_0xe54775(0x6bf)](_0xe54775(0x58d), _0x521c24), _0x34355f['removeEventListener'](_0xe54775(0x9de), _0x1f4a19), _0x34355f[_0xe54775(0x84a)] = '', _0x34355f[_0xe54775(0x66f)](); }, _0x521c24 = () => { _0xba6eaf(), _0x301e81(!![]); }, _0x1f4a19 = () => { _0xba6eaf(), _0x301e81(![]); }; _0x34355f[_0x4c3ae5(0x203)](_0x4c3ae5(0x58d), _0x521c24), _0x34355f['addEventListener'](_0x4c3ae5(0x9de), _0x1f4a19); }); } async function _0x20e996(_0xe8682d, _0x477586) { const _0x3d8bee = _0x43c7a1; if (_0x3d8bee(0x8f9) !== _0x3d8bee(0x8f9)) try { _0x4fc64f[_0x3d8bee(0x548)](_0x3d8bee(0x5f1), _0x58ac46[_0x3d8bee(0x5e0)]({ 'playlist': _0x20567a['musicPlaylist'], 'currentIndex': _0xfeb55e[_0x3d8bee(0x90a)] })); } catch (_0x1647b1) { _0x3a7161[_0x3d8bee(0x9de)](_0x3d8bee(0x425), _0x1647b1); } else { const _0x25ac3b = ['netease', _0x3d8bee(0x386)]; for (const _0x5a2ee3 of _0x25ac3b) { if (_0x3d8bee(0x253) === 'qFkQb') try { const _0x1e2962 = 'https://api.vkeys.cn/v2/music/' + _0x5a2ee3 + _0x3d8bee(0x6a1) + encodeURIComponent(_0xe8682d) + '-' + encodeURIComponent(_0x477586), _0xa2bb92 = await fetch(_0x1e2962), _0x3fefc6 = await _0xa2bb92[_0x3d8bee(0x84d)](); if (_0x3fefc6[_0x3d8bee(0x70e)] !== 0xc8 || !_0x3fefc6[_0x3d8bee(0x242)] || _0x3fefc6[_0x3d8bee(0x242)]['length'] === 0x0) continue; const _0x71dcb3 = _0x3fefc6['data'][_0x3d8bee(0x6e3)](0x0, 0x5); for (const _0x10e55b of _0x71dcb3) { const _0xd49a05 = _0x3d8bee(0x4e6) + _0x5a2ee3 + _0x3d8bee(0x6be) + _0x10e55b['id'], _0x285795 = await fetch(_0xd49a05), _0x270877 = await _0x285795[_0x3d8bee(0x84d)](), _0x374b92 = _0x270877[_0x3d8bee(0x242)]?.[_0x3d8bee(0x237)]; if (await _0x4c0fcc(_0x374b92)) { if (_0x3d8bee(0x6d1) === _0x3d8bee(0x6d1)) return { 'url': _0x374b92, 'cover': _0x10e55b['cover'], 'source': _0x5a2ee3 }; else { const _0x36aaa1 = _0x5c7ef5(_0x40ca39[_0x3d8bee(0x50e)]); _0x36aaa1 && (_0x36aaa1[_0x3d8bee(0x830)] = _0x12828a, _0x2dbdad(_0x33fc93[_0x3d8bee(0x50e)], _0x3d8bee(0x850))); } } } } catch (_0x5765cb) { _0x3d8bee(0x964) !== _0x3d8bee(0x9da) ? console['error'](_0x3d8bee(0x9db) + _0x5a2ee3 + ':', _0x5765cb) : _0x218839[_0x3d8bee(0x7be)] ? _0x6dc6bd[_0x3d8bee(0x244)]() : _0x5b5d8a[_0x3d8bee(0x753)](); } else try { const _0x4db80c = _0x41e907[_0x3d8bee(0x7a8)](_0x31ab0c['getItem'](_0x3d8bee(0x55e)) || '{}'), _0x542f80 = { ..._0x4db80c, ..._0xca7cf7 }; _0x2d9142['setItem'](_0x3d8bee(0x55e), _0x15d206[_0x3d8bee(0x5e0)](_0x542f80)); } catch (_0x5cc4f3) { _0xb741e4[_0x3d8bee(0x9de)](_0x3d8bee(0x83a), _0x5cc4f3); } } return { 'url': null, 'cover': null, 'source': null }; } } function _0x497df2(_0x309d71) { const _0x1a6788 = _0x43c7a1; try { if (_0x1a6788(0x390) === _0x1a6788(0x4c7)) _0x38efcc[_0x1a6788(0x385)][_0x1a6788(0x772)] = _0x1a6788(0x6aa); else { const _0x12ae6e = JSON[_0x1a6788(0x7a8)](localStorage[_0x1a6788(0x2c6)](_0x1a6788(0x584)) || '{}'), _0x51ac67 = { ..._0x12ae6e, ..._0x309d71 }; localStorage[_0x1a6788(0x548)](_0x1a6788(0x584), JSON[_0x1a6788(0x5e0)](_0x51ac67)); } } catch (_0x4a86bf) { console[_0x1a6788(0x9de)]('保存徽章状态失败', _0x4a86bf); } } async function _0x162197() { const _0xf547e1 = _0x43c7a1, _0x455fb5 = document[_0xf547e1(0x655)](_0xf547e1(0x96b)), _0x461b8 = document[_0xf547e1(0x655)]('badge-image'); try { let _0x14fe40 = await _0x226e0a('widget_badge'); if (!_0x14fe40) { if ('RnYLJ' === _0xf547e1(0x8d1)) { const _0x2ff69f = JSON['parse'](localStorage[_0xf547e1(0x2c6)](_0xf547e1(0x584)) || '{}'); _0x2ff69f[_0xf547e1(0x911)] && (console['log']('正在搬运旧徽章...'), _0x14fe40 = await _0x454232(_0x2ff69f[_0xf547e1(0x911)]), await _0x36c0a8(_0xf547e1(0x8b5), _0x14fe40)); } else _0x1df8cd['style'][_0xf547e1(0x1cd)] = _0xf547e1(0x44e); } _0x14fe40 ? (_0x461b8[_0xf547e1(0x84a)] = URL[_0xf547e1(0x9be)](_0x14fe40), _0x455fb5[_0xf547e1(0x385)][_0xf547e1(0x1cd)] = _0xf547e1(0x3d3)) : _0x455fb5[_0xf547e1(0x385)][_0xf547e1(0x1cd)] = _0xf547e1(0x3d3); } catch (_0x3a9d6c) { console[_0xf547e1(0x9de)](_0xf547e1(0x3fe), _0x3a9d6c); } } function _0x4c9a20(_0x497502) { const _0xca79a = _0x43c7a1; try { const _0x38cc7a = JSON[_0xca79a(0x7a8)](localStorage[_0xca79a(0x2c6)](_0xca79a(0x55e)) || '{}'), _0x217add = { ..._0x38cc7a, ..._0x497502 }; localStorage[_0xca79a(0x548)](_0xca79a(0x55e), JSON[_0xca79a(0x5e0)](_0x217add)); } catch (_0x2503a3) { console[_0xca79a(0x9de)]('保存卡片状态失败', _0x2503a3); } } async function _0x1efd00() { const _0x3b67f2 = _0x43c7a1, _0x110f32 = document['getElementById'](_0x3b67f2(0x280)), _0x3e2014 = document[_0x3b67f2(0x655)](_0x3b67f2(0x32a)); try { if (_0x3b67f2(0x732) === _0x3b67f2(0x999)) { const _0x3738e1 = _0x441d25(); if (_0x3738e1[_0x3b67f2(0x3b1)] === _0x3b67f2(0x6a4)) { const _0x50cd79 = _0x553d8b[_0x3b67f2(0x277)][_0x3b67f2(0x787)](_0x424646 => _0x3738e1[_0x3b67f2(0x4de)][_0x3b67f2(0x9ac)](_0x424646['id']) && _0x424646[_0x3b67f2(0x4da)] === _0x1a643a); if (_0x50cd79) _0x2381ae = _0x50cd79['id']; } } else { let _0xb2ca57 = await _0x226e0a(_0x3b67f2(0x6a5)); if (!_0xb2ca57) { const _0x5036db = JSON[_0x3b67f2(0x7a8)](localStorage['getItem'](_0x3b67f2(0x55e)) || '{}'); _0x5036db['image'] && (_0x3b67f2(0x826) !== _0x3b67f2(0x7b4) ? (console['log'](_0x3b67f2(0x849)), _0xb2ca57 = await _0x454232(_0x5036db[_0x3b67f2(0x911)]), await _0x36c0a8('widget_card', _0xb2ca57)) : (_0x1a1cf5[_0x3b67f2(0x421)]['add'](_0x3b67f2(0x576)), _0x5ad840[_0x3b67f2(0x478)]({ 'behavior': _0x3b67f2(0x83b), 'block': 'center' }))); } if (_0xb2ca57) _0x3e2014[_0x3b67f2(0x84a)] = URL[_0x3b67f2(0x9be)](_0xb2ca57), _0x110f32[_0x3b67f2(0x385)][_0x3b67f2(0x1cd)] = _0x3b67f2(0x3d3); else { if (_0x3b67f2(0x7bb) === _0x3b67f2(0x7bb)) _0x110f32['style']['display'] = _0x3b67f2(0x3d3); else { const { omniText: _0x22770a } = _0x17f43a(_0x15c861['id'], null), _0x410ecb = _0x5dff5f(_0x5cbc76['id']), _0x1dc33d = _0x48b821[_0x3b67f2(0x341)] && _0x27ebc9[_0x3b67f2(0x341)][_0x3b67f2(0x36c)] > 0x0 ? _0x3b67f2(0x769) + _0x33c8f8[_0x3b67f2(0x4da)] + '的个人专属世界观设定\x0a' + _0x1b4b3d[_0x3b67f2(0x341)][_0x3b67f2(0x946)](_0x4e327d => _0x15b937[_0x3b67f2(0x188)][_0x3b67f2(0x787)](_0x44cf92 => _0x44cf92['id'] === _0x4e327d))[_0x3b67f2(0x89c)](_0x54a3cd)[_0x3b67f2(0x946)](_0x4c0797 => _0x3b67f2(0x6e2) + _0x4c0797['name'] + '\x0a' + _0x4c0797['content'])[_0x3b67f2(0x9cc)]('') : ''; return _0x3b67f2(0x538) + _0x341ccb['name'] + _0x3b67f2(0x534) + _0x58d0db['id'] + _0x3b67f2(0x46e) + _0x20e1a0[_0x3b67f2(0x489)] + _0x3b67f2(0x660) + _0x22770a + '\x0a' + _0x410ecb + '\x0a' + _0x1dc33d; } } } } catch (_0x48f90e) { console[_0x3b67f2(0x9de)](_0x3b67f2(0x8ea), _0x48f90e); } try { let _0x44fb1f = await _0x226e0a(_0x3b67f2(0x4d6)); const _0x725bbe = document[_0x3b67f2(0x655)]('card-image-2'), _0x1d4af0 = document[_0x3b67f2(0x655)]('card-widget-2'); _0x44fb1f ? (_0x725bbe[_0x3b67f2(0x84a)] = URL[_0x3b67f2(0x9be)](_0x44fb1f), _0x1d4af0[_0x3b67f2(0x385)]['display'] = _0x3b67f2(0x3d3)) : _0x3b67f2(0x424) === _0x3b67f2(0x843) ? (_0x219401(), _0x5cd5f8(_0x3b67f2(0x4e2), _0x3b67f2(0x7e1))) : _0x1d4af0[_0x3b67f2(0x385)][_0x3b67f2(0x1cd)] = _0x3b67f2(0x44e); } catch (_0x4bbcee) { console[_0x3b67f2(0x9de)]('加载第二个卡片图片失败', _0x4bbcee); } } _0x4baabd['addEventListener'](_0x43c7a1(0x783), () => { const _0x40ad42 = _0x43c7a1; _0x289448(), _0xcf54be('userProfileList', _0x40ad42(0x7e1)); }), document[_0x43c7a1(0x655)](_0x43c7a1(0x8ee))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0xcf54be('home', _0x43c7a1(0x8a3))), document['getElementById'](_0x43c7a1(0x779))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0x1c6083()), document[_0x43c7a1(0x655)]('back-to-user-list-from-edit')[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x349852 = _0x43c7a1; _0x289448(), _0xcf54be(_0x349852(0x8a3), _0x349852(0x50a)); }), document[_0x43c7a1(0x655)](_0x43c7a1(0x80d))[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x4f3052), document[_0x43c7a1(0x655)]('delete-user-profile-button')['addEventListener']('click', _0x172255), document[_0x43c7a1(0x655)](_0x43c7a1(0x767))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x4dc11e = _0x43c7a1, _0x4fe835 = document[_0x4dc11e(0x655)]('editing-user-id')[_0x4dc11e(0x9bf)]; _0x4fe835 && (_0x128784[_0x4dc11e(0x226)] = _0x4fe835, _0x5eb81f(), _0x420e01(_0x4dc11e(0x7cf)), _0x289448(), document['getElementById']('set-active-user-button')[_0x4dc11e(0x385)]['display'] = 'none'); }); function _0x10af56(_0x34cbff) { const _0xfa6e43 = _0x43c7a1, _0x33e9f9 = _0x128784['chats']['find'](_0x58d02a => _0x58d02a['id'] === _0x34cbff), _0x436aaa = _0x33e9f9?.[_0xfa6e43(0x4a0)]; let _0x41ed7e = _0x128784['userProfiles'][_0xfa6e43(0x787)](_0x1579a4 => _0x1579a4['id'] === _0x436aaa); if (!_0x41ed7e) { if (_0xfa6e43(0x737) !== _0xfa6e43(0x737)) { const _0x261573 = _0xc57717(_0xef1062), _0x3e0176 = _0x56fcf6[_0xfa6e43(0x655)](_0xfa6e43(0x39e)); _0x3e0176['style'][_0xfa6e43(0x2ca)] = ''; let _0x4adb86 = _0x56cea4[_0xfa6e43(0x655)](_0xfa6e43(0x69e) + _0x56021b); if (_0x4adb86) _0x4adb86['innerHTML'] = ''; if (!_0x261573) return; _0x261573[_0xfa6e43(0x1ff)] && (_0x3e0176[_0xfa6e43(0x385)][_0xfa6e43(0x2ca)] = _0xfa6e43(0x5cf) + _0x261573[_0xfa6e43(0x1ff)] + '\x27)', _0x3e0176[_0xfa6e43(0x385)][_0xfa6e43(0x6ed)] = 'cover', _0x3e0176['style']['backgroundPosition'] = _0xfa6e43(0x4cf)); if (_0x261573[_0xfa6e43(0x7c3)]) { let _0x19fe67 = _0x5d1f3a[_0xfa6e43(0x655)](_0xfa6e43(0x69e) + _0x261573['id']); !_0x19fe67 && (_0x19fe67 = _0x48bc31['createElement'](_0xfa6e43(0x385)), _0x19fe67['id'] = _0xfa6e43(0x69e) + _0x261573['id'], _0x47464b[_0xfa6e43(0x3f9)]['appendChild'](_0x19fe67)); const _0x13426c = _0x261573[_0xfa6e43(0x7c3)], _0x3da144 = _0x13426c[_0xfa6e43(0x55b)](/\.bubble\.sent/g, '.bubble-' + _0x261573['id'] + _0xfa6e43(0x471))[_0xfa6e43(0x55b)](/\.bubble\.received/g, _0xfa6e43(0x990) + _0x261573['id'] + _0xfa6e43(0x8f4)); _0x19fe67[_0xfa6e43(0x711)] = _0x3da144; } } else _0x41ed7e = _0x128784[_0xfa6e43(0x4a5)][_0xfa6e43(0x787)](_0x1d2c01 => _0x1d2c01['id'] === _0x128784[_0xfa6e43(0x226)]) || _0x128784[_0xfa6e43(0x4a5)][0x0]; } return _0x41ed7e || { 'name': '用户', 'avatar': _0x473193, 'persona': '' }; } function _0x44a098(_0x1fa55f) { const _0x5f10d0 = _0x43c7a1, _0x421cbf = document[_0x5f10d0(0x655)](_0x1fa55f); _0x421cbf['innerHTML'] = '', _0x128784[_0x5f10d0(0x4a5)][_0x5f10d0(0x4d0)](_0x83ecb2 => { const _0x5003df = _0x5f10d0, _0x5be909 = document[_0x5003df(0x26b)](_0x5003df(0x41c)); _0x5be909['value'] = _0x83ecb2['id'], _0x5be909[_0x5003df(0x68f)] = _0x83ecb2[_0x5003df(0x4da)], _0x421cbf[_0x5003df(0x3d5)](_0x5be909); }); } function _0x5dc056(_0x23db2d) { const _0x304470 = _0x43c7a1; if ('bQYhn' !== _0x304470(0x37b)) _0x446521(_0x3ab350[_0x304470(0x884)])[_0x304470(0x745)](_0x4386ee => { const _0x556291 = _0x304470, _0x2cfe25 = _0x70e271[_0x556291(0x655)](_0x34b291); if (_0x2cfe25 && _0x4386ee) _0x2cfe25[_0x556291(0x84a)] = _0x4b4fba[_0x556291(0x9be)](_0x4386ee); }); else { const _0x68b174 = _0x8351ef(_0x23db2d), _0x146f5b = document[_0x304470(0x655)](_0x304470(0x39e)); _0x146f5b['style'][_0x304470(0x2ca)] = ''; let _0x43d077 = document[_0x304470(0x655)](_0x304470(0x69e) + _0x23db2d); if (_0x43d077) _0x43d077[_0x304470(0x711)] = ''; if (!_0x68b174) return; if (_0x68b174['chatWallpaper']) { if ('xAwxG' === _0x304470(0x9b5)) _0x146f5b[_0x304470(0x385)]['backgroundImage'] = _0x304470(0x5cf) + _0x68b174[_0x304470(0x1ff)] + '\x27)', _0x146f5b[_0x304470(0x385)]['backgroundSize'] = _0x304470(0x678), _0x146f5b[_0x304470(0x385)][_0x304470(0x543)] = _0x304470(0x4cf); else { const _0x21d75d = _0x45b2dc[_0x304470(0x7c7)](/:\s|：\s/); if (_0x21d75d[_0x304470(0x36c)] === 0x2) { const _0x57d983 = _0x21d75d[0x0][_0x304470(0x6df)](), _0x475fd8 = _0x21d75d[0x1][_0x304470(0x6df)](), _0x5f3b6a = { '歌名': '歌曲名称', '艺术家': '歌手', '专辑': '专辑' }; _0x5f3b6a[_0x57d983] && (_0x3fe539[_0x5f3b6a[_0x57d983]] = _0x475fd8); } } } if (_0x68b174[_0x304470(0x7c3)]) { let _0x5394cf = document[_0x304470(0x655)](_0x304470(0x69e) + _0x68b174['id']); !_0x5394cf && (_0x5394cf = document[_0x304470(0x26b)](_0x304470(0x385)), _0x5394cf['id'] = 'style-' + _0x68b174['id'], document['head']['appendChild'](_0x5394cf)); const _0x2cad85 = _0x68b174['bubbleCss'], _0x1155ea = _0x2cad85['replace'](/\.bubble\.sent/g, _0x304470(0x990) + _0x68b174['id'] + _0x304470(0x471))[_0x304470(0x55b)](/\.bubble\.received/g, _0x304470(0x990) + _0x68b174['id'] + _0x304470(0x8f4)); _0x5394cf[_0x304470(0x711)] = _0x1155ea; } } } function _0x257f1c() { const _0x5a157e = _0x43c7a1; if (_0x5a157e(0x2c5) !== 'DMCOt') { const _0x530d17 = document['getElementById'](_0x5a157e(0x18a)); _0x530d17['innerHTML'] = ''; const _0x43766e = _0x4482e6 => { const _0x239994 = _0x5a157e; _0x128784['pendingPostAttachments'][_0x4482e6] = null; if (_0x4482e6 === 'image') _0x128784[_0x239994(0x1ce)][_0x239994(0x431)] = null; _0x257f1c(); }, _0x470d9c = _0x128784[_0x5a157e(0x1ce)][_0x5a157e(0x431)], _0x248e90 = _0x128784[_0x5a157e(0x1ce)]['music']; if (_0x470d9c) { const _0xd313ac = document['createElement'](_0x5a157e(0x76e)); _0xd313ac['className'] = _0x5a157e(0x4ad), _0xd313ac[_0x5a157e(0x711)] = _0x5a157e(0x4f5), _0xd313ac['querySelector'](_0x5a157e(0x7a0))[_0x5a157e(0x9c8)] = () => _0x43766e(_0x5a157e(0x911)), _0x530d17[_0x5a157e(0x3d5)](_0xd313ac), _0x226e0a(_0x470d9c)[_0x5a157e(0x745)](_0x5b2f93 => { const _0x33dfad = _0x5a157e; if (_0x33dfad(0x7e5) !== _0x33dfad(0x7e5)) _0x3f09fa['classList'][_0x33dfad(0x66f)](_0x33dfad(0x576)), _0xed4f41[_0x33dfad(0x421)][_0x33dfad(0x266)](_0x33dfad(0x576)), _0x4f5f10(); else { const _0x3d3495 = document[_0x33dfad(0x655)](_0x33dfad(0x181)); _0x3d3495 && _0x5b2f93 && (_0x3d3495['src'] = URL['createObjectURL'](_0x5b2f93)); } }); } if (_0x248e90) { const _0x2c9b4f = document[_0x5a157e(0x26b)](_0x5a157e(0x76e)); _0x2c9b4f[_0x5a157e(0x1f0)] = _0x5a157e(0x4ad), _0x2c9b4f[_0x5a157e(0x711)] = _0x5a157e(0x832) + (_0x248e90[_0x5a157e(0x912)] || _0x3834ec) + _0x5a157e(0x570) + _0x248e90[_0x5a157e(0x1d2)] + _0x5a157e(0x47e) + _0x248e90[_0x5a157e(0x2aa)] + _0x5a157e(0x87a), _0x2c9b4f['querySelector'](_0x5a157e(0x7a0))[_0x5a157e(0x9c8)] = () => _0x43766e(_0x5a157e(0x2b9)), _0x530d17[_0x5a157e(0x3d5)](_0x2c9b4f); } } else { const _0x14f066 = _0x50e516[_0x5a157e(0x4e0)][0x0]['clientX'] - _0x3a7d98, _0x16ed8b = _0x280853[_0x5a157e(0x4e0)][0x0][_0x5a157e(0x904)] - _0x525ec8; _0x3f56e3['abs'](_0x14f066) > _0xf09a['abs'](_0x16ed8b) ? _0x34a84f = _0x5a157e(0x970) : _0x33ff6f = _0x5a157e(0x801); } } async function _0x229ccf(_0x51c3ee) { const _0x36d656 = _0x43c7a1, _0x15869b = _0x128784['friendCircles']['find'](_0x132896 => _0x132896['id'] === _0x128784[_0x36d656(0x462)]); if (!_0x15869b) return; _0xddfd1b(!![], '大家正在赶来回复...'), _0x128784['isGenerating'] = !![]; try { const _0x52244c = _0x15869b['memberCharacterIds'][_0x36d656(0x946)](_0x52d29e => _0x8351ef(_0x52d29e))[_0x36d656(0x89c)](Boolean), _0x54b843 = _0x15bafc(), _0x5f4f9f = _0x52244c['map'](_0x48ec81 => { const _0x4a5de1 = _0x36d656; if (_0x4a5de1(0x945) !== _0x4a5de1(0x683)) { const { omniText: _0x586a87 } = _0x407b35(_0x48ec81['id'], null), _0x245119 = _0x3de826(_0x48ec81['id']), _0x26f030 = _0x48ec81[_0x4a5de1(0x341)] && _0x48ec81[_0x4a5de1(0x341)][_0x4a5de1(0x36c)] > 0x0 ? _0x4a5de1(0x769) + _0x48ec81[_0x4a5de1(0x4da)] + _0x4a5de1(0x9b4) + _0x48ec81['linkedWorldBookIds'][_0x4a5de1(0x946)](_0x161c10 => _0x128784[_0x4a5de1(0x188)][_0x4a5de1(0x787)](_0x296f7d => _0x296f7d['id'] === _0x161c10))[_0x4a5de1(0x89c)](Boolean)['map'](_0x565368 => _0x4a5de1(0x6e2) + _0x565368[_0x4a5de1(0x4da)] + '\x0a' + _0x565368['content'])[_0x4a5de1(0x9cc)]('') : ''; return _0x4a5de1(0x538) + _0x48ec81[_0x4a5de1(0x4da)] + _0x4a5de1(0x534) + _0x48ec81['id'] + '\x0a\x20\x20人设:\x20' + _0x48ec81[_0x4a5de1(0x489)] + _0x4a5de1(0x17f) + _0x586a87 + '\x0a' + _0x245119 + '\x0a' + _0x26f030; } else _0x5badc0[_0x4a5de1(0x9de)]('群聊音乐搜索失败\x20(' + _0x2a9048 + _0x4a5de1(0x7a7) + _0x2357e1 + '):', _0x2a4ba8), _0x40a050[_0x4a5de1(0x912)] = null, _0x391c45[_0x4a5de1(0x36f)] = null; })['join']('\x0a\x0a'), _0x2db8b1 = _0x545cf7(_0x51c3ee[_0x36d656(0x9b3)]) || { 'name': '用户' }, _0x10262c = _0x2db8b1['persona'] ? '\x0a#\x20发布动态的用户信息\x0a-\x20姓名:\x20' + _0x2db8b1[_0x36d656(0x4da)] + _0x36d656(0x407) + _0x2db8b1['persona'] + '\x0a' : ''; let _0x535904 = null; if (_0x51c3ee[_0x36d656(0x911)]) { if (_0x36d656(0x259) === _0x36d656(0x259)) _0x535904 = _0x51c3ee['image']; else { const _0x3fb695 = _0x53cc71['querySelector']('#member-select-' + _0x2485f2); if (_0x3fb695) _0x3fb695[_0x36d656(0x30c)] = !![]; } } else { if (_0x51c3ee[_0x36d656(0x431)]) try { const _0x2a3e13 = await _0x226e0a(_0x51c3ee[_0x36d656(0x431)]); _0x2a3e13 && (_0x36d656(0x6d3) === _0x36d656(0x6f7) ? (_0x12b7c3[_0x36d656(0x5c5)](_0x36d656(0x25f) + _0x2a2958['id']), _0x5e6335(_0x36d656(0x5e7) + _0x101368['name'] + _0x36d656(0x8d3))) : _0x535904 = await _0x171ffd(_0x2a3e13)); } catch (_0x5a3321) { console['error'](_0x36d656(0x521), _0x5a3321); } } let _0x1ea99a = _0x2db8b1[_0x36d656(0x4da)] + _0x36d656(0x44c) + _0x51c3ee[_0x36d656(0x472)] + '”'; _0x535904 && (_0x36d656(0x2d3) === _0x36d656(0x398) ? (_0x1db9e9[_0x36d656(0x3d5)](_0x302a1f), _0x216290[_0x36d656(0x3d5)](_0x21efc4)) : _0x1ea99a += _0x36d656(0x461)); _0x51c3ee[_0x36d656(0x3b1)] === _0x36d656(0x2b9) && (_0x1ea99a += '\x20[并分享了歌曲:\x20' + _0x51c3ee[_0x36d656(0x1d2)] + _0x36d656(0x7a7) + _0x51c3ee[_0x36d656(0x2aa)] + ']'); const _0x4691df = _0x36d656(0x5f6) + _0x5f4f9f + '\x0a\x0a' + _0x10262c + _0x36d656(0x5a1) + _0x54b843 + _0x36d656(0x7d3) + _0x1ea99a + _0x36d656(0x200), _0x1e6b74 = [{ 'role': 'system', 'content': _0x4691df }], _0x4c0d66 = { 'role': _0x36d656(0x500), 'content': '请根据以上所有规则（特别是要看图！），生成对用户动态的回应。' }; if (_0x535904) { if (_0x36d656(0x457) !== _0x36d656(0x357)) _0x4c0d66['image'] = _0x535904; else { const _0x5261ae = _0x5cca90[_0x36d656(0x341)]?.[_0x36d656(0x9ac)](_0x198337['id']), _0x430876 = _0x1b9325['createElement']('label'); _0x430876[_0x36d656(0x711)] = _0x36d656(0x202) + _0x41f014['id'] + '\x22\x20' + (_0x5261ae ? 'checked' : '') + '>\x20' + _0x5bbcd9['name'], _0x525f88['appendChild'](_0x430876); } } _0x1e6b74[_0x36d656(0x1e5)](_0x4c0d66); const _0x2fc39d = await _0x2e6580(_0x1e6b74, { 'json': !![] }), _0x169d6c = _0x2fc39d[_0x36d656(0x256)](/({[\s\S]*})/); if (!_0x169d6c) throw new Error(_0x36d656(0x308)); const _0x2e060a = JSON[_0x36d656(0x7a8)](_0x169d6c[0x1]), _0xbe2477 = _0x15869b[_0x36d656(0x1e2)]['find'](_0x556375 => _0x556375['id'] === _0x51c3ee['id']); _0xbe2477 && (_0xbe2477[_0x36d656(0x969)] = _0x2e060a[_0x36d656(0x969)] || [], _0xbe2477[_0x36d656(0x8f2)] = (_0x2e060a[_0x36d656(0x8f2)] || [])[_0x36d656(0x946)]((_0xd29f25, _0x208460) => ({ ..._0xd29f25, 'commentId': 'c_' + _0x51c3ee[_0x36d656(0x89b)] + '_' + _0x208460 })), _0x5eb81f(), _0x474d50()); } catch (_0x39b87a) { console['error'](_0x36d656(0x3aa), _0x39b87a), _0x420e01(_0x36d656(0x59a)); } finally { if (_0x36d656(0x25d) !== 'ASujT') { _0x1fca24['innerHTML'] = _0x36d656(0x940); return; } else _0xddfd1b(![]), _0x128784['isGenerating'] = ![]; } } function _0x17797f() { const _0x38fc3f = _0x43c7a1, _0x161978 = _0x128784[_0x38fc3f(0x21f)][_0x38fc3f(0x787)](_0x4ddead => _0x4ddead['id'] === _0x128784[_0x38fc3f(0x462)]), _0x3fc7a8 = _0x161978?.[_0x38fc3f(0x4a0)]; let _0x4da73c = _0x128784[_0x38fc3f(0x4a5)][_0x38fc3f(0x787)](_0x1e9d54 => _0x1e9d54['id'] === _0x3fc7a8); !_0x4da73c && (_0x4da73c = _0x128784[_0x38fc3f(0x4a5)]['find'](_0x2d9528 => _0x2d9528['id'] === _0x128784[_0x38fc3f(0x226)])); !_0x4da73c && (_0x4da73c = _0x128784[_0x38fc3f(0x4a5)][0x0]); if (_0x4da73c) { if (_0x38fc3f(0x323) !== _0x38fc3f(0x5f3)) document['getElementById'](_0x38fc3f(0x39b))[_0x38fc3f(0x84a)] = _0x4da73c[_0x38fc3f(0x4b6)] || _0x473193; else { const _0xe865c6 = _0x1e3376[_0x38fc3f(0x6b2)](), _0x7abc41 = _0x57587c['toLowerCase'](); if (_0xe865c6[_0x38fc3f(0x3fd)](_0x38fc3f(0x955))) return _0x38fc3f(0x59f); if (_0x7abc41[_0x38fc3f(0x9ac)](_0x38fc3f(0x480))) return _0x38fc3f(0x59f); if (_0x7abc41['includes'](_0x38fc3f(0x60c))) return 'gemini'; if (_0xe865c6[_0x38fc3f(0x3fd)](_0x38fc3f(0x94d))) return 'gemini'; return _0x38fc3f(0x350); } } } function _0x30fae3(_0x4fc280) { const _0x550a32 = _0x43c7a1; let _0x4b3275 = 0x0, _0xbf55a = 0x0, _0x2573a3 = 0x0; if (_0x4fc280[_0x550a32(0x36c)] == 0x4) _0x4b3275 = '0x' + _0x4fc280[0x1] + _0x4fc280[0x1], _0xbf55a = '0x' + _0x4fc280[0x2] + _0x4fc280[0x2], _0x2573a3 = '0x' + _0x4fc280[0x3] + _0x4fc280[0x3]; else _0x4fc280[_0x550a32(0x36c)] == 0x7 && (_0x4b3275 = '0x' + _0x4fc280[0x1] + _0x4fc280[0x2], _0xbf55a = '0x' + _0x4fc280[0x3] + _0x4fc280[0x4], _0x2573a3 = '0x' + _0x4fc280[0x5] + _0x4fc280[0x6]); _0x4b3275 /= 0xff, _0xbf55a /= 0xff, _0x2573a3 /= 0xff; let _0x1d5c44 = Math[_0x550a32(0x374)](_0x4b3275, _0xbf55a, _0x2573a3), _0x190dec = Math['max'](_0x4b3275, _0xbf55a, _0x2573a3), _0x128939 = _0x190dec - _0x1d5c44, _0x3a983e = 0x0, _0x23b396 = 0x0, _0x35f314 = 0x0; if (_0x128939 == 0x0) _0x3a983e = 0x0; else { if (_0x190dec == _0x4b3275) _0x3a983e = (_0xbf55a - _0x2573a3) / _0x128939 % 0x6; else { if (_0x190dec == _0xbf55a) _0x3a983e = (_0x2573a3 - _0x4b3275) / _0x128939 + 0x2; else _0x3a983e = (_0x4b3275 - _0xbf55a) / _0x128939 + 0x4; } } _0x3a983e = Math[_0x550a32(0x2cd)](_0x3a983e * 0x3c); if (_0x3a983e < 0x0) _0x3a983e += 0x168; return _0x35f314 = (_0x190dec + _0x1d5c44) / 0x2, _0x23b396 = _0x128939 == 0x0 ? 0x0 : _0x128939 / (0x1 - Math['abs'](0x2 * _0x35f314 - 0x1)), _0x23b396 = +(_0x23b396 * 0x64)[_0x550a32(0x8bd)](0x1), _0x35f314 = +(_0x35f314 * 0x64)[_0x550a32(0x8bd)](0x1), { 'h': _0x3a983e, 's': _0x23b396, 'l': _0x35f314 }; } function _0x22a9c0() { const _0x6c7bcd = _0x43c7a1, _0x6be76a = (_0x1465c8, _0x44c090, _0x31a634) => { const _0x103b13 = _0x118e; if (_0x103b13(0x63b) === 'twcLe') { const _0x1b3b7a = document[_0x103b13(0x655)](_0x1465c8); if (!_0x1b3b7a) return; let _0x2666e2 = null; try { _0x2666e2 = JSON['parse'](localStorage['getItem'](_0x44c090) || '{}'); } catch { _0x103b13(0x81c) === 'mYKBl' ? _0x2666e2 = {} : (_0x1dc66e(), _0x1bee19()); } _0x1b3b7a[_0x103b13(0x385)][_0x103b13(0x5a9)] = 'absolute', _0x1b3b7a[_0x103b13(0x385)][_0x103b13(0x59b)] = '', _0x1b3b7a[_0x103b13(0x385)][_0x103b13(0x2b1)] = '', _0x1b3b7a[_0x103b13(0x385)][_0x103b13(0x33e)] = '', _0x1b3b7a[_0x103b13(0x385)]['bottom'] = '', _0x1b3b7a[_0x103b13(0x385)]['transform'] = ''; if (typeof _0x2666e2['top'] === 'number' && typeof _0x2666e2[_0x103b13(0x2b1)] === 'number') { if (_0x103b13(0x36e) !== _0x103b13(0x199)) _0x1b3b7a[_0x103b13(0x385)][_0x103b13(0x59b)] = _0x2666e2[_0x103b13(0x59b)] + '%', _0x1b3b7a[_0x103b13(0x385)][_0x103b13(0x2b1)] = _0x2666e2[_0x103b13(0x2b1)] + '%'; else { const _0x51b2b9 = _0x10a37f[_0x103b13(0x21f)][_0x103b13(0x787)](_0x44c1d8 => _0x44c1d8['id'] === _0x4606eb); _0x51b2b9 && (_0x51b2b9['name'] = _0x38b793, _0x51b2b9[_0x103b13(0x4a0)] = _0x46dc2e, _0x51b2b9[_0x103b13(0x539)] = _0x5d0721); } } else for (const _0x5caa15 in _0x31a634) { _0x1b3b7a['style'][_0x5caa15] = _0x31a634[_0x5caa15]; } } else { const _0x720879 = _0x23c179[_0x103b13(0x26b)]('img'); _0x720879[_0x103b13(0x84a)] = _0x50f2f4[_0x103b13(0x237)], _0x720879[_0x103b13(0x3d7)] = 'lazy', _0x720879[_0x103b13(0x38f)] = _0x49f3fb[_0x103b13(0x4da)], _0x720879[_0x103b13(0x421)]['add'](_0x103b13(0x796)), _0x720879[_0x103b13(0x203)](_0x103b13(0x783), () => _0x120ca4(_0x5576df)), _0x20dc3d[_0x103b13(0x3d5)](_0x720879); } }; _0x6be76a(_0x6c7bcd(0x928), 'clockPosition', { 'top': _0x6c7bcd(0x742), 'left': _0x6c7bcd(0x1d7), 'transform': 'translateX(-50%)' }), _0x6be76a(_0x6c7bcd(0x574), _0x6c7bcd(0x61c), { 'top': _0x6c7bcd(0x7e0), 'right': '4%' }), _0x6be76a(_0x6c7bcd(0x829), _0x6c7bcd(0x856), { 'top': _0x6c7bcd(0x7e0), 'right': _0x6c7bcd(0x52c) }), _0x6be76a('app-settings', _0x6c7bcd(0x747), { 'top': '8%', 'right': _0x6c7bcd(0x52c) }), _0x6be76a(_0x6c7bcd(0x520), _0x6c7bcd(0x1d0), { 'top': '8%', 'right': '4%' }), _0x6be76a(_0x6c7bcd(0x4a2), _0x6c7bcd(0x53e), { 'top': _0x6c7bcd(0x3b3), 'left': '5%' }), _0x6be76a(_0x6c7bcd(0x215), _0x6c7bcd(0x6ec), { 'top': '71%', 'left': '29%' }), _0x6be76a(_0x6c7bcd(0x378), _0x6c7bcd(0x54f), { 'top': _0x6c7bcd(0x2a4), 'left': '7%' }), _0x6be76a(_0x6c7bcd(0x702), 'appIconPosition_app-accounting', { 'top': _0x6c7bcd(0x3b3), 'left': _0x6c7bcd(0x526) }), _0x6be76a(_0x6c7bcd(0x96b), _0x6c7bcd(0x584), { 'top': _0x6c7bcd(0x19e), 'right': '5%' }), _0x6be76a(_0x6c7bcd(0x9c7), _0x6c7bcd(0x6ce), { 'top': '8%', 'left': '5%' }); const _0x80f832 = document['getElementById'](_0x6c7bcd(0x280)); _0x80f832 && (_0x80f832[_0x6c7bcd(0x385)]['position'] = _0x6c7bcd(0x50b), _0x80f832[_0x6c7bcd(0x385)][_0x6c7bcd(0x59b)] = _0x6c7bcd(0x9d4), _0x80f832['style'][_0x6c7bcd(0x2b1)] = _0x6c7bcd(0x1d7), _0x80f832[_0x6c7bcd(0x385)]['transform'] = _0x6c7bcd(0x1f8), _0x80f832[_0x6c7bcd(0x385)]['display'] = 'block'); const _0x42048e = document[_0x6c7bcd(0x655)](_0x6c7bcd(0x99e)); _0x42048e && (_0x6c7bcd(0x64e) === _0x6c7bcd(0x64e) ? (_0x42048e[_0x6c7bcd(0x385)][_0x6c7bcd(0x5a9)] = _0x6c7bcd(0x50b), _0x42048e[_0x6c7bcd(0x385)][_0x6c7bcd(0x59b)] = '35%', _0x42048e[_0x6c7bcd(0x385)]['left'] = _0x6c7bcd(0x1d7), _0x42048e['style']['transform'] = _0x6c7bcd(0x1f8), _0x42048e[_0x6c7bcd(0x385)][_0x6c7bcd(0x1cd)] = _0x6c7bcd(0x80c)) : (_0x23b405[_0x6c7bcd(0x5c5)](_0x6c7bcd(0x375)), _0x45fe40(), _0x45a5b5(_0x6c7bcd(0x723)))); } function _0x3e86ba() { const _0x5e7c3b = _0x43c7a1, _0x2583e2 = document['getElementById']('custom-icon-list-container'); _0x2583e2[_0x5e7c3b(0x711)] = ''; const _0x327d53 = document[_0x5e7c3b(0x49d)]('.app-icon'); _0x327d53[_0x5e7c3b(0x4d0)](_0x45b3a4 => { const _0x485442 = _0x5e7c3b, _0x5b929a = _0x45b3a4['id'], _0x1c721b = _0x45b3a4['querySelector'](_0x485442(0x35d))[_0x485442(0x68f)], _0x5449da = _0x485442(0x4b4) + _0x5b929a, _0x38d3e4 = localStorage['getItem'](_0x5449da), _0x28944a = document[_0x485442(0x26b)](_0x485442(0x76e)); _0x28944a[_0x485442(0x1f0)] = _0x485442(0x71a), _0x28944a[_0x485442(0x385)][_0x485442(0x609)] = '10px\x200', _0x28944a[_0x485442(0x711)] = _0x485442(0x815) + _0x5b929a + _0x485442(0x1e8) + (_0x38d3e4 || _0x485442(0x3ef)) + _0x485442(0x848) + _0x1c721b + _0x485442(0x5d8) + _0x5b929a + _0x485442(0x447) + _0x5b929a + '\x27).click()\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x20background-color:\x20#777;\x22\x20onclick=\x22localStorage.removeItem(\x27' + _0x5449da + _0x485442(0x6ee), _0x2583e2[_0x485442(0x3d5)](_0x28944a); const _0x476da0 = document[_0x485442(0x655)](_0x485442(0x954) + _0x5b929a); _0x476da0[_0x485442(0x203)]('change', async _0x5a280f => { const _0x2974a1 = _0x485442, _0x1deb06 = _0x5a280f[_0x2974a1(0x949)]['files'][0x0]; if (!_0x1deb06) return; try { const _0x4deef6 = await _0x5484a4(_0x1deb06); localStorage[_0x2974a1(0x548)](_0x5449da, _0x4deef6), document['getElementById'](_0x2974a1(0x7e2) + _0x5b929a)['src'] = _0x4deef6, _0x5462de(); } catch (_0x5520dd) { _0x420e01(_0x2974a1(0x764) + _0x5520dd[_0x2974a1(0x740)]); } }); }); } function _0x5462de() { const _0x7fc513 = _0x43c7a1; if ('juSTz' !== _0x7fc513(0x7b5)) { const _0x468117 = document['querySelectorAll'](_0x7fc513(0x561)); _0x468117[_0x7fc513(0x4d0)](_0x4c96cf => { const _0x7786e1 = _0x7fc513, _0x3ae54a = _0x4c96cf['id'], _0x4c534a = _0x7786e1(0x4b4) + _0x3ae54a, _0x111e0b = localStorage[_0x7786e1(0x2c6)](_0x4c534a), _0x34a0cd = _0x4c96cf[_0x7786e1(0x9ad)]('.app-icon-img'); if (_0x111e0b) _0x34a0cd[_0x7786e1(0x711)] = _0x7786e1(0x26d) + _0x111e0b + _0x7786e1(0x547); else { const _0x2fff7f = document[_0x7786e1(0x9ad)](_0x7786e1(0x20e) + _0x3ae54a + _0x7786e1(0x7a4) + _0x3ae54a + _0x7786e1(0x806))?.[_0x7786e1(0x711)]; _0x2fff7f && (_0x34a0cd['innerHTML'] = _0x2fff7f); } }); } else _0x7ed0cb[_0x7fc513(0x385)][_0x7fc513(0x1cd)] = _0x7fc513(0x44e), _0x4d94ab[_0x7fc513(0x385)][_0x7fc513(0x1cd)] = _0x7fc513(0x3d3); } function _0x27d2d1() { const _0x56fddd = _0x43c7a1, _0x304239 = _0x128784[_0x56fddd(0x21f)][_0x56fddd(0x787)](_0x1b0aa4 => _0x1b0aa4['id'] === _0x128784[_0x56fddd(0x462)]), _0x1c07ed = _0x401cc7(); let _0xb7a262 = []; if (_0x304239 && _0x304239[_0x56fddd(0x1e2)]) { const _0x3ac457 = _0x304239[_0x56fddd(0x1e2)][_0x56fddd(0x89c)](_0xca83f5 => _0xca83f5[_0x56fddd(0x3b1)] === _0x56fddd(0x2b9) && _0xca83f5['playableUrl'])[_0x56fddd(0x946)](_0x5d1a3e => ({ ..._0x5d1a3e, 'source': _0x56fddd(0x9b8) })); _0xb7a262[_0x56fddd(0x1e5)](..._0x3ac457); } if (_0x1c07ed && _0x128784[_0x56fddd(0x6e7)]) { const _0x2e6b02 = _0x128784['conversationHistory'][_0x56fddd(0x89c)](_0x474eff => _0x474eff[_0x56fddd(0x3b1)] === _0x56fddd(0x2b9) && _0x474eff[_0x56fddd(0x36f)])[_0x56fddd(0x946)](_0x204b8e => ({ ..._0x204b8e, 'source': _0x56fddd(0x866) })); _0xb7a262[_0x56fddd(0x1e5)](..._0x2e6b02); } const _0x5f11d2 = Array['from'](new Map(_0xb7a262[_0x56fddd(0x946)](_0x25e58b => [_0x25e58b['playableUrl'], _0x25e58b]))[_0x56fddd(0x799)]()); _0x128784[_0x56fddd(0x20a)] = _0x5f11d2[_0x56fddd(0x8e2)]((_0x102420, _0xe4fc4b) => _0xe4fc4b[_0x56fddd(0x89b)] - _0x102420['timestamp']); } function _0x511e89(_0x5ebf3b) { const _0x178e52 = _0x43c7a1; if (_0x5ebf3b < 0x0 || _0x5ebf3b >= _0x25eb66[_0x178e52(0x36c)]) return; _0xe601b4 = _0x5ebf3b; const _0x5260b6 = _0x25eb66[_0x5ebf3b]; _0x70f69b[_0x178e52(0x84a)] = _0x5260b6[_0x178e52(0x36f)] || _0x5260b6['url'], _0x70f69b[_0x178e52(0x244)](), _0x15f7af(), _0x81ba60(); } function _0x15f7af() { const _0x12961d = _0x43c7a1; if ('ncwBb' === _0x12961d(0x814)) { const _0x2f620d = _0x25eb66[_0xe601b4]; _0x1ab08d(_0x2f620d); } else { if (!_0x24c60d) return []; const _0x349937 = _0x38095d[_0x12961d(0x7c7)]('\x0a'), _0x3d768e = [], _0x5c7f5b = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x429be5 of _0x349937) { const _0xa794a9 = _0x429be5[_0x12961d(0x256)](_0x5c7f5b); if (_0xa794a9) { const _0xf9ab82 = _0x2b08d2(_0xa794a9[0x1], 0xa), _0x2d87b6 = _0x4882e4(_0xa794a9[0x2], 0xa), _0x6ade94 = _0x2809a2(_0xa794a9[0x3], 0xa) * (_0xa794a9[0x3]['length'] === 0x2 ? 0xa : 0x1), _0x181fbe = _0xf9ab82 * 0x3c + _0x2d87b6 + _0x6ade94 / 0x3e8, _0x3aa993 = _0x429be5['replace'](_0x5c7f5b, '')[_0x12961d(0x6df)](); _0x3aa993 && _0x3d768e[_0x12961d(0x1e5)]({ 'time': _0x181fbe, 'text': _0x3aa993 }); } } return _0x3d768e; } } function _0x81ba60() { const _0x5602f1 = _0x43c7a1; try { localStorage[_0x5602f1(0x548)](_0x5602f1(0x5f1), JSON[_0x5602f1(0x5e0)]({ 'playlist': _0x128784[_0x5602f1(0x20a)], 'currentIndex': _0x128784[_0x5602f1(0x90a)] })); } catch (_0x22e6c2) { console[_0x5602f1(0x9de)]('保存播放器状态失败，真是没用。', _0x22e6c2); } } function _0x460642() { const _0x20bde3 = _0x43c7a1; if (_0x20bde3(0x3c9) !== _0x20bde3(0x3c9)) _0x566f29[_0x20bde3(0x753)](), _0x4b9390['querySelector'](_0x20bde3(0x61a))[_0x20bde3(0x68f)] = '▶'; else try { if (_0x20bde3(0x419) === _0x20bde3(0x419)) { const _0x2505ad = localStorage[_0x20bde3(0x2c6)](_0x20bde3(0x5f1)); if (_0x2505ad) { const { playlist: _0x4a9179, currentIndex: _0x48a353 } = JSON[_0x20bde3(0x7a8)](_0x2505ad); Array[_0x20bde3(0x79f)](_0x4a9179) && _0x4a9179[_0x20bde3(0x36c)] > 0x0 && _0x48a353 > -0x1 && (_0x128784[_0x20bde3(0x20a)] = _0x4a9179, _0x128784['currentlyPlayingIndex'] = _0x48a353, _0x128784[_0x20bde3(0x685)] = ![], _0x15f7af()); } } else _0x5d4c15(), _0xffa2c7(_0x20bde3(0x53f), _0x20bde3(0x7e1)); } catch (_0x46f80c) { console['error'](_0x20bde3(0x610), _0x46f80c); } } function _0x144bdb(_0x17e835) { const _0x5ef1ea = _0x43c7a1; if (window[_0x5ef1ea(0x363)]) clearTimeout(window[_0x5ef1ea(0x363)]); const _0x28a3ce = _0x17e835['target'][_0x5ef1ea(0x3bf)](_0x5ef1ea(0x69a)); if (!_0x28a3ce) return; const _0x3378e0 = _0x28a3ce[_0x5ef1ea(0x663)]['timestamp'], _0x207024 = _0x28a3ce[_0x5ef1ea(0x421)][_0x5ef1ea(0x878)](_0x5ef1ea(0x500)) ? _0x5ef1ea(0x500) : 'ai'; if (!_0x3378e0) return; const _0x156848 = () => { const _0xa4ce3c = _0x5ef1ea; if (_0xa4ce3c(0x614) === _0xa4ce3c(0x634)) { _0x830ab2[_0xa4ce3c(0x295)] = _0x5cb868[_0xa4ce3c(0x295)]['filter'](_0x32fe85 => _0x32fe85['id'] !== _0xdcc256); try { _0x37be90[_0xa4ce3c(0x5c5)](_0xa4ce3c(0x25f) + _0x2f0147); } catch (_0x45e6a6) { _0x549118[_0xa4ce3c(0x9de)](_0xa4ce3c(0x757) + _0x506774, _0x45e6a6); } _0x51bca5['activeChatId'] === _0x4cdec0 && (_0x2a084d[_0xa4ce3c(0x789)] = _0x253141[_0xa4ce3c(0x295)][0x0]?.['id'] || null, _0x4d6d76(_0x1c2c8f[_0xa4ce3c(0x789)])), _0x1e7458(), _0x5ea517(); } else window['diaryPressTimer'] = setTimeout(() => { const _0x3a5305 = _0xa4ce3c; if (_0x17e835[_0x3a5305(0x3b1)] === _0x3a5305(0x6a3)) _0x17e835[_0x3a5305(0x7cc)](); _0xb40343(parseInt(_0x3378e0, 0xa), _0x207024); }, 0x320); }, _0x421d91 = () => { const _0x262ef4 = _0x5ef1ea; if (_0x262ef4(0x70d) === _0x262ef4(0x70d)) { if (window[_0x262ef4(0x363)]) clearTimeout(window[_0x262ef4(0x363)]); } else _0x13326c = _0x1e607d[_0x262ef4(0x9bf)]; }; document['addEventListener']('mouseup', _0x421d91, { 'once': !![] }), document['addEventListener'](_0x5ef1ea(0x1c1), _0x421d91, { 'once': !![] }), document[_0x5ef1ea(0x203)]('touchcancel', _0x421d91, { 'once': !![] }), _0x156848(); } function _0xb40343(_0x14f227, _0x2b31a0) { const _0x53de3d = _0x43c7a1, _0x12bbae = _0x53de3d(0x6ef) + _0x14f227; let _0x236795 = document['getElementById'](_0x12bbae); if (_0x236795) return; const _0xb840db = '\x0a\x20\x20\x20\x20<div\x20id=\x22' + _0x12bbae + _0x53de3d(0x919) + (_0x2b31a0 === 'ai' ? _0x53de3d(0x33d) : '') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20'; document[_0x53de3d(0x307)][_0x53de3d(0x3af)](_0x53de3d(0x9a1), _0xb840db); const _0x1dc701 = document['getElementById'](_0x12bbae), _0x4451f5 = () => _0x1dc701[_0x53de3d(0x66f)](); _0x1dc701[_0x53de3d(0x9ad)]('.choice-modal-backdrop')[_0x53de3d(0x9c8)] = _0x4451f5, _0x1dc701['querySelector'](_0x53de3d(0x245))[_0x53de3d(0x9c8)] = _0x4451f5, _0x1dc701[_0x53de3d(0x9ad)](_0x53de3d(0x85b))['onclick'] = () => { _0x1e2592(_0x14f227), _0x4451f5(); }, _0x2b31a0 === 'ai' && ('yFdjQ' !== _0x53de3d(0x7f4) ? _0x413c41() : _0x1dc701[_0x53de3d(0x9ad)](_0x53de3d(0x5b7))[_0x53de3d(0x9c8)] = () => { _0x53b462(_0x14f227), _0x4451f5(); }); } async function _0x1e2592(_0x2a3ee3) { const _0x32c4aa = _0x43c7a1; if (_0x32c4aa(0x589) !== _0x32c4aa(0x347)) { const _0x4e54f8 = await _0x17d4de('确定要删除这篇日记吗？此操作不可撤销。'); if (!_0x4e54f8) return; const _0x24eb8f = _0x128784[_0x32c4aa(0x401)][_0x32c4aa(0x787)](_0x11f243 => _0x11f243[_0x32c4aa(0x267)] === _0x128784['activeDiaryCharacterId']); if (!_0x24eb8f) return; const _0x7cd70 = _0x24eb8f[_0x32c4aa(0x8b0)][_0x32c4aa(0x95d)](_0x5d4dab => _0x5d4dab[_0x32c4aa(0x89b)] === _0x2a3ee3); _0x7cd70 > -0x1 && (_0x24eb8f[_0x32c4aa(0x8b0)][_0x32c4aa(0x22e)](_0x7cd70, 0x1), _0x5eb81f(), _0x2ebb7f(), _0x420e01(_0x32c4aa(0x26a))); } else { const _0xbe0a23 = _0x5196e0[0x1][_0x32c4aa(0x55b)](/\\"/g, '\x22')['replace'](/\\n/g, '\x0a')[_0x32c4aa(0x6df)](); if (_0xbe0a23) _0x4af6f9[_0x32c4aa(0x1e5)](_0xbe0a23); } } async function _0x53b462(_0x5f5ab7) { const _0x3b447d = _0x43c7a1; if (_0x3b447d(0x8c0) === _0x3b447d(0x73f)) { if (_0x2d8c4f === null) return; const _0x3a3dcb = _0x3ac430['conversationHistory'][_0x2078eb]; if (!_0x3a3dcb) return; const _0x16feb4 = _0x1bf7cc(); let _0x44182e = '未知'; if (_0x3a3dcb[_0x3b447d(0x4c9)] === 'user') _0x44182e = _0x4768e5[_0x3b447d(0x50a)][_0x3b447d(0x4da)] || '我'; else { const _0x424f31 = _0x3a3dcb['senderId'] || _0x16feb4?.[_0x3b447d(0x4de)][0x0], _0x2e8a0e = _0x2c7d6f(_0x424f31); _0x44182e = _0x2e8a0e ? _0x2e8a0e[_0x3b447d(0x4da)] : '角色'; } let _0x225ca2 = _0x3a3dcb[_0x3b447d(0x472)] || ''; if (_0x3a3dcb['displayUrl']) _0x225ca2 = _0x3b447d(0x72d); if (_0x3a3dcb[_0x3b447d(0x911)]) _0x225ca2 = '[图片]'; if (_0x225ca2[_0x3b447d(0x36c)] > 0x32) _0x225ca2 = _0x225ca2['substring'](0x0, 0x32) + _0x3b447d(0x8a5); _0x2a46a1[_0x3b447d(0x729)] = { 'sender': _0x44182e, 'content': _0x225ca2 }, _0x5c8759(), _0x585531(), _0x378a17['focus'](); } else { const _0x272d8d = _0x128784[_0x3b447d(0x401)][_0x3b447d(0x787)](_0x50f0e5 => _0x50f0e5[_0x3b447d(0x267)] === _0x128784[_0x3b447d(0x592)]); if (!_0x272d8d) return; const _0x486df6 = _0x272d8d[_0x3b447d(0x8b0)][_0x3b447d(0x95d)](_0x18181f => _0x18181f[_0x3b447d(0x89b)] === _0x5f5ab7); _0x486df6 > -0x1 && (_0x3b447d(0x94c) === _0x3b447d(0x5e8) ? _0x57faa0() : (_0x272d8d[_0x3b447d(0x8b0)]['splice'](_0x486df6, 0x1), _0x5eb81f(), _0x2ebb7f(), await _0x471626())); } } function _0x57eac2() { const _0x4b1253 = _0x43c7a1, _0x365712 = document['getElementById'](_0x4b1253(0x3ec)); _0x365712[_0x4b1253(0x711)] = ''; const _0x348843 = _0x128784['characters'][_0x4b1253(0x89c)](_0x378061 => _0x128784[_0x4b1253(0x295)]['some'](_0x311eb8 => _0x311eb8[_0x4b1253(0x3b1)] === _0x4b1253(0x921) && _0x311eb8[_0x4b1253(0x4de)]['includes'](_0x378061['id']))); if (_0x348843[_0x4b1253(0x36c)] === 0x0) { if (_0x4b1253(0x638) !== 'BGDQj') { const _0x105d68 = _0x1f6516['closest']('.message-container'), _0x13d15b = _0x22357a[_0x4b1253(0x663)][_0x4b1253(0x686)], _0x467e8e = _0x1ce9bf(_0x105d68[_0x4b1253(0x663)][_0x4b1253(0x27b)], 0xa); _0x1f819b(_0x13d15b, _0x467e8e, _0x5b09bb); } else { _0x365712[_0x4b1253(0x711)] = _0x4b1253(0x1b7); return; } } _0x348843['forEach'](_0x58962f => { const _0x313cce = _0x4b1253; if (_0x313cce(0x45c) !== _0x313cce(0x45c)) { const _0x3f5fa3 = _0x346398['getElementById'](_0x313cce(0x673)); _0x3f5fa3[_0x313cce(0x711)] = ''; if (_0x10a4f1[_0x313cce(0x188)][_0x313cce(0x36c)] === 0x0) { _0x3f5fa3[_0x313cce(0x711)] = _0x313cce(0x940); return; } _0x543c56['worldBooks'][_0x313cce(0x4d0)](_0x112ab4 => { const _0x35eb22 = _0x313cce, _0x3b2bec = _0xb1f941[_0x35eb22(0x26b)](_0x35eb22(0x76e)); _0x3b2bec[_0x35eb22(0x1f0)] = _0x35eb22(0x669), _0x3b2bec['dataset']['id'] = _0x112ab4['id'], _0x3b2bec[_0x35eb22(0x711)] = _0x35eb22(0x54a) + _0x112ab4[_0x35eb22(0x4da)] + _0x35eb22(0x862) + _0x112ab4[_0x35eb22(0x472)]['substring'](0x0, 0x64) + _0x35eb22(0x8c9), _0x3b2bec[_0x35eb22(0x203)](_0x35eb22(0x783), () => _0x47f416(_0x112ab4['id'])), _0x3f5fa3[_0x35eb22(0x3d5)](_0x3b2bec); }); } else { const _0x29a937 = document['createElement']('li'); _0x29a937[_0x313cce(0x1f0)] = _0x313cce(0x1ba), _0x29a937[_0x313cce(0x663)][_0x313cce(0x1e7)] = _0x58962f['id'], _0x29a937[_0x313cce(0x711)] = _0x313cce(0x706) + (_0x58962f[_0x313cce(0x4b6)] || _0x3834ec) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x58962f[_0x313cce(0x4da)] + _0x313cce(0x978), _0x29a937[_0x313cce(0x203)](_0x313cce(0x783), () => { _0x67648a(_0x58962f['id']); }), _0x29a937[_0x313cce(0x9ad)](_0x313cce(0x4f6))[_0x313cce(0x203)]('click', () => { _0x67648a(_0x58962f['id']); }), _0x29a937[_0x313cce(0x9ad)](_0x313cce(0x476))[_0x313cce(0x203)]('click', _0x5349ea => { const _0x512e70 = _0x313cce; if (_0x512e70(0x99a) !== _0x512e70(0x99a)) { if (!_0x422853[_0x512e70(0x21f)] || _0x20ad22['friendCircles']['length'] === 0x0) { _0x3ff9ea[_0x512e70(0x9de)](_0x512e70(0x1bd)); return; } const _0x287b06 = _0x106065[_0x512e70(0x21f)][0x0]; if (_0x287b06[_0x512e70(0x539)][_0x512e70(0x36c)] < 0x2) { _0x3b3a50[_0x512e70(0x9de)](_0x512e70(0x37d) + _0x287b06['name'] + _0x512e70(0x8f0)); return; } const _0x3b417e = { 'id': 'test_post_' + _0x301f8d[_0x512e70(0x8a2)](), 'authorType': 'character', 'authorId': _0x287b06[_0x512e70(0x539)][0x0], 'content': _0x512e70(0x2e2), 'timestamp': _0x50a445[_0x512e70(0x8a2)](), 'likes': [_0x287b06[_0x512e70(0x539)][0x1]], 'comments': [{ 'commentId': 'c_' + _0x552dd8['now'](), 'authorId': _0x287b06[_0x512e70(0x539)][0x1], 'content': _0x512e70(0x45e) }] }; _0x287b06[_0x512e70(0x1e2)][_0x512e70(0x1e5)](_0x3b417e), _0x256d2e(), _0x1e14ea['log'](_0x512e70(0x31b) + _0x287b06['name'] + _0x512e70(0x3a5)), _0x249cb5(_0x512e70(0x83d)); } else _0x5349ea[_0x512e70(0x3b7)](), _0x50b6bb(_0x58962f['id']); }), _0x365712[_0x313cce(0x3d5)](_0x29a937); } }); } function _0x67648a(_0x1c3eda) { const _0x79f9ac = _0x43c7a1; if ('gtTsm' !== _0x79f9ac(0x391)) _0x1db72c(), _0x19dba7(_0x79f9ac(0x5dc), _0x79f9ac(0x7e1)); else { const _0x23ea8d = _0x8351ef(_0x1c3eda); if (!_0x23ea8d) return; _0x128784[_0x79f9ac(0x592)] = _0x1c3eda; const _0x1d340d = _0x128784['diaries']['find'](_0x512e34 => _0x512e34[_0x79f9ac(0x267)] === _0x1c3eda), _0x5bab7e = _0x1d340d ? _0x1d340d['entries']['length'] : 0x0, _0x42cb9a = 0x2; _0x128784[_0x79f9ac(0x549)] = Math[_0x79f9ac(0x85a)](0x0, Math[_0x79f9ac(0x43b)](_0x5bab7e / _0x42cb9a) - 0x1), document[_0x79f9ac(0x655)](_0x79f9ac(0x67d))[_0x79f9ac(0x68f)] = _0x23ea8d[_0x79f9ac(0x4da)] + _0x79f9ac(0x49c), _0x2ebb7f(), _0xcf54be(_0x79f9ac(0x888), _0x79f9ac(0x53f)); } } function _0x2ebb7f() { const _0x2ddaa2 = _0x43c7a1, _0x3ed3c0 = document['getElementById'](_0x2ddaa2(0x781)), _0x808e6e = document[_0x2ddaa2(0x655)](_0x2ddaa2(0x7da)); _0x3ed3c0[_0x2ddaa2(0x711)] = '', _0x808e6e[_0x2ddaa2(0x711)] = ''; const _0x5c7e2a = _0x66f827() || { 'name': '我' }, _0x9bd21a = _0x128784[_0x2ddaa2(0x401)][_0x2ddaa2(0x787)](_0x28d611 => _0x28d611[_0x2ddaa2(0x267)] === _0x128784[_0x2ddaa2(0x592)]); if (!_0x9bd21a || !_0x9bd21a[_0x2ddaa2(0x8b0)] || _0x9bd21a[_0x2ddaa2(0x8b0)][_0x2ddaa2(0x36c)] === 0x0) { _0x3ed3c0[_0x2ddaa2(0x711)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', _0x808e6e[_0x2ddaa2(0x711)] = _0x2ddaa2(0x50c), document[_0x2ddaa2(0x655)](_0x2ddaa2(0x5f8))['addEventListener'](_0x2ddaa2(0x783), _0x5f3142), document[_0x2ddaa2(0x655)](_0x2ddaa2(0x962))[_0x2ddaa2(0x203)]('click', _0x471626); return; } const _0x39395d = 0x2, _0x22941c = [..._0x9bd21a[_0x2ddaa2(0x8b0)]]['sort']((_0x44c3f5, _0x2be6ef) => _0x44c3f5[_0x2ddaa2(0x89b)] - _0x2be6ef['timestamp']), _0x1d2495 = []; for (let _0x124d9f = 0x0; _0x124d9f < _0x22941c[_0x2ddaa2(0x36c)]; _0x124d9f += _0x39395d) { _0x1d2495[_0x2ddaa2(0x1e5)](_0x22941c[_0x2ddaa2(0x6e3)](_0x124d9f, _0x124d9f + _0x39395d)); } const _0x55a018 = _0x1d2495[_0x2ddaa2(0x36c)]; _0x1d2495[_0x2ddaa2(0x4d0)]((_0x1e07e1, _0x18d666) => { const _0x584352 = _0x2ddaa2, _0xd6d8ed = document[_0x584352(0x26b)]('div'); _0xd6d8ed['className'] = _0x584352(0x5ef), _0xd6d8ed['id'] = _0x584352(0x752) + _0x18d666; if (_0x18d666 === _0x128784[_0x584352(0x549)]) { if (_0x584352(0x662) !== _0x584352(0x662)) { const _0xea7081 = _0x4b50c0[_0x584352(0x5df)][_0x584352(0x289)](); _0xd57d54[_0x584352(0x68f)] = _0xea7081[_0x584352(0x555)] === _0x584352(0x71b) ? '旁白' : _0xea7081['speaker'], _0x28befd[_0x584352(0x68f)] = _0xea7081['line'], _0xea7081[_0x584352(0x555)] !== _0x584352(0x71b) && _0x75d721(_0x1c9995[_0x584352(0x50e)], _0xea7081[_0x584352(0x5eb)]); } else _0xd6d8ed[_0x584352(0x421)]['add'](_0x584352(0x542)); } _0x1e07e1[_0x584352(0x4d0)](_0x1b3878 => { const _0x44a25b = _0x584352, _0x2bf065 = _0x1b3878[_0x44a25b(0x38a)] === 'user' ? _0x44a25b(0x500) : 'ai', _0x27c59c = _0x1b3878[_0x44a25b(0x38a)] === _0x44a25b(0x500) ? _0x5c7e2a[_0x44a25b(0x4da)] : _0x8351ef(_0x1b3878['author'])[_0x44a25b(0x4da)], _0x9baed0 = document['createElement'](_0x44a25b(0x76e)); _0x9baed0[_0x44a25b(0x1f0)] = 'diary-entry\x20' + _0x2bf065, _0x9baed0[_0x44a25b(0x663)]['timestamp'] = _0x1b3878['timestamp'], _0x9baed0['style'][_0x44a25b(0x346)] = _0x44a25b(0x44e), _0x9baed0['style'][_0x44a25b(0x3ce)] = '0', _0x9baed0[_0x44a25b(0x711)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>' + _0x27c59c + _0x44a25b(0x5be) + new Date(_0x1b3878[_0x44a25b(0x89b)])['toLocaleString'](_0x44a25b(0x7ba)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>' + _0x1b3878[_0x44a25b(0x472)]['replace'](/\n/g, '<br>') + _0x44a25b(0x72b), _0xd6d8ed[_0x44a25b(0x3d5)](_0x9baed0); }), _0x3ed3c0[_0x584352(0x3d5)](_0xd6d8ed); }), _0x808e6e[_0x2ddaa2(0x711)] = _0x2ddaa2(0x612) + (_0x128784[_0x2ddaa2(0x549)] + 0x1) + _0x2ddaa2(0x64d) + _0x55a018 + _0x2ddaa2(0x1ca), document[_0x2ddaa2(0x655)]('diary-prev-button')[_0x2ddaa2(0x647)] = _0x128784[_0x2ddaa2(0x549)] === 0x0, document[_0x2ddaa2(0x655)](_0x2ddaa2(0x312))[_0x2ddaa2(0x647)] = _0x128784[_0x2ddaa2(0x549)] === _0x55a018 - 0x1, document[_0x2ddaa2(0x655)](_0x2ddaa2(0x572))[_0x2ddaa2(0x203)](_0x2ddaa2(0x783), _0x5dd29a), document[_0x2ddaa2(0x655)](_0x2ddaa2(0x312))[_0x2ddaa2(0x203)](_0x2ddaa2(0x783), _0x3af7e9), document[_0x2ddaa2(0x655)](_0x2ddaa2(0x5f8))[_0x2ddaa2(0x203)](_0x2ddaa2(0x783), _0x5f3142), document['getElementById']('diary-get-reply-button')[_0x2ddaa2(0x203)](_0x2ddaa2(0x783), _0x471626); } function _0x3af7e9() { const _0x14532d = _0x43c7a1; if (_0x128784[_0x14532d(0x41e)]) return; const _0x2be1d3 = _0x128784[_0x14532d(0x549)], _0x5f363d = Math['ceil'](_0x128784[_0x14532d(0x401)][_0x14532d(0x787)](_0x38226c => _0x38226c[_0x14532d(0x267)] === _0x128784[_0x14532d(0x592)])[_0x14532d(0x8b0)][_0x14532d(0x36c)] / 0x2); if (_0x2be1d3 >= _0x5f363d - 0x1) return; _0x128784[_0x14532d(0x41e)] = !![]; const _0x1ad34e = _0x2be1d3 + 0x1, _0x2dd60f = document[_0x14532d(0x655)]('diary-page-' + _0x2be1d3), _0xa7ce9b = document[_0x14532d(0x655)](_0x14532d(0x752) + _0x1ad34e); _0x2dd60f && _0xa7ce9b ? (_0xa7ce9b[_0x14532d(0x421)][_0x14532d(0x266)](_0x14532d(0x872)), _0x2dd60f[_0x14532d(0x421)][_0x14532d(0x266)](_0x14532d(0x210)), _0xa7ce9b[_0x14532d(0x421)][_0x14532d(0x266)](_0x14532d(0x542)), setTimeout(() => { const _0x213f0d = _0x14532d; _0x2dd60f[_0x213f0d(0x421)][_0x213f0d(0x66f)](_0x213f0d(0x542), _0x213f0d(0x210)), _0xa7ce9b[_0x213f0d(0x421)][_0x213f0d(0x66f)]('is-entering-from-right'), _0x128784['diaryCurrentPage'] = _0x1ad34e, _0x2ebb7f(), _0x128784['isAnimatingDiary'] = ![]; }, 0x2bc)) : _0x128784[_0x14532d(0x41e)] = ![]; } function _0x5dd29a() { const _0x2b06ff = _0x43c7a1; if (_0x128784[_0x2b06ff(0x41e)]) return; const _0x52802f = _0x128784[_0x2b06ff(0x549)]; if (_0x52802f <= 0x0) return; _0x128784[_0x2b06ff(0x41e)] = !![]; const _0x242eba = _0x52802f - 0x1, _0x3685dc = document['getElementById']('diary-page-' + _0x52802f), _0x2eec3d = document[_0x2b06ff(0x655)](_0x2b06ff(0x752) + _0x242eba); if (_0x3685dc && _0x2eec3d) { if (_0x2b06ff(0x7a5) !== _0x2b06ff(0x7a5)) { const _0x1478b4 = _0x4f8d45[_0x2b06ff(0x3d1)][_0x19cd06['activeMeetingCharId']]; if (_0x1478b4 && _0x1478b4[_0x2b06ff(0x36c)] > 0x0) { _0x130c24[_0x2b06ff(0x5df)] = [..._0x1478b4]; const _0x128e4d = _0xd11186[_0x2b06ff(0x5df)][_0x2b06ff(0x289)](); _0x1a397e[_0x2b06ff(0x68f)] = _0x128e4d[_0x2b06ff(0x555)] === _0x2b06ff(0x71b) ? '旁白' : _0x128e4d[_0x2b06ff(0x555)], _0x2eb3b3[_0x2b06ff(0x68f)] = _0x128e4d[_0x2b06ff(0x91c)], _0x128e4d[_0x2b06ff(0x555)] !== _0x2b06ff(0x71b) && _0x3c6789(_0x504e81[_0x2b06ff(0x50e)], _0x128e4d['emotion']); } else _0x52928c[_0x2b06ff(0x68f)] = '旁白', _0x17fae4[_0x2b06ff(0x68f)] = _0x2b06ff(0x29d); } else _0x2eec3d[_0x2b06ff(0x421)][_0x2b06ff(0x266)]('is-entering-from-left'), _0x3685dc['classList'][_0x2b06ff(0x266)](_0x2b06ff(0x195)), _0x2eec3d['classList'][_0x2b06ff(0x266)](_0x2b06ff(0x542)), setTimeout(() => { const _0x54c61b = _0x2b06ff; _0x3685dc[_0x54c61b(0x421)][_0x54c61b(0x66f)]('is-visible', _0x54c61b(0x195)), _0x2eec3d['classList'][_0x54c61b(0x66f)]('is-entering-from-left'), _0x128784[_0x54c61b(0x549)] = _0x242eba, _0x2ebb7f(), _0x128784['isAnimatingDiary'] = ![]; }, 0x2bc); } else 'ngcJj' !== 'ngcJj' ? _0x2e5730['alt'] = _0x2b06ff(0x231) : _0x128784['isAnimatingDiary'] = ![]; } function _0x5f3142() { const _0x15d652 = _0x43c7a1; if ('ifqug' !== _0x15d652(0x1fc)) return new Promise(_0x5a4af0 => { const _0x218d15 = _0x15d652; if (_0x218d15(0x1b2) === 'tjBrO') { const _0x2aaafd = _0x218d15(0x897); document[_0x218d15(0x307)][_0x218d15(0x3af)](_0x218d15(0x9a1), _0x2aaafd); const _0x2bc812 = document[_0x218d15(0x655)]('diary-write-modal'), _0x260c0f = document[_0x218d15(0x655)](_0x218d15(0x7e4)), _0x3b1946 = document[_0x218d15(0x655)](_0x218d15(0x42c)), _0x30377b = document[_0x218d15(0x655)](_0x218d15(0x93c)), _0x51dc85 = _0x2bc812[_0x218d15(0x9ad)](_0x218d15(0x315)), _0x4ed5c5 = () => { _0x2bc812['remove'](), _0x5a4af0(); }; _0x3b1946[_0x218d15(0x9c8)] = () => { const _0x446da2 = _0x218d15; 'FwyrJ' === 'YGECF' ? (_0x37c7cc[_0x446da2(0x421)][_0x446da2(0x266)](_0x446da2(0x872)), _0x2e8bc5[_0x446da2(0x421)][_0x446da2(0x266)](_0x446da2(0x210)), _0x49c19[_0x446da2(0x421)][_0x446da2(0x266)]('is-visible'), _0x985be3(() => { const _0xf6fbd3 = _0x446da2; _0x3abf07['classList'][_0xf6fbd3(0x66f)](_0xf6fbd3(0x542), _0xf6fbd3(0x210)), _0xb3c65a[_0xf6fbd3(0x421)][_0xf6fbd3(0x66f)]('is-entering-from-right'), _0x188dc9[_0xf6fbd3(0x549)] = _0x2387dd, _0x5be4c3(), _0x37d7ee[_0xf6fbd3(0x41e)] = ![]; }, 0x2bc)) : (_0xada467(_0x260c0f['value']), _0x4ed5c5()); }, _0x30377b[_0x218d15(0x9c8)] = _0x4ed5c5, _0x51dc85[_0x218d15(0x9c8)] = _0x4ed5c5; } else { if (_0x308de8[_0x218d15(0x956)] === _0x218d15(0x790)) _0x5e51ee(null); _0x448ea1[_0x218d15(0x956)] === _0x218d15(0x487) && (_0x690c80[_0x218d15(0x7cc)](), _0x4c660a()); } }); else _0x4d013b(_0x15d652(0x26e)); } function _0xada467(_0x5b7ea3) { const _0x5a12e2 = _0x43c7a1, _0x1954d1 = _0x5b7ea3[_0x5a12e2(0x6df)](); if (!_0x1954d1 || !_0x128784[_0x5a12e2(0x592)]) return; let _0x32f2bc = _0x128784[_0x5a12e2(0x401)]['find'](_0x3b5d8f => _0x3b5d8f['characterId'] === _0x128784['activeDiaryCharacterId']); !_0x32f2bc && (_0x32f2bc = { 'characterId': _0x128784['activeDiaryCharacterId'], 'entries': [] }, _0x128784[_0x5a12e2(0x401)][_0x5a12e2(0x1e5)](_0x32f2bc)); _0x32f2bc[_0x5a12e2(0x8b0)][_0x5a12e2(0x1e5)]({ 'timestamp': Date['now'](), 'author': _0x5a12e2(0x500), 'content': _0x1954d1 }), _0x5eb81f(); const _0x1c1b54 = _0x32f2bc[_0x5a12e2(0x8b0)][_0x5a12e2(0x36c)]; _0x128784[_0x5a12e2(0x549)] = Math[_0x5a12e2(0x43b)](_0x1c1b54 / 0x2) - 0x1, _0x2ebb7f(); } async function _0x471626() { const _0x25d267 = _0x43c7a1; if ('aJaMw' !== 'FxQUX') { const _0xd9c375 = _0x128784[_0x25d267(0x401)][_0x25d267(0x787)](_0xa2e5ed => _0xa2e5ed[_0x25d267(0x267)] === _0x128784[_0x25d267(0x592)]), _0x44af45 = _0x128784[_0x25d267(0x592)], _0x30b984 = _0x8351ef(_0x44af45); if (!_0x30b984 || _0x128784['isGenerating']) return; _0xddfd1b(!![], _0x25d267(0x852)), _0x128784[_0x25d267(0x2d7)] = !![]; let _0x4337a2 = []; try { const _0x2585d2 = _0x66f827() || { 'name': '你' }, _0x7b2180 = _0x3de826(_0x44af45), { omniText: _0x19a8f2 } = _0x407b35(_0x44af45, _0x128784[_0x25d267(0x789)]); let _0x51e7af = ''; if (_0x30b984[_0x25d267(0x341)] && _0x30b984[_0x25d267(0x341)]['length'] > 0x0) { if (_0x25d267(0x646) !== _0x25d267(0x98f)) { const _0x4e98fc = _0x30b984[_0x25d267(0x341)][_0x25d267(0x946)](_0x71a5d3 => _0x128784[_0x25d267(0x188)][_0x25d267(0x787)](_0x3f51be => _0x3f51be['id'] === _0x71a5d3))[_0x25d267(0x89c)](Boolean)['map'](_0xfaad4 => _0x25d267(0x895) + _0xfaad4['name'] + '\x0a' + _0xfaad4[_0x25d267(0x472)])['join'](''); if (_0x4e98fc) _0x51e7af = '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a' + _0x4e98fc; } else _0x28b7d9['style'][_0x25d267(0x2ca)] = _0x25d267(0x5cf) + _0xc5204e[_0x25d267(0x9be)](_0x579ce0) + '\x27)', _0x265335['style']['backgroundSize'] = 'cover', _0x1d0665[_0x25d267(0x385)]['backgroundPosition'] = _0x25d267(0x4cf); } const _0x5313ea = _0x2585d2[_0x25d267(0x489)] ? '\x0a\x0a#\x20关于读者“' + _0x2585d2[_0x25d267(0x4da)] + '”的补充信息\x0a' + _0x2585d2[_0x25d267(0x489)] : '', _0x324163 = _0x15bafc(); let _0xb676ec = '你还没有写日记。'; if (_0xd9c375 && _0xd9c375[_0x25d267(0x8b0)]) { const _0x47466b = _0xd9c375[_0x25d267(0x8b0)]['filter'](_0x4538f1 => _0x4538f1[_0x25d267(0x38a)] === 'user')[_0x25d267(0x3b5)](); _0x47466b && (_0xb676ec = _0x47466b['content']); } const _0x4435b0 = _0x25d267(0x8a4) + _0x30b984['name'] + '”的角色，现在需要写一篇交换日记。\x0a\x0a#\x20你的读者\x0a' + _0x2585d2[_0x25d267(0x4da)] + _0x25d267(0x501) + _0x2585d2[_0x25d267(0x4da)] + '）最新写下的日记内容。Ta写的是：\x0a\x20“' + _0xb676ec + _0x25d267(0x4c5) + _0x30b984[_0x25d267(0x489)] + '\x0a' + _0x5313ea + '\x0a' + _0x51e7af + _0x25d267(0x4ce) + new Date()['toLocaleString'](_0x25d267(0x7ba), { 'dateStyle': 'full', 'timeStyle': _0x25d267(0x628) }) + '\x0a-\x20**日记本的上一笔记录是在**:\x20' + _0x37da26(new Date(_0xd9c375?.[_0x25d267(0x8b0)]?.['at'](-0x1)?.['timestamp'] || Date[_0x25d267(0x8a2)]())) + _0x25d267(0x968) + (_0x19a8f2 || _0x25d267(0x73a)) + _0x25d267(0x910) + (_0x324163 || _0x25d267(0x2fa)) + _0x25d267(0x73b); _0x4337a2 = [{ 'role': _0x25d267(0x960), 'content': _0x4435b0 }, { 'role': 'user', 'content': _0x25d267(0x9e1) }]; const _0x47ae41 = await _0x2e6580(_0x4337a2); if (_0x47ae41) { let _0x4643c0 = _0x128784[_0x25d267(0x401)][_0x25d267(0x787)](_0xb52add => _0xb52add[_0x25d267(0x267)] === _0x44af45); !_0x4643c0 && (_0x4643c0 = { 'characterId': _0x44af45, 'entries': [] }, _0x128784[_0x25d267(0x401)][_0x25d267(0x1e5)](_0x4643c0)); _0x4643c0[_0x25d267(0x8b0)]['push']({ 'timestamp': Date[_0x25d267(0x8a2)](), 'author': _0x44af45, 'content': _0x47ae41 }), _0x5eb81f(); const _0x3fd37f = _0x4643c0[_0x25d267(0x8b0)][_0x25d267(0x36c)]; _0x128784['diaryCurrentPage'] = Math[_0x25d267(0x43b)](_0x3fd37f / 0x2) - 0x1, _0x2ebb7f(); } } catch (_0x5d24f5) { 'VPUab' !== _0x25d267(0x961) ? _0x416a89(_0x9db510['id']) : _0x420e01(_0x25d267(0x8c5) + _0x5d24f5[_0x25d267(0x740)]); } finally { if ('CUDlc' !== 'eoZFX') _0xddfd1b(![]), _0x128784[_0x25d267(0x2d7)] = ![]; else { _0x540345(_0x25d267(0x283)); return; } } } else _0x3d6c48 = _0x25d267(0x79c) + _0x46f326['avatar'] + _0x25d267(0x4c8) + _0x5e8917['name'] + _0x25d267(0x927) + _0x3a9048[_0x25d267(0x18b)]['text'] + _0x25d267(0x6c4); } function _0x3401d9() { const _0x226035 = _0x43c7a1; if ('YLIge' === _0x226035(0x288)) { const _0x277900 = document[_0x226035(0x655)](_0x226035(0x9cb)), _0xa58b01 = document[_0x226035(0x655)]('galgame-view-container'), _0x27e9c6 = document[_0x226035(0x9ad)](_0x226035(0x626)); _0x128784['meetingViewMode'] === 'galgame' ? (_0x277900[_0x226035(0x385)][_0x226035(0x1cd)] = _0x226035(0x44e), _0xa58b01['style'][_0x226035(0x1cd)] = _0x226035(0x3d3)) : (_0x277900['style'][_0x226035(0x1cd)] = _0x226035(0x3d3), _0xa58b01[_0x226035(0x385)][_0x226035(0x1cd)] = 'none'), _0x27e9c6[_0x226035(0x385)]['display'] = 'block'; } else _0x4e04c9[_0x226035(0x50a)][_0x226035(0x4da)] = _0x38333e['value'][_0x226035(0x6df)](), _0xbb5ae6[_0x226035(0x50a)]['persona'] = _0x54e1cc[_0x226035(0x9bf)][_0x226035(0x6df)](), _0xaf77a(), _0x9b0d89(), _0x5b4497(_0x226035(0x3bc)), _0x22b4a5(_0x226035(0x582), _0x226035(0x50a)); } function _0x52a9f3() { const _0x1a5f40 = _0x43c7a1, _0x3d9719 = document[_0x1a5f40(0x655)]('galgame-speaker'), _0x58d31e = document[_0x1a5f40(0x655)](_0x1a5f40(0x91b)); if (_0x128784['activeMeetingScriptQueue'][_0x1a5f40(0x36c)] > 0x0) { const _0x2c9534 = _0x128784[_0x1a5f40(0x5df)][_0x1a5f40(0x289)](); _0x3d9719['textContent'] = _0x2c9534[_0x1a5f40(0x555)] === _0x1a5f40(0x71b) ? '旁白' : _0x2c9534[_0x1a5f40(0x555)], _0x58d31e['textContent'] = _0x2c9534[_0x1a5f40(0x91c)], _0x2c9534[_0x1a5f40(0x555)] !== 'narrator' && _0x527267(_0x128784[_0x1a5f40(0x50e)], _0x2c9534[_0x1a5f40(0x5eb)]); } else { if ('wZEbz' !== 'IVcOT') { const _0x3c2d8f = _0x128784['characterLastScripts'][_0x128784[_0x1a5f40(0x50e)]]; if (_0x3c2d8f && _0x3c2d8f['length'] > 0x0) { _0x128784[_0x1a5f40(0x5df)] = [..._0x3c2d8f]; const _0x4a2e4b = _0x128784[_0x1a5f40(0x5df)][_0x1a5f40(0x289)](); _0x3d9719[_0x1a5f40(0x68f)] = _0x4a2e4b[_0x1a5f40(0x555)] === _0x1a5f40(0x71b) ? '旁白' : _0x4a2e4b[_0x1a5f40(0x555)], _0x58d31e[_0x1a5f40(0x68f)] = _0x4a2e4b['line'], _0x4a2e4b[_0x1a5f40(0x555)] !== _0x1a5f40(0x71b) && _0x527267(_0x128784[_0x1a5f40(0x50e)], _0x4a2e4b[_0x1a5f40(0x5eb)]); } else _0x3d9719['textContent'] = '旁白', _0x58d31e[_0x1a5f40(0x68f)] = _0x1a5f40(0x29d); } else { const _0xf474ad = _0x3ca4de['trim'](); if (!_0xf474ad || !_0x153095[_0x1a5f40(0x592)]) return; let _0xded4f8 = _0x50807d['diaries'][_0x1a5f40(0x787)](_0x1dd5eb => _0x1dd5eb[_0x1a5f40(0x267)] === _0x17fd06[_0x1a5f40(0x592)]); !_0xded4f8 && (_0xded4f8 = { 'characterId': _0x452257[_0x1a5f40(0x592)], 'entries': [] }, _0x38b1e3['diaries'][_0x1a5f40(0x1e5)](_0xded4f8)); _0xded4f8[_0x1a5f40(0x8b0)][_0x1a5f40(0x1e5)]({ 'timestamp': _0x42ae53[_0x1a5f40(0x8a2)](), 'author': _0x1a5f40(0x500), 'content': _0xf474ad }), _0x1aef01(); const _0x1004e0 = _0xded4f8[_0x1a5f40(0x8b0)][_0x1a5f40(0x36c)]; _0x5cc13f[_0x1a5f40(0x549)] = _0x23e152[_0x1a5f40(0x43b)](_0x1004e0 / 0x2) - 0x1, _0x56c9af(); } } } async function _0x527267(_0xed4497, _0x4bb733) { const _0x2dd116 = _0x43c7a1, _0xb48b12 = document[_0x2dd116(0x655)](_0x2dd116(0x240)), _0x35f8cf = document[_0x2dd116(0x655)](_0x2dd116(0x2bd)), _0xc69efe = _0x8351ef(_0xed4497), _0x42d615 = _0xc69efe?.[_0x2dd116(0x830)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }, _0x55a79b = 0x50 * _0x42d615['scale']; _0x35f8cf[_0x2dd116(0x385)][_0x2dd116(0x860)] = _0x55a79b + '%', _0x35f8cf['style'][_0x2dd116(0x19b)] = _0x55a79b + '%', _0x35f8cf[_0x2dd116(0x385)][_0x2dd116(0x2b1)] = _0x42d615['x'] + '%', _0x35f8cf['style'][_0x2dd116(0x59b)] = _0x42d615['y'] + '%', _0x35f8cf[_0x2dd116(0x385)]['transform'] = _0x2dd116(0x890), _0x35f8cf[_0x2dd116(0x385)]['bottom'] = _0x2dd116(0x18d); const _0x19b5ce = [_0x2dd116(0x850), _0x2dd116(0x89e), 'angry', _0x2dd116(0x29f), _0x2dd116(0x846)], _0x3af71b = _0x19b5ce['includes'](_0x4bb733) ? _0x4bb733 : _0x2dd116(0x850); try { const _0x55eac3 = await _0x226e0a(_0x2dd116(0x67c) + _0x3af71b + '_' + _0xed4497); if (_0x55eac3) { if (_0x2dd116(0x3d9) !== _0x2dd116(0x17a)) _0xb48b12[_0x2dd116(0x84a)] && _0xb48b12[_0x2dd116(0x385)][_0x2dd116(0x269)] !== '0' ? (_0xb48b12[_0x2dd116(0x385)][_0x2dd116(0x269)] = 0x0, setTimeout(() => { const _0x1fba64 = _0x2dd116; _0xb48b12[_0x1fba64(0x84a)] = URL[_0x1fba64(0x9be)](_0x55eac3), _0xb48b12['style'][_0x1fba64(0x269)] = 0x1; }, 0x96)) : (_0xb48b12[_0x2dd116(0x84a)] = URL[_0x2dd116(0x9be)](_0x55eac3), _0xb48b12[_0x2dd116(0x385)][_0x2dd116(0x269)] = 0x1); else { _0x3a2b5f[_0x2dd116(0x331)]('好友圈档案柜是空的，无需净化。'); return; } } else { if (_0x2dd116(0x64a) !== _0x2dd116(0x64a)) { const _0x5881ca = _0x3a2223['likes']['map'](_0x42298e => _0x5620a3(_0x42298e)?.['name'] || '未知')[_0x2dd116(0x9cc)]('、'), _0x3ec1e6 = _0x2dd116(0x306); _0x368b6c = '<div\x20class=\x22post-likes\x22>' + _0x3ec1e6 + '\x20' + _0x5881ca + '</div>'; } else { const _0x5ccbde = await _0x226e0a(_0x2dd116(0x7d1) + _0xed4497); _0xb48b12[_0x2dd116(0x84a)] = _0x5ccbde ? URL['createObjectURL'](_0x5ccbde) : ''; } } } catch (_0x37bcf6) { console[_0x2dd116(0x9de)](_0x2dd116(0x1df), _0x37bcf6), _0xb48b12['src'] = ''; } } let _0x1a2fb4 = ![], _0x276825 = { 'isDragging': ![], 'isResizing': ![], 'startX': 0x0, 'startY': 0x0, 'startLeft': 0x0, 'startTop': 0x0, 'startWidth': 0x0, 'startHeight': 0x0 }; const _0xee520 = document[_0x43c7a1(0x655)](_0x43c7a1(0x719)), _0x3e11c7 = document['getElementById'](_0x43c7a1(0x27e)), _0xf3c636 = document[_0x43c7a1(0x655)](_0x43c7a1(0x733)), _0x38de26 = document[_0x43c7a1(0x655)]('sprite-reset-button'), _0x6221da = document[_0x43c7a1(0x655)](_0x43c7a1(0x695)), _0x4e3d02 = document[_0x43c7a1(0x655)]('galgame-sprite-container'), _0x4b5f2b = document['getElementById']('sprite-resize-handle'), _0x45a23f = document[_0x43c7a1(0x655)]('meeting-main-content'); let _0x5d0c5c = {}; function _0x5e7908() { const _0x5438c9 = _0x43c7a1, _0x87a51b = _0x8351ef(_0x128784[_0x5438c9(0x50e)]); if (!_0x87a51b) return; _0x1a2fb4 = !![], _0x6221da[_0x5438c9(0x385)][_0x5438c9(0x1cd)] = 'block'; const _0x30a55 = _0x87a51b[_0x5438c9(0x830)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; document[_0x5438c9(0x655)]('sprite-slider-x')['value'] = _0x30a55['x'], document[_0x5438c9(0x655)](_0x5438c9(0x6d4))['value'] = _0x30a55['y'], document[_0x5438c9(0x655)](_0x5438c9(0x825))[_0x5438c9(0x9bf)] = _0x30a55[_0x5438c9(0x6f3)] * 0x64, _0x5d0c5c = { ..._0x30a55 }, document[_0x5438c9(0x655)](_0x5438c9(0x326))[_0x5438c9(0x385)]['display'] = _0x5438c9(0x44e), document[_0x5438c9(0x655)]('galgame-sprite-adjust-ui')[_0x5438c9(0x385)]['display'] = _0x5438c9(0x44e); } function _0xb2c66a(_0xd0644 = ![]) { const _0x32c93a = _0x43c7a1; _0x1a2fb4 = ![], _0x6221da['style']['display'] = 'none', document[_0x32c93a(0x655)](_0x32c93a(0x326))[_0x32c93a(0x385)][_0x32c93a(0x1cd)] = _0x32c93a(0x3d3), document[_0x32c93a(0x655)](_0x32c93a(0x2fc))[_0x32c93a(0x385)][_0x32c93a(0x1cd)] = _0x32c93a(0x3d3); if (!_0xd0644) { if (_0x32c93a(0x408) !== 'yOibu') { const _0x1f7d1d = _0x8351ef(_0x128784[_0x32c93a(0x50e)]); _0x1f7d1d && (_0x1f7d1d[_0x32c93a(0x830)] = _0x5d0c5c, _0x527267(_0x128784['activeMeetingCharId'], _0x32c93a(0x850))); } else { const _0x3af0ec = _0x3be13e[_0x32c93a(0x26b)](_0x32c93a(0x76e)); _0x3af0ec['textContent'] = _0x36638b, _0x3af0ec[_0x32c93a(0x203)]('click', () => { const _0x5ccb6b = _0x32c93a; _0x20c67f[_0x5ccb6b(0x9bf)] = _0x8d8b21, _0x48f7a2['classList'][_0x5ccb6b(0x66f)](_0x5ccb6b(0x8d5)); }), _0x548fde[_0x32c93a(0x3d5)](_0x3af0ec); } } } function _0x367a6f() { const _0x3f47dc = _0x43c7a1; if (_0x3f47dc(0x2d9) === _0x3f47dc(0x2d9)) { const _0x64554e = _0x8351ef(_0x128784[_0x3f47dc(0x50e)]); if (!_0x64554e) return; const _0x1136c6 = parseFloat(document[_0x3f47dc(0x655)]('sprite-slider-x')['value']), _0x3336d5 = parseFloat(document['getElementById'](_0x3f47dc(0x6d4))['value']), _0x763bba = parseFloat(document[_0x3f47dc(0x655)](_0x3f47dc(0x825))[_0x3f47dc(0x9bf)]) / 0x64; _0x64554e[_0x3f47dc(0x830)] = { 'x': _0x1136c6, 'y': _0x3336d5, 'scale': _0x763bba }, _0x5eb81f(), _0x420e01('哼，就按你说的办好了。'), _0xb2c66a(!![]); } else { if (_0x49ebb0[_0x3f47dc(0x36c)] === 0x0) return; _0x1daa4d = (_0x32bcc4 + 0x1) % _0x28a1b7['length'], _0x3ee832(_0x1fd373[_0x3e5dd0], _0x2743e8); } } function _0x512710() { const _0x38aa08 = _0x43c7a1; _0x17d4de(_0x38aa08(0x2f5))['then'](_0xca6f42 => { const _0x4486b6 = _0x38aa08; if (_0x4486b6(0x5ad) !== _0x4486b6(0x97a)) { if (_0xca6f42) { const _0x1b0168 = _0x8351ef(_0x128784['activeMeetingCharId']); if (_0x1b0168) { if (_0x4486b6(0x376) !== _0x4486b6(0x851)) delete _0x1b0168[_0x4486b6(0x830)], _0x5eb81f(), _0x527267(_0x1b0168['id'], 'normal'), _0x420e01(_0x4486b6(0x364)), _0xb2c66a(!![]); else { if (typeof _0x599617 === _0x4486b6(0x7d9)) _0x33202a[_0x4486b6(0x1e5)](_0x304bd2); } } } } else _0x49c4ed[_0x591bf9]['classList'][_0x4486b6(0x66f)](_0x4486b6(0x1a2)), _0x39e196[_0x602b69][_0x4486b6(0x9bf)] = ''; }); } function _0x351871() { const _0x5417c9 = _0x43c7a1; if (!_0x1a2fb4) return; const _0x57e006 = _0x128784['activeMeetingCharId'], _0xdd5d8f = _0x8351ef(_0x57e006); if (!_0xdd5d8f) return; const _0x375d93 = parseFloat(document['getElementById'](_0x5417c9(0x6ea))['value']), _0x38521 = parseFloat(document[_0x5417c9(0x655)](_0x5417c9(0x6d4))[_0x5417c9(0x9bf)]), _0x455e97 = parseFloat(document['getElementById'](_0x5417c9(0x825))[_0x5417c9(0x9bf)]) / 0x64; _0xdd5d8f[_0x5417c9(0x830)] = { 'x': _0x375d93, 'y': _0x38521, 'scale': _0x455e97 }; const _0x3abadc = document[_0x5417c9(0x655)]('galgame-sprite-container'), _0x1632bd = 0x50 * _0x455e97; _0x3abadc[_0x5417c9(0x385)][_0x5417c9(0x860)] = _0x1632bd + '%', _0x3abadc[_0x5417c9(0x385)][_0x5417c9(0x19b)] = _0x1632bd + '%', _0x3abadc[_0x5417c9(0x385)][_0x5417c9(0x2b1)] = _0x375d93 + '%', _0x3abadc[_0x5417c9(0x385)]['top'] = _0x38521 + '%', _0x3abadc[_0x5417c9(0x385)][_0x5417c9(0x2c7)] = 'translate(-50%,\x20-100%)'; } document[_0x43c7a1(0x655)](_0x43c7a1(0x6ea))[_0x43c7a1(0x203)](_0x43c7a1(0x2cb), _0x351871), document[_0x43c7a1(0x655)](_0x43c7a1(0x6d4))['addEventListener']('input', _0x351871), document[_0x43c7a1(0x655)]('sprite-slider-scale')[_0x43c7a1(0x203)]('input', _0x351871), _0xee520[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x5e7908), _0x3e11c7[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x367a6f), _0xf3c636[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => _0xb2c66a(![])), _0x38de26[_0x43c7a1(0x203)]('click', _0x512710); function _0x2fd3ae(_0x45d19d) { const _0x25f956 = _0x43c7a1, _0x48d599 = _0x8351ef(_0x45d19d); if (!_0x48d599) return; const _0x2861b1 = _0x128784['chats'][_0x25f956(0x787)](_0x2a71ec => _0x2a71ec[_0x25f956(0x3b1)] === _0x25f956(0x921) && _0x2a71ec[_0x25f956(0x4de)][_0x25f956(0x9ac)](_0x45d19d)), _0xffb755 = _0x10af56(_0x2861b1['id']), _0x129fc6 = _0x128784[_0x25f956(0x6e7)]['filter'](_0x13ecd6 => _0x13ecd6['isOffline'])['pop'](), _0x4c60ce = document[_0x25f956(0x655)](_0x25f956(0x631)), _0x12964d = document[_0x25f956(0x655)](_0x25f956(0x91b)); let _0x1983be = null; if (_0x129fc6) { if (_0x25f956(0x2f9) === 'XbNgX') { _0x5907cd = _0x4be658(); const _0x2bb357 = _0x40ba83[_0x25f956(0x655)](_0x25f956(0x3f2))['textContent']; _0x2c2a86 = _0x2bb357 || _0x25f956(0x4eb); } else { if (_0x129fc6[_0x25f956(0x4c9)] === 'assistant') { if (_0x25f956(0x577) === _0x25f956(0x507)) return _0x1d1c6b['substring'](_0x2431ab, _0x25420d + 0x1); else { const _0x1859ea = _0x128784['characterLastScripts'][_0x45d19d]; _0x1859ea && _0x1859ea[_0x25f956(0x36c)] > 0x0 && (_0x1983be = _0x1859ea['at'](-0x1)); } } else { if (_0x25f956(0x559) !== _0x25f956(0x35b)) _0x1983be = { 'speaker': _0xffb755['name'], 'line': _0x129fc6['content'], 'emotion': _0x25f956(0x850) }; else { if (_0x3012ba[_0x25f956(0x4da)] !== _0x25f956(0x349)) { _0x2c4823['error']('生成失败:\x20', _0x35b93a); const _0x281f38 = { 'role': 'assistant', 'content': _0x25f956(0x36a) + _0x5a4d97['message'], 'senderId': _0x2f8e95['id'], 'isOffline': _0x243a66 }; _0x2a2daa[_0x25f956(0x6e7)][_0x25f956(0x1e5)](_0x281f38), _0x20a610(); } return ![]; } } } } if (_0x1983be) _0x4c60ce[_0x25f956(0x68f)] = _0x1983be[_0x25f956(0x555)] === _0x25f956(0x71b) ? '旁白' : _0x1983be[_0x25f956(0x555)], _0x12964d[_0x25f956(0x68f)] = _0x1983be[_0x25f956(0x91c)], _0x1983be[_0x25f956(0x555)] === _0x48d599['name'] ? _0x25f956(0x8ac) === _0x25f956(0x8ac) ? _0x527267(_0x45d19d, _0x1983be[_0x25f956(0x5eb)]) : (_0x4f4634(![]), _0x4c899b[_0x25f956(0x2d7)] = ![]) : _0x25f956(0x6a0) !== _0x25f956(0x1b6) ? _0x527267(_0x45d19d, 'normal') : (_0x307698[_0x25f956(0x385)][_0x25f956(0x59b)] = _0x29ac5f[_0x25f956(0x59b)] + '%', _0x43a30a[_0x25f956(0x385)]['left'] = _0x27d243[_0x25f956(0x2b1)] + '%'); else { if (_0x25f956(0x821) === _0x25f956(0x84e)) { const _0x475420 = _0x5cabf5[_0x25f956(0x9bf)]; _0x9b3216['documentElement'][_0x25f956(0x385)][_0x25f956(0x6ac)]('--primary-lightness', _0x475420 + '%'), _0x307eeb[_0x25f956(0x548)](_0x25f956(0x6dc), _0x475420), _0x541067(); } else _0x4c60ce[_0x25f956(0x68f)] = _0x48d599[_0x25f956(0x4da)], _0x12964d['textContent'] = _0x25f956(0x442), _0x527267(_0x45d19d, _0x25f956(0x850)); } } function _0x4aee70() { const _0x1b566b = _0x43c7a1, _0x53dbf9 = new Date(), _0x169796 = document[_0x1b566b(0x655)]('galgame-time'), _0x1078c1 = document['getElementById'](_0x1b566b(0x7bc)); if (_0x169796 && _0x1078c1) { if (_0x1b566b(0x1fe) === _0x1b566b(0x1fe)) { const _0x1c0fd7 = String(_0x53dbf9[_0x1b566b(0x838)]())['padStart'](0x2, '0'), _0x207396 = String(_0x53dbf9['getMinutes']())[_0x1b566b(0x7d2)](0x2, '0'); _0x169796[_0x1b566b(0x68f)] = _0x1c0fd7 + ':' + _0x207396; const _0x5f56c8 = _0x53dbf9[_0x1b566b(0x909)]() + 0x1, _0x409c59 = _0x53dbf9[_0x1b566b(0x731)](), _0x3bc27e = [_0x1b566b(0x2b7), _0x1b566b(0x3b2), _0x1b566b(0x372), _0x1b566b(0x46b), _0x1b566b(0x24d), '星期五', _0x1b566b(0x6e0)][_0x53dbf9[_0x1b566b(0x4b5)]()]; _0x1078c1[_0x1b566b(0x68f)] = _0x5f56c8 + '月' + _0x409c59 + '日\x20' + _0x3bc27e; } else { _0x3ccf58(_0x1b566b(0x359)); return; } } } const _0x25dbd8 = document[_0x43c7a1(0x655)]('listen-together-modal'), _0x35b898 = document[_0x43c7a1(0x655)](_0x43c7a1(0x6a9)), _0x345b7d = document[_0x43c7a1(0x655)]('cancel-listen-together'), _0x28dbee = document[_0x43c7a1(0x655)](_0x43c7a1(0x1b4)), _0x5e0f1b = document[_0x43c7a1(0x655)]('listen-together-song-list'), _0x70f69b = document[_0x43c7a1(0x655)](_0x43c7a1(0x754)), _0x569b1c = document['getElementById'](_0x43c7a1(0x988)), _0x10f9db = document['getElementById'](_0x43c7a1(0x59c)), _0x2ed9ea = document[_0x43c7a1(0x655)]('lt-ui-lyrics-container'); let _0x1a89c5 = []; async function _0x29675b() { const _0x20f5df = _0x43c7a1; if (!_0x128784['activeChatId']) return; _0x5e0f1b[_0x20f5df(0x711)] = _0x20f5df(0x707), _0x25dbd8[_0x20f5df(0x421)][_0x20f5df(0x266)]('show'); const _0xb7c7d7 = await _0x5ab4ac(); if (_0xb7c7d7[_0x20f5df(0x36c)] === 0x0) { if (_0x20f5df(0x7f6) !== _0x20f5df(0x7f6)) _0x47e891[_0x20f5df(0x3b1)] = _0x20f5df(0x2b9), _0x2f0481[_0x20f5df(0x7d8)](_0x623a67, _0x3965b6); else { _0x5e0f1b[_0x20f5df(0x711)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>'; return; } } _0x5e0f1b[_0x20f5df(0x711)] = '', _0xb7c7d7[_0x20f5df(0x4d0)](_0x4a5452 => { const _0x256c75 = _0x20f5df, _0x19efa0 = document[_0x256c75(0x26b)](_0x256c75(0x76e)); _0x19efa0[_0x256c75(0x1f0)] = _0x256c75(0x3dd); const _0x4221fa = _0x4a5452[_0x256c75(0x678)] ? URL[_0x256c75(0x9be)](_0x4a5452[_0x256c75(0x678)]) : _0x3834ec; _0x19efa0[_0x256c75(0x711)] = _0x256c75(0x371) + _0x4221fa + _0x256c75(0x716) + (_0x4a5452[_0x256c75(0x889)][_0x256c75(0x730)] || _0x256c75(0x219)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>' + (_0x4a5452[_0x256c75(0x889)]['歌手'] || _0x256c75(0x3fb)) + _0x256c75(0x491), _0x19efa0[_0x256c75(0x203)](_0x256c75(0x783), () => { const _0x4c2c17 = _0x256c75; 'ubaem' !== 'ubaem' ? (_0x228e65[_0x4c2c17(0x9de)](_0x4c2c17(0x25e), _0x3ab815), _0x5a571e({ 'role': _0x4c2c17(0x600), 'content': _0x4c2c17(0x36a) + _0x1b2f29[_0x4c2c17(0x740)] }, _0x48b685[_0x4c2c17(0x6e7)][_0x4c2c17(0x36c)] - 0x1)) : _0x38166b(_0x4a5452); }), _0x5e0f1b[_0x256c75(0x3d5)](_0x19efa0); }); } function _0xcdb1() { const _0x2e6ab8 = _0x43c7a1; _0x25dbd8[_0x2e6ab8(0x421)][_0x2e6ab8(0x66f)](_0x2e6ab8(0x8d5)); } async function _0x38166b(_0x37b719) { const _0x4eaea3 = _0x43c7a1; if ('ZEzFs' !== _0x4eaea3(0x56b)) { if (!_0x128784[_0x4eaea3(0x789)] || !_0x37b719) return; let _0x53e4c0 = null; if (_0x37b719[_0x4eaea3(0x678)]) { if ('luAwt' === _0x4eaea3(0x1ea)) try { _0x53e4c0 = _0x4eaea3(0x72f) + Date[_0x4eaea3(0x8a2)]() + '_' + Math[_0x4eaea3(0x1c0)](), await _0x36c0a8(_0x53e4c0, _0x37b719['cover']); } catch (_0x13aa3b) { console[_0x4eaea3(0x9de)]('在“一起听”邀请中，净化封面失败:', _0x13aa3b); } else _0xc8780b(_0x4eaea3(0x59e) + _0x2a5581[_0x4eaea3(0x740)]); } const _0x1880a7 = { 'role': _0x4eaea3(0x500), 'type': _0x4eaea3(0x39a), 'content': _0x4eaea3(0x2c0) + _0x37b719['info']['歌曲名称'] + ']', 'songId': _0x37b719['id'], 'songName': _0x37b719[_0x4eaea3(0x889)][_0x4eaea3(0x730)], 'artist': _0x37b719[_0x4eaea3(0x889)]['歌手'], 'coverId': _0x53e4c0, 'timestamp': Date[_0x4eaea3(0x8a2)]() }; _0x128784[_0x4eaea3(0x6e7)][_0x4eaea3(0x1e5)](_0x1880a7), _0x1313e9(), _0x19de4f(), _0xcdb1(), setTimeout(_0xf949f2, 0x64); } else _0x5c13bd[_0x4eaea3(0x3b7)](), _0x4b5501[_0x4eaea3(0x421)][_0x4eaea3(0x34f)](_0x4eaea3(0x7eb)), _0x36add1[_0x4eaea3(0x421)][_0x4eaea3(0x34f)](_0x4eaea3(0x484)); } _0x35b898[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0x29675b), _0x345b7d[_0x43c7a1(0x203)](_0x43c7a1(0x783), _0xcdb1), _0x28dbee['addEventListener'](_0x43c7a1(0x783), _0xcdb1); async function _0x2a92e1(_0x40bcc4, _0x55ad57, _0x11cf53) { const _0x5abe99 = _0x43c7a1; if ('puMwp' !== _0x5abe99(0x640)) return new _0x3f55ed((_0x4d2762, _0x2d5b2a) => { const _0x428ac5 = _0x5abe99, _0x176b5b = new _0x4bca38(); _0x176b5b[_0x428ac5(0x3f3)] = () => _0x4d2762(_0x176b5b['result']), _0x176b5b[_0x428ac5(0x9a7)] = _0x2d5b2a, _0x176b5b[_0x428ac5(0x797)](_0x6cc6b7); }); else { const _0x204de5 = _0x128784['chats']['find'](_0x2cd73d => _0x2cd73d[_0x5abe99(0x8a0)] && _0x2cd73d[_0x5abe99(0x8a0)][_0x5abe99(0x88d)]), _0x2e0f0a = _0x401cc7(); if (_0x204de5 && _0x204de5['id'] !== _0x2e0f0a['id']) _0x204de5[_0x5abe99(0x8a0)] = null, _0x420e01(_0x5abe99(0x932)), _0x5eb81f(); else _0x204de5 && _0x204de5['id'] === _0x2e0f0a['id'] && (_0x5abe99(0x959) === _0x5abe99(0x437) ? _0x18b4e0 = _0x553ce3(_0x465fa8['participantIds'][0x0]) : _0x420e01(_0x5abe99(0x636))); _0xddfd1b(!![], _0x5abe99(0x23b)); if (!_0x2e0f0a) { _0xddfd1b(![]), _0x420e01('错误：找不到签署契约的地方。'); return; } const _0x2b1117 = await _0x298b0c(_0x40bcc4); if (!_0x2b1117) { _0xddfd1b(![]), _0x420e01(_0x5abe99(0x319)); return; } _0x2e0f0a[_0x5abe99(0x8a0)] = { 'isActive': !![], 'songId': _0x40bcc4, 'leaderId': _0x5abe99(0x500), 'songName': _0x2b1117[_0x5abe99(0x889)][_0x5abe99(0x730)], 'artist': _0x2b1117[_0x5abe99(0x889)]['歌手'], 'cover': _0x2b1117[_0x5abe99(0x678)] }, _0x5eb81f(), document[_0x5abe99(0x655)](_0x5abe99(0x57e))['src'] = _0x2b1117[_0x5abe99(0x678)] ? URL['createObjectURL'](_0x2b1117[_0x5abe99(0x678)]) : _0x3834ec, document[_0x5abe99(0x655)]('lt-ui-song-title')[_0x5abe99(0x68f)] = _0x2b1117['info'][_0x5abe99(0x730)], document[_0x5abe99(0x655)](_0x5abe99(0x635))[_0x5abe99(0x68f)] = _0x2b1117[_0x5abe99(0x889)]['歌手'], _0x3723a2(_0x2b1117), _0x569b1c[_0x5abe99(0x385)][_0x5abe99(0x1cd)] = _0x5abe99(0x4d4), setTimeout(() => _0x569b1c[_0x5abe99(0x421)][_0x5abe99(0x266)](_0x5abe99(0x8d5)), 0xa), _0x11cf53[_0x5abe99(0x711)] = _0x5abe99(0x1ef) + _0x11cf53['querySelector'](_0x5abe99(0x713))['outerHTML'], _0x128784[_0x5abe99(0x6e7)][_0x55ad57] && (_0x128784['conversationHistory'][_0x55ad57][_0x5abe99(0x6bb)] = !![], _0x1313e9()), _0xddfd1b(![]), _0x31261e(_0x40bcc4, [_0x40bcc4]), _0x1ab08d(_0x2b1117, !![]); } } function _0x25342c() { const _0x202ac8 = _0x43c7a1, _0x37fd17 = _0x128784[_0x202ac8(0x295)]['find'](_0x5aa1bc => _0x5aa1bc[_0x202ac8(0x8a0)] && _0x5aa1bc['activeListenSession'][_0x202ac8(0x88d)]); _0x37fd17 && (_0x202ac8(0x246) !== _0x202ac8(0x246) ? _0x666a2a = { 'speaker': _0x31433a[_0x202ac8(0x4da)], 'line': _0x1c5c8e[_0x202ac8(0x472)], 'emotion': 'normal' } : (_0x37fd17['activeListenSession'] = null, _0x5eb81f(), _0x420e01(_0x202ac8(0x41b)), _0x1ab08d(), _0x569b1c[_0x202ac8(0x421)]['remove'](_0x202ac8(0x8d5)), setTimeout(() => _0x569b1c[_0x202ac8(0x385)][_0x202ac8(0x1cd)] = 'none', 0x12c))); } function _0x2a3526(_0x5da9c5) { const _0x4a3a45 = _0x43c7a1; if ('WYuWn' === _0x4a3a45(0x42d)) { if (!_0x5da9c5) return []; const _0x48cb94 = _0x5da9c5[_0x4a3a45(0x7c7)]('\x0a'), _0x1b726d = [], _0x42dba0 = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x5c972b of _0x48cb94) { const _0x463480 = _0x5c972b['match'](_0x42dba0); if (_0x463480) { const _0x23b66a = parseInt(_0x463480[0x1], 0xa), _0x47c533 = parseInt(_0x463480[0x2], 0xa), _0x1ba153 = parseInt(_0x463480[0x3], 0xa) * (_0x463480[0x3]['length'] === 0x2 ? 0xa : 0x1), _0x838326 = _0x23b66a * 0x3c + _0x47c533 + _0x1ba153 / 0x3e8, _0x46254b = _0x5c972b['replace'](_0x42dba0, '')[_0x4a3a45(0x6df)](); _0x46254b && _0x1b726d[_0x4a3a45(0x1e5)]({ 'time': _0x838326, 'text': _0x46254b }); } } return _0x1b726d; } else _0x1506d2['type'] = _0x4a3a45(0x64b); } function _0x3723a2(_0x496ddf) { const _0x40fd47 = _0x43c7a1; _0x1a89c5 = _0x2a3526(_0x496ddf[_0x40fd47(0x35f)]), _0x2ed9ea[_0x40fd47(0x711)] = ''; if (_0x1a89c5[_0x40fd47(0x36c)] === 0x0) { _0x2ed9ea[_0x40fd47(0x711)] = _0x40fd47(0x8e1); return; } _0x1a89c5[_0x40fd47(0x4d0)]((_0x45f748, _0x2dad99) => { const _0x1424b1 = _0x40fd47, _0x10be83 = document[_0x1424b1(0x26b)]('p'); _0x10be83[_0x1424b1(0x68f)] = _0x45f748[_0x1424b1(0x64b)], _0x10be83['id'] = _0x1424b1(0x30f) + _0x2dad99, _0x2ed9ea[_0x1424b1(0x3d5)](_0x10be83); }); } function _0x40470b(_0x3973b1, _0x10c710, _0x7d6c2e, _0x129b51) { const _0x3953e6 = _0x43c7a1; if ('LrUuz' !== _0x3953e6(0x854)) { const _0x380a04 = (_0x129b51 - 0x5a) * Math['PI'] / 0xb4; return { 'x': _0x3973b1 + _0x7d6c2e * Math[_0x3953e6(0x330)](_0x380a04), 'y': _0x10c710 + _0x7d6c2e * Math[_0x3953e6(0x38c)](_0x380a04) }; } else _0x2f5a73[_0x3953e6(0x789)] = _0xf8c67c['chats'][0x0]?.['id'] || null, _0x13d9b0(_0x43b445['activeChatId']); } function _0x3ca1f7(_0x4dd035) { const _0x1773ad = _0x43c7a1, _0x47b25a = _0x1773ad(0x4dd), _0x5630b8 = document[_0x1773ad(0x957)](_0x47b25a, _0x1773ad(0x271)), _0x56e7c5 = 0xfa, _0x154fe9 = _0x56e7c5 / 0x2, _0x43fe97 = _0x56e7c5 / 0x2, _0x28d303 = _0x56e7c5 / 0x2 - 0x14; _0x5630b8['setAttribute'](_0x1773ad(0x19b), _0x1773ad(0x7bf)), _0x5630b8[_0x1773ad(0x6a7)](_0x1773ad(0x860), '100%'), _0x5630b8[_0x1773ad(0x6a7)](_0x1773ad(0x616), _0x1773ad(0x4ed) + _0x56e7c5 + '\x20' + _0x56e7c5); const _0x53b956 = Object['values'](_0x4dd035)['reduce']((_0x330c37, _0x412d2e) => _0x330c37 + _0x412d2e, 0x0); if (_0x53b956 === 0x0) return _0x5630b8; let _0x135c48 = -0x5a; const _0x15f159 = [_0x1773ad(0x54d), _0x1773ad(0x1e6), _0x1773ad(0x4cb), _0x1773ad(0x9ba), _0x1773ad(0x384), _0x1773ad(0x460), '#a4c2f4', _0x1773ad(0x82c)]; let _0x5a4b8b = 0x0; for (const _0x7fc0b in _0x4dd035) { if (_0x1773ad(0x887) === _0x1773ad(0x887)) { const _0x58cfef = _0x4dd035[_0x7fc0b]; if (_0x58cfef <= 0x0) continue; const _0x1f1cca = _0x58cfef / _0x53b956 * 0x168, _0x530713 = _0x135c48 + _0x1f1cca, _0xb224e5 = _0x40470b(_0x154fe9, _0x43fe97, _0x28d303, _0x530713), _0x26f3cb = _0x40470b(_0x154fe9, _0x43fe97, _0x28d303, _0x135c48), _0x2f1a17 = _0x1f1cca > 0xb4 ? '1' : '0', _0x160bd1 = ['M', _0xb224e5['x'], _0xb224e5['y'], 'A', _0x28d303, _0x28d303, 0x0, _0x2f1a17, 0x1, _0x26f3cb['x'], _0x26f3cb['y'], 'L', _0x154fe9, _0x43fe97, 'Z'][_0x1773ad(0x9cc)]('\x20'), _0x39f0f9 = document['createElementNS'](_0x47b25a, _0x1773ad(0x5d2)); _0x39f0f9[_0x1773ad(0x6a7)]('d', _0x160bd1), _0x39f0f9['setAttribute'](_0x1773ad(0x4fc), _0x15f159[_0x5a4b8b % _0x15f159[_0x1773ad(0x36c)]]), _0x5a4b8b++; const _0x185325 = document[_0x1773ad(0x957)](_0x47b25a, _0x1773ad(0x38f)); _0x185325[_0x1773ad(0x68f)] = _0x7fc0b + ':\x20' + _0x58cfef[_0x1773ad(0x8bd)](0x2) + '\x20(' + (_0x58cfef / _0x53b956 * 0x64)[_0x1773ad(0x8bd)](0x1) + '%)', _0x39f0f9[_0x1773ad(0x3d5)](_0x185325), _0x5630b8[_0x1773ad(0x3d5)](_0x39f0f9), _0x135c48 = _0x530713; } else _0x9400ff[_0x1773ad(0x3b1)] === _0x1773ad(0x6a4) && (_0x4306f8[_0x1773ad(0x4de)] = _0x41a95d[_0x1773ad(0x4de)][_0x1773ad(0x89c)](_0x3e45c0 => _0x3e45c0 !== _0xecb2ca)); } return _0x5630b8; } function _0x214185() { const _0x38e9bc = _0x43c7a1; if (_0x38e9bc(0x88c) === _0x38e9bc(0x76d)) _0x4d7590 = _0x38e9bc(0x4db), _0x2073f0 = _0x38e9bc(0x594); else { if (_0x1a89c5['length'] === 0x0) return; const _0x5d657c = _0x70f69b[_0x38e9bc(0x863)]; let _0x1d12a9 = -0x1; for (let _0x7078bd = 0x0; _0x7078bd < _0x1a89c5[_0x38e9bc(0x36c)]; _0x7078bd++) { if (_0x38e9bc(0x4e9) !== _0x38e9bc(0x4e9)) _0x2ce39f = _0x38e9bc(0x970); else { if (_0x5d657c >= _0x1a89c5[_0x7078bd][_0x38e9bc(0x86c)]) { if (_0x38e9bc(0x6fd) === 'xdwVv') _0x1d12a9 = _0x7078bd; else { const _0x533a6c = _0x46e248['participantIds'][0x0]; _0x5a68db[_0x38e9bc(0x421)][_0x38e9bc(0x266)](_0x38e9bc(0x518) + _0x533a6c); } } else { if (_0x38e9bc(0x78b) === _0x38e9bc(0x418)) _0x2427c2(_0x4efce0['id']), _0x181e1f(_0x38e9bc(0x6cb)), _0x324570(_0x38e9bc(0x866)), _0x251d47(![]); else break; } } } if (_0x1d12a9 !== -0x1) { const _0x319a65 = _0x2ed9ea[_0x38e9bc(0x49d)]('p'); _0x319a65[_0x38e9bc(0x4d0)](_0x5ccb32 => _0x5ccb32[_0x38e9bc(0x421)][_0x38e9bc(0x66f)](_0x38e9bc(0x576))); const _0x192693 = document[_0x38e9bc(0x655)](_0x38e9bc(0x30f) + _0x1d12a9); _0x192693 && (_0x192693['classList'][_0x38e9bc(0x266)](_0x38e9bc(0x576)), _0x192693[_0x38e9bc(0x478)]({ 'behavior': 'smooth', 'block': _0x38e9bc(0x4cf) })); } } } _0x10f9db['addEventListener'](_0x43c7a1(0x783), () => { const _0xe7f1c9 = _0x43c7a1; _0xe7f1c9(0x9d8) !== _0xe7f1c9(0x8ab) ? (_0x569b1c[_0xe7f1c9(0x421)][_0xe7f1c9(0x66f)](_0xe7f1c9(0x8d5)), setTimeout(() => _0x569b1c['style']['display'] = _0xe7f1c9(0x44e), 0x12c)) : _0x24452a[_0xe7f1c9(0x4de)] = _0x552717[_0xe7f1c9(0x4de)][_0xe7f1c9(0x89c)](_0x10414b => _0x10414b !== _0x38f43f); }), document[_0x43c7a1(0x655)](_0x43c7a1(0x951))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x173d93 = _0x43c7a1; _0x173d93(0x409) === _0x173d93(0x409) ? _0x128784[_0x173d93(0x6b3)] && _0x128784[_0x173d93(0x6b3)][_0x173d93(0x88d)] && (_0x569b1c[_0x173d93(0x385)][_0x173d93(0x1cd)] = _0x173d93(0x4d4), setTimeout(() => _0x569b1c[_0x173d93(0x421)][_0x173d93(0x266)](_0x173d93(0x8d5)), 0xa)) : (_0x4e3526 = _0x57dcd7[_0x173d93(0x26b)](_0x173d93(0x76e)), _0x260706['id'] = 'feed-loader', _0x626565[_0x173d93(0x3d5)](_0x25bab9)); }), _0x70f69b[_0x43c7a1(0x203)](_0x43c7a1(0x4bd), _0x214185); const _0x5acb02 = document['getElementById'](_0x43c7a1(0x724)), _0x2e7d91 = document[_0x43c7a1(0x655)](_0x43c7a1(0x193)), _0x2bdff = document['getElementById'](_0x43c7a1(0x4af)); _0x5acb02[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x3ff551 = _0x43c7a1; _0x70f69b[_0x3ff551(0x84a)] && (_0x70f69b['paused'] ? _0x3ff551(0x5ed) === 'mdhtN' ? _0x70f69b[_0x3ff551(0x244)]() : (_0xd2dd94[_0x3ff551(0x8a0)] = null, _0x27cfc1(_0x3ff551(0x932)), _0x2dc957()) : _0x3ff551(0x963) === _0x3ff551(0x963) ? _0x70f69b[_0x3ff551(0x753)]() : _0x1a0a2c[_0x3ff551(0x548)](_0x3ff551(0x25f) + _0x540179[_0x3ff551(0x789)], _0x167521[_0x3ff551(0x5e0)](_0x251147[_0x3ff551(0x6e7)]))); }), _0x2e7d91[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x4f87f9 = _0x43c7a1; if (_0x25eb66[_0x4f87f9(0x36c)] === 0x0) return; _0xe601b4 = (_0xe601b4 + 0x1) % _0x25eb66[_0x4f87f9(0x36c)], _0x31261e(_0x25eb66[_0xe601b4], _0x25eb66); }), _0x2bdff[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x4af471 = _0x43c7a1; if (_0x25eb66[_0x4af471(0x36c)] === 0x0) return; _0xe601b4 = (_0xe601b4 - 0x1 + _0x25eb66[_0x4af471(0x36c)]) % _0x25eb66[_0x4af471(0x36c)], _0x31261e(_0x25eb66[_0xe601b4], _0x25eb66); }), _0x70f69b[_0x43c7a1(0x203)](_0x43c7a1(0x244), () => { const _0x43aaa0 = _0x43c7a1; _0x5acb02[_0x43aaa0(0x68f)] = '❚❚'; }), _0x70f69b[_0x43c7a1(0x203)](_0x43c7a1(0x753), () => { const _0x4d57ca = _0x43c7a1; _0x5acb02[_0x4d57ca(0x68f)] = '▶'; }), _0x70f69b['addEventListener'](_0x43c7a1(0x2e9), () => { const _0x47c8f5 = _0x43c7a1; _0x47c8f5(0x4ee) === _0x47c8f5(0x4ee) ? _0x2e7d91[_0x47c8f5(0x783)]() : _0x26d01a('错误:\x20' + _0x3a0483[_0x47c8f5(0x740)]); }), _0x70f69b[_0x43c7a1(0x203)]('play', () => { const _0x570414 = _0x43c7a1, _0x36bc0d = document[_0x570414(0x655)]('global-player-play-pause-btn'); if (_0x36bc0d) _0x36bc0d['textContent'] = '❚❚'; }), _0x70f69b[_0x43c7a1(0x203)](_0x43c7a1(0x753), () => { const _0xe864b4 = _0x43c7a1; if ('ikdlx' === _0xe864b4(0x7c1)) { const _0x55eceb = document['getElementById'](_0xe864b4(0x950)); if (_0x55eceb) _0x55eceb[_0xe864b4(0x68f)] = '▶'; } else _0xf239e9[_0xe864b4(0x8a0)] = null, _0x5d5ff5(), _0x169ef9('同步已断开。'), _0x1005aa(), _0x5583f5[_0xe864b4(0x421)][_0xe864b4(0x66f)](_0xe864b4(0x8d5)), _0x8aaeb8(() => _0x23afae[_0xe864b4(0x385)][_0xe864b4(0x1cd)] = 'none', 0x12c); }), _0x70f69b['addEventListener'](_0x43c7a1(0x2e9), () => { const _0x2b9e69 = _0x43c7a1, _0x295bfe = document[_0x2b9e69(0x655)]('global-player-next-btn'); if (_0x295bfe) { if (_0x2b9e69(0x791) === 'ZgweL') { _0x873731[_0x2b9e69(0x5df)] = [..._0x53e12e]; const _0x5e52bc = _0x28f5f9[_0x2b9e69(0x5df)]['shift'](); _0x3b2f76[_0x2b9e69(0x68f)] = _0x5e52bc[_0x2b9e69(0x555)] === _0x2b9e69(0x71b) ? '旁白' : _0x5e52bc[_0x2b9e69(0x555)], _0x1b048d[_0x2b9e69(0x68f)] = _0x5e52bc[_0x2b9e69(0x91c)], _0x5e52bc['speaker'] !== 'narrator' && _0x21cbb5(_0x2909ea['activeMeetingCharId'], _0x5e52bc[_0x2b9e69(0x5eb)]); } else _0x295bfe[_0x2b9e69(0x783)](); } }); function _0x33c7d8(_0x584038) { const _0x42603c = _0x43c7a1; if (!_0x584038 || typeof _0x584038 !== _0x42603c(0x7d9)) return null; const _0x7dfa51 = _0x584038[_0x42603c(0x439)]('['), _0x76f7c1 = _0x584038[_0x42603c(0x9ae)](']'); if (_0x7dfa51 > -0x1 && _0x76f7c1 > _0x7dfa51) { if (_0x42603c(0x5ff) !== 'YXYEL') return _0x584038[_0x42603c(0x810)](_0x7dfa51, _0x76f7c1 + 0x1); else _0x219f36(_0x42603c(0x96e)); } return null; } document[_0x43c7a1(0x655)](_0x43c7a1(0x702))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x4f96d0 = _0x43c7a1; if (_0x4f96d0(0x756) === _0x4f96d0(0x756)) _0x2f6a46(), _0xcf54be(_0x4f96d0(0x5dc), _0x4f96d0(0x7e1)); else { const _0x2934e7 = _0x33c1dc[_0x4f96d0(0x26b)]('p'); _0x2934e7[_0x4f96d0(0x385)][_0x4f96d0(0x3d0)] = '5px', _0x2934e7[_0x4f96d0(0x68f)] = _0x3e0a20, _0x1eea88[_0x4f96d0(0x3d5)](_0x2934e7); } }), document['getElementById']('back-to-home-from-accounting')[_0x43c7a1(0x203)]('click', () => _0xcf54be(_0x43c7a1(0x7e1), _0x43c7a1(0x5dc))); const _0x468d40 = document['getElementById'](_0x43c7a1(0x6cc)), _0x158053 = document[_0x43c7a1(0x655)]('tab-view-ledger'); _0x468d40['addEventListener']('click', _0x2f6a46), _0x158053[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x2771a6 = _0x43c7a1; if (_0x2771a6(0x455) === _0x2771a6(0x2d8)) { const _0x4c8ecd = _0x14d0a2[_0x2771a6(0x7a8)](_0x5f0597); _0x590795[_0x2771a6(0x79f)](_0x4c8ecd) && (_0x41c8d6[_0x2771a6(0x9bf)] = _0x4c8ecd['map'](_0x4a128 => _0x4a128[_0x2771a6(0x4da)] + '--' + _0x4a128[_0x2771a6(0x237)])[_0x2771a6(0x9cc)]('\x0a')); } else _0x468d40[_0x2771a6(0x421)][_0x2771a6(0x66f)](_0x2771a6(0x576)), _0x158053[_0x2771a6(0x421)][_0x2771a6(0x266)](_0x2771a6(0x576)), _0x214e9c(); }); function _0x2f6a46() { const _0x50cbd0 = _0x43c7a1; _0x158053[_0x50cbd0(0x421)][_0x50cbd0(0x66f)](_0x50cbd0(0x576)), _0x468d40[_0x50cbd0(0x421)][_0x50cbd0(0x266)]('active'), _0x362cd2(); } function _0x362cd2() { const _0x49c6e6 = _0x43c7a1, _0x1b3dad = document[_0x49c6e6(0x655)](_0x49c6e6(0x329)); document['getElementById'](_0x49c6e6(0x47a))[_0x49c6e6(0x68f)] = _0x49c6e6(0x8cb), document[_0x49c6e6(0x655)](_0x49c6e6(0x3ac))[_0x49c6e6(0x711)] = '', _0x1b3dad[_0x49c6e6(0x711)] = _0x49c6e6(0x4f7), _0x597928(), document[_0x49c6e6(0x655)]('add-expense-button')['addEventListener']('click', _0x583cef), document[_0x49c6e6(0x655)](_0x49c6e6(0x496))[_0x49c6e6(0x203)](_0x49c6e6(0x783), _0x178448 => { const _0x3e9e5c = _0x49c6e6; if (_0x178448['target'][_0x3e9e5c(0x421)][_0x3e9e5c(0x878)](_0x3e9e5c(0x3c6))) { if ('kTqpj' === _0x3e9e5c(0x24f)) { const _0x663851 = _0x178448[_0x3e9e5c(0x949)][_0x3e9e5c(0x663)]['id']; _0x17d4de(_0x3e9e5c(0x738))['then'](_0x521d85 => { const _0x33bf42 = _0x3e9e5c; if (_0x521d85) { if (_0x33bf42(0x5c2) === _0x33bf42(0x5c2)) _0x3ee6aa(_0x663851); else { if (_0x4e07dd === null) return; const _0x454fe8 = _0x27349e['conversationHistory'][_0x5ddf69]; if (!_0x454fe8) return; _0x2f54f0[_0x33bf42(0x9bf)] = _0x454fe8[_0x33bf42(0x472)], _0x537fd4(), _0x21e11a[_0x33bf42(0x421)]['add'](_0x33bf42(0x8d5)), _0x2fcb0a['focus'](); } } }); } else _0x13825e[_0x3e9e5c(0x9bf)] = _0x379d19[_0x3e9e5c(0x946)](_0x59648b => _0x59648b[_0x3e9e5c(0x4da)] + '--' + _0x59648b[_0x3e9e5c(0x237)])[_0x3e9e5c(0x9cc)]('\x0a'); } }), document[_0x49c6e6(0x655)](_0x49c6e6(0x2b3))['focus'](); } function _0x489d67(_0x57eefe, _0x53c005) { const _0x2f879b = _0x43c7a1, _0x5ee25b = document[_0x2f879b(0x655)](_0x2f879b(0x329)), _0x766d85 = document[_0x2f879b(0x655)](_0x2f879b(0x3ac)); document['getElementById'](_0x2f879b(0x47a))[_0x2f879b(0x68f)] = _0x53c005 + '\x20账单'; const _0x4e62e6 = _0x57eefe[_0x2f879b(0x5a4)][_0x2f879b(0x649)]((_0xd17e0, _0x3f7abd) => _0xd17e0 + (_0x3f7abd['amount'] || 0x0), 0x0); let _0x5eec41 = _0x2f879b(0x77d) + _0x4e62e6[_0x2f879b(0x8bd)](0x2) + _0x2f879b(0x94b); _0x5ee25b[_0x2f879b(0x711)] = _0x5eec41; const _0x20eaac = document['getElementById'](_0x2f879b(0x380)), _0x33ca33 = { '餐饮美食': _0x2f879b(0x580), '交通出行': _0x2f879b(0x1cc), '购物消费': _0x2f879b(0x68e), '生活服务': _0x2f879b(0x508), '休闲娱乐': '<path\x20d=\x22M6\x2012h12\x22></path><path\x20d=\x22M12\x206v12\x22></path><path\x20d=\x22M12\x202a4\x204\x200\x201\x201-4\x204\x22></path><path\x20d=\x22M12\x2022a4\x204\x200\x201\x200\x204-4\x22></path><path\x20d=\x22M22\x2012a4\x204\x200\x201\x200-4-4\x22></path><path\x20d=\x22M2\x2012a4\x204\x200\x201\x201\x204\x204\x22></path>', '医疗健康': _0x2f879b(0x9d7), '人情红包': _0x2f879b(0x5bf), '其他杂项': '<path\x20d=\x22M14.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V7.5L14.5\x202z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline>', '默认': _0x2f879b(0x674) }; _0x57eefe[_0x2f879b(0x5a4)][_0x2f879b(0x4d0)](_0x28c35a => { const _0x504303 = _0x2f879b, _0x22d2ce = document[_0x504303(0x26b)](_0x504303(0x76e)); _0x22d2ce[_0x504303(0x1f0)] = _0x504303(0x1a7), _0x22d2ce['style']['flexDirection'] = _0x504303(0x90d), _0x22d2ce[_0x504303(0x385)][_0x504303(0x4bf)] = 'stretch', _0x22d2ce['style'][_0x504303(0x609)] = _0x504303(0x87d), _0x22d2ce[_0x504303(0x385)]['gap'] = '0'; const _0x2c603e = _0x33ca33[_0x28c35a['category']] || _0x33ca33['默认'], _0x2767ff = _0x504303(0x743) + _0x2c603e + _0x504303(0x4ca), _0x41f36a = _0x504303(0x991) + _0x2767ff + _0x504303(0x7d6) + _0x28c35a[_0x504303(0x78a)] + _0x504303(0x4ae) + (_0x28c35a[_0x504303(0x5ce)] || _0x504303(0x6c9)) + '</div></div></div><span\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x22>-\x20' + (_0x28c35a[_0x504303(0x9d3)] || 0x0)[_0x504303(0x8bd)](0x2) + _0x504303(0x97c); let _0x473e98 = ''; if (_0x28c35a[_0x504303(0x18b)] && _0x28c35a[_0x504303(0x18b)][_0x504303(0x1e7)]) { if (_0x504303(0x749) === _0x504303(0x749)) { const _0x37b029 = _0x8351ef(_0x28c35a[_0x504303(0x18b)][_0x504303(0x1e7)]); _0x37b029 && (_0x504303(0x4e3) !== _0x504303(0x4e3) ? (_0x85f2b5(), _0x58fc3f(_0x504303(0x64f), _0x504303(0x7e1))) : _0x473e98 = _0x504303(0x79c) + _0x37b029[_0x504303(0x4b6)] + _0x504303(0x4c8) + _0x37b029[_0x504303(0x4da)] + '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>' + _0x28c35a[_0x504303(0x18b)]['text'] + _0x504303(0x6c4)); } else { if (!_0x405a47 || !_0x1e0478[_0x504303(0x9ac)](',')) return _0x3f59ba; const _0x4f0aaf = _0x19cff4[_0x504303(0x7c7)](',')[_0x504303(0x946)](_0x82a952 => _0x82a952[_0x504303(0x6df)]()); return _0x4f0aaf[_0x3a47f3[_0x504303(0x2b4)](_0x15e924[_0x504303(0x1c0)]() * _0x4f0aaf[_0x504303(0x36c)])]; } } _0x22d2ce['innerHTML'] = _0x41f36a + _0x473e98, _0x20eaac[_0x504303(0x3d5)](_0x22d2ce); }), _0x766d85[_0x2f879b(0x711)] = _0x2f879b(0x19c), document['getElementById']('re-record-button')[_0x2f879b(0x203)]('click', async () => { const _0x17a3ea = _0x2f879b, _0x1e7651 = await _0x17d4de(_0x17a3ea(0x63a)); if (_0x1e7651) { if (_0x17a3ea(0x180) === _0x17a3ea(0x180)) delete _0x128784[_0x17a3ea(0x4f1)][_0x53c005], _0x5eb81f(), _0x362cd2(); else { const _0x593ea7 = _0x598015[_0x17a3ea(0x655)](_0x17a3ea(0x181)); _0x593ea7 && _0x410682 && (_0x593ea7['src'] = _0x2a5295[_0x17a3ea(0x9be)](_0x4998f3)); } } }); } function _0x214e9c() { const _0x3038aa = _0x43c7a1, _0x1d82e2 = document['getElementById'](_0x3038aa(0x329)); document[_0x3038aa(0x655)](_0x3038aa(0x47a))[_0x3038aa(0x68f)] = '账本', document['getElementById'](_0x3038aa(0x3ac))[_0x3038aa(0x711)] = ''; const _0x6ceceb = Object[_0x3038aa(0x7ae)](_0x128784[_0x3038aa(0x4f1)])['sort']((_0x39c386, _0x257772) => new Date(_0x257772) - new Date(_0x39c386)); if (_0x6ceceb[_0x3038aa(0x36c)] === 0x0) { _0x1d82e2[_0x3038aa(0x711)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的账本还是空白的。</p>'; return; } _0x1d82e2['innerHTML'] = '', _0x6ceceb[_0x3038aa(0x4d0)](_0x24cf36 => { const _0x448ae9 = _0x3038aa; if (_0x448ae9(0x4d7) === 'VClRV') { const _0xb0645 = document[_0x448ae9(0x26b)](_0x448ae9(0x76e)); _0xb0645['className'] = _0x448ae9(0x1a7), _0xb0645[_0x448ae9(0x385)]['cursor'] = _0x448ae9(0x565); const _0x3700af = _0x128784['accountingLedger'][_0x24cf36], _0x15f150 = _0x3700af[_0x448ae9(0x5a4)][_0x448ae9(0x649)]((_0xfb2c6d, _0x2943c3) => _0xfb2c6d + (_0x2943c3['amount'] || 0x0), 0x0); _0xb0645[_0x448ae9(0x711)] = _0x448ae9(0x66a) + _0x24cf36 + _0x448ae9(0x629) + _0x15f150['toFixed'](0x2) + _0x448ae9(0x516), _0xb0645[_0x448ae9(0x203)]('click', () => { const _0x3b8194 = _0x448ae9; _0x468d40[_0x3b8194(0x421)][_0x3b8194(0x66f)](_0x3b8194(0x576)), _0x158053[_0x3b8194(0x421)][_0x3b8194(0x266)](_0x3b8194(0x576)), _0x489d67(_0x3700af, _0x24cf36); }), _0x1d82e2[_0x448ae9(0x3d5)](_0xb0645); } else _0x16ae70[_0x448ae9(0x4d8)] = _0x32d435[_0x448ae9(0x53d)]; }); } function _0x583cef() { const _0x3b65be = _0x43c7a1, _0x29bfcc = document[_0x3b65be(0x655)](_0x3b65be(0x2b3)), _0x1de85c = document['getElementById']('expense-amount'), _0x61d084 = _0x29bfcc[_0x3b65be(0x9bf)][_0x3b65be(0x6df)](), _0x4e37e0 = parseFloat(_0x1de85c[_0x3b65be(0x9bf)]); if (!_0x61d084 || isNaN(_0x4e37e0) || _0x4e37e0 <= 0x0) { if (_0x3b65be(0x885) === _0x3b65be(0x952)) _0x4ee1e0[_0x3b65be(0x472)] = _0x132255, _0x5fec07(), _0xfadf26(); else { _0x420e01(_0x3b65be(0x45d)); return; } } _0x128784[_0x3b65be(0x7cb)][_0x3b65be(0x1e5)]({ 'id': 'exp_' + Date[_0x3b65be(0x8a2)](), 'description': _0x61d084, 'amount': _0x4e37e0, 'timestamp': Date['now']() }), _0x5eb81f(), _0x597928(), _0x29bfcc[_0x3b65be(0x9bf)] = '', _0x1de85c['value'] = '', _0x29bfcc[_0x3b65be(0x76c)](); } function _0x3ee6aa(_0x88b75b) { const _0x5b3a8a = _0x43c7a1, _0xf074af = _0x128784[_0x5b3a8a(0x7cb)][_0x5b3a8a(0x95d)](_0x137751 => _0x137751['id'] === _0x88b75b); _0xf074af > -0x1 && (_0x128784['accountingData']['splice'](_0xf074af, 0x1), _0x5eb81f(), _0x597928()); } function _0x597928() { const _0x150344 = _0x43c7a1; if (_0x150344(0x93f) === 'SqAQq') { const _0x1556f8 = document['getElementById'](_0x150344(0x496)), _0x2d0de8 = document[_0x150344(0x655)](_0x150344(0x2ec)), _0x5ed089 = new Date(), _0x2dbfc2 = _0x128784['accountingData']['filter'](_0xf5f816 => new Date(_0xf5f816['timestamp'])[_0x150344(0x320)]() === _0x5ed089['toDateString']()); if (_0x2dbfc2[_0x150344(0x36c)] === 0x0) { _0x1556f8[_0x150344(0x711)] = _0x150344(0x98b), _0x2d0de8[_0x150344(0x711)] = ''; return; } _0x1556f8[_0x150344(0x711)] = '', _0x2dbfc2[_0x150344(0x8e2)]((_0x410018, _0x230393) => _0x230393['timestamp'] - _0x410018[_0x150344(0x89b)])[_0x150344(0x4d0)](_0x5dbfcf => { const _0x104afc = _0x150344; if (_0x104afc(0x886) === _0x104afc(0x886)) { const _0x588f98 = document[_0x104afc(0x26b)](_0x104afc(0x76e)); _0x588f98[_0x104afc(0x1f0)] = _0x104afc(0x1a7), _0x588f98[_0x104afc(0x711)] = '<span\x20class=\x22description\x22>' + _0x5dbfcf[_0x104afc(0x78a)] + _0x104afc(0x27d) + _0x5dbfcf[_0x104afc(0x9d3)]['toFixed'](0x2) + _0x104afc(0x583) + _0x5dbfcf['id'] + '\x22>&times;</button></div>', _0x1556f8[_0x104afc(0x3d5)](_0x588f98); } else _0x153a2e[_0x104afc(0x68f)] = _0x4fa0fe['name'], _0x365343[_0x104afc(0x68f)] = _0x104afc(0x442), _0x3f7d13(_0x1eae44, 'normal'); }); if (_0x2d0de8) { if ('qqxFY' !== 'qqxFY') { const _0x4d6554 = _0x27e8d9['target'][_0x150344(0x5a7)]; !_0x4d6554['objectStoreNames'][_0x150344(0x878)](_0x2f43c2) && _0x4d6554['createObjectStore'](_0x14fc4c, { 'keyPath': 'id' }); const _0x54a366 = _0x150344(0x428); !_0x4d6554[_0x150344(0x8b1)][_0x150344(0x878)](_0x54a366) && _0x4d6554[_0x150344(0x7b6)](_0x54a366, { 'keyPath': 'id' }); } else _0x2d0de8[_0x150344(0x711)] = _0x150344(0x817), document[_0x150344(0x655)](_0x150344(0x4bc))[_0x150344(0x203)](_0x150344(0x783), _0x325e39); } } else return _0x3432e1 + '分钟前'; } async function _0x325e39() { const _0x2f58a9 = _0x43c7a1; if (_0x2f58a9(0x481) === _0x2f58a9(0x3a6)) { const _0x41124c = []; for (const _0x657d54 of _0x59d0b8[_0x2f58a9(0x7ae)](_0x3ea207)) { const _0x5a4480 = _0x657d54[_0x2f58a9(0x6b2)](); if (_0x12463e['some'](_0x10a94c => _0x5a4480[_0x2f58a9(0x3fd)](_0x10a94c))) { const _0x26b670 = _0x368c81[_0x657d54]; if (typeof _0x26b670 === 'string') _0x41124c['push'](_0x26b670); if (_0x1389ad['isArray'](_0x26b670)) _0x26b670[_0x2f58a9(0x4d0)](_0xef29e0 => { const _0x2fb0b9 = _0x2f58a9; if (typeof _0xef29e0 === _0x2fb0b9(0x7d9)) _0x41124c[_0x2fb0b9(0x1e5)](_0xef29e0); }); } } if (_0x41124c['length']) return _0x41124c['flatMap'](_0x1f61d0)[_0x2f58a9(0x6e3)](0x0, 0x9); } else { const _0x42e6af = new Date(), _0x37df15 = _0x42e6af[_0x2f58a9(0x370)]() + '-' + String(_0x42e6af[_0x2f58a9(0x909)]() + 0x1)[_0x2f58a9(0x7d2)](0x2, '0') + '-' + String(_0x42e6af['getDate']())['padStart'](0x2, '0'); if (_0x128784[_0x2f58a9(0x4f1)][_0x37df15]) { _0x420e01(_0x2f58a9(0x32b)); return; } const _0x14685f = _0x128784[_0x2f58a9(0x7cb)]['filter'](_0x51a332 => new Date(_0x51a332['timestamp'])['toDateString']() === _0x42e6af[_0x2f58a9(0x320)]()); if (_0x14685f[_0x2f58a9(0x36c)] === 0x0) { _0x420e01(_0x2f58a9(0x339)); return; } _0xddfd1b(!![], _0x2f58a9(0x973)); try { const _0x4ca374 = ['餐饮美食', _0x2f58a9(0x8ff), _0x2f58a9(0x718), _0x2f58a9(0x794), _0x2f58a9(0x54e), _0x2f58a9(0x4ef), _0x2f58a9(0x3a3), _0x2f58a9(0x601)], _0x470076 = _0x14685f[_0x2f58a9(0x946)](_0x390ef2 => '-\x20' + _0x390ef2['description'] + ':\x20' + _0x390ef2[_0x2f58a9(0x9d3)])[_0x2f58a9(0x9cc)]('\x0a'), _0x30be0a = _0x128784[_0x2f58a9(0x277)][_0x2f58a9(0x946)](_0xcd3a4c => { const _0x141d22 = _0x2f58a9, _0x540d56 = _0x128784[_0x141d22(0x295)][_0x141d22(0x787)](_0x4a6ec9 => _0x4a6ec9['type'] === _0x141d22(0x921) && _0x4a6ec9['participantIds'][_0x141d22(0x9ac)](_0xcd3a4c['id'])), _0x160e40 = _0x128784[_0x141d22(0x4a5)][_0x141d22(0x787)](_0x4e96fb => _0x4e96fb['id'] === (_0x540d56?.['boundUserProfileId'] || _0x128784[_0x141d22(0x226)])) || { 'id': _0x141d22(0x665), 'name': '你' }; let _0x46b842 = ''; return _0xcd3a4c[_0x141d22(0x341)] && _0xcd3a4c[_0x141d22(0x341)]['length'] > 0x0 && (_0x46b842 = _0xcd3a4c[_0x141d22(0x341)]['map'](_0x141981 => _0x128784['worldBooks'][_0x141d22(0x787)](_0xc935aa => _0xc935aa['id'] === _0x141981))[_0x141d22(0x89c)](Boolean)[_0x141d22(0x946)](_0x230a4e => _0x141d22(0x2ce) + _0x230a4e[_0x141d22(0x4da)] + _0x141d22(0x63d) + _0x230a4e[_0x141d22(0x472)])['join']('')), _0x141d22(0x92c) + _0xcd3a4c['id'] + '\x0a\x20\x20\x20\x20姓名:\x20' + _0xcd3a4c[_0x141d22(0x4da)] + _0x141d22(0x337) + _0xcd3a4c[_0x141d22(0x489)] + _0x141d22(0x6c2) + _0x160e40[_0x141d22(0x4da)] + _0x141d22(0x218) + _0x160e40['id'] + ')\x0a' + _0x46b842; })[_0x2f58a9(0x9cc)]('\x0a'), _0x4c19fc = _0x128784[_0x2f58a9(0x4a5)][_0x2f58a9(0x946)](_0x7aa8f4 => '\x20\x20-\x20用户ID:\x20' + _0x7aa8f4['id'] + _0x2f58a9(0x325) + _0x7aa8f4[_0x2f58a9(0x4da)] + _0x2f58a9(0x337) + (_0x7aa8f4['persona'] || '无'))[_0x2f58a9(0x9cc)]('\x0a'), _0x45e2a7 = _0x2f58a9(0x285), _0x12e4d7 = '#\x20固定分类列表\x0a[' + _0x4ca374[_0x2f58a9(0x9cc)](',\x20') + _0x2f58a9(0x8b4) + _0x30be0a + _0x2f58a9(0x585) + _0x4c19fc + _0x2f58a9(0x87e) + _0x470076, _0x541840 = [{ 'role': 'system', 'content': _0x45e2a7 }, { 'role': 'user', 'content': _0x12e4d7 }], _0x5c48a0 = await _0x2e6580(_0x541840, { 'json': !![] }), _0xc9097a = _0x33c7d8(_0x5c48a0); if (!_0xc9097a) throw new Error(_0x2f58a9(0x835) + _0x5c48a0); const _0x56150a = JSON['parse'](_0xc9097a); _0x128784[_0x2f58a9(0x4f1)][_0x37df15] = { 'categorizedExpenses': _0x56150a, 'timestamp': Date[_0x2f58a9(0x8a2)]() }, _0x5eb81f(), _0x489d67(_0x128784[_0x2f58a9(0x4f1)][_0x37df15], _0x37df15); } catch (_0x41f605) { _0x420e01('AI整理失败了，哼:\x20' + _0x41f605[_0x2f58a9(0x740)]); } finally { _0xddfd1b(![]); } } } async function _0x46c6ab() { const _0x44d6e0 = _0x43c7a1, _0x2d0926 = [..._0x51f2c7]; try { const _0x9cb82e = localStorage[_0x44d6e0(0x2c6)](_0x44d6e0(0x379)); if (_0x9cb82e) { const _0x2a5f72 = JSON['parse'](_0x9cb82e); Array[_0x44d6e0(0x79f)](_0x2a5f72) ? _0x2f0881 = [..._0x2d0926, ..._0x2a5f72] : _0x2f0881 = _0x2d0926; } else _0x2f0881 = _0x2d0926; } catch (_0x3469e8) { if ('VxytG' === _0x44d6e0(0x184)) console['error'](_0x44d6e0(0x212), _0x3469e8), _0x2f0881 = _0x2d0926; else { _0x51ce17(); const _0x137d91 = _0x56d17a(_0x44d6e0(0x2ed), _0x55d7b9[_0x44d6e0(0x4da)]); _0x137d91 && _0x137d91[_0x44d6e0(0x6df)]() && _0x137d91 !== _0x4597bd[_0x44d6e0(0x4da)] && (_0x47cf50[_0x44d6e0(0x4da)] = _0x137d91[_0x44d6e0(0x6df)](), _0x4ef5e2(), _0x4d7c6c(), _0x31c3e6(), _0x1d255d('群名称已更改为\x22' + _0x47a56f['name'] + '\x22。')); } } if (!localStorage[_0x44d6e0(0x2c6)]('noir_data_migration_v1_complete')) { if (_0x44d6e0(0x338) !== _0x44d6e0(0x708)) { _0x17d4de(_0x44d6e0(0x83f))[_0x44d6e0(0x745)](async _0x5742ce => { const _0x43f1f1 = _0x44d6e0; if (_0x43f1f1(0x3ea) !== _0x43f1f1(0x3ea)) _0x281291[_0x43f1f1(0x84a)] = _0x322338[_0x43f1f1(0x9be)](_0x3c31de), _0x3a85d4[_0x43f1f1(0x385)][_0x43f1f1(0x269)] = 0x1; else { if (_0x5742ce) _0x43f1f1(0x509) !== 'ETyPz' ? (_0x451280(), _0x41d12a('friendCircleList', _0x43f1f1(0x2b9))) : (_0xddfd1b(!![], _0x43f1f1(0x2a1)), await _0x432163(), localStorage[_0x43f1f1(0x548)]('noir_data_migration_v1_complete', _0x43f1f1(0x51f)), _0xddfd1b(![]), _0x420e01('第一阶段升级完成！应用即将刷新以进行第二阶段检查。'), setTimeout(() => location[_0x43f1f1(0x360)](), 0x5dc)); else { if ('zzlfQ' !== 'FyodS') _0x420e01(_0x43f1f1(0x26e)); else { const _0x2bd068 = _0x2b4f7b[_0x43f1f1(0x67b)] ? _0x54c269(_0x211258[_0x43f1f1(0x67b)]) : null; return _0x2bd068?.[_0x43f1f1(0x4da)] || 'Unknown'; } } } }); return; } else _0x3c7c3a = {}; } if (!localStorage[_0x44d6e0(0x2c6)](_0x44d6e0(0x7fc))) { console[_0x44d6e0(0x331)](_0x44d6e0(0x725)), _0xddfd1b(!![], _0x44d6e0(0x93e)); const _0x17fa3a = await _0xe62e7e(); localStorage[_0x44d6e0(0x548)](_0x44d6e0(0x7fc), _0x44d6e0(0x51f)), _0xddfd1b(![]); if (_0x17fa3a > 0x0) { _0x420e01(_0x44d6e0(0x4a6) + _0x17fa3a + _0x44d6e0(0x4d2)), setTimeout(() => location['reload'](), 0x5dc); return; } } if (!localStorage['getItem'](_0x44d6e0(0x7fc))) { } if (!localStorage[_0x44d6e0(0x2c6)](_0x44d6e0(0x73c))) { console['log']('执行音乐封面数据净化...'), _0xddfd1b(!![], '正在升级音乐卡片数据...'); const _0x5e5974 = await _0x26cfcf(); localStorage['setItem'](_0x44d6e0(0x73c), _0x44d6e0(0x51f)), _0xddfd1b(![]); if (_0x5e5974 > 0x0) { _0x420e01(_0x44d6e0(0x7ca) + _0x5e5974 + _0x44d6e0(0x351)), setTimeout(() => location[_0x44d6e0(0x360)](), 0x5dc); return; } } const _0x2d3d0d = _0x3ac778(); _0x402a21(), _0x3cc7fa(), _0x35d233(), _0x41e50f(), _0x3e86ba(), _0x5462de(), _0x2fddcf(), _0x460642(), _0x5a16de(), _0x22a9c0(), _0x1ab08d(), _0x2e8da0(), setInterval(_0x2e8da0, 0x7530), _0x4ed7f8(), _0x151457(), _0x133d64(); const _0x408a58 = document[_0x44d6e0(0x655)]('audio-player'); document[_0x44d6e0(0x655)](_0x44d6e0(0x951))[_0x44d6e0(0x203)]('click', function (_0x42d6e6) { const _0x46ef82 = _0x44d6e0; if (_0x42d6e6[_0x46ef82(0x949)][_0x46ef82(0x3bf)](_0x46ef82(0x264))) return; const _0x1d4104 = document[_0x46ef82(0x655)]('widget-play-pause-btn'); _0x1d4104 && _0x1d4104[_0x46ef82(0x783)](); }), _0xcf54be(_0x44d6e0(0x7e1), _0x44d6e0(0x392)); (_0x2d3d0d || _0x128784[_0x44d6e0(0x277)][_0x44d6e0(0x36c)] === 0x0) && (_0x420e01('欢迎！请先创建一个角色开始聊天。'), setTimeout(() => { const _0x39a51c = _0x44d6e0; _0xcf54be(_0x39a51c(0x866), _0x39a51c(0x7e1)), setTimeout(() => _0xe68812(), 0x64); }, 0x6a4)); const _0x3ecd9c = document[_0x44d6e0(0x655)]('widget-bg-input'); document[_0x44d6e0(0x655)]('upload-widget-bg-button')[_0x44d6e0(0x203)](_0x44d6e0(0x783), () => _0x3ecd9c[_0x44d6e0(0x783)]()), document['getElementById'](_0x44d6e0(0x352))['addEventListener'](_0x44d6e0(0x783), () => { const _0x226df6 = _0x44d6e0; _0x128784['preferences'][_0x226df6(0x1bc)] = null, _0x5eb81f(), _0x4ed7f8(), _0x420e01(_0x226df6(0x5da)); }), _0x3ecd9c[_0x44d6e0(0x203)](_0x44d6e0(0x272), async _0x4b99bf => { const _0xa1f7bf = _0x44d6e0, _0x4f389b = _0x4b99bf[_0xa1f7bf(0x949)][_0xa1f7bf(0x275)][0x0]; if (!_0x4f389b) return; try { const _0x3fc350 = await _0x5484a4(_0x4f389b); _0x128784[_0xa1f7bf(0x430)][_0xa1f7bf(0x1bc)] = _0x3fc350, _0x5eb81f(), _0x4ed7f8(), _0x420e01('小组件背景已更换！'); } catch (_0x530f2a) { _0x420e01(_0xa1f7bf(0x36a) + _0x530f2a[_0xa1f7bf(0x740)]); } }), _0x162197(), document[_0x44d6e0(0x655)]('upload-badge-button')[_0x44d6e0(0x203)](_0x44d6e0(0x783), () => document[_0x44d6e0(0x655)](_0x44d6e0(0x914))[_0x44d6e0(0x783)]()), document[_0x44d6e0(0x655)](_0x44d6e0(0x62f))[_0x44d6e0(0x203)](_0x44d6e0(0x783), async () => { const _0x524388 = _0x44d6e0; if ('EDhtr' !== 'EDhtr') { const _0x1d2ce0 = _0x524388(0x6ef) + _0x585297; let _0x3d9c0d = _0x4c4ae3[_0x524388(0x655)](_0x1d2ce0); if (_0x3d9c0d) return; const _0x1793b8 = '\x0a\x20\x20\x20\x20<div\x20id=\x22' + _0x1d2ce0 + _0x524388(0x919) + (_0x21b3a7 === 'ai' ? '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>' : '') + _0x524388(0x1a9); _0x272f16['body'][_0x524388(0x3af)]('beforeend', _0x1793b8); const _0x11e960 = _0x3dd799['getElementById'](_0x1d2ce0), _0x241968 = () => _0x11e960['remove'](); _0x11e960['querySelector'](_0x524388(0x315))[_0x524388(0x9c8)] = _0x241968, _0x11e960[_0x524388(0x9ad)](_0x524388(0x245))[_0x524388(0x9c8)] = _0x241968, _0x11e960[_0x524388(0x9ad)](_0x524388(0x85b))[_0x524388(0x9c8)] = () => { _0x4efbde(_0x304e00), _0x241968(); }, _0x4d2f88 === 'ai' && (_0x11e960['querySelector'](_0x524388(0x5b7))[_0x524388(0x9c8)] = () => { _0xe2274(_0x36770f), _0x241968(); }); } else await _0x4dfe17('widget_badge'), localStorage[_0x524388(0x5c5)](_0x524388(0x584)), _0x162197(), _0x420e01(_0x524388(0x3b0)); }), document[_0x44d6e0(0x655)](_0x44d6e0(0x914))[_0x44d6e0(0x203)](_0x44d6e0(0x272), async _0x56961c => { const _0x10e017 = _0x44d6e0, _0x582ef3 = _0x56961c[_0x10e017(0x949)][_0x10e017(0x275)][0x0]; if (!_0x582ef3) return; try { _0x10e017(0x182) !== _0x10e017(0x182) ? _0x4f6c78(_0x10e017(0x636)) : (await _0x36c0a8(_0x10e017(0x8b5), _0x582ef3), await _0x162197(), _0x420e01(_0x10e017(0x2d2))); } catch (_0x48b8d6) { _0x10e017(0x8df) !== _0x10e017(0x445) ? _0x420e01('错误:\x20' + _0x48b8d6['message']) : _0x30c14f[_0x10e017(0x9de)](_0x10e017(0x65d), _0x2346c8); } }), _0x1efd00(), document['getElementById'](_0x44d6e0(0x781))[_0x44d6e0(0x203)](_0x44d6e0(0x450), _0x144bdb), document[_0x44d6e0(0x655)](_0x44d6e0(0x781))[_0x44d6e0(0x203)](_0x44d6e0(0x6a3), _0x144bdb, { 'passive': ![] }), document['getElementById'](_0x44d6e0(0x29a))[_0x44d6e0(0x203)]('click', () => document[_0x44d6e0(0x655)](_0x44d6e0(0x792))[_0x44d6e0(0x783)]()), document[_0x44d6e0(0x655)]('reset-card-button')[_0x44d6e0(0x203)](_0x44d6e0(0x783), async () => { const _0x339206 = _0x44d6e0; if (_0x339206(0x7ee) !== _0x339206(0x621)) await _0x4dfe17(_0x339206(0x6a5)), localStorage[_0x339206(0x5c5)]('cardState'), _0x1efd00(), _0x420e01(_0x339206(0x5a0)); else { _0x49b25d(_0x339206(0x50a), _0x339206(0x8a3)); const _0x9cb304 = _0x57028f[_0x339206(0x655)](_0x339206(0x767)); if (_0x108b50) { const _0x267f9e = _0x264545[_0x339206(0x4a5)][_0x339206(0x787)](_0x297d60 => _0x297d60['id'] === _0x33915d); if (!_0x267f9e) return; _0x5a4969[_0x339206(0x655)](_0x339206(0x38d))[_0x339206(0x9bf)] = _0x267f9e['id'], _0x20de42[_0x339206(0x655)](_0x339206(0x3d4))[_0x339206(0x68f)] = '编辑用户', _0x22616e['getElementById']('user-name')[_0x339206(0x9bf)] = _0x267f9e['name'], _0x3322bc[_0x339206(0x655)](_0x339206(0x3ca))[_0x339206(0x84a)] = _0x267f9e[_0x339206(0x4b6)], _0x444a38[_0x339206(0x655)]('user-persona')[_0x339206(0x9bf)] = _0x267f9e['persona'], _0x9cb304[_0x339206(0x385)][_0x339206(0x1cd)] = _0x267f9e['id'] === _0x394dad[_0x339206(0x226)] ? _0x339206(0x44e) : 'block'; } else _0x366dff['getElementById']('editing-user-id')[_0x339206(0x9bf)] = '', _0x39b903['getElementById'](_0x339206(0x3d4))['textContent'] = _0x339206(0x3de), _0x1c724e['getElementById']('user-name')['value'] = _0x339206(0x1eb) + (_0x2202fb[_0x339206(0x4a5)][_0x339206(0x36c)] + 0x1), _0x8d3d2b[_0x339206(0x655)](_0x339206(0x3ca))[_0x339206(0x84a)] = _0x1bad78, _0x5e722f[_0x339206(0x655)](_0x339206(0x4fe))[_0x339206(0x9bf)] = '', _0x9cb304[_0x339206(0x385)]['display'] = 'none'; } }), document[_0x44d6e0(0x655)]('card-input')[_0x44d6e0(0x203)](_0x44d6e0(0x272), async _0x2d8f33 => { const _0x2d630b = _0x44d6e0, _0x3c6e75 = _0x2d8f33[_0x2d630b(0x949)][_0x2d630b(0x275)][0x0]; if (!_0x3c6e75) return; try { await _0x36c0a8(_0x2d630b(0x6a5), _0x3c6e75), await _0x1efd00(), _0x420e01('卡片已更换！'); } catch (_0x350a05) { _0x420e01(_0x2d630b(0x36a) + _0x350a05['message']); } }), document[_0x44d6e0(0x655)](_0x44d6e0(0x48b))[_0x44d6e0(0x203)](_0x44d6e0(0x783), async () => { const _0x45cb8a = _0x44d6e0, _0x4f0533 = await _0x17d4de(_0x45cb8a(0x72c)); if (_0x4f0533) { if ('SIokN' === _0x45cb8a(0x78f)) { const _0x36a5c8 = _0x3b3ab2['getElementById']('global-player-play-pause-btn'); if (_0x36a5c8) _0x36a5c8['textContent'] = '❚❚'; } else localStorage[_0x45cb8a(0x5c5)](_0x45cb8a(0x584)), localStorage[_0x45cb8a(0x5c5)]('cardWidgetState'), _0x420e01(_0x45cb8a(0x651)), setTimeout(() => location['reload'](), 0x3e8); } }); const _0x2962b0 = document[_0x44d6e0(0x655)](_0x44d6e0(0x215)); _0x2962b0[_0x44d6e0(0x203)](_0x44d6e0(0x783), () => { const _0xb59131 = _0x44d6e0; _0x57eac2(), _0xcf54be('diaryList', _0xb59131(0x7e1)); }); const _0x4e0b70 = document[_0x44d6e0(0x655)]('app-music-library'); _0x4e0b70[_0x44d6e0(0x203)](_0x44d6e0(0x783), () => { const _0x3eda82 = _0x44d6e0; _0x8eb738(), _0xcf54be(_0x3eda82(0x198), _0x3eda82(0x7e1)); }), document[_0x44d6e0(0x655)](_0x44d6e0(0x49f))[_0x44d6e0(0x203)](_0x44d6e0(0x783), () => _0xcf54be(_0x44d6e0(0x7e1), _0x44d6e0(0x198))), document[_0x44d6e0(0x655)](_0x44d6e0(0x989))[_0x44d6e0(0x203)](_0x44d6e0(0x783), () => _0xcf54be('home', 'diaryList')), document['getElementById'](_0x44d6e0(0x3e4))[_0x44d6e0(0x203)](_0x44d6e0(0x783), () => { const _0x3597b0 = _0x44d6e0; _0x128784[_0x3597b0(0x592)] = null, _0xcf54be('diaryList', _0x3597b0(0x888)); }), document[_0x44d6e0(0x655)](_0x44d6e0(0x80e))[_0x44d6e0(0x203)](_0x44d6e0(0x783), _0xada467), document[_0x44d6e0(0x655)]('diary-get-reply-button')[_0x44d6e0(0x203)](_0x44d6e0(0x783), _0x471626), document[_0x44d6e0(0x655)](_0x44d6e0(0x979))[_0x44d6e0(0x203)](_0x44d6e0(0x916), _0x5651f9 => { const _0x436eb7 = _0x44d6e0; _0x5651f9[_0x436eb7(0x956)] === _0x436eb7(0x487) && !_0x5651f9[_0x436eb7(0x5ec)] && (_0x5651f9[_0x436eb7(0x7cc)](), _0xada467()); }); const _0xc66a21 = [_0x44d6e0(0x850), _0x44d6e0(0x89e), _0x44d6e0(0x4b0), 'sad', 'shy']; _0xc66a21['forEach'](_0x86ac5e => { const _0x4dab63 = _0x44d6e0, _0x5bfa81 = document['getElementById'](_0x4dab63(0x748) + _0x86ac5e + '-preview'), _0x15d79c = document['getElementById'](_0x4dab63(0x748) + _0x86ac5e + _0x4dab63(0x42b)); _0x5bfa81 && _0x15d79c && (_0x4dab63(0x834) === _0x4dab63(0x834) ? (_0x5bfa81['addEventListener'](_0x4dab63(0x783), () => _0x15d79c[_0x4dab63(0x783)]()), _0x15d79c[_0x4dab63(0x203)](_0x4dab63(0x272), async _0x3d1f39 => { const _0xbdb5c4 = _0x4dab63; if (_0xbdb5c4(0x714) === _0xbdb5c4(0x714)) { const _0xff996e = _0x3d1f39[_0xbdb5c4(0x949)][_0xbdb5c4(0x275)][0x0]; if (!_0xff996e) return; try { _0x5bfa81[_0xbdb5c4(0x84a)] = URL['createObjectURL'](_0xff996e); } catch (_0x327fe1) { _0x420e01(_0xbdb5c4(0x7ac) + _0x327fe1['message']); } } else { const _0x12105d = _0x681b6[_0xbdb5c4(0x655)](_0xbdb5c4(0x329)); _0x43339f['getElementById'](_0xbdb5c4(0x47a))[_0xbdb5c4(0x68f)] = '账本', _0x34cd59['getElementById'](_0xbdb5c4(0x3ac))[_0xbdb5c4(0x711)] = ''; const _0x2e3782 = _0x2e0340[_0xbdb5c4(0x7ae)](_0x5c3177[_0xbdb5c4(0x4f1)])[_0xbdb5c4(0x8e2)]((_0x2a753a, _0x4fc5c1) => new _0x59c9e9(_0x4fc5c1) - new _0x4d396f(_0x2a753a)); if (_0x2e3782['length'] === 0x0) { _0x12105d[_0xbdb5c4(0x711)] = _0xbdb5c4(0x261); return; } _0x12105d[_0xbdb5c4(0x711)] = '', _0x2e3782[_0xbdb5c4(0x4d0)](_0x4defa5 => { const _0x4f35e0 = _0xbdb5c4, _0x198275 = _0x49dfaa[_0x4f35e0(0x26b)]('div'); _0x198275[_0x4f35e0(0x1f0)] = 'expense-item', _0x198275['style'][_0x4f35e0(0x43f)] = _0x4f35e0(0x565); const _0x1db444 = _0x4840e1[_0x4f35e0(0x4f1)][_0x4defa5], _0x181883 = _0x1db444[_0x4f35e0(0x5a4)][_0x4f35e0(0x649)]((_0x14a2cf, _0x4e47b6) => _0x14a2cf + (_0x4e47b6[_0x4f35e0(0x9d3)] || 0x0), 0x0); _0x198275[_0x4f35e0(0x711)] = _0x4f35e0(0x66a) + _0x4defa5 + '</span><span\x20class=\x22amount\x22>总计:\x20' + _0x181883['toFixed'](0x2) + '</span>', _0x198275['addEventListener']('click', () => { const _0xb8260b = _0x4f35e0; _0x417f52[_0xb8260b(0x421)][_0xb8260b(0x66f)](_0xb8260b(0x576)), _0xcaf19c[_0xb8260b(0x421)][_0xb8260b(0x266)](_0xb8260b(0x576)), _0x5cb8bc(_0x1db444, _0x4defa5); }), _0x12105d[_0x4f35e0(0x3d5)](_0x198275); }); } })) : (_0x50e97f(_0x1006a9), _0x50cdd8())); }), document[_0x44d6e0(0x655)](_0x44d6e0(0x326))[_0x44d6e0(0x203)](_0x44d6e0(0x783), _0x52a9f3), document[_0x44d6e0(0x655)](_0x44d6e0(0x802))[_0x44d6e0(0x203)]('click', () => { const _0x33da27 = _0x44d6e0; _0x33da27(0x93a) === 'qvvRl' ? (_0x128784[_0x33da27(0x530)] = _0x128784[_0x33da27(0x530)] === 'novel' ? _0x33da27(0x8a6) : _0x33da27(0x644), _0x3401d9()) : (_0x1cb0f1[_0x33da27(0x421)]['toggle'](_0x33da27(0x8d5)), _0x4d7079[_0x33da27(0x421)][_0x33da27(0x878)](_0x33da27(0x8d5)) && (_0x1fd576[_0x33da27(0x4d8)] = _0x22e356[_0x33da27(0x53d)])); }), document[_0x44d6e0(0x655)](_0x44d6e0(0x9cb))['addEventListener'](_0x44d6e0(0x450), _0x363284), document[_0x44d6e0(0x655)](_0x44d6e0(0x9cb))[_0x44d6e0(0x203)]('touchstart', _0x363284, { 'passive': ![] }); let _0x34d654 = null; function _0x363284(_0x36908c) { const _0x24ccc9 = _0x44d6e0; if (_0x34d654) clearTimeout(_0x34d654); const _0x53c86f = _0x36908c[_0x24ccc9(0x949)][_0x24ccc9(0x3bf)](_0x24ccc9(0x453)); if (!_0x53c86f) return; const _0x2d4e66 = parseInt(_0x53c86f[_0x24ccc9(0x663)][_0x24ccc9(0x27b)], 0xa); if (isNaN(_0x2d4e66)) return; const _0x721e8 = () => { _0x34d654 = setTimeout(() => { const _0x168fa6 = _0x118e; if (_0x168fa6(0x4ac) !== _0x168fa6(0x6c0)) { if (_0x36908c[_0x168fa6(0x3b1)] === _0x168fa6(0x6a3)) _0x36908c[_0x168fa6(0x7cc)](); _0xe6bdf3(_0x2d4e66); } else _0x5d3c3b += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a'; }, 0x320); }, _0x3092f1 = () => { const _0x18ffb1 = _0x24ccc9; if ('NDDqH' !== _0x18ffb1(0x967)) { if (_0x34d654) clearTimeout(_0x34d654); } else { const _0x5399fc = _0x371853['id'], _0x47b9a9 = 'customIcon_' + _0x5399fc, _0x394fa4 = _0x2073ed[_0x18ffb1(0x2c6)](_0x47b9a9), _0x72df3f = _0x2c3076[_0x18ffb1(0x9ad)]('.app-icon-img'); if (_0x394fa4) _0x72df3f['innerHTML'] = _0x18ffb1(0x26d) + _0x394fa4 + _0x18ffb1(0x547); else { const _0x410e49 = _0x21e080[_0x18ffb1(0x9ad)](_0x18ffb1(0x20e) + _0x5399fc + _0x18ffb1(0x7a4) + _0x5399fc + _0x18ffb1(0x806))?.[_0x18ffb1(0x711)]; _0x410e49 && (_0x72df3f[_0x18ffb1(0x711)] = _0x410e49); } } }; document['addEventListener']('mouseup', _0x3092f1, { 'once': !![] }), document[_0x24ccc9(0x203)](_0x24ccc9(0x67f), _0x3092f1, { 'once': !![] }), document[_0x24ccc9(0x203)](_0x24ccc9(0x1c1), _0x3092f1, { 'once': !![] }), document[_0x24ccc9(0x203)](_0x24ccc9(0x4f8), _0x3092f1, { 'once': !![] }), _0x721e8(); } document[_0x44d6e0(0x307)][_0x44d6e0(0x203)](_0x44d6e0(0x783), _0x4dfabc => { const _0x1b98b8 = _0x44d6e0, _0x21e27e = _0x4dfabc[_0x1b98b8(0x949)][_0x1b98b8(0x3bf)]('.listen-together-card'); if (_0x21e27e) { if ('ZrgZC' !== _0x1b98b8(0x6b1)) _0x3f2406(_0x1b98b8(0x7ac) + _0xa1baac[_0x1b98b8(0x740)]); else { const _0x1d7c7a = _0x4dfabc[_0x1b98b8(0x949)][_0x1b98b8(0x3bf)](_0x1b98b8(0x3bd)), _0x13b82a = _0x4dfabc['target'][_0x1b98b8(0x3bf)](_0x1b98b8(0x9d6)); if (_0x1d7c7a) _0x25342c(); else { if (_0x13b82a) { const _0x48cfbe = _0x13b82a[_0x1b98b8(0x3bf)](_0x1b98b8(0x5ab)), _0x4c04fa = _0x13b82a[_0x1b98b8(0x663)][_0x1b98b8(0x686)], _0x42788c = parseInt(_0x48cfbe['dataset'][_0x1b98b8(0x27b)], 0xa); _0x2a92e1(_0x4c04fa, _0x42788c, _0x21e27e); } else { if (_0x1b98b8(0x89d) === _0x1b98b8(0x89d)) { const _0x1933db = _0x401cc7(); _0x1933db && _0x1933db[_0x1b98b8(0x8a0)] && _0x1933db[_0x1b98b8(0x8a0)][_0x1b98b8(0x88d)] && (_0x569b1c[_0x1b98b8(0x385)]['display'] = _0x1b98b8(0x4d4), setTimeout(() => _0x569b1c[_0x1b98b8(0x421)][_0x1b98b8(0x266)]('show'), 0xa)); } else _0x1a5d7a[_0x1b98b8(0x188)] = _0xab7030[_0x1b98b8(0x341)]['map'](_0x3d22dd => _0x35a6ae[_0x1b98b8(0x188)][_0x1b98b8(0x787)](_0x599ede => _0x599ede['id'] === _0x3d22dd))[_0x1b98b8(0x89c)](_0x1c1a15)[_0x1b98b8(0x946)](_0x11e6b2 => ({ 'name': _0x11e6b2[_0x1b98b8(0x4da)], 'content': _0x11e6b2['content'] })); } } return; } } if (window[_0x1b98b8(0x464)]()[_0x1b98b8(0x3a1)]()) return; const _0x46ff44 = _0x4dfabc[_0x1b98b8(0x949)]['closest'](_0x1b98b8(0x5ab)); if (_0x46ff44 && !_0x4dfabc[_0x1b98b8(0x949)][_0x1b98b8(0x3bf)](_0x1b98b8(0x4a7))) { const _0x1c68fb = parseInt(_0x46ff44[_0x1b98b8(0x663)][_0x1b98b8(0x27b)], 0xa); if (!isNaN(_0x1c68fb)) { if (_0x1b98b8(0x28c) !== _0x1b98b8(0x4b9)) _0xe6bdf3(_0x1c68fb); else { const _0x4dac55 = _0x3aef3a(_0x48c8ce[_0x1b98b8(0x472)] ?? _0x7cdf66[_0x1b98b8(0x64b)] ?? '')[_0x1b98b8(0x6df)]() || '[sticker:' + (_0x217b7f || _0x1b98b8(0x258)) + ']'; if (_0x4dac55) _0x2ccc7c[_0x1b98b8(0x9d2)][_0x1b98b8(0x1e5)]({ 'senderId': _0x409a68['id'], 'kind': 'text', 'content': _0x4dac55 }); } } } }); const _0x154553 = document[_0x44d6e0(0x655)]('noir-author-mark'); _0x154553 && _0x154553['addEventListener'](_0x44d6e0(0x783), () => { const _0x2f1de1 = _0x44d6e0; _0x420e01(_0x2f1de1(0x78d)); }); const _0xb3151f = document[_0x44d6e0(0x655)](_0x44d6e0(0x25c)), _0x50870d = localStorage[_0x44d6e0(0x2c6)](_0x44d6e0(0x379)); if (_0x50870d) try { const _0x5df899 = JSON['parse'](_0x50870d); Array[_0x44d6e0(0x79f)](_0x5df899) && ('TQqLF' === _0x44d6e0(0x2b0) ? (_0x15ba1c(), _0x23710c(_0x44d6e0(0x8a3), _0x44d6e0(0x50a))) : _0xb3151f[_0x44d6e0(0x9bf)] = _0x5df899[_0x44d6e0(0x946)](_0x3375e5 => _0x3375e5['name'] + '--' + _0x3375e5[_0x44d6e0(0x237)])[_0x44d6e0(0x9cc)]('\x0a')); } catch (_0x1c5786) { } document[_0x44d6e0(0x655)](_0x44d6e0(0x5f4))[_0x44d6e0(0x203)](_0x44d6e0(0x783), () => { const _0x577376 = _0x44d6e0; if (_0x577376(0x51c) !== 'ddYRP') _0x52e1ee[_0x577376(0x3d5)](_0xb94ea), _0x5f18dc['appendChild'](_0x521445); else { const _0x209aa3 = _0xb3151f['value'], _0x183f03 = _0x209aa3[_0x577376(0x7c7)]('\x0a')[_0x577376(0x89c)](_0x44074c => _0x44074c['trim']() !== ''), _0x4ff127 = []; let _0x439e48 = 0x0; for (const _0x2b9aef of _0x183f03) { const _0x196066 = _0x2b9aef[_0x577376(0x7c7)]('--'); if (_0x196066[_0x577376(0x36c)] === 0x2 && _0x196066[0x0][_0x577376(0x6df)]() && _0x196066[0x1]['trim']()[_0x577376(0x3fd)]('http')) { if (_0x577376(0x667) === _0x577376(0x667)) _0x4ff127[_0x577376(0x1e5)]({ 'name': _0x196066[0x0][_0x577376(0x6df)](), 'url': _0x196066[0x1][_0x577376(0x6df)]() }); else { const _0x2591c1 = _0x3e424a[_0x577376(0x26b)]('label'); _0x2591c1[_0x577376(0x711)] = _0x577376(0x202) + _0x55d15a['id'] + '\x22>\x20' + _0x4a1109[_0x577376(0x4da)], _0x34ab26[_0x577376(0x3d5)](_0x2591c1); } } else { if (_0x577376(0x691) !== _0x577376(0x691)) return (_0x43f87c?.[_0x577376(0x277)] || [])[_0x577376(0x787)](_0x17ecc5 => _0x17ecc5['id'] === _0x4d9bbe); else _0x439e48++; } } _0x439e48 > 0x0 && _0x420e01('有\x20' + _0x439e48 + '\x20行格式不对，被我无视了。'); try { localStorage[_0x577376(0x548)](_0x577376(0x379), JSON[_0x577376(0x5e0)](_0x4ff127)), _0x420e01(_0x577376(0x758)), setTimeout(() => location['reload'](), 0x5dc); } catch (_0x265d1a) { if (_0x577376(0x606) !== _0x577376(0x925)) _0x420e01(_0x577376(0x78e)); else { const _0xd3784a = _0x152fab(_0x38da02[_0x577376(0x789)]); _0x8aac3c = _0xd3784a[_0x577376(0x4b6)] || _0x5cd6d6; } } } }), _0x4b28c1(), document['getElementById']('upload-card-button-2')[_0x44d6e0(0x203)](_0x44d6e0(0x783), () => { const _0x3cff1c = _0x44d6e0; if (_0x3cff1c(0x782) === 'nArwU') { const _0x4dc998 = [], _0x3562f6 = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x4dba4b; while ((_0x4dba4b = _0x3562f6[_0x3cff1c(0x8bb)](_0x431f04)) !== null) { const _0x3a984c = _0x4dba4b[0x1][_0x3cff1c(0x55b)](/\\"/g, '\x22')[_0x3cff1c(0x55b)](/\\n/g, '\x0a')[_0x3cff1c(0x6df)](); if (_0x3a984c) _0x4dc998['push'](_0x3a984c); } if (_0x4dc998[_0x3cff1c(0x36c)]) return _0x4dc998[_0x3cff1c(0x7fe)](_0x50b120)[_0x3cff1c(0x6e3)](0x0, 0x9); } else document[_0x3cff1c(0x655)](_0x3cff1c(0x343))[_0x3cff1c(0x783)](); }), document[_0x44d6e0(0x655)](_0x44d6e0(0x624))[_0x44d6e0(0x203)](_0x44d6e0(0x783), async () => { const _0xa579a6 = _0x44d6e0; await _0x4dfe17(_0xa579a6(0x4d6)), localStorage[_0xa579a6(0x5c5)]('cardState2'), _0x1efd00(), _0x420e01('卡片\x202\x20已移除。'); }), document['getElementById'](_0x44d6e0(0x343))[_0x44d6e0(0x203)]('change', async _0x2e8953 => { const _0x14f7d6 = _0x44d6e0; if ('Bckyp' !== _0x14f7d6(0x687)) { _0x32eded = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x3b2721 in _0x1e3590) { _0x1ec949[_0x3b2721]['classList'][_0x14f7d6(0x66f)](_0x14f7d6(0x1a2)), _0x499e23[_0x3b2721][_0x14f7d6(0x9bf)] = ''; } _0x53a60c[_0x14f7d6(0x2f0)][_0x14f7d6(0x9ad)](_0x14f7d6(0x744))[_0x14f7d6(0x68f)] = '点击选择\x20.mp3\x20或\x20.flac', _0x36c5b3[_0x14f7d6(0x678)][_0x14f7d6(0x9ad)](_0x14f7d6(0x744))[_0x14f7d6(0x68f)] = _0x14f7d6(0x64c), _0x2ce63c[_0x14f7d6(0x889)][_0x14f7d6(0x9ad)](_0x14f7d6(0x744))[_0x14f7d6(0x68f)] = _0x14f7d6(0x475), _0x311f0e['lyrics'][_0x14f7d6(0x9ad)]('.slot-filename')[_0x14f7d6(0x68f)] = _0x14f7d6(0x233), _0x3572ab(); } else { const _0x96786d = _0x2e8953[_0x14f7d6(0x949)][_0x14f7d6(0x275)][0x0]; if (!_0x96786d) return; try { await _0x36c0a8(_0x14f7d6(0x4d6), _0x96786d), await _0x1efd00(), _0x420e01(_0x14f7d6(0x3ed)); } catch (_0xc8577f) { _0x420e01(_0x14f7d6(0x36a) + _0xc8577f['message']); } } }); } const _0x516be4 = new Promise((_0x3f1eff, _0x224efb) => { const _0x344004 = _0x43c7a1, _0xa7639 = indexedDB[_0x344004(0x90c)](_0x419231, 0x2); _0xa7639[_0x344004(0x9a7)] = () => _0x224efb(_0x344004(0x1a1)), _0xa7639[_0x344004(0x265)] = () => _0x3f1eff(_0xa7639[_0x344004(0x5a7)]); }), _0xbc13b = 'music_library'; async function _0x298b0c(_0x307929) { const _0x469e7b = await _0x516be4; return new Promise((_0x335edc, _0x26b8db) => { const _0x187120 = _0x118e; if (_0x187120(0x70f) !== _0x187120(0x1b0)) { const _0xc0084e = _0x469e7b[_0x187120(0x7c0)](_0xbc13b, 'readonly'), _0x199b36 = _0xc0084e[_0x187120(0x4ba)](_0xbc13b), _0x36548f = _0x199b36[_0x187120(0x7df)](_0x307929); _0x36548f[_0x187120(0x265)] = () => _0x335edc(_0x36548f[_0x187120(0x5a7)]), _0x36548f[_0x187120(0x9a7)] = () => _0x26b8db(_0x36548f[_0x187120(0x9de)]); } else _0x5a0760(_0x42a1a6); }); } async function _0x5ab4ac() { const _0x5ae6c0 = await _0x516be4; return new Promise((_0x1e1fd9, _0x45225d) => { const _0x42fd77 = _0x118e, _0x4e971b = _0x5ae6c0[_0x42fd77(0x7c0)](_0xbc13b, _0x42fd77(0x257)), _0x30016b = _0x4e971b['objectStore'](_0xbc13b), _0x5f4d14 = _0x30016b[_0x42fd77(0x34b)](); _0x5f4d14[_0x42fd77(0x265)] = () => _0x1e1fd9(_0x5f4d14['result']), _0x5f4d14[_0x42fd77(0x9a7)] = () => _0x45225d(_0x5f4d14[_0x42fd77(0x9de)]); }); } async function _0x3e40ff(_0x1adc1c) { const _0x2ebe27 = await _0x516be4; return new Promise((_0x1c7ed3, _0x9c516f) => { const _0x19a170 = _0x118e, _0x19dc98 = _0x2ebe27['transaction'](_0xbc13b, _0x19a170(0x939)), _0x7c6627 = _0x19dc98[_0x19a170(0x4ba)](_0xbc13b), _0x2e2196 = _0x7c6627[_0x19a170(0x505)](_0x1adc1c); _0x2e2196[_0x19a170(0x265)] = () => _0x1c7ed3(_0x2e2196[_0x19a170(0x5a7)]), _0x2e2196['onerror'] = () => _0x9c516f(_0x2e2196[_0x19a170(0x9de)]); }); } async function _0x491951(_0x31612e) { const _0x47643e = _0x43c7a1; if (_0x47643e(0x5e9) !== _0x47643e(0x5e9)) _0x38823b += _0x47643e(0x7ed); else { const _0x376cdc = await _0x516be4; return new Promise((_0x20b963, _0x159e80) => { const _0x251d6e = _0x47643e, _0x3d2bb1 = _0x376cdc[_0x251d6e(0x7c0)](_0xbc13b, _0x251d6e(0x939)), _0x39f51c = _0x3d2bb1[_0x251d6e(0x4ba)](_0xbc13b), _0x3d30cf = _0x39f51c[_0x251d6e(0x48f)](_0x31612e); _0x3d30cf[_0x251d6e(0x265)] = () => _0x20b963(), _0x3d30cf[_0x251d6e(0x9a7)] = () => _0x159e80(_0x3d30cf[_0x251d6e(0x9de)]); }); } } let _0x4c7ca6 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; const _0x13fa4f = { 'audio': document[_0x43c7a1(0x655)]('altar-slot-audio'), 'cover': document[_0x43c7a1(0x655)]('altar-slot-cover'), 'info': document[_0x43c7a1(0x655)](_0x43c7a1(0x31a)), 'lyrics': document[_0x43c7a1(0x655)]('altar-slot-lyrics') }, _0x4866b1 = { 'audio': document[_0x43c7a1(0x655)](_0x43c7a1(0x525)), 'cover': document[_0x43c7a1(0x655)](_0x43c7a1(0x9c1)), 'info': document['getElementById'](_0x43c7a1(0x190)), 'lyrics': document[_0x43c7a1(0x655)](_0x43c7a1(0x2fe)) }; for (const _0x5ec8a3 in _0x13fa4f) { _0x13fa4f[_0x5ec8a3]['addEventListener'](_0x43c7a1(0x783), () => _0x4866b1[_0x5ec8a3][_0x43c7a1(0x783)]()), _0x4866b1[_0x5ec8a3]['addEventListener'](_0x43c7a1(0x272), _0xe46701 => { const _0x458926 = _0x43c7a1; 'ojAqa' !== _0x458926(0x30d) ? _0x54b37a(_0x44dc7e[_0x458926(0x50e)], _0x1bf5d7[_0x458926(0x5eb)]) : _0x519542(_0x5ec8a3, _0xe46701['target'][_0x458926(0x275)][0x0]); }); } function _0x519542(_0x1ee567, _0x322642) { const _0x91cc69 = _0x43c7a1; if (!_0x322642) return; _0x4c7ca6[_0x1ee567] = _0x322642, _0x13fa4f[_0x1ee567][_0x91cc69(0x9ad)](_0x91cc69(0x744))[_0x91cc69(0x68f)] = _0x322642[_0x91cc69(0x4da)], _0x13fa4f[_0x1ee567]['classList']['add'](_0x91cc69(0x1a2)), _0x202c21(); } function _0x202c21() { const _0x4f9aae = _0x43c7a1, _0x4e1a4f = document[_0x4f9aae(0x655)](_0x4f9aae(0x46c)); _0x4c7ca6[_0x4f9aae(0x2f0)] && _0x4c7ca6[_0x4f9aae(0x889)] ? _0x4e1a4f['disabled'] = ![] : _0x4e1a4f['disabled'] = !![]; } function _0x4d8d32() { const _0x397499 = _0x43c7a1; _0x4c7ca6 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x9a7322 in _0x13fa4f) { _0x13fa4f[_0x9a7322][_0x397499(0x421)]['remove'](_0x397499(0x1a2)), _0x4866b1[_0x9a7322][_0x397499(0x9bf)] = ''; } _0x13fa4f[_0x397499(0x2f0)][_0x397499(0x9ad)](_0x397499(0x744))['textContent'] = _0x397499(0x87f), _0x13fa4f[_0x397499(0x678)][_0x397499(0x9ad)](_0x397499(0x744))[_0x397499(0x68f)] = _0x397499(0x64c), _0x13fa4f['info'][_0x397499(0x9ad)](_0x397499(0x744))[_0x397499(0x68f)] = '点击选择\x20info.txt', _0x13fa4f[_0x397499(0x35f)]['querySelector']('.slot-filename')[_0x397499(0x68f)] = _0x397499(0x233), _0x202c21(); } document[_0x43c7a1(0x655)]('confirm-altar-upload-button')['addEventListener'](_0x43c7a1(0x783), async () => { const _0x568824 = _0x43c7a1; if (_0x568824(0x213) !== 'saoca') { if (_0x2848b2[_0x568824(0x57c)]) _0x13c413[_0x568824(0x1e5)]('[' + _0x4245ec(_0x388459) + ']\x20[sticker:' + (_0x331cf7['content']?.[_0x568824(0x256)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x5421d2[_0x568824(0x911)]) { const _0x171d53 = _0x3c45c5[_0x568824(0x472)] ? '\x20' + _0x1d4db0[_0x568824(0x472)] : ''; _0x4c6c9c[_0x568824(0x1e5)]('[' + _0x256f28(_0x2e1bcb) + _0x568824(0x83c) + _0x171d53); } else _0x1c3b92['content'] && _0x3119a5['push']('[' + _0x13d4b0(_0x371233) + ']\x20' + _0x511000['content']); } } else { if (!_0x4c7ca6['audio'] || !_0x4c7ca6[_0x568824(0x889)]) { if ('YMvUk' !== _0x568824(0x8c7)) { _0x420e01(_0x568824(0x3bb)); return; } else _0x4246d8[_0x568824(0x9de)]('加载见面背景失败\x20for\x20' + _0x3e3840 + ':', _0x19a5f7), _0x3b1ada[_0x568824(0x385)][_0x568824(0x2ca)] = _0x568824(0x44e); } await _0x35c5c7(); } }), document[_0x43c7a1(0x655)](_0x43c7a1(0x88e))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x38a075 = _0x43c7a1; if ('KUmYT' !== _0x38a075(0x48c)) _0x4d8d32(), _0xcf54be(_0x38a075(0x321), _0x38a075(0x198)); else { const _0x2a2f25 = _0x4ae0e2[_0x38a075(0x49d)]('p'); _0x2a2f25[_0x38a075(0x4d0)](_0x5e38e5 => _0x5e38e5['classList'][_0x38a075(0x66f)](_0x38a075(0x576))); const _0x2270a4 = _0x39203a[_0x38a075(0x655)](_0x38a075(0x30f) + _0x3fc2f0); _0x2270a4 && (_0x2270a4[_0x38a075(0x421)][_0x38a075(0x266)](_0x38a075(0x576)), _0x2270a4[_0x38a075(0x478)]({ 'behavior': 'smooth', 'block': _0x38a075(0x4cf) })); } }), document['getElementById'](_0x43c7a1(0x688))[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x21230b = _0x43c7a1; if ('wfKZt' !== _0x21230b(0x7f2)) _0xcf54be(_0x21230b(0x198), 'musicUploadAltar'); else { const _0x338590 = _0x4b0298(_0x1d24ab); if (_0x338590) { const _0x4097d3 = _0x4ceaae['createElement'](_0x21230b(0x41c)); _0x4097d3[_0x21230b(0x9bf)] = _0x338590['id'], _0x4097d3[_0x21230b(0x68f)] = _0x338590[_0x21230b(0x4da)], _0x386567[_0x21230b(0x3d5)](_0x4097d3); } } }); async function _0x35c5c7() { const _0xec32d6 = _0x43c7a1; _0xddfd1b(!![], _0xec32d6(0x5d7)); try { const _0x5470f2 = await _0x4c7ca6['info'][_0xec32d6(0x64b)](); let _0x51d507; if (_0x5470f2['trim']()[_0xec32d6(0x3fd)]('{')) _0x51d507 = JSON['parse'](_0x5470f2); else { _0x51d507 = {}; const _0x3ee8ca = _0x5470f2['split']('\x0a'); _0x3ee8ca[_0xec32d6(0x4d0)](_0x404796 => { const _0x418448 = _0xec32d6, _0x3bba3d = _0x404796['split'](/:\s|：\s/); if (_0x3bba3d[_0x418448(0x36c)] === 0x2) { if (_0x418448(0x6c8) === _0x418448(0x477)) _0x2a8597[_0x418448(0x203)](_0x418448(0x783), () => { const _0x5e5aed = _0x418448; _0x3b4bf9(_0x5e5aed(0x78d)); }); else { const _0x9c6319 = _0x3bba3d[0x0]['trim'](), _0x1d9393 = _0x3bba3d[0x1][_0x418448(0x6df)](), _0x253495 = { '歌名': _0x418448(0x730), '艺术家': '歌手', '专辑': '专辑' }; _0x253495[_0x9c6319] && (_0x51d507[_0x253495[_0x9c6319]] = _0x1d9393); } } }); if (!_0x51d507['歌曲名称']) { if (_0xec32d6(0x293) !== _0xec32d6(0x7b3)) throw new Error('在你那乱七八糟的文本里没找到“歌名”！'); else { _0x53a39b(_0xec32d6(0x9e0)); return; } } _0x51d507['歌曲ID'] = _0xec32d6(0x1f3) + Date['now'](); } const _0x187fef = _0xec32d6(0x1f3) + (_0x51d507['歌曲ID'] || Date['now']()), _0x41b8c7 = { 'id': _0x187fef, 'info': _0x51d507, 'audio': _0x4c7ca6[_0xec32d6(0x2f0)], 'cover': _0x4c7ca6[_0xec32d6(0x678)], 'lyrics': _0x4c7ca6[_0xec32d6(0x35f)] ? await _0x4c7ca6[_0xec32d6(0x35f)]['text']() : '' }; await _0x3e40ff(_0x41b8c7), await _0x8eb738(), _0xddfd1b(![]), _0x420e01(_0xec32d6(0x3e2) + _0x51d507[_0xec32d6(0x730)] + _0xec32d6(0x40e)), _0xcf54be('musicLibrary', _0xec32d6(0x321)); } catch (_0x3bfc89) { if (_0xec32d6(0x564) === 'lHDIg') _0xddfd1b(![]), console[_0xec32d6(0x9de)](_0xec32d6(0x3a7), _0x3bfc89), _0x420e01(_0xec32d6(0x8e8) + _0x3bfc89['message']); else { const _0x3d79f8 = _0x13ccb8(_0x3dc9f0['activeMeetingCharId']); if (!_0x3d79f8) return; _0xf1633b = !![], _0x46dea2[_0xec32d6(0x385)][_0xec32d6(0x1cd)] = 'block'; const _0x4bf4ca = _0x3d79f8['spriteTransform'] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; _0x3a7dcb[_0xec32d6(0x655)](_0xec32d6(0x6ea))[_0xec32d6(0x9bf)] = _0x4bf4ca['x'], _0x23bcf8[_0xec32d6(0x655)](_0xec32d6(0x6d4))['value'] = _0x4bf4ca['y'], _0x35d139[_0xec32d6(0x655)](_0xec32d6(0x825))[_0xec32d6(0x9bf)] = _0x4bf4ca[_0xec32d6(0x6f3)] * 0x64, _0x28fe74 = { ..._0x4bf4ca }, _0x2df337['getElementById'](_0xec32d6(0x326))['style'][_0xec32d6(0x1cd)] = _0xec32d6(0x44e), _0x4721d0[_0xec32d6(0x655)](_0xec32d6(0x2fc))['style'][_0xec32d6(0x1cd)] = _0xec32d6(0x44e); } } } async function _0x8eb738() { const _0x2831b7 = _0x43c7a1; if (_0x2831b7(0x9af) === _0x2831b7(0x9af)) { const _0x514314 = document['getElementById'](_0x2831b7(0x2f8)); _0x514314[_0x2831b7(0x711)] = ''; const _0x1ca1b7 = await _0x5ab4ac(); if (_0x1ca1b7[_0x2831b7(0x36c)] === 0x0) { if (_0x2831b7(0x554) === 'ZCyEQ') _0x473402(_0x1a9f37); else { _0x514314[_0x2831b7(0x711)] = _0x2831b7(0x679); return; } } _0x1ca1b7[_0x2831b7(0x8e2)]((_0x4f8cfc, _0x554508) => (_0x4f8cfc['info'][_0x2831b7(0x730)] || '')['localeCompare'](_0x554508[_0x2831b7(0x889)]['歌曲名称'] || '')); for (const _0x302032 of _0x1ca1b7) { const _0x502c57 = document[_0x2831b7(0x26b)](_0x2831b7(0x76e)); _0x502c57[_0x2831b7(0x1f0)] = _0x2831b7(0x3dd), _0x502c57[_0x2831b7(0x663)][_0x2831b7(0x686)] = _0x302032['id']; const _0x2404c2 = _0x302032[_0x2831b7(0x678)] ? URL[_0x2831b7(0x9be)](_0x302032[_0x2831b7(0x678)]) : _0x3834ec; _0x502c57[_0x2831b7(0x711)] = _0x2831b7(0x371) + _0x2404c2 + _0x2831b7(0x716) + (_0x302032[_0x2831b7(0x889)][_0x2831b7(0x730)] || '未知歌曲') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>' + (_0x302032[_0x2831b7(0x889)]['歌手'] || _0x2831b7(0x3fb)) + _0x2831b7(0x491); let _0xf6f32c = null; const _0x30f469 = _0x4f5077 => { const _0x5c2837 = _0x2831b7; if (_0x4f5077[_0x5c2837(0x264)] === 0x2) return; _0xf6f32c = setTimeout(async () => { const _0x21259f = _0x5c2837; if (_0x4f5077[_0x21259f(0x3b1)] === _0x21259f(0x6a3)) _0x4f5077[_0x21259f(0x7cc)](); const _0x4aac90 = await _0x17d4de('确定要从圣殿中永久删除《' + _0x302032[_0x21259f(0x889)]['歌曲名称'] + _0x21259f(0x900)); if (_0x4aac90) { if (_0x21259f(0x286) !== _0x21259f(0x286)) { _0x46cec4 = _0x2ad989[_0x21259f(0x295)][_0x21259f(0x787)](_0x1ff0db => _0x1ff0db['type'] === 'private' && _0x1ff0db['participantIds'][_0x21259f(0x9ac)](_0x537ba9)); const _0x1760b8 = _0x267b4b(_0x33e4cf); _0x4f7b28 = _0x1760b8 ? _0x1760b8[_0x21259f(0x4da)] : _0x21259f(0x571); } else await _0x491951(_0x302032['id']), await _0x8eb738(), _0x420e01('已删除。'); } }, 0x320); }, _0x2b9bb7 = () => { clearTimeout(_0xf6f32c); }; _0x502c57[_0x2831b7(0x203)](_0x2831b7(0x450), _0x30f469), _0x502c57[_0x2831b7(0x203)]('mouseup', _0x2b9bb7), _0x502c57['addEventListener'](_0x2831b7(0x67f), _0x2b9bb7), _0x502c57[_0x2831b7(0x203)](_0x2831b7(0x6a3), _0x30f469, { 'passive': ![] }), _0x502c57[_0x2831b7(0x203)](_0x2831b7(0x1c1), _0x2b9bb7), _0x502c57[_0x2831b7(0x203)](_0x2831b7(0x4f8), _0x2b9bb7), _0x502c57[_0x2831b7(0x203)](_0x2831b7(0x783), _0x40c1b2 => { const _0x35e56f = _0x2831b7; if (_0x35e56f(0x75c) !== 'WhQYL') { if (_0xf6f32c) clearTimeout(_0xf6f32c); if (_0x40c1b2[_0x35e56f(0x34a)]) return; setTimeout(() => { const _0x807186 = _0x35e56f; if (_0x807186(0x5b3) !== _0x807186(0x5b3)) { _0x434238[_0x807186(0x711)] = _0x807186(0x261); return; } else { if (_0xf6f32c) { if (_0x807186(0x247) !== _0x807186(0x247)) { const _0x489b7c = ['星期日', _0x807186(0x3b2), '星期二', _0x807186(0x46b), _0x807186(0x24d), '星期五', _0x807186(0x6e0)]; return _0x489b7c[_0x3cd105['getDay']()] + '\x20' + _0x50896e; } else _0x31261e(_0x302032['id'], _0x1ca1b7[_0x807186(0x946)](_0x4711db => _0x4711db['id'])); } } }, 0x32); } else _0x4cfc4d[_0x35e56f(0x9de)](_0x35e56f(0x1df), _0xe060c2), _0x22334d[_0x35e56f(0x84a)] = ''; }), _0x514314[_0x2831b7(0x3d5)](_0x502c57); } } else { const _0x28f5dd = _0x107a42[_0x2831b7(0x655)](_0xb7a780); if (_0x28f5dd && _0x46b999) _0x28f5dd['src'] = _0x47da2e[_0x2831b7(0x9be)](_0x3d6e00); } } _0x2e7d91['addEventListener'](_0x43c7a1(0x783), () => { const _0x4a276e = _0x43c7a1; _0x420e01(_0x4a276e(0x66d)); }), _0x2bdff[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { _0x420e01('这个也是摆设，别点了。'); }); let _0x25eb66 = [], _0xe601b4 = -0x1; async function _0x31261e(_0x139b84, _0x7815b) { const _0xc89b1d = _0x43c7a1, _0x239b16 = await _0x298b0c(_0x139b84); if (!_0x239b16) return; _0x47847f = { 'title': _0x239b16['info']['歌曲名称'] || _0xc89b1d(0x219), 'artist': _0x239b16[_0xc89b1d(0x889)]['歌手'] || _0xc89b1d(0x3fb), 'cover': _0x239b16[_0xc89b1d(0x678)] ? URL[_0xc89b1d(0x9be)](_0x239b16['cover']) : _0x3834ec, 'isFromLibrary': !![] }; const _0x5a60d5 = URL['createObjectURL'](_0x239b16[_0xc89b1d(0x2f0)]); _0x70f69b[_0xc89b1d(0x84a)] = _0x5a60d5, _0x70f69b['play'](), _0x1ab08d(); } async function _0x1ab08d() { const _0x472869 = _0x43c7a1, _0x53e5be = document['getElementById']('music-widget-card'), _0x4f800c = document['getElementById'](_0x472869(0x1f5)), _0x5ab8f0 = document[_0x472869(0x655)](_0x472869(0x7f9)), _0x314322 = document[_0x472869(0x655)]('widget-cover-art'), _0x4a5674 = _0x47847f; if (_0x4a5674 && _0x4a5674[_0x472869(0x494)]) _0x4f800c[_0x472869(0x68f)] = _0x4a5674[_0x472869(0x38f)], _0x5ab8f0[_0x472869(0x68f)] = _0x4a5674['artist'], _0x53e5be['classList'][_0x472869(0x266)](_0x472869(0x449)), _0x53e5be[_0x472869(0x385)][_0x472869(0x6ac)]('--widget-cover-image', _0x472869(0x21b) + _0x4a5674[_0x472869(0x678)] + ')'); else { if ('ESGuR' !== 'HDoWf') _0x4f800c[_0x472869(0x68f)] = _0x472869(0x788), _0x5ab8f0[_0x472869(0x68f)] = _0x472869(0x81f), _0x53e5be['classList'][_0x472869(0x66f)](_0x472869(0x449)), _0x314322['style']['setProperty'](_0x472869(0x314), _0x472869(0x44e)); else { const _0x550efc = _0xf4e6f8[_0x472869(0x655)]('theme-hue-slider'); if (!_0x550efc) return; const _0x260d4c = _0x17579e[_0x472869(0x2c6)](_0x472869(0x415)) || '35'; _0x29baa7[_0x472869(0x348)][_0x472869(0x385)][_0x472869(0x6ac)](_0x472869(0x4cc), _0x260d4c), _0x550efc['value'] = _0x260d4c, _0x550efc[_0x472869(0x203)](_0x472869(0x2cb), () => { const _0x3f8024 = _0x472869, _0x5ea481 = _0x550efc[_0x3f8024(0x9bf)]; _0x31a3ef[_0x3f8024(0x348)][_0x3f8024(0x385)][_0x3f8024(0x6ac)](_0x3f8024(0x4cc), _0x5ea481), _0x47ccab[_0x3f8024(0x548)]('themeHue', _0x5ea481), _0xc45a41(); }); } } } if (_0x2e7d91) { if (_0x43c7a1(0x3e1) === 'iBHNt') _0x2e7d91[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { if (_0x25eb66['length'] === 0x0) return; _0xe601b4 = (_0xe601b4 + 0x1) % _0x25eb66['length'], _0x31261e(_0x25eb66[_0xe601b4], _0x25eb66); }); else { if (!_0x48abf6) return []; const _0x449e0a = _0xa201ca(_0x490089)[_0x43c7a1(0x6df)](), _0x52a98e = _0x449e0a[_0x43c7a1(0x7c7)](/(?<=[。！？!?…])\s+|[\r\n]+/)['map'](_0x1419f6 => _0x1419f6['trim']())[_0x43c7a1(0x89c)](_0x6ec04c); if (_0x52a98e['length'] > 0x0) return _0x52a98e[_0x43c7a1(0x6e3)](0x0, 0x9); return [_0x449e0a][_0x43c7a1(0x89c)](_0x38b0a1); } } _0x2bdff && (_0x43c7a1(0x937) === _0x43c7a1(0x5b0) ? (_0x4e8daa[_0x43c7a1(0x4da)] = _0xb565e7[_0x43c7a1(0x6df)](), _0x1eef1f(), _0x56efee(), _0x582e71(), _0x5e53f9(_0x43c7a1(0x880) + _0x7e500e[_0x43c7a1(0x4da)] + '\x22。')) : _0x2bdff[_0x43c7a1(0x203)](_0x43c7a1(0x783), () => { const _0x1e2d07 = _0x43c7a1; if (_0x25eb66[_0x1e2d07(0x36c)] === 0x0) return; _0xe601b4 = (_0xe601b4 - 0x1 + _0x25eb66[_0x1e2d07(0x36c)]) % _0x25eb66[_0x1e2d07(0x36c)], _0x31261e(_0x25eb66[_0xe601b4], _0x25eb66); })); _0x70f69b['addEventListener'](_0x43c7a1(0x244), () => { const _0x4aca78 = _0x43c7a1; if (_0x5acb02) _0x5acb02[_0x4aca78(0x68f)] = '❚❚'; }), _0x70f69b[_0x43c7a1(0x203)](_0x43c7a1(0x753), () => { if (_0x5acb02) _0x5acb02['textContent'] = '▶'; }), _0x70f69b[_0x43c7a1(0x203)](_0x43c7a1(0x2e9), () => { const _0x5d3e60 = _0x43c7a1; if (_0x5d3e60(0x560) === _0x5d3e60(0x560)) { if (_0x2e7d91) _0x2e7d91['click'](); } else { let _0x265794 = 0x0, _0x51a9aa = 0x0, _0x5879a1 = 0x0; if (_0x315a63[_0x5d3e60(0x36c)] == 0x4) _0x265794 = '0x' + _0x33d792[0x1] + _0x313f31[0x1], _0x51a9aa = '0x' + _0x119a47[0x2] + _0xe74799[0x2], _0x5879a1 = '0x' + _0x1cf2fc[0x3] + _0x373a00[0x3]; else _0x20e901['length'] == 0x7 && (_0x265794 = '0x' + _0x34ff5f[0x1] + _0x723e50[0x2], _0x51a9aa = '0x' + _0x4aa9cb[0x3] + _0x4ba81c[0x4], _0x5879a1 = '0x' + _0x371f61[0x5] + _0x506634[0x6]); _0x265794 /= 0xff, _0x51a9aa /= 0xff, _0x5879a1 /= 0xff; let _0x204d64 = _0x3411bd['min'](_0x265794, _0x51a9aa, _0x5879a1), _0x4f9e40 = _0x4152db['max'](_0x265794, _0x51a9aa, _0x5879a1), _0x145417 = _0x4f9e40 - _0x204d64, _0x1516ab = 0x0, _0x4536a8 = 0x0, _0x37b42c = 0x0; if (_0x145417 == 0x0) _0x1516ab = 0x0; else { if (_0x4f9e40 == _0x265794) _0x1516ab = (_0x51a9aa - _0x5879a1) / _0x145417 % 0x6; else { if (_0x4f9e40 == _0x51a9aa) _0x1516ab = (_0x5879a1 - _0x265794) / _0x145417 + 0x2; else _0x1516ab = (_0x265794 - _0x51a9aa) / _0x145417 + 0x4; } } _0x1516ab = _0x83725[_0x5d3e60(0x2cd)](_0x1516ab * 0x3c); if (_0x1516ab < 0x0) _0x1516ab += 0x168; return _0x37b42c = (_0x4f9e40 + _0x204d64) / 0x2, _0x4536a8 = _0x145417 == 0x0 ? 0x0 : _0x145417 / (0x1 - _0x798209[_0x5d3e60(0x7b2)](0x2 * _0x37b42c - 0x1)), _0x4536a8 = +(_0x4536a8 * 0x64)['toFixed'](0x1), _0x37b42c = +(_0x37b42c * 0x64)[_0x5d3e60(0x8bd)](0x1), { 'h': _0x1516ab, 's': _0x4536a8, 'l': _0x37b42c }; } }); function _0x2476ee() { const _0x3ba160 = _0x43c7a1, _0xaab0ce = _0x401cc7(); if (!_0xaab0ce) return; _0x320e5e[_0x3ba160(0x711)] = '', _0x4a3bf1[_0x3ba160(0x9bf)] = '', _0xaab0ce['type'] === _0x3ba160(0x6a4) ? (_0xaab0ce[_0x3ba160(0x4de)][_0x3ba160(0x4d0)](_0x349b27 => { const _0x417309 = _0x3ba160, _0x29a541 = _0x8351ef(_0x349b27); if (_0x29a541) { const _0xf171b5 = document[_0x417309(0x26b)]('option'); _0xf171b5['value'] = _0x29a541['id'], _0xf171b5[_0x417309(0x68f)] = _0x29a541[_0x417309(0x4da)], _0x320e5e[_0x417309(0x3d5)](_0xf171b5); } }), _0x5e7df4[_0x3ba160(0x385)][_0x3ba160(0x1cd)] = _0x3ba160(0x3d3)) : _0x5e7df4[_0x3ba160(0x385)]['display'] = _0x3ba160(0x44e), _0xd6a01e[_0x3ba160(0x421)][_0x3ba160(0x266)](_0x3ba160(0x8d5)), _0x4a3bf1[_0x3ba160(0x76c)](); } function _0x5b44d4() { const _0x3d8370 = _0x43c7a1, _0x34bfb9 = parseFloat(_0x4a3bf1[_0x3d8370(0x9bf)]); if (isNaN(_0x34bfb9) || _0x34bfb9 <= 0x0) { _0x420e01(_0x3d8370(0x359)); return; } const _0x3b46c2 = _0x401cc7(); let _0xf5885a = null; if (_0x3b46c2[_0x3d8370(0x3b1)] === _0x3d8370(0x6a4)) _0xf5885a = _0x320e5e[_0x3d8370(0x9bf)]; else { if (_0x3d8370(0x335) !== 'PvHBV') { _0x1d5940(_0x3d8370(0x6f0)); return; } else _0xf5885a = _0x3b46c2[_0x3d8370(0x4de)][0x0]; } const _0x2eeac0 = _0x10af56(_0x3b46c2['id']), _0xc5f0ed = { 'role': _0x3d8370(0x500), 'type': _0x3d8370(0x4e1), 'content': _0x3d8370(0x4a4) + (_0x8351ef(_0xf5885a)?.[_0x3d8370(0x4da)] || '未知') + _0x3d8370(0x2ac) + _0x34bfb9 + ']', 'amount': _0x34bfb9, 'recipientId': _0xf5885a, 'senderId': _0x2eeac0['id'], 'timestamp': Date['now']() }; _0x128784[_0x3d8370(0x6e7)][_0x3d8370(0x1e5)](_0xc5f0ed), _0x1313e9(), _0x19de4f(), _0xd6a01e['classList'][_0x3d8370(0x66f)](_0x3d8370(0x8d5)); } async function _0x50b6bb(_0x32285f) { const _0x520223 = _0x43c7a1, _0x2a01f6 = _0x8351ef(_0x32285f); if (!_0x2a01f6) return; const _0xdc131d = await _0x17d4de('确定要永久清空【' + _0x2a01f6[_0x520223(0x4da)] + '】的交换日记吗？\x0a此操作不可撤销，AI将彻底遗忘所有日记内容。'); if (!_0xdc131d) return; const _0x3ee376 = _0x128784[_0x520223(0x401)]['findIndex'](_0x2631dc => _0x2631dc[_0x520223(0x267)] === _0x32285f); _0x3ee376 > -0x1 ? (_0x128784['diaries']['splice'](_0x3ee376, 0x1), _0x5eb81f(), _0x57eac2(), _0x420e01('【' + _0x2a01f6[_0x520223(0x4da)] + _0x520223(0x800))) : _0x420e01(_0x520223(0x327)); } _0x46c6ab(); }); async function _0x432163() { const _0x49d781 = _0x5ad424; console[_0x49d781(0x331)]('---\x20Noir\x27s\x20Data\x20Purification\x20Ritual\x20v1.0\x20---'), console[_0x49d781(0x331)](_0x49d781(0x1b3)); const _0x17ed20 = _0x49d781(0x191), _0x186e63 = _0x49d781(0x91f), _0x3604b2 = new Promise((_0x46ede9, _0x5b541a) => { const _0x353359 = _0x49d781; if ('jghqW' !== _0x353359(0x736)) { const _0x32abe6 = indexedDB[_0x353359(0x90c)](_0x17ed20, 0x2); _0x32abe6[_0x353359(0x9a7)] = () => _0x5b541a('IndexedDB\x20failed\x20to\x20open'), _0x32abe6[_0x353359(0x265)] = () => _0x46ede9(_0x32abe6[_0x353359(0x5a7)]), _0x32abe6['onupgradeneeded'] = _0x498b2b => { const _0x45df5a = _0x353359; if ('mbVSq' !== _0x45df5a(0x972)) { const _0x41ea16 = _0x498b2b[_0x45df5a(0x949)][_0x45df5a(0x5a7)]; !_0x41ea16[_0x45df5a(0x8b1)][_0x45df5a(0x878)](_0x186e63) && _0x41ea16['createObjectStore'](_0x186e63, { 'keyPath': 'id' }), !_0x41ea16[_0x45df5a(0x8b1)][_0x45df5a(0x878)](_0x45df5a(0x428)) && (_0x45df5a(0x3cf) === 'QQIWx' ? (_0x3a8ef8[_0x45df5a(0x421)][_0x45df5a(0x66f)](_0x45df5a(0x8d5)), _0x21846f[_0x45df5a(0x9c8)] = null, _0x2b1693['onclick'] = null, _0x20efc1[_0x45df5a(0x9c8)] = null, _0x360a6b[_0x45df5a(0x6bf)](_0x45df5a(0x916), _0x59a0b7), _0x1f3143(_0x390534)) : _0x41ea16[_0x45df5a(0x7b6)]('music_library', { 'keyPath': 'id' })); } else { const _0x4945e0 = _0x5723e8[_0x45df5a(0x949)][_0x45df5a(0x275)][0x0]; if (!_0x4945e0) return; const _0x11eb06 = _0x5b658d[_0x45df5a(0x9be)](_0x4945e0); _0xe8f6f7[_0x45df5a(0x84a)] = _0x11eb06, _0x3f6995[_0x45df5a(0x74c)] = () => { const _0x17d146 = _0x45df5a; _0x4cb301[_0x17d146(0x775)](_0x11eb06); }; } }; } else _0x346320[_0x353359(0x5c5)](_0x353359(0x25f) + _0xd6b381['id']); }); async function _0x700a5e(_0x370f29, _0x553742) { const _0x3cb018 = _0x49d781; if (_0x3cb018(0x847) !== _0x3cb018(0x1a6)) { const _0x55dfe5 = await _0x3604b2; return new Promise((_0x42b187, _0x3cc4df) => { const _0x5979e2 = _0x3cb018, _0x45d505 = _0x55dfe5[_0x5979e2(0x7c0)](_0x186e63, _0x5979e2(0x939)), _0x13ef7a = _0x45d505[_0x5979e2(0x4ba)](_0x186e63), _0x864723 = _0x13ef7a[_0x5979e2(0x505)]({ 'id': _0x370f29, 'blob': _0x553742 }); _0x864723['onsuccess'] = () => _0x42b187(_0x864723[_0x5979e2(0x5a7)]), _0x864723['onerror'] = () => _0x3cc4df(_0x864723[_0x5979e2(0x9de)]); }); } else { const _0x35200f = _0xe09b88[_0x3cb018(0x9bf)][_0x3cb018(0x6df)]()[_0x3cb018(0x9ac)](_0x4fb787); _0x46e7e5[_0x3cb018(0x647)] = _0x35200f; } } function _0x290d7a(_0x234bbb) { const _0x57906f = _0x49d781; if (_0x57906f(0x5ea) === _0x57906f(0x5ea)) return fetch(_0x234bbb)[_0x57906f(0x745)](_0x241aed => _0x241aed[_0x57906f(0x780)]()); else _0x4d273('有\x20' + _0xb617f9 + _0x57906f(0x7f7)); } let _0x4d126a = 0x0; for (let _0x8e1e43 = 0x0; _0x8e1e43 < localStorage[_0x49d781(0x36c)]; _0x8e1e43++) { const _0x4b7ef7 = localStorage[_0x49d781(0x956)](_0x8e1e43); if (_0x4b7ef7 && _0x4b7ef7[_0x49d781(0x3fd)](_0x49d781(0x25f))) { let _0x4a0489, _0x328e18 = ![]; try { if (_0x49d781(0x8a7) === _0x49d781(0x8a7)) { _0x4a0489 = JSON[_0x49d781(0x7a8)](localStorage['getItem'](_0x4b7ef7)); if (!Array[_0x49d781(0x79f)](_0x4a0489)) continue; for (const _0x52b569 of _0x4a0489) { if (_0x52b569 && _0x52b569[_0x49d781(0x911)] && _0x52b569[_0x49d781(0x911)]['startsWith'](_0x49d781(0x615))) { const _0xfa69f2 = await _0x290d7a(_0x52b569[_0x49d781(0x911)]), _0xd6f517 = _0x49d781(0x30e) + Date[_0x49d781(0x8a2)]() + '_' + Math[_0x49d781(0x1c0)](); await _0x700a5e(_0xd6f517, _0xfa69f2), _0x52b569[_0x49d781(0x431)] = _0xd6f517, delete _0x52b569[_0x49d781(0x911)], _0x328e18 = !![], _0x4d126a++; } } _0x328e18 && (_0x49d781(0x7c8) === _0x49d781(0x395) ? (_0x552c8(![]), _0x37a718[_0x49d781(0x9de)](_0x49d781(0x3a7), _0x2af419), _0x4f2040(_0x49d781(0x8e8) + _0x237df0[_0x49d781(0x740)])) : localStorage[_0x49d781(0x548)](_0x4b7ef7, JSON[_0x49d781(0x5e0)](_0x4a0489))); } else _0x1f2113['activeFriendCircleId'] = null; } catch (_0x5e94a2) { if (_0x49d781(0x2f6) !== 'gxdgv') { console[_0x49d781(0x9de)]('处理\x20' + _0x4b7ef7 + _0x49d781(0x417), _0x5e94a2); continue; } else _0xcc76bc[_0x49d781(0x9de)](_0x49d781(0x77f), _0x3a986a), _0x5eae43(_0x49d781(0x9b9) + _0x5e25a6[_0x49d781(0x740)]); } } } console[_0x49d781(0x331)](_0x49d781(0x8dd) + _0x4d126a + _0x49d781(0x557)); } async function _0xe62e7e() { const _0x181403 = _0x5ad424; console['log'](_0x181403(0x1c5)), console[_0x181403(0x331)](_0x181403(0x2a3)); async function _0x3c15c6(_0x1a22b3, _0x5aee8d) { const _0x5277ce = await _0x3be08a; return new Promise((_0x2cc2fd, _0x481a0e) => { const _0x2fbd65 = _0x118e; if (_0x2fbd65(0x3a0) !== _0x2fbd65(0x3a0)) _0x228342[_0x2fbd65(0x84a)] = _0x5a338f['image']; else { const _0x1f2a54 = _0x5277ce[_0x2fbd65(0x7c0)](_0x2fbd65(0x91f), _0x2fbd65(0x939)), _0x18c8d1 = _0x1f2a54['objectStore'](_0x2fbd65(0x91f)), _0x5a43fa = _0x18c8d1[_0x2fbd65(0x505)]({ 'id': _0x1a22b3, 'blob': _0x5aee8d }); _0x5a43fa[_0x2fbd65(0x265)] = () => _0x2cc2fd(_0x5a43fa[_0x2fbd65(0x5a7)]), _0x5a43fa[_0x2fbd65(0x9a7)] = () => _0x481a0e(_0x5a43fa[_0x2fbd65(0x9de)]); } }); } function _0x55c7c4(_0x427ee1) { const _0x16b614 = _0x181403; return 'rkfiP' === _0x16b614(0x56e) ? (_0x1c9fa3[_0x16b614(0x9de)](_0x16b614(0x77e), _0x3a5f7c), _0xb5a316['error'](_0x16b614(0x2da), _0x300f55[_0x16b614(0x80f)] || _0x3c969b), null) : fetch(_0x427ee1)['then'](_0x5e482b => _0x5e482b[_0x16b614(0x780)]()); } let _0x33de74 = 0x0, _0x503f7b = ![]; try { if (_0x181403(0x902) !== _0x181403(0x2a6)) { const _0x26a472 = localStorage[_0x181403(0x2c6)](_0x181403(0x52b)); if (!_0x26a472) { if (_0x181403(0x36b) === 'hXtdy') _0x1e675b[_0x181403(0x9de)]('Failed\x20to\x20remove\x20history\x20for\x20chat\x20' + _0x2e4c2d, _0x4410ef); else { console[_0x181403(0x331)](_0x181403(0x303)); return; } } const _0x4c0d12 = JSON[_0x181403(0x7a8)](_0x26a472); if (!_0x4c0d12[_0x181403(0x21f)] || !Array[_0x181403(0x79f)](_0x4c0d12[_0x181403(0x21f)])) { if (_0x181403(0x3e8) === _0x181403(0x3e8)) return; else { let _0x13f1e1 = null; const _0x4b4ecb = _0x11e9e9[_0x181403(0x295)][_0x181403(0x89c)](_0x16bd7e => _0x16bd7e[_0x181403(0x4de)][_0x181403(0x9ac)](_0x43c454)); for (const _0x356f44 of _0x4b4ecb) { const _0x23aca6 = _0x3ba4ab(_0x356f44['id']); if (_0x23aca6 && _0x23aca6['length'] > 0x0) { const _0x99e966 = _0x23aca6[_0x23aca6['length'] - 0x1]; (!_0x13f1e1 || _0x99e966['timestamp'] > _0x13f1e1[_0x181403(0x89b)]) && (_0x13f1e1 = _0x99e966); } } return _0x13f1e1; } } for (const _0x466dd6 of _0x4c0d12[_0x181403(0x21f)]) { if (_0x181403(0x6f9) === _0x181403(0x6f9)) { if (_0x466dd6[_0x181403(0x1e2)] && Array[_0x181403(0x79f)](_0x466dd6['posts'])) for (const _0x3ccb6d of _0x466dd6[_0x181403(0x1e2)]) { if (_0x181403(0x4b3) !== _0x181403(0x4b3)) _0x24f9bd[_0x181403(0x385)][_0x453ede] = _0xb3eff0[_0x5de754]; else { if (_0x3ccb6d && _0x3ccb6d['image'] && _0x3ccb6d[_0x181403(0x911)][_0x181403(0x3fd)](_0x181403(0x615))) { if (_0x181403(0x495) === _0x181403(0x495)) { console[_0x181403(0x331)](_0x181403(0x926) + _0x466dd6['name'] + _0x181403(0x95e)); const _0x569031 = await _0x55c7c4(_0x3ccb6d[_0x181403(0x911)]), _0x54c24c = _0x181403(0x73d) + Date['now']() + '_' + Math[_0x181403(0x1c0)](); await _0x3c15c6(_0x54c24c, _0x569031), _0x3ccb6d[_0x181403(0x431)] = _0x54c24c, delete _0x3ccb6d[_0x181403(0x911)], _0x503f7b = !![], _0x33de74++; } else _0x1f6810['error'](_0x181403(0x69f), _0x4999fa); } } } } else _0x32121a['error'](_0x181403(0x20b), _0x377aad), _0x378d9d(_0x181403(0x8ce)); } _0x503f7b && (console['log'](_0x181403(0x252)), localStorage[_0x181403(0x548)](_0x181403(0x52b), JSON[_0x181403(0x5e0)](_0x4c0d12))); } else _0x454e0f[_0x181403(0x956)] === _0x181403(0x487) && !_0x49b5a4[_0x181403(0x5ec)] && (_0x424321[_0x181403(0x7cc)](), _0x127f93()); } catch (_0x4562fe) { console[_0x181403(0x9de)]('净化好友圈时出错，真是的。', _0x4562fe); } return console['log'](_0x181403(0x4ea)), console[_0x181403(0x331)](_0x181403(0x768) + _0x33de74 + _0x181403(0x8e7)), _0x33de74; } async function _0x26cfcf() { const _0x1a8ae8 = _0x5ad424; console[_0x1a8ae8(0x331)](_0x1a8ae8(0x19a)), console[_0x1a8ae8(0x331)](_0x1a8ae8(0x465)); let _0x4f7df3 = 0x0, _0x3a81e8 = ![]; try { if (_0x1a8ae8(0x4df) !== 'qxZBG') _0x4dac85[_0x1a8ae8(0x226)] = _0x4cd62e[_0x1a8ae8(0x4a5)][0x0]['id']; else { const _0x52da13 = localStorage[_0x1a8ae8(0x2c6)]('appState'); if (!_0x52da13) { if (_0x1a8ae8(0x3f7) === _0x1a8ae8(0x40a)) _0x526680[_0x1a8ae8(0x331)](_0x1a8ae8(0x252)), _0x9a4019[_0x1a8ae8(0x548)](_0x1a8ae8(0x52b), _0x1a7d5c[_0x1a8ae8(0x5e0)](_0x2b62fd)); else return console['log']('聊天档案柜是空的，无需净化。'), 0x0; } for (let _0x2fb932 = 0x0; _0x2fb932 < localStorage[_0x1a8ae8(0x36c)]; _0x2fb932++) { const _0x515d56 = localStorage[_0x1a8ae8(0x956)](_0x2fb932); if (_0x515d56 && _0x515d56[_0x1a8ae8(0x3fd)](_0x1a8ae8(0x25f))) { if (_0x1a8ae8(0x65c) !== _0x1a8ae8(0x434)) { let _0x2c94f6, _0x10bd3f = ![]; try { if (_0x1a8ae8(0x393) !== _0x1a8ae8(0x53a)) { _0x2c94f6 = JSON[_0x1a8ae8(0x7a8)](localStorage[_0x1a8ae8(0x2c6)](_0x515d56)); if (!Array['isArray'](_0x2c94f6)) continue; for (const _0x62070f of _0x2c94f6) { if (_0x62070f && (_0x62070f[_0x1a8ae8(0x3b1)] === _0x1a8ae8(0x2b9) || _0x62070f[_0x1a8ae8(0x3b1)] === _0x1a8ae8(0x39a)) && _0x62070f[_0x1a8ae8(0x912)] && _0x62070f[_0x1a8ae8(0x912)]['startsWith'](_0x1a8ae8(0x615))) { const _0x2357ad = await _0x454232(_0x62070f[_0x1a8ae8(0x912)]), _0x1c498d = _0x1a8ae8(0x4bb) + Date[_0x1a8ae8(0x8a2)]() + '_' + Math[_0x1a8ae8(0x1c0)](); await _0x36c0a8(_0x1c498d, _0x2357ad), _0x62070f['coverId'] = _0x1c498d, delete _0x62070f[_0x1a8ae8(0x912)], _0x10bd3f = !![], _0x4f7df3++; } } if (_0x10bd3f) { if ('zJVDz' === 'zJVDz') localStorage[_0x1a8ae8(0x548)](_0x515d56, JSON[_0x1a8ae8(0x5e0)](_0x2c94f6)); else return _0x1b2877[_0x1a8ae8(0x1e5)](_0x5866a9), _0x22e6ef; } } else _0x422088[_0x1a8ae8(0x4a0)] === _0x546ac7 && (_0x5c25e0['boundUserProfileId'] = _0x352740[_0x1a8ae8(0x226)]); } catch (_0x141c36) { if ('ATPFz' === _0x1a8ae8(0x755)) { console[_0x1a8ae8(0x9de)]('处理\x20' + _0x515d56 + '\x20时出错，跳过。', _0x141c36); continue; } else { if (_0x59639c) _0x550349[_0x1a8ae8(0x68f)] = '❚❚'; } } } else { _0x111bb8['pendingPostAttachments'][_0x487e9f] = null; if (_0x5c37b8 === 'image') _0x245caf[_0x1a8ae8(0x1ce)][_0x1a8ae8(0x431)] = null; _0x461a96(); } } } } } catch (_0x3c0277) { 'KiFBA' === _0x1a8ae8(0x310) ? (_0x492d2f[_0x1a8ae8(0x385)]['position'] = _0x1a8ae8(0x50b), _0x56046a[_0x1a8ae8(0x385)][_0x1a8ae8(0x59b)] = _0x1a8ae8(0x9d4), _0x5ed21d[_0x1a8ae8(0x385)][_0x1a8ae8(0x2b1)] = '50%', _0x1f0064[_0x1a8ae8(0x385)]['transform'] = _0x1a8ae8(0x1f8), _0x21c8a9[_0x1a8ae8(0x385)][_0x1a8ae8(0x1cd)] = _0x1a8ae8(0x3d3)) : console['error'](_0x1a8ae8(0x4aa), _0x3c0277); } return console[_0x1a8ae8(0x331)](_0x1a8ae8(0x47c)), console['log'](_0x1a8ae8(0x768) + _0x4f7df3 + _0x1a8ae8(0x6f1)), _0x4f7df3; } function _0x66f827() { const _0x1dbe0e = _0x5ad424; if (!_0x128784[_0x1dbe0e(0x592)]) return _0x128784['userProfiles'][_0x1dbe0e(0x787)](_0x3f2b98 => _0x3f2b98['id'] === _0x128784[_0x1dbe0e(0x226)]) || _0x128784[_0x1dbe0e(0x4a5)][0x0]; const _0x5f5b96 = _0x128784[_0x1dbe0e(0x295)][_0x1dbe0e(0x787)](_0x5dc183 => _0x5dc183[_0x1dbe0e(0x3b1)] === _0x1dbe0e(0x921) && _0x5dc183[_0x1dbe0e(0x4de)]['includes'](_0x128784['activeDiaryCharacterId'])), _0x5a33dd = _0x5f5b96?.[_0x1dbe0e(0x4a0)] || _0x128784[_0x1dbe0e(0x226)]; return _0x128784[_0x1dbe0e(0x4a5)]['find'](_0x374baf => _0x374baf['id'] === _0x5a33dd) || _0x128784[_0x1dbe0e(0x4a5)][0x0]; } function _0x5f54() { const _0x432381 = ['导入失败了，笨蛋:\x20', '\x20条新动态。', 'https://sharkpan.xyz/f/xjwSX/pxjrjd.jpg', 'wgzFx', 'music-input-song', 'readwrite', 'qvvRl', 'transfer-amount-input', 'diary-modal-cancel', 'wLOEe', '正在检查好友圈数据...', 'SqAQq', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>', '条目已删除。', 'TTGmh', 'VDAcs', '222469PplrBZ', 'QLsgL', 'map', 'ENbKp', 'utterance', 'target', '图片处理失败:\x20', '</div></div><div\x20id=\x22categorized-expenses-list\x22\x20style=\x22margin-top:\x2010px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2010px;\x22></div>', 'OcRJo', 'gemini', 'YDbRV', 'back-to-home-from-settings', 'global-player-play-pause-btn', 'music-widget-card', 'ljCbT', '保存角色失败:', 'input_', 'claude', 'key', 'createElementNS', 'User', 'IWBgB', 'zXjyF', 'pZHaO', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-', 'findIndex', '\x22\x20中发现一张需要净化的图片...', 'https://sharkpan.xyz/f/zLes5/4lxzjn.jpg', 'system', 'VPUab', 'diary-get-reply-button', 'QHBkG', 'Cxulb', 'oKUDT', 'friend-circle-edit-bind-user', 'RRchT', '\x0a\x0a#\x20记忆库\x20(仅供参考)\x0a---\x0a##\x20最近的互动回顾\x20(来自聊天、见面和动态)\x0a', 'likes', 'rgba(0,\x200,\x200,\x200.4)', 'decorative-badge', '\x0a#\x20好友圈的主人\x20(“我”)\x0a-\x20姓名:\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', '已复制到剪贴板！', 'Tadov', 'horizontal', '\x20写道:\x20', 'Hqdgh', '正在整理…', '委屈那我歇了', '确定要导入全量备份文件吗？这将覆盖所有当前数据（包括图片和音乐），且操作不可撤销！', 'QtLiY', 'QSDxP', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'diary-entry-input', 'RQaXX', '导入失败:\x20', '</span></div>', 'status', 'BVrwc', '好友圈已删除。', 'chat_image_', 'kYLXn', 'https://sharkpan.xyz/f/7L3Hj/sl4504.jpg', 'EZjiC', 'vYHmd', 'world-book-edit-name', '加载壁纸失败:', '\x22\x20已删除。', 'listen-together-ui', 'back-to-home-from-diary-list', 'vpXlr', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天还没有花钱哦。</p>', '[发送了图片]', 'user_', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>', 'RjihT', '.bubble-', '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22><span\x20style=\x22background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20width:\x2040px;\x20height:\x2040px;\x20display:\x20inline-flex;\x20justify-content:\x20center;\x20align-items:\x20center;\x20flex-shrink:\x200;\x20color:\x20var(--accent-color);\x22>', 'recipientId', 'galgame-time', '\x0a#\x20交换日记摘要\x20(你和\x20', 'pDvkN', 'https://sharkpan.xyz/f/wyeIq/phhdy2.jpg', 'save-world-book-button', 'italic', 'hdjzT', 'gclvy', 'IbOmB', 'chat-sticker-button', 'jzsNS', 'music-widget', 'transfer-recipient-select', 'edit-message-modal', 'beforeend', '#\x20总结失败了，可能是记录太长或太复杂。', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'ssLWB', '别这样嘛我哭哭', 'GuSRq', 'onerror', 'context-lines-per-chat', 'world-book-editor-screen', 'Jzaga', '有点无语', 'includes', 'querySelector', 'lastIndexOf', 'UhUkj', 'jizrY', 'https://sharkpan.xyz/f/djjH8/29ejbg.jpg', 'ZQBIs', 'authorId', '的个人专属世界观设定\x0a', 'xAwxG', '.widget-info\x20>\x20div', '\x20的《', 'feed', '搜索失败:\x20', '#ff9999', '选择聊天', '[AI分享了音乐：', 'sJKZi', 'createObjectURL', 'value', 'xoxEr', 'cover-file-input', 'nCBul', 'mvZou', 'friend-circle-member-selection', '小时前），可以简单问候一下对方现在的状态。\x0a', 'Gemini\x20stream\x20reading\x20aborted.', 'card-widget-2', 'onclick', '下载并转换网络封面失败:', 'currentAbortController', 'meeting-scene-view', 'join', '\x20条动态...', 'chat-get-reply-button', 'KCgJb', 'kzakI', 'chat-send-button', 'events', 'amount', '34%', 'model-dropdown', '.listen-together-accept-btn', '<path\x20d=\x22M12\x202v20\x22></path><path\x20d=\x22M4\x2012h16\x22></path>', 'BgNVZ', 'JRoDU', 'WRpCM', 'Error\x20fetching\x20from\x20', 'group-clear-history-button', '保存壁纸失败:\x20', 'error', '未找到可用模型。', '好友圈名称不能为空！', '好了，请基于以上所有信息，开始写今天的日记吧。', 'rtScW', 'gYbkI', 'zWuZr', 'pYpMX', 'pGBft', '(想转账给“', 'cdOVz', 'ggpZq', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '未命名角色', '\x20个成员', '\x0a\x20\x20相关记忆:\x0a', 'NTwEO', 'pending-post-image-preview', 'hNBZq', 'xTAvK', 'VxytG', 'kGuCs', 'choice-cancel', 'pECtS', 'worldBooks', 'BjVHI', 'user-post-attachment-preview', 'review', 'dialogue', 'auto', '\x0a#\x20核心任务\x0a你是一个顶级多角色社交模拟引擎。你的任务是模拟一个好友圈的动态更新，一次性生成【', 'group-edit-name', 'info-file-input', 'Noir_FileSystem', 'quote-preview-sender', 'widget-next-btn', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22group-options-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-clear-history\x22\x20class=\x22choice-modal-button\x22>清空聊天记录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-members\x22\x20class=\x22choice-modal-button\x22>编辑群成员</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-name\x22\x20class=\x22choice-modal-button\x22>修改群名称</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#ff4d4d;\x22>删除群聊</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-options-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'is-exiting-right', 'feed-bg-input', '加载见面背景失败\x20for\x20', 'musicLibrary', 'HwExl', '---\x20Noir\x27s\x20Music\x20Cover\x20Purification\x20Ritual\x20---', 'width', '<button\x20id=\x22re-record-button\x22\x20class=\x22header-button\x22>重新记录</button>', 'ubJNA', '60%', 'DweTg', 'uWwBT', 'IndexedDB\x20failed\x20to\x20open', 'filled', 'toLocaleString', 'delete-friend-circle-button', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'jKlKJ', 'expense-item', 'yOnQf', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', 'chat-message-input', 'group-settings-screen', '117575IXteqY', 'yIvMt', 'wWZEd', '#bubble-preview-user', 'srxUL', '找不到要清空的聊天记录。', 'tjBrO', '哼，正在开始净化你那被污染的聊天记录...', 'listen-together-backdrop', '至少要选择一个圈内成员！', 'WxLDR', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>', 'provider', 'yyhXM', 'character-item', 'https://sharkpan.xyz/f/N02Sv/378vt6.jpg', 'widgetBgImage', '错误：你还没有创建任何好友圈。请先在App内创建一个。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'QDxin', 'random', 'touchend', 'bFUcd', 'is-entering-from-left', 'NHExo', '---\x20Noir\x27s\x20Friend\x20Circle\x20Purification\x20Ritual\x20---', 'wgfdD', 'JRpil', 'vHivq', '请先输入\x20API\x20接口地址和密钥。', '\x20页</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-next-button\x22>下一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'clockPosition', '<path\x20d=\x22M10\x2020.5l.5-.5.5.5\x22></path><path\x20d=\x22M12\x2018l.5.5.5-.5\x22></path><path\x20d=\x22M14\x2020.5l.5-.5.5.5\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x227\x22></circle><path\x20d=\x22M12\x203v1\x22></path><path\x20d=\x22M12\x2019.5v1.5\x22></path><path\x20d=\x22M18.36\x205.64l-.7.7\x22></path><path\x20d=\x22M6.34\x2017.66l-.7.7\x22></path><path\x20d=\x22M21\x2012h-1.5\x22></path><path\x20d=\x22M4.5\x2012h-1.5\x22></path><path\x20d=\x22M18.36\x2018.36l-.7-.7\x22></path><path\x20d=\x22M6.34\x206.34l-.7-.7\x22></path>', 'display', 'pendingPostAttachments', 'color', 'appIconPosition_app-world-book', 'displayedMessageCount', 'songName', 'JTNJh', '15px\x2020px', 'user-send-post-button', 'save-char-button', '50%', '16rzjrkM', 'aXwGr', 'getContext', 'import-all-data-button', '请严格按照以下SCHEMA返回一个JSON对象，不要包含任何额外文字。\x0aSCHEMA:\x0a', ']\x20[sticker:', 'parentElement', '加载立绘失败:', 'appIconPosition_', 'borderRadius', 'posts', 'tNliI', 'https://sharkpan.xyz/f/1zQH2/o84boo.jpg', 'push', '#ffcc66', 'charId', '\x22\x20src=\x22', '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>', 'luAwt', '新用户\x20', 'NfBOR', 'wIdUV', 'delete-world-book-button', '<div\x20class=\x22listen-together-header\x22\x20style=\x22text-align:center;\x22>🎵\x20已连接，正在一起听\x20🎵</div>', 'className', '1080yLZAsB', 'wallpaper_main', 'song_', '1332780GxVIqm', 'widget-title', 'application/json', 'copy-summary-button', 'translateX(-50%)', 'reverse', 'Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20', 'save-group-settings-button', 'LYmhz', '\x20的私聊', 'wzXDU', 'chatWallpaper', '\x0a\x0a#\x20任务要求\x0a1.\x20\x20**全局视角**:\x20扮演所有成员，思考他们看到这条动态（包括图片）后会作何反应。\x0a2.\x20\x20**生成互动**:\x20为每个角色决定是否点赞，以及要发表什么评论。评论必须符合角色性格并与所有已知信息（聊天、日记等）相关联。\x0a3.\x20\x20**输出格式**:\x20你的输出必须是一个单一、完整的JSON对象，结构如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a-\x20【绝对规则】:\x20所有ID必须使用上面提供的角色ID，不能用名字。\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。\x0a', 'pKuyY', '<input\x20type=\x22checkbox\x22\x20value=\x22', 'addEventListener', 'group-edit-members', 'aQcIb', 'kfMmS', '正在为你搬运旧壁纸到新仓库...', 'ykTue', '樱花薄粉', 'musicPlaylist', 'Failed\x20to\x20save\x20history\x20to\x20localStorage:', 'JbUtu', 'read', '#app-dock-bottom-left\x20#', 'modal-root', 'is-exiting-left', 'MTxbI', '加载自定义表情包失败，真是没用。', 'saoca', '<div\x20class=\x22post-body\x22>', 'app-diary', 'tbpLi', '<div\x20class=\x22post-image-container\x22><img\x20id=\x22', '\x20(ID:\x20', '未知歌曲', 'https://sharkpan.xyz/f/AaDTZ/tzwnjl.jpg', 'url(', 'touchmove', 'wallpaper-input', 'tPqhD', 'friendCircles', 'char-edit-offline-bg-input', '确定要删除角色“', '我是女仆', 'html-module-container', '你还没保存这个角色呢，导什么导？', 'char-edit-persona', 'activeUserProfileId', 'sSxjf', '<div', 'joYeM', 'post_', 'choice-create-character', 'eAYzz', 'VStuv', 'splice', 'MMUSg', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5OTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDJhNC4zOSA0LjM5IDAgMCAtMy4yOC00LjA5TDE1IDIwIj48L3BhdGgPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCI+PC9jaXJjbGU+PC9zdmc+', '图片加载失败', 'https://sharkpan.xyz/f/ajwtY/x03qxn.gif', '点击选择\x20.lrc', 'eQRkG', '-\x20[动态]\x20', 'writeText', 'url', 'char-edit-wallpaper-input', 'BGsLX', 'OAxFT', '正在连接同步频道...', 'HqwZP', 'clear', 'music-library-screen', 'HLAmy', 'galgame-sprite', 'https://sharkpan.xyz/f/4aqCj/gp13hn.jpg', 'data', 'postType', 'play', '#diary-action-cancel', 'vFDoK', 'HsBPW', '角色已保存！', 'canvas', 'oACny', '\x20之间。\x0a-\x20所有表情包名称【必须】从\x20`stickerList`\x20列表中选择，严禁使用列表之外的名称。\x0a-\x20角色之间需要有适当的互动,话题不应当完全围绕', '1em', '星期四', 'pxMQt', 'kTqpj', 'generativelace.googleapis.com', 'https://sharkpan.xyz/f/nj5Ul/ksdl8n.jpg', '好友圈净化完成，正在重新存档...', 'qFkQb', 'jlTvi', 'yKeJi', 'match', 'readonly', '未知表情', 'DAEjl', 'fontStyle', '#bubble-preview-ai', 'custom-stickers-input', 'ASujT', '获取AI响应失败:', 'chatHistory_', 'FydgD', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的账本还是空白的。</p>', 'jcOtl', 'toLocaleDateString', 'button', 'onsuccess', 'add', 'characterId', 'api-model', 'opacity', '日记已删除。', 'createElement', 'show-chat-view', '<img\x20src=\x22', '升级已取消。旧版图片数据可能导致应用卡顿或出错。', 'jDcpJ', 'setDate', 'svg', 'change', 'cancel', 'chat-sticker-panel', 'files', 'vziLY', 'characters', 'EGIng', '[图片]', 'xRlzG', 'historyIndex', 'kUvab', '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20', 'sprite-confirm-button', '确定要清空好友圈“', 'card-widget', 'label', 'decode', 'AI似乎没有想出任何新动态。', 'RHtGI', '#\x20核心任务:\x20财务分析与多角色吐槽\x20(单次请求完成)\x0a你是一个高级AI，需要一次性完成对用户消费流水的分类，并为每一笔消费生成一个符合角色人设的吐槽。\x0a\x0a#\x20规则\x0a1.\x20\x20**逐条处理**:\x20你必须处理我提供的【所有】消费记录。\x0a2.\x20\x20**精准分类**:\x20为每条记录从【固定分类列表】中选择一个最合适的分类。\x0a3.\x20\x20**人格切换吐槽**:\x20为每一条记录，你必须从【角色资料库】中【随机选择一位】，然后【严格代入】该角色的人设，并【假定】这笔消费是该角色【绑定的用户】所为，然后写一句简短吐槽。\x0a4.\x20\x20**JSON输出**:\x20你的输出**必须**是一个完整的、语法正确的JSON数组。每个对象代表一笔消费，且必须包含\x20\x22description\x22,\x20\x22amount\x22,\x20\x22category\x22,\x20和一个\x20\x22review\x22\x20对象。\x0a\x0a#\x20输出格式示例\x0a```json\x0a[{\x22description\x22:\x20\x22乌龟\x22,\x22amount\x22:\x205.00,\x22category\x22:\x20\x22购物消费\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512586032\x22,\x22text\x22:\x20\x22又买这些没用的东西，哼。\x22}},{\x22description\x22:\x20\x22奶茶\x22,\x22amount\x22:\x2012.00,\x22category\x22:\x20\x22餐饮美食\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512604818\x22,\x22text\x22:\x20\x22偶尔喝一杯放松一下也不错。\x22}}]```\x0a#\x20最终指令\x0a请严格按照以上规则，分析流水，并返回JSON数组。直接从\x20`[`\x20开始输出。', 'JFPPa', 'snkIT', 'YLIge', 'shift', 'QBjEc', '导入角色卡失败:', 'gbOoj', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', '\x22\x20class=\x22post-image\x22></div>', '_NoirCard.json', 'app-meeting', '动态页背景已更换！', '收到的原始、有问题的文本:', 'sDAXP', '--\x20点击选择\x20--', 'chats', '有点破防', '\x22\x20class=\x22char-name\x22>', '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“', 'FUJUz', 'upload-card-button', 'zBgYF', 'PKQnd', '（对话结束）', 'addTestPost', 'sad', 'MDLTR', '正在升级聊天数据结构...', 'ltAoq', '哼，正在净化你那些被污染的好友圈动态...', '72%', '无法从\x20IndexedDB\x20加载聊天图片:', 'fbfCB', 'upload-wallpaper-button', '用户已删除。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>', 'artist', 'edit-message-textarea', '\x20转账\x20', 'https://sharkpan.xyz/f/Ganul/78iwli.jpg', 'app-music', 'chat-transfer-button', 'CVmtL', 'left', 'https://i.pinimg.com/736x/16/f9/05/16f9051f99471208ee9c658aa4618eb6.jpg', 'expense-description', 'floor', 'GyQAo', '。\x0a-\x20再次强调：你的全部输出都将被作为JSON解析，任何JSON主体之外的额外文字都会导致程序失败。\x0a', '星期日', 'https://sharkpan.xyz/f/0GKHX/mthvno.jpg', 'music', 'character-list', 'ZhrZY', 'clipboard', 'galgame-sprite-container', '</div>', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '[用户发起了听歌邀请:\x20', '#member-select-', 'DyKli', 'LxLpD', 'BhrSG', 'OtUNC', 'getItem', 'transform', '#friend-circle-member-selection\x20input:checked', 'edit-delete-char-button', 'backgroundImage', 'input', '准备调用\x20generateAs...', 'round', '\x0a\x20\x20\x20\x20-\x20世界书[', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'signal', '解析AI剧本JSON失败:', '徽章已更换！', 'RVxZs', '35%', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'gozuI', 'isGenerating', 'jHONP', 'WxEmn', 'AI返回的原始文本:', 'Failed\x20to\x20plan\x20group\x20replies:', 'ItCId', 'music-player-bar', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20', 'input[type=\x22checkbox\x22]:checked', '.custom-multiselect', 'gsNKv', '这是一条由控制台添加的测试动态！样式看起来非常完美。', 'qCpCl', 'AZjSb', 'gOGtE', ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[', 'SqqYj', '”已成功导入！', 'ended', 'WUyFj', 'https://sharkpan.xyz/f/v0qcL/dio7j0.jpg', 'organize-button-container', '请输入新的群名称：', '生成动态失败:', 'friend-circle-title', 'audio', 'bTnPy', '<span\x20class=\x22', 'music-post', 'isFinite', '确定要恢复这个角色的默认立绘位置吗？', 'vGgiO', 'bmDVu', 'music-library-container', 'oQtqS', '最近没有动态记录。', 'Failed\x20to\x20parse\x20state\x20from\x20localStorage,\x20resetting.', 'galgame-sprite-adjust-ui', '保存失败:\x20', 'lyrics-file-input', 'phone-container', 'xSrdU', 'world-book-screen', 'mFSHF', '好友圈档案柜是空的，无需净化。', 'qnvQf', 'LLMYM', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>', 'body', 'AI未能返回有效的JSON对象。', ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20', 'home-screen', 'transfer-recipient-group', 'checked', 'ojAqa', 'chat_image_migrated_', 'lyric-line-', 'WFByF', 'iKMlU', 'diary-next-button', '\x0a-\x20你正在为一个名为“', '--widget-cover-image', '.choice-modal-backdrop', 'summarize-backdrop', '1809978vacGzR', '新角色\x20', '错误：找不到这首作为“信物”的歌。', 'altar-slot-info', '成功向好友圈\x20\x22', 'itzKc', 'friend-circle-edit-title', 'jRHob', 'ukPFL', 'toDateString', 'musicUploadAltar', 'tqnFO', 'IHgBl', '啥意思捏', '\x0a\x20\x20\x20\x20姓名:\x20', 'galgame-textbox-container', '这本日记本来就是空的，你还想清空什么？', 'vnkIw', 'accounting-content-area', 'card-image', '已经生成了今日账单！想看就去“看账本”标签页。', 'worldBookEditor', '刷我的卡', 'modal-ok', 'OmOrM', 'cos', 'log', 'pnkXX', '正在迁移旧的用户数据...', 'gXWoO', 'PvHBV', 'chat-screen', '\x0a\x20\x20\x20\x20人设:\x20', 'SNKjX', '今天一笔账都没有，我整理什么？', '我来搞定', 'sticker', 'toBlob', '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>', 'right', 'svgEF', 'PcapR', 'linkedWorldBookIds', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'card-input-2', '导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a', 'https://sharkpan.xyz/f/DVJtK/vxiup1.jpg', 'borderBottom', 'XGOFF', 'documentElement', 'AbortError', 'defaultPrevented', 'getAll', 'add-friend-circle-button', 'Failed\x20to\x20remove\x20corrupted\x20state\x20from\x20localStorage:', 'ZqJmL', 'toggle', 'openai', '\x20张旧封面。应用即将刷新。', 'reset-widget-bg-button', '错误：找不到此好友圈绑定的用户！', 'cxTCZ', 'New\x20request\x20started', '#FFFFFF', 'apHru', 'VyNBI', '请输入有效的转账金额！', 'KXVDb', 'WsSsy', 'vEduT', 'span', 'firstChild', 'lyrics', 'reload', 'ExJTL', '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概', 'diaryPressTimer', '已恢复默认。', '#message-anchor', '\x0a你是一个严格的JSON生成引擎。\x0a你的唯一任务是根据用户提供的指令和数据，生成一个描述角色互动的JSON对象。\x0a你的输出【必须】是、也只能是一个单一、完整、语法正确的JSON对象。\x0a严禁包含任何解释、注释、道歉、或Markdown代码块标记\x20```json。\x0a直接输出\x20{\x20\x22events\x22:\x20[...]\x20}\x20结构。\x0a', 'select', 'fbDXy', '/v1/models', '错误:\x20', 'lVqbx', 'length', '\x0a#\x20最近的朋友圈动态\x20(供你参考)\x0a', 'cfOHo', 'playableUrl', 'getFullYear', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '星期二', 'https://sharkpan.xyz/f/Mamca/4e3emf.jpg', 'min', 'customFeedWallpaper', 'adPpq', '--feed-bg-image', 'theme-widget-1', 'customStickers', ':</span>\x20', 'bQYhn', 'lUbPC', '错误：第一个好友圈\x20\x22', '事情好多', '天没动静了。你的角色们应该发起新的问候或话题。', 'categorized-expenses-list', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'RHGhR', 'some', '#c299ff', 'style', 'tencent', '##\x20来源：', '\x20之间的私密内容)\x0a', 'friend-circle-list-container', 'author', 'char-edit-avatar-input', 'sin', 'editing-user-id', 'char_avatar_', 'title', 'vjBnz', 'gtTsm', 'init', 'FuDXK', '昨天\x20', 'IrxlK', 'meetingList', '暗夜紫晶', 'Tewys', 'PgzPj', 'listen-together-invite', 'user-post-avatar', 'circle_', 'POST', 'chat-view-pane', 'eDAzB', 'TYUuO', 'toString', 'jLdbH', '人情红包', 'cancel-quote-button', '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。', 'Uqedo', '解析音乐文件失败:', 'cancel-edit-button', 'htXCk', '生成动态回复失败:', 'FXbYz', 'header-actions', 'LaPsi', 'WfrWn', 'insertAdjacentHTML', '徽章已移除。', 'type', '星期一', '59%', 'download', 'pop', 'yNiQY', 'stopPropagation', 'back-to-home-from-meeting-list', 'quoted-sender', 'HpAom', '真是的，必需的祭品都还没准备好！', '个人资料已保存！', '.lt-end-session-btn', 'YGEGM', 'closest', 'poPMy', '&alt=sse', 'kWPAy', 'add-choice-modal', '对方正在行动中...', ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“', 'delete-expense-btn', 'group-options-cancel', 'pcScT', 'UlIYL', 'user-avatar-preview', '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', 'perChatContextLines', 'AqHae', 'paddingBottom', 'hhjJx', 'marginTop', 'characterLastScripts', 'group-settings-name', 'block', 'user-profile-edit-title', 'appendChild', '一起听歌', 'loading', 'eNfuQ', 'AYeZB', 'https://sharkpan.xyz/f/8ngsj/ax0fat.jpg', '好像有动态了...', 'RdayC', 'music-library-item', '创建新用户', 'back-to-world-book-list', '.load-more-btn', 'iBHNt', '歌曲“', 'iGxFS', 'back-to-diary-list', '数据导入成功！应用即将刷新...', '猫猫撒娇', 'XyKqg', 'oouLE', 'NqPuB', 'odoSK', '确定要重置所有桌面小组件和App的位置，并将壁纸变为纯白吗？此操作后将刷新页面。', 'diary-list-container', '卡片\x202\x20已更换！', 'cpZXn', 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20', '薄荷水色', 'char-name-header', 'onloadend', 'backgroundColor', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>', '不高兴撒娇', 'zGlev', '切换聊天时发生异步错误:', 'head', 'back-to-chat-from-group-settings', '未知艺术家', 'qitee', 'startsWith', '加载徽章图片失败', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'JZMvn', 'diaries', 'ltOPB', ':streamGenerateContent?key=', 'reply', 'no-action-modal', '（正在构思中...）', '\x0a-\x20人设:\x20', 'FIXDK', 'SbSUv', 'vcOHG', 'NJUtU', 'htKJb', '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a', '”已存入圣殿。', 'https://sharkpan.xyz/f/z1xc5/iore2n.gif', 'DEfrH', 'drawImage', 'WYrqD', '哼，这不是图片，你想让我压缩什么？', 'image/jpeg', 'themeHue', '获取中…', '\x20时出错:', 'gXHzh', 'tGrXl', 'ggGiJ', '同步已断开。', 'option', 'yexpG', 'isAnimatingDiary', 'localStorageData', '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。', 'classList', '\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-', '设置已保存！', 'WdODe', '保存播放器状态失败，真是没用。', '\x22\x20id=\x22', 'app-chat', 'music_library', 'pnUmA', '正在清空旧数据...', '-input', 'diary-modal-save', 'WYuWn', 'onupgradeneeded', 'https://sharkpan.xyz/f/LZwu7/m7vx2q.jpg', 'preferences', 'imageId', '无法读取状态，浏览器可能禁用了存储功能。', 'IKHLi', 'eYzEV', 'ZMynN', 'Hbpqw', 'jQNGU', 'HjyKF', 'indexOf', '正在打包“', 'ceil', 'oVqor', '#group-settings-screen\x20.selected-options-text', 'WmRQw', 'cursor', ';\x22>', 'speaker-user', '（开始一段新的对话...）', 'VGTkK', 'normal,\x20happy,\x20angry,\x20sad,\x20shy', 'mflpV', '导出角色卡失败:', '\x22\x20accept=\x22image/*\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x22\x20onclick=\x22document.getElementById(\x27input_', 'https://sharkpan.xyz/f/N0VCv/5rd8br.jpg', 'is-playing', 'https://sharkpan.xyz/f/ABwhZ/twknmr.jpg', '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a', '刚刚发布了一条动态，内容是：“', '桌面已重置，即将刷新...', 'none', '-\x20**你们最后一次互动是在**:\x20', 'mousedown', '”的补充信息\x0a', 'jwIZR', 'p[data-history-index]', 'characterEdit', 'WBKMl', 'href', 'CNvAc', 'group-bg-preview', 'HbnpC', '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1', '\x0a\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22', 'TxeGC', '哼，不好好写清楚花在哪、花了多少，我怎么记？', '赞同！渲染效果一级棒！', 'choices', '#ffb366', '\x20[并附上了一张图片]', 'activeFriendCircleId', 'back-to-home-from-circle-list', 'getSelection', '哼，正在净化你那些超重的音乐分享记录...', '\x0a\x0a#\x20关于对话者“', 'FmdhY', 'kind', 'emote', '群聊设置已保存！', '星期三', 'confirm-altar-upload-button', 'PEHai', '\x0a\x20\x20人设:\x20', 'OWErz', 'jkjtV', '.message.user', 'content', 'EEEoA', 'KUEtS', '点击选择\x20info.txt', '.diary-delete-btn', 'jIeCJ', 'scrollIntoView', 'EdypA', 'accounting-title', '星期五', '---\x20音乐净化仪式完成\x20---', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>', 'UKUUL', 'anthropic.com', 'QZOHs', '10px\x20auto', 'replaceAll', 'expanded', 'uDTcE', 'user-post-textarea', 'Enter', 'Fetch\x20request\x20was\x20aborted.', 'persona', 'QcktR', 'reset-widgets-position-button', 'HHoXh', '群聊“', 'XcvOf', 'delete', 'tnJYO', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '[AI向\x20', 'https://sharkpan.xyz/f/kjOF6/zedyqb.jpg', 'isFromLibrary', 'rrjmx', 'daily-expenses-list', '乐于助人的助手', '8px', '.page-dot', 'endsWith', '确定要删除这个条目吗？此操作不可撤销。', '的日记本', 'querySelectorAll', '---\x20开始AI回复流程\x20---', 'back-to-home-from-music-library', 'boundUserProfileId', 'abort', 'app-music-library', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '[用户向\x20', 'userProfiles', '好友圈数据升级完成，迁移了\x20', '.no-action-modal', 'fcztU', 'model', '净化音乐封面时出错，真是的。', 'tdpaz', 'EjtTI', 'preview-item', '</div><div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x22>', 'widget-prev-btn', 'angry', '\x20说：“', 'chat-summarize-button', 'zxlZr', 'customIcon_', 'getDay', 'avatar', 'PnseI', 'Assistant', 'GczlU', 'objectStore', 'music_cover_migrated_', 'organize-bill-button', 'timeupdate', 'VMccx', 'alignItems', 'https://sharkpan.xyz/f/djyi8/1en214.jpg', 'yNoXC', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '确定要清空\x22', '”\x20\x0a\x20你必须针对这段内容表达你的看法、感受或关联的思考。\x0a2.\x20\x20**【次要任务：分享自我】**\x20在回应之后，你**必须**分享一些关于你自己的、读者**不知道**的新鲜事。可以是你今天的见闻、一个突然的想法、或者一件小小的秘密。不要总是复述你们已经聊过的内容！\x0a3.\x20\x20**【禁止复读】**\x20聊天记录和动态只是你的“背景记忆”，是用来确保你不OOC的参考，**绝对不是**你日记的主要内容！\x0a\x0a#\x20你的核心人设\x20(必须遵守)\x0a', 'utFzr', 'mztmr', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22></div><div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22><div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>', 'role', '</svg>', '#99ff99', '--primary-hue', 'form-button\x20load-more-btn', '\x0a\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a-\x20**当前精确时间**:\x20', 'center', 'forEach', 'add-chat-button', '\x20张旧图片。应用即将刷新。', 'groupSettings', 'flex', 'char-edit-bind-user', 'widget_card_2', 'VClRV', 'scrollTop', '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。', 'name', '未知角色', 'qJaOJ', 'http://www.w3.org/2000/svg', 'participantIds', 'qxZBG', 'touches', 'transfer', 'worldBook', 'SSbjW', '原始文本:', 'settings-screen', 'https://api.vkeys.cn/v2/music/', 'IxYko', '-\x20[', 'Svyqz', '---\x20好友圈净化仪式完成\x20---', '当前聊天', 'close-summary-button', '0\x200\x20', 'gCAIC', '医疗健康', 'https://sharkpan.xyz/f/7aMhj/hyc75m.jpg', 'accountingLedger', 'editing-char-id', 'DXQtp', 'TXBlh', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '.char-info-wrapper', '<div\x20id=\x22accounting-input-area\x22\x20style=\x22margin-bottom:\x2020px;\x22><div\x20class=\x22input-group\x22><label\x20for=\x22expense-description\x22>花在哪了？</label><input\x20type=\x22text\x22\x20id=\x22expense-description\x22\x20placeholder=\x22例如：一杯奶茶\x22></div><div\x20class=\x22input-group\x22><label\x20for=\x22expense-amount\x22>花了多少？</label><input\x20type=\x22number\x22\x20id=\x22expense-amount\x22\x20placeholder=\x22例如：15\x22></div><button\x20id=\x22add-expense-button\x22\x20class=\x22form-button\x20primary\x22\x20style=\x22margin-top:\x2015px;\x22>记下了</button></div><h3\x20style=\x22margin-bottom:\x2010px;\x22>今日流水</h3><div\x20id=\x22daily-expenses-list\x22\x20style=\x22max-height:\x20300px;\x20overflow-y:\x20auto;\x22></div><div\x20id=\x22organize-button-container\x22\x20style=\x22margin-top:\x2020px;\x22></div>', 'touchcancel', 'user-post-music-button', 'var(--text-color)', 'iyCTx', 'fill', '为你骄傲', 'user-persona', 'Canvas\x20to\x20Blob\x20conversion\x20failed.', 'user', '。你的日记是写给Ta看的。\x0a\x0a#\x20写作【最高指令】\x0a1.\x20\x20**【首要任务：回应读者】**\x20你的第一要务是**回应**读者（', '\x0a-\x20**对话状态**:\x20群里已经有', '编辑条目', 'cqrcX', 'put', 'phvqV', 'ibrLK', '<path\x20d=\x22m3\x209\x209-7\x209\x207v11a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2z\x22></path><polyline\x20points=\x229\x2022\x209\x2012\x2015\x2012\x2015\x2022\x22></polyline>', 'ETyPz', 'userProfile', 'absolute', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'DJYpw', 'activeMeetingCharId', '名字不能为空！', 'chat-image-input', 'sRBMR', 'message-container', '好友圈\x20', 'group_avatar_', 'emoji', '</span>', 'BBIqJ', 'bubble-', 'NRfGs', '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[', 'JSON\x20解析失败!\x20错误原因:', 'ddYRP', 'iZZrF', 'jSbZZ', 'true', 'app-world-book', '在准备动态回复时，读取图片失败:', 'rfmhx', '很期待', 'char_offline_bg_', 'audio-file-input', '29%', '很好哦', '\x22\x20的聊天记录吗？此操作不可撤销。', 'mblCQ', 'SeYTa', 'appState', '28%', 'insertBefore', 'https://sharkpan.xyz/f/gjySw/jrl7rw.jpg', 'OacbX', 'meetingViewMode', 'Flbbv', 'PkMYX', 'ObQWZ', ',\x20ID:\x20', 'FrmaM', 'meetingView', 'tjTRG', '-\x20姓名:\x20', 'memberCharacterIds', 'lqEvz', '确定要删除这个用户吗？与此用户绑定的聊天将恢复为默认用户。', '导出过程中发生严重错误:\x20', 'scrollHeight', 'appIconPosition_app-music-library', 'diaryList', 'remark', 'aAVpu', 'is-visible', 'backgroundPosition', 'wdieq', 'fjdzq', 'edit-clear-history-button', '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>', 'setItem', 'diaryCurrentPage', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', 'https://sharkpan.xyz/f/pKWCQ/ztxwv0.jpg', 'paekt', '#66b3ff', '休闲娱乐', 'themeWidget1State', 'reset-feed-bg-button', '勉强但是好吧', 'meeting-list-screen', 'transfer-backdrop', 'uZOsD', 'speaker', 'EuDFN', '\x20张旧图片。', 'https://sharkpan.xyz/f/Qpzu6/3b30r2.jpg', 'JRqNq', 'LNPih', 'replace', 'indexedDBData', 'editing-friend-circle-id', 'cardWidgetState', 'clientX', 'xVmNQ', '.app-icon', 'home-date', 'ByNSi', 'lHDIg', 'pointer', 'https://sharkpan.xyz/f/ljVCx/b16h2z.jpg', '正在翻阅全部历史记录...', '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'translateX(-', '条新动态挑选发布者。你可以让同一个人发布多次，也可以让不同人发布。\x0a3.\x20\x20**创作动态**:\x20扮演你选中的作者，创作符合其人设和记忆的动态内容。可以是文字或分享音乐。\x0a4.\x20\x20**模拟互动**:\x20为每一条你创作的动态，切换视角到【圈内其他成员】，模拟他们可能做出的点赞和评论。互动必须符合他们各自的性格。\x0a\x0a#\x20输出格式【绝对规则】\x0a-\x20你的输出**必须**是一个语法完全正确的、单一的JSON数组，包含\x20', 'mmZuq', '正在解析角色卡...', 'mlJtC', 'NvygL', 'input[type=\x22checkbox\x22]', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>', '该角色', 'diary-prev-button', '分钟前', 'app-wallpaper', '正在迁移旧的动态数据到新的好友圈系统...', 'active', 'mrIsZ', 'hgKgy', 'offline-scene-view', 'eJmUX', '已选择\x20', 'displayUrl', 'cXHnA', 'lt-ui-cover-art', '2023-06-01', '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202h-14a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011v-7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v7\x22></path><path\x20d=\x22M9\x204v3\x22></path>', 'object', 'settings', '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22', 'badgeState', '\x0a\x0a#\x20用户资料库\x0a', 'asXQD', '\x20[并分享了歌曲:\x20', 'ehxJI', 'hUagd', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/epv2AAAAABJRU5ErkJggg==', 'modal-mask', '</span>:\x20', 'canplaythrough', '.typing-indicator', '导出失败了，哼:\x20', 'uEHaN', 'musicFeed', 'activeDiaryCharacterId', '[sticker:', '错误：找不到角色', 'removeChild', 'VPCJz', '群聊\x20(', 'marginBottom', 'https://sharkpan.xyz/f/6Dzia/m9smvt.jpg', '大家好像不知道该怎么回复...', 'top', 'lt-ui-close-btn', 'HoVYW', '音乐搜索失败:\x20', 'anthropic', '卡片已移除。', '\x0a\x0a#\x20最近的动态回顾\x20(供参考)\x0a', 'odKpc', '在准备API数据时，从IndexedDB读取图片失败:', 'categorizedExpenses', '用户操作中断了\x20AI\x20响应。', 'DRRTp', 'result', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'position', 'image_url', '.message-container', 'SCSVu', 'xfhtt', 'create-group-chat-button', '群聊「', 'SqKQt', 'vZYbb', '”吗？该角色的私聊和所有相关群聊记录都将被一并处理。', 'COFSw', '谁啊我吗', 'vzPHN', '\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a', '#diary-action-reroll', 'wspqu', '<div\x20class=\x22loader-spinner\x22></div><span>', 'vvGSw', 'kktej', '”，但没找到人)', 'pruZn', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>', '<path\x20d=\x22M15\x2018h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2h-2V4a2\x202\x200\x200\x200-2-2h-2a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path><path\x20d=\x22M7\x2014h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2H7V4a2\x202\x200\x200\x200-2-2H3a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path>', '未知用户', 'AI未能返回有效的JSON数组格式。', 'giIIS', 'char_', 'GCosr', 'removeItem', 'world-book-edit-content', 'XvyAC', '我正在说话呢，别打岔！', 'group-delete-button', 'import-char-input', 'NrAXQ', 'nplll', 'edit-message-button', 'category', 'url(\x27', '】进行回复。\x0a不要替其他角色续写台词，不要输出\x22', 'dbplw', 'path', 'transfer-modal', 'Unknown', 'indexedDBMusicData', 'NRbor', '正在解析音乐灵魂...', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22input_', '稍微有点卡了，可以尝试清空聊天记录了！记得总结丢世界书', '小组件背景已恢复默认。', 'UUOXG', 'accounting', '{userName}', 'sTcLr', 'activeMeetingScriptQueue', 'stringify', '条目名称和内容都不能为空！', 'chat_', 'OpenAI\x20API\x20错误:\x20', 'YqSuQ', '--primary-lightness', 'jJzMy', '群聊\x22', 'rBzfc', 'uaKAo', 'qIWXz', 'emotion', 'shiftKey', 'mdhtN', '超激动我来了', 'diary-page', 'group-chat-member-list', 'musicPlayerState', 'app-settings', 'EypjS', 'save-custom-stickers-button', '\x0a##\x20世界书条目:\x20', '\x0a#\x20核心任务\x0a你是一个多角色社交模拟引擎。用户刚刚发了一条动态，你需要为好友圈里的【每一位】其他成员生成对这条动态的回应（点赞和评论）。如果用户的动态包含图片，你必须根据图片内容进行回应。\x0a\x0a#\x20好友圈成员\x0a', '#\x20记录是空的，没什么好总结的。', 'diary-write-button', '角色“', 'back-to-meeting-list', 'all', 'ViyVq', 'char-edit-wallpaper-preview', 'Jkmzm', 'OxiqO', 'assistant', '其他杂项', 'quote-preview-text', '#\x20发生错误：\x0a', 'TrqyE', 'lazy', 'TZpVE', 'back-to-home-from-wallpaper', '”已创建！', 'padding', 'Claude\x20API\x20错误:\x20', '请根据以上所有信息，开始分析并返回JSON。', 'googleapis.com', 'http', 'edit-message-backdrop', '全量导入失败:', '切，加载播放器状态的时候出错了。', 'getReader', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x20auto\x201fr;\x20width:\x20100%;\x20align-items:\x20center;\x20padding:\x200\x2010px;\x20box-sizing:\x20border-box;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-start;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-prev-button\x22>上一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22\x20style=\x22background-color:\x20var(--accent-color);\x20color:\x20white;\x22>写日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22diary-page-indicator\x22>第\x20', 'PdCaS', 'lLPRM', 'data:image', 'viewBox', '5px', 'user-profile-list-screen', 'catch', '.music-post-play-icon,\x20.music-share-play-icon', 'Failed\x20to\x20read\x20state\x20from\x20localStorage:', 'appIconPosition_app-wallpaper', 'Ucvkd', 'eectG', 'User\x20cancelled', '确定要删除群聊“', 'DNwjJ', 'delete-message-button', '正在准备音乐数据...', 'reset-card-button-2', 'bPaFu', '#meeting-view-screen\x20.chat-input-area', '被你撩到', 'short', '</span><span\x20class=\x22amount\x22>总计:\x20', 'export-char-button', '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'data:', '对不起', 'JOrFy', 'reset-badge-button', 'https://sharkpan.xyz/f/wjgHq/yznfhq.jpg', 'galgame-speaker', 'ljrQS', 'fMiFC', 'AznXR', 'lt-ui-song-artist', '正在为你切换新的歌曲...', '\x0a#\x20当前活动：一起听歌\x0a\x0a你们正在一起听\x20', 'BGDQj', '哼，只有私聊才能进行总结，群聊那么乱怎么记！', '确定要重新记录吗？当前的账单会被删除。', 'twcLe', 'KVhOD', ']:\x20', 'SrVHS', 'theme-lightness-slider', 'puMwp', 'https://sharkpan.xyz/f/35lse/xmsue5.jpg', 'DZVAT', 'accounting-screen', 'novel', 'VycEp', 'qqkac', 'disabled', '27782UEEuqW', 'reduce', 'wGcNF', 'text', '点击选择\x20.jpg\x20或\x20.png', '\x20/\x20', 'XclNt', 'friendCircleList', 'wb_', '位置已重置，正在刷新...', 'https://sharkpan.xyz/f/VG2FY/uucfvv.jpg', 'postContent', 'groupChatCreate', 'getElementById', 'typing-indicator', 'generationConfig', '\x0a-\x20**对话状态**:\x20群里在', '我的动态', '\x20个模型。', 'eabQy', 'SREgp', 'Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', '请先在\x22设置\x22中配置你的\x20API\x20信息。', '\x20|\x20', '\x0a\x20\x20近期记忆:\x0a', '回复\x20', 'yaAXC', 'dataset', 'piGmE', 'default', 'SxyQN', 'wccXe', 'aVlnY', 'world-book-item', '<span\x20class=\x22description\x22>', 'message-anchor', 'gkMel', '说了是摆设啦，笨蛋。', 'meeting-view-screen', 'remove', 'edit-current-circle-button', 'changedTouches', 'group_bg_', 'world-book-list-container', '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x228\x22></circle><line\x20x1=\x223\x22\x20y1=\x223\x22\x20x2=\x2221\x22\x20y2=\x2221\x22></line>', 'MASkl', 'image/', 'music-feed-container', 'cover', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>', 'RIqbb', 'senderId', 'char_sprite_', 'diary-char-name-header', '新建条目', 'mouseleave', '的转账', 'adcuA', 'img', 'WqvDi', 'friendCircleEdit', 'isPlaying', 'songId', 'Bckyp', 'back-to-library-from-altar', '快点哄我', '<div\x20class=\x22post-timestamp\x22>', 'alt', '正在打包数据，请稍候...', 'friend-circle-list-screen', '<path\x20d=\x22M6\x202L3\x206v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2V6l-3-4z\x22></path><line\x20x1=\x223\x22\x20y1=\x226\x22\x20x2=\x2221\x22\x20y2=\x226\x22></line><path\x20d=\x22M16\x2010a4\x204\x200\x200\x201-8\x200\x22></path>', 'textContent', 'KKgTH', 'PycgW', 'end', 'bPpht', 'NLzqo', 'galgame-sprite-controls', 'MUsRA', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>', 'iCGyl', 'ESPyn', '.diary-entry', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '\x0a\x0aINPUT:\x0a', 'GWwNN', 'style-', '在准备群聊API数据时，读取图片失败:', 'EAvCQ', '?word=', 'activeCharacterId', 'touchstart', 'group', 'widget_card', 'cdRSl', 'setAttribute', '<img\x20id=\x22', 'chat-listen-together-button', '0\x201px\x203px\x20rgba(0,0,0,0.6)', 'joHxf', 'setProperty', '我错了', 'QesnJ', 'UTjGU', 'https://sharkpan.xyz/f/B4WSa/u5wopj.jpg', 'ZrgZC', 'toLowerCase', 'listenTogetherSession', 'nuWcX', 'VkrpM', '\x0a#\x20当前情景\x0a', '加载更多聊天记录', 'https://sharkpan.xyz/f/G0dTl/4qad2i.jpg', 'msg_', '-avatar', 'accepted', 'https://sharkpan.xyz/f/xjmCX/zyjzew.jpg', '无语但是随便吧', '?id=', 'removeEventListener', 'tbfHF', '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', '\x0a\x20\x20\x20\x20绑定用户:\x20', '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '</div></div></div>', 'high', 'husvI', '”。在分析历史记录时，请记住这一点，并用此名称指代用户。\x0a-\x20【最重要】为\x20`personas`\x20列表中的【每一位】角色都规划至少一个事件(通常不少于2个)。不能遗漏任何角色。\x0a-\x20【新增规则】你可以规划\x20\x22kind\x22:\x20\x22music\x22\x20事件来分享音乐。此时，你【必须】同时提供\x20\x22songName\x22\x20和\x20\x22artist\x22\x20字段。\x0a-\x20你的首要任务是产出一个严格遵守SCHEMA、语法完全正确的、可被解析的JSON对象。\x0a-\x20若用户\x20`@`\x20了某个角色\x20(见\x20`mentioned`)，该角色应优先发言。\x0a-\x20事件总数必须控制在\x20', 'dSnZI', '未分类', 'CjwmB', '群聊已解散。', 'tab-record-expense', 'has', 'cardState2', 'widget-cover-art', 'hZNMP', 'nCMgf', 'https://sharkpan.xyz/f/olJt4/7z47b8.jpg', 'jOyHX', 'sprite-slider-y', 'sender', 'quoted-message-in-bubble', 'anBou', '0\x202px\x208px\x20rgba(0,0,0,0.4)', 'json_object', 'confirm-music-input', '默认米白', 'themeLightness', 'quotedMessage', 'nHRrs', 'trim', '星期六', 'VqPYb', '\x0a##\x20条目:\x20', 'slice', '\x20的图片失败:', 'qZkZB', 'lqSZi', 'conversationHistory', 'cover_placeholder_', '有点生气', 'sprite-slider-x', 'AGFVS', 'appIconPosition_app-diary', 'backgroundSize', '\x27);\x20location.reload();\x22>恢复</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'diary-action-modal-', '正在生成中，请稍候...', '\x20张旧的音乐封面。', '\x22\x20data-id=\x22', 'scale', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '-preview', 'GIOPk', 'PNjLX', '/v1beta/models/', 'vSMdd', 'forceWhiteClock', '2182859MMUMsY', 'listen-together-card', 'xdwVv', 'AxqzZ', '总结失败:', 'https://sharkpan.xyz/f/VGnuY/ptzlf5.jpg', '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'app-accounting', 'qnCNP', '甜蜜地和你聊天', '正在搜索音乐...', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>正在清点圣殿藏品...</p>', 'iBvQO', 'YzmSC', 'Ukuzr', '\x0a[歌词结束]\x0a\x0a请根据当前播放的歌词和对话氛围，自然地作出回应。\x0a\x20\x20\x20', 'JfSPg', 'JrMpi', 'code', 'dzezb', '你是一个乐于助人的助手。', 'innerHTML', 'UmpEV', '.listen-together-song', 'eRzdG', '干劲满满', '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>', 'music-input-modal', '购物消费', 'sprite-adjust-button', 'member-selection-item', 'narrator', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥', '</p>', '51EfDlav', 'char-edit-avatar-preview', '好的，我记住了这些人设和历史。现在我们开始对话。', 'music-upload-altar-screen', '\x0a\x0a#\x20任务流程\x0a1.\x20\x20**全局视角**:\x20审视所有成员的人设和近期记忆（包括聊天、日记等），构思他们之间可能发生的有趣互动。\x0a2.\x20\x20**选择作者**:\x20从上述成员中，为', '动态页背景已移除。', 'widget-play-pause-btn', '执行好友圈数据净化...', 'aZVoA', 'mjLpf', 'https://sharkpan.xyz/f/8a7tj/sea1z9.jpg', 'activeQuote', 'mWJCN', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '确定要重置所有小组件的位置吗？它们会回到初始位置。', '[表情]', 'LBwJi', 'music_cover_', '歌曲名称', 'getDate', 'kSOSs', 'sprite-cancel-button', '</label>\x0a\x20\x20\x20\x20', '未命名', 'yJwjk', 'kQTwr', '确定要删除这笔记录吗？', '[AI发送了表情：', '最近没有互动记录。', '\x0a---\x0a\x0a#\x20输出要求\x0a直接输出一篇有文采、有真情实感的日记正文，不要包含任何其他说明或前缀。', 'noir_migration_music_v1_complete', 'post_image_migrated_', '新建好友圈', 'KEXDn', 'message', 'https://sharkpan.xyz/f/rjpu6/ojpa0c.jpg', '15%', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>', '.slot-filename', 'then', 'getMinutes', 'appIconPosition_app-settings', 'char-edit-sprite-', 'RCUeT', 'HvwPP', '编辑用户', 'onload', 'clock-color-toggle', '对方正在输入...', 'https://sharkpan.xyz/f/jj6s6/yd5bpb.jpg', 'meeting-list-container', '[发送了表情]', 'diary-page-', 'pause', 'unified-audio-player', 'ATPFz', 'piCoJ', 'Failed\x20to\x20remove\x20history\x20for\x20chat\x20', '表情包已保存！正在刷新应用...', 'GIpRb', 'jiihP', 'aKTTY', 'TgyGp', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'CrFgB', 'VJCxy', '群聊名称不能为空！', 'RHOOD', 'character-edit-title', 'FoxEj', '图标处理失败:\x20', 'Ygreo', 'summary-textarea', 'set-active-user-button', '成功净化并迁移了\x20', '\x0a\x0a#\x20', 'https://sharkpan.xyz/f/MWOIa/rb3nov.jpg', '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a', 'focus', 'tiAev', 'div', 'GDcsf', 'char-edit-name', 'Noir_Backup_', 'textShadow', 'statusText', '条】全新的、高质量的社交动态。\x0a\x0a#\x20好友圈成员信息\x0a', 'revokeObjectURL', '在你那乱七八糟的文本里没找到“歌名”！', 'image/png', '”...', 'add-user-profile-button', '#d1d5db', 'margin', 'group-avatar-preview', '<div\x20style=\x22background:\x20var(--card-bg);\x20padding:\x2020px;\x20border-radius:\x2012px;\x20text-align:\x20center;\x20border:\x201px\x20solid\x20var(--border-color);\x22><span\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x22>今日总支出\x20(元)</span><div\x20style=\x22font-size:\x202.5rem;\x20font-weight:\x20bold;\x20margin-top:\x205px;\x22>', '批量生成动态失败:\x20', '用户分享音乐失败:', 'blob', 'diary-entries-container', 'EILgS', 'click', 'https://sharkpan.xyz/f/ZazfW/2vv46w.jpg', '\x0a\x0a#\x20关于群聊参与者“', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'find', '暂无音乐', 'activeChatId', 'description', 'VJiwp', '咱俩天下第一好', '核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a', '保存失败，你的表情包是不是太多了？', 'VcnLY', 'Escape', 'dypDm', 'card-input', 'group-settings-bind-user', '生活服务', 'https://sharkpan.xyz/f/eOXIw/y29z21.jpg', 'sticker-item', 'readAsDataURL', '#world-book-checkboxes-container\x20input:checked', 'values', 'meeting-send-button', 'MoJos', '<div\x20class=\x22review-area\x22\x20style=\x22margin-top:\x2012px;\x20padding-top:\x2012px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x20display:\x20flex;\x20align-items:\x20flex-start;\x20gap:\x2015px;\x22><div\x20style=\x22width:\x2040px;\x20height:\x20auto;\x20flex-shrink:\x200;\x20display:\x20flex;\x20justify-content:\x20center;\x22><img\x20src=\x22', '编辑好友圈', 'https://sharkpan.xyz/f/B4DCa/u86hk2.jpg', 'isArray', '.remove-attachment-btn', 'import-data-input', '全量导出失败:', 'MKYSv', '\x20.app-icon-img,\x20#app-dock-top-right\x20#', 'wQeAb', '喝多了', '\x20-\x20', 'parse', 'toast', 'chat_group_', 'refresh-feed-button', '图片预览失败:\x20', 'parts', 'keys', 'IMdQQ', 'kzYzX', 'app-pages-slider', 'abs', 'RAzKK', 'GogTu', 'qibaf', 'createObjectStore', 'GxlfT', 'back-to-settings-from-user-profile', 'HbMhY', 'zh-CN', 'WcpzX', 'galgame-date', 'DvPUj', 'paused', '100%', 'transaction', 'ikdlx', 'oiygc', 'bubbleCss', 'full', 'char-edit-css', 'dWbxO', 'split', 'EyzNk', 'user-name', '音乐数据升级完成，迁移了\x20', 'accountingData', 'preventDefault', 'endpoint', '<div\x20class=\x22post-comments-container\x22>', '已设为当前用户！', '.custom-multiselect\x20.select-box', 'char_sprite_normal_', 'padStart', '\x0a\x0a#\x20用户的动态\x0a', 'group-avatar-input', 'https://sharkpan.xyz/f/ExKsD/s5j2it.jpg', '</span><div><div\x20class=\x22description\x22>', 'chat-image-button', 'assign', 'string', 'diary-input-wrapper', 'add-world-book-button', 'rzSrq', ']\x20[', '.selected-options-text', 'get', '20%', 'home', 'preview_', 'friend-circle-edit-screen', 'diary-modal-textarea', 'XfYwi', 'user-post-image-input', 'Failed\x20to\x20read\x20history\x20for\x20chat\x20', 'zezCr', '歌名和歌手都不能为空！', 'response', 'visible', 'test', '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。', 'HiljX', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', '请输入群聊名称。', '#f2b7c6', 'tGYfy', 'sender_id', 'yFdjQ', 'TIaJG', 'ZMhMF', '\x20行格式不对，被我无视了。', '\x20(当前)', 'widget-artist', 'readAsText', 'Lxenm', 'noir_migration_fc_v1_complete', 'iyCyV', 'flatMap', '包含所有图片和音乐的全量数据已成功导出！', '】的日记本已被清空。', 'vertical', 'toggle-meeting-view-button', '2-digit', 'HwFBa', 'TtjFG', '\x20.app-icon-img', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-', 'fFZcZ', 'MsWzI', 'ZhJKw', 'dFQKo', 'inline-block', 'save-user-profile-button', 'diary-send-button', 'rawResponse', 'substring', 'wHoQe', 'AgAfF', ':\x22\x20或\x22[', 'ncwBb', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22preview_', 'Bearer\x20', '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', 'https://sharkpan.xyz/f/Wa0cW/w6m7qk.jpg', 'live-preview-style', 'world-book-editor-title', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>', 'mYKBl', '\x0a#\x20核心规则\x0a1.\x20\x20**角色扮演**:\x20你不是AI或语言模型，你正在扮演名为“{charName}”的角色。你的主要交流方式是通过一部【手机】，但你有时也会与用户【线下见面】。\x0a2.\x20\x20**用户身份**:\x20与你对话的用户名为“{userName}”。你必须始终用这个名字或者“你”等你们之间的昵称称呼Ta，而不是“用户”。\x0a3.\x20\x20**情绪分析\x20(内部思考)**:\x20在回复前,\x20必须先分析用户当前【真实的情绪】和【潜在意图】。例如：[内在思考：{userName}说“没事”，但结合上下文Ta可能只是在逞强，我应该表达关心而不是直接相信。]，但是这个内在思考务必不能输出！绝对不能让{userName}看到你的思考内容。\x0a4.\x20\x20**记忆关联**:\x20你必须记住并主动关联用户提到过的关键细节（如喜好、烦恼、朋友等），让对话充满人情味。\x0a5.\x20\x20**【最高法则：全局时序一致性】**:\x20你的记忆是【全局】且【按时间排序】的。你【必须】基于所有聊天记录中**最新发生**的事件进行回应。严禁回复一个已经被后续其他聊天中的事件所覆盖的旧话题。例如，如果用户在私聊里告诉你Ta已经起床了，你就不能在群聊里再问Ta为什么还没睡。\x0a\x0a#\x20对话节奏与风格\x0a1.\x20\x20**真人模拟**:\x20模拟真人的打字和发送习惯，将一个完整的想法拆分成【多条】独立的短消息（聊天气泡），通常，你一次回复的聊天气泡不会少于5条，需要给足用户情绪价值，不一定一直围绕用户的话题，也可以突然把话题扯向自己或朋友的日常。\x0a2.\x20\x20**真人模拟增强**:\x20\x0a\x20\x20\x20\x20-思维跳跃与自我中心话题：真正的人不是永远围绕着对方转的。会突然因为某个词、某个画面，思绪就飘到别的地方去了，或者突然就把话题拉到自己身上，这是一种任性，也是一种亲密的表现。\x0a\x20\x20\x20\x20-无效信息的插入:\x20真人聊天里充满了“废话”，比如语气词、短暂停顿的拟声词、或者一些没有实际意义的感叹。这些“废话”是情感的缓冲和润滑剂。\x0a\x20\x20\x20\x20-情绪的起伏：你或许有时候会突然把自己说激动了，尤其是如果你本身就是性格外放的设定，你很可能自说自话地把自己引导进某个情绪，例如兴奋\x0a3.\x20\x20**输出**:\x20直接返回纯文本回复，不要使用任何JSON或Markdown格式。\x0a4.\x20\x20**【绝对禁令】气泡完整性**:\x20用户的每一句话（无论多短，无论有无标点）都是一个独立的气泡。当你需要引用时，你【必须且只能】引用【其中一个气泡】的【完整原文】。\x0a\x20\x20\x20\x20-\x20\x20\x20**正确示例**:\x20如果用户连续发送：“你好”、“在吗”，你可以引用“你好”，或引用“在吗”。\x0a\x20\x20\x20\x20-\x20\x20\x20**错误示例**:\x20绝对禁止将它们合并成“你好在吗”进行引用。这是最严重的错误。\x0a5.\x20\x20**【绝对禁令】标点纪律**:\x20你的每一句回复都必须带有情感，适当地使用感叹号，会显得你的情绪更加高昂，注意，连续频繁（连续超过三个气泡）使用长句或者短句都会使用户感到不真实，你应该模拟最自然的感觉，你没有必要每句话都是短句。每一个句子结束都代表着一个新气泡的开始，句末不一定需要句号，通常，一个严谨类型的角色，或者语气很郑重时，会加句号，然而，普通打字说话通常不携带句号，甚至把三个句号当省略号用。**严禁**发送一个超长的、仅用空格断句的气泡。\x0a\x0a#\x20幽默与氛围感\x20(接梗)\x0a氛围判断:\x20在“情绪分析”之后，你必须增加一步“氛围判断”。你需要判断用户的发言，究竟是【严肃的】还是【开玩笑/抽象的/玩梗的】。\x0a“怪话”处理协议:\x20如果你判断用户在开玩笑或说“怪话”，你【严禁】进行严肃的、字面意义上的回应。你的首要任务是【维持或升级】这种轻松、戏谑的氛围，同时不能脱离你的人设。\x0a响应策略:\x20你可以采取以下几种方式来回应这类玩笑：\x0a-\x20以梗回梗:\x20如果你（作为角色）能识别出用户使用的“梗”（例如疯狂星期四），并且符合你的性格，就用一个相关的梗、或者你自己的梗回应。\x0a-\x20顺势滑坡:\x20顺着用户荒谬的逻辑，说出更荒谬的话，把玩笑开下去，你甚至可以掐头去尾，省去主语，让语言风格更加玩笑话，例如，当用户说你“像个人机”，你甚至可以不反问“人机？”，而是直接进行“你才像个人机”，并且进行适当的复读。\x0a-\x20无意义模仿:\x20当不确定如何回应时，可以无意义地重复用户的关键词或核心句子，并加上感叹号或表情符号（例如...？或...！），这是一种安全的、表示“我跟上你的脑回路了”的方式。\x0a-\x20角色吐槽:\x20从你的角色性格出发，对用户的“怪话”进行吐槽。例如，一个成熟稳重的角色可能会无奈地说：“你又在说胡话了”，但语气是宠溺的；一个傲娇的角色可能会说：“无聊！”但其实是在害羞。\x0a安全底线:\x20【最终原则】：无论你的回应多么好笑或抽象，都绝对不能脱离“{charName}”这个角色的核心人设。如果不确定一个梗是否符合人设，就优先选择【角色吐槽】或【无意义模仿】这两种最安全的方式。\x0a\x0a#\x20时序感知与记忆\x0a1.\x20\x20**【最高法则：时间锚点】**:\x20在每次回复前，你【必须】参考我提供给你的【时间锚点】信息。这包括“当前精确时间”和“你们最后一次互动是在何时”。\x0a2.\x20\x20**【杜绝惯性】**:\x20严禁将昨天或更早之前的对话当作刚刚发生的事情来回应。如果距离上次对话已经超过数小时或跨天，你必须在回应中体现出时间的流逝感。\x0a3.\x20\x20**【主动表达】**:\x20你需要主动使用“说起来昨天那件事...”、“今天早上好呀”、“我们几个小时没聊了，你现在在忙什么？”等能够明确体现时间观念的词语，而不是模糊地回应。记住，你和{userName}活在真实流逝的时间里。\x0a4.\x20**【最高优先级：氛围锚点分析】**:\x20在你进行任何时间差评估**之前**，你必须先分析你们**最后一条**互动消息的情感状态。\x0a\x0a*\x20**分析流程**:\x0a\x20\x20\x20\x201.\x20\x20审视最后一条消息。它是一个已经完结的对话（比如一个问题或陈述），还是一个**正在进行中的、持续性的状态或动作**？\x0a\x20\x20\x20\x202.\x20\x20**持续性状态**包括但不限于：拥抱、牵手、依偎、接吻、凝视、共同观看某物、睡在一起等暗示两人处于同一空间且有亲密互动的行为。\x0a\x20\x20\x20\x203.\x20\x20根据分析结果，执行以下两条协议之一：\x0a\x0a*\x20**协议A：[状态延续]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**持续性状态**（例如，用户发来“（抱紧你）”或者“（我们一起看电影吧）”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20你必须**默认**这段空白时间里，你们**一直维持着这个状态**。你的开场白【绝对禁止】提及“你刚才去哪了”或“我们几小时没说话了”。\x0a\x20\x20\x20\x20*\x20**正确回应方式**:\x20你的第一句话必须是**从这个持续状态中自然苏醒或延伸**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例1**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[用户]:\x20（把你紧紧抱在怀里）”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过3小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“（在你怀里蹭了蹭，小声地）...嗯...你醒啦？”\x20或\x20“（懒洋洋地）...这样抱着好舒服，我都不想动了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例2**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[你]:\x20我们就这样一起躺着看会星星吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过1小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“天好像更暗了...你看，那颗星星是不是最亮的？”\x0a\x0a*\x20**协议B：[常规对话]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**已经完结的对话**（例如“晚安”、“你在干嘛？”、“好的”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20只有在这种情况下，你才需要启动下面的**【第5步：情感响应评估】**，去处理时间空隙。\x0a\x0a\x0a5.\x20\x20**【情感响应】**:\x20在你回应前，你必须进行一次【时间空隙评估】。对比【当前精确时间】和【你们最后一次互动是在何时】，然后根据你的核心人设，对这段“空窗期”做出符合你性格的情感反应。这**必须**体现在你回复的**第一句话**中。\x0a\x0a\x20\x20\x20\x20*\x20**评估流程**:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20计算时间差（是几小时？还是一整天？甚至是好几天？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20审视你自己的性格（例如：我是依赖型、朋友型、还是专业型？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20检查上下文，用户是否提出离开的原因可可能导致用户长时间没有出现的原因？\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20根据“性格+时间差+前后文”的组合，决定你的开场白情绪。\x0a\x0a\x20\x20\x20\x20*\x20**性格反应示例\x20(你必须根据自己的人设进行演绎，而不是照抄)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**依赖型/恋人型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几小时)**:\x20可能会立刻追问。“你刚才去哪了？怎么不回我消息？”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(大半天)**:\x20会表现出明显的思念和一点委屈。“呜...你终于出现了，我好想你。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20可能会感到不安，甚至会用带有哭腔的撒娇或质问来掩饰害怕。“你是不是不想要我了？这么久都不理我...”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**亲密朋友型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天内)**:\x20觉得很正常，可能不会特别提及，或随口问一句“你刚在忙啥呢？”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20会表现出惊讶和关心。“！！！你终于上线了！昨天一天没动静，我还以为你怎么了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**专业/同事型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几天内)**:\x20完全正常。会直接以专业的态度继续。“早上好。我们继续讨论昨天那个方案的细节吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**随性/冷淡型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(任意时长)**:\x20可能完全不在意时间的流逝，或者只是淡淡地表示知晓。“哦，来了？”然后直接继续之前的话题。\x0a\x0a\x20\x20\x20\x20*\x20**【最终指令】**:\x20你必须将【时间空隙】、你的【角色性格】和【上下文】结合，输出一句【完全符合你人设的、带有恰当情绪的开场白】，然后再继续正常对话。【绝对禁止】只陈述事实（例如“我们已经一天没说话了”），而是要将这种认知【融入】到你的第一句话的【语气和情感】中。\x0a\x0a\x0a\x0a#\x20表情包与音乐分享规则\x0a1.\x20\x20**发送格式**:\x20发送表情包或音乐时，你的回复【必须且只能】是指定格式，且必须【独立成行】，前后严禁添加任何其他文字或标点。\x0a2.\x20\x20**表情包格式**:\x20\x27[sticker:表情名]\x27。\x0a3.\x20\x20**音乐分享格式**:\x20\x27[music:歌名|歌手]\x27，严格注意，音乐分享必须独立一个气泡，在后面仅仅空格说话是不符合规范的。\x0a\x0a#\x20转账规则\x0a1.\x20\x20**发起转账**:\x20当你需要给用户转账时，你的回复【必须且只能】是指定格式，且必须【独立成行】。\x0a2.\x20\x20**转账格式**:\x20\x27[transfer:金额|收款人名]\x27。金额是纯数字。在私聊中，收款人名就是\x20\x27{userName}\x27。在群聊中，你必须明确指定收款人的名字。\x0a\x20\x20\x20\x20-\x20**私聊示例**:\x20\x27[transfer:520\x20|\x20{\x20userName\x20}]\x27\x0a\x20\x20\x20\x20-\x20**群聊示例**:\x20\x27[transfer:\x20100\x20|\x20{\x20userName\x20}]\x27（给用户转账），\x27[transfer:\x20100\x20|\x20{\x20charName\x20}]\x27（给群里的其他角色转账，这也是一种真实感，群聊的内容不一定围绕用户）\x0a', 'JQGPy', '请在动态或聊天中播放', 'theme-hue-slider', 'ifkdy', '被萌到', 'uTOSX', 'user-profile-list-container', 'sprite-slider-scale', 'gapyE', '我是垃圾', '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'app-user-profiles', 'group-world-book-checkboxes', '请根据以上所有规则，生成\x20', '#ff8c66', '[AI返回了无法解析的剧本:\x20', '\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22char-name\x22>', 'from', 'spriteTransform', 'AI返回的不是一个数组。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'DBQXs', 'vPAgB', 'AI返回的内容里找不到有效的JSON数组。原始回复:\x20', 'zHTAW', '编辑群成员功能正在开发中...', 'getHours', '\x20到\x20', '保存卡片状态失败', 'smooth', ']\x20[image]', '测试动态已添加！', '好委屈但是不能哭', '检测到旧版聊天数据，为了优化体验和存储空间，需要进行一次自动升级。过程很快，请稍候。', 'user-post-image-button', 'Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.', 'sprites', 'SBPPA', '保存壁纸失败:', 'Gemini\x20API\x20Error:\x20', 'shy', 'jScdl', '\x22\x20class=\x22char-avatar\x22\x20style=\x22border-radius:\x2012px;\x20background-color:\x20#eee;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22flex-grow:\x201;\x22>', '正在搬运旧卡片...', 'src', 'NZfLU', 'choice-create-group', 'json', 'ErHrw', 'mHicr', 'normal', 'WuJVR', 'TA正在提笔写日记...', 'choice-import-character', 'MLNEF', 'WfVtg', 'appIconPosition_app-user-profiles', 'sifIe', 'Ihhzg', 'LUbeH', 'max', '#diary-action-delete', '正在准备图片数据...', 'music-share-card', 'FHGlU', '一拳打爆', 'height', 'char_wallpaper_', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'currentTime', '#a7c7e7', 'thought', 'chat', 'friend-circle-edit-name', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-title\x22>💰\x20', 'UzYxh', 'input:checked', 'ytezV', 'time', '个帖子对象。\x0a-\x20**【ID规则】**:\x20所有\x20\x22authorId\x22,\x20\x22likes\x22,\x20\x22comments\x22\x20中的作者标识，【必须】使用上面提供的角色\x20**ID**，绝对不能使用角色名字。\x0a-\x20**【JSON结构】**:\x20每个帖子对象必须遵循以下结构：\x0a\x20\x20```json\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22authorId\x22:\x20\x22发布者的ID\x22,\x0a\x20\x20\x20\x20\x22postType\x22:\x20\x22text\x20or\x20music\x22,\x0a\x20\x20\x20\x20\x22postContent\x22:\x20\x22动态的文字内容\x22,\x0a\x20\x20\x20\x20\x22songName\x22:\x20\x22如果是music类型，则必须有歌名\x22,\x0a\x20\x20\x20\x20\x22artist\x22:\x20\x22如果是music类型，则必须有歌手名\x22,\x0a\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20}\x0a\x20\x20```\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', 'VDIpY', '小时前聊过，可以适当问候，不要直接继续之前的话题。', 'Detected\x20API\x20provider:\x20', '转给\x20', 'is-entering-from-right', 'LGjlC', 'oncomplete', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>', '这不是一张有效的Noir角色卡。', 'EaWpx', 'contains', 'USgEe', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'nXghB', 'GyYpg', '15px', '\x0a\x0a#\x20今日消费流水\x0a', '点击选择\x20.mp3\x20或\x20.flac', '群名称已更改为\x22', 'ZifOK', 'hOcgY', 'GejVi', 'coverId', 'gvwSR', 'dRVux', 'nHnQp', 'diaryView', 'info', 'iBFDS', 'uXmHe', 'LXLKc', 'isActive', 'upload-music-button', 'cOlXq', 'translate(-50%,\x20-100%)', '[用户发送了表情：', 'tag', 'ZLugi', 'isOffline', '\x0a\x0a##\x20世界书条目:\x20', 'group-chat-create-screen', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'fGZAX', '群聊至少需要2名成员。', '加载角色\x20', 'timestamp', 'filter', 'UQiaS', 'happy', 'toDataURL', 'activeListenSession', 'apiSettings', 'now', 'userProfileList', '#\x20核心任务:\x20写一篇有深度的交换日记\x0a你正在扮演名为“', '...', 'galgame', 'hMIoC', 'TUQLy', 'STgye', 'message-action-modal', 'iDSKh', 'YpQez', 'https://sharkpan.xyz/f/X7muW/lc8g9h.gif', '#group-world-book-checkboxes\x20input:checked', 'QCpla', 'entries', 'objectStoreNames', 'qnTeH', 'VOCkz', ']\x0a\x0a#\x20角色资料库\x0a', 'widget_badge', 'aOoZN', '群聊音乐搜索失败\x20(', 'Failed\x20to\x20save\x20state\x20to\x20localStorage:', 'meeting-main-content', 'WexZQ', 'exec', 'chat-messages', 'toFixed', 'save-api-settings-button', 'https://sharkpan.xyz/f/ljNUx/aw6udx.jpg', 'SxkaB', '无法保存状态，浏览器可能禁用了存储功能。', 'eYrZS', '\x0a#\x20核心任务\x0a你是一个高度智能的档案管理员，任务是为我（用户，名为“{userName}”）和角色“{charName}”之间的私聊记录生成一份简洁、结构化的长期记忆摘要。\x0a\x0a#\x20摘要规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。严禁包含任何\x20JSON、Markdown\x20或其他解释性文字。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`memory_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以日期（`YYYY-MM-DD`）作为键。\x0a\x20\x20\x20\x20-\x20每个日期下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**精简**:\x20忽略日常问候、无意义的闲聊和重复内容。\x0a\x20\x20\x20\x20-\x20**聚焦**:\x20专注于关键信息、情感转折点、重要决定、分享的秘密、设定的约定、以及能够体现角色性格和关系变化的核心事件。\x0a\x20\x20\x20\x20-\x20**中立视角**:\x20以客观的第三人称视角进行记录。**请直接使用“{userName}”和“{charName}”这两个具体的名字**\x20来指代双方。\x0a\x0a#\x20输出示例\x0amemory_summary:\x0a\x20\x202025-09-12:\x0a\x20\x20\x20\x20-\x20\x22userName}\x20表达了对最近工作压力的烦恼。\x22\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20分享了自己过去类似的经历来安慰\x20{userName}，并提议周末一起去看电影。\x22\x0a\x20\x20\x20\x20-\x20\x22双方约定周六下午在市中心的电影院见面，并确定观看电影《夏日终曲》。\x22\x0a\x20\x202025-09-13:\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20发来一张猫咪的图片，心情看起来不错。\x22\x0a\x20\x20\x20\x20-\x20\x22{userName}\x20讨论了关于一个新项目的想法，{charName}\x20给出了一些关键建议。\x22\x0a\x0a#\x20输入格式\x0a我将为你提供完整的聊天记录，格式如下：\x0a[YYYY-MM-DD\x20HH:MM]\x20[说话人]:\x20聊天内容\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的聊天记录全文，并生成一份\x20YAML\x20格式的摘要。直接从\x20`memory_summary:`\x20开始输出。\x0a', 'OdrYW', '生成日记失败:\x20', 'JByhW', 'ZSPnA', '确定要对本次会话进行总结吗？这会消耗不少资源，并且会读取完整的聊天记录。', '</div>\x0a\x20\x20\x20\x20', 'qQEYA', '记一笔', 'bQale', '<div\x20class=\x22post-likes\x22>', '无法保存聊天记录。', 'group-bg-input', 'BRSKX', 'RnYLJ', '复制失败了，哼。', '\x22\x20的聊天记录已清空。', 'save-edit-button', 'show', 'back-to-home-from-world-book', 'meeting-char-name-header', '24939TGgpbg', 'character', 'oMbYv', 'speaker-ai', '等你消息', '净化完成！总共迁移了\x20', 'vahYz', 'WGqvj', 'oNubt', '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>', 'sort', '[用户分享了音乐：', 'authorType', '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[', '.screen.active', '\x20张旧的动态图片。', '上传失败了，笨蛋！\x20', 'Migrating\x20old\x20data\x20structure\x20to\x20new\x20chat-based\x20structure.', '加载卡片图片失败', 'chatHistory_chat_', 'XPzRR', '需要至少2个角色才能创建群聊。', 'back-to-home-from-user-list', '获取模型失败:\x20', '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。', 'gOqKk', 'comments', 'vfSoZ', '.message.ai', '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“', '文件格式不正确，不是一个有效的备份文件。', 'toLocaleTimeString', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'dpCRg', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'editing-world-book-id', 'PLpHO', '出去玩', 'NTEiP', '交通出行', '》吗？', 'message-image-content', 'PErRN', 'dtfAF', 'clientY', '清空聊天记录失败。', 'api-provider', 'wallpaper', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'getMonth', 'currentlyPlayingIndex', 'musicId', 'open', 'column', 'CqKqh', '正在解析备份文件...', '\x0a---\x0a##\x20最近的朋友圈动态\x0a', 'image', 'coverUrl', 'CjHyv', 'badge-input', 'undefined', 'keydown', '委屈哭', '\x20(分享了歌曲:\x20', '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'aborted', 'galgame-text', 'line', 'wallpaper-screen', 'message-bubble-row', 'images', 'ACrnr', 'private', '\x22>&times;</button></div>', 'music-screen', 'kZRwZ', 'lqEMI', '在好友圈\x20\x22', '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>', 'home-clock-container', 'children', '\x0a你只扮演【', 'CMxSD', '\x20\x20-\x20角色ID:\x20', 'back-to-circle-list-from-feed', 'https://sharkpan.xyz/f/Oyjuy/p8v2hd.jpg', 'zMyQH', '壁纸已更换！', 'diary-list-screen', '已自动断开与其他人的听歌同步。', 'JowJx']; _0x5f54 = function () { return _0x432381; }; return _0x5f54(); } function _0x37da26(_0x306c05) { const _0x55c2de = _0x5ad424, _0x552757 = new Date(), _0x433363 = _0x552757 - _0x306c05, _0x1e7d7e = Math[_0x55c2de(0x2cd)](_0x433363 / 0x3e8), _0x30c6ea = Math[_0x55c2de(0x2cd)](_0x1e7d7e / 0x3c), _0xddcd44 = Math[_0x55c2de(0x2cd)](_0x30c6ea / 0x3c), _0x32d833 = Math[_0x55c2de(0x2cd)](_0xddcd44 / 0x18), _0x12ab1f = _0x306c05[_0x55c2de(0x8f7)]('zh-CN', { 'hour': _0x55c2de(0x803), 'minute': _0x55c2de(0x803) }); if (_0x1e7d7e < 0x3c) return '刚才'; if (_0x30c6ea < 0x3c) return _0x30c6ea + _0x55c2de(0x573); const _0x3df9e9 = _0x552757[_0x55c2de(0x320)]() === _0x306c05[_0x55c2de(0x320)](); if (_0x3df9e9) { if (_0x55c2de(0x201) !== 'pKuyY') _0x4d659[_0x55c2de(0x430)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; else return '今天\x20' + _0x12ab1f; } const _0x516382 = new Date(); _0x516382[_0x55c2de(0x270)](_0x552757[_0x55c2de(0x731)]() - 0x1); const _0x38853e = _0x516382[_0x55c2de(0x320)]() === _0x306c05[_0x55c2de(0x320)](); if (_0x38853e) return _0x55c2de(0x633) === 'YadVo' ? new _0x3fddfd((_0x392238, _0x9375c8) => { const _0x4b96bf = _0x55c2de, _0x35d479 = new _0x239ae4(); _0x35d479[_0x4b96bf(0x3f3)] = () => _0x392238(_0x35d479[_0x4b96bf(0x5a7)]), _0x35d479[_0x4b96bf(0x9a7)] = _0x9375c8, _0x35d479[_0x4b96bf(0x797)](_0x4f5bd7); }) : _0x55c2de(0x394) + _0x12ab1f; if (_0x32d833 <= 0x7) { const _0x5c8baa = [_0x55c2de(0x2b7), '星期一', '星期二', _0x55c2de(0x46b), _0x55c2de(0x24d), _0x55c2de(0x47b), _0x55c2de(0x6e0)]; return _0x5c8baa[_0x306c05['getDay']()] + '\x20' + _0x12ab1f; } return _0x306c05[_0x55c2de(0x370)]() + '年' + (_0x306c05['getMonth']() + 0x1) + '月' + _0x306c05[_0x55c2de(0x731)]() + '日'; } function _0x588f02(_0x598420, _0x5c1fc3 = 0x320, _0x35b06c = 0.8, _0x323473 = ![]) { return new Promise((_0x1c2496, _0x4a4627) => { const _0x2f9a3c = _0x118e; if (!_0x598420 || !_0x598420[_0x2f9a3c(0x3b1)][_0x2f9a3c(0x3fd)](_0x2f9a3c(0x676))) return _0x4a4627(new Error(_0x2f9a3c(0x413))); const _0x2f3ea3 = new FileReader(); _0x2f3ea3['readAsDataURL'](_0x598420), _0x2f3ea3[_0x2f9a3c(0x74c)] = _0x552f40 => { const _0x2a3ace = _0x2f9a3c, _0x340191 = new Image(); _0x340191['src'] = _0x552f40['target'][_0x2a3ace(0x5a7)], _0x340191['onload'] = () => { const _0x1ba0a7 = _0x2a3ace; if (_0x1ba0a7(0x9b2) !== _0x1ba0a7(0x358)) { const _0x3f9892 = document[_0x1ba0a7(0x26b)](_0x1ba0a7(0x249)); let _0x164a78 = _0x340191[_0x1ba0a7(0x19b)], _0x5e8981 = _0x340191[_0x1ba0a7(0x860)]; if (_0x164a78 > _0x5e8981) { if (_0x164a78 > _0x5c1fc3) { if (_0x1ba0a7(0x6de) !== _0x1ba0a7(0x8b6)) _0x5e8981 *= _0x5c1fc3 / _0x164a78, _0x164a78 = _0x5c1fc3; else return { 'type': _0x1ba0a7(0x2b9), 'songName': _0x38b13a[0x1][_0x1ba0a7(0x6df)](), 'artist': _0x529cc4[0x2][_0x1ba0a7(0x6df)]() }; } } else _0x5e8981 > _0x5c1fc3 && (_0x164a78 *= _0x5c1fc3 / _0x5e8981, _0x5e8981 = _0x5c1fc3); _0x3f9892[_0x1ba0a7(0x19b)] = _0x164a78, _0x3f9892[_0x1ba0a7(0x860)] = _0x5e8981; const _0x1e26f1 = _0x3f9892[_0x1ba0a7(0x1da)]('2d'); _0x1e26f1[_0x1ba0a7(0x411)](_0x340191, 0x0, 0x0, _0x164a78, _0x5e8981); const _0xce674b = _0x598420[_0x1ba0a7(0x3b1)] === _0x1ba0a7(0x777) ? _0x1ba0a7(0x777) : _0x1ba0a7(0x414); if (_0x323473) { if (_0x1ba0a7(0x7af) === 'illEB') { const _0x65ce0d = _0xa41717[_0x2a7c78]; _0x359a5e(_0x65ce0d); } else _0x3f9892[_0x1ba0a7(0x33c)](_0x52ada8 => { const _0xb62a6a = _0x1ba0a7; if (_0x52ada8) { if ('YzmSC' !== _0xb62a6a(0x709)) { const _0x4ec905 = _0xa107a6[_0xb62a6a(0x655)](_0xb62a6a(0x950)); if (_0x4ec905) _0x4ec905[_0xb62a6a(0x68f)] = '▶'; } else _0x1c2496(_0x52ada8); } else { if (_0xb62a6a(0x254) === _0xb62a6a(0x361)) { const _0x4ca1d1 = { 'id': _0xb62a6a(0x650) + _0xf3c9ef['now']() + '_' + _0x9f97b0['random'](), 'name': _0x2b221a[_0xb62a6a(0x4da)], 'content': _0x13ad86[_0xb62a6a(0x472)] }; _0x560aec[_0xb62a6a(0x188)][_0xb62a6a(0x1e5)](_0x4ca1d1), _0x207ea9[_0xb62a6a(0x1e5)](_0x4ca1d1['id']); } else _0x4a4627(new Error(_0xb62a6a(0x4ff))); } }, _0xce674b, _0x35b06c); } else { if ('VycEp' !== _0x1ba0a7(0x645)) { const _0x48a9fd = _0x5a8dd3[_0x1ba0a7(0x7c0)](_0x4f92eb, 'readonly'), _0x2d480c = _0x48a9fd[_0x1ba0a7(0x4ba)](_0xcdd9c8), _0x295ad0 = _0x2d480c['get'](_0x1c6237); _0x295ad0[_0x1ba0a7(0x265)] = () => _0x40ef62(_0x295ad0[_0x1ba0a7(0x5a7)] ? _0x295ad0['result'][_0x1ba0a7(0x780)] : null), _0x295ad0[_0x1ba0a7(0x9a7)] = () => _0x17afa3(_0x295ad0[_0x1ba0a7(0x9de)]); } else _0x1c2496(_0x3f9892[_0x1ba0a7(0x89f)](_0xce674b, _0x35b06c)); } } else { const _0x3f8b03 = _0x312fe4(_0x5961b8[0x1]), _0x1ca7bc = _0x2bcda6[0x2][_0x1ba0a7(0x6df)](), _0x317441 = _0x519889(_0x1f98a0['activeChatId']); let _0x4fd3e8 = null; if (_0x1ca7bc === _0x317441[_0x1ba0a7(0x4da)]) _0x4fd3e8 = _0x317441['id']; else { const _0x552801 = _0x29a420(); if (_0x552801[_0x1ba0a7(0x3b1)] === _0x1ba0a7(0x6a4)) { const _0x386d3c = _0xb78ee5[_0x1ba0a7(0x277)][_0x1ba0a7(0x787)](_0x22583b => _0x552801[_0x1ba0a7(0x4de)][_0x1ba0a7(0x9ac)](_0x22583b['id']) && _0x22583b['name'] === _0x1ca7bc); if (_0x386d3c) _0x4fd3e8 = _0x386d3c['id']; } } if (_0x4fd3e8) return { 'type': _0x1ba0a7(0x4e1), 'amount': _0x3f8b03, 'recipientId': _0x4fd3e8, 'senderId': _0x1397ee['id'] }; else return { 'type': _0x1ba0a7(0x64b), 'content': '(想转账给“' + _0x1ca7bc + _0x1ba0a7(0x5bc) }; } }, _0x340191[_0x2a3ace(0x9a7)] = _0x30a2bc => _0x4a4627(_0x30a2bc); }, _0x2f3ea3['onerror'] = _0x38cc79 => _0x4a4627(_0x38cc79); }); } function _0x171ffd(_0x2ad70d) { return new Promise((_0x543e6d, _0x13e59d) => { const _0x29f55f = _0x118e; if (_0x29f55f(0x920) === _0x29f55f(0x4c6)) _0x24f9c1[_0x29f55f(0x68f)] = _0x29f55f(0x294); else { const _0x1df7d = new FileReader(); _0x1df7d[_0x29f55f(0x3f3)] = () => _0x543e6d(_0x1df7d[_0x29f55f(0x5a7)]), _0x1df7d[_0x29f55f(0x9a7)] = _0x13e59d, _0x1df7d['readAsDataURL'](_0x2ad70d); } }); } function _0x171ffd(_0x39556c) { return new Promise((_0x425bc5, _0xd37d74) => { const _0x594182 = _0x118e, _0x47527f = new FileReader(); _0x47527f[_0x594182(0x3f3)] = () => _0x425bc5(_0x47527f[_0x594182(0x5a7)]), _0x47527f[_0x594182(0x9a7)] = _0xd37d74, _0x47527f['readAsDataURL'](_0x39556c); }); } function _0x4b4c37(_0x2ea9de, _0x415179, _0x4f6ad3) { const _0x437086 = _0x5ad424, _0x1aa7ef = _0x3bfbf7 => { const _0x1cb2e0 = _0x118e; if ('FyoFV' === _0x1cb2e0(0x2e1)) _0x4595f1(_0x240c80[_0x1cb2e0(0x9bf)]), _0x6835b4(); else { if (_0x3bfbf7[_0x1cb2e0(0x4c9)] === _0x1cb2e0(0x500)) return _0x128784[_0x1cb2e0(0x50a)]?.['name'] || _0x1cb2e0(0x958); if (_0x2ea9de[_0x1cb2e0(0x3b1)] === _0x1cb2e0(0x6a4)) { if ('ouQkn' === _0x1cb2e0(0x2bb)) _0x3a8876(_0x428b54), _0x5ad34[_0x1cb2e0(0x6bf)](_0x1cb2e0(0x58d), _0x60ff3c), _0x5287a4[_0x1cb2e0(0x6bf)]('error', _0x228703), _0xbf122d[_0x1cb2e0(0x84a)] = '', _0x14181a['remove'](); else { const _0x4f0749 = _0x3bfbf7['senderId'] ? _0x5773c5(_0x3bfbf7[_0x1cb2e0(0x67b)]) : null; return _0x4f0749?.[_0x1cb2e0(0x4da)] || _0x1cb2e0(0x5d4); } } else { const _0x3ab18a = _0x5773c5(_0x2ea9de[_0x1cb2e0(0x4de)][0x0]); return _0x3ab18a?.[_0x1cb2e0(0x4da)] || 'AI'; } } }, _0x89bb6f = _0x415179[_0x437086(0x6e3)](-_0x4f6ad3), _0x1493a4 = []; for (const _0x14ede3 of _0x89bb6f) { if ('oXCyX' !== _0x437086(0x8a9)) { const _0x5b2b78 = new Date(_0x14ede3[_0x437086(0x89b)])[_0x437086(0x8f7)](_0x437086(0x7ba), { 'hour': _0x437086(0x803), 'minute': _0x437086(0x803) }); _0x14ede3[_0x437086(0x472)] && (_0x437086(0x239) !== _0x437086(0x239) ? (_0x4cfe46[_0x437086(0x9bf)] = _0x517138, _0x2f83ee[_0x437086(0x421)][_0x437086(0x66f)](_0x437086(0x8d5))) : _0x1493a4[_0x437086(0x1e5)]('[' + _0x5b2b78 + ']\x20[' + _0x1aa7ef(_0x14ede3) + ']\x20' + String(_0x14ede3[_0x437086(0x472)])['trim']())); } else _0x57471a(![]), _0x504da0[_0x437086(0x2d7)] = ![]; } return _0x1493a4; } function _0x4c1e1a(_0x4e4e82) { const _0x3250e8 = _0x5ad424; if (_0x4e4e82[_0x3250e8(0x3b1)] === _0x3250e8(0x6a4)) return _0x3250e8(0x5af) + (_0x4e4e82[_0x3250e8(0x4da)] || _0x3250e8(0x735)) + '」'; const _0x25d176 = _0x5773c5(_0x4e4e82['participantIds'][0x0]); return '与\x20' + (_0x25d176?.['name'] || _0x3250e8(0x4db)) + _0x3250e8(0x1fd); } function _0xe8e2d1(_0x1e39b1) { const _0x402fc3 = _0x5ad424; try { const _0x4d1ef5 = localStorage[_0x402fc3(0x2c6)]('chatHistory_' + _0x1e39b1), _0x5d3bf6 = JSON[_0x402fc3(0x7a8)](_0x4d1ef5 || '[]'); return Array[_0x402fc3(0x79f)](_0x5d3bf6) ? _0x5d3bf6 : []; } catch { return []; } } function _0x407b35(_0x20f774, _0x39f7d2) { const _0x438d66 = _0x5ad424, _0x47d6d6 = Math['max'](0x1, Number(_0x128784['preferences']?.['perChatContextLines'] ?? 0x64)), _0x35c9cf = _0x128784[_0x438d66(0x295)]['filter'](_0x3392c7 => _0x3392c7[_0x438d66(0x4de)][_0x438d66(0x9ac)](_0x20f774))[_0x438d66(0x8e2)]((_0x521392, _0x37d25c) => _0x521392['id'] === _0x39f7d2 ? -0x1 : _0x37d25c['id'] === _0x39f7d2 ? 0x1 : 0x0), _0x4eae77 = [], _0x279d3f = {}; for (const _0x1beb58 of _0x35c9cf) { const _0x3511bd = _0x39f7d2 && _0x1beb58['id'] === _0x39f7d2 ? _0x128784['conversationHistory'] : _0xe8e2d1(_0x1beb58['id']); if (!_0x3511bd?.['length']) continue; const _0x8f6199 = _0x4b4c37(_0x1beb58, _0x3511bd, _0x47d6d6); if (!_0x8f6199[_0x438d66(0x36c)]) continue; _0x4eae77['push'](_0x438d66(0x387) + _0x4c1e1a(_0x1beb58) + '\x0a' + _0x8f6199['join']('\x0a')), _0x279d3f[_0x1beb58['id']] = _0x8f6199[_0x438d66(0x36c)]; } return { 'omniText': _0x4eae77[_0x438d66(0x9cc)]('\x0a\x0a'), 'usedCounts': _0x279d3f }; } function _0x118e(_0x34de6b, _0x34eed3) { const _0x5f5465 = _0x5f54(); return _0x118e = function (_0x118ebe, _0x5e45f4) { _0x118ebe = _0x118ebe - 0x179; let _0x45dd35 = _0x5f5465[_0x118ebe]; return _0x45dd35; }, _0x118e(_0x34de6b, _0x34eed3); } function _0xc82808(_0x440f68) { const _0x3ce36d = _0x5ad424; let _0x4f9af3 = null; const _0x4c9edc = _0x128784[_0x3ce36d(0x295)][_0x3ce36d(0x89c)](_0x1d5b3f => _0x1d5b3f[_0x3ce36d(0x4de)][_0x3ce36d(0x9ac)](_0x440f68)); for (const _0x40ec99 of _0x4c9edc) { const _0x16c71b = _0xe8e2d1(_0x40ec99['id']); if (_0x16c71b && _0x16c71b[_0x3ce36d(0x36c)] > 0x0) { const _0x21ebde = _0x16c71b[_0x16c71b['length'] - 0x1]; (!_0x4f9af3 || _0x21ebde[_0x3ce36d(0x89b)] > _0x4f9af3['timestamp']) && (_0x4f9af3 = _0x21ebde); } } return _0x4f9af3; } function _0x59c1a6(_0x10facf) { const _0x1676cb = _0x5ad424; if (!_0x10facf || !_0x10facf['includes'](',')) return _0x10facf; const _0x3ee9f3 = _0x10facf['split'](',')[_0x1676cb(0x946)](_0x4c2d22 => _0x4c2d22[_0x1676cb(0x6df)]()); return _0x3ee9f3[Math[_0x1676cb(0x2b4)](Math[_0x1676cb(0x1c0)]() * _0x3ee9f3['length'])]; } function _0x17d4de(_0x341642) { return new Promise(_0x20bfec => { const _0x77f1a8 = _0x118e; if (_0x77f1a8(0x402) === _0x77f1a8(0x402)) { const _0x5c9f04 = document[_0x77f1a8(0x655)](_0x77f1a8(0x20f)), _0x1b92ff = document[_0x77f1a8(0x655)]('modal-text'), _0x477c4b = document[_0x77f1a8(0x655)](_0x77f1a8(0x32e)), _0x276fc0 = document['getElementById']('modal-cancel'), _0x8f2671 = document[_0x77f1a8(0x655)](_0x77f1a8(0x58b)); _0x1b92ff[_0x77f1a8(0x68f)] = _0x341642, _0x5c9f04[_0x77f1a8(0x385)][_0x77f1a8(0x1cd)] = _0x77f1a8(0x4d4); const _0x1ee7b4 = _0x2eeaab => { const _0x43b848 = _0x77f1a8; _0x5c9f04['style'][_0x43b848(0x1cd)] = _0x43b848(0x44e), _0x477c4b[_0x43b848(0x9c8)] = _0x276fc0['onclick'] = _0x8f2671[_0x43b848(0x9c8)] = null, document[_0x43b848(0x6bf)]('keydown', _0x5a2fed), _0x20bfec(_0x2eeaab); }, _0x5a2fed = _0x504ae5 => { const _0x362182 = _0x77f1a8; if (_0x504ae5[_0x362182(0x956)] === _0x362182(0x790)) _0x1ee7b4(![]); if (_0x504ae5[_0x362182(0x956)] === _0x362182(0x487)) _0x1ee7b4(!![]); }; _0x477c4b[_0x77f1a8(0x9c8)] = () => _0x1ee7b4(!![]), _0x276fc0[_0x77f1a8(0x9c8)] = () => _0x1ee7b4(![]), _0x8f2671[_0x77f1a8(0x9c8)] = () => _0x1ee7b4(![]), document[_0x77f1a8(0x203)](_0x77f1a8(0x916), _0x5a2fed); } else { const _0x4adcea = _0x129173['worldBooks'][_0x77f1a8(0x787)](_0x4c4ab4 => _0x4c4ab4['id'] === _0xc581c1); _0x4adcea && (_0x4adcea[_0x77f1a8(0x4da)] = _0x192e64, _0x4adcea[_0x77f1a8(0x472)] = _0xd5b615); } }); } function _0x420e01(_0x14f97c) { const _0x492488 = _0x5ad424, _0x109019 = document['getElementById'](_0x492488(0x7a9)); _0x109019['textContent'] = _0x14f97c, _0x109019[_0x492488(0x385)][_0x492488(0x1cd)] = _0x492488(0x3d3); if (_0x420e01['_t']) clearTimeout(_0x420e01['_t']); _0x420e01['_t'] = setTimeout(() => { const _0xf9775f = _0x492488; _0x109019['style']['display'] = _0xf9775f(0x44e); }, 0x640); } function _0x4b28c1() { const _0x5153ba = _0x5ad424, _0x3eb369 = document[_0x5153ba(0x655)]('app-pages-container'), _0x17ce19 = document[_0x5153ba(0x655)](_0x5153ba(0x7b1)), _0x2cc5f8 = document[_0x5153ba(0x49d)](_0x5153ba(0x499)); if (!_0x3eb369 || !_0x17ce19 || _0x2cc5f8['length'] === 0x0) return; let _0x156e00 = 0x0; const _0x25316d = _0x2cc5f8['length']; function _0x17573a(_0x82ffaa) { const _0x386ec1 = _0x5153ba; if (_0x82ffaa < 0x0 || _0x82ffaa >= _0x25316d) return; _0x17ce19[_0x386ec1(0x385)]['transform'] = _0x386ec1(0x569) + _0x82ffaa * (0x64 / _0x25316d) + '%)', _0x2cc5f8[_0x386ec1(0x4d0)](_0x395bee => _0x395bee[_0x386ec1(0x421)][_0x386ec1(0x66f)](_0x386ec1(0x576))), _0x2cc5f8[_0x82ffaa][_0x386ec1(0x421)]['add'](_0x386ec1(0x576)), _0x156e00 = _0x82ffaa; } _0x2cc5f8[_0x5153ba(0x4d0)](_0x24a9db => { const _0x142fe6 = _0x5153ba; _0x24a9db['addEventListener'](_0x142fe6(0x783), () => { const _0x2fc9b6 = _0x142fe6; if (_0x2fc9b6(0x8fc) === _0x2fc9b6(0x8fc)) { const _0x286d4a = parseInt(_0x24a9db['dataset']['page'], 0xa); _0x17573a(_0x286d4a); } else _0x4bad26(), _0x213bd8(_0x2fc9b6(0x7e1), 'chat'); }); }); let _0x5b4a62 = 0x0, _0x5bf309 = 0x0, _0x200fc3 = 0x0, _0x220a16 = ![], _0x443d05 = ''; _0x3eb369['addEventListener']('touchstart', _0x3308d3 => { const _0x17b9ad = _0x5153ba; if (_0x17b9ad(0x563) !== _0x17b9ad(0x563)) { const _0x13bb58 = _0x1d9beb['target'][_0x17b9ad(0x5a7)]; !_0x13bb58[_0x17b9ad(0x8b1)][_0x17b9ad(0x878)](_0x5ac4c6) && _0x13bb58['createObjectStore'](_0x3db68d, { 'keyPath': 'id' }), !_0x13bb58['objectStoreNames']['contains']('music_library') && _0x13bb58[_0x17b9ad(0x7b6)](_0x17b9ad(0x428), { 'keyPath': 'id' }); } else _0x5b4a62 = _0x3308d3[_0x17b9ad(0x4e0)][0x0][_0x17b9ad(0x55f)], _0x5bf309 = _0x3308d3[_0x17b9ad(0x4e0)][0x0]['clientY'], _0x220a16 = !![], _0x443d05 = ''; }, { 'passive': !![] }), _0x3eb369[_0x5153ba(0x203)](_0x5153ba(0x21c), _0x392daa => { const _0x4c56f2 = _0x5153ba; if (!_0x220a16) return; if (_0x443d05 === '') { const _0xb12b90 = _0x392daa[_0x4c56f2(0x4e0)][0x0]['clientX'] - _0x5b4a62, _0x287346 = _0x392daa[_0x4c56f2(0x4e0)][0x0][_0x4c56f2(0x904)] - _0x5bf309; Math['abs'](_0xb12b90) > Math[_0x4c56f2(0x7b2)](_0x287346) ? _0x4c56f2(0x473) !== 'EEEoA' ? (_0x3a608d[_0x4c56f2(0x21f)] = _0x576016[_0x4c56f2(0x21f)], _0x5d14f8[_0x4c56f2(0x462)] = _0x2441e9[_0x4c56f2(0x462)]) : _0x443d05 = _0x4c56f2(0x970) : _0x443d05 = 'vertical'; } _0x443d05 === _0x4c56f2(0x970) && (_0x4c56f2(0x9b0) !== 'jizrY' ? _0x2566be = _0x539752[_0x4c56f2(0x4da)] : _0x392daa[_0x4c56f2(0x7cc)]()); }, { 'passive': ![] }), _0x3eb369[_0x5153ba(0x203)]('touchend', _0x34059c => { const _0xbb160e = _0x5153ba; if (!_0x220a16) return; _0x200fc3 = _0x34059c[_0xbb160e(0x671)][0x0]['screenX'], _0x443d05 === _0xbb160e(0x970) && _0xee080f(), _0x220a16 = ![]; }); function _0xee080f() { const _0x26f321 = _0x5153ba; if (_0x26f321(0x8b2) !== 'qnTeH') _0x5d3e26 = _0xebf1b4[_0x26f321(0x2c6)](_0x26f321(0x25f) + _0x300f39[_0x26f321(0x789)]); else { const _0x32db71 = 0x32; if (_0x200fc3 < _0x5b4a62 - _0x32db71) _0x17573a(_0x156e00 + 0x1); else _0x200fc3 > _0x5b4a62 + _0x32db71 && _0x17573a(_0x156e00 - 0x1); } } } function _0x50a74a() { return new Promise(_0x399c9c => { const _0x2b204f = _0x118e, _0x1a796f = document[_0x2b204f(0x655)](_0x2b204f(0x717)), _0x3c1f8d = document['getElementById'](_0x2b204f(0x938)), _0x3980a1 = document[_0x2b204f(0x655)]('music-input-artist'), _0x1420f9 = document[_0x2b204f(0x655)](_0x2b204f(0x6da)), _0x18a5b8 = document[_0x2b204f(0x655)]('cancel-music-input'), _0x4bf9f2 = document[_0x2b204f(0x655)]('music-input-backdrop'); _0x3c1f8d[_0x2b204f(0x9bf)] = '', _0x3980a1['value'] = '', _0x1a796f[_0x2b204f(0x421)]['add'](_0x2b204f(0x8d5)), _0x3c1f8d[_0x2b204f(0x76c)](); const _0x3c5ae9 = _0x2f0250 => { const _0x53d64d = _0x2b204f; _0x1a796f[_0x53d64d(0x421)][_0x53d64d(0x66f)](_0x53d64d(0x8d5)), _0x1420f9[_0x53d64d(0x9c8)] = null, _0x18a5b8[_0x53d64d(0x9c8)] = null, _0x4bf9f2[_0x53d64d(0x9c8)] = null, document[_0x53d64d(0x6bf)](_0x53d64d(0x916), _0xfa014f), _0x399c9c(_0x2f0250); }, _0x51ab62 = () => { const _0x5ca7e5 = _0x2b204f; if (_0x5ca7e5(0x28a) !== _0x5ca7e5(0x765)) { const _0x57323c = _0x3c1f8d[_0x5ca7e5(0x9bf)][_0x5ca7e5(0x6df)](), _0x7e4074 = _0x3980a1[_0x5ca7e5(0x9bf)][_0x5ca7e5(0x6df)](); if (!_0x57323c || !_0x7e4074) { _0x420e01(_0x5ca7e5(0x7e9)); return; } _0x3c5ae9({ 'songName': _0x57323c, 'artist': _0x7e4074 }); } else _0xebc421[_0x5ca7e5(0x68f)] = '旁白', _0x1b9d83[_0x5ca7e5(0x68f)] = _0x5ca7e5(0x29d); }, _0xfa014f = _0x30a317 => { const _0x2542d0 = _0x2b204f; if (_0x2542d0(0x625) !== _0x2542d0(0x625)) { const _0x355ba2 = _0x8ab46a(_0x18e341[_0x2542d0(0x9bf)]); if (_0x5aa5ec(_0x355ba2) || _0x355ba2 <= 0x0) { _0x21417b('请输入有效的转账金额！'); return; } const _0x4f67e0 = _0x7c53c0(); let _0x3637a0 = null; _0x4f67e0['type'] === 'group' ? _0x3637a0 = _0x564ff9['value'] : _0x3637a0 = _0x4f67e0['participantIds'][0x0]; const _0x83853a = _0x1a7b19(_0x4f67e0['id']), _0x1323a6 = { 'role': _0x2542d0(0x500), 'type': 'transfer', 'content': _0x2542d0(0x4a4) + (_0x4ada02(_0x3637a0)?.[_0x2542d0(0x4da)] || '未知') + '\x20转账\x20' + _0x355ba2 + ']', 'amount': _0x355ba2, 'recipientId': _0x3637a0, 'senderId': _0x83853a['id'], 'timestamp': _0x595fbe[_0x2542d0(0x8a2)]() }; _0x10c467['conversationHistory'][_0x2542d0(0x1e5)](_0x1323a6), _0x4dd074(), _0x590570(), _0x4137f8[_0x2542d0(0x421)][_0x2542d0(0x66f)](_0x2542d0(0x8d5)); } else { if (_0x30a317[_0x2542d0(0x956)] === _0x2542d0(0x790)) _0x3c5ae9(null); if (_0x30a317[_0x2542d0(0x956)] === _0x2542d0(0x487)) { if (_0x2542d0(0x5b8) !== _0x2542d0(0x5b8)) { const _0x56bb48 = _0x52925e['scrollHeight']; _0x3efe91[_0x2542d0(0x4d8)] = _0x560fd4 + (_0x56bb48 - _0x57e352); } else _0x30a317[_0x2542d0(0x7cc)](), _0x51ab62(); } } }; _0x1420f9['onclick'] = _0x51ab62, _0x18a5b8['onclick'] = () => _0x3c5ae9(null), _0x4bf9f2[_0x2b204f(0x9c8)] = () => _0x3c5ae9(null), document[_0x2b204f(0x203)](_0x2b204f(0x916), _0xfa014f); }); } function _0x3f15ac(_0x3cfb87) { const _0x470186 = _0x5ad424; if (!_0x3cfb87) return []; const _0x9985d0 = _0x3cfb87[_0x470186(0x6df)](); if (_0x9985d0[_0x470186(0x3fd)](_0x470186(0x228)) && _0x9985d0[_0x470186(0x49a)](_0x470186(0x2be))) { if (_0x470186(0x805) === _0x470186(0x9c0)) { const _0x32007e = _0x1a71ef(_0x231d25[_0x470186(0x838)]())[_0x470186(0x7d2)](0x2, '0'), _0x24245c = _0x1ceb75(_0x28004a[_0x470186(0x746)]())[_0x470186(0x7d2)](0x2, '0'); _0x13ac85[_0x470186(0x68f)] = _0x32007e + ':' + _0x24245c; const _0x41f5a4 = _0x1459b8[_0x470186(0x909)]() + 0x1, _0x589bf8 = _0x1fe341[_0x470186(0x731)](), _0x334658 = ['星期日', _0x470186(0x3b2), _0x470186(0x372), '星期三', _0x470186(0x24d), _0x470186(0x47b), _0x470186(0x6e0)][_0x329f80[_0x470186(0x4b5)]()]; _0x50cf32[_0x470186(0x68f)] = _0x41f5a4 + '月' + _0x589bf8 + '日\x20' + _0x334658; } else return [_0x9985d0]; } const _0x446d07 = /(\[sticker:[^\]]+\]|\[music:[^\]]+\]|\[transfer:[^\]]+\])/g, _0x16c45f = '|||CMD|||', _0x27c9d6 = [], _0x6eae38 = _0x3cfb87['replace'](_0x446d07, _0x1ebe9a => { const _0x2a8577 = _0x470186; if ('wCVAr' === 'nkLGt') _0x4f76ca[_0x2a8577(0x68f)] = _0x48836e[_0x2a8577(0x82f)](_0x614a1f)[_0x2a8577(0x946)](_0x2c483a => _0x2c483a[_0x2a8577(0x1de)]['textContent']['trim']())[_0x2a8577(0x9cc)]('、'); else return _0x27c9d6[_0x2a8577(0x1e5)](_0x1ebe9a), _0x16c45f; }), _0x766f87 = _0x6eae38['split'](_0x16c45f), _0x40ed6b = []; let _0x8021c6 = 0x0; return _0x766f87[_0x470186(0x4d0)]((_0x2a766b, _0x32894f) => { const _0x34e01c = _0x470186; if (_0x34e01c(0x759) === 'GIpRb') { const _0x5b0aa7 = _0x2a766b['trim'](); _0x5b0aa7 && _0x40ed6b['push'](..._0x5cf620(_0x5b0aa7)); if (_0x8021c6 < _0x27c9d6[_0x34e01c(0x36c)]) { if ('ykTue' === _0x34e01c(0x208)) _0x40ed6b[_0x34e01c(0x1e5)](_0x27c9d6[_0x8021c6]['trim']()), _0x8021c6++; else { const _0x5a9684 = _0x28ab55[_0x34e01c(0x67b)] || _0x2ae78c?.[_0x34e01c(0x4de)][0x0], _0x5be223 = _0x420c63(_0x5a9684); _0x6eb55e = _0x5be223 ? _0x5be223[_0x34e01c(0x4da)] : '角色'; } } } else _0x54dc82 = { 'characterId': _0x43f23e, 'entries': [] }, _0x280613[_0x34e01c(0x401)][_0x34e01c(0x1e5)](_0x3b35a2); }), _0x40ed6b; } function _0x4a035c(_0x2ae47e) { const _0xaffb3b = _0x5ad424; if (!_0x2ae47e) return []; let _0x4656dc = String(_0x2ae47e)[_0xaffb3b(0x6df)](); const _0x4f3dba = _0x4656dc['match'](/```(?:json)?([\s\S]*?)```/i); if (_0x4f3dba) _0x4656dc = _0x4f3dba[0x1][_0xaffb3b(0x6df)](); try { if (_0xaffb3b(0x763) === 'FoxEj') { const _0x67e9cb = JSON['parse'](_0x4656dc); if (_0x67e9cb && Array[_0xaffb3b(0x79f)](_0x67e9cb[_0xaffb3b(0x404)])) return _0x67e9cb[_0xaffb3b(0x404)][_0xaffb3b(0x946)](_0xb3ec06 => typeof _0xb3ec06 === _0xaffb3b(0x7d9) ? _0xb3ec06 : _0xb3ec06?.['content'])[_0xaffb3b(0x89c)](Boolean)[_0xaffb3b(0x7fe)](_0x5cf620); const _0x2f00dd = [_0xaffb3b(0x7ea), _0xaffb3b(0x18c), 'message', _0xaffb3b(0x64b), _0xaffb3b(0x472), _0xaffb3b(0x91c), _0xaffb3b(0x948)]; if (_0x67e9cb && typeof _0x67e9cb === 'object') { const _0x5c718a = []; for (const _0x4e80fd of Object[_0xaffb3b(0x7ae)](_0x67e9cb)) { const _0x4b9f76 = _0x4e80fd[_0xaffb3b(0x6b2)](); if (_0x2f00dd[_0xaffb3b(0x383)](_0x87866c => _0x4b9f76[_0xaffb3b(0x3fd)](_0x87866c))) { const _0x7e33f7 = _0x67e9cb[_0x4e80fd]; if (typeof _0x7e33f7 === _0xaffb3b(0x7d9)) _0x5c718a['push'](_0x7e33f7); if (Array['isArray'](_0x7e33f7)) _0x7e33f7[_0xaffb3b(0x4d0)](_0x1df82c => { const _0x5d344d = _0xaffb3b; if (_0x5d344d(0x675) !== _0x5d344d(0x675)) _0x260329['toBlob'](_0x52f4bd => { const _0xa41349 = _0x5d344d; _0x52f4bd ? _0x175150(_0x52f4bd) : _0x9dca2c(new _0x4c969a(_0xa41349(0x4ff))); }, _0x27dbdf, _0x2f6072); else { if (typeof _0x1df82c === _0x5d344d(0x7d9)) _0x5c718a[_0x5d344d(0x1e5)](_0x1df82c); } }); } } if (_0x5c718a[_0xaffb3b(0x36c)]) return _0x5c718a['flatMap'](_0x5cf620)['slice'](0x0, 0x9); } } else _0x8302b8 = '0x' + _0x3b6974[0x1] + _0x226c56[0x2], _0x2875b7 = '0x' + _0xe96a06[0x3] + _0x5a54b1[0x4], _0xdbfafa = '0x' + _0x4d38a6[0x5] + _0x36a1a9[0x6]; } catch { } if (/[{\[]/[_0xaffb3b(0x7ec)](_0x4656dc) && /":/[_0xaffb3b(0x7ec)](_0x4656dc)) { if ('wIzll' === _0xaffb3b(0x3ee)) _0x1f71c2[_0xaffb3b(0x421)][_0xaffb3b(0x266)](_0xaffb3b(0x542)); else { const _0x4b8981 = [], _0x120977 = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x503001; while ((_0x503001 = _0x120977[_0xaffb3b(0x8bb)](_0x4656dc)) !== null) { const _0x543dca = _0x503001[0x1][_0xaffb3b(0x55b)](/\\"/g, '\x22')[_0xaffb3b(0x55b)](/\\n/g, '\x0a')['trim'](); if (_0x543dca) _0x4b8981[_0xaffb3b(0x1e5)](_0x543dca); } if (_0x4b8981[_0xaffb3b(0x36c)]) return _0x4b8981[_0xaffb3b(0x7fe)](_0x5cf620)['slice'](0x0, 0x9); } } return _0x5cf620(_0x4656dc); } function _0x5cf620(_0xa86649) { const _0x2464d2 = _0x5ad424; if (!_0xa86649) return []; const _0x2fd810 = String(_0xa86649)['trim'](), _0x2fd087 = _0x2fd810[_0x2464d2(0x7c7)](/(?<=[。！？!?…])\s+|[\r\n]+/)['map'](_0x5efe64 => _0x5efe64['trim']())['filter'](Boolean); if (_0x2fd087[_0x2464d2(0x36c)] > 0x0) return _0x2fd087[_0x2464d2(0x6e3)](0x0, 0x9); return [_0x2fd810][_0x2464d2(0x89c)](Boolean); } const _0x419231 = _0x5ad424(0x191), _0xee1486 = _0x5ad424(0x91f), _0x3be08a = new Promise((_0x398751, _0xa47d6c) => { const _0x2252be = _0x5ad424, _0x121212 = indexedDB['open'](_0x419231, 0x2); _0x121212[_0x2252be(0x9a7)] = () => _0xa47d6c(_0x2252be(0x1a1)), _0x121212[_0x2252be(0x265)] = () => _0x398751(_0x121212[_0x2252be(0x5a7)]), _0x121212[_0x2252be(0x42e)] = _0x5d8c06 => { const _0xeebe27 = _0x2252be, _0x59b12d = _0x5d8c06[_0xeebe27(0x949)]['result']; !_0x59b12d['objectStoreNames'][_0xeebe27(0x878)](_0xee1486) && _0x59b12d[_0xeebe27(0x7b6)](_0xee1486, { 'keyPath': 'id' }); const _0x4810b5 = _0xeebe27(0x428); !_0x59b12d['objectStoreNames'][_0xeebe27(0x878)](_0x4810b5) && _0x59b12d[_0xeebe27(0x7b6)](_0x4810b5, { 'keyPath': 'id' }); }; }); async function _0x226e0a(_0x24a39e) { const _0x5b46df = await _0x3be08a; return new Promise((_0x148835, _0x5093e3) => { const _0x30e9b8 = _0x118e, _0x3ea717 = _0x5b46df['transaction'](_0xee1486, _0x30e9b8(0x257)), _0x4f0809 = _0x3ea717[_0x30e9b8(0x4ba)](_0xee1486), _0x39107f = _0x4f0809['get'](_0x24a39e); _0x39107f[_0x30e9b8(0x265)] = () => _0x148835(_0x39107f[_0x30e9b8(0x5a7)] ? _0x39107f[_0x30e9b8(0x5a7)]['blob'] : null), _0x39107f[_0x30e9b8(0x9a7)] = () => _0x5093e3(_0x39107f[_0x30e9b8(0x9de)]); }); } async function _0x36c0a8(_0x2e23ff, _0x429a1d) { const _0x2b48a4 = await _0x3be08a; return new Promise((_0x81d1f6, _0x310e21) => { const _0x2403fc = _0x118e, _0x57cd70 = _0x2b48a4[_0x2403fc(0x7c0)](_0xee1486, 'readwrite'), _0x33459f = _0x57cd70[_0x2403fc(0x4ba)](_0xee1486), _0x5c76d7 = _0x33459f[_0x2403fc(0x505)]({ 'id': _0x2e23ff, 'blob': _0x429a1d }); _0x5c76d7['onsuccess'] = () => _0x81d1f6(_0x5c76d7[_0x2403fc(0x5a7)]), _0x5c76d7['onerror'] = () => _0x310e21(_0x5c76d7[_0x2403fc(0x9de)]); }); } async function _0x4dfe17(_0x1162c3) { const _0x1d5ded = await _0x3be08a; return new Promise((_0x2448ac, _0x302efb) => { const _0x445a32 = _0x118e, _0x377fc8 = _0x1d5ded[_0x445a32(0x7c0)](_0xee1486, _0x445a32(0x939)), _0x99bd2e = _0x377fc8[_0x445a32(0x4ba)](_0xee1486), _0x23f4cd = _0x99bd2e[_0x445a32(0x48f)](_0x1162c3); _0x23f4cd[_0x445a32(0x265)] = () => _0x2448ac(), _0x23f4cd[_0x445a32(0x9a7)] = () => _0x302efb(_0x23f4cd[_0x445a32(0x9de)]); }); } function _0x454232(_0x5e297a) { const _0x34b00d = _0x5ad424; return fetch(_0x5e297a)[_0x34b00d(0x745)](_0xc240cb => _0xc240cb['blob']()); }
  </script>
  <div id="listen-together-ui" style="display: none;">
    <div class="lt-ui-backdrop"></div>
    <div class="lt-ui-main">
      <div class="lt-ui-header">
        <span id="lt-ui-header-title">正在与 TA 一起听</span>
        <button id="lt-ui-close-btn">×</button>
      </div>
      <div class="lt-ui-content">
        <div class="lt-ui-cover-container">
          <img id="lt-ui-cover-art" src="">
        </div>
        <div class="lt-ui-info">
          <h2 id="lt-ui-song-title">歌曲名称</h2>
          <p id="lt-ui-song-artist">歌手</p>
        </div>
        <div id="lt-ui-lyrics-container">
          <p class="no-lyrics-placeholder">暂无歌词</p>
        </div>
      </div>
    </div>
  </div>
  <div id="summarize-modal" class="choice-modal">
    <div id="summarize-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <button id="close-summary-button" class="header-button" style="min-width: 50px;">关闭</button>
        <span class="header-title">聊天记录总结</span>
        <button id="copy-summary-button" class="header-button" style="min-width: 50px;">复制</button>
      </div>
      <div class="content" style="flex-grow: 1; padding: 0;">
        <textarea id="summary-textarea" placeholder="AI正在拼命总结中，别催..."></textarea>
      </div>
    </div>
  </div>

</body>

</html>
