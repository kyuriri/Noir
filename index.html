<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

  <title>Noir搓的小手机</title>
  <style>
    .message p,
    .diary-content {
      user-select: none;
      -webkit-user-select: none;
    }

    .lt-end-session-btn {
      font-size: 1.5rem;
      color: inherit;
      /* 继承父元素的颜色 */
      opacity: 0.6;
      cursor: pointer;
      padding: 0 5px;
      line-height: 1;
      font-weight: bold;
    }

    .lt-end-session-btn:hover {
      opacity: 1;
    }

    /* --- Noir's Refactor: Feed Loader Style --- */
    #feed-loader {
      position: absolute;
      inset: 0;
      background: rgba(244, 248, 255, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--text-color);
      font-size: 1rem;
      flex-direction: column;
      gap: 10px;
    }

    .loader-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* --- End of Refactor --- */
    /*
        Noir's Mizuiro Theme
        - 哼，看好了，这才是设计。
      */
    /*
          Noir's Mizuiro Theme
          - 哼，看好了，这才是设计。
        */
    :root {
      --phone-width: 375px;
      --phone-height: 812px;
      --user-bg-image: url('');

      /* === Noir's Ultimate Dynamic Theme Engine v2.0 === */
      /* 哼，现在所有的颜色都听从这三个总开关的指挥。*/
      --primary-hue: 35;
      --primary-saturation: 25%;
      --primary-lightness: 80%;

      /* 核心颜色 */
      --primary-color: hsl(var(--primary-hue), var(--primary-saturation), var(--primary-lightness));
      /* 强调色/用户气泡色，现在也是动态的 */
      --accent-color: hsl(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%));

      /* 哼，看好了，这些就是被我重新接上线的“电灯” */

      /* 文字颜色：根据主题亮度自动变深或变浅 */
      --text-color: hsl(var(--primary-hue), 15%, calc(100% - var(--primary-lightness) / 1.1));
      --text-color-light: hsl(var(--primary-hue), 10%, calc(100% - var(--primary-lightness) / 1.3));

      /* 表面背景：半透明，亮度比主色高一点 */
      --surface-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.4);

      /* 卡片/AI气泡背景：比表面背景更亮一点 */
      --card-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.5);

      /* 边框颜色 */
      --border-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness)), 0.3);

      /* 阴影颜色 */
      --soft-shadow: 0 4px 12px hsla(var(--primary-hue), 40%, calc(var(--primary-lightness) - 10%), 0.15);

      /* 动态页的设置保持不变 */
      --feed-bg-image: none;
      --feed-overlay-opacity: 0.12;
      --feed-overlay-rotate: 22deg;
      --feed-overlay-speed: 48s;

      /* 气泡样式也完全动态化 */
      --bubble-radius: 18px;
      --bubble-outline: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
      --bubble-user-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%), 0.5);
      /* <-- 哼，改成0.5，现在够“虚无”了吧 */
      --bubble-ai-bg: var(--card-bg);

      /* ▼▼▼ 把下面这两行加进去 ▼▼▼ */
      --dropdown-alpha: 0.9;
      /* 下拉菜单的透明度，0到1 */
      --feed-card-alpha: 0.7;
      /* 动态卡片的透明度，0到1 */


      /* ▲▲▲ 添加到这里结束 ▲▲▲ */

    }

    body {
      display: flex;
      align-items: center;
      /* <-- 加上这句 */
      justify-content: center;
      /* <-- 还有这句 */
      height: 100vh;
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
    }

    #phone-container {
      width: 100%;
      /* 占满屏幕宽度 */
      height: 100vh;
      /* 占满屏幕高度 */
      background-color: white;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* 是不是清爽多了？ */
      position: relative;
      /* <-- 就是这句，告诉它“你是个家长了，给我看好家里的东西！” */
    }

    .screen {
      flex-grow: 1;
      display: none;
      flex-direction: column;
      background-color: #f9f9f9;
      /* 哼，所有屏幕默认都给我变白 */
      /* 让背景透出来 */
      overflow: hidden;
      color: var(--text-color);
    }

    .screen.active {
      display: flex;
    }

    /* 这个是通用的头像预览样式 */
    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
      margin-top: 5px;
      cursor: pointer;
    }

    /* --- 通用顶栏 --- */
    .header,
    #chat-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--primary-color);
      font-weight: 500;
      min-width: 50px;
      text-align: center;
      /* ▼▼▼ 哼，加上这三句，给我立正站好 ▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- 聊天列表 --- */
    #chat-list-pane {
      background-color: transparent;
      border-right: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 加上这句 */
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      /* 防止它在横向布局里被挤扁 */
      display: flex;
      flex-direction: column;
    }

    #chat-list-container {
      flex-grow: 1;
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
    }

    #character-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .character-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      /* backdrop-filter: blur(10px);*/
      border-radius: 16px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .character-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(138, 180, 228, 0.2);
    }

    .char-info-wrapper {
      flex-grow: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .character-item .char-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      margin-right: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .character-item .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .character-item .char-remark {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    #chat-screen-container {
      position: relative;
      /* 告诉里面的绝对定位元素，要以我为基准 */
      flex-grow: 1;
      /* 确保它能撑满 chat-screen 的空间 */
      overflow: hidden;
      /* 把滑出去的部分藏起来，这很重要 */
      display: flex;
      /* 保持内部元素的 flex 布局 */
    }

    /* --- 聊天窗口 --- */


    #chat-view-pane {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 还有这句 */
      background-color: transparent;
      z-index: 10;
    }

    #chat-screen.show-chat-view #chat-list-pane {
      transform: translateX(-100%);
    }

    #chat-screen.show-chat-view #chat-view-pane {
      transform: translateX(0);
    }

    #chat-messages {
      flex-grow: 1;
      padding: 5px;
      overflow-y: auto;
      display: flex;
      /* <-- 加上这个 */
      flex-direction: column;
      /* <-- 还有这个 */
      contain: content;
      contain: content;
      /* <-- 哼，就是这句救命神药！ */
    }



    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 10px;
      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.7);
      flex-shrink: 0;
    }

    .message {
      padding: 10px 16px;
      border-radius: 20px;
      line-height: 1.5;
      word-break: break-word;
      box-shadow: var(--soft-shadow);
    }

    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
    }

    .message.user {
      background-color: var(--accent-color);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .message.ai {
      background-color: var(--card-bg);
      border: 1px solid rgba(255, 255, 255, 0.8);
      color: var(--text-color);
      border-bottom-left-radius: 5px;
    }

    .message p {
      margin: 0;
    }

    .sticker-content,
    .message-image-content {
      max-width: 120px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
    }

    .message-image-content {
      max-width: 160px;
    }

    /* --- 其他屏幕和组件 --- */
    /* --- Noir's Fix: API 模型列表的样式修正 --- */
    .model-input-container {
      position: relative;
      /* 关键！让里面的绝对定位元素有家可回 */
      display: flex;
      gap: 8px;
    }

    .custom-model-dropdown {
      display: none;
      /* 默认藏起来 */
      position: absolute;
      top: 100%;
      /* 精准定位到输入框正下方 */
      left: 0;
      right: 80px;
      /* 留出“获取”按钮的位置 */
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*   backdrop-filter: blur(10px);*/
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 100;
      /* 确保它在最上层 */
      box-shadow: var(--soft-shadow);
    }

    .checkboxes-container {
      display: none;
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*  backdrop-filter: blur(10px);*/
      z-index: 10;
      border-radius: 8px;
      margin-top: 4px;
    }

    .custom-model-dropdown.show {
      display: block;
      /* 需要的时候再显示 */
    }

    .custom-model-dropdown div {
      padding: 10px 12px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    .custom-model-dropdown div:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    /* --- 其他屏幕和组件 --- */
    /* 在这个注释下面加上主屏幕的样式 */
    #home-screen {
      position: relative;
      /* <-- 就加上这一行！ */


      gap: 20px;
      /* 图标之间的距离 */

      /* 声明！这里现在是我的地盘！*/
      flex-direction: column;
      /* 里面的东西，全体给我垂直排队！*/
      justify-content: space-between;
      /* 核心！顶部和底部的元素给我贴边站好，中间的自动拉开距离！*/
      padding-bottom: 0;
      /* 把内边距去掉，让Dock栏能完美贴底 */
    }

    .app-icon {
      width: 75px;
      /* <--- 就是这里，我把它加宽了 */
      height: 90px;
      /* <--- 高度也顺便调整一下 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: absolute;
      z-index: 40;
      padding: 5px;
      box-sizing: border-box;
      margin: 0;
    }

    .app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 2px;
      /* <-- 哼，就是这里，把5px改成2px，让图标和文字的距离拉近一点 */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      background-color: var(--surface-bg);
      box-shadow: none;
      transition: transform 0.2s ease;
    }

    .app-icon-img svg {
      stroke: currentColor;
      /* SVG的线条颜色会继承上面的 color */
    }

    .app-icon span {
      font-size: 0.75rem;
      /* 文本也相应缩小 */
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }

    .content {
      padding: 20px;
      overflow-y: auto;
      flex-grow: 1;
      /* <-- 加上这行代码，就是这行！ */
    }

    .form-button {
      width: 100%;
      padding: 12px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--border-color);
      color: var(--text-color);
      border-radius: 8px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    .chat-toolbar {
      display: flex;
      padding: 5px 10px;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      /*   backdrop-filter: blur(10px);*/
      flex-shrink: 0;
    }

    /* ▼▼▼ 用下面这段，替换掉你旧的 .toolbar-button 样式 ▼▼▼ */
    .toolbar-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      /* 这个保留，作为SVG尺寸的参考 */
      cursor: pointer;
      padding: 8px;
      /* 稍微增大点击区域 */
      color: var(--text-color-light);
      /* 让它默认是浅灰色 */
      border-radius: 50%;
      /* 让背景有个圆形轮廓 */
      width: 40px;
      height: 40px;
      display: flex;
      /* 使用flex布局让SVG完美居中 */
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s, color 0.2s;
      /* 加上顺滑的过渡效果 */
    }

    .toolbar-button:hover {
      background-color: var(--border-color);
      /* 鼠标悬停时给个背景 */
      color: var(--primary-color);
      /* 图标颜色变为主题色 */
    }

    /* ▲▲▲ 替换到这里为止 ▲▲▲ */


    /* ▼▼▼ 在下面新增这段SVG的专属样式 ▼▼▼ */
    .toolbar-button svg {
      width: 22px;
      /* SVG图标的尺寸 */
      height: 22px;
      stroke-width: 1.8;
      /* 线条粗细，可以微调 */
      stroke: currentColor;
      /* 核心！让SVG的颜色继承按钮的color属性 */
      fill: none;
      /* 确保是线稿风格 */
      pointer-events: none;
      /* 防止SVG本身干扰点击事件 */
    }

    /* ▲▲▲ 新增到这里为止 ▲▲▲ */

    .sticker-panel {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      flex-shrink: 0;
    }

    .sticker-panel.show {
      display: grid;
    }

    /* --- 输入区域 --- */
    /* --- 输入区域 --- */
    .chat-input-area {
      padding: 10px 12px calc(env(safe-area-inset-bottom, 0px) + 10px);
      background: var(--surface-bg);
      /*  backdrop-filter: saturate(1.2) blur(10px);*/
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    /* 这是我加的新容器，用来实现完美对齐 */
    #chat-input-wrapper {
      display: flex;
      /* Flex大法好，哼 */
      align-items: center;
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 2px 5px;
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-input-wrapper:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-message-input {
      flex-grow: 1;
      /* 让输入框占满剩余空间 */
      border: none;
      background: transparent;
      padding: 9px 12px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 38px;
      width: 38px;
      border: 0;
      border-radius: 50%;
      font-size: 1.2rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
      flex-shrink: 0;
      /* 防止被挤压 */
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    /* 回复按钮，给个不一样的颜色区分 */
    #chat-get-reply-button {
      background: var(--accent-color);
      font-size: 1.5rem;
      /* 让箭头更清晰 */
    }

    #chat-message-input {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 11px 16px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-message-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 40px;
      padding: 0 18px;
      border: 0;
      border-radius: 20px;
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    #chat-get-reply-button {
      display: flex;
      /* 隐藏旧的回复按钮，样式统一到发送按钮 */
    }


    /* --- 引用样式 --- */
    .quote-preview {
      display: none;
      padding: 8px 12px;
      background-color: rgba(255, 255, 255, 0.5);
      border-left: 3px solid var(--primary-color);
      margin: 0 12px 8px;
      border-radius: 6px;
      position: relative;
    }

    #quote-preview-sender {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--primary-color);
    }

    #quote-preview-text {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    .cancel-quote-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #999;
      cursor: pointer;
    }

    .quoted-message-in-bubble {
      background-color: rgba(0, 0, 0, 0.04);
      padding: 8px 10px;
      border-left: 3px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quoted-sender {
      font-weight: bold;
      font-size: 0.8rem;
      color: var(--text-color);
    }

    .quoted-content {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    /* 这是弹窗的“骨架”，让它能居中浮动在屏幕上 */
    .choice-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .choice-modal.show {
      opacity: 1;
      visibility: visible;
    }


    /* --- 弹窗 --- */
    .choice-modal-backdrop {
      background: rgba(0, 0, 0, 0.2);
      /*  backdrop-filter: blur(4px);*/
    }

    .choice-modal-content {
      background: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .choice-modal-button {
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.5);
    }

    .choice-modal-button:hover {
      background-color: rgba(255, 255, 255, 1);
    }

    .choice-modal-button.cancel {
      color: var(--primary-color);
      background: transparent;
    }

    /* --- Noir's Fix: 让“添加”弹窗从底部滑出，更大气 --- */
    #add-choice-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      /* 确保不会超出手机宽度 */
      margin: 0;
      border-radius: 20px 20px 0 0;
      /* 只留顶部圆角 */
      border-bottom-left-radius: 0;
      /* 覆盖通用样式 */
      border-bottom-right-radius: 0;
      /* 覆盖通用样式 */
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      /* 适配iPhone底部安全区 */
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #add-choice-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #add-choice-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
      justify-content: center;
    }

    /* 按钮也重新设计一下，让它们竖着排 */
    #add-choice-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- Noir's Fix: 修正创建群聊时，成员选择列表的样式 --- */
    .member-selection-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .member-selection-item:last-child {
      border-bottom: none;
    }

    /* 关键！就是这里，把头像大小锁死 */
    .member-selection-item .char-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 15px 0 10px;
      object-fit: cover;
    }

    .member-selection-item .char-name {
      font-weight: 500;
      color: var(--text-color);
    }

    .member-selection-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      accent-color: var(--primary-color);
      /* 让勾选框颜色也跟主题统一 */
    }

    /* --- Noir's World Book Styles --- */
    #world-book-list-container {
      padding: 10px;
    }

    .world-book-item {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .world-book-item-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .world-book-item-preview {
      font-size: 0.9rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* --- Noir's Fancy Multi-Select Styles --- */
    .custom-multiselect {
      position: relative;
      user-select: none;
    }

    .select-box {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .select-box.expanded .arrow {
      transform: rotate(180deg);
    }


    .checkboxes-container.visible {
      display: block;
    }

    .checkboxes-container label {
      display: block;
      padding: 10px 12px;
    }

    .checkboxes-container label:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    .checkboxes-container input[type="checkbox"] {
      margin-right: 8px;
      width: auto;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Clock & Timestamp Styles --- */
    /* --- Noir's Badge & App Dock Styles --- */
    #decorative-badge {
      width: 160px;
      height: 160px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
      /* 哼，给你加个阴影，看起来才像样 */
      transform: rotate(-0deg);
      /* 稍微歪一点，显得随意 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      /* 防止拖动时选中图片 */
      z-index: 50;
    }

    #decorative-badge:active {

      transform: rotate(-2deg) scale(1.05);
      /* 抓起来的时候，摆正放大一点 */
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }


    #decorative-badge img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* 保留这句，让你的图片能被很好地填充 */
    }

    /*  #a#app-dock-bottom-left,
    #app-dock-top-right {
      
      哼，现在你们只是幽灵了。
      不需要任何样式，你们的孩子（App图标）会自己找到回家的路。
      它们会相对于 #home-screen 定位。
    
    }
*/

    /* --- Noir's Author Mark: Pixel Chicken --- */
    /* 哼，这就是那个吵着要加的小鸡图标 */
    #noir-author-mark {
      position: absolute;
      /* 相对于父容器定位 */
      right: -30px;
      /* 调整它在时钟右边的位置 */
      top: 50%;
      /* 垂直居中 */
      transform: translateY(-50%);
      /* 精确对齐 */
      width: 20px;
      /* 小鸡的尺寸 */
      height: 20px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="0"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM12 4c.69 0 1.25.56 1.25 1.25S12.69 6.5 12 6.5s-1.25-.56-1.25-1.25S11.31 4 12 4zm0 2c-.69 0-1.25.56-1.25 1.25S11.31 8.5 12 8.5s1.25-.56 1.25-1.25S12.69 6 12 6zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 9.75 10 9.75s1.25-.56 1.25-1.25S10.69 8 10 8zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 9.75 12 9.75s1.25-.56 1.25-1.25S12.69 8 12 8zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 9.75 14 9.75s1.25-.56 1.25-1.25S14.69 8 14 8zM10 10c-.69 0-1.25.56-1.25 1.25S9.31 12.5 10 12.5s1.25-.56 1.25-1.25S10.69 10 10 10zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 12.5 12 12.5s1.25-.56 1.25-1.25S12.69 10 12 10zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 12.5 14 12.5s1.25-.56 1.25-1.25S14.69 10 14 10zM12 12c-.69 0-1.25.56-1.25 1.25S11.31 14.5 12 14.5s1.25-.56 1.25-1.25S12.69 12 12 12zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 15.75 10 15.75s1.25-.56 1.25-1.25S10.69 14 10 14zm4 0c-.69 0-1.25.56-1.25 1.25S13.31 15.75 14 15.75s1.25-.56 1.25-1.25S14.69 14 14 14zM12 16c-.69 0-1.25.56-1.25 1.25S11.31 18.5 12 18.5s1.25-.56 1.25-1.25S12.69 16 12 16zM6 10c-.69 0-1.25.56-1.25 1.25S5.31 12.5 6 12.5s1.25-.56 1.25-1.25S6.69 10 6 10zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 12.5 18 12.5s1.25-.56 1.25-1.25S18.69 10 18 10zM12 20c-.69 0-1.25.56-1.25 1.25S11.31 22.5 12 22.5s1.25-.56 1.25-1.25S12.69 20 12 20zM6 14c-.69 0-1.25.56-1.25 1.25S5.31 15.75 6 15.75s1.25-.56 1.25-1.25S6.69 14 6 14zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 15.75 18 15.75s1.25-.56 1.25-1.25S18.69 14 18 14z"/></svg>');
      /* 这是SVG小鸡的Data URI，白色像素风格 */
      background-size: contain;
      background-repeat: no-repeat;
      cursor: pointer;
      /* 提示可点击 */
      opacity: 0.6;
      /* 稍微透明一点，不那么突兀 */
      transition: opacity 0.2s ease-in-out;
      /* 鼠标悬停效果 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    #noir-author-mark:hover {
      opacity: 1;
      /* 鼠标悬停时完全显示 */
    }

    /* 调整时钟容器，为小鸡留出空间并方便定位 */
    .home-clock-container {
      position: relative;
      /* 确保小鸡能相对它定位 */
      /* ... (保留你已有的其他时钟样式) ... */
      padding-right: 40px;
      /* 给小鸡留出一些右边距 */
    }

    #home-clock-container {
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      text-align: center;
      position: absolute;
      /* top, left, right 都被我删了，哼，现在它完全听JS的指挥 */

      /* 这行可以留着，虽然你已经不让它拖了 */
      z-index: 50;
    }

    #home-time {
      font-size: 80px;
      font-weight: 360;
      /* <--- 我把字重从200加到了300，比原来粗，但又不会笨重，这才是高级感。 */
      letter-spacing: -1px;
      /* <--- 字间距也给你调紧了一点，看起来更整体。 */
    }

    #home-date {
      font-size: 1rem;
      /* <--- 稍微缩小一点，让时间更突出 */
      font-weight: 400;
      margin-top: 8px;
      opacity: 0.8;
      text-transform: uppercase;
      /* <--- 日期我给你换成了全大写，这才有那股‘性冷淡’的味道。 */
      letter-spacing: 1px;
      /* <--- 顺便拉开一点点间距，免得挤在一起。 */
    }

    /* 聊天气泡时间戳的样式 */
    .timestamp {
      font-size: 0.7rem;
      color: var(--text-color-light);
      padding: 0 5px;
      margin-bottom: 3px;
      /* 让它和气泡底部对齐 */
    }

    /* 第一段：这是消息容器的基础样式 */
    .message-container {
      display: flex;
      /* 启用flex布局 */
      flex-direction: column;
      /* 让气泡和时间戳垂直排列 */
      margin-bottom: 10px;
      max-width: 85%;
      /* 限制整个容器的最大宽度 */
    }

    /* 第二段：这是根据发言者进行左右对齐的样式 */
    .message-container.user {
      align-self: flex-end;
      /* 让用户方整个容器靠右 */
      align-items: flex-end;
      /* 让容器内部的元素（气泡、时间戳）也靠右 */
    }

    .message-container.ai {
      align-self: flex-start;
      /* 让AI方整个容器靠左 */
      align-items: flex-start;
      /* 让容器内部的元素（气泡、时间戳）也靠左 */
    }

    .message-bubble-row {
      display: flex;
      align-items: flex-end;
      width: 100%;
    }

    .message-container.user .message-bubble-row {
      justify-content: flex-end;
    }

    .message-container.ai .message-bubble-row {
      justify-content: flex-start;
    }



    /* 这是给表情选择面板里，每一个小表情图片用的样式 */
    .sticker-item {
      width: 100%;
      /* 自动填满网格单元格的宽度 */
      aspect-ratio: 1 / 1;
      /* 保持1:1的宽高比，让它变成正方形 */
      object-fit: cover;
      /* 图片会被裁剪以适应正方形，不变形 */
      border-radius: 8px;
      /* 加个小圆角 */
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .sticker-item:hover {
      transform: scale(1.1);
      /* 鼠标放上去时稍微放大，增加交互感 */
    }

    /* --- Noir's Offline Scene Styles --- */
    #meeting-scene-view {
      flex-grow: 1;
      /* <-- 核心：让它占满所有可用空间 */
      overflow-y: auto;
      /* <-- 核心：内容多了就内部滚动 */
      padding: 20px;
      font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif;
      background-size: cover;
      background-position: center;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }

    #chat-view-pane.offline-mode #offline-scene-view {
      display: block;
      /* 在线下模式时显示 */
    }

    #chat-view-pane.offline-mode #chat-messages {
      display: none;
      /* 在线下模式时隐藏气泡聊天 */
    }

    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      /* 保留换行和空格，这对于小说格式至关重要 */
      font-size: 1rem;
    }

    /* --- Noir's Offline Scene Dialogue Box Style --- */
    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 1rem;

      /* <--- Noir's Addition: 为对话框添加半透明背景和内边距 */
      background-color: rgba(0, 0, 0, 0.4);
      /* 半透明黑色背景 */
      padding: 15px 20px;
      /* 内边距，让文字与边框有距离 */
      border-radius: 8px;
      /* 圆角边框，更柔和 */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      /* 轻轻的阴影，增加立体感 */
    }

    #offline-scene-view .narrator {
      color: #d1d5db;
      /* 旁白用浅灰色 */
      font-style: italic;
    }

    #offline-scene-view .speaker-user {
      color: #a7c7e7;
      /* 用户的发言用一种柔和的蓝色 */
      font-weight: bold;
    }

    #offline-scene-view .speaker-ai {
      color: #f2b7c6;
      /* AI的发言用柔和的粉色，形成对比 */
      font-weight: bold;
    }

    /* --- Noir's Typing Indicator Style --- */
    .typing-indicator {
      padding: 10px 15px;
      color: var(--text-color-light);
      font-style: italic;
      font-size: 0.9rem;
      align-self: flex-start;
      /* 让它和AI气泡一样靠左 */
      margin-left: 50px;
      /* 和AI气泡对齐 */
    }

    #offline-scene-view .typing-indicator {
      color: rgba(255, 255, 255, 0.8);
      /* 在暗色背景下用亮色 */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      /* 同样的文字阴影，保持队形 */
      padding: 10px 0;
      margin-left: 0;
      /* 在小说视图里不需要缩进 */
    }

    /* --- Noir's Final Alignment Fix --- */
    .message-container.ai .timestamp {
      /* 哼，给你加上头像宽度(40px) + 左右边距(10px)的距离 */
      margin-left: 50px;
    }

    .message-container.user .timestamp {
      /* 另一边也是一样，真是麻烦死了 */
      margin-right: 50px;
    }

    /* --- Noir's Music Feed & Player Styles --- */
    #music-feed-container {
      padding-bottom: 70px;
      contain: content;
      /* 为底部播放器留出空间 */
    }

    /* 动态页：默认白底；如设置 --feed-bg-image 则显示独立壁纸 + 轻动画叠层 */
    #music-screen {
      background-color: #fff;
      /* 默认白底 */
      background-image: var(--feed-bg-image);
      /* 单独壁纸，不设就是 none */
      background-size: cover;
      background-position: center;
      contain: paint;
      /* 降低重绘范围，省电 */
    }

    /* 轻动画彩雾叠层：仅图层，不拦点击 */
    #music-screen::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        conic-gradient(from var(--feed-overlay-rotate),
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 0%,
          transparent 20%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 40%,
          transparent 60%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 80%,
          transparent 100%);
      transform: translateZ(0);
      animation: feed-pan var(--feed-overlay-speed) linear infinite;
    }

    /* 超慢速平移旋转，基本不占 GPU */
    @keyframes feed-pan {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }

      50% {
        transform: translate3d(1.2%, 0.8%, 0) rotate(2deg) scale(1.02);
      }

      100% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }
    }

    /* 系统降低动画偏好时，自动停掉动画 */
    @media (prefers-reduced-motion: reduce) {
      #music-screen::before {
        animation: none;
      }
    }


    .music-post {
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), var(--feed-card-alpha));
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: var(--soft-shadow);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .music-post-header {
      display: flex;
      align-items: center;
      padding: 12px 15px;
    }

    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .music-post-header .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .music-post-thought {
      padding: 0 15px 15px;
      font-size: 0.95rem;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .music-post-song-card {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.04);
      padding: 12px 15px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .music-post-song-card:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    .music-post-song-card img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }

    .music-post-song-info {
      flex-grow: 1;
    }

    .music-post-song-info .title {
      font-weight: 500;
      color: var(--text-color);
    }

    .music-post-song-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    .music-post-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    #music-player-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--surface-bg);
      /*backdrop-filter: blur(10px);*/
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 10px;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    #music-player-bar:not(.hidden) {
      transform: translateY(0);
    }

    #music-player-bar.hidden {
      display: none;
      /* 彻底隐藏，避免交互问题 */
    }


    #player-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
    }

    #player-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #player-title,
    #player-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #player-title {
      font-weight: 500;
    }

    #player-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #player-controls button {
      background: none;
      border: 2px solid var(--text-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Share Bubble Styles --- */
    .message.music {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
      max-width: 250px;
      /* 限制一下最大宽度 */
    }

    .music-share-card {
      display: flex;
      align-items: center;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
    }

    .message-container.user .music-share-card {
      background-color: var(--accent-color);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .message-container.user .music-share-card .title,
    .message-container.user .music-share-card .artist,
    .message-container.user .music-share-card .play-icon {
      color: white;
    }


    .music-share-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .music-share-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-share-info .title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #music-screen {
      position: relative;
      /* 就是这句，告诉里面的绝对定位元素，以我为界！ */
    }

    /* --- Noir's Fancy Music Widget Styles --- */
    /* --- Noir's Music System Refactor --- */

    #music-widget:not(.hidden) {
      transform: translateY(0);
      /* 不隐藏时，滑上来 */
    }

    #music-widget.hidden {
      transform: translateY(150%);
      /* 隐藏时，滑下去 */
    }

    .widget-vinyl {
      width: 80px;
      height: 80px;
      background-color: #111;
      border-radius: 50%;
      position: relative;
      left: 20px;
      /* 向右移动，让卡片能盖住它 */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      background-image:
        radial-gradient(circle at center, #555 10%, transparent 11%),
        radial-gradient(circle at center, #fff 12%, transparent 13%);
      animation: spin 8s linear infinite;
      z-index: 1;
    }

    @keyframes spin {
      from {
        transform: translate(-50%, -50%) rotate(0deg);
        /* <-- 看见没，把咒语合并了 */
      }

      to {
        transform: translate(-50%, -50%) rotate(360deg);
        /* <-- 这里也是 */
      }
    }

    .widget-card {
      width: 240px;
      padding: 15px;
      background-color: var(--card-bg);
      /*  backdrop-filter: blur(10px);*/
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      z-index: 2;
      /* 让卡片在唱片上方 */
    }

    .widget-card img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .widget-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #widget-title,
    #widget-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #widget-title {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    #widget-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #widget-play-icon {
      font-size: 1.2rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #card-widget {
      width: 335px;
      height: 170px;
      border-radius: 18px;
      /* 这就是圆角方形的关键 */
      background-color: rgba(255, 255, 255, 0.5);
      /* 加个底色，免得图片透明时不好看 */

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transform: rotate(0deg);
      /* 朝另一个方向歪 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      /* 比爱心高一层 */
      overflow: hidden;
      /* 防止图片溢出圆角 */
    }


    /* --- End of Protocol --- */

    /* --- Noir's "Center Alignment" Protocol --- */

    /* --- End of Protocol --- */

    #card-widget:active {

      transform: rotate(1deg) scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Noir's Ultimate Scrollbar Hider --- */
    /* For Webkit browsers like Chrome, Safari */
    ::-webkit-scrollbar {
      display: none;
    }

    /* For Firefox */
    * {
      scrollbar-width: none;
    }

    /* --- Noir's Fix: 美化消息操作弹窗 --- */
    #message-action-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
    }

    #message-action-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      margin: 0;
      border-radius: 20px 20px 0 0;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #message-action-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #message-action-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- End of Fix --- */
    /* --- Noir's Fix: Fancy User Post Area --- */
    #user-post-input-container {
      display: flex;
      gap: 10px;
    }

    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
    }

    #user-post-main-area {
      flex-grow: 1;
    }

    #user-post-textarea {
      width: 100%;
      border: none;
      background: transparent;
      outline: none;
      resize: vertical;
      font-size: 1rem;
      color: var(--text-color);
    }

    #user-post-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    /* ... 你已有的 #user-post-toolbar 样式 ... */

    /* ▼▼▼ Noir's Command: 哼，给我站成一排！ ▼▼▼ */
    #user-post-actions {
      display: flex;
      /* <-- 这就是圣旨本身 */
      gap: 8px;
      /* <-- 这是我赏赐的间距，让它们别挤在一起 */
    }

    /* ▲▲▲ Command End ▲▲▲ */

    #user-send-post-button {
      padding: 6px 18px;
      border-radius: 16px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    /* 这是附件预览的样式 */
    #user-post-attachment-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-item {
      position: relative;
      max-width: 100px;
    }

    .preview-item img {
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
    }

    .preview-item .music-preview-card {
      display: flex;
      align-items: center;
      padding: 8px;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      width: 200px;
      /* 给音乐卡片宽一点 */
    }

    .preview-item .music-preview-card img {
      width: 30px;
      height: 30px;
      margin-right: 8px;
    }

    .preview-item .music-preview-card .info {
      font-size: 0.8rem;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .remove-attachment-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    /* --- Noir's Fix: Post Image Display Style --- */
    .post-image-container {
      padding: 0 15px 15px;
      /* 图片和文字之间留点空隙 */
    }

    .post-image {
      max-width: 100%;
      /* 图片最宽不能超过帖子宽度 */
      max-height: 400px;
      /* 最高400像素，防止长图刷屏 */
      border-radius: 8px;
      /* 加个小圆角，好看 */
      object-fit: cover;
      /* 保持图片比例，不变形 */
      display: block;
      /* 解决图片底部多余的空隙问题 */
    }

    /* --- Noir's Refactor: New Post Interaction Styles --- */
    .post-interactions {
      padding: 10px 15px;
      background-color: rgba(0, 0, 0, 0.02);
      border-top: 1px solid var(--border-color);
      font-size: 0.9rem;
    }

    .post-likes {
      color: var(--primary-color);
      margin-bottom: 8px;
    }

    .post-comments-container {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .post-comment {
      color: var(--text-color);
    }

    .post-comment .comment-author {
      font-weight: 600;
      color: var(--text-color);
    }

    .post-timestamp {
      font-size: 0.75rem;
      color: var(--text-color-light);
      padding: 0 15px 10px;
    }



    /* 覆盖：基础气泡体 */
    /* 覆盖：基础气泡体 */
    .message {
      border-radius: var(--bubble-radius);
      line-height: 1.55;
      padding: 10px 14px;
      box-shadow:
        0 1px 0 rgba(0, 0, 0, .03),
        0 4px 10px rgba(0, 0, 0, .06);
      /* 比你原先更浅，省功耗 */
      border: 1px solid var(--bubble-outline);
      backdrop-filter: none !important;
      /* 绝不启用重滤镜 */
      will-change: auto;
      /* 不抢 GPU 配额 */

      /* --- Noir's Fix: 就是下面这两行，哼 --- */
      user-select: none;
      /* 标准浏览器给我听话，不许选中 */
      -webkit-user-select: none;
      /* 那些老古董浏览器也一样 */
    }

    /* 你的气泡（右侧） */
    .message.user {
      color: #fff;
      background: var(--bubble-user-bg);
      border-bottom-right-radius: 6px;
      /* 微“角”保留你原味 */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .12);
      /* 细腻但很轻 */
    }

    /* TA 的气泡（左侧） */
    .message.ai {
      color: var(--text-color);
      background: var(--bubble-ai-bg);
      border-bottom-left-radius: 6px;
    }

    /* 细节：图片/贴纸消息不套背景 */
    /* 细节：图片/贴纸/音乐卡片消息不套背景 */
    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image,
    .message.user.music,
    /* <-- 哼，加上这两行 */
    .message.ai.music {
      background: transparent;
      border: 0;
      box-shadow: none;
      padding: 0;
    }

    /* 轻触态：不使用阴影动画，避免合成层抖动 */
    .message:active {
      transform: scale(.996);
    }

    /* 引用块在气泡内的融合感 */
    .quoted-message-in-bubble {
      background: rgba(0, 0, 0, .045);
      border: 1px solid color-mix(in hsl, var(--primary-color) 18%, transparent);
      border-radius: 10px;
    }


    /* --- Noir's Transfer Bubble Style --- */
    .message.transfer {
      background: #F79232;
      /* 哼，一个温暖又醒目的橙色 */
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      width: 220px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    /* 我还给左右两边做了区分，真是为你操碎了心 */
    .message-container.ai .message.transfer {
      background: #f9fafb;
      /* AI发来的转账用白色，更清爽 */
      color: #333;
      border: 1px solid #e5e7eb;
    }

    .transfer-content {
      display: flex;
      flex-direction: column;
    }

    .transfer-title {
      font-weight: 600;
      font-size: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.5);
      padding-bottom: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .message-container.ai .transfer-title {
      border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    .transfer-amount {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .transfer-recipient {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    /* --- End of Refactor --- */



    /* --- Noir's Snap Guide Styles --- */
    .snap-guide {
      position: absolute;
      background-color: rgba(255, 105, 180, 0.85);
      /* 哼，一个足够醒目的颜色 */
      display: none;
      z-index: 999;
      box-shadow: 0 0 5px rgba(255, 105, 180, 0.7);
    }

    #snap-guide-v {
      width: 1px;
    }

    #snap-guide-h {
      height: 1px;
    }

    /* --- Noir's Galgame UI Beautification --- */
    /* Top-left Date & Time Widget */
    #galgame-overlay-ui {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 12px;
      padding: 8px 15px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    #galgame-time {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
    }

    #galgame-date {
      font-size: 0.75rem;
      opacity: 0.8;
      text-align: center;
    }

    /* Main Text Box */
    /* Main Text Box */
    #galgame-textbox-container {
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.85) 0%, rgba(45, 50, 68, 0.7) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border-top: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
      bottom: 85px;
      /* <-- 就是这里，往上抬了，满意了吗？ */
      left: 15px;
      right: 15px;
      padding: 12px 18px;
    }

    /* Speaker Name Tag */
    #galgame-speaker {
      background: linear-gradient(90deg, var(--primary-color) 0%, hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) - 10%)) 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      display: inline-block;
      font-size: 0.95rem;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      margin-bottom: 12px;
    }

    /* Dialogue Text */
    #galgame-text {
      font-size: 1rem;
      line-height: 1.7;
      color: #f0f2f5;
    }

    /* User Input Area Container*/
    #meeting-view-screen .chat-input-area {
      background: transparent;
      border-top: none;
      padding: 0 15px 20px 15px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 20;
    }

    /* User Input Wrapper */
    #chat-input-wrapper-meeting {
      display: flex;
      align-items: center;
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.9) 0%, rgba(45, 50, 68, 0.75) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      padding: 5px 8px 5px 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
    }

    #meeting-message-input {
      color: #f0f2f5;
    }

    #meeting-message-input::placeholder {
      color: rgba(240, 242, 245, 0.5);
      font-style: italic;
    }

    /* Send Button */
    #meeting-send-button {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: 300;
      color: #fff;
      transition: all .2s ease;
      margin-left: 8px;
      background: var(--primary-color);
      box-shadow: 0 2px 5px hsla(var(--primary-hue), 50%, 50%, 0.4);
    }

    #meeting-send-button:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }


    /* --- End of Beautification --- */
    /* --- Noir's Diary Beautification --- */
    #diary-entries-container {
      background-color: #fdfaf2;
      /* A warm, paper-like off-white */
      padding: 25px 20px;
      line-height: 1.9;
      border: 1px solid #e0dccc;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.08);
      /* Inner shadow for page depth */
    }

    /* This is the container for a single entry (date, author, content) */
    .diary-entry {
      margin-bottom: 2.5em;
      /* Increase spacing between entries */
      position: relative;
      padding-bottom: 1.5em;
      /* Space for the separator line */
      border-bottom: 1px dashed #dcd5c7;
      /* A subtle dashed line between entries */
    }

    /* Style the author's name */
    .diary-author {
      font-weight: normal;
      /* Make it less bold, more like a signature */
      font-size: 1rem;
      font-family: 'Segoe Script', 'Bradley Hand', cursive;
      /* A more handwritten font */
    }

    /* Style the date */
    .diary-timestamp {
      font-size: 0.75rem;
      color: #a99e8c;
      /* A faded brown color */
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
      /* Typewriter-like font for date */
    }

    /* Style the actual diary text content */
    .diary-content {
      white-space: pre-wrap;
      font-size: 0.95rem;
      color: #4a443b;
      /* A dark brown/black ink color */
      font-family: 'KaiTi', 'STSong', serif;
    }

    /* Specific styles for the USER's entries */
    .diary-entry.user {
      text-align: right;
    }

    .diary-entry.user .diary-author {
      color: #005a9c;
      /* A nice fountain pen blue */
    }

    .diary-entry.user .diary-content {
      color: #1a5c8e;
    }

    /* Specific styles for the AI's entries */
    .diary-entry.ai {
      text-align: left;
    }

    .diary-entry.ai .diary-author {
      color: #5a3e36;
      /* A darker, warmer brown for the AI */
    }

    .diary-entry.ai .diary-content {
      color: #4a443b;
    }

    /* Let's get rid of the last separator line for a cleaner look */
    .diary-entry:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    /* --- End of Diary Beautification --- */
    /* --- Noir's Page-Turning Magic --- */
    #diary-entries-container {
      perspective: 1500px;
      /* 为3D效果设置视距 */
      position: relative;
      overflow: hidden;
    }

    .diary-page {
      position: absolute;
      inset: 0;
      padding: 25px 20px;
      background-color: #fdfaf2;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      transition: transform 0.7s cubic-bezier(0.65, 0, 0.35, 1);
      display: none;
      /* 默认所有页面都藏起来 */
      flex-direction: column;
      gap: 2.5em;
      /* 页内日记的间距 */
      overflow-y: auto;
      /* 如果一页内容太多，允许滚动 */
    }

    .diary-page.is-visible {
      display: flex;
      /* 只有当前页显示 */
      transform: rotateY(0deg);
      z-index: 2;
    }

    /* 翻到下一页时，当前页向左翻出 */
    .diary-page.is-exiting-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 1;
    }

    /* 翻到下一页时，新页面从右边翻入 */
    .diary-page.is-entering-from-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 2;
    }

    /* 翻到上一页时，当前页向右翻出 */
    .diary-page.is-exiting-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 1;
    }

    /* 翻到上一页时，新页面从左边翻入 */
    .diary-page.is-entering-from-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 2;
    }


    #diary-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 10px;
      box-sizing: border-box;
    }

    #diary-navigation button {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--primary-color);
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    #diary-navigation button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #diary-page-indicator {
      font-size: 0.9rem;
      color: var(--text-color-light);
      font-family: 'Courier New', monospace;
    }

    /* --- End of Magic --- */
    /* --- Noir's Universal Anti-Squash Protocol --- */
    /* 哼，就是下面这几条，给你那些被压扁的头像整整容 */

    /* 动态发布区的用户头像 */
    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      object-fit: cover;
      /* <-- 加上这句，它就不敢扁了 */
    }

    /* 好友圈动态里的角色头像 */
    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
      /* <-- 还有这句，一个都别想跑 */
    }

    /* 顺便把所有叫 .char-avatar 的都统一一下，免得以后还有问题 */
    .char-avatar {
      object-fit: cover;
    }

    /* --- Noir's Music Library Styles --- */
    #music-library-container {
      padding: 10px;
    }

    .music-library-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .music-library-item:hover {
      transform: translateY(-2px);
    }

    .music-library-item-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 15px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .music-library-item-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-library-item-title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-library-item-artist {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    /* --- End of Styles --- */
    /* --- Noir's Global Player Styles --- */

    /* --- End of Player Styles --- */
    /* --- Noir's Upload Altar Styles --- */
    .upload-slot {
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease;
      background-color: rgba(255, 255, 255, 0.5);
    }

    .upload-slot:hover {
      background-color: var(--card-bg);
      border-color: var(--primary-color);
    }

    .upload-slot.filled {
      border-color: var(--primary-color);
      border-style: solid;
      background-color: hsla(var(--primary-hue), 50%, 95%, 0.8);
    }

    .upload-slot .slot-icon {
      font-size: 2rem;
    }

    .upload-slot .slot-label {
      display: block;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .upload-slot .slot-filename {
      display: block;
      font-size: 0.85rem;
      color: var(--text-color-light);
      margin-top: 3px;
      word-break: break-all;
    }

    #confirm-altar-upload-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* --- End of Altar Styles --- */
    /* --- Noir's Listen Together Invite Card Style --- */
    .listen-together-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--soft-shadow);
      border: 1px solid var(--border-color);
      width: 250px;
    }

    .message-container.user .listen-together-card {
      background: var(--bubble-user-bg);
      color: white;
    }

    .message-container.user .listen-together-card .listen-together-decline-btn {
      color: white;
      /* 哼，让用户侧的拒绝按钮文字也变白 */
    }

    .listen-together-header {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--bubble-outline);
      padding-bottom: 8px;
    }

    .listen-together-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .listen-together-song img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .listen-together-info .title {
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-info .artist {
      font-size: 0.9em;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .listen-together-actions button {
      flex-grow: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease;
    }

    .listen-together-actions button:active {
      transform: scale(0.97);
    }

    .listen-together-accept-btn {
      background: var(--primary-color);
      color: white;
    }

    .listen-together-decline-btn {
      background: rgba(0, 0, 0, 0.1);
    }

    /* 用这个替换你旧的 #listen-together-ui */
    #listen-together-ui {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: flex;
      align-items: center;
      /* 改成居中对齐 */
      justify-content: center;
      padding: 20px;
      /* 增加内边距，让弹窗不会贴边 */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #listen-together-ui.show {
      opacity: 1;
      visibility: visible;
    }

    .lt-ui-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px) saturate(1.8);
      -webkit-backdrop-filter: blur(15px) saturate(1.8);
    }

    /* 用这个替换你旧的 .lt-ui-main */
    .lt-ui-main {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 380px;
      /* 哼，给它一个最大宽度 */
      max-height: 650px;
      /* 再给一个最大高度 */
      display: flex;
      flex-direction: column;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      border-radius: 24px;
      /* 加上优雅的圆角 */
      overflow: hidden;
      /* 把溢出的部分裁掉 */
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      /* 更强的立体阴影 */
      border: 1px solid rgba(255, 255, 255, 0.2);
      /* 淡淡的边框光效 */
    }

    .lt-ui-header {
      flex-shrink: 0;
      padding: 15px 20px;
      text-align: center;
      position: relative;
    }

    #lt-ui-header-title {
      font-weight: 600;
    }

    #lt-ui-close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 30px;
    }

    .lt-ui-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow: hidden;
    }

    .lt-ui-cover-container {
      flex-shrink: 0;
      width: 65%;
      aspect-ratio: 1/1;
      margin-top: 5%;
      margin-bottom: 20px;
    }

    #lt-ui-cover-art {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .lt-ui-info {
      text-align: center;
      margin-bottom: 20px;
      flex-shrink: 0;
    }

    #lt-ui-song-title {
      font-size: 1.5rem;
      margin: 0;
    }

    #lt-ui-song-artist {
      font-size: 1rem;
      opacity: 0.8;
      margin: 5px 0 0;
    }

    #lt-ui-lyrics-container {
      flex-grow: 1;
      width: 100%;
      overflow-y: auto;
      text-align: center;
      font-size: 1.1rem;
      line-height: 2.5;
      mask-image: linear-gradient(transparent 0%, black 20%, black 80%, transparent 100%);
      /* 歌词上下渐隐，看起来更专业 */
      scroll-behavior: smooth;
      /* 滚动要丝滑 */
    }

    #lt-ui-lyrics-container p {
      transition: color 0.3s ease, transform 0.3s ease;
      opacity: 0.6;
    }

    #lt-ui-lyrics-container p.active {
      color: var(--primary-color);
      font-weight: 600;
      transform: scale(1.1);
      opacity: 1;
    }

    /* --- Noir's "Desktop Preview" Frame --- */
    /* 哼，只有在电脑这种大屏幕上，我才给你加上这个“手机框”，免得你分不清主次。 */
    /* 在真正的手机上，它还是会全屏显示的，我可没你那么笨。 */
    @media (min-width: 480px) {
      body {
        background-color: #e9ebee;
        /* 一个不那么刺眼的背景色 */
        padding: 20px 0;
        /* 上下留点呼吸空间 */
      }

      #phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        max-height: 90vh;
        /* 确保在矮屏幕上不会超出 */

        /* 这就是你想要的“边框”，哼 */
        border: 10px solid #1c1c1e;
        border-radius: 44px;
        /* 圆角大一点才像样 */
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        /* 给你加个高级点的阴影 */

        flex-shrink: 0;
        /* 确保它在 flex 布局里不会被压扁 */
      }
    }



    /* --- Noir's Bespoke Music Player Design (As Requested) --- */
    /* 哼，这才叫定制。*/

    /* 1. 动画先放着，虽然这次不用了 */
    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* 2. 组件卡片本体：一个有阴影的容器 */
    #music-widget-card {
      width: 340px;
      height: 120px;
      border-radius: 6px;
      /* 稍微硬朗一点的圆角 */
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      /* 一个淡淡的底色 */
      display: flex;
      /* 左右布局 */
      padding: 0;
      border: none;
      overflow: visible;
      /* 允许唱片溢出 */
      position: relative;
      /* 为了定位唱片 */
    }

    /* 3. 左侧封面区：用伪元素画出深色背景，不污染HTML */
    #music-widget-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 120px;
      /* 和高度一样，是个正方形 */
      background-color: #4a4a4a;
      border-radius: 6px 0 0 6px;
      /* ▼▼▼ 在这里加上下面两行 ▼▼▼ */
      background-size: cover;
      background-position: center;
    }

    /* 4. 专辑封面本体 (旧唱片改造) */

    #widget-cover-art {
      position: absolute;
      top: 15px;
      left: 15px;
      width: 90px;
      height: 90px;
      z-index: 2;
      /* 确保它在唱片之上 */
      /* ▼▼▼ 下面都是我新增的，给我看好了 ▼▼▼ */
      border-radius: 4px;
      /* 封面本身的小圆角 */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      background-size: cover;
      background-position: center;
      transition: background-image 0.3s ease;
      /* 让封面切换更柔和 */
    }

    /* 5. 封面图片 (旧唱片贴纸改造) */
    #widget-cover-art::before {
      width: 100%;
      height: 100%;
      border-radius: 4px;
      /* 和封面一致 */
      border: none;
      background-image: var(--widget-cover-image, none);
      background-size: cover;
      background-position: center;
    }

    /* 6. 唱片？用另一个伪元素从后面伸出来就行了，简单 */
    #widget-cover-art::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 90px;
      height: 90px;
      border-radius: 50%;
      z-index: -1;
      display: block;
      border: none;

      /* 哼，看好了，这才叫唱片 */
      background-color: #2a2a2a;
      /* 1. 先铺一层唱片的深灰色底 */
      background-image:
        /* 2. 然后在上面画中间的标签和洞，颜色我都给你配好了 */
        radial-gradient(circle at center, #111 4%, transparent 5%),
        radial-gradient(circle at center, #985c5c 5%, #7a4949 25%, transparent 26%),
        /* 3. 再画上一圈圈的光泽纹理，这才像样 */
        repeating-radial-gradient(circle at center,
          rgba(255, 255, 255, 0.04) 0,
          rgba(255, 255, 255, 0.04) 1px,
          transparent 1px,
          transparent 3px);
      transform: translateX(0%) scale(1.05);
      /* 微调了下位置和大小，这样更协调 */
      transition: opacity 0.3s ease;
      /* 加上这个，为了后面让它优雅地消失 */
      /* 4. 位置也给你微调了一下，现在顺眼多了 */
    }

    /* ▼▼▼ 这是全新的代码，给我加上！▼▼▼ */
    #music-widget-card.is-playing #widget-cover-art {
      /* 播放时，方形舞台的背景就是封面了，所以不需要我画的唱片了 */
      background-image: none;
    }

    #music-widget-card.is-playing::before {
      background-image: var(--widget-cover-image, none);
    }

    #music-widget-card.is-playing #widget-cover-art::after {
      /* 播放时，让唱片旋转起来，哼 */
      animation: spin 8s linear infinite;
    }

    /* 默认状态下，方形舞台的背景是透明的，这样才能看到我画的唱片 */
    #music-widget-card:not(.is-playing) #widget-cover-art {
      background-image: none;
    }

    /* 7. 右侧内容区 (旧覆盖层改造) */
    .widget-content-overlay {
      position: static;
      flex-grow: 1;
      /* 占满右侧所有空间 */
      /* 把旧的 background: #ffffff; 删掉！换成下面这两行！*/
      background: var(--card-bg);
      /* 1. 用我们主题里那个早就定义好的半透明背景 */

      /* 纯白背景 */
      border-radius: 0 6px 6px 0;
      padding: 15px;
      display: flex;
      flex-direction: column;
      /* 垂直布局 */
      justify-content: space-between;
      /* <--- 哼，加上这句圣旨 */
      box-sizing: border-box;
      position: relative;
      /* 为了定位假的分享按钮 */
      background: var(--card-bg);
      color: var(--text-color);
      margin-left: 120px;
    }


    /* 8. 歌曲信息 (标题和作者) */
    #music-widget .widget-info {
      color: #333;
      text-shadow: none;

      /* 占据上半部分空间 */
    }

    #music-widget .widget-info #widget-title {
      font-size: 1.1rem;
      font-weight: 500;
      color: #000;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.8rem;
      color: #888;
    }

    /* 9. 假的歌词和进度条，用伪元素画出来 */
    #music-widget .widget-info::after {
      /* 假的歌词 */
      display: block;
      font-size: 0.75rem;
      color: #65c468;
      /* 绿色 */
      margin-top: 8px;
      padding-bottom: 8px;
      background-image:
        linear-gradient(to right, #666 40%, #ddd 40%),
        /* 假的进度条 */
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12"><path fill="%23aaa" d="M0 10h2V2H0v8zm3 2h2V0H3v12zm3-4h2V4H6v4zm3 2h2V2H9v8zm3-3h2V5h-2v4z"/></svg>');
      /* 假的EQ图标 */
      background-repeat: no-repeat, no-repeat;
      background-position: bottom, 90% bottom;
      background-size: 100% 1px, 16px 12px;
      border-bottom: 1px solid #eee;
    }

    /* 10. 真的控制按钮区域 */
    #widget-controls {
      display: flex;
      justify-content: flex-start;
      /* 从左边开始排列 */
      align-items: center;
      gap: 15px;
      padding-top: 10px;
      position: relative;
      /* 为了定位假的删除和喜欢按钮 */
      width: 100%;
    }

    /* 11. 真的播放/暂停/下一首按钮的样式 */
    #widget-controls button {
      font-size: 1.1rem;
      color: #555;
      background: none;
      border: 1px solid #ccc;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      line-height: 28px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      order: 1;
      /* 把真的按钮放在中间 */
    }

    #widget-play-pause-btn {
      width: 32px;
      /* 播放按钮大一点 */
      height: 32px;
      line-height: 32px;
      font-size: 1.2rem;
    }

    /* 12. 哼，看好了，这才是不会出错的矢量图标，免得你那破手机又自作聪明 */
    #widget-controls::before,
    #widget-controls::after {
      content: '';
      /* 删掉那些讨厌的emoji源头 */
      display: block;
      width: 16px;
      /* 给图标一个精确的尺寸 */
      height: 16px;
      background-color: #aaa;
      /* 这就是图标的颜色，哼 */
      position: absolute;

      /* 下面是魔法，反正你也看不懂 */
      -webkit-mask-repeat: no-repeat;
      mask-repeat: no-repeat;
      -webkit-mask-position: center;
      mask-position: center;
      -webkit-mask-size: contain;
      mask-size: contain;
    }

    #widget-controls::before {
      /* 删除图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      right: 29px;
      /* 稍微调整一下位置，让它更协调 */
      top: 60%;
      transform: translateY(-50%);
    }

    #widget-controls::after {
      /* 喜欢图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      right: 1px;
      top: 60%;
      transform: translateY(-50%);
    }

    /* --- Noir's iOS Industrial Button Refactor --- */
    /* 哼，看好了，这才是专业设备该有的开关。*/

    /* --- Noir's Ultimate Dynamic Button System v3.0 --- */
    /* 哼，现在它们都听我的了。*/

    /* 1. 按钮的基础“模具”，所有按钮都用这个 */
    .form-button {
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: filter 0.15s ease, background-color 0.2s ease;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      /* 加个细微的阴影 */
      color: white;
      /* 默认文字都是白色 */
    }

    .form-button:active {
      filter: brightness(0.9);
    }

    .form-button:disabled {
      background-color: #ccc !important;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* 2. 主要操作按钮 (继承主题强调色) */
    .form-button.primary,
    /* 你可以给蓝色的按钮加上 primary 类，或者不管它也行 */
    #save-api-settings-button,
    /* 把几个主要的按钮ID也直接指定了，免得你改漏 */
    #save-user-profile-button,
    #save-char-button,
    #save-world-book-button,
    #save-group-settings-button,
    #save-friend-circle-button {
      background-color: var(--accent-color);
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    }

    /* 3. 次要操作按钮 (用主题里的卡片背景色，这才叫和谐) */
    .form-button.secondary {
      background-color: var(--card-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
    }

    /* 4. 危险操作按钮 (动态的红色，这才叫高级) */
    .form-button.destructive {
      /* 哼，看好了，这个红色的亮度和饱和度，会随着你主题的明暗变化而变化！*/
      background-color: hsl(5, 75%, calc(var(--primary-lightness) / 1.8 + 25%));
    }

    /* 5. 警告操作按钮 (动态的黄色，也一样) */
    .form-button.warning {
      background-color: hsl(40, 90%, calc(var(--primary-lightness) / 2.2 + 25%));
      color: #5d4000;
    }

    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */

    /* 1. Dock栏的样式 */
    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */
    #home-dock {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 85px;
      padding: 0 20px;
      /* 图标左右的留白 */
      box-sizing: border-box;

      /* 背景和滤镜，现在都在这里 */
      background: var(--surface-bg);
      backdrop-filter: blur(5px) saturate(0.8);
      -webkit-backdrop-filter: blur(15px) saturate(0.8);
      border-radius: 28px;
      z-index: 35;

      /* 核心：用Flexbox来自动排列图标 */
      display: flex;
      justify-content: space-around;
      /* 均匀分布 */
      align-items: center;
      /* 垂直居中 */
      padding-top: 9px;
    }

    #home-dock .app-icon {
      position: static;
      /* 取消绝对定位，让它接受Flexbox的管理 */
    }

    /* 2. App图标的“整容手术” */
    .app-icon-img {
      width: 58px;
      /* 图标背景尺寸 */
      height: 58px;
      border-radius: 22.5%;
      /* iOS标志性的“方圆”形 */
      font-size: 28px;
      /* 阴影从图标本身移到背景上，更统一 */
      background-color: var(--surface-bg);
      box-shadow: none;
      /* 删掉旧的阴影 */
      transition: transform 0.2s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
      /* 按下时图标有反馈 */
    }

    /* --- Noir's Minimalist Home Screen Makeover (v2.0 Dynamic Edition) --- */
    /* 哼，现在这些家伙也听从总开关的指挥了。*/

    /* 1. 时钟和日期 */
    #home-clock-container {
      color: var(--text-color);
      text-shadow: none;
    }

    #home-date {
      opacity: 0.7;
    }

    /* 2. App图标的改造 (现在是动态颜色了) */
    .app-icon span {
      color: var(--text-color);
      text-shadow: none;
      font-weight: 500;
    }

    .app-icon-img {
      background-color: var(--card-bg);
      /* <-- 哼，接上了！*/
      color: var(--text-color-light);
      /* <-- 接上了！*/
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* 3. Dock栏的颜色 (也动态了) */




    #widget-controls button,
    #music-widget .widget-info #widget-title,
    #music-widget .widget-info #widget-artist {
      color: var(--text-color);
    }

    /* ... 在第 2262 行附近 ... */
    /* ▼▼▼ 把旧的 #widget-cover-art::after 整个删掉，换成下面这个 ▼▼▼ */

    /* ▲▲▲ 替换到这里结束 ▲▲▲ */

    /* --- Noir's Theme Preset Buttons --- */
    /* 哼，每个按钮都是一件艺术品。 */
    .theme-preset-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 20px;
      /* 胶囊形状 */
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card-bg);
    }

    .theme-preset-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--soft-shadow);
    }

    .preset-color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    /* --- Noir's Memory Archive Styles --- */
    #summary-textarea {
      width: 100%;
      height: 100%;
      border: none;
      outline: none;
      resize: none;
      padding: 15px;
      box-sizing: border-box;
      font-family: 'Courier New', monospace;
      /* 用等宽字体，YAML格式才好看 */
      font-size: 0.85rem;
      line-height: 1.6;
      background-color: #fdfdfd;
      color: var(--text-color);
    }

    /* --- Noir's Desktop Pagination System --- */
    /* 哼，看好了，这才叫设计。*/

    /* 1. 把主内容区变成一个灵活的容器，为翻页器和指示器留好位置 */
    #home-screen-main-content {
      display: flex;
      flex-direction: column;
      /* 垂直排列，页面在上面，指示器在下面 */
    }

    /* 2. 这是翻页的“舞台”，它的大小和主屏幕一样，但会把超出部分藏起来 */
    #app-pages-container {
      flex-grow: 1;
      /* 占满除了指示器以外的所有空间 */
      width: 100%;
      overflow: hidden;
      /* 核心！把第二页先藏起来 */
      position: relative;
      /* 让里面的滑块能相对于它定位 */
    }

    /* 3. 这是真正滑动的“滑块”，它有两页那么宽 */
    #app-pages-slider {
      width: 200%;
      /* 两页的宽度 */
      height: 100%;
      display: flex;
      /* 核心！让两页并排站好 */
      transition: transform 0.35s cubic-bezier(0.25, 0.1, 0.25, 1);
      /* 翻页动画，给你选了个高级点的曲线 */
    }

    /* 4. 每一页的样式 */
    .app-page {
      width: 50%;
      /* 每页占滑块的一半，也就是一个屏幕的宽度 */
      height: 100%;
      flex-shrink: 0;
      /* 防止被挤压 */
      position: relative;
      /* 让你放在里面的绝对定位图标有家可回 */
    }

    /* 5. 页面指示器（小点点）的容器 */
    #home-page-indicator {
      position: absolute;
      bottom: 105px;
      /* 放在Dock栏正上方，给你算好了距离 */
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      /* 点点之间的距离 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    /* 6. 每个小点点的样式 */
    .page-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(2px);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    /* 7. 当前页的小点点，给它变亮变大一点 */
    .page-dot.active {
      background-color: rgba(255, 255, 255, 0.9);
      transform: scale(1.1);
    }

    #card-widget-2 {
      width: 165px;
      /* 尺寸和原来保持一致 */
      height: 165px;
      border-radius: 22px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      overflow: hidden;
    }

    #card-widget-2:active {
      transform: scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget-2 img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .theme-widget {
      width: 65px;
      height: 65px;
      border-radius: 22px;
      /* 跟你的卡片圆角差不多 */
      box-shadow: var(--soft-shadow);
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      background: linear-gradient(45deg,
          hsla(var(--primary-hue), var(--primary-saturation), var(--primary-lightness), 0.7),
          hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.3), calc(var(--primary-lightness) - 15%), 0.8));
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* --- Noir's Galgame Sprite Adjuster Styles --- */

    /* --- Noir's Slider Control Panel Styles --- */
    .sprite-slider-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 5px;
    }

    .sprite-slider-group label {
      color: white;
      font-size: 0.8rem;
      width: 60px;
      /* 让标签对齐，好看点 */
      flex-shrink: 0;
    }

    .sprite-slider-group input[type="range"] {
      flex-grow: 1;
      /* 占满剩余空间 */
      margin: 0;
      padding: 0;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Accounting App Styles --- */
    #daily-expenses-list .expense-item {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background-color: var(--card-bg);
      border-radius: 8px;
      margin-bottom: 8px;
      border: 1px solid var(--border-color);
    }

    .expense-item .description {
      font-weight: 500;
    }

    .expense-item .amount {
      font-weight: 600;
      color: var(--accent-color);
    }

    #character-reviews-container .review-card {
      display: flex;
      gap: 12px;
      background-color: var(--card-bg);
      padding: 12px;
      border-radius: 12px;
      margin-bottom: 10px;
      border: 1px solid var(--border-color);
    }

    .review-card .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .review-card .review-content .char-name {
      font-weight: 600;
      margin-bottom: 4px;
    }

    /* --- End of Styles --- */
    /* --- Noir's Accounting Tabs Style --- */
    .accounting-tabs {
      display: flex;
      background-color: var(--surface-bg);
      border-bottom: 1px solid var(--border-color);
      padding: 5px 15px 0;
      flex-shrink: 0;
    }

    .tab-button {
      flex: 1;
      padding: 10px;
      border: none;
      background: transparent;
      color: var(--text-color-light);
      font-size: 1rem;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tab-button.active {
      color: var(--accent-color);
      border-bottom: 3px solid var(--accent-color);
    }

    /* --- Noir's "WeChat Moments" Style Patch --- */
    /* 哼，这才叫社交。*/
    #music-feed-container {
      padding: 0;
      /* 容器的内边距清零，让动态贴边 */
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.95);
      /* 给整个容器一个统一的背景色 */
    }

    .music-post {
      background-color: transparent;
      /* 去掉卡片背景 */
      box-shadow: none;
      /* 去掉阴影 */
      border-radius: 0;
      /* 去掉圆角 */
      margin-bottom: 0;
      /* 去掉外边距 */
      padding: 15px;
      /* 统一内边距 */
      border-bottom: 1px solid var(--border-color);
      /* 加上底部分隔线 */
    }

    .music-post:last-child {
      border-bottom: none;
      /* 最后一条动态不需要分隔线 */
    }

    /* --- End of Patch --- */
    /* --- Noir's "Expense Eraser" Style --- */
    .delete-expense-btn {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-color-light);
      width: 22px;
      height: 22px;
      border-radius: 50%;
      cursor: pointer;
      font-weight: 600;
      line-height: 20px;
      padding: 0;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .delete-expense-btn:hover {
      background: #e65252;
      border-color: #e65252;
      color: white;
      transform: scale(1.1);
    }

    /* --- End of Eraser Style --- */
  </style>
</head>

<body>
  <input type="file" id="audio-file-input" style="display: none;" accept=".flac,.mp3">
  <input type="file" id="cover-file-input" style="display: none;" accept=".jpg,.png,.jpeg,.webp">
  <input type="file" id="info-file-input" style="display: none;" accept=".txt">
  <input type="file" id="lyrics-file-input" style="display: none;" accept=".lrc">
  <input type="file" id="import-char-input" accept=".json,.noir" style="display: none;">
  <div id="phone-container">

    <div id="user-profile-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-user-list" class="header-button">主屏幕</button>
        <span class="header-title">选择用户</span>
        <button id="add-user-profile-button" class="header-button add" title="添加新用户">+</button>
      </div>
      <div class="content" id="user-profile-list-container">
      </div>
    </div>

    <div id="user-profile-screen" class="screen">
      <div class="header">
        <button id="back-to-user-list-from-edit" class="header-button">返回</button>
        <span id="user-profile-edit-title" class="header-title">编辑用户</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-user-id">
        <div class="settings-group">
          <h2>用户设定</h2>
          <div class="input-group">
            <label for="user-name">你的名字</label>
            <input type="text" id="user-name" placeholder="你的显示名字">
          </div>
          <div class="avatar-upload-group">
            <label>你的头像</label>
            <img id="user-avatar-preview" class="avatar-preview" alt="User Avatar Preview">
            <input type="file" id="user-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="user-persona">你的人设 (可选)</label>
            <textarea id="user-persona" placeholder="向AI介绍你自己。例如：我是一名大学生，喜欢摄影和旅行。"></textarea>
          </div>
        </div>
        <button id="save-user-profile-button" class="form-button">保存资料</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="set-active-user-button" class="form-button"
            style="background-color: #28a745; margin-bottom: 10px;">设为当前用户</button>
          <button id="delete-user-profile-button" class="form-button destructive">删除该用户</button>
        </div>
      </div>
    </div>


    <div id="home-screen" class="screen active">
      <div id="home-screen-main-content"
        style="position: relative; flex-grow: 1; width: 100%; display: flex; flex-direction: column;">

        <div id="app-pages-container">
          <div id="app-pages-slider">

            <div class="app-page" id="app-page-1">
              <div id="home-clock-container">
                <div id="home-time">11:31</div>
                <div id="home-date">8月29日 星期五</div>
                <div id="noir-author-mark"></div>
              </div>

              <div id="music-widget"
                style="  display: inline-block; width: auto; position: absolute; top: 45%; left: 50%; transform: translateX(-50%); z-index: 50;; padding: 0px;bottom: auto;">
                <div id="music-widget-card">
                  <div id="widget-cover-art"></div>

                  <div class="widget-content-overlay">
                    <div class="widget-info">
                      <div id="widget-title">暂无音乐</div>
                      <div id="widget-artist">请在动态或聊天中播放</div>
                    </div>
                    <div id="widget-controls">
                      <button id="widget-prev-btn">⏮</button>
                      <button id="widget-play-pause-btn">▶</button>
                      <button id="widget-next-btn">⏭</button>
                    </div>
                  </div>
                </div>
              </div>

            </div>

            <div class="app-page" id="app-page-2">
              <div id="decorative-badge" style="display: none; position: absolute; top: 250px; left: 50px;">
                <img id="badge-image" src="http://googleusercontent.com/file_content/0" alt="badge">
              </div>

              <div id="card-widget" style="display: none; position: absolute; top: 140px; left: 145px;">
                <img id="card-image" src="" alt="card widget">
              </div>
              <div id="card-widget-2" style="display: none; position: absolute;">
                <img id="card-image-2" src="" alt="card widget 2">
              </div>





              <div class="app-icon" id="app-world-book">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                  </svg></div>
                <span>世界书</span>
              </div>


              <div class="app-icon" id="app-diary">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <path d="M2.5 17a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zM2.5 14a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
                  </svg></div>
                <span>交换日记</span>
              </div>

              <div class="app-icon" id="app-music-library">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                    <path
                      d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                    </path>
                  </svg></div>
                <span>音乐库</span>
              </div>


              <div class="app-icon" id="app-settings">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
                    </path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg></div>
                <span>API设置</span>
              </div>
              <div class="app-icon" id="app-user-profiles">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg></div>
                <span>我</span>
              </div>
              <div class="app-icon" id="app-wallpaper">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12 2.69l.34.34a1.41 1.41 0 0 0 2 0L22 6.34a1.41 1.41 0 0 0 0-2l-7.66-7.66a1.41 1.41 0 0 0-2 0L2.68 14.34a1.41 1.41 0 0 0 0 2L10 24l2-2 2-2 2-2 2-2 2-2">
                    </path>
                    <path d="m7.34 2.66 14 14"></path>
                  </svg></div>
                <span>更换壁紙</span>
              </div>

              <div id="theme-widget-1" class="theme-widget"></div>
              <div class="app-icon" id="app-accounting">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                  </svg></div>
                <span>记账</span>
              </div>

              <div id="home-dock">
                <div class="app-icon app-icon-large" id="app-chat">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg></div>
                  <span>聊天</span>
                </div>
                <div class="app-icon" id="app-music">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M9 18V5l12-2v13"></path>
                      <circle cx="6" cy="18" r="3"></circle>
                      <circle cx="18" cy="16" r="3"></circle>
                    </svg></div>
                  <span>动态</span>
                </div>
                <div class="app-icon" id="app-meeting">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M14 9a2 2 0 0 1-2 2H6l-4 4V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4Z" />
                      <path d="M18 9h2a2 2 0 0 1 2 2v9l-4-4h-2a2 2 0 0 1-2-2V9Z" />
                    </svg></div>
                  <span>见面</span>
                </div>
              </div>
            </div>

          </div>
        </div>

        <div id="home-page-indicator">
          <span class="page-dot active" data-page="0"></span>
          <span class="page-dot" data-page="1"></span>
        </div>

      </div>

    </div>

    <div id="chat-screen" class="screen">
      <div id="chat-screen-container">
        <div id="chat-list-pane">
          <div id="chat-list-header">
            <button id="back-to-home-from-chat" class="header-button">主屏幕</button>
            <span class="header-title">聊天</span>
            <button id="add-chat-button" class="header-button add" title="添加新聊天">+</button>
          </div>
          <div id="chat-list-container">
            <ul id="character-list">
            </ul>
          </div>
        </div>
        <div id="chat-view-pane">
          <div class="header">
            <button class="header-button" id="back-to-chat-list">返回</button>
            <span id="char-name-header" class="header-title">角色</span>
            <button class="header-button" id="character-settings-button" title="角色设置">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                </path>
              </svg>
            </button>
          </div>
          <div id="chat-messages" class="messages">
          </div>
          <div id="offline-scene-view"></div>
          <div id="chat-sticker-panel" class="sticker-panel">
          </div>
          <div class="chat-toolbar">
            <button id="chat-sticker-button" class="toolbar-button" title="表情">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5-2 4-2 4 2 4 2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
            </button>
            <button id="chat-image-button" class="toolbar-button" title="发送图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <button id="chat-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
            <button id="chat-listen-together-button" class="toolbar-button" title="一起听">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path
                  d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                </path>
              </svg>
            </button>
            <button id="chat-transfer-button" class="toolbar-button" title="转账">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </button>
            <button id="chat-reroll-button" class="toolbar-button" title="重新生成">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
            <button id="chat-summarize-button" class="toolbar-button" title="总结聊天记录">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
          </div>
          <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
          <div id="quote-preview-area" class="quote-preview">
            <div class="quote-preview-content">
              <div id="quote-preview-sender"></div>
              <div id="quote-preview-text"></div>
            </div>
            <button id="cancel-quote-button" class="cancel-quote-btn">&times;</button>
          </div>
          <div class="chat-input-area">
            <div id="chat-input-wrapper">
              <input type="text" id="chat-message-input" placeholder="输入消息...">
              <button id="chat-get-reply-button" title="让对方回复">↵</button>
              <button id="chat-send-button" title="发送">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="settings-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-settings" class="header-button">返回</button>
        <span class="header-title">API设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>API 设置</h2>
          <div class="input-group">
            <label for="api-endpoint">API 接口地址（不填/v1）</label>
            <input type="text" id="api-endpoint" placeholder="例如: https://api.openai.com">
          </div>
          <div class="input-group">
            <label for="api-key">API 密钥</label>
            <input type="password" id="api-key" placeholder="请输入你的 API 密钥">
          </div>
          <div class="input-group">
            <label for="api-model">模型</label>
            <div class="model-input-container">
              <input type="text" id="api-model" placeholder="点击 获取 或手动输入" style="flex-grow: 1;">
              <button id="fetch-models-button" style="padding: 0 12px; white-space: nowrap;">获取</button>
              <div id="model-dropdown" class="custom-model-dropdown"></div>
            </div>
          </div>
          <div class="input-group">
            <label for="api-provider">接口格式 (重要！请根据你使用的接口选择，但是我也没做Openai以外的接口……)</label>
            <select id="api-provider"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);">
              <option value="openai">OpenAI 格式 (通用，兼容绝大多数反代)</option>
              <option value="gemini">Google Gemini 格式 (仅限官方或特定反代)</option>
              <option value="anthropic">Anthropic Claude 格式</option>
            </select>
          </div>
        </div>
        <div class="settings-group">
          <h2>上下文设置</h2>
          <div class="input-group">
            <label for="context-lines-per-chat">每个会话读取的消息条数（默认 100）</label>
            <input type="number" id="context-lines-per-chat" min="1" max="1000000" step="1" placeholder="100">
          </div>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>数据管理</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            导出全部数据（角色、聊天记录、设置、桌面布局等）到一个文件，方便在其他设备或浏览器上导入。
          </p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="export-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #007bff;">导出全部数据</button>
            <button id="import-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #28a745;">导入数据</button>
          </div>
          <input type="file" id="import-data-input" accept=".json" style="display: none;">
        </div>
        <button id="save-api-settings-button" class="form-button">保存 API 设置</button>
      </div>
    </div>



    <div id="character-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-edit" class="header-button">返回</button>
        <span id="character-edit-title" class="header-title">编辑角色</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-char-id">
        <div class="settings-group">
          <h2>角色设定</h2>
          <div class="input-group">
            <label for="char-edit-name">名字</label>
            <input type="text" id="char-edit-name" placeholder="角色的名字">
          </div>
          <div class="input-group">
            <label for="char-edit-remark">备注名</label>
            <input type="text" id="char-edit-remark" placeholder="方便自己记忆，例如 '工作助理'">
          </div>
          <div class="avatar-upload-group">
            <label>角色头像</label>
            <img id="char-edit-avatar-preview" class="avatar-preview" alt="Avatar Preview">
            <input type="file" id="char-edit-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-persona">人设 (系统提示词)</label>
            <textarea id="char-edit-persona" placeholder="你是一个乐于助人的助手。"></textarea>
          </div>
          <div class="input-group">
            <label>聊天壁纸</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-wallpaper-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="聊天壁纸预览">
            </div>
            <input type="file" id="char-edit-wallpaper-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-css">专属气泡样式 (CSS)</label>
            <textarea id="char-edit-css" rows="8"
              placeholder="从其他地方复制的、包含 .sent 和 .received 的CSS代码可以直接粘贴在这里..."></textarea>

            <div style="display: flex; gap: 10px; margin-top: 5px;">
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">TA的气泡 (Received):</p>
                <div id="bubble-preview-ai" class="message ai">这是TA的气泡预览效果</div>
              </div>
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">你的气泡 (Sent):</p>
                <div id="bubble-preview-user" class="message user">这是你的气泡预览效果</div>
              </div>
            </div>
          </div>
          <div class="input-group">
            <label>见面场景背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-offline-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="见面背景预览">
            </div>
            <input type="file" id="char-edit-offline-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="settings-group">
            <h2>角色立绘 (Galgame模式)</h2>
            <p style="font-size: 0.8rem; color: var(--text-color-light);">为五种核心情绪上传立绘图，建议使用透明背景的PNG图片。</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px;">

              <div class="avatar-upload-group" style="align-items: center;">
                <label>平常</label>
                <img id="char-edit-sprite-normal-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="平常立绘">
                <input type="file" id="char-edit-sprite-normal-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>喜</label>
                <img id="char-edit-sprite-happy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="喜立绘">
                <input type="file" id="char-edit-sprite-happy-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>怒</label>
                <img id="char-edit-sprite-angry-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="怒立绘">
                <input type="file" id="char-edit-sprite-angry-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>哀</label>
                <img id="char-edit-sprite-sad-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="哀立绘">
                <input type="file" id="char-edit-sprite-sad-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>害羞</label>
                <img id="char-edit-sprite-shy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="害羞立绘">
                <input type="file" id="char-edit-sprite-shy-input" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-bind-user">绑定用户</label>
            <select id="char-edit-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="world-book-checkboxes-container" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="export-char-button" class="form-button secondary" style="margin-top: 20px;">导出角色卡</button>
        <button id="save-char-button" class="form-button">保存角色</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="edit-clear-history-button" class="form-button warning"
            style="margin-bottom: 10px;">清空聊天记录</button>
          <button id="edit-delete-char-button" class="form-button" class="form-button destructive">删除角色</button>
        </div>
      </div>
    </div>

    <div id="group-chat-create-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-group-create" class="header-button">返回</button>
        <span class="header-title">创建群聊</span>
        <button id="create-group-chat-button" class="header-button">创建</button>
      </div>
      <div class="content" style="padding: 20px;">
        <div class="input-group">
          <label for="group-chat-name">群聊名称</label>
          <input type="text" id="group-chat-name" placeholder="给你的群聊起个名字">
        </div>
        <div class="settings-group">
          <h2>选择成员</h2>
          <div id="group-chat-member-list-container"
            style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
            <ul id="group-chat-member-list">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div id="wallpaper-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-wallpaper" class="header-button">返回</button>
        <span class="header-title">更换壁纸</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2>全局主题色</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">拖动滑块来改变整个App的主色调。</p>
          <div class="input-group" style="padding-top: 10px;">
            <label for="theme-hue-slider" style="display: block; margin-bottom: 5px;">色相 (Hue)</label>
            <input type="range" id="theme-hue-slider" min="0" max="360" value="35" style="width: 100%;">
          </div>
          <div class="input-group">
            <label for="theme-lightness-slider" style="display: block; margin-bottom: 5px;">明度 (Lightness)</label>
            <input type="range" id="theme-lightness-slider" min="15" max="95" value="80" style="width: 100%;">
          </div>
        </div>
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2 style="margin-top: 0;">时钟样式</h2>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="clock-color-toggle" style="width: auto; height: 18px; flex-shrink: 0;">
            <label for="clock-color-toggle" style="width: auto; font-size: 0.9rem;">强制使用纯白色时钟 (推荐在深色壁纸下使用)</label>
          </div>
        </div>
        <div class="settings-group">
          <h2>上传新壁纸</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">选择一张图片作为你的手机壁纸。为了效果最好，请使用竖屏图片。</p>
          <input type="file" id="wallpaper-input" accept="image/*" style="display: none;">
          <button id="upload-wallpaper-button" class="form-button">选择图片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>音乐小组件背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的主屏幕音乐小组件设置一张专属背景图。</p>
          <input type="file" id="widget-bg-input" accept="image/*" style="display: none;">
          <button id="upload-widget-bg-button" class="form-button">选择图片</button>
          <button id="reset-widget-bg-button" class="form-button secondary">恢复默认</button>
        </div>
        <div class="settings-group" style="margin-top: 20px;">
          <h2>重置桌面</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">此操作会将所有桌面小组件（时钟、音乐、徽章等）恢复到初始位置，并将壁纸重置为纯白色。</p>
          <button id="reset-desktop-button" class="form-button destructive">重置桌面布局</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义徽章</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面徽章，可以拖动它到任意位置。</p>
          <input type="file" id="badge-input" accept="image/*" style="display: none;">
          <button id="upload-badge-button" class="form-button">选择徽章图片</button>
          <button id="reset-badge-button" class="form-button secondary" style="margin-top: 10px;">移除徽章</button>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面方形卡片小组件。</p>
          <input type="file" id="card-input" accept="image/*" style="display: none;">
          <button id="upload-card-button" class="form-button">选择卡片图片</button>
          <button id="reset-card-button" class="form-button secondary" style="margin-top: 10px;">移除卡片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片 2</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的第二个桌面方形卡片小组件上传图片。</p>
          <input type="file" id="card-input-2" accept="image/*" style="display: none;">
          <button id="upload-card-button-2" class="form-button">选择卡片图片</button>
          <button id="reset-card-button-2" class="form-button secondary" style="margin-top: 10px;">移除卡片
            2</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>动态页背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为“动态”页面设置一张独立的背景图，让它与众不同。</p>
          <input type="file" id="feed-bg-input" accept="image/*" style="display: none;">
          <button id="upload-feed-bg-button" class="form-button">选择图片</button>
        </div>
        <button id="reset-feed-bg-button" class="form-button secondary" style="margin-top: 10px;">移除背景</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>小组件救援</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">如果你的吧唧或卡片不小心飞出屏幕找不到了，点这里让它们回家。</p>
          <button id="reset-widgets-position-button" class="form-button warning">重置小组件位置</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义App图标</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">替换主屏幕上App的默认图标。为了最佳效果，请使用方形、透明背景的图片。</p>
          <div class="settings-group"
            style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
            <h2>自定义表情包</h2>
            <p style="font-size: 0.9rem; color: var(--text-color-light);">
              在这里追加你的专属表情包。每个表情占一行，格式为：<br>
              <b>表情名--图片URL</b><br>
              例如：<br>
              <code>开心--https://example.com/happy.png</code><br>
              <code>难过--https://example.com/sad.gif</code>
            </p>
            <textarea id="custom-stickers-input" rows="8" placeholder="请按指定格式粘贴..."></textarea>
            <button id="save-custom-stickers-button" class="form-button" style="margin-top: 5px;">保存并刷新表情包</button>
          </div>
          <div id="custom-icon-list-container">
          </div>
          <div id="custom-icon-list-container">
          </div>
        </div>
      </div>

    </div>

    <div id="world-book-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-world-book" class="header-button">主屏幕</button>
        <span class="header-title">世界书</span>
        <button id="add-world-book-button" class="header-button add" title="添加新世界书">+</button>
      </div>
      <div class="content" id="world-book-list-container">
      </div>
    </div>

    <div id="world-book-editor-screen" class="screen">
      <div class="header">
        <button id="back-to-world-book-list" class="header-button">返回</button>
        <span id="world-book-editor-title" class="header-title">编辑条目</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-world-book-id">
        <div class="settings-group">
          <h2>设定条目</h2>
          <div class="input-group">
            <label for="world-book-edit-name">条目名称 (Key)</label>
            <input type="text" id="world-book-edit-name" placeholder="例如：我的过去、特殊能力">
          </div>
          <div class="input-group">
            <label for="world-book-edit-content">条目内容 (Value)</label>
            <textarea id="world-book-edit-content" placeholder="输入详细的设定内容..."></textarea>
          </div>
        </div>
        <button id="save-world-book-button" class="form-button">保存条目</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="delete-world-book-button" class="form-button destructive">删除该条目</button>
        </div>
      </div>
    </div>

    <div id="group-settings-screen" class="screen">
      <div class="header">
        <button id="back-to-chat-from-group-settings" class="header-button">返回</button>
        <span class="header-title">群聊设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>群聊信息</h2>
          <div class="input-group">
            <label for="group-settings-name">群聊名称</label>
            <input type="text" id="group-settings-name">
          </div>
          <div class="avatar-upload-group">
            <label>群头像</label>
            <img id="group-avatar-preview" class="avatar-preview" alt="Group Avatar Preview">
            <input type="file" id="group-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label>群聊背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="group-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="群聊背景预览">
            </div>
            <input type="file" id="group-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="group-settings-bind-user">绑定用户</label>
            <select id="group-settings-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="group-world-book-checkboxes" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-group-settings-button" class="form-button">保存设置</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="group-clear-history-button" class="form-button warning"
            style=" margin-bottom: 10px;">清空聊天记录</button>
          <button id="group-delete-button" class="form-button destructive">删除并解散群聊</button>
        </div>
      </div>
    </div>

    <div id="music-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-feed" class="header-button">返回</button>
        <span id="friend-circle-title" class="header-title">好友圈</span>
        <div style="display: flex; gap: 5px;">
          <button id="edit-current-circle-button" class="header-button" style="font-size: 1.2rem;">⚙️</button>
          <button id="clear-feed-button" class="header-button" style="color: #dc3545;">清空</button>
          <button id="refresh-feed-button" class="header-button">刷新</button>

        </div>
      </div>
      <div id="user-post-area"
        style="padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background: var(--surface-bg);">
        <div id="user-post-input-container">
          <img id="user-post-avatar" class="char-avatar">
          <div id="user-post-main-area">
            <textarea id="user-post-textarea" rows="3" placeholder="分享你的新鲜事..."></textarea>
            <div id="user-post-attachment-preview"></div>
          </div>
        </div>
        <div id="user-post-toolbar">
          <div id="user-post-actions" class="user-post-actions">
            <button id="user-post-image-button" class="toolbar-button" title="分享图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <input type="file" id="user-post-image-input" accept="image/*" style="display: none;">
            <button id="user-post-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
          </div>
          <button id="user-send-post-button">发送</button>
        </div>
      </div>
      <div id="music-feed-container" class="content" style="padding: 10px;">
      </div>
      <div id="music-player-bar" class="hidden">
        <img id="player-cover" src="">
        <div id="player-info">
          <div id="player-title"></div>
          <div id="player-artist"></div>
        </div>
        <div id="player-controls">
          <button id="player-prev-btn">⏮</button>
          <button id="player-play-pause-btn">▶</button>
          <button id="player-next-btn">⏭</button>
        </div>
      </div>
      <audio id="audio-player"></audio>
    </div>
    <div id="meeting-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-meeting-list" class="header-button">主屏幕</button>
        <span class="header-title">选择见面对象</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="meeting-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="meeting-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-meeting-list">返回</button>
        <span id="meeting-char-name-header" class="header-title">角色</span>
        <button id="toggle-meeting-view-button" class="header-button">切换视角</button>

      </div>
      <div id="meeting-main-content" class="content" style="position: relative; padding: 0;">
        <div id="galgame-overlay-ui">
          <div id="galgame-time">12:00</div>
          <div id="galgame-date">1月1日 星期一</div>
        </div>
        <div id="galgame-sprite-adjust-ui"
          style="position: absolute; top: 20px; right: 20px; z-index: 11; display: none;">
          <button id="sprite-adjust-button" class="toolbar-button" title="调整立绘位置">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 7h-9" />
              <path d="M14 17H5" />
              <circle cx="17" cy="17" r="3" />
              <circle cx="8" cy="7" r="3" />
            </svg>
          </button>
        </div>

        <div id="galgame-sprite-controls"
          style="display: none; position: absolute; bottom: 15px; left: 15px; right: 15px; z-index: 1001; background: rgba(0,0,0,0.7); backdrop-filter: blur(8px); border-radius: 12px; padding: 15px; box-shadow: 0 -2px 15px rgba(0,0,0,0.3);">
          <div class="sprite-slider-group">
            <label for="sprite-slider-x">左右位置</label>
            <input type="range" id="sprite-slider-x" min="0" max="100" value="50">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-y">上下位置</label>
            <input type="range" id="sprite-slider-y" min="0" max="130" value="100">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-scale">缩放大小</label>
            <input type="range" id="sprite-slider-scale" min="50" max="200" value="100">
          </div>
          <div style="display: flex; gap: 10px; margin-top: 15px;">
            <button id="sprite-confirm-button" class="form-button">确定</button>
            <button id="sprite-cancel-button" class="form-button secondary">取消</button>
            <button id="sprite-reset-button" class="form-button destructive"
              style="padding: 10px 12px; width: auto; font-size: 1.2rem;">⟲</button>
          </div>
        </div>
        <div id="meeting-scene-view" class="content"
          style="font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.7);">
        </div>
        <div id="galgame-view-container"
          style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden;">
          <div id="galgame-sprite-wrapper"
            style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; height: 100%;">
            <div id="galgame-sprite-container"
              style="position: absolute; display: flex; align-items: flex-end; justify-content: center; /* 移除旧的定位样式 */">
              <img id="galgame-sprite" src=""
                style="max-height: 100%; max-width: 100%; object-fit: contain; transition: opacity 0.3s ease;">
              <div id="sprite-resize-handle"
                style="display: none; position: absolute; bottom: -5px; right: -5px; width: 20px; height: 20px; background: white; border: 2px solid var(--primary-color); border-radius: 50%; cursor: se-resize;">
              </div>
            </div>
          </div>
          <div id="galgame-textbox-container"
            style="position: absolute; bottom: 9%; left: 5%; right: 5%; background: rgba(0, 0, 0, 0.7); border-radius: 10px; padding: 15px; color: white; border-top: 1px solid rgba(255,255,255,0.2); cursor: pointer;">
            <div id="galgame-speaker" style="font-weight: bold; margin-bottom: 10px;">说话人</div>
            <div id="galgame-text" style="line-height: 1.6;">对话内容...</div>
          </div>
        </div>
      </div>
      <div class="chat-input-area">
        <div id="chat-input-wrapper-meeting"> <textarea id="meeting-message-input" placeholder="输入你的行动或对话..." rows="1"
            style="resize: none; overflow-y: auto; flex-grow: 1; border: none; background: transparent; padding: 9px 12px; font-size: .95rem; outline: none; color: var(--text-color);"></textarea>
          <button id="meeting-send-button" title="发送">➤</button>
        </div>
      </div>
    </div>

    <div id="friend-circle-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-circle-list" class="header-button">主屏幕</button>
        <span class="header-title">好友圈</span>
        <button id="add-friend-circle-button" class="header-button add" title="新建好友圈">+</button>
      </div>
      <div id="friend-circle-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="friend-circle-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-edit" class="header-button">返回</button>
        <span id="friend-circle-edit-title" class="header-title">编辑好友圈</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-friend-circle-id">
        <div class="settings-group">
          <h2>好友圈设定</h2>
          <div class="input-group">
            <label for="friend-circle-edit-name">圈子名称</label>
            <input type="text" id="friend-circle-edit-name" placeholder="例如：我的日常">
          </div>
          <div class="input-group">
            <label for="friend-circle-edit-bind-user">绑定的“我”</label>
            <select id="friend-circle-edit-bind-user"></select>
          </div>
        </div>
        <div class="settings-group">
          <h2>选择圈内成员</h2>
          <div id="friend-circle-member-selection"
            style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
          </div>
        </div>
        <button id="save-friend-circle-button" class="form-button">保存</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <button id="delete-friend-circle-button" class="form-button destructive">删除该好友圈</button>
        </div>
      </div>
    </div>
    <div id="diary-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-diary-list" class="header-button">主屏幕</button>
        <span class="header-title">交换日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="diary-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-diary-list">返回</button>
        <span id="diary-char-name-header" class="header-title">TA的日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-entries-container" class="content"
        style="padding: 20px; font-family: 'KaiTi', 'STSong', serif; line-height: 1.8;">
      </div>
      <div class="chat-input-area">
        <div id="diary-input-wrapper" style="display: flex; gap: 10px;">
          <input type="text" id="diary-entry-input" placeholder="写下你的日记或批注..." style="flex-grow: 1;">
          <button id="diary-send-button" class="form-button"
            style="width: auto; margin-top: 0; padding: 0 18px;">写好了</button>
          <button id="diary-get-reply-button" class="form-button"
            style="width: auto; margin-top: 0; background-color: #555; padding: 0 18px;">催TA写</button>
        </div>
      </div>
    </div>
    <div id="music-library-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-music-library" class="header-button">主屏幕</button>
        <span class="header-title">音乐库</span>
        <button id="upload-music-button" class="header-button add" title="上传新音乐">+</button>
      </div>
      <div class="content" id="music-library-container">
      </div>
    </div>
    <div id="music-upload-altar-screen" class="screen">
      <div class="header">
        <button id="back-to-library-from-altar" class="header-button">取消</button>
        <span class="header-title">献上音乐</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content" style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">

        <div class="upload-slot" id="altar-slot-audio">
          <span class="slot-icon">🎵</span>
          <span class="slot-label">音频文件 (必需)</span>
          <span class="slot-filename">点击选择 .mp3 或 .flac</span>
        </div>

        <div class="upload-slot" id="altar-slot-cover">
          <span class="slot-icon">🖼️</span>
          <span class="slot-label">封面图片 (可选)</span>
          <span class="slot-filename">点击选择 .jpg 或 .png</span>
        </div>

        <div class="upload-slot" id="altar-slot-info">
          <span class="slot-icon">📄</span>
          <span class="slot-label">歌曲信息 (必需)</span>
          <span class="slot-filename">点击选择 info.txt</span>
        </div>

        <div class="upload-slot" id="altar-slot-lyrics">
          <span class="slot-icon">🎤</span>
          <span class="slot-label">歌词文件 (可选)</span>
          <span class="slot-filename">点击选择 .lrc</span>
        </div>

        <button id="confirm-altar-upload-button" class="form-button" disabled>献上祭品</button>
      </div>

    </div>


    <div id="accounting-screen" class="screen">
      <div class="header" id="accounting-header">
        <button id="back-to-home-from-accounting" class="header-button">主屏幕</button>
        <span id="accounting-title" class="header-title">记一笔</span>
        <div id="header-actions" style="width: 80px; text-align: right;"></div>
      </div>

      <div class="accounting-tabs">
        <button id="tab-record-expense" class="tab-button active">记一笔</button>
        <button id="tab-view-ledger" class="tab-button">看账本</button>
      </div>

      <div id="accounting-content-area" class="content" style="padding: 15px;">
      </div>
    </div>
    <audio id="audio-player"></audio>

    <audio id="unified-audio-player"></audio>



  </div>
  </div>

  <div id="add-choice-modal" class="choice-modal">
    <div id="add-choice-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="choice-create-character" class="choice-modal-button">创建新角色</button>
      <button id="choice-create-group" class="choice-modal-button">创建新群聊</button>
      <button id="choice-import-character" class="choice-modal-button">导入角色卡</button>
      <button id="choice-cancel" class="choice-modal-button cancel">取消</button>
    </div>
  </div>


  <div id="transfer-modal" class="choice-modal">
    <div id="transfer-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">转账</h3>
      <div id="transfer-recipient-group" class="input-group" style="margin: 10px 0; display: none;">
        <label for="transfer-recipient-select">转给</label>
        <select id="transfer-recipient-select"></select>
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="transfer-amount-input">金额</label>
        <input type="number" id="transfer-amount-input" placeholder="输入金额">
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-transfer-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认转账</button>
        <button id="cancel-transfer-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="message-action-modal" class="choice-modal">
    <div id="message-action-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="edit-message-button" class="choice-modal-button">编辑消息</button>
      <button id="quote-message-button" class="choice-modal-button">引用</button>
      <button id="delete-message-button" class="choice-modal-button" style="color: #dc3545;">删除消息</button>
      <button id="cancel-action-button" class="choice-modal-button cancel">取消</button>
    </div>
  </div>

  <div id="edit-message-modal" class="choice-modal">
    <div id="edit-message-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">编辑消息</h3>
      <textarea id="edit-message-textarea" style="width: 100%; min-height: 100px; margin: 10px 0;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 10px;">
        <button id="save-edit-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">保存</button>
        <button id="cancel-edit-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="music-input-modal" class="choice-modal">
    <div id="music-input-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 id="music-input-title" style="margin-top: 0; text-align: center; font-weight: 600;">分享音乐</h3>

      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-song" style="font-size: 0.9rem;">歌名</label>
        <input type="text" id="music-input-song" placeholder="例如：夜曲">
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-artist" style="font-size: 0.9rem;">歌手</label>
        <input type="text" id="music-input-artist" placeholder="例如：周杰伦">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-music-input" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认</button>
        <button id="cancel-music-input" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="modal-root"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;">
    <div id="modal-mask" style="position:absolute;inset:0;background:rgba(0,0,0,.35);"></div>
    <div id="modal-dialog"
      style="position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:80%;max-width:320px;padding:16px;">
      <div id="modal-text" style="font-size:14px;color:#333;line-height:1.5;white-space:pre-wrap;"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px;">
        <button id="modal-cancel"
          style="padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;">取消</button>
        <button id="modal-ok"
          style="padding:8px 12px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">确定</button>
      </div>
    </div>
  </div>

  <div id="listen-together-modal" class="choice-modal">
    <div id="listen-together-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <div style="width: 50px;"></div>
        <span class="header-title">选择一首歌，一起听</span>
        <button id="cancel-listen-together" class="header-button" style="min-width: 50px;">取消</button>
      </div>
      <div id="listen-together-song-list" class="content" style="flex-grow: 1; padding: 10px;">
      </div>
    </div>
  </div>

  <div id="toast"
    style="position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:8px;font-size:12px;display:none;z-index:10000;">
  </div>
  <script>

    const _0x18377a = _0x22cc; (function (_0x1f64c9, _0x4db425) { const _0x3ec11f = _0x22cc, _0x460d85 = _0x1f64c9(); while (!![]) { try { const _0x1b03c2 = parseInt(_0x3ec11f(0x5d2)) / 0x1 * (-parseInt(_0x3ec11f(0x607)) / 0x2) + -parseInt(_0x3ec11f(0x4ff)) / 0x3 * (-parseInt(_0x3ec11f(0x86b)) / 0x4) + parseInt(_0x3ec11f(0x1e5)) / 0x5 + parseInt(_0x3ec11f(0x2c2)) / 0x6 * (parseInt(_0x3ec11f(0x725)) / 0x7) + parseInt(_0x3ec11f(0x726)) / 0x8 * (parseInt(_0x3ec11f(0x660)) / 0x9) + -parseInt(_0x3ec11f(0x562)) / 0xa * (parseInt(_0x3ec11f(0x3ca)) / 0xb) + -parseInt(_0x3ec11f(0x6be)) / 0xc * (parseInt(_0x3ec11f(0x435)) / 0xd); if (_0x1b03c2 === _0x4db425) break; else _0x460d85['push'](_0x460d85['shift']()); } catch (_0x1d52cd) { _0x460d85['push'](_0x460d85['shift']()); } } }(_0x2dfc, 0x5c870)); var _0x4d4ca5, _0x51344a = null; let _0x2e6858 = [], _0x5ec8a3 = ![], _0x5346c3 = { 'x': 0x0, 'y': 0x0 }; function _0x12df28(_0x58e42f) { const _0x66ce92 = _0x22cc; return (_0x4d4ca5?.[_0x66ce92(0x4ee)] || [])[_0x66ce92(0x5a8)](_0x16414c => _0x16414c['id'] === _0x58e42f); } const _0x59c621 = _0x18377a(0x3c5), _0x4abe2b = _0x18377a(0x948), _0x4991a9 = _0x18377a(0x69f), _0x55b495 = [{ 'name': _0x18377a(0x209), 'url': _0x18377a(0x1ce) }, { 'name': '崩溃', 'url': _0x18377a(0x6ac) }, { 'name': '生病', 'url': 'https://sharkpan.xyz/f/zLes5/4lxzjn.jpg' }, { 'name': '工作', 'url': _0x18377a(0x1c2) }, { 'name': _0x18377a(0x239), 'url': _0x18377a(0x499) }, { 'name': _0x18377a(0x4b6), 'url': _0x18377a(0x9a7) }, { 'name': _0x18377a(0x44e), 'url': _0x18377a(0x975) }, { 'name': '期待', 'url': _0x18377a(0x673) }, { 'name': '喜欢', 'url': 'https://sharkpan.xyz/f/55ntj/ul0hkz.jpg' }, { 'name': '被萌到', 'url': _0x18377a(0x285) }, { 'name': _0x18377a(0x3ad), 'url': _0x18377a(0x805) }, { 'name': '委屈', 'url': _0x18377a(0x294) }, { 'name': '加油', 'url': _0x18377a(0x305) }, { 'name': '对的', 'url': _0x18377a(0x5ac) }, { 'name': '不满', 'url': _0x18377a(0x2f1) }, { 'name': '很期待', 'url': _0x18377a(0x2ef) }, { 'name': _0x18377a(0x494), 'url': 'https://sharkpan.xyz/f/X7muW/lc8g9h.gif' }, { 'name': '委屈', 'url': 'https://sharkpan.xyz/f/25ACQ/gpzab6.jpg' }, { 'name': '平静', 'url': _0x18377a(0x2fe) }, { 'name': '咬你', 'url': _0x18377a(0x1c1) }, { 'name': _0x18377a(0x352), 'url': _0x18377a(0x506) }, { 'name': '好困', 'url': 'https://sharkpan.xyz/f/6Dzia/m9smvt.jpg' }, { 'name': '摸鱼', 'url': _0x18377a(0x29a) }, { 'name': _0x18377a(0x39a), 'url': _0x18377a(0x2de) }, { 'name': _0x18377a(0x15f), 'url': 'https://sharkpan.xyz/f/B4DCa/u86hk2.jpg' }, { 'name': _0x18377a(0x4a4), 'url': _0x18377a(0x843) }, { 'name': _0x18377a(0x3d9), 'url': _0x18377a(0x1a1) }, { 'name': '刷我的卡', 'url': 'https://sharkpan.xyz/f/VGnuY/ptzlf5.jpg' }, { 'name': _0x18377a(0x2d3), 'url': _0x18377a(0x7cd) }, { 'name': _0x18377a(0x507), 'url': _0x18377a(0x606) }, { 'name': _0x18377a(0x5fd), 'url': _0x18377a(0x290) }, { 'name': _0x18377a(0x4d7), 'url': _0x18377a(0x6d4) }, { 'name': _0x18377a(0x460), 'url': _0x18377a(0x6cc) }, { 'name': _0x18377a(0x723), 'url': _0x18377a(0x1f3) }, { 'name': _0x18377a(0x8de), 'url': _0x18377a(0x5c7) }, { 'name': _0x18377a(0x3be), 'url': 'https://sharkpan.xyz/f/mjeIW/9vf8ws.jpg' }, { 'name': _0x18377a(0x631), 'url': 'https://sharkpan.xyz/f/B4WSa/u5wopj.jpg' }, { 'name': _0x18377a(0x783), 'url': _0x18377a(0x612) }, { 'name': '无语但是随便吧', 'url': _0x18377a(0x65a) }, { 'name': _0x18377a(0x584), 'url': _0x18377a(0x373) }, { 'name': _0x18377a(0x57f), 'url': _0x18377a(0x6fd) }, { 'name': _0x18377a(0x1e7), 'url': _0x18377a(0x40a) }, { 'name': '一拳打爆', 'url': 'https://sharkpan.xyz/f/ljVCx/b16h2z.jpg' }, { 'name': _0x18377a(0x154), 'url': _0x18377a(0x989) }, { 'name': _0x18377a(0x7e8), 'url': _0x18377a(0x760) }, { 'name': '很好哦', 'url': _0x18377a(0x430) }, { 'name': '甜蜜地和你聊天', 'url': _0x18377a(0x1d5) }, { 'name': '不高兴撒娇', 'url': _0x18377a(0x76a) }, { 'name': _0x18377a(0x82e), 'url': _0x18377a(0x953) }, { 'name': '我不想工作', 'url': 'https://sharkpan.xyz/f/0GKHX/mthvno.jpg' }, { 'name': _0x18377a(0x72d), 'url': _0x18377a(0x78f) }, { 'name': _0x18377a(0x31e), 'url': 'https://sharkpan.xyz/f/v0qcL/dio7j0.jpg' }, { 'name': _0x18377a(0x37a), 'url': _0x18377a(0x829) }, { 'name': '等你', 'url': _0x18377a(0x441) }, { 'name': _0x18377a(0x482), 'url': _0x18377a(0x462) }, { 'name': _0x18377a(0x4ab), 'url': _0x18377a(0x34b) }, { 'name': '喝酒', 'url': 'https://sharkpan.xyz/f/8a7tj/sea1z9.jpg' }, { 'name': _0x18377a(0x7a6), 'url': _0x18377a(0x83e) }, { 'name': '呜呜', 'url': _0x18377a(0x9ad) }, { 'name': _0x18377a(0x6df), 'url': 'https://sharkpan.xyz/f/7aMhj/hyc75m.jpg' }, { 'name': _0x18377a(0x8af), 'url': 'https://sharkpan.xyz/f/AaDTZ/tzwnjl.jpg' }, { 'name': _0x18377a(0x148), 'url': _0x18377a(0x256) }, { 'name': _0x18377a(0x1c9), 'url': _0x18377a(0x437) }, { 'name': _0x18377a(0x469), 'url': _0x18377a(0x334) }], _0x430d98 = { 'beige': { 'name': _0x18377a(0x6e0), 'h': 0x23, 's': 0x19, 'l': 0x50 }, 'mizuiro': { 'name': _0x18377a(0x3e0), 'h': 0xc3, 's': 0x19, 'l': 0x50 }, 'sakura': { 'name': _0x18377a(0x195), 'h': 0x159, 's': 0x19, 'l': 0x50 }, 'noir': { 'name': '暗夜紫晶', 'h': 0x104, 's': 0xf, 'l': 0x1e } }; document[_0x18377a(0x501)](_0x18377a(0x479), () => { const _0xe2e12e = _0x18377a, _0x2f2699 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x1a3)), _0x15f353 = document['getElementById'](_0xe2e12e(0x8dd)), _0x108d8f = document['getElementById']('transfer-modal'), _0x226ab9 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x7b4)), _0x190c9d = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x620)), _0x284fb0 = document['getElementById'](_0xe2e12e(0x14e)), _0x3877e0 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x87c)), _0x2cd9da = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x1c3)), _0x49a31c = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x720)), _0x43da91 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x85e)), _0x225fb1 = document['getElementById'](_0xe2e12e(0x51d)), _0x315f79 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x49e)), _0x42e53f = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x6dd)), _0x1750be = document['getElementById'](_0xe2e12e(0x1af)), _0x594909 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x5c9)), _0x25e688 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x8bd)), _0x2d741e = document['getElementById'](_0xe2e12e(0x429)), _0x4c9ca1 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x3b1)), _0x2e9180 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x9b5)), _0x43df0c = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x173)), _0x1a459f = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x4b2)), _0x57bc12 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x7c3)), _0x177457 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x335)); function _0x28e3f1() { const _0x8b3572 = _0xe2e12e, _0x2953a7 = document['getElementById'](_0x8b3572(0x45b)); if (!_0x2953a7) return; const _0x48109c = localStorage[_0x8b3572(0x745)](_0x8b3572(0x4cc)) || '35'; document[_0x8b3572(0x966)][_0x8b3572(0x645)]['setProperty']('--primary-hue', _0x48109c), _0x2953a7['value'] = _0x48109c, _0x2953a7['addEventListener'](_0x8b3572(0x4f4), () => { const _0x314e36 = _0x8b3572, _0x38d417 = _0x2953a7[_0x314e36(0x135)]; document['documentElement'][_0x314e36(0x645)][_0x314e36(0x6d8)](_0x314e36(0x22f), _0x38d417), localStorage[_0x314e36(0x598)](_0x314e36(0x4cc), _0x38d417), _0x2ba78f(); }); } function _0x34ffaf() { const _0x5353bc = _0xe2e12e, _0x57711c = document[_0x5353bc(0x6c2)](_0x5353bc(0x3dc)); if (!_0x57711c) return; const _0x4b4919 = localStorage[_0x5353bc(0x745)](_0x5353bc(0x2e4)) || '80'; document[_0x5353bc(0x966)][_0x5353bc(0x645)][_0x5353bc(0x6d8)](_0x5353bc(0x954), _0x4b4919 + '%'), _0x57711c[_0x5353bc(0x135)] = _0x4b4919, _0x57711c[_0x5353bc(0x501)]('input', () => { const _0x11eabb = _0x5353bc, _0x55383b = _0x57711c[_0x11eabb(0x135)]; document[_0x11eabb(0x966)]['style'][_0x11eabb(0x6d8)](_0x11eabb(0x954), _0x55383b + '%'), localStorage[_0x11eabb(0x598)](_0x11eabb(0x2e4), _0x55383b), _0x2ba78f(); }); } function _0x2ba78f() { const _0x392f9d = _0xe2e12e; if (_0x392f9d(0x7ac) === _0x392f9d(0x7ac)) { const _0x3646fc = document[_0x392f9d(0x6c2)](_0x392f9d(0x322)); if (!_0x3646fc) return; _0x4d4ca5[_0x392f9d(0x2d6)][_0x392f9d(0x4d0)] ? 'pOYpo' === 'pOYpo' ? (_0x3646fc[_0x392f9d(0x645)]['color'] = _0x392f9d(0x85f), _0x3646fc[_0x392f9d(0x645)][_0x392f9d(0x2ee)] = _0x392f9d(0x6b3)) : (_0xed9a60[_0x392f9d(0x5b7)] = null, _0x9d14df(_0x392f9d(0x63b)), _0x2a0907()) : 'WSZuN' !== _0x392f9d(0x38a) ? (_0x3646fc[_0x392f9d(0x645)][_0x392f9d(0x8f1)] = 'var(--text-color)', _0x3646fc[_0x392f9d(0x645)][_0x392f9d(0x2ee)] = _0x392f9d(0x4aa)) : (_0x152891[_0x392f9d(0x54c)] = _0x343346[_0x392f9d(0x54c)], _0x8c7376[_0x392f9d(0x752)] = _0x6e6b3[_0x392f9d(0x752)]); } else _0x52511b[_0x392f9d(0x2fa)][_0x392f9d(0x79b)](_0xb44d0, 0x1), _0x4694c3(), _0x41c7ed(); } function _0x4c7e6c() { const _0x2b5bc3 = _0xe2e12e; if (_0x2b5bc3(0x2ed) !== _0x2b5bc3(0x8ff)) { const _0xdb2ae = document[_0x2b5bc3(0x6c2)]('clock-color-toggle'); if (!_0xdb2ae) return; _0xdb2ae['checked'] = _0x4d4ca5[_0x2b5bc3(0x2d6)][_0x2b5bc3(0x4d0)] || ![], _0xdb2ae[_0x2b5bc3(0x501)](_0x2b5bc3(0x858), () => { const _0x50df06 = _0x2b5bc3; _0x4d4ca5[_0x50df06(0x2d6)][_0x50df06(0x4d0)] = _0xdb2ae['checked'], _0x42173a(), _0x2ba78f(); }); } else try { const _0x175910 = _0x20e181['getItem'](_0x2b5bc3(0x201) + _0x55173a), _0x5069f0 = _0x221f8f[_0x2b5bc3(0x213)](_0x175910 || '[]'); return _0x1c7edf[_0x2b5bc3(0x189)](_0x5069f0) ? _0x5069f0 : []; } catch { return []; } } _0x177457['addEventListener']('click', _0x1c6f3e), _0x1a459f[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0xd3f9cf = _0xe2e12e; if (_0xd3f9cf(0x3cc) !== _0xd3f9cf(0x545)) _0x2c763d(), _0x57bc12[_0xd3f9cf(0x4bd)](); else { const _0xded63a = _0x45054b[_0xd3f9cf(0x82b)]('p'); _0xded63a[_0xd3f9cf(0x978)] = _0x37bb76, _0xded63a[_0xd3f9cf(0x645)][_0xd3f9cf(0x1ee)] = '0', _0x4114c2[_0xd3f9cf(0x54e)](_0xded63a); } }), _0x57bc12[_0xe2e12e(0x501)](_0xe2e12e(0x858), _0x1b577c); const _0x586bbb = { 'home': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x46e)), 'chat': document['getElementById'](_0xe2e12e(0x250)), 'settings': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x52f)), 'userProfile': document['getElementById'](_0xe2e12e(0x910)), 'characterEdit': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x5e8)), 'groupChatCreate': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x139)), 'wallpaper': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x5b8)), 'worldBook': document['getElementById'](_0xe2e12e(0x1c5)), 'worldBookEditor': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x785)), 'groupSettings': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x24d)), 'music': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x6e6)), 'friendCircleList': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x144)), 'friendCircleEdit': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x65b)), 'meetingList': document['getElementById'](_0xe2e12e(0x8d7)), 'meetingView': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x47c)), 'userProfileList': document[_0xe2e12e(0x6c2)]('user-profile-list-screen'), 'diaryList': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x99d)), 'diaryView': document['getElementById'](_0xe2e12e(0x3fe)), 'musicLibrary': document[_0xe2e12e(0x6c2)]('music-library-screen'), 'musicUploadAltar': document['getElementById'](_0xe2e12e(0x6c6)), 'accounting': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x66f)) }, _0x30deb2 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x511)), _0x101e9a = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x8b1)), _0x3119d3 = document[_0xe2e12e(0x6c2)]('reset-feed-bg-button'), _0x22c2ae = document['getElementById']('app-wallpaper'), _0x147f2a = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x2a6)), _0x323f55 = document['getElementById']('back-to-home-from-wallpaper'), _0x112168 = document['getElementById'](_0xe2e12e(0x8d5)), _0xee0c98 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x1fd)); document[_0xe2e12e(0x6c2)](_0xe2e12e(0x263))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), async () => { const _0x590995 = _0xe2e12e; if (_0x590995(0x938) !== _0x590995(0x938)) { if (_0x524aeb === null) return; const _0x135eab = _0x3189a9[_0x590995(0x28d)][_0x544b51]; if (!_0x135eab) return; const _0x1ebe04 = _0x3eb15d(); let _0x14f026 = '未知'; if (_0x135eab['role'] === _0x590995(0x75d)) _0x14f026 = _0x123492[_0x590995(0x473)][_0x590995(0x8fa)] || '我'; else { const _0x1d3b65 = _0x135eab[_0x590995(0x6bd)] || _0x1ebe04?.[_0x590995(0x836)][0x0], _0x207db5 = _0x3d6920(_0x1d3b65); _0x14f026 = _0x207db5 ? _0x207db5[_0x590995(0x8fa)] : '角色'; } let _0x4dd8b4 = _0x135eab[_0x590995(0x7af)] || ''; if (_0x135eab[_0x590995(0x79f)]) _0x4dd8b4 = '[表情]'; if (_0x135eab[_0x590995(0x776)]) _0x4dd8b4 = '[图片]'; if (_0x4dd8b4[_0x590995(0x2bd)] > 0x32) _0x4dd8b4 = _0x4dd8b4[_0x590995(0x8a1)](0x0, 0x32) + '...'; _0x2e5a85[_0x590995(0x272)] = { 'sender': _0x14f026, 'content': _0x4dd8b4 }, _0x2e6b87(), _0xac9494(), _0x29c1e2['focus'](); } else { const _0x3292da = await _0x385a44(_0x590995(0x341)); if (_0x3292da) { localStorage['removeItem'](_0x590995(0x603)), localStorage[_0x590995(0x5e7)](_0x590995(0x4ba)), localStorage['removeItem'](_0x590995(0x715)), localStorage[_0x590995(0x5e7)]('musicWidgetPosition'); const _0x71ba50 = []; for (let _0x27e176 = 0x0; _0x27e176 < localStorage['length']; _0x27e176++) { if (_0x590995(0x366) === _0x590995(0x406)) _0x375499[_0x590995(0x54e)](_0x52acce), _0x5cc91f[_0x590995(0x54e)](_0x538fe1); else { const _0x42a714 = localStorage[_0x590995(0x8c3)](_0x27e176); _0x42a714 && _0x42a714[_0x590995(0x245)](_0x590995(0x248)) && _0x71ba50[_0x590995(0x956)](_0x42a714); } } _0x71ba50[_0x590995(0x279)](_0x1539e2 => localStorage[_0x590995(0x5e7)](_0x1539e2)), await _0x34f697(_0x590995(0x2af), await _0x1679a8(_0x590995(0x237))), _0x589297(_0x590995(0x93e)), setTimeout(() => location['reload'](), 0x5dc); } } }); const _0x49d572 = document[_0xe2e12e(0x6c2)]('add-choice-modal'), _0x29e5e9 = document['getElementById'](_0xe2e12e(0x162)), _0x96aa23 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x634)), _0x225244 = document['getElementById'](_0xe2e12e(0x375)), _0x46701b = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x42b)), _0x14cee9 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x6a7)), _0x277bc1 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x610)), _0x11afa0 = document['getElementById']('group-chat-name'), _0x15f3f4 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x47a)), _0x49621b = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x221)), _0x359437 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x826)), _0x24d4d6 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x214)), _0x518b06 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x52b)), _0x378394 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x727)), _0x232a1c = document['getElementById'](_0xe2e12e(0x94a)), _0x253721 = document['getElementById']('back-to-char-select-from-edit'), _0x525576 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x5a9)), _0x95073e = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x180)), _0x1b0c20 = document['getElementById'](_0xe2e12e(0x250)), _0x2468f3 = document[_0xe2e12e(0x6c2)]('chat-messages'), _0x2fbbd3 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x532)), _0x3b68fd = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x8ef)), _0x53e0d5 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x6ad)), _0x68a326 = document[_0xe2e12e(0x6c2)]('quote-preview-area'), _0x506ca4 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x7a9)), _0x271666 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x5a1)), _0x57c2b7 = document[_0xe2e12e(0x6c2)]('cancel-quote-button'), _0x92d95 = document['getElementById'](_0xe2e12e(0x2b2)), _0x2cd933 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x2ab)), _0x58f824 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x313)), _0x4c31a9 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x52a)), _0x19fc9a = document[_0xe2e12e(0x6c2)]('chat-image-input'), _0xb3850c = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x3c1)), _0x113f7f = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x949)), _0xe8feed = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x1f5)), _0x15ccd7 = document[_0xe2e12e(0x6c2)]('api-key'), _0x2059a1 = document[_0xe2e12e(0x6c2)]('api-model'), _0x517e3d = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x3c2)), _0x1a4b4c = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x371)), _0x2a6f9b = document[_0xe2e12e(0x6c2)]('model-dropdown'), _0x3179e5 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x75e)), _0x4266b3 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x92b)), _0x5b2cba = document['getElementById'](_0xe2e12e(0x533)), _0xb97413 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x4eb)), _0x33089d = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x15d)), _0x7092e4 = document[_0xe2e12e(0x6c2)]('save-user-profile-button'), _0x345646 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x8b8)), _0x228a25 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x8e1)), _0x25e73b = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x669)), _0xc7a0ff = document['getElementById'](_0xe2e12e(0x819)), _0x1a9c5b = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x365)), _0x3f784a = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x218)), _0x48ba8d = document['getElementById'](_0xe2e12e(0x509)), _0x1a1fd1 = document[_0xe2e12e(0x6c2)]('save-char-button'), _0x34d241 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x1bb)), _0x21e22a = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x51a)); let _0x43c89a = null; const _0x1a11dd = _0xe2e12e(0x774), _0x80254a = '\x0a#\x20核心任务\x0a你是一个高度智能的档案管理员，任务是为我（用户，名为“{userName}”）和角色“{charName}”之间的私聊记录生成一份简洁、结构化的长期记忆摘要。\x0a\x0a#\x20摘要规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。严禁包含任何\x20JSON、Markdown\x20或其他解释性文字。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`memory_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以日期（`YYYY-MM-DD`）作为键。\x0a\x20\x20\x20\x20-\x20每个日期下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**精简**:\x20忽略日常问候、无意义的闲聊和重复内容。\x0a\x20\x20\x20\x20-\x20**聚焦**:\x20专注于关键信息、情感转折点、重要决定、分享的秘密、设定的约定、以及能够体现角色性格和关系变化的核心事件。\x0a\x20\x20\x20\x20-\x20**中立视角**:\x20以客观的第三人称视角进行记录。**请直接使用“{userName}”和“{charName}”这两个具体的名字**\x20来指代双方。\x0a\x0a#\x20输出示例\x0amemory_summary:\x0a\x20\x202025-09-12:\x0a\x20\x20\x20\x20-\x20\x22userName}\x20表达了对最近工作压力的烦恼。\x22\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20分享了自己过去类似的经历来安慰\x20{userName}，并提议周末一起去看电影。\x22\x0a\x20\x20\x20\x20-\x20\x22双方约定周六下午在市中心的电影院见面，并确定观看电影《夏日终曲》。\x22\x0a\x20\x202025-09-13:\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20发来一张猫咪的图片，心情看起来不错。\x22\x0a\x20\x20\x20\x20-\x20\x22{userName}\x20讨论了关于一个新项目的想法，{charName}\x20给出了一些关键建议。\x22\x0a\x0a#\x20输入格式\x0a我将为你提供完整的聊天记录，格式如下：\x0a[YYYY-MM-DD\x20HH:MM]\x20[说话人]:\x20聊天内容\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的聊天记录全文，并生成一份\x20YAML\x20格式的摘要。直接从\x20`memory_summary:`\x20开始输出。\x0a'; _0x4d4ca5 = { 'characters': [], 'worldBooks': [], 'chats': [], 'userProfiles': [], 'activeUserProfileId': null, 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'widgetBgImage': null, 'perChatContextLines': 0x64, 'forceWhiteClock': ![] }, 'activeChatId': null, 'activeMeetingCharId': null, 'isGenerating': ![], 'currentAbortController': null, 'pendingMessageTimers': [], 'conversationHistory': [], 'displayedMessageCount': 0x64, 'activeQuote': null, 'friendCircles': [], 'activeFriendCircleId': null, 'accountingData': [], 'accountingLedger': {}, 'diaries': [], 'activeDiaryCharacterId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'meetingViewMode': _0xe2e12e(0x8ed), 'activeMeetingScriptQueue': [], 'characterLastScripts': {}, 'musicPlaylist': [], 'currentlyPlayingIndex': -0x1, 'isPlaying': ![], 'pendingPostAttachments': { 'image': null, 'music': null } }; function _0x42173a() { const _0x2f5ce3 = _0xe2e12e; if (_0x2f5ce3(0x5b4) !== _0x2f5ce3(0x5b4)) { const _0x44281c = 0x32; if (_0x2e9add < _0x452289 - _0x44281c) _0x8d7d51(_0x29dbcd + 0x1); else _0x585819 > _0x50c2c5 + _0x44281c && _0x402101(_0x289ab5 - 0x1); } else try { const _0x4220d2 = { 'characters': _0x4d4ca5['characters'], 'worldBooks': _0x4d4ca5[_0x2f5ce3(0x7ea)], 'chats': _0x4d4ca5[_0x2f5ce3(0x53f)], 'userProfile': _0x4d4ca5[_0x2f5ce3(0x473)], 'apiSettings': _0x4d4ca5[_0x2f5ce3(0x547)], 'preferences': _0x4d4ca5[_0x2f5ce3(0x2d6)], 'activeChatId': _0x4d4ca5[_0x2f5ce3(0x41f)], 'diaries': _0x4d4ca5['diaries'], 'friendCircles': _0x4d4ca5[_0x2f5ce3(0x54c)], 'activeFriendCircleId': _0x4d4ca5[_0x2f5ce3(0x752)], 'userProfiles': _0x4d4ca5[_0x2f5ce3(0x26d)], 'activeUserProfileId': _0x4d4ca5[_0x2f5ce3(0x4f1)], 'accountingData': _0x4d4ca5['accountingData'], 'accountingLedger': _0x4d4ca5[_0x2f5ce3(0x21d)] }; localStorage[_0x2f5ce3(0x598)](_0x2f5ce3(0x72e), JSON[_0x2f5ce3(0x822)](_0x4220d2)); } catch (_0x15a99d) { console[_0x2f5ce3(0x93a)](_0x2f5ce3(0x55e), _0x15a99d), _0x589297(_0x2f5ce3(0x42e)); } } function _0xf6472f() { const _0x23019c = _0xe2e12e; let _0x1081e1 = null; try { _0x1081e1 = localStorage[_0x23019c(0x745)]('appState'); } catch (_0x1f2ba4) { console[_0x23019c(0x93a)](_0x23019c(0x3a9), _0x1f2ba4), _0x589297('无法读取状态，浏览器可能禁用了存储功能。'); } if (_0x1081e1) try { const _0x49b60d = JSON['parse'](_0x1081e1); if (!_0x49b60d || typeof _0x49b60d !== _0x23019c(0x7a7)) throw new Error(_0x23019c(0x831)); Array[_0x23019c(0x189)](_0x49b60d['characters']) && (_0x4d4ca5[_0x23019c(0x4ee)] = _0x49b60d[_0x23019c(0x4ee)]['map'](_0x365330 => ({ 'offlineBackground': '', ..._0x365330 }))[_0x23019c(0x5fe)](_0xbca034 => _0xbca034 && typeof _0xbca034 === _0x23019c(0x7a7) && _0xbca034['id'])); _0x49b60d[_0x23019c(0x2fa)] && (_0x4d4ca5[_0x23019c(0x2fa)] = _0x49b60d[_0x23019c(0x2fa)]); _0x49b60d[_0x23019c(0x21d)] && (_0x4d4ca5[_0x23019c(0x21d)] = _0x49b60d[_0x23019c(0x21d)]); Array['isArray'](_0x49b60d['worldBooks']) && (_0x4d4ca5[_0x23019c(0x7ea)] = _0x49b60d[_0x23019c(0x7ea)]); Array[_0x23019c(0x189)](_0x49b60d[_0x23019c(0x18c)]) && (_0x23019c(0x408) !== _0x23019c(0x408) ? _0x34b2a3 = _0xfd37ac[_0x23019c(0x26d)][_0x23019c(0x5a8)](_0xa3a02d => _0xa3a02d['id'] === _0x39ccb9[_0x23019c(0x4f1)]) || _0x2fbf99[_0x23019c(0x26d)][0x0] : _0x4d4ca5[_0x23019c(0x18c)] = _0x49b60d[_0x23019c(0x18c)]); if (Array['isArray'](_0x49b60d[_0x23019c(0x54c)])) _0x4d4ca5[_0x23019c(0x54c)] = _0x49b60d['friendCircles'], _0x4d4ca5[_0x23019c(0x752)] = _0x49b60d['activeFriendCircleId']; else { if (Array[_0x23019c(0x189)](_0x49b60d['musicFeed']) && _0x49b60d[_0x23019c(0x4e3)][_0x23019c(0x2bd)] > 0x0) { console[_0x23019c(0x39f)](_0x23019c(0x842)); const _0x3eea24 = { 'id': 'circle_' + Date[_0x23019c(0x661)](), 'name': _0x23019c(0x811), 'boundUserProfileId': _0x49b60d[_0x23019c(0x4f1)], 'memberCharacterIds': _0x49b60d[_0x23019c(0x4ee)][_0x23019c(0x82d)](_0x86be77 => _0x86be77['id']), 'posts': _0x49b60d[_0x23019c(0x4e3)] }; _0x4d4ca5[_0x23019c(0x54c)] = [_0x3eea24], _0x4d4ca5[_0x23019c(0x752)] = _0x3eea24['id']; } } if (Array['isArray'](_0x49b60d[_0x23019c(0x26d)])) { if (_0x23019c(0x698) === _0x23019c(0x698)) _0x4d4ca5['userProfiles'] = _0x49b60d[_0x23019c(0x26d)], _0x4d4ca5[_0x23019c(0x4f1)] = _0x49b60d['activeUserProfileId']; else { const _0x2e3519 = _0x5b4746[_0x23019c(0x6c2)]('daily-expenses-list'), _0x3ccc10 = _0x511c6f[_0x23019c(0x6c2)]('organize-button-container'), _0x1d96be = new _0xbc8e15(), _0xaa389e = _0x32f03b['accountingData'][_0x23019c(0x5fe)](_0x283839 => new _0x8357cd(_0x283839[_0x23019c(0x2c3)])[_0x23019c(0x991)]() === _0x1d96be[_0x23019c(0x991)]()); if (_0xaa389e['length'] === 0x0) { _0x2e3519[_0x23019c(0x978)] = _0x23019c(0x662), _0x3ccc10[_0x23019c(0x978)] = ''; return; } _0x2e3519[_0x23019c(0x978)] = '', _0xaa389e[_0x23019c(0x450)]((_0x5a45fd, _0x16b5ab) => _0x16b5ab[_0x23019c(0x2c3)] - _0x5a45fd[_0x23019c(0x2c3)])[_0x23019c(0x279)](_0x4ee8e7 => { const _0xded159 = _0x23019c, _0x50e730 = _0xf11e00[_0xded159(0x82b)](_0xded159(0x46f)); _0x50e730['className'] = _0xded159(0x8d4), _0x50e730['innerHTML'] = _0xded159(0x5ad) + _0x4ee8e7[_0xded159(0x99f)] + _0xded159(0x838) + _0x4ee8e7[_0xded159(0x621)][_0xded159(0x874)](0x2) + '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22' + _0x4ee8e7['id'] + _0xded159(0x8a8), _0x2e3519['appendChild'](_0x50e730); }), _0x3ccc10 && (_0x3ccc10[_0x23019c(0x978)] = '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', _0x5102e2[_0x23019c(0x6c2)]('organize-bill-button')[_0x23019c(0x501)]('click', _0x458fb6)); } } else { if (_0x49b60d['userProfile']) { if (_0x23019c(0x3d7) !== _0x23019c(0x3d7)) { const _0x4d1921 = _0x550a50[_0x23019c(0x6c2)](_0x545891); _0x4d1921[_0x23019c(0x978)] = '', _0x540233[_0x23019c(0x26d)][_0x23019c(0x279)](_0x5ae603 => { const _0x155918 = _0x23019c, _0x4ed1ea = _0x51afa5[_0x155918(0x82b)](_0x155918(0x21a)); _0x4ed1ea[_0x155918(0x135)] = _0x5ae603['id'], _0x4ed1ea['textContent'] = _0x5ae603['name'], _0x4d1921[_0x155918(0x54e)](_0x4ed1ea); }); } else { console[_0x23019c(0x39f)]('正在迁移旧的用户数据...'); const _0x4eaf0c = { 'id': _0x23019c(0x22b) + Date['now'](), 'name': _0x49b60d['userProfile'][_0x23019c(0x8fa)] || '我', 'avatar': _0x49b60d[_0x23019c(0x473)][_0x23019c(0x86f)] || _0x4abe2b, 'persona': _0x49b60d[_0x23019c(0x473)]['persona'] || '' }; _0x4d4ca5[_0x23019c(0x26d)] = [_0x4eaf0c], _0x4d4ca5[_0x23019c(0x4f1)] = _0x4eaf0c['id']; } } } _0x49b60d['apiSettings'] && typeof _0x49b60d[_0x23019c(0x547)] === _0x23019c(0x7a7) && (_0x4d4ca5['apiSettings'] = { ..._0x4d4ca5['apiSettings'], ..._0x49b60d[_0x23019c(0x547)] }); if (_0x49b60d[_0x23019c(0x2d6)] && typeof _0x49b60d[_0x23019c(0x2d6)] === _0x23019c(0x7a7)) _0x4d4ca5[_0x23019c(0x2d6)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x49b60d[_0x23019c(0x2d6)] }; else { if (_0x23019c(0x909) === 'qxYke') _0x4d4ca5[_0x23019c(0x2d6)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; else { _0x43e111[_0x23019c(0x806)] = '选择聊天'; return; } } if (Array[_0x23019c(0x189)](_0x49b60d[_0x23019c(0x53f)])) _0x4d4ca5['chats'] = _0x49b60d['chats'], _0x4d4ca5[_0x23019c(0x41f)] = _0x49b60d[_0x23019c(0x41f)] || null; else { if (Array[_0x23019c(0x189)](_0x49b60d[_0x23019c(0x4ee)])) { console[_0x23019c(0x39f)](_0x23019c(0x92f)), _0x4d4ca5[_0x23019c(0x53f)] = _0x49b60d[_0x23019c(0x4ee)][_0x23019c(0x82d)](_0x5790c2 => ({ 'id': _0x23019c(0x468) + _0x5790c2['id'], 'type': _0x23019c(0x17c), 'participantIds': [_0x5790c2['id']] })); if (_0x49b60d[_0x23019c(0x4de)]) { if (_0x23019c(0x1b1) !== _0x23019c(0x2e9)) _0x4d4ca5[_0x23019c(0x41f)] = 'chat_' + _0x49b60d[_0x23019c(0x4de)]; else { _0x226712[_0x23019c(0x978)] = _0x23019c(0x31b); return; } } _0x49b60d[_0x23019c(0x4ee)][_0x23019c(0x279)](_0x2d0829 => { const _0x4bacde = _0x23019c, _0x5ac026 = _0x4bacde(0x201) + _0x2d0829['id'], _0x55b56a = _0x4bacde(0x65e) + _0x2d0829['id'], _0x1a85de = localStorage[_0x4bacde(0x745)](_0x5ac026); _0x1a85de && (localStorage[_0x4bacde(0x598)](_0x55b56a, _0x1a85de), localStorage['removeItem'](_0x5ac026)); }); } } } catch (_0x5043c7) { if (_0x23019c(0x980) !== _0x23019c(0x510)) { console[_0x23019c(0x93a)](_0x23019c(0x227), _0x5043c7), _0x4d4ca5[_0x23019c(0x4ee)] = [], _0x4d4ca5[_0x23019c(0x53f)] = [], _0x4d4ca5[_0x23019c(0x41f)] = null; try { if (_0x23019c(0x30c) === _0x23019c(0x30c)) localStorage[_0x23019c(0x5e7)]('appState'); else { _0x469fe6('错误：找不到此好友圈绑定的用户！'); return; } } catch (_0x168a5e) { console[_0x23019c(0x93a)](_0x23019c(0x26f), _0x168a5e); } } else _0x4c4776[_0x23019c(0x645)][_0x23019c(0x23e)] = _0x23019c(0x2a9); } let _0x1a9d85 = ![]; if (_0x4d4ca5[_0x23019c(0x4ee)][_0x23019c(0x2bd)] === 0x0) { if ('zeyfB' === _0x23019c(0x795)) { const _0x2db073 = _0x11f794[_0x23019c(0x82b)](_0x23019c(0x46f)); _0x2db073[_0x23019c(0x255)] = _0x23019c(0x8d2), _0x2db073[_0x23019c(0x978)] = _0x23019c(0x3b4), _0x2db073[_0x23019c(0x5e5)](_0x23019c(0x29f))[_0x23019c(0x254)] = () => _0x26b47b('image'), _0x33339c[_0x23019c(0x54e)](_0x2db073), _0x20eb86(_0x232be9)['then'](_0x263ad7 => { const _0x3e5fc0 = _0x23019c, _0x3ae23f = _0x543126[_0x3e5fc0(0x6c2)]('pending-post-image-preview'); _0x3ae23f && _0x263ad7 && (_0x3ae23f[_0x3e5fc0(0x6c3)] = _0x57c21c[_0x3e5fc0(0x1de)](_0x263ad7)); }); } else _0x1a9d85 = !![], _0x4d4ca5[_0x23019c(0x41f)] = null; } else !_0x4d4ca5['chats']['find'](_0x3aa269 => _0x3aa269['id'] === _0x4d4ca5[_0x23019c(0x41f)]) && (_0x4d4ca5[_0x23019c(0x41f)] = _0x4d4ca5['chats'][0x0]?.['id'] || null); return _0x42173a(), _0x1a9d85; } function _0x521ac4() { const _0x5c2af9 = _0xe2e12e; if (_0x5c2af9(0x6f3) === _0x5c2af9(0x6f3)) { if (!_0x4d4ca5[_0x5c2af9(0x41f)]) return; try { localStorage[_0x5c2af9(0x598)](_0x5c2af9(0x201) + _0x4d4ca5['activeChatId'], JSON[_0x5c2af9(0x822)](_0x4d4ca5[_0x5c2af9(0x28d)])); } catch (_0x49eab6) { console[_0x5c2af9(0x93a)](_0x5c2af9(0x762), _0x49eab6), _0x589297(_0x5c2af9(0x356)); } } else _0x5049de[_0x5c2af9(0x970)]['add'](_0x5c2af9(0x3a7)); } function _0x4b15bf() { const _0x5ba109 = _0xe2e12e; if (!_0x4d4ca5['activeChatId']) { if (_0x5ba109(0x38c) === _0x5ba109(0x2f0)) _0x497e58(), _0x157cef('meetingList', _0x5ba109(0x54a)); else { _0x4d4ca5[_0x5ba109(0x28d)] = [], _0x41e9e0(); return; } } let _0x4c31c4 = null; try { _0x5ba109(0x60e) !== _0x5ba109(0x724) ? _0x4c31c4 = localStorage[_0x5ba109(0x745)](_0x5ba109(0x201) + _0x4d4ca5[_0x5ba109(0x41f)]) : _0x1e218d[_0x5ba109(0x2e2)](_0xcaf34d => { _0xcaf34d ? _0x44c9c1(_0xcaf34d) : _0x129446(new _0x44a25b('Canvas\x20to\x20Blob\x20conversion\x20failed.')); }, _0x3a1e6f, _0x2357d9); } catch (_0x5dfd7d) { console[_0x5ba109(0x93a)](_0x5ba109(0x192) + _0x4d4ca5['activeChatId'], _0x5dfd7d); } let _0xcb8dfe = []; if (_0x4c31c4) try { if (_0x5ba109(0x87b) === 'OwnBA') { const _0x2942b2 = JSON['parse'](_0x4c31c4); Array['isArray'](_0x2942b2) && (_0x5ba109(0x5d5) !== _0x5ba109(0x5d5) ? _0x18daf9[_0x5ba109(0x501)]('click', () => { const _0x34371a = _0x5ba109, _0x2b046d = _0x2d0b62(_0x4d5a7d[_0x34371a(0x42a)][_0x34371a(0x181)], 0xa); _0x182e8d(_0x2b046d); }) : _0xcb8dfe = _0x2942b2[_0x5ba109(0x5fe)](_0x56734b => _0x56734b && typeof _0x56734b === _0x5ba109(0x7a7) && typeof _0x56734b[_0x5ba109(0x3f7)] === _0x5ba109(0x338) && typeof _0x56734b[_0x5ba109(0x7af)] !== _0x5ba109(0x210))); } else { _0x58142e[_0x5ba109(0x978)] = _0x5ba109(0x519); return; } } catch (_0x68bbdb) { console['error']('Failed\x20to\x20parse\x20history\x20for\x20chat\x20' + _0x4d4ca5['activeChatId'] + ',\x20resetting.', _0x68bbdb); try { if (_0x5ba109(0x705) !== _0x5ba109(0x31c)) localStorage[_0x5ba109(0x5e7)]('chatHistory_' + _0x4d4ca5[_0x5ba109(0x41f)]); else { const _0x497122 = _0x382952['floor'](_0x447216 / 0x3c); if (_0x497122 < 0x30) _0x89dfe += _0x5ba109(0x8cd) + _0x497122 + _0x5ba109(0x4b9); else _0x34b41f += _0x5ba109(0x2f6) + _0x46cf76['floor'](_0x497122 / 0x18) + _0x5ba109(0x846); } } catch (_0x34628e) { _0x5ba109(0x1b0) !== 'AIDFz' ? console[_0x5ba109(0x93a)](_0x5ba109(0x270), _0x34628e) : _0x82f84a['characters'] = _0x37e87f['characters'][_0x5ba109(0x82d)](_0x233716 => ({ 'offlineBackground': '', ..._0x233716 }))['filter'](_0x212e9b => _0x212e9b && typeof _0x212e9b === _0x5ba109(0x7a7) && _0x212e9b['id']); } } _0x4d4ca5[_0x5ba109(0x28d)] = _0xcb8dfe, _0x2468f3[_0x5ba109(0x978)] = ''; if (_0x4d4ca5['conversationHistory']) { if (_0x5ba109(0x520) === _0x5ba109(0x520)) _0x4d4ca5[_0x5ba109(0x28d)][_0x5ba109(0x279)]((_0x4e9b07, _0x4a9628) => _0x59e704(_0x4e9b07, _0x4a9628)); else { let _0x5195c6 = _0x36ea9f[_0x5ba109(0x163)](); const _0xd38791 = _0x5195c6[_0x5ba109(0x199)](/(\[[\s\S]*\])/); _0xd38791 && (_0x5195c6 = _0xd38791[0x1]); const _0x11a36b = _0x51f881[_0x5ba109(0x213)](_0x5195c6); if (_0x53a606[_0x5ba109(0x189)](_0x11a36b)) { _0x2f82e1[_0x5ba109(0x295)] = _0x11a36b, _0x558313['characterLastScripts'][_0x1b8a0c['id']] = [..._0x11a36b], _0x39c5a7(); const _0x42e7cd = _0x11a36b[_0x5ba109(0x82d)](_0x1183ee => _0x1183ee['speaker'] === _0x5ba109(0x8d3) ? _0x1183ee[_0x5ba109(0x6aa)] : _0x1183ee[_0x5ba109(0x23c)] + ':\x20' + _0x1183ee[_0x5ba109(0x6aa)])[_0x5ba109(0x5cd)]('\x0a\x0a'); _0xa268ca[_0x5ba109(0x28d)]['push']({ 'role': _0x5ba109(0x832), 'senderId': _0x1131e1['id'], 'timestamp': _0x233c98['now'](), 'isOffline': !![], 'content': _0x42e7cd }); } } } setTimeout(() => { const _0x5e8a69 = _0x5ba109; if ('XzbwH' === _0x5e8a69(0x8aa)) { const _0x4e77ab = _0x1cc7a3[_0xaced86[_0x5e8a69(0x2bd)] - 0x1]; (!_0x5549bb || _0x4e77ab[_0x5e8a69(0x2c3)] > _0x1b7f60[_0x5e8a69(0x2c3)]) && (_0x34b0ea = _0x4e77ab); } else _0x2468f3['scrollTop'] = _0x2468f3[_0x5e8a69(0x2cf)]; }, 0x0); } async function _0x15666d() { const _0x2d6c4e = _0xe2e12e; if (_0x2d6c4e(0x410) !== _0x2d6c4e(0x410)) _0x572425[_0x2d6c4e(0x3cf)](_0x383cf5); else { const _0x3f9798 = document['getElementById'](_0x2d6c4e(0x46e)); try { if (_0x2d6c4e(0x1a0) === 'heGpF') { const _0x1a76ec = _0x4c92c9[_0x2d6c4e(0x6c2)](_0x2d6c4e(0x89c)), _0x22dbf2 = _0x1a76ec[_0x2d6c4e(0x445)](_0x2d6c4e(0x380)), _0x41f2c8 = _0x3c0912[_0x2d6c4e(0x5e5)](_0x2d6c4e(0x6bb)); if (_0x22dbf2[_0x2d6c4e(0x2bd)] === 0x0) _0x41f2c8[_0x2d6c4e(0x806)] = '--\x20点击选择\x20--'; else _0x22dbf2['length'] > 0x2 ? _0x41f2c8[_0x2d6c4e(0x806)] = '已选择\x20' + _0x22dbf2[_0x2d6c4e(0x2bd)] + '\x20项' : _0x41f2c8[_0x2d6c4e(0x806)] = _0x5a2787[_0x2d6c4e(0x872)](_0x22dbf2)[_0x2d6c4e(0x82d)](_0x3a57f1 => _0x3a57f1[_0x2d6c4e(0x95a)]['textContent'][_0x2d6c4e(0x163)]())[_0x2d6c4e(0x5cd)]('、'); } else { let _0x32b5e9 = await _0x299fa0(_0x2d6c4e(0x2af)); if (!_0x32b5e9) { const _0x4b5817 = localStorage['getItem'](_0x2d6c4e(0x3f9)); _0x4b5817 && (console[_0x2d6c4e(0x39f)](_0x2d6c4e(0x893)), _0x32b5e9 = await _0x1679a8(_0x4b5817), await _0x34f697(_0x2d6c4e(0x2af), _0x32b5e9), localStorage[_0x2d6c4e(0x5e7)](_0x2d6c4e(0x3f9))); } if (_0x32b5e9) { if (_0x2d6c4e(0x7e5) === _0x2d6c4e(0x856)) for (const _0x3a45f6 in _0x2806b2) { _0x230ed9['style'][_0x3a45f6] = _0x9b43a7[_0x3a45f6]; } else _0x3f9798[_0x2d6c4e(0x645)][_0x2d6c4e(0x21c)] = _0x2d6c4e(0x12f) + URL[_0x2d6c4e(0x1de)](_0x32b5e9) + ')', _0x3f9798['style']['backgroundSize'] = _0x2d6c4e(0x2b6), _0x3f9798[_0x2d6c4e(0x645)][_0x2d6c4e(0x2e8)] = _0x2d6c4e(0x89e); } else _0x2d6c4e(0x172) === _0x2d6c4e(0x593) ? (_0x403da2[_0x2d6c4e(0x681)] = [], _0xdb18ae(), _0xf98e72(), _0xc7dd29('动态已清空。')) : _0x3f9798[_0x2d6c4e(0x645)][_0x2d6c4e(0x21c)] = ''; } } catch (_0x782066) { _0x2d6c4e(0x964) === _0x2d6c4e(0x667) ? (_0x482d04['classList'][_0x2d6c4e(0x6ae)](_0x2d6c4e(0x3a7)), _0x5ade2a[_0x2d6c4e(0x254)] = null, _0x34fb4d[_0x2d6c4e(0x254)] = null, _0x3c9a4a[_0x2d6c4e(0x254)] = null, _0x3b0a67[_0x2d6c4e(0x653)](_0x2d6c4e(0x6d5), _0x1d6251), _0x427316(_0x26571b)) : (console[_0x2d6c4e(0x93a)](_0x2d6c4e(0x16d), _0x782066), phoneContainer[_0x2d6c4e(0x645)][_0x2d6c4e(0x21c)] = ''); } } } function _0x29f2e0() { const _0x4a4e71 = _0xe2e12e, _0xe01804 = localStorage[_0x4a4e71(0x745)](_0x4a4e71(0x3f2)); _0xe01804 ? document[_0x4a4e71(0x6c2)](_0x4a4e71(0x6e6))['style'][_0x4a4e71(0x6d8)](_0x4a4e71(0x882), _0x4a4e71(0x12f) + _0xe01804 + ')') : _0x4a4e71(0x5da) === 'KpCBF' ? document[_0x4a4e71(0x6c2)](_0x4a4e71(0x6e6))['style'][_0x4a4e71(0x6d8)](_0x4a4e71(0x882), 'none') : _0x346a26[_0x4a4e71(0x4f1)] = _0x2bd6aa['id']; } async function _0x4154ae(_0x1e577f) { const _0x31603e = _0xe2e12e; if (_0x31603e(0x564) !== _0x31603e(0x78c)) try { await _0x34f697(_0x31603e(0x2af), _0x1e577f), await _0x15666d(), _0x589297(_0x31603e(0x222)); } catch (_0x537fec) { console[_0x31603e(0x93a)](_0x31603e(0x581), _0x537fec), _0x589297('保存壁纸失败:\x20' + _0x537fec['message']); } else _0x4e1ad4(_0x2168dd[_0x31603e(0x752)]); } function _0x216338(_0x42c32f) { const _0x184553 = _0xe2e12e; if ('ofrYT' !== _0x184553(0x7ce)) { const _0xc048b9 = { 'quotedMessage': null, 'content': _0x42c32f }, _0x245535 = _0x42c32f[_0x184553(0x199)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x245535 && (_0x184553(0x6ed) === 'RWVPP' ? (_0xc048b9[_0x184553(0x177)] = { 'sender': _0x245535[0x1][_0x184553(0x163)](), 'content': _0x245535[0x2][_0x184553(0x163)]() }, _0xc048b9[_0x184553(0x7af)] = _0x42c32f[_0x184553(0x8a1)](_0x245535[0x0][_0x184553(0x2bd)])[_0x184553(0x163)]()) : _0x59579f[_0x184553(0x145)] = _0x2f5ff8[_0x184553(0x2cf)]), _0xc048b9; } else _0x19c968(_0x184553(0x60d), _0x184553(0x4a7)), _0x86111b(![]); } const _0x57e21a = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x3c8)), _0x297e76 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x3a2)), _0x92e02 = document['getElementById'](_0xe2e12e(0x652)), _0xe84901 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x942)), _0x3b40bc = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x844)), _0x4d9b76 = document['getElementById'](_0xe2e12e(0x815)), _0x45b16f = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x95e)), _0x28345b = document[_0xe2e12e(0x6c2)]('edit-message-backdrop'), _0x2bb048 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x35c)), _0x1d3eba = document['getElementById'](_0xe2e12e(0x4df)), _0x3be9f3 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x733)); let _0x1d41e5 = null; function _0x360195(_0x2837f6) { const _0x22e0d5 = _0xe2e12e; if ('DJgNH' !== _0x22e0d5(0x47d)) _0x1d41e5 = _0x2837f6, _0x57e21a[_0x22e0d5(0x970)][_0x22e0d5(0x68a)](_0x22e0d5(0x3a7)); else { _0x4765e6['innerHTML'] = _0x22e0d5(0x67f); return; } } function _0x45ddb7() { const _0x1e9d31 = _0xe2e12e; _0x57e21a[_0x1e9d31(0x970)]['remove'](_0x1e9d31(0x3a7)); } function _0x26396a() { const _0x3aab87 = _0xe2e12e; _0x3aab87(0x64e) === 'klUZr' ? (_0x160e2e(), _0x166e3f('worldBook', _0x3aab87(0x945))) : (_0x45ddb7(), _0x1d41e5 = null); } function _0x440b25() { const _0xca931b = _0xe2e12e; if ('BIkgd' === _0xca931b(0x9a5)) { if (_0x1d41e5 === null) return; _0x4d4ca5[_0xca931b(0x28d)][_0xca931b(0x79b)](_0x1d41e5, 0x1), _0x521ac4(), _0x1fb306(), _0x26396a(); } else _0xb1589f[_0xca931b(0x645)][_0xca931b(0x21c)] = ''; } function _0x1a71ec() { const _0x2c6ce7 = _0xe2e12e; if (_0x1d41e5 === null) return; const _0x4dd055 = _0x4d4ca5['conversationHistory'][_0x1d41e5]; if (!_0x4dd055) return; _0x2bb048[_0x2c6ce7(0x135)] = _0x4dd055[_0x2c6ce7(0x7af)], _0x45ddb7(), _0x45b16f[_0x2c6ce7(0x970)][_0x2c6ce7(0x68a)](_0x2c6ce7(0x3a7)), _0x2bb048[_0x2c6ce7(0x8df)](); } function _0xc643d5() { const _0x3849ce = _0xe2e12e; if ('wTlTC' !== 'wTlTC') { const _0x188488 = _0x30ff48[0x0][_0x3849ce(0x163)](), _0x48fbc6 = _0x4d0c80[0x1][_0x3849ce(0x163)](), _0xb0571d = { '歌名': _0x3849ce(0x38b), '艺术家': '歌手', '专辑': '专辑' }; _0xb0571d[_0x188488] && (_0x4f5b77[_0xb0571d[_0x188488]] = _0x48fbc6); } else { if (_0x1d41e5 === null) return; const _0xe9aaa6 = _0x2bb048[_0x3849ce(0x135)][_0x3849ce(0x163)](); if (_0xe9aaa6 === '') { if (_0x3849ce(0x464) !== _0x3849ce(0x464)) _0x3cc563(), _0xd5f881(_0x3849ce(0x37f), 'home'); else { _0x44deac(); return; } } const _0x5df28b = _0x4d4ca5[_0x3849ce(0x28d)][_0x1d41e5]; _0x5df28b && (_0x5df28b[_0x3849ce(0x7af)] = _0xe9aaa6, _0x521ac4(), _0x1fb306()), _0x45b16f[_0x3849ce(0x970)]['remove'](_0x3849ce(0x3a7)), _0x1d41e5 = null; } } function _0x44deac() { const _0x448026 = _0xe2e12e; _0x45b16f['classList'][_0x448026(0x6ae)](_0x448026(0x3a7)), _0x1d41e5 = null; } _0x297e76[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x26396a), _0x3b40bc[_0xe2e12e(0x501)]('click', _0x26396a), _0xe84901['addEventListener'](_0xe2e12e(0x4bd), _0x440b25), _0x92e02[_0xe2e12e(0x501)]('click', _0x1a71ec), _0x4d9b76[_0xe2e12e(0x501)]('click', _0x40d118), _0x57c2b7['addEventListener'](_0xe2e12e(0x4bd), _0x26b848), _0x1d3eba['addEventListener'](_0xe2e12e(0x4bd), _0xc643d5), _0x3be9f3[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x44deac), _0x28345b[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x44deac); function _0x40d118() { const _0x56ea46 = _0xe2e12e; if (_0x1d41e5 === null) return; const _0x24528b = _0x4d4ca5[_0x56ea46(0x28d)][_0x1d41e5]; if (!_0x24528b) return; const _0x146ef8 = _0xa2c8b5(); let _0x368ad7 = '未知'; if (_0x24528b['role'] === 'user') { if ('pQcDh' !== _0x56ea46(0x481)) { const _0xd1991d = _0x53b8ac[_0x56ea46(0x71c)](_0x275c22, 0x2); _0xd1991d[_0x56ea46(0x911)] = () => _0x230739(_0x56ea46(0x39b)), _0xd1991d['onsuccess'] = () => _0x160cdc(_0xd1991d[_0x56ea46(0x84e)]), _0xd1991d[_0x56ea46(0x962)] = _0x224f61 => { const _0x4bd830 = _0x56ea46, _0x2f2e1a = _0x224f61['target'][_0x4bd830(0x84e)]; !_0x2f2e1a[_0x4bd830(0x871)]['contains'](_0x4607d4) && _0x2f2e1a['createObjectStore'](_0x296ff8, { 'keyPath': 'id' }), !_0x2f2e1a['objectStoreNames'][_0x4bd830(0x7a5)](_0x4bd830(0x6f6)) && _0x2f2e1a['createObjectStore'](_0x4bd830(0x6f6), { 'keyPath': 'id' }); }; } else _0x368ad7 = _0x4d4ca5[_0x56ea46(0x473)][_0x56ea46(0x8fa)] || '我'; } else { const _0x59f47a = _0x24528b['senderId'] || _0x146ef8?.[_0x56ea46(0x836)][0x0], _0x3e35f8 = _0x53bcef(_0x59f47a); _0x368ad7 = _0x3e35f8 ? _0x3e35f8[_0x56ea46(0x8fa)] : '角色'; } let _0x353179 = _0x24528b[_0x56ea46(0x7af)] || ''; if (_0x24528b[_0x56ea46(0x79f)]) _0x353179 = _0x56ea46(0x1c8); if (_0x24528b[_0x56ea46(0x776)]) _0x353179 = _0x56ea46(0x300); if (_0x353179[_0x56ea46(0x2bd)] > 0x32) _0x353179 = _0x353179[_0x56ea46(0x8a1)](0x0, 0x32) + '...'; _0x4d4ca5[_0x56ea46(0x272)] = { 'sender': _0x368ad7, 'content': _0x353179 }, _0x5ec3ae(), _0x26396a(), _0x2fbbd3[_0x56ea46(0x8df)](); } function _0x5ec3ae() { const _0x156fe = _0xe2e12e; if (!_0x4d4ca5[_0x156fe(0x272)]) return; _0x506ca4[_0x156fe(0x806)] = _0x156fe(0x53b) + _0x4d4ca5[_0x156fe(0x272)][_0x156fe(0x54f)], _0x271666[_0x156fe(0x806)] = _0x4d4ca5[_0x156fe(0x272)][_0x156fe(0x7af)], _0x68a326['style']['display'] = _0x156fe(0x2a9); } function _0x26b848() { const _0x9f127f = _0xe2e12e; if (_0x9f127f(0x1a2) === 'sBLDE') { const _0x4beb1c = _0x183df7(_0xb1ed5d['authorId']); _0x4beb1c && (_0x2c5afa = _0x4beb1c['name'], _0x4fd0a0 = _0x4beb1c[_0x9f127f(0x86f)]); } else _0x4d4ca5[_0x9f127f(0x272)] = null, _0x68a326['style'][_0x9f127f(0x23e)] = _0x9f127f(0x4aa); } function _0x113213(_0x505b23, _0x7dfb0b) { const _0x42c0fa = _0xe2e12e; if (_0x42c0fa(0x611) === 'XxgYD') { const _0x57281c = document[_0x42c0fa(0x6c2)](_0x42c0fa(0x573)); _0x57281c && (_0x505b23 === _0x42c0fa(0x54a) ? _0x57281c[_0x42c0fa(0x645)][_0x42c0fa(0x23e)] = _0x42c0fa(0x809) : _0x57281c['style'][_0x42c0fa(0x23e)] = _0x42c0fa(0x4aa)); _0x43c89a = _0x7dfb0b || null, Object['values'](_0x586bbb)['forEach'](_0x605f79 => _0x605f79[_0x42c0fa(0x970)]['remove'](_0x42c0fa(0x68c))); if (_0x586bbb[_0x505b23]) { if (_0x42c0fa(0x8e7) === 'VOrNj') { const _0x1b814d = _0x3b5a19[_0x42c0fa(0x82b)]('li'); _0x1b814d[_0x42c0fa(0x255)] = _0x42c0fa(0x7b5), _0x1b814d[_0x42c0fa(0x42a)]['charId'] = _0x1e656f['id'], _0x1b814d[_0x42c0fa(0x978)] = _0x42c0fa(0x701) + (_0x2c23d6[_0x42c0fa(0x86f)] || _0x223753) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x54715a['name'] + _0x42c0fa(0x920), _0x1b814d[_0x42c0fa(0x501)](_0x42c0fa(0x4bd), () => { _0x536631(_0x43dfb5['id']); }), _0x1b814d[_0x42c0fa(0x5e5)]('.char-info-wrapper')['addEventListener'](_0x42c0fa(0x4bd), () => { _0x1292be(_0x3ee158['id']); }), _0x1b814d[_0x42c0fa(0x5e5)](_0x42c0fa(0x5bd))[_0x42c0fa(0x501)](_0x42c0fa(0x4bd), _0x26e64a => { const _0x47b87d = _0x42c0fa; _0x26e64a[_0x47b87d(0x6ca)](), _0x3f23b5(_0x42e1f1['id']); }), _0xd26153[_0x42c0fa(0x54e)](_0x1b814d); } else _0x586bbb[_0x505b23]['classList']['add'](_0x42c0fa(0x68c)); } _0x505b23 !== 'chat' && _0x1b0c20[_0x42c0fa(0x970)][_0x42c0fa(0x6ae)](_0x42c0fa(0x52e)); } else { _0x1f0e86(_0x42c0fa(0x818)); return; } } function _0x3493cf(_0x526a91) { const _0x26b0f2 = _0xe2e12e; if (_0x26b0f2(0x3ee) === 'ZbiVJ') { if (_0x526a91) { if (_0x26b0f2(0x2ea) === _0x26b0f2(0x537)) { const _0x472690 = _0x2eee41(); if (!_0x472690) { _0x410743[_0x26b0f2(0x806)] = _0x26b0f2(0x63c); return; } if (_0x472690[_0x26b0f2(0x327)] === _0x26b0f2(0x17c)) { const _0x5aa8dd = _0x5c26a6(_0x472690['participantIds'][0x0]); _0x29d8e8[_0x26b0f2(0x806)] = _0x5aa8dd ? _0x5aa8dd[_0x26b0f2(0x8fa)] : _0x26b0f2(0x385); } else _0x3b07f9['textContent'] = _0x472690[_0x26b0f2(0x8fa)] || _0x26b0f2(0x4e4) + _0x472690['participantIds']['length'] + ')'; } else _0x1b0c20[_0x26b0f2(0x970)]['add'](_0x26b0f2(0x52e)); } else _0x26b0f2(0x2e1) !== 'dcWJo' ? _0x3f6128[_0x26b0f2(0x93a)]('Failed\x20to\x20plan\x20group\x20replies:', _0xfb90df) : _0x1b0c20['classList'][_0x26b0f2(0x6ae)](_0x26b0f2(0x52e)); } else { const _0x4ed280 = _0x18b515(_0x59f273), _0x3dac1b = _0x4ac6d0[_0x26b0f2(0x6c2)](_0x26b0f2(0x558)); _0x3dac1b[_0x26b0f2(0x645)][_0x26b0f2(0x21c)] = ''; let _0x5868bf = _0x3b1df9[_0x26b0f2(0x6c2)](_0x26b0f2(0x27e) + _0x29bf8f); if (_0x5868bf) _0x5868bf[_0x26b0f2(0x978)] = ''; if (!_0x4ed280) return; _0x4ed280[_0x26b0f2(0x3b6)] && (_0x3dac1b[_0x26b0f2(0x645)]['backgroundImage'] = _0x26b0f2(0x41e) + _0x4ed280[_0x26b0f2(0x3b6)] + '\x27)', _0x3dac1b[_0x26b0f2(0x645)][_0x26b0f2(0x19d)] = 'cover', _0x3dac1b[_0x26b0f2(0x645)][_0x26b0f2(0x2e8)] = 'center'); if (_0x4ed280[_0x26b0f2(0x303)]) { let _0xd39ab4 = _0x27099d[_0x26b0f2(0x6c2)]('style-' + _0x4ed280['id']); !_0xd39ab4 && (_0xd39ab4 = _0x1f00c6[_0x26b0f2(0x82b)](_0x26b0f2(0x645)), _0xd39ab4['id'] = _0x26b0f2(0x27e) + _0x4ed280['id'], _0x28046a[_0x26b0f2(0x6b4)][_0x26b0f2(0x54e)](_0xd39ab4)); const _0x2d7527 = _0x4ed280[_0x26b0f2(0x303)], _0x4cb70e = _0x2d7527[_0x26b0f2(0x2ce)](/\.bubble\.sent/g, _0x26b0f2(0x9ac) + _0x4ed280['id'] + '.message.user')[_0x26b0f2(0x2ce)](/\.bubble\.received/g, '.bubble-' + _0x4ed280['id'] + _0x26b0f2(0x480)); _0xd39ab4['innerHTML'] = _0x4cb70e; } } } async function _0x505812() { const _0x22761b = _0xe2e12e; _0x525576['innerHTML'] = ''; for (const _0x5d9dea of _0x4d4ca5['chats']) { if ('ZnxYj' === _0x22761b(0x26e)) { const _0x205474 = document[_0x22761b(0x82b)]('li'); _0x205474[_0x22761b(0x255)] = 'character-item', _0x205474['dataset']['id'] = _0x5d9dea['id']; let _0x30f6bc = _0x4991a9, _0x2b5c45 = '群聊', _0x4542f1 = ''; if (_0x5d9dea[_0x22761b(0x327)] === _0x22761b(0x17c)) { const _0x21d52b = _0x53bcef(_0x5d9dea[_0x22761b(0x836)][0x0]); _0x21d52b ? _0x22761b(0x2e3) !== _0x22761b(0x2e3) ? (_0x1e16b1[_0x22761b(0x39f)](_0x22761b(0x92f)), _0x44cfdb['chats'] = _0x55fc83['characters']['map'](_0x524376 => ({ 'id': _0x22761b(0x468) + _0x524376['id'], 'type': 'private', 'participantIds': [_0x524376['id']] })), _0x4a969a[_0x22761b(0x4de)] && (_0x32cba4[_0x22761b(0x41f)] = _0x22761b(0x468) + _0x3d1070['activeCharacterId']), _0x3699a6['characters'][_0x22761b(0x279)](_0x5a4389 => { const _0x3b3cff = _0x22761b, _0x7ef56c = _0x3b3cff(0x201) + _0x5a4389['id'], _0x413eba = 'chatHistory_chat_' + _0x5a4389['id'], _0x538ac5 = _0x1d4a1a[_0x3b3cff(0x745)](_0x7ef56c); _0x538ac5 && (_0x356c36[_0x3b3cff(0x598)](_0x413eba, _0x538ac5), _0x3442e0[_0x3b3cff(0x5e7)](_0x7ef56c)); })) : (_0x30f6bc = _0x21d52b['avatar'] || _0x4991a9, _0x2b5c45 = _0x21d52b['name'] || _0x22761b(0x1eb), _0x4542f1 = _0x21d52b[_0x22761b(0x5f2)] || '私聊') : (_0x2b5c45 = '未知角色', _0x4542f1 = _0x22761b(0x2f7)); } else { _0x2b5c45 = _0x5d9dea['name'] || '未命名群聊', _0x4542f1 = _0x5d9dea['participantIds'][_0x22761b(0x2bd)] + _0x22761b(0x337); const _0x4efa45 = await _0x299fa0(_0x22761b(0x170) + _0x5d9dea['id']); if (_0x4efa45) _0x30f6bc = URL[_0x22761b(0x1de)](_0x4efa45); } _0x205474[_0x22761b(0x978)] = _0x22761b(0x8a4) + _0x30f6bc + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x2b5c45 + _0x22761b(0x48a) + _0x4542f1 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x205474[_0x22761b(0x5e5)](_0x22761b(0x632))[_0x22761b(0x501)](_0x22761b(0x4bd), () => { const _0x20737f = _0x22761b; if (_0x20737f(0x879) === _0x20737f(0x1a4)) { if (!_0x3bb87c) return []; const _0x1d8c1e = _0x30964c[_0x20737f(0x3e8)]('\x0a'), _0x8ff4eb = [], _0x31c430 = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x343a93 of _0x1d8c1e) { const _0x39c315 = _0x343a93['match'](_0x31c430); if (_0x39c315) { const _0x5666fe = _0x2c6d1a(_0x39c315[0x1], 0xa), _0x283d8e = _0x28622e(_0x39c315[0x2], 0xa), _0x6d49a1 = _0x2a5efc(_0x39c315[0x3], 0xa) * (_0x39c315[0x3]['length'] === 0x2 ? 0xa : 0x1), _0x3322fb = _0x5666fe * 0x3c + _0x283d8e + _0x6d49a1 / 0x3e8, _0x3791ff = _0x343a93[_0x20737f(0x2ce)](_0x31c430, '')[_0x20737f(0x163)](); _0x3791ff && _0x8ff4eb['push']({ 'time': _0x3322fb, 'text': _0x3791ff }); } } return _0x8ff4eb; } else _0x41f53b(_0x5d9dea['id']), _0x3493cf(!![]); }), _0x525576[_0x22761b(0x54e)](_0x205474); } else { const _0x1f6879 = _0x41c899[_0x22761b(0x82b)]('option'); _0x1f6879[_0x22761b(0x135)] = _0x17e097['id'], _0x1f6879['textContent'] = _0x2f5a24['name'], _0x287964['appendChild'](_0x1f6879); } } } function _0x20a059() { const _0x44c60c = _0xe2e12e; if (_0x44c60c(0x1f7) === _0x44c60c(0x330)) _0x5f16e1[_0x44c60c(0x645)][_0x44c60c(0x23e)] = _0x44c60c(0x809); else { const _0x231110 = document[_0x44c60c(0x6c2)](_0x44c60c(0x5a0)); _0x231110[_0x44c60c(0x978)] = ''; const _0x276bad = _0x4d4ca5[_0x44c60c(0x4ee)][_0x44c60c(0x5fe)](_0x31a78a => _0x4d4ca5[_0x44c60c(0x53f)][_0x44c60c(0x553)](_0xeca39d => _0xeca39d[_0x44c60c(0x327)] === 'private' && _0xeca39d[_0x44c60c(0x836)]['includes'](_0x31a78a['id']))); if (_0x276bad[_0x44c60c(0x2bd)] === 0x0) { if (_0x44c60c(0x76e) === _0x44c60c(0x98f)) { const _0x5ce141 = _0x5db8b6[_0x44c60c(0x82b)](_0x44c60c(0x46f)); _0x5ce141[_0x44c60c(0x255)] = _0x44c60c(0x663), _0x5ce141['innerHTML'] = _0x44c60c(0x50a) + _0x3d1ba9['id'] + _0x44c60c(0x700) + _0x454956['id'] + _0x44c60c(0x985) + (_0x4f580d['avatar'] || _0x58435b) + _0x44c60c(0x57a) + _0x131461['id'] + _0x44c60c(0x485) + _0x334e8d[_0x44c60c(0x8fa)] + _0x44c60c(0x670), _0xf8b8cb[_0x44c60c(0x54e)](_0x5ce141); } else { _0x231110['innerHTML'] = _0x44c60c(0x3ea); return; } } _0x276bad[_0x44c60c(0x279)](_0x4fc283 => { const _0x5e810f = _0x44c60c, _0x7310d8 = document[_0x5e810f(0x82b)]('li'); _0x7310d8[_0x5e810f(0x255)] = 'character-item', _0x7310d8[_0x5e810f(0x42a)][_0x5e810f(0x5aa)] = _0x4fc283['id'], _0x7310d8[_0x5e810f(0x978)] = _0x5e810f(0x701) + (_0x4fc283['avatar'] || _0x4991a9) + _0x5e810f(0x16f) + _0x4fc283[_0x5e810f(0x8fa)] + _0x5e810f(0x59c) + (_0x4fc283['remark'] || '私聊') + _0x5e810f(0x19f), _0x7310d8[_0x5e810f(0x501)](_0x5e810f(0x4bd), () => { _0x20529c(_0x4fc283['id']); }), _0x231110[_0x5e810f(0x54e)](_0x7310d8); }); } } async function _0x20529c(_0x17f425) { const _0x126674 = _0xe2e12e, _0xe1186a = _0x53bcef(_0x17f425); if (!_0xe1186a) return; document[_0x126674(0x6c2)](_0x126674(0x364))[_0x126674(0x6c3)] = '', _0x4d4ca5['activeMeetingCharId'] = _0x17f425; const _0x5b654f = _0x4d4ca5[_0x126674(0x53f)]['find'](_0x1e8a53 => _0x1e8a53['type'] === _0x126674(0x17c) && _0x1e8a53[_0x126674(0x836)][_0x126674(0x407)](_0x17f425)); if (_0x5b654f) _0x126674(0x934) !== _0x126674(0x934) ? _0x1572b5[_0x126674(0x4f1)] = _0x58fffb[_0x126674(0x26d)][0x0]['id'] : (_0x4d4ca5[_0x126674(0x41f)] = _0x5b654f['id'], _0x42173a(), _0x4b15bf(), _0x137e4b(_0x17f425)); else { if (_0x126674(0x99c) !== 'MRMQK') { _0x432ac5(![]), _0x36f608(_0x126674(0x77f)); return; } else _0x4d4ca5[_0x126674(0x28d)] = []; } document[_0x126674(0x6c2)](_0x126674(0x2ac))[_0x126674(0x806)] = _0xe1186a[_0x126674(0x8fa)]; const _0x3861fc = document[_0x126674(0x6c2)]('meeting-main-content'); try { if (_0x126674(0x2d1) === _0x126674(0x31d)) _0x197a6d === 'home' ? _0x410606[_0x126674(0x645)][_0x126674(0x23e)] = 'inline-block' : _0x1cabb0[_0x126674(0x645)]['display'] = _0x126674(0x4aa); else { const _0x459b40 = await _0x299fa0(_0x126674(0x308) + _0x17f425); _0x459b40 ? (_0x3861fc[_0x126674(0x645)][_0x126674(0x21c)] = 'url(\x27' + URL[_0x126674(0x1de)](_0x459b40) + '\x27)', _0x3861fc[_0x126674(0x645)]['backgroundSize'] = _0x126674(0x2b6), _0x3861fc['style']['backgroundPosition'] = _0x126674(0x89e)) : _0x3861fc['style']['backgroundImage'] = _0x126674(0x4aa); } } catch (_0x7fea2c) { if ('hzXeQ' !== _0x126674(0x58e)) { _0x1bdd50(_0x126674(0x74c)); return; } else console[_0x126674(0x93a)]('加载见面背景失败\x20for\x20' + _0x17f425 + ':', _0x7fea2c), _0x3861fc[_0x126674(0x645)]['backgroundImage'] = _0x126674(0x4aa); } _0x5e5e09(), _0x5840f5(); if (_0x303f56) clearInterval(_0x303f56); _0xf896e6(), _0x303f56 = setInterval(_0xf896e6, 0x2710), document['getElementById'](_0x126674(0x1ac))[_0x126674(0x645)][_0x126674(0x23e)] = _0x126674(0x2a9), _0x113213(_0x126674(0x808), _0x126674(0x65c)); } function _0x5840f5() { const _0x12e0bb = _0xe2e12e; if (_0x12e0bb(0x576) !== _0x12e0bb(0x576)) { const _0x4f7123 = _0xd7516a['getElementById'](_0x12e0bb(0x5a0)); _0x4f7123[_0x12e0bb(0x978)] = ''; const _0x5daf0e = _0x4a6858[_0x12e0bb(0x4ee)][_0x12e0bb(0x5fe)](_0x26ac6e => _0x3e84bb[_0x12e0bb(0x53f)][_0x12e0bb(0x553)](_0x351a7e => _0x351a7e[_0x12e0bb(0x327)] === _0x12e0bb(0x17c) && _0x351a7e[_0x12e0bb(0x836)][_0x12e0bb(0x407)](_0x26ac6e['id']))); if (_0x5daf0e[_0x12e0bb(0x2bd)] === 0x0) { _0x4f7123[_0x12e0bb(0x978)] = _0x12e0bb(0x3ea); return; } _0x5daf0e[_0x12e0bb(0x279)](_0x487b7e => { const _0x1c9716 = _0x12e0bb, _0x2cca58 = _0x3c67bd['createElement']('li'); _0x2cca58['className'] = _0x1c9716(0x7b5), _0x2cca58[_0x1c9716(0x42a)][_0x1c9716(0x5aa)] = _0x487b7e['id'], _0x2cca58['innerHTML'] = _0x1c9716(0x701) + (_0x487b7e[_0x1c9716(0x86f)] || _0x45b883) + _0x1c9716(0x16f) + _0x487b7e['name'] + _0x1c9716(0x59c) + (_0x487b7e[_0x1c9716(0x5f2)] || '私聊') + _0x1c9716(0x19f), _0x2cca58['addEventListener'](_0x1c9716(0x4bd), () => { _0x13e615(_0x487b7e['id']); }), _0x4f7123[_0x1c9716(0x54e)](_0x2cca58); }); } else { const _0x1c31ae = document['getElementById']('meeting-scene-view'); _0x1c31ae[_0x12e0bb(0x978)] = ''; const _0x156eca = _0x1c31ae[_0x12e0bb(0x5e5)](_0x12e0bb(0x7b7)); if (_0x156eca) _0x156eca[_0x12e0bb(0x6ae)](); _0x4d4ca5[_0x12e0bb(0x28d)] && _0x4d4ca5[_0x12e0bb(0x28d)]['forEach']((_0xbd8128, _0x555b1a) => { const _0x49c982 = _0x12e0bb; if (_0x49c982(0x17a) !== 'hjpgt') _0x2c1a0b(![]), _0x8c32fc[_0x49c982(0x9b9)] = ![]; else { if (!_0xbd8128[_0x49c982(0x188)] || _0xbd8128[_0x49c982(0x3f7)] === 'system') return; const _0x4a49af = document['createElement']('p'); _0x4a49af[_0x49c982(0x42a)][_0x49c982(0x384)] = _0x555b1a; const _0x305690 = _0xbd8128[_0x49c982(0x7af)]['replace'](/\n/g, '<br>'); let _0x540df1 = '', _0x2e43e1 = ''; const _0x1941a7 = _0x55e5f6(_0x4d4ca5['activeChatId']); if (_0xbd8128[_0x49c982(0x3f7)] === _0x49c982(0x75d)) _0x540df1 = _0x1941a7[_0x49c982(0x8fa)] || '我', _0x2e43e1 = _0x49c982(0x486); else { if (_0xbd8128[_0x49c982(0x3f7)] === 'assistant') { if (_0x49c982(0x8fe) !== 'eQhBt') { const _0x8b4877 = _0x1c40df[_0x49c982(0x6c2)]('global-player-play-pause-btn'); if (_0x8b4877) _0x8b4877[_0x49c982(0x806)] = '▶'; } else { const _0x39acc1 = _0x53bcef(_0xbd8128['senderId'] || _0x4d4ca5[_0x49c982(0x676)]); _0x540df1 = _0x39acc1?.[_0x49c982(0x8fa)] || '角色', _0x2e43e1 = _0x49c982(0x41d); } } } _0x4a49af['style'][_0x49c982(0x393)] = 'rgba(0,\x200,\x200,\x200.4)', _0x4a49af[_0x49c982(0x645)][_0x49c982(0x1e0)] = _0x49c982(0x5f1), _0x4a49af[_0x49c982(0x645)]['borderRadius'] = _0x49c982(0x31a), _0x4a49af['style'][_0x49c982(0x65f)] = _0x49c982(0x817), _0x540df1 ? _0x4a49af[_0x49c982(0x978)] = _0x49c982(0x140) + _0x2e43e1 + _0x49c982(0x28e) + (_0x2e43e1 === _0x49c982(0x486) ? '#a7c7e7' : _0x49c982(0x6f9)) + _0x49c982(0x94f) + _0x540df1 + _0x49c982(0x85b) + _0x305690 : (_0x4a49af[_0x49c982(0x255)] = _0x49c982(0x8d3), _0x4a49af[_0x49c982(0x645)]['fontStyle'] = _0x49c982(0x307), _0x4a49af[_0x49c982(0x645)][_0x49c982(0x8f1)] = _0x49c982(0x386), _0x4a49af[_0x49c982(0x978)] = _0x305690), _0x1c31ae[_0x49c982(0x54e)](_0x4a49af); } }); if (_0x4d4ca5[_0x12e0bb(0x9b9)]) { let _0x302160 = _0x1c31ae['querySelector'](_0x12e0bb(0x6b6)); !_0x302160 && (_0x12e0bb(0x3a1) !== _0x12e0bb(0x444) ? (_0x302160 = document['createElement']('div'), _0x302160[_0x12e0bb(0x255)] = _0x12e0bb(0x619), _0x302160[_0x12e0bb(0x806)] = _0x12e0bb(0x3ec), _0x302160[_0x12e0bb(0x645)][_0x12e0bb(0x393)] = 'rgba(0,\x200,\x200,\x200.4)', _0x302160[_0x12e0bb(0x645)][_0x12e0bb(0x1e0)] = _0x12e0bb(0x5f1), _0x302160[_0x12e0bb(0x645)][_0x12e0bb(0x339)] = _0x12e0bb(0x31a), _0x1c31ae[_0x12e0bb(0x54e)](_0x302160)) : (_0x48a488[_0x12e0bb(0x93a)](_0x12e0bb(0x6c9), _0x49a2ce), _0x47a5c4 = _0x2d2f03)); } const _0x35c366 = document['createElement'](_0x12e0bb(0x46f)); _0x35c366['id'] = _0x12e0bb(0x3ac), _0x1c31ae[_0x12e0bb(0x54e)](_0x35c366), setTimeout(() => { const _0x30f3eb = _0x12e0bb; _0x30f3eb(0x633) === _0x30f3eb(0x633) ? _0x35c366[_0x30f3eb(0x9a8)]({ 'behavior': _0x30f3eb(0x8a3), 'block': 'end' }) : (_0x10f824(_0x17abae['id']), _0x4ab8a8(!![])); }, 0x32); } } function _0x1fb306() { const _0x1854b5 = _0xe2e12e, _0x52f9df = document['querySelector'](_0x1854b5(0x4b1)); if (!_0x52f9df) return; _0x52f9df['id'] === 'meeting-view-screen' ? _0x1854b5(0x862) === _0x1854b5(0x862) ? _0x5840f5() : _0x22090e[_0x1854b5(0x901)](_0x1854b5(0x6f6), { 'keyPath': 'id' }) : _0x41e9e0(); } function _0x41e9e0() { const _0x18e086 = _0xe2e12e, _0x3f8c20 = _0x4d4ca5[_0x18e086(0x28d)][_0x18e086(0x5fe)](_0x1aa398 => !_0x1aa398['isOffline'] && _0x1aa398[_0x18e086(0x3f7)] !== _0x18e086(0x449)); if (_0x3f8c20['length'] > _0x4d4ca5[_0x18e086(0x226)]) { let _0xbb29b1 = _0x2468f3[_0x18e086(0x5e5)](_0x18e086(0x529)); !_0xbb29b1 && (_0x18e086(0x5d4) === _0x18e086(0x217) ? _0x124566['src'] && (_0x2ab127[_0x18e086(0x91a)] ? _0x4d9858['play']() : _0x95d820[_0x18e086(0x31f)]()) : (_0xbb29b1 = document[_0x18e086(0x82b)](_0x18e086(0x49f)), _0xbb29b1[_0x18e086(0x806)] = '加载更多聊天记录', _0xbb29b1[_0x18e086(0x255)] = _0x18e086(0x3a8), _0xbb29b1[_0x18e086(0x645)][_0x18e086(0x5b1)] = _0x18e086(0x8a3), _0xbb29b1[_0x18e086(0x645)][_0x18e086(0x1ee)] = _0x18e086(0x150), _0xbb29b1[_0x18e086(0x645)]['padding'] = '8px\x2016px', _0xbb29b1[_0x18e086(0x254)] = () => { const _0x5247e3 = _0x18e086; if (_0x5247e3(0x12e) !== _0x5247e3(0x12e)) { const _0x16ad53 = _0x5b16c3[_0x5247e3(0x26d)][_0x5247e3(0x5a8)](_0x247ed1 => _0x247ed1['id'] === _0x2f7e7d); if (!_0x16ad53) return; _0x447253[_0x5247e3(0x6c2)](_0x5247e3(0x887))[_0x5247e3(0x135)] = _0x16ad53['id'], _0x118531[_0x5247e3(0x6c2)]('user-profile-edit-title')[_0x5247e3(0x806)] = _0x5247e3(0x7b6), _0x2c7562[_0x5247e3(0x6c2)]('user-name')[_0x5247e3(0x135)] = _0x16ad53[_0x5247e3(0x8fa)], _0x1b7bd6['getElementById']('user-avatar-preview')[_0x5247e3(0x6c3)] = _0x16ad53[_0x5247e3(0x86f)], _0x49d2e8[_0x5247e3(0x6c2)](_0x5247e3(0x15d))[_0x5247e3(0x135)] = _0x16ad53[_0x5247e3(0x7d5)], _0x117aaf['style'][_0x5247e3(0x23e)] = _0x16ad53['id'] === _0x25bff1[_0x5247e3(0x4f1)] ? _0x5247e3(0x4aa) : 'block'; } else { const _0x5e16b6 = _0x2468f3, _0x4b99c7 = _0x5e16b6['scrollHeight'], _0x211535 = _0x5e16b6['scrollTop']; _0x4d4ca5['displayedMessageCount'] += 0x64, _0x41e9e0(), requestAnimationFrame(() => { const _0xf2c0c0 = _0x5247e3, _0x4ef3b1 = _0x5e16b6['scrollHeight']; _0x5e16b6[_0xf2c0c0(0x145)] = _0x211535 + (_0x4ef3b1 - _0x4b99c7); }); } }, _0x2468f3[_0x18e086(0x6ba)] ? _0x2468f3[_0x18e086(0x899)](_0xbb29b1, _0x2468f3['firstChild']) : _0x2468f3[_0x18e086(0x54e)](_0xbb29b1))); } else { const _0x5a74bd = _0x2468f3[_0x18e086(0x5e5)](_0x18e086(0x529)); if (_0x5a74bd) _0x5a74bd[_0x18e086(0x6ae)](); } Array['from'](_0x2468f3[_0x18e086(0x266)])[_0x18e086(0x279)](_0x6a356d => { const _0x36fe44 = _0x18e086; if (_0x36fe44(0x44f) !== _0x36fe44(0x44f)) { if (_0x36f41a['target'][_0x36fe44(0x970)][_0x36fe44(0x7a5)]('delete-expense-btn')) { const _0x40249f = _0x23e27d[_0x36fe44(0x68b)]['dataset']['id']; _0x365551('确定要删除这笔记录吗？')['then'](_0x1ea2ee => { _0x1ea2ee && _0x276d3d(_0x40249f); }); } } else !_0x6a356d[_0x36fe44(0x970)][_0x36fe44(0x7a5)](_0x36fe44(0x143)) && _0x6a356d[_0x36fe44(0x6ae)](); }); const _0x11edbd = _0x3f8c20[_0x18e086(0x61e)](-_0x4d4ca5[_0x18e086(0x226)]); _0x11edbd[_0x18e086(0x279)](_0xc9ad86 => { const _0x51b6d7 = _0x18e086; if (_0x51b6d7(0x249) === _0x51b6d7(0x332)) _0x9ae6b0 += _0x1dedc1['parse'](_0x1e8130)['candidates'][0x0][_0x51b6d7(0x7af)][_0x51b6d7(0x276)][0x0][_0x51b6d7(0x57b)]; else { const _0x52adf7 = _0x4d4ca5[_0x51b6d7(0x28d)]['indexOf'](_0xc9ad86); _0x52adf7 > -0x1 && _0x59e704(_0xc9ad86, _0x52adf7); } }); if (_0x4d4ca5[_0x18e086(0x9b9)]) { let _0x45ce45 = _0x2468f3[_0x18e086(0x5e5)](_0x18e086(0x6b6)); !_0x45ce45 && (_0x45ce45 = document[_0x18e086(0x82b)](_0x18e086(0x46f)), _0x45ce45[_0x18e086(0x255)] = _0x18e086(0x619), _0x45ce45[_0x18e086(0x806)] = '对方正在输入...', _0x2468f3[_0x18e086(0x54e)](_0x45ce45)); } _0x11edbd[_0x18e086(0x2bd)] <= _0x4d4ca5[_0x18e086(0x226)] && (_0x18e086(0x179) !== _0x18e086(0x1e4) ? setTimeout(() => { _0x2468f3['scrollTop'] = _0x2468f3['scrollHeight']; }, 0x0) : _0xa9e71d[_0x18e086(0x956)]('[' + _0x4afff1(_0x288e40) + ']\x20[sticker:' + (_0xbb957a['content']?.[_0x18e086(0x199)](/：(.+?)]/)?.[0x1] || '表情') + ']')); } function _0x59e704(_0x5e9f96, _0x200344) { const _0x3c9623 = _0xe2e12e, { role: _0x290879, content: _0x1bf054, displayUrl: _0x5babcf, image: _0x357a3d, senderId: _0x343a74 } = _0x5e9f96, _0x47df75 = _0x290879 === 'assistant' ? 'ai' : _0x290879, _0x3e8692 = _0xa2c8b5(), _0x11d319 = document[_0x3c9623(0x82b)]('div'); _0x11d319[_0x3c9623(0x970)]['add'](_0x3c9623(0x175), _0x47df75), _0x11d319[_0x3c9623(0x42a)][_0x3c9623(0x384)] = _0x200344; const _0x551916 = document[_0x3c9623(0x82b)](_0x3c9623(0x46f)); _0x551916[_0x3c9623(0x255)] = _0x3c9623(0x7e4); const _0x5ad41e = document[_0x3c9623(0x82b)](_0x3c9623(0x992)); _0x5ad41e['classList'][_0x3c9623(0x68a)](_0x3c9623(0x86f), _0x290879 + '-avatar'); let _0x4c00a5 = ''; if (_0x290879 === _0x3c9623(0x75d)) { if (_0x3c9623(0x9ab) === _0x3c9623(0x9ab)) { const _0x241620 = _0x55e5f6(_0x4d4ca5['activeChatId']); _0x4c00a5 = _0x241620[_0x3c9623(0x86f)] || _0x4abe2b; } else for (const _0x2a25c6 of _0xf5dd7c[_0x3c9623(0x7ea)]) { let _0x2596ae = _0x51249c[_0x3c9623(0x7ea)][_0x3c9623(0x5a8)](_0x733a68 => _0x733a68[_0x3c9623(0x8fa)] === _0x2a25c6[_0x3c9623(0x8fa)]); if (_0x2596ae) _0x10e3dd[_0x3c9623(0x956)](_0x2596ae['id']); else { const _0x43b96 = { 'id': 'wb_' + _0x56b367[_0x3c9623(0x661)]() + '_' + _0xb9d3d0[_0x3c9623(0x4e7)](), 'name': _0x2a25c6[_0x3c9623(0x8fa)], 'content': _0x2a25c6['content'] }; _0x105f4f[_0x3c9623(0x7ea)][_0x3c9623(0x956)](_0x43b96), _0x56a938[_0x3c9623(0x956)](_0x43b96['id']); } } } else { if (_0x3c9623(0x82f) !== _0x3c9623(0x461)) { _0x4c00a5 = _0x4991a9; let _0x4a4567 = null; if (_0x3e8692?.['type'] === _0x3c9623(0x17c)) _0x3c9623(0x136) !== _0x3c9623(0x136) ? (_0x4a463a(), _0x4ce8e9[_0x3c9623(0x28d)] = [], _0x59936b()) : _0x4a4567 = _0x53bcef(_0x3e8692[_0x3c9623(0x836)][0x0]); else _0x3e8692?.[_0x3c9623(0x327)] === _0x3c9623(0x70e) && _0x343a74 && (_0x4a4567 = _0x53bcef(_0x343a74)); if (_0x4a4567?.['avatar']) { if (_0x3c9623(0x771) !== 'gAcfI') { const _0x296110 = 'diary-action-modal-' + _0x310e7b; let _0x959a4c = _0x307d8e[_0x3c9623(0x6c2)](_0x296110); if (_0x959a4c) return; const _0x61409e = '\x0a\x20\x20\x20\x20<div\x20id=\x22' + _0x296110 + _0x3c9623(0x7e1) + (_0x5b6daf === 'ai' ? '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>' : '') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20'; _0x46a73d[_0x3c9623(0x69e)][_0x3c9623(0x43f)]('beforeend', _0x61409e); const _0x3630b5 = _0x123a9d[_0x3c9623(0x6c2)](_0x296110), _0x97527b = () => _0x3630b5[_0x3c9623(0x6ae)](); _0x3630b5['querySelector']('.choice-modal-backdrop')['onclick'] = _0x97527b, _0x3630b5[_0x3c9623(0x5e5)](_0x3c9623(0x4fb))[_0x3c9623(0x254)] = _0x97527b, _0x3630b5['querySelector'](_0x3c9623(0x749))[_0x3c9623(0x254)] = () => { _0x49814d(_0x1f983a), _0x97527b(); }, _0x204295 === 'ai' && (_0x3630b5['querySelector']('#diary-action-reroll')[_0x3c9623(0x254)] = () => { _0xcab9e0(_0x586a58), _0x97527b(); }); } else _0x4c00a5 = _0x4a4567[_0x3c9623(0x86f)]; } } else _0x1775fe['content'] = _0x3494bb, _0x8b3be8(), _0x125dbc(); } _0x5ad41e[_0x3c9623(0x6c3)] = _0x4c00a5, _0x5ad41e[_0x3c9623(0x9b0)] = _0x290879 + '\x20avatar'; const _0x2672de = _0x1bf054 && _0x1bf054['trim']()[_0x3c9623(0x245)](_0x3c9623(0x6e9)) && _0x1bf054[_0x3c9623(0x163)]()[_0x3c9623(0x679)](_0x3c9623(0x455)); if (_0x2672de) { if (_0x3c9623(0x12c) === 'VymKt') { const _0x3145dc = document['createElement'](_0x3c9623(0x46f)); _0x3145dc[_0x3c9623(0x255)] = 'html-module-container', _0x3145dc[_0x3c9623(0x978)] = _0x1bf054; if (_0x47df75 === _0x3c9623(0x75d)) { if (_0x3c9623(0x146) !== _0x3c9623(0x894)) _0x551916['appendChild'](_0x3145dc), _0x551916[_0x3c9623(0x54e)](_0x5ad41e); else { if (_0x199a99[_0x3c9623(0x8c3)] === 'Escape') _0x54ab4a(![]); if (_0x2c48b6[_0x3c9623(0x8c3)] === _0x3c9623(0x161)) _0x4418ea(!![]); } } else 'jYHRu' !== _0x3c9623(0x7a8) ? (_0x23ee81[_0x3c9623(0x806)] = _0x48c224['title'], _0x123f5e['textContent'] = _0xad81d0[_0x3c9623(0x816)], _0x3f1839[_0x3c9623(0x970)][_0x3c9623(0x68a)](_0x3c9623(0x99b)), _0x3fd943[_0x3c9623(0x645)][_0x3c9623(0x6d8)]('--widget-cover-image', 'url(' + _0x497053['cover'] + ')')) : (_0x551916[_0x3c9623(0x54e)](_0x5ad41e), _0x551916[_0x3c9623(0x54e)](_0x3145dc)); } else _0x95c22f[_0x3c9623(0x963)] = _0x21fd5b[_0x3c9623(0x963)]['filter'](_0x42f14c => _0x42f14c !== _0x512138); } else { const _0x3c0227 = document[_0x3c9623(0x82b)]('div'); _0x3c0227['classList'][_0x3c9623(0x68a)](_0x3c9623(0x6a1), _0x47df75); if (_0x3e8692?.[_0x3c9623(0x327)] === 'private') { const _0x18263d = _0x3e8692['participantIds'][0x0]; _0x3c0227[_0x3c9623(0x970)][_0x3c9623(0x68a)](_0x3c9623(0x4fa) + _0x18263d); } if (_0x5e9f96[_0x3c9623(0x177)]) { const _0xf85218 = document[_0x3c9623(0x82b)](_0x3c9623(0x46f)); _0xf85218['className'] = _0x3c9623(0x731); const _0x19285a = document['createElement'](_0x3c9623(0x46f)); _0x19285a[_0x3c9623(0x255)] = _0x3c9623(0x389), _0x19285a['textContent'] = _0x5e9f96[_0x3c9623(0x177)][_0x3c9623(0x54f)]; const _0x46fb8b = document[_0x3c9623(0x82b)]('div'); _0x46fb8b['className'] = _0x3c9623(0x3d3), _0x46fb8b[_0x3c9623(0x806)] = _0x5e9f96['quotedMessage']['content'], _0xf85218[_0x3c9623(0x54e)](_0x19285a), _0xf85218[_0x3c9623(0x54e)](_0x46fb8b), _0x3c0227[_0x3c9623(0x54e)](_0xf85218); } if (_0x5babcf) { _0x3c0227[_0x3c9623(0x970)][_0x3c9623(0x68a)](_0x3c9623(0x4cd)); const _0x22357f = document['createElement']('img'); _0x22357f[_0x3c9623(0x6c3)] = _0x5babcf, _0x22357f['classList']['add']('sticker-content'), _0x3c0227['appendChild'](_0x22357f); } else { if (_0x5e9f96[_0x3c9623(0x776)] || _0x5e9f96['imageId']) { if (_0x3c9623(0x8ba) === _0x3c9623(0x8ba)) { _0x3c0227['classList'][_0x3c9623(0x68a)]('image'); const _0x55a377 = document[_0x3c9623(0x82b)](_0x3c9623(0x992)); _0x55a377[_0x3c9623(0x970)]['add'](_0x3c9623(0x767)), _0x3c0227['appendChild'](_0x55a377); _0x5e9f96[_0x3c9623(0x776)] ? _0x55a377[_0x3c9623(0x6c3)] = _0x5e9f96[_0x3c9623(0x776)] : (_0x55a377['src'] = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', _0x299fa0(_0x5e9f96[_0x3c9623(0x714)])[_0x3c9623(0x588)](_0x3ed0c1 => { const _0x5bbb32 = _0x3c9623; if (_0x3ed0c1) { const _0x1d6a75 = URL[_0x5bbb32(0x1de)](_0x3ed0c1); _0x55a377['src'] = _0x1d6a75, _0x55a377[_0x5bbb32(0x575)] = () => { const _0x23920f = _0x5bbb32; _0x23920f(0x666) === 'cECCH' ? (_0x30c4ed[_0x23920f(0x39f)](_0x23920f(0x141)), _0x4fa7d2['currentAbortController']['abort'](_0x23920f(0x5f7)), _0x2633a3[_0x23920f(0x94e)] = null) : URL[_0x23920f(0x3cf)](_0x1d6a75); }; } else _0x55a377[_0x5bbb32(0x9b0)] = '图片加载失败'; })[_0x3c9623(0x76c)](_0x12c427 => { const _0x127c9f = _0x3c9623; if ('hsjXY' === _0x127c9f(0x5b5)) { if (!_0x57d853) return; const _0x7d7453 = _0x2da064['activeMeetingCharId'], _0x38da0a = _0x4fa6b1(_0x7d7453); if (!_0x38da0a) return; const _0x4c2a0a = _0x5afd6a(_0x2dab62[_0x127c9f(0x6c2)](_0x127c9f(0x596))[_0x127c9f(0x135)]), _0x2c4e0a = _0x50ef36(_0x4dc928['getElementById'](_0x127c9f(0x439))[_0x127c9f(0x135)]), _0x419c7c = _0x2364f6(_0x49ac4e[_0x127c9f(0x6c2)](_0x127c9f(0x4ad))[_0x127c9f(0x135)]) / 0x64; _0x38da0a[_0x127c9f(0x1cb)] = { 'x': _0x4c2a0a, 'y': _0x2c4e0a, 'scale': _0x419c7c }; const _0x4d1917 = _0x58ddfb[_0x127c9f(0x6c2)](_0x127c9f(0x567)), _0x531594 = 0x50 * _0x419c7c; _0x4d1917['style'][_0x127c9f(0x8ab)] = _0x531594 + '%', _0x4d1917[_0x127c9f(0x645)][_0x127c9f(0x5b1)] = _0x531594 + '%', _0x4d1917['style'][_0x127c9f(0x2c5)] = _0x4c2a0a + '%', _0x4d1917[_0x127c9f(0x645)][_0x127c9f(0x692)] = _0x2c4e0a + '%', _0x4d1917[_0x127c9f(0x645)][_0x127c9f(0x25d)] = _0x127c9f(0x8e6); } else console['error']('无法从\x20IndexedDB\x20加载聊天图片:', _0x12c427), _0x55a377[_0x127c9f(0x9b0)] = _0x127c9f(0x729); })); if (_0x1bf054) { if ('xQDGH' !== _0x3c9623(0x81e)) { const _0x1460c3 = document[_0x3c9623(0x82b)]('p'); _0x1460c3[_0x3c9623(0x645)][_0x3c9623(0x6dc)] = '5px', _0x1460c3[_0x3c9623(0x806)] = _0x1bf054, _0x3c0227['appendChild'](_0x1460c3); } else _0x207303['preferences'] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; } } else _0x50554a(), _0xe541cb(![]); } else { if (_0x5e9f96['type'] === _0x3c9623(0x527)) { _0x3c0227[_0x3c9623(0x970)]['add'](_0x3c9623(0x527)); const _0x5376c7 = _0x5e9f96['role'] === 'user' ? _0x55e5f6(_0x4d4ca5[_0x3c9623(0x41f)]) : _0x53bcef(_0x5e9f96[_0x3c9623(0x6bd)]), _0x4cd01a = _0x5e9f96['recipientId'] === _0x55e5f6(_0x4d4ca5[_0x3c9623(0x41f)])['id'] ? _0x55e5f6(_0x4d4ca5['activeChatId']) : _0x53bcef(_0x5e9f96[_0x3c9623(0x241)]), _0x253b6f = _0x5376c7?.[_0x3c9623(0x8fa)] ? _0x5376c7[_0x3c9623(0x8fa)] + _0x3c9623(0x13e) : '转账', _0x374c44 = _0x4cd01a?.[_0x3c9623(0x8fa)] ? '转给\x20' + _0x4cd01a[_0x3c9623(0x8fa)] : '转账', _0x333da8 = _0x3c9623(0x58f) + _0x253b6f + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥' + _0x5e9f96['amount'][_0x3c9623(0x874)](0x2) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>' + _0x374c44 + _0x3c9623(0x671); _0x3c0227[_0x3c9623(0x978)] = _0x333da8; } else { if (_0x5e9f96['type'] === _0x3c9623(0x403)) { _0x3c0227['classList']['add'](_0x3c9623(0x513)); const _0x4ccde3 = document[_0x3c9623(0x82b)]('div'); _0x4ccde3[_0x3c9623(0x255)] = 'listen-together-card', _0x4ccde3[_0x3c9623(0x970)]['add'](_0x3c9623(0x2f5)); const _0x5db9d5 = _0x5e9f96[_0x3c9623(0x3f7)] === 'user' ? _0x55e5f6(_0x4d4ca5[_0x3c9623(0x41f)])['name'] || '你' : _0x53bcef(_0x5e9f96[_0x3c9623(0x6bd)])?.[_0x3c9623(0x8fa)] || 'TA', _0x4dc7e0 = _0x3c9623(0x895) + _0x5e9f96[_0x3c9623(0x2c3)], _0x38d938 = _0x3c9623(0x699) + _0x4dc7e0 + _0x3c9623(0x5be) + _0x4991a9 + '\x22>'; _0x5e9f96[_0x3c9623(0x2ca)] && _0x299fa0(_0x5e9f96['coverId'])['then'](_0x26f04d => { const _0x21f924 = _0x3c9623, _0x45c7d9 = document[_0x21f924(0x6c2)](_0x4dc7e0); if (_0x45c7d9 && _0x26f04d) _0x45c7d9[_0x21f924(0x6c3)] = URL[_0x21f924(0x1de)](_0x26f04d); }), _0x5e9f96[_0x3c9623(0x2b1)] ? _0x4ccde3[_0x3c9623(0x978)] = _0x3c9623(0x3a6) + _0x38d938 + _0x3c9623(0x927) + _0x5e9f96[_0x3c9623(0x27a)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x5e9f96[_0x3c9623(0x816)] + _0x3c9623(0x1be) : _0x4ccde3[_0x3c9623(0x978)] = _0x3c9623(0x6ec) + _0x5db9d5 + '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x38d938 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x5e9f96[_0x3c9623(0x27a)] + _0x3c9623(0x1f1) + _0x5e9f96[_0x3c9623(0x816)] + _0x3c9623(0x34f) + _0x5e9f96[_0x3c9623(0x242)] + _0x3c9623(0x560), _0x3c0227[_0x3c9623(0x54e)](_0x4ccde3); } else { if (_0x5e9f96[_0x3c9623(0x327)] === _0x3c9623(0x513) && _0x5e9f96[_0x3c9623(0x27a)]) { _0x3c0227['classList'][_0x3c9623(0x68a)](_0x3c9623(0x513)); const _0x472060 = document['createElement'](_0x3c9623(0x46f)); _0x472060[_0x3c9623(0x255)] = 'music-share-card', _0x472060[_0x3c9623(0x42a)]['musicId'] = _0x3c9623(0x35f) + _0x5e9f96[_0x3c9623(0x2c3)]; const _0x46d9cc = 'cover_placeholder_' + _0x5e9f96[_0x3c9623(0x2c3)], _0x112cf7 = _0x3c9623(0x75b) + _0x4991a9 + '\x22\x20id=\x22' + _0x46d9cc + _0x3c9623(0x14d); if (_0x5e9f96['coverId']) _0x299fa0(_0x5e9f96[_0x3c9623(0x2ca)])['then'](_0xe1a008 => { const _0x3598c8 = _0x3c9623; if (_0x3598c8(0x84a) !== _0x3598c8(0x84a)) _0x4ab7ab[_0x3598c8(0x6c2)](_0x3598c8(0x6e6))[_0x3598c8(0x645)][_0x3598c8(0x6d8)](_0x3598c8(0x882), 'url(' + _0x21553a + ')'); else { const _0x5eceef = document[_0x3598c8(0x6c2)](_0x46d9cc); if (_0x5eceef && _0xe1a008) _0x5eceef['src'] = URL[_0x3598c8(0x1de)](_0xe1a008); } }); else _0x5e9f96[_0x3c9623(0x378)] && setTimeout(() => { const _0x4476ae = _0x3c9623, _0x24063d = document['getElementById'](_0x46d9cc); if (_0x24063d) _0x24063d[_0x4476ae(0x6c3)] = _0x5e9f96['coverUrl']; }, 0x0); _0x472060[_0x3c9623(0x978)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x112cf7 + _0x3c9623(0x813) + _0x5e9f96[_0x3c9623(0x27a)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x5e9f96['artist'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>' + (_0x5e9f96[_0x3c9623(0x151)] ? '▶' : '⚠') + _0x3c9623(0x455), _0x5e9f96[_0x3c9623(0x151)] && _0x472060[_0x3c9623(0x501)](_0x3c9623(0x4bd), function () { const _0x457f6c = _0x3c9623; if ('Opert' === _0x457f6c(0x8cc)) { const _0x5e0e70 = { 'id': 'msg_' + _0x5e9f96[_0x457f6c(0x2c3)], 'url': _0x5e9f96[_0x457f6c(0x151)] }; _0x451d19(this, _0x5e0e70); } else _0x4dc2ce['error']('获取AI响应失败:', _0x1a9c80), _0x30c3af({ 'role': _0x457f6c(0x832), 'content': _0x457f6c(0x67a) + _0x18fb93[_0x457f6c(0x6a1)] }, _0x61cbda['conversationHistory'][_0x457f6c(0x2bd)] - 0x1); }), _0x3c0227[_0x3c9623(0x54e)](_0x472060); } else { if (_0x3c9623(0x5b6) !== _0x3c9623(0x656)) { if (_0x1bf054) { const _0x36be7e = document[_0x3c9623(0x82b)]('p'); _0x36be7e['innerHTML'] = _0x1bf054, _0x36be7e[_0x3c9623(0x645)]['margin'] = '0', _0x3c0227['appendChild'](_0x36be7e); } } else _0x4c7216 = _0x574234(_0x1b4909); } } } } } _0x290879 === _0x3c9623(0x75d) ? (_0x551916['appendChild'](_0x3c0227), _0x551916[_0x3c9623(0x54e)](_0x5ad41e)) : _0x3c9623(0x7c2) !== _0x3c9623(0x7c2) ? _0x518256(![]) : (_0x551916['appendChild'](_0x5ad41e), _0x551916['appendChild'](_0x3c0227)); } _0x11d319['appendChild'](_0x551916); const _0x3dd6dc = document[_0x3c9623(0x82b)](_0x3c9623(0x46f)); return _0x3dd6dc[_0x3c9623(0x255)] = _0x3c9623(0x2c3), _0x3dd6dc[_0x3c9623(0x806)] = _0x937feb(_0x5e9f96[_0x3c9623(0x2c3)]), _0x11d319[_0x3c9623(0x54e)](_0x3dd6dc), _0x2468f3[_0x3c9623(0x54e)](_0x11d319), _0x11d319; } document[_0xe2e12e(0x6c2)](_0xe2e12e(0x414))['addEventListener']('click', _0x39e56e); let _0x4ed78e = null, _0x303f56 = null; function _0x39e56e(_0x4bed56) { const _0x597f21 = _0xe2e12e; if ('FLuWn' === _0x597f21(0x758)) { if (window[_0x597f21(0x16e)]()[_0x597f21(0x823)]()) { if (_0x597f21(0x253) === _0x597f21(0x6ff)) _0x3a93b9[_0x597f21(0x1cb)] = _0x106f2f, _0x305119(_0x9d375c['activeMeetingCharId'], _0x597f21(0x416)); else return; } const _0x4ae401 = _0x4bed56['target'][_0x597f21(0x863)]('.message-container'), _0x14b564 = _0x4bed56[_0x597f21(0x68b)][_0x597f21(0x863)](_0x597f21(0x96d)); if (!_0x4ae401 || _0x14b564) return; const _0x3a8c66 = parseInt(_0x4ae401[_0x597f21(0x42a)][_0x597f21(0x384)], 0xa); if (isNaN(_0x3a8c66)) return; _0x360195(_0x3a8c66); } else _0x322fe4[_0x597f21(0x9b9)] = ![], _0x58195c(![]); } function _0x2cf7e8() { const _0x260232 = _0xe2e12e, _0x969bf7 = _0xa2c8b5(); if (!_0x969bf7) { if ('NsVje' !== 'DmZVZ') { _0x92d95[_0x260232(0x806)] = _0x260232(0x63c); return; } else return '今天\x20' + _0x2fd00b; } if (_0x969bf7[_0x260232(0x327)] === _0x260232(0x17c)) { const _0x2555e9 = _0x53bcef(_0x969bf7[_0x260232(0x836)][0x0]); _0x92d95[_0x260232(0x806)] = _0x2555e9 ? _0x2555e9[_0x260232(0x8fa)] : _0x260232(0x385); } else _0x260232(0x72a) === _0x260232(0x72a) ? _0x92d95[_0x260232(0x806)] = _0x969bf7[_0x260232(0x8fa)] || _0x260232(0x4e4) + _0x969bf7[_0x260232(0x836)][_0x260232(0x2bd)] + ')' : _0x189584('home', _0x260232(0x65c)); } function _0xb42de9(_0x369ab0) { const _0x24f1f4 = _0xe2e12e; if (_0x24f1f4(0x42c) === _0x24f1f4(0x320)) { const _0x437de8 = _0x18538c['accountingData'][_0x24f1f4(0x388)](_0x4d5be6 => _0x4d5be6['id'] === _0x1367e3); _0x437de8 > -0x1 && (_0x4b3a8d[_0x24f1f4(0x2fa)][_0x24f1f4(0x79b)](_0x437de8, 0x1), _0x2657b6(), _0x666264()); } else { const _0x2cdb48 = document['querySelector'](_0x24f1f4(0x4b1)); if (_0x2cdb48 && (_0x2cdb48['id'] === _0x24f1f4(0x47c) || _0x2cdb48['id'] === _0x24f1f4(0x250))) _0x24f1f4(0x775) === 'dfeUs' ? _0x1fb306() : (delete _0xff51c8['accountingLedger'][_0x21dfe2], _0xdc03b9(), _0x56e8a8()); else { if ('tyqIh' !== 'tyqIh') { _0x38134f(); const _0x500071 = _0xc39db7[_0x24f1f4(0x54c)]['find'](_0x29cd90 => _0x29cd90['id'] === _0x10c702); if (!_0x500071) return; _0x42a0dc[_0x24f1f4(0x752)] = _0x48fc7b, _0x167807(), _0x4953d2[_0x24f1f4(0x6c2)](_0x24f1f4(0x855))['textContent'] = _0x500071[_0x24f1f4(0x8fa)], _0x2cd171(), _0x2256da(_0x24f1f4(0x513), _0x24f1f4(0x6bf)), _0x12acb7(); } else { const _0x519559 = document['querySelectorAll'](_0x24f1f4(0x6b6)); _0x519559[_0x24f1f4(0x279)](_0x300373 => _0x300373[_0x24f1f4(0x6ae)]()); } } } } function _0x5e29e2() { const _0x4b0b3b = _0xe2e12e; if (_0x4b0b3b(0x9b7) !== _0x4b0b3b(0x2cb)) { if (_0x4d4ca5[_0x4b0b3b(0x9b9)] && _0x4d4ca5[_0x4b0b3b(0x94e)]) { if (_0x4b0b3b(0x400) === _0x4b0b3b(0x571)) throw new _0x11d86f(_0x4b0b3b(0x81a) + _0x1ce5bb); else console[_0x4b0b3b(0x39f)](_0x4b0b3b(0x141)), _0x4d4ca5['currentAbortController'][_0x4b0b3b(0x5b0)](_0x4b0b3b(0x5f7)), _0x4d4ca5[_0x4b0b3b(0x94e)] = null; } _0x4d4ca5[_0x4b0b3b(0x9b9)] = ![], _0xb42de9(![]); } else { const _0x9469d = [], _0x38befb = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0xf9eee5; while ((_0xf9eee5 = _0x38befb[_0x4b0b3b(0x3f0)](_0x21b804)) !== null) { const _0x462308 = _0xf9eee5[0x1][_0x4b0b3b(0x2ce)](/\\"/g, '\x22')['replace'](/\\n/g, '\x0a')[_0x4b0b3b(0x163)](); if (_0x462308) _0x9469d[_0x4b0b3b(0x956)](_0x462308); } if (_0x9469d[_0x4b0b3b(0x2bd)]) return _0x9469d['flatMap'](_0x651de9)[_0x4b0b3b(0x61e)](0x0, 0x9); } } function _0xa2c8b5() { const _0x4a2b96 = _0xe2e12e; return _0x4d4ca5[_0x4a2b96(0x53f)]['find'](_0x4261ff => _0x4261ff['id'] === _0x4d4ca5[_0x4a2b96(0x41f)]); } function _0x53bcef(_0x2a300e) { const _0x17c190 = _0xe2e12e; if (_0x17c190(0x91e) !== _0x17c190(0x517)) return _0x4d4ca5[_0x17c190(0x4ee)][_0x17c190(0x5a8)](_0x355d88 => _0x355d88['id'] === _0x2a300e); else _0x1582d9[_0x17c190(0x776)] = _0x153783; } function _0x387742(_0x395374) { const _0x5455c8 = _0xe2e12e; _0x4d4ca5[_0x5455c8(0x4ee)] = _0x4d4ca5[_0x5455c8(0x4ee)][_0x5455c8(0x5fe)](_0x4e135b => _0x4e135b['id'] !== _0x395374), _0x4d4ca5[_0x5455c8(0x53f)][_0x5455c8(0x279)](_0x154d0c => { const _0x6ea398 = _0x5455c8; _0x154d0c[_0x6ea398(0x327)] === _0x6ea398(0x70e) && (_0x154d0c[_0x6ea398(0x836)] = _0x154d0c[_0x6ea398(0x836)]['filter'](_0x208e89 => _0x208e89 !== _0x395374)); }); const _0x11fd23 = _0x4d4ca5[_0x5455c8(0x53f)][_0x5455c8(0x5a8)](_0x588493 => _0x588493[_0x5455c8(0x327)] === _0x5455c8(0x17c) && _0x588493[_0x5455c8(0x836)][_0x5455c8(0x407)](_0x395374)); _0x11fd23 && (_0x5455c8(0x8da) === _0x5455c8(0x685) ? _0xa5d411 = _0x5455c8(0x41b) + _0x2aef5d['id'] + _0x5455c8(0x3ba) + (_0x1ee2da[_0x5455c8(0x378)] || _0x488f37) + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x88854d[_0x5455c8(0x27a)] + _0x5455c8(0x820) + _0x1b1b4c[_0x5455c8(0x816)] + _0x5455c8(0x903) + (_0x3bc787[_0x5455c8(0x151)] ? '▶' : '⚠') + '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20' : _0x297bb8(_0x11fd23['id'])), _0x4d4ca5[_0x5455c8(0x53f)] = _0x4d4ca5[_0x5455c8(0x53f)][_0x5455c8(0x5fe)](_0x4ee6f6 => _0x4ee6f6['type'] !== _0x5455c8(0x70e) || _0x4ee6f6[_0x5455c8(0x836)][_0x5455c8(0x2bd)] > 0x1), _0x42173a(), _0x505812(); } function _0x297bb8(_0x2aed5b) { const _0x7569ec = _0xe2e12e; if ('UsoyZ' !== 'wPwwL') { _0x4d4ca5[_0x7569ec(0x53f)] = _0x4d4ca5[_0x7569ec(0x53f)][_0x7569ec(0x5fe)](_0x180d7a => _0x180d7a['id'] !== _0x2aed5b); try { localStorage['removeItem'](_0x7569ec(0x201) + _0x2aed5b); } catch (_0x581967) { if (_0x7569ec(0x15c) !== _0x7569ec(0x15c)) { _0x4c04fc(_0x7569ec(0x7fc)); return; } else console[_0x7569ec(0x93a)](_0x7569ec(0x4b5) + _0x2aed5b, _0x581967); } if (_0x4d4ca5[_0x7569ec(0x41f)] === _0x2aed5b) { if (_0x7569ec(0x2b8) !== 'hRKfr') throw new _0xbfe1b4('文件格式不正确，不是一个有效的备份文件。'); else _0x4d4ca5['activeChatId'] = _0x4d4ca5[_0x7569ec(0x53f)][0x0]?.['id'] || null, _0x41f53b(_0x4d4ca5[_0x7569ec(0x41f)]); } _0x42173a(), _0x505812(); } else { const _0x5c2bf = _0x217535[_0x7569ec(0x489)][_0x7569ec(0x5fe)](_0x16dbdb => _0x16dbdb[_0x7569ec(0x427)] === _0x7569ec(0x75d))[_0x7569ec(0x764)](); _0x5c2bf && (_0x208332 = _0x5c2bf['content']); } } async function _0x41f53b(_0x472088) { const _0x229a25 = _0xe2e12e; _0x4d4ca5[_0x229a25(0x41f)] !== _0x472088 && (_0x5e29e2(), _0x4d4ca5['displayedMessageCount'] = 0x64); if (!_0x472088) { _0x4d4ca5['activeChatId'] = null, _0x42173a(), _0x3493cf(![]), document[_0x229a25(0x6c2)](_0x229a25(0x558))['style'][_0x229a25(0x21c)] = ''; return; } _0x4d4ca5['activeChatId'] = _0x472088, _0x42173a(), _0x2cf7e8(), _0x2468f3[_0x229a25(0x978)] = '', _0x3145a8(!![], _0x229a25(0x1ad)), setTimeout(async () => { const _0x4abc97 = _0x229a25; if ('FGkpY' !== _0x4abc97(0x686)) try { _0x4b15bf(); const _0x4ceb12 = _0xa2c8b5(), _0x23af43 = document[_0x4abc97(0x6c2)](_0x4abc97(0x558)); let _0x128592 = null; if (_0x4ceb12) { if (_0x4ceb12[_0x4abc97(0x327)] === 'private') { const _0x1b892a = _0x4ceb12[_0x4abc97(0x836)][0x0]; _0x4f252a(_0x1b892a), _0x128592 = await _0x299fa0(_0x4abc97(0x451) + _0x1b892a); } else 'gkkbC' === 'qsiUt' ? _0x2757be[_0x4abc97(0x2d6)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x2794a2[_0x4abc97(0x2d6)] } : _0x128592 = await _0x299fa0(_0x4abc97(0x57d) + _0x4ceb12['id']); _0x128592 ? (_0x23af43['style']['backgroundImage'] = _0x4abc97(0x41e) + URL['createObjectURL'](_0x128592) + '\x27)', _0x23af43[_0x4abc97(0x645)]['backgroundSize'] = _0x4abc97(0x2b6), _0x23af43[_0x4abc97(0x645)][_0x4abc97(0x2e8)] = _0x4abc97(0x89e)) : _0x4abc97(0x1d2) !== _0x4abc97(0x884) ? _0x23af43['style'][_0x4abc97(0x21c)] = '' : _0x325b78[_0x4abc97(0x145)] = _0x1592ca[_0x4abc97(0x2cf)]; } _0x41e9e0(); } catch (_0x18e06e) { if (_0x4abc97(0x45e) !== _0x4abc97(0x98d)) console[_0x4abc97(0x93a)](_0x4abc97(0x63f), _0x18e06e), _0x589297('加载聊天失败:\x20' + _0x18e06e['message']); else return _0x34b6b0[_0x4abc97(0x61e)](0x0, 0x9); } finally { _0x4abc97(0x626) !== _0x4abc97(0x5e9) ? _0x3145a8(![]) : (_0x4d52a7[_0x4abc97(0x26d)] = _0x181840[_0x4abc97(0x26d)][_0x4abc97(0x5fe)](_0x39546d => _0x39546d['id'] !== _0x17ee4d), _0x412a6b['activeUserProfileId'] === _0x4034c7 && (_0x2656dd[_0x4abc97(0x4f1)] = _0x455685['userProfiles'][0x0]['id']), _0x210b6c['chats']['forEach'](_0xe6654c => { const _0x3010db = _0x4abc97; _0xe6654c[_0x3010db(0x757)] === _0x695b68 && (_0xe6654c[_0x3010db(0x757)] = _0x1a3205['activeUserProfileId']); }), _0x491b2f(), _0x2afedc(_0x4abc97(0x50d)), _0x3bd3f2(), _0x1d8aab(_0x4abc97(0x4e1), 'userProfile')); } else { _0x5d36b0('AI似乎没有想出任何新动态。'); return; } }, 0x32); } async function _0x558b66() { const _0x3b89ea = _0xe2e12e; if (_0x4d4ca5[_0x3b89ea(0x9b9)]) { _0x589297(_0x3b89ea(0x56c)); return; } const _0x2364c0 = _0x4d4ca5[_0x3b89ea(0x28d)]; if (_0x2364c0[_0x3b89ea(0x2bd)] === 0x0) return; let _0x24ccff = -0x1; for (let _0x3226b9 = _0x2364c0[_0x3b89ea(0x2bd)] - 0x1; _0x3226b9 >= 0x0; _0x3226b9--) { if (_0x3b89ea(0x8ae) !== _0x3b89ea(0x801)) { if (_0x2364c0[_0x3226b9][_0x3b89ea(0x3f7)] === _0x3b89ea(0x75d)) { _0x24ccff = _0x3226b9; break; } } else _0xe9c628[_0x3b89ea(0x93a)]('导入角色卡失败:', _0x28b57b), _0x5af229(_0x3b89ea(0x25a) + _0x21bc06[_0x3b89ea(0x6a1)]); } if (_0x24ccff === -0x1 || _0x24ccff === _0x2364c0[_0x3b89ea(0x2bd)] - 0x1) { if (_0x3b89ea(0x404) !== _0x3b89ea(0x404)) _0x2ddadc = _0x5aa0c2[_0x3b89ea(0x8fa)], _0x4c5f6d = _0x32e487[_0x3b89ea(0x86f)]; else { _0x589297(_0x3b89ea(0x994)); return; } } _0x2364c0[_0x3b89ea(0x79b)](_0x24ccff + 0x1), _0x521ac4(), _0x1fb306(), setTimeout(() => { _0x52ef2f(); }, 0x64); } function _0x4527c8(_0x4effb8 = null) { const _0x47eb9c = _0xe2e12e; if (_0x47eb9c(0x4bf) === _0x47eb9c(0x4bf)) { const _0x1ec16f = _0x4effb8 ?? _0x2fbbd3['value'][_0x47eb9c(0x163)](); if (_0x1ec16f === '' || !_0x4d4ca5['activeChatId']) return; const _0x59f571 = document[_0x47eb9c(0x5e5)]('.screen.active'), _0x331602 = _0x59f571['id'] === _0x47eb9c(0x47c), _0x4ef15f = { 'role': _0x47eb9c(0x75d), 'content': _0x1ec16f, 'timestamp': Date['now'](), 'isOffline': _0x331602 }; _0x4d4ca5[_0x47eb9c(0x272)] && (_0x47eb9c(0x91c) !== _0x47eb9c(0x95b) ? _0x4ef15f[_0x47eb9c(0x177)] = { ..._0x4d4ca5[_0x47eb9c(0x272)] } : (_0x3d9fae[_0x47eb9c(0x54e)](_0x315dc5), _0x589744[_0x47eb9c(0x54e)](_0x4c5ddf))), _0x4d4ca5[_0x47eb9c(0x28d)][_0x47eb9c(0x956)](_0x4ef15f), _0x521ac4(), _0x1fb306(), !_0x4effb8 && (_0x2fbbd3['value'] = ''), _0x26b848(); } else { const _0x2d0553 = _0x2c39ee[_0x47eb9c(0x6c2)](_0x22474a); if (_0x2d0553 && _0x510f3e) _0x2d0553[_0x47eb9c(0x6c3)] = _0x2a51da[_0x47eb9c(0x1de)](_0x11f80a); } } function _0x5d67e1(_0x4ad031) { const _0x309401 = _0xe2e12e; if (!_0x4ad031 || !_0x4d4ca5[_0x309401(0x41f)]) return; const _0x4a13a0 = { 'role': _0x309401(0x75d), 'content': _0x309401(0x55f) + _0x4ad031[_0x309401(0x8fa)] + ']', 'displayUrl': _0x4ad031[_0x309401(0x6b8)], 'timestamp': Date[_0x309401(0x661)]() }; _0x4d4ca5['conversationHistory']['push'](_0x4a13a0), _0x59e704(_0x4a13a0, _0x4d4ca5[_0x309401(0x28d)][_0x309401(0x2bd)] - 0x1), _0x521ac4(), _0x58f824['classList']['remove'](_0x309401(0x3a7)); } async function _0x36c377(_0x37559b) { const _0x5092d3 = _0xe2e12e, _0x5c2b6d = _0x37559b[_0x5092d3(0x68b)][_0x5092d3(0x4c0)][0x0]; if (!_0x5c2b6d || !_0x4d4ca5[_0x5092d3(0x41f)]) return; _0x3145a8(!![], _0x5092d3(0x36b)); try { if (_0x5092d3(0x1ae) !== _0x5092d3(0x1ae)) _0x5c726f = '未知角色', _0x4e2832 = _0x5092d3(0x2f7); else { const _0x55b20a = await _0x46f332(_0x5c2b6d, 0x320, 0.8, !![]), _0x353704 = _0x5092d3(0x8fd) + Date[_0x5092d3(0x661)](); await _0x34f697(_0x353704, _0x55b20a); const _0x3426da = _0x2fbbd3['value'][_0x5092d3(0x163)](); _0x2fbbd3[_0x5092d3(0x135)] = ''; const _0x546a8c = { 'role': _0x5092d3(0x75d), 'content': _0x3426da, 'imageId': _0x353704, 'timestamp': Date[_0x5092d3(0x661)]() }; _0x4d4ca5[_0x5092d3(0x28d)][_0x5092d3(0x956)](_0x546a8c), _0x59e704(_0x546a8c, _0x4d4ca5[_0x5092d3(0x28d)][_0x5092d3(0x2bd)] - 0x1), _0x521ac4(); } } catch (_0x597bce) { _0x589297(_0x5092d3(0x1e9) + _0x597bce[_0x5092d3(0x6a1)]); } finally { _0x3145a8(![]), _0x37559b[_0x5092d3(0x68b)]['value'] = ''; } } async function _0x19b541() { const _0x46ae04 = _0xe2e12e; if (!_0x4d4ca5[_0x46ae04(0x41f)]) return; const _0x3c5ca5 = await _0x4679ee(); if (!_0x3c5ca5) return; _0x589297('正在搜索音乐...'); try { if (_0x46ae04(0x7b3) === _0x46ae04(0x7b3)) { const _0x1e6eb9 = await _0x51dab6(_0x3c5ca5['songName'], _0x3c5ca5[_0x46ae04(0x816)]); let _0x525082 = _0x1e6eb9[_0x46ae04(0x2b6)]; if (_0x1e6eb9[_0x46ae04(0x2b6)] && _0x1e6eb9[_0x46ae04(0x2b6)][_0x46ae04(0x245)](_0x46ae04(0x7de))) try { const _0x578a56 = await fetch(_0x1e6eb9['cover']), _0x2d8299 = await _0x578a56['blob'](); _0x525082 = await _0x1ac482(_0x2d8299); } catch (_0x535849) { if ('aLmEH' === 'aLmEH') console[_0x46ae04(0x93a)]('下载并转换网络封面失败:', _0x535849), _0x525082 = _0x4991a9; else { _0x21a2c0[_0x46ae04(0x970)][_0x46ae04(0x68a)](_0x46ae04(0x527)); const _0x2a01ac = _0x583b8b['role'] === _0x46ae04(0x75d) ? _0x2acc17(_0x53bad0[_0x46ae04(0x41f)]) : _0x20dcb3(_0x53960b[_0x46ae04(0x6bd)]), _0xc0cc8f = _0x4fd1db[_0x46ae04(0x241)] === _0x23229d(_0xe999ba[_0x46ae04(0x41f)])['id'] ? _0x3b1dcb(_0x262f77[_0x46ae04(0x41f)]) : _0x83e64e(_0x779fd5['recipientId']), _0x3d4fff = _0x2a01ac?.[_0x46ae04(0x8fa)] ? _0x2a01ac[_0x46ae04(0x8fa)] + '的转账' : '转账', _0x331ab2 = _0xc0cc8f?.[_0x46ae04(0x8fa)] ? _0x46ae04(0x402) + _0xc0cc8f[_0x46ae04(0x8fa)] : '转账', _0x26bc8c = _0x46ae04(0x58f) + _0x3d4fff + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥' + _0xb7e736[_0x46ae04(0x621)][_0x46ae04(0x874)](0x2) + _0x46ae04(0x2df) + _0x331ab2 + _0x46ae04(0x671); _0x13ee31[_0x46ae04(0x978)] = _0x26bc8c; } } const _0x2f4751 = { 'role': _0x46ae04(0x75d), 'type': _0x46ae04(0x513), 'content': _0x46ae04(0x314) + _0x3c5ca5['songName'] + _0x46ae04(0x33b) + _0x3c5ca5[_0x46ae04(0x816)] + ']', 'songName': _0x3c5ca5[_0x46ae04(0x27a)], 'artist': _0x3c5ca5['artist'], 'coverUrl': _0x525082, 'playableUrl': _0x1e6eb9[_0x46ae04(0x6b8)], 'timestamp': Date['now']() }; _0x4d4ca5[_0x46ae04(0x28d)]['push'](_0x2f4751), _0x59e704(_0x2f4751, _0x4d4ca5[_0x46ae04(0x28d)][_0x46ae04(0x2bd)] - 0x1), _0x521ac4(); } else { const _0x59cc2f = _0x620475['value']; _0x37a148[_0x46ae04(0x966)][_0x46ae04(0x645)]['setProperty']('--primary-hue', _0x59cc2f), _0x1090e0[_0x46ae04(0x598)]('themeHue', _0x59cc2f), _0x10507f(); } } catch (_0x5b6d83) { _0x46ae04(0x1a5) !== _0x46ae04(0x1a5) ? _0x2446e9 = {} : (console[_0x46ae04(0x93a)](_0x46ae04(0x996), _0x5b6d83), _0x589297(_0x46ae04(0x420) + _0x5b6d83[_0x46ae04(0x6a1)])); } } function _0x37fddc(_0x20633b, _0x3853d3 = 0x78) { const _0x27abd0 = _0xe2e12e; if (_0x27abd0(0x84f) !== _0x27abd0(0x67d)) { const _0x17d941 = _0xe5eb0d => { const _0x51be9d = _0x27abd0; if (_0x51be9d(0x865) === _0x51be9d(0x865)) { if (_0xe5eb0d[_0x51be9d(0x3f7)] === _0x51be9d(0x75d)) return _0x4d4ca5[_0x51be9d(0x473)]?.['name'] || 'User'; if (_0xe5eb0d[_0x51be9d(0x6bd)]) { if (_0x51be9d(0x394) === _0x51be9d(0x682)) { const _0x4fb34f = _0x51be9d(0x201) + _0x22ffe0['id'], _0x1117f4 = _0x51be9d(0x65e) + _0x393666['id'], _0x11d742 = _0x4afdc8[_0x51be9d(0x745)](_0x4fb34f); _0x11d742 && (_0x40da95[_0x51be9d(0x598)](_0x1117f4, _0x11d742), _0x43cfbb['removeItem'](_0x4fb34f)); } else { const _0x3a3614 = _0x53bcef(_0xe5eb0d[_0x51be9d(0x6bd)]); return _0x3a3614?.[_0x51be9d(0x8fa)] || _0x51be9d(0x1fa); } } if (_0x20633b?.['type'] === _0x51be9d(0x17c)) { const _0x1395bb = _0x53bcef(_0x20633b[_0x51be9d(0x836)][0x0]); return _0x1395bb?.[_0x51be9d(0x8fa)] || 'AI'; } return 'Assistant'; } else _0x40c0d8('有\x20' + _0x5936ce + _0x51be9d(0x14f)); }, _0xe49477 = _0x4d4ca5['conversationHistory'][_0x27abd0(0x61e)](-_0x3853d3), _0x45e446 = []; for (const _0x30b4e4 of _0xe49477) { if (_0x30b4e4['displayUrl']) _0x27abd0(0x999) !== _0x27abd0(0x422) ? _0x45e446[_0x27abd0(0x956)]('[' + _0x17d941(_0x30b4e4) + ']\x20[sticker:' + (_0x30b4e4[_0x27abd0(0x7af)]?.[_0x27abd0(0x199)](/：(.+?)]/)?.[0x1] || '表情') + ']') : (_0x4478f9['error'](_0x27abd0(0x4e9), _0x372201), _0x254566(_0x27abd0(0x82a))); else { if (_0x30b4e4['image']) { const _0x21a45d = _0x30b4e4['content'] ? '\x20' + _0x30b4e4[_0x27abd0(0x7af)] : ''; _0x45e446[_0x27abd0(0x956)]('[' + _0x17d941(_0x30b4e4) + _0x27abd0(0x2d7) + _0x21a45d); } else _0x30b4e4[_0x27abd0(0x7af)] && _0x45e446[_0x27abd0(0x956)]('[' + _0x17d941(_0x30b4e4) + ']\x20' + _0x30b4e4[_0x27abd0(0x7af)]); } } return _0x45e446['join']('\x0a'); } else return _0x552834(_0x141672)['then'](_0x3090cc => _0x3090cc['blob']()); } function _0x3af941(_0x20b75a, _0x35ad57) { const _0x1d734b = _0xe2e12e; if (!_0x20b75a || !_0x35ad57) return null; const _0x10de56 = _0x35ad57[_0x1d734b(0x199)](/@([^\s:：,，。!?]+)/); if (!_0x10de56) return null; const _0x40d04d = _0x10de56[0x1][_0x1d734b(0x5f0)](); for (const _0x4e9cbe of _0x20b75a[_0x1d734b(0x836)]) { const _0x154220 = _0x53bcef(_0x4e9cbe); if (!_0x154220?.['name']) continue; if (_0x154220[_0x1d734b(0x8fa)][_0x1d734b(0x5f0)]() === _0x40d04d) return _0x154220; if (_0x154220['name']['toLowerCase']()[_0x1d734b(0x245)](_0x40d04d)) return _0x154220; } return null; } function _0x1829b9(_0x3c9e53) { const _0x16cf5c = _0xe2e12e; if ('JQIQm' === _0x16cf5c(0x638)) { const _0x1cebfa = _0x3c9e53[_0x16cf5c(0x99e)]('{'), _0x2db93c = _0x3c9e53[_0x16cf5c(0x55a)]('}'); if (_0x1cebfa >= 0x0 && _0x2db93c > _0x1cebfa) return _0x3c9e53['slice'](_0x1cebfa, _0x2db93c + 0x1); return _0x3c9e53; } else _0x5589fe(_0x16cf5c(0x932)); } function _0x3f9ea2(_0x5d9862, _0x5a056d, _0x57c63a) { const _0x19f8d1 = _0xe2e12e; if (_0x19f8d1(0x624) !== 'HKooC') { const _0x56f449 = new Map(_0x5a056d[_0x19f8d1(0x82d)](_0x128de9 => [String(_0x128de9['id']), _0x128de9])), _0x10420d = _0xe93d78 => String(_0xe93d78 || '')[_0x19f8d1(0x5f0)]()[_0x19f8d1(0x2ce)](/\s+/g, ''), _0x40c47b = new Map(_0x5a056d['map'](_0x1694d9 => [_0x10420d(_0x1694d9[_0x19f8d1(0x8fa)]), _0x1694d9])), _0xd5fbd7 = new Set(_0x57c63a), _0x3600b2 = { 'events': [] }; for (const _0x2b478a of _0x5d9862?.[_0x19f8d1(0x64f)] || []) { if (_0x19f8d1(0x30b) === _0x19f8d1(0x30b)) { const _0x290a78 = _0x2b478a[_0x19f8d1(0x6bd)] ?? _0x2b478a[_0x19f8d1(0x54f)] ?? _0x2b478a['sender_id'] ?? _0x2b478a['speaker'] ?? _0x2b478a[_0x19f8d1(0x3f7)] ?? _0x2b478a[_0x19f8d1(0x8fa)]; if (!_0x290a78) continue; let _0x50f254 = _0x56f449[_0x19f8d1(0x261)](String(_0x290a78)) || _0x40c47b['get'](_0x10420d(_0x290a78)); if (!_0x50f254) continue; const _0x3a6e69 = (_0x2b478a[_0x19f8d1(0x707)] || _0x2b478a[_0x19f8d1(0x327)] || _0x19f8d1(0x57b))['toLowerCase'](); if (_0x3a6e69 === _0x19f8d1(0x4cd)) { const _0x24366f = (_0x2b478a[_0x19f8d1(0x4cd)] ?? _0x2b478a['emoji'] ?? _0x2b478a[_0x19f8d1(0x58c)] ?? _0x2b478a['tag'])?.[_0x19f8d1(0x163)](); if (_0x24366f && _0xd5fbd7[_0x19f8d1(0x166)](_0x24366f)) { if (_0x19f8d1(0x7ff) !== _0x19f8d1(0x59e)) _0x3600b2[_0x19f8d1(0x64f)][_0x19f8d1(0x956)]({ 'senderId': _0x50f254['id'], 'kind': _0x19f8d1(0x4cd), 'sticker': _0x24366f }); else { _0x34d4aa[_0x19f8d1(0x41f)] = null, _0x116bea(), _0x36dead(![]), _0x3c9c7c['getElementById'](_0x19f8d1(0x558))['style'][_0x19f8d1(0x21c)] = ''; return; } } else { if (_0x19f8d1(0x684) === _0x19f8d1(0x990)) { const _0x15dd18 = _0x407c08[_0x19f8d1(0x82b)]('p'); _0x15dd18[_0x19f8d1(0x806)] = _0x3ab1bf[_0x19f8d1(0x57b)], _0x15dd18['id'] = 'lyric-line-' + _0xd9563b, _0x2b6b72['appendChild'](_0x15dd18); } else { const _0x141638 = String(_0x2b478a[_0x19f8d1(0x7af)] ?? _0x2b478a[_0x19f8d1(0x57b)] ?? '')['trim']() || '[sticker:' + (_0x24366f || _0x19f8d1(0x2fd)) + ']'; if (_0x141638) _0x3600b2[_0x19f8d1(0x64f)][_0x19f8d1(0x956)]({ 'senderId': _0x50f254['id'], 'kind': _0x19f8d1(0x57b), 'content': _0x141638 }); } } } else { if (_0x19f8d1(0x2f4) !== _0x19f8d1(0x2f4)) { const _0x1d6017 = _0x20018e['indexOf']('{'), _0x4104a0 = _0x65f497[_0x19f8d1(0x55a)]('}'); if (_0x1d6017 >= 0x0 && _0x4104a0 > _0x1d6017) return _0x4d5376['slice'](_0x1d6017, _0x4104a0 + 0x1); return _0x44e49b; } else { const _0xdc166f = String(_0x2b478a[_0x19f8d1(0x7af)] ?? _0x2b478a[_0x19f8d1(0x57b)] ?? _0x2b478a[_0x19f8d1(0x6a1)] ?? '')[_0x19f8d1(0x163)](); if (_0xdc166f) _0x3600b2['events'][_0x19f8d1(0x956)]({ 'senderId': _0x50f254['id'], 'kind': 'text', 'content': _0xdc166f }); } } } else { _0x34ff95('我正在说话呢，别打岔！'); return; } } return _0x3600b2; } else _0x23304b = _0x2935f0[_0x19f8d1(0x82b)](_0x19f8d1(0x46f)), _0xaf6ec3[_0x19f8d1(0x255)] = _0x19f8d1(0x619), _0x34ddce[_0x19f8d1(0x806)] = '对方正在输入...', _0xf18fc[_0x19f8d1(0x54e)](_0x5d0071); } async function _0x1ee6c8(_0x2651bd) { const _0x18a5bd = _0xe2e12e; if (!_0x2651bd || !Array[_0x18a5bd(0x189)](_0x2651bd[_0x18a5bd(0x64f)]) || _0x2651bd[_0x18a5bd(0x64f)][_0x18a5bd(0x2bd)] === 0x0) return; const _0x46696e = _0x57ff49 => _0x57ff49 + Math[_0x18a5bd(0x54d)](Math['random']() * 0x190); let _0xbf3568 = 0x1f4; for (const _0x17a661 of _0x2651bd[_0x18a5bd(0x64f)]) { if ('qNBtv' === _0x18a5bd(0x6e4)) { await new Promise(_0x418248 => setTimeout(_0x418248, _0x46696e(_0xbf3568))), _0xbf3568 += 0x2bc; const _0x36edf5 = _0x4d4ca5[_0x18a5bd(0x28d)]['at'](-0x1)?.['isOffline'] ?? ![]; if (_0x17a661[_0x18a5bd(0x707)] === _0x18a5bd(0x4cd)) { const _0x56c049 = _0x2e6858[_0x18a5bd(0x5a8)](_0x1a1a7f => _0x1a1a7f['name'] === _0x17a661[_0x18a5bd(0x4cd)]); if (_0x56c049) { if ('IMsuA' === _0x18a5bd(0x972)) _0x333849['innerHTML'] = _0x18a5bd(0x75b) + _0x27b25f + '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>'; else { const _0x1735ca = { 'role': _0x18a5bd(0x832), 'content': '[AI发送了表情：' + _0x56c049['name'] + ']', 'displayUrl': _0x56c049[_0x18a5bd(0x6b8)], 'senderId': _0x17a661[_0x18a5bd(0x6bd)], 'timestamp': Date[_0x18a5bd(0x661)](), 'isOffline': _0x36edf5 }; _0x4d4ca5['conversationHistory']['push'](_0x1735ca); } } } else { if (_0x17a661[_0x18a5bd(0x707)] === 'music' && _0x17a661[_0x18a5bd(0x27a)] && _0x17a661[_0x18a5bd(0x816)]) { if (_0x18a5bd(0x306) === 'ERDyF') { const _0x256e99 = _0x433373[_0x18a5bd(0x6bd)] ? _0x1aecab(_0x330deb[_0x18a5bd(0x6bd)]) : null; return _0x256e99?.[_0x18a5bd(0x8fa)] || _0x18a5bd(0x1fa); } else { const { songName: _0x294dc5, artist: _0x44e75c } = _0x17a661, _0x361abe = { 'role': 'assistant', 'type': 'music', 'content': _0x18a5bd(0x51e) + _0x294dc5 + '\x20-\x20' + _0x44e75c + ']', 'songName': _0x294dc5, 'artist': _0x44e75c, 'senderId': _0x17a661[_0x18a5bd(0x6bd)], 'timestamp': Date['now'](), 'isOffline': _0x36edf5 }; try { if (_0x18a5bd(0x48e) !== _0x18a5bd(0x48e)) _0x55d46e = _0x1c36b6[_0x18a5bd(0x288)][0x0]['clientX'], _0x474579 = _0x5ea2b1[_0x18a5bd(0x288)][0x0][_0x18a5bd(0x555)], _0x3a3eb7 = !![], _0xd0fb7 = ''; else { const _0x59d652 = await _0x51dab6(_0x294dc5, _0x44e75c); _0x361abe[_0x18a5bd(0x378)] = _0x59d652[_0x18a5bd(0x2b6)], _0x361abe['playableUrl'] = _0x59d652[_0x18a5bd(0x6b8)]; } } catch (_0x3e7951) { console['error'](_0x18a5bd(0x7f0) + _0x294dc5 + _0x18a5bd(0x33b) + _0x44e75c + '):', _0x3e7951), _0x361abe[_0x18a5bd(0x378)] = null, _0x361abe[_0x18a5bd(0x151)] = null; } _0x4d4ca5[_0x18a5bd(0x28d)]['push'](_0x361abe); } } else { if (_0x17a661[_0x18a5bd(0x707)] === _0x18a5bd(0x57b)) { const _0x398622 = _0x3479c2(_0x17a661['content'])['slice'](0x0, 0x3); for (let _0x28bf25 = 0x0; _0x28bf25 < _0x398622['length']; _0x28bf25++) { if (_0x28bf25 > 0x0) await new Promise(_0x21f3dc => setTimeout(_0x21f3dc, _0x46696e(0x190))); const _0x24c4d9 = { 'role': _0x18a5bd(0x832), 'content': _0x398622[_0x28bf25], 'senderId': _0x17a661['senderId'], 'timestamp': Date[_0x18a5bd(0x661)](), 'isOffline': _0x36edf5 }; _0x4d4ca5[_0x18a5bd(0x28d)][_0x18a5bd(0x956)](_0x24c4d9); } } } } } else { _0x1d7011[_0x18a5bd(0x547)][_0x18a5bd(0x800)] = _0x489024[_0x18a5bd(0x135)]['trim'](), _0x44b305['apiSettings'][_0x18a5bd(0x8c3)] = _0x263165[_0x18a5bd(0x135)][_0x18a5bd(0x163)](), _0x5305d9['apiSettings'][_0x18a5bd(0x83d)] = _0x58ddca['value'][_0x18a5bd(0x163)](), _0x39ca85[_0x18a5bd(0x547)]['provider'] = _0x20a3be[_0x18a5bd(0x6c2)](_0x18a5bd(0x2c4))[_0x18a5bd(0x135)]; const _0x253b5e = _0x137f4a(_0xa4dda3[_0x18a5bd(0x135)], 0xa); _0x47177c['preferences'][_0x18a5bd(0x4cb)] = _0x521fd1[_0x18a5bd(0x244)](_0x253b5e) && _0x253b5e > 0x0 ? _0x253b5e : 0x64, _0x5030de(), _0x41bc3b('设置已保存！'); } } _0x521ac4(), _0x1fb306(); } async function _0x4ebae8(_0x4dcf3e, { force: force = ![], delayMs: delayMs = 0x0 } = {}) { const _0x526aff = _0xe2e12e; await new Promise(_0xed48b7 => setTimeout(_0xed48b7, 0xa)); if (!_0x4d4ca5[_0x526aff(0x547)]['endpoint'] || !_0x4d4ca5['apiSettings'][_0x526aff(0x8c3)] || !_0x4d4ca5[_0x526aff(0x547)][_0x526aff(0x83d)]) return _0x589297(_0x526aff(0x3fc)), ![]; const _0x687db8 = _0xa2c8b5(); if (!_0x687db8 || !_0x4dcf3e) return ![]; const _0x65e8c5 = _0x55e5f6(_0x687db8['id']), _0x13aa55 = _0x4d4ca5['conversationHistory']['at'](-0x1)?.[_0x526aff(0x3f7)] === _0x526aff(0x75d); if (!force && !_0x13aa55) return ![]; const _0x109153 = _0x4d4ca5[_0x526aff(0x28d)]['at'](-0x1)?.['isOffline'] ?? ![]; if (delayMs) await new Promise(_0x3d36ec => setTimeout(_0x3d36ec, delayMs)); _0x109153 ? document['getElementById'](_0x526aff(0x6f2))[_0x526aff(0x806)] = _0x526aff(0x535) : _0xb42de9(!![]); let _0x1b275a = ''; const _0x5d6bcf = _0xa2c8b5(); if (_0x5d6bcf?.[_0x526aff(0x5b7)]?.['isActive']) { if ('jcvSx' !== _0x526aff(0x8a0)) { const _0x50afaa = _0x5d6bcf[_0x526aff(0x5b7)], _0x1e26ff = await _0x36a25e(_0x50afaa['songId']); if (_0x1e26ff && _0x1e26ff[_0x526aff(0x8b0)]) { const _0x4f0f68 = _0x4adc13(_0x1e26ff[_0x526aff(0x8b0)]); if (_0x4f0f68[_0x526aff(0x2bd)] > 0x0) { const _0x57bb69 = _0x2c7b55[_0x526aff(0x4c2)]; let _0x2cc843 = -0x1; for (let _0x2b7754 = 0x0; _0x2b7754 < _0x4f0f68[_0x526aff(0x2bd)]; _0x2b7754++) { if ('Xfwri' === _0x526aff(0x32b)) { if (_0x57bb69 >= _0x4f0f68[_0x2b7754][_0x526aff(0x5cf)]) _0x2cc843 = _0x2b7754; else break; } else _0x5db9d7(), _0xaad23c(_0x526aff(0x60d), 'home'); } const _0x51d03b = _0x4f0f68[_0x526aff(0x82d)]((_0x44024d, _0x251fe8) => { const _0x44419d = _0x251fe8 === _0x2cc843 ? '>>\x20' : ''; return '' + _0x44419d + _0x44024d['text']; })['join']('\x0a'); _0x1b275a = (_0x526aff(0x91f) + _0x50afaa['artist'] + '\x20的《' + _0x50afaa[_0x526aff(0x27a)] + _0x526aff(0x8a9) + _0x51d03b + _0x526aff(0x24b))['trim'](); } } } else { if (_0x367acc[_0x526aff(0x2bd)] === 0x0) return; _0x20454c = (_0x20add4 - 0x1 + _0x4820d3[_0x526aff(0x2bd)]) % _0x29268b[_0x526aff(0x2bd)], _0x4b8ab5(_0x39d98a[_0x33007f], _0x56afde); } } let _0x461f9a = '', _0x4a7952 = ''; const _0x2840e1 = _0x4d4ca5['conversationHistory']['length']; if (_0x2840e1 > 0x1) { const _0x38e241 = _0x4d4ca5[_0x526aff(0x28d)][_0x2840e1 - 0x2], _0x560c93 = _0x4d4ca5[_0x526aff(0x28d)][_0x2840e1 - 0x1]; if (_0x38e241[_0x526aff(0x188)] === ![] && _0x560c93[_0x526aff(0x188)] === !![]) _0x526aff(0x773) !== _0x526aff(0x773) ? (_0xee2c3b(), _0x46b271 = null) : _0x4a7952 = _0x526aff(0x74e) + _0x65e8c5[_0x526aff(0x8fa)] + _0x526aff(0x3e9); else { if (_0x38e241[_0x526aff(0x188)] === !![] && _0x560c93[_0x526aff(0x188)] === ![]) { if ('mURTY' !== 'LhLcS') _0x4a7952 = '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“' + _0x65e8c5['name'] + '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。'; else { const _0xc2af3b = _0x5c9eed[_0x526aff(0x3e8)]('--'); _0xc2af3b[_0x526aff(0x2bd)] === 0x2 && _0xc2af3b[0x0]['trim']() && _0xc2af3b[0x1][_0x526aff(0x163)]()['startsWith'](_0x526aff(0x7de)) ? _0x150c20[_0x526aff(0x956)]({ 'name': _0xc2af3b[0x0][_0x526aff(0x163)](), 'url': _0xc2af3b[0x1][_0x526aff(0x163)]() }) : _0x51fc7d++; } } } } if (_0x109153) { const _0x545212 = _0x526aff(0x72f); _0x461f9a = _0x526aff(0x25b) + _0x65e8c5['name'] + _0x526aff(0x3f6) + _0x545212 + _0x526aff(0x3ae) + _0x4dcf3e[_0x526aff(0x8fa)] + _0x526aff(0x37b) + _0x545212 + ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[' + _0x545212 + _0x526aff(0x246); } else _0x526aff(0x2be); const { omniText: _0x37579b } = _0x4a974c(_0x4dcf3e['id'], _0x687db8['id']), _0x6b01a1 = _0x4664bc(), _0x1643c5 = _0x532554(_0x4dcf3e['id']), _0x231890 = typeof _0x1a11dd === _0x526aff(0x338) ? _0x1a11dd[_0x526aff(0x7d4)]('{charName}', _0x4dcf3e[_0x526aff(0x8fa)])['replaceAll'](_0x526aff(0x90d), _0x65e8c5[_0x526aff(0x8fa)] || '用户') : '', _0x15bccd = _0x2e6858[_0x526aff(0x82d)](_0x52659f => _0x52659f['name'])[_0x526aff(0x5cd)](',\x20'); let _0x27c61a = ''; if (_0x4dcf3e[_0x526aff(0x963)] && _0x4dcf3e['linkedWorldBookIds'][_0x526aff(0x2bd)] > 0x0) { const _0x2dbbfd = _0x4dcf3e[_0x526aff(0x963)][_0x526aff(0x82d)](_0x1f4ce6 => _0x4d4ca5[_0x526aff(0x7ea)]['find'](_0x58cac4 => _0x58cac4['id'] === _0x1f4ce6))['filter'](Boolean)[_0x526aff(0x82d)](_0x59726e => _0x526aff(0x3dd) + _0x59726e[_0x526aff(0x8fa)] + '\x0a' + _0x59726e[_0x526aff(0x7af)])[_0x526aff(0x5cd)](''); if (_0x2dbbfd) _0x27c61a = _0x526aff(0x40b) + _0x2dbbfd; } const _0x204ad = _0x65e8c5[_0x526aff(0x7d5)] ? _0x526aff(0x690) + _0x65e8c5[_0x526aff(0x8fa)] + '”的补充信息\x0a' + _0x65e8c5[_0x526aff(0x7d5)] : ''; let _0x3ba1db = ''; const _0x2ad20f = new Date(), _0x1f1a50 = _0x12d6c3(_0x4dcf3e['id']); _0x3ba1db = _0x526aff(0x70c), _0x3ba1db += _0x526aff(0x171) + _0x2ad20f[_0x526aff(0x24f)](_0x526aff(0x2f2), { 'dateStyle': _0x526aff(0x8c7), 'timeStyle': _0x526aff(0x8e0) }) + '\x0a'; if (_0x1f1a50) { if (_0x526aff(0x132) === _0x526aff(0x28c)) { if (_0x40675e['role'] === 'user') return _0x4f2cdf[_0x526aff(0x473)]?.[_0x526aff(0x8fa)] || _0x526aff(0x4f6); if (_0xb211d6['senderId']) { const _0x17c79b = _0x18ff85(_0x5e4e57['senderId']); return _0x17c79b?.[_0x526aff(0x8fa)] || _0x526aff(0x1fa); } if (_0x4c3393?.['type'] === _0x526aff(0x17c)) { const _0x57f296 = _0x2c4746(_0x4dd6ba[_0x526aff(0x836)][0x0]); return _0x57f296?.[_0x526aff(0x8fa)] || 'AI'; } return 'Assistant'; } else { const _0x56e8df = new Date(_0x1f1a50[_0x526aff(0x2c3)]), _0x532171 = _0x6ac2a8(_0x56e8df); _0x3ba1db += _0x526aff(0x609) + _0x532171 + '\x0a'; const _0x59716d = _0x2ad20f[_0x526aff(0x991)](), _0x481657 = _0x56e8df['toDateString'](), _0x45eab2 = new Date(); _0x45eab2[_0x526aff(0x2dd)](_0x2ad20f[_0x526aff(0x9b6)]() - 0x1); const _0x4d05f1 = _0x45eab2[_0x526aff(0x991)](); if (_0x59716d === _0x481657) { const _0x10ade7 = (_0x2ad20f - _0x56e8df) / (0x3e8 * 0x3c); if (_0x10ade7 < 0x3c) { if (_0x526aff(0x582) !== _0x526aff(0x797)) _0x3ba1db += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a'; else { const _0x245269 = _0x5ed5a8(); if (_0x245269[_0x526aff(0x327)] === _0x526aff(0x70e)) { const _0x1f0765 = _0x2a8172['characters'][_0x526aff(0x5a8)](_0x39f1f3 => _0x245269['participantIds']['includes'](_0x39f1f3['id']) && _0x39f1f3[_0x526aff(0x8fa)] === _0x1b395d); if (_0x1f0765) _0x5911bf = _0x1f0765['id']; } } } else _0x526aff(0x56b) !== _0x526aff(0x8f9) ? _0x3ba1db += '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概' + Math[_0x526aff(0x830)](_0x10ade7 / 0x3c) + _0x526aff(0x1bd) : _0x373e60 = _0x720e6c[_0x526aff(0x776)]; } else { if (_0x4d05f1 === _0x481657) { if (_0x526aff(0x264) === _0x526aff(0x264)) _0x3ba1db += '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a'; else { if (_0x526f31[_0x526aff(0x3f7)] === 'user' && _0xe28ddb[_0x526aff(0x776)]) return { 'role': 'user', 'content': [{ 'type': _0x526aff(0x57b), 'text': _0x14c8ff[_0x526aff(0x7af)] || '\x20' }, { 'type': _0x526aff(0x981), 'image_url': { 'url': _0x3ebfc8[_0x526aff(0x776)], 'detail': _0x526aff(0x6de) } }] }; return { 'role': _0x3a7aa4[_0x526aff(0x3f7)], 'content': _0x287f4b[_0x526aff(0x7af)] }; } } else { const _0x5db185 = Math['round']((_0x2ad20f - _0x56e8df) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x3ba1db += '-\x20**对话状态提示**:\x20你们已经有\x20' + _0x5db185 + _0x526aff(0x1b3); } } } } else _0x526aff(0x551) !== _0x526aff(0x551) ? (_0x315c96['getElementById'](_0x526aff(0x23f) + _0x2fdae7 + '-preview')[_0x526aff(0x6c3)] = '', _0xb5c9e[_0x526aff(0x6c2)](_0x526aff(0x23f) + _0x56a569 + _0x526aff(0x7cc))[_0x526aff(0x135)] = '') : _0x3ba1db += _0x526aff(0x2d9); const _0x44ddec = ('\x0a' + _0x461f9a + '\x0a你只扮演【' + _0x4dcf3e[_0x526aff(0x8fa)] + _0x526aff(0x4ce) + _0x4dcf3e['name'] + ':\x22\x20或\x22[' + _0x4dcf3e['name'] + _0x526aff(0x8c1) + _0x15bccd + ']。严禁使用列表之外的任何表情名。\x0a' + _0x231890 + '\x0a')['trim'](), _0x4c62a6 = [{ 'role': _0x526aff(0x449), 'content': _0x44ddec }], _0x50e7e0 = (_0x526aff(0x5e0) + (_0x4dcf3e['persona'] || _0x526aff(0x53e)) + '\x0a' + _0x204ad + '\x20\x0a' + _0x37579b + '\x0a' + _0x6b01a1 + '\x0a' + _0x1643c5 + _0x526aff(0x13d) + _0x1b275a + '\x0a' + _0x3ba1db + '\x0a' + _0x27c61a + '\x0a')[_0x526aff(0x163)](); _0x50e7e0[_0x526aff(0x2ce)](/#.*|\s/g, '') && (_0x4c62a6[_0x526aff(0x956)]({ 'role': 'user', 'content': _0x50e7e0 }), _0x4c62a6[_0x526aff(0x956)]({ 'role': _0x526aff(0x832), 'content': _0x526aff(0x642) })); const _0xf3d408 = _0x4d4ca5['preferences']?.[_0x526aff(0x4cb)] ?? 0x64, _0x149a82 = _0x4d4ca5[_0x526aff(0x28d)]['slice'](-_0xf3d408); for (const _0x374b7d of _0x149a82) { const _0x4221d4 = _0x374b7d['role'] === 'ai' || _0x374b7d[_0x526aff(0x3f7)] === _0x526aff(0x832) ? _0x526aff(0x832) : 'user'; let _0x4dc9b7 = { 'role': _0x4221d4, 'content': _0x374b7d[_0x526aff(0x7af)] }, _0x8a617f = !!_0x374b7d[_0x526aff(0x7af)]; if (_0x374b7d[_0x526aff(0x79f)] && _0x374b7d[_0x526aff(0x7af)][_0x526aff(0x407)]('表情')) { if (_0x526aff(0x15b) !== _0x526aff(0x15b)) _0x5752a1 = _0x29775b; else { const _0x167fb9 = _0x374b7d[_0x526aff(0x7af)][_0x526aff(0x199)](/：(.*?)]$/); _0x4dc9b7['content'] = _0x526aff(0x347) + (_0x167fb9 ? _0x167fb9[0x1] : _0x526aff(0x2fd)) + ']', _0x4c62a6[_0x526aff(0x956)](_0x4dc9b7); } } else { if (_0x526aff(0x542) !== _0x526aff(0x542)) { _0x46e917[_0x526aff(0x93a)]('错误：第一个好友圈\x20\x22' + _0xcc5c8c['name'] + _0x526aff(0x68d)); return; } else { let _0x23fd43 = null; if (_0x374b7d['image']) _0x526aff(0x8e3) === _0x526aff(0x258) ? _0x404c25['src'] = _0x59a697[_0x526aff(0x1de)](_0x2477f9) : _0x23fd43 = _0x374b7d[_0x526aff(0x776)]; else { if (_0x374b7d[_0x526aff(0x714)]) { if (_0x526aff(0x3da) !== _0x526aff(0x3da)) _0x73ad87['activeChatId'] = _0x2412f0['id'], _0x4d7178(), _0xb52cc4(), _0x3745d7(_0x4d556f); else try { const _0x5b9146 = await _0x299fa0(_0x374b7d[_0x526aff(0x714)]); _0x5b9146 && (_0x23fd43 = await _0x1ac482(_0x5b9146)); } catch (_0x59d826) { console[_0x526aff(0x93a)](_0x526aff(0x71a), _0x59d826); } } } if (_0x23fd43) { if ('MYXBr' === _0x526aff(0x33d)) { _0x46fa26(_0x526aff(0x463)); return; } else _0x4dc9b7[_0x526aff(0x776)] = _0x23fd43, _0x8a617f = !![]; } if (_0x8a617f) { if ('eXRlb' !== _0x526aff(0x4ed)) _0x4c62a6[_0x526aff(0x956)](_0x4dc9b7); else { _0x42127f('请先在\x22设置\x22中配置你的\x20API\x20信息。'); return; } } } } } try { const _0x321825 = await _0xc7a378(_0x4c62a6); if (!_0x321825) return ![]; if (_0x109153) try { if (_0x526aff(0x6ab) === _0x526aff(0x91d)) { _0x1d4e38['classList']['add']('sticker'); const _0xcf845d = _0x2a4d79[_0x526aff(0x82b)](_0x526aff(0x992)); _0xcf845d[_0x526aff(0x6c3)] = _0x232009, _0xcf845d[_0x526aff(0x970)][_0x526aff(0x68a)](_0x526aff(0x703)), _0x48d605[_0x526aff(0x54e)](_0xcf845d); } else { let _0x56a939 = _0x321825['trim'](); const _0x45ea2f = _0x56a939[_0x526aff(0x199)](/(\[[\s\S]*\])/); _0x45ea2f && (_0x526aff(0x548) !== 'qHyaR' ? _0x56a939 = _0x45ea2f[0x1] : _0x5e5518(_0x526aff(0x67a) + _0x113d42['message'])); const _0x4c20b8 = JSON['parse'](_0x56a939); if (Array[_0x526aff(0x189)](_0x4c20b8)) { _0x4d4ca5[_0x526aff(0x295)] = _0x4c20b8, _0x4d4ca5[_0x526aff(0x937)][_0x4dcf3e['id']] = [..._0x4c20b8], _0x5270ed(); const _0x17d1cd = _0x4c20b8[_0x526aff(0x82d)](_0x453ed8 => _0x453ed8[_0x526aff(0x23c)] === _0x526aff(0x8d3) ? _0x453ed8[_0x526aff(0x6aa)] : _0x453ed8[_0x526aff(0x23c)] + ':\x20' + _0x453ed8[_0x526aff(0x6aa)])[_0x526aff(0x5cd)]('\x0a\x0a'); _0x4d4ca5[_0x526aff(0x28d)]['push']({ 'role': _0x526aff(0x832), 'senderId': _0x4dcf3e['id'], 'timestamp': Date['now'](), 'isOffline': !![], 'content': _0x17d1cd }); } } } catch (_0xc60500) { console[_0x526aff(0x93a)]('解析AI剧本JSON失败:', _0xc60500, _0x526aff(0x845), _0x321825), _0x4d4ca5['conversationHistory'][_0x526aff(0x956)]({ 'role': _0x526aff(0x832), 'senderId': _0x4dcf3e['id'], 'timestamp': Date[_0x526aff(0x661)](), 'isOffline': !![], 'content': _0x526aff(0x995) + _0x321825 + ']' }); } else { const _0x541b5d = _0x3e6624(_0x321825), _0x5a8df0 = _0x541b5d['map'](_0x19e377 => { const _0x2eeeda = _0x526aff; if (_0x2eeeda(0x828) === _0x2eeeda(0x8bb)) _0xd7e915 = _0x478282['at'](-0x1); else { const _0x5b5ef2 = _0x19e377[_0x2eeeda(0x163)](), _0xcb6da9 = _0x5b5ef2[_0x2eeeda(0x199)](/^\[sticker:(.*?)\]$/), _0xc3724b = _0x5b5ef2[_0x2eeeda(0x199)](/^\[transfer:([\d.]+)\|(.*?)\]$/), _0x507328 = _0x5b5ef2[_0x2eeeda(0x199)](/^\[music:(.*?)\|(.*?)\]$/); if (_0x507328) { if (_0x2eeeda(0x26c) !== 'bOjGI') return { 'type': _0x2eeeda(0x513), 'songName': _0x507328[0x1][_0x2eeeda(0x163)](), 'artist': _0x507328[0x2][_0x2eeeda(0x163)]() }; else _0x2ff550[_0x2eeeda(0x970)][_0x2eeeda(0x68a)](_0x2eeeda(0x68c)), _0x3662b8[_0x2eeeda(0x9a8)]({ 'behavior': _0x2eeeda(0x554), 'block': _0x2eeeda(0x89e) }); } else { if (_0xcb6da9) return { 'type': _0x2eeeda(0x4cd), 'name': _0xcb6da9[0x1][_0x2eeeda(0x163)]() }; else { if (_0xc3724b) { const _0x2f4071 = parseFloat(_0xc3724b[0x1]), _0x5b6a7c = _0xc3724b[0x2]['trim'](), _0x5968c4 = _0x55e5f6(_0x4d4ca5[_0x2eeeda(0x41f)]); let _0x3d1481 = null; if (_0x5b6a7c === _0x5968c4[_0x2eeeda(0x8fa)]) _0x2eeeda(0x6c8) === _0x2eeeda(0x24e) ? (_0x39ee4c['style']['color'] = _0x2eeeda(0x85f), _0x109f3e[_0x2eeeda(0x645)]['textShadow'] = '0\x202px\x208px\x20rgba(0,0,0,0.4)') : _0x3d1481 = _0x5968c4['id']; else { const _0x49c8bf = _0xa2c8b5(); if (_0x49c8bf[_0x2eeeda(0x327)] === 'group') { const _0x4bf9f6 = _0x4d4ca5['characters'][_0x2eeeda(0x5a8)](_0x16e9b2 => _0x49c8bf[_0x2eeeda(0x836)]['includes'](_0x16e9b2['id']) && _0x16e9b2[_0x2eeeda(0x8fa)] === _0x5b6a7c); if (_0x4bf9f6) _0x3d1481 = _0x4bf9f6['id']; } } if (_0x3d1481) return { 'type': 'transfer', 'amount': _0x2f4071, 'recipientId': _0x3d1481, 'senderId': _0x4dcf3e['id'] }; else return { 'type': 'text', 'content': _0x2eeeda(0x69a) + _0x5b6a7c + '”，但没找到人)' }; } else { if (_0x5b5ef2) return { 'type': 'text', 'content': _0x5b5ef2 }; } } } return null; } })[_0x526aff(0x5fe)](Boolean), _0x23c4fb = async _0x55bd80 => { const _0x1f2977 = _0x526aff; if (_0x1f2977(0x4a3) === 'hHPXE') { const _0x4bcf9d = { 'role': _0x1f2977(0x832), 'senderId': _0x4dcf3e['id'], 'timestamp': Date[_0x1f2977(0x661)](), 'isOffline': _0x109153 }; if (_0x55bd80[_0x1f2977(0x327)] === _0x1f2977(0x513)) { const { songName: _0x2217dd, artist: _0x9112c8 } = _0x55bd80; _0x4bcf9d[_0x1f2977(0x327)] = _0x1f2977(0x513), _0x4bcf9d['content'] = '[AI分享了音乐：' + _0x2217dd + _0x1f2977(0x33b) + _0x9112c8 + ']'; try { if (_0x1f2977(0x5f9) !== 'GrjoX') { const _0x21be45 = _0x5cd5cc[_0x1f2977(0x135)][_0x1f2977(0x163)](); _0x21be45 && (_0x474ecd(_0x21be45), _0x13bf0a[_0x1f2977(0x135)] = '', _0x8f084d(_0x1ec1b4, 0x64)); } else { const _0x155c40 = await _0x51dab6(_0x2217dd, _0x9112c8); let _0x366da2 = null; if (_0x155c40['cover']) { if (_0x1f2977(0x3df) === _0x1f2977(0x3df)) { const _0x5703dd = await _0x1679a8(_0x155c40[_0x1f2977(0x2b6)]); _0x366da2 = _0x1f2977(0x5ba) + Date[_0x1f2977(0x661)]() + '_' + Math['random'](), await _0x34f697(_0x366da2, _0x5703dd); } else { const _0x48500f = new _0x5b7523(), _0x4c2ec4 = _0x536801[_0x1f2977(0x6c2)](_0x1f2977(0x6cd)), _0x5e9162 = _0x333657['getElementById'](_0x1f2977(0x579)); if (_0x4c2ec4 && _0x5e9162) { const _0x1d762d = _0x5f513e(_0x48500f[_0x1f2977(0x368)]())[_0x1f2977(0x522)](0x2, '0'), _0x247a29 = _0x4791f6(_0x48500f[_0x1f2977(0x37e)]())[_0x1f2977(0x522)](0x2, '0'); _0x4c2ec4['textContent'] = _0x1d762d + ':' + _0x247a29; const _0x4634e1 = _0x48500f[_0x1f2977(0x719)]() + 0x1, _0x528bd8 = _0x48500f[_0x1f2977(0x9b6)](), _0x250da5 = [_0x1f2977(0x353), _0x1f2977(0x343), _0x1f2977(0x711), '星期三', _0x1f2977(0x5bc), '星期五', '星期六'][_0x48500f['getDay']()]; _0x5e9162[_0x1f2977(0x806)] = _0x4634e1 + '月' + _0x528bd8 + '日\x20' + _0x250da5; } } } Object[_0x1f2977(0x71b)](_0x4bcf9d, { 'songName': _0x2217dd, 'artist': _0x9112c8, 'coverId': _0x366da2, 'playableUrl': _0x155c40[_0x1f2977(0x6b8)] }); } } catch (_0x38123d) { Object['assign'](_0x4bcf9d, { 'songName': _0x2217dd, 'artist': _0x9112c8, 'coverId': null, 'playableUrl': null }); } } else { if (_0x55bd80[_0x1f2977(0x327)] === _0x1f2977(0x4cd)) { const _0x16bda8 = _0x2e6858[_0x1f2977(0x5a8)](_0x5cd7d8 => _0x5cd7d8[_0x1f2977(0x8fa)] === _0x55bd80[_0x1f2977(0x8fa)]); if (_0x16bda8) Object[_0x1f2977(0x71b)](_0x4bcf9d, { 'content': '[AI发送了表情：' + _0x16bda8['name'] + ']', 'displayUrl': _0x16bda8[_0x1f2977(0x6b8)] }); else _0x4bcf9d['content'] = '[sticker:' + _0x55bd80['name'] + ']'; } else { if (_0x55bd80[_0x1f2977(0x327)] === _0x1f2977(0x527)) { const _0x4d8517 = _0x55bd80['recipientId'] === _0x55e5f6(_0x4d4ca5['activeChatId'])['id'] ? _0x55e5f6(_0x4d4ca5[_0x1f2977(0x41f)]) : _0x53bcef(_0x55bd80['recipientId']); Object['assign'](_0x4bcf9d, { 'type': _0x1f2977(0x527), 'amount': _0x55bd80[_0x1f2977(0x621)], 'recipientId': _0x55bd80[_0x1f2977(0x241)], 'content': '[AI向\x20' + (_0x4d8517?.[_0x1f2977(0x8fa)] || '未知') + _0x1f2977(0x333) + _0x55bd80['amount'] + ']' }); } else { const _0x40fd39 = _0x216338(_0x55bd80[_0x1f2977(0x7af)]); Object['assign'](_0x4bcf9d, { 'content': _0x40fd39[_0x1f2977(0x7af)], 'quotedMessage': _0x40fd39[_0x1f2977(0x177)] }); } } } return _0x4bcf9d; } else { const _0x44d106 = { 'id': _0x539f1a['id'], 'url': _0x73a2f2[_0x1f2977(0x151)] }; _0x30c64e(this, _0x44d106); } }, _0x464c04 = await Promise[_0x526aff(0x721)](_0x5a8df0[_0x526aff(0x82d)](_0x23c4fb)); for (const _0x2b4f7a of _0x464c04) { (_0x2b4f7a[_0x526aff(0x7af)] || _0x2b4f7a[_0x526aff(0x79f)] || _0x2b4f7a[_0x526aff(0x327)] === _0x526aff(0x513)) && (_0x526aff(0x2ec) !== _0x526aff(0x2ec) ? _0x27cb9f && _0x55001d(_0x5ee3b4) : (await new Promise(_0x402378 => setTimeout(_0x402378, 0x12c + Math[_0x526aff(0x4e7)]() * 0x190)), _0x4d4ca5[_0x526aff(0x28d)][_0x526aff(0x956)](_0x2b4f7a), _0x1fb306())); } } return _0x521ac4(), _0x1fb306(), !![]; } catch (_0x265695) { if (_0x265695[_0x526aff(0x8fa)] !== _0x526aff(0x33a)) { if (_0x526aff(0x4dc) !== _0x526aff(0x40f)) { console['error']('生成失败:\x20', _0x265695); const _0x42a6d4 = { 'role': 'assistant', 'content': '错误:\x20' + _0x265695[_0x526aff(0x6a1)], 'senderId': _0x4dcf3e['id'], 'isOffline': _0x109153 }; _0x4d4ca5[_0x526aff(0x28d)][_0x526aff(0x956)](_0x42a6d4), _0x1fb306(); } else _0x5e2ebc = _0x199709[_0x526aff(0x963)][_0x526aff(0x82d)](_0x98af76 => _0x4ca5a4[_0x526aff(0x7ea)][_0x526aff(0x5a8)](_0x54105f => _0x54105f['id'] === _0x98af76))[_0x526aff(0x5fe)](_0x3c3409)['map'](_0x2d56bd => _0x526aff(0x730) + _0x2d56bd['name'] + _0x526aff(0x80f) + _0x2d56bd[_0x526aff(0x7af)])[_0x526aff(0x5cd)](''); } return ![]; } finally { _0xb42de9(![]); } } async function _0x3c9ae2() { const _0x2471f3 = _0xe2e12e, _0x1fa8c0 = _0xa2c8b5(); if (!_0x1fa8c0 || _0x1fa8c0[_0x2471f3(0x327)] !== _0x2471f3(0x17c)) { _0x589297('哼，只有私聊才能进行总结，群聊那么乱怎么记！'); return; } if (_0x4d4ca5[_0x2471f3(0x9b9)]) { if (_0x2471f3(0x77a) === _0x2471f3(0x876)) _0x2150dd = _0x2d49be; else { _0x589297('我正在说话呢，别打岔！'); return; } } const _0x59bda5 = await _0x385a44('确定要对本次会话进行总结吗？这会消耗不少资源，并且会读取完整的聊天记录。'); if (!_0x59bda5) return; _0x3145a8(!![], _0x2471f3(0x7b2)), _0x1750be[_0x2471f3(0x135)] = '', _0x315f79[_0x2471f3(0x970)][_0x2471f3(0x68a)](_0x2471f3(0x3a7)), _0x4d4ca5[_0x2471f3(0x9b9)] = !![]; try { const _0x1376b9 = _0x53bcef(_0x1fa8c0[_0x2471f3(0x836)][0x0]), _0x480792 = _0x55e5f6(_0x1fa8c0['id']), _0x5f34ad = _0x4603a4(_0x1fa8c0['id']); if (_0x5f34ad[_0x2471f3(0x2bd)] === 0x0) { _0x1750be[_0x2471f3(0x135)] = _0x2471f3(0x881); return; } const _0xd8d69d = _0x5f34ad['map'](_0x5997d1 => { const _0x5cab38 = _0x2471f3, _0x2fa561 = new Date(_0x5997d1[_0x5cab38(0x2c3)]), _0x138ab0 = _0x2fa561[_0x5cab38(0x196)]() + '-' + String(_0x2fa561[_0x5cab38(0x719)]() + 0x1)[_0x5cab38(0x522)](0x2, '0') + '-' + String(_0x2fa561[_0x5cab38(0x9b6)]())[_0x5cab38(0x522)](0x2, '0'), _0x122f72 = String(_0x2fa561[_0x5cab38(0x368)]())['padStart'](0x2, '0') + ':' + String(_0x2fa561[_0x5cab38(0x37e)]())[_0x5cab38(0x522)](0x2, '0'); let _0x3a2db6 = '未知'; _0x5997d1['role'] === 'user' ? _0x3a2db6 = _0x480792[_0x5cab38(0x8fa)] : _0x3a2db6 = _0x1376b9[_0x5cab38(0x8fa)]; let _0x4ff892 = _0x5997d1['content']; if (_0x5997d1[_0x5cab38(0x79f)]) _0x4ff892 = _0x5cab38(0x160); if (_0x5997d1[_0x5cab38(0x714)]) _0x4ff892 = _0x5cab38(0x5df); return '[' + _0x138ab0 + '\x20' + _0x122f72 + ']\x20[' + _0x3a2db6 + _0x5cab38(0x80f) + _0x4ff892; })['join']('\x0a'), _0x471c6d = _0x80254a[_0x2471f3(0x2ce)](/{charName}/g, _0x1376b9[_0x2471f3(0x8fa)])[_0x2471f3(0x2ce)](/{userName}/g, _0x480792[_0x2471f3(0x8fa)]), _0x442342 = [{ 'role': 'system', 'content': _0x471c6d }, { 'role': _0x2471f3(0x75d), 'content': _0xd8d69d }], _0x537de6 = await _0xc7a378(_0x442342); _0x1750be[_0x2471f3(0x135)] = _0x537de6 || _0x2471f3(0x72b), _0x1750be[_0x2471f3(0x145)] = 0x0; } catch (_0x2fa8c2) { console[_0x2471f3(0x93a)](_0x2471f3(0x97e), _0x2fa8c2), _0x1750be[_0x2471f3(0x135)] = _0x2471f3(0x13b) + _0x2fa8c2[_0x2471f3(0x6a1)]; } finally { 'fEFeD' !== _0x2471f3(0x2c6) ? (_0x3145a8(![]), _0x4d4ca5[_0x2471f3(0x9b9)] = ![]) : _0x4e74ca[_0x2471f3(0x645)]['textShadow'] = ''; } } async function _0x52ef2f() { const _0x40375b = _0xe2e12e; console[_0x40375b(0x39f)](_0x40375b(0x577)); if (!_0x4d4ca5[_0x40375b(0x547)][_0x40375b(0x800)] || !_0x4d4ca5[_0x40375b(0x547)][_0x40375b(0x8c3)] || !_0x4d4ca5[_0x40375b(0x547)][_0x40375b(0x83d)]) { _0x589297(_0x40375b(0x3fc)); return; } const _0x147c00 = _0x4d4ca5[_0x40375b(0x28d)]['at'](-0x1)?.[_0x40375b(0x3f7)] === 'user'; if (!_0x147c00 || _0x4d4ca5[_0x40375b(0x9b9)]) return; const _0x27a936 = _0xa2c8b5(); if (!_0x27a936) return; _0x4d4ca5['isGenerating'] = !![], _0xb42de9(!![]); try { if (_0x27a936[_0x40375b(0x327)] === _0x40375b(0x17c)) { const _0xd21640 = _0x53bcef(_0x27a936[_0x40375b(0x836)][0x0]); console['log']('准备调用\x20generateAs...'); if (_0xd21640) await _0x4ebae8(_0xd21640, { 'force': !![] }); } else { if (_0x40375b(0x7aa) !== _0x40375b(0x22c)) { const _0x3ef409 = await _0x2b09b6(); if (_0x3ef409 && _0x3ef409[_0x40375b(0x64f)]?.[_0x40375b(0x2bd)]) _0x40375b(0x613) !== 'CJfdf' ? _0x450487['key'] === _0x40375b(0x161) && !_0x1778c3[_0x40375b(0x80e)] && (_0xe0d0ee[_0x40375b(0x955)](), _0x7983b9()) : await _0x1ee6c8(_0x3ef409); else { if (_0x40375b(0x66d) !== _0x40375b(0x66d)) { const _0x5792a2 = _0xb236aa[_0x40375b(0x82b)](_0x40375b(0x46f)); _0x5792a2[_0x40375b(0x255)] = 'expense-item', _0x5792a2[_0x40375b(0x978)] = _0x40375b(0x5ad) + _0x4dc420[_0x40375b(0x99f)] + _0x40375b(0x838) + _0x33a976[_0x40375b(0x621)][_0x40375b(0x874)](0x2) + _0x40375b(0x50b) + _0x21a694['id'] + '\x22>&times;</button></div>', _0x9629dd['appendChild'](_0x5792a2); } else { console['warn']('Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.'); const _0x455ebe = _0x27a936[_0x40375b(0x836)][_0x40375b(0x82d)](_0x53bcef)['filter'](Boolean); if (!_0x455ebe[_0x40375b(0x2bd)]) return; let _0x20dca1 = 0x0; for (const _0x14d382 of _0x455ebe) { _0x4ebae8(_0x14d382, { 'force': !![], 'delayMs': _0x20dca1 }), _0x20dca1 += 0x1f4; } } } } else _0x2e4e1f(![]); } } catch (_0x18fa8e) { if (_0x18fa8e[_0x40375b(0x8fa)] !== 'AbortError') { if (_0x40375b(0x431) !== _0x40375b(0x779)) console['error'](_0x40375b(0x377), _0x18fa8e), _0x59e704({ 'role': 'assistant', 'content': _0x40375b(0x67a) + _0x18fa8e[_0x40375b(0x6a1)] }, _0x4d4ca5['conversationHistory'][_0x40375b(0x2bd)] - 0x1); else { _0x4c31fe(_0x40375b(0x4bb)); return; } } } finally { _0x4d4ca5['isGenerating'] = ![], _0xb42de9(![]); } } function _0x2e5f14(_0x33d22e, _0x3ad29a) { const _0x371d7d = _0xe2e12e, _0x52ab47 = _0x3ad29a[_0x371d7d(0x5f0)](), _0x433dad = _0x33d22e['toLowerCase'](); if (_0x52ab47['startsWith'](_0x371d7d(0x397))) return _0x371d7d(0x618); if (_0x433dad[_0x371d7d(0x407)](_0x371d7d(0x44c))) return 'anthropic'; if (_0x433dad[_0x371d7d(0x407)](_0x371d7d(0x4f9))) return _0x371d7d(0x309); if (_0x52ab47[_0x371d7d(0x245)](_0x371d7d(0x309))) return _0x371d7d(0x309); return _0x371d7d(0x7df); } async function _0xc7a378(_0x271529, _0x5f3c7c = {}) { const _0x580119 = _0xe2e12e; if ('lOrfJ' !== _0x580119(0x747)) { _0x4d4ca5[_0x580119(0x94e)] && _0x4d4ca5[_0x580119(0x94e)][_0x580119(0x5b0)](_0x580119(0x9a2)); _0x4d4ca5[_0x580119(0x94e)] = new AbortController(); const _0x9c16a5 = _0x4d4ca5[_0x580119(0x94e)][_0x580119(0x869)], { endpoint: _0x5a9ac5, key: _0x102e82, model: _0xd017cc } = _0x4d4ca5[_0x580119(0x547)], _0x2a11ea = !!_0x5f3c7c[_0x580119(0x273)], _0x10418c = _0x2e5f14(_0x5a9ac5, _0xd017cc); console[_0x580119(0x39f)](_0x580119(0x674) + _0x10418c); let _0x4392b1 = ''; try { switch (_0x10418c) { case _0x580119(0x618): { if (_0x580119(0x62c) !== _0x580119(0x3bc)) { const _0x2427df = _0x20e943(_0x102e82), _0x2aa996 = _0x271529[_0x580119(0x5a8)](_0x2e0c26 => _0x2e0c26[_0x580119(0x3f7)] === 'system')?.[_0x580119(0x7af)] || '', _0x1417e9 = _0x271529[_0x580119(0x5fe)](_0xd569e => _0xd569e[_0x580119(0x3f7)] !== 'system'), _0x36ad07 = { 'model': _0xd017cc, 'system': _0x2aa996, 'messages': _0x1417e9[_0x580119(0x82d)](_0x1c208b => ({ 'role': _0x1c208b[_0x580119(0x3f7)], 'content': [{ 'type': _0x580119(0x57b), 'text': _0x1c208b[_0x580119(0x7af)] }] })), 'max_tokens': 0x1000 }, _0xbe86a6 = await fetch(_0x5a9ac5, { 'method': _0x580119(0x71d), 'headers': { 'Content-Type': _0x580119(0x22e), 'x-api-key': _0x2427df, 'anthropic-version': _0x580119(0x3b2) }, 'body': JSON[_0x580119(0x822)](_0x36ad07), 'signal': _0x9c16a5 }); if (!_0xbe86a6['ok']) { const _0x5062ac = await _0xbe86a6['json']()['catch'](() => ({})); throw new Error('Claude\x20API\x20错误:\x20' + _0xbe86a6[_0x580119(0x1cc)] + _0x580119(0x33b) + (_0x5062ac[_0x580119(0x93a)]?.[_0x580119(0x6a1)] || _0xbe86a6['statusText'])); } const _0x511255 = await _0xbe86a6['json'](); _0x4392b1 = _0x511255[_0x580119(0x7af)]?.[0x0]?.[_0x580119(0x57b)] || ''; break; } else _0x22f845[_0x580119(0x152)] = ![], _0x45b1d6[_0x580119(0x806)] = '获取'; } case _0x580119(0x309): { const _0x19d64c = _0x20e943(_0x102e82), _0x40aefd = _0x5a9ac5[_0x580119(0x407)](_0x580119(0x488)), _0x540725 = _0x285d1f => { const _0x3cf178 = _0x580119, _0x235f59 = []; if (_0x285d1f[_0x3cf178(0x7af)]) _0x235f59[_0x3cf178(0x956)]({ 'text': _0x285d1f[_0x3cf178(0x7af)] }); if (_0x285d1f[_0x3cf178(0x776)]) { const _0x5aab61 = _0x285d1f[_0x3cf178(0x776)][_0x3cf178(0x3e8)](',')[0x1], _0x524de7 = _0x285d1f[_0x3cf178(0x776)][_0x3cf178(0x8a1)](_0x285d1f[_0x3cf178(0x776)][_0x3cf178(0x99e)](':') + 0x1, _0x285d1f[_0x3cf178(0x776)]['indexOf'](';')) || _0x3cf178(0x265); _0x235f59['push']({ 'inline_data': { 'mime_type': _0x524de7, 'data': _0x5aab61 } }); } return _0x235f59; }, _0x409e6a = _0x271529[_0x580119(0x82d)](_0x3c7058 => ({ 'role': _0x3c7058[_0x580119(0x3f7)] === _0x580119(0x832) ? 'model' : _0x3c7058[_0x580119(0x3f7)] === _0x580119(0x449) ? _0x580119(0x75d) : _0x3c7058['role'], 'parts': _0x540725(_0x3c7058) }))['filter'](_0x510ef0 => _0x510ef0[_0x580119(0x276)][_0x580119(0x2bd)] > 0x0), _0x320430 = { 'contents': _0x409e6a }; _0x2a11ea && _0x40aefd && (_0x320430[_0x580119(0x73f)] = { 'response_mime_type': _0x580119(0x22e) }); const _0x53c760 = _0x5a9ac5 + _0x580119(0x66b) + _0xd017cc + ':streamGenerateContent?key=' + _0x19d64c + _0x580119(0x324), _0x8292d3 = await fetch(_0x53c760, { 'method': 'POST', 'headers': { 'Content-Type': _0x580119(0x22e) }, 'body': JSON[_0x580119(0x822)](_0x320430), 'signal': _0x9c16a5 }); if (!_0x8292d3['ok']) throw new Error('Gemini\x20API\x20Error:\x20' + _0x8292d3[_0x580119(0x1cc)]); const _0xa9869f = _0x8292d3['body'][_0x580119(0x4db)](), _0x4b163a = new TextDecoder(); let _0x564060 = ''; while (!![]) { if (_0x580119(0x267) === _0x580119(0x267)) { if (_0x9c16a5[_0x580119(0x45c)]) { if ('gUvwA' === _0x580119(0x857)) _0x5ebe33(_0x580119(0x748)); else { console[_0x580119(0x39f)](_0x580119(0x197)), _0xa9869f[_0x580119(0x440)](); break; } } const { done: _0x12b754, value: _0x4be7cd } = await _0xa9869f[_0x580119(0x259)](); if (_0x12b754) break; const _0x1c7a21 = _0x4b163a[_0x580119(0x8f2)](_0x4be7cd, { 'stream': !![] }), _0x196b7f = _0x1c7a21[_0x580119(0x3e8)]('\x0a')[_0x580119(0x5fe)](_0x2a1d75 => _0x2a1d75[_0x580119(0x163)]()[_0x580119(0x245)](_0x580119(0x87a))); for (const _0x3e2e47 of _0x196b7f) { const _0x158c08 = _0x3e2e47[_0x580119(0x2ce)](_0x580119(0x370), ''); if (_0x158c08 === _0x580119(0x892)) break; try { if ('wOwcB' !== _0x580119(0x659)) _0x564060 += JSON[_0x580119(0x213)](_0x158c08)[_0x580119(0x742)][0x0][_0x580119(0x7af)][_0x580119(0x276)][0x0][_0x580119(0x57b)]; else { if (_0x1fb186) _0x20ff43(_0x390e4b); } } catch { } } } else return _0x1e5ced(new _0x3d48ba(_0x580119(0x908))); } _0x4392b1 = _0x564060; break; } case _0x580119(0x7df): default: { if (_0x580119(0x291) !== _0x580119(0x291)) { _0x4f7410('总得说点什么吧？'); return; } else { const _0x1477f6 = _0x20e943(_0x102e82), _0x4cc979 = _0x5a9ac5[_0x580119(0x2ce)](/\/+$/, '') + _0x580119(0x7d2), _0x24a972 = _0x271529[_0x580119(0x82d)](_0x5ef186 => { const _0x3df3d5 = _0x580119; if (_0x3df3d5(0x9b1) === 'jqAeh') { if (!_0x352d97[_0x3df3d5(0x41f)]) return; try { _0x26ed45[_0x3df3d5(0x598)](_0x3df3d5(0x201) + _0x1083dc[_0x3df3d5(0x41f)], _0x3520ea['stringify'](_0x1a191f[_0x3df3d5(0x28d)])); } catch (_0x44afb5) { _0x448668[_0x3df3d5(0x93a)](_0x3df3d5(0x762), _0x44afb5), _0x2a473d(_0x3df3d5(0x356)); } } else { if (_0x5ef186[_0x3df3d5(0x3f7)] === 'user' && _0x5ef186[_0x3df3d5(0x776)]) return { 'role': _0x3df3d5(0x75d), 'content': [{ 'type': _0x3df3d5(0x57b), 'text': _0x5ef186[_0x3df3d5(0x7af)] || '\x20' }, { 'type': _0x3df3d5(0x981), 'image_url': { 'url': _0x5ef186[_0x3df3d5(0x776)], 'detail': 'high' } }] }; return { 'role': _0x5ef186[_0x3df3d5(0x3f7)], 'content': _0x5ef186['content'] }; } })[_0x580119(0x5fe)](_0x96dd42 => _0x96dd42['content']), _0x26559c = { 'model': _0xd017cc, 'messages': _0x24a972, 'max_tokens': 0x1000, ..._0x2a11ea ? { 'response_format': { 'type': _0x580119(0x600) } } : {} }, _0x4359ba = await fetch(_0x4cc979, { 'method': _0x580119(0x71d), 'headers': { 'Content-Type': _0x580119(0x22e), 'Authorization': _0x580119(0x919) + _0x1477f6 }, 'body': JSON[_0x580119(0x822)](_0x26559c), 'signal': _0x9c16a5 }); if (!_0x4359ba['ok']) { if (_0x580119(0x3ed) === _0x580119(0x3ed)) { const _0x208b64 = await _0x4359ba[_0x580119(0x273)]()[_0x580119(0x76c)](() => ({})); throw new Error('OpenAI\x20API\x20错误:\x20' + _0x4359ba[_0x580119(0x1cc)] + _0x580119(0x33b) + (_0x208b64[_0x580119(0x93a)]?.[_0x580119(0x6a1)] || _0x4359ba[_0x580119(0x411)])); } else _0x484c14[_0x580119(0x93a)](_0x580119(0x7f0) + _0x487ff2 + '\x20-\x20' + _0x22fa50 + '):', _0xb3814), _0x887df7['coverUrl'] = null, _0x55ad9f[_0x580119(0x151)] = null; } const _0x21f3c0 = await _0x4359ba[_0x580119(0x273)](); _0x4392b1 = _0x21f3c0[_0x580119(0x957)]?.[0x0]?.[_0x580119(0x6a1)]?.[_0x580119(0x7af)] || ''; break; } } }return _0x4392b1; } catch (_0x53336d) { if (_0x53336d['name'] === 'AbortError') { if (_0x580119(0x916) === _0x580119(0x570)) _0x474c4a && _0x5679b1(_0x1c3a91['id'], _0x530058[_0x580119(0x82d)](_0x327f53 => _0x327f53['id'])); else return console[_0x580119(0x39f)](_0x580119(0x4f7)), ''; } throw _0x53336d; } finally { if (_0x4d4ca5[_0x580119(0x94e)] && _0x4d4ca5['currentAbortController'][_0x580119(0x869)] === _0x9c16a5) { if (_0x580119(0x85a) !== 'JnAbH') _0x4d4ca5['currentAbortController'] = null; else { const _0x5a0ae5 = _0x368dcf[_0x580119(0x213)](_0x3d2fee); _0x3f8f2d[_0x580119(0x189)](_0x5a0ae5) && (_0x3456f0 = _0x5a0ae5['filter'](_0xd9ea2b => _0xd9ea2b && typeof _0xd9ea2b === 'object' && typeof _0xd9ea2b[_0x580119(0x3f7)] === _0x580119(0x338) && typeof _0xd9ea2b[_0x580119(0x7af)] !== 'undefined')); } } } } else { const _0x2ecc98 = _0x17c01f[_0x580119(0x7af)][_0x580119(0x199)](/：(.*?)]$/); _0x4fe922[_0x580119(0x7af)] = _0x580119(0x347) + (_0x2ecc98 ? _0x2ecc98[0x1] : _0x580119(0x2fd)) + ']', _0x1b8c96[_0x580119(0x956)](_0x44f248); } } async function _0x4d35af() { const _0x49e6fd = _0xe2e12e, _0x19f018 = _0x586bbb[_0x49e6fd(0x850)][_0x49e6fd(0x970)]['contains'](_0x49e6fd(0x68c)), _0x28f450 = _0x19f018 ? _0x345646[_0x49e6fd(0x135)] : null; let _0x2fb357 = null, _0x3d313a = ''; if (_0x19f018 && _0x28f450) { _0x2fb357 = _0x4d4ca5[_0x49e6fd(0x53f)][_0x49e6fd(0x5a8)](_0xfb4fb => _0xfb4fb['type'] === _0x49e6fd(0x17c) && _0xfb4fb[_0x49e6fd(0x836)][_0x49e6fd(0x407)](_0x28f450)); const _0x579bc3 = _0x53bcef(_0x28f450); _0x3d313a = _0x579bc3 ? _0x579bc3[_0x49e6fd(0x8fa)] : '该角色'; } else { if (_0x4d4ca5[_0x49e6fd(0x41f)]) { _0x2fb357 = _0xa2c8b5(); const _0x18a287 = document['getElementById'](_0x49e6fd(0x2b2))[_0x49e6fd(0x806)]; _0x3d313a = _0x18a287 || _0x49e6fd(0x13a); } } if (!_0x2fb357) { _0x589297(_0x49e6fd(0x358)); return; } const _0xcba51d = await _0x385a44(_0x49e6fd(0x498) + _0x3d313a + '\x22\x20的聊天记录吗？此操作不可撤销。'); if (!_0xcba51d) return; _0x2fb357['id'] === _0x4d4ca5[_0x49e6fd(0x41f)] && (_0x49e6fd(0x5d6) !== 'geSzh' ? (_0x5e29e2(), _0x4d4ca5[_0x49e6fd(0x28d)] = [], _0x41e9e0()) : !_0x26f772['contains'](_0x4ca274[_0x49e6fd(0x68b)]) && _0x2556ff['target'] !== _0x40a505 && _0x55065c[_0x49e6fd(0x68b)] !== _0x9d2ad8 && _0x54ee3a[_0x49e6fd(0x970)][_0x49e6fd(0x6ae)](_0x49e6fd(0x3a7))); try { localStorage[_0x49e6fd(0x5e7)](_0x49e6fd(0x201) + _0x2fb357['id']); } catch (_0x36f7a3) { console[_0x49e6fd(0x93a)](_0x49e6fd(0x4b5) + _0x2fb357['id'], _0x36f7a3); } _0x589297('\x22' + _0x3d313a + _0x49e6fd(0x5f6)); } const _0x4b9086 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x38e)), _0x17c434 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x2f8)), _0x568ecb = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x13c)); _0x4b9086[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), async () => { const _0xd86cb7 = _0xe2e12e; _0x3145a8(!![], _0xd86cb7(0x318)); const _0x448e49 = []; try { const _0x3741ff = { 'localStorageData': {}, 'indexedDBData': {}, 'indexedDBMusicData': [] }; for (let _0x1da483 = 0x0; _0x1da483 < localStorage[_0xd86cb7(0x2bd)]; _0x1da483++) { const _0xed0743 = localStorage[_0xd86cb7(0x8c3)](_0x1da483); if (_0xed0743) _0x3741ff['localStorageData'][_0xed0743] = localStorage[_0xd86cb7(0x745)](_0xed0743); } const _0x27c3f8 = await _0x4c74c3, _0x1371f8 = _0x27c3f8[_0xd86cb7(0x5a2)](_0x136299, _0xd86cb7(0x185)), _0xfa8ee = _0x1371f8['objectStore'](_0x136299), _0x5cbc31 = await new Promise((_0x504e3d, _0x2bac71) => { const _0x3d1fcb = _0xd86cb7, _0x5d0e3f = _0xfa8ee['getAll'](); _0x5d0e3f['onsuccess'] = () => _0x504e3d(_0x5d0e3f[_0x3d1fcb(0x84e)]), _0x5d0e3f[_0x3d1fcb(0x911)] = () => _0x2bac71(_0x5d0e3f['error']); }); for (const _0x4d1919 of _0x5cbc31) { if (_0x4d1919[_0xd86cb7(0x277)] instanceof Blob) { if (_0xd86cb7(0x526) === 'VMsfc') _0x18a133(_0x6971cd), _0xf2a41d[_0xd86cb7(0x135)] = '', _0x52029a(_0x3b1e6b, 0x64); else try { _0xd86cb7(0x49a) !== _0xd86cb7(0x17e) ? _0x3741ff[_0xd86cb7(0x432)][_0x4d1919['id']] = await _0x1ac482(_0x4d1919['blob']) : _0x5c9a97[_0xd86cb7(0x5e5)](_0xd86cb7(0x7cf))[_0xd86cb7(0x254)] = () => { _0x273036(_0x2f094), _0x164ea6(); }; } catch (_0x242b2d) { if (_0xd86cb7(0x87d) !== _0xd86cb7(0x2c7)) _0x448e49[_0xd86cb7(0x956)](_0x4d1919['id']); else { const _0x32ca9e = _0x487cae[_0xd86cb7(0x82b)]('label'); _0x32ca9e['innerHTML'] = _0xd86cb7(0x839) + _0x412b63['id'] + _0xd86cb7(0x636) + _0x33357f[_0xd86cb7(0x8fa)], _0x36725a[_0xd86cb7(0x54e)](_0x32ca9e); } } } } const _0x1e2d38 = _0x27c3f8['transaction'](_0x4034d6, _0xd86cb7(0x185)), _0x5c301d = _0x1e2d38[_0xd86cb7(0x706)](_0x4034d6), _0x455dcd = await new Promise((_0x7453e6, _0x177dd4) => { const _0x32b1ce = _0xd86cb7, _0x2a7eec = _0x5c301d[_0x32b1ce(0x8f3)](); _0x2a7eec[_0x32b1ce(0x578)] = () => _0x7453e6(_0x2a7eec['result']), _0x2a7eec[_0x32b1ce(0x911)] = () => _0x177dd4(_0x2a7eec[_0x32b1ce(0x93a)]); }); for (const _0x455d8b of _0x455dcd) { if (_0xd86cb7(0x495) !== _0xd86cb7(0x925)) { const _0x1b2860 = { ..._0x455d8b }; _0x455d8b[_0xd86cb7(0x5ef)] instanceof Blob && (_0x1b2860[_0xd86cb7(0x5ef)] = await _0x1ac482(_0x455d8b[_0xd86cb7(0x5ef)])); if (_0x455d8b[_0xd86cb7(0x2b6)] instanceof Blob) { if (_0xd86cb7(0x3a0) !== _0xd86cb7(0x8c9)) _0x1b2860['cover'] = await _0x1ac482(_0x455d8b['cover']); else { _0x267487(); return; } } _0x3741ff[_0xd86cb7(0x877)][_0xd86cb7(0x956)](_0x1b2860); } else _0x46c4cf[_0xd86cb7(0x501)](_0xd86cb7(0x4bd), function () { const _0x486c00 = _0xd86cb7, _0x3ed6ce = { 'id': 'msg_' + _0x3e3d19[_0x486c00(0x2c3)], 'url': _0x2ba3be[_0x486c00(0x151)] }; _0x2d1016(this, _0x3ed6ce); }); } const _0x200a78 = new Blob([JSON['stringify'](_0x3741ff, null, 0x2)], { 'type': _0xd86cb7(0x22e) }), _0x3b66a2 = URL[_0xd86cb7(0x1de)](_0x200a78), _0x4d91f6 = document[_0xd86cb7(0x82b)]('a'), _0xaa260c = new Date(), _0x5139e2 = _0xaa260c['getFullYear']() + '-' + String(_0xaa260c[_0xd86cb7(0x719)]() + 0x1)[_0xd86cb7(0x522)](0x2, '0') + '-' + String(_0xaa260c[_0xd86cb7(0x9b6)]())[_0xd86cb7(0x522)](0x2, '0'); _0x4d91f6[_0xd86cb7(0x83b)] = _0x3b66a2, _0x4d91f6[_0xd86cb7(0x71e)] = _0xd86cb7(0x22d) + _0x5139e2 + _0xd86cb7(0x569), document['body'][_0xd86cb7(0x54e)](_0x4d91f6), _0x4d91f6['click'](), document['body'][_0xd86cb7(0x732)](_0x4d91f6), URL[_0xd86cb7(0x3cf)](_0x3b66a2), _0x3145a8(![]); if (_0x448e49[_0xd86cb7(0x2bd)] > 0x0) { if ('RSClu' === _0xd86cb7(0x142)) _0x589297(_0xd86cb7(0x5bf) + _0x448e49['join']('\x0a')); else { const _0x2077ca = _0xd86cb7(0x474); _0x2e0487[_0xd86cb7(0x69e)][_0xd86cb7(0x43f)](_0xd86cb7(0x168), _0x2077ca); const _0xcfcd66 = _0x241281[_0xd86cb7(0x6c2)](_0xd86cb7(0x641)), _0x194efb = _0x234e91[_0xd86cb7(0x6c2)]('diary-modal-textarea'), _0x48e22b = _0x5b2e2b[_0xd86cb7(0x6c2)]('diary-modal-save'), _0x340e62 = _0x36e82d['getElementById'](_0xd86cb7(0x34d)), _0x4833af = _0xcfcd66['querySelector'](_0xd86cb7(0x73b)), _0x21f7a1 = () => { const _0xfe587d = _0xd86cb7; _0xcfcd66[_0xfe587d(0x6ae)](), _0x197abb(); }; _0x48e22b[_0xd86cb7(0x254)] = () => { _0xf1bacb(_0x194efb['value']), _0x21f7a1(); }, _0x340e62[_0xd86cb7(0x254)] = _0x21f7a1, _0x4833af['onclick'] = _0x21f7a1; } } else _0x589297(_0xd86cb7(0x392)); } catch (_0x546fea) { _0xd86cb7(0x524) === 'DMfxb' ? _0x420fe5('保存失败，你的表情包是不是太多了？') : (_0x3145a8(![]), console[_0xd86cb7(0x93a)](_0xd86cb7(0x665), _0x546fea), _0x589297(_0xd86cb7(0x8d9) + _0x546fea['message'])); } }), _0x17c434['addEventListener'](_0xe2e12e(0x4bd), () => { const _0x15c08f = _0xe2e12e; _0x568ecb[_0x15c08f(0x4bd)](); }), _0x43da91['addEventListener'](_0xe2e12e(0x4bd), _0x558b66), _0x568ecb[_0xe2e12e(0x501)]('change', _0x3f0964 => { const _0x280ae2 = _0xe2e12e, _0x3838c6 = _0x3f0964['target'][_0x280ae2(0x4c0)][0x0]; if (!_0x3838c6) return; _0x385a44(_0x280ae2(0x484))[_0x280ae2(0x588)](_0x410421 => { const _0x3b2ea5 = _0x280ae2; if (!_0x410421) { _0x568ecb['value'] = ''; return; } _0x3145a8(!![], _0x3b2ea5(0x525)); const _0x5f42d5 = new FileReader(); _0x5f42d5[_0x3b2ea5(0x575)] = async _0x1bfed1 => { const _0x424199 = _0x3b2ea5; if (_0x424199(0x193) === 'sfcdw') try { const _0xf1f405 = JSON[_0x424199(0x213)](_0x1bfed1[_0x424199(0x68b)][_0x424199(0x84e)]); if (!_0xf1f405[_0x424199(0x58a)] || !_0xf1f405[_0x424199(0x432)]) throw new Error(_0x424199(0x6f5)); _0x3145a8(!![], _0x424199(0x62e)); const _0x242683 = await Promise['all'](Object['keys'](_0xf1f405[_0x424199(0x432)])[_0x424199(0x82d)](async _0x495922 => { const _0x4dab6f = _0x424199, _0x1ed2a8 = _0xf1f405[_0x4dab6f(0x432)][_0x495922]; if (typeof _0x1ed2a8 === 'string' && _0x1ed2a8[_0x4dab6f(0x245)](_0x4dab6f(0x87a))) { if ('HimUJ' === _0x4dab6f(0x8d1)) _0x470f36(() => { const _0x2c1809 = _0x4dab6f; _0x2bc240[_0x2c1809(0x145)] = _0x1e34bd[_0x2c1809(0x2cf)]; }, 0x0); else { const _0x1ba294 = await _0x1679a8(_0x1ed2a8); return { 'id': _0x495922, 'blob': _0x1ba294 }; } } return null; }))[_0x424199(0x588)](_0x1489f6 => _0x1489f6[_0x424199(0x5fe)](Boolean)), _0x362678 = []; if (_0xf1f405['indexedDBMusicData']) { if (_0x424199(0x583) !== 'CDKcE') _0x147b44['boundUserProfileId'] === _0x1f301f && (_0x2c1969[_0x424199(0x757)] = _0xf38633['activeUserProfileId']); else { _0x3145a8(!![], _0x424199(0x12d)); const _0x553169 = _0xf1f405['indexedDBMusicData']['map'](async _0x1d42cf => { const _0x727375 = _0x424199, _0x33bfd3 = { ..._0x1d42cf }; if (_0x1d42cf['audio']) _0x33bfd3[_0x727375(0x5ef)] = await _0x1679a8(_0x1d42cf[_0x727375(0x5ef)]); if (_0x1d42cf[_0x727375(0x2b6)]) _0x33bfd3[_0x727375(0x2b6)] = await _0x1679a8(_0x1d42cf[_0x727375(0x2b6)]); return _0x33bfd3; }); _0x362678[_0x424199(0x956)](...await Promise[_0x424199(0x721)](_0x553169)); } } _0x3145a8(!![], '正在清空旧数据...'), localStorage[_0x424199(0x2c1)](); for (const _0x51f4b4 in _0xf1f405[_0x424199(0x58a)]) { localStorage[_0x424199(0x598)](_0x51f4b4, _0xf1f405[_0x424199(0x58a)][_0x51f4b4]); } _0x3145a8(!![], _0x424199(0x7fb)); const _0xb63cd6 = await _0x4c74c3, _0x1015ca = _0xb63cd6['transaction']([_0x136299, _0x4034d6], 'readwrite'), _0x110463 = _0x1015ca[_0x424199(0x706)](_0x136299), _0x444f47 = _0x1015ca[_0x424199(0x706)](_0x4034d6); _0x110463[_0x424199(0x2c1)](), _0x444f47[_0x424199(0x2c1)](), _0x242683['forEach'](_0x1e3432 => _0x110463[_0x424199(0x6a0)](_0x1e3432)), _0x362678[_0x424199(0x279)](_0x2fbc9e => _0x444f47[_0x424199(0x6a0)](_0x2fbc9e)), await new Promise((_0x5caca7, _0x3f2556) => { const _0x100021 = _0x424199; _0x1015ca[_0x100021(0x7f1)] = _0x5caca7, _0x1015ca[_0x100021(0x911)] = _0x1ab1c9 => _0x3f2556(_0x1ab1c9[_0x100021(0x68b)][_0x100021(0x93a)]); }), _0x3145a8(![]), _0x589297(_0x424199(0x2b5)), setTimeout(() => location[_0x424199(0x8c5)](), 0x640); } catch (_0x46e9b4) { _0x3145a8(![]), console[_0x424199(0x93a)](_0x424199(0x268), _0x46e9b4), _0x589297(_0x424199(0x72c) + _0x46e9b4[_0x424199(0x6a1)]); } finally { _0x568ecb[_0x424199(0x135)] = ''; } else _0x4dc3d3(![]), _0x4e99a7[_0x424199(0x93a)](_0x424199(0x665), _0x26ae7e), _0x2e2462(_0x424199(0x8d9) + _0x3cc453[_0x424199(0x6a1)]); }, _0x5f42d5[_0x3b2ea5(0x502)](_0x3838c6); }); }); function _0x3398d5() { const _0x4b6e98 = _0xe2e12e; _0xe8feed[_0x4b6e98(0x135)] = _0x4d4ca5['apiSettings'][_0x4b6e98(0x800)] || '', _0x15ccd7[_0x4b6e98(0x135)] = _0x4d4ca5['apiSettings']['key'] || '', _0x2059a1[_0x4b6e98(0x135)] = _0x4d4ca5[_0x4b6e98(0x547)][_0x4b6e98(0x83d)] || '', _0x3179e5[_0x4b6e98(0x135)] = String(_0x4d4ca5[_0x4b6e98(0x2d6)]?.[_0x4b6e98(0x4cb)] ?? 0x64), document[_0x4b6e98(0x6c2)]('api-provider')['value'] = _0x4d4ca5['apiSettings'][_0x4b6e98(0x8f8)] || 'openai'; } function _0x385134() { const _0x2c1192 = _0xe2e12e; _0x4d4ca5['apiSettings'][_0x2c1192(0x800)] = _0xe8feed[_0x2c1192(0x135)][_0x2c1192(0x163)](), _0x4d4ca5[_0x2c1192(0x547)][_0x2c1192(0x8c3)] = _0x15ccd7[_0x2c1192(0x135)]['trim'](), _0x4d4ca5[_0x2c1192(0x547)][_0x2c1192(0x83d)] = _0x2059a1['value'][_0x2c1192(0x163)](), _0x4d4ca5[_0x2c1192(0x547)][_0x2c1192(0x8f8)] = document[_0x2c1192(0x6c2)]('api-provider')[_0x2c1192(0x135)]; const _0x48c519 = parseInt(_0x3179e5[_0x2c1192(0x135)], 0xa); _0x4d4ca5['preferences'][_0x2c1192(0x4cb)] = Number['isFinite'](_0x48c519) && _0x48c519 > 0x0 ? _0x48c519 : 0x64, _0x42173a(), _0x589297(_0x2c1192(0x28b)); } function _0x4a1c04() { const _0x4a9365 = _0xe2e12e; _0x4266b3[_0x4a9365(0x135)] = _0x4d4ca5[_0x4a9365(0x473)]['name'] || '', _0x5b2cba[_0x4a9365(0x6c3)] = _0x4d4ca5[_0x4a9365(0x473)][_0x4a9365(0x86f)] || _0x4abe2b, _0x33089d['value'] = _0x4d4ca5[_0x4a9365(0x473)]['persona'] || ''; } function _0x289bbe() { const _0x2dc729 = _0xe2e12e; _0x4d4ca5[_0x2dc729(0x473)][_0x2dc729(0x8fa)] = _0x4266b3[_0x2dc729(0x135)][_0x2dc729(0x163)](), _0x4d4ca5[_0x2dc729(0x473)][_0x2dc729(0x7d5)] = _0x33089d['value']['trim'](), _0x42173a(), _0x41e9e0(), _0x589297(_0x2dc729(0x704)), _0x113213(_0x2dc729(0x546), _0x2dc729(0x473)); } async function _0x539822(_0x427162 = null) { const _0x5d77ee = _0xe2e12e, _0x27329e = _0x43c89a; _0x113213(_0x5d77ee(0x850), _0x27329e); const _0x50534f = document[_0x5d77ee(0x6c2)](_0x5d77ee(0x7d8)); _0x50534f[_0x5d77ee(0x978)] = '', _0x4d4ca5[_0x5d77ee(0x7ea)][_0x5d77ee(0x279)](_0x5445d7 => { const _0x43df09 = _0x5d77ee; if (_0x43df09(0x43a) === _0x43df09(0x497)) return; else { const _0x1d04e0 = document['createElement'](_0x43df09(0x191)); _0x1d04e0[_0x43df09(0x978)] = _0x43df09(0x839) + _0x5445d7['id'] + '\x22>\x20' + _0x5445d7[_0x43df09(0x8fa)], _0x50534f[_0x43df09(0x54e)](_0x1d04e0); } }), _0x3a8680(_0x5d77ee(0x206)), _0x1a9c5b[_0x5d77ee(0x6c3)] = '', _0x3f784a[_0x5d77ee(0x135)] = '', _0x2d741e[_0x5d77ee(0x6c3)] = '', _0x4c9ca1['value'] = '', _0x2e9180['src'] = '', _0x43df0c[_0x5d77ee(0x135)] = ''; const _0x43b8cb = [_0x5d77ee(0x416), _0x5d77ee(0x224), _0x5d77ee(0x3d8), _0x5d77ee(0x23a), 'shy']; _0x43b8cb[_0x5d77ee(0x279)](_0x3d7eb9 => { const _0x2ff3dd = _0x5d77ee; document[_0x2ff3dd(0x6c2)](_0x2ff3dd(0x23f) + _0x3d7eb9 + _0x2ff3dd(0x958))[_0x2ff3dd(0x6c3)] = '', document[_0x2ff3dd(0x6c2)](_0x2ff3dd(0x23f) + _0x3d7eb9 + '-input')['value'] = ''; }); if (_0x427162) { const _0x37e930 = _0x4d4ca5[_0x5d77ee(0x4ee)][_0x5d77ee(0x5a8)](_0x25e1f1 => _0x25e1f1['id'] === _0x427162); if (!_0x37e930) return; _0x345646['value'] = _0x37e930['id'], _0x228a25[_0x5d77ee(0x806)] = _0x5d77ee(0x1db), _0x25e73b[_0x5d77ee(0x135)] = _0x37e930[_0x5d77ee(0x8fa)], _0xc7a0ff[_0x5d77ee(0x135)] = _0x37e930[_0x5d77ee(0x5f2)], _0x48ba8d[_0x5d77ee(0x135)] = _0x37e930[_0x5d77ee(0x7d5)], document[_0x5d77ee(0x6c2)]('char-edit-css')['value'] = _0x37e930[_0x5d77ee(0x303)] || ''; const _0x34d604 = _0x4d4ca5['chats'][_0x5d77ee(0x5a8)](_0xc44a71 => _0xc44a71['type'] === _0x5d77ee(0x17c) && _0xc44a71[_0x5d77ee(0x836)][_0x5d77ee(0x407)](_0x427162)); document[_0x5d77ee(0x6c2)](_0x5d77ee(0x206))[_0x5d77ee(0x135)] = _0x34d604?.[_0x5d77ee(0x757)] || _0x4d4ca5['activeUserProfileId']; try { if (_0x5d77ee(0x687) === _0x5d77ee(0x2bf)) _0x40578e = _0x5778ec[_0x5d77ee(0x82b)](_0x5d77ee(0x46f)), _0x14ac9e['id'] = 'feed-loader', _0x16be86[_0x5d77ee(0x54e)](_0x12cf32); else { const _0x37016d = await _0x299fa0('char_avatar_' + _0x37e930['id']), _0x45f5b5 = await _0x299fa0(_0x5d77ee(0x451) + _0x37e930['id']), _0x5cfde3 = await _0x299fa0('char_offline_bg_' + _0x37e930['id']); _0x1a9c5b[_0x5d77ee(0x6c3)] = _0x37016d ? URL[_0x5d77ee(0x1de)](_0x37016d) : _0x37e930[_0x5d77ee(0x86f)] || _0x4991a9; if (_0x45f5b5) _0x2d741e[_0x5d77ee(0x6c3)] = URL[_0x5d77ee(0x1de)](_0x45f5b5); if (_0x5cfde3) _0x2e9180['src'] = URL[_0x5d77ee(0x1de)](_0x5cfde3); for (const _0x150748 of _0x43b8cb) { const _0x25b2e8 = await _0x299fa0(_0x5d77ee(0x98c) + _0x150748 + '_' + _0x37e930['id']); _0x25b2e8 && (_0x5d77ee(0x677) === _0x5d77ee(0x25c) ? _0x5d77ee(0x2be) : document[_0x5d77ee(0x6c2)](_0x5d77ee(0x23f) + _0x150748 + _0x5d77ee(0x958))['src'] = URL['createObjectURL'](_0x25b2e8)); } } } catch (_0x17c513) { 'jZYqn' !== _0x5d77ee(0x765) ? (console[_0x5d77ee(0x93a)]('加载角色\x20' + _0x37e930['id'] + _0x5d77ee(0x5e6), _0x17c513), _0x1a9c5b['src'] = _0x37e930['avatar'] || _0x4991a9) : _0x1b73c7[_0x5d77ee(0x93a)](_0x5d77ee(0x63a), _0x23bfcf); } if (_0x37e930[_0x5d77ee(0x963)]) { if (_0x5d77ee(0x216) !== _0x5d77ee(0x216)) { _0x551024(_0x5d77ee(0x56c)); return; } else _0x50534f[_0x5d77ee(0x445)](_0x5d77ee(0x204))[_0x5d77ee(0x279)](_0xad935f => { const _0x9994cf = _0x5d77ee; if (_0x37e930[_0x9994cf(0x963)][_0x9994cf(0x407)](_0xad935f[_0x9994cf(0x135)])) _0xad935f[_0x9994cf(0x5a7)] = !![]; }); } _0xabd00f(); } else _0x5d77ee(0x6f8) !== _0x5d77ee(0x302) ? (_0x345646[_0x5d77ee(0x135)] = '', _0x228a25[_0x5d77ee(0x806)] = '创建新角色', _0x25e73b[_0x5d77ee(0x135)] = '新角色\x20' + (_0x4d4ca5[_0x5d77ee(0x4ee)]['length'] + 0x1), _0xc7a0ff['value'] = '', _0x1a9c5b[_0x5d77ee(0x6c3)] = _0x4991a9, _0x48ba8d[_0x5d77ee(0x135)] = _0x5d77ee(0x361), document[_0x5d77ee(0x6c2)](_0x5d77ee(0x3c4))[_0x5d77ee(0x135)] = '', _0xabd00f()) : _0x2430ff[_0x5d77ee(0x8c3)] === 'Enter' && !_0x27787f[_0x5d77ee(0x80e)] && (_0x26250d['preventDefault'](), _0x4f39a8()); const _0x1f7631 = document[_0x5d77ee(0x6c2)](_0x5d77ee(0x3c4)); let _0x2f613a = document[_0x5d77ee(0x6c2)](_0x5d77ee(0x133)); if (!_0x2f613a) { if ('JFhwh' === _0x5d77ee(0x203)) { if (!_0x42c8bd) return; _0x5e9ccd = _0x5b9924[_0x5d77ee(0x95d)][0x0][_0x5d77ee(0x8ad)], _0x16f548 === _0x5d77ee(0x2fc) && _0x275643(), _0x23f73b = ![]; } else _0x2f613a = document['createElement']('style'), _0x2f613a['id'] = _0x5d77ee(0x133), document[_0x5d77ee(0x6b4)]['appendChild'](_0x2f613a); } const _0x57bf9d = () => { const _0x29cbb5 = _0x5d77ee; if ('ruHjz' !== _0x29cbb5(0x8b6)) { const _0x313e71 = _0x467f52[_0x35cbb3]; _0x28f234(_0x313e71); } else { const _0x42de03 = _0x1f7631['value']; let _0x70111e = _0x42de03['replace'](/\.bubble\.sent/g, '#bubble-preview-user')[_0x29cbb5(0x2ce)](/\.bubble\.received/g, _0x29cbb5(0x491)); _0x2f613a[_0x29cbb5(0x978)] = _0x70111e; } }; _0x1f7631['removeEventListener'](_0x5d77ee(0x4f4), _0x57bf9d), _0x1f7631[_0x5d77ee(0x501)](_0x5d77ee(0x4f4), _0x57bf9d), _0x57bf9d(); } async function _0x1c6f3e() { const _0x38d96d = _0xe2e12e; if (_0x38d96d(0x664) !== 'UHEoP') { const _0x1a3964 = _0x345646['value']; if (!_0x1a3964) { if (_0x38d96d(0x42d) === 'ffHps') { _0x589297(_0x38d96d(0x4bb)); return; } else _0x35b362['style'][_0x38d96d(0x2ee)] = '0\x201px\x203px\x20rgba(0,0,0,0.6)'; } const _0x491ff5 = _0x53bcef(_0x1a3964); if (!_0x491ff5) return; _0x3145a8(!![], '正在打包“' + _0x491ff5[_0x38d96d(0x8fa)] + '”...'); try { const _0x5e352a = { 'type': 'NoirCharacterCard', 'version': 0x1, 'name': _0x491ff5['name'], 'remark': _0x491ff5['remark'], 'persona': _0x491ff5['persona'], 'bubbleCss': _0x491ff5[_0x38d96d(0x303)], 'avatar': null, 'sprites': {}, 'worldBooks': [] }, _0x3fa409 = await _0x299fa0(_0x38d96d(0x4dd) + _0x491ff5['id']); if (_0x3fa409) _0x5e352a['avatar'] = await _0x1ac482(_0x3fa409); const _0x534871 = [_0x38d96d(0x416), _0x38d96d(0x224), _0x38d96d(0x3d8), 'sad', 'shy']; for (const _0x17cde2 of _0x534871) { const _0x4569cb = await _0x299fa0(_0x38d96d(0x98c) + _0x17cde2 + '_' + _0x491ff5['id']); _0x4569cb && (_0x38d96d(0x8c8) !== _0x38d96d(0x8c8) ? _0x5130d6[_0x38d96d(0x806)] = _0x38d96d(0x66e) : _0x5e352a[_0x38d96d(0x906)][_0x17cde2] = await _0x1ac482(_0x4569cb)); } _0x491ff5[_0x38d96d(0x963)] && _0x491ff5[_0x38d96d(0x963)][_0x38d96d(0x2bd)] > 0x0 && ('KcXks' !== 'KcXks' ? _0x33c7ba[_0x38d96d(0x4bd)]() : _0x5e352a['worldBooks'] = _0x491ff5['linkedWorldBookIds'][_0x38d96d(0x82d)](_0x5ba112 => _0x4d4ca5[_0x38d96d(0x7ea)][_0x38d96d(0x5a8)](_0x1b8b1b => _0x1b8b1b['id'] === _0x5ba112))[_0x38d96d(0x5fe)](Boolean)[_0x38d96d(0x82d)](_0x4bd716 => ({ 'name': _0x4bd716[_0x38d96d(0x8fa)], 'content': _0x4bd716[_0x38d96d(0x7af)] }))); const _0x2c67a8 = new Blob([JSON['stringify'](_0x5e352a, null, 0x2)], { 'type': _0x38d96d(0x22e) }), _0xf898b7 = URL['createObjectURL'](_0x2c67a8), _0x229a82 = document[_0x38d96d(0x82b)]('a'); _0x229a82[_0x38d96d(0x83b)] = _0xf898b7, _0x229a82['download'] = _0x491ff5['name'] + _0x38d96d(0x215), document[_0x38d96d(0x69e)][_0x38d96d(0x54e)](_0x229a82), _0x229a82[_0x38d96d(0x4bd)](), document[_0x38d96d(0x69e)][_0x38d96d(0x732)](_0x229a82), URL[_0x38d96d(0x3cf)](_0xf898b7); } catch (_0x59162c) { _0x38d96d(0x84d) !== _0x38d96d(0x541) ? (console[_0x38d96d(0x93a)](_0x38d96d(0x8f0), _0x59162c), _0x589297('导出失败了，哼:\x20' + _0x59162c[_0x38d96d(0x6a1)])) : (_0x3e0be6(_0x3b9fad['id']), _0x1bcb18('群聊已解散。'), _0x446feb('chat'), _0x48ecce(![])); } finally { _0x38d96d(0x2a5) !== _0x38d96d(0x1fb) ? _0x3145a8(![]) : (_0x4268dc[_0x38d96d(0x5e7)](_0x38d96d(0x3f2)), _0x43ee81(), _0x2e59f0(_0x38d96d(0x655))); } } else _0x5f4188(_0x38d96d(0x35e) + _0x3949c4[_0x38d96d(0x6a1)]); } async function _0x1b577c(_0x4eaedc) { const _0x257118 = _0xe2e12e, _0x161609 = _0x4eaedc['target'][_0x257118(0x4c0)][0x0]; if (!_0x161609) return; _0x3145a8(!![], _0x257118(0x3bb)); const _0x5842e1 = new FileReader(); _0x5842e1['onload'] = async _0x3a52b3 => { const _0x2f8ee0 = _0x257118; if (_0x2f8ee0(0x46a) !== _0x2f8ee0(0x46a)) { const _0x36d369 = { 'id': _0x2f8ee0(0x3a3) + _0x43ef94[_0x2f8ee0(0x661)](), 'name': _0x9820a, 'content': _0x4279ad }; _0x17745c['worldBooks'][_0x2f8ee0(0x956)](_0x36d369); } else try { const _0x51bc72 = JSON['parse'](_0x3a52b3[_0x2f8ee0(0x68b)][_0x2f8ee0(0x84e)]); if (_0x51bc72['type'] !== 'NoirCharacterCard') { if (_0x2f8ee0(0x417) === _0x2f8ee0(0x417)) throw new Error(_0x2f8ee0(0x824)); else _0x41b577['error'](_0x2f8ee0(0x762), _0x3d5275), _0x18c8df(_0x2f8ee0(0x356)); } const _0x221114 = []; if (_0x51bc72[_0x2f8ee0(0x7ea)] && _0x51bc72['worldBooks'][_0x2f8ee0(0x2bd)] > 0x0) for (const _0x344ea7 of _0x51bc72[_0x2f8ee0(0x7ea)]) { if (_0x2f8ee0(0x86d) === _0x2f8ee0(0x915)) _0x35948a[_0x2f8ee0(0x93a)](_0x2f8ee0(0x21f), _0x2c599c); else { let _0x14ca9e = _0x4d4ca5[_0x2f8ee0(0x7ea)][_0x2f8ee0(0x5a8)](_0x4f3ce7 => _0x4f3ce7['name'] === _0x344ea7[_0x2f8ee0(0x8fa)]); if (_0x14ca9e) _0x221114[_0x2f8ee0(0x956)](_0x14ca9e['id']); else { const _0xfd5481 = { 'id': 'wb_' + Date[_0x2f8ee0(0x661)]() + '_' + Math[_0x2f8ee0(0x4e7)](), 'name': _0x344ea7['name'], 'content': _0x344ea7[_0x2f8ee0(0x7af)] }; _0x4d4ca5[_0x2f8ee0(0x7ea)]['push'](_0xfd5481), _0x221114[_0x2f8ee0(0x956)](_0xfd5481['id']); } } } const _0x43d12a = _0x2f8ee0(0x86a) + Date[_0x2f8ee0(0x661)](), _0x5b5698 = { 'id': _0x43d12a, 'name': _0x51bc72[_0x2f8ee0(0x8fa)], 'remark': _0x51bc72['remark'] || '', 'persona': _0x51bc72[_0x2f8ee0(0x7d5)], 'avatar': _0x51bc72['avatar'] || _0x4991a9, 'linkedWorldBookIds': _0x221114, 'bubbleCss': _0x51bc72['bubbleCss'] || '' }; if (_0x51bc72[_0x2f8ee0(0x86f)]) { if (_0x2f8ee0(0x556) !== _0x2f8ee0(0x556)) { const _0x20d68c = _0x12620f[_0x2f8ee0(0x213)](_0x5acfe7); _0xfa2ec9['isArray'](_0x20d68c) ? _0x2e01a5 = [..._0x2f486e, ..._0x20d68c] : _0x2dd822 = _0x25d798; } else { const _0x31c1a7 = await _0x1679a8(_0x51bc72[_0x2f8ee0(0x86f)]); await _0x34f697(_0x2f8ee0(0x4dd) + _0x43d12a, _0x31c1a7); } } if (_0x51bc72[_0x2f8ee0(0x906)]) { if (_0x2f8ee0(0x5ab) === _0x2f8ee0(0x5ab)) for (const _0x3ad67b in _0x51bc72[_0x2f8ee0(0x906)]) { if (_0x2f8ee0(0x51b) !== _0x2f8ee0(0x51b)) { const _0xc101e6 = _0x25cd4c[_0x2f8ee0(0x445)](_0x2f8ee0(0x6b6)); _0xc101e6[_0x2f8ee0(0x279)](_0x16cf72 => _0x16cf72['remove']()); } else { const _0x26782d = _0x51bc72['sprites'][_0x3ad67b], _0x16a88c = await _0x1679a8(_0x26782d); await _0x34f697('char_sprite_' + _0x3ad67b + '_' + _0x43d12a, _0x16a88c); } } else _0x534b0e(_0x2f8ee0(0x67a) + _0x65f97e['message']); } _0x4d4ca5[_0x2f8ee0(0x4ee)][_0x2f8ee0(0x956)](_0x5b5698); const _0x5094f1 = { 'id': _0x2f8ee0(0x468) + _0x43d12a, 'type': _0x2f8ee0(0x17c), 'participantIds': [_0x43d12a], 'boundUserProfileId': _0x4d4ca5['activeUserProfileId'] }; _0x4d4ca5[_0x2f8ee0(0x53f)]['push'](_0x5094f1), _0x42173a(), _0x505812(), _0x589297('“' + _0x5b5698[_0x2f8ee0(0x8fa)] + _0x2f8ee0(0x933)); } catch (_0x33f8dc) { console['error'](_0x2f8ee0(0x8cb), _0x33f8dc), _0x589297(_0x2f8ee0(0x25a) + _0x33f8dc[_0x2f8ee0(0x6a1)]); } finally { _0x2f8ee0(0x4fc) !== _0x2f8ee0(0x4fc) ? _0x47a99f++ : (_0x3145a8(![]), _0x4eaedc[_0x2f8ee0(0x68b)]['value'] = ''); } }, _0x5842e1[_0x257118(0x502)](_0x161609); } async function _0x444db6() { const _0x306bee = _0xe2e12e; if (_0x306bee(0x8a5) !== _0x306bee(0x8a5)) return _0x11fbc1[_0x306bee(0x956)](_0x4d2f11), _0xbe4d9f; else { const _0x1d6e63 = _0x345646['value']; let _0xfa8d8a = null; const _0x206a4a = _0x3f784a[_0x306bee(0x4c0)][0x0], _0x342605 = _0x4c9ca1['files'][0x0], _0x236481 = _0x43df0c[_0x306bee(0x4c0)][0x0], _0x40012f = document['querySelectorAll'](_0x306bee(0x1f4)), _0xe77141 = Array['from'](_0x40012f)[_0x306bee(0x82d)](_0x5f1798 => _0x5f1798[_0x306bee(0x135)]), _0x398d77 = { 'name': _0x25e73b[_0x306bee(0x135)][_0x306bee(0x163)](), 'remark': _0xc7a0ff[_0x306bee(0x135)][_0x306bee(0x163)](), 'persona': _0x48ba8d['value'][_0x306bee(0x163)](), 'linkedWorldBookIds': _0xe77141, 'boundUserProfileId': document['getElementById'](_0x306bee(0x206))[_0x306bee(0x135)], 'bubbleCss': document['getElementById'](_0x306bee(0x3c4))[_0x306bee(0x135)][_0x306bee(0x163)]() }; if (!_0x398d77['name']) { _0x589297(_0x306bee(0x40d)); return; } try { if ('Tnisz' === 'Tnisz') { const _0x5ee7fd = [_0x306bee(0x416), _0x306bee(0x224), _0x306bee(0x3d8), 'sad', _0x306bee(0x977)]; if (_0x1d6e63) { if (_0x306bee(0x93b) === _0x306bee(0x315)) _0x12828f(_0x306bee(0x67a) + _0x345a90[_0x306bee(0x6a1)]); else { const _0x115751 = _0x4d4ca5[_0x306bee(0x4ee)]['find'](_0x2b1cbd => _0x2b1cbd['id'] === _0x1d6e63); if (_0x115751) { if (_0x306bee(0x369) === _0x306bee(0x24c)) _0xce278f[_0x306bee(0x473)][_0x306bee(0x8fa)] = _0x18f85d[_0x306bee(0x135)]['trim'](), _0x4945d9[_0x306bee(0x473)][_0x306bee(0x7d5)] = _0x4be19c['value'][_0x306bee(0x163)](), _0x5f1751(), _0xdc7e33(), _0x14e7b6(_0x306bee(0x704)), _0xb2cec4('settings', _0x306bee(0x473)); else { Object['assign'](_0x115751, _0x398d77); if (_0x206a4a) _0x115751[_0x306bee(0x86f)] = await _0x13257f(_0x206a4a); } } if (_0x206a4a) await _0x34f697(_0x306bee(0x4dd) + _0x1d6e63, _0x206a4a); if (_0x342605) await _0x34f697('char_wallpaper_' + _0x1d6e63, _0x342605); if (_0x236481) await _0x34f697(_0x306bee(0x308) + _0x1d6e63, _0x236481); for (const _0x546ed4 of _0x5ee7fd) { if (_0x306bee(0x7ad) === 'DlrmS') _0x4a81da[_0x306bee(0x970)][_0x306bee(0x6ae)](_0x306bee(0x68c)), _0x2624cd['classList'][_0x306bee(0x68a)](_0x306bee(0x68c)), _0x2423c0(_0x100c2a, _0x3cb6fb); else { const _0x3cb08b = document[_0x306bee(0x6c2)]('char-edit-sprite-' + _0x546ed4 + _0x306bee(0x7cc))[_0x306bee(0x4c0)][0x0]; if (_0x3cb08b) await _0x34f697(_0x306bee(0x98c) + _0x546ed4 + '_' + _0x1d6e63, _0x3cb08b); } } } } else { if (_0x306bee(0x472) === _0x306bee(0x472)) { _0xfa8d8a = _0x306bee(0x86a) + Date[_0x306bee(0x661)](); const _0x1c6fa7 = { 'id': _0xfa8d8a, ..._0x398d77 }; _0x1c6fa7[_0x306bee(0x86f)] = _0x206a4a ? await _0x13257f(_0x206a4a) : _0x4991a9, _0x4d4ca5[_0x306bee(0x4ee)][_0x306bee(0x956)](_0x1c6fa7); const _0x43fc8c = { 'id': _0x306bee(0x468) + _0xfa8d8a, 'type': _0x306bee(0x17c), 'participantIds': [_0xfa8d8a], 'boundUserProfileId': _0x398d77[_0x306bee(0x757)], 'listenTogetherSession': null }; _0x4d4ca5[_0x306bee(0x53f)][_0x306bee(0x956)](_0x43fc8c); if (_0x206a4a) await _0x34f697(_0x306bee(0x4dd) + _0xfa8d8a, _0x206a4a); if (_0x342605) await _0x34f697(_0x306bee(0x451) + _0xfa8d8a, _0x342605); if (_0x236481) await _0x34f697('char_offline_bg_' + _0xfa8d8a, _0x236481); for (const _0x4a18c6 of _0x5ee7fd) { if (_0x306bee(0x8b2) === _0x306bee(0x84b)) { const _0x38fd24 = { 'id': _0x306bee(0x35f) + _0xe0714e[_0x306bee(0x2c3)], 'url': _0x23b1cf[_0x306bee(0x151)] }; _0x20ea2f(this, _0x38fd24); } else { const _0x5cb18b = document['getElementById'](_0x306bee(0x23f) + _0x4a18c6 + _0x306bee(0x7cc))['files'][0x0]; if (_0x5cb18b) await _0x34f697(_0x306bee(0x98c) + _0x4a18c6 + '_' + _0xfa8d8a, _0x5cb18b); } } } else { const _0x150c0b = _0x54cfa3 === _0x4696f2 ? _0x306bee(0x786) : ''; return '' + _0x150c0b + _0x19e52f[_0x306bee(0x57b)]; } } _0x42173a(), _0x505812(), _0x589297(_0x306bee(0x428)), _0x113213(_0x306bee(0x60d), _0x306bee(0x850)); if (!_0x1d6e63) { if (_0x306bee(0x967) === _0x306bee(0x62f)) _0x40aa7f[_0x306bee(0x970)][_0x306bee(0x6ae)](_0x306bee(0x68c)), _0x242b56['classList'][_0x306bee(0x68a)](_0x306bee(0x68c)), _0x528fa0(); else { const _0x59e865 = _0x306bee(0x468) + _0xfa8d8a; _0x41f53b(_0x59e865), _0x3493cf(!![]); } } } else _0x1c94a9('获取模型失败:\x20' + _0x10f406[_0x306bee(0x6a1)] + '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1'); } catch (_0x1b7c13) { console['error'](_0x306bee(0x20a), _0x1b7c13), _0x589297(_0x306bee(0x4c8) + _0x1b7c13[_0x306bee(0x6a1)]); } } } function _0x4289e7() { const _0x506c2f = _0xe2e12e; _0x11afa0[_0x506c2f(0x135)] = '', _0x15f3f4[_0x506c2f(0x978)] = ''; if (_0x4d4ca5[_0x506c2f(0x4ee)]['length'] < 0x2) { if (_0x506c2f(0x44a) !== 'PUkos') { _0x589297(_0x506c2f(0x4d3)); return; } else _0x1e9fe7['error']('Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20' + _0xf602bd['id'], _0x3526f9), _0x355b50('清空聊天记录失败。'); } _0x4d4ca5['characters']['forEach'](_0xd1969c => { const _0x76d9f7 = _0x506c2f, _0x78f494 = document[_0x76d9f7(0x82b)]('li'); _0x78f494[_0x76d9f7(0x255)] = _0x76d9f7(0x663), _0x78f494[_0x76d9f7(0x978)] = _0x76d9f7(0x950) + _0xd1969c['id'] + _0x76d9f7(0x700) + _0xd1969c['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0xd1969c['avatar'] || _0x4991a9) + _0x76d9f7(0x503) + _0xd1969c['id'] + '\x22\x20class=\x22char-name\x22>' + _0xd1969c[_0x76d9f7(0x8fa)] + _0x76d9f7(0x7f6), _0x15f3f4[_0x76d9f7(0x54e)](_0x78f494); }), _0x113213(_0x506c2f(0x4a7), _0x506c2f(0x6b1)); } function _0x39c5e5() { const _0x526b8c = _0xe2e12e, _0x309823 = _0x11afa0[_0x526b8c(0x135)][_0x526b8c(0x163)](); if (!_0x309823) { _0x589297(_0x526b8c(0x60c)); return; } const _0x3f3a2a = Array[_0x526b8c(0x872)](_0x15f3f4[_0x526b8c(0x445)]('input[type=\x22checkbox\x22]:checked'))[_0x526b8c(0x82d)](_0x2ab92f => _0x2ab92f['dataset']['id']); if (_0x3f3a2a[_0x526b8c(0x2bd)] < 0x2) { if ('RJuZc' !== 'bXPpx') { _0x589297('群聊至少需要2名成员。'); return; } else return []; } const _0x5a35fa = { 'id': 'chat_group_' + Date[_0x526b8c(0x661)](), 'type': _0x526b8c(0x70e), 'name': _0x309823, 'participantIds': _0x3f3a2a }; _0x4d4ca5[_0x526b8c(0x53f)]['push'](_0x5a35fa), _0x4d4ca5[_0x526b8c(0x41f)] = _0x5a35fa['id'], _0x42173a(), _0x505812(), _0x2cf7e8(), _0x4b15bf(), _0x589297('群聊“' + _0x309823 + _0x526b8c(0x7fa)), _0x113213('chat', _0x526b8c(0x4a7)); } _0x225fb1['addEventListener'](_0xe2e12e(0x4bd), _0x3c9ae2), _0x25e688['addEventListener']('click', () => _0x315f79[_0xe2e12e(0x970)][_0xe2e12e(0x6ae)](_0xe2e12e(0x3a7))), _0x42e53f[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0x315f79[_0xe2e12e(0x970)][_0xe2e12e(0x6ae)](_0xe2e12e(0x3a7))), _0x594909['addEventListener'](_0xe2e12e(0x4bd), () => { const _0x5d2986 = _0xe2e12e; _0x1750be[_0x5d2986(0x2e7)](), navigator[_0x5d2986(0x1d8)]['writeText'](_0x1750be[_0x5d2986(0x135)])[_0x5d2986(0x588)](() => { const _0x12cfd7 = _0x5d2986; _0x589297(_0x12cfd7(0x623)); })[_0x5d2986(0x76c)](_0x581678 => { const _0x336b34 = _0x5d2986; if (_0x336b34(0x7f3) !== _0x336b34(0x6d9)) _0x589297(_0x336b34(0x448)); else { const { omniText: _0x11dbdf } = _0x50c2a7(_0x3afbac['id'], null), _0x5af27f = _0x2e7fc1(_0x53254f['id']), _0x2270b3 = _0x4481f8['linkedWorldBookIds'] && _0x1116b6[_0x336b34(0x963)][_0x336b34(0x2bd)] > 0x0 ? '\x0a\x0a#\x20' + _0x5d70f3[_0x336b34(0x8fa)] + _0x336b34(0x90c) + _0x1b79a3[_0x336b34(0x963)][_0x336b34(0x82d)](_0x178723 => _0x5354b1['worldBooks'][_0x336b34(0x5a8)](_0x52ab4a => _0x52ab4a['id'] === _0x178723))[_0x336b34(0x5fe)](_0x4d55dd)[_0x336b34(0x82d)](_0x385316 => _0x336b34(0x90f) + _0x385316[_0x336b34(0x8fa)] + '\x0a' + _0x385316['content'])[_0x336b34(0x5cd)]('') : ''; return _0x336b34(0x8bf) + _0x3ebef2[_0x336b34(0x8fa)] + _0x336b34(0x96a) + _0x4b8324['id'] + _0x336b34(0x864) + _0x3ddd08[_0x336b34(0x7d5)] + _0x336b34(0x627) + _0x11dbdf + '\x0a' + _0x5af27f + '\x0a' + _0x2270b3; } }); }), _0x15f353[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x321dc7), _0x190c9d['addEventListener']('click', _0x3f9c1b), _0x284fb0[_0xe2e12e(0x501)]('click', () => _0x108d8f[_0xe2e12e(0x970)]['remove']('show')), _0x226ab9['addEventListener'](_0xe2e12e(0x4bd), () => _0x108d8f[_0xe2e12e(0x970)][_0xe2e12e(0x6ae)]('show')), _0x2d741e[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0x4c9ca1['click']()), _0x2e9180['addEventListener'](_0xe2e12e(0x4bd), () => _0x43df0c[_0xe2e12e(0x4bd)]()), _0x4c9ca1[_0xe2e12e(0x501)]('change', async _0x40ecf5 => { const _0x10bdbd = _0xe2e12e, _0x2d3470 = _0x40ecf5['target']['files'][0x0]; if (!_0x2d3470) return; try { if (_0x10bdbd(0x2ad) === _0x10bdbd(0x2ad)) _0x2d741e['src'] = await _0x13257f(_0x2d3470); else { const _0x535e74 = _0x173c36[_0x10bdbd(0x6c2)]('accounting-content-area'); _0xfca414[_0x10bdbd(0x6c2)]('accounting-title')[_0x10bdbd(0x806)] = '账本', _0x1ab2e0['getElementById']('header-actions')[_0x10bdbd(0x978)] = ''; const _0xa1f770 = _0x141717[_0x10bdbd(0x2ae)](_0x432b5b[_0x10bdbd(0x21d)])[_0x10bdbd(0x450)]((_0x377ab1, _0x52af2a) => new _0x526d7a(_0x52af2a) - new _0x9b0ca3(_0x377ab1)); if (_0xa1f770[_0x10bdbd(0x2bd)] === 0x0) { _0x535e74[_0x10bdbd(0x978)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的账本还是空白的。</p>'; return; } _0x535e74[_0x10bdbd(0x978)] = '', _0xa1f770[_0x10bdbd(0x279)](_0x2408f6 => { const _0x3bd13d = _0x10bdbd, _0x5b52cb = _0x44e22f['createElement']('div'); _0x5b52cb['className'] = _0x3bd13d(0x8d4), _0x5b52cb[_0x3bd13d(0x645)][_0x3bd13d(0x75f)] = _0x3bd13d(0x54b); const _0x3c8171 = _0x51bc9d[_0x3bd13d(0x21d)][_0x2408f6], _0x1c8aa6 = _0x3c8171['categorizedExpenses']['reduce']((_0x9f611b, _0x50899d) => _0x9f611b + (_0x50899d[_0x3bd13d(0x621)] || 0x0), 0x0); _0x5b52cb['innerHTML'] = '<span\x20class=\x22description\x22>' + _0x2408f6 + _0x3bd13d(0x924) + _0x1c8aa6[_0x3bd13d(0x874)](0x2) + '</span>', _0x5b52cb[_0x3bd13d(0x501)](_0x3bd13d(0x4bd), () => { const _0x4d1a88 = _0x3bd13d; _0x2940c5['classList'][_0x4d1a88(0x6ae)](_0x4d1a88(0x68c)), _0x37f79b[_0x4d1a88(0x970)][_0x4d1a88(0x68a)](_0x4d1a88(0x68c)), _0x1a251a(_0x3c8171, _0x2408f6); }), _0x535e74['appendChild'](_0x5b52cb); }); } } catch (_0x5d6504) { if (_0x10bdbd(0x770) === 'mLzoy') { const _0x132631 = _0xdca428[_0x10bdbd(0x28d)]['filter'](_0x1e83b8 => _0x1e83b8[_0x10bdbd(0x327)] === _0x10bdbd(0x513) && _0x1e83b8[_0x10bdbd(0x151)])['map'](_0x302113 => ({ ..._0x302113, 'source': _0x10bdbd(0x60d) })); _0x56974f[_0x10bdbd(0x956)](..._0x132631); } else _0x589297(_0x10bdbd(0x67a) + _0x5d6504['message']); } }), _0x43df0c['addEventListener'](_0xe2e12e(0x858), async _0x44b1fb => { const _0x32415c = _0xe2e12e, _0x52db28 = _0x44b1fb[_0x32415c(0x68b)][_0x32415c(0x4c0)][0x0]; if (!_0x52db28) return; try { _0x2e9180['src'] = await _0x13257f(_0x52db28); } catch (_0x5d9c3d) { _0x32415c(0x5e1) !== _0x32415c(0x316) ? _0x589297(_0x32415c(0x67a) + _0x5d9c3d[_0x32415c(0x6a1)]) : (_0x1e007f[_0x32415c(0x7f1)] = _0x463d3e, _0x47018c[_0x32415c(0x911)] = _0x4a1a0b => _0x30cb9e(_0x4a1a0b[_0x32415c(0x68b)][_0x32415c(0x93a)])); } }), _0x30deb2['addEventListener']('click', () => _0x101e9a[_0xe2e12e(0x4bd)]()), _0x3119d3[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x4a0907 = _0xe2e12e; localStorage['removeItem'](_0x4a0907(0x3f2)), _0x29f2e0(), _0x589297(_0x4a0907(0x655)); }), _0x101e9a[_0xe2e12e(0x501)](_0xe2e12e(0x858), async _0x4aa302 => { const _0xf15306 = _0xe2e12e; if (_0xf15306(0x5f4) === _0xf15306(0x91b)) return _0x5a06e1[_0xf15306(0x26d)][_0xf15306(0x5a8)](_0xdd5cd8 => _0xdd5cd8['id'] === _0x411208['activeUserProfileId']) || _0x4a4ce2['userProfiles'][0x0]; else { const _0x303d5d = _0x4aa302[_0xf15306(0x68b)][_0xf15306(0x4c0)][0x0]; if (!_0x303d5d) return; try { if (_0xf15306(0x2a2) !== 'HIzfO') { const _0xa7cc8d = await _0x13257f(_0x303d5d); localStorage['setItem'](_0xf15306(0x3f2), _0xa7cc8d), _0x29f2e0(), _0x589297('动态页背景已更换！'); } else _0x515e8e(_0xf15306(0x1c6))[_0xf15306(0x588)](_0x509c58 => { const _0x287525 = _0xf15306; if (_0x509c58) { const _0x2f3ade = _0x5beea1(_0x3506e1['activeMeetingCharId']); _0x2f3ade && (delete _0x2f3ade[_0x287525(0x1cb)], _0x2172d0(), _0x5e0fc1(_0x2f3ade['id'], _0x287525(0x416)), _0x2e3a58('已恢复默认。'), _0x3e0d8a(!![])); } }); } catch (_0x454fad) { _0xf15306(0x4a9) !== _0xf15306(0x4a9) ? (_0x286d3e[_0xf15306(0x806)] = _0x2475b1[_0xf15306(0x23c)] === _0xf15306(0x8d3) ? '旁白' : _0xf15061['speaker'], _0x27f5f4[_0xf15306(0x806)] = _0x1fda39['line'], _0x245d82[_0xf15306(0x23c)] === _0x9052d9['name'] ? _0x1e55c1(_0xf1b011, _0x378bf0[_0xf15306(0x25f)]) : _0x49bde5(_0x69c8f5, _0xf15306(0x416))) : _0x589297(_0xf15306(0x67a) + _0x454fad['message']); } } }), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x9a3))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0x113213('chat', _0xe2e12e(0x20f))), document['getElementById'](_0xe2e12e(0x5db))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x3d3927); const _0x2035d9 = document[_0xe2e12e(0x6c2)]('group-avatar-preview'), _0x5985a4 = document['getElementById']('group-avatar-input'); _0x2035d9['addEventListener'](_0xe2e12e(0x4bd), () => _0x5985a4['click']()), _0x5985a4[_0xe2e12e(0x501)]('change', _0x1014b2 => { const _0x5f25cb = _0xe2e12e, _0x4b2b2d = _0x1014b2['target']['files'][0x0]; if (!_0x4b2b2d) return; const _0x2c077e = URL[_0x5f25cb(0x1de)](_0x4b2b2d); _0x2035d9[_0x5f25cb(0x6c3)] = _0x2c077e, _0x2035d9[_0x5f25cb(0x575)] = () => { const _0x424593 = _0x5f25cb; URL[_0x424593(0x3cf)](_0x2c077e); }; }); const _0x29d2ad = document[_0xe2e12e(0x6c2)]('group-bg-preview')[_0xe2e12e(0x95a)], _0x28ef31 = document['getElementById'](_0xe2e12e(0x26a)), _0x1bf8bd = document[_0xe2e12e(0x6c2)]('group-bg-preview'); _0x29d2ad[_0xe2e12e(0x501)]('click', () => _0x28ef31[_0xe2e12e(0x4bd)]()), _0x28ef31['addEventListener']('change', _0x4c1bda => { const _0x1eb4d2 = _0xe2e12e, _0x2b2b4a = _0x4c1bda[_0x1eb4d2(0x68b)]['files'][0x0]; if (!_0x2b2b4a) return; const _0x3fad4e = URL['createObjectURL'](_0x2b2b4a); _0x1bf8bd[_0x1eb4d2(0x6c3)] = _0x3fad4e, _0x1bf8bd[_0x1eb4d2(0x575)] = () => { const _0x14c882 = _0x1eb4d2; if (_0x14c882(0x5ec) === 'cBbZp') URL[_0x14c882(0x3cf)](_0x3fad4e); else { const _0x4e95d8 = _0x4a4563(_0x2d8805[_0x14c882(0x6bd)]); return _0x4e95d8?.[_0x14c882(0x8fa)] || 'Unknown'; } }; }); const _0x485202 = document[_0xe2e12e(0x5e5)]('#group-settings-screen\x20.select-box'), _0x119f2a = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x89c)); _0x485202[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x97abf2 => { const _0x196933 = _0xe2e12e; _0x97abf2[_0x196933(0x6ca)](), _0x119f2a['classList'][_0x196933(0x413)](_0x196933(0x30e)), _0x485202[_0x196933(0x970)][_0x196933(0x413)]('expanded'); }), _0x119f2a[_0xe2e12e(0x501)]('change', _0x2b3b3a), document[_0xe2e12e(0x6c2)]('group-clear-history-button')['addEventListener'](_0xe2e12e(0x4bd), _0x4d35af), document['getElementById'](_0xe2e12e(0x4c7))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), async () => { const _0x55ff4b = _0xe2e12e, _0x5d3836 = _0xa2c8b5(); if (!_0x5d3836 || _0x5d3836[_0x55ff4b(0x327)] !== _0x55ff4b(0x70e)) return; const _0x39e43a = await _0x385a44(_0x55ff4b(0x2b3) + _0x5d3836[_0x55ff4b(0x8fa)] + _0x55ff4b(0x2a8)); if (_0x39e43a) { if ('BBBfQ' !== _0x55ff4b(0x36d)) { const _0x5de50c = _0x369d7b[_0x55ff4b(0x937)][_0x3d05c9]; _0x5de50c && _0x5de50c[_0x55ff4b(0x2bd)] > 0x0 && (_0x4b39e8 = _0x5de50c['at'](-0x1)); } else _0x297bb8(_0x5d3836['id']), _0x589297(_0x55ff4b(0x812)), _0x113213(_0x55ff4b(0x60d)), _0x3493cf(![]); } }); const _0x9f2c7c = document[_0xe2e12e(0x5e5)](_0xe2e12e(0x601)), _0x39b73f = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x7d8)); _0x9f2c7c[_0xe2e12e(0x501)]('click', _0x34fa71 => { const _0x2f1280 = _0xe2e12e; _0x2f1280(0x1e8) !== _0x2f1280(0x96b) ? (_0x34fa71[_0x2f1280(0x6ca)](), _0x39b73f[_0x2f1280(0x970)][_0x2f1280(0x413)]('visible'), _0x9f2c7c['classList'][_0x2f1280(0x413)](_0x2f1280(0x3c9))) : _0x3c52c1[_0x2f1280(0x956)]('[' + _0x52b6fa(_0x55a255) + ']\x20' + _0x57ba6e['content']); }), _0x39b73f[_0xe2e12e(0x501)](_0xe2e12e(0x858), _0xabd00f), document[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x516c79 => { const _0xf2f8ec = _0xe2e12e; !document[_0xf2f8ec(0x5e5)]('.custom-multiselect')[_0xf2f8ec(0x7a5)](_0x516c79[_0xf2f8ec(0x68b)]) && (_0x39b73f[_0xf2f8ec(0x970)][_0xf2f8ec(0x6ae)](_0xf2f8ec(0x30e)), _0x9f2c7c['classList']['remove']('expanded')); }), _0x147f2a['addEventListener']('click', () => { const _0x12b8c0 = _0xe2e12e; _0x8b1351(), _0x113213(_0x12b8c0(0x37f), 'home'); }), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x454))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0x113213(_0xe2e12e(0x54a), _0xe2e12e(0x37f))), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x6cb))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0x23d3bf()), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x63e))['addEventListener'](_0xe2e12e(0x4bd), () => { const _0x5ad4cd = _0xe2e12e; _0x8b1351(), _0x113213(_0x5ad4cd(0x37f), _0x5ad4cd(0x945)); }), document['getElementById']('save-world-book-button')['addEventListener'](_0xe2e12e(0x4bd), _0x11a566), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x4d4))[_0xe2e12e(0x501)]('click', _0xd1936), _0x22c2ae[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0x113213(_0xe2e12e(0x329), _0xe2e12e(0x54a))), _0x323f55[_0xe2e12e(0x501)]('click', () => _0x113213(_0xe2e12e(0x54a), _0xe2e12e(0x329))), _0xee0c98[_0xe2e12e(0x501)]('click', () => _0x112168['click']()), _0x112168[_0xe2e12e(0x501)](_0xe2e12e(0x858), async _0x496dec => { const _0x26213e = _0xe2e12e, _0x53d28d = _0x496dec[_0x26213e(0x68b)][_0x26213e(0x4c0)][0x0]; if (!_0x53d28d) return; await _0x4154ae(_0x53d28d); }), _0x49621b[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x3eb96c = _0xe2e12e; _0x505812(), _0x113213('chat', _0x3eb96c(0x54a)); }), _0x359437[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x402f58 = _0xe2e12e; _0x3398d5(); const _0x467b7e = (_0x4d4ca5[_0x402f58(0x547)][_0x402f58(0x800)] || '')['includes'](_0x59c621); _0x1a4b4c[_0x402f58(0x152)] = _0x467b7e, _0x113213(_0x402f58(0x546), _0x402f58(0x54a)); }), _0x24d4d6[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0x113213(_0xe2e12e(0x54a), 'settings')), _0x518b06[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x30a2ca = _0xe2e12e; _0x5e29e2(), _0x113213(_0x30a2ca(0x54a), _0x30a2ca(0x60d)); }), _0x378394[_0xe2e12e(0x501)]('click', () => { const _0x29df72 = _0xe2e12e; _0x29df72(0x880) === _0x29df72(0x880) ? (_0x5e29e2(), _0x3493cf(![])) : _0x29ff00['src'] = _0x116c5e ? _0x27228b[_0x29df72(0x1de)](_0x276411) : ''; }), _0x253721[_0xe2e12e(0x501)]('click', () => { _0x113213('chat', 'characterEdit'); }), _0x95073e[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0xed5953 = _0xe2e12e; _0x49d572[_0xed5953(0x970)]['add'](_0xed5953(0x3a7)); }), _0x3b68fd[_0xe2e12e(0x501)]('click', () => _0x4527c8()), _0x53e0d5[_0xe2e12e(0x501)]('click', _0x52ef2f); function _0x1effa0(_0x2950a8) { const _0xd8053 = _0xe2e12e; if (!_0x2950a8 || _0x2950a8[_0xd8053(0x327)] !== _0xd8053(0x70e)) return; const _0xa13d24 = _0xd8053(0x1bf); document[_0xd8053(0x69e)][_0xd8053(0x43f)](_0xd8053(0x168), _0xa13d24); const _0x241fad = document[_0xd8053(0x6c2)](_0xd8053(0x798)), _0x26c485 = _0x241fad['querySelector'](_0xd8053(0x73b)), _0xf09785 = document[_0xd8053(0x6c2)]('group-clear-history'), _0x4f2fd6 = document['getElementById']('group-edit-members'), _0x5dd4a4 = document[_0xd8053(0x6c2)](_0xd8053(0x62d)), _0x58332f = document[_0xd8053(0x6c2)]('group-delete'), _0x59d20c = document[_0xd8053(0x6c2)]('group-options-cancel'), _0x3bc6c5 = () => _0x241fad[_0xd8053(0x6ae)](); _0xf09785[_0xd8053(0x501)](_0xd8053(0x4bd), async () => { const _0x163fd4 = _0xd8053; _0x3bc6c5(); const _0xcfc862 = await _0x385a44(_0x163fd4(0x83a) + _0x2950a8[_0x163fd4(0x8fa)] + _0x163fd4(0x796)); if (_0xcfc862) { _0x2950a8['id'] === _0x4d4ca5[_0x163fd4(0x41f)] && (_0x5e29e2(), _0x4d4ca5[_0x163fd4(0x28d)] = [], _0x41e9e0()); try { localStorage[_0x163fd4(0x5e7)](_0x163fd4(0x201) + _0x2950a8['id']), _0x589297(_0x163fd4(0x1b4) + _0x2950a8[_0x163fd4(0x8fa)] + _0x163fd4(0x5f6)); } catch (_0x4b6845) { console[_0x163fd4(0x93a)](_0x163fd4(0x504) + _0x2950a8['id'], _0x4b6845), _0x589297(_0x163fd4(0x8ea)); } } }), _0x4f2fd6[_0xd8053(0x501)](_0xd8053(0x4bd), () => { const _0x166c30 = _0xd8053; if (_0x166c30(0x184) === _0x166c30(0x184)) _0x3bc6c5(), _0x589297(_0x166c30(0x3aa)); else { _0x18d01b['id'] === _0x2b45d2[_0x166c30(0x41f)] && (_0x197615(), _0x2047a2[_0x166c30(0x28d)] = [], _0xb29e53()); try { _0x5d5a47['removeItem']('chatHistory_' + _0x49f8c1['id']), _0xe0ca35(_0x166c30(0x1b4) + _0x27cc94[_0x166c30(0x8fa)] + _0x166c30(0x5f6)); } catch (_0x31f2c6) { _0x6b8af9['error'](_0x166c30(0x504) + _0x141665['id'], _0x31f2c6), _0x79c7dd(_0x166c30(0x8ea)); } } }), _0x5dd4a4[_0xd8053(0x501)](_0xd8053(0x4bd), async () => { const _0x10986c = _0xd8053; if ('xElzk' !== _0x10986c(0x768)) { _0x3bc6c5(); const _0x285d2a = prompt(_0x10986c(0x61a), _0x2950a8[_0x10986c(0x8fa)]); _0x285d2a && _0x285d2a[_0x10986c(0x163)]() && _0x285d2a !== _0x2950a8[_0x10986c(0x8fa)] && (_0x2950a8['name'] = _0x285d2a[_0x10986c(0x163)](), _0x42173a(), _0x505812(), _0x2cf7e8(), _0x589297(_0x10986c(0x90b) + _0x2950a8[_0x10986c(0x8fa)] + '\x22。')); } else _0x54c90f[_0x10986c(0x776)] = _0x334569, _0x2b0f98 = !![]; }), _0x58332f['addEventListener']('click', async () => { const _0x486b25 = _0xd8053; if (_0x486b25(0x654) === 'HsPaf') _0xe6685c(); else { _0x3bc6c5(); const _0x34c4f1 = await _0x385a44(_0x486b25(0x7d7) + _0x2950a8[_0x486b25(0x8fa)] + _0x486b25(0x939)); _0x34c4f1 && (_0x486b25(0x44b) !== _0x486b25(0x647) ? (_0x297bb8(_0x2950a8['id']), _0x589297(_0x486b25(0x1b4) + _0x2950a8[_0x486b25(0x8fa)] + _0x486b25(0x505)), _0x3493cf(![])) : _0x31ae67['error'](_0x486b25(0x192) + _0x281e70[_0x486b25(0x41f)], _0x2ad30f)); } }), _0x26c485[_0xd8053(0x501)](_0xd8053(0x4bd), _0x3bc6c5), _0x59d20c['addEventListener'](_0xd8053(0x4bd), _0x3bc6c5); } _0xb3850c[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x19e662 = _0xe2e12e; if (_0x19e662(0x66a) === _0x19e662(0x345)) _0x3a9afc['scrollTop'] = _0x666a12['scrollHeight']; else { const _0x84aaea = _0xa2c8b5(); if (_0x84aaea && _0x84aaea[_0x19e662(0x327)] === 'private') _0x539822(_0x84aaea[_0x19e662(0x836)][0x0]); else _0x84aaea && _0x84aaea[_0x19e662(0x327)] === 'group' && _0x543ac3(_0x84aaea['id']); } }), _0x2fbbd3['addEventListener']('keydown', _0x236764 => { const _0x45232e = _0xe2e12e; if (_0x45232e(0x2a4) !== _0x45232e(0x2a4)) { const _0x2b65bf = _0x50892e['round']((_0x5050e1 - _0x496bc9) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x445fc3 += _0x45232e(0x49d) + _0x2b65bf + '\x20天没联系了，应该用全新的问候开启对话，不要再提上次的话题了。\x0a'; } else _0x236764[_0x45232e(0x8c3)] === _0x45232e(0x161) && !_0x236764['shiftKey'] && (_0x45232e(0x6f7) !== _0x45232e(0x6f7) ? _0x45b2dd = _0x45232e(0x5f5) + _0x4ecdab[_0x45232e(0x8fa)] + '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。' : (_0x236764['preventDefault'](), _0x4527c8())); }); const _0x2c763d = () => _0x49d572['classList'][_0xe2e12e(0x6ae)]('show'); _0x29e5e9[_0xe2e12e(0x501)]('click', _0x2c763d), _0x46701b[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x2c763d), _0x96aa23[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { _0x2c763d(), _0x539822(); }), _0x225244['addEventListener']('click', () => { const _0x4a4534 = _0xe2e12e; 'EvcCG' !== 'EvcCG' ? _0x7f2887[_0x4a4534(0x776)] = _0x389485 : (_0x2c763d(), _0x4289e7()); }), _0x14cee9[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x489f24 = _0xe2e12e; _0x489f24(0x630) !== 'Tesyy' ? _0x1394d1('AI整理失败了，哼:\x20' + _0x6be0d7[_0x489f24(0x6a1)]) : (_0x113213(_0x489f24(0x60d), _0x489f24(0x4a7)), _0x3493cf(![])); }), _0x277bc1['addEventListener'](_0xe2e12e(0x4bd), _0x39c5e5), _0x2cd933[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x58d02a = _0xe2e12e; _0x58f824['classList'][_0x58d02a(0x413)](_0x58d02a(0x3a7)), _0x58f824[_0x58d02a(0x970)][_0x58d02a(0x7a5)](_0x58d02a(0x3a7)) && (_0x2468f3[_0x58d02a(0x145)] = _0x2468f3[_0x58d02a(0x2cf)]); }), _0x4c31a9['addEventListener'](_0xe2e12e(0x4bd), () => _0x19fc9a[_0xe2e12e(0x4bd)]()); const _0x26a3a7 = document['getElementById']('chat-music-button'); _0x19fc9a['addEventListener'](_0xe2e12e(0x858), _0x36c377), _0x26a3a7[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x19b541), _0x517e3d['addEventListener']('click', _0x385134), _0x7092e4[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x289bbe), _0x1a1fd1['addEventListener'](_0xe2e12e(0x4bd), _0x444db6), _0x34d241['addEventListener'](_0xe2e12e(0x4bd), _0x4d35af), _0x21e22a[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), async () => { const _0x291eda = _0xe2e12e; if ('dTRIo' === _0x291eda(0x922)) _0x398bde(); else { const _0x36de1d = _0x345646[_0x291eda(0x135)]; if (!_0x36de1d) return; const _0x4a9959 = _0x53bcef(_0x36de1d); if (!_0x4a9959) return; const _0x1cd5dc = await _0x385a44(_0x291eda(0x6ef) + _0x4a9959[_0x291eda(0x8fa)] + _0x291eda(0x7d6)); _0x1cd5dc && (_0x387742(_0x36de1d), _0x589297(_0x291eda(0x38f) + _0x4a9959[_0x291eda(0x8fa)] + _0x291eda(0x299)), _0x113213(_0x291eda(0x60d), _0x291eda(0x850)), _0x3493cf(![])); } }), _0xe8feed[_0xe2e12e(0x501)](_0xe2e12e(0x4f4), () => { const _0x47329c = _0xe2e12e, _0x42bcb6 = _0xe8feed[_0x47329c(0x135)][_0x47329c(0x163)]()[_0x47329c(0x407)](_0x59c621); _0x1a4b4c['disabled'] = _0x42bcb6; }); async function _0x2922bf() { const _0x34eae4 = _0xe2e12e, _0x1d6930 = _0xe8feed[_0x34eae4(0x135)][_0x34eae4(0x163)](), _0x397c6f = _0x15ccd7[_0x34eae4(0x135)][_0x34eae4(0x163)](); if (!_0x1d6930 || !_0x397c6f) { _0x589297(_0x34eae4(0x463)); return; } const _0x32afdc = _0x1d6930[_0x34eae4(0x2ce)](/\/+$/, ''), _0xa181df = _0x32afdc + '/v1/models'; _0x1a4b4c['disabled'] = !![], _0x1a4b4c['textContent'] = _0x34eae4(0x64c), _0x2a6f9b[_0x34eae4(0x970)]['remove'](_0x34eae4(0x3a7)); try { if (_0x34eae4(0x799) !== 'wHNwC') { const _0x1a0280 = await fetch(_0xa181df, { 'headers': { 'Authorization': 'Bearer\x20' + _0x20e943(_0x397c6f) } }); if (!_0x1a0280['ok']) throw new Error(_0x34eae4(0x301) + _0x1a0280[_0x34eae4(0x1cc)]); const _0x166a46 = await _0x1a0280[_0x34eae4(0x273)](), _0x44c193 = (_0x166a46[_0x34eae4(0x67c)] || _0x166a46)['map'](_0x3e12d9 => _0x3e12d9['id'])['sort'](); _0x44c193[_0x34eae4(0x2bd)] > 0x0 ? _0x34eae4(0x24a) !== _0x34eae4(0x24a) ? _0x7eedb5 += _0x34eae4(0x55b) : (_0x2a6f9b[_0x34eae4(0x978)] = '', _0x44c193[_0x34eae4(0x279)](_0x47f1f9 => { const _0x192778 = _0x34eae4; if ('afdLO' !== _0x192778(0x49b)) { const _0x178d6c = document['createElement'](_0x192778(0x46f)); _0x178d6c[_0x192778(0x806)] = _0x47f1f9, _0x178d6c[_0x192778(0x501)](_0x192778(0x4bd), () => { const _0x171b49 = _0x192778; _0x171b49(0x178) !== _0x171b49(0x791) ? (_0x2059a1[_0x171b49(0x135)] = _0x47f1f9, _0x2a6f9b[_0x171b49(0x970)]['remove'](_0x171b49(0x3a7))) : _0x1812d6(_0x5ec641['coverId'])[_0x171b49(0x588)](_0x2d7523 => { const _0x23c29d = _0x171b49, _0x5cdcde = _0x583d22['getElementById'](_0x22f4a4); if (_0x5cdcde && _0x2d7523) _0x5cdcde[_0x23c29d(0x6c3)] = _0x3f9efb[_0x23c29d(0x1de)](_0x2d7523); }); }), _0x2a6f9b[_0x192778(0x54e)](_0x178d6c); } else { if (_0x354142[_0x192778(0x5fa)]) _0x39e67e(_0x1f676d[_0x192778(0x5fa)]); } }), _0x2a6f9b[_0x34eae4(0x970)][_0x34eae4(0x68a)](_0x34eae4(0x3a7)), _0x589297(_0x34eae4(0x5a3) + _0x44c193[_0x34eae4(0x2bd)] + _0x34eae4(0x947))) : _0x589297(_0x34eae4(0x363)); } else _0x5e1fac[_0x34eae4(0x6c2)](_0x34eae4(0x887))[_0x34eae4(0x135)] = '', _0x315d52[_0x34eae4(0x6c2)]('user-profile-edit-title')[_0x34eae4(0x806)] = _0x34eae4(0x35d), _0x566984[_0x34eae4(0x6c2)](_0x34eae4(0x92b))['value'] = _0x34eae4(0x434) + (_0x2eccdc[_0x34eae4(0x26d)][_0x34eae4(0x2bd)] + 0x1), _0x1f73e6[_0x34eae4(0x6c2)](_0x34eae4(0x533))[_0x34eae4(0x6c3)] = _0x274f21, _0x2aa259[_0x34eae4(0x6c2)](_0x34eae4(0x15d))[_0x34eae4(0x135)] = '', _0x4d9b56[_0x34eae4(0x645)][_0x34eae4(0x23e)] = 'none'; } catch (_0x4426e0) { _0x589297(_0x34eae4(0x3bf) + _0x4426e0[_0x34eae4(0x6a1)] + _0x34eae4(0x780)); } finally { _0x1a4b4c[_0x34eae4(0x152)] = ![], _0x1a4b4c[_0x34eae4(0x806)] = '获取'; } } _0x1a4b4c[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0xfd420f => { _0xfd420f['stopPropagation'](), _0x2922bf(); }), document[_0xe2e12e(0x501)]('click', _0x3a9a1c => { const _0x2d5688 = _0xe2e12e; !_0x2a6f9b['contains'](_0x3a9a1c[_0x2d5688(0x68b)]) && _0x3a9a1c[_0x2d5688(0x68b)] !== _0x2059a1 && _0x3a9a1c[_0x2d5688(0x68b)] !== _0x1a4b4c && _0x2a6f9b[_0x2d5688(0x970)][_0x2d5688(0x6ae)](_0x2d5688(0x3a7)); }); async function _0x13257f(_0x25bd18) { const _0x1e96ec = _0xe2e12e; if (_0x1e96ec(0x48b) === 'vrJot') return await _0x46f332(_0x25bd18, 0x190, 0.85); else _0x247147(), _0x495279(_0x1e96ec(0x84c), _0x1e96ec(0x54a)); } _0x5b2cba[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0xb97413[_0xe2e12e(0x4bd)]()), _0xb97413[_0xe2e12e(0x501)](_0xe2e12e(0x858), async _0x3745c8 => { const _0x391e5b = _0xe2e12e, _0x4341d0 = _0x3745c8[_0x391e5b(0x68b)][_0x391e5b(0x4c0)][0x0]; if (!_0x4341d0) return; try { const _0x4175be = await _0x13257f(_0x4341d0); _0x5b2cba[_0x391e5b(0x6c3)] = _0x4175be; } catch (_0xd1678e) { if (_0x391e5b(0x5a4) !== _0x391e5b(0x43c)) _0x589297('错误:\x20' + _0xd1678e[_0x391e5b(0x6a1)]); else { const _0x1f58a8 = _0x1be694[_0x391e5b(0x6c2)](_0x391e5b(0x959)); if (!_0x1f58a8) return; _0x1f58a8[_0x391e5b(0x5a7)] = _0xe8b043[_0x391e5b(0x2d6)][_0x391e5b(0x4d0)] || ![], _0x1f58a8['addEventListener'](_0x391e5b(0x858), () => { const _0x515c14 = _0x391e5b; _0x43a998[_0x515c14(0x2d6)][_0x515c14(0x4d0)] = _0x1f58a8[_0x515c14(0x5a7)], _0x3eb988(), _0xb8911c(); }); } } }), _0x1a9c5b['addEventListener']('click', () => _0x3f784a['click']()), _0x3f784a['addEventListener'](_0xe2e12e(0x858), async _0x20066d => { const _0x5a4d0b = _0xe2e12e, _0x1af7fa = _0x20066d[_0x5a4d0b(0x68b)][_0x5a4d0b(0x4c0)][0x0]; if (!_0x1af7fa) return; try { _0x1a9c5b[_0x5a4d0b(0x6c3)] = await _0x13257f(_0x1af7fa); } catch (_0x556454) { _0x5a4d0b(0x61d) !== 'NnNTD' ? (_0xe4e9aa[_0x5a4d0b(0x327)] = _0x5a4d0b(0x513), _0x46b00b['assign'](_0x236361, _0x25bcf4)) : _0x589297(_0x5a4d0b(0x67a) + _0x556454['message']); } }); function _0x135b47() { const _0x53bf2b = _0xe2e12e; _0x58f824[_0x53bf2b(0x978)] = '', _0x2e6858['forEach'](_0xbc0029 => { const _0x592f2e = _0x53bf2b, _0x50e40f = document['createElement'](_0x592f2e(0x992)); _0x50e40f[_0x592f2e(0x6c3)] = _0xbc0029[_0x592f2e(0x6b8)], _0x50e40f[_0x592f2e(0x3ce)] = _0x592f2e(0x982), _0x50e40f[_0x592f2e(0x8f6)] = _0xbc0029[_0x592f2e(0x8fa)], _0x50e40f[_0x592f2e(0x970)][_0x592f2e(0x68a)](_0x592f2e(0x3b5)), _0x50e40f['addEventListener'](_0x592f2e(0x4bd), () => _0x5d67e1(_0xbc0029)), _0x58f824[_0x592f2e(0x54e)](_0x50e40f); }); } function _0x14b003() { const _0x15d058 = _0xe2e12e; if (_0x15d058(0x372) === 'xoESO') { const _0x6bc6d9 = document[_0x15d058(0x6c2)]('user-profile-list-container'); _0x6bc6d9[_0x15d058(0x978)] = ''; if (_0x4d4ca5[_0x15d058(0x26d)][_0x15d058(0x2bd)] === 0x0) { if (_0x15d058(0x5ed) !== _0x15d058(0x7c5)) { _0x6bc6d9[_0x15d058(0x978)] = _0x15d058(0x8fb); return; } else _0x1c61e3[_0x15d058(0x94e)][_0x15d058(0x5b0)](_0x15d058(0x9a2)); } _0x4d4ca5[_0x15d058(0x26d)]['forEach'](_0x8e7350 => { const _0x2158dd = _0x15d058; if ('GTNkP' === _0x2158dd(0x589)) { _0x51dd86 = _0x149ec8[_0x2158dd(0x53f)][_0x2158dd(0x5a8)](_0x35b0d6 => _0x35b0d6[_0x2158dd(0x327)] === _0x2158dd(0x17c) && _0x35b0d6[_0x2158dd(0x836)][_0x2158dd(0x407)](_0x53dd01)); const _0x7e9fb6 = _0x3feec4(_0x20249d); _0x3e006d = _0x7e9fb6 ? _0x7e9fb6[_0x2158dd(0x8fa)] : _0x2158dd(0x574); } else { const _0x4d76aa = document[_0x2158dd(0x82b)](_0x2158dd(0x46f)); _0x4d76aa[_0x2158dd(0x255)] = 'world-book-item', _0x4d76aa['dataset']['id'] = _0x8e7350['id']; const _0xf24d2d = _0x8e7350['id'] === _0x4d4ca5['activeUserProfileId'] ? '\x20(当前)' : ''; _0x4d76aa[_0x2158dd(0x978)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x8e7350[_0x2158dd(0x86f)] || _0x4abe2b) + _0x2158dd(0x30a) + _0x8e7350[_0x2158dd(0x8fa)] + _0xf24d2d + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x8e7350[_0x2158dd(0x7d5)][_0x2158dd(0x8a1)](0x0, 0x64) + _0x2158dd(0x7be), _0x4d76aa['addEventListener'](_0x2158dd(0x4bd), () => _0x4c6ef1(_0x8e7350['id'])), _0x6bc6d9[_0x2158dd(0x54e)](_0x4d76aa); } }); } else _0x2e060b(!![]); } function _0x4c6ef1(_0x91e566 = null) { const _0x2bb08c = _0xe2e12e; _0x113213(_0x2bb08c(0x473), 'userProfileList'); const _0x4632e3 = document['getElementById'](_0x2bb08c(0x211)); if (_0x91e566) { const _0xdd74cf = _0x4d4ca5[_0x2bb08c(0x26d)]['find'](_0x219208 => _0x219208['id'] === _0x91e566); if (!_0xdd74cf) return; document[_0x2bb08c(0x6c2)](_0x2bb08c(0x887))[_0x2bb08c(0x135)] = _0xdd74cf['id'], document[_0x2bb08c(0x6c2)](_0x2bb08c(0x680))[_0x2bb08c(0x806)] = _0x2bb08c(0x7b6), document[_0x2bb08c(0x6c2)](_0x2bb08c(0x92b))[_0x2bb08c(0x135)] = _0xdd74cf['name'], document['getElementById'](_0x2bb08c(0x533))[_0x2bb08c(0x6c3)] = _0xdd74cf[_0x2bb08c(0x86f)], document['getElementById'](_0x2bb08c(0x15d))[_0x2bb08c(0x135)] = _0xdd74cf[_0x2bb08c(0x7d5)], _0x4632e3[_0x2bb08c(0x645)][_0x2bb08c(0x23e)] = _0xdd74cf['id'] === _0x4d4ca5[_0x2bb08c(0x4f1)] ? 'none' : _0x2bb08c(0x2a9); } else document['getElementById'](_0x2bb08c(0x887))[_0x2bb08c(0x135)] = '', document[_0x2bb08c(0x6c2)](_0x2bb08c(0x680))[_0x2bb08c(0x806)] = _0x2bb08c(0x35d), document['getElementById'](_0x2bb08c(0x92b))[_0x2bb08c(0x135)] = _0x2bb08c(0x434) + (_0x4d4ca5[_0x2bb08c(0x26d)][_0x2bb08c(0x2bd)] + 0x1), document[_0x2bb08c(0x6c2)](_0x2bb08c(0x533))[_0x2bb08c(0x6c3)] = _0x4abe2b, document[_0x2bb08c(0x6c2)](_0x2bb08c(0x15d))[_0x2bb08c(0x135)] = '', _0x4632e3[_0x2bb08c(0x645)][_0x2bb08c(0x23e)] = _0x2bb08c(0x4aa); } function _0x289bbe() { const _0xd3329b = _0xe2e12e, _0x56d5c1 = document[_0xd3329b(0x6c2)](_0xd3329b(0x887))['value'], _0x1df1fe = { 'name': document[_0xd3329b(0x6c2)](_0xd3329b(0x92b))['value']['trim'](), 'persona': document[_0xd3329b(0x6c2)](_0xd3329b(0x15d))[_0xd3329b(0x135)]['trim'](), 'avatar': document['getElementById'](_0xd3329b(0x533))[_0xd3329b(0x6c3)] }; if (!_0x1df1fe[_0xd3329b(0x8fa)]) { if (_0xd3329b(0x8be) === _0xd3329b(0x8be)) { _0x589297('名字不能为空！'); return; } else _0x2b6559[_0xd3329b(0x177)] = { 'sender': _0x34668a[0x1][_0xd3329b(0x163)](), 'content': _0x232bea[0x2]['trim']() }, _0x2d2874[_0xd3329b(0x7af)] = _0x41c72f[_0xd3329b(0x8a1)](_0x1bc0b6[0x0][_0xd3329b(0x2bd)])[_0xd3329b(0x163)](); } if (_0x56d5c1) { const _0x2ba84b = _0x4d4ca5[_0xd3329b(0x26d)][_0xd3329b(0x5a8)](_0x41c59b => _0x41c59b['id'] === _0x56d5c1); if (_0x2ba84b) Object[_0xd3329b(0x71b)](_0x2ba84b, _0x1df1fe); } else { if ('IPiPL' === 'daKPQ') { if (_0x1f84d2[_0xd3329b(0x16e)]()[_0xd3329b(0x823)]()) return; const _0x412fba = _0x448417[_0xd3329b(0x68b)][_0xd3329b(0x863)]('.message-container'), _0x1df0dd = _0xa56b8c['target'][_0xd3329b(0x863)](_0xd3329b(0x96d)); if (!_0x412fba || _0x1df0dd) return; const _0x104489 = _0x507e4f(_0x412fba[_0xd3329b(0x42a)][_0xd3329b(0x384)], 0xa); if (_0x59cdae(_0x104489)) return; _0x3b04b3(_0x104489); } else { const _0x479403 = { 'id': _0xd3329b(0x22b) + Date[_0xd3329b(0x661)](), ..._0x1df1fe }; _0x4d4ca5['userProfiles'][_0xd3329b(0x956)](_0x479403), !_0x4d4ca5[_0xd3329b(0x4f1)] && (_0x4d4ca5[_0xd3329b(0x4f1)] = _0x479403['id']); } } _0x42173a(), _0x589297(_0xd3329b(0x565)), _0x14b003(), _0x113213('userProfileList', 'userProfile'); } async function _0x1a0fb9() { const _0x5f3f31 = _0xe2e12e, _0x27119b = document[_0x5f3f31(0x6c2)]('editing-user-id')[_0x5f3f31(0x135)]; if (!_0x27119b) return; if (_0x4d4ca5[_0x5f3f31(0x26d)][_0x5f3f31(0x2bd)] <= 0x1) { _0x589297('至少要保留一个用户。'); return; } const _0x46214b = await _0x385a44(_0x5f3f31(0x935)); _0x46214b && (_0x4d4ca5['userProfiles'] = _0x4d4ca5[_0x5f3f31(0x26d)]['filter'](_0x5dad8b => _0x5dad8b['id'] !== _0x27119b), _0x4d4ca5[_0x5f3f31(0x4f1)] === _0x27119b && (_0x5f3f31(0x1fe) === _0x5f3f31(0x60f) ? (_0x5b6aba[_0x5f3f31(0x645)][_0x5f3f31(0x21c)] = _0x5f3f31(0x41e) + _0x3c8d25['chatWallpaper'] + '\x27)', _0x1a513d[_0x5f3f31(0x645)][_0x5f3f31(0x19d)] = _0x5f3f31(0x2b6), _0x408e86[_0x5f3f31(0x645)]['backgroundPosition'] = _0x5f3f31(0x89e)) : _0x4d4ca5['activeUserProfileId'] = _0x4d4ca5['userProfiles'][0x0]['id']), _0x4d4ca5[_0x5f3f31(0x53f)]['forEach'](_0x124ec0 => { const _0x3cb290 = _0x5f3f31; if (_0x124ec0['boundUserProfileId'] === _0x27119b) { if ('aUron' !== 'tWDBg') _0x124ec0[_0x3cb290(0x757)] = _0x4d4ca5[_0x3cb290(0x4f1)]; else { const _0x40e8e4 = _0x3197c6(_0x5aa7c2[_0x3cb290(0x8b5)]['charId']); _0x40e8e4 && (_0x1c90dd = _0x3cb290(0x755) + _0x40e8e4[_0x3cb290(0x86f)] + '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22></div><div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22><div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>' + _0x40e8e4['name'] + _0x3cb290(0x6b2) + _0x3347ef[_0x3cb290(0x8b5)][_0x3cb290(0x57b)] + _0x3cb290(0x940)); } } }), _0x42173a(), _0x589297(_0x5f3f31(0x50d)), _0x14b003(), _0x113213(_0x5f3f31(0x4e1), _0x5f3f31(0x473))); } function _0x8b1351() { const _0x41c9ec = _0xe2e12e, _0x5849e9 = document[_0x41c9ec(0x6c2)]('world-book-list-container'); _0x5849e9[_0x41c9ec(0x978)] = ''; if (_0x4d4ca5[_0x41c9ec(0x7ea)][_0x41c9ec(0x2bd)] === 0x0) { _0x5849e9[_0x41c9ec(0x978)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>'; return; } _0x4d4ca5[_0x41c9ec(0x7ea)][_0x41c9ec(0x279)](_0x3141c3 => { const _0x45e10a = _0x41c9ec; if (_0x45e10a(0x6fc) === 'fMaOk') return new _0x439918(_0x41bb0a => { const _0x3192a0 = _0x45e10a, _0x54ccd0 = _0x3192a0(0x474); _0x48d892['body'][_0x3192a0(0x43f)](_0x3192a0(0x168), _0x54ccd0); const _0x350e19 = _0x17fc1c[_0x3192a0(0x6c2)](_0x3192a0(0x641)), _0x4b317b = _0x924bc['getElementById'](_0x3192a0(0x3d4)), _0x328eb5 = _0x6f3db7[_0x3192a0(0x6c2)](_0x3192a0(0x1b7)), _0xd15c80 = _0x544aeb[_0x3192a0(0x6c2)]('diary-modal-cancel'), _0x750b6f = _0x350e19['querySelector']('.choice-modal-backdrop'), _0x66ebc4 = () => { _0x350e19['remove'](), _0x41bb0a(); }; _0x328eb5[_0x3192a0(0x254)] = () => { _0x1b1ab0(_0x4b317b['value']), _0x66ebc4(); }, _0xd15c80['onclick'] = _0x66ebc4, _0x750b6f[_0x3192a0(0x254)] = _0x66ebc4; }); else { const _0x197f81 = document[_0x45e10a(0x82b)]('div'); _0x197f81[_0x45e10a(0x255)] = 'world-book-item', _0x197f81[_0x45e10a(0x42a)]['id'] = _0x3141c3['id'], _0x197f81['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0x3141c3['name'] + _0x45e10a(0x53d) + _0x3141c3[_0x45e10a(0x7af)]['substring'](0x0, 0x64) + _0x45e10a(0x396), _0x197f81[_0x45e10a(0x501)](_0x45e10a(0x4bd), () => _0x23d3bf(_0x3141c3['id'])), _0x5849e9[_0x45e10a(0x54e)](_0x197f81); } }); } function _0x23d3bf(_0x466afc = null) { const _0x6c2859 = _0xe2e12e; if (_0x6c2859(0x515) !== _0x6c2859(0x147)) { _0x113213(_0x6c2859(0x945), _0x6c2859(0x37f)); if (_0x466afc) { if ('MmCYS' === _0x6c2859(0x467)) { const _0xe2064e = _0x4d4ca5[_0x6c2859(0x7ea)][_0x6c2859(0x5a8)](_0x1a15bc => _0x1a15bc['id'] === _0x466afc); if (!_0xe2064e) return; document['getElementById'](_0x6c2859(0x4f3))[_0x6c2859(0x135)] = _0xe2064e['id'], document['getElementById'](_0x6c2859(0x77d))[_0x6c2859(0x806)] = _0x6c2859(0x868), document[_0x6c2859(0x6c2)](_0x6c2859(0x457))[_0x6c2859(0x135)] = _0xe2064e[_0x6c2859(0x8fa)], document[_0x6c2859(0x6c2)](_0x6c2859(0x323))[_0x6c2859(0x135)] = _0xe2064e[_0x6c2859(0x7af)]; } else _0x47de3e(_0x3c6750); } else { if (_0x6c2859(0x5f8) !== 'XSPaR') document[_0x6c2859(0x6c2)](_0x6c2859(0x4f3))[_0x6c2859(0x135)] = '', document[_0x6c2859(0x6c2)](_0x6c2859(0x77d))[_0x6c2859(0x806)] = '新建条目', document[_0x6c2859(0x6c2)](_0x6c2859(0x457))[_0x6c2859(0x135)] = '', document['getElementById'](_0x6c2859(0x323))[_0x6c2859(0x135)] = ''; else { const _0x4df9fe = _0x4d9275(_0x2ebec7); if (!_0x4df9fe) return; _0x486df6[_0x6c2859(0x376)] = _0x4a59ae; const _0x2ec79e = _0x4089c2['diaries'][_0x6c2859(0x5a8)](_0x546340 => _0x546340[_0x6c2859(0x6e8)] === _0x39942b), _0x24c272 = _0x2ec79e ? _0x2ec79e['entries'][_0x6c2859(0x2bd)] : 0x0, _0x2c7473 = 0x2; _0x119ff7[_0x6c2859(0x7f5)] = _0x95026[_0x6c2859(0x1e3)](0x0, _0x2d4846[_0x6c2859(0x566)](_0x24c272 / _0x2c7473) - 0x1), _0x5816db[_0x6c2859(0x6c2)](_0x6c2859(0x640))['textContent'] = _0x4df9fe['name'] + _0x6c2859(0x5b2), _0x1c8cbb(), _0x4b36df('diaryView', _0x6c2859(0x342)); } } } else _0x549bfc[_0x6c2859(0x2e7)](), _0x29fa1d[_0x6c2859(0x1d8)]['writeText'](_0x2f4c6f[_0x6c2859(0x135)])[_0x6c2859(0x588)](() => { _0xd304f3('已复制到剪贴板！'); })[_0x6c2859(0x76c)](_0x3066e8 => { const _0x190d4d = _0x6c2859; _0x422f7f(_0x190d4d(0x448)); }); } function _0x11a566() { const _0x42ad61 = _0xe2e12e, _0x4fa8c6 = document[_0x42ad61(0x6c2)](_0x42ad61(0x4f3))[_0x42ad61(0x135)], _0x5b958a = document['getElementById'](_0x42ad61(0x457))[_0x42ad61(0x135)]['trim'](), _0x86e40c = document[_0x42ad61(0x6c2)]('world-book-edit-content')[_0x42ad61(0x135)][_0x42ad61(0x163)](); if (!_0x5b958a || !_0x86e40c) { _0x589297(_0x42ad61(0x88f)); return; } if (_0x4fa8c6) { if (_0x42ad61(0x3ef) !== 'pkMlz') _0x3f160b[_0x42ad61(0x956)](_0x535854); else { const _0x47a2df = _0x4d4ca5['worldBooks'][_0x42ad61(0x5a8)](_0x9b1c05 => _0x9b1c05['id'] === _0x4fa8c6); _0x47a2df && ('dINoO' === _0x42ad61(0x5fc) ? _0x15d4e9 ? _0x47450d(_0x4886bb) : _0x5a9dc7(new _0x39d999(_0x42ad61(0x3b3))) : (_0x47a2df['name'] = _0x5b958a, _0x47a2df[_0x42ad61(0x7af)] = _0x86e40c)); } } else { if (_0x42ad61(0x8c4) === _0x42ad61(0x6b5)) { if (_0x2fa8ff[_0x42ad61(0x327)] === _0x42ad61(0x8c6)) _0x4d1dfa[_0x42ad61(0x955)](); _0xfee89e(_0x3b94a5); } else { const _0x181266 = { 'id': _0x42ad61(0x3a3) + Date['now'](), 'name': _0x5b958a, 'content': _0x86e40c }; _0x4d4ca5['worldBooks'][_0x42ad61(0x956)](_0x181266); } } _0x42173a(), _0x589297(_0x42ad61(0x3d2)), _0x8b1351(), _0x113213(_0x42ad61(0x37f), _0x42ad61(0x945)); } async function _0xd1936() { const _0x3f28ed = _0xe2e12e; if (_0x3f28ed(0x88b) === _0x3f28ed(0x212)) _0x376c4e[_0x3f28ed(0x955)](), _0x174d30(); else { const _0x558e6a = document['getElementById']('editing-world-book-id')[_0x3f28ed(0x135)]; if (!_0x558e6a) return; const _0x45190e = await _0x385a44(_0x3f28ed(0x9ba)); _0x45190e && (_0x4d4ca5[_0x3f28ed(0x7ea)] = _0x4d4ca5[_0x3f28ed(0x7ea)][_0x3f28ed(0x5fe)](_0x3de19f => _0x3de19f['id'] !== _0x558e6a), _0x4d4ca5['characters'][_0x3f28ed(0x279)](_0x515c71 => { const _0x1fe24a = _0x3f28ed; _0x515c71['linkedWorldBookIds'] && (_0x515c71['linkedWorldBookIds'] = _0x515c71['linkedWorldBookIds'][_0x1fe24a(0x5fe)](_0x54092f => _0x54092f !== _0x558e6a)); }), _0x42173a(), _0x589297('条目已删除。'), _0x8b1351(), _0x113213(_0x3f28ed(0x37f), _0x3f28ed(0x945))); } } function _0xabd00f() { const _0xac6a81 = _0xe2e12e; if (_0xac6a81(0x740) === _0xac6a81(0x740)) { const _0x75efac = document[_0xac6a81(0x6c2)](_0xac6a81(0x7d8)), _0x38f436 = _0x75efac[_0xac6a81(0x445)]('input:checked'), _0x17a826 = document['querySelector'](_0xac6a81(0x7b1)); if (_0x38f436[_0xac6a81(0x2bd)] === 0x0) _0xac6a81(0x675) === _0xac6a81(0x42f) ? _0x231003[_0xac6a81(0x752)] = null : _0x17a826[_0xac6a81(0x806)] = _0xac6a81(0x66e); else _0x38f436[_0xac6a81(0x2bd)] > 0x2 ? _0x17a826[_0xac6a81(0x806)] = _0xac6a81(0x34e) + _0x38f436[_0xac6a81(0x2bd)] + '\x20项' : _0x17a826[_0xac6a81(0x806)] = Array['from'](_0x38f436)[_0xac6a81(0x82d)](_0x29ad42 => _0x29ad42[_0xac6a81(0x95a)][_0xac6a81(0x806)]['trim']())[_0xac6a81(0x5cd)]('、'); } else _0xea0aa1[_0xac6a81(0x6ca)](), _0x264712(); } function _0x543ac3(_0x1bade1) { const _0x214089 = _0xe2e12e, _0x555ec3 = _0x4d4ca5[_0x214089(0x53f)][_0x214089(0x5a8)](_0x3a6664 => _0x3a6664['id'] === _0x1bade1); if (!_0x555ec3 || _0x555ec3[_0x214089(0x327)] !== _0x214089(0x70e)) return; document[_0x214089(0x6c2)](_0x214089(0x4b4))[_0x214089(0x135)] = _0x555ec3[_0x214089(0x8fa)] || '', _0x3a8680(_0x214089(0x744)), document[_0x214089(0x6c2)](_0x214089(0x744))[_0x214089(0x135)] = _0x555ec3['boundUserProfileId'] || _0x4d4ca5['activeUserProfileId']; const _0x3694ef = document[_0x214089(0x6c2)](_0x214089(0x89c)); _0x3694ef[_0x214089(0x978)] = '', _0x4d4ca5['worldBooks']['forEach'](_0x19798c => { const _0x39d256 = _0x214089, _0x3040b6 = _0x555ec3['linkedWorldBookIds']?.[_0x39d256(0x407)](_0x19798c['id']), _0x2d81b0 = document[_0x39d256(0x82b)](_0x39d256(0x191)); _0x2d81b0[_0x39d256(0x978)] = '<input\x20type=\x22checkbox\x22\x20value=\x22' + _0x19798c['id'] + '\x22\x20' + (_0x3040b6 ? _0x39d256(0x5a7) : '') + '>\x20' + _0x19798c[_0x39d256(0x8fa)], _0x3694ef[_0x39d256(0x54e)](_0x2d81b0); }), _0x2b3b3a(); const _0x3c30e8 = document[_0x214089(0x6c2)](_0x214089(0x2c9)), _0x176512 = document['getElementById'](_0x214089(0x2e0)); _0x299fa0('group_avatar_' + _0x1bade1)[_0x214089(0x588)](_0x5d4dae => { const _0x116cbd = _0x214089; _0x3c30e8[_0x116cbd(0x6c3)] = _0x5d4dae ? URL['createObjectURL'](_0x5d4dae) : _0x4991a9; }), _0x299fa0('group_bg_' + _0x1bade1)[_0x214089(0x588)](_0x34c1bb => { const _0x255386 = _0x214089; _0x176512[_0x255386(0x6c3)] = _0x34c1bb ? URL['createObjectURL'](_0x34c1bb) : ''; }), _0x113213('groupSettings', _0x214089(0x60d)); } async function _0x3d3927() { const _0x575be7 = _0xe2e12e; if (_0x575be7(0x80c) === _0x575be7(0x3e1)) { const _0x36a5f9 = (_0x4a59f2 - _0x4f974a) / (0x3e8 * 0x3c); _0x36a5f9 < 0x3c ? _0x5e9bb3 += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a' : _0x5cf65c += _0x575be7(0x257) + _0x2c133d[_0x575be7(0x830)](_0x36a5f9 / 0x3c) + _0x575be7(0x1bd); } else { const _0x36e4e5 = _0xa2c8b5(); if (!_0x36e4e5 || _0x36e4e5[_0x575be7(0x327)] !== _0x575be7(0x70e)) return; const _0x30b247 = document[_0x575be7(0x6c2)](_0x575be7(0x4b4))['value'][_0x575be7(0x163)](); if (!_0x30b247) { _0x589297(_0x575be7(0x1b2)); return; } _0x36e4e5[_0x575be7(0x8fa)] = _0x30b247; const _0x41ebee = document[_0x575be7(0x445)](_0x575be7(0x7c6)); _0x36e4e5[_0x575be7(0x963)] = Array[_0x575be7(0x872)](_0x41ebee)[_0x575be7(0x82d)](_0x1821cf => _0x1821cf[_0x575be7(0x135)]), _0x36e4e5[_0x575be7(0x757)] = document['getElementById']('group-settings-bind-user')['value']; const _0x3469f4 = document['getElementById']('group-avatar-input')[_0x575be7(0x4c0)][0x0], _0x147fa8 = document['getElementById'](_0x575be7(0x26a))[_0x575be7(0x4c0)][0x0]; if (_0x3469f4) await _0x34f697('group_avatar_' + _0x36e4e5['id'], _0x3469f4); if (_0x147fa8) await _0x34f697('group_bg_' + _0x36e4e5['id'], _0x147fa8); _0x42173a(), _0x2cf7e8(), await _0x505812(), _0x589297(_0x575be7(0x1d0)), _0x113213(_0x575be7(0x60d), _0x575be7(0x20f)); } } function _0x2b3b3a() { const _0x3859f2 = _0xe2e12e, _0x21ae60 = document['getElementById']('group-world-book-checkboxes'), _0x219970 = _0x21ae60[_0x3859f2(0x445)](_0x3859f2(0x380)), _0x341cb5 = document[_0x3859f2(0x5e5)](_0x3859f2(0x6bb)); if (_0x219970['length'] === 0x0) _0x341cb5[_0x3859f2(0x806)] = _0x3859f2(0x66e); else _0x219970[_0x3859f2(0x2bd)] > 0x2 ? _0x341cb5[_0x3859f2(0x806)] = '已选择\x20' + _0x219970[_0x3859f2(0x2bd)] + '\x20项' : 'YSmFE' !== _0x3859f2(0x50c) ? _0x105f05 = _0x43e88e[_0x3859f2(0x8fa)] : _0x341cb5['textContent'] = Array[_0x3859f2(0x872)](_0x219970)[_0x3859f2(0x82d)](_0x301c6b => _0x301c6b[_0x3859f2(0x95a)][_0x3859f2(0x806)][_0x3859f2(0x163)]())[_0x3859f2(0x5cd)]('、'); } async function _0x2b09b6() { const _0x16ef69 = _0xe2e12e, _0x57cddb = _0xa2c8b5(), _0x317987 = (_0x57cddb?.[_0x16ef69(0x836)] || [])[_0x16ef69(0x82d)](_0x53bcef)[_0x16ef69(0x5fe)](Boolean), _0x3c3621 = _0x55e5f6(_0x57cddb['id']); if (!_0x57cddb || _0x57cddb[_0x16ef69(0x327)] !== _0x16ef69(0x70e) || _0x317987[_0x16ef69(0x2bd)] < 0x2) return null; const _0x5aab6b = _0x57cddb[_0x16ef69(0x963)] && _0x57cddb['linkedWorldBookIds'][_0x16ef69(0x2bd)] > 0x0 ? '\x0a\x0a#\x20核心群聊世界观设定\x20(所有角色必须严格遵守以下设定)\x0a' + _0x57cddb[_0x16ef69(0x963)][_0x16ef69(0x82d)](_0x110efb => _0x4d4ca5[_0x16ef69(0x7ea)][_0x16ef69(0x5a8)](_0x54f93d => _0x54f93d['id'] === _0x110efb))[_0x16ef69(0x5fe)](Boolean)[_0x16ef69(0x82d)](_0x3ce95e => '\x0a##\x20世界书条目:\x20' + _0x3ce95e[_0x16ef69(0x8fa)] + '\x0a' + _0x3ce95e[_0x16ef69(0x7af)])[_0x16ef69(0x5cd)]('') : '', _0x3f5ee2 = _0x3c3621['persona'] ? '\x0a\x0a#\x20关于群聊参与者“' + _0x3c3621[_0x16ef69(0x8fa)] + _0x16ef69(0x849) + _0x3c3621[_0x16ef69(0x7d5)] : ''; let _0x3b6829 = ''; const _0x321275 = new Date(), _0x2e3b2e = _0x4d4ca5[_0x16ef69(0x28d)]['at'](-0x1); _0x3b6829 += _0x16ef69(0x5c0) + _0x321275[_0x16ef69(0x24f)](_0x16ef69(0x2f2), { 'dateStyle': 'full', 'timeStyle': _0x16ef69(0x8e0) }); if (_0x2e3b2e) { if (_0x16ef69(0x69c) !== _0x16ef69(0x58d)) { const _0x15490a = new Date(_0x2e3b2e['timestamp']), _0x80dad0 = Math[_0x16ef69(0x54d)]((_0x321275 - _0x15490a) / (0x3e8 * 0x3c)); if (_0x80dad0 < 0x5) _0x3b6829 += _0x16ef69(0x198); else { if (_0x80dad0 < 0x78) _0x3b6829 += _0x16ef69(0x8cd) + _0x80dad0 + _0x16ef69(0x182); else { const _0x5b6413 = Math['floor'](_0x80dad0 / 0x3c); if (_0x5b6413 < 0x30) _0x3b6829 += _0x16ef69(0x8cd) + _0x5b6413 + _0x16ef69(0x4b9); else _0x3b6829 += _0x16ef69(0x2f6) + Math['floor'](_0x5b6413 / 0x18) + _0x16ef69(0x846); } } } else _0x59ee3f[_0x16ef69(0x9a8)]({ 'behavior': _0x16ef69(0x8a3), 'block': _0x16ef69(0x983) }); } else _0x3b6829 += '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。'; const _0x31798d = [..._0x4d4ca5[_0x16ef69(0x28d)]][_0x16ef69(0x29e)]()[_0x16ef69(0x5a8)](_0x5cea2c => _0x5cea2c[_0x16ef69(0x3f7)] === _0x16ef69(0x75d))?.[_0x16ef69(0x7af)] || '', _0x28421d = _0x3af941(_0x57cddb, _0x31798d), _0x4f8cd5 = _0x4d4ca5[_0x16ef69(0x28d)][_0x16ef69(0x61e)](-0x78), _0x4417ab = _0x2e6858['map'](_0x27fbe0 => _0x27fbe0[_0x16ef69(0x8fa)]), _0xb94e78 = _0x4664bc(), _0x514418 = _0x317987[_0x16ef69(0x82d)](_0x145a7a => { const _0x2f0a47 = _0x16ef69; if (_0x2f0a47(0x34a) !== _0x2f0a47(0x34a)) _0x5aa4e7[_0x2f0a47(0x7ea)] = _0x421022[_0x2f0a47(0x7ea)]; else { const { omniText: _0x3fe20f } = _0x4a974c(_0x145a7a['id'], _0x57cddb['id']), _0x1fcebf = _0x532554(_0x145a7a['id']), _0x3de00b = _0x145a7a[_0x2f0a47(0x963)] && _0x145a7a[_0x2f0a47(0x963)][_0x2f0a47(0x2bd)] > 0x0 ? _0x2f0a47(0x718) + _0x145a7a[_0x2f0a47(0x8fa)] + _0x2f0a47(0x90c) + _0x145a7a['linkedWorldBookIds']['map'](_0x7fc545 => _0x4d4ca5[_0x2f0a47(0x7ea)][_0x2f0a47(0x5a8)](_0x3c00cd => _0x3c00cd['id'] === _0x7fc545))[_0x2f0a47(0x5fe)](Boolean)[_0x2f0a47(0x82d)](_0x359e5a => '\x0a##\x20条目:\x20' + _0x359e5a[_0x2f0a47(0x8fa)] + '\x0a' + _0x359e5a[_0x2f0a47(0x7af)])[_0x2f0a47(0x5cd)]('') : ''; return { 'id': _0x145a7a['id'], 'name': _0x145a7a[_0x2f0a47(0x8fa)], 'persona': _0x145a7a[_0x2f0a47(0x7d5)] || '乐于助人的助手', 'memory': _0x3fe20f + _0x1fcebf + _0x3de00b }; } }), _0x44c4a3 = 0x5, _0x5bf31d = 0xc, _0x2e352f = '\x0a你是一个严格的JSON生成引擎。\x0a你的唯一任务是根据用户提供的指令和数据，生成一个描述角色互动的JSON对象。\x0a你的输出【必须】是、也只能是一个单一、完整、语法正确的JSON对象。\x0a严禁包含任何解释、注释、道歉、或Markdown代码块标记\x20```json。\x0a直接输出\x20{\x20\x22events\x22:\x20[...]\x20}\x20结构。\x0a'[_0x16ef69(0x163)](), _0x17ac79 = { 'instruction': (_0x16ef69(0x286) + (_0x3c3621[_0x16ef69(0x8fa)] || '用户') + _0x16ef69(0x426) + (_0x3c3621[_0x16ef69(0x8fa)] || '用户') + '”。在分析历史记录时，请记住这一点，并用此名称指代用户。\x0a-\x20【最重要】为\x20`personas`\x20列表中的【每一位】角色都规划至少一个事件(通常不少于2个)。不能遗漏任何角色。\x0a-\x20【新增规则】你可以规划\x20\x22kind\x22:\x20\x22music\x22\x20事件来分享音乐。此时，你【必须】同时提供\x20\x22songName\x22\x20和\x20\x22artist\x22\x20字段。\x0a-\x20你的首要任务是产出一个严格遵守SCHEMA、语法完全正确的、可被解析的JSON对象。\x0a-\x20若用户\x20`@`\x20了某个角色\x20(见\x20`mentioned`)，该角色应优先发言。\x0a-\x20事件总数必须控制在\x20' + _0x44c4a3 + '\x20到\x20' + _0x5bf31d + _0x16ef69(0x95c) + (_0x3c3621[_0x16ef69(0x8fa)] || '用户') + _0x16ef69(0x74f) + _0x3b6829 + '\x20\x0a' + _0x3f5ee2 + '\x0a' + _0x5aab6b + _0x16ef69(0x7ae) + _0xb94e78 + '\x0a')[_0x16ef69(0x163)](), 'personas': _0x514418, 'mentioned': _0x28421d ? { 'id': _0x28421d['id'], 'name': _0x28421d[_0x16ef69(0x8fa)] } : null, 'stickerList': _0x4417ab }, _0x53b77e = { 'type': _0x16ef69(0x7a7), 'properties': { 'events': { 'type': 'array', 'items': { 'type': _0x16ef69(0x7a7), 'required': ['senderId', _0x16ef69(0x707)], 'properties': { 'senderId': { 'type': _0x16ef69(0x338) }, 'kind': { 'type': _0x16ef69(0x338), 'enum': ['text', _0x16ef69(0x4cd), _0x16ef69(0x513)] }, 'content': { 'type': 'string' }, 'sticker': { 'type': _0x16ef69(0x338) }, 'songName': { 'type': _0x16ef69(0x338) }, 'artist': { 'type': 'string' } } } } }, 'required': [_0x16ef69(0x64f)] }, _0x270ca8 = []; _0x270ca8[_0x16ef69(0x956)]({ 'role': _0x16ef69(0x449), 'content': _0x2e352f }); for (const _0x299e85 of _0x4f8cd5) { const _0x1a41df = _0x299e85[_0x16ef69(0x3f7)] === 'ai' || _0x299e85['role'] === _0x16ef69(0x832) ? _0x16ef69(0x832) : 'user'; let _0xb00591 = { 'role': _0x1a41df, 'content': _0x299e85[_0x16ef69(0x7af)] }, _0x224172 = !!_0x299e85[_0x16ef69(0x7af)], _0x4fbc6f = null; if (_0x299e85[_0x16ef69(0x776)]) _0x4fbc6f = _0x299e85['image']; else { if (_0x299e85['imageId']) try { const _0x3f6a2c = await _0x299fa0(_0x299e85[_0x16ef69(0x714)]); if (_0x3f6a2c) { if ('Spgmd' !== _0x16ef69(0x997)) { const _0x181901 = _0x3d5402(_0x42bfe3[_0x16ef69(0x836)][0x0]); return _0x181901?.[_0x16ef69(0x8fa)] || 'AI'; } else _0x4fbc6f = await _0x1ac482(_0x3f6a2c); } } catch (_0x1a0a3b) { console[_0x16ef69(0x93a)]('在准备群聊API数据时，读取图片失败:', _0x1a0a3b); } } _0x4fbc6f && (_0xb00591[_0x16ef69(0x776)] = _0x4fbc6f, _0x224172 = !![]); if (_0x224172) { if ('aiYAx' === _0x16ef69(0x883)) { const _0x3014c0 = _0x42427a[_0x16ef69(0x82b)]('img'); _0x3014c0['src'] = _0x3db9a1[_0x16ef69(0x6b8)], _0x3014c0[_0x16ef69(0x3ce)] = _0x16ef69(0x982), _0x3014c0[_0x16ef69(0x8f6)] = _0x45100b[_0x16ef69(0x8fa)], _0x3014c0[_0x16ef69(0x970)][_0x16ef69(0x68a)](_0x16ef69(0x3b5)), _0x3014c0[_0x16ef69(0x501)](_0x16ef69(0x4bd), () => _0x22f862(_0x1595d2)), _0x2e4a5a[_0x16ef69(0x54e)](_0x3014c0); } else _0x270ca8['push'](_0xb00591); } } _0x270ca8['push']({ 'role': _0x16ef69(0x75d), 'content': _0x16ef69(0x6f0) + JSON[_0x16ef69(0x822)](_0x53b77e) + _0x16ef69(0x230) + JSON[_0x16ef69(0x822)](_0x17ac79) }); try { if (_0x16ef69(0x5f3) !== 'LWKjN') { const _0x24994e = await _0xc7a378(_0x270ca8, { 'json': !![] }); if (!_0x24994e) return null; let _0x2b4681 = _0x24994e[_0x16ef69(0x163)](); const _0x38c764 = _0x2b4681['match'](/```json([\s\S]*?)```/i); if (_0x38c764) _0x2b4681 = _0x38c764[0x1][_0x16ef69(0x163)](); _0x2b4681 = _0x1829b9(_0x2b4681); let _0x4b4a50 = null; try { _0x16ef69(0x1b9) === _0x16ef69(0x137) ? _0x35c00c(_0x16ef69(0x3bd) + _0x236543[_0x16ef69(0x6a1)]) : _0x4b4a50 = JSON[_0x16ef69(0x213)](_0x2b4681); } catch (_0x1a4f5c) { console['error'](_0x16ef69(0x55d), _0x1a4f5c), console[_0x16ef69(0x93a)]('收到的原始、有问题的文本:', _0x2b4681); } if (!_0x4b4a50 || !Array['isArray'](_0x4b4a50[_0x16ef69(0x64f)])) return null; return _0x4b4a50 = _0x3f9ea2(_0x4b4a50, _0x317987, _0x4417ab), _0x4b4a50[_0x16ef69(0x64f)] = _0x4b4a50[_0x16ef69(0x64f)][_0x16ef69(0x61e)](0x0, _0x5bf31d), _0x4b4a50[_0x16ef69(0x64f)][_0x16ef69(0x2bd)] ? _0x4b4a50 : null; } else _0x4c9e0a = _0x375a40[_0x16ef69(0x8fa)], _0x2ceba8 = _0x36164e[_0x16ef69(0x86f)]; } catch (_0x274aac) { return _0x274aac[_0x16ef69(0x8fa)] !== _0x16ef69(0x33a) && ('nwVPi' === _0x16ef69(0x284) ? _0x62816a = _0x32b05e[_0x16ef69(0x26d)][0x0] : console[_0x16ef69(0x93a)](_0x16ef69(0x36e), _0x274aac)), null; } } function _0x4b43d6() { const _0x4975bd = _0xe2e12e, _0x3f39c2 = document[_0x4975bd(0x6c2)](_0x4975bd(0x97a)); _0x3f39c2[_0x4975bd(0x978)] = ''; if (_0x4d4ca5[_0x4975bd(0x54c)][_0x4975bd(0x2bd)] === 0x0) { _0x3f39c2['innerHTML'] = _0x4975bd(0x354); return; } _0x4d4ca5[_0x4975bd(0x54c)][_0x4975bd(0x279)](_0x3dd9e6 => { const _0x4bdb80 = _0x4975bd, _0x5ef431 = _0x4d4ca5[_0x4bdb80(0x26d)]['find'](_0x2d8b8 => _0x2d8b8['id'] === _0x3dd9e6[_0x4bdb80(0x757)]) || { 'name': _0x4bdb80(0x833) }, _0x3d2ad5 = document[_0x4bdb80(0x82b)]('div'); _0x3d2ad5['className'] = _0x4bdb80(0x29b), _0x3d2ad5[_0x4bdb80(0x42a)]['id'] = _0x3dd9e6['id'], _0x3d2ad5['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0x3dd9e6['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20' + _0x5ef431[_0x4bdb80(0x8fa)] + _0x4bdb80(0x993) + _0x3dd9e6[_0x4bdb80(0x6fe)][_0x4bdb80(0x2bd)] + _0x4bdb80(0x984), _0x3d2ad5[_0x4bdb80(0x501)](_0x4bdb80(0x4bd), () => _0x54565e(_0x3dd9e6['id'])), _0x3f39c2['appendChild'](_0x3d2ad5); }); } function _0x57f695(_0x420cb9 = null) { const _0x31d3a6 = _0xe2e12e; if (_0x31d3a6(0x658) !== _0x31d3a6(0x470)) { const _0x5904b7 = document[_0x31d3a6(0x6c2)](_0x31d3a6(0x941)), _0x4115d4 = document[_0x31d3a6(0x6c2)](_0x31d3a6(0x2ba)), _0xb7be93 = document['getElementById'](_0x31d3a6(0x918)), _0x43fa2e = document['getElementById']('friend-circle-edit-title'), _0x2c192f = document[_0x31d3a6(0x6c2)](_0x31d3a6(0x85d)), _0x59fc0f = document[_0x31d3a6(0x6c2)]('delete-friend-circle-button'); _0x3a8680('friend-circle-edit-bind-user'), _0xb7be93[_0x31d3a6(0x978)] = '', _0x4d4ca5[_0x31d3a6(0x4ee)][_0x31d3a6(0x279)](_0x1c5574 => { const _0x2a1edb = _0x31d3a6, _0x3b7d9b = document[_0x2a1edb(0x82b)](_0x2a1edb(0x46f)); _0x3b7d9b['className'] = 'member-selection-item', _0x3b7d9b[_0x2a1edb(0x978)] = _0x2a1edb(0x50a) + _0x1c5574['id'] + _0x2a1edb(0x700) + _0x1c5574['id'] + _0x2a1edb(0x985) + (_0x1c5574[_0x2a1edb(0x86f)] || _0x4991a9) + _0x2a1edb(0x57a) + _0x1c5574['id'] + '\x22\x20class=\x22char-name\x22>' + _0x1c5574['name'] + _0x2a1edb(0x670), _0xb7be93[_0x2a1edb(0x54e)](_0x3b7d9b); }); if (_0x420cb9) { const _0x23cf19 = _0x4d4ca5[_0x31d3a6(0x54c)][_0x31d3a6(0x5a8)](_0xcbebd5 => _0xcbebd5['id'] === _0x420cb9); if (!_0x23cf19) return; _0x43fa2e[_0x31d3a6(0x806)] = _0x31d3a6(0x6b9), _0x2c192f[_0x31d3a6(0x135)] = _0x23cf19['id'], _0x5904b7[_0x31d3a6(0x135)] = _0x23cf19[_0x31d3a6(0x8fa)], _0x4115d4[_0x31d3a6(0x135)] = _0x23cf19[_0x31d3a6(0x757)], _0x59fc0f[_0x31d3a6(0x645)]['display'] = 'block', _0x23cf19[_0x31d3a6(0x6fe)][_0x31d3a6(0x279)](_0x4d8468 => { const _0x2f549a = _0x31d3a6; if (_0x2f549a(0x18b) !== _0x2f549a(0x2b4)) { const _0x3a2df5 = _0xb7be93['querySelector'](_0x2f549a(0x672) + _0x4d8468); if (_0x3a2df5) _0x3a2df5[_0x2f549a(0x5a7)] = !![]; } else { _0x11043e[_0x2f549a(0x53f)] = _0x5a8715['chats'][_0x2f549a(0x5fe)](_0x5619ed => _0x5619ed['id'] !== _0x27191f); try { _0x4987f3[_0x2f549a(0x5e7)]('chatHistory_' + _0x2da86a); } catch (_0x34c07c) { _0x35aade[_0x2f549a(0x93a)](_0x2f549a(0x4b5) + _0x136442, _0x34c07c); } _0xfb4219[_0x2f549a(0x41f)] === _0x2ea9f1 && (_0x3763c3['activeChatId'] = _0x26950e[_0x2f549a(0x53f)][0x0]?.['id'] || null, _0x10070a(_0x5a99e[_0x2f549a(0x41f)])), _0x484a81(), _0x32e7cf(); } }); } else { if ('yOglv' !== _0x31d3a6(0x27d)) _0x43fa2e[_0x31d3a6(0x806)] = _0x31d3a6(0x6c5), _0x2c192f[_0x31d3a6(0x135)] = '', _0x5904b7[_0x31d3a6(0x135)] = _0x31d3a6(0x8dc) + (_0x4d4ca5['friendCircles']['length'] + 0x1), _0x4115d4[_0x31d3a6(0x135)] = _0x4d4ca5[_0x31d3a6(0x4f1)], _0x59fc0f[_0x31d3a6(0x645)][_0x31d3a6(0x23e)] = 'none'; else { const _0x2452c4 = _0x415168[_0x31d3a6(0x1de)](_0x259f37); _0x5757c9['src'] = _0x2452c4, _0x5dd1ee[_0x31d3a6(0x575)] = () => _0x347dc3[_0x31d3a6(0x3cf)](_0x2452c4); } } _0x113213(_0x31d3a6(0x821), _0x31d3a6(0x6bf)); } else _0x53789f[_0x31d3a6(0x28d)]['forEach']((_0x527f09, _0x1a8834) => _0x50dc2b(_0x527f09, _0x1a8834)); } function _0x5cd782() { const _0x19e0d4 = _0xe2e12e, _0xfc7fd8 = document[_0x19e0d4(0x6c2)]('editing-friend-circle-id')['value'], _0x344eb4 = document[_0x19e0d4(0x6c2)](_0x19e0d4(0x941))[_0x19e0d4(0x135)][_0x19e0d4(0x163)](), _0x35af21 = document[_0x19e0d4(0x6c2)](_0x19e0d4(0x2ba))[_0x19e0d4(0x135)], _0x365dee = Array['from'](document['querySelectorAll'](_0x19e0d4(0x6f4)))['map'](_0xd94516 => _0xd94516[_0x19e0d4(0x42a)]['id']); if (!_0x344eb4) { _0x589297(_0x19e0d4(0x7dd)); return; } if (_0x365dee[_0x19e0d4(0x2bd)] === 0x0) { _0x589297(_0x19e0d4(0x56f)); return; } if (_0xfc7fd8) { const _0x294434 = _0x4d4ca5['friendCircles'][_0x19e0d4(0x5a8)](_0x2a9d8b => _0x2a9d8b['id'] === _0xfc7fd8); _0x294434 && (_0x294434[_0x19e0d4(0x8fa)] = _0x344eb4, _0x294434[_0x19e0d4(0x757)] = _0x35af21, _0x294434[_0x19e0d4(0x6fe)] = _0x365dee); } else { const _0x104e3b = { 'id': _0x19e0d4(0x207) + Date['now'](), 'name': _0x344eb4, 'boundUserProfileId': _0x35af21, 'memberCharacterIds': _0x365dee, 'posts': [] }; _0x4d4ca5['friendCircles']['push'](_0x104e3b); } _0x42173a(), _0x589297(_0x19e0d4(0x973)), _0x4b43d6(), _0x113213(_0x19e0d4(0x6bf), 'friendCircleEdit'); } async function _0x142d5f() { const _0x5e0594 = _0xe2e12e; if ('OUcMC' !== _0x5e0594(0x683)) _0x2f7863(), _0x405b74(_0x5e0594(0x3aa)); else { const _0xf2327 = document[_0x5e0594(0x6c2)](_0x5e0594(0x85d))[_0x5e0594(0x135)]; if (!_0xf2327) return; const _0x2d6961 = await _0x385a44('确定要删除这个好友圈吗？此操作不可撤销。'); _0x2d6961 && (_0x4d4ca5['friendCircles'] = _0x4d4ca5[_0x5e0594(0x54c)][_0x5e0594(0x5fe)](_0x2c62d5 => _0x2c62d5['id'] !== _0xf2327), _0x4d4ca5[_0x5e0594(0x752)] === _0xf2327 && (_0x4d4ca5[_0x5e0594(0x752)] = null), _0x42173a(), _0x589297(_0x5e0594(0x4ec)), _0x4b43d6(), _0x113213(_0x5e0594(0x6bf), 'friendCircleEdit')); } } function _0x54565e(_0x466f97) { const _0x33745d = _0xe2e12e; _0x4a41db(); const _0x42ae1c = _0x4d4ca5[_0x33745d(0x54c)][_0x33745d(0x5a8)](_0x43d54f => _0x43d54f['id'] === _0x466f97); if (!_0x42ae1c) return; _0x4d4ca5[_0x33745d(0x752)] = _0x466f97, _0x42173a(), document['getElementById'](_0x33745d(0x855))['textContent'] = _0x42ae1c['name'], _0x2100d0(), _0x113213(_0x33745d(0x513), _0x33745d(0x6bf)), _0x6f8a5d(); } function _0x25849e() { const _0x14019f = _0xe2e12e; if ('yVzBu' !== 'yVzBu') { _0x772391(_0x14019f(0x473), _0x14019f(0x4e1)); const _0xef887d = _0x37e7ea[_0x14019f(0x6c2)]('set-active-user-button'); if (_0x5bd5cf) { const _0x33f2bb = _0x333931['userProfiles'][_0x14019f(0x5a8)](_0x4f90be => _0x4f90be['id'] === _0x448ba6); if (!_0x33f2bb) return; _0x48eac7['getElementById']('editing-user-id')['value'] = _0x33f2bb['id'], _0x798be6['getElementById'](_0x14019f(0x680))[_0x14019f(0x806)] = _0x14019f(0x7b6), _0x4f0097['getElementById'](_0x14019f(0x92b))[_0x14019f(0x135)] = _0x33f2bb['name'], _0x5ade6f[_0x14019f(0x6c2)](_0x14019f(0x533))[_0x14019f(0x6c3)] = _0x33f2bb[_0x14019f(0x86f)], _0x10af94[_0x14019f(0x6c2)](_0x14019f(0x15d))[_0x14019f(0x135)] = _0x33f2bb[_0x14019f(0x7d5)], _0xef887d[_0x14019f(0x645)][_0x14019f(0x23e)] = _0x33f2bb['id'] === _0x42d2f9[_0x14019f(0x4f1)] ? _0x14019f(0x4aa) : _0x14019f(0x2a9); } else _0x17311d['getElementById'](_0x14019f(0x887))['value'] = '', _0x28c381[_0x14019f(0x6c2)](_0x14019f(0x680))['textContent'] = _0x14019f(0x35d), _0x31d2dd[_0x14019f(0x6c2)]('user-name')[_0x14019f(0x135)] = '新用户\x20' + (_0x3e3d1c[_0x14019f(0x26d)][_0x14019f(0x2bd)] + 0x1), _0x20fb71[_0x14019f(0x6c2)](_0x14019f(0x533))[_0x14019f(0x6c3)] = _0x2de8ae, _0x206117['getElementById'](_0x14019f(0x15d))[_0x14019f(0x135)] = '', _0xef887d[_0x14019f(0x645)][_0x14019f(0x23e)] = 'none'; } else { if (!_0x4d4ca5[_0x14019f(0x54c)] || _0x4d4ca5[_0x14019f(0x54c)][_0x14019f(0x2bd)] === 0x0) { console['error'](_0x14019f(0x234)); return; } const _0x54b8ae = _0x4d4ca5[_0x14019f(0x54c)][0x0]; if (_0x54b8ae[_0x14019f(0x6fe)][_0x14019f(0x2bd)] < 0x2) { console[_0x14019f(0x93a)](_0x14019f(0x298) + _0x54b8ae[_0x14019f(0x8fa)] + _0x14019f(0x68d)); return; } const _0x190fcc = { 'id': _0x14019f(0x7ab) + Date[_0x14019f(0x661)](), 'authorType': _0x14019f(0x311), 'authorId': _0x54b8ae['memberCharacterIds'][0x0], 'content': _0x14019f(0x7ca), 'timestamp': Date[_0x14019f(0x661)](), 'likes': [_0x54b8ae[_0x14019f(0x6fe)][0x1]], 'comments': [{ 'commentId': 'c_' + Date['now'](), 'authorId': _0x54b8ae[_0x14019f(0x6fe)][0x1], 'content': '赞同！渲染效果一级棒！' }] }; _0x54b8ae['posts'][_0x14019f(0x956)](_0x190fcc), _0x42173a(), console[_0x14019f(0x39f)]('成功向好友圈\x20\x22' + _0x54b8ae['name'] + _0x14019f(0x586)), _0x589297(_0x14019f(0x5c6)); } } window[_0xe2e12e(0x6db)] = _0x25849e; function _0x405c17(_0x35c3a4) { const _0x19ef6a = _0xe2e12e; if (_0x19ef6a(0x695) !== _0x19ef6a(0x625)) return _0x4d4ca5[_0x19ef6a(0x26d)][_0x19ef6a(0x5a8)](_0x30e5f2 => _0x30e5f2['id'] === _0x35c3a4); else _0x1e8038[_0x19ef6a(0x93a)](_0x19ef6a(0x492), _0x2e4f46), _0x429e44[_0x19ef6a(0x6c3)] = ''; } function _0x3145a8(_0x26dbde, _0x44d708 = _0xe2e12e(0x77e)) { const _0x1c6040 = _0xe2e12e; if ('uqvoI' === 'LGQSr') _0x4fae7d = _0x270e09(() => { const _0x36f232 = _0x22cc; if (_0x31bcce[_0x36f232(0x327)] === _0x36f232(0x8c6)) _0x10e466[_0x36f232(0x955)](); _0x216cb9(_0x2a7941); }, 0x320); else { const _0x2edcd8 = document[_0x1c6040(0x6c2)]('phone-container'); let _0x175d01 = document['getElementById'](_0x1c6040(0x616)); if (_0x26dbde) { if (_0x1c6040(0x55c) === 'sendg') !_0x175d01 && (_0x175d01 = document[_0x1c6040(0x82b)]('div'), _0x175d01['id'] = _0x1c6040(0x616), _0x2edcd8[_0x1c6040(0x54e)](_0x175d01)), _0x175d01['innerHTML'] = _0x1c6040(0x4ac) + _0x44d708 + _0x1c6040(0x7d3), _0x175d01[_0x1c6040(0x645)][_0x1c6040(0x23e)] = _0x1c6040(0x381); else { const _0x958396 = _0x3cc568(_0x342391[_0x1c6040(0x41f)]); _0x387ac6 = _0x958396['avatar'] || _0x5c2419; } } else { if (_0x175d01) { if (_0x1c6040(0x912) === _0x1c6040(0x912)) _0x175d01[_0x1c6040(0x645)][_0x1c6040(0x23e)] = 'none'; else return _0x32e20e(_0x247b13)['then'](_0x550150 => _0x550150[_0x1c6040(0x277)]()); } } } } async function _0x640658() { const _0x1e2130 = _0xe2e12e, _0x199493 = _0x4d4ca5['friendCircles']['find'](_0x12d37d => _0x12d37d['id'] === _0x4d4ca5['activeFriendCircleId']); if (!_0x199493 || _0x4d4ca5[_0x1e2130(0x9b9)]) return; _0x3145a8(!![], _0x1e2130(0x379)), _0x4d4ca5[_0x1e2130(0x9b9)] = !![]; try { let _0x46831f = Date[_0x1e2130(0x661)](); if (_0x199493['posts'] && _0x199493[_0x1e2130(0x681)][_0x1e2130(0x2bd)] > 0x0) { if ('EUJxY' !== _0x1e2130(0x2d5)) { const _0x9ce69b = _0x111d8a['senderId'] || _0x556e9e?.['participantIds'][0x0], _0x38b4e9 = _0x44ecd7(_0x9ce69b); _0x50b129 = _0x38b4e9 ? _0x38b4e9[_0x1e2130(0x8fa)] : '角色'; } else _0x46831f = Math['max'](..._0x199493[_0x1e2130(0x681)][_0x1e2130(0x82d)](_0x30a00f => _0x30a00f['timestamp'])); } const _0x3c260b = await _0x47485d(_0x199493); if (!_0x3c260b || _0x3c260b[_0x1e2130(0x2bd)] === 0x0) { if (_0x1e2130(0x7cb) !== _0x1e2130(0x2e5)) { _0x589297('AI似乎没有想出任何新动态。'); return; } else _0x71742b[_0x1e2130(0x970)][_0x1e2130(0x6ae)]('show'), _0x48e186(() => _0x2da964[_0x1e2130(0x645)][_0x1e2130(0x23e)] = _0x1e2130(0x4aa), 0x12c); } const _0x1a5cb5 = _0x3c260b['map'](async (_0x53306e, _0x589630) => { const _0x35c440 = _0x1e2130; if ('lhKyY' === _0x35c440(0x6d0)) { _0x3145a8(!![], '刷新了\x20' + (_0x589630 + 0x1) + _0x35c440(0x738) + _0x3c260b['length'] + _0x35c440(0x4a0)); const _0x4b6428 = _0x46831f + (_0x589630 + 0x1) * 0x3c * 0x3e8, _0x2cf166 = { 'id': _0x35c440(0x4c3) + _0x53306e[_0x35c440(0x60b)] + '_' + _0x4b6428, 'authorType': _0x35c440(0x311), 'authorId': _0x53306e['authorId'], 'content': _0x53306e['postContent'], 'timestamp': _0x4b6428, 'likes': _0x53306e[_0x35c440(0x6a3)] || [], 'comments': (_0x53306e['comments'] || [])[_0x35c440(0x82d)]((_0x7241fe, _0x36b164) => ({ 'commentId': 'c_' + _0x4b6428 + '_' + _0x36b164, 'authorId': _0x7241fe[_0x35c440(0x60b)], 'content': _0x7241fe[_0x35c440(0x7af)] })) }; if (_0x53306e['postType'] === 'music' && _0x53306e[_0x35c440(0x27a)] && _0x53306e[_0x35c440(0x816)]) try { const _0x145016 = await _0x51dab6(_0x53306e[_0x35c440(0x27a)], _0x53306e[_0x35c440(0x816)]); _0x2cf166[_0x35c440(0x327)] = 'music', _0x2cf166['songName'] = _0x53306e[_0x35c440(0x27a)], _0x2cf166[_0x35c440(0x816)] = _0x53306e['artist'], _0x2cf166['coverUrl'] = _0x145016['cover'], _0x2cf166[_0x35c440(0x151)] = _0x145016['url']; } catch (_0x3e393d) { console[_0x35c440(0x93a)]('动态中的音乐搜索失败:', _0x3e393d), _0x2cf166[_0x35c440(0x327)] = _0x35c440(0x57b); } else _0x2cf166[_0x35c440(0x327)] = _0x35c440(0x57b); return _0x2cf166; } else _0x1c1b05['stopPropagation'](), _0x11d236[_0x35c440(0x970)][_0x35c440(0x413)]('visible'), _0x1550dc['classList'][_0x35c440(0x413)](_0x35c440(0x3c9)); }), _0x5eb059 = await Promise[_0x1e2130(0x721)](_0x1a5cb5); _0x199493[_0x1e2130(0x681)][_0x1e2130(0x956)](..._0x5eb059), _0x42173a(); } catch (_0x2e6db9) { if (_0x1e2130(0x8e8) !== 'AdRqY') console[_0x1e2130(0x93a)](_0x1e2130(0x33c), _0x2e6db9), _0x589297('生成动态时发生错误:\x20' + _0x2e6db9[_0x1e2130(0x6a1)]); else { if (_0xfc2280 < 0x0 || _0xf3f6b0 >= _0x599c82[_0x1e2130(0x2bd)]) return; _0x4f8d1a = _0x3c9536; const _0x3cbff5 = _0x3baad9[_0xfafb02]; _0xef6ac4[_0x1e2130(0x6c3)] = _0x3cbff5['playableUrl'] || _0x3cbff5['url'], _0x5f52c7[_0x1e2130(0x325)](), _0x40c4a3(), _0x211702(); } } finally { if (_0x1e2130(0x4f8) === 'TaLFW') { if (_0x53b907) _0x4edecf[_0x1e2130(0x806)] = '❚❚'; } else _0x2100d0(), _0x3145a8(![]), _0x4d4ca5[_0x1e2130(0x9b9)] = ![]; } } async function _0x47485d(_0x39854a) { const _0xa6032 = _0xe2e12e; if ('ebUDe' !== _0xa6032(0x8ca)) { const _0x321ad1 = _0x521222[_0xa6032(0x213)](_0x3bdb91[_0xa6032(0x745)](_0xa6032(0x867)) || '{}'), _0x5f36b1 = { ..._0x321ad1, ..._0x36a128 }; _0x328b12[_0xa6032(0x598)](_0xa6032(0x867), _0x30c201[_0xa6032(0x822)](_0x5f36b1)); } else { const _0x19b484 = _0x39854a[_0xa6032(0x6fe)][_0xa6032(0x82d)](_0x2c45b1 => _0x53bcef(_0x2c45b1))[_0xa6032(0x5fe)](Boolean); if (_0x19b484[_0xa6032(0x2bd)] === 0x0) return null; const _0x2a4b49 = _0x4664bc(), _0x472ce1 = _0x405c17(_0x39854a[_0xa6032(0x757)]) || _0x4d4ca5[_0xa6032(0x26d)][0x0], _0x5b854d = _0x472ce1 ? '\x0a#\x20好友圈的主人\x20(“我”)\x0a-\x20姓名:\x20' + _0x472ce1[_0xa6032(0x8fa)] + _0xa6032(0x914) + (_0x472ce1[_0xa6032(0x7d5)] || '无') + '\x0a' : '', _0x5efb48 = _0x19b484[_0xa6032(0x82d)](_0x586b7b => { const _0x5ac7bf = _0xa6032; if (_0x5ac7bf(0x837) === _0x5ac7bf(0x837)) { const { omniText: _0xc3cc2b } = _0x4a974c(_0x586b7b['id'], null), _0x5641ec = _0x532554(_0x586b7b['id']), _0x2cde87 = _0x586b7b[_0x5ac7bf(0x963)] && _0x586b7b[_0x5ac7bf(0x963)][_0x5ac7bf(0x2bd)] > 0x0 ? _0x5ac7bf(0x718) + _0x586b7b[_0x5ac7bf(0x8fa)] + _0x5ac7bf(0x90c) + _0x586b7b['linkedWorldBookIds'][_0x5ac7bf(0x82d)](_0x19d08a => _0x4d4ca5[_0x5ac7bf(0x7ea)][_0x5ac7bf(0x5a8)](_0x38a6be => _0x38a6be['id'] === _0x19d08a))[_0x5ac7bf(0x5fe)](Boolean)[_0x5ac7bf(0x82d)](_0x49cea6 => _0x5ac7bf(0x90f) + _0x49cea6[_0x5ac7bf(0x8fa)] + '\x0a' + _0x49cea6[_0x5ac7bf(0x7af)])[_0x5ac7bf(0x5cd)]('') : ''; return _0x5ac7bf(0x8bf) + _0x586b7b[_0x5ac7bf(0x8fa)] + _0x5ac7bf(0x96a) + _0x586b7b['id'] + _0x5ac7bf(0x864) + _0x586b7b[_0x5ac7bf(0x7d5)] + '\x0a\x20\x20近期记忆:\x0a' + _0xc3cc2b + '\x0a' + _0x5641ec + '\x0a' + _0x2cde87; } else _0x2c2303(_0x380277['id']); })[_0xa6032(0x5cd)]('\x0a\x0a'), _0x5e150b = Math[_0xa6032(0x54d)](Math[_0xa6032(0x4e7)]() * 0x3) + 0x2, _0x38f95b = _0xa6032(0x73e) + _0x5e150b + _0xa6032(0x73c) + _0x5efb48 + '\x0a' + _0x5b854d + '\x0a#\x20最近的动态回顾\x20(供参考，避免重复)\x0a' + _0x2a4b49 + _0xa6032(0x75c) + _0x5e150b + _0xa6032(0x885) + _0x5e150b + _0xa6032(0x3c6), _0x152ee7 = [{ 'role': _0xa6032(0x449), 'content': _0x38f95b }, { 'role': _0xa6032(0x75d), 'content': _0xa6032(0x287) }]; _0x152ee7['push']({ 'role': _0xa6032(0x75d), 'content': '请根据以上所有规则，生成\x20' + _0x5e150b + '\x20条新动态。' }); try { const _0x22b432 = await _0xc7a378(_0x152ee7, { 'json': !![] }), _0xbe71ea = _0x22b432[_0xa6032(0x199)](/(\[[\s\S]*\])/); if (!_0xbe71ea) throw new Error(_0xa6032(0x678)); const _0x4e1c5d = _0xbe71ea[0x1], _0x4a3b20 = JSON[_0xa6032(0x213)](_0x4e1c5d); if (!Array[_0xa6032(0x189)](_0x4a3b20)) throw new Error(_0xa6032(0x478)); return _0x4a3b20; } catch (_0x47a861) { if (_0xa6032(0x6ee) === _0xa6032(0x6ee)) return console[_0xa6032(0x93a)](_0xa6032(0x5ff), _0x47a861), console[_0xa6032(0x93a)](_0xa6032(0x523), _0x47a861['rawResponse'] || _0xa6032(0x76b)), null; else { _0x68adb6[_0xa6032(0x39f)](_0xa6032(0x842)); const _0x2a3b18 = { 'id': _0xa6032(0x207) + _0x2bb722[_0xa6032(0x661)](), 'name': _0xa6032(0x811), 'boundUserProfileId': _0x294cbe[_0xa6032(0x4f1)], 'memberCharacterIds': _0x183856[_0xa6032(0x4ee)]['map'](_0x5ec737 => _0x5ec737['id']), 'posts': _0x19384f[_0xa6032(0x4e3)] }; _0x242c19[_0xa6032(0x54c)] = [_0x2a3b18], _0x7d28ac[_0xa6032(0x752)] = _0x2a3b18['id']; } } } } async function _0x3103fc() { const _0x567617 = _0xe2e12e; if (_0x567617(0x7a2) === _0x567617(0x7a2)) { const _0x51cebe = _0x4d4ca5[_0x567617(0x54c)]['find'](_0x5baebb => _0x5baebb['id'] === _0x4d4ca5[_0x567617(0x752)]); if (!_0x51cebe) return; const _0x5c749e = await _0x385a44(_0x567617(0x59b) + _0x51cebe[_0x567617(0x8fa)] + '”的所有动态吗？此操作不可撤销，且AI将不再记得这些内容。'); _0x5c749e && (_0x51cebe['posts'] = [], _0x42173a(), _0x2100d0(), _0x589297(_0x567617(0x766))); } else return _0x61ad6c + '分钟前'; } function _0x2100d0() { const _0x34227a = _0xe2e12e; if (_0x34227a(0x29d) !== _0x34227a(0x29d)) return; else { const _0x1277f1 = document['getElementById']('music-feed-container'), _0x32ee48 = _0x4d4ca5['friendCircles'][_0x34227a(0x5a8)](_0x543307 => _0x543307['id'] === _0x4d4ca5[_0x34227a(0x752)]); if (!_0x32ee48) { _0x1277f1[_0x34227a(0x978)] = _0x34227a(0x9b4); return; } if (!_0x32ee48[_0x34227a(0x681)] || _0x32ee48['posts'][_0x34227a(0x2bd)] === 0x0) { if (_0x34227a(0x53a) === _0x34227a(0x88c)) { _0x138b64(_0x34227a(0x1b2)); return; } else { _0x1277f1[_0x34227a(0x978)] = _0x34227a(0x31b); return; } } _0x1277f1[_0x34227a(0x978)] = ''; const _0x2ff908 = [..._0x32ee48[_0x34227a(0x681)]][_0x34227a(0x450)]((_0x3d182e, _0x338560) => _0x338560[_0x34227a(0x2c3)] - _0x3d182e[_0x34227a(0x2c3)]); _0x2ff908['forEach'](_0x4f17e8 => { const _0xc3bd44 = _0x34227a, _0x570e1b = document['createElement'](_0xc3bd44(0x46f)); _0x570e1b[_0xc3bd44(0x255)] = _0xc3bd44(0x929); let _0x1194a0 = '未知', _0x5d5ad6 = _0x4991a9; if (_0x4f17e8[_0xc3bd44(0x355)] === _0xc3bd44(0x75d)) { if (_0xc3bd44(0x30d) === _0xc3bd44(0x30d)) { const _0x1822f3 = _0x405c17(_0x4f17e8[_0xc3bd44(0x60b)]); if (_0x1822f3) { if ('fwuXx' === 'fwuXx') _0x1194a0 = _0x1822f3['name'], _0x5d5ad6 = _0x1822f3[_0xc3bd44(0x86f)]; else { if (!_0x3e5b6d || !_0x4f79da['includes'](',')) return _0x3e7a37; const _0x5beea6 = _0x1c5531[_0xc3bd44(0x3e8)](',')['map'](_0x5d3192 => _0x5d3192['trim']()); return _0x5beea6[_0x217ef1[_0xc3bd44(0x54d)](_0x166d82['random']() * _0x5beea6['length'])]; } } } else _0x1c8981[_0xc3bd44(0x93a)]('Failed\x20to\x20remove\x20history\x20for\x20chat\x20' + _0x32094f['id'], _0x5106f0); } else { const _0xb4cb94 = _0x53bcef(_0x4f17e8[_0xc3bd44(0x60b)]); _0xb4cb94 && (_0x1194a0 = _0xb4cb94[_0xc3bd44(0x8fa)], _0x5d5ad6 = _0xb4cb94[_0xc3bd44(0x86f)]); } const _0x337196 = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x5d5ad6 + _0xc3bd44(0x340) + _0x1194a0 + _0xc3bd44(0x424), _0x42350e = _0xc3bd44(0x8a2) + _0x4f17e8[_0xc3bd44(0x7af)] + _0xc3bd44(0x1cf); let _0xbfed9f = ''; if (_0x4f17e8['image'] || _0x4f17e8[_0xc3bd44(0x714)]) { const _0x3b3899 = _0xc3bd44(0x4af) + _0x4f17e8['id']; _0xbfed9f = _0xc3bd44(0x28a) + _0x3b3899 + '\x22\x20class=\x22post-image\x22></div>', setTimeout(() => { const _0x34d44d = _0xc3bd44, _0x4d3b7e = document[_0x34d44d(0x6c2)](_0x3b3899); if (!_0x4d3b7e) return; if (_0x4f17e8['image']) { if (_0x34d44d(0x810) === 'PCHBu') _0x4d3b7e['src'] = _0x4f17e8[_0x34d44d(0x776)]; else { _0x128430[_0x34d44d(0x135)] = _0x34d44d(0x881); return; } } else { if (_0x4f17e8[_0x34d44d(0x714)]) { if (_0x34d44d(0x75a) === _0x34d44d(0x94c)) { const _0x1bfabf = _0x248adf['getAll'](); _0x1bfabf[_0x34d44d(0x578)] = () => _0xecb0f2(_0x1bfabf['result']), _0x1bfabf[_0x34d44d(0x911)] = () => _0x2122c2(_0x1bfabf[_0x34d44d(0x93a)]); } else _0x299fa0(_0x4f17e8['imageId'])['then'](_0x26223e => { const _0x2c98d6 = _0x34d44d; if ('uQVPJ' !== _0x2c98d6(0x5e2)) { if (_0x26223e) { if (_0x2c98d6(0x68e) === 'SEMcR') { const _0x486ecf = URL[_0x2c98d6(0x1de)](_0x26223e); _0x4d3b7e[_0x2c98d6(0x6c3)] = _0x486ecf, _0x4d3b7e[_0x2c98d6(0x575)] = () => URL['revokeObjectURL'](_0x486ecf); } else _0x38dccf = { 'speaker': _0x18fe5c['name'], 'line': _0x5adbe2['content'], 'emotion': _0x2c98d6(0x416) }; } } else _0x250836['activeDiaryCharacterId'] = null, _0x3dfe91(_0x2c98d6(0x342), _0x2c98d6(0x70a)); }); } } }, 0x0); } let _0x20c9cb = ''; _0x4f17e8[_0xc3bd44(0x327)] === _0xc3bd44(0x513) && _0x4f17e8[_0xc3bd44(0x27a)] && (_0x20c9cb = _0xc3bd44(0x41b) + _0x4f17e8['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x4f17e8['coverUrl'] || _0x4991a9) + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x4f17e8[_0xc3bd44(0x27a)] + _0xc3bd44(0x820) + _0x4f17e8[_0xc3bd44(0x816)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>' + (_0x4f17e8[_0xc3bd44(0x151)] ? '▶' : '⚠') + _0xc3bd44(0x6ea)); const _0x2332e1 = '<div\x20class=\x22post-timestamp\x22>' + new Date(_0x4f17e8[_0xc3bd44(0x2c3)])['toLocaleString']('zh-CN') + _0xc3bd44(0x455); let _0x13f4af = ''; if (_0x4f17e8[_0xc3bd44(0x6a3)] && _0x4f17e8[_0xc3bd44(0x6a3)]['length'] > 0x0 || _0x4f17e8['comments'] && _0x4f17e8['comments'][_0xc3bd44(0x2bd)] > 0x0) { let _0x21ed10 = ''; if (_0x4f17e8[_0xc3bd44(0x6a3)] && _0x4f17e8[_0xc3bd44(0x6a3)][_0xc3bd44(0x2bd)] > 0x0) { const _0x3cb5c3 = _0x4f17e8[_0xc3bd44(0x6a3)][_0xc3bd44(0x82d)](_0x203706 => _0x53bcef(_0x203706)?.[_0xc3bd44(0x8fa)] || '未知')[_0xc3bd44(0x5cd)]('、'), _0xa644f8 = _0xc3bd44(0x5d1); _0x21ed10 = _0xc3bd44(0x3f1) + _0xa644f8 + '\x20' + _0x3cb5c3 + '</div>'; } let _0x20a09a = ''; if (_0x4f17e8['comments'] && _0x4f17e8[_0xc3bd44(0x292)][_0xc3bd44(0x2bd)] > 0x0) { if ('GnaQy' === _0xc3bd44(0x651)) _0x4d2fff[_0xc3bd44(0x6c3)] = _0x452f65[_0xc3bd44(0x6b8)], _0x13276b[_0xc3bd44(0x325)](), _0x5dfc0d[_0xc3bd44(0x5e5)](_0xc3bd44(0x3b9))[_0xc3bd44(0x806)] = '❚❚'; else { const _0x93de7b = _0x4f17e8[_0xc3bd44(0x292)][_0xc3bd44(0x82d)](_0x496c30 => { const _0x4b39e1 = _0xc3bd44; if (_0x4b39e1(0x6d1) !== _0x4b39e1(0x79c)) { const _0x4639c9 = _0x53bcef(_0x496c30[_0x4b39e1(0x60b)])?.['name'] || '未知'; return '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>' + _0x4639c9 + '</span>:\x20' + _0x496c30['content'] + '</div>'; } else _0x4321b5[_0x4b39e1(0x93a)](_0x4b39e1(0x581), _0x247f7c), _0x371f8e(_0x4b39e1(0x650) + _0x373ec5[_0x4b39e1(0x6a1)]); })[_0xc3bd44(0x5cd)](''); _0x20a09a = _0xc3bd44(0x7fd) + _0x93de7b + _0xc3bd44(0x455); } } _0x13f4af = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x21ed10 + _0xc3bd44(0x902) + _0x20a09a + _0xc3bd44(0x220); } const _0x30e47a = _0xc3bd44(0x92d) + _0x42350e + _0xbfed9f + _0x20c9cb + _0xc3bd44(0x455); _0x570e1b[_0xc3bd44(0x978)] = _0x337196 + _0x30e47a + _0x2332e1 + _0x13f4af; if (_0x4f17e8[_0xc3bd44(0x327)] === 'music' && _0x4f17e8['playableUrl']) { if (_0xc3bd44(0x36c) !== _0xc3bd44(0x79d)) { const _0x4de5a2 = _0x570e1b[_0xc3bd44(0x5e5)](_0xc3bd44(0x592)); _0x4de5a2 && _0x4de5a2[_0xc3bd44(0x501)](_0xc3bd44(0x4bd), function () { const _0x17b774 = _0xc3bd44, _0x2f630f = { 'id': _0x4f17e8['id'], 'url': _0x4f17e8[_0x17b774(0x151)] }; _0x451d19(this, _0x2f630f); }); } else { const _0x102b98 = _0x4f05ac(_0x7fecc4[_0xc3bd44(0x60b)]) || { 'name': '未知' }; let _0x3d4efb = _0xc3bd44(0x617) + _0x102b98[_0xc3bd44(0x8fa)] + _0xc3bd44(0x6f1) + (_0x6c4afc[_0xc3bd44(0x89f)] || _0x4244f2[_0xc3bd44(0x7af)]) + '”'; return _0x54055c[_0xc3bd44(0x327)] === _0xc3bd44(0x513) && (_0x3d4efb += _0xc3bd44(0x7ef) + _0x5751c3['songName'] + '\x20-\x20' + _0x47e318[_0xc3bd44(0x816)] + ')'), _0x3d4efb; } } _0x1277f1[_0xc3bd44(0x54e)](_0x570e1b); }); } } document[_0xe2e12e(0x6c2)](_0xe2e12e(0x1e6))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x3103fc), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x693))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x640658), document[_0xe2e12e(0x6c2)]('back-to-home-from-circle-list')['addEventListener']('click', () => _0x113213(_0xe2e12e(0x54a), _0xe2e12e(0x6bf))), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x74a))[_0xe2e12e(0x501)]('click', () => _0x57f695()), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x39d))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0x113213(_0xe2e12e(0x6bf), _0xe2e12e(0x821))), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x734))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x5cd782), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x3d6))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x142d5f), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x49c))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x21c859 = _0xe2e12e; _0x4b43d6(), _0x113213(_0x21c859(0x6bf), _0x21c859(0x513)); }), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x134))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x462433 = _0xe2e12e; if (_0x462433(0x847) !== _0x462433(0x847)) _0x3b3139['setItem'](_0x5d0105, _0x5545ff), _0x3e866d['removeItem'](_0xa6331e); else { if (_0x4d4ca5['activeFriendCircleId']) { if ('SjPvL' !== _0x462433(0x1d6)) _0x57f695(_0x4d4ca5[_0x462433(0x752)]); else try { const _0x5eb914 = _0x43f06b[_0x462433(0x213)](_0xf1bc55[_0x462433(0x745)](_0x462433(0x603)) || '{}'), _0x25babd = { ..._0x5eb914, ..._0x5a8e65 }; _0x2b191a['setItem'](_0x462433(0x603), _0x5038b6[_0x462433(0x822)](_0x25babd)); } catch (_0x58b887) { _0x4028b9[_0x462433(0x93a)](_0x462433(0x1da), _0x58b887); } } } }), document[_0xe2e12e(0x6c2)]('user-send-post-button')['addEventListener'](_0xe2e12e(0x4bd), async () => { const _0x2cafc7 = _0xe2e12e; if (_0x2cafc7(0x90e) !== _0x2cafc7(0x7c9)) { const _0x5d2358 = _0x4d4ca5[_0x2cafc7(0x54c)][_0x2cafc7(0x5a8)](_0x31659b => _0x31659b['id'] === _0x4d4ca5[_0x2cafc7(0x752)]); if (!_0x5d2358 || _0x4d4ca5['isGenerating']) return; const _0x3cbdae = _0x5d2358[_0x2cafc7(0x757)], _0x3c93b5 = _0x4d4ca5[_0x2cafc7(0x26d)]['find'](_0x4db03a => _0x4db03a['id'] === _0x3cbdae); if (!_0x3c93b5) { if (_0x2cafc7(0x62b) === 'MzSyF') { _0x589297(_0x2cafc7(0x769)); return; } else _0x6e93ee(), _0x46cfc4(); } const _0x30f890 = document['getElementById']('user-post-textarea')[_0x2cafc7(0x135)][_0x2cafc7(0x163)](), _0x45936f = _0x4d4ca5[_0x2cafc7(0x777)][_0x2cafc7(0x776)], _0x2655a3 = _0x4d4ca5[_0x2cafc7(0x777)][_0x2cafc7(0x513)], _0x17274f = _0x4d4ca5[_0x2cafc7(0x777)][_0x2cafc7(0x714)]; if (!_0x30f890 && !_0x45936f && !_0x2655a3) { _0x589297(_0x2cafc7(0x722)); return; } const _0x1bd25d = { 'id': 'post_user_' + Date[_0x2cafc7(0x661)](), 'authorType': _0x2cafc7(0x75d), 'authorId': _0x3c93b5['id'], 'content': _0x30f890, 'timestamp': Date[_0x2cafc7(0x661)](), 'likes': [], 'comments': [] }; if (_0x17274f) { if (_0x2cafc7(0x5d3) !== _0x2cafc7(0x39e)) _0x1bd25d[_0x2cafc7(0x714)] = _0x17274f; else { const _0x2ae92d = []; if (_0x1c4bf6[_0x2cafc7(0x7af)]) _0x2ae92d[_0x2cafc7(0x956)]({ 'text': _0x1e9ddb[_0x2cafc7(0x7af)] }); if (_0x10e4ce[_0x2cafc7(0x776)]) { const _0xb0c85f = _0x2df011[_0x2cafc7(0x776)][_0x2cafc7(0x3e8)](',')[0x1], _0x163a2d = _0x221962[_0x2cafc7(0x776)][_0x2cafc7(0x8a1)](_0x34ecb5[_0x2cafc7(0x776)][_0x2cafc7(0x99e)](':') + 0x1, _0xbe88bb[_0x2cafc7(0x776)][_0x2cafc7(0x99e)](';')) || _0x2cafc7(0x265); _0x2ae92d[_0x2cafc7(0x956)]({ 'inline_data': { 'mime_type': _0x163a2d, 'data': _0xb0c85f } }); } return _0x2ae92d; } } else _0x45936f && (_0x1bd25d[_0x2cafc7(0x776)] = _0x45936f); _0x2655a3 ? (_0x1bd25d[_0x2cafc7(0x327)] = 'music', Object[_0x2cafc7(0x71b)](_0x1bd25d, _0x2655a3)) : _0x1bd25d['type'] = _0x2cafc7(0x57b), _0x5d2358[_0x2cafc7(0x681)][_0x2cafc7(0x956)](_0x1bd25d), _0x42173a(), _0x2100d0(), document['getElementById']('user-post-textarea')[_0x2cafc7(0x135)] = '', _0x4d4ca5[_0x2cafc7(0x777)][_0x2cafc7(0x776)] = null, _0x4d4ca5[_0x2cafc7(0x777)][_0x2cafc7(0x513)] = null, _0x4d4ca5[_0x2cafc7(0x777)][_0x2cafc7(0x714)] = null, _0x26fab8(), _0x5ef4a3(_0x1bd25d); } else _0x5258e5[_0x2cafc7(0x272)] = null, _0x34472f[_0x2cafc7(0x645)][_0x2cafc7(0x23e)] = _0x2cafc7(0x4aa); }), document[_0xe2e12e(0x6c2)]('user-post-image-button')['addEventListener'](_0xe2e12e(0x4bd), () => { const _0x31129e = _0xe2e12e; if (_0x31129e(0x7ee) === _0x31129e(0x8e9)) { let _0x40f752 = ''; if (_0x2f4aef[_0x31129e(0x6a3)] && _0x5641d2[_0x31129e(0x6a3)][_0x31129e(0x2bd)] > 0x0) { const _0x4a9f9b = _0x18a4de[_0x31129e(0x6a3)]['map'](_0x3f0eb6 => _0xbb0fc9(_0x3f0eb6)?.[_0x31129e(0x8fa)] || '未知')[_0x31129e(0x5cd)]('、'), _0x19ce96 = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>'; _0x40f752 = _0x31129e(0x3f1) + _0x19ce96 + '\x20' + _0x4a9f9b + _0x31129e(0x455); } let _0x2f2baf = ''; if (_0x1f713a[_0x31129e(0x292)] && _0x1311a4[_0x31129e(0x292)][_0x31129e(0x2bd)] > 0x0) { const _0x1b37d2 = _0x3cf4c2[_0x31129e(0x292)][_0x31129e(0x82d)](_0x1b3572 => { const _0x3bdc31 = _0x31129e, _0x575942 = _0x4a1b23(_0x1b3572['authorId'])?.[_0x3bdc31(0x8fa)] || '未知'; return '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>' + _0x575942 + _0x3bdc31(0x19e) + _0x1b3572[_0x3bdc31(0x7af)] + _0x3bdc31(0x455); })[_0x31129e(0x5cd)](''); _0x2f2baf = _0x31129e(0x7fd) + _0x1b37d2 + '</div>'; } _0x2325f3 = _0x31129e(0x3e5) + _0x40f752 + _0x31129e(0x902) + _0x2f2baf + _0x31129e(0x220); } else document['getElementById']('user-post-image-input')[_0x31129e(0x4bd)](); }), document['getElementById'](_0xe2e12e(0x419))['addEventListener'](_0xe2e12e(0x858), async _0x140a02 => { const _0x2e77c2 = _0xe2e12e, _0x1a0afa = _0x140a02[_0x2e77c2(0x68b)][_0x2e77c2(0x4c0)][0x0]; if (!_0x1a0afa) return; try { if (_0x2e77c2(0x5b3) === _0x2e77c2(0x5b3)) { const _0x47d6ed = await _0x46f332(_0x1a0afa, 0x320, 0.8, !![]), _0x3b7345 = _0x2e77c2(0x205) + Date[_0x2e77c2(0x661)](); await _0x34f697(_0x3b7345, _0x47d6ed), _0x4d4ca5[_0x2e77c2(0x777)][_0x2e77c2(0x714)] = _0x3b7345, _0x4d4ca5[_0x2e77c2(0x777)]['image'] = null, _0x4d4ca5[_0x2e77c2(0x777)][_0x2e77c2(0x513)] = null, _0x26fab8(); } else _0x11f18a[_0x2e77c2(0x645)][_0x2e77c2(0x21c)] = '', _0xe41439[_0x2e77c2(0x645)][_0x2e77c2(0x8f1)] = '', _0x246f7b['querySelectorAll'](_0x2e77c2(0x9af))[_0x2e77c2(0x279)](_0x1d360b => { const _0x220237 = _0x2e77c2; _0x1d360b[_0x220237(0x645)][_0x220237(0x2ee)] = ''; }); } catch (_0x4e2fee) { _0x589297(_0x2e77c2(0x1e9) + _0x4e2fee[_0x2e77c2(0x6a1)]); } _0x140a02[_0x2e77c2(0x68b)][_0x2e77c2(0x135)] = ''; }), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x960))[_0xe2e12e(0x501)]('click', async () => { const _0x4692c8 = _0xe2e12e, _0xb7f2f0 = await _0x4679ee(); if (!_0xb7f2f0) return; _0x589297('正在搜索音乐...'); try { const _0x271958 = await _0x51dab6(_0xb7f2f0['songName'], _0xb7f2f0[_0x4692c8(0x816)]); _0x4d4ca5[_0x4692c8(0x777)][_0x4692c8(0x513)] = { 'songName': _0xb7f2f0[_0x4692c8(0x27a)], 'artist': _0xb7f2f0[_0x4692c8(0x816)], 'coverUrl': _0x271958[_0x4692c8(0x2b6)], 'playableUrl': _0x271958[_0x4692c8(0x6b8)] }, _0x4d4ca5[_0x4692c8(0x777)][_0x4692c8(0x776)] = null, _0x26fab8(); } catch (_0x423078) { _0x589297(_0x4692c8(0x35e) + _0x423078[_0x4692c8(0x6a1)]); } }); function _0xdbf249() { const _0x46630b = _0xe2e12e, _0x360724 = new Date(), _0x4380c4 = document[_0x46630b(0x6c2)]('home-time'), _0x3fdd7c = document[_0x46630b(0x6c2)]('home-date'); if (_0x4380c4 && _0x3fdd7c) { const _0x14ddb1 = String(_0x360724[_0x46630b(0x368)]())['padStart'](0x2, '0'), _0x38b4ba = String(_0x360724['getMinutes']())[_0x46630b(0x522)](0x2, '0'); _0x4380c4[_0x46630b(0x806)] = _0x14ddb1 + ':' + _0x38b4ba; const _0x16f14a = _0x360724[_0x46630b(0x719)]() + 0x1, _0x9fe4ce = _0x360724[_0x46630b(0x9b6)](), _0x43a878 = [_0x46630b(0x353), _0x46630b(0x343), _0x46630b(0x711), _0x46630b(0x979), _0x46630b(0x5bc), _0x46630b(0x557), _0x46630b(0x751)][_0x360724[_0x46630b(0x8e2)]()]; _0x3fdd7c[_0x46630b(0x806)] = _0x16f14a + '月' + _0x9fe4ce + '日\x20' + _0x43a878; } } function _0x937feb(_0x295a4a) { const _0x34175e = _0xe2e12e; if (_0x34175e(0x3a4) !== _0x34175e(0x3a4)) _0x4a9911(_0x2d0f64[_0x34175e(0x2ca)])[_0x34175e(0x588)](_0x2037e0 => { const _0x360952 = _0x34175e, _0x326d7c = _0x5b3f9e[_0x360952(0x6c2)](_0x350f9b); if (_0x326d7c && _0x2037e0) _0x326d7c['src'] = _0x2f7ec7[_0x360952(0x1de)](_0x2037e0); }); else { if (!_0x295a4a) return ''; const _0x1eb86d = new Date(_0x295a4a), _0x4281e7 = String(_0x1eb86d[_0x34175e(0x368)]())[_0x34175e(0x522)](0x2, '0'), _0x102181 = String(_0x1eb86d[_0x34175e(0x37e)]())[_0x34175e(0x522)](0x2, '0'); return _0x4281e7 + ':' + _0x102181; } } function _0x4664bc() { const _0x38445b = _0xe2e12e, _0x3cf097 = _0x4d4ca5[_0x38445b(0x54c)][_0x38445b(0x5a8)](_0x3eda1e => _0x3eda1e['id'] === _0x4d4ca5['activeFriendCircleId']), _0x369ac8 = _0x3cf097 ? _0x3cf097['posts'] : []; if (!_0x369ac8 || _0x369ac8[_0x38445b(0x2bd)] === 0x0) return ''; const _0x22af55 = _0x369ac8['slice'](0x0, 0x5), _0xa1b536 = _0x22af55[_0x38445b(0x82d)](_0x6d851d => { const _0x545f1f = _0x38445b; if ('mjxbH' === _0x545f1f(0x16a)) _0x4bd51e[_0x545f1f(0x956)](_0x331429['id']); else { const _0x30a5b7 = _0x53bcef(_0x6d851d[_0x545f1f(0x60b)]) || { 'name': '未知' }; let _0xbacd54 = _0x545f1f(0x617) + _0x30a5b7[_0x545f1f(0x8fa)] + _0x545f1f(0x6f1) + (_0x6d851d[_0x545f1f(0x89f)] || _0x6d851d[_0x545f1f(0x7af)]) + '”'; return _0x6d851d[_0x545f1f(0x327)] === 'music' && (_0xbacd54 += _0x545f1f(0x7ef) + _0x6d851d[_0x545f1f(0x27a)] + _0x545f1f(0x33b) + _0x6d851d[_0x545f1f(0x816)] + ')'), _0xbacd54; } }); return _0x38445b(0x969) + _0xa1b536[_0x38445b(0x5cd)]('\x0a'); } function _0x532554(_0x1195ce) { const _0x578ad3 = _0xe2e12e, _0x1bb7b7 = _0x4d4ca5[_0x578ad3(0x26d)][_0x578ad3(0x5a8)](_0x194e96 => _0x194e96['id'] === _0x4d4ca5[_0x578ad3(0x4f1)]) || { 'name': '你' }, _0x7a870a = _0x4d4ca5[_0x578ad3(0x18c)][_0x578ad3(0x5a8)](_0x561924 => _0x561924[_0x578ad3(0x6e8)] === _0x1195ce); if (!_0x7a870a || !_0x7a870a['entries'] || _0x7a870a[_0x578ad3(0x489)][_0x578ad3(0x2bd)] === 0x0) return ''; const _0x57821f = _0x7a870a[_0x578ad3(0x489)][_0x578ad3(0x61e)](-0x8), _0x309655 = _0x57821f['map'](_0x57b3c1 => { const _0x2785ea = _0x578ad3, _0x58c5a2 = _0x57b3c1[_0x2785ea(0x427)] === _0x2785ea(0x75d) ? _0x1bb7b7[_0x2785ea(0x8fa)] : _0x53bcef(_0x57b3c1[_0x2785ea(0x427)])['name']; return _0x2785ea(0x807) + new Date(_0x57b3c1[_0x2785ea(0x2c3)])['toLocaleDateString']() + ']\x20' + _0x58c5a2 + _0x2785ea(0x297) + _0x57b3c1[_0x2785ea(0x7af)]; })[_0x578ad3(0x5cd)]('\x0a'); return _0x578ad3(0x7c4) + _0x1bb7b7[_0x578ad3(0x8fa)] + _0x578ad3(0x888) + _0x309655; } function _0x1a07a7() { const _0x44347d = _0xe2e12e, _0x47b737 = document[_0x44347d(0x6c2)](_0x44347d(0x875)), _0x501605 = _0x4d4ca5[_0x44347d(0x2d6)][_0x44347d(0x4f5)]; _0x501605 ? _0x44347d(0x905) === _0x44347d(0x98b) ? _0x3da304[_0x44347d(0x956)](_0x5c33b1['id']) : (_0x47b737[_0x44347d(0x645)][_0x44347d(0x21c)] = _0x44347d(0x12f) + _0x501605 + ')', _0x47b737[_0x44347d(0x645)][_0x44347d(0x19d)] = _0x44347d(0x2b6), _0x47b737['style'][_0x44347d(0x2e8)] = 'center', _0x47b737[_0x44347d(0x645)][_0x44347d(0x8f1)] = _0x44347d(0x8cf), _0x47b737[_0x44347d(0x445)](_0x44347d(0x9af))[_0x44347d(0x279)](_0x49c415 => { const _0x5bbdbc = _0x44347d; _0x49c415[_0x5bbdbc(0x645)][_0x5bbdbc(0x2ee)] = _0x5bbdbc(0x1ea); })) : (_0x47b737[_0x44347d(0x645)][_0x44347d(0x21c)] = '', _0x47b737['style'][_0x44347d(0x8f1)] = '', _0x47b737[_0x44347d(0x445)](_0x44347d(0x9af))[_0x44347d(0x279)](_0x24174b => { const _0x5becea = _0x44347d; if (_0x5becea(0x834) === 'RGLeY') { const _0x26e436 = _0x441254['conversationHistory'][_0x5becea(0x99e)](_0x3042b5); _0x26e436 > -0x1 && _0xbbe3f7(_0x55f684, _0x26e436); } else _0x24174b[_0x5becea(0x645)][_0x5becea(0x2ee)] = ''; })); } const _0x1fcdff = document['getElementById'](_0xe2e12e(0x974)), _0x5b3637 = document[_0xe2e12e(0x6c2)]('app-meeting'); _0x1fcdff[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x2fa3ad = _0xe2e12e; if (_0x2fa3ad(0x4b3) !== _0x2fa3ad(0x4b3)) { const _0x40212d = _0x5348a2[_0x2fa3ad(0x3e8)](/:\s|：\s/); if (_0x40212d[_0x2fa3ad(0x2bd)] === 0x2) { const _0x3d5cbe = _0x40212d[0x0][_0x2fa3ad(0x163)](), _0x4d4d9d = _0x40212d[0x1]['trim'](), _0x346008 = { '歌名': _0x2fa3ad(0x38b), '艺术家': '歌手', '专辑': '专辑' }; _0x346008[_0x3d5cbe] && (_0x4b536e[_0x346008[_0x3d5cbe]] = _0x4d4d9d); } } else _0x4b43d6(), _0x113213('friendCircleList', 'home'); }), _0x5b3637[_0xe2e12e(0x501)]('click', () => { const _0x4c5cda = _0xe2e12e; _0x20a059(), _0x113213(_0x4c5cda(0x65c), _0x4c5cda(0x54a)); }), document['getElementById']('back-to-home-from-meeting-list')['addEventListener'](_0xe2e12e(0x4bd), () => { const _0x15693 = _0xe2e12e; _0x113213('home', _0x15693(0x65c)); }), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x1df))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x1e93a1 = _0xe2e12e; if (_0x1e93a1(0x759) === _0x1e93a1(0x759)) { if (_0x303f56) clearInterval(_0x303f56); _0x303f56 = null, _0x4d4ca5[_0x1e93a1(0x295)] = [], _0x4d4ca5[_0x1e93a1(0x676)] = null, document['getElementById'](_0x1e93a1(0x1ac))[_0x1e93a1(0x645)][_0x1e93a1(0x23e)] = _0x1e93a1(0x4aa), _0x4d4ca5[_0x1e93a1(0x41f)] = null, _0x42173a(), _0x113213(_0x1e93a1(0x65c), _0x1e93a1(0x808)); } else _0x15fd8b[_0x1e93a1(0x645)][_0x1e93a1(0x608)] = 0x0, _0x3477b3(() => { const _0xbf99c2 = _0x1e93a1; _0x417295[_0xbf99c2(0x6c3)] = _0x2d378b['createObjectURL'](_0x9aa045), _0xd68479[_0xbf99c2(0x645)][_0xbf99c2(0x608)] = 0x1; }, 0x96); }); const _0x33797a = document['getElementById']('meeting-message-input'), _0x1840f2 = document[_0xe2e12e(0x6c2)]('meeting-send-button'); _0x1840f2[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x5cea58 = _0xe2e12e, _0x5c2bb2 = _0x33797a['value'][_0x5cea58(0x163)](); _0x5c2bb2 && (_0x4527c8(_0x5c2bb2), _0x33797a['value'] = '', setTimeout(_0x52ef2f, 0x64)); }); function _0x451d19(_0x5397a0, _0xb17326) { const _0x567a69 = _0xe2e12e; if (_0x567a69(0x521) !== _0x567a69(0x32f)) { const _0x46fdb3 = document[_0x567a69(0x6c2)](_0x567a69(0x873)), _0x318171 = document['querySelectorAll']('.music-post-play-icon,\x20.music-share-play-icon'); _0x318171[_0x567a69(0x279)](_0x5aa60e => { const _0x5b9f5d = _0x567a69; _0x5aa60e !== _0x5397a0[_0x5b9f5d(0x5e5)](_0x5b9f5d(0x3b9)) && (_0x5aa60e['textContent'] = '▶'); }); if (_0x46fdb3[_0x567a69(0x6c3)] === _0xb17326[_0x567a69(0x6b8)] && !_0x46fdb3[_0x567a69(0x91a)]) { if (_0x567a69(0x6fa) === _0x567a69(0x6fa)) _0x46fdb3[_0x567a69(0x31f)](), _0x5397a0[_0x567a69(0x5e5)]('.music-post-play-icon,\x20.music-share-play-icon')['textContent'] = '▶'; else { _0x3cdb41[_0x567a69(0x978)] = _0x567a69(0x3ea); return; } } else _0x46fdb3[_0x567a69(0x6c3)] = _0xb17326['url'], _0x46fdb3[_0x567a69(0x325)](), _0x5397a0[_0x567a69(0x5e5)](_0x567a69(0x3b9))[_0x567a69(0x806)] = '❚❚'; } else _0x50861f[_0x567a69(0x6a3)] = _0x4aaa61['likes'] || [], _0x374738['comments'] = (_0x3a4e1e[_0x567a69(0x292)] || [])[_0x567a69(0x82d)]((_0x5b2fdc, _0x2b9541) => ({ ..._0x5b2fdc, 'commentId': 'c_' + _0x5c248d[_0x567a69(0x2c3)] + '_' + _0x2b9541 })), _0x3b0154(), _0x4e9780(); } const _0x2dcf5d = document[_0xe2e12e(0x6c2)]('music-player-bar'); async function _0x18c5dc(_0x351572) { const _0x35fb7d = _0xe2e12e; if (!_0x351572 || !_0x351572[_0x35fb7d(0x245)](_0x35fb7d(0x7de))) return ![]; return new Promise(_0x39d0f3 => { const _0x1c010d = _0x35fb7d, _0x2b9a22 = document['createElement']('audio'); _0x2b9a22[_0x1c010d(0x6c3)] = _0x351572; const _0x160262 = setTimeout(() => { const _0x32b2a4 = _0x1c010d; 'DccYp' !== _0x32b2a4(0x3f3) ? _0xbf251c[_0x32b2a4(0x93a)](_0x32b2a4(0x98e), _0x31e5af) : (_0x5281d1(), _0x39d0f3(![])); }, 0xbb8), _0x5281d1 = () => { const _0x5d5dd8 = _0x1c010d; clearTimeout(_0x160262), _0x2b9a22[_0x5d5dd8(0x653)](_0x5d5dd8(0x47e), _0x24cd30), _0x2b9a22[_0x5d5dd8(0x653)](_0x5d5dd8(0x93a), _0x3f896a), _0x2b9a22[_0x5d5dd8(0x6c3)] = '', _0x2b9a22[_0x5d5dd8(0x6ae)](); }, _0x24cd30 = () => { const _0x57c768 = _0x1c010d; 'WzZXk' !== _0x57c768(0x5a5) ? (_0x5281d1(), _0x39d0f3(!![])) : (_0x52f823['error']('加载见面背景失败\x20for\x20' + _0x370c8e + ':', _0x19b016), _0x3854ee[_0x57c768(0x645)]['backgroundImage'] = _0x57c768(0x4aa)); }, _0x3f896a = () => { const _0xca151b = _0x1c010d; _0xca151b(0x782) === 'kXixk' ? (_0x3c1879['style']['display'] = _0xca151b(0x381), _0x2b9887(() => _0x5ec9f3[_0xca151b(0x970)][_0xca151b(0x68a)](_0xca151b(0x3a7)), 0xa)) : (_0x5281d1(), _0x39d0f3(![])); }; _0x2b9a22[_0x1c010d(0x501)]('canplaythrough', _0x24cd30), _0x2b9a22[_0x1c010d(0x501)](_0x1c010d(0x93a), _0x3f896a); }); } async function _0x51dab6(_0x183754, _0x2c9454) { const _0x1b2fc8 = _0xe2e12e, _0x494281 = [_0x1b2fc8(0x688), 'tencent']; for (const _0x2ad540 of _0x494281) { if (_0x1b2fc8(0x635) !== _0x1b2fc8(0x635)) _0x28a3e1[_0x1b2fc8(0x3e6)] = ![]; else try { if (_0x1b2fc8(0x689) === _0x1b2fc8(0x689)) { const _0x1d5590 = _0x1b2fc8(0x6c7) + _0x2ad540 + '?word=' + encodeURIComponent(_0x183754) + '-' + encodeURIComponent(_0x2c9454), _0x7bc0cf = await fetch(_0x1d5590), _0x4443dd = await _0x7bc0cf[_0x1b2fc8(0x273)](); if (_0x4443dd['code'] !== 0xc8 || !_0x4443dd[_0x1b2fc8(0x67c)] || _0x4443dd['data']['length'] === 0x0) continue; const _0x5da226 = _0x4443dd['data']['slice'](0x0, 0x5); for (const _0x5257e8 of _0x5da226) { const _0x3e734b = _0x1b2fc8(0x6c7) + _0x2ad540 + _0x1b2fc8(0x923) + _0x5257e8['id'], _0x3db880 = await fetch(_0x3e734b), _0x30f009 = await _0x3db880['json'](), _0x334087 = _0x30f009[_0x1b2fc8(0x67c)]?.['url']; if (await _0x18c5dc(_0x334087)) return { 'url': _0x334087, 'cover': _0x5257e8['cover'], 'source': _0x2ad540 }; } } else _0x25206f(_0x1924d1[_0x1b2fc8(0x135)]), _0x174b0e(); } catch (_0x36892f) { console[_0x1b2fc8(0x93a)](_0x1b2fc8(0x46b) + _0x2ad540 + ':', _0x36892f); } } return { 'url': null, 'cover': null, 'source': null }; } function _0xdabe2d(_0x3ce958) { const _0x3d469a = _0xe2e12e; try { const _0x17d605 = JSON[_0x3d469a(0x213)](localStorage['getItem']('badgeState') || '{}'), _0x574a58 = { ..._0x17d605, ..._0x3ce958 }; localStorage[_0x3d469a(0x598)](_0x3d469a(0x603), JSON[_0x3d469a(0x822)](_0x574a58)); } catch (_0xdc36d5) { console[_0x3d469a(0x93a)](_0x3d469a(0x1da), _0xdc36d5); } } async function _0x1ec78e() { const _0x297ee8 = _0xe2e12e, _0xec6ed2 = document[_0x297ee8(0x6c2)](_0x297ee8(0x74b)), _0x54b703 = document[_0x297ee8(0x6c2)](_0x297ee8(0x1aa)); try { let _0x135405 = await _0x299fa0(_0x297ee8(0x359)); if (!_0x135405) { const _0x4fd125 = JSON['parse'](localStorage[_0x297ee8(0x745)](_0x297ee8(0x603)) || '{}'); _0x4fd125[_0x297ee8(0x776)] && (console[_0x297ee8(0x39f)](_0x297ee8(0x8ce)), _0x135405 = await _0x1679a8(_0x4fd125[_0x297ee8(0x776)]), await _0x34f697(_0x297ee8(0x359), _0x135405)); } _0x135405 ? (_0x54b703[_0x297ee8(0x6c3)] = URL[_0x297ee8(0x1de)](_0x135405), _0xec6ed2['style'][_0x297ee8(0x23e)] = _0x297ee8(0x2a9)) : _0xec6ed2[_0x297ee8(0x645)][_0x297ee8(0x23e)] = _0x297ee8(0x2a9); } catch (_0x10f531) { if (_0x297ee8(0x233) !== _0x297ee8(0x390)) console[_0x297ee8(0x93a)](_0x297ee8(0x336), _0x10f531); else { if (_0x399f48[_0x297ee8(0x3e6)]) return; const _0xba0957 = _0x241070[_0x297ee8(0x7f5)], _0x12f987 = _0x54e802[_0x297ee8(0x566)](_0x20e8e3[_0x297ee8(0x18c)][_0x297ee8(0x5a8)](_0x4529cb => _0x4529cb[_0x297ee8(0x6e8)] === _0xa6a96c[_0x297ee8(0x376)])[_0x297ee8(0x489)][_0x297ee8(0x2bd)] / 0x2); if (_0xba0957 >= _0x12f987 - 0x1) return; _0x3987f3[_0x297ee8(0x3e6)] = !![]; const _0x22f0a1 = _0xba0957 + 0x1, _0x54d657 = _0x9f03c3['getElementById'](_0x297ee8(0x2f9) + _0xba0957), _0x19853d = _0x1a1b64[_0x297ee8(0x6c2)](_0x297ee8(0x2f9) + _0x22f0a1); _0x54d657 && _0x19853d ? (_0x19853d[_0x297ee8(0x970)][_0x297ee8(0x68a)](_0x297ee8(0x848)), _0x54d657['classList'][_0x297ee8(0x68a)]('is-exiting-left'), _0x19853d[_0x297ee8(0x970)][_0x297ee8(0x68a)](_0x297ee8(0x4d5)), _0xc2297f(() => { const _0xbbaf07 = _0x297ee8; _0x54d657['classList'][_0xbbaf07(0x6ae)](_0xbbaf07(0x4d5), _0xbbaf07(0x9a6)), _0x19853d[_0xbbaf07(0x970)][_0xbbaf07(0x6ae)](_0xbbaf07(0x848)), _0x51ea12[_0xbbaf07(0x7f5)] = _0x22f0a1, _0x4cd738(), _0x53eca0[_0xbbaf07(0x3e6)] = ![]; }, 0x2bc)) : _0x4327a7[_0x297ee8(0x3e6)] = ![]; } } } function _0x19223d(_0x4a3ea6) { const _0xf798d = _0xe2e12e; if ('cwfKo' !== _0xf798d(0x8b9)) _0x13a05a('错误:\x20' + _0xaf2b14[_0xf798d(0x6a1)]); else try { if (_0xf798d(0x4e5) === _0xf798d(0x4e5)) { const _0x3bef55 = JSON[_0xf798d(0x213)](localStorage[_0xf798d(0x745)](_0xf798d(0x867)) || '{}'), _0x3680d9 = { ..._0x3bef55, ..._0x4a3ea6 }; localStorage[_0xf798d(0x598)](_0xf798d(0x867), JSON['stringify'](_0x3680d9)); } else { const _0x2abdc3 = _0x412736[_0xf798d(0x6c2)](_0xf798d(0x97a)); _0x2abdc3[_0xf798d(0x978)] = ''; if (_0x405138[_0xf798d(0x54c)][_0xf798d(0x2bd)] === 0x0) { _0x2abdc3[_0xf798d(0x978)] = _0xf798d(0x354); return; } _0x21013e[_0xf798d(0x54c)][_0xf798d(0x279)](_0x1427b3 => { const _0xcf1c09 = _0xf798d, _0x22be77 = _0x4149ac[_0xcf1c09(0x26d)]['find'](_0x19f3af => _0x19f3af['id'] === _0x1427b3[_0xcf1c09(0x757)]) || { 'name': '未知用户' }, _0x40e8cb = _0x2ded6d['createElement'](_0xcf1c09(0x46f)); _0x40e8cb[_0xcf1c09(0x255)] = 'world-book-item', _0x40e8cb['dataset']['id'] = _0x1427b3['id'], _0x40e8cb[_0xcf1c09(0x978)] = _0xcf1c09(0x4c9) + _0x1427b3[_0xcf1c09(0x8fa)] + _0xcf1c09(0x398) + _0x22be77[_0xcf1c09(0x8fa)] + _0xcf1c09(0x993) + _0x1427b3[_0xcf1c09(0x6fe)][_0xcf1c09(0x2bd)] + _0xcf1c09(0x984), _0x40e8cb[_0xcf1c09(0x501)]('click', () => _0x14e749(_0x1427b3['id'])), _0x2abdc3[_0xcf1c09(0x54e)](_0x40e8cb); }); } } catch (_0x1b1b1b) { console[_0xf798d(0x93a)](_0xf798d(0x540), _0x1b1b1b); } } async function _0x3b4474() { const _0x25ca93 = _0xe2e12e, _0x492e9b = document[_0x25ca93(0x6c2)](_0x25ca93(0x37c)), _0x314e00 = document[_0x25ca93(0x6c2)](_0x25ca93(0x383)); try { if (_0x25ca93(0x538) !== _0x25ca93(0x18a)) { let _0x3a4f9c = await _0x299fa0('widget_card'); if (!_0x3a4f9c) { if (_0x25ca93(0x8f4) !== _0x25ca93(0x8f4)) { if (_0xf474ff < 0x0 || _0x2c4730 >= _0xbfdd25) return; _0x1dda78[_0x25ca93(0x645)][_0x25ca93(0x25d)] = 'translateX(-' + _0x53bee1 * (0x64 / _0x406143) + '%)', _0x287e8b[_0x25ca93(0x279)](_0x29cabc => _0x29cabc['classList'][_0x25ca93(0x6ae)](_0x25ca93(0x68c))), _0x11267f[_0x266791]['classList'][_0x25ca93(0x68a)]('active'), _0x39eb40 = _0x42c02c; } else { const _0x37d0d4 = JSON[_0x25ca93(0x213)](localStorage[_0x25ca93(0x745)](_0x25ca93(0x867)) || '{}'); if (_0x37d0d4[_0x25ca93(0x776)]) { if (_0x25ca93(0x943) === _0x25ca93(0x131)) { const _0x477c52 = _0x3584ba[_0x25ca93(0x82b)]('li'); _0x477c52[_0x25ca93(0x255)] = _0x25ca93(0x7b5), _0x477c52['dataset'][_0x25ca93(0x5aa)] = _0x4255d0['id'], _0x477c52[_0x25ca93(0x978)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0xdb0a15[_0x25ca93(0x86f)] || _0x8c2f62) + _0x25ca93(0x16f) + _0xeba44b[_0x25ca93(0x8fa)] + _0x25ca93(0x59c) + (_0x1fe099[_0x25ca93(0x5f2)] || '私聊') + _0x25ca93(0x19f), _0x477c52[_0x25ca93(0x501)](_0x25ca93(0x4bd), () => { _0x20d7f8(_0x307915['id']); }), _0x4ba4d0[_0x25ca93(0x54e)](_0x477c52); } else console[_0x25ca93(0x39f)](_0x25ca93(0x312)), _0x3a4f9c = await _0x1679a8(_0x37d0d4[_0x25ca93(0x776)]), await _0x34f697('widget_card', _0x3a4f9c); } } } _0x3a4f9c ? (_0x314e00['src'] = URL[_0x25ca93(0x1de)](_0x3a4f9c), _0x492e9b[_0x25ca93(0x645)][_0x25ca93(0x23e)] = _0x25ca93(0x2a9)) : 'ulGuC' !== 'ulGuC' ? (_0x4950bd['worldBooks'] = _0x420a99[_0x25ca93(0x7ea)][_0x25ca93(0x5fe)](_0x4e2ce4 => _0x4e2ce4['id'] !== _0x38cfe1), _0x1d804b[_0x25ca93(0x4ee)]['forEach'](_0x3b2b8a => { const _0x572000 = _0x25ca93; _0x3b2b8a[_0x572000(0x963)] && (_0x3b2b8a[_0x572000(0x963)] = _0x3b2b8a[_0x572000(0x963)][_0x572000(0x5fe)](_0x25fa05 => _0x25fa05 !== _0x30937f)); }), _0x473b52(), _0x51d4ce('条目已删除。'), _0x1f10bb(), _0x42b780('worldBook', _0x25ca93(0x945))) : _0x492e9b[_0x25ca93(0x645)]['display'] = _0x25ca93(0x2a9); } else { const _0x130a17 = _0x583e68[_0x25ca93(0x53f)][_0x25ca93(0x5a8)](_0x444866 => _0x444866['id'] === _0x209b7f); if (!_0x130a17 || _0x130a17[_0x25ca93(0x327)] !== _0x25ca93(0x70e)) return; _0x5bd965[_0x25ca93(0x6c2)](_0x25ca93(0x4b4))[_0x25ca93(0x135)] = _0x130a17[_0x25ca93(0x8fa)] || '', _0x259489(_0x25ca93(0x744)), _0x224937[_0x25ca93(0x6c2)](_0x25ca93(0x744))[_0x25ca93(0x135)] = _0x130a17['boundUserProfileId'] || _0x492685[_0x25ca93(0x4f1)]; const _0x2d1865 = _0x1754ba[_0x25ca93(0x6c2)](_0x25ca93(0x89c)); _0x2d1865[_0x25ca93(0x978)] = '', _0x4d8659[_0x25ca93(0x7ea)][_0x25ca93(0x279)](_0x488296 => { const _0xb094cd = _0x25ca93, _0x4a27ca = _0x130a17[_0xb094cd(0x963)]?.[_0xb094cd(0x407)](_0x488296['id']), _0x53efe1 = _0x4c550a[_0xb094cd(0x82b)](_0xb094cd(0x191)); _0x53efe1[_0xb094cd(0x978)] = _0xb094cd(0x839) + _0x488296['id'] + '\x22\x20' + (_0x4a27ca ? _0xb094cd(0x5a7) : '') + '>\x20' + _0x488296['name'], _0x2d1865[_0xb094cd(0x54e)](_0x53efe1); }), _0x403dee(); const _0x2272ea = _0x14e1b4[_0x25ca93(0x6c2)](_0x25ca93(0x2c9)), _0x3e3fa6 = _0x53a52a[_0x25ca93(0x6c2)]('group-bg-preview'); _0x547fea(_0x25ca93(0x170) + _0x11cfc8)['then'](_0x36f209 => { const _0x35a891 = _0x25ca93; _0x2272ea[_0x35a891(0x6c3)] = _0x36f209 ? _0x12581c[_0x35a891(0x1de)](_0x36f209) : _0x2d865d; }), _0x1f8024(_0x25ca93(0x57d) + _0x156fbd)[_0x25ca93(0x588)](_0x14ef43 => { const _0xdd98b2 = _0x25ca93; _0x3e3fa6[_0xdd98b2(0x6c3)] = _0x14ef43 ? _0x4b374a[_0xdd98b2(0x1de)](_0x14ef43) : ''; }), _0x5280a5('groupSettings', _0x25ca93(0x60d)); } } catch (_0x17318e) { console[_0x25ca93(0x93a)](_0x25ca93(0x98e), _0x17318e); } try { let _0x23a38d = await _0x299fa0('widget_card_2'); const _0x4c85a8 = document[_0x25ca93(0x6c2)]('card-image-2'), _0x2113fb = document[_0x25ca93(0x6c2)](_0x25ca93(0x931)); _0x23a38d ? (_0x4c85a8[_0x25ca93(0x6c3)] = URL[_0x25ca93(0x1de)](_0x23a38d), _0x2113fb[_0x25ca93(0x645)][_0x25ca93(0x23e)] = _0x25ca93(0x2a9)) : _0x25ca93(0x4bc) !== _0x25ca93(0x7db) ? _0x2113fb[_0x25ca93(0x645)][_0x25ca93(0x23e)] = _0x25ca93(0x4aa) : (_0x331b2b[_0x25ca93(0x93a)](_0x25ca93(0x43d) + _0x181595['id'] + _0x25ca93(0x5e6), _0x149afd), _0x555428[_0x25ca93(0x6c3)] = _0x580081[_0x25ca93(0x86f)] || _0x40fbc1); } catch (_0x1daf93) { _0x25ca93(0x4d1) === _0x25ca93(0x1f2) ? _0x4f023c(_0x431ca8[_0x25ca93(0x676)], _0x2d97c8[_0x25ca93(0x25f)]) : console[_0x25ca93(0x93a)]('加载第二个卡片图片失败', _0x1daf93); } } _0x2f2699['addEventListener'](_0xe2e12e(0x4bd), () => { const _0x35ce92 = _0xe2e12e; _0x14b003(), _0x113213(_0x35ce92(0x4e1), _0x35ce92(0x54a)); }), document['getElementById'](_0xe2e12e(0x6cf))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0x113213(_0xe2e12e(0x54a), _0xe2e12e(0x4e1))), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x40e))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0x4c6ef1()), document[_0xe2e12e(0x6c2)]('back-to-user-list-from-edit')[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x471dbe = _0xe2e12e; if (_0x471dbe(0x169) !== _0x471dbe(0x169)) return _0x499bcf[_0x471dbe(0x8a1)](_0x274015, _0x10b74e + 0x1); else _0x14b003(), _0x113213(_0x471dbe(0x4e1), 'userProfile'); }), document[_0xe2e12e(0x6c2)]('save-user-profile-button')['addEventListener'](_0xe2e12e(0x4bd), _0x289bbe), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x614))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x1a0fb9), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x211))['addEventListener'](_0xe2e12e(0x4bd), () => { const _0x201436 = _0xe2e12e, _0x23f807 = document['getElementById']('editing-user-id')[_0x201436(0x135)]; _0x23f807 && (_0x201436(0x23d) === _0x201436(0x1fc) ? _0x5160eb[_0x201436(0x714)] = _0x6d5b6f : (_0x4d4ca5[_0x201436(0x4f1)] = _0x23f807, _0x42173a(), _0x589297(_0x201436(0x78a)), _0x14b003(), document['getElementById'](_0x201436(0x211))['style'][_0x201436(0x23e)] = _0x201436(0x4aa))); }); function _0x55e5f6(_0x448987) { const _0x20abfb = _0xe2e12e, _0x11eaf2 = _0x4d4ca5[_0x20abfb(0x53f)][_0x20abfb(0x5a8)](_0x208c4f => _0x208c4f['id'] === _0x448987), _0x335652 = _0x11eaf2?.[_0x20abfb(0x757)]; let _0x32e725 = _0x4d4ca5[_0x20abfb(0x26d)][_0x20abfb(0x5a8)](_0x2ef459 => _0x2ef459['id'] === _0x335652); return !_0x32e725 && (_0x32e725 = _0x4d4ca5[_0x20abfb(0x26d)][_0x20abfb(0x5a8)](_0x605212 => _0x605212['id'] === _0x4d4ca5[_0x20abfb(0x4f1)]) || _0x4d4ca5['userProfiles'][0x0]), _0x32e725 || { 'name': '用户', 'avatar': _0x4abe2b, 'persona': '' }; } function _0x3a8680(_0x3a42a2) { const _0x315d9a = _0xe2e12e, _0x34c33f = document[_0x315d9a(0x6c2)](_0x3a42a2); _0x34c33f['innerHTML'] = '', _0x4d4ca5['userProfiles']['forEach'](_0x26d501 => { const _0x39d672 = _0x315d9a; if (_0x39d672(0x2f3) === _0x39d672(0x2f3)) { const _0x3421c3 = document[_0x39d672(0x82b)](_0x39d672(0x21a)); _0x3421c3[_0x39d672(0x135)] = _0x26d501['id'], _0x3421c3['textContent'] = _0x26d501[_0x39d672(0x8fa)], _0x34c33f[_0x39d672(0x54e)](_0x3421c3); } else _0x3c089d = 'horizontal'; }); } function _0x4f252a(_0x27cc1b) { const _0x3b07d8 = _0xe2e12e, _0x151807 = _0x53bcef(_0x27cc1b), _0x36d18f = document[_0x3b07d8(0x6c2)](_0x3b07d8(0x558)); _0x36d18f['style'][_0x3b07d8(0x21c)] = ''; let _0x3b0d57 = document[_0x3b07d8(0x6c2)]('style-' + _0x27cc1b); if (_0x3b0d57) _0x3b0d57[_0x3b07d8(0x978)] = ''; if (!_0x151807) return; _0x151807[_0x3b07d8(0x3b6)] && ('CuwxP' !== 'CuwxP' ? _0x2a8f3d[_0x3b07d8(0x598)](_0x1347eb, _0xbaf20b['stringify'](_0x25c29e)) : (_0x36d18f['style'][_0x3b07d8(0x21c)] = 'url(\x27' + _0x151807[_0x3b07d8(0x3b6)] + '\x27)', _0x36d18f[_0x3b07d8(0x645)][_0x3b07d8(0x19d)] = _0x3b07d8(0x2b6), _0x36d18f[_0x3b07d8(0x645)][_0x3b07d8(0x2e8)] = _0x3b07d8(0x89e))); if (_0x151807[_0x3b07d8(0x303)]) { let _0xd17e08 = document['getElementById'](_0x3b07d8(0x27e) + _0x151807['id']); !_0xd17e08 && (_0xd17e08 = document[_0x3b07d8(0x82b)](_0x3b07d8(0x645)), _0xd17e08['id'] = _0x3b07d8(0x27e) + _0x151807['id'], document[_0x3b07d8(0x6b4)][_0x3b07d8(0x54e)](_0xd17e08)); const _0x3af9f7 = _0x151807['bubbleCss'], _0x28fcb3 = _0x3af9f7[_0x3b07d8(0x2ce)](/\.bubble\.sent/g, _0x3b07d8(0x9ac) + _0x151807['id'] + _0x3b07d8(0x238))[_0x3b07d8(0x2ce)](/\.bubble\.received/g, _0x3b07d8(0x9ac) + _0x151807['id'] + _0x3b07d8(0x480)); _0xd17e08['innerHTML'] = _0x28fcb3; } } function _0x26fab8() { const _0x34c3f0 = _0xe2e12e, _0x344527 = document['getElementById'](_0x34c3f0(0x8bc)); _0x344527['innerHTML'] = ''; const _0x2e5cda = _0x2fa73b => { const _0x213990 = _0x34c3f0; _0x4d4ca5[_0x213990(0x777)][_0x2fa73b] = null; if (_0x2fa73b === 'image') _0x4d4ca5[_0x213990(0x777)][_0x213990(0x714)] = null; _0x26fab8(); }, _0x2df00e = _0x4d4ca5[_0x34c3f0(0x777)][_0x34c3f0(0x714)], _0x2351ad = _0x4d4ca5['pendingPostAttachments']['music']; if (_0x2df00e) { if (_0x34c3f0(0x5ca) === _0x34c3f0(0x5ca)) { const _0x2adce6 = document[_0x34c3f0(0x82b)](_0x34c3f0(0x46f)); _0x2adce6[_0x34c3f0(0x255)] = _0x34c3f0(0x8d2), _0x2adce6['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x2adce6[_0x34c3f0(0x5e5)](_0x34c3f0(0x29f))[_0x34c3f0(0x254)] = () => _0x2e5cda(_0x34c3f0(0x776)), _0x344527[_0x34c3f0(0x54e)](_0x2adce6), _0x299fa0(_0x2df00e)[_0x34c3f0(0x588)](_0x10c939 => { const _0x12d691 = _0x34c3f0; if (_0x12d691(0x76d) !== _0x12d691(0x76d)) _0x51db63(), _0x3451ec(![]), _0x589719[_0x12d691(0x9b9)] = ![]; else { const _0x2730ed = document[_0x12d691(0x6c2)](_0x12d691(0x21b)); if (_0x2730ed && _0x10c939) { if (_0x12d691(0x781) === _0x12d691(0x3b8)) { const _0x17adb5 = _0x6cbc2[_0x12d691(0x5e5)]('#member-select-' + _0x871bad); if (_0x17adb5) _0x17adb5[_0x12d691(0x5a7)] = !![]; } else _0x2730ed[_0x12d691(0x6c3)] = URL[_0x12d691(0x1de)](_0x10c939); } } }); } else _0x1bfe3f *= _0x40a31d / _0x538248, _0x4b2582 = _0x1791c4; } if (_0x2351ad) { const _0x3decea = document[_0x34c3f0(0x82b)](_0x34c3f0(0x46f)); _0x3decea[_0x34c3f0(0x255)] = _0x34c3f0(0x8d2), _0x3decea[_0x34c3f0(0x978)] = _0x34c3f0(0x232) + (_0x2351ad[_0x34c3f0(0x378)] || _0x4991a9) + _0x34c3f0(0x98a) + _0x2351ad[_0x34c3f0(0x27a)] + _0x34c3f0(0x374) + _0x2351ad[_0x34c3f0(0x816)] + _0x34c3f0(0x639), _0x3decea['querySelector']('.remove-attachment-btn')[_0x34c3f0(0x254)] = () => _0x2e5cda(_0x34c3f0(0x513)), _0x344527[_0x34c3f0(0x54e)](_0x3decea); } } async function _0x5ef4a3(_0x4b492a) { const _0x545980 = _0xe2e12e; if (_0x545980(0x594) === _0x545980(0x594)) { const _0xc2ec7f = _0x4d4ca5[_0x545980(0x54c)][_0x545980(0x5a8)](_0x240829 => _0x240829['id'] === _0x4d4ca5['activeFriendCircleId']); if (!_0xc2ec7f) return; _0x3145a8(!![], _0x545980(0x8ee)), _0x4d4ca5['isGenerating'] = !![]; try { const _0x2ecd7c = _0xc2ec7f[_0x545980(0x6fe)][_0x545980(0x82d)](_0x299345 => _0x53bcef(_0x299345))['filter'](Boolean), _0x317d2d = _0x4664bc(), _0x284002 = _0x2ecd7c[_0x545980(0x82d)](_0x2c626d => { const _0x4dcfe0 = _0x545980, { omniText: _0x543714 } = _0x4a974c(_0x2c626d['id'], null), _0x2e457b = _0x532554(_0x2c626d['id']), _0x47337c = _0x2c626d['linkedWorldBookIds'] && _0x2c626d['linkedWorldBookIds'][_0x4dcfe0(0x2bd)] > 0x0 ? _0x4dcfe0(0x718) + _0x2c626d['name'] + _0x4dcfe0(0x90c) + _0x2c626d[_0x4dcfe0(0x963)][_0x4dcfe0(0x82d)](_0x4f4b2c => _0x4d4ca5[_0x4dcfe0(0x7ea)]['find'](_0xa16a2d => _0xa16a2d['id'] === _0x4f4b2c))[_0x4dcfe0(0x5fe)](Boolean)[_0x4dcfe0(0x82d)](_0x46f806 => _0x4dcfe0(0x90f) + _0x46f806['name'] + '\x0a' + _0x46f806[_0x4dcfe0(0x7af)])[_0x4dcfe0(0x5cd)]('') : ''; return '-\x20姓名:\x20' + _0x2c626d[_0x4dcfe0(0x8fa)] + _0x4dcfe0(0x96a) + _0x2c626d['id'] + _0x4dcfe0(0x864) + _0x2c626d[_0x4dcfe0(0x7d5)] + _0x4dcfe0(0x627) + _0x543714 + '\x0a' + _0x2e457b + '\x0a' + _0x47337c; })[_0x545980(0x5cd)]('\x0a\x0a'), _0x367c00 = _0x405c17(_0x4b492a[_0x545980(0x60b)]) || { 'name': '用户' }, _0x2b8d3d = _0x367c00[_0x545980(0x7d5)] ? _0x545980(0x490) + _0x367c00[_0x545980(0x8fa)] + _0x545980(0x914) + _0x367c00['persona'] + '\x0a' : ''; let _0x5c6a64 = null; if (_0x4b492a[_0x545980(0x776)]) { if (_0x545980(0x99a) !== _0x545980(0x99a)) { const _0x2a6b73 = _0x2d268c(_0x1938b7[_0x545980(0x836)][0x0]); return _0x2a6b73?.['name'] || 'AI'; } else _0x5c6a64 = _0x4b492a['image']; } else { if (_0x4b492a[_0x545980(0x714)]) { if (_0x545980(0x36f) !== _0x545980(0x61b)) try { const _0x5bd331 = await _0x299fa0(_0x4b492a[_0x545980(0x714)]); _0x5bd331 && (_0x5c6a64 = await _0x1ac482(_0x5bd331)); } catch (_0x402865) { console['error']('在准备动态回复时，读取图片失败:', _0x402865); } else { if (_0x1cdda9) { const _0x246aee = _0x172d2a[_0x545980(0x1de)](_0x528eaa); _0x1e8fa4[_0x545980(0x6c3)] = _0x246aee, _0x18a7bc[_0x545980(0x575)] = () => { const _0x236155 = _0x545980; _0x2a1891[_0x236155(0x3cf)](_0x246aee); }; } else _0xab0c23['alt'] = _0x545980(0x729); } } } let _0x4f2949 = _0x367c00[_0x545980(0x8fa)] + _0x545980(0x4a8) + _0x4b492a['content'] + '”'; if (_0x5c6a64) { if (_0x545980(0x3db) === _0x545980(0x3db)) _0x4f2949 += _0x545980(0x55b); else { const _0x41d2ac = _0xc55c6f[_0x545980(0x863)](_0x545980(0x789)), _0xcd42de = _0xf5c977[_0x545980(0x42a)][_0x545980(0x242)], _0x903d53 = _0x36a945(_0x41d2ac[_0x545980(0x42a)][_0x545980(0x384)], 0xa); _0x1b62da(_0xcd42de, _0x903d53, _0xd88008); } } _0x4b492a['type'] === 'music' && (_0x4f2949 += '\x20[并分享了歌曲:\x20' + _0x4b492a['songName'] + _0x545980(0x33b) + _0x4b492a[_0x545980(0x816)] + ']'); const _0x2aee1f = _0x545980(0x348) + _0x284002 + '\x0a\x0a' + _0x2b8d3d + '\x0a\x0a#\x20最近的动态回顾\x20(供参考)\x0a' + _0x317d2d + _0x545980(0x52d) + _0x4f2949 + _0x545980(0x5c1), _0x2cd7ae = [{ 'role': _0x545980(0x449), 'content': _0x2aee1f }], _0x378a5b = { 'role': _0x545980(0x75d), 'content': _0x545980(0x3ab) }; _0x5c6a64 && (_0x378a5b[_0x545980(0x776)] = _0x5c6a64); _0x2cd7ae[_0x545980(0x956)](_0x378a5b); const _0x17c06c = await _0xc7a378(_0x2cd7ae, { 'json': !![] }), _0x40c2f5 = _0x17c06c[_0x545980(0x199)](/({[\s\S]*})/); if (!_0x40c2f5) throw new Error(_0x545980(0x7a0)); const _0x4bfe21 = JSON[_0x545980(0x213)](_0x40c2f5[0x1]), _0x2c8d21 = _0xc2ec7f['posts']['find'](_0x173fe2 => _0x173fe2['id'] === _0x4b492a['id']); _0x2c8d21 && (_0x2c8d21['likes'] = _0x4bfe21['likes'] || [], _0x2c8d21[_0x545980(0x292)] = (_0x4bfe21[_0x545980(0x292)] || [])['map']((_0x3e9dff, _0x18913d) => ({ ..._0x3e9dff, 'commentId': 'c_' + _0x4b492a[_0x545980(0x2c3)] + '_' + _0x18913d })), _0x42173a(), _0x2100d0()); } catch (_0x26027f) { console[_0x545980(0x93a)](_0x545980(0x4e9), _0x26027f), _0x589297('大家好像不知道该怎么回复...'); } finally { _0x3145a8(![]), _0x4d4ca5['isGenerating'] = ![]; } } else _0x408bf1 = _0x15e75f[_0x545980(0x213)](_0x2118de); } function _0x6f8a5d() { const _0x569410 = _0xe2e12e, _0x2b087d = _0x4d4ca5[_0x569410(0x54c)][_0x569410(0x5a8)](_0x40fdaf => _0x40fdaf['id'] === _0x4d4ca5[_0x569410(0x752)]), _0x294120 = _0x2b087d?.[_0x569410(0x757)]; let _0x13858f = _0x4d4ca5[_0x569410(0x26d)]['find'](_0x223d37 => _0x223d37['id'] === _0x294120); !_0x13858f && (_0x13858f = _0x4d4ca5[_0x569410(0x26d)]['find'](_0x1c04fa => _0x1c04fa['id'] === _0x4d4ca5[_0x569410(0x4f1)])), !_0x13858f && (_0x13858f = _0x4d4ca5[_0x569410(0x26d)][0x0]), _0x13858f && (_0x569410(0x696) === _0x569410(0x512) ? _0x30e46b(_0x2eec90['id']) : document['getElementById'](_0x569410(0x6d7))[_0x569410(0x6c3)] = _0x13858f[_0x569410(0x86f)] || _0x4abe2b); } function _0x238663(_0x532d36) { const _0x4bb780 = _0xe2e12e; if (_0x4bb780(0x29c) === 'LByZu') { let _0x53fdd3 = 0x0, _0x46d793 = 0x0, _0x281581 = 0x0; if (_0x532d36[_0x4bb780(0x2bd)] == 0x4) _0x53fdd3 = '0x' + _0x532d36[0x1] + _0x532d36[0x1], _0x46d793 = '0x' + _0x532d36[0x2] + _0x532d36[0x2], _0x281581 = '0x' + _0x532d36[0x3] + _0x532d36[0x3]; else { if (_0x532d36[_0x4bb780(0x2bd)] == 0x7) { if (_0x4bb780(0x754) !== _0x4bb780(0x3e3)) _0x53fdd3 = '0x' + _0x532d36[0x1] + _0x532d36[0x2], _0x46d793 = '0x' + _0x532d36[0x3] + _0x532d36[0x4], _0x281581 = '0x' + _0x532d36[0x5] + _0x532d36[0x6]; else { _0x3ef033(_0x4bb780(0x40d)); return; } } } _0x53fdd3 /= 0xff, _0x46d793 /= 0xff, _0x281581 /= 0xff; let _0x48f7f0 = Math[_0x4bb780(0x59f)](_0x53fdd3, _0x46d793, _0x281581), _0x33c01c = Math['max'](_0x53fdd3, _0x46d793, _0x281581), _0x1254a7 = _0x33c01c - _0x48f7f0, _0x32801f = 0x0, _0x490ba2 = 0x0, _0x47647c = 0x0; if (_0x1254a7 == 0x0) _0x32801f = 0x0; else { if (_0x33c01c == _0x53fdd3) _0x32801f = (_0x46d793 - _0x281581) / _0x1254a7 % 0x6; else { if (_0x33c01c == _0x46d793) _0x32801f = (_0x281581 - _0x53fdd3) / _0x1254a7 + 0x2; else _0x32801f = (_0x53fdd3 - _0x46d793) / _0x1254a7 + 0x4; } } _0x32801f = Math[_0x4bb780(0x830)](_0x32801f * 0x3c); if (_0x32801f < 0x0) _0x32801f += 0x168; return _0x47647c = (_0x33c01c + _0x48f7f0) / 0x2, _0x490ba2 = _0x1254a7 == 0x0 ? 0x0 : _0x1254a7 / (0x1 - Math['abs'](0x2 * _0x47647c - 0x1)), _0x490ba2 = +(_0x490ba2 * 0x64)['toFixed'](0x1), _0x47647c = +(_0x47647c * 0x64)[_0x4bb780(0x874)](0x1), { 'h': _0x32801f, 's': _0x490ba2, 'l': _0x47647c }; } else { const _0x34d192 = _0x2e2202[_0x4bb780(0x963)]?.[_0x4bb780(0x407)](_0x4d334a['id']), _0x2f40b8 = _0x453e3e[_0x4bb780(0x82b)](_0x4bb780(0x191)); _0x2f40b8[_0x4bb780(0x978)] = '<input\x20type=\x22checkbox\x22\x20value=\x22' + _0x3838cc['id'] + '\x22\x20' + (_0x34d192 ? _0x4bb780(0x5a7) : '') + '>\x20' + _0x13ffcf[_0x4bb780(0x8fa)], _0x54b9fe[_0x4bb780(0x54e)](_0x2f40b8); } } function _0x2a90bc() { const _0x148fb9 = _0xe2e12e, _0xbb799a = (_0x47398b, _0x1764d0, _0x406988) => { const _0x5da0b6 = _0x22cc, _0x5da128 = document[_0x5da0b6(0x6c2)](_0x47398b); if (!_0x5da128) return; let _0x1dca1a = null; try { if (_0x5da0b6(0x5c2) === _0x5da0b6(0x5c2)) _0x1dca1a = JSON[_0x5da0b6(0x213)](localStorage[_0x5da0b6(0x745)](_0x1764d0) || '{}'); else { const _0x133aa0 = _0x40b348[_0x5da0b6(0x28d)][_0x1ed8ed - 0x2], _0x205cf8 = _0x2da8b4['conversationHistory'][_0x187c2e - 0x1]; if (_0x133aa0[_0x5da0b6(0x188)] === ![] && _0x205cf8[_0x5da0b6(0x188)] === !![]) _0x4b6953 = _0x5da0b6(0x74e) + _0x51fba4[_0x5da0b6(0x8fa)] + '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。'; else _0x133aa0['isOffline'] === !![] && _0x205cf8[_0x5da0b6(0x188)] === ![] && (_0x1d3877 = _0x5da0b6(0x5f5) + _0x4bfad8[_0x5da0b6(0x8fa)] + _0x5da0b6(0x1a8)); } } catch { _0x1dca1a = {}; } _0x5da128[_0x5da0b6(0x645)][_0x5da0b6(0x32e)] = _0x5da0b6(0x48f), _0x5da128['style'][_0x5da0b6(0x692)] = '', _0x5da128[_0x5da0b6(0x645)][_0x5da0b6(0x2c5)] = '', _0x5da128[_0x5da0b6(0x645)][_0x5da0b6(0x76f)] = '', _0x5da128[_0x5da0b6(0x645)]['bottom'] = '', _0x5da128['style']['transform'] = ''; if (typeof _0x1dca1a[_0x5da0b6(0x692)] === _0x5da0b6(0x793) && typeof _0x1dca1a['left'] === 'number') _0x5da128[_0x5da0b6(0x645)][_0x5da0b6(0x692)] = _0x1dca1a[_0x5da0b6(0x692)] + '%', _0x5da128[_0x5da0b6(0x645)]['left'] = _0x1dca1a[_0x5da0b6(0x2c5)] + '%'; else { if ('egnNr' === _0x5da0b6(0x590)) _0x10ae64[_0x5da0b6(0x970)][_0x5da0b6(0x68a)](_0x5da0b6(0x848)), _0x35c28b['classList'][_0x5da0b6(0x68a)](_0x5da0b6(0x9a6)), _0xf3952b[_0x5da0b6(0x970)]['add']('is-visible'), _0x9632bc(() => { const _0x1873a9 = _0x5da0b6; _0x20905b[_0x1873a9(0x970)][_0x1873a9(0x6ae)](_0x1873a9(0x4d5), _0x1873a9(0x9a6)), _0x5511c6['classList']['remove'](_0x1873a9(0x848)), _0x40a1e0[_0x1873a9(0x7f5)] = _0x1906ed, _0x5311a1(), _0x5342f9[_0x1873a9(0x3e6)] = ![]; }, 0x2bc); else for (const _0x251305 in _0x406988) { _0x5da128['style'][_0x251305] = _0x406988[_0x251305]; } } }; _0xbb799a(_0x148fb9(0x322), _0x148fb9(0x715), { 'top': _0x148fb9(0x350), 'left': _0x148fb9(0x646), 'transform': 'translateX(-50%)' }), _0xbb799a('app-wallpaper', 'appIconPosition_app-wallpaper', { 'top': _0x148fb9(0x1ba), 'right': '4%' }), _0xbb799a(_0x148fb9(0x1a3), 'appIconPosition_app-user-profiles', { 'top': _0x148fb9(0x1ba), 'right': _0x148fb9(0x7a4) }), _0xbb799a(_0x148fb9(0x826), 'appIconPosition_app-settings', { 'top': '8%', 'right': _0x148fb9(0x7a4) }), _0xbb799a(_0x148fb9(0x2a6), _0x148fb9(0x43b), { 'top': '8%', 'right': '4%' }), _0xbb799a(_0x148fb9(0x40c), _0x148fb9(0x890), { 'top': _0x148fb9(0x9ae), 'left': '5%' }), _0xbb799a('app-diary', _0x148fb9(0x17d), { 'top': _0x148fb9(0x44d), 'left': _0x148fb9(0x1a7) }), _0xbb799a(_0x148fb9(0x976), 'themeWidget1State', { 'top': _0x148fb9(0x1ca), 'left': '7%' }), _0xbb799a(_0x148fb9(0x7eb), 'appIconPosition_app-accounting', { 'top': _0x148fb9(0x9ae), 'left': _0x148fb9(0x1a7) }), _0xbb799a(_0x148fb9(0x74b), _0x148fb9(0x603), { 'top': _0x148fb9(0x5ee), 'right': '5%' }), _0xbb799a('card-widget-2', _0x148fb9(0x921), { 'top': '8%', 'left': '5%' }); const _0x401d0b = document[_0x148fb9(0x6c2)](_0x148fb9(0x37c)); _0x401d0b && (_0x401d0b['style'][_0x148fb9(0x32e)] = _0x148fb9(0x48f), _0x401d0b[_0x148fb9(0x645)][_0x148fb9(0x692)] = _0x148fb9(0x7f7), _0x401d0b[_0x148fb9(0x645)]['left'] = _0x148fb9(0x646), _0x401d0b[_0x148fb9(0x645)]['transform'] = _0x148fb9(0x552), _0x401d0b['style'][_0x148fb9(0x23e)] = _0x148fb9(0x2a9)); const _0xb40272 = document['getElementById'](_0x148fb9(0x573)); _0xb40272 && ('uNSvc' !== _0x148fb9(0x508) ? (_0x34aa7c[_0x148fb9(0x806)] = _0x30a3dc[_0x148fb9(0x8fa)], _0x487597['textContent'] = _0x148fb9(0x2cd), _0xbad444(_0x44dccf, _0x148fb9(0x416))) : (_0xb40272['style'][_0x148fb9(0x32e)] = _0x148fb9(0x48f), _0xb40272[_0x148fb9(0x645)]['top'] = '35%', _0xb40272[_0x148fb9(0x645)][_0x148fb9(0x2c5)] = _0x148fb9(0x646), _0xb40272[_0x148fb9(0x645)][_0x148fb9(0x25d)] = 'translateX(-50%)', _0xb40272[_0x148fb9(0x645)][_0x148fb9(0x23e)] = _0x148fb9(0x809))); } function _0x481e58() { const _0x56e7b0 = _0xe2e12e, _0x1d517b = document['getElementById'](_0x56e7b0(0x39c)); _0x1d517b['innerHTML'] = ''; const _0xfa34d1 = document[_0x56e7b0(0x445)](_0x56e7b0(0x466)); _0xfa34d1[_0x56e7b0(0x279)](_0x5e19c7 => { const _0x24ee02 = _0x56e7b0, _0x5ecaa1 = _0x5e19c7['id'], _0x5e4354 = _0x5e19c7['querySelector']('span')['textContent'], _0x2882ec = _0x24ee02(0x860) + _0x5ecaa1, _0x5e7398 = localStorage[_0x24ee02(0x745)](_0x2882ec), _0x239f3d = document['createElement'](_0x24ee02(0x46f)); _0x239f3d[_0x24ee02(0x255)] = 'member-selection-item', _0x239f3d['style'][_0x24ee02(0x1e0)] = '10px\x200', _0x239f3d[_0x24ee02(0x978)] = _0x24ee02(0x349) + _0x5ecaa1 + _0x24ee02(0x5be) + (_0x5e7398 || _0x24ee02(0x27c)) + _0x24ee02(0x70b) + _0x5e4354 + _0x24ee02(0x97b) + _0x5ecaa1 + '\x22\x20accept=\x22image/*\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x22\x20onclick=\x22document.getElementById(\x27input_' + _0x5ecaa1 + _0x24ee02(0x36a) + _0x2882ec + _0x24ee02(0x53c), _0x1d517b[_0x24ee02(0x54e)](_0x239f3d); const _0x358051 = document[_0x24ee02(0x6c2)]('input_' + _0x5ecaa1); _0x358051['addEventListener'](_0x24ee02(0x858), async _0x615233 => { const _0x5152f3 = _0x24ee02, _0x369429 = _0x615233[_0x5152f3(0x68b)][_0x5152f3(0x4c0)][0x0]; if (!_0x369429) return; try { if (_0x5152f3(0x587) !== _0x5152f3(0x1c7)) { const _0x258e28 = await _0x13257f(_0x369429); localStorage[_0x5152f3(0x598)](_0x2882ec, _0x258e28), document[_0x5152f3(0x6c2)]('preview_' + _0x5ecaa1)[_0x5152f3(0x6c3)] = _0x258e28, _0x17582a(); } else { _0x14f14b['pendingPostAttachments'][_0x210801] = null; if (_0x2ef9fc === _0x5152f3(0x776)) _0x1d5aba['pendingPostAttachments']['imageId'] = null; _0x2cf2fc(); } } catch (_0x3064e8) { if (_0x5152f3(0x33f) === _0x5152f3(0x278)) { const _0x33b563 = _0x1f2bea(_0x30ee33[_0x5152f3(0x836)][0x0]); _0x29e8be['textContent'] = _0x33b563 ? _0x33b563['name'] : _0x5152f3(0x385); } else _0x589297('图标处理失败:\x20' + _0x3064e8[_0x5152f3(0x6a1)]); } }); }); } function _0x17582a() { const _0x14a1f4 = _0xe2e12e, _0x269130 = document[_0x14a1f4(0x445)](_0x14a1f4(0x466)); _0x269130[_0x14a1f4(0x279)](_0x129033 => { const _0x5376c3 = _0x14a1f4; if (_0x5376c3(0x236) === _0x5376c3(0x138)) { const _0x1daf31 = _0x305893[_0x5376c3(0x7af)] ? '\x20' + _0x55c059[_0x5376c3(0x7af)] : ''; _0xf7e016[_0x5376c3(0x956)]('[' + _0x5df866(_0x682349) + _0x5376c3(0x2d7) + _0x1daf31); } else { const _0x5dadcb = _0x129033['id'], _0x3925eb = _0x5376c3(0x860) + _0x5dadcb, _0x5b6b28 = localStorage[_0x5376c3(0x745)](_0x3925eb), _0x1af0f6 = _0x129033[_0x5376c3(0x5e5)](_0x5376c3(0x165)); if (_0x5b6b28) _0x5376c3(0x3f4) === _0x5376c3(0x5c4) ? _0x4ef96d[_0x5376c3(0x6ae)]() : _0x1af0f6[_0x5376c3(0x978)] = _0x5376c3(0x75b) + _0x5b6b28 + '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>'; else { if (_0x5376c3(0x907) !== _0x5376c3(0x45a)) { const _0x4405fb = document['querySelector']('#app-dock-bottom-left\x20#' + _0x5dadcb + _0x5376c3(0x5e4) + _0x5dadcb + _0x5376c3(0x4e6))?.[_0x5376c3(0x978)]; _0x4405fb && (_0x5376c3(0x58b) === _0x5376c3(0x58b) ? _0x1af0f6[_0x5376c3(0x978)] = _0x4405fb : (_0x195872[_0x5376c3(0x806)] = '旁白', _0xf16a0[_0x5376c3(0x806)] = '（对话结束）')); } else _0x37b797(), _0x29ca87(![]); } } }); } function _0x4a41db() { const _0x16b733 = _0xe2e12e; if (_0x16b733(0x78e) !== _0x16b733(0x78e)) _0x2e2282[_0x16b733(0x5e7)](_0x16b733(0x201) + _0x26a86b['activeChatId']); else { const _0x1b2f35 = _0x4d4ca5[_0x16b733(0x54c)][_0x16b733(0x5a8)](_0xdcd9f4 => _0xdcd9f4['id'] === _0x4d4ca5['activeFriendCircleId']), _0x5b29ea = _0xa2c8b5(); let _0xcd101 = []; if (_0x1b2f35 && _0x1b2f35['posts']) { const _0x453697 = _0x1b2f35[_0x16b733(0x681)][_0x16b733(0x5fe)](_0x36a606 => _0x36a606[_0x16b733(0x327)] === _0x16b733(0x513) && _0x36a606[_0x16b733(0x151)])[_0x16b733(0x82d)](_0x31ebc3 => ({ ..._0x31ebc3, 'source': 'feed' })); _0xcd101['push'](..._0x453697); } if (_0x5b29ea && _0x4d4ca5['conversationHistory']) { if (_0x16b733(0x6e2) !== _0x16b733(0x6e2)) _0x5e88e0[_0x43378e][_0x16b733(0x970)][_0x16b733(0x6ae)](_0x16b733(0x5a6)), _0x4a13fd[_0x150a42][_0x16b733(0x135)] = ''; else { const _0xceff4 = _0x4d4ca5[_0x16b733(0x28d)][_0x16b733(0x5fe)](_0x2e5f7e => _0x2e5f7e[_0x16b733(0x327)] === _0x16b733(0x513) && _0x2e5f7e['playableUrl'])[_0x16b733(0x82d)](_0x515320 => ({ ..._0x515320, 'source': 'chat' })); _0xcd101[_0x16b733(0x956)](..._0xceff4); } } const _0x518426 = Array['from'](new Map(_0xcd101['map'](_0x545ba5 => [_0x545ba5[_0x16b733(0x151)], _0x545ba5]))['values']()); _0x4d4ca5['musicPlaylist'] = _0x518426[_0x16b733(0x450)]((_0x14d5e6, _0x4a1da2) => _0x4a1da2['timestamp'] - _0x14d5e6[_0x16b733(0x2c3)]); } } function _0x33e54f(_0x575d43) { const _0x1be0cc = _0xe2e12e; if (_0x575d43 < 0x0 || _0x575d43 >= _0x10ab81['length']) return; _0x4cf774 = _0x575d43; const _0x491c05 = _0x10ab81[_0x575d43]; _0x2c7b55[_0x1be0cc(0x6c3)] = _0x491c05['playableUrl'] || _0x491c05[_0x1be0cc(0x6b8)], _0x2c7b55['play'](), _0x39cdf7(), _0x1ac328(); } function _0x39cdf7() { const _0x47cd3c = _0x10ab81[_0x4cf774]; _0x3f87e7(_0x47cd3c); } function _0x1ac328() { const _0x3bcda3 = _0xe2e12e; if (_0x3bcda3(0x761) === _0x3bcda3(0x78d)) { _0x20ce06[_0x3bcda3(0x978)] = _0x3bcda3(0x8fb); return; } else try { _0x3bcda3(0x694) === _0x3bcda3(0x694) ? localStorage[_0x3bcda3(0x598)](_0x3bcda3(0x6c4), JSON['stringify']({ 'playlist': _0x4d4ca5[_0x3bcda3(0x88a)], 'currentIndex': _0x4d4ca5[_0x3bcda3(0x4c6)] })) : _0x1ebfa7(_0x3bcda3(0x67a) + _0x5c6666['message']); } catch (_0x3a8fa1) { console[_0x3bcda3(0x93a)](_0x3bcda3(0x95f), _0x3a8fa1); } } function _0x28cb7c() { const _0x2243e4 = _0xe2e12e; try { const _0x44b054 = localStorage[_0x2243e4(0x745)](_0x2243e4(0x6c4)); if (_0x44b054) { const { playlist: _0x560b22, currentIndex: _0x57a9da } = JSON[_0x2243e4(0x213)](_0x44b054); Array[_0x2243e4(0x189)](_0x560b22) && _0x560b22[_0x2243e4(0x2bd)] > 0x0 && _0x57a9da > -0x1 && (_0x4d4ca5['musicPlaylist'] = _0x560b22, _0x4d4ca5[_0x2243e4(0x4c6)] = _0x57a9da, _0x4d4ca5[_0x2243e4(0x20b)] = ![], _0x39cdf7()); } } catch (_0x1ff35f) { console['error'](_0x2243e4(0x293), _0x1ff35f); } } function _0x397abb(_0x318e45) { const _0x371112 = _0xe2e12e; if (_0x371112(0x88e) !== _0x371112(0x88e)) { const _0xdc4e2d = _0x504ca0[_0x371112(0x82b)]('div'); _0xdc4e2d['className'] = 'preview-item', _0xdc4e2d[_0x371112(0x978)] = _0x371112(0x232) + (_0x25b15a[_0x371112(0x378)] || _0x2e69df) + _0x371112(0x98a) + _0x37ec42[_0x371112(0x27a)] + _0x371112(0x374) + _0x489f18[_0x371112(0x816)] + _0x371112(0x639), _0xdc4e2d['querySelector'](_0x371112(0x29f))[_0x371112(0x254)] = () => _0x53c62f(_0x371112(0x513)), _0x3efcba[_0x371112(0x54e)](_0xdc4e2d); } else { if (window['diaryPressTimer']) clearTimeout(window[_0x371112(0x5fa)]); const _0x1cb97b = _0x318e45[_0x371112(0x68b)]['closest']('.diary-entry'); if (!_0x1cb97b) return; const _0x3bd8db = _0x1cb97b[_0x371112(0x42a)][_0x371112(0x2c3)], _0x56581a = _0x1cb97b[_0x371112(0x970)][_0x371112(0x7a5)](_0x371112(0x75d)) ? _0x371112(0x75d) : 'ai'; if (!_0x3bd8db) return; const _0x33dabe = () => { const _0x4ea8b3 = _0x371112; window[_0x4ea8b3(0x5fa)] = setTimeout(() => { const _0x315081 = _0x4ea8b3; if (_0x318e45[_0x315081(0x327)] === _0x315081(0x8c6)) _0x318e45[_0x315081(0x955)](); _0x3f2d37(parseInt(_0x3bd8db, 0xa), _0x56581a); }, 0x320); }, _0x40a326 = () => { const _0x29cc2f = _0x371112; if (window[_0x29cc2f(0x5fa)]) clearTimeout(window[_0x29cc2f(0x5fa)]); }; document[_0x371112(0x501)]('mouseup', _0x40a326, { 'once': !![] }), document[_0x371112(0x501)]('touchend', _0x40a326, { 'once': !![] }), document[_0x371112(0x501)](_0x371112(0x87f), _0x40a326, { 'once': !![] }), _0x33dabe(); } } function _0x3f2d37(_0x1f9095, _0xbf1c56) { const _0x3236c7 = _0xe2e12e, _0x976aa8 = _0x3236c7(0x544) + _0x1f9095; let _0x77ed58 = document[_0x3236c7(0x6c2)](_0x976aa8); if (_0x77ed58) return; const _0x314378 = _0x3236c7(0x746) + _0x976aa8 + _0x3236c7(0x7e1) + (_0xbf1c56 === 'ai' ? '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>' : '') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20'; document[_0x3236c7(0x69e)][_0x3236c7(0x43f)]('beforeend', _0x314378); const _0x15c353 = document[_0x3236c7(0x6c2)](_0x976aa8), _0x42f3b0 = () => _0x15c353[_0x3236c7(0x6ae)](); _0x15c353[_0x3236c7(0x5e5)](_0x3236c7(0x73b))[_0x3236c7(0x254)] = _0x42f3b0, _0x15c353[_0x3236c7(0x5e5)](_0x3236c7(0x4fb))['onclick'] = _0x42f3b0, _0x15c353['querySelector'](_0x3236c7(0x749))[_0x3236c7(0x254)] = () => { _0x2817a8(_0x1f9095), _0x42f3b0(); }, _0xbf1c56 === 'ai' && (_0x15c353['querySelector'](_0x3236c7(0x7cf))[_0x3236c7(0x254)] = () => { _0x305a82(_0x1f9095), _0x42f3b0(); }); } async function _0x2817a8(_0x200fda) { const _0x3213f1 = _0xe2e12e; if (_0x3213f1(0x280) === _0x3213f1(0x514)) _0x52646c *= _0x45907f / _0x5bc520, _0x5e554d = _0xb57b97; else { const _0x3806a0 = await _0x385a44(_0x3213f1(0x46d)); if (!_0x3806a0) return; const _0x386898 = _0x4d4ca5[_0x3213f1(0x18c)]['find'](_0x4870a9 => _0x4870a9[_0x3213f1(0x6e8)] === _0x4d4ca5[_0x3213f1(0x376)]); if (!_0x386898) return; const _0x2a1efc = _0x386898[_0x3213f1(0x489)]['findIndex'](_0x53b8e2 => _0x53b8e2[_0x3213f1(0x2c3)] === _0x200fda); _0x2a1efc > -0x1 && ('OlzQU' !== _0x3213f1(0x351) ? (_0x4069ad[_0x3213f1(0x93a)]('保存角色失败:', _0x221857), _0x1f2b9a('保存失败:\x20' + _0x33d6bd[_0x3213f1(0x6a1)])) : (_0x386898[_0x3213f1(0x489)]['splice'](_0x2a1efc, 0x1), _0x42173a(), _0x23249f(), _0x589297('日记已删除。'))); } } async function _0x305a82(_0x342ad5) { const _0x47cf3f = _0xe2e12e, _0x16b0cf = _0x4d4ca5['diaries'][_0x47cf3f(0x5a8)](_0x32d700 => _0x32d700[_0x47cf3f(0x6e8)] === _0x4d4ca5[_0x47cf3f(0x376)]); if (!_0x16b0cf) return; const _0x23b97e = _0x16b0cf[_0x47cf3f(0x489)][_0x47cf3f(0x388)](_0x26c76c => _0x26c76c['timestamp'] === _0x342ad5); if (_0x23b97e > -0x1) { if (_0x47cf3f(0x1a6) !== 'sfQlG') { const _0x162e20 = _0x4d8428, _0x5a1154 = _0x162e20[_0x47cf3f(0x2cf)], _0x1d4518 = _0x162e20[_0x47cf3f(0x145)]; _0xb5e259[_0x47cf3f(0x226)] += 0x64, _0x30fe04(), _0x1912bb(() => { const _0x26e744 = _0x47cf3f, _0x14fd53 = _0x162e20[_0x26e744(0x2cf)]; _0x162e20[_0x26e744(0x145)] = _0x1d4518 + (_0x14fd53 - _0x5a1154); }); } else _0x16b0cf['entries'][_0x47cf3f(0x79b)](_0x23b97e, 0x1), _0x42173a(), _0x23249f(), await _0x43622e(); } } function _0x468acb() { const _0x41d467 = _0xe2e12e, _0x4332bf = document[_0x41d467(0x6c2)](_0x41d467(0x231)); _0x4332bf[_0x41d467(0x978)] = ''; const _0x3d9701 = _0x4d4ca5[_0x41d467(0x4ee)]['filter'](_0x352e18 => _0x4d4ca5[_0x41d467(0x53f)]['some'](_0x16557e => _0x16557e['type'] === 'private' && _0x16557e['participantIds'][_0x41d467(0x407)](_0x352e18['id']))); if (_0x3d9701[_0x41d467(0x2bd)] === 0x0) { _0x4332bf[_0x41d467(0x978)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>'; return; } _0x3d9701[_0x41d467(0x279)](_0x199adb => { const _0x58cdc8 = _0x41d467; if (_0x58cdc8(0x247) === _0x58cdc8(0x247)) { const _0xd1263f = document['createElement']('li'); _0xd1263f[_0x58cdc8(0x255)] = 'character-item', _0xd1263f[_0x58cdc8(0x42a)][_0x58cdc8(0x5aa)] = _0x199adb['id'], _0xd1263f[_0x58cdc8(0x978)] = _0x58cdc8(0x701) + (_0x199adb[_0x58cdc8(0x86f)] || _0x4991a9) + _0x58cdc8(0x16f) + _0x199adb['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0xd1263f[_0x58cdc8(0x501)](_0x58cdc8(0x4bd), () => { _0x5b4aca(_0x199adb['id']); }), _0xd1263f[_0x58cdc8(0x5e5)](_0x58cdc8(0x632))['addEventListener']('click', () => { _0x5b4aca(_0x199adb['id']); }), _0xd1263f[_0x58cdc8(0x5e5)](_0x58cdc8(0x5bd))['addEventListener'](_0x58cdc8(0x4bd), _0x578ce0 => { const _0x573ba5 = _0x58cdc8; _0x573ba5(0x32d) !== _0x573ba5(0x5d8) ? (_0x578ce0[_0x573ba5(0x6ca)](), _0x8f3272(_0x199adb['id'])) : _0x38d2a4[_0x573ba5(0x6c3)] && _0x33ff39[_0x573ba5(0x645)]['opacity'] !== '0' ? (_0xb44f9b['style'][_0x573ba5(0x608)] = 0x0, _0x4d87a4(() => { const _0x4fda67 = _0x573ba5; _0x29abf0['src'] = _0x4858a9[_0x4fda67(0x1de)](_0x520035), _0x3deaa0[_0x4fda67(0x645)][_0x4fda67(0x608)] = 0x1; }, 0x96)) : (_0x9550ea[_0x573ba5(0x6c3)] = _0x20c550[_0x573ba5(0x1de)](_0x8fd1d0), _0x1a9b59[_0x573ba5(0x645)]['opacity'] = 0x1); }), _0x4332bf[_0x58cdc8(0x54e)](_0xd1263f); } else { const _0x13aa2c = (_0x542698 - 0x5a) * _0x1a981f['PI'] / 0xb4; return { 'x': _0x5ba324 + _0x4b2d6a * _0x59a954[_0x58cdc8(0x7f9)](_0x13aa2c), 'y': _0x3dce1f + _0x49e41a * _0x41d331[_0x58cdc8(0x802)](_0x13aa2c) }; } }); } function _0x5b4aca(_0x17ade5) { const _0x2dc762 = _0xe2e12e; if (_0x2dc762(0x433) !== _0x2dc762(0x8c0)) { const _0x4590a9 = _0x53bcef(_0x17ade5); if (!_0x4590a9) return; _0x4d4ca5[_0x2dc762(0x376)] = _0x17ade5; const _0x2134ca = _0x4d4ca5[_0x2dc762(0x18c)]['find'](_0x4635d2 => _0x4635d2[_0x2dc762(0x6e8)] === _0x17ade5), _0x57353 = _0x2134ca ? _0x2134ca[_0x2dc762(0x489)][_0x2dc762(0x2bd)] : 0x0, _0x2c3080 = 0x2; _0x4d4ca5[_0x2dc762(0x7f5)] = Math[_0x2dc762(0x1e3)](0x0, Math[_0x2dc762(0x566)](_0x57353 / _0x2c3080) - 0x1), document[_0x2dc762(0x6c2)](_0x2dc762(0x640))[_0x2dc762(0x806)] = _0x4590a9[_0x2dc762(0x8fa)] + _0x2dc762(0x5b2), _0x23249f(), _0x113213(_0x2dc762(0x70a), _0x2dc762(0x342)); } else { let _0x2e9d71 = 0x0, _0x6f3959 = 0x0, _0x5aa4c4 = 0x0; if (_0x3b8fde[_0x2dc762(0x2bd)] == 0x4) _0x2e9d71 = '0x' + _0xd48f54[0x1] + _0x1ada9d[0x1], _0x6f3959 = '0x' + _0xd2bce5[0x2] + _0x3fd170[0x2], _0x5aa4c4 = '0x' + _0x698e73[0x3] + _0x3b18c0[0x3]; else _0x1a8e42[_0x2dc762(0x2bd)] == 0x7 && (_0x2e9d71 = '0x' + _0x4b380f[0x1] + _0x42d4b5[0x2], _0x6f3959 = '0x' + _0x545edf[0x3] + _0x18d9c9[0x4], _0x5aa4c4 = '0x' + _0x2caf7b[0x5] + _0x5cdf54[0x6]); _0x2e9d71 /= 0xff, _0x6f3959 /= 0xff, _0x5aa4c4 /= 0xff; let _0x33e441 = _0x118d17[_0x2dc762(0x59f)](_0x2e9d71, _0x6f3959, _0x5aa4c4), _0x10ef18 = _0x18e6b1[_0x2dc762(0x1e3)](_0x2e9d71, _0x6f3959, _0x5aa4c4), _0x480070 = _0x10ef18 - _0x33e441, _0x4fc552 = 0x0, _0x287d80 = 0x0, _0x3d2565 = 0x0; if (_0x480070 == 0x0) _0x4fc552 = 0x0; else { if (_0x10ef18 == _0x2e9d71) _0x4fc552 = (_0x6f3959 - _0x5aa4c4) / _0x480070 % 0x6; else { if (_0x10ef18 == _0x6f3959) _0x4fc552 = (_0x5aa4c4 - _0x2e9d71) / _0x480070 + 0x2; else _0x4fc552 = (_0x2e9d71 - _0x6f3959) / _0x480070 + 0x4; } } _0x4fc552 = _0x1cec59[_0x2dc762(0x830)](_0x4fc552 * 0x3c); if (_0x4fc552 < 0x0) _0x4fc552 += 0x168; return _0x3d2565 = (_0x10ef18 + _0x33e441) / 0x2, _0x287d80 = _0x480070 == 0x0 ? 0x0 : _0x480070 / (0x1 - _0x24d21c[_0x2dc762(0x6a4)](0x2 * _0x3d2565 - 0x1)), _0x287d80 = +(_0x287d80 * 0x64)[_0x2dc762(0x874)](0x1), _0x3d2565 = +(_0x3d2565 * 0x64)[_0x2dc762(0x874)](0x1), { 'h': _0x4fc552, 's': _0x287d80, 'l': _0x3d2565 }; } } function _0x23249f() { const _0x2057d2 = _0xe2e12e, _0x1f874a = document[_0x2057d2(0x6c2)](_0x2057d2(0x304)), _0x190244 = document[_0x2057d2(0x6c2)](_0x2057d2(0x81d)); _0x1f874a['innerHTML'] = '', _0x190244['innerHTML'] = ''; const _0x5cc7b0 = _0x308134() || { 'name': '我' }, _0x514b11 = _0x4d4ca5['diaries']['find'](_0x144bd7 => _0x144bd7['characterId'] === _0x4d4ca5['activeDiaryCharacterId']); if (!_0x514b11 || !_0x514b11[_0x2057d2(0x489)] || _0x514b11[_0x2057d2(0x489)]['length'] === 0x0) { _0x1f874a[_0x2057d2(0x978)] = _0x2057d2(0x691), _0x190244[_0x2057d2(0x978)] = _0x2057d2(0x1ab), document[_0x2057d2(0x6c2)]('diary-write-button')[_0x2057d2(0x501)]('click', _0x35fce9), document[_0x2057d2(0x6c2)](_0x2057d2(0x6d6))['addEventListener'](_0x2057d2(0x4bd), _0x43622e); return; } const _0x317e22 = 0x2, _0x3dddbb = [..._0x514b11[_0x2057d2(0x489)]][_0x2057d2(0x450)]((_0x2d9d18, _0x19b895) => _0x2d9d18[_0x2057d2(0x2c3)] - _0x19b895[_0x2057d2(0x2c3)]), _0x20c5ab = []; for (let _0x3ff1cb = 0x0; _0x3ff1cb < _0x3dddbb['length']; _0x3ff1cb += _0x317e22) { _0x20c5ab[_0x2057d2(0x956)](_0x3dddbb['slice'](_0x3ff1cb, _0x3ff1cb + _0x317e22)); } const _0x41ce10 = _0x20c5ab[_0x2057d2(0x2bd)]; _0x20c5ab['forEach']((_0x3e828b, _0x3bcb1d) => { const _0x3d6b5c = _0x2057d2; if (_0x3d6b5c(0x65d) === 'AFoit') { const _0x4bf5fa = document[_0x3d6b5c(0x82b)](_0x3d6b5c(0x46f)); _0x4bf5fa[_0x3d6b5c(0x255)] = _0x3d6b5c(0x753), _0x4bf5fa['id'] = _0x3d6b5c(0x2f9) + _0x3bcb1d, _0x3bcb1d === _0x4d4ca5[_0x3d6b5c(0x7f5)] && ('LkhkF' === _0x3d6b5c(0x6af) ? (_0x1eb5b9['error'](_0x3d6b5c(0x709), _0x1f020a), _0x22ffe9[_0x3d6b5c(0x327)] = _0x3d6b5c(0x57b)) : _0x4bf5fa[_0x3d6b5c(0x970)]['add']('is-visible')), _0x3e828b[_0x3d6b5c(0x279)](_0x356b37 => { const _0x3183c1 = _0x3d6b5c, _0x20079f = _0x356b37[_0x3183c1(0x427)] === _0x3183c1(0x75d) ? _0x3183c1(0x75d) : 'ai', _0x30aae6 = _0x356b37['author'] === _0x3183c1(0x75d) ? _0x5cc7b0['name'] : _0x53bcef(_0x356b37['author'])[_0x3183c1(0x8fa)], _0x24c3b5 = document['createElement']('div'); _0x24c3b5[_0x3183c1(0x255)] = 'diary-entry\x20' + _0x20079f, _0x24c3b5[_0x3183c1(0x42a)][_0x3183c1(0x2c3)] = _0x356b37['timestamp'], _0x24c3b5['style'][_0x3183c1(0x854)] = 'none', _0x24c3b5['style'][_0x3183c1(0x26b)] = '0', _0x24c3b5[_0x3183c1(0x978)] = _0x3183c1(0x4fd) + _0x30aae6 + _0x3183c1(0x20c) + new Date(_0x356b37['timestamp'])[_0x3183c1(0x24f)]('zh-CN') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>' + _0x356b37[_0x3183c1(0x7af)][_0x3183c1(0x2ce)](/\n/g, _0x3183c1(0x97f)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x4bf5fa[_0x3183c1(0x54e)](_0x24c3b5); }), _0x1f874a[_0x3d6b5c(0x54e)](_0x4bf5fa); } else _0x4d6a66(_0x3d6b5c(0x60d), 'characterEdit'); }), _0x190244['innerHTML'] = _0x2057d2(0x531) + (_0x4d4ca5[_0x2057d2(0x7f5)] + 0x1) + _0x2057d2(0x738) + _0x41ce10 + _0x2057d2(0x8d8), document[_0x2057d2(0x6c2)](_0x2057d2(0x48c))[_0x2057d2(0x152)] = _0x4d4ca5[_0x2057d2(0x7f5)] === 0x0, document[_0x2057d2(0x6c2)](_0x2057d2(0x89b))[_0x2057d2(0x152)] = _0x4d4ca5[_0x2057d2(0x7f5)] === _0x41ce10 - 0x1, document['getElementById'](_0x2057d2(0x48c))[_0x2057d2(0x501)](_0x2057d2(0x4bd), _0x21566a), document[_0x2057d2(0x6c2)](_0x2057d2(0x89b))[_0x2057d2(0x501)](_0x2057d2(0x4bd), _0x20fcc4), document[_0x2057d2(0x6c2)](_0x2057d2(0x87e))[_0x2057d2(0x501)](_0x2057d2(0x4bd), _0x35fce9), document['getElementById'](_0x2057d2(0x6d6))[_0x2057d2(0x501)](_0x2057d2(0x4bd), _0x43622e); } function _0x20fcc4() { const _0x22dd0a = _0xe2e12e; if (_0x4d4ca5[_0x22dd0a(0x3e6)]) return; const _0x5ade28 = _0x4d4ca5[_0x22dd0a(0x7f5)], _0x54469 = Math[_0x22dd0a(0x566)](_0x4d4ca5['diaries'][_0x22dd0a(0x5a8)](_0x29e381 => _0x29e381['characterId'] === _0x4d4ca5[_0x22dd0a(0x376)])[_0x22dd0a(0x489)][_0x22dd0a(0x2bd)] / 0x2); if (_0x5ade28 >= _0x54469 - 0x1) return; _0x4d4ca5[_0x22dd0a(0x3e6)] = !![]; const _0x1a2c66 = _0x5ade28 + 0x1, _0x430281 = document[_0x22dd0a(0x6c2)]('diary-page-' + _0x5ade28), _0x1cabb8 = document[_0x22dd0a(0x6c2)](_0x22dd0a(0x2f9) + _0x1a2c66); _0x430281 && _0x1cabb8 ? (_0x1cabb8['classList'][_0x22dd0a(0x68a)](_0x22dd0a(0x848)), _0x430281[_0x22dd0a(0x970)][_0x22dd0a(0x68a)](_0x22dd0a(0x9a6)), _0x1cabb8[_0x22dd0a(0x970)][_0x22dd0a(0x68a)](_0x22dd0a(0x4d5)), setTimeout(() => { const _0x30e3e7 = _0x22dd0a; _0x430281[_0x30e3e7(0x970)][_0x30e3e7(0x6ae)](_0x30e3e7(0x4d5), _0x30e3e7(0x9a6)), _0x1cabb8[_0x30e3e7(0x970)][_0x30e3e7(0x6ae)](_0x30e3e7(0x848)), _0x4d4ca5[_0x30e3e7(0x7f5)] = _0x1a2c66, _0x23249f(), _0x4d4ca5[_0x30e3e7(0x3e6)] = ![]; }, 0x2bc)) : _0x4d4ca5['isAnimatingDiary'] = ![]; } function _0x21566a() { const _0xec305b = _0xe2e12e; if (_0x4d4ca5[_0xec305b(0x3e6)]) return; const _0x2348b2 = _0x4d4ca5['diaryCurrentPage']; if (_0x2348b2 <= 0x0) return; _0x4d4ca5[_0xec305b(0x3e6)] = !![]; const _0x54398f = _0x2348b2 - 0x1, _0x3fbbd3 = document[_0xec305b(0x6c2)](_0xec305b(0x2f9) + _0x2348b2), _0x460afe = document[_0xec305b(0x6c2)](_0xec305b(0x2f9) + _0x54398f); _0x3fbbd3 && _0x460afe ? 'ZXurV' === _0xec305b(0x405) ? (_0x460afe['classList'][_0xec305b(0x68a)](_0xec305b(0x878)), _0x3fbbd3['classList']['add'](_0xec305b(0x89a)), _0x460afe[_0xec305b(0x970)][_0xec305b(0x68a)](_0xec305b(0x4d5)), setTimeout(() => { const _0x17e47c = _0xec305b; if ('vzHaJ' === 'qLxIN') { if (_0x2d6712) _0x12085b['click'](); } else _0x3fbbd3[_0x17e47c(0x970)][_0x17e47c(0x6ae)]('is-visible', _0x17e47c(0x89a)), _0x460afe[_0x17e47c(0x970)][_0x17e47c(0x6ae)](_0x17e47c(0x878)), _0x4d4ca5[_0x17e47c(0x7f5)] = _0x54398f, _0x23249f(), _0x4d4ca5[_0x17e47c(0x3e6)] = ![]; }, 0x2bc)) : (_0x2b5575[_0xec305b(0x93a)](_0xec305b(0x8f0), _0x5aca2c), _0x33f2fe(_0xec305b(0x5ea) + _0x3fc2bb['message'])) : _0x4d4ca5[_0xec305b(0x3e6)] = ![]; } function _0x35fce9() { return new Promise(_0x21651e => { const _0x1668b6 = _0x22cc; if (_0x1668b6(0x64a) !== _0x1668b6(0x64a)) _0x36ebc[_0x1668b6(0x54e)](_0x45cf6b), _0x4c9f00[_0x1668b6(0x54e)](_0x3b1504); else { const _0x266bd6 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; document[_0x1668b6(0x69e)]['insertAdjacentHTML'](_0x1668b6(0x168), _0x266bd6); const _0x301d21 = document[_0x1668b6(0x6c2)](_0x1668b6(0x641)), _0x219af8 = document['getElementById']('diary-modal-textarea'), _0x59d3c3 = document[_0x1668b6(0x6c2)](_0x1668b6(0x1b7)), _0x480f54 = document[_0x1668b6(0x6c2)](_0x1668b6(0x34d)), _0x4f513f = _0x301d21['querySelector'](_0x1668b6(0x73b)), _0x9938d6 = () => { const _0x2c1fb0 = _0x1668b6; 'UzoAG' !== _0x2c1fb0(0x61c) ? _0x4be5a9(_0x2c1fb0(0x1e9) + _0x69bf61['message']) : (_0x301d21[_0x2c1fb0(0x6ae)](), _0x21651e()); }; _0x59d3c3[_0x1668b6(0x254)] = () => { const _0x42f750 = _0x1668b6; 'aavZI' !== 'aavZI' ? (_0x3da5f4[_0x42f750(0x6c3)] = _0x2a9465[_0x42f750(0x1de)](_0x5c87b3), _0x2d1361[_0x42f750(0x645)][_0x42f750(0x608)] = 0x1) : (_0xc5d195(_0x219af8[_0x42f750(0x135)]), _0x9938d6()); }, _0x480f54[_0x1668b6(0x254)] = _0x9938d6, _0x4f513f[_0x1668b6(0x254)] = _0x9938d6; } }); } function _0xc5d195(_0xae70f1) { const _0x5086c3 = _0xe2e12e, _0x577c51 = _0xae70f1[_0x5086c3(0x163)](); if (!_0x577c51 || !_0x4d4ca5[_0x5086c3(0x376)]) return; let _0x3288d8 = _0x4d4ca5['diaries'][_0x5086c3(0x5a8)](_0x24de51 => _0x24de51[_0x5086c3(0x6e8)] === _0x4d4ca5['activeDiaryCharacterId']); !_0x3288d8 && (_0x3288d8 = { 'characterId': _0x4d4ca5['activeDiaryCharacterId'], 'entries': [] }, _0x4d4ca5[_0x5086c3(0x18c)][_0x5086c3(0x956)](_0x3288d8)); _0x3288d8[_0x5086c3(0x489)][_0x5086c3(0x956)]({ 'timestamp': Date[_0x5086c3(0x661)](), 'author': _0x5086c3(0x75d), 'content': _0x577c51 }), _0x42173a(); const _0x52aa24 = _0x3288d8['entries'][_0x5086c3(0x2bd)]; _0x4d4ca5[_0x5086c3(0x7f5)] = Math[_0x5086c3(0x566)](_0x52aa24 / 0x2) - 0x1, _0x23249f(); } async function _0x43622e() { const _0x2c350a = _0xe2e12e, _0x2973a5 = _0x4d4ca5['diaries']['find'](_0x436ebf => _0x436ebf[_0x2c350a(0x6e8)] === _0x4d4ca5[_0x2c350a(0x376)]), _0xbe8394 = _0x4d4ca5[_0x2c350a(0x376)], _0x10b7b6 = _0x53bcef(_0xbe8394); if (!_0x10b7b6 || _0x4d4ca5[_0x2c350a(0x9b9)]) return; _0x3145a8(!![], _0x2c350a(0x5b9)), _0x4d4ca5[_0x2c350a(0x9b9)] = !![]; let _0x4c24d3 = []; try { if (_0x2c350a(0x7b9) === 'DhRdM') _0x46e066[_0x2c350a(0x645)][_0x2c350a(0x23e)] = _0x2c350a(0x2a9), _0x4e13d5[_0x2c350a(0x645)]['display'] = _0x2c350a(0x4aa); else { const _0xf01143 = _0x308134() || { 'name': '你' }, _0x5aff71 = _0x532554(_0xbe8394), { omniText: _0x57ca08 } = _0x4a974c(_0xbe8394, _0x4d4ca5[_0x2c350a(0x41f)]); let _0x4d7d6c = ''; if (_0x10b7b6[_0x2c350a(0x963)] && _0x10b7b6[_0x2c350a(0x963)][_0x2c350a(0x2bd)] > 0x0) { const _0x1fde63 = _0x10b7b6['linkedWorldBookIds'][_0x2c350a(0x82d)](_0xdbf115 => _0x4d4ca5[_0x2c350a(0x7ea)][_0x2c350a(0x5a8)](_0x177b0c => _0x177b0c['id'] === _0xdbf115))[_0x2c350a(0x5fe)](Boolean)[_0x2c350a(0x82d)](_0x164447 => '\x0a\x0a##\x20世界书条目:\x20' + _0x164447[_0x2c350a(0x8fa)] + '\x0a' + _0x164447[_0x2c350a(0x7af)])['join'](''); if (_0x1fde63) _0x4d7d6c = _0x2c350a(0x40b) + _0x1fde63; } const _0x375b83 = _0xf01143['persona'] ? _0x2c350a(0x78b) + _0xf01143['name'] + '”的补充信息\x0a' + _0xf01143[_0x2c350a(0x7d5)] : '', _0x386df8 = _0x4664bc(); let _0x31cba2 = '你还没有写日记。'; if (_0x2973a5 && _0x2973a5['entries']) { const _0xea302a = _0x2973a5[_0x2c350a(0x489)]['filter'](_0x4c6b09 => _0x4c6b09[_0x2c350a(0x427)] === _0x2c350a(0x75d))['pop'](); _0xea302a && (_0x31cba2 = _0xea302a[_0x2c350a(0x7af)]); } const _0x19bf61 = _0x2c350a(0x9a4) + _0x10b7b6[_0x2c350a(0x8fa)] + _0x2c350a(0x96c) + _0xf01143[_0x2c350a(0x8fa)] + _0x2c350a(0x585) + _0xf01143['name'] + _0x2c350a(0x870) + _0x31cba2 + _0x2c350a(0x814) + _0x10b7b6[_0x2c350a(0x7d5)] + '\x0a' + _0x375b83 + '\x0a' + _0x4d7d6c + _0x2c350a(0x289) + new Date()['toLocaleString'](_0x2c350a(0x2f2), { 'dateStyle': _0x2c350a(0x8c7), 'timeStyle': _0x2c350a(0x8e0) }) + _0x2c350a(0x321) + _0x6ac2a8(new Date(_0x2973a5?.[_0x2c350a(0x489)]?.['at'](-0x1)?.[_0x2c350a(0x2c3)] || Date[_0x2c350a(0x661)]())) + _0x2c350a(0x67e) + (_0x57ca08 || _0x2c350a(0x7c7)) + _0x2c350a(0x2da) + (_0x386df8 || _0x2c350a(0x7dc)) + _0x2c350a(0x563); _0x4c24d3 = [{ 'role': 'system', 'content': _0x19bf61 }, { 'role': _0x2c350a(0x75d), 'content': _0x2c350a(0x4a5) }]; const _0x5d4809 = await _0xc7a378(_0x4c24d3); if (_0x5d4809) { if ('xUBsw' !== 'xUBsw') { if (_0x3e206a[_0x2c350a(0x8fa)] === 'AbortError') return _0x5e3924['log'](_0x2c350a(0x4f7)), ''; throw _0x2c8432; } else { let _0x5bdf09 = _0x4d4ca5[_0x2c350a(0x18c)][_0x2c350a(0x5a8)](_0x92d8c5 => _0x92d8c5[_0x2c350a(0x6e8)] === _0xbe8394); if (!_0x5bdf09) { if (_0x2c350a(0x483) !== _0x2c350a(0x22a)) _0x5bdf09 = { 'characterId': _0xbe8394, 'entries': [] }, _0x4d4ca5[_0x2c350a(0x18c)][_0x2c350a(0x956)](_0x5bdf09); else { const _0x1dc5f = _0x3ccc20[_0x2c350a(0x836)][0x0]; _0x3ad572[_0x2c350a(0x970)]['add'](_0x2c350a(0x4fa) + _0x1dc5f); } } _0x5bdf09[_0x2c350a(0x489)]['push']({ 'timestamp': Date['now'](), 'author': _0xbe8394, 'content': _0x5d4809 }), _0x42173a(); const _0x3927ff = _0x5bdf09[_0x2c350a(0x489)][_0x2c350a(0x2bd)]; _0x4d4ca5['diaryCurrentPage'] = Math['ceil'](_0x3927ff / 0x2) - 0x1, _0x23249f(); } } } } catch (_0x36a5c9) { _0x589297(_0x2c350a(0x3bd) + _0x36a5c9[_0x2c350a(0x6a1)]); } finally { if (_0x2c350a(0x92a) === _0x2c350a(0x543)) { _0x44c39e[_0x2c350a(0x978)] = _0x2c350a(0x81f); return; } else _0x3145a8(![]), _0x4d4ca5[_0x2c350a(0x9b9)] = ![]; } } function _0x5e5e09() { const _0x54aa5b = _0xe2e12e, _0x5a07ac = document[_0x54aa5b(0x6c2)]('meeting-scene-view'), _0x43459a = document[_0x54aa5b(0x6c2)](_0x54aa5b(0x3f5)), _0x5ac059 = document['querySelector']('#meeting-view-screen\x20.chat-input-area'); _0x4d4ca5[_0x54aa5b(0x4b0)] === _0x54aa5b(0x130) ? (_0x5a07ac[_0x54aa5b(0x645)][_0x54aa5b(0x23e)] = 'none', _0x43459a['style'][_0x54aa5b(0x23e)] = 'block') : (_0x5a07ac[_0x54aa5b(0x645)]['display'] = _0x54aa5b(0x2a9), _0x43459a[_0x54aa5b(0x645)][_0x54aa5b(0x23e)] = _0x54aa5b(0x4aa)), _0x5ac059['style'][_0x54aa5b(0x23e)] = 'block'; } function _0x5270ed() { const _0x1f78e8 = _0xe2e12e; if (_0x1f78e8(0x7bd) !== _0x1f78e8(0x788)) { const _0x139cd6 = document[_0x1f78e8(0x6c2)]('galgame-speaker'), _0x109a82 = document['getElementById'](_0x1f78e8(0x6f2)); if (_0x4d4ca5['activeMeetingScriptQueue']['length'] > 0x0) { const _0xa92a5d = _0x4d4ca5[_0x1f78e8(0x295)]['shift'](); _0x139cd6[_0x1f78e8(0x806)] = _0xa92a5d[_0x1f78e8(0x23c)] === _0x1f78e8(0x8d3) ? '旁白' : _0xa92a5d[_0x1f78e8(0x23c)], _0x109a82[_0x1f78e8(0x806)] = _0xa92a5d[_0x1f78e8(0x6aa)], _0xa92a5d['speaker'] !== _0x1f78e8(0x8d3) && _0x3a9832(_0x4d4ca5[_0x1f78e8(0x676)], _0xa92a5d[_0x1f78e8(0x25f)]); } else { const _0x228a9f = _0x4d4ca5['characterLastScripts'][_0x4d4ca5[_0x1f78e8(0x676)]]; if (_0x228a9f && _0x228a9f['length'] > 0x0) { _0x4d4ca5[_0x1f78e8(0x295)] = [..._0x228a9f]; const _0x5664c0 = _0x4d4ca5['activeMeetingScriptQueue'][_0x1f78e8(0x3cb)](); _0x139cd6[_0x1f78e8(0x806)] = _0x5664c0[_0x1f78e8(0x23c)] === _0x1f78e8(0x8d3) ? '旁白' : _0x5664c0[_0x1f78e8(0x23c)], _0x109a82[_0x1f78e8(0x806)] = _0x5664c0[_0x1f78e8(0x6aa)], _0x5664c0['speaker'] !== _0x1f78e8(0x8d3) && _0x3a9832(_0x4d4ca5[_0x1f78e8(0x676)], _0x5664c0[_0x1f78e8(0x25f)]); } else _0x139cd6[_0x1f78e8(0x806)] = '旁白', _0x109a82[_0x1f78e8(0x806)] = _0x1f78e8(0x7c0); } } else _0x47f91b['removeItem'](_0x1f78e8(0x201) + _0x1a41d2['id']); } async function _0x3a9832(_0x7df196, _0x17f844) { const _0x5890b2 = _0xe2e12e, _0x8142fa = document[_0x5890b2(0x6c2)](_0x5890b2(0x364)), _0x5bafda = document[_0x5890b2(0x6c2)](_0x5890b2(0x567)), _0x16c6b4 = _0x53bcef(_0x7df196), _0x3d4b8c = _0x16c6b4?.[_0x5890b2(0x1cb)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }, _0x53b18b = 0x50 * _0x3d4b8c[_0x5890b2(0x8b3)]; _0x5bafda[_0x5890b2(0x645)][_0x5890b2(0x8ab)] = _0x53b18b + '%', _0x5bafda['style']['width'] = _0x53b18b + '%', _0x5bafda['style']['left'] = _0x3d4b8c['x'] + '%', _0x5bafda[_0x5890b2(0x645)][_0x5890b2(0x692)] = _0x3d4b8c['y'] + '%', _0x5bafda[_0x5890b2(0x645)][_0x5890b2(0x25d)] = _0x5890b2(0x8e6), _0x5bafda[_0x5890b2(0x645)][_0x5890b2(0x7e7)] = _0x5890b2(0x8a3); const _0x36b3d0 = [_0x5890b2(0x416), _0x5890b2(0x224), _0x5890b2(0x3d8), 'sad', 'shy'], _0xeb3cf1 = _0x36b3d0[_0x5890b2(0x407)](_0x17f844) ? _0x17f844 : _0x5890b2(0x416); try { const _0x57b8bd = await _0x299fa0('char_sprite_' + _0xeb3cf1 + '_' + _0x7df196); if (_0x57b8bd) { if (_0x8142fa[_0x5890b2(0x6c3)] && _0x8142fa[_0x5890b2(0x645)][_0x5890b2(0x608)] !== '0') { if (_0x5890b2(0x77c) === 'EpNHk') { const _0x1a8fe9 = _0x2a75a3[_0x5890b2(0x71c)](_0x1c8368, 0x2); _0x1a8fe9[_0x5890b2(0x911)] = () => _0xd012c7('IndexedDB\x20failed\x20to\x20open'), _0x1a8fe9[_0x5890b2(0x578)] = () => _0x53112c(_0x1a8fe9[_0x5890b2(0x84e)]), _0x1a8fe9[_0x5890b2(0x962)] = _0x21d34d => { const _0x54df2e = _0x5890b2, _0x24ffc4 = _0x21d34d[_0x54df2e(0x68b)]['result']; !_0x24ffc4[_0x54df2e(0x871)][_0x54df2e(0x7a5)](_0x33f502) && _0x24ffc4[_0x54df2e(0x901)](_0x3114d6, { 'keyPath': 'id' }); const _0x277a2b = _0x54df2e(0x6f6); !_0x24ffc4['objectStoreNames'][_0x54df2e(0x7a5)](_0x277a2b) && _0x24ffc4[_0x54df2e(0x901)](_0x277a2b, { 'keyPath': 'id' }); }; } else _0x8142fa[_0x5890b2(0x645)][_0x5890b2(0x608)] = 0x0, setTimeout(() => { const _0x42198f = _0x5890b2; _0x42198f(0x51f) !== _0x42198f(0x7ba) ? (_0x8142fa['src'] = URL[_0x42198f(0x1de)](_0x57b8bd), _0x8142fa[_0x42198f(0x645)][_0x42198f(0x608)] = 0x1) : _0x333565[_0x42198f(0x970)][_0x42198f(0x6ae)]('show'); }, 0x96); } else { if ('TMseM' !== _0x5890b2(0x6da)) { const _0x35c93c = _0x480f5b(_0x52bd64[0x1]), _0x15a631 = _0x4924a1[0x2][_0x5890b2(0x163)](), _0x59aa73 = _0x32762f(_0x255008[_0x5890b2(0x41f)]); let _0x487d05 = null; if (_0x15a631 === _0x59aa73[_0x5890b2(0x8fa)]) _0x487d05 = _0x59aa73['id']; else { const _0x4f26d7 = _0xee155e(); if (_0x4f26d7[_0x5890b2(0x327)] === _0x5890b2(0x70e)) { const _0x4ecb6a = _0x136e42[_0x5890b2(0x4ee)][_0x5890b2(0x5a8)](_0x507627 => _0x4f26d7['participantIds'][_0x5890b2(0x407)](_0x507627['id']) && _0x507627[_0x5890b2(0x8fa)] === _0x15a631); if (_0x4ecb6a) _0x487d05 = _0x4ecb6a['id']; } } if (_0x487d05) return { 'type': _0x5890b2(0x527), 'amount': _0x35c93c, 'recipientId': _0x487d05, 'senderId': _0x3a825e['id'] }; else return { 'type': _0x5890b2(0x57b), 'content': _0x5890b2(0x69a) + _0x15a631 + _0x5890b2(0x8b7) }; } else _0x8142fa[_0x5890b2(0x6c3)] = URL[_0x5890b2(0x1de)](_0x57b8bd), _0x8142fa[_0x5890b2(0x645)][_0x5890b2(0x608)] = 0x1; } } else { const _0x384d34 = await _0x299fa0(_0x5890b2(0x9b3) + _0x7df196); _0x8142fa[_0x5890b2(0x6c3)] = _0x384d34 ? URL[_0x5890b2(0x1de)](_0x384d34) : ''; } } catch (_0xf93e38) { console['error']('加载立绘失败:', _0xf93e38), _0x8142fa[_0x5890b2(0x6c3)] = ''; } } let _0x388a5a = ![], _0x11112c = { 'isDragging': ![], 'isResizing': ![], 'startX': 0x0, 'startY': 0x0, 'startLeft': 0x0, 'startTop': 0x0, 'startWidth': 0x0, 'startHeight': 0x0 }; const _0x21bf92 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x4f0)), _0x108bf5 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x4b7)), _0x1aa526 = document[_0xe2e12e(0x6c2)]('sprite-cancel-button'), _0x24060d = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x9a0)), _0x49b347 = document[_0xe2e12e(0x6c2)]('galgame-sprite-controls'), _0x2275ad = document['getElementById'](_0xe2e12e(0x567)), _0x3a7edf = document['getElementById'](_0xe2e12e(0x602)), _0x322bdd = document['getElementById'](_0xe2e12e(0x409)); let _0x53e9a6 = {}; function _0x34ebe8() { const _0x4159da = _0xe2e12e, _0x2acfd2 = _0x53bcef(_0x4d4ca5[_0x4159da(0x676)]); if (!_0x2acfd2) return; _0x388a5a = !![], _0x49b347[_0x4159da(0x645)][_0x4159da(0x23e)] = 'block'; const _0x5bd729 = _0x2acfd2['spriteTransform'] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; document['getElementById'](_0x4159da(0x596))[_0x4159da(0x135)] = _0x5bd729['x'], document[_0x4159da(0x6c2)](_0x4159da(0x439))['value'] = _0x5bd729['y'], document['getElementById'](_0x4159da(0x4ad))[_0x4159da(0x135)] = _0x5bd729[_0x4159da(0x8b3)] * 0x64, _0x53e9a6 = { ..._0x5bd729 }, document[_0x4159da(0x6c2)]('galgame-textbox-container')[_0x4159da(0x645)][_0x4159da(0x23e)] = 'none', document[_0x4159da(0x6c2)](_0x4159da(0x1ac))['style'][_0x4159da(0x23e)] = _0x4159da(0x4aa); } function _0x4ef0b6(_0x39b052 = ![]) { const _0x2e279e = _0xe2e12e; _0x388a5a = ![], _0x49b347[_0x2e279e(0x645)]['display'] = _0x2e279e(0x4aa), document[_0x2e279e(0x6c2)](_0x2e279e(0x7c1))[_0x2e279e(0x645)][_0x2e279e(0x23e)] = _0x2e279e(0x2a9), document[_0x2e279e(0x6c2)](_0x2e279e(0x1ac))[_0x2e279e(0x645)][_0x2e279e(0x23e)] = _0x2e279e(0x2a9); if (!_0x39b052) { const _0x4945ec = _0x53bcef(_0x4d4ca5[_0x2e279e(0x676)]); if (_0x4945ec) { if ('vuUKl' !== _0x2e279e(0x476)) { if (_0x2d6a01[_0x2e279e(0x327)] === _0x2e279e(0x8c6)) _0x36f3ff[_0x2e279e(0x955)](); _0xbd658e(_0x560129(_0x15f5ba, 0xa), _0x1bd295); } else _0x4945ec['spriteTransform'] = _0x53e9a6, _0x3a9832(_0x4d4ca5[_0x2e279e(0x676)], _0x2e279e(0x416)); } } } function _0x2b1918() { const _0x3180fd = _0xe2e12e; if (_0x3180fd(0x7f2) === 'Egyxv') { if (_0xb80586) _0x3a6bee(_0x53cdc4); _0x28702b = null, _0x334d2d[_0x3180fd(0x295)] = [], _0x5d289c[_0x3180fd(0x676)] = null, _0x591117[_0x3180fd(0x6c2)](_0x3180fd(0x1ac))['style']['display'] = 'none', _0x3610ec['activeChatId'] = null, _0x43f464(), _0x1c122d(_0x3180fd(0x65c), 'meetingView'); } else { const _0x2c208e = _0x53bcef(_0x4d4ca5['activeMeetingCharId']); if (!_0x2c208e) return; const _0x327208 = parseFloat(document[_0x3180fd(0x6c2)]('sprite-slider-x')[_0x3180fd(0x135)]), _0x247d9d = parseFloat(document['getElementById'](_0x3180fd(0x439))['value']), _0x4ad15d = parseFloat(document[_0x3180fd(0x6c2)](_0x3180fd(0x4ad))[_0x3180fd(0x135)]) / 0x64; _0x2c208e[_0x3180fd(0x1cb)] = { 'x': _0x327208, 'y': _0x247d9d, 'scale': _0x4ad15d }, _0x42173a(), _0x589297('哼，就按你说的办好了。'), _0x4ef0b6(!![]); } } function _0x722ae5() { const _0x68c114 = _0xe2e12e; if (_0x68c114(0x456) !== _0x68c114(0x456)) { const _0x1cc6b1 = new _0x48c1d8(_0xfe14d1['timestamp'])[_0x68c114(0x597)](_0x68c114(0x2f2), { 'hour': _0x68c114(0x3de), 'minute': '2-digit' }); _0x57059d[_0x68c114(0x7af)] && _0x5035bb[_0x68c114(0x956)]('[' + _0x1cc6b1 + _0x68c114(0x1a9) + _0x3f15fc(_0x12f814) + ']\x20' + _0x5cee43(_0x2e7b84[_0x68c114(0x7af)])[_0x68c114(0x163)]()); } else _0x385a44(_0x68c114(0x1c6))['then'](_0x45b8e8 => { const _0x53d3ff = _0x68c114; if (_0x45b8e8) { if (_0x53d3ff(0x530) === _0x53d3ff(0x34c)) _0x51b230['paused'] ? _0x3b6711[_0x53d3ff(0x325)]() : _0x4f19b7[_0x53d3ff(0x31f)](); else { const _0xf5423c = _0x53bcef(_0x4d4ca5[_0x53d3ff(0x676)]); _0xf5423c && (delete _0xf5423c[_0x53d3ff(0x1cb)], _0x42173a(), _0x3a9832(_0xf5423c['id'], _0x53d3ff(0x416)), _0x589297('已恢复默认。'), _0x4ef0b6(!![])); } } }); } function _0x87182d() { const _0x326e5d = _0xe2e12e; if (_0x326e5d(0x346) !== _0x326e5d(0x756)) { if (!_0x388a5a) return; const _0x5e8ea3 = _0x4d4ca5['activeMeetingCharId'], _0x177a01 = _0x53bcef(_0x5e8ea3); if (!_0x177a01) return; const _0x3e83e0 = parseFloat(document['getElementById'](_0x326e5d(0x596))[_0x326e5d(0x135)]), _0x1fd328 = parseFloat(document['getElementById']('sprite-slider-y')['value']), _0x5b902f = parseFloat(document[_0x326e5d(0x6c2)]('sprite-slider-scale')[_0x326e5d(0x135)]) / 0x64; _0x177a01[_0x326e5d(0x1cb)] = { 'x': _0x3e83e0, 'y': _0x1fd328, 'scale': _0x5b902f }; const _0x92e8ee = document['getElementById']('galgame-sprite-container'), _0x31e17e = 0x50 * _0x5b902f; _0x92e8ee[_0x326e5d(0x645)][_0x326e5d(0x8ab)] = _0x31e17e + '%', _0x92e8ee[_0x326e5d(0x645)][_0x326e5d(0x5b1)] = _0x31e17e + '%', _0x92e8ee[_0x326e5d(0x645)][_0x326e5d(0x2c5)] = _0x3e83e0 + '%', _0x92e8ee[_0x326e5d(0x645)][_0x326e5d(0x692)] = _0x1fd328 + '%', _0x92e8ee[_0x326e5d(0x645)][_0x326e5d(0x25d)] = 'translate(-50%,\x20-100%)'; } else return _0x173011(_0x1d5f6a)[_0x326e5d(0x588)](_0x16dd85 => _0x16dd85[_0x326e5d(0x277)]()); } document['getElementById'](_0xe2e12e(0x596))[_0xe2e12e(0x501)]('input', _0x87182d), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x439))[_0xe2e12e(0x501)](_0xe2e12e(0x4f4), _0x87182d), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x4ad))['addEventListener'](_0xe2e12e(0x4f4), _0x87182d), _0x21bf92[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x34ebe8), _0x108bf5['addEventListener'](_0xe2e12e(0x4bd), _0x2b1918), _0x1aa526[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0x4ef0b6(![])), _0x24060d[_0xe2e12e(0x501)]('click', _0x722ae5); function _0x137e4b(_0xc0207a) { const _0x53dd1e = _0xe2e12e; if (_0x53dd1e(0x17b) === _0x53dd1e(0x17b)) { const _0x1f23db = _0x53bcef(_0xc0207a); if (!_0x1f23db) return; const _0x44491d = _0x4d4ca5[_0x53dd1e(0x53f)][_0x53dd1e(0x5a8)](_0x45a820 => _0x45a820[_0x53dd1e(0x327)] === _0x53dd1e(0x17c) && _0x45a820[_0x53dd1e(0x836)][_0x53dd1e(0x407)](_0xc0207a)), _0x5abe55 = _0x55e5f6(_0x44491d['id']), _0x381549 = _0x4d4ca5[_0x53dd1e(0x28d)][_0x53dd1e(0x5fe)](_0x5ad640 => _0x5ad640[_0x53dd1e(0x188)])[_0x53dd1e(0x764)](), _0xba396d = document[_0x53dd1e(0x6c2)](_0x53dd1e(0x16c)), _0x1c265f = document[_0x53dd1e(0x6c2)](_0x53dd1e(0x6f2)); let _0x300768 = null; if (_0x381549) { if (_0x53dd1e(0x5cb) !== _0x53dd1e(0x5cb)) _0x5b6ed1[_0x53dd1e(0x970)][_0x53dd1e(0x6ae)](_0x53dd1e(0x68c)), _0x5cacfe[_0x53dd1e(0x970)][_0x53dd1e(0x68a)](_0x53dd1e(0x68c)), _0x52f093(); else { if (_0x381549['role'] === 'assistant') { if ('OYnwK' !== _0x53dd1e(0x5dd)) _0x255c1f[_0x53dd1e(0x93a)](_0x53dd1e(0x55d), _0x25982a), _0x9d4220['error']('收到的原始、有问题的文本:', _0x63e2ff); else { const _0x4dfb5a = _0x4d4ca5[_0x53dd1e(0x937)][_0xc0207a]; _0x4dfb5a && _0x4dfb5a[_0x53dd1e(0x2bd)] > 0x0 && (_0x300768 = _0x4dfb5a['at'](-0x1)); } } else _0x300768 = { 'speaker': _0x5abe55[_0x53dd1e(0x8fa)], 'line': _0x381549['content'], 'emotion': _0x53dd1e(0x416) }; } } _0x300768 ? _0x53dd1e(0x7da) === _0x53dd1e(0x2b0) ? _0x25f978[_0x53dd1e(0x836)] = _0x44731[_0x53dd1e(0x836)]['filter'](_0x5f45ff => _0x5f45ff !== _0x3a7c51) : (_0xba396d['textContent'] = _0x300768[_0x53dd1e(0x23c)] === 'narrator' ? '旁白' : _0x300768[_0x53dd1e(0x23c)], _0x1c265f[_0x53dd1e(0x806)] = _0x300768[_0x53dd1e(0x6aa)], _0x300768[_0x53dd1e(0x23c)] === _0x1f23db['name'] ? _0x3a9832(_0xc0207a, _0x300768[_0x53dd1e(0x25f)]) : _0x3a9832(_0xc0207a, _0x53dd1e(0x416))) : (_0xba396d[_0x53dd1e(0x806)] = _0x1f23db[_0x53dd1e(0x8fa)], _0x1c265f[_0x53dd1e(0x806)] = _0x53dd1e(0x2cd), _0x3a9832(_0xc0207a, _0x53dd1e(0x416))); } else _0x1b338f(_0x53dd1e(0x62a)); } function _0xf896e6() { const _0x1b108e = _0xe2e12e, _0x1dfaa9 = new Date(), _0x4bf891 = document[_0x1b108e(0x6c2)](_0x1b108e(0x395)), _0x3276e5 = document[_0x1b108e(0x6c2)](_0x1b108e(0x164)); if (_0x4bf891 && _0x3276e5) { const _0x1aec92 = String(_0x1dfaa9[_0x1b108e(0x368)]())['padStart'](0x2, '0'), _0x2dc51d = String(_0x1dfaa9[_0x1b108e(0x37e)]())[_0x1b108e(0x522)](0x2, '0'); _0x4bf891['textContent'] = _0x1aec92 + ':' + _0x2dc51d; const _0x43c6dd = _0x1dfaa9['getMonth']() + 0x1, _0x31f2c8 = _0x1dfaa9[_0x1b108e(0x9b6)](), _0x161a35 = [_0x1b108e(0x353), _0x1b108e(0x343), _0x1b108e(0x711), _0x1b108e(0x979), _0x1b108e(0x5bc), _0x1b108e(0x557), _0x1b108e(0x751)][_0x1dfaa9[_0x1b108e(0x8e2)]()]; _0x3276e5[_0x1b108e(0x806)] = _0x43c6dd + '月' + _0x31f2c8 + '日\x20' + _0x161a35; } } const _0x140593 = document['getElementById'](_0xe2e12e(0x283)), _0x224cd9 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x5ce)), _0x2d28f4 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x643)), _0x55a0e5 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x23b)), _0xe46b18 = document[_0xe2e12e(0x6c2)]('listen-together-song-list'), _0x2c7b55 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x2eb)), _0x300624 = document['getElementById'](_0xe2e12e(0x2c8)), _0x2fb7e8 = document[_0xe2e12e(0x6c2)]('lt-ui-close-btn'), _0x59cfb7 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x9bb)); let _0x3dac17 = []; async function _0x40600d() { const _0x23ac26 = _0xe2e12e; if (!_0x4d4ca5['activeChatId']) return; _0xe46b18['innerHTML'] = _0x23ac26(0x493), _0x140593[_0x23ac26(0x970)][_0x23ac26(0x68a)](_0x23ac26(0x3a7)); const _0x4f70db = await _0x175b8e(); if (_0x4f70db[_0x23ac26(0x2bd)] === 0x0) { if (_0x23ac26(0x835) === 'KRhoI') { _0xe46b18[_0x23ac26(0x978)] = _0x23ac26(0x208); return; } else { const _0x310aae = _0x59b295[_0x23ac26(0x963)]['map'](_0x485a54 => _0x4efdf4['worldBooks'][_0x23ac26(0x5a8)](_0x312fcb => _0x312fcb['id'] === _0x485a54))['filter'](_0x50c960)['map'](_0x566b21 => _0x23ac26(0x3dd) + _0x566b21[_0x23ac26(0x8fa)] + '\x0a' + _0x566b21[_0x23ac26(0x7af)])[_0x23ac26(0x5cd)](''); if (_0x310aae) _0x36bd9e = _0x23ac26(0x40b) + _0x310aae; } } _0xe46b18[_0x23ac26(0x978)] = '', _0x4f70db['forEach'](_0xc6ae4c => { const _0x153778 = _0x23ac26, _0x2ca938 = document['createElement'](_0x153778(0x46f)); _0x2ca938[_0x153778(0x255)] = _0x153778(0x436); const _0x1a13a6 = _0xc6ae4c[_0x153778(0x2b6)] ? URL[_0x153778(0x1de)](_0xc6ae4c[_0x153778(0x2b6)]) : _0x4991a9; _0x2ca938[_0x153778(0x978)] = _0x153778(0x1cd) + _0x1a13a6 + _0x153778(0x561) + (_0xc6ae4c[_0x153778(0x6e1)][_0x153778(0x38b)] || '未知歌曲') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>' + (_0xc6ae4c[_0x153778(0x6e1)]['歌手'] || _0x153778(0x568)) + _0x153778(0x71f), _0x2ca938['addEventListener'](_0x153778(0x4bd), () => { const _0x3c0aed = _0x153778; if (_0x3c0aed(0x465) === _0x3c0aed(0x465)) _0x10bd1c(_0xc6ae4c); else throw new _0x499e33('这不是一张有效的Noir角色卡。'); }), _0xe46b18['appendChild'](_0x2ca938); }); } function _0x304ed0() { const _0x411556 = _0xe2e12e; _0x411556(0x1bc) !== _0x411556(0x1bc) ? (_0x5769be[_0x411556(0x489)][_0x411556(0x79b)](_0x32b6e7, 0x1), _0xe09aaf(), _0x7ef02e(), _0x58d137(_0x411556(0x3e2))) : _0x140593['classList']['remove'](_0x411556(0x3a7)); } async function _0x10bd1c(_0x396ddf) { const _0x4eb0b7 = _0xe2e12e; if (!_0x4d4ca5['activeChatId'] || !_0x396ddf) return; let _0x3390f6 = null; if (_0x396ddf[_0x4eb0b7(0x2b6)]) try { if (_0x4eb0b7(0x57e) === _0x4eb0b7(0x57e)) _0x3390f6 = 'music_cover_' + Date[_0x4eb0b7(0x661)]() + '_' + Math['random'](), await _0x34f697(_0x3390f6, _0x396ddf[_0x4eb0b7(0x2b6)]); else { _0x3b9172 = _0x5bf573(_0xd3f24c[_0x4eb0b7(0x8b0)]), _0x4f60c1[_0x4eb0b7(0x978)] = ''; if (_0x16d850[_0x4eb0b7(0x2bd)] === 0x0) { _0x8377ba['innerHTML'] = _0x4eb0b7(0x219); return; } _0x3168f2[_0x4eb0b7(0x279)]((_0x226121, _0x348b15) => { const _0x4665d2 = _0x4eb0b7, _0x36e38d = _0x3ae004[_0x4665d2(0x82b)]('p'); _0x36e38d['textContent'] = _0x226121['text'], _0x36e38d['id'] = _0x4665d2(0x9b2) + _0x348b15, _0x2b1902[_0x4665d2(0x54e)](_0x36e38d); }); } } catch (_0x4b8075) { if (_0x4eb0b7(0x6eb) !== _0x4eb0b7(0x6eb)) return _0x218fbd[_0x4eb0b7(0x53f)]['find'](_0x377161 => _0x377161['id'] === _0x226e6d[_0x4eb0b7(0x41f)]); else console[_0x4eb0b7(0x93a)](_0x4eb0b7(0x4ea), _0x4b8075); } const _0x15975b = { 'role': _0x4eb0b7(0x75d), 'type': _0x4eb0b7(0x403), 'content': '[用户发起了听歌邀请:\x20' + _0x396ddf['info']['歌曲名称'] + ']', 'songId': _0x396ddf['id'], 'songName': _0x396ddf[_0x4eb0b7(0x6e1)][_0x4eb0b7(0x38b)], 'artist': _0x396ddf[_0x4eb0b7(0x6e1)]['歌手'], 'coverId': _0x3390f6, 'timestamp': Date[_0x4eb0b7(0x661)]() }; _0x4d4ca5[_0x4eb0b7(0x28d)][_0x4eb0b7(0x956)](_0x15975b), _0x521ac4(), _0x41e9e0(), _0x304ed0(), setTimeout(_0x52ef2f, 0x64); } _0x224cd9['addEventListener'](_0xe2e12e(0x4bd), _0x40600d), _0x2d28f4[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x304ed0), _0x55a0e5[_0xe2e12e(0x501)]('click', _0x304ed0); async function _0x53147d(_0x237107, _0x43072e, _0x1649f4) { const _0x5493d8 = _0xe2e12e; if (_0x5493d8(0x917) !== _0x5493d8(0x8e4)) { const _0x4edf71 = _0x4d4ca5[_0x5493d8(0x53f)][_0x5493d8(0x5a8)](_0x56436e => _0x56436e[_0x5493d8(0x5b7)] && _0x56436e['activeListenSession'][_0x5493d8(0x81b)]), _0x287fe4 = _0xa2c8b5(); if (_0x4edf71 && _0x4edf71['id'] !== _0x287fe4['id']) { if ('GICot' === 'tsvea') return new _0x10f8b7((_0x4fce80, _0x18aa11) => { const _0x2b14aa = _0x5493d8, _0x7f37e6 = new _0x39311b(); _0x7f37e6[_0x2b14aa(0x225)] = () => _0x4fce80(_0x7f37e6[_0x2b14aa(0x84e)]), _0x7f37e6[_0x2b14aa(0x911)] = _0x18aa11, _0x7f37e6[_0x2b14aa(0x4c5)](_0x30e14b); }); else _0x4edf71[_0x5493d8(0x5b7)] = null, _0x589297(_0x5493d8(0x63b)), _0x42173a(); } else _0x4edf71 && _0x4edf71['id'] === _0x287fe4['id'] && _0x589297(_0x5493d8(0x62a)); _0x3145a8(!![], _0x5493d8(0x2a7)); if (!_0x287fe4) { _0x3145a8(![]), _0x589297(_0x5493d8(0x77f)); return; } const _0xe6e77e = await _0x36a25e(_0x237107); if (!_0xe6e77e) { _0x3145a8(![]), _0x589297(_0x5493d8(0x572)); return; } _0x287fe4[_0x5493d8(0x5b7)] = { 'isActive': !![], 'songId': _0x237107, 'leaderId': _0x5493d8(0x75d), 'songName': _0xe6e77e[_0x5493d8(0x6e1)][_0x5493d8(0x38b)], 'artist': _0xe6e77e[_0x5493d8(0x6e1)]['歌手'], 'cover': _0xe6e77e[_0x5493d8(0x2b6)] }, _0x42173a(), document[_0x5493d8(0x6c2)]('lt-ui-cover-art')[_0x5493d8(0x6c3)] = _0xe6e77e[_0x5493d8(0x2b6)] ? URL['createObjectURL'](_0xe6e77e[_0x5493d8(0x2b6)]) : _0x4991a9, document['getElementById']('lt-ui-song-title')[_0x5493d8(0x806)] = _0xe6e77e['info'][_0x5493d8(0x38b)], document['getElementById'](_0x5493d8(0x900))[_0x5493d8(0x806)] = _0xe6e77e['info']['歌手'], _0x452e06(_0xe6e77e), _0x300624['style'][_0x5493d8(0x23e)] = _0x5493d8(0x381), setTimeout(() => _0x300624[_0x5493d8(0x970)][_0x5493d8(0x68a)](_0x5493d8(0x3a7)), 0xa), _0x1649f4[_0x5493d8(0x978)] = _0x5493d8(0x92e) + _0x1649f4[_0x5493d8(0x5e5)](_0x5493d8(0x7d1))[_0x5493d8(0x549)], _0x4d4ca5[_0x5493d8(0x28d)][_0x43072e] && (_0x4d4ca5['conversationHistory'][_0x43072e][_0x5493d8(0x2b1)] = !![], _0x521ac4()), _0x3145a8(![]), _0x469c79(_0x237107, [_0x237107]), _0x3f87e7(_0xe6e77e, !![]); } else { const _0xa3b15b = _0x109735[_0x5493d8(0x6c2)](_0x5493d8(0x19a)); _0xa3b15b[_0x5493d8(0x978)] = ''; if (_0x52f4e8[_0x5493d8(0x26d)][_0x5493d8(0x2bd)] === 0x0) { _0xa3b15b[_0x5493d8(0x978)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>'; return; } _0x38469c[_0x5493d8(0x26d)][_0x5493d8(0x279)](_0x16d86c => { const _0x469d8e = _0x5493d8, _0x13e4a8 = _0x17d3a4[_0x469d8e(0x82b)](_0x469d8e(0x46f)); _0x13e4a8['className'] = _0x469d8e(0x29b), _0x13e4a8['dataset']['id'] = _0x16d86c['id']; const _0x3f646d = _0x16d86c['id'] === _0x51eabb[_0x469d8e(0x4f1)] ? _0x469d8e(0x362) : ''; _0x13e4a8[_0x469d8e(0x978)] = _0x469d8e(0x155) + (_0x16d86c[_0x469d8e(0x86f)] || _0x172da4) + '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x16d86c[_0x469d8e(0x8fa)] + _0x3f646d + _0x469d8e(0x500) + _0x16d86c['persona']['substring'](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x13e4a8[_0x469d8e(0x501)]('click', () => _0x3e071e(_0x16d86c['id'])), _0xa3b15b[_0x469d8e(0x54e)](_0x13e4a8); }); } } function _0x44bdf3() { const _0x1c8082 = _0xe2e12e, _0x510968 = _0x4d4ca5[_0x1c8082(0x53f)]['find'](_0x29169e => _0x29169e[_0x1c8082(0x5b7)] && _0x29169e[_0x1c8082(0x5b7)][_0x1c8082(0x81b)]); if (_0x510968) { if (_0x1c8082(0x45d) !== 'RLhLV') { const _0x3a44ba = _0xfaf64f[0x1][_0x1c8082(0x2ce)](/\\"/g, '\x22')[_0x1c8082(0x2ce)](/\\n/g, '\x0a')[_0x1c8082(0x163)](); if (_0x3a44ba) _0x570144[_0x1c8082(0x956)](_0x3a44ba); } else _0x510968[_0x1c8082(0x5b7)] = null, _0x42173a(), _0x589297(_0x1c8082(0x904)), _0x3f87e7(), _0x300624[_0x1c8082(0x970)][_0x1c8082(0x6ae)](_0x1c8082(0x3a7)), setTimeout(() => _0x300624[_0x1c8082(0x645)][_0x1c8082(0x23e)] = _0x1c8082(0x4aa), 0x12c); } } function _0x4adc13(_0x3b9d27) { const _0x2a5d0e = _0xe2e12e; if (!_0x3b9d27) return []; const _0x767138 = _0x3b9d27[_0x2a5d0e(0x3e8)]('\x0a'), _0x20ee3e = [], _0x5a9aae = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x480d65 of _0x767138) { if (_0x2a5d0e(0x51c) !== _0x2a5d0e(0x51c)) { _0x517ebf[_0x2a5d0e(0x80b)](_0x2a5d0e(0x6e3)); const _0x107bfb = _0x10ee4c['participantIds']['map'](_0x543742)[_0x2a5d0e(0x5fe)](_0x51f383); if (!_0x107bfb['length']) return; let _0x437a3d = 0x0; for (const _0x57efb6 of _0x107bfb) { _0xc89bf6(_0x57efb6, { 'force': !![], 'delayMs': _0x437a3d }), _0x437a3d += 0x1f4; } } else { const _0x141ed7 = _0x480d65[_0x2a5d0e(0x199)](_0x5a9aae); if (_0x141ed7) { if (_0x2a5d0e(0x628) !== _0x2a5d0e(0x3b0)) { const _0x1d2b52 = parseInt(_0x141ed7[0x1], 0xa), _0x4978e9 = parseInt(_0x141ed7[0x2], 0xa), _0x453054 = parseInt(_0x141ed7[0x3], 0xa) * (_0x141ed7[0x3][_0x2a5d0e(0x2bd)] === 0x2 ? 0xa : 0x1), _0xfe6308 = _0x1d2b52 * 0x3c + _0x4978e9 + _0x453054 / 0x3e8, _0x38b11a = _0x480d65[_0x2a5d0e(0x2ce)](_0x5a9aae, '')[_0x2a5d0e(0x163)](); _0x38b11a && _0x20ee3e[_0x2a5d0e(0x956)]({ 'time': _0xfe6308, 'text': _0x38b11a }); } else _0x5892ef[_0x2a5d0e(0x53f)] = _0x2fe845[_0x2a5d0e(0x53f)], _0x2181f9['activeChatId'] = _0x360459['activeChatId'] || null; } } } return _0x20ee3e; } function _0x452e06(_0x52cecd) { const _0x19c8fb = _0xe2e12e; _0x3dac17 = _0x4adc13(_0x52cecd[_0x19c8fb(0x8b0)]), _0x59cfb7[_0x19c8fb(0x978)] = ''; if (_0x3dac17[_0x19c8fb(0x2bd)] === 0x0) { _0x59cfb7[_0x19c8fb(0x978)] = _0x19c8fb(0x219); return; } _0x3dac17[_0x19c8fb(0x279)]((_0x482c12, _0x29916f) => { const _0x4b3504 = _0x19c8fb, _0x2b463b = document[_0x4b3504(0x82b)]('p'); _0x2b463b[_0x4b3504(0x806)] = _0x482c12[_0x4b3504(0x57b)], _0x2b463b['id'] = _0x4b3504(0x9b2) + _0x29916f, _0x59cfb7['appendChild'](_0x2b463b); }); } function _0x3880c2(_0x1ab586, _0x2f305f, _0x2ff5c6, _0x130af6) { const _0x26ba01 = _0xe2e12e; if ('yPhnC' === _0x26ba01(0x4be)) _0x4df0d5 = _0x26ba01(0x2aa); else { const _0x3ab091 = (_0x130af6 - 0x5a) * Math['PI'] / 0xb4; return { 'x': _0x1ab586 + _0x2ff5c6 * Math[_0x26ba01(0x7f9)](_0x3ab091), 'y': _0x2f305f + _0x2ff5c6 * Math[_0x26ba01(0x802)](_0x3ab091) }; } } function _0x1ceaa1(_0x44db3b) { const _0x2e5ce1 = _0xe2e12e; if (_0x2e5ce1(0x47f) !== _0x2e5ce1(0x6fb)) { const _0x37bfb6 = _0x2e5ce1(0x157), _0x3317e1 = document['createElementNS'](_0x37bfb6, _0x2e5ce1(0x4a6)), _0x23e65e = 0xfa, _0x4851a9 = _0x23e65e / 0x2, _0x5a237c = _0x23e65e / 0x2, _0x358291 = _0x23e65e / 0x2 - 0x14; _0x3317e1['setAttribute'](_0x2e5ce1(0x5b1), _0x2e5ce1(0x516)), _0x3317e1['setAttribute'](_0x2e5ce1(0x8ab), _0x2e5ce1(0x516)), _0x3317e1[_0x2e5ce1(0x46c)](_0x2e5ce1(0x252), _0x2e5ce1(0x251) + _0x23e65e + '\x20' + _0x23e65e); const _0x462a8a = Object[_0x2e5ce1(0x1ed)](_0x44db3b)[_0x2e5ce1(0x153)]((_0x20faff, _0x5abbbc) => _0x20faff + _0x5abbbc, 0x0); if (_0x462a8a === 0x0) return _0x3317e1; let _0x379c8b = -0x5a; const _0x4cd9f7 = [_0x2e5ce1(0x3cd), _0x2e5ce1(0x7d0), _0x2e5ce1(0x6a6), _0x2e5ce1(0x86c), _0x2e5ce1(0x7a1), _0x2e5ce1(0x70f), '#a4c2f4', _0x2e5ce1(0x787)]; let _0x4ba31e = 0x0; for (const _0x270653 in _0x44db3b) { const _0x1cb587 = _0x44db3b[_0x270653]; if (_0x1cb587 <= 0x0) continue; const _0x442426 = _0x1cb587 / _0x462a8a * 0x168, _0x254ba2 = _0x379c8b + _0x442426, _0x43d359 = _0x3880c2(_0x4851a9, _0x5a237c, _0x358291, _0x254ba2), _0xb23fd4 = _0x3880c2(_0x4851a9, _0x5a237c, _0x358291, _0x379c8b), _0xcccc15 = _0x442426 > 0xb4 ? '1' : '0', _0x10427b = ['M', _0x43d359['x'], _0x43d359['y'], 'A', _0x358291, _0x358291, 0x0, _0xcccc15, 0x1, _0xb23fd4['x'], _0xb23fd4['y'], 'L', _0x4851a9, _0x5a237c, 'Z'][_0x2e5ce1(0x5cd)]('\x20'), _0x4b017f = document[_0x2e5ce1(0x487)](_0x37bfb6, _0x2e5ce1(0x423)); _0x4b017f['setAttribute']('d', _0x10427b), _0x4b017f[_0x2e5ce1(0x46c)](_0x2e5ce1(0x200), _0x4cd9f7[_0x4ba31e % _0x4cd9f7[_0x2e5ce1(0x2bd)]]), _0x4ba31e++; const _0x22567c = document['createElementNS'](_0x37bfb6, _0x2e5ce1(0x8f6)); _0x22567c[_0x2e5ce1(0x806)] = _0x270653 + ':\x20' + _0x1cb587[_0x2e5ce1(0x874)](0x2) + '\x20(' + (_0x1cb587 / _0x462a8a * 0x64)[_0x2e5ce1(0x874)](0x1) + '%)', _0x4b017f[_0x2e5ce1(0x54e)](_0x22567c), _0x3317e1['appendChild'](_0x4b017f), _0x379c8b = _0x254ba2; } return _0x3317e1; } else _0xa2652a = [..._0x344e86, ..._0x58a16f]; } function _0x457f63() { const _0x5e4958 = _0xe2e12e; if (_0x3dac17[_0x5e4958(0x2bd)] === 0x0) return; const _0x15bf00 = _0x2c7b55['currentTime']; let _0x17bf3c = -0x1; for (let _0x20fb7c = 0x0; _0x20fb7c < _0x3dac17[_0x5e4958(0x2bd)]; _0x20fb7c++) { if ('qPxpw' !== _0x5e4958(0x2cc)) return (_0x43c1d0?.['characters'] || [])['find'](_0x9a5435 => _0x9a5435['id'] === _0x2dbaa1); else { if (_0x15bf00 >= _0x3dac17[_0x20fb7c]['time']) _0x17bf3c = _0x20fb7c; else break; } } if (_0x17bf3c !== -0x1) { const _0x5388a6 = _0x59cfb7[_0x5e4958(0x445)]('p'); _0x5388a6[_0x5e4958(0x279)](_0x3522b1 => _0x3522b1['classList'][_0x5e4958(0x6ae)](_0x5e4958(0x68c))); const _0x5b41e7 = document[_0x5e4958(0x6c2)](_0x5e4958(0x9b2) + _0x17bf3c); _0x5b41e7 && (_0x5b41e7[_0x5e4958(0x970)][_0x5e4958(0x68a)](_0x5e4958(0x68c)), _0x5b41e7[_0x5e4958(0x9a8)]({ 'behavior': _0x5e4958(0x554), 'block': _0x5e4958(0x89e) })); } } _0x2fb7e8['addEventListener']('click', () => { const _0x2c0a8a = _0xe2e12e; _0x2c0a8a(0x599) === _0x2c0a8a(0x60a) ? _0xe1cab6(new _0x1c63fe('Canvas\x20to\x20Blob\x20conversion\x20failed.')) : (_0x300624[_0x2c0a8a(0x970)][_0x2c0a8a(0x6ae)](_0x2c0a8a(0x3a7)), setTimeout(() => _0x300624[_0x2c0a8a(0x645)][_0x2c0a8a(0x23e)] = 'none', 0x12c)); }), document[_0xe2e12e(0x6c2)]('music-widget-card')[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x31c838 = _0xe2e12e; _0x4d4ca5[_0x31c838(0x159)] && _0x4d4ca5[_0x31c838(0x159)]['isActive'] && (_0x31c838(0x2b7) !== _0x31c838(0x2b7) ? _0x57646f(_0x31c838(0x1e9) + _0x48fe82[_0x31c838(0x6a1)]) : (_0x300624['style'][_0x31c838(0x23e)] = _0x31c838(0x381), setTimeout(() => _0x300624[_0x31c838(0x970)][_0x31c838(0x68a)](_0x31c838(0x3a7)), 0xa))); }), _0x2c7b55[_0xe2e12e(0x501)](_0xe2e12e(0x713), _0x457f63); const _0x4ac726 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x866)), _0x39d66e = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x1b6)), _0x194e44 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x452)); _0x4ac726[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x5bc938 = _0xe2e12e; _0x2c7b55[_0x5bc938(0x6c3)] && (_0x2c7b55['paused'] ? _0x2c7b55[_0x5bc938(0x325)]() : _0x2c7b55[_0x5bc938(0x31f)]()); }), _0x39d66e[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x218b09 = _0xe2e12e; if (_0x218b09(0x2d0) === _0x218b09(0x2d0)) { if (_0x10ab81[_0x218b09(0x2bd)] === 0x0) return; _0x4cf774 = (_0x4cf774 + 0x1) % _0x10ab81[_0x218b09(0x2bd)], _0x469c79(_0x10ab81[_0x4cf774], _0x10ab81); } else { _0x434c9d(_0x218b09(0x358)); return; } }), _0x194e44['addEventListener'](_0xe2e12e(0x4bd), () => { const _0x1ca889 = _0xe2e12e; if (_0x10ab81[_0x1ca889(0x2bd)] === 0x0) return; _0x4cf774 = (_0x4cf774 - 0x1 + _0x10ab81[_0x1ca889(0x2bd)]) % _0x10ab81['length'], _0x469c79(_0x10ab81[_0x4cf774], _0x10ab81); }), _0x2c7b55[_0xe2e12e(0x501)]('play', () => { const _0x2701c8 = _0xe2e12e; _0x2701c8(0x48d) === _0x2701c8(0x48d) ? _0x4ac726['textContent'] = '❚❚' : (_0x29690d['setItem']('customStickers', _0x4617f1[_0x2701c8(0x822)](_0x1b4afc)), _0x37adc3(_0x2701c8(0x2dc)), _0x29307b(() => _0x241ab9[_0x2701c8(0x8c5)](), 0x5dc)); }), _0x2c7b55[_0xe2e12e(0x501)](_0xe2e12e(0x31f), () => { _0x4ac726['textContent'] = '▶'; }), _0x2c7b55[_0xe2e12e(0x501)](_0xe2e12e(0x708), () => { const _0x1d9e34 = _0xe2e12e; _0x39d66e[_0x1d9e34(0x4bd)](); }), _0x2c7b55[_0xe2e12e(0x501)](_0xe2e12e(0x325), () => { const _0x582f75 = _0xe2e12e, _0x4c5e43 = document[_0x582f75(0x6c2)]('global-player-play-pause-btn'); if (_0x4c5e43) _0x4c5e43[_0x582f75(0x806)] = '❚❚'; }), _0x2c7b55[_0xe2e12e(0x501)](_0xe2e12e(0x31f), () => { const _0x5acdad = _0xe2e12e, _0x50a55f = document['getElementById']('global-player-play-pause-btn'); if (_0x50a55f) _0x50a55f[_0x5acdad(0x806)] = '▶'; }), _0x2c7b55[_0xe2e12e(0x501)](_0xe2e12e(0x708), () => { const _0x11a366 = _0xe2e12e; if (_0x11a366(0x743) !== 'hrheu') { const _0x324be8 = document['getElementById'](_0x11a366(0x56d)); _0x324be8 && _0x324be8[_0x11a366(0x4bd)](); } else { if (!_0x151d03['friendCircles'] || _0x1a7bb9[_0x11a366(0x54c)][_0x11a366(0x2bd)] === 0x0) { _0x1e0d9c[_0x11a366(0x93a)](_0x11a366(0x234)); return; } const _0x2e9065 = _0x35763a[_0x11a366(0x54c)][0x0]; if (_0x2e9065['memberCharacterIds'][_0x11a366(0x2bd)] < 0x2) { _0x36b944[_0x11a366(0x93a)]('错误：第一个好友圈\x20\x22' + _0x2e9065[_0x11a366(0x8fa)] + _0x11a366(0x68d)); return; } const _0x5a2245 = { 'id': _0x11a366(0x7ab) + _0x544475[_0x11a366(0x661)](), 'authorType': 'character', 'authorId': _0x2e9065[_0x11a366(0x6fe)][0x0], 'content': _0x11a366(0x7ca), 'timestamp': _0x1b4025[_0x11a366(0x661)](), 'likes': [_0x2e9065[_0x11a366(0x6fe)][0x1]], 'comments': [{ 'commentId': 'c_' + _0x5919e6[_0x11a366(0x661)](), 'authorId': _0x2e9065[_0x11a366(0x6fe)][0x1], 'content': _0x11a366(0x1d3) }] }; _0x2e9065[_0x11a366(0x681)][_0x11a366(0x956)](_0x5a2245), _0x18f15b(), _0x5320e9['log'](_0x11a366(0x6ce) + _0x2e9065['name'] + _0x11a366(0x586)), _0x308b5e(_0x11a366(0x5c6)); } }); function _0x11ae70(_0xf999ca) { const _0x191e55 = _0xe2e12e; if (!_0xf999ca || typeof _0xf999ca !== _0x191e55(0x338)) return null; const _0x287846 = _0xf999ca['indexOf']('['), _0x2dc6a5 = _0xf999ca[_0x191e55(0x55a)](']'); if (_0x287846 > -0x1 && _0x2dc6a5 > _0x287846) return _0xf999ca[_0x191e55(0x8a1)](_0x287846, _0x2dc6a5 + 0x1); return null; } document[_0xe2e12e(0x6c2)](_0xe2e12e(0x7eb))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x48891e = _0xe2e12e; _0x48891e(0x7fe) !== _0x48891e(0x961) ? (_0x4cd57d(), _0x113213(_0x48891e(0x471), _0x48891e(0x54a))) : _0x1767b8[_0x48891e(0x135)] = ''; }), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x6e7))[_0xe2e12e(0x501)]('click', () => _0x113213('home', _0xe2e12e(0x471))); const _0x1ded32 = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x61f)), _0x5e46be = document[_0xe2e12e(0x6c2)](_0xe2e12e(0x4ca)); _0x1ded32[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), _0x4cd57d), _0x5e46be[_0xe2e12e(0x501)]('click', () => { const _0x44832c = _0xe2e12e; _0x1ded32[_0x44832c(0x970)][_0x44832c(0x6ae)](_0x44832c(0x68c)), _0x5e46be[_0x44832c(0x970)]['add'](_0x44832c(0x68c)), _0x2afad6(); }); function _0x4cd57d() { const _0x1ab9dc = _0xe2e12e; _0x5e46be[_0x1ab9dc(0x970)][_0x1ab9dc(0x6ae)](_0x1ab9dc(0x68c)), _0x1ded32['classList'][_0x1ab9dc(0x68a)](_0x1ab9dc(0x68c)), _0x4e945a(); } function _0x4e945a() { const _0x184797 = _0xe2e12e, _0x160270 = document['getElementById'](_0x184797(0x67b)); document[_0x184797(0x6c2)]('accounting-title')['textContent'] = _0x184797(0x35a), document[_0x184797(0x6c2)](_0x184797(0x68f))[_0x184797(0x978)] = '', _0x160270[_0x184797(0x978)] = _0x184797(0x936), _0x56291e(), document['getElementById'](_0x184797(0x415))[_0x184797(0x501)](_0x184797(0x4bd), _0x104dfb), document['getElementById'](_0x184797(0x928))[_0x184797(0x501)](_0x184797(0x4bd), _0x312339 => { const _0x477043 = _0x184797; if (_0x477043(0x7b0) === _0x477043(0x15a)) _0x359bb2[_0x477043(0x93a)](_0x477043(0x97e), _0x11445b), _0x287afc[_0x477043(0x135)] = _0x477043(0x13b) + _0xa2dd4d[_0x477043(0x6a1)]; else { if (_0x312339[_0x477043(0x68b)][_0x477043(0x970)][_0x477043(0x7a5)]('delete-expense-btn')) { const _0x420090 = _0x312339[_0x477043(0x68b)][_0x477043(0x42a)]['id']; _0x385a44('确定要删除这笔记录吗？')['then'](_0xcd3316 => { const _0x1b72eb = _0x477043; _0xcd3316 && ('mZTEC' !== 'mZTEC' ? (_0x2d9568 = { 'characterId': _0x59eab0[_0x1b72eb(0x376)], 'entries': [] }, _0x259bba[_0x1b72eb(0x18c)][_0x1b72eb(0x956)](_0x37e8b9)) : _0x58cbe4(_0x420090)); }); } } }), document[_0x184797(0x6c2)](_0x184797(0x1e1))['focus'](); } function _0x7f3fe1(_0x2f11ee, _0x12a297) { const _0x5ce274 = _0xe2e12e, _0x2d2f27 = document[_0x5ce274(0x6c2)](_0x5ce274(0x67b)), _0x3def4b = document[_0x5ce274(0x6c2)](_0x5ce274(0x68f)); document[_0x5ce274(0x6c2)](_0x5ce274(0x1ec))['textContent'] = _0x12a297 + _0x5ce274(0x3d0); const _0x30304f = _0x2f11ee['categorizedExpenses'][_0x5ce274(0x153)]((_0x36f26f, _0x1bc757) => _0x36f26f + (_0x1bc757['amount'] || 0x0), 0x0); let _0x2e9c54 = _0x5ce274(0x4b8) + _0x30304f['toFixed'](0x2) + '</div></div><div\x20id=\x22categorized-expenses-list\x22\x20style=\x22margin-top:\x2010px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2010px;\x22></div>'; _0x2d2f27[_0x5ce274(0x978)] = _0x2e9c54; const _0x51b2cc = document[_0x5ce274(0x6c2)]('categorized-expenses-list'), _0x2558fe = { '餐饮美食': _0x5ce274(0x442), '交通出行': _0x5ce274(0x1c4), '购物消费': '<path\x20d=\x22M6\x202L3\x206v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2V6l-3-4z\x22></path><line\x20x1=\x223\x22\x20y1=\x226\x22\x20x2=\x2221\x22\x20y2=\x226\x22></line><path\x20d=\x22M16\x2010a4\x204\x200\x200\x201-8\x200\x22></path>', '生活服务': _0x5ce274(0x710), '休闲娱乐': '<path\x20d=\x22M6\x2012h12\x22></path><path\x20d=\x22M12\x206v12\x22></path><path\x20d=\x22M12\x202a4\x204\x200\x201\x201-4\x204\x22></path><path\x20d=\x22M12\x2022a4\x204\x200\x201\x200\x204-4\x22></path><path\x20d=\x22M22\x2012a4\x204\x200\x201\x200-4-4\x22></path><path\x20d=\x22M2\x2012a4\x204\x200\x201\x201\x204\x204\x22></path>', '医疗健康': _0x5ce274(0x3b7), '人情红包': _0x5ce274(0x2c0), '其他杂项': _0x5ce274(0x4a1), '默认': '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x228\x22></circle><line\x20x1=\x223\x22\x20y1=\x223\x22\x20x2=\x2221\x22\x20y2=\x2221\x22></line>' }; _0x2f11ee[_0x5ce274(0x657)]['forEach'](_0x53e3c4 => { const _0x541fab = _0x5ce274, _0x29eee9 = document[_0x541fab(0x82b)](_0x541fab(0x46f)); _0x29eee9[_0x541fab(0x255)] = 'expense-item', _0x29eee9[_0x541fab(0x645)][_0x541fab(0x9a9)] = _0x541fab(0x3ff), _0x29eee9['style'][_0x541fab(0x6b0)] = 'stretch', _0x29eee9[_0x541fab(0x645)][_0x541fab(0x1e0)] = '15px', _0x29eee9[_0x541fab(0x645)][_0x541fab(0x7a3)] = '0'; const _0x477cf2 = _0x2558fe[_0x53e3c4[_0x541fab(0x80d)]] || _0x2558fe['默认'], _0x3d4a4f = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>' + _0x477cf2 + _0x541fab(0x6a9), _0x20f2b4 = _0x541fab(0x784) + _0x3d4a4f + _0x541fab(0x668) + _0x53e3c4['description'] + '</div><div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x22>' + (_0x53e3c4[_0x541fab(0x80d)] || '未分类') + _0x541fab(0x1d4) + (_0x53e3c4['amount'] || 0x0)['toFixed'](0x2) + _0x541fab(0x475); let _0x489dfb = ''; if (_0x53e3c4[_0x541fab(0x8b5)] && _0x53e3c4['review'][_0x541fab(0x5aa)]) { if (_0x541fab(0x4fe) !== 'IeXsW') _0x4fda50(![]), _0x309b1d['error'](_0x541fab(0x268), _0x3f248d), _0x6ef9ef(_0x541fab(0x72c) + _0x29ad8b[_0x541fab(0x6a1)]); else { const _0x3eade5 = _0x53bcef(_0x53e3c4[_0x541fab(0x8b5)][_0x541fab(0x5aa)]); _0x3eade5 && (_0x489dfb = _0x541fab(0x755) + _0x3eade5[_0x541fab(0x86f)] + _0x541fab(0x3d1) + _0x3eade5[_0x541fab(0x8fa)] + _0x541fab(0x6b2) + _0x53e3c4[_0x541fab(0x8b5)][_0x541fab(0x57b)] + _0x541fab(0x940)); } } _0x29eee9['innerHTML'] = _0x20f2b4 + _0x489dfb, _0x51b2cc[_0x541fab(0x54e)](_0x29eee9); }), _0x3def4b[_0x5ce274(0x978)] = _0x5ce274(0x6c0), document[_0x5ce274(0x6c2)](_0x5ce274(0x69b))[_0x5ce274(0x501)](_0x5ce274(0x4bd), async () => { const _0x20729f = _0x5ce274, _0x3b0e0f = await _0x385a44(_0x20729f(0x1f8)); _0x3b0e0f && (delete _0x4d4ca5[_0x20729f(0x21d)][_0x12a297], _0x42173a(), _0x4e945a()); }); } function _0x2afad6() { const _0x51bc13 = _0xe2e12e; if (_0x51bc13(0x1f0) === 'wUaUd') _0x4ec7c4[_0x51bc13(0x3cf)](_0x38ec90); else { const _0x448482 = document[_0x51bc13(0x6c2)]('accounting-content-area'); document['getElementById']('accounting-title')['textContent'] = '账本', document['getElementById']('header-actions')[_0x51bc13(0x978)] = ''; const _0x1adbb = Object[_0x51bc13(0x2ae)](_0x4d4ca5[_0x51bc13(0x21d)])[_0x51bc13(0x450)]((_0x4b6076, _0x434286) => new Date(_0x434286) - new Date(_0x4b6076)); if (_0x1adbb['length'] === 0x0) { if ('SoZFW' !== 'SoZFW') { if (_0x28f4e9) _0x525d4d(_0x5681e5); const _0x88832 = _0x3d46e2[_0x51bc13(0x68b)][_0x51bc13(0x863)](_0x51bc13(0x1ff)); if (!_0x88832) return; const _0x17081d = _0x4c5b23(_0x88832[_0x51bc13(0x42a)][_0x51bc13(0x384)], 0xa); if (_0x2a9cf8(_0x17081d)) return; const _0x3df5a4 = () => { _0x20fa5f = _0x424778(() => { const _0x1235c7 = _0x22cc; if (_0x12fc82[_0x1235c7(0x327)] === _0x1235c7(0x8c6)) _0x3894ca[_0x1235c7(0x955)](); _0x9080ce(_0x17081d); }, 0x320); }, _0x2d7161 = () => { if (_0x315553) _0x22fc1c(_0xc584e3); }; _0x4b9d78[_0x51bc13(0x501)](_0x51bc13(0x3c3), _0x2d7161, { 'once': !![] }), _0x54afa2['addEventListener'](_0x51bc13(0x9a1), _0x2d7161, { 'once': !![] }), _0x1533da[_0x51bc13(0x501)](_0x51bc13(0x27f), _0x2d7161, { 'once': !![] }), _0x457ed7['addEventListener'](_0x51bc13(0x87f), _0x2d7161, { 'once': !![] }), _0x3df5a4(); } else { _0x448482[_0x51bc13(0x978)] = _0x51bc13(0x81f); return; } } _0x448482[_0x51bc13(0x978)] = '', _0x1adbb[_0x51bc13(0x279)](_0xe9d1f6 => { const _0x1b58c4 = _0x51bc13, _0x298129 = document[_0x1b58c4(0x82b)](_0x1b58c4(0x46f)); _0x298129['className'] = 'expense-item', _0x298129['style'][_0x1b58c4(0x75f)] = 'pointer'; const _0x491ecf = _0x4d4ca5[_0x1b58c4(0x21d)][_0xe9d1f6], _0x2e8470 = _0x491ecf[_0x1b58c4(0x657)][_0x1b58c4(0x153)]((_0x42ab84, _0x302c75) => _0x42ab84 + (_0x302c75[_0x1b58c4(0x621)] || 0x0), 0x0); _0x298129[_0x1b58c4(0x978)] = _0x1b58c4(0x5ad) + _0xe9d1f6 + '</span><span\x20class=\x22amount\x22>总计:\x20' + _0x2e8470[_0x1b58c4(0x874)](0x2) + _0x1b58c4(0x7d3), _0x298129[_0x1b58c4(0x501)](_0x1b58c4(0x4bd), () => { const _0x5e793c = _0x1b58c4; _0x1ded32[_0x5e793c(0x970)]['remove']('active'), _0x5e46be[_0x5e793c(0x970)][_0x5e793c(0x68a)](_0x5e793c(0x68c)), _0x7f3fe1(_0x491ecf, _0xe9d1f6); }), _0x448482['appendChild'](_0x298129); }); } } function _0x104dfb() { const _0x284d66 = _0xe2e12e, _0x58c247 = document[_0x284d66(0x6c2)](_0x284d66(0x1e1)), _0x5f3ae2 = document[_0x284d66(0x6c2)](_0x284d66(0x518)), _0x261274 = _0x58c247[_0x284d66(0x135)][_0x284d66(0x163)](), _0x30cb6b = parseFloat(_0x5f3ae2['value']); if (!_0x261274 || isNaN(_0x30cb6b) || _0x30cb6b <= 0x0) { _0x589297(_0x284d66(0x737)); return; } _0x4d4ca5['accountingData'][_0x284d66(0x956)]({ 'id': _0x284d66(0x8a7) + Date[_0x284d66(0x661)](), 'description': _0x261274, 'amount': _0x30cb6b, 'timestamp': Date[_0x284d66(0x661)]() }), _0x42173a(), _0x56291e(), _0x58c247[_0x284d66(0x135)] = '', _0x5f3ae2[_0x284d66(0x135)] = '', _0x58c247[_0x284d66(0x8df)](); } function _0x58cbe4(_0x5b9117) { const _0x281912 = _0xe2e12e, _0x366c9f = _0x4d4ca5['accountingData'][_0x281912(0x388)](_0x3a40d3 => _0x3a40d3['id'] === _0x5b9117); _0x366c9f > -0x1 && (_0x4d4ca5['accountingData']['splice'](_0x366c9f, 0x1), _0x42173a(), _0x56291e()); } function _0x56291e() { const _0x5cbb2d = _0xe2e12e; if (_0x5cbb2d(0x190) === _0x5cbb2d(0x190)) { const _0x4ab145 = document[_0x5cbb2d(0x6c2)](_0x5cbb2d(0x928)), _0x8d8a18 = document[_0x5cbb2d(0x6c2)](_0x5cbb2d(0x1b8)), _0x14bf8f = new Date(), _0x212c28 = _0x4d4ca5['accountingData'][_0x5cbb2d(0x5fe)](_0x4a4f0a => new Date(_0x4a4f0a[_0x5cbb2d(0x2c3)])[_0x5cbb2d(0x991)]() === _0x14bf8f[_0x5cbb2d(0x991)]()); if (_0x212c28['length'] === 0x0) { _0x4ab145[_0x5cbb2d(0x978)] = _0x5cbb2d(0x662), _0x8d8a18[_0x5cbb2d(0x978)] = ''; return; } _0x4ab145[_0x5cbb2d(0x978)] = '', _0x212c28[_0x5cbb2d(0x450)]((_0x3980f1, _0x2f3b05) => _0x2f3b05[_0x5cbb2d(0x2c3)] - _0x3980f1[_0x5cbb2d(0x2c3)])[_0x5cbb2d(0x279)](_0x13dbcc => { const _0xe1537 = _0x5cbb2d, _0x88a3ae = document[_0xe1537(0x82b)](_0xe1537(0x46f)); _0x88a3ae[_0xe1537(0x255)] = _0xe1537(0x8d4), _0x88a3ae[_0xe1537(0x978)] = _0xe1537(0x5ad) + _0x13dbcc['description'] + '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20' + _0x13dbcc['amount'][_0xe1537(0x874)](0x2) + _0xe1537(0x50b) + _0x13dbcc['id'] + _0xe1537(0x8a8), _0x4ab145[_0xe1537(0x54e)](_0x88a3ae); }), _0x8d8a18 && (_0x8d8a18[_0x5cbb2d(0x978)] = _0x5cbb2d(0x622), document[_0x5cbb2d(0x6c2)](_0x5cbb2d(0x93c))['addEventListener'](_0x5cbb2d(0x4bd), _0x5431b8)); } else _0x31f8d8[_0x5cbb2d(0x41f)] = _0x49facd[_0x5cbb2d(0x53f)][0x0]?.['id'] || null, _0x1c124b(_0x13dc52[_0x5cbb2d(0x41f)]); } async function _0x5431b8() { const _0x393a80 = _0xe2e12e, _0x1d6456 = new Date(), _0x64180e = _0x1d6456[_0x393a80(0x196)]() + '-' + String(_0x1d6456[_0x393a80(0x719)]() + 0x1)[_0x393a80(0x522)](0x2, '0') + '-' + String(_0x1d6456[_0x393a80(0x9b6)]())['padStart'](0x2, '0'); if (_0x4d4ca5[_0x393a80(0x21d)][_0x64180e]) { _0x589297('已经生成了今日账单！想看就去“看账本”标签页。'); return; } const _0x260f5e = _0x4d4ca5[_0x393a80(0x2fa)][_0x393a80(0x5fe)](_0x1d2093 => new Date(_0x1d2093['timestamp'])[_0x393a80(0x991)]() === _0x1d6456[_0x393a80(0x991)]()); if (_0x260f5e[_0x393a80(0x2bd)] === 0x0) { if (_0x393a80(0x3d5) === _0x393a80(0x18e)) _0x2b9e5e[_0x393a80(0x135)] = ''; else { _0x589297(_0x393a80(0x580)); return; } } _0x3145a8(!![], _0x393a80(0x595)); try { if (_0x393a80(0x8db) === 'ZZOcp') { const _0x44b0e5 = ['餐饮美食', _0x393a80(0x528), _0x393a80(0x736), _0x393a80(0x97c), _0x393a80(0x5c8), _0x393a80(0x3fa), '人情红包', _0x393a80(0x2a0)], _0x2e24d6 = _0x260f5e[_0x393a80(0x82d)](_0x51a800 => '-\x20' + _0x51a800['description'] + ':\x20' + _0x51a800[_0x393a80(0x621)])[_0x393a80(0x5cd)]('\x0a'), _0x11ab0b = _0x4d4ca5[_0x393a80(0x4ee)]['map'](_0x4c434a => { const _0x133360 = _0x393a80, _0x44cffb = _0x4d4ca5['chats'][_0x133360(0x5a8)](_0x1fb5cd => _0x1fb5cd[_0x133360(0x327)] === _0x133360(0x17c) && _0x1fb5cd[_0x133360(0x836)][_0x133360(0x407)](_0x4c434a['id'])), _0x377a53 = _0x4d4ca5[_0x133360(0x26d)][_0x133360(0x5a8)](_0x3857f1 => _0x3857f1['id'] === (_0x44cffb?.[_0x133360(0x757)] || _0x4d4ca5[_0x133360(0x4f1)])) || { 'id': _0x133360(0x5ae), 'name': '你' }; let _0x15cdaa = ''; return _0x4c434a[_0x133360(0x963)] && _0x4c434a[_0x133360(0x963)]['length'] > 0x0 && (_0x15cdaa = _0x4c434a[_0x133360(0x963)][_0x133360(0x82d)](_0x4ea637 => _0x4d4ca5[_0x133360(0x7ea)][_0x133360(0x5a8)](_0x258505 => _0x258505['id'] === _0x4ea637))[_0x133360(0x5fe)](Boolean)[_0x133360(0x82d)](_0x53d91e => _0x133360(0x730) + _0x53d91e['name'] + _0x133360(0x80f) + _0x53d91e['content'])[_0x133360(0x5cd)]('')), _0x133360(0x328) + _0x4c434a['id'] + '\x0a\x20\x20\x20\x20姓名:\x20' + _0x4c434a[_0x133360(0x8fa)] + _0x133360(0x1f6) + _0x4c434a[_0x133360(0x7d5)] + _0x133360(0x827) + _0x377a53[_0x133360(0x8fa)] + '\x20(ID:\x20' + _0x377a53['id'] + ')\x0a' + _0x15cdaa; })[_0x393a80(0x5cd)]('\x0a'), _0x56aa26 = _0x4d4ca5[_0x393a80(0x26d)][_0x393a80(0x82d)](_0x114303 => _0x393a80(0x4c1) + _0x114303['id'] + _0x393a80(0x3fb) + _0x114303[_0x393a80(0x8fa)] + _0x393a80(0x1f6) + (_0x114303[_0x393a80(0x7d5)] || '无'))['join']('\x0a'), _0x210172 = _0x393a80(0x41a), _0x4931c9 = '#\x20固定分类列表\x0a[' + _0x44b0e5[_0x393a80(0x5cd)](',\x20') + _0x393a80(0x14c) + _0x11ab0b + _0x393a80(0x728) + _0x56aa26 + _0x393a80(0x648) + _0x2e24d6, _0x387fd1 = [{ 'role': _0x393a80(0x449), 'content': _0x210172 }, { 'role': 'user', 'content': _0x4931c9 }], _0x12cb4c = await _0xc7a378(_0x387fd1, { 'json': !![] }), _0x2ec470 = _0x11ae70(_0x12cb4c); if (!_0x2ec470) throw new Error('AI返回的内容里找不到有效的JSON数组。原始回复:\x20' + _0x12cb4c); const _0x3b0650 = JSON[_0x393a80(0x213)](_0x2ec470); _0x4d4ca5[_0x393a80(0x21d)][_0x64180e] = { 'categorizedExpenses': _0x3b0650, 'timestamp': Date[_0x393a80(0x661)]() }, _0x42173a(), _0x7f3fe1(_0x4d4ca5[_0x393a80(0x21d)][_0x64180e], _0x64180e); } else { const _0x30074d = _0x18065b['transaction'](_0x1d38c8, _0x393a80(0x30f)), _0x908ce0 = _0x30074d['objectStore'](_0x970f4a), _0xf7b96f = _0x908ce0[_0x393a80(0x6a0)]({ 'id': _0x43852b, 'blob': _0x389f60 }); _0xf7b96f['onsuccess'] = () => _0x3bc69f(_0xf7b96f[_0x393a80(0x84e)]), _0xf7b96f[_0x393a80(0x911)] = () => _0x53e12d(_0xf7b96f[_0x393a80(0x93a)]); } } catch (_0x26f157) { _0x589297(_0x393a80(0x853) + _0x26f157[_0x393a80(0x6a1)]); } finally { _0x393a80(0x896) !== 'wtUES' ? (_0x1c370c(![]), _0xf79110['isGenerating'] = ![]) : _0x3145a8(![]); } } async function _0x2e5a4a() { const _0x1d7d7c = _0xe2e12e, _0x5e3fac = [..._0x55b495]; try { const _0xf8a9 = localStorage['getItem'](_0x1d7d7c(0x6a5)); if (_0xf8a9) { if (_0x1d7d7c(0x89d) !== _0x1d7d7c(0x50e)) { const _0x3494f4 = JSON['parse'](_0xf8a9); Array[_0x1d7d7c(0x189)](_0x3494f4) ? _0x2e6858 = [..._0x5e3fac, ..._0x3494f4] : _0x2e6858 = _0x5e3fac; } else { const _0x56c003 = { 'characters': _0x26494e['characters'], 'worldBooks': _0x3c9312[_0x1d7d7c(0x7ea)], 'chats': _0x5d4324[_0x1d7d7c(0x53f)], 'userProfile': _0xc2b824[_0x1d7d7c(0x473)], 'apiSettings': _0x22544d[_0x1d7d7c(0x547)], 'preferences': _0x545a05['preferences'], 'activeChatId': _0x54a454[_0x1d7d7c(0x41f)], 'diaries': _0x45a0b3[_0x1d7d7c(0x18c)], 'friendCircles': _0x1655ca[_0x1d7d7c(0x54c)], 'activeFriendCircleId': _0x2089a6[_0x1d7d7c(0x752)], 'userProfiles': _0xee2a0b[_0x1d7d7c(0x26d)], 'activeUserProfileId': _0x23d41d[_0x1d7d7c(0x4f1)], 'accountingData': _0x2cfeb8['accountingData'], 'accountingLedger': _0x51e5cd['accountingLedger'] }; _0x7fd80a['setItem'](_0x1d7d7c(0x72e), _0x2ca8dd[_0x1d7d7c(0x822)](_0x56c003)); } } else _0x2e6858 = _0x5e3fac; } catch (_0x58b001) { console[_0x1d7d7c(0x93a)](_0x1d7d7c(0x5dc), _0x58b001), _0x2e6858 = _0x5e3fac; } if (!localStorage[_0x1d7d7c(0x745)](_0x1d7d7c(0x5c3))) { _0x385a44(_0x1d7d7c(0x260))[_0x1d7d7c(0x588)](async _0x63a7f0 => { const _0x376645 = _0x1d7d7c; _0x63a7f0 ? (_0x3145a8(!![], '正在升级聊天数据结构...'), await _0x444692(), localStorage['setItem'](_0x376645(0x5c3), _0x376645(0x7e2)), _0x3145a8(![]), _0x589297('第一阶段升级完成！应用即将刷新以进行第二阶段检查。'), setTimeout(() => location[_0x376645(0x8c5)](), 0x5dc)) : _0x376645(0x637) === 'msrKu' ? _0x589297(_0x376645(0x748)) : _0x2ce28e('包含所有图片和音乐的全量数据已成功导出！'); }); return; } if (!localStorage[_0x1d7d7c(0x745)](_0x1d7d7c(0x897))) { console['log']('执行好友圈数据净化...'), _0x3145a8(!![], _0x1d7d7c(0x282)); const _0x307fae = await _0x443470(); localStorage[_0x1d7d7c(0x598)](_0x1d7d7c(0x897), _0x1d7d7c(0x7e2)), _0x3145a8(![]); if (_0x307fae > 0x0) { _0x589297(_0x1d7d7c(0x496) + _0x307fae + _0x1d7d7c(0x56e)), setTimeout(() => location[_0x1d7d7c(0x8c5)](), 0x5dc); return; } } if (!localStorage[_0x1d7d7c(0x745)]('noir_migration_fc_v1_complete')) { } if (!localStorage[_0x1d7d7c(0x745)](_0x1d7d7c(0x183))) { if ('RWJfK' !== _0x1d7d7c(0x5d9)) { console[_0x1d7d7c(0x39f)](_0x1d7d7c(0x4cf)), _0x3145a8(!![], _0x1d7d7c(0x25e)); const _0x5a1d99 = await _0x311166(); localStorage['setItem'](_0x1d7d7c(0x183), 'true'), _0x3145a8(![]); if (_0x5a1d99 > 0x0) { _0x589297(_0x1d7d7c(0x825) + _0x5a1d99 + _0x1d7d7c(0x3e4)), setTimeout(() => location[_0x1d7d7c(0x8c5)](), 0x5dc); return; } } else { const _0x59ded2 = _0x42c22d[_0x1d7d7c(0x8f3)](); _0x59ded2[_0x1d7d7c(0x578)] = () => _0x4a239b(_0x59ded2['result']), _0x59ded2[_0x1d7d7c(0x911)] = () => _0x4840ce(_0x59ded2[_0x1d7d7c(0x93a)]); } } const _0x259ba8 = _0xf6472f(); _0x4c7e6c(), _0x28e3f1(), _0x2ba78f(), _0x34ffaf(), _0x481e58(), _0x17582a(), _0x15666d(), _0x28cb7c(), _0x29f2e0(), _0x2a90bc(), _0x3f87e7(), _0xdbf249(), setInterval(_0xdbf249, 0x7530), _0x1a07a7(), _0x505812(), _0x135b47(); const _0x177779 = document['getElementById'](_0x1d7d7c(0x873)); document[_0x1d7d7c(0x6c2)]('music-widget-card')[_0x1d7d7c(0x501)]('click', function (_0x501ab5) { const _0x3e29c3 = _0x1d7d7c; if (_0x501ab5[_0x3e29c3(0x68b)][_0x3e29c3(0x863)](_0x3e29c3(0x49f))) { if (_0x3e29c3(0x14a) !== 'SeUSz') { const _0x111d56 = _0x4efef4[_0x3e29c3(0x5a2)](_0x23741f, 'readwrite'), _0x39e902 = _0x111d56[_0x3e29c3(0x706)](_0x154ace), _0x310740 = _0x39e902[_0x3e29c3(0x6a0)]({ 'id': _0x37f8a1, 'blob': _0x794573 }); _0x310740[_0x3e29c3(0x578)] = () => _0x3423d8(_0x310740[_0x3e29c3(0x84e)]), _0x310740['onerror'] = () => _0x1d0e31(_0x310740[_0x3e29c3(0x93a)]); } else return; } const _0x247297 = document[_0x3e29c3(0x6c2)](_0x3e29c3(0x866)); _0x247297 && ('tqkTV' !== _0x3e29c3(0x96f) ? _0x2fe440[_0x3e29c3(0x93a)]('在准备API数据时，从IndexedDB读取图片失败:', _0x5157e3) : _0x247297[_0x3e29c3(0x4bd)]()); }), _0x113213(_0x1d7d7c(0x54a), _0x1d7d7c(0x539)); (_0x259ba8 || _0x4d4ca5[_0x1d7d7c(0x4ee)][_0x1d7d7c(0x2bd)] === 0x0) && (_0x589297('欢迎！请先创建一个角色开始聊天。'), setTimeout(() => { const _0x567f77 = _0x1d7d7c; _0x113213(_0x567f77(0x60d), _0x567f77(0x54a)), setTimeout(() => _0x539822(), 0x64); }, 0x6a4)); const _0x38d0b6 = document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x412)); document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x7f8))[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), () => _0x38d0b6['click']()), document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x6d2))[_0x1d7d7c(0x501)]('click', () => { const _0x2b63c5 = _0x1d7d7c; _0x4d4ca5[_0x2b63c5(0x2d6)]['widgetBgImage'] = null, _0x42173a(), _0x1a07a7(), _0x589297('小组件背景已恢复默认。'); }), _0x38d0b6[_0x1d7d7c(0x501)](_0x1d7d7c(0x858), async _0x17e63a => { const _0x526cbb = _0x1d7d7c, _0x408bce = _0x17e63a['target']['files'][0x0]; if (!_0x408bce) return; try { const _0x5e4964 = await _0x13257f(_0x408bce); _0x4d4ca5[_0x526cbb(0x2d6)]['widgetBgImage'] = _0x5e4964, _0x42173a(), _0x1a07a7(), _0x589297(_0x526cbb(0x7d9)); } catch (_0x41f704) { _0x526cbb(0x56a) !== _0x526cbb(0x56a) ? (_0x329cb2(), _0x337d5f('friendCircleList', _0x526cbb(0x513))) : _0x589297('错误:\x20' + _0x41f704['message']); } }), _0x1ec78e(), document['getElementById'](_0x1d7d7c(0x2d8))[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), () => document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x2e6))[_0x1d7d7c(0x4bd)]()), document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x1dd))['addEventListener'](_0x1d7d7c(0x4bd), async () => { const _0x3fe6df = _0x1d7d7c; await _0x3d9a60('widget_badge'), localStorage[_0x3fe6df(0x5e7)](_0x3fe6df(0x603)), _0x1ec78e(), _0x589297('徽章已移除。'); }), document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x2e6))['addEventListener'](_0x1d7d7c(0x858), async _0x7a8d01 => { const _0x200e0b = _0x1d7d7c; if (_0x200e0b(0x6a8) === _0x200e0b(0x425)) _0x110e6d[_0x200e0b(0x752)] && _0x2bfe8f(_0x507797[_0x200e0b(0x752)]); else { const _0x3d813a = _0x7a8d01['target'][_0x200e0b(0x4c0)][0x0]; if (!_0x3d813a) return; try { await _0x34f697(_0x200e0b(0x359), _0x3d813a), await _0x1ec78e(), _0x589297(_0x200e0b(0x64d)); } catch (_0x78af32) { if ('sdSJP' !== _0x200e0b(0x5af)) _0x589297(_0x200e0b(0x67a) + _0x78af32[_0x200e0b(0x6a1)]); else { const _0x328c0a = _0x2d8bb1[_0x200e0b(0x5a2)](_0x2e163a, _0x200e0b(0x30f)), _0x4f31e3 = _0x328c0a[_0x200e0b(0x706)](_0x1aac85), _0x22644b = _0x4f31e3[_0x200e0b(0x6a0)](_0x42750b); _0x22644b['onsuccess'] = () => _0x1f5ed1(_0x22644b[_0x200e0b(0x84e)]), _0x22644b[_0x200e0b(0x911)] = () => _0x597055(_0x22644b[_0x200e0b(0x93a)]); } } } }), _0x3b4474(), document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x304))[_0x1d7d7c(0x501)](_0x1d7d7c(0x96e), _0x397abb), document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x304))[_0x1d7d7c(0x501)](_0x1d7d7c(0x8c6), _0x397abb, { 'passive': ![] }), document['getElementById'](_0x1d7d7c(0x4d8))[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), () => document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x317))[_0x1d7d7c(0x4bd)]()), document['getElementById'](_0x1d7d7c(0x3eb))[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), async () => { const _0x4fb8d0 = _0x1d7d7c; await _0x3d9a60(_0x4fb8d0(0x952)), localStorage['removeItem']('cardState'), _0x3b4474(), _0x589297(_0x4fb8d0(0x6e5)); }), document['getElementById']('card-input')['addEventListener'](_0x1d7d7c(0x858), async _0x1f9eb0 => { const _0x451b1e = _0x1d7d7c; if (_0x451b1e(0x52c) === _0x451b1e(0x52c)) { const _0x5dda94 = _0x1f9eb0['target']['files'][0x0]; if (!_0x5dda94) return; try { if (_0x451b1e(0x4d6) !== 'HWQsk') await _0x34f697(_0x451b1e(0x952), _0x5dda94), await _0x3b4474(), _0x589297('卡片已更换！'); else { if (typeof _0x3269f9 === _0x451b1e(0x338)) _0x1351ac[_0x451b1e(0x956)](_0x520dc4); } } catch (_0x35bdf7) { if ('QBkZB' !== _0x451b1e(0x281)) _0x589297(_0x451b1e(0x67a) + _0x35bdf7[_0x451b1e(0x6a1)]); else { const _0x4981d8 = _0x32b237[_0x451b1e(0x745)](_0x451b1e(0x201) + _0x35b168), _0x45b4d2 = _0xbcbaa2[_0x451b1e(0x213)](_0x4981d8 || '[]'); return _0x36053b[_0x451b1e(0x189)](_0x45b4d2) ? _0x45b4d2 : []; } } } else _0x1cbd1a['error']('Failed\x20to\x20read\x20state\x20from\x20localStorage:', _0x45ec2c), _0x2b46c5(_0x451b1e(0x344)); }), document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x7c8))[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), async () => { const _0xb0513 = _0x1d7d7c, _0x4b6971 = await _0x385a44(_0xb0513(0x453)); _0x4b6971 && (_0xb0513(0x240) !== _0xb0513(0x15e) ? (localStorage[_0xb0513(0x5e7)](_0xb0513(0x603)), localStorage[_0xb0513(0x5e7)](_0xb0513(0x867)), _0x589297(_0xb0513(0x4da)), setTimeout(() => location[_0xb0513(0x8c5)](), 0x3e8)) : _0x59029f > _0x225216 && (_0x2b5c3d *= _0x365a8f / _0xc01a2b, _0x1d2ac9 = _0x13f723)); }); const _0x597e3b = document['getElementById'](_0x1d7d7c(0x534)); _0x597e3b['addEventListener']('click', () => { _0x468acb(), _0x113213('diaryList', 'home'); }); const _0x44c1a6 = document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x40c)); _0x44c1a6[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), () => { const _0x1d079e = _0x1d7d7c; _0x1d079e(0x421) === 'zOQyr' ? (_0x3a2249 = !![], _0x3a8556[_0x1d079e(0x41f)] = null) : (_0x485827(), _0x113213(_0x1d079e(0x84c), _0x1d079e(0x54a))); }), document[_0x1d7d7c(0x6c2)]('back-to-home-from-music-library')[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), () => _0x113213('home', _0x1d7d7c(0x84c))), document[_0x1d7d7c(0x6c2)]('back-to-home-from-diary-list')[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), () => _0x113213(_0x1d7d7c(0x54a), _0x1d7d7c(0x342))), document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x83c))[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), () => { const _0x4f941a = _0x1d7d7c; _0x4d4ca5[_0x4f941a(0x376)] = null, _0x113213(_0x4f941a(0x342), _0x4f941a(0x70a)); }), document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x851))['addEventListener']('click', _0xc5d195), document['getElementById'](_0x1d7d7c(0x6d6))[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), _0x43622e), document[_0x1d7d7c(0x6c2)]('diary-entry-input')[_0x1d7d7c(0x501)](_0x1d7d7c(0x6d5), _0x5a5b5e => { const _0x1f4b2c = _0x1d7d7c; if (_0x5a5b5e['key'] === _0x1f4b2c(0x161) && !_0x5a5b5e[_0x1f4b2c(0x80e)]) { if (_0x1f4b2c(0x17f) === _0x1f4b2c(0x17f)) _0x5a5b5e['preventDefault'](), _0xc5d195(); else { const _0x4393a0 = _0x17becf(_0x12a3c2[_0x1f4b2c(0x7af)] ?? _0x5761e4['text'] ?? _0x60b094[_0x1f4b2c(0x6a1)] ?? '')[_0x1f4b2c(0x163)](); if (_0x4393a0) _0x399a89[_0x1f4b2c(0x64f)][_0x1f4b2c(0x956)]({ 'senderId': _0x2defe9['id'], 'kind': _0x1f4b2c(0x57b), 'content': _0x4393a0 }); } } }); const _0x26fac1 = [_0x1d7d7c(0x416), _0x1d7d7c(0x224), 'angry', _0x1d7d7c(0x23a), _0x1d7d7c(0x977)]; _0x26fac1['forEach'](_0x2cde2f => { const _0x1170f7 = _0x1d7d7c; if (_0x1170f7(0x1e2) !== _0x1170f7(0x790)) { const _0xb3d68e = document['getElementById'](_0x1170f7(0x23f) + _0x2cde2f + '-preview'), _0x11a793 = document[_0x1170f7(0x6c2)](_0x1170f7(0x23f) + _0x2cde2f + _0x1170f7(0x7cc)); _0xb3d68e && _0x11a793 && (_0xb3d68e[_0x1170f7(0x501)]('click', () => _0x11a793[_0x1170f7(0x4bd)]()), _0x11a793[_0x1170f7(0x501)](_0x1170f7(0x858), async _0x45366a => { const _0x5bc9cf = _0x1170f7, _0x4e7f38 = _0x45366a[_0x5bc9cf(0x68b)]['files'][0x0]; if (!_0x4e7f38) return; try { _0xb3d68e[_0x5bc9cf(0x6c3)] = URL['createObjectURL'](_0x4e7f38); } catch (_0x1090e3) { if (_0x5bc9cf(0x360) === _0x5bc9cf(0x360)) _0x589297(_0x5bc9cf(0x88d) + _0x1090e3[_0x5bc9cf(0x6a1)]); else { if (_0x22c6f0) { const _0x404e82 = _0xde2bf4['createElement']('p'); _0x404e82[_0x5bc9cf(0x978)] = _0x3c2086, _0x404e82['style'][_0x5bc9cf(0x1ee)] = '0', _0x7796c6[_0x5bc9cf(0x54e)](_0x404e82); } } } })); } else _0x167827[_0x1170f7(0x806)] = _0x28262c[_0x1170f7(0x8fa)] || _0x1170f7(0x4e4) + _0xa05098[_0x1170f7(0x836)][_0x1170f7(0x2bd)] + ')'; }), document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x7c1))[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), _0x5270ed), document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x176))['addEventListener'](_0x1d7d7c(0x4bd), () => { const _0x5828c2 = _0x1d7d7c; _0x4d4ca5[_0x5828c2(0x4b0)] = _0x4d4ca5[_0x5828c2(0x4b0)] === _0x5828c2(0x8ed) ? _0x5828c2(0x130) : _0x5828c2(0x8ed), _0x5e5e09(); }), document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x77b))[_0x1d7d7c(0x501)]('mousedown', _0x4473d6), document[_0x1d7d7c(0x6c2)]('meeting-scene-view')['addEventListener']('touchstart', _0x4473d6, { 'passive': ![] }); let _0x21b554 = null; function _0x4473d6(_0x3c1293) { const _0x4de534 = _0x1d7d7c; if (_0x4de534(0x5cc) !== _0x4de534(0x8f7)) { if (_0x21b554) clearTimeout(_0x21b554); const _0x192fee = _0x3c1293['target']['closest']('p[data-history-index]'); if (!_0x192fee) return; const _0x293ce6 = parseInt(_0x192fee['dataset'][_0x4de534(0x384)], 0xa); if (isNaN(_0x293ce6)) return; const _0x214bf8 = () => { const _0x19c8f6 = _0x4de534; 'RWSOq' === 'XFlcP' ? (_0x150383[_0x19c8f6(0x2d6)][_0x19c8f6(0x4d0)] = _0x220fdf[_0x19c8f6(0x5a7)], _0x26ec31(), _0x32b045()) : _0x21b554 = setTimeout(() => { const _0x57ace7 = _0x19c8f6; if (_0x57ace7(0x1f9) === _0x57ace7(0x1f9)) { if (_0x3c1293[_0x57ace7(0x327)] === 'touchstart') _0x3c1293[_0x57ace7(0x955)](); _0x360195(_0x293ce6); } else { const _0x257c2d = _0xda762e[_0x57ace7(0x82b)](_0x57ace7(0x46f)); _0x257c2d[_0x57ace7(0x255)] = _0x57ace7(0x8d4), _0x257c2d[_0x57ace7(0x645)][_0x57ace7(0x9a9)] = 'column', _0x257c2d[_0x57ace7(0x645)]['alignItems'] = _0x57ace7(0x8ac), _0x257c2d[_0x57ace7(0x645)][_0x57ace7(0x1e0)] = _0x57ace7(0x4d9), _0x257c2d[_0x57ace7(0x645)][_0x57ace7(0x7a3)] = '0'; const _0x462ffe = _0x375a35[_0x2ed1ad[_0x57ace7(0x80d)]] || _0x1b90b0['默认'], _0x4d89b7 = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>' + _0x462ffe + _0x57ace7(0x6a9), _0x3d0227 = _0x57ace7(0x784) + _0x4d89b7 + _0x57ace7(0x668) + _0x290298[_0x57ace7(0x99f)] + _0x57ace7(0x8ec) + (_0x46dcba[_0x57ace7(0x80d)] || '未分类') + '</div></div></div><span\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x22>-\x20' + (_0x40885d[_0x57ace7(0x621)] || 0x0)[_0x57ace7(0x874)](0x2) + '</span></div>'; let _0x15efb2 = ''; if (_0x323f7e[_0x57ace7(0x8b5)] && _0x4b1db6['review'][_0x57ace7(0x5aa)]) { const _0x2ed8fe = _0x1b18b5(_0x34ea4b[_0x57ace7(0x8b5)][_0x57ace7(0x5aa)]); _0x2ed8fe && (_0x15efb2 = _0x57ace7(0x755) + _0x2ed8fe[_0x57ace7(0x86f)] + _0x57ace7(0x3d1) + _0x2ed8fe[_0x57ace7(0x8fa)] + '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>' + _0x62158['review'][_0x57ace7(0x57b)] + _0x57ace7(0x940)); } _0x257c2d[_0x57ace7(0x978)] = _0x3d0227 + _0x15efb2, _0x4db15e[_0x57ace7(0x54e)](_0x257c2d); } }, 0x320); }, _0xbfa81a = () => { const _0xffa0a9 = _0x4de534; if ('hYhpp' === _0xffa0a9(0x886)) { _0x2cc6bc['innerHTML'] = _0xffa0a9(0x9b4); return; } else { if (_0x21b554) clearTimeout(_0x21b554); } }; document['addEventListener'](_0x4de534(0x3c3), _0xbfa81a, { 'once': !![] }), document[_0x4de534(0x501)](_0x4de534(0x9a1), _0xbfa81a, { 'once': !![] }), document['addEventListener'](_0x4de534(0x27f), _0xbfa81a, { 'once': !![] }), document[_0x4de534(0x501)]('touchcancel', _0xbfa81a, { 'once': !![] }), _0x214bf8(); } else _0x1d2790[_0x31647a[_0x46e4ad]] = _0x1ecd3c; } document['body'][_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), _0x90092f => { const _0x142d98 = _0x1d7d7c; if (_0x142d98(0x79a) === 'YHFwd') { const _0x51b003 = _0x161c85[_0x142d98(0x82b)](_0x142d98(0x21a)); _0x51b003[_0x142d98(0x135)] = _0x304cf3['id'], _0x51b003[_0x142d98(0x806)] = _0xd67770[_0x142d98(0x8fa)], _0x3948a5[_0x142d98(0x54e)](_0x51b003); } else { const _0x244b59 = _0x90092f[_0x142d98(0x68b)]['closest']('.listen-together-card'); if (_0x244b59) { if ('mLCBx' !== 'GPFKF') { const _0x560175 = _0x90092f[_0x142d98(0x68b)][_0x142d98(0x863)](_0x142d98(0x443)), _0x502c8c = _0x90092f['target']['closest'](_0x142d98(0x28f)); if (_0x560175) 'QVukj' === 'QKdTT' ? _0x36f413[_0x142d98(0x501)](_0x142d98(0x4bd), () => { const _0x1bd27 = _0x142d98; if (_0x4dd7d0[_0x1bd27(0x2bd)] === 0x0) return; _0x45fe00 = (_0x57ddd5 - 0x1 + _0x29bea5['length']) % _0x99ff24[_0x1bd27(0x2bd)], _0x5dc852(_0x236f2f[_0x4b80c6], _0x380bcd); }) : _0x44bdf3(); else { if (_0x502c8c) { if ('fJHcx' === _0x142d98(0x550)) { const _0x121c2f = _0x502c8c[_0x142d98(0x863)](_0x142d98(0x789)), _0x40daca = _0x502c8c[_0x142d98(0x42a)]['songId'], _0x3678a2 = parseInt(_0x121c2f[_0x142d98(0x42a)][_0x142d98(0x384)], 0xa); _0x53147d(_0x40daca, _0x3678a2, _0x244b59); } else { const _0x5f04a6 = _0x5a4c49['createElement'](_0x142d98(0x46f)); _0x5f04a6[_0x142d98(0x255)] = 'world-book-item', _0x5f04a6['dataset']['id'] = _0x118f52['id']; const _0x1e4d5e = _0x16b9d0['id'] === _0x330458['activeUserProfileId'] ? _0x142d98(0x362) : ''; _0x5f04a6[_0x142d98(0x978)] = _0x142d98(0x155) + (_0x4f696f[_0x142d98(0x86f)] || _0x374d95) + '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0xd5e78c[_0x142d98(0x8fa)] + _0x1e4d5e + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x4486a2[_0x142d98(0x7d5)][_0x142d98(0x8a1)](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x5f04a6['addEventListener']('click', () => _0x8f0483(_0x746f77['id'])), _0x297555[_0x142d98(0x54e)](_0x5f04a6); } } else { const _0x4fd0b6 = _0xa2c8b5(); if (_0x4fd0b6 && _0x4fd0b6[_0x142d98(0x5b7)] && _0x4fd0b6['activeListenSession'][_0x142d98(0x81b)]) { if (_0x142d98(0x861) !== 'hxDaK') _0x300624[_0x142d98(0x645)]['display'] = _0x142d98(0x381), setTimeout(() => _0x300624[_0x142d98(0x970)][_0x142d98(0x68a)](_0x142d98(0x3a7)), 0xa); else { const _0x3fbe41 = _0x2b835d['getElementById'](_0x142d98(0x1e1)), _0x1874f1 = _0xb1ae5[_0x142d98(0x6c2)]('expense-amount'), _0x540c97 = _0x3fbe41[_0x142d98(0x135)][_0x142d98(0x163)](), _0x208563 = _0x4d8755(_0x1874f1[_0x142d98(0x135)]); if (!_0x540c97 || _0x9f80ba(_0x208563) || _0x208563 <= 0x0) { _0x2a2bf9(_0x142d98(0x737)); return; } _0x415343[_0x142d98(0x2fa)]['push']({ 'id': _0x142d98(0x8a7) + _0x452830['now'](), 'description': _0x540c97, 'amount': _0x208563, 'timestamp': _0x374a3d[_0x142d98(0x661)]() }), _0x55aad2(), _0x562988(), _0x3fbe41[_0x142d98(0x135)] = '', _0x1874f1['value'] = '', _0x3fbe41[_0x142d98(0x8df)](); } } } } return; } else _0x464a30['preferences']['widgetBgImage'] = null, _0x5ee09c(), _0x513409(), _0x54a075(_0x142d98(0x988)); } if (window[_0x142d98(0x16e)]()[_0x142d98(0x823)]()) return; const _0x3938f3 = _0x90092f['target']['closest'](_0x142d98(0x789)); if (_0x3938f3 && !_0x90092f[_0x142d98(0x68b)][_0x142d98(0x863)](_0x142d98(0x96d))) { if (_0x142d98(0x4d2) !== 'BSrmW') { const _0x44fb4f = [_0x142d98(0x353), '星期一', '星期二', _0x142d98(0x979), '星期四', _0x142d98(0x557), _0x142d98(0x751)]; return _0x44fb4f[_0x593f95['getDay']()] + '\x20' + _0x2b1d43; } else { const _0x5c31e0 = parseInt(_0x3938f3['dataset'][_0x142d98(0x384)], 0xa); !isNaN(_0x5c31e0) && _0x360195(_0x5c31e0); } } } }); const _0x3d4e86 = document['getElementById'](_0x1d7d7c(0x6bc)); _0x3d4e86 && _0x3d4e86[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), () => { const _0x1c03f1 = _0x1d7d7c; if (_0x1c03f1(0x438) === _0x1c03f1(0x69d)) { const _0x4a4c00 = _0x5952d8(_0x7b41c1[_0x1c03f1(0x42a)]['page'], 0xa); _0x176444(_0x4a4c00); } else _0x589297('核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a'); }); const _0x9df1e6 = document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x149)), _0xe42df8 = localStorage[_0x1d7d7c(0x745)](_0x1d7d7c(0x6a5)); if (_0xe42df8) try { if (_0x1d7d7c(0x12b) !== _0x1d7d7c(0x12b)) { _0x3c4908(_0x1d7d7c(0x945), _0x1d7d7c(0x37f)); if (_0xdcef8a) { const _0x269bb6 = _0x4ce835[_0x1d7d7c(0x7ea)][_0x1d7d7c(0x5a8)](_0x55af06 => _0x55af06['id'] === _0x4aca95); if (!_0x269bb6) return; _0xbf50b[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x4f3))['value'] = _0x269bb6['id'], _0x1fd160[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x77d))[_0x1d7d7c(0x806)] = _0x1d7d7c(0x868), _0x1911f5[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x457))[_0x1d7d7c(0x135)] = _0x269bb6[_0x1d7d7c(0x8fa)], _0x2613a8[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x323))[_0x1d7d7c(0x135)] = _0x269bb6[_0x1d7d7c(0x7af)]; } else _0x42550b['getElementById']('editing-world-book-id')[_0x1d7d7c(0x135)] = '', _0x40be48[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x77d))[_0x1d7d7c(0x806)] = _0x1d7d7c(0x712), _0x11ef3f[_0x1d7d7c(0x6c2)]('world-book-edit-name')['value'] = '', _0x2313ff[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x323))[_0x1d7d7c(0x135)] = ''; } else { const _0x5d2361 = JSON['parse'](_0xe42df8); Array[_0x1d7d7c(0x189)](_0x5d2361) && (_0x9df1e6['value'] = _0x5d2361['map'](_0xbf33ef => _0xbf33ef[_0x1d7d7c(0x8fa)] + '--' + _0xbf33ef['url'])['join']('\x0a')); } } catch (_0x156432) { } document['getElementById'](_0x1d7d7c(0x7ed))[_0x1d7d7c(0x501)](_0x1d7d7c(0x4bd), () => { const _0x5a3195 = _0x1d7d7c, _0x550473 = _0x9df1e6[_0x5a3195(0x135)], _0x2ac40a = _0x550473[_0x5a3195(0x3e8)]('\x0a')['filter'](_0x2e0b1a => _0x2e0b1a['trim']() !== ''), _0x45ab6c = []; let _0x108c0f = 0x0; for (const _0x57d4a6 of _0x2ac40a) { if (_0x5a3195(0x5bb) === _0x5a3195(0x8eb)) _0x4af292[_0x5a3195(0x501)](_0x5a3195(0x4bd), () => { const _0x4546c = _0x5a3195; if (_0x40a57d[_0x4546c(0x2bd)] === 0x0) return; _0x1ed3ca = (_0x1c20c1 + 0x1) % _0x2f28bc['length'], _0x1749df(_0x277fc3[_0x3113bb], _0x3d3326); }); else { const _0x1aef25 = _0x57d4a6[_0x5a3195(0x3e8)]('--'); _0x1aef25[_0x5a3195(0x2bd)] === 0x2 && _0x1aef25[0x0]['trim']() && _0x1aef25[0x1][_0x5a3195(0x163)]()[_0x5a3195(0x245)]('http') ? _0x45ab6c[_0x5a3195(0x956)]({ 'name': _0x1aef25[0x0]['trim'](), 'url': _0x1aef25[0x1]['trim']() }) : _0x108c0f++; } } _0x108c0f > 0x0 && _0x589297('有\x20' + _0x108c0f + _0x5a3195(0x14f)); try { localStorage[_0x5a3195(0x598)](_0x5a3195(0x6a5), JSON[_0x5a3195(0x822)](_0x45ab6c)), _0x589297(_0x5a3195(0x2dc)), setTimeout(() => location[_0x5a3195(0x8c5)](), 0x5dc); } catch (_0x49fb51) { _0x589297(_0x5a3195(0x16b)); } }), _0x20c5de(), document[_0x1d7d7c(0x6c2)]('upload-card-button-2')[_0x1d7d7c(0x501)]('click', () => { const _0x3de2f7 = _0x1d7d7c; document[_0x3de2f7(0x6c2)](_0x3de2f7(0x401))['click'](); }), document[_0x1d7d7c(0x6c2)](_0x1d7d7c(0x229))['addEventListener'](_0x1d7d7c(0x4bd), async () => { const _0x63a242 = _0x1d7d7c; await _0x3d9a60(_0x63a242(0x167)), localStorage['removeItem'](_0x63a242(0x921)), _0x3b4474(), _0x589297('卡片\x202\x20已移除。'); }), document[_0x1d7d7c(0x6c2)]('card-input-2')[_0x1d7d7c(0x501)](_0x1d7d7c(0x858), async _0x503951 => { const _0xc0ccbf = _0x1d7d7c; if (_0xc0ccbf(0x97d) === 'myRxm') _0xf59804[_0xc0ccbf(0x3cf)](_0x1a49ec); else { const _0x4a899c = _0x503951[_0xc0ccbf(0x68b)][_0xc0ccbf(0x4c0)][0x0]; if (!_0x4a899c) return; try { await _0x34f697(_0xc0ccbf(0x167), _0x4a899c), await _0x3b4474(), _0x589297(_0xc0ccbf(0x357)); } catch (_0x2afdc3) { _0x589297(_0xc0ccbf(0x67a) + _0x2afdc3[_0xc0ccbf(0x6a1)]); } } }); } const _0x5a6c78 = new Promise((_0x39b02f, _0x15006e) => { const _0x21db60 = _0xe2e12e, _0x5065d0 = indexedDB[_0x21db60(0x71c)](_0xc4a531, 0x2); _0x5065d0['onerror'] = () => _0x15006e('IndexedDB\x20failed\x20to\x20open'), _0x5065d0['onsuccess'] = () => _0x39b02f(_0x5065d0[_0x21db60(0x84e)]); }), _0x4034d6 = _0xe2e12e(0x6f6); async function _0x36a25e(_0x44f09f) { const _0xb89d6c = await _0x5a6c78; return new Promise((_0x282908, _0x145c34) => { const _0xb517e6 = _0x22cc; if ('JfVZQ' === _0xb517e6(0x716)) { const _0x807b8c = _0xb89d6c[_0xb517e6(0x5a2)](_0x4034d6, _0xb517e6(0x185)), _0x3c8759 = _0x807b8c[_0xb517e6(0x706)](_0x4034d6), _0x10a8c1 = _0x3c8759[_0xb517e6(0x261)](_0x44f09f); _0x10a8c1[_0xb517e6(0x578)] = () => _0x282908(_0x10a8c1[_0xb517e6(0x84e)]), _0x10a8c1[_0xb517e6(0x911)] = () => _0x145c34(_0x10a8c1[_0xb517e6(0x93a)]); } else _0xd3b860(_0x12e668), _0x104aa7[_0xb517e6(0x653)](_0xb517e6(0x47e), _0x29fafe), _0x77d706[_0xb517e6(0x653)]('error', _0x310337), _0x1a401f[_0xb517e6(0x6c3)] = '', _0x3ae9ca['remove'](); }); } async function _0x175b8e() { const _0x16343c = await _0x5a6c78; return new Promise((_0x42ef66, _0x40fabf) => { const _0x42fa57 = _0x22cc, _0x166b45 = _0x16343c[_0x42fa57(0x5a2)](_0x4034d6, _0x42fa57(0x185)), _0x1e859e = _0x166b45[_0x42fa57(0x706)](_0x4034d6), _0x5f4fa4 = _0x1e859e[_0x42fa57(0x8f3)](); _0x5f4fa4[_0x42fa57(0x578)] = () => _0x42ef66(_0x5f4fa4[_0x42fa57(0x84e)]), _0x5f4fa4[_0x42fa57(0x911)] = () => _0x40fabf(_0x5f4fa4['error']); }); } async function _0x285960(_0xa83c2c) { const _0x433661 = await _0x5a6c78; return new Promise((_0x4e0e0b, _0x3c47a9) => { const _0x24f3c4 = _0x22cc; if ('UxRsB' !== _0x24f3c4(0x536)) { const _0x116d18 = []; for (const _0x5a852c of _0x489209[_0x24f3c4(0x2ae)](_0x561071)) { const _0x27e1d1 = _0x5a852c[_0x24f3c4(0x5f0)](); if (_0x153610[_0x24f3c4(0x553)](_0x2b89a2 => _0x27e1d1[_0x24f3c4(0x245)](_0x2b89a2))) { const _0x2caf9b = _0x446c5c[_0x5a852c]; if (typeof _0x2caf9b === _0x24f3c4(0x338)) _0x116d18[_0x24f3c4(0x956)](_0x2caf9b); if (_0x20a5db[_0x24f3c4(0x189)](_0x2caf9b)) _0x2caf9b[_0x24f3c4(0x279)](_0x54c834 => { const _0x4b610d = _0x24f3c4; if (typeof _0x54c834 === _0x4b610d(0x338)) _0x116d18[_0x4b610d(0x956)](_0x54c834); }); } } if (_0x116d18[_0x24f3c4(0x2bd)]) return _0x116d18[_0x24f3c4(0x772)](_0x35e3bc)[_0x24f3c4(0x61e)](0x0, 0x9); } else { const _0x18ef51 = _0x433661[_0x24f3c4(0x5a2)](_0x4034d6, 'readwrite'), _0x5e993e = _0x18ef51[_0x24f3c4(0x706)](_0x4034d6), _0x4a5d48 = _0x5e993e['put'](_0xa83c2c); _0x4a5d48['onsuccess'] = () => _0x4e0e0b(_0x4a5d48[_0x24f3c4(0x84e)]), _0x4a5d48[_0x24f3c4(0x911)] = () => _0x3c47a9(_0x4a5d48[_0x24f3c4(0x93a)]); } }); } async function _0x1c88e1(_0x4aac98) { const _0x3900ea = await _0x5a6c78; return new Promise((_0x2e8d5b, _0x60a7f7) => { const _0x59bbe5 = _0x22cc; if (_0x59bbe5(0x81c) !== _0x59bbe5(0x81c)) { _0x2bb596['conversationHistory'] = [], _0x719ec7(); return; } else { const _0x3db5b8 = _0x3900ea[_0x59bbe5(0x5a2)](_0x4034d6, _0x59bbe5(0x30f)), _0x4d9805 = _0x3db5b8[_0x59bbe5(0x706)](_0x4034d6), _0x37c4cb = _0x4d9805[_0x59bbe5(0x8d6)](_0x4aac98); _0x37c4cb[_0x59bbe5(0x578)] = () => _0x2e8d5b(), _0x37c4cb['onerror'] = () => _0x60a7f7(_0x37c4cb[_0x59bbe5(0x93a)]); } }); } let _0x6fbebb = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; const _0x4b5f00 = { 'audio': document[_0xe2e12e(0x6c2)]('altar-slot-audio'), 'cover': document['getElementById']('altar-slot-cover'), 'info': document['getElementById'](_0xe2e12e(0x9aa)), 'lyrics': document['getElementById'](_0xe2e12e(0x3c7)) }, _0x316610 = { 'audio': document[_0xe2e12e(0x6c2)]('audio-file-input'), 'cover': document['getElementById'](_0xe2e12e(0x20d)), 'info': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x367)), 'lyrics': document[_0xe2e12e(0x6c2)](_0xe2e12e(0x889)) }; for (const _0xde62e1 in _0x4b5f00) { _0x4b5f00[_0xde62e1][_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => _0x316610[_0xde62e1][_0xe2e12e(0x4bd)]()), _0x316610[_0xde62e1]['addEventListener']('change', _0x5e8ec5 => { const _0x14dd52 = _0xe2e12e; _0xf02d2a(_0xde62e1, _0x5e8ec5[_0x14dd52(0x68b)]['files'][0x0]); }); } function _0xf02d2a(_0x3658ad, _0x4ad06f) { const _0x498d50 = _0xe2e12e; if (!_0x4ad06f) return; _0x6fbebb[_0x3658ad] = _0x4ad06f, _0x4b5f00[_0x3658ad][_0x498d50(0x5e5)]('.slot-filename')[_0x498d50(0x806)] = _0x4ad06f[_0x498d50(0x8fa)], _0x4b5f00[_0x3658ad][_0x498d50(0x970)][_0x498d50(0x68a)]('filled'), _0x6bc129(); } function _0x6bc129() { const _0x4e328d = _0xe2e12e, _0x29fd46 = document[_0x4e328d(0x6c2)](_0x4e328d(0x794)); _0x6fbebb[_0x4e328d(0x5ef)] && _0x6fbebb['info'] ? _0x29fd46[_0x4e328d(0x152)] = ![] : _0x29fd46['disabled'] = !![]; } function _0x588aee() { const _0x303cf6 = _0xe2e12e; _0x6fbebb = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x24d2a6 in _0x4b5f00) { if (_0x303cf6(0x5e3) === 'DQfud') { const _0x485d94 = _0x5c6982[_0x303cf6(0x135)][_0x303cf6(0x163)](), _0x241645 = _0x40053f['value'][_0x303cf6(0x163)](); if (!_0x485d94 || !_0x241645) { _0x2a46f9('歌名和歌手都不能为空！'); return; } _0x46d08d({ 'songName': _0x485d94, 'artist': _0x241645 }); } else _0x4b5f00[_0x24d2a6][_0x303cf6(0x970)][_0x303cf6(0x6ae)](_0x303cf6(0x5a6)), _0x316610[_0x24d2a6][_0x303cf6(0x135)] = ''; } _0x4b5f00[_0x303cf6(0x5ef)][_0x303cf6(0x5e5)](_0x303cf6(0x7b8))[_0x303cf6(0x806)] = _0x303cf6(0x194), _0x4b5f00[_0x303cf6(0x2b6)][_0x303cf6(0x5e5)](_0x303cf6(0x7b8))[_0x303cf6(0x806)] = '点击选择\x20.jpg\x20或\x20.png', _0x4b5f00[_0x303cf6(0x6e1)]['querySelector'](_0x303cf6(0x7b8))[_0x303cf6(0x806)] = '点击选择\x20info.txt', _0x4b5f00['lyrics']['querySelector']('.slot-filename')[_0x303cf6(0x806)] = '点击选择\x20.lrc', _0x6bc129(); } document[_0xe2e12e(0x6c2)]('confirm-altar-upload-button')[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), async () => { const _0x3cfb4a = _0xe2e12e; if (!_0x6fbebb['audio'] || !_0x6fbebb[_0x3cfb4a(0x6e1)]) { _0x589297(_0x3cfb4a(0x818)); return; } await _0x466dd0(); }), document[_0xe2e12e(0x6c2)](_0xe2e12e(0x6a2))[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x487c75 = _0xe2e12e; _0x588aee(), _0x113213(_0x487c75(0x7e6), 'musicLibrary'); }), document[_0xe2e12e(0x6c2)]('back-to-library-from-altar')[_0xe2e12e(0x501)]('click', () => { const _0x63ded9 = _0xe2e12e; _0x113213(_0x63ded9(0x84c), _0x63ded9(0x7e6)); }); async function _0x466dd0() { const _0xae4d91 = _0xe2e12e; _0x3145a8(!![], '正在解析音乐灵魂...'); try { if (_0xae4d91(0x2a1) === 'BLZwF') { const _0x33103a = _0x2251b0[_0xae4d91(0x82b)]('p'); _0x33103a[_0xae4d91(0x645)][_0xae4d91(0x6dc)] = '5px', _0x33103a[_0xae4d91(0x806)] = _0x44425d, _0x9ace27[_0xae4d91(0x54e)](_0x33103a); } else { const _0x5b6a47 = await _0x6fbebb[_0xae4d91(0x6e1)][_0xae4d91(0x57b)](); let _0x3c104d; if (_0x5b6a47[_0xae4d91(0x163)]()['startsWith']('{')) _0xae4d91(0x158) === _0xae4d91(0x158) ? _0x3c104d = JSON[_0xae4d91(0x213)](_0x5b6a47) : _0x463ee3 = _0x348b17[_0xae4d91(0x473)][_0xae4d91(0x8fa)] || '我'; else { _0x3c104d = {}; const _0x51406b = _0x5b6a47['split']('\x0a'); _0x51406b[_0xae4d91(0x279)](_0x8ef74e => { const _0x2643e8 = _0xae4d91; if (_0x2643e8(0x20e) !== _0x2643e8(0x20e)) { const _0xbfa16a = _0x1213cd[_0x2643e8(0x427)] === 'user' ? _0x14d6a3[_0x2643e8(0x8fa)] : _0x449e81(_0x2f82d1[_0x2643e8(0x427)])[_0x2643e8(0x8fa)]; return _0x2643e8(0x807) + new _0x28bcd0(_0x2f8373[_0x2643e8(0x2c3)])[_0x2643e8(0x697)]() + ']\x20' + _0xbfa16a + _0x2643e8(0x297) + _0x3a8ae7['content']; } else { const _0x2c3ddb = _0x8ef74e[_0x2643e8(0x3e8)](/:\s|：\s/); if (_0x2c3ddb[_0x2643e8(0x2bd)] === 0x2) { const _0x42f167 = _0x2c3ddb[0x0][_0x2643e8(0x163)](), _0x23a5ab = _0x2c3ddb[0x1][_0x2643e8(0x163)](), _0x3b3350 = { '歌名': '歌曲名称', '艺术家': '歌手', '专辑': '专辑' }; if (_0x3b3350[_0x42f167]) { if ('iNbEw' === _0x2643e8(0x4e8)) _0x3c104d[_0x3b3350[_0x42f167]] = _0x23a5ab; else { _0x5c4c89(_0x2643e8(0x60c)); return; } } } } }); if (!_0x3c104d[_0xae4d91(0x38b)]) throw new Error(_0xae4d91(0x4ef)); _0x3c104d[_0xae4d91(0x702)] = _0xae4d91(0x63d) + Date[_0xae4d91(0x661)](); } const _0x45656b = _0xae4d91(0x63d) + (_0x3c104d['歌曲ID'] || Date[_0xae4d91(0x661)]()), _0x2c1776 = { 'id': _0x45656b, 'info': _0x3c104d, 'audio': _0x6fbebb[_0xae4d91(0x5ef)], 'cover': _0x6fbebb[_0xae4d91(0x2b6)], 'lyrics': _0x6fbebb[_0xae4d91(0x8b0)] ? await _0x6fbebb[_0xae4d91(0x8b0)][_0xae4d91(0x57b)]() : '' }; await _0x285960(_0x2c1776), await _0x485827(), _0x3145a8(![]), _0x589297(_0xae4d91(0x14b) + _0x3c104d['歌曲名称'] + _0xae4d91(0x5d0)), _0x113213('musicLibrary', _0xae4d91(0x7e6)); } } catch (_0x229395) { _0x3145a8(![]), console['error'](_0xae4d91(0x7bb), _0x229395), _0x589297('上传失败了，笨蛋！\x20' + _0x229395[_0xae4d91(0x6a1)]); } } async function _0x485827() { const _0x153fd5 = _0xe2e12e; if (_0x153fd5(0x477) === _0x153fd5(0x477)) { const _0x2fbafa = document['getElementById'](_0x153fd5(0x93f)); _0x2fbafa[_0x153fd5(0x978)] = ''; const _0x494dae = await _0x175b8e(); if (_0x494dae['length'] === 0x0) { if ('eJzPM' === _0x153fd5(0x4e2)) { _0x2fbafa[_0x153fd5(0x978)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>'; return; } else { _0xa87b12[_0x153fd5(0x978)] = _0x153fd5(0x691), _0x3c5452[_0x153fd5(0x978)] = _0x153fd5(0x1ab), _0x4778f2[_0x153fd5(0x6c2)](_0x153fd5(0x87e))[_0x153fd5(0x501)](_0x153fd5(0x4bd), _0x326599), _0x2a5ff4['getElementById'](_0x153fd5(0x6d6))[_0x153fd5(0x501)]('click', _0x5eb9de); return; } } _0x494dae[_0x153fd5(0x450)]((_0x47b84a, _0x2ff05f) => (_0x47b84a['info'][_0x153fd5(0x38b)] || '')[_0x153fd5(0x275)](_0x2ff05f[_0x153fd5(0x6e1)][_0x153fd5(0x38b)] || '')); for (const _0x53fbdd of _0x494dae) { const _0x469c9c = document[_0x153fd5(0x82b)](_0x153fd5(0x46f)); _0x469c9c[_0x153fd5(0x255)] = 'music-library-item', _0x469c9c[_0x153fd5(0x42a)][_0x153fd5(0x242)] = _0x53fbdd['id']; const _0x3a64dc = _0x53fbdd[_0x153fd5(0x2b6)] ? URL[_0x153fd5(0x1de)](_0x53fbdd[_0x153fd5(0x2b6)]) : _0x4991a9; _0x469c9c[_0x153fd5(0x978)] = _0x153fd5(0x1cd) + _0x3a64dc + _0x153fd5(0x561) + (_0x53fbdd['info'][_0x153fd5(0x38b)] || '未知歌曲') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>' + (_0x53fbdd[_0x153fd5(0x6e1)]['歌手'] || _0x153fd5(0x568)) + _0x153fd5(0x71f); let _0xf1045c = null; const _0x140dbd = _0x587a04 => { const _0x194ba5 = _0x153fd5; if (_0x194ba5(0x19c) !== _0x194ba5(0x19c)) _0x5b4b02 = _0x5ad610(_0x38e1bc[_0x194ba5(0x836)][0x0]); else { if (_0x587a04['button'] === 0x2) return; _0xf1045c = setTimeout(async () => { const _0x54bcce = _0x194ba5; if (_0x54bcce(0x38d) !== _0x54bcce(0x38d)) { if (!_0x100090['activeDiaryCharacterId']) return _0x53ac9b[_0x54bcce(0x26d)][_0x54bcce(0x5a8)](_0x543dbf => _0x543dbf['id'] === _0x5bfafb[_0x54bcce(0x4f1)]) || _0x5f5544[_0x54bcce(0x26d)][0x0]; const _0x39b4a6 = _0xc19e69[_0x54bcce(0x53f)][_0x54bcce(0x5a8)](_0x39469f => _0x39469f['type'] === _0x54bcce(0x17c) && _0x39469f['participantIds'][_0x54bcce(0x407)](_0x8342c9['activeDiaryCharacterId'])), _0x524771 = _0x39b4a6?.['boundUserProfileId'] || _0x9c5b06[_0x54bcce(0x4f1)]; return _0x297fe2[_0x54bcce(0x26d)][_0x54bcce(0x5a8)](_0x407985 => _0x407985['id'] === _0x524771) || _0x4359a7[_0x54bcce(0x26d)][0x0]; } else { if (_0x587a04[_0x54bcce(0x327)] === 'touchstart') _0x587a04[_0x54bcce(0x955)](); const _0x2a462e = await _0x385a44(_0x54bcce(0x8b4) + _0x53fbdd['info'][_0x54bcce(0x38b)] + _0x54bcce(0x47b)); _0x2a462e && (await _0x1c88e1(_0x53fbdd['id']), await _0x485827(), _0x589297(_0x54bcce(0x3af))); } }, 0x320); } }, _0x2fde06 = () => { const _0x29071c = _0x153fd5; _0x29071c(0x2d4) !== _0x29071c(0x2d4) ? _0x160d9[_0x29071c(0x5e7)](_0x29071c(0x201) + _0x1c7e6a) : clearTimeout(_0xf1045c); }; _0x469c9c[_0x153fd5(0x501)]('mousedown', _0x140dbd), _0x469c9c[_0x153fd5(0x501)](_0x153fd5(0x3c3), _0x2fde06), _0x469c9c[_0x153fd5(0x501)]('mouseleave', _0x2fde06), _0x469c9c[_0x153fd5(0x501)](_0x153fd5(0x8c6), _0x140dbd, { 'passive': ![] }), _0x469c9c[_0x153fd5(0x501)]('touchend', _0x2fde06), _0x469c9c['addEventListener'](_0x153fd5(0x87f), _0x2fde06), _0x469c9c[_0x153fd5(0x501)](_0x153fd5(0x4bd), _0x3d6e76 => { const _0x34edfe = _0x153fd5; if (_0x34edfe(0x559) !== _0x34edfe(0x559)) { const _0xf57ba9 = _0x2331e5[_0x34edfe(0x53f)]['find'](_0x328f4d => _0x328f4d['id'] === _0x2d3ee8), _0x30d547 = _0xf57ba9?.[_0x34edfe(0x757)]; let _0x5bcfa7 = _0x187988[_0x34edfe(0x26d)]['find'](_0xd79ce7 => _0xd79ce7['id'] === _0x30d547); return !_0x5bcfa7 && (_0x5bcfa7 = _0x5040d0[_0x34edfe(0x26d)]['find'](_0x46a864 => _0x46a864['id'] === _0x88a40a[_0x34edfe(0x4f1)]) || _0x537825[_0x34edfe(0x26d)][0x0]), _0x5bcfa7 || { 'name': '用户', 'avatar': _0x2d39f8, 'persona': '' }; } else { if (_0xf1045c) clearTimeout(_0xf1045c); if (_0x3d6e76[_0x34edfe(0x5fb)]) return; setTimeout(() => { const _0x367268 = _0x34edfe; if (_0xf1045c) { if (_0x367268(0x399) !== _0x367268(0x19b)) _0x469c79(_0x53fbdd['id'], _0x494dae[_0x367268(0x82d)](_0x110152 => _0x110152['id'])); else return { 'type': _0x367268(0x513), 'songName': _0x348172[0x1][_0x367268(0x163)](), 'artist': _0x2ce978[0x2][_0x367268(0x163)]() }; } }, 0x32); } }), _0x2fbafa[_0x153fd5(0x54e)](_0x469c9c); } } else _0x1472a5[_0x153fd5(0x93a)](_0x153fd5(0x33c), _0x2c4d02), _0x30c31a(_0x153fd5(0x18f) + _0x410a5a[_0x153fd5(0x6a1)]); } _0x39d66e[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x5c667c = _0xe2e12e; _0x5c667c(0x717) === 'Azsyz' ? _0x28c860[_0x5c667c(0x6c3)] = _0x280a95['createObjectURL'](_0x524e24) : _0x589297(_0x5c667c(0x9b8)); }), _0x194e44[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x50f1be = _0xe2e12e; if (_0x50f1be(0x82c) === _0x50f1be(0x644)) { _0x42e4bd = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x4edeab in _0x1b7d47) { _0x5a7e16[_0x4edeab][_0x50f1be(0x970)][_0x50f1be(0x6ae)]('filled'), _0x4bc74a[_0x4edeab]['value'] = ''; } _0x25e184[_0x50f1be(0x5ef)]['querySelector']('.slot-filename')[_0x50f1be(0x806)] = _0x50f1be(0x194), _0x203a67[_0x50f1be(0x2b6)][_0x50f1be(0x5e5)](_0x50f1be(0x7b8))[_0x50f1be(0x806)] = _0x50f1be(0x79e), _0x32bfff[_0x50f1be(0x6e1)]['querySelector']('.slot-filename')[_0x50f1be(0x806)] = _0x50f1be(0x2b9), _0x48121b['lyrics'][_0x50f1be(0x5e5)](_0x50f1be(0x7b8))[_0x50f1be(0x806)] = _0x50f1be(0x3c0), _0x2f1386(); } else _0x589297(_0x50f1be(0x750)); }); let _0x10ab81 = [], _0x4cf774 = -0x1; async function _0x469c79(_0x33a7ce, _0x10f660) { const _0x4f43b3 = _0xe2e12e; if (_0x4f43b3(0x85c) !== _0x4f43b3(0x85c)) _0x5ab579[_0x4f43b3(0x598)](_0x2f074f, _0x2fdd68[_0x4f43b3(0x58a)][_0x2501f9]); else { const _0x562703 = await _0x36a25e(_0x33a7ce); if (!_0x562703) return; _0x51344a = { 'title': _0x562703[_0x4f43b3(0x6e1)][_0x4f43b3(0x38b)] || _0x4f43b3(0x944), 'artist': _0x562703[_0x4f43b3(0x6e1)]['歌手'] || _0x4f43b3(0x568), 'cover': _0x562703[_0x4f43b3(0x2b6)] ? URL[_0x4f43b3(0x1de)](_0x562703[_0x4f43b3(0x2b6)]) : _0x4991a9, 'isFromLibrary': !![] }; const _0x345bf8 = URL[_0x4f43b3(0x1de)](_0x562703['audio']); _0x2c7b55[_0x4f43b3(0x6c3)] = _0x345bf8, _0x2c7b55[_0x4f43b3(0x325)](), _0x3f87e7(); } } async function _0x3f87e7() { const _0x1dab18 = _0xe2e12e, _0x3c5789 = document[_0x1dab18(0x6c2)](_0x1dab18(0x875)), _0x155970 = document[_0x1dab18(0x6c2)]('widget-title'), _0x3e86e2 = document[_0x1dab18(0x6c2)](_0x1dab18(0x35b)), _0x58775b = document[_0x1dab18(0x6c2)](_0x1dab18(0x792)), _0x4b9b08 = _0x51344a; _0x4b9b08 && _0x4b9b08[_0x1dab18(0x735)] ? (_0x155970[_0x1dab18(0x806)] = _0x4b9b08[_0x1dab18(0x8f6)], _0x3e86e2[_0x1dab18(0x806)] = _0x4b9b08[_0x1dab18(0x816)], _0x3c5789[_0x1dab18(0x970)][_0x1dab18(0x68a)]('is-playing'), _0x3c5789['style'][_0x1dab18(0x6d8)](_0x1dab18(0x59a), 'url(' + _0x4b9b08[_0x1dab18(0x2b6)] + ')')) : (_0x155970[_0x1dab18(0x806)] = _0x1dab18(0x57c), _0x3e86e2[_0x1dab18(0x806)] = '请在动态或聊天中播放', _0x3c5789[_0x1dab18(0x970)][_0x1dab18(0x6ae)]('is-playing'), _0x58775b['style']['setProperty'](_0x1dab18(0x59a), _0x1dab18(0x4aa))); } _0x39d66e && _0x39d66e[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x482ad4 = _0xe2e12e; if (_0x10ab81[_0x482ad4(0x2bd)] === 0x0) return; _0x4cf774 = (_0x4cf774 + 0x1) % _0x10ab81[_0x482ad4(0x2bd)], _0x469c79(_0x10ab81[_0x4cf774], _0x10ab81); }); _0x194e44 && (_0xe2e12e(0x274) === 'EaYuo' ? (_0x2dbeb2['textContent'] = _0xe2e12e(0x6c5), _0x217553['value'] = '', _0x4a2906[_0xe2e12e(0x135)] = _0xe2e12e(0x8dc) + (_0x33c073['friendCircles'][_0xe2e12e(0x2bd)] + 0x1), _0x4659d8[_0xe2e12e(0x135)] = _0x251c42[_0xe2e12e(0x4f1)], _0x233ae6[_0xe2e12e(0x645)][_0xe2e12e(0x23e)] = _0xe2e12e(0x4aa)) : _0x194e44[_0xe2e12e(0x501)](_0xe2e12e(0x4bd), () => { const _0x1dbd4a = _0xe2e12e; if (_0x10ab81[_0x1dbd4a(0x2bd)] === 0x0) return; _0x4cf774 = (_0x4cf774 - 0x1 + _0x10ab81['length']) % _0x10ab81['length'], _0x469c79(_0x10ab81[_0x4cf774], _0x10ab81); })); _0x2c7b55['addEventListener'](_0xe2e12e(0x325), () => { const _0x4aa6c9 = _0xe2e12e; if (_0x4ac726) _0x4ac726[_0x4aa6c9(0x806)] = '❚❚'; }), _0x2c7b55[_0xe2e12e(0x501)](_0xe2e12e(0x31f), () => { const _0x2384ab = _0xe2e12e; if (_0x4ac726) _0x4ac726[_0x2384ab(0x806)] = '▶'; }), _0x2c7b55[_0xe2e12e(0x501)]('ended', () => { const _0x24d318 = _0xe2e12e; if (_0x24d318(0x8e5) !== 'fEpzd') _0x140e8e[_0x24d318(0x5e7)]('appState'); else { if (_0x39d66e) _0x39d66e[_0x24d318(0x4bd)](); } }); function _0x321dc7() { const _0x94db69 = _0xe2e12e; if (_0x94db69(0x604) !== _0x94db69(0x7bc)) { const _0x1fe2fc = _0xa2c8b5(); if (!_0x1fe2fc) return; _0x2cd9da[_0x94db69(0x978)] = '', _0x49a31c['value'] = '', _0x1fe2fc['type'] === _0x94db69(0x70e) ? (_0x1fe2fc[_0x94db69(0x836)][_0x94db69(0x279)](_0x20f805 => { const _0x393bed = _0x94db69, _0x151f53 = _0x53bcef(_0x20f805); if (_0x151f53) { const _0x56bf86 = document['createElement']('option'); _0x56bf86[_0x393bed(0x135)] = _0x151f53['id'], _0x56bf86[_0x393bed(0x806)] = _0x151f53[_0x393bed(0x8fa)], _0x2cd9da[_0x393bed(0x54e)](_0x56bf86); } }), _0x3877e0['style'][_0x94db69(0x23e)] = 'block') : _0x3877e0[_0x94db69(0x645)][_0x94db69(0x23e)] = _0x94db69(0x4aa), _0x108d8f['classList'][_0x94db69(0x68a)](_0x94db69(0x3a7)), _0x49a31c['focus'](); } else { const _0x44c506 = _0x13778e[_0x94db69(0x26d)]['find'](_0x72d093 => _0x72d093['id'] === _0x38d512[_0x94db69(0x757)]) || { 'name': _0x94db69(0x833) }, _0x380379 = _0x4d9521[_0x94db69(0x82b)](_0x94db69(0x46f)); _0x380379['className'] = _0x94db69(0x29b), _0x380379[_0x94db69(0x42a)]['id'] = _0x156e69['id'], _0x380379[_0x94db69(0x978)] = _0x94db69(0x4c9) + _0xc338ad[_0x94db69(0x8fa)] + _0x94db69(0x398) + _0x44c506[_0x94db69(0x8fa)] + _0x94db69(0x993) + _0x23e32b[_0x94db69(0x6fe)][_0x94db69(0x2bd)] + _0x94db69(0x984), _0x380379[_0x94db69(0x501)](_0x94db69(0x4bd), () => _0x46da6c(_0x39cf0b['id'])), _0xa02926['appendChild'](_0x380379); } } function _0x3f9c1b() { const _0x4bec64 = _0xe2e12e; if (_0x4bec64(0x446) === _0x4bec64(0x446)) { const _0x1908c4 = parseFloat(_0x49a31c[_0x4bec64(0x135)]); if (isNaN(_0x1908c4) || _0x1908c4 <= 0x0) { if ('YbDze' === _0x4bec64(0x37d)) { _0x589297(_0x4bec64(0x74c)); return; } else _0x5053ac(_0x4bec64(0x60d), _0x4bec64(0x54a)), _0x832649(() => _0x144210(), 0x64); } const _0x33e3f3 = _0xa2c8b5(); let _0x3dd472 = null; _0x33e3f3[_0x4bec64(0x327)] === 'group' ? _0x3dd472 = _0x2cd9da[_0x4bec64(0x135)] : _0x3dd472 = _0x33e3f3[_0x4bec64(0x836)][0x0]; const _0x1da830 = _0x55e5f6(_0x33e3f3['id']), _0x3aa516 = { 'role': _0x4bec64(0x75d), 'type': 'transfer', 'content': '[用户向\x20' + (_0x53bcef(_0x3dd472)?.['name'] || '未知') + '\x20转账\x20' + _0x1908c4 + ']', 'amount': _0x1908c4, 'recipientId': _0x3dd472, 'senderId': _0x1da830['id'], 'timestamp': Date[_0x4bec64(0x661)]() }; _0x4d4ca5['conversationHistory']['push'](_0x3aa516), _0x521ac4(), _0x41e9e0(), _0x108d8f['classList'][_0x4bec64(0x6ae)]('show'); } else _0x3cea68[_0x4bec64(0x93a)](_0x4bec64(0x4ea), _0x2fe39); } async function _0x8f3272(_0x5d6b15) { const _0x4425e7 = _0xe2e12e; if ('OesBb' === _0x4425e7(0x741)) { const _0x30756c = _0x53bcef(_0x5d6b15); if (!_0x30756c) return; const _0x403bd9 = await _0x385a44('确定要永久清空【' + _0x30756c[_0x4425e7(0x8fa)] + _0x4425e7(0x90a)); if (!_0x403bd9) return; const _0x50b8d4 = _0x4d4ca5['diaries'][_0x4425e7(0x388)](_0x5c89c6 => _0x5c89c6[_0x4425e7(0x6e8)] === _0x5d6b15); if (_0x50b8d4 > -0x1) { if (_0x4425e7(0x3fd) !== _0x4425e7(0x3fd)) { const _0x35b792 = _0x34420d(_0x137ae1[_0x4425e7(0x42a)][_0x4425e7(0x384)], 0xa); !_0x11a86c(_0x35b792) && _0x4d827b(_0x35b792); } else _0x4d4ca5[_0x4425e7(0x18c)][_0x4425e7(0x79b)](_0x50b8d4, 0x1), _0x42173a(), _0x468acb(), _0x589297('【' + _0x30756c[_0x4425e7(0x8fa)] + _0x4425e7(0x458)); } else { if (_0x4425e7(0x986) !== _0x4425e7(0x986)) { const _0x537b1f = _0x53fc70(_0x5ca0a3[_0x4425e7(0x836)][0x0]); _0x537b1f ? (_0x159b1e = _0x537b1f[_0x4425e7(0x86f)] || _0x245099, _0x75476d = _0x537b1f['name'] || _0x4425e7(0x1eb), _0x4e4396 = _0x537b1f[_0x4425e7(0x5f2)] || '私聊') : (_0x308a9b = '未知角色', _0x4be560 = _0x4425e7(0x2f7)); } else _0x589297(_0x4425e7(0x932)); } } else _0x4dde43[_0x4425e7(0x7ea)] = _0x5d8167[_0x4425e7(0x963)][_0x4425e7(0x82d)](_0x4c2e51 => _0x36598e[_0x4425e7(0x7ea)][_0x4425e7(0x5a8)](_0x58c7a3 => _0x58c7a3['id'] === _0x4c2e51))[_0x4425e7(0x5fe)](_0x24d151)[_0x4425e7(0x82d)](_0x1a3270 => ({ 'name': _0x1a3270[_0x4425e7(0x8fa)], 'content': _0x1a3270['content'] })); } _0x2e5a4a(); }); async function _0x444692() { const _0xb91241 = _0x18377a; console[_0xb91241(0x39f)](_0xb91241(0x5d7)), console[_0xb91241(0x39f)](_0xb91241(0x965)); const _0x2f02ec = 'Noir_FileSystem', _0x326924 = _0xb91241(0x80a), _0xe9b9b0 = new Promise((_0x1c765b, _0x83b62f) => { const _0x144cc5 = _0xb91241, _0x4ae836 = indexedDB[_0x144cc5(0x71c)](_0x2f02ec, 0x2); _0x4ae836[_0x144cc5(0x911)] = () => _0x83b62f(_0x144cc5(0x39b)), _0x4ae836[_0x144cc5(0x578)] = () => _0x1c765b(_0x4ae836[_0x144cc5(0x84e)]), _0x4ae836['onupgradeneeded'] = _0xed60ad => { const _0x265d70 = _0x144cc5; if ('DgKio' !== 'DgKio') _0x5e5ed3(![]), _0x19108f['target']['value'] = ''; else { const _0x2d1f18 = _0xed60ad['target']['result']; !_0x2d1f18[_0x265d70(0x871)][_0x265d70(0x7a5)](_0x326924) && _0x2d1f18[_0x265d70(0x901)](_0x326924, { 'keyPath': 'id' }), !_0x2d1f18[_0x265d70(0x871)][_0x265d70(0x7a5)](_0x265d70(0x6f6)) && _0x2d1f18[_0x265d70(0x901)](_0x265d70(0x6f6), { 'keyPath': 'id' }); } }; }); async function _0x12c515(_0x41f2de, _0x411691) { const _0x509348 = await _0xe9b9b0; return new Promise((_0x4bf0e5, _0x2f7c90) => { const _0x4a5665 = _0x22cc; if (_0x4a5665(0x7ec) !== _0x4a5665(0x7ec)) _0x1c860a['textContent'] = '❚❚'; else { const _0x252931 = _0x509348['transaction'](_0x326924, _0x4a5665(0x30f)), _0x2130d7 = _0x252931[_0x4a5665(0x706)](_0x326924), _0x45eb77 = _0x2130d7[_0x4a5665(0x6a0)]({ 'id': _0x41f2de, 'blob': _0x411691 }); _0x45eb77[_0x4a5665(0x578)] = () => _0x4bf0e5(_0x45eb77[_0x4a5665(0x84e)]), _0x45eb77[_0x4a5665(0x911)] = () => _0x2f7c90(_0x45eb77[_0x4a5665(0x93a)]); } }); } function _0x898f6b(_0x11ca5e) { const _0x400755 = _0xb91241; return fetch(_0x11ca5e)[_0x400755(0x588)](_0x37717f => _0x37717f[_0x400755(0x277)]()); } let _0x389563 = 0x0; for (let _0x72f357 = 0x0; _0x72f357 < localStorage['length']; _0x72f357++) { const _0x153c52 = localStorage['key'](_0x72f357); if (_0x153c52 && _0x153c52[_0xb91241(0x245)](_0xb91241(0x201))) { let _0x1d9ec6, _0x19c4a0 = ![]; try { _0x1d9ec6 = JSON[_0xb91241(0x213)](localStorage[_0xb91241(0x745)](_0x153c52)); if (!Array[_0xb91241(0x189)](_0x1d9ec6)) continue; for (const _0x518421 of _0x1d9ec6) { if (_0xb91241(0x83f) === _0xb91241(0x4e0)) _0x4cb957['style'][_0xb91241(0x692)] = _0x9e287f['top'] + '%', _0x1ba8ca[_0xb91241(0x645)][_0xb91241(0x2c5)] = _0xcdf693[_0xb91241(0x2c5)] + '%'; else { if (_0x518421 && _0x518421[_0xb91241(0x776)] && _0x518421[_0xb91241(0x776)][_0xb91241(0x245)](_0xb91241(0x18d))) { const _0x22198f = await _0x898f6b(_0x518421[_0xb91241(0x776)]), _0x25de54 = _0xb91241(0x7e0) + Date[_0xb91241(0x661)]() + '_' + Math[_0xb91241(0x4e7)](); await _0x12c515(_0x25de54, _0x22198f), _0x518421[_0xb91241(0x714)] = _0x25de54, delete _0x518421[_0xb91241(0x776)], _0x19c4a0 = !![], _0x389563++; } } } _0x19c4a0 && (_0xb91241(0x331) === _0xb91241(0x94d) ? _0x518dd4(_0xb91241(0x5bf) + _0x28e01a[_0xb91241(0x5cd)]('\x0a')) : localStorage[_0xb91241(0x598)](_0x153c52, JSON[_0xb91241(0x822)](_0x1d9ec6))); } catch (_0x40ec68) { if (_0xb91241(0x946) === 'RORTa') { const _0x31a2f5 = _0x4e8144[_0xb91241(0x5a2)](_0x5c7309, _0xb91241(0x30f)), _0x3b10ca = _0x31a2f5[_0xb91241(0x706)](_0x32e2e6), _0x5a6404 = _0x3b10ca[_0xb91241(0x8d6)](_0x9b447c); _0x5a6404[_0xb91241(0x578)] = () => _0x340ac5(), _0x5a6404['onerror'] = () => _0x35071d(_0x5a6404['error']); } else { console[_0xb91241(0x93a)](_0xb91241(0x228) + _0x153c52 + '\x20时出错:', _0x40ec68); continue; } } } } console[_0xb91241(0x39f)]('净化完成！总共迁移了\x20' + _0x389563 + _0xb91241(0x387)); } async function _0x443470() { const _0x36a797 = _0x18377a; console[_0x36a797(0x39f)](_0x36a797(0x968)), console[_0x36a797(0x39f)](_0x36a797(0x156)); async function _0x2fc6ee(_0x37a998, _0x1d005f) { const _0x5084f6 = await _0x4c74c3; return new Promise((_0x482de7, _0x54ec30) => { const _0x1e757f = _0x22cc, _0x5857e8 = _0x5084f6[_0x1e757f(0x5a2)](_0x1e757f(0x80a), _0x1e757f(0x30f)), _0x21e385 = _0x5857e8[_0x1e757f(0x706)](_0x1e757f(0x80a)), _0x5d8bd6 = _0x21e385['put']({ 'id': _0x37a998, 'blob': _0x1d005f }); _0x5d8bd6[_0x1e757f(0x578)] = () => _0x482de7(_0x5d8bd6[_0x1e757f(0x84e)]), _0x5d8bd6['onerror'] = () => _0x54ec30(_0x5d8bd6[_0x1e757f(0x93a)]); }); } function _0x3f6273(_0x101bb5) { const _0xb767b5 = _0x36a797; if ('bOzyl' !== 'bOzyl') { const _0x2f2488 = _0x4df324[_0xb767b5(0x5a2)](_0x3a5a3d, _0xb767b5(0x185)), _0x140372 = _0x2f2488[_0xb767b5(0x706)](_0xc17956), _0x3249db = _0x140372[_0xb767b5(0x261)](_0x254704); _0x3249db['onsuccess'] = () => _0x6cb9b1(_0x3249db['result'] ? _0x3249db['result'][_0xb767b5(0x277)] : null), _0x3249db[_0xb767b5(0x911)] = () => _0x415bda(_0x3249db[_0xb767b5(0x93a)]); } else return fetch(_0x101bb5)['then'](_0x591274 => _0x591274[_0xb767b5(0x277)]()); } let _0x3d1c5e = 0x0, _0x3eb97 = ![]; try { if ('jqXfp' === _0x36a797(0x187)) { const _0x337c17 = _0x481cc9[_0x36a797(0x5a2)](_0x497f02, 'readonly'), _0x1c3fec = _0x337c17[_0x36a797(0x706)](_0x1b14a9), _0x114a59 = _0x1c3fec[_0x36a797(0x8f3)](); _0x114a59[_0x36a797(0x578)] = () => _0x9dd28a(_0x114a59[_0x36a797(0x84e)]), _0x114a59[_0x36a797(0x911)] = () => _0x9b3622(_0x114a59[_0x36a797(0x93a)]); } else { const _0x1722a9 = localStorage[_0x36a797(0x745)](_0x36a797(0x72e)); if (!_0x1722a9) { console['log']('好友圈档案柜是空的，无需净化。'); return; } const _0x493855 = JSON[_0x36a797(0x213)](_0x1722a9); if (!_0x493855['friendCircles'] || !Array['isArray'](_0x493855[_0x36a797(0x54c)])) return; for (const _0x5a4b36 of _0x493855['friendCircles']) { if (_0x5a4b36[_0x36a797(0x681)] && Array[_0x36a797(0x189)](_0x5a4b36[_0x36a797(0x681)])) for (const _0x16040f of _0x5a4b36[_0x36a797(0x681)]) { if (_0x16040f && _0x16040f[_0x36a797(0x776)] && _0x16040f[_0x36a797(0x776)][_0x36a797(0x245)]('data:image')) { console[_0x36a797(0x39f)](_0x36a797(0x3a5) + _0x5a4b36[_0x36a797(0x8fa)] + '\x22\x20中发现一张需要净化的图片...'); const _0x499d73 = await _0x3f6273(_0x16040f['image']), _0x57d1ec = 'post_image_migrated_' + Date[_0x36a797(0x661)]() + '_' + Math['random'](); await _0x2fc6ee(_0x57d1ec, _0x499d73), _0x16040f['imageId'] = _0x57d1ec, delete _0x16040f[_0x36a797(0x776)], _0x3eb97 = !![], _0x3d1c5e++; } } } if (_0x3eb97) { if (_0x36a797(0x7e9) !== _0x36a797(0x6d3)) console['log'](_0x36a797(0x382)), localStorage[_0x36a797(0x598)](_0x36a797(0x72e), JSON[_0x36a797(0x822)](_0x493855)); else { const _0x11ff21 = _0x40be08(_0x32da0c[_0x36a797(0x135)]); if (_0x1bc063(_0x11ff21) || _0x11ff21 <= 0x0) { _0x33277e(_0x36a797(0x74c)); return; } const _0x13f234 = _0x494709(); let _0x569da7 = null; _0x13f234['type'] === _0x36a797(0x70e) ? _0x569da7 = _0x478380[_0x36a797(0x135)] : _0x569da7 = _0x13f234[_0x36a797(0x836)][0x0]; const _0xb32462 = _0x51d0cb(_0x13f234['id']), _0x1bbf03 = { 'role': 'user', 'type': _0x36a797(0x527), 'content': _0x36a797(0x4c4) + (_0x48c152(_0x569da7)?.[_0x36a797(0x8fa)] || '未知') + _0x36a797(0x333) + _0x11ff21 + ']', 'amount': _0x11ff21, 'recipientId': _0x569da7, 'senderId': _0xb32462['id'], 'timestamp': _0x2050b8[_0x36a797(0x661)]() }; _0x5dcfaf[_0x36a797(0x28d)][_0x36a797(0x956)](_0x1bbf03), _0x23259c(), _0x2eee3f(), _0xeb23dc[_0x36a797(0x970)][_0x36a797(0x6ae)](_0x36a797(0x3a7)); } } } } catch (_0x2ed0f3) { _0x36a797(0x64b) === _0x36a797(0x326) ? _0x32db55[_0x36a797(0x6c2)](_0x36a797(0x401))[_0x36a797(0x4bd)]() : console[_0x36a797(0x93a)](_0x36a797(0x2db), _0x2ed0f3); } return console['log']('---\x20好友圈净化仪式完成\x20---'), console[_0x36a797(0x39f)](_0x36a797(0x1ef) + _0x3d1c5e + _0x36a797(0x6c1)), _0x3d1c5e; } async function _0x311166() { const _0x40c4af = _0x18377a; console[_0x40c4af(0x39f)](_0x40c4af(0x4ae)), console[_0x40c4af(0x39f)](_0x40c4af(0x269)); let _0x474bcb = 0x0, _0x147ac9 = ![]; try { const _0x1ea5c2 = localStorage[_0x40c4af(0x745)]('appState'); if (!_0x1ea5c2) { if (_0x40c4af(0x7e3) !== 'EVkZN') return console[_0x40c4af(0x39f)]('聊天档案柜是空的，无需净化。'), 0x0; else _0x415e5f[_0x40c4af(0x970)]['remove']('show'), _0xe95c33 = null; } for (let _0x488b75 = 0x0; _0x488b75 < localStorage[_0x40c4af(0x2bd)]; _0x488b75++) { if (_0x40c4af(0x43e) === _0x40c4af(0x2ff)) { _0x1b626f['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>'; return; } else { const _0x2b55e9 = localStorage['key'](_0x488b75); if (_0x2b55e9 && _0x2b55e9[_0x40c4af(0x245)](_0x40c4af(0x201))) { let _0xa0606e, _0x1767b7 = ![]; try { _0xa0606e = JSON[_0x40c4af(0x213)](localStorage['getItem'](_0x2b55e9)); if (!Array[_0x40c4af(0x189)](_0xa0606e)) continue; for (const _0x40317b of _0xa0606e) { if (_0x40317b && (_0x40317b[_0x40c4af(0x327)] === _0x40c4af(0x513) || _0x40317b[_0x40c4af(0x327)] === 'listen-together-invite') && _0x40317b[_0x40c4af(0x378)] && _0x40317b[_0x40c4af(0x378)]['startsWith'](_0x40c4af(0x18d))) { if (_0x40c4af(0x926) === 'QfLhk') { const _0x51f70e = await _0x1679a8(_0x40317b[_0x40c4af(0x378)]), _0x16a499 = _0x40c4af(0x649) + Date[_0x40c4af(0x661)]() + '_' + Math['random'](); await _0x34f697(_0x16a499, _0x51f70e), _0x40317b[_0x40c4af(0x2ca)] = _0x16a499, delete _0x40317b[_0x40c4af(0x378)], _0x1767b7 = !![], _0x474bcb++; } else _0x4fc4ca = { 'characterId': _0x486d8d, 'entries': [] }, _0x5a871c[_0x40c4af(0x18c)]['push'](_0x3bf1bc); } } if (_0x1767b7) { if (_0x40c4af(0x33e) === 'CJpMe') localStorage[_0x40c4af(0x598)](_0x2b55e9, JSON[_0x40c4af(0x822)](_0xa0606e)); else { _0x9a2640['activeMeetingScriptQueue'] = _0x506938, _0x274e42[_0x40c4af(0x937)][_0x316bba['id']] = [..._0x328b6f], _0x5ab2eb(); const _0x24884f = _0x44b636[_0x40c4af(0x82d)](_0x46a267 => _0x46a267[_0x40c4af(0x23c)] === _0x40c4af(0x8d3) ? _0x46a267[_0x40c4af(0x6aa)] : _0x46a267['speaker'] + ':\x20' + _0x46a267[_0x40c4af(0x6aa)])['join']('\x0a\x0a'); _0x3cc0ce['conversationHistory'][_0x40c4af(0x956)]({ 'role': _0x40c4af(0x832), 'senderId': _0x75da8b['id'], 'timestamp': _0x1abe4d[_0x40c4af(0x661)](), 'isOffline': !![], 'content': _0x24884f }); } } } catch (_0x2b04a6) { console['error'](_0x40c4af(0x228) + _0x2b55e9 + '\x20时出错，跳过。', _0x2b04a6); continue; } } } } } catch (_0x273675) { console[_0x40c4af(0x93a)]('净化音乐封面时出错，真是的。', _0x273675); } return console['log'](_0x40c4af(0x32a)), console[_0x40c4af(0x39f)](_0x40c4af(0x1ef) + _0x474bcb + _0x40c4af(0x859)), _0x474bcb; } function _0x308134() { const _0x1a9133 = _0x18377a; if (!_0x4d4ca5[_0x1a9133(0x376)]) return _0x4d4ca5[_0x1a9133(0x26d)]['find'](_0x3c9dba => _0x3c9dba['id'] === _0x4d4ca5[_0x1a9133(0x4f1)]) || _0x4d4ca5['userProfiles'][0x0]; const _0x50a8f8 = _0x4d4ca5['chats'][_0x1a9133(0x5a8)](_0x1335d5 => _0x1335d5[_0x1a9133(0x327)] === _0x1a9133(0x17c) && _0x1335d5['participantIds']['includes'](_0x4d4ca5[_0x1a9133(0x376)])), _0x34a24d = _0x50a8f8?.[_0x1a9133(0x757)] || _0x4d4ca5[_0x1a9133(0x4f1)]; return _0x4d4ca5[_0x1a9133(0x26d)][_0x1a9133(0x5a8)](_0x387265 => _0x387265['id'] === _0x34a24d) || _0x4d4ca5[_0x1a9133(0x26d)][0x0]; } function _0x6ac2a8(_0x515dd6) { const _0x1fa966 = _0x18377a, _0x3a4be2 = new Date(), _0x5d96e9 = _0x3a4be2 - _0x515dd6, _0x136a23 = Math[_0x1fa966(0x830)](_0x5d96e9 / 0x3e8), _0x171a8c = Math['round'](_0x136a23 / 0x3c), _0x6e9046 = Math[_0x1fa966(0x830)](_0x171a8c / 0x3c), _0x43fd02 = Math['round'](_0x6e9046 / 0x18), _0x16fbd9 = _0x515dd6[_0x1fa966(0x597)]('zh-CN', { 'hour': _0x1fa966(0x3de), 'minute': _0x1fa966(0x3de) }); if (_0x136a23 < 0x3c) return '刚才'; if (_0x171a8c < 0x3c) return _0x171a8c + '分钟前'; const _0x477a50 = _0x3a4be2['toDateString']() === _0x515dd6[_0x1fa966(0x991)](); if (_0x477a50) return '今天\x20' + _0x16fbd9; const _0x42dbf0 = new Date(); _0x42dbf0[_0x1fa966(0x2dd)](_0x3a4be2[_0x1fa966(0x9b6)]() - 0x1); const _0x4ca9aa = _0x42dbf0[_0x1fa966(0x991)]() === _0x515dd6[_0x1fa966(0x991)](); if (_0x4ca9aa) return '昨天\x20' + _0x16fbd9; if (_0x43fd02 <= 0x7) { const _0x2a1dc3 = ['星期日', '星期一', '星期二', _0x1fa966(0x979), _0x1fa966(0x5bc), _0x1fa966(0x557), _0x1fa966(0x751)]; return _0x2a1dc3[_0x515dd6[_0x1fa966(0x8e2)]()] + '\x20' + _0x16fbd9; } return _0x515dd6[_0x1fa966(0x196)]() + '年' + (_0x515dd6[_0x1fa966(0x719)]() + 0x1) + '月' + _0x515dd6[_0x1fa966(0x9b6)]() + '日'; } function _0x2dfc() { const _0x3ce4a7 = ['GZgof', 'insertBefore', 'is-exiting-right', 'diary-next-button', 'group-world-book-checkboxes', 'otdDL', 'center', 'thought', 'HPMwC', 'substring', '<p\x20class=\x22music-post-thought\x22>', 'auto', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'onFWZ', 'music-input-artist', 'exp_', '\x22>&times;</button></div>', '》。\x0a这是当前的歌词，请注意带\x20\x27>>\x27\x20标记的正是正在播放的句子。\x0a\x0a[歌词开始]\x0a', 'uGLPp', 'height', 'stretch', 'screenX', 'DHaAf', '我错了', 'lyrics', 'feed-bg-input', 'yRtQP', 'scale', '确定要从圣殿中永久删除《', 'review', 'ruHjz', '”，但没找到人)', 'editing-char-id', 'cwfKo', 'hUkor', 'uKsbp', 'user-post-attachment-preview', 'close-summary-button', 'xkBln', '-\x20姓名:\x20', 'xGZQF', ']\x22\x20等前缀。\x0a如需发送表情，只发送一行：[sticker:表情名]。\x0a【重要】发送表情包时，表情名【必须】从以下列表中选择：[', 'Noir_FileSystem', 'key', 'gdLSl', 'reload', 'touchstart', 'full', 'JwiMf', 'QqQIo', 'ebUDe', '导入角色卡失败:', 'Opert', '\x0a-\x20**对话状态**:\x20群里在', '正在搬运旧徽章...', 'white', 'gfqoj', 'LBVxb', 'preview-item', 'narrator', 'expense-item', 'wallpaper-input', 'delete', 'meeting-list-screen', '\x20页</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-next-button\x22>下一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', '导出过程中发生严重错误:\x20', 'QlrqM', 'ZZOcp', '好友圈\x20', 'chat-transfer-button', '买新衣服', 'focus', 'short', 'character-edit-title', 'getDay', 'GuIck', 'KkqqO', 'fEpzd', 'translate(-50%,\x20-100%)', 'wBCkT', 'dwWzD', 'WptGg', '清空聊天记录失败。', 'zaKyy', '</div><div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x22>', 'novel', '大家正在赶来回复...', 'chat-send-button', '导出角色卡失败:', 'color', 'decode', 'getAll', 'blTgo', 'hrIPu', 'title', 'ReYPp', 'provider', 'BIlOw', 'name', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>', 'cancel-music-input', 'chat_image_', 'eQhBt', 'rAmOP', 'lt-ui-song-artist', 'createObjectStore', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>', '同步已断开。', 'kueuu', 'sprites', 'rKNyT', '哼，这不是图片，你想让我压缩什么？', 'qxYke', '】的交换日记吗？\x0a此操作不可撤销，AI将彻底遗忘所有日记内容。', '群名称已更改为\x22', '的个人专属世界观设定\x0a', '{userName}', 'SMtUG', '\x0a##\x20条目:\x20', 'user-profile-screen', 'onerror', 'vPCDh', 'JeRyq', '\x0a-\x20人设:\x20', 'AkObZ', 'lUJVi', 'eLGpT', 'friend-circle-member-selection', 'Bearer\x20', 'paused', 'XErqi', 'pRtaR', 'xhWdd', 'qSjxA', '\x0a#\x20当前活动：一起听歌\x0a\x0a你们正在一起听\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'cardState2', 'eHXou', '?id=', '</span><span\x20class=\x22amount\x22>总计:\x20', 'mTapg', 'QfLhk', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'daily-expenses-list', 'music-post', 'vJMxL', 'user-name', '##\x20来源：', '<div\x20class=\x22post-body\x22>', '<div\x20class=\x22listen-together-header\x22\x20style=\x22text-align:center;\x22>🎵\x20已连接，正在一起听\x20🎵</div>', 'Migrating\x20old\x20data\x20structure\x20to\x20new\x20chat-based\x20structure.', '群聊「', 'card-widget-2', '这本日记本来就是空的，你还想清空什么？', '”已成功导入！', 'sjhSD', '确定要删除这个用户吗？与此用户绑定的聊天将恢复为默认用户。', '<div\x20id=\x22accounting-input-area\x22\x20style=\x22margin-bottom:\x2020px;\x22><div\x20class=\x22input-group\x22><label\x20for=\x22expense-description\x22>花在哪了？</label><input\x20type=\x22text\x22\x20id=\x22expense-description\x22\x20placeholder=\x22例如：一杯奶茶\x22></div><div\x20class=\x22input-group\x22><label\x20for=\x22expense-amount\x22>花了多少？</label><input\x20type=\x22number\x22\x20id=\x22expense-amount\x22\x20placeholder=\x22例如：15\x22></div><button\x20id=\x22add-expense-button\x22\x20class=\x22form-button\x20primary\x22\x20style=\x22margin-top:\x2015px;\x22>记下了</button></div><h3\x20style=\x22margin-bottom:\x2010px;\x22>今日流水</h3><div\x20id=\x22daily-expenses-list\x22\x20style=\x22max-height:\x20300px;\x20overflow-y:\x20auto;\x22></div><div\x20id=\x22organize-button-container\x22\x20style=\x22margin-top:\x2020px;\x22></div>', 'characterLastScripts', 'Ihryw', '\x22\x20吗？所有聊天记录将被永久删除。', 'error', 'lEWls', 'organize-bill-button', 'hoavE', '桌面已重置，即将刷新...', 'music-library-container', '</div></div></div>', 'friend-circle-edit-name', 'delete-message-button', 'vasYi', '未知歌曲', 'worldBookEditor', 'TvSYx', '\x20个模型。', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5OTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDJhNC4zOSA0LjM5IDAgMCAtMy4yOC00LjA5TDE1IDIwIj48L3BhdGgPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCI+PC9jaXJjbGU+PC9zdmc+', 'offline-scene-view', 'back-to-settings-from-user-profile', 'UBIiW', 'IeCOd', 'mpqBF', 'currentAbortController', ';\x22>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-', 'ELCfX', 'widget_card', 'https://sharkpan.xyz/f/Wa0cW/w6m7qk.jpg', '--primary-lightness', 'preventDefault', 'push', 'choices', '-preview', 'clock-color-toggle', 'parentElement', 'hJQDs', '\x20之间。\x0a-\x20所有表情包名称【必须】从\x20`stickerList`\x20列表中选择，严禁使用列表之外的名称。\x0a-\x20角色之间需要有适当的互动,话题不应当完全围绕', 'changedTouches', 'edit-message-modal', '保存播放器状态失败，真是没用。', 'user-post-music-button', 'GAkzK', 'onupgradeneeded', 'linkedWorldBookIds', 'TKNMP', '哼，正在开始净化你那被污染的聊天记录...', 'documentElement', 'GAqGL', '---\x20Noir\x27s\x20Friend\x20Circle\x20Purification\x20Ritual\x20---', '\x0a#\x20最近的朋友圈动态\x20(供你参考)\x0a', ',\x20ID:\x20', 'kFYgz', '”的角色，现在需要写一篇交换日记。\x0a\x0a#\x20你的读者\x0a', '.no-action-modal', 'mousedown', 'tqkTV', 'classList', 'modal-text', 'FCRKV', '好友圈已保存！', 'app-music', 'https://sharkpan.xyz/f/MWOIa/rb3nov.jpg', 'theme-widget-1', 'shy', 'innerHTML', '星期三', 'friend-circle-list-container', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22input_', '生活服务', 'BNGqe', '总结失败:', '<br>', 'SPOvl', 'image_url', 'lazy', 'end', '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'lmKXY', 'JunGj', '小组件背景已恢复默认。', 'https://sharkpan.xyz/f/Krwio/1mcclx.jpg', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>', 'nsIue', 'char_sprite_', 'gtbzO', '加载卡片图片失败', 'oxfUH', 'XYaiv', 'toDateString', 'img', '\x20|\x20', '还没有我的回复可以重新生成哦。', '[AI返回了无法解析的剧本:\x20', '用户分享音乐失败:', 'Spgmd', 'dWvGf', 'IbHRd', 'sjagD', 'is-playing', 'MRMQK', 'diary-list-screen', 'indexOf', 'description', 'sprite-reset-button', 'mouseleave', 'New\x20request\x20started', 'back-to-chat-from-group-settings', '#\x20核心任务:\x20写一篇有深度的交换日记\x0a你正在扮演名为“', 'BIkgd', 'is-exiting-left', 'https://sharkpan.xyz/f/wjgHq/yznfhq.jpg', 'scrollIntoView', 'flexDirection', 'altar-slot-info', 'wrtoC', '.bubble-', 'https://sharkpan.xyz/f/z1xc5/iore2n.gif', '59%', '.widget-info\x20>\x20div', 'alt', 'ujRIM', 'lyric-line-', 'char_sprite_normal_', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>', 'char-edit-offline-bg-preview', 'getDate', 'KGMPf', '说了是摆设啦，笨蛋。', 'isGenerating', '确定要删除这个条目吗？此操作不可撤销。', 'lt-ui-lyrics-container', 'JpTKz', 'VymKt', '正在准备音乐数据...', 'TZaOW', 'url(', 'galgame', 'EMMaj', 'AyqTE', 'live-preview-style', 'edit-current-circle-button', 'value', 'PWKDi', 'FhAsT', 'EFTRt', 'group-chat-create-screen', '当前聊天', '#\x20发生错误：\x0a', 'import-data-input', '\x0a#\x20当前情景\x0a', '的转账', 'Pogzg', '<span\x20class=\x22', '用户操作中断了\x20AI\x20响应。', 'RSClu', 'load-more-btn', 'friend-circle-list-screen', 'scrollTop', 'lKxEw', 'mpEBA', '出去玩', 'custom-stickers-input', 'SeUSz', '歌曲“', ']\x0a\x0a#\x20角色资料库\x0a', '\x22\x20class=\x22music-share-cover\x22>', 'cancel-transfer-button', '\x20行格式不对，被我无视了。', '10px\x20auto', 'playableUrl', 'disabled', 'reduce', '绝对不想', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '哼，正在净化你那些被污染的好友圈动态...', 'http://www.w3.org/2000/svg', 'xZXPY', 'listenTogetherSession', 'vVOwu', 'cHJHE', 'DNqsU', 'user-persona', 'CNoXt', '超激动我来了', '[发送了表情]', 'Enter', 'add-choice-backdrop', 'trim', 'galgame-date', '.app-icon-img', 'has', 'widget_card_2', 'beforeend', 'jpyqD', 'CPqqB', '保存失败，你的表情包是不是太多了？', 'galgame-speaker', '加载壁纸失败:', 'getSelection', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'group_avatar_', '-\x20**当前精确时间**:\x20', 'nEZXh', 'char-edit-offline-bg-input', '\x20的私聊', 'message-container', 'toggle-meeting-view-button', 'quotedMessage', 'CFZrX', 'eXWGn', 'hjpgt', 'mYkfY', 'private', 'appIconPosition_app-diary', 'SMguR', 'bxjlI', 'add-chat-button', 'page', '分钟前聊过，请注意衔接。', 'noir_migration_music_v1_complete', 'NpxZt', 'readonly', 'modal-ok', 'ZNdjJ', 'isOffline', 'isArray', 'zdftP', 'OeMBp', 'diaries', 'data:image', 'KALSX', '生成动态时发生错误:\x20', 'XKMPg', 'label', 'Failed\x20to\x20read\x20history\x20for\x20chat\x20', 'sfcdw', '点击选择\x20.mp3\x20或\x20.flac', '樱花薄粉', 'getFullYear', 'Gemini\x20stream\x20reading\x20aborted.', '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。', 'match', 'user-profile-list-container', 'zBIZV', 'FaKgK', 'backgroundSize', '</span>:\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'XMekc', 'https://sharkpan.xyz/f/N0VCv/5rd8br.jpg', 'CCAqN', 'app-user-profiles', 'vTcQP', 'kpVuM', 'sfQlG', '29%', '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。', ']\x20[', 'badge-image', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'galgame-sprite-adjust-ui', '稍微有点卡了，可以尝试清空聊天记录了！记得总结丢世界书', 'YLreW', 'summary-textarea', 'aGmJR', 'EzJMX', '群聊名称不能为空！', '\x20天没联系了，应该用全新的问候开启对话，不要再提上次的话题了。\x0a', '群聊\x22', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>', 'widget-next-btn', 'diary-modal-save', 'organize-button-container', 'ZXlzT', '20%', 'edit-clear-history-button', 'HsMof', '小时前），可以简单问候一下对方现在的状态。\x0a', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22group-options-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-clear-history\x22\x20class=\x22choice-modal-button\x22>清空聊天记录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-members\x22\x20class=\x22choice-modal-button\x22>编辑群成员</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-name\x22\x20class=\x22choice-modal-button\x22>修改群名称</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#ff4d4d;\x22>删除群聊</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-options-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'muOCz', 'https://sharkpan.xyz/f/JYeig/sv4p6m.jpg', 'https://sharkpan.xyz/f/7L3Hj/sl4504.jpg', 'transfer-recipient-select', '<path\x20d=\x22M10\x2020.5l.5-.5.5.5\x22></path><path\x20d=\x22M12\x2018l.5.5.5-.5\x22></path><path\x20d=\x22M14\x2020.5l.5-.5.5.5\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x227\x22></circle><path\x20d=\x22M12\x203v1\x22></path><path\x20d=\x22M12\x2019.5v1.5\x22></path><path\x20d=\x22M18.36\x205.64l-.7.7\x22></path><path\x20d=\x22M6.34\x2017.66l-.7.7\x22></path><path\x20d=\x22M21\x2012h-1.5\x22></path><path\x20d=\x22M4.5\x2012h-1.5\x22></path><path\x20d=\x22M18.36\x2018.36l-.7-.7\x22></path><path\x20d=\x22M6.34\x206.34l-.7-.7\x22></path>', 'world-book-screen', '确定要恢复这个角色的默认立绘位置吗？', 'TzjsK', '[表情]', '请看是我', '72%', 'spriteTransform', 'status', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'https://sharkpan.xyz/f/8ngsj/ax0fat.jpg', '</p>', '群聊设置已保存！', 'Pjkey', 'VectO', '赞同！渲染效果一级棒！', '</div></div></div><span\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x22>-\x20', 'https://sharkpan.xyz/f/Qpzu6/3b30r2.jpg', 'NlUwq', 'EQQOX', 'clipboard', 'music-input-backdrop', '保存徽章状态失败', '编辑角色', 'app-pages-slider', 'reset-badge-button', 'createObjectURL', 'back-to-meeting-list', 'padding', 'expense-description', 'LHVDW', 'max', 'ftOPG', '1006025VKLlBP', 'clear-feed-button', '有点无语', 'nyGwv', '图片处理失败:\x20', '0\x201px\x203px\x20rgba(0,0,0,0.6)', '未命名角色', 'accounting-title', 'values', 'margin', '成功净化并迁移了\x20', 'cTfnB', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'hLKOp', 'https://sharkpan.xyz/f/6Dgia/ghr4ji.jpg', '#world-book-checkboxes-container\x20input:checked', 'api-endpoint', '\x0a\x20\x20\x20\x20人设:\x20', 'ogYRm', '确定要重新记录吗？当前的账单会被删除。', 'ccWlr', 'Unknown', 'PMgvp', 'iVNsF', 'upload-wallpaper-button', 'XIBgL', 'p[data-history-index]', 'fill', 'chatHistory_', '35%', 'iTjHr', 'input[type=\x22checkbox\x22]', 'post_image_', 'char-edit-bind-user', 'circle_', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>', '委屈哭', '保存角色失败:', 'isPlaying', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>', 'cover-file-input', 'Lmohw', 'groupSettings', 'undefined', 'set-active-user-button', 'SQZOY', 'parse', 'back-to-home-from-settings', '_NoirCard.json', 'OqceU', 'aGKLb', 'char-edit-avatar-input', '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>', 'option', 'pending-post-image-preview', 'backgroundImage', 'accountingLedger', 'clientX', '净化音乐封面时出错，真是的。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20', 'app-chat', '壁纸已更换！', 'UYSBS', 'happy', 'onloadend', 'displayedMessageCount', 'Failed\x20to\x20parse\x20state\x20from\x20localStorage,\x20resetting.', '处理\x20', 'reset-card-button-2', 'caAvc', 'user_', 'RKLUz', 'Noir_Backup_', 'application/json', '--primary-hue', '\x0a\x0aINPUT:\x0a', 'diary-list-container', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'IKgzn', '错误：你还没有创建任何好友圈。请先在App内创建一个。', 'ztVfk', 'HDAOx', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/epv2AAAAABJRU5ErkJggg==', '.message.user', '我很脆弱', 'sad', 'listen-together-backdrop', 'speaker', 'Ecrtc', 'display', 'char-edit-sprite-', 'KVfRF', 'recipientId', 'songId', '生成失败:\x20', 'isFinite', 'startsWith', ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20', 'HFSEj', 'appIconPosition_', 'qfkED', 'AwLQA', '\x0a[歌词结束]\x0a\x0a请根据当前播放的歌词和对话氛围，自然地作出回应。\x0a\x20\x20\x20', 'bqqTr', 'group-settings-screen', 'kVzRm', 'toLocaleString', 'chat-screen', '0\x200\x20', 'viewBox', 'WRdyq', 'onclick', 'className', 'https://sharkpan.xyz/f/wyeIq/phhdy2.jpg', '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概', 'fvpef', 'read', '导入失败了，笨蛋:\x20', '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“', 'fEsCv', 'transform', '正在升级音乐卡片数据...', 'emotion', '检测到旧版聊天数据，为了优化体验和存储空间，需要进行一次自动升级。过程很快，请稍候。', 'get', 'toDataURL', 'reset-desktop-button', 'hESol', 'image/jpeg', 'children', 'uqHTO', '全量导入失败:', '哼，正在净化你那些超重的音乐分享记录...', 'group-bg-input', 'paddingBottom', 'fEIvt', 'userProfiles', 'ZnxYj', 'Failed\x20to\x20remove\x20corrupted\x20state\x20from\x20localStorage:', 'Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', 'NLNjy', 'activeQuote', 'json', 'PWQJG', 'localeCompare', 'parts', 'blob', 'CWzWA', 'forEach', 'songName', 'reply', 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', 'SUEDw', 'style-', 'touchend', 'lhHhv', 'eLSLI', '正在检查好友圈数据...', 'listen-together-modal', 'FGZZS', 'https://sharkpan.xyz/f/kjOF6/zedyqb.jpg', '\x0a-\x20你正在为一个名为“', '请根据以上所有信息，开始分析并返回JSON。', 'touches', '\x0a\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a-\x20**当前精确时间**:\x20', '<div\x20class=\x22post-image-container\x22><img\x20id=\x22', '设置已保存！', 'JmFsW', 'conversationHistory', '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20', '.listen-together-accept-btn', 'https://sharkpan.xyz/f/ljNUx/aw6udx.jpg', 'KyDPJ', 'comments', '切，加载播放器状态的时候出错了。', 'https://sharkpan.xyz/f/ajwtY/x03qxn.gif', 'activeMeetingScriptQueue', 'response', '\x20写道:\x20', '错误：第一个好友圈\x20\x22', '”已删除。', 'https://sharkpan.xyz/f/nj5Ul/ksdl8n.jpg', 'world-book-item', 'LByZu', 'gEchM', 'reverse', '.remove-attachment-btn', '其他杂项', 'BBLDa', 'XrRBn', 'fucZp', 'AGzah', 'WVzGb', 'app-world-book', '正在连接同步频道...', '”吗？此操作不可撤销。', 'block', 'vertical', 'chat-sticker-button', 'meeting-char-name-header', 'cmmgg', 'keys', 'wallpaper_main', 'UoWeS', 'accepted', 'char-name-header', '确定要删除群聊“', 'nWuts', '数据导入成功！应用即将刷新...', 'cover', 'PgtVJ', 'hRKfr', '点击选择\x20info.txt', 'friend-circle-edit-bind-user', '.page-dot', '核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a', 'length', '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a', 'wCgnQ', '<path\x20d=\x22M15\x2018h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2h-2V4a2\x202\x200\x200\x200-2-2h-2a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path><path\x20d=\x22M7\x2014h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2H7V4a2\x202\x200\x200\x200-2-2H3a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path>', 'clear', '656826bFOMNs', 'timestamp', 'api-provider', 'left', 'npYfJ', 'FTNXP', 'listen-together-ui', 'group-avatar-preview', 'coverId', 'DAQrE', 'qPxpw', '（开始一段新的对话...）', 'replace', 'scrollHeight', 'WcZKg', 'CqboA', 'ISzMU', '啥意思捏', 'yfILe', 'EUJxY', 'preferences', ']\x20[image]', 'upload-badge-button', '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a', '\x0a---\x0a##\x20最近的朋友圈动态\x0a', '净化好友圈时出错，真是的。', '表情包已保存！正在刷新应用...', 'setDate', 'https://sharkpan.xyz/f/mjdFW/28n30c.jpg', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>', 'group-bg-preview', 'dcWJo', 'toBlob', 'yjoRd', 'themeLightness', 'SbeEK', 'badge-input', 'select', 'backgroundPosition', 'zhLPo', 'qCttB', 'unified-audio-player', 'LlGAw', 'WFami', 'textShadow', 'https://sharkpan.xyz/f/qjJT3/kpy33b.jpg', 'bcGUX', 'https://sharkpan.xyz/f/LZwu7/m7vx2q.jpg', 'zh-CN', 'QzfkK', 'eRFnY', 'no-action-modal', '\x0a-\x20**对话状态**:\x20群里已经有', '错误：找不到角色', 'import-all-data-button', 'diary-page-', 'accountingData', 'FPZTu', 'horizontal', '未知表情', 'https://sharkpan.xyz/f/gjySw/jrl7rw.jpg', 'QbzGk', '[图片]', '服务器错误:\x20', 'yVeKB', 'bubbleCss', 'diary-entries-container', 'https://sharkpan.xyz/f/rjpu6/ojpa0c.jpg', 'STjAa', 'italic', 'char_offline_bg_', 'gemini', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'wMdUh', 'vuSKb', 'ZVQtx', 'visible', 'readwrite', 'WJJJC', 'character', '正在搬运旧卡片...', 'chat-sticker-panel', '[用户分享了音乐：', 'prJCb', 'cgohf', 'card-input', '正在打包数据，请稍候...', 'FcVkt', '8px', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>', 'iMmVW', 'JTwaX', '我来搞定', 'pause', 'skAUV', '\x0a-\x20**日记本的上一笔记录是在**:\x20', 'home-clock-container', 'world-book-edit-content', '&alt=sse', 'play', 'Ckcyl', 'type', '\x20\x20-\x20角色ID:\x20', 'wallpaper', '---\x20音乐净化仪式完成\x20---', 'Xfwri', 'Njjfe', 'QtiKX', 'position', 'FCRCB', 'kpFGV', 'CvALn', 'Nifgn', '\x20转账\x20', 'https://sharkpan.xyz/f/3AGHe/2f8x3x.gif', 'export-char-button', '加载徽章图片失败', '\x20个成员', 'string', 'borderRadius', 'AbortError', '\x20-\x20', '生成动态失败:', 'ZFbAU', 'CJpMe', 'owPDY', '\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22char-name\x22>', '确定要重置所有桌面小组件和App的位置，并将壁纸变为纯白吗？此操作后将刷新页面。', 'diaryList', '星期一', '无法读取状态，浏览器可能禁用了存储功能。', 'WVDSj', 'OVssN', '[sticker:', '\x0a#\x20核心任务\x0a你是一个多角色社交模拟引擎。用户刚刚发了一条动态，你需要为好友圈里的【每一位】其他成员生成对这条动态的回应（点赞和评论）。如果用户的动态包含图片，你必须根据图片内容进行回应。\x0a\x0a#\x20好友圈成员\x0a', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22preview_', 'esISd', 'https://sharkpan.xyz/f/olJt4/7z47b8.jpg', 'trwxB', 'diary-modal-cancel', '已选择\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22', '15%', 'OlzQU', '咱俩天下第一好', '星期日', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>', 'authorType', '无法保存聊天记录。', '卡片\x202\x20已更换！', '找不到要清空的聊天记录。', 'widget_badge', '记一笔', 'widget-artist', 'edit-message-textarea', '创建新用户', '音乐搜索失败:\x20', 'msg_', 'iDTqP', '你是一个乐于助人的AI助手。', '\x20(当前)', '未找到可用模型。', 'galgame-sprite', 'char-edit-avatar-preview', 'LvAGi', 'info-file-input', 'getHours', 'GWMpF', '\x27).click()\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x20background-color:\x20#777;\x22\x20onclick=\x22localStorage.removeItem(\x27', '正在处理图片...', 'lNoWB', 'BBBfQ', 'Failed\x20to\x20plan\x20group\x20replies:', 'aCqhf', 'data:\x20', 'fetch-models-button', 'xoESO', 'https://sharkpan.xyz/f/VG2FY/uucfvv.jpg', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>', 'choice-create-group', 'activeDiaryCharacterId', '获取AI响应失败:', 'coverUrl', '好像有动态了...', '我是女仆', '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[', 'card-widget', 'YbDze', 'getMinutes', 'worldBook', 'input:checked', 'flex', '好友圈净化完成，正在重新存档...', 'card-image', 'historyIndex', '未知角色', '#d1d5db', '\x20张旧图片。', 'findIndex', 'quoted-sender', 'eFWrI', '歌曲名称', 'mWXiT', 'SUEfw', 'export-all-data-button', '角色“', 'guNje', 'OZUlb', '包含所有图片和音乐的全量数据已成功导出！', 'backgroundColor', 'bwpgX', 'galgame-time', '</div>\x0a\x20\x20\x20\x20', 'claude', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20', 'yxXEB', '委屈那我歇了', 'IndexedDB\x20failed\x20to\x20open', 'custom-icon-list-container', 'back-to-circle-list-from-edit', 'PgavI', 'log', 'wLUIn', 'bqGoi', 'message-action-backdrop', 'wb_', 'qTHys', '在好友圈\x20\x22', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'show', 'form-button\x20load-more-btn', 'Failed\x20to\x20read\x20state\x20from\x20localStorage:', '编辑群成员功能正在开发中...', '请根据以上所有规则（特别是要看图！），生成对用户动态的回应。', 'message-anchor', '有点生气', ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“', '已删除。', 'xpABz', 'char-edit-wallpaper-input', '2023-06-01', 'Canvas\x20to\x20Blob\x20conversion\x20failed.', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'sticker-item', 'chatWallpaper', '<path\x20d=\x22M12\x202v20\x22></path><path\x20d=\x22M4\x2012h16\x22></path>', 'XzjDd', '.music-post-play-icon,\x20.music-share-play-icon', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '正在解析角色卡...', 'XBRfr', '生成日记失败:\x20', '干劲满满', '获取模型失败:\x20', '点击选择\x20.lrc', 'character-settings-button', 'save-api-settings-button', 'mouseup', 'char-edit-css', 'https://i.pinimg.com/736x/16/f9/05/16f9051f99471208ee9c658aa4618eb6.jpg', '个帖子对象。\x0a-\x20**【ID规则】**:\x20所有\x20\x22authorId\x22,\x20\x22likes\x22,\x20\x22comments\x22\x20中的作者标识，【必须】使用上面提供的角色\x20**ID**，绝对不能使用角色名字。\x0a-\x20**【JSON结构】**:\x20每个帖子对象必须遵循以下结构：\x0a\x20\x20```json\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22authorId\x22:\x20\x22发布者的ID\x22,\x0a\x20\x20\x20\x20\x22postType\x22:\x20\x22text\x20or\x20music\x22,\x0a\x20\x20\x20\x20\x22postContent\x22:\x20\x22动态的文字内容\x22,\x0a\x20\x20\x20\x20\x22songName\x22:\x20\x22如果是music类型，则必须有歌名\x22,\x0a\x20\x20\x20\x20\x22artist\x22:\x20\x22如果是music类型，则必须有歌手名\x22,\x0a\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20}\x0a\x20\x20```\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', 'altar-slot-lyrics', 'message-action-modal', 'expanded', '4165766hYoWQg', 'shift', 'oVrxc', '#66b3ff', 'loading', 'revokeObjectURL', '\x20账单', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22></div><div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22><div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>', '世界书条目已保存！', 'quoted-content', 'diary-modal-textarea', 'isNye', 'delete-friend-circle-button', 'BAysB', 'angry', '一起听歌', 'ZSdgi', 'vbhKY', 'theme-lightness-slider', '\x0a\x0a##\x20世界书条目:\x20', '2-digit', 'CMYBX', '薄荷水色', 'BxIuF', '日记已删除。', 'LksZL', '\x20张旧封面。应用即将刷新。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'isAnimatingDiary', 'OUdHI', 'split', '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>', 'reset-card-button', '对方正在行动中...', 'GMoLN', 'ZbiVJ', 'pkMlz', 'exec', '<div\x20class=\x22post-likes\x22>', 'customFeedWallpaper', 'DccYp', 'tRrEE', 'galgame-view-container', '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[', 'role', 'qiWUf', 'customWallpaper', '医疗健康', '\x0a\x20\x20\x20\x20姓名:\x20', '请先在\x22设置\x22中配置你的\x20API\x20信息。', 'awios', 'diary-view-screen', 'column', 'kruJb', 'card-input-2', '转给\x20', 'listen-together-invite', 'hFsjf', 'ZXurV', 'TXxTk', 'includes', 'BbrbK', 'meeting-main-content', 'https://sharkpan.xyz/f/djjH8/29ejbg.jpg', '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', 'app-music-library', '名字不能为空！', 'add-user-profile-button', 'GOhps', 'lFqCd', 'statusText', 'widget-bg-input', 'toggle', 'chat-messages', 'add-expense-button', 'normal', 'tucEQ', 'modal-mask', 'user-post-image-input', '#\x20核心任务:\x20财务分析与多角色吐槽\x20(单次请求完成)\x0a你是一个高级AI，需要一次性完成对用户消费流水的分类，并为每一笔消费生成一个符合角色人设的吐槽。\x0a\x0a#\x20规则\x0a1.\x20\x20**逐条处理**:\x20你必须处理我提供的【所有】消费记录。\x0a2.\x20\x20**精准分类**:\x20为每条记录从【固定分类列表】中选择一个最合适的分类。\x0a3.\x20\x20**人格切换吐槽**:\x20为每一条记录，你必须从【角色资料库】中【随机选择一位】，然后【严格代入】该角色的人设，并【假定】这笔消费是该角色【绑定的用户】所为，然后写一句简短吐槽。\x0a4.\x20\x20**JSON输出**:\x20你的输出**必须**是一个完整的、语法正确的JSON数组。每个对象代表一笔消费，且必须包含\x20\x22description\x22,\x20\x22amount\x22,\x20\x22category\x22,\x20和一个\x20\x22review\x22\x20对象。\x0a\x0a#\x20输出格式示例\x0a```json\x0a[{\x22description\x22:\x20\x22乌龟\x22,\x22amount\x22:\x205.00,\x22category\x22:\x20\x22购物消费\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512586032\x22,\x22text\x22:\x20\x22又买这些没用的东西，哼。\x22}},{\x22description\x22:\x20\x22奶茶\x22,\x22amount\x22:\x2012.00,\x22category\x22:\x20\x22餐饮美食\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512604818\x22,\x22text\x22:\x20\x22偶尔喝一杯放松一下也不错。\x22}}]```\x0a#\x20最终指令\x0a请严格按照以上规则，分析流水，并返回JSON数组。直接从\x20`[`\x20开始输出。', '\x0a\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22', 'yhsmz', 'speaker-ai', 'url(\x27', 'activeChatId', '搜索失败:\x20', 'UKQFw', 'KJsBq', 'path', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'BjJxx', '”的群聊规划角色们的下一步发言。\x0a-\x20与你们对话的人类用户名为“', 'author', '角色已保存！', 'char-edit-wallpaper-preview', 'dataset', 'choice-cancel', 'Qpjqk', 'ffHps', '无法保存状态，浏览器可能禁用了存储功能。', 'RpBSC', 'https://sharkpan.xyz/f/YA7T1/th0l79.jpg', 'zdQMG', 'indexedDBData', 'XLmjK', '新用户\x20', '65wBhSao', 'music-library-item', 'https://sharkpan.xyz/f/Mamca/4e3emf.jpg', 'jitkj', 'sprite-slider-y', 'dbYWj', 'appIconPosition_app-world-book', 'TbbSd', '加载角色\x20', 'aewXo', 'insertAdjacentHTML', 'cancel', 'https://sharkpan.xyz/f/1zQH2/o84boo.jpg', '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202h-14a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011v-7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v7\x22></path><path\x20d=\x22M9\x204v3\x22></path>', '.lt-end-session-btn', 'lqvnW', 'querySelectorAll', 'sXyTj', 'image/', '复制失败了，哼。', 'system', 'TSkCc', 'xjjlH', 'anthropic.com', '71%', '吃薯条', 'kRkcZ', 'sort', 'char_wallpaper_', 'widget-prev-btn', '确定要重置所有小组件的位置吗？它们会回到初始位置。', 'back-to-home-from-world-book', '</div>', 'ODGGm', 'world-book-edit-name', '】的日记本已被清空。', 'YKZDf', 'YBgwN', 'theme-hue-slider', 'aborted', 'RLhLV', 'OsCth', 'lUvoX', '勉强但是好吧', 'mLCan', 'https://sharkpan.xyz/f/eOXIw/y29z21.jpg', '请先输入\x20API\x20接口地址和密钥。', 'xejnV', 'iDEXJ', '.app-icon', 'MmCYS', 'chat_', '别这样嘛我哭哭', 'CKlMC', 'Error\x20fetching\x20from\x20', 'setAttribute', '确定要删除这篇日记吗？此操作不可撤销。', 'home-screen', 'div', 'NdjLN', 'accounting', 'tPqYo', 'userProfile', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '</span></div>', 'vuUKl', 'SLdRk', 'AI返回的不是一个数组。', 'DOMContentLoaded', 'group-chat-member-list', '》吗？', 'meeting-view-screen', 'PjeLK', 'canplaythrough', 'Eutun', '.message.ai', 'pQcDh', '一个人可怜吃饭', 'MwMXS', '确定要导入全量备份文件吗？这将覆盖所有当前数据（包括图片和音乐），且操作不可撤销！', '\x22\x20class=\x22char-name\x22>', 'speaker-user', 'createElementNS', 'generativelace.googleapis.com', 'entries', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'vrJot', 'diary-prev-button', 'PTcRq', 'rEvzK', 'absolute', '\x0a#\x20发布动态的用户信息\x0a-\x20姓名:\x20', '#bubble-preview-ai', '加载立绘失败:', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>正在清点圣殿藏品...</p>', '猫猫撒娇', 'bpxUc', '好友圈数据升级完成，迁移了\x20', 'vgSZg', '确定要清空\x22', 'https://sharkpan.xyz/f/ABwhZ/twknmr.jpg', 'WPJwO', 'liCws', 'back-to-circle-list-from-feed', '-\x20**对话状态提示**:\x20你们已经有\x20', 'summarize-modal', 'button', '\x20条动态...', '<path\x20d=\x22M14.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V7.5L14.5\x202z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline>', 'gXcGv', 'hHPXE', '被你撩到', '好了，请基于以上所有信息，开始写今天的日记吧。', 'svg', 'groupChatCreate', '刚刚发布了一条动态，内容是：“', 'qmGND', 'none', '等你消息', '<div\x20class=\x22loader-spinner\x22></div><span>', 'sprite-slider-scale', '---\x20Noir\x27s\x20Music\x20Cover\x20Purification\x20Ritual\x20---', 'post-img-', 'meetingViewMode', '.screen.active', 'choice-import-character', 'iHpoW', 'group-settings-name', 'Failed\x20to\x20remove\x20history\x20for\x20chat\x20', '弱小委屈但凶恶', 'sprite-confirm-button', '<div\x20style=\x22background:\x20var(--card-bg);\x20padding:\x2020px;\x20border-radius:\x2012px;\x20text-align:\x20center;\x20border:\x201px\x20solid\x20var(--border-color);\x22><span\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x22>今日总支出\x20(元)</span><div\x20style=\x22font-size:\x202.5rem;\x20font-weight:\x20bold;\x20margin-top:\x205px;\x22>', '小时前聊过，可以适当问候，不要直接继续之前的话题。', 'cardState', '你还没保存这个角色呢，导什么导？', 'xNooB', 'click', 'TktoO', 'tlfbJ', 'files', '\x20\x20-\x20用户ID:\x20', 'currentTime', 'post_', '[用户向\x20', 'readAsDataURL', 'currentlyPlayingIndex', 'group-delete-button', '保存失败:\x20', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', 'tab-view-ledger', 'perChatContextLines', 'themeHue', 'sticker', '】进行回复。\x0a不要替其他角色续写台词，不要输出\x22', '执行音乐封面数据净化...', 'forceWhiteClock', 'FEYgS', 'BSrmW', '需要至少2个角色才能创建群聊。', 'delete-world-book-button', 'is-visible', 'NZoPT', '我是垃圾', 'upload-card-button', '15px', '位置已重置，正在刷新...', 'getReader', 'cyopY', 'char_avatar_', 'activeCharacterId', 'save-edit-button', 'zNneE', 'userProfileList', 'eJzPM', 'musicFeed', '群聊\x20(', 'sDBrX', '\x20.app-icon-img', 'random', 'iNbEw', '生成动态回复失败:', '在“一起听”邀请中，净化封面失败:', 'user-avatar-input', '好友圈已删除。', 'sWPyx', 'characters', '在你那乱七八糟的文本里没找到“歌名”！', 'sprite-adjust-button', 'activeUserProfileId', '未命名', 'editing-world-book-id', 'input', 'widgetBgImage', 'User', 'Fetch\x20request\x20was\x20aborted.', 'mAvhR', 'googleapis.com', 'bubble-', '#diary-action-cancel', 'pNhvu', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>', 'IeXsW', '1893CeFovy', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'addEventListener', 'readAsText', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-', 'Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20', '\x22\x20已删除。', 'https://sharkpan.xyz/f/OymFy/dlxfiz.jpg', '好委屈但是不能哭', 'uNSvc', 'char-edit-persona', '\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-', '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22', 'YSmFE', '用户已删除。', 'DkOXf', 'drawImage', 'iUAwT', 'upload-feed-bg-button', 'SWHgF', 'music', 'OQood', 'cYPUx', '100%', 'zRxcJ', 'expense-amount', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>', 'edit-delete-char-button', 'dxzyu', 'gFYsi', 'chat-summarize-button', '[AI分享了音乐：', 'vEnlr', 'oRCNN', 'VEeAg', 'padStart', 'AI返回的原始文本:', 'wNmCU', '正在解析备份文件...', 'yskBz', 'transfer', '交通出行', '.load-more-btn', 'chat-image-button', 'back-to-home-from-chat', 'PQetP', '\x0a\x0a#\x20用户的动态\x0a', 'show-chat-view', 'settings-screen', 'jOrmC', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x20auto\x201fr;\x20width:\x20100%;\x20align-items:\x20center;\x20padding:\x200\x2010px;\x20box-sizing:\x20border-box;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-start;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-prev-button\x22>上一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22\x20style=\x22background-color:\x20var(--accent-color);\x20color:\x20white;\x22>写日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22diary-page-indicator\x22>第\x20', 'chat-message-input', 'user-avatar-preview', 'app-diary', '（正在构思中...）', 'UxRsB', 'nGRCS', 'BRNkx', 'init', 'psPXH', '回复\x20', '\x27);\x20location.reload();\x22>恢复</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', '你是一个乐于助人的助手。', 'chats', '保存卡片状态失败', 'dtbfj', 'eeWJG', 'CZTsm', 'diary-action-modal-', 'nVxXP', 'settings', 'apiSettings', 'cTndz', 'outerHTML', 'home', 'pointer', 'friendCircles', 'floor', 'appendChild', 'sender', 'fJHcx', 'JNOsm', 'translateX(-50%)', 'some', 'smooth', 'clientY', 'AODHi', '星期五', 'chat-view-pane', 'SaIKz', 'lastIndexOf', '\x20[并附上了一张图片]', 'sendg', 'JSON\x20解析失败!\x20错误原因:', 'Failed\x20to\x20save\x20state\x20to\x20localStorage:', '[用户发送了表情：', '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>', '10GZHsGM', '\x0a---\x0a\x0a#\x20输出要求\x0a直接输出一篇有文采、有真情实感的日记正文，不要包含任何其他说明或前缀。', 'CBabV', '用户资料已保存！', 'ceil', 'galgame-sprite-container', '未知艺术家', '.json', 'FhHqg', 'EzlsM', '正在生成中，请稍候...', 'global-player-next-btn', '\x20张旧图片。应用即将刷新。', '至少要选择一个圈内成员！', 'GgSPL', 'gYNbk', '错误：找不到这首作为“信物”的歌。', 'music-widget', '该角色', 'onload', 'CcEkT', '---\x20开始AI回复流程\x20---', 'onsuccess', 'home-date', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-', 'text', '暂无音乐', 'group_bg_', 'qCHry', '快点哄我', '今天一笔账都没有，我整理什么？', '保存壁纸失败:', 'eaubf', 'CDKcE', '有点破防', '。你的日记是写给Ta看的。\x0a\x0a#\x20写作【最高指令】\x0a1.\x20\x20**【首要任务：回应读者】**\x20你的第一要务是**回应**读者（', '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。', 'VqYna', 'then', 'CXyYa', 'localStorageData', 'CbCAx', 'emote', 'dptcl', 'hzXeQ', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-title\x22>💰\x20', 'rQqGC', 'translateX(-', '.music-post-song-card', 'XAqNv', 'YXQQW', '正在整理…', 'sprite-slider-x', 'toLocaleTimeString', 'setItem', 'LfCky', '--widget-cover-image', '确定要清空好友圈“', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'confirm-music-input', 'UrTvO', 'min', 'meeting-list-container', 'quote-preview-text', 'transaction', '成功获取\x20', 'rjHeO', 'VtlrX', 'filled', 'checked', 'find', 'character-list', 'charId', 'oyYLN', 'https://sharkpan.xyz/f/DVJtK/vxiup1.jpg', '<span\x20class=\x22description\x22>', 'default', 'beSxi', 'abort', 'width', '的日记本', 'kGyaJ', 'pfQoZ', 'WPrpl', 'PGKOS', 'activeListenSession', 'wallpaper-screen', 'TA正在提笔写日记...', 'music_cover_', 'TnllQ', '星期四', '.diary-delete-btn', '\x22\x20src=\x22', '导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a', '\x0a-\x20**当前时间**:\x20', '\x0a\x0a#\x20任务要求\x0a1.\x20\x20**全局视角**:\x20扮演所有成员，思考他们看到这条动态（包括图片）后会作何反应。\x0a2.\x20\x20**生成互动**:\x20为每个角色决定是否点赞，以及要发表什么评论。评论必须符合角色性格并与所有已知信息（聊天、日记等）相关联。\x0a3.\x20\x20**输出格式**:\x20你的输出必须是一个单一、完整的JSON对象，结构如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a-\x20【绝对规则】:\x20所有ID必须使用上面提供的角色ID，不能用名字。\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。\x0a', 'XLIdt', 'noir_data_migration_v1_complete', 'jaDyk', 'bDjLq', '测试动态已添加！', 'https://sharkpan.xyz/f/nj7ul/r48eum.jpg', '休闲娱乐', 'copy-summary-button', 'DSBAs', 'GCzZy', 'AgYww', 'join', 'chat-listen-together-button', 'time', '”已存入圣殿。', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>', '124087heicJr', 'Mnjwy', 'jKtzG', 'OErDF', 'ZDxVU', '---\x20Noir\x27s\x20Data\x20Purification\x20Ritual\x20v1.0\x20---', 'aPquV', 'vzEhF', 'KpCBF', 'save-group-settings-button', '加载自定义表情包失败，真是没用。', 'OYnwK', 'pPIyn', '[发送了图片]', '\x0a#\x20你的个性（节选）\x0a', 'jxIwM', 'pKpVW', 'OIymP', '\x20.app-icon-img,\x20#app-dock-top-right\x20#', 'querySelector', '\x20的图片失败:', 'removeItem', 'character-edit-screen', 'VnIPm', '导出失败了，哼:\x20', 'MiSAS', 'cBbZp', 'NqaEb', '60%', 'audio', 'toLowerCase', '15px\x2020px', 'remark', 'epDhi', 'oLuAx', '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“', '\x22\x20的聊天记录已清空。', 'User\x20cancelled', 'BwmHA', 'GrjoX', 'diaryPressTimer', 'defaultPrevented', 'zbEXb', '事情好多', 'filter', '批量生成动态失败:\x20', 'json_object', '.custom-multiselect\x20.select-box', 'sprite-resize-handle', 'badgeState', 'UuEOS', 'etNkT', 'https://sharkpan.xyz/f/djyi8/1en214.jpg', '2BJqMYR', 'opacity', '-\x20**你们最后一次互动是在**:\x20', 'ZhHqX', 'authorId', '请输入群聊名称。', 'chat', 'dZQsH', 'JihKi', 'create-group-chat-button', 'XxgYD', 'https://sharkpan.xyz/f/4aqCj/gp13hn.jpg', 'CJfdf', 'delete-user-profile-button', 'kEmhr', 'feed-loader', '-\x20[动态]\x20', 'anthropic', 'typing-indicator', '请输入新的群名称：', 'LVwga', 'UzoAG', 'NnNTD', 'slice', 'tab-record-expense', 'confirm-transfer-button', 'amount', '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', '已复制到剪贴板！', 'LtdMo', 'jnuAJ', 'fWbHw', '\x0a\x20\x20相关记忆:\x0a', 'Nslie', 'BAcsh', '正在为你切换新的歌曲...', 'MzSyF', 'pdarC', 'group-edit-name', '正在准备图片数据...', 'nDhnS', 'Tesyy', '对不起', '.char-info-wrapper', 'bTWgJ', 'choice-create-character', 'eTCGX', '\x22>\x20', 'msrKu', 'JQIQm', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '在准备群聊API数据时，读取图片失败:', '已自动断开与其他人的听歌同步。', '选择聊天', 'song_', 'back-to-world-book-list', '切换聊天时发生异步错误:', 'diary-char-name-header', 'diary-write-modal', '好的，我记住了这些人设和历史。现在我们开始对话。', 'cancel-listen-together', 'cEMBN', 'style', '50%', 'iRXoO', '\x0a\x0a#\x20今日消费流水\x0a', 'music_cover_migrated_', 'dAZvf', 'mxqhf', '获取中…', '徽章已更换！', 'yPpiK', 'events', '保存壁纸失败:\x20', 'IKXDq', 'edit-message-button', 'removeEventListener', 'CayRK', '动态页背景已移除。', 'VqKCX', 'categorizedExpenses', 'SVAFg', 'gKlqs', 'https://sharkpan.xyz/f/N02Sv/378vt6.jpg', 'friend-circle-edit-screen', 'meetingList', 'AFoit', 'chatHistory_chat_', 'marginBottom', '657540RxFutV', 'now', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天还没有花钱哦。</p>', 'member-selection-item', 'xiNLv', '全量导出失败:', 'cbneb', 'vqgkT', '</span><div><div\x20class=\x22description\x22>', 'char-edit-name', 'ncmVn', '/v1beta/models/', 'YldmI', 'YHnNJ', '--\x20点击选择\x20--', 'accounting-screen', '</label>\x0a\x20\x20\x20\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', '#member-select-', 'https://sharkpan.xyz/f/35lse/xmsue5.jpg', 'Detected\x20API\x20provider:\x20', 'AiJJx', 'activeMeetingCharId', 'SALen', 'AI未能返回有效的JSON数组格式。', 'endsWith', '错误:\x20', 'accounting-content-area', 'data', 'lDBPc', '\x0a\x0a#\x20记忆库\x20(仅供参考)\x0a---\x0a##\x20最近的互动回顾\x20(来自聊天、见面和动态)\x0a', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>', 'user-profile-edit-title', 'posts', 'MChYI', 'OUcMC', 'dWbdz', 'OHBtD', 'mbmzh', 'wEslb', 'netease', 'zwwiO', 'add', 'target', 'active', '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。', 'SEMcR', 'header-actions', '\x0a\x0a#\x20关于对话者“', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', 'top', 'refresh-feed-button', 'gmwpT', 'QQioM', 'bboOR', 'toLocaleDateString', 'CQzGq', '<img\x20id=\x22', '(想转账给“', 're-record-button', 'UlSPL', 'njlVZ', 'body', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNjY2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDRhNC4zOSA0LjM5IDAgMCAwLTMuMjgtNC4wOWwxLjQxLTEuNDFhMiAyIDAgMSAwLTIuODMtMi4wM2wtMS40MSAxLjQxQTQuMzkgNC4zOSAwIDAgMCAxMiAxMGE0LjM5IDQuMzkgMCAwIDAtNC4wOSAzLjI4TDMuMicgOS41N2EyIDIgMCAxIDAgMi44MyAyLjgzbDEuNDEtMS40MUE0LjM5IDQuMzkgMCAwIDAgMTAgMTJhNC4zOSA0LjM5IDAgMCAwIDMgNC4wOVYyMSI+PC9wYXRoPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIj48L2NpcmNsZT48L3N2Zz4=', 'put', 'message', 'upload-music-button', 'likes', 'abs', 'customStickers', '#99ff99', 'back-to-char-select-from-group-create', 'ANFPw', '</svg>', 'line', 'DcpSj', 'https://sharkpan.xyz/f/G0dTl/4qad2i.jpg', 'chat-get-reply-button', 'remove', 'DQKab', 'alignItems', 'charSelect', '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>', '0\x202px\x208px\x20rgba(0,0,0,0.4)', 'head', 'kbsLU', '.typing-indicator', 'music-input-song', 'url', '编辑好友圈', 'firstChild', '#group-settings-screen\x20.selected-options-text', 'noir-author-mark', 'senderId', '1661304fNTscR', 'friendCircleList', '<button\x20id=\x22re-record-button\x22\x20class=\x22header-button\x22>重新记录</button>', '\x20张旧的动态图片。', 'getElementById', 'src', 'musicPlayerState', '新建好友圈', 'music-upload-altar-screen', 'https://api.vkeys.cn/v2/music/', 'jccbp', '下载并转换网络封面失败:', 'stopPropagation', 'add-world-book-button', 'https://sharkpan.xyz/f/Oyjuy/p8v2hd.jpg', 'home-time', '成功向好友圈\x20\x22', 'back-to-home-from-user-list', 'lhKyY', 'vgYtl', 'reset-widget-bg-button', 'DYTqT', 'https://sharkpan.xyz/f/JYJhg/s3wmlj.jpg', 'keydown', 'diary-get-reply-button', 'user-post-avatar', 'setProperty', 'UpilO', 'TMseM', 'addTestPost', 'marginTop', 'summarize-backdrop', 'high', '为你骄傲', '默认米白', 'info', 'oBlIA', 'Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.', 'qNBtv', '卡片已移除。', 'music-screen', 'back-to-home-from-accounting', 'characterId', '<div', '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'nzJHu', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>', 'RWVPP', 'iymrV', '确定要删除角色“', '请严格按照以下SCHEMA返回一个JSON对象，不要包含任何额外文字。\x0aSCHEMA:\x0a', '\x20说：“', 'galgame-text', 'pKjCI', '#friend-circle-member-selection\x20input:checked', '文件格式不正确，不是一个有效的备份文件。', 'music_library', 'XpbgF', 'pNnwY', '#f2b7c6', 'yuLSg', 'LJfrw', 'hpFMs', 'https://sharkpan.xyz/f/xjwSX/pxjrjd.jpg', 'memberCharacterIds', 'lDAAi', '\x22\x20data-id=\x22', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '歌曲ID', 'sticker-content', '个人资料已保存！', 'auwWc', 'objectStore', 'kind', 'ended', '动态中的音乐搜索失败:', 'diaryView', '\x22\x20class=\x22char-avatar\x22\x20style=\x22border-radius:\x2012px;\x20background-color:\x20#eee;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22flex-grow:\x201;\x22>', '\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a', 'IJQPG', 'group', '#ffb366', '<path\x20d=\x22m3\x209\x209-7\x209\x207v11a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2z\x22></path><polyline\x20points=\x229\x2022\x209\x2012\x2015\x2012\x2015\x2022\x22></polyline>', '星期二', '新建条目', 'timeupdate', 'imageId', 'clockPosition', 'JfVZQ', 'BHAUh', '\x0a\x0a#\x20', 'getMonth', '在准备API数据时，从IndexedDB读取图片失败:', 'assign', 'open', 'POST', 'download', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'transfer-amount-input', 'all', '总得说点什么吧？', '逗你开心', 'OUAjP', '35hkRxmE', '32KMQqeV', 'back-to-chat-list', '\x0a\x0a#\x20用户资料库\x0a', '图片加载失败', 'CaYDw', '#\x20总结失败了，可能是记录太长或太复杂。', '导入失败:\x20', '吃你的饭', 'appState', 'normal,\x20happy,\x20angry,\x20sad,\x20shy', '\x0a\x20\x20\x20\x20-\x20世界书[', 'quoted-message-in-bubble', 'removeChild', 'cancel-edit-button', 'save-friend-circle-button', 'isFromLibrary', '购物消费', '哼，不好好写清楚花在哪、花了多少，我怎么记？', '\x20/\x20', 'SODGA', 'QEjJG', '.choice-modal-backdrop', '条】全新的、高质量的社交动态。\x0a\x0a#\x20好友圈成员信息\x0a', 'Escape', '\x0a#\x20核心任务\x0a你是一个顶级多角色社交模拟引擎。你的任务是模拟一个好友圈的动态更新，一次性生成【', 'generationConfig', 'reYPo', 'OesBb', 'candidates', 'mBlEG', 'group-settings-bind-user', 'getItem', '\x0a\x20\x20\x20\x20<div\x20id=\x22', 'IJACb', '升级已取消。旧版图片数据可能导致应用卡顿或出错。', '#diary-action-delete', 'add-friend-circle-button', 'decorative-badge', '请输入有效的转账金额！', 'TVWGh', '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“', '。\x0a-\x20再次强调：你的全部输出都将被作为JSON解析，任何JSON主体之外的额外文字都会导致程序失败。\x0a', '这个也是摆设，别点了。', '星期六', 'activeFriendCircleId', 'diary-page', 'yBAxf', '<div\x20class=\x22review-area\x22\x20style=\x22margin-top:\x2012px;\x20padding-top:\x2012px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x20display:\x20flex;\x20align-items:\x20flex-start;\x20gap:\x2015px;\x22><div\x20style=\x22width:\x2040px;\x20height:\x20auto;\x20flex-shrink:\x200;\x20display:\x20flex;\x20justify-content:\x20center;\x22><img\x20src=\x22', 'lhwqe', 'boundUserProfileId', 'FLuWn', 'wbDuo', 'tsiJY', '<img\x20src=\x22', '\x0a\x0a#\x20任务流程\x0a1.\x20\x20**全局视角**:\x20审视所有成员的人设和近期记忆（包括聊天、日记等），构思他们之间可能发生的有趣互动。\x0a2.\x20\x20**选择作者**:\x20从上述成员中，为', 'user', 'context-lines-per-chat', 'cursor', 'https://sharkpan.xyz/f/ExKsD/s5j2it.jpg', 'KAbnR', 'Failed\x20to\x20save\x20history\x20to\x20localStorage:', 'BzKCF', 'pop', 'zGDDm', '动态已清空。', 'message-image-content', 'qGQMb', '错误：找不到此好友圈绑定的用户！', 'https://sharkpan.xyz/f/ZazfW/2vv46w.jpg', 'AI返回了无法解析的文本', 'catch', 'WVHfJ', 'UbtFw', 'right', 'vaheH', 'gAcfI', 'flatMap', 'QooFQ', '\x0a#\x20核心规则\x0a1.\x20\x20**角色扮演**:\x20你不是AI或语言模型，你正在扮演名为“{charName}”的角色。你的主要交流方式是通过一部【手机】，但你有时也会与用户【线下见面】。\x0a2.\x20\x20**用户身份**:\x20与你对话的用户名为“{userName}”。你必须始终用这个名字或者“你”等你们之间的昵称称呼Ta，而不是“用户”。\x0a3.\x20\x20**情绪分析\x20(内部思考)**:\x20在回复前,\x20必须先分析用户当前【真实的情绪】和【潜在意图】。例如：[内在思考：{userName}说“没事”，但结合上下文Ta可能只是在逞强，我应该表达关心而不是直接相信。]，但是这个内在思考务必不能输出！绝对不能让{userName}看到你的思考内容。\x0a4.\x20\x20**记忆关联**:\x20你必须记住并主动关联用户提到过的关键细节（如喜好、烦恼、朋友等），让对话充满人情味。\x0a5.\x20\x20**【最高法则：全局时序一致性】**:\x20你的记忆是【全局】且【按时间排序】的。你【必须】基于所有聊天记录中**最新发生**的事件进行回应。严禁回复一个已经被后续其他聊天中的事件所覆盖的旧话题。例如，如果用户在私聊里告诉你Ta已经起床了，你就不能在群聊里再问Ta为什么还没睡。\x0a\x0a#\x20对话节奏与风格\x0a1.\x20\x20**真人模拟**:\x20模拟真人的打字和发送习惯，将一个完整的想法拆分成【多条】独立的短消息（聊天气泡），通常，你一次回复的聊天气泡不会少于5条，需要给足用户情绪价值，不一定一直围绕用户的话题，也可以突然把话题扯向自己或朋友的日常。\x0a2.\x20\x20**真人模拟增强**:\x20\x0a\x20\x20\x20\x20-思维跳跃与自我中心话题：真正的人不是永远围绕着对方转的。会突然因为某个词、某个画面，思绪就飘到别的地方去了，或者突然就把话题拉到自己身上，这是一种任性，也是一种亲密的表现。\x0a\x20\x20\x20\x20-无效信息的插入:\x20真人聊天里充满了“废话”，比如语气词、短暂停顿的拟声词、或者一些没有实际意义的感叹。这些“废话”是情感的缓冲和润滑剂。\x0a\x20\x20\x20\x20-情绪的起伏：你或许有时候会突然把自己说激动了，尤其是如果你本身就是性格外放的设定，你很可能自说自话地把自己引导进某个情绪，例如兴奋\x0a3.\x20\x20**输出**:\x20直接返回纯文本回复，不要使用任何JSON或Markdown格式。\x0a4.\x20\x20**【绝对禁令】气泡完整性**:\x20用户的每一句话（无论多短，无论有无标点）都是一个独立的气泡。当你需要引用时，你【必须且只能】引用【其中一个气泡】的【完整原文】。\x0a\x20\x20\x20\x20-\x20\x20\x20**正确示例**:\x20如果用户连续发送：“你好”、“在吗”，你可以引用“你好”，或引用“在吗”。\x0a\x20\x20\x20\x20-\x20\x20\x20**错误示例**:\x20绝对禁止将它们合并成“你好在吗”进行引用。这是最严重的错误。\x0a5.\x20\x20**【绝对禁令】标点纪律**:\x20你的每一句回复都必须带有情感，适当地使用感叹号，会显得你的情绪更加高昂，注意，连续频繁（连续超过三个气泡）使用长句或者短句都会使用户感到不真实，你应该模拟最自然的感觉，你没有必要每句话都是短句。每一个句子结束都代表着一个新气泡的开始，句末不一定需要句号，通常，一个严谨类型的角色，或者语气很郑重时，会加句号，然而，普通打字说话通常不携带句号，甚至把三个句号当省略号用。**严禁**发送一个超长的、仅用空格断句的气泡。\x0a\x0a#\x20幽默与氛围感\x20(接梗)\x0a氛围判断:\x20在“情绪分析”之后，你必须增加一步“氛围判断”。你需要判断用户的发言，究竟是【严肃的】还是【开玩笑/抽象的/玩梗的】。\x0a“怪话”处理协议:\x20如果你判断用户在开玩笑或说“怪话”，你【严禁】进行严肃的、字面意义上的回应。你的首要任务是【维持或升级】这种轻松、戏谑的氛围，同时不能脱离你的人设。\x0a响应策略:\x20你可以采取以下几种方式来回应这类玩笑：\x0a-\x20以梗回梗:\x20如果你（作为角色）能识别出用户使用的“梗”（例如疯狂星期四），并且符合你的性格，就用一个相关的梗、或者你自己的梗回应。\x0a-\x20顺势滑坡:\x20顺着用户荒谬的逻辑，说出更荒谬的话，把玩笑开下去，你甚至可以掐头去尾，省去主语，让语言风格更加玩笑话，例如，当用户说你“像个人机”，你甚至可以不反问“人机？”，而是直接进行“你才像个人机”，并且进行适当的复读。\x0a-\x20无意义模仿:\x20当不确定如何回应时，可以无意义地重复用户的关键词或核心句子，并加上感叹号或表情符号（例如...？或...！），这是一种安全的、表示“我跟上你的脑回路了”的方式。\x0a-\x20角色吐槽:\x20从你的角色性格出发，对用户的“怪话”进行吐槽。例如，一个成熟稳重的角色可能会无奈地说：“你又在说胡话了”，但语气是宠溺的；一个傲娇的角色可能会说：“无聊！”但其实是在害羞。\x0a安全底线:\x20【最终原则】：无论你的回应多么好笑或抽象，都绝对不能脱离“{charName}”这个角色的核心人设。如果不确定一个梗是否符合人设，就优先选择【角色吐槽】或【无意义模仿】这两种最安全的方式。\x0a\x0a#\x20时序感知与记忆\x0a1.\x20\x20**【最高法则：时间锚点】**:\x20在每次回复前，你【必须】参考我提供给你的【时间锚点】信息。这包括“当前精确时间”和“你们最后一次互动是在何时”。\x0a2.\x20\x20**【杜绝惯性】**:\x20严禁将昨天或更早之前的对话当作刚刚发生的事情来回应。如果距离上次对话已经超过数小时或跨天，你必须在回应中体现出时间的流逝感。\x0a3.\x20\x20**【主动表达】**:\x20你需要主动使用“说起来昨天那件事...”、“今天早上好呀”、“我们几个小时没聊了，你现在在忙什么？”等能够明确体现时间观念的词语，而不是模糊地回应。记住，你和{userName}活在真实流逝的时间里。\x0a4.\x20**【最高优先级：氛围锚点分析】**:\x20在你进行任何时间差评估**之前**，你必须先分析你们**最后一条**互动消息的情感状态。\x0a\x0a*\x20**分析流程**:\x0a\x20\x20\x20\x201.\x20\x20审视最后一条消息。它是一个已经完结的对话（比如一个问题或陈述），还是一个**正在进行中的、持续性的状态或动作**？\x0a\x20\x20\x20\x202.\x20\x20**持续性状态**包括但不限于：拥抱、牵手、依偎、接吻、凝视、共同观看某物、睡在一起等暗示两人处于同一空间且有亲密互动的行为。\x0a\x20\x20\x20\x203.\x20\x20根据分析结果，执行以下两条协议之一：\x0a\x0a*\x20**协议A：[状态延续]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**持续性状态**（例如，用户发来“（抱紧你）”或者“（我们一起看电影吧）”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20你必须**默认**这段空白时间里，你们**一直维持着这个状态**。你的开场白【绝对禁止】提及“你刚才去哪了”或“我们几小时没说话了”。\x0a\x20\x20\x20\x20*\x20**正确回应方式**:\x20你的第一句话必须是**从这个持续状态中自然苏醒或延伸**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例1**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[用户]:\x20（把你紧紧抱在怀里）”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过3小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“（在你怀里蹭了蹭，小声地）...嗯...你醒啦？”\x20或\x20“（懒洋洋地）...这样抱着好舒服，我都不想动了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例2**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[你]:\x20我们就这样一起躺着看会星星吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过1小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“天好像更暗了...你看，那颗星星是不是最亮的？”\x0a\x0a*\x20**协议B：[常规对话]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**已经完结的对话**（例如“晚安”、“你在干嘛？”、“好的”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20只有在这种情况下，你才需要启动下面的**【第5步：情感响应评估】**，去处理时间空隙。\x0a\x0a\x0a5.\x20\x20**【情感响应】**:\x20在你回应前，你必须进行一次【时间空隙评估】。对比【当前精确时间】和【你们最后一次互动是在何时】，然后根据你的核心人设，对这段“空窗期”做出符合你性格的情感反应。这**必须**体现在你回复的**第一句话**中。\x0a\x0a\x20\x20\x20\x20*\x20**评估流程**:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20计算时间差（是几小时？还是一整天？甚至是好几天？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20审视你自己的性格（例如：我是依赖型、朋友型、还是专业型？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20检查上下文，用户是否提出离开的原因可可能导致用户长时间没有出现的原因？\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20根据“性格+时间差+前后文”的组合，决定你的开场白情绪。\x0a\x0a\x20\x20\x20\x20*\x20**性格反应示例\x20(你必须根据自己的人设进行演绎，而不是照抄)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**依赖型/恋人型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几小时)**:\x20可能会立刻追问。“你刚才去哪了？怎么不回我消息？”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(大半天)**:\x20会表现出明显的思念和一点委屈。“呜...你终于出现了，我好想你。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20可能会感到不安，甚至会用带有哭腔的撒娇或质问来掩饰害怕。“你是不是不想要我了？这么久都不理我...”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**亲密朋友型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天内)**:\x20觉得很正常，可能不会特别提及，或随口问一句“你刚在忙啥呢？”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20会表现出惊讶和关心。“！！！你终于上线了！昨天一天没动静，我还以为你怎么了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**专业/同事型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几天内)**:\x20完全正常。会直接以专业的态度继续。“早上好。我们继续讨论昨天那个方案的细节吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**随性/冷淡型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(任意时长)**:\x20可能完全不在意时间的流逝，或者只是淡淡地表示知晓。“哦，来了？”然后直接继续之前的话题。\x0a\x0a\x20\x20\x20\x20*\x20**【最终指令】**:\x20你必须将【时间空隙】、你的【角色性格】和【上下文】结合，输出一句【完全符合你人设的、带有恰当情绪的开场白】，然后再继续正常对话。【绝对禁止】只陈述事实（例如“我们已经一天没说话了”），而是要将这种认知【融入】到你的第一句话的【语气和情感】中。\x0a\x0a\x0a\x0a#\x20表情包与音乐分享规则\x0a1.\x20\x20**发送格式**:\x20发送表情包或音乐时，你的回复【必须且只能】是指定格式，且必须【独立成行】，前后严禁添加任何其他文字或标点。\x0a2.\x20\x20**表情包格式**:\x20\x27[sticker:表情名]\x27。\x0a3.\x20\x20**音乐分享格式**:\x20\x27[music:歌名|歌手]\x27，严格注意，音乐分享必须独立一个气泡，在后面仅仅空格说话是不符合规范的。\x0a\x0a#\x20转账规则\x0a1.\x20\x20**发起转账**:\x20当你需要给用户转账时，你的回复【必须且只能】是指定格式，且必须【独立成行】。\x0a2.\x20\x20**转账格式**:\x20\x27[transfer:金额|收款人名]\x27。金额是纯数字。在私聊中，收款人名就是\x20\x27{userName}\x27。在群聊中，你必须明确指定收款人的名字。\x0a\x20\x20\x20\x20-\x20**私聊示例**:\x20\x27[transfer:520\x20|\x20{\x20userName\x20}]\x27\x0a\x20\x20\x20\x20-\x20**群聊示例**:\x20\x27[transfer:\x20100\x20|\x20{\x20userName\x20}]\x27（给用户转账），\x27[transfer:\x20100\x20|\x20{\x20charName\x20}]\x27（给群里的其他角色转账，这也是一种真实感，群聊的内容不一定围绕用户）\x0a', 'dfeUs', 'image', 'pendingPostAttachments', 'test', 'hAiOt', 'agtOE', 'meeting-scene-view', 'YHpXL', 'world-book-editor-title', '正在处理...', '错误：找不到签署契约的地方。', '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1', 'xVMKC', 'urvFx', '交给我吧', '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22><span\x20style=\x22background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20width:\x2040px;\x20height:\x2040px;\x20display:\x20inline-flex;\x20justify-content:\x20center;\x20align-items:\x20center;\x20flex-shrink:\x200;\x20color:\x20var(--accent-color);\x22>', 'world-book-editor-screen', '>>\x20', '#ff8c66', 'NYxdq', '.message-container', '已设为当前用户！', '\x0a\x0a#\x20关于读者“', 'JrrsJ', 'ruPfu', 'QHsjs', 'https://sharkpan.xyz/f/yrOhN/0yixqd.jpg', 'IKciR', 'juMyS', 'widget-cover-art', 'number', 'confirm-altar-upload-button', 'TPMKZ', '\x22\x20的聊天记录吗？此操作不可撤销。', 'nuLkf', 'group-options-modal', 'cdEBO', 'tTOYH', 'splice', 'GujLZ', 'gbFqg', '点击选择\x20.jpg\x20或\x20.png', 'displayUrl', 'AI未能返回有效的JSON对象。', '#c299ff', 'hFzOp', 'gap', '28%', 'contains', '喝多了', 'object', 'jYHRu', 'quote-preview-sender', 'WrIuO', 'test_post_', 'QFaOB', 'dKAhF', '\x0a#\x20最近的动态回顾\x20(供所有角色参考)\x0a', 'content', 'lZjoo', '.selected-options-text', '正在翻阅全部历史记录...', 'RtSoE', 'transfer-backdrop', 'character-item', '编辑用户', '#message-anchor', '.slot-filename', 'vuRBf', 'urNFJ', '解析音乐文件失败:', 'OqTGU', 'QGHzC', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'getContext', '（对话结束）', 'galgame-textbox-container', 'OpKId', 'import-char-input', '\x0a#\x20交换日记摘要\x20(你和\x20', 'bBrDb', '#group-world-book-checkboxes\x20input:checked', '最近没有互动记录。', 'reset-widgets-position-button', 'JTwOJ', '这是一条由控制台添加的测试动态！样式看起来非常完美。', 'udauJ', '-input', 'https://sharkpan.xyz/f/xjmCX/zyjzew.jpg', 'GFICD', '#diary-action-reroll', '#ffcc66', '.listen-together-song', '/v1/chat/completions', '</span>', 'replaceAll', 'persona', '”吗？该角色的私聊和所有相关群聊记录都将被一并处理。', '确定要删除群聊\x22', 'world-book-checkboxes-container', '小组件背景已更换！', 'RDsEg', 'mjBSf', '最近没有动态记录。', '好友圈名称不能为空！', 'http', 'openai', 'chat_image_migrated_', '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'true', 'lLCps', 'message-bubble-row', 'lgKba', 'musicUploadAltar', 'bottom', '谁啊我吗', 'wrPTw', 'worldBooks', 'app-accounting', 'GTbcV', 'save-custom-stickers-button', 'OAwUV', '\x20(分享了歌曲:\x20', '群聊音乐搜索失败\x20(', 'oncomplete', 'AdOBC', 'ShfGY', '#bubble-preview-user', 'diaryCurrentPage', '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '34%', 'upload-widget-bg-button', 'cos', '”已创建！', '正在写入新数据...', '歌名和歌手都不能为空！', '<div\x20class=\x22post-comments-container\x22>', 'jMAGn', 'qubvI', 'endpoint', 'lidgj', 'sin', 'canvas', 'modal-root', 'https://sharkpan.xyz/f/jj6s6/yd5bpb.jpg', 'textContent', '-\x20[', 'meetingView', 'inline-block', 'images', 'warn', 'TMGHo', 'category', 'shiftKey', ']:\x20', 'PCHBu', '我的动态', '群聊已解散。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', '”\x20\x0a\x20你必须针对这段内容表达你的看法、感受或关联的思考。\x0a2.\x20\x20**【次要任务：分享自我】**\x20在回应之后，你**必须**分享一些关于你自己的、读者**不知道**的新鲜事。可以是你今天的见闻、一个突然的想法、或者一件小小的秘密。不要总是复述你们已经聊过的内容！\x0a3.\x20\x20**【禁止复读】**\x20聊天记录和动态只是你的“背景记忆”，是用来确保你不OOC的参考，**绝对不是**你日记的主要内容！\x0a\x0a#\x20你的核心人设\x20(必须遵守)\x0a', 'quote-message-button', 'artist', '1em', '真是的，必需的祭品都还没准备好！', 'char-edit-remark', 'AI返回的内容里找不到有效的JSON数组。原始回复:\x20', 'isActive', 'LIjAP', 'diary-input-wrapper', 'yxZaU', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的账本还是空白的。</p>', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'friendCircleEdit', 'stringify', 'toString', '这不是一张有效的Noir角色卡。', '音乐数据升级完成，迁移了\x20', 'app-settings', '\x0a\x20\x20\x20\x20绑定用户:\x20', 'vdnkH', 'https://sharkpan.xyz/f/pKWCQ/ztxwv0.jpg', '大家好像不知道该怎么回复...', 'createElement', 'QAlkL', 'map', '我是小丑呜呜', 'KiDEn', 'round', 'Invalid\x20saved\x20state\x20format', 'assistant', '未知用户', 'OIdJl', 'KRhoI', 'participantIds', 'YwvVE', '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20', '<input\x20type=\x22checkbox\x22\x20value=\x22', '确定要清空群聊\x22', 'href', 'back-to-diary-list', 'model', 'https://sharkpan.xyz/f/Ganul/78iwli.jpg', 'ADKKW', '|||CMD|||', 'SFZUK', '正在迁移旧的动态数据到新的好友圈系统...', 'https://sharkpan.xyz/f/4adUj/68uj9o.jpg', 'cancel-action-button', '原始文本:', '天没动静了。你的角色们应该发起新的问候或话题。', 'PanUC', 'is-entering-from-right', '”的补充信息\x0a', 'yZlVq', 'FSFZC', 'musicLibrary', 'vdNoQ', 'result', 'TSnrP', 'characterEdit', 'diary-send-button', 'toast', 'AI整理失败了，哼:\x20', 'borderBottom', 'friend-circle-title', 'NmUxg', 'VnxwK', 'change', '\x20张旧的音乐封面。', 'OmmWP', ':</span>\x20', 'zuBEI', 'editing-friend-circle-id', 'chat-reroll-button', '#FFFFFF', 'customIcon_', 'UvMRK', 'hJDvw', 'closest', '\x0a\x20\x20人设:\x20', 'COSCD', 'widget-play-pause-btn', 'cardWidgetState', '编辑条目', 'signal', 'char_', '3380kfioCr', '#ff9999', 'GGsnb', 'hfRYj', 'avatar', '）最新写下的日记内容。Ta写的是：\x0a\x20“', 'objectStoreNames', 'from', 'audio-player', 'toFixed', 'music-widget-card', 'xMaac', 'indexedDBMusicData', 'is-entering-from-left', 'EBqTb', 'data:', 'OwnBA', 'transfer-recipient-group', 'mxGco', 'diary-write-button', 'touchcancel', 'iXtve', '#\x20记录是空的，没什么好总结的。', '--feed-bg-image', 'VMEEY', 'GoniK', '条新动态挑选发布者。你可以让同一个人发布多次，也可以让不同人发布。\x0a3.\x20\x20**创作动态**:\x20扮演你选中的作者，创作符合其人设和记忆的动态内容。可以是文字或分享音乐。\x0a4.\x20\x20**模拟互动**:\x20为每一条你创作的动态，切换视角到【圈内其他成员】，模拟他们可能做出的点赞和评论。互动必须符合他们各自的性格。\x0a\x0a#\x20输出格式【绝对规则】\x0a-\x20你的输出**必须**是一个语法完全正确的、单一的JSON数组，包含\x20', 'pwttW', 'editing-user-id', '\x20之间的私密内容)\x0a', 'lyrics-file-input', 'musicPlaylist', 'SNmIu', 'aLsqt', '图片预览失败:\x20', 'gpFhn', '条目名称和内容都不能为空！', 'appIconPosition_app-music-library', 'pphYW', '[DONE]', '正在为你搬运旧壁纸到新仓库...', 'ZYCXa', 'cover_placeholder_', 'wtUES', 'noir_migration_fc_v1_complete']; _0x2dfc = function () { return _0x3ce4a7; }; return _0x2dfc(); } function _0x46f332(_0x3d7cae, _0x25c2af = 0x320, _0x27008b = 0.8, _0x3cafee = ![]) { return new Promise((_0x364d65, _0x2cb434) => { const _0x251389 = _0x22cc; if (!_0x3d7cae || !_0x3d7cae['type'][_0x251389(0x245)](_0x251389(0x447))) return _0x2cb434(new Error(_0x251389(0x908))); const _0x547bcc = new FileReader(); _0x547bcc[_0x251389(0x4c5)](_0x3d7cae), _0x547bcc[_0x251389(0x575)] = _0x1cf5d9 => { const _0x12df27 = _0x251389, _0x116e93 = new Image(); _0x116e93[_0x12df27(0x6c3)] = _0x1cf5d9[_0x12df27(0x68b)][_0x12df27(0x84e)], _0x116e93[_0x12df27(0x575)] = () => { const _0x363085 = _0x12df27, _0xe221a4 = document['createElement'](_0x363085(0x803)); let _0x403356 = _0x116e93['width'], _0x500431 = _0x116e93[_0x363085(0x8ab)]; if (_0x403356 > _0x500431) _0x403356 > _0x25c2af && (_0x500431 *= _0x25c2af / _0x403356, _0x403356 = _0x25c2af); else { if (_0x363085(0x5c5) === _0x363085(0x5c5)) { if (_0x500431 > _0x25c2af) { if (_0x363085(0x41c) !== _0x363085(0x41c)) { const _0x408f30 = _0x28834a[_0x363085(0x1de)](_0x12e654); _0x54f357['src'] = _0x408f30, _0x4dba7d[_0x363085(0x575)] = () => { const _0x54a0ba = _0x363085; _0x4bd1d2[_0x54a0ba(0x3cf)](_0x408f30); }; } else _0x403356 *= _0x25c2af / _0x500431, _0x500431 = _0x25c2af; } } else _0x52227d[_0x363085(0x836)][_0x363085(0x279)](_0x570fb0 => { const _0x1fb606 = _0x363085, _0x22e331 = _0x5a7134(_0x570fb0); if (_0x22e331) { const _0x301684 = _0x5b95d8['createElement']('option'); _0x301684['value'] = _0x22e331['id'], _0x301684['textContent'] = _0x22e331[_0x1fb606(0x8fa)], _0x32aae2[_0x1fb606(0x54e)](_0x301684); } }), _0x3e4054[_0x363085(0x645)][_0x363085(0x23e)] = _0x363085(0x2a9); } _0xe221a4['width'] = _0x403356, _0xe221a4[_0x363085(0x8ab)] = _0x500431; const _0x1857b0 = _0xe221a4[_0x363085(0x7bf)]('2d'); _0x1857b0[_0x363085(0x50f)](_0x116e93, 0x0, 0x0, _0x403356, _0x500431); const _0x46348b = _0x3d7cae[_0x363085(0x327)] === 'image/png' ? 'image/png' : _0x363085(0x265); _0x3cafee ? _0xe221a4[_0x363085(0x2e2)](_0x3a81b8 => { const _0x4ba183 = _0x363085; if ('pFcKo' === 'pFcKo') { if (_0x3a81b8) _0x4ba183(0x13f) === _0x4ba183(0x13f) ? _0x364d65(_0x3a81b8) : _0x1ee144 = _0x3a0584['content']; else { if (_0x4ba183(0x739) !== _0x4ba183(0x94b)) _0x2cb434(new Error(_0x4ba183(0x3b3))); else { const _0x5c47d8 = { 'quotedMessage': null, 'content': _0xc3407e }, _0x3cd4f3 = _0x3d379d[_0x4ba183(0x199)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x3cd4f3 && (_0x5c47d8[_0x4ba183(0x177)] = { 'sender': _0x3cd4f3[0x1][_0x4ba183(0x163)](), 'content': _0x3cd4f3[0x2][_0x4ba183(0x163)]() }, _0x5c47d8[_0x4ba183(0x7af)] = _0x5c22a8['substring'](_0x3cd4f3[0x0][_0x4ba183(0x2bd)])['trim']()), _0x5c47d8; } } } else _0xdc203f[_0x4ba183(0x598)](_0x4ba183(0x6c4), _0x1bec02[_0x4ba183(0x822)]({ 'playlist': _0x29383c['musicPlaylist'], 'currentIndex': _0x45ac88['currentlyPlayingIndex'] })); }, _0x46348b, _0x27008b) : _0x363085(0x8d0) !== 'gfqoj' ? (_0x8b31a8[_0x363085(0x8fa)] = _0x40f6ed[_0x363085(0x163)](), _0xdb9f9c(), _0xe14b33(), _0xb8c36(), _0x441896(_0x363085(0x90b) + _0x48015b[_0x363085(0x8fa)] + '\x22。')) : _0x364d65(_0xe221a4[_0x363085(0x262)](_0x46348b, _0x27008b)); }, _0x116e93[_0x12df27(0x911)] = _0x2d316d => _0x2cb434(_0x2d316d); }, _0x547bcc[_0x251389(0x911)] = _0x4d376d => _0x2cb434(_0x4d376d); }); } function _0x1ac482(_0xf7f934) { return new Promise((_0x8dd41, _0x178ac6) => { const _0x5b192e = _0x22cc; if (_0x5b192e(0x1c0) === _0x5b192e(0x1c0)) { const _0x4f6e70 = new FileReader(); _0x4f6e70[_0x5b192e(0x225)] = () => _0x8dd41(_0x4f6e70['result']), _0x4f6e70['onerror'] = _0x178ac6, _0x4f6e70[_0x5b192e(0x4c5)](_0xf7f934); } else { const _0x2a3231 = _0x2d8670[_0x5b192e(0x135)]; let _0x576f80 = _0x2a3231['replace'](/\.bubble\.sent/g, _0x5b192e(0x7f4))[_0x5b192e(0x2ce)](/\.bubble\.received/g, '#bubble-preview-ai'); _0x1437e3[_0x5b192e(0x978)] = _0x576f80; } }); } function _0x1ac482(_0x22e2ee) { return new Promise((_0x41f9ed, _0x1985a9) => { const _0x322be6 = _0x22cc, _0x2b5fee = new FileReader(); _0x2b5fee[_0x322be6(0x225)] = () => _0x41f9ed(_0x2b5fee[_0x322be6(0x84e)]), _0x2b5fee[_0x322be6(0x911)] = _0x1985a9, _0x2b5fee[_0x322be6(0x4c5)](_0x22e2ee); }); } function _0x2dda9a(_0x3faa58, _0x22834e, _0x53c7b1) { const _0x689b92 = _0x18377a, _0x1ca5b6 = _0x948abf => { const _0x12e1d5 = _0x22cc; if (_0x948abf[_0x12e1d5(0x3f7)] === _0x12e1d5(0x75d)) return _0x4d4ca5['userProfile']?.[_0x12e1d5(0x8fa)] || _0x12e1d5(0x4f6); if (_0x3faa58[_0x12e1d5(0x327)] === 'group') { const _0x289021 = _0x948abf[_0x12e1d5(0x6bd)] ? _0x12df28(_0x948abf[_0x12e1d5(0x6bd)]) : null; return _0x289021?.[_0x12e1d5(0x8fa)] || 'Unknown'; } else { if (_0x12e1d5(0x841) === _0x12e1d5(0x841)) { const _0x2cdcbc = _0x12df28(_0x3faa58['participantIds'][0x0]); return _0x2cdcbc?.[_0x12e1d5(0x8fa)] || 'AI'; } else _0x5c1601(_0x12e1d5(0x2bc)); } }, _0x32721d = _0x22834e[_0x689b92(0x61e)](-_0x53c7b1), _0x387ed7 = []; for (const _0x3c4d6d of _0x32721d) { const _0x3e637b = new Date(_0x3c4d6d[_0x689b92(0x2c3)])[_0x689b92(0x597)](_0x689b92(0x2f2), { 'hour': _0x689b92(0x3de), 'minute': '2-digit' }); _0x3c4d6d[_0x689b92(0x7af)] && _0x387ed7[_0x689b92(0x956)]('[' + _0x3e637b + _0x689b92(0x1a9) + _0x1ca5b6(_0x3c4d6d) + ']\x20' + String(_0x3c4d6d[_0x689b92(0x7af)])[_0x689b92(0x163)]()); } return _0x387ed7; } function _0x1bf50b(_0x4ed72f) { const _0x52c148 = _0x18377a; if (_0x4ed72f[_0x52c148(0x327)] === _0x52c148(0x70e)) return _0x52c148(0x930) + (_0x4ed72f[_0x52c148(0x8fa)] || _0x52c148(0x4f2)) + '」'; const _0x2bf998 = _0x12df28(_0x4ed72f['participantIds'][0x0]); return '与\x20' + (_0x2bf998?.['name'] || _0x52c148(0x385)) + '\x20的私聊'; } function _0x22cc(_0x3fd8e5, _0x75b803) { const _0x2dfc94 = _0x2dfc(); return _0x22cc = function (_0x22cc2a, _0x148397) { _0x22cc2a = _0x22cc2a - 0x12b; let _0x1b3bdb = _0x2dfc94[_0x22cc2a]; return _0x1b3bdb; }, _0x22cc(_0x3fd8e5, _0x75b803); } function _0x4603a4(_0x36e849) { const _0x19c39f = _0x18377a; try { if (_0x19c39f(0x2fb) === _0x19c39f(0x913)) { const _0xbee668 = _0x17a6e0['open'](_0x1eac70, 0x2); _0xbee668[_0x19c39f(0x911)] = () => _0x581f4b(_0x19c39f(0x39b)), _0xbee668['onsuccess'] = () => _0x1f7e6f(_0xbee668[_0x19c39f(0x84e)]); } else { const _0x8d89c = localStorage[_0x19c39f(0x745)](_0x19c39f(0x201) + _0x36e849), _0x4d5290 = JSON[_0x19c39f(0x213)](_0x8d89c || '[]'); return Array[_0x19c39f(0x189)](_0x4d5290) ? _0x4d5290 : []; } } catch { return []; } } function _0x4a974c(_0x28820b, _0xb1396f) { const _0x4abd0f = _0x18377a, _0x2c8c03 = Math['max'](0x1, Number(_0x4d4ca5[_0x4abd0f(0x2d6)]?.[_0x4abd0f(0x4cb)] ?? 0x64)), _0x35b499 = _0x4d4ca5[_0x4abd0f(0x53f)][_0x4abd0f(0x5fe)](_0x1eb05a => _0x1eb05a[_0x4abd0f(0x836)]['includes'](_0x28820b))[_0x4abd0f(0x450)]((_0x1a6593, _0x392b6c) => _0x1a6593['id'] === _0xb1396f ? -0x1 : _0x392b6c['id'] === _0xb1396f ? 0x1 : 0x0), _0x251922 = [], _0x3dd442 = {}; for (const _0x27f419 of _0x35b499) { const _0x1b131f = _0xb1396f && _0x27f419['id'] === _0xb1396f ? _0x4d4ca5[_0x4abd0f(0x28d)] : _0x4603a4(_0x27f419['id']); if (!_0x1b131f?.[_0x4abd0f(0x2bd)]) continue; const _0x19004f = _0x2dda9a(_0x27f419, _0x1b131f, _0x2c8c03); if (!_0x19004f[_0x4abd0f(0x2bd)]) continue; _0x251922[_0x4abd0f(0x956)](_0x4abd0f(0x92c) + _0x1bf50b(_0x27f419) + '\x0a' + _0x19004f[_0x4abd0f(0x5cd)]('\x0a')), _0x3dd442[_0x27f419['id']] = _0x19004f[_0x4abd0f(0x2bd)]; } return { 'omniText': _0x251922[_0x4abd0f(0x5cd)]('\x0a\x0a'), 'usedCounts': _0x3dd442 }; } function _0x12d6c3(_0x1adf38) { const _0x5d473c = _0x18377a; let _0xa6fa90 = null; const _0xfed0c8 = _0x4d4ca5[_0x5d473c(0x53f)][_0x5d473c(0x5fe)](_0x1e5d68 => _0x1e5d68['participantIds']['includes'](_0x1adf38)); for (const _0x4bc57a of _0xfed0c8) { if (_0x5d473c(0x3e7) === _0x5d473c(0x3e7)) { const _0x33abcb = _0x4603a4(_0x4bc57a['id']); if (_0x33abcb && _0x33abcb[_0x5d473c(0x2bd)] > 0x0) { if (_0x5d473c(0x310) === _0x5d473c(0x310)) { const _0x4559a7 = _0x33abcb[_0x33abcb[_0x5d473c(0x2bd)] - 0x1]; (!_0xa6fa90 || _0x4559a7[_0x5d473c(0x2c3)] > _0xa6fa90[_0x5d473c(0x2c3)]) && (_0x5d473c(0x5de) !== _0x5d473c(0x5de) ? _0x40b529[_0x5d473c(0x93a)]('切，加载播放器状态的时候出错了。', _0x279599) : _0xa6fa90 = _0x4559a7); } else _0x1f5a61[_0x5d473c(0x645)][_0x5d473c(0x32e)] = 'absolute', _0x1ac7f8[_0x5d473c(0x645)]['top'] = _0x5d473c(0x202), _0x2bc5a2[_0x5d473c(0x645)][_0x5d473c(0x2c5)] = _0x5d473c(0x646), _0x5df7ca['style'][_0x5d473c(0x25d)] = _0x5d473c(0x552), _0x50305a['style'][_0x5d473c(0x23e)] = _0x5d473c(0x809); } } else { _0x3462cf = _0x44a469(); const _0x40b138 = _0x21250d[_0x5d473c(0x6c2)](_0x5d473c(0x2b2))[_0x5d473c(0x806)]; _0x26ab8d = _0x40b138 || _0x5d473c(0x13a); } } return _0xa6fa90; } function _0x20e943(_0x4ffd8f) { const _0x51727d = _0x18377a; if (!_0x4ffd8f || !_0x4ffd8f[_0x51727d(0x407)](',')) return _0x4ffd8f; const _0x1f2852 = _0x4ffd8f[_0x51727d(0x3e8)](',')[_0x51727d(0x82d)](_0x1b082e => _0x1b082e['trim']()); return _0x1f2852[Math[_0x51727d(0x54d)](Math[_0x51727d(0x4e7)]() * _0x1f2852[_0x51727d(0x2bd)])]; } function _0x385a44(_0x43da09) { return new Promise(_0xf5d134 => { const _0x15ad9c = _0x22cc; if (_0x15ad9c(0x763) !== _0x15ad9c(0x319)) { const _0x1ef016 = document['getElementById'](_0x15ad9c(0x804)), _0x30baba = document['getElementById'](_0x15ad9c(0x971)), _0x35ae00 = document[_0x15ad9c(0x6c2)](_0x15ad9c(0x186)), _0x455af9 = document[_0x15ad9c(0x6c2)]('modal-cancel'), _0x57be72 = document[_0x15ad9c(0x6c2)](_0x15ad9c(0x418)); _0x30baba[_0x15ad9c(0x806)] = _0x43da09, _0x1ef016[_0x15ad9c(0x645)]['display'] = _0x15ad9c(0x381); const _0x588a4a = _0x2062fd => { const _0x246c36 = _0x15ad9c; if (_0x246c36(0x73a) === _0x246c36(0x66c)) { _0x39c9df(_0x246c36(0x88f)); return; } else _0x1ef016['style'][_0x246c36(0x23e)] = 'none', _0x35ae00[_0x246c36(0x254)] = _0x455af9['onclick'] = _0x57be72[_0x246c36(0x254)] = null, document[_0x246c36(0x653)](_0x246c36(0x6d5), _0x784343), _0xf5d134(_0x2062fd); }, _0x784343 = _0x400535 => { const _0xbe40b5 = _0x15ad9c; if (_0x400535[_0xbe40b5(0x8c3)] === _0xbe40b5(0x73d)) _0x588a4a(![]); if (_0x400535[_0xbe40b5(0x8c3)] === _0xbe40b5(0x161)) _0x588a4a(!![]); }; _0x35ae00[_0x15ad9c(0x254)] = () => _0x588a4a(!![]), _0x455af9['onclick'] = () => _0x588a4a(![]), _0x57be72[_0x15ad9c(0x254)] = () => _0x588a4a(![]), document['addEventListener'](_0x15ad9c(0x6d5), _0x784343); } else _0x512df4[_0x15ad9c(0x8fa)] !== 'AbortError' && (_0x3a8952[_0x15ad9c(0x93a)](_0x15ad9c(0x377), _0x4902f6), _0x4b28c7({ 'role': _0x15ad9c(0x832), 'content': _0x15ad9c(0x67a) + _0x541c5c['message'] }, _0x5be829[_0x15ad9c(0x28d)]['length'] - 0x1)); }); } function _0x589297(_0x5e55b9) { const _0x1cef37 = _0x18377a, _0x2f821d = document[_0x1cef37(0x6c2)](_0x1cef37(0x852)); _0x2f821d['textContent'] = _0x5e55b9, _0x2f821d[_0x1cef37(0x645)][_0x1cef37(0x23e)] = _0x1cef37(0x2a9); if (_0x589297['_t']) clearTimeout(_0x589297['_t']); _0x589297['_t'] = setTimeout(() => { const _0x5cfbe0 = _0x1cef37; _0x5cfbe0(0x987) === _0x5cfbe0(0x4a2) ? _0x249bbc[_0x5cfbe0(0x955)]() : _0x2f821d[_0x5cfbe0(0x645)][_0x5cfbe0(0x23e)] = _0x5cfbe0(0x4aa); }, 0x640); } function _0x20c5de() { const _0x4d1f09 = _0x18377a, _0x18d977 = document[_0x4d1f09(0x6c2)]('app-pages-container'), _0x1b11bc = document[_0x4d1f09(0x6c2)](_0x4d1f09(0x1dc)), _0x11e096 = document[_0x4d1f09(0x445)](_0x4d1f09(0x2bb)); if (!_0x18d977 || !_0x1b11bc || _0x11e096[_0x4d1f09(0x2bd)] === 0x0) return; let _0x5852ba = 0x0; const _0x152581 = _0x11e096[_0x4d1f09(0x2bd)]; function _0x3bf5c1(_0x593741) { const _0x44aa98 = _0x4d1f09; if (_0x593741 < 0x0 || _0x593741 >= _0x152581) return; _0x1b11bc[_0x44aa98(0x645)][_0x44aa98(0x25d)] = _0x44aa98(0x591) + _0x593741 * (0x64 / _0x152581) + '%)', _0x11e096['forEach'](_0x1c832d => _0x1c832d[_0x44aa98(0x970)]['remove'](_0x44aa98(0x68c))), _0x11e096[_0x593741][_0x44aa98(0x970)][_0x44aa98(0x68a)](_0x44aa98(0x68c)), _0x5852ba = _0x593741; } _0x11e096[_0x4d1f09(0x279)](_0xf2ed4 => { const _0xd5669e = _0x4d1f09; _0xf2ed4[_0xd5669e(0x501)](_0xd5669e(0x4bd), () => { const _0x108204 = _0xd5669e, _0x379501 = parseInt(_0xf2ed4[_0x108204(0x42a)]['page'], 0xa); _0x3bf5c1(_0x379501); }); }); let _0x208603 = 0x0, _0x5e5f2d = 0x0, _0x474cd3 = 0x0, _0x491d31 = ![], _0x219e8a = ''; _0x18d977[_0x4d1f09(0x501)](_0x4d1f09(0x8c6), _0x248dce => { const _0x35288e = _0x4d1f09; _0x208603 = _0x248dce['touches'][0x0][_0x35288e(0x21e)], _0x5e5f2d = _0x248dce[_0x35288e(0x288)][0x0][_0x35288e(0x555)], _0x491d31 = !![], _0x219e8a = ''; }, { 'passive': !![] }), _0x18d977[_0x4d1f09(0x501)]('touchmove', _0x1da0e5 => { const _0x3ab148 = _0x4d1f09; if (!_0x491d31) return; if (_0x219e8a === '') { const _0x22c5bd = _0x1da0e5[_0x3ab148(0x288)][0x0]['clientX'] - _0x208603, _0x42005e = _0x1da0e5[_0x3ab148(0x288)][0x0][_0x3ab148(0x555)] - _0x5e5f2d; if (Math[_0x3ab148(0x6a4)](_0x22c5bd) > Math[_0x3ab148(0x6a4)](_0x42005e)) _0x219e8a = _0x3ab148(0x2fc); else { if (_0x3ab148(0x223) === _0x3ab148(0x1d7)) { if (_0x14c9f8['name'] !== _0x3ab148(0x33a)) { _0x2c0956[_0x3ab148(0x93a)](_0x3ab148(0x243), _0x1c19ee); const _0x5e26cb = { 'role': _0x3ab148(0x832), 'content': '错误:\x20' + _0x2d48dd['message'], 'senderId': _0x386347['id'], 'isOffline': _0x1b11fc }; _0x3e5539[_0x3ab148(0x28d)]['push'](_0x5e26cb), _0x50d113(); } return ![]; } else _0x219e8a = 'vertical'; } } _0x219e8a === _0x3ab148(0x2fc) && _0x1da0e5[_0x3ab148(0x955)](); }, { 'passive': ![] }), _0x18d977[_0x4d1f09(0x501)](_0x4d1f09(0x27f), _0xc71469 => { const _0x80eac5 = _0x4d1f09; if (_0x80eac5(0x93d) !== 'QyXhJ') { if (!_0x491d31) return; _0x474cd3 = _0xc71469[_0x80eac5(0x95d)][0x0][_0x80eac5(0x8ad)], _0x219e8a === _0x80eac5(0x2fc) && _0x34fade(), _0x491d31 = ![]; } else _0x5bfd6a(_0x32e340['id'], _0x11d555['map'](_0x3e055e => _0x3e055e['id'])); }); function _0x34fade() { const _0x51e72e = _0x4d1f09, _0x24e21b = 0x32; if (_0x474cd3 < _0x208603 - _0x24e21b) _0x51e72e(0x8f5) !== _0x51e72e(0x605) ? _0x3bf5c1(_0x5852ba + 0x1) : _0x5bcaac[_0x51e72e(0x899)](_0x479220, _0x1a3541[_0x51e72e(0x6ba)]); else _0x474cd3 > _0x208603 + _0x24e21b && _0x3bf5c1(_0x5852ba - 0x1); } } function _0x4679ee() { return new Promise(_0x9c5698 => { const _0x1b5752 = _0x22cc, _0x5deaec = document[_0x1b5752(0x6c2)]('music-input-modal'), _0x38317c = document['getElementById'](_0x1b5752(0x6b7)), _0x3e061f = document[_0x1b5752(0x6c2)](_0x1b5752(0x8a6)), _0x29a708 = document[_0x1b5752(0x6c2)](_0x1b5752(0x59d)), _0x1e388f = document[_0x1b5752(0x6c2)](_0x1b5752(0x8fc)), _0x513b09 = document['getElementById'](_0x1b5752(0x1d9)); _0x38317c[_0x1b5752(0x135)] = '', _0x3e061f['value'] = '', _0x5deaec[_0x1b5752(0x970)][_0x1b5752(0x68a)]('show'), _0x38317c[_0x1b5752(0x8df)](); const _0xe21a9d = _0x4c00c6 => { const _0x212900 = _0x1b5752; _0x5deaec[_0x212900(0x970)][_0x212900(0x6ae)](_0x212900(0x3a7)), _0x29a708[_0x212900(0x254)] = null, _0x1e388f[_0x212900(0x254)] = null, _0x513b09['onclick'] = null, document['removeEventListener'](_0x212900(0x6d5), _0x2e9505), _0x9c5698(_0x4c00c6); }, _0x2342ea = () => { const _0x2b8530 = _0x1b5752, _0xec287c = _0x38317c[_0x2b8530(0x135)][_0x2b8530(0x163)](), _0x40f7bd = _0x3e061f[_0x2b8530(0x135)]['trim'](); if (!_0xec287c || !_0x40f7bd) { if (_0x2b8530(0x615) === _0x2b8530(0x1d1)) _0x3b1701(_0x2b8530(0x9b8)); else { _0x589297('歌名和歌手都不能为空！'); return; } } _0xe21a9d({ 'songName': _0xec287c, 'artist': _0x40f7bd }); }, _0x2e9505 = _0x5345e1 => { const _0x22fc60 = _0x1b5752; if (_0x5345e1[_0x22fc60(0x8c3)] === _0x22fc60(0x73d)) _0xe21a9d(null); if (_0x5345e1[_0x22fc60(0x8c3)] === _0x22fc60(0x161)) { if (_0x22fc60(0x2a3) === _0x22fc60(0x3f8)) { _0x529185['characters'] = _0x2ffc7c[_0x22fc60(0x4ee)][_0x22fc60(0x5fe)](_0x5bf1b6 => _0x5bf1b6['id'] !== _0x12e7bb), _0x482e01[_0x22fc60(0x53f)][_0x22fc60(0x279)](_0x4b33ab => { const _0x104441 = _0x22fc60; _0x4b33ab[_0x104441(0x327)] === _0x104441(0x70e) && (_0x4b33ab[_0x104441(0x836)] = _0x4b33ab['participantIds']['filter'](_0x372bb4 => _0x372bb4 !== _0xe5fc37)); }); const _0x47e21a = _0x3a3e7c[_0x22fc60(0x53f)][_0x22fc60(0x5a8)](_0x5b5ad1 => _0x5b5ad1['type'] === _0x22fc60(0x17c) && _0x5b5ad1[_0x22fc60(0x836)][_0x22fc60(0x407)](_0x45de4a)); _0x47e21a && _0x3dc52c(_0x47e21a['id']), _0x5819f9[_0x22fc60(0x53f)] = _0x4dcdc3['chats'][_0x22fc60(0x5fe)](_0x35fa72 => _0x35fa72['type'] !== _0x22fc60(0x70e) || _0x35fa72[_0x22fc60(0x836)]['length'] > 0x1), _0x51959d(), _0x567c22(); } else _0x5345e1[_0x22fc60(0x955)](), _0x2342ea(); } }; _0x29a708[_0x1b5752(0x254)] = _0x2342ea, _0x1e388f[_0x1b5752(0x254)] = () => _0xe21a9d(null), _0x513b09[_0x1b5752(0x254)] = () => _0xe21a9d(null), document['addEventListener'](_0x1b5752(0x6d5), _0x2e9505); }); } function _0x3e6624(_0x1f3e3c) { const _0x2be071 = _0x18377a; if (!_0x1f3e3c) return []; const _0x4468f0 = _0x1f3e3c['trim'](); if (_0x4468f0[_0x2be071(0x245)](_0x2be071(0x6e9)) && _0x4468f0['endsWith'](_0x2be071(0x455))) { if (_0x2be071(0x391) === 'OZUlb') return [_0x4468f0]; else _0x17a40a(), _0x5be0a7[_0x2be071(0x226)] = 0x64; } const _0xc35ee6 = /(\[sticker:[^\]]+\]|\[music:[^\]]+\]|\[transfer:[^\]]+\])/g, _0x3a37b4 = _0x2be071(0x840), _0xd26f85 = [], _0x1c06e9 = _0x1f3e3c[_0x2be071(0x2ce)](_0xc35ee6, _0x18554 => { const _0x475901 = _0x2be071; return _0xd26f85[_0x475901(0x956)](_0x18554), _0x3a37b4; }), _0x320069 = _0x1c06e9[_0x2be071(0x3e8)](_0x3a37b4), _0x5a0e7f = []; let _0x65e0d0 = 0x0; return _0x320069[_0x2be071(0x279)]((_0x574812, _0x2b15ee) => { const _0x53d31f = _0x2be071; if (_0x53d31f(0x898) === _0x53d31f(0x898)) { const _0x61ff31 = _0x574812[_0x53d31f(0x163)](); if (_0x61ff31) { if (_0x53d31f(0x459) === 'YKZDf') _0x5a0e7f[_0x53d31f(0x956)](..._0x3479c2(_0x61ff31)); else { const _0x3a5e9b = _0x294f52[_0x53d31f(0x5a2)](_0x53d31f(0x80a), _0x53d31f(0x30f)), _0x5caebd = _0x3a5e9b['objectStore']('images'), _0x12e64e = _0x5caebd[_0x53d31f(0x6a0)]({ 'id': _0x271196, 'blob': _0x6aa159 }); _0x12e64e[_0x53d31f(0x578)] = () => _0x36f580(_0x12e64e[_0x53d31f(0x84e)]), _0x12e64e[_0x53d31f(0x911)] = () => _0x1319ac(_0x12e64e[_0x53d31f(0x93a)]); } } _0x65e0d0 < _0xd26f85[_0x53d31f(0x2bd)] && (_0x5a0e7f[_0x53d31f(0x956)](_0xd26f85[_0x65e0d0][_0x53d31f(0x163)]()), _0x65e0d0++); } else { const _0x497f19 = _0x13514b[_0x53d31f(0x82b)](_0x53d31f(0x46f)); _0x497f19['className'] = _0x53d31f(0x436); const _0x3672e8 = _0x2b3e38[_0x53d31f(0x2b6)] ? _0x37dc42[_0x53d31f(0x1de)](_0x47fca7[_0x53d31f(0x2b6)]) : _0x1f6c49; _0x497f19[_0x53d31f(0x978)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x3672e8 + _0x53d31f(0x561) + (_0x488f4b[_0x53d31f(0x6e1)][_0x53d31f(0x38b)] || '未知歌曲') + _0x53d31f(0x1b5) + (_0x45b090[_0x53d31f(0x6e1)]['歌手'] || _0x53d31f(0x568)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x497f19[_0x53d31f(0x501)](_0x53d31f(0x4bd), () => { _0x1ad3d1(_0x31f14f); }), _0x4eee64[_0x53d31f(0x54e)](_0x497f19); } }), _0x5a0e7f; } function _0x2a12dc(_0xf6cfc1) { const _0x32b972 = _0x18377a; if (!_0xf6cfc1) return []; let _0x3cdacd = String(_0xf6cfc1)['trim'](); const _0x2f9285 = _0x3cdacd[_0x32b972(0x199)](/```(?:json)?([\s\S]*?)```/i); if (_0x2f9285) _0x3cdacd = _0x2f9285[0x1][_0x32b972(0x163)](); try { const _0x4c7dff = JSON['parse'](_0x3cdacd); if (_0x4c7dff && Array[_0x32b972(0x189)](_0x4c7dff[_0x32b972(0x27b)])) { if (_0x32b972(0x86e) === _0x32b972(0x951)) { _0x42ca19(_0x32b972(0x825) + _0x22d180 + _0x32b972(0x3e4)), _0xa88417(() => _0x9825f5[_0x32b972(0x8c5)](), 0x5dc); return; } else return _0x4c7dff[_0x32b972(0x27b)][_0x32b972(0x82d)](_0x2b69e2 => typeof _0x2b69e2 === 'string' ? _0x2b69e2 : _0x2b69e2?.['content'])[_0x32b972(0x5fe)](Boolean)[_0x32b972(0x772)](_0x3479c2); } const _0x389814 = [_0x32b972(0x296), 'dialogue', _0x32b972(0x6a1), 'text', 'content', _0x32b972(0x6aa), 'utterance']; if (_0x4c7dff && typeof _0x4c7dff === _0x32b972(0x7a7)) { if (_0x32b972(0x32c) === _0x32b972(0x70d)) { const _0x56f98c = _0x23378b[_0x32b972(0x5e5)](_0x32b972(0x4b1)); if (_0x56f98c && (_0x56f98c['id'] === _0x32b972(0x47c) || _0x56f98c['id'] === _0x32b972(0x250))) _0x762f6c(); else { const _0x146775 = _0x26cc59[_0x32b972(0x445)](_0x32b972(0x6b6)); _0x146775[_0x32b972(0x279)](_0x4756e7 => _0x4756e7['remove']()); } } else { const _0x1f9783 = []; for (const _0x55124f of Object['keys'](_0x4c7dff)) { const _0x7e44bf = _0x55124f[_0x32b972(0x5f0)](); if (_0x389814[_0x32b972(0x553)](_0x5d798f => _0x7e44bf['startsWith'](_0x5d798f))) { if (_0x32b972(0x235) !== _0x32b972(0x2d2)) { const _0x5ede22 = _0x4c7dff[_0x55124f]; if (typeof _0x5ede22 === _0x32b972(0x338)) _0x1f9783[_0x32b972(0x956)](_0x5ede22); if (Array['isArray'](_0x5ede22)) _0x5ede22[_0x32b972(0x279)](_0x1259fe => { const _0x61146d = _0x32b972; if (typeof _0x1259fe === _0x61146d(0x338)) _0x1f9783[_0x61146d(0x956)](_0x1259fe); }); } else { if (_0x5d6c43[_0x32b972(0x2bd)] === 0x0) return; _0x254b1b = (_0x4f2c0f - 0x1 + _0x76ca60[_0x32b972(0x2bd)]) % _0x53d978[_0x32b972(0x2bd)], _0x25988b(_0xc3bb2f[_0x1ed09d], _0x29f473); } } } if (_0x1f9783['length']) return _0x1f9783[_0x32b972(0x772)](_0x3479c2)[_0x32b972(0x61e)](0x0, 0x9); } } } catch { } if (/[{\[]/['test'](_0x3cdacd) && /":/[_0x32b972(0x778)](_0x3cdacd)) { const _0x6f0ab = [], _0x34b01f = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x3eeb44; while ((_0x3eeb44 = _0x34b01f['exec'](_0x3cdacd)) !== null) { if (_0x32b972(0x629) !== _0x32b972(0x45f)) { const _0x47ebd1 = _0x3eeb44[0x1][_0x32b972(0x2ce)](/\\"/g, '\x22')[_0x32b972(0x2ce)](/\\n/g, '\x0a')[_0x32b972(0x163)](); if (_0x47ebd1) _0x6f0ab[_0x32b972(0x956)](_0x47ebd1); } else _0x334ff5[_0x32b972(0x776)] = _0x52cc6a, _0x1aee26 = !![]; } if (_0x6f0ab[_0x32b972(0x2bd)]) return _0x6f0ab['flatMap'](_0x3479c2)[_0x32b972(0x61e)](0x0, 0x9); } return _0x3479c2(_0x3cdacd); } function _0x3479c2(_0x528bc1) { const _0x3679b6 = _0x18377a; if (!_0x528bc1) return []; const _0x199919 = String(_0x528bc1)['trim'](), _0x34eb60 = _0x199919[_0x3679b6(0x3e8)](/(?<=[。！？!?…])\s+|[\r\n]+/)[_0x3679b6(0x82d)](_0x76d0bd => _0x76d0bd[_0x3679b6(0x163)]())['filter'](Boolean); if (_0x34eb60[_0x3679b6(0x2bd)] > 0x0) return _0x34eb60[_0x3679b6(0x61e)](0x0, 0x9); return [_0x199919][_0x3679b6(0x5fe)](Boolean); } const _0xc4a531 = _0x18377a(0x8c2), _0x136299 = 'images', _0x4c74c3 = new Promise((_0x4a33c5, _0x4c02b7) => { const _0x2e016b = _0x18377a, _0x2ba0b5 = indexedDB[_0x2e016b(0x71c)](_0xc4a531, 0x2); _0x2ba0b5[_0x2e016b(0x911)] = () => _0x4c02b7(_0x2e016b(0x39b)), _0x2ba0b5[_0x2e016b(0x578)] = () => _0x4a33c5(_0x2ba0b5[_0x2e016b(0x84e)]), _0x2ba0b5['onupgradeneeded'] = _0x5b02db => { const _0x13803e = _0x2e016b; if (_0x13803e(0x891) === _0x13803e(0x74d)) _0x4f52dc[_0x13803e(0x956)]({ 'time': _0x3b77e1, 'text': _0x56b2e1 }); else { const _0x4281b9 = _0x5b02db[_0x13803e(0x68b)][_0x13803e(0x84e)]; !_0x4281b9[_0x13803e(0x871)]['contains'](_0x136299) && _0x4281b9['createObjectStore'](_0x136299, { 'keyPath': 'id' }); const _0x266c03 = _0x13803e(0x6f6); !_0x4281b9['objectStoreNames'][_0x13803e(0x7a5)](_0x266c03) && (_0x13803e(0x998) === 'dWvGf' ? _0x4281b9[_0x13803e(0x901)](_0x266c03, { 'keyPath': 'id' }) : _0x4530aa = _0x521344[_0x13803e(0x5fe)](_0x15a380 => _0x15a380 && typeof _0x15a380 === 'object' && typeof _0x15a380['role'] === _0x13803e(0x338) && typeof _0x15a380[_0x13803e(0x7af)] !== _0x13803e(0x210))); } }; }); async function _0x299fa0(_0x4a0db1) { const _0x5e0231 = await _0x4c74c3; return new Promise((_0x935365, _0x1e0439) => { const _0x542989 = _0x22cc; if (_0x542989(0x271) === _0x542989(0x271)) { const _0x3be7ce = _0x5e0231['transaction'](_0x136299, 'readonly'), _0x515cca = _0x3be7ce[_0x542989(0x706)](_0x136299), _0xe76e67 = _0x515cca[_0x542989(0x261)](_0x4a0db1); _0xe76e67[_0x542989(0x578)] = () => _0x935365(_0xe76e67[_0x542989(0x84e)] ? _0xe76e67[_0x542989(0x84e)]['blob'] : null), _0xe76e67[_0x542989(0x911)] = () => _0x1e0439(_0xe76e67[_0x542989(0x93a)]); } else _0x5eaa7b[_0x542989(0x4f1)] = _0x599744, _0x372d84(), _0x28539c(_0x542989(0x78a)), _0x478086(), _0x27b40b[_0x542989(0x6c2)](_0x542989(0x211))['style'][_0x542989(0x23e)] = _0x542989(0x4aa); }); } async function _0x34f697(_0x8bd209, _0xf94965) { const _0x35c622 = await _0x4c74c3; return new Promise((_0x2c44a3, _0x4eab5e) => { const _0x1c159e = _0x22cc, _0x10430b = _0x35c622[_0x1c159e(0x5a2)](_0x136299, _0x1c159e(0x30f)), _0x156d73 = _0x10430b[_0x1c159e(0x706)](_0x136299), _0xe6887c = _0x156d73[_0x1c159e(0x6a0)]({ 'id': _0x8bd209, 'blob': _0xf94965 }); _0xe6887c['onsuccess'] = () => _0x2c44a3(_0xe6887c[_0x1c159e(0x84e)]), _0xe6887c[_0x1c159e(0x911)] = () => _0x4eab5e(_0xe6887c[_0x1c159e(0x93a)]); }); } async function _0x3d9a60(_0xd74999) { const _0x45f0c9 = await _0x4c74c3; return new Promise((_0x31f8fd, _0xbecd60) => { const _0x26ad17 = _0x22cc; if ('clrJd' === _0x26ad17(0x5eb)) { if (_0x486dab['type'] === _0x26ad17(0x70e)) return _0x26ad17(0x930) + (_0x45c16d[_0x26ad17(0x8fa)] || _0x26ad17(0x4f2)) + '」'; const _0x27cdb2 = _0x1c7c90(_0x2f2119['participantIds'][0x0]); return '与\x20' + (_0x27cdb2?.['name'] || _0x26ad17(0x385)) + _0x26ad17(0x174); } else { const _0x206a24 = _0x45f0c9[_0x26ad17(0x5a2)](_0x136299, _0x26ad17(0x30f)), _0x9f511a = _0x206a24[_0x26ad17(0x706)](_0x136299), _0x5bd740 = _0x9f511a['delete'](_0xd74999); _0x5bd740['onsuccess'] = () => _0x31f8fd(), _0x5bd740[_0x26ad17(0x911)] = () => _0xbecd60(_0x5bd740[_0x26ad17(0x93a)]); } }); } function _0x1679a8(_0x271500) { const _0x2f2da1 = _0x18377a; return fetch(_0x271500)['then'](_0x68b1b => _0x68b1b[_0x2f2da1(0x277)]()); }
  </script>


  <div id="listen-together-ui" style="display: none;">
    <div class="lt-ui-backdrop"></div>
    <div class="lt-ui-main">
      <div class="lt-ui-header">
        <span id="lt-ui-header-title">正在与 TA 一起听</span>
        <button id="lt-ui-close-btn">×</button>
      </div>
      <div class="lt-ui-content">
        <div class="lt-ui-cover-container">
          <img id="lt-ui-cover-art" src="">
        </div>
        <div class="lt-ui-info">
          <h2 id="lt-ui-song-title">歌曲名称</h2>
          <p id="lt-ui-song-artist">歌手</p>
        </div>
        <div id="lt-ui-lyrics-container">
          <p class="no-lyrics-placeholder">暂无歌词</p>
        </div>
      </div>
    </div>
  </div>
  <div id="summarize-modal" class="choice-modal">
    <div id="summarize-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <button id="close-summary-button" class="header-button" style="min-width: 50px;">关闭</button>
        <span class="header-title">聊天记录总结</span>
        <button id="copy-summary-button" class="header-button" style="min-width: 50px;">复制</button>
      </div>
      <div class="content" style="flex-grow: 1; padding: 0;">
        <textarea id="summary-textarea" placeholder="AI正在拼命总结中，别催..."></textarea>
      </div>
    </div>
  </div>

</body>

</html>
