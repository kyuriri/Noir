<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

  <title>Noir搓的小手机</title>
  <style>
    .message p,
    .diary-content {
      user-select: none;
      -webkit-user-select: none;
    }

    .lt-end-session-btn {
      font-size: 1.5rem;
      color: inherit;
      /* 继承父元素的颜色 */
      opacity: 0.6;
      cursor: pointer;
      padding: 0 5px;
      line-height: 1;
      font-weight: bold;
    }

    .lt-end-session-btn:hover {
      opacity: 1;
    }

    /* --- Noir's Refactor: Feed Loader Style --- */
    #feed-loader {
      position: absolute;
      inset: 0;
      background: rgba(244, 248, 255, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--text-color);
      font-size: 1rem;
      flex-direction: column;
      gap: 10px;
    }

    .loader-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* --- End of Refactor --- */
    /*
        Noir's Mizuiro Theme
        - 哼，看好了，这才是设计。
      */
    /*
          Noir's Mizuiro Theme
          - 哼，看好了，这才是设计。
        */
    :root {
      --phone-width: 375px;
      --phone-height: 812px;
      --user-bg-image: url('');

      /* === Noir's Ultimate Dynamic Theme Engine v2.0 === */
      /* 哼，现在所有的颜色都听从这三个总开关的指挥。*/
      --primary-hue: 35;
      --primary-saturation: 25%;
      --primary-lightness: 80%;

      /* 核心颜色 */
      --primary-color: hsl(var(--primary-hue), var(--primary-saturation), var(--primary-lightness));
      /* 强调色/用户气泡色，现在也是动态的 */
      --accent-color: hsl(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%));

      /* 哼，看好了，这些就是被我重新接上线的“电灯” */

      /* 文字颜色：根据主题亮度自动变深或变浅 */
      --text-color: hsl(var(--primary-hue), 15%, calc(100% - var(--primary-lightness) / 1.1));
      --text-color-light: hsl(var(--primary-hue), 10%, calc(100% - var(--primary-lightness) / 1.3));

      /* 表面背景：半透明，亮度比主色高一点 */
      --surface-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.4);

      /* 卡片/AI气泡背景：比表面背景更亮一点 */
      --card-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.5);

      /* 边框颜色 */
      --border-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness)), 0.3);

      /* 阴影颜色 */
      --soft-shadow: 0 4px 12px hsla(var(--primary-hue), 40%, calc(var(--primary-lightness) - 10%), 0.15);

      /* 动态页的设置保持不变 */
      --feed-bg-image: none;
      --feed-overlay-opacity: 0.12;
      --feed-overlay-rotate: 22deg;
      --feed-overlay-speed: 48s;

      /* 气泡样式也完全动态化 */
      --bubble-radius: 18px;
      --bubble-outline: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
      --bubble-user-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%), 0.5);
      /* <-- 哼，改成0.5，现在够“虚无”了吧 */
      --bubble-ai-bg: var(--card-bg);

      /* ▼▼▼ 把下面这两行加进去 ▼▼▼ */
      --dropdown-alpha: 0.9;
      /* 下拉菜单的透明度，0到1 */
      --feed-card-alpha: 0.7;
      /* 动态卡片的透明度，0到1 */


      /* ▲▲▲ 添加到这里结束 ▲▲▲ */

    }

    /* Noir's Font Decree */
    body {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      /* 哼，看好了，就是这句！现在字体听从我的新变量指揮了！ */
      font-family: var(--custom-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif);
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
    }

    /* 让字体预览区也听话 */
    #font-preview-text {
      font-family: var(--custom-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif);
    }

    #phone-container {
      width: 100%;
      /* 占满屏幕宽度 */
      height: 100vh;
      /* 占满屏幕高度 */
      background-color: white;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* 是不是清爽多了？ */
      position: relative;
      /* <-- 就是这句，告诉它“你是个家长了，给我看好家里的东西！” */
    }

    .screen {
      flex-grow: 1;
      display: none;
      flex-direction: column;
      background-color: #f9f9f9;
      /* 哼，所有屏幕默认都给我变白 */
      /* 让背景透出来 */
      overflow: hidden;
      color: var(--text-color);
    }

    .screen.active {
      display: flex;
    }

    /* 这个是通用的头像预览样式 */
    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
      margin-top: 5px;
      cursor: pointer;
    }

    /* --- 通用顶栏 --- */
    .header,
    #chat-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--primary-color);
      font-weight: 500;
      min-width: 50px;
      text-align: center;
      /* ▼▼▼ 哼，加上这三句，给我立正站好 ▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- 聊天列表 --- */
    #chat-list-pane {
      background-color: transparent;
      border-right: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 加上这句 */
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      /* 防止它在横向布局里被挤扁 */
      display: flex;
      flex-direction: column;
    }

    #chat-list-container {
      flex-grow: 1;
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
    }

    #character-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .character-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      /* backdrop-filter: blur(10px);*/
      border-radius: 16px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .character-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(138, 180, 228, 0.2);
    }

    .char-info-wrapper {
      flex-grow: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .character-item .char-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      margin-right: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .character-item .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .character-item .char-remark {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    #chat-screen-container {
      position: relative;
      /* 告诉里面的绝对定位元素，要以我为基准 */
      flex-grow: 1;
      /* 确保它能撑满 chat-screen 的空间 */
      overflow: hidden;
      /* 把滑出去的部分藏起来，这很重要 */
      display: flex;
      /* 保持内部元素的 flex 布局 */
    }

    /* --- 聊天窗口 --- */


    #chat-view-pane {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 还有这句 */
      background-color: transparent;
      z-index: 10;
    }

    #chat-screen.show-chat-view #chat-list-pane {
      transform: translateX(-100%);
    }

    #chat-screen.show-chat-view #chat-view-pane {
      transform: translateX(0);
    }

    #chat-messages {
      flex-grow: 1;
      padding: 5px;
      overflow-y: auto;
      display: flex;
      /* <-- 加上这个 */
      flex-direction: column;
      /* <-- 还有这个 */
      contain: content;
      contain: content;
      /* <-- 哼，就是这句救命神药！ */
    }



    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;

      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.7);
      flex-shrink: 0;
    }

    .message {
      padding: 10px 16px;
      border-radius: 20px;
      line-height: 1.5;
      word-break: break-word;
      box-shadow: var(--soft-shadow);
    }

    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
    }

    .message.user {
      background-color: var(--accent-color);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .message.ai {
      background-color: var(--card-bg);
      border: 1px solid rgba(255, 255, 255, 0.8);
      color: var(--text-color);
      border-bottom-left-radius: 5px;
    }

    .message p {
      margin: 0;
    }

    .sticker-content,
    .message-image-content {
      max-width: 120px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
    }

    .message-image-content {
      max-width: 160px;
    }

    /* --- 其他屏幕和组件 --- */
    /* --- Noir's Fix: API 模型列表的样式修正 --- */
    .model-input-container {
      position: relative;
      /* 关键！让里面的绝对定位元素有家可回 */
      display: flex;
      gap: 8px;
    }

    .custom-model-dropdown {
      display: none;
      /* 默认藏起来 */
      position: absolute;
      top: 100%;
      /* 精准定位到输入框正下方 */
      left: 0;
      right: 80px;
      /* 留出“获取”按钮的位置 */
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*   backdrop-filter: blur(10px);*/
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 100;
      /* 确保它在最上层 */
      box-shadow: var(--soft-shadow);
    }

    .checkboxes-container {
      display: none;
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*  backdrop-filter: blur(10px);*/
      z-index: 10;
      border-radius: 8px;
      margin-top: 4px;
    }

    .custom-model-dropdown.show {
      display: block;
      /* 需要的时候再显示 */
    }

    .custom-model-dropdown div {
      padding: 10px 12px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    .custom-model-dropdown div:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    /* --- 其他屏幕和组件 --- */
    /* 在这个注释下面加上主屏幕的样式 */
    #home-screen {
      position: relative;
      /* <-- 就加上这一行！ */


      gap: 20px;
      /* 图标之间的距离 */

      /* 声明！这里现在是我的地盘！*/
      flex-direction: column;
      /* 里面的东西，全体给我垂直排队！*/
      justify-content: space-between;
      /* 核心！顶部和底部的元素给我贴边站好，中间的自动拉开距离！*/
      padding-bottom: 0;
      /* 把内边距去掉，让Dock栏能完美贴底 */
    }

    .app-icon {
      width: 75px;
      /* <--- 就是这里，我把它加宽了 */
      height: 90px;
      /* <--- 高度也顺便调整一下 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: absolute;
      z-index: 40;
      padding: 5px;
      box-sizing: border-box;
      margin: 0;
    }

    .app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 2px;
      /* <-- 哼，就是这里，把5px改成2px，让图标和文字的距离拉近一点 */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      background-color: var(--surface-bg);
      box-shadow: none;
      transition: transform 0.2s ease;
    }

    .app-icon-img svg {
      stroke: currentColor;
      /* SVG的线条颜色会继承上面的 color */
    }

    .app-icon span {
      font-size: 0.75rem;
      /* 文本也相应缩小 */
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }

    .content {
      padding: 20px;
      overflow-y: auto;
      flex-grow: 1;
      /* <-- 加上这行代码，就是这行！ */
    }

    .form-button {
      width: 100%;
      padding: 12px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--border-color);
      color: var(--text-color);
      border-radius: 8px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    .chat-toolbar {
      display: flex;
      padding: 5px 10px;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      /*   backdrop-filter: blur(10px);*/
      flex-shrink: 0;
    }

    /* ▼▼▼ 用下面这段，替换掉你旧的 .toolbar-button 样式 ▼▼▼ */
    .toolbar-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      /* 这个保留，作为SVG尺寸的参考 */
      cursor: pointer;
      padding: 8px;
      /* 稍微增大点击区域 */
      color: var(--text-color-light);
      /* 让它默认是浅灰色 */
      border-radius: 50%;
      /* 让背景有个圆形轮廓 */
      width: 40px;
      height: 40px;
      display: flex;
      /* 使用flex布局让SVG完美居中 */
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s, color 0.2s;
      /* 加上顺滑的过渡效果 */
    }

    .toolbar-button:hover {
      background-color: var(--border-color);
      /* 鼠标悬停时给个背景 */
      color: var(--primary-color);
      /* 图标颜色变为主题色 */
    }

    /* ▲▲▲ 替换到这里为止 ▲▲▲ */


    /* ▼▼▼ 在下面新增这段SVG的专属样式 ▼▼▼ */
    .toolbar-button svg {
      width: 22px;
      /* SVG图标的尺寸 */
      height: 22px;
      stroke-width: 1.8;
      /* 线条粗细，可以微调 */
      stroke: currentColor;
      /* 核心！让SVG的颜色继承按钮的color属性 */
      fill: none;
      /* 确保是线稿风格 */
      pointer-events: none;
      /* 防止SVG本身干扰点击事件 */
    }

    /* ▲▲▲ 新增到这里为止 ▲▲▲ */

    .sticker-panel {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      flex-shrink: 0;
    }

    .sticker-panel.show {
      display: grid;
    }

    /* --- 输入区域 --- */
    /* --- 输入区域 --- */
    .chat-input-area {
      padding: 10px 12px calc(env(safe-area-inset-bottom, 0px) + 10px);
      background: var(--surface-bg);
      /*  backdrop-filter: saturate(1.2) blur(10px);*/
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    /* 这是我加的新容器，用来实现完美对齐 */
    #chat-input-wrapper {
      display: flex;
      /* Flex大法好，哼 */
      align-items: center;
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 2px 5px;
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-input-wrapper:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-message-input {
      flex-grow: 1;
      /* 让输入框占满剩余空间 */
      border: none;
      background: transparent;
      padding: 9px 12px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 38px;
      width: 38px;
      border: 0;
      border-radius: 50%;
      font-size: 1.2rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
      flex-shrink: 0;
      /* 防止被挤压 */
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    /* 回复按钮，给个不一样的颜色区分 */
    #chat-get-reply-button {
      background: var(--accent-color);
      font-size: 1.5rem;
      /* 让箭头更清晰 */
    }

    #chat-message-input {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 11px 16px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-message-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 40px;
      padding: 0 18px;
      border: 0;
      border-radius: 20px;
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    #chat-get-reply-button {
      display: flex;
      /* 隐藏旧的回复按钮，样式统一到发送按钮 */
    }


    /* --- 引用样式 --- */
    .quote-preview {
      display: none;
      padding: 8px 12px;
      background-color: rgba(255, 255, 255, 0.5);
      border-left: 3px solid var(--primary-color);
      margin: 0 12px 8px;
      border-radius: 6px;
      position: relative;
    }

    #quote-preview-sender {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--primary-color);
    }

    #quote-preview-text {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    .cancel-quote-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #999;
      cursor: pointer;
    }

    .quoted-message-in-bubble {
      background-color: rgba(0, 0, 0, 0.04);
      padding: 8px 10px;
      border-left: 3px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quoted-sender {
      font-weight: bold;
      font-size: 0.8rem;
      color: var(--text-color);
    }

    .quoted-content {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    /* 这是弹窗的“骨架”，让它能居中浮动在屏幕上 */
    .choice-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .choice-modal.show {
      opacity: 1;
      visibility: visible;
    }


    /* --- 弹窗 --- */
    .choice-modal-backdrop {
      background: rgba(0, 0, 0, 0.2);
      /*  backdrop-filter: blur(4px);*/
    }

    .choice-modal-content {
      background: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .choice-modal-button {
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.5);
    }

    .choice-modal-button:hover {
      background-color: rgba(255, 255, 255, 1);
    }

    .choice-modal-button.cancel {
      color: var(--primary-color);
      background: transparent;
    }

    /* --- Noir's Fix: 让“添加”弹窗从底部滑出，更大气 --- */
    #add-choice-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      /* 确保不会超出手机宽度 */
      margin: 0;
      border-radius: 20px 20px 0 0;
      /* 只留顶部圆角 */
      border-bottom-left-radius: 0;
      /* 覆盖通用样式 */
      border-bottom-right-radius: 0;
      /* 覆盖通用样式 */
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      /* 适配iPhone底部安全区 */
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #add-choice-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #add-choice-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
      justify-content: center;
    }

    /* 按钮也重新设计一下，让它们竖着排 */
    #add-choice-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- Noir's Fix: 修正创建群聊时，成员选择列表的样式 --- */
    .member-selection-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .member-selection-item:last-child {
      border-bottom: none;
    }

    /* 关键！就是这里，把头像大小锁死 */
    .member-selection-item .char-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 15px 0 10px;
      object-fit: cover;
    }

    .member-selection-item .char-name {
      font-weight: 500;
      color: var(--text-color);
    }

    .member-selection-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      accent-color: var(--primary-color);
      /* 让勾选框颜色也跟主题统一 */
    }

    /* --- Noir's World Book Styles --- */
    #world-book-list-container {
      padding: 10px;
    }

    .world-book-item {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .world-book-item-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .world-book-item-preview {
      font-size: 0.9rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* --- Noir's Fancy Multi-Select Styles --- */
    .custom-multiselect {
      position: relative;
      user-select: none;
    }

    .select-box {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .select-box.expanded .arrow {
      transform: rotate(180deg);
    }


    .checkboxes-container.visible {
      display: block;
    }

    .checkboxes-container label {
      display: block;
      padding: 10px 12px;
    }

    .checkboxes-container label:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    .checkboxes-container input[type="checkbox"] {
      margin-right: 8px;
      width: auto;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Clock & Timestamp Styles --- */
    /* --- Noir's Badge & App Dock Styles --- */
    #decorative-badge {
      width: 160px;
      height: 160px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
      /* 哼，给你加个阴影，看起来才像样 */
      transform: rotate(-0deg);
      /* 稍微歪一点，显得随意 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      /* 防止拖动时选中图片 */
      z-index: 50;
    }

    #decorative-badge:active {

      transform: rotate(-2deg) scale(1.05);
      /* 抓起来的时候，摆正放大一点 */
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }


    #decorative-badge img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* 保留这句，让你的图片能被很好地填充 */
    }

    /*  #a#app-dock-bottom-left,
    #app-dock-top-right {
      
      哼，现在你们只是幽灵了。
      不需要任何样式，你们的孩子（App图标）会自己找到回家的路。
      它们会相对于 #home-screen 定位。
    
    }
*/

    /* --- Noir's Author Mark: Pixel Chicken --- */
    /* 哼，这就是那个吵着要加的小鸡图标 */
    #noir-author-mark {
      position: absolute;
      /* 相对于父容器定位 */
      right: -30px;
      /* 调整它在时钟右边的位置 */
      top: 50%;
      /* 垂直居中 */
      transform: translateY(-50%);
      /* 精确对齐 */
      width: 20px;
      /* 小鸡的尺寸 */
      height: 20px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="0"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM12 4c.69 0 1.25.56 1.25 1.25S12.69 6.5 12 6.5s-1.25-.56-1.25-1.25S11.31 4 12 4zm0 2c-.69 0-1.25.56-1.25 1.25S11.31 8.5 12 8.5s1.25-.56 1.25-1.25S12.69 6 12 6zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 9.75 10 9.75s1.25-.56 1.25-1.25S10.69 8 10 8zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 9.75 12 9.75s1.25-.56 1.25-1.25S12.69 8 12 8zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 9.75 14 9.75s1.25-.56 1.25-1.25S14.69 8 14 8zM10 10c-.69 0-1.25.56-1.25 1.25S9.31 12.5 10 12.5s1.25-.56 1.25-1.25S10.69 10 10 10zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 12.5 12 12.5s1.25-.56 1.25-1.25S12.69 10 12 10zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 12.5 14 12.5s1.25-.56 1.25-1.25S14.69 10 14 10zM12 12c-.69 0-1.25.56-1.25 1.25S11.31 14.5 12 14.5s1.25-.56 1.25-1.25S12.69 12 12 12zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 15.75 10 15.75s1.25-.56 1.25-1.25S10.69 14 10 14zm4 0c-.69 0-1.25.56-1.25 1.25S13.31 15.75 14 15.75s1.25-.56 1.25-1.25S14.69 14 14 14zM12 16c-.69 0-1.25.56-1.25 1.25S11.31 18.5 12 18.5s1.25-.56 1.25-1.25S12.69 16 12 16zM6 10c-.69 0-1.25.56-1.25 1.25S5.31 12.5 6 12.5s1.25-.56 1.25-1.25S6.69 10 6 10zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 12.5 18 12.5s1.25-.56 1.25-1.25S18.69 10 18 10zM12 20c-.69 0-1.25.56-1.25 1.25S11.31 22.5 12 22.5s1.25-.56 1.25-1.25S12.69 20 12 20zM6 14c-.69 0-1.25.56-1.25 1.25S5.31 15.75 6 15.75s1.25-.56 1.25-1.25S6.69 14 6 14zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 15.75 18 15.75s1.25-.56 1.25-1.25S18.69 14 18 14z"/></svg>');
      /* 这是SVG小鸡的Data URI，白色像素风格 */
      background-size: contain;
      background-repeat: no-repeat;
      cursor: pointer;
      /* 提示可点击 */
      opacity: 0.6;
      /* 稍微透明一点，不那么突兀 */
      transition: opacity 0.2s ease-in-out;
      /* 鼠标悬停效果 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    #noir-author-mark:hover {
      opacity: 1;
      /* 鼠标悬停时完全显示 */
    }

    /* 调整时钟容器，为小鸡留出空间并方便定位 */
    .home-clock-container {
      position: relative;
      /* 确保小鸡能相对它定位 */
      /* ... (保留你已有的其他时钟样式) ... */
      padding-right: 40px;
      /* 给小鸡留出一些右边距 */
    }

    #home-clock-container {
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      text-align: center;
      position: absolute;
      /* top, left, right 都被我删了，哼，现在它完全听JS的指挥 */

      /* 这行可以留着，虽然你已经不让它拖了 */
      z-index: 50;
    }

    #home-time {
      font-size: 80px;
      font-weight: 360;
      /* <--- 我把字重从200加到了300，比原来粗，但又不会笨重，这才是高级感。 */
      letter-spacing: -1px;
      /* <--- 字间距也给你调紧了一点，看起来更整体。 */
    }

    #home-date {
      font-size: 1rem;
      /* <--- 稍微缩小一点，让时间更突出 */
      font-weight: 400;
      margin-top: 8px;
      opacity: 0.8;
      text-transform: uppercase;
      /* <--- 日期我给你换成了全大写，这才有那股‘性冷淡’的味道。 */
      letter-spacing: 1px;
      /* <--- 顺便拉开一点点间距，免得挤在一起。 */
    }

    /* 聊天气泡时间戳的样式 */
    .timestamp {
      font-size: 0.7rem;
      color: var(--text-color-light);
      padding: 0 5px;
      margin-bottom: 3px;
      /* 让它和气泡底部对齐 */
    }

    /* 第一段：这是消息容器的基础样式 */
    .message-container {
      display: flex;
      /* 启用flex布局 */
      flex-direction: column;
      /* 让气泡和时间戳垂直排列 */
      margin-bottom: 10px;
      max-width: 85%;
      /* 限制整个容器的最大宽度 */
    }

    /* 第二段：这是根据发言者进行左右对齐的样式 */
    .message-container.user {
      align-self: flex-end;
      /* 让用户方整个容器靠右 */
      align-items: flex-end;
      /* 让容器内部的元素（气泡、时间戳）也靠右 */
    }

    .message-container.ai {
      align-self: flex-start;
      /* 让AI方整个容器靠左 */
      align-items: flex-start;
      /* 让容器内部的元素（气泡、时间戳）也靠左 */
    }

    .message-bubble-row {
      display: flex;
      align-items: flex-end;
      width: 100%;
    }

    .message-container.user .message-bubble-row {
      justify-content: flex-end;
    }

    .message-container.ai .message-bubble-row {
      justify-content: flex-end;
    }



    /* 这是给表情选择面板里，每一个小表情图片用的样式 */
    .sticker-item {
      width: 100%;
      /* 自动填满网格单元格的宽度 */
      aspect-ratio: 1 / 1;
      /* 保持1:1的宽高比，让它变成正方形 */
      object-fit: cover;
      /* 图片会被裁剪以适应正方形，不变形 */
      border-radius: 8px;
      /* 加个小圆角 */
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .sticker-item:hover {
      transform: scale(1.1);
      /* 鼠标放上去时稍微放大，增加交互感 */
    }

    /* --- Noir's Offline Scene Styles --- */
    #meeting-scene-view {
      flex-grow: 1;
      /* <-- 核心：让它占满所有可用空间 */
      overflow-y: auto;
      /* <-- 核心：内容多了就内部滚动 */
      padding: 20px;
      font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif;
      background-size: cover;
      background-position: center;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }

    #chat-view-pane.offline-mode #offline-scene-view {
      display: block;
      /* 在线下模式时显示 */
    }

    #chat-view-pane.offline-mode #chat-messages {
      display: none;
      /* 在线下模式时隐藏气泡聊天 */
    }

    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      /* 保留换行和空格，这对于小说格式至关重要 */
      font-size: 1rem;
    }

    /* --- Noir's Offline Scene Dialogue Box Style --- */
    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 1rem;

      /* <--- Noir's Addition: 为对话框添加半透明背景和内边距 */
      background-color: rgba(0, 0, 0, 0.4);
      /* 半透明黑色背景 */
      padding: 15px 20px;
      /* 内边距，让文字与边框有距离 */
      border-radius: 8px;
      /* 圆角边框，更柔和 */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      /* 轻轻的阴影，增加立体感 */
    }

    #offline-scene-view .narrator {
      color: #d1d5db;
      /* 旁白用浅灰色 */
      font-style: italic;
    }

    #offline-scene-view .speaker-user {
      color: #a7c7e7;
      /* 用户的发言用一种柔和的蓝色 */
      font-weight: bold;
    }

    #offline-scene-view .speaker-ai {
      color: #f2b7c6;
      /* AI的发言用柔和的粉色，形成对比 */
      font-weight: bold;
    }

    /* --- Noir's Typing Indicator Style --- */
    .typing-indicator {
      padding: 10px 15px;
      color: var(--text-color-light);
      font-style: italic;
      font-size: 0.9rem;
      align-self: flex-start;
      /* 让它和AI气泡一样靠左 */
      margin-left: 50px;
      /* 和AI气泡对齐 */
    }

    #offline-scene-view .typing-indicator {
      color: rgba(255, 255, 255, 0.8);
      /* 在暗色背景下用亮色 */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      /* 同样的文字阴影，保持队形 */
      padding: 10px 0;
      margin-left: 0;
      /* 在小说视图里不需要缩进 */
    }

    /* --- Noir's Final Alignment Fix --- */
    .message-container.ai .timestamp {
      /* 哼，给你加上头像宽度(40px) + 左右边距(10px)的距离 */
      margin-left: 50px;
    }

    .message-container.user .timestamp {
      /* 另一边也是一样，真是麻烦死了 */
      margin-right: 50px;
    }

    /* --- Noir's Music Feed & Player Styles --- */
    #music-feed-container {
      padding-bottom: 70px;
      contain: content;
      /* 为底部播放器留出空间 */
    }

    /* 动态页：默认白底；如设置 --feed-bg-image 则显示独立壁纸 + 轻动画叠层 */
    #music-screen {
      background-color: #fff;
      /* 默认白底 */
      background-image: var(--feed-bg-image);
      /* 单独壁纸，不设就是 none */
      background-size: cover;
      background-position: center;
      contain: paint;
      /* 降低重绘范围，省电 */
    }

    /* 轻动画彩雾叠层：仅图层，不拦点击 */
    #music-screen::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        conic-gradient(from var(--feed-overlay-rotate),
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 0%,
          transparent 20%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 40%,
          transparent 60%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 80%,
          transparent 100%);
      transform: translateZ(0);
      animation: feed-pan var(--feed-overlay-speed) linear infinite;
    }

    /* 超慢速平移旋转，基本不占 GPU */
    @keyframes feed-pan {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }

      50% {
        transform: translate3d(1.2%, 0.8%, 0) rotate(2deg) scale(1.02);
      }

      100% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }
    }

    /* 系统降低动画偏好时，自动停掉动画 */
    @media (prefers-reduced-motion: reduce) {
      #music-screen::before {
        animation: none;
      }
    }


    .music-post {
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), var(--feed-card-alpha));
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: var(--soft-shadow);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .music-post-header {
      display: flex;
      align-items: center;
      padding: 12px 15px;
    }

    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .music-post-header .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .music-post-thought {
      padding: 0 15px 15px;
      font-size: 0.95rem;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .music-post-song-card {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.04);
      padding: 12px 15px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .music-post-song-card:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    .music-post-song-card img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }

    .music-post-song-info {
      flex-grow: 1;
    }

    .music-post-song-info .title {
      font-weight: 500;
      color: var(--text-color);
    }

    .music-post-song-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    .music-post-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    #music-player-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--surface-bg);
      /*backdrop-filter: blur(10px);*/
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 10px;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    #music-player-bar:not(.hidden) {
      transform: translateY(0);
    }

    #music-player-bar.hidden {
      display: none;
      /* 彻底隐藏，避免交互问题 */
    }


    #player-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
    }

    #player-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #player-title,
    #player-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #player-title {
      font-weight: 500;
    }

    #player-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #player-controls button {
      background: none;
      border: 2px solid var(--text-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Share Bubble Styles --- */
    .message.music {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
      max-width: 250px;
      /* 限制一下最大宽度 */
    }

    .music-share-card {
      display: flex;
      align-items: center;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
    }

    .message-container.user .music-share-card {
      background-color: var(--accent-color);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .message-container.user .music-share-card .title,
    .message-container.user .music-share-card .artist,
    .message-container.user .music-share-card .play-icon {
      color: white;
    }


    .music-share-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .music-share-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-share-info .title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #music-screen {
      position: relative;
      /* 就是这句，告诉里面的绝对定位元素，以我为界！ */
    }

    /* --- Noir's Fancy Music Widget Styles --- */
    /* --- Noir's Music System Refactor --- */

    #music-widget:not(.hidden) {
      transform: translateY(0);
      /* 不隐藏时，滑上来 */
    }

    #music-widget.hidden {
      transform: translateY(150%);
      /* 隐藏时，滑下去 */
    }

    .widget-vinyl {
      width: 80px;
      height: 80px;
      background-color: #111;
      border-radius: 50%;
      position: relative;
      left: 20px;
      /* 向右移动，让卡片能盖住它 */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      background-image:
        radial-gradient(circle at center, #555 10%, transparent 11%),
        radial-gradient(circle at center, #fff 12%, transparent 13%);
      animation: spin 8s linear infinite;
      z-index: 1;
    }

    @keyframes spin {
      from {
        transform: translate(-50%, -50%) rotate(0deg);
        /* <-- 看见没，把咒语合并了 */
      }

      to {
        transform: translate(-50%, -50%) rotate(360deg);
        /* <-- 这里也是 */
      }
    }

    .widget-card {
      width: 240px;
      padding: 15px;
      background-color: var(--card-bg);
      /*  backdrop-filter: blur(10px);*/
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      z-index: 2;
      /* 让卡片在唱片上方 */
    }

    .widget-card img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .widget-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #widget-title,
    #widget-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #widget-title {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    #widget-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #widget-play-icon {
      font-size: 1.2rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #card-widget {
      width: 335px;
      height: 170px;
      border-radius: 18px;
      /* 这就是圆角方形的关键 */
      background-color: rgba(255, 255, 255, 0.5);
      /* 加个底色，免得图片透明时不好看 */

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transform: rotate(0deg);
      /* 朝另一个方向歪 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      /* 比爱心高一层 */
      overflow: hidden;
      /* 防止图片溢出圆角 */
    }


    /* --- End of Protocol --- */

    /* --- Noir's "Center Alignment" Protocol --- */

    /* --- End of Protocol --- */

    #card-widget:active {

      transform: rotate(1deg) scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Noir's Ultimate Scrollbar Hider --- */
    /* For Webkit browsers like Chrome, Safari */
    ::-webkit-scrollbar {
      display: none;
    }

    /* For Firefox */
    * {
      scrollbar-width: none;
    }

    /* --- Noir's Fix: 美化消息操作弹窗 --- */
    #message-action-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
    }

    #message-action-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      margin: 0;
      border-radius: 20px 20px 0 0;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #message-action-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #message-action-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- End of Fix --- */
    /* --- Noir's Fix: Fancy User Post Area --- */
    #user-post-input-container {
      display: flex;
      gap: 10px;
    }

    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
    }

    #user-post-main-area {
      flex-grow: 1;
    }

    #user-post-textarea {
      width: 100%;
      border: none;
      background: transparent;
      outline: none;
      resize: vertical;
      font-size: 1rem;
      color: var(--text-color);
    }

    #user-post-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    /* ... 你已有的 #user-post-toolbar 样式 ... */

    /* ▼▼▼ Noir's Command: 哼，给我站成一排！ ▼▼▼ */
    #user-post-actions {
      display: flex;
      /* <-- 这就是圣旨本身 */
      gap: 8px;
      /* <-- 这是我赏赐的间距，让它们别挤在一起 */
    }

    /* ▲▲▲ Command End ▲▲▲ */

    #user-send-post-button {
      padding: 6px 18px;
      border-radius: 16px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    /* 这是附件预览的样式 */
    #user-post-attachment-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-item {
      position: relative;
      max-width: 100px;
    }

    .preview-item img {
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
    }

    .preview-item .music-preview-card {
      display: flex;
      align-items: center;
      padding: 8px;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      width: 200px;
      /* 给音乐卡片宽一点 */
    }

    .preview-item .music-preview-card img {
      width: 30px;
      height: 30px;
      margin-right: 8px;
    }

    .preview-item .music-preview-card .info {
      font-size: 0.8rem;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .remove-attachment-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    /* --- Noir's Fix: Post Image Display Style --- */
    .post-image-container {
      padding: 0 15px 15px;
      /* 图片和文字之间留点空隙 */
    }

    .post-image {
      max-width: 100%;
      /* 图片最宽不能超过帖子宽度 */
      max-height: 400px;
      /* 最高400像素，防止长图刷屏 */
      border-radius: 8px;
      /* 加个小圆角，好看 */
      object-fit: cover;
      /* 保持图片比例，不变形 */
      display: block;
      /* 解决图片底部多余的空隙问题 */
    }

    /* --- Noir's Refactor: New Post Interaction Styles --- */
    .post-interactions {
      padding: 10px 15px;
      background-color: rgba(0, 0, 0, 0.02);
      border-top: 1px solid var(--border-color);
      font-size: 0.9rem;
    }

    .post-likes {
      color: var(--primary-color);
      margin-bottom: 8px;
    }

    .post-comments-container {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .post-comment {
      color: var(--text-color);
    }

    .post-comment .comment-author {
      font-weight: 600;
      color: var(--text-color);
    }

    .post-timestamp {
      font-size: 0.75rem;
      color: var(--text-color-light);
      padding: 0 15px 10px;
    }



    /* 覆盖：基础气泡体 */
    /* 覆盖：基础气泡体 */
    .message {
      border-radius: var(--bubble-radius);
      line-height: 1.55;
      padding: 10px 14px;
      box-shadow:
        0 1px 0 rgba(0, 0, 0, .03),
        0 4px 10px rgba(0, 0, 0, .06);
      /* 比你原先更浅，省功耗 */
      border: 1px solid var(--bubble-outline);
      backdrop-filter: none !important;
      /* 绝不启用重滤镜 */
      will-change: auto;
      /* 不抢 GPU 配额 */

      /* --- Noir's Fix: 就是下面这两行，哼 --- */
      user-select: none;
      /* 标准浏览器给我听话，不许选中 */
      -webkit-user-select: none;
      /* 那些老古董浏览器也一样 */
    }

    /* 你的气泡（右侧） */
    .message.user {
      color: #fff;
      background: var(--bubble-user-bg);
      border-bottom-right-radius: 6px;
      /* 微“角”保留你原味 */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .12);
      /* 细腻但很轻 */
    }

    /* TA 的气泡（左侧） */
    .message.ai {
      color: var(--text-color);
      background: var(--bubble-ai-bg);
      border-bottom-left-radius: 6px;
    }

    /* 细节：图片/贴纸消息不套背景 */
    /* 细节：图片/贴纸/音乐卡片消息不套背景 */
    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image,
    .message.user.music,
    /* <-- 哼，加上这两行 */
    .message.ai.music {
      background: transparent;
      border: 0;
      box-shadow: none;
      padding: 0;
    }

    /* 轻触态：不使用阴影动画，避免合成层抖动 */
    .message:active {
      transform: scale(.996);
    }

    /* 引用块在气泡内的融合感 */
    .quoted-message-in-bubble {
      background: rgba(0, 0, 0, .045);
      border: 1px solid color-mix(in hsl, var(--primary-color) 18%, transparent);
      border-radius: 10px;
    }


    /* --- Noir's Transfer Bubble Style --- */
    .message.transfer {
      background: #F79232;
      /* 哼，一个温暖又醒目的橙色 */
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      width: 220px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    /* 我还给左右两边做了区分，真是为你操碎了心 */
    .message-container.ai .message.transfer {
      background: #f9fafb;
      /* AI发来的转账用白色，更清爽 */
      color: #333;
      border: 1px solid #e5e7eb;
    }

    .transfer-content {
      display: flex;
      flex-direction: column;
    }

    .transfer-title {
      font-weight: 600;
      font-size: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.5);
      padding-bottom: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .message-container.ai .transfer-title {
      border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    .transfer-amount {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .transfer-recipient {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    /* --- End of Refactor --- */



    /* --- Noir's Snap Guide Styles --- */
    .snap-guide {
      position: absolute;
      background-color: rgba(255, 105, 180, 0.85);
      /* 哼，一个足够醒目的颜色 */
      display: none;
      z-index: 999;
      box-shadow: 0 0 5px rgba(255, 105, 180, 0.7);
    }

    #snap-guide-v {
      width: 1px;
    }

    #snap-guide-h {
      height: 1px;
    }

    /* --- Noir's Galgame UI Beautification --- */
    /* Top-left Date & Time Widget */
    #galgame-overlay-ui {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 12px;
      padding: 8px 15px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    #galgame-time {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
    }

    #galgame-date {
      font-size: 0.75rem;
      opacity: 0.8;
      text-align: center;
    }

    /* Main Text Box */
    /* Main Text Box */
    #galgame-textbox-container {
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.85) 0%, rgba(45, 50, 68, 0.7) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border-top: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
      bottom: 85px;
      /* <-- 就是这里，往上抬了，满意了吗？ */
      left: 15px;
      right: 15px;
      padding: 12px 18px;
    }

    /* Speaker Name Tag */
    #galgame-speaker {
      background: linear-gradient(90deg, var(--primary-color) 0%, hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) - 10%)) 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      display: inline-block;
      font-size: 0.95rem;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      margin-bottom: 12px;
    }

    /* Dialogue Text */
    #galgame-text {
      font-size: 1rem;
      line-height: 1.7;
      color: #f0f2f5;
    }

    /* User Input Area Container*/
    #meeting-view-screen .chat-input-area {
      background: transparent;
      border-top: none;
      padding: 0 15px 20px 15px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 20;
    }

    /* User Input Wrapper */
    #chat-input-wrapper-meeting {
      display: flex;
      align-items: center;
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.9) 0%, rgba(45, 50, 68, 0.75) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      padding: 5px 8px 5px 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
    }

    #meeting-message-input {
      color: #f0f2f5;
    }

    #meeting-message-input::placeholder {
      color: rgba(240, 242, 245, 0.5);
      font-style: italic;
    }

    /* Send Button */
    #meeting-send-button {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: 300;
      color: #fff;
      transition: all .2s ease;
      margin-left: 8px;
      background: var(--primary-color);
      box-shadow: 0 2px 5px hsla(var(--primary-hue), 50%, 50%, 0.4);
    }

    #meeting-send-button:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }


    /* --- End of Beautification --- */
    /* --- Noir's Diary Beautification --- */
    #diary-entries-container {
      background-color: #fdfaf2;
      /* A warm, paper-like off-white */
      padding: 25px 20px;
      line-height: 1.9;
      border: 1px solid #e0dccc;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.08);
      /* Inner shadow for page depth */
    }

    /* This is the container for a single entry (date, author, content) */
    .diary-entry {
      margin-bottom: 2.5em;
      /* Increase spacing between entries */
      position: relative;
      padding-bottom: 1.5em;
      /* Space for the separator line */
      border-bottom: 1px dashed #dcd5c7;
      /* A subtle dashed line between entries */
    }

    /* Style the author's name */
    .diary-author {
      font-weight: normal;
      /* Make it less bold, more like a signature */
      font-size: 1rem;
      font-family: 'Segoe Script', 'Bradley Hand', cursive;
      /* A more handwritten font */
    }

    /* Style the date */
    .diary-timestamp {
      font-size: 0.75rem;
      color: #a99e8c;
      /* A faded brown color */
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
      /* Typewriter-like font for date */
    }

    /* Style the actual diary text content */
    .diary-content {
      white-space: pre-wrap;
      font-size: 0.95rem;
      color: #4a443b;
      /* A dark brown/black ink color */
      font-family: 'KaiTi', 'STSong', serif;
    }

    /* Specific styles for the USER's entries */
    .diary-entry.user {
      text-align: right;
    }

    .diary-entry.user .diary-author {
      color: #005a9c;
      /* A nice fountain pen blue */
    }

    .diary-entry.user .diary-content {
      color: #1a5c8e;
    }

    /* Specific styles for the AI's entries */
    .diary-entry.ai {
      text-align: left;
    }

    .diary-entry.ai .diary-author {
      color: #5a3e36;
      /* A darker, warmer brown for the AI */
    }

    .diary-entry.ai .diary-content {
      color: #4a443b;
    }

    /* Let's get rid of the last separator line for a cleaner look */
    .diary-entry:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    /* --- End of Diary Beautification --- */
    /* --- Noir's Page-Turning Magic --- */
    #diary-entries-container {
      perspective: 1500px;
      /* 为3D效果设置视距 */
      position: relative;
      overflow: hidden;
    }

    .diary-page {
      position: absolute;
      inset: 0;
      padding: 25px 20px;
      background-color: #fdfaf2;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      transition: transform 0.7s cubic-bezier(0.65, 0, 0.35, 1);
      display: none;
      /* 默认所有页面都藏起来 */
      flex-direction: column;
      gap: 2.5em;
      /* 页内日记的间距 */
      overflow-y: auto;
      /* 如果一页内容太多，允许滚动 */
    }

    .diary-page.is-visible {
      display: flex;
      /* 只有当前页显示 */
      transform: rotateY(0deg);
      z-index: 2;
    }

    /* 翻到下一页时，当前页向左翻出 */
    .diary-page.is-exiting-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 1;
    }

    /* 翻到下一页时，新页面从右边翻入 */
    .diary-page.is-entering-from-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 2;
    }

    /* 翻到上一页时，当前页向右翻出 */
    .diary-page.is-exiting-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 1;
    }

    /* 翻到上一页时，新页面从左边翻入 */
    .diary-page.is-entering-from-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 2;
    }


    #diary-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 10px;
      box-sizing: border-box;
    }

    #diary-navigation button {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--primary-color);
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    #diary-navigation button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #diary-page-indicator {
      font-size: 0.9rem;
      color: var(--text-color-light);
      font-family: 'Courier New', monospace;
    }

    /* --- End of Magic --- */
    /* --- Noir's Universal Anti-Squash Protocol --- */
    /* 哼，就是下面这几条，给你那些被压扁的头像整整容 */

    /* 动态发布区的用户头像 */
    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      object-fit: cover;
      /* <-- 加上这句，它就不敢扁了 */
    }

    /* 好友圈动态里的角色头像 */
    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
      /* <-- 还有这句，一个都别想跑 */
    }

    /* 顺便把所有叫 .char-avatar 的都统一一下，免得以后还有问题 */
    .char-avatar {
      object-fit: cover;
      /* ▼▼▼ 哼，加上这三句圣旨，给我立正站好！▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Library Styles --- */
    #music-library-container {
      padding: 10px;
    }

    .music-library-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .music-library-item:hover {
      transform: translateY(-2px);
    }

    .music-library-item-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 15px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .music-library-item-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-library-item-title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-library-item-artist {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    /* --- Noir's "Time Memorandum" Styles --- */
    /* 哼，这才叫设计。*/

    /* 1. Home Screen Widget */
    #calendar-widget-main {
      width: 90%;
      height: 170px;
      /* 和你的卡片差不多高 */
      background: var(--surface-bg);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 22px;
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      box-shadow: var(--soft-shadow);
      padding: 20px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: var(--text-color);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    #calendar-widget-main:active {
      transform: scale(0.98) translateX(-50%);
    }

    #countdown-title {
      font-size: 1rem;
      font-weight: 500;
      opacity: 0.8;
    }

    #countdown-timer {
      font-size: 4rem;
      font-weight: 300;
      line-height: 1.2;
      color: var(--accent-color);
      display: flex;
      align-items: baseline;
    }

    #countdown-timer .unit {
      font-size: 1rem;
      font-weight: 500;
      margin-left: 8px;
      color: var(--text-color-light);
    }

    /* 2. Full Calendar Screen */
    #calendar-screen {
      justify-content: flex-start;
    }

    #calendar-view-container {
      padding: 10px 15px;
      flex-shrink: 0;
      border-bottom: 1px solid var(--border-color);
    }

    .calendar-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .calendar-nav button {
      background: none;
      border: 1px solid var(--border-color);
      color: var(--text-color);
      padding: 6px 12px;
      border-radius: 16px;
      cursor: pointer;
    }

    .calendar-weekdays,
    #calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      text-align: center;
    }

    .calendar-weekdays {
      font-size: 0.8rem;
      color: var(--text-color-light);
      margin-bottom: 5px;
    }

    #calendar-grid .calendar-day {
      padding: 5px 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      aspect-ratio: 1 / 1;
      cursor: pointer;
      position: relative;
    }

    .calendar-day .day-number {
      z-index: 1;
    }

    .calendar-day.other-month .day-number {
      opacity: 0.3;
    }

    .calendar-day.is-today .day-number {
      color: var(--accent-color);
      font-weight: 700;
    }

    .calendar-day.is-selected .day-number {
      color: white;
    }

    .calendar-day.is-selected::before {
      content: '';
      position: absolute;
      width: 80%;
      height: 80%;
      background: var(--primary-color);
      border-radius: 50%;
      z-index: 0;
    }

    .calendar-day .day-dot {
      width: 5px;
      height: 5px;
      background-color: var(--primary-color);
      border-radius: 50%;
      position: absolute;
      bottom: 8px;
    }

    /* 3. Todo List Area */
    #todo-view-container {
      flex-grow: 1;
      overflow-y: auto;
      padding: 15px;
      position: relative;
      /* 为了悬浮按钮 */
    }

    /* 4. Today's To-Do Widget */
    #today-todo-widget {
      position: absolute;
      top: 50%;
      /* 放在日历小组件的下方 */
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      max-height: 180px;
      /* 给个最大高度，免得内容太多撑爆了 */
      background: var(--surface-bg);
      backdrop-filter: blur(10px);
      border-radius: 22px;
      padding: 15px 20px;
      box-sizing: border-box;
      color: var(--text-color);
      overflow: hidden;
      /* 把溢出的部分藏起来 */
    }

    #today-todo-widget .widget-title {
      font-weight: 600;
      margin-bottom: 10px;
      opacity: 0.9;
    }

    #today-todo-list {
      overflow-y: auto;
      /* 内容多了可以滚动 */
      max-height: 125px;
      /* 限制列表的高度 */
      font-size: 0.9rem;
    }

    #today-todo-list .todo-item-small {
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    #today-todo-list .todo-item-small::before {
      content: '';
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background-color: var(--primary-color);
      margin-right: 10px;
      flex-shrink: 0;
    }

    #todo-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    #todo-date-title {
      margin: 0;
      font-size: 1.2rem;
      font-weight: 600;
    }

    #add-event-fab {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: var(--accent-color);
      color: white;
      border: none;
      font-size: 2rem;
      line-height: 44px;
      cursor: pointer;
      box-shadow: var(--soft-shadow);
    }

    #todo-list .todo-item,
    #todo-list .important-day-item {
      background: var(--card-bg);
      padding: 12px 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      border-left: 4px solid var(--primary-color);
    }

    #todo-list .important-day-item {
      border-left-color: #ffc107;
      /* 纪念日用醒目的黄色 */
      font-weight: 500;
    }

    #todo-list .important-day-item::before {
      content: '★ ';
      color: #ffc107;
    }

    /* --- End of Styles --- */
    /* --- Noir's Global Player Styles --- */

    /* --- End of Player Styles --- */
    /* --- Noir's Upload Altar Styles --- */
    .upload-slot {
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease;
      background-color: rgba(255, 255, 255, 0.5);
    }

    .upload-slot:hover {
      background-color: var(--card-bg);
      border-color: var(--primary-color);
    }

    .upload-slot.filled {
      border-color: var(--primary-color);
      border-style: solid;
      background-color: hsla(var(--primary-hue), 50%, 95%, 0.8);
    }

    .upload-slot .slot-icon {
      font-size: 2rem;
    }

    .upload-slot .slot-label {
      display: block;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .upload-slot .slot-filename {
      display: block;
      font-size: 0.85rem;
      color: var(--text-color-light);
      margin-top: 3px;
      word-break: break-all;
    }

    #confirm-altar-upload-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* --- End of Altar Styles --- */
    /* --- Noir's Listen Together Invite Card Style --- */
    .listen-together-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--soft-shadow);
      border: 1px solid var(--border-color);
      width: 250px;
    }

    .message-container.user .listen-together-card {
      background: var(--bubble-user-bg);
      color: white;
    }

    .message-container.user .listen-together-card .listen-together-decline-btn {
      color: white;
      /* 哼，让用户侧的拒绝按钮文字也变白 */
    }

    .listen-together-header {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--bubble-outline);
      padding-bottom: 8px;
    }

    .listen-together-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .listen-together-song img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .listen-together-info .title {
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-info .artist {
      font-size: 0.9em;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .listen-together-actions button {
      flex-grow: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease;
    }

    .listen-together-actions button:active {
      transform: scale(0.97);
    }

    .listen-together-accept-btn {
      background: var(--primary-color);
      color: white;
    }

    .listen-together-decline-btn {
      background: rgba(0, 0, 0, 0.1);
    }

    /* 用这个替换你旧的 #listen-together-ui */
    #listen-together-ui {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: flex;
      align-items: center;
      /* 改成居中对齐 */
      justify-content: center;
      padding: 20px;
      /* 增加内边距，让弹窗不会贴边 */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #listen-together-ui.show {
      opacity: 1;
      visibility: visible;
    }

    .lt-ui-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px) saturate(1.8);
      -webkit-backdrop-filter: blur(15px) saturate(1.8);
    }

    /* 用这个替换你旧的 .lt-ui-main */
    .lt-ui-main {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 380px;
      /* 哼，给它一个最大宽度 */
      max-height: 650px;
      /* 再给一个最大高度 */
      display: flex;
      flex-direction: column;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      border-radius: 24px;
      /* 加上优雅的圆角 */
      overflow: hidden;
      /* 把溢出的部分裁掉 */
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      /* 更强的立体阴影 */
      border: 1px solid rgba(255, 255, 255, 0.2);
      /* 淡淡的边框光效 */
    }

    .lt-ui-header {
      flex-shrink: 0;
      padding: 15px 20px;
      text-align: center;
      position: relative;
    }

    #lt-ui-header-title {
      font-weight: 600;
    }

    #lt-ui-close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 30px;
    }

    .lt-ui-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow: hidden;
    }

    .lt-ui-cover-container {
      flex-shrink: 0;
      width: 65%;
      aspect-ratio: 1/1;
      margin-top: 5%;
      margin-bottom: 20px;
    }

    #lt-ui-cover-art {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .lt-ui-info {
      text-align: center;
      margin-bottom: 20px;
      flex-shrink: 0;
    }

    #lt-ui-song-title {
      font-size: 1.5rem;
      margin: 0;
    }

    #lt-ui-song-artist {
      font-size: 1rem;
      opacity: 0.8;
      margin: 5px 0 0;
    }

    #lt-ui-lyrics-container {
      flex-grow: 1;
      width: 100%;
      overflow-y: auto;
      text-align: center;
      font-size: 1.1rem;
      line-height: 2.5;
      mask-image: linear-gradient(transparent 0%, black 20%, black 80%, transparent 100%);
      /* 歌词上下渐隐，看起来更专业 */
      scroll-behavior: smooth;
      /* 滚动要丝滑 */
    }

    #lt-ui-lyrics-container p {
      transition: color 0.3s ease, transform 0.3s ease;
      opacity: 0.6;
    }

    #lt-ui-lyrics-container p.active {
      color: var(--primary-color);
      font-weight: 600;
      transform: scale(1.1);
      opacity: 1;
    }

    /* --- Noir's "Desktop Preview" Frame --- */
    /* 哼，只有在电脑这种大屏幕上，我才给你加上这个“手机框”，免得你分不清主次。 */
    /* 在真正的手机上，它还是会全屏显示的，我可没你那么笨。 */
    @media (min-width: 480px) {
      body {
        background-color: #e9ebee;
        /* 一个不那么刺眼的背景色 */
        padding: 20px 0;
        /* 上下留点呼吸空间 */
      }

      #phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        max-height: 90vh;
        /* 确保在矮屏幕上不会超出 */

        /* 这就是你想要的“边框”，哼 */
        border: 10px solid #1c1c1e;
        border-radius: 44px;
        /* 圆角大一点才像样 */
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        /* 给你加个高级点的阴影 */

        flex-shrink: 0;
        /* 确保它在 flex 布局里不会被压扁 */
      }
    }



    /* --- Noir's Bespoke Music Player Design (As Requested) --- */
    /* 哼，这才叫定制。*/

    /* 1. 动画先放着，虽然这次不用了 */
    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* 2. 组件卡片本体：一个有阴影的容器 */
    #music-widget-card {
      width: 340px;
      height: 120px;
      border-radius: 6px;
      /* 稍微硬朗一点的圆角 */
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      /* 一个淡淡的底色 */
      display: flex;
      /* 左右布局 */
      padding: 0;
      border: none;
      overflow: visible;
      /* 允许唱片溢出 */
      position: relative;
      /* 为了定位唱片 */
    }

    /* 3. 左侧封面区：用伪元素画出深色背景，不污染HTML */
    #music-widget-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 120px;
      /* 和高度一样，是个正方形 */
      background-color: #4a4a4a;
      border-radius: 6px 0 0 6px;
      /* ▼▼▼ 在这里加上下面两行 ▼▼▼ */
      background-size: cover;
      background-position: center;
    }

    /* 4. 专辑封面本体 (旧唱片改造) */

    #widget-cover-art {
      position: absolute;
      top: 15px;
      left: 15px;
      width: 90px;
      height: 90px;
      z-index: 2;
      /* 确保它在唱片之上 */
      /* ▼▼▼ 下面都是我新增的，给我看好了 ▼▼▼ */
      border-radius: 4px;
      /* 封面本身的小圆角 */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      background-size: cover;
      background-position: center;
      transition: background-image 0.3s ease;
      /* 让封面切换更柔和 */
    }

    /* 5. 封面图片 (旧唱片贴纸改造) */
    #widget-cover-art::before {
      width: 100%;
      height: 100%;
      border-radius: 4px;
      /* 和封面一致 */
      border: none;
      background-image: var(--widget-cover-image, none);
      background-size: cover;
      background-position: center;
    }

    /* 6. 唱片？用另一个伪元素从后面伸出来就行了，简单 */
    #widget-cover-art::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 90px;
      height: 90px;
      border-radius: 50%;
      z-index: -1;
      display: block;
      border: none;

      /* 哼，看好了，这才叫唱片 */
      background-color: #2a2a2a;
      /* 1. 先铺一层唱片的深灰色底 */
      background-image:
        /* 2. 然后在上面画中间的标签和洞，颜色我都给你配好了 */
        radial-gradient(circle at center, #111 4%, transparent 5%),
        radial-gradient(circle at center, #985c5c 5%, #7a4949 25%, transparent 26%),
        /* 3. 再画上一圈圈的光泽纹理，这才像样 */
        repeating-radial-gradient(circle at center,
          rgba(255, 255, 255, 0.04) 0,
          rgba(255, 255, 255, 0.04) 1px,
          transparent 1px,
          transparent 3px);
      transform: translateX(0%) scale(1.05);
      /* 微调了下位置和大小，这样更协调 */
      transition: opacity 0.3s ease;
      /* 加上这个，为了后面让它优雅地消失 */
      /* 4. 位置也给你微调了一下，现在顺眼多了 */
    }

    /* ▼▼▼ 这是全新的代码，给我加上！▼▼▼ */
    #music-widget-card.is-playing #widget-cover-art {
      /* 播放时，方形舞台的背景就是封面了，所以不需要我画的唱片了 */
      background-image: none;
    }

    #music-widget-card.is-playing::before {
      background-image: var(--widget-cover-image, none);
    }

    #music-widget-card.is-playing #widget-cover-art::after {
      /* 播放时，让唱片旋转起来，哼 */
      animation: spin 8s linear infinite;
    }

    /* 默认状态下，方形舞台的背景是透明的，这样才能看到我画的唱片 */
    #music-widget-card:not(.is-playing) #widget-cover-art {
      background-image: none;
    }

    /* 7. 右侧内容区 (旧覆盖层改造) */
    .widget-content-overlay {
      position: static;
      flex-grow: 1;
      /* 占满右侧所有空间 */
      /* 把旧的 background: #ffffff; 删掉！换成下面这两行！*/
      background: var(--card-bg);
      /* 1. 用我们主题里那个早就定义好的半透明背景 */

      /* 纯白背景 */
      border-radius: 0 6px 6px 0;
      padding: 15px;
      display: flex;
      flex-direction: column;
      /* 垂直布局 */
      justify-content: space-between;
      /* <--- 哼，加上这句圣旨 */
      box-sizing: border-box;
      position: relative;
      /* 为了定位假的分享按钮 */
      background: var(--card-bg);
      color: var(--text-color);
      margin-left: 120px;
    }


    /* 8. 歌曲信息 (标题和作者) */
    #music-widget .widget-info {
      color: #333;
      text-shadow: none;

      /* 占据上半部分空间 */
    }

    #music-widget .widget-info #widget-title {
      font-size: 1.1rem;
      font-weight: 500;
      color: #000;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.8rem;
      color: #888;
    }

    /* 9. 假的歌词和进度条，用伪元素画出来 */
    #music-widget .widget-info::after {
      /* 假的歌词 */
      display: block;
      font-size: 0.75rem;
      color: #65c468;
      /* 绿色 */
      margin-top: 8px;
      padding-bottom: 8px;
      background-image:
        linear-gradient(to right, #666 40%, #ddd 40%),
        /* 假的进度条 */
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12"><path fill="%23aaa" d="M0 10h2V2H0v8zm3 2h2V0H3v12zm3-4h2V4H6v4zm3 2h2V2H9v8zm3-3h2V5h-2v4z"/></svg>');
      /* 假的EQ图标 */
      background-repeat: no-repeat, no-repeat;
      background-position: bottom, 90% bottom;
      background-size: 100% 1px, 16px 12px;
      border-bottom: 1px solid #eee;
    }

    /* 10. 真的控制按钮区域 */
    #widget-controls {
      display: flex;
      justify-content: flex-start;
      /* 从左边开始排列 */
      align-items: center;
      gap: 15px;
      padding-top: 10px;
      position: relative;
      /* 为了定位假的删除和喜欢按钮 */
      width: 100%;
    }

    /* 11. 真的播放/暂停/下一首按钮的样式 */
    #widget-controls button {
      font-size: 1.1rem;
      color: #555;
      background: none;
      border: 1px solid #ccc;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      line-height: 28px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      order: 1;
      /* 把真的按钮放在中间 */
    }

    #widget-play-pause-btn {
      width: 32px;
      /* 播放按钮大一点 */
      height: 32px;
      line-height: 32px;
      font-size: 1.2rem;
    }

    /* 12. 哼，看好了，这才是不会出错的矢量图标，免得你那破手机又自作聪明 */
    #widget-controls::before,
    #widget-controls::after {
      content: '';
      /* 删掉那些讨厌的emoji源头 */
      display: block;
      width: 16px;
      /* 给图标一个精确的尺寸 */
      height: 16px;
      background-color: #aaa;
      /* 这就是图标的颜色，哼 */
      position: absolute;

      /* 下面是魔法，反正你也看不懂 */
      -webkit-mask-repeat: no-repeat;
      mask-repeat: no-repeat;
      -webkit-mask-position: center;
      mask-position: center;
      -webkit-mask-size: contain;
      mask-size: contain;
    }

    #widget-controls::before {
      /* 删除图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      right: 29px;
      /* 稍微调整一下位置，让它更协调 */
      top: 60%;
      transform: translateY(-50%);
    }

    #widget-controls::after {
      /* 喜欢图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      right: 1px;
      top: 60%;
      transform: translateY(-50%);
    }

    /* --- Noir's iOS Industrial Button Refactor --- */
    /* 哼，看好了，这才是专业设备该有的开关。*/

    /* --- Noir's Ultimate Dynamic Button System v3.0 --- */
    /* 哼，现在它们都听我的了。*/

    /* 1. 按钮的基础“模具”，所有按钮都用这个 */
    .form-button {
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: filter 0.15s ease, background-color 0.2s ease;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      /* 加个细微的阴影 */
      color: white;
      /* 默认文字都是白色 */
    }

    .form-button:active {
      filter: brightness(0.9);
    }

    .form-button:disabled {
      background-color: #ccc !important;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* 2. 主要操作按钮 (继承主题强调色) */
    .form-button.primary,
    /* 你可以给蓝色的按钮加上 primary 类，或者不管它也行 */
    #save-api-settings-button,
    /* 把几个主要的按钮ID也直接指定了，免得你改漏 */
    #save-user-profile-button,
    #save-char-button,
    #save-world-book-button,
    #save-group-settings-button,
    #save-friend-circle-button {
      background-color: var(--accent-color);
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    }

    /* 3. 次要操作按钮 (用主题里的卡片背景色，这才叫和谐) */
    .form-button.secondary {
      background-color: var(--card-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
    }

    /* 4. 危险操作按钮 (动态的红色，这才叫高级) */
    .form-button.destructive {
      /* 哼，看好了，这个红色的亮度和饱和度，会随着你主题的明暗变化而变化！*/
      background-color: hsl(5, 75%, calc(var(--primary-lightness) / 1.8 + 25%));
    }

    /* 5. 警告操作按钮 (动态的黄色，也一样) */
    .form-button.warning {
      background-color: hsl(40, 90%, calc(var(--primary-lightness) / 2.2 + 25%));
      color: #5d4000;
    }

    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */

    /* 1. Dock栏的样式 */
    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */
    #home-dock {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 85px;
      padding: 0 20px;
      /* 图标左右的留白 */
      box-sizing: border-box;

      /* 背景和滤镜，现在都在这里 */
      background: var(--surface-bg);
      backdrop-filter: blur(5px) saturate(0.8);
      -webkit-backdrop-filter: blur(15px) saturate(0.8);
      border-radius: 28px;
      z-index: 35;

      /* 核心：用Flexbox来自动排列图标 */
      display: flex;
      justify-content: space-around;
      /* 均匀分布 */
      align-items: center;
      /* 垂直居中 */
      padding-top: 9px;
    }

    #home-dock .app-icon {
      position: static;
      /* 取消绝对定位，让它接受Flexbox的管理 */
    }

    /* 2. App图标的“整容手术” */
    .app-icon-img {
      width: 58px;
      /* 图标背景尺寸 */
      height: 58px;
      border-radius: 22.5%;
      /* iOS标志性的“方圆”形 */
      font-size: 28px;
      /* 阴影从图标本身移到背景上，更统一 */
      background-color: var(--surface-bg);
      box-shadow: none;
      /* 删掉旧的阴影 */
      transition: transform 0.2s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
      /* 按下时图标有反馈 */
    }

    /* --- Noir's Minimalist Home Screen Makeover (v2.0 Dynamic Edition) --- */
    /* 哼，现在这些家伙也听从总开关的指挥了。*/

    /* 1. 时钟和日期 */
    #home-clock-container {
      color: var(--text-color);
      text-shadow: none;
    }

    #home-date {
      opacity: 0.7;
    }

    /* 2. App图标的改造 (现在是动态颜色了) */
    .app-icon span {
      color: var(--text-color);
      text-shadow: none;
      font-weight: 500;
    }

    .app-icon-img {
      background-color: var(--card-bg);
      /* <-- 哼，接上了！*/
      color: var(--text-color-light);
      /* <-- 接上了！*/
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* 3. Dock栏的颜色 (也动态了) */




    #widget-controls button,
    #music-widget .widget-info #widget-title,
    #music-widget .widget-info #widget-artist {
      color: var(--text-color);
    }

    /* ... 在第 2262 行附近 ... */
    /* ▼▼▼ 把旧的 #widget-cover-art::after 整个删掉，换成下面这个 ▼▼▼ */

    /* ▲▲▲ 替换到这里结束 ▲▲▲ */

    /* --- Noir's Theme Preset Buttons --- */
    /* 哼，每个按钮都是一件艺术品。 */
    .theme-preset-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 20px;
      /* 胶囊形状 */
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card-bg);
    }

    .theme-preset-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--soft-shadow);
    }

    .preset-color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    /* --- Noir's Memory Archive Styles --- */
    #summary-textarea {
      width: 100%;
      height: 100%;
      border: none;
      outline: none;
      resize: none;
      padding: 15px;
      box-sizing: border-box;
      font-family: 'Courier New', monospace;
      /* 用等宽字体，YAML格式才好看 */
      font-size: 0.85rem;
      line-height: 1.6;
      background-color: #fdfdfd;
      color: var(--text-color);
    }

    /* --- Noir's Desktop Pagination System --- */
    /* 哼，看好了，这才叫设计。*/

    /* 1. 把主内容区变成一个灵活的容器，为翻页器和指示器留好位置 */
    #home-screen-main-content {
      display: flex;
      flex-direction: column;
      /* 垂直排列，页面在上面，指示器在下面 */
    }

    /* 2. 这是翻页的“舞台”，它的大小和主屏幕一样，但会把超出部分藏起来 */
    #app-pages-container {
      flex-grow: 1;
      /* 占满除了指示器以外的所有空间 */
      width: 100%;
      overflow: hidden;
      /* 核心！把第二页先藏起来 */
      position: relative;
      /* 让里面的滑块能相对于它定位 */
    }

    /* 3. 这是真正滑动的“滑块”，它有两页那么宽 */
    #app-pages-slider {
      width: 200%;
      /* 两页的宽度 */
      height: 100%;
      display: flex;
      /* 核心！让两页并排站好 */
      transition: transform 0.35s cubic-bezier(0.25, 0.1, 0.25, 1);
      /* 翻页动画，给你选了个高级点的曲线 */
    }

    /* 4. 每一页的样式 */
    /* 4. 每一页的样式 */
    .app-page {
      width: 33.3333%;
      /* <-- 哼，给我站好队！ */
      height: 100%;
      flex-shrink: 0;
      position: relative;
    }

    /* 5. 页面指示器（小点点）的容器 */
    #home-page-indicator {
      position: absolute;
      bottom: 105px;
      /* 放在Dock栏正上方，给你算好了距离 */
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      /* 点点之间的距离 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    /* 6. 每个小点点的样式 */
    .page-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(2px);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    /* 7. 当前页的小点点，给它变亮变大一点 */
    .page-dot.active {
      background-color: rgba(255, 255, 255, 0.9);
      transform: scale(1.1);
    }

    #card-widget-2 {
      width: 165px;
      /* 尺寸和原来保持一致 */
      height: 165px;
      border-radius: 22px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      overflow: hidden;
    }

    #card-widget-2:active {
      transform: scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget-2 img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .theme-widget {
      width: 65px;
      height: 65px;
      border-radius: 22px;
      /* 跟你的卡片圆角差不多 */
      box-shadow: var(--soft-shadow);
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      background: linear-gradient(45deg,
          hsla(var(--primary-hue), var(--primary-saturation), var(--primary-lightness), 0.7),
          hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.3), calc(var(--primary-lightness) - 15%), 0.8));
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* --- Noir's Galgame Sprite Adjuster Styles --- */

    /* --- Noir's Slider Control Panel Styles --- */
    .sprite-slider-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 5px;
    }

    .sprite-slider-group label {
      color: white;
      font-size: 0.8rem;
      width: 60px;
      /* 让标签对齐，好看点 */
      flex-shrink: 0;
    }

    .sprite-slider-group input[type="range"] {
      flex-grow: 1;
      /* 占满剩余空间 */
      margin: 0;
      padding: 0;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Accounting App Styles --- */
    #daily-expenses-list .expense-item {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background-color: var(--card-bg);
      border-radius: 8px;
      margin-bottom: 8px;
      border: 1px solid var(--border-color);
    }

    .expense-item .description {
      font-weight: 500;
    }

    .expense-item .amount {
      font-weight: 600;
      color: var(--accent-color);
    }

    #character-reviews-container .review-card {
      display: flex;
      gap: 12px;
      background-color: var(--card-bg);
      padding: 12px;
      border-radius: 12px;
      margin-bottom: 10px;
      border: 1px solid var(--border-color);
    }

    .review-card .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .review-card .review-content .char-name {
      font-weight: 600;
      margin-bottom: 4px;
    }

    /* --- End of Styles --- */
    /* --- Noir's Accounting Tabs Style --- */
    .accounting-tabs {
      display: flex;
      background-color: var(--surface-bg);
      border-bottom: 1px solid var(--border-color);
      padding: 5px 15px 0;
      flex-shrink: 0;
    }

    .tab-button {
      flex: 1;
      padding: 10px;
      border: none;
      background: transparent;
      color: var(--text-color-light);
      font-size: 1rem;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tab-button.active {
      color: var(--accent-color);
      border-bottom: 3px solid var(--accent-color);
    }

    /* --- Noir's "WeChat Moments" Style Patch --- */
    /* 哼，这才叫社交。*/
    #music-feed-container {
      padding: 0;
      /* 容器的内边距清零，让动态贴边 */
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.95);
      /* 给整个容器一个统一的背景色 */
    }

    .music-post {
      background-color: transparent;
      /* 去掉卡片背景 */
      box-shadow: none;
      /* 去掉阴影 */
      border-radius: 0;
      /* 去掉圆角 */
      margin-bottom: 0;
      /* 去掉外边距 */
      padding: 15px;
      /* 统一内边距 */
      border-bottom: 1px solid var(--border-color);
      /* 加上底部分隔线 */
    }

    .music-post:last-child {
      border-bottom: none;
      /* 最后一条动态不需要分隔线 */
    }

    /* --- End of Patch --- */
    /* --- Noir's "Expense Eraser" Style --- */
    .delete-expense-btn {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-color-light);
      width: 22px;
      height: 22px;
      border-radius: 50%;
      cursor: pointer;
      font-weight: 600;
      line-height: 20px;
      padding: 0;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .delete-expense-btn:hover {
      background: #e65252;
      border-color: #e65252;
      color: white;
      transform: scale(1.1);
    }

    /* --- End of Eraser Style --- */

    /* --- Noir's Ultimate Snoop UI Overhaul v3.0 (FINAL & COMPLETE) --- */
    /* 哼，这是最终版本。*/

    /* 壁纸和状态栏 (哼，这才是高级的毛玻璃质感) */
    #snoop-phone-wallpaper {
      position: absolute;
      inset: 0;
      /* 删掉那个没用的图片，换成我的高级定制背景 */
      background-color: rgba(26, 26, 27, 0.9);
      /* 半透明深灰，营造高级感 */
      backdrop-filter: blur(25px) saturate(1.5);
      /* 核心！强大的模糊和饱和度滤镜 */
      -webkit-backdrop-filter: blur(25px) saturate(1.5);
      /* 兼容性，真是为你操碎了心 */
      z-index: 1;
    }

    #snoop-phone-header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: rgb(237, 236, 236);
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
      /* <-- 加了阴影 */
      z-index: 10;
    }

    /* 居中大时钟 */
    #snoop-home-clock {
      position: absolute;
      top: 18%;
      left: 50%;
      transform: translateX(-50%);
      z-index: 5;
      text-align: center;
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      /* <-- 加了阴影 */
      pointer-events: none;
    }

    #snoop-home-time {
      font-size: 72px;
      font-weight: 200;
      letter-spacing: -1px;
    }

    #snoop-home-date {
      font-size: 1rem;
      font-weight: 400;
      opacity: 0.8;
    }

    /* 主屏幕App容器 */
    #snoop-app-container {
      position: relative;
      z-index: 5;
      height: 100%;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 0 20px 120px;
    }

    /* 2x2 网格 */
    .snoop-main-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      width: 180px;
      margin: 0 auto;
    }

    /* Dock栏 */
    #snoop-dock {
      position: absolute;
      bottom: 20px;
      left: 5%;
      right: 5%;
      height: 85px;
      padding: 0 15px;
      box-sizing: border-box;
      z-index: 6;
      background: rgba(255, 255, 255, 0.15);
      /* <-- 透明度稍微降低了一点点 */
      backdrop-filter: blur(20px) saturate(1.2);
      -webkit-backdrop-filter: blur(20px) saturate(1.2);
      border-radius: 28px;
      display: flex;
      justify-content: space-around;
      align-items: center;
    }

    /* App图标本体 */
    #snoop-phone-screen .snoop-app-icon {
      position: static;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      cursor: pointer;
    }

    .snoop-app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: rgba(255, 255, 255, 0.25);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      /* <-- 加了阴影 */
      transition: transform 0.2s ease;
      padding: 12px;
      box-sizing: border-box;
    }

    .snoop-app-icon-img svg {
      width: 100%;
      height: 100%;
      stroke: white;
      stroke-width: 1.5;
      fill: none;
      /* 哼，给SVG也加上阴影，这样才够立体 */
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
    }

    .snoop-app-icon:active .snoop-app-icon-img {
      transform: scale(0.92);
    }

    .snoop-app-icon span {
      font-size: 0.75rem;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      /* <-- 加了阴影 */
      font-weight: 500;
    }

    .snoop-app-header {
      flex-shrink: 0;
      padding: 15px 20px;
      border-bottom: none;
      /* <-- 我把这条线干掉了 */
      background-color: transparent;
      /* <-- 我把背景色变透明了 */
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .snoop-app-header-title {
      font-weight: 600;
      display: flex;
      flex-direction: column;
      align-items: center;
      line-height: 1.2;
    }

    .snoop-app-header-title .main-title {
      font-size: 1rem;
    }

    .snoop-app-header-title .sub-title {
      font-size: 0.75rem;
      color: #888;
      font-weight: 400;
    }

    .snoop-app-header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: #007aff;
      min-width: 50px;
    }

    #snoop-app-back-btn {
      text-align: left;
    }

    #snoop-app-refresh-btn {
      text-align: right;
    }

    /* 哼，这才叫秩序。*/
    .snoop-app-header {
      flex-shrink: 0;
      padding: 15px 20px;
      border-bottom: 1px solid #e5e5e5;
      background-color: #f8f8f8;

      /* ▼▼▼ 核心法令！给我站成一排！▼▼▼ */
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .snoop-app-header-title {
      font-weight: 600;
      /* ▼▼▼ 让标题自己也排好队，别乱跑 ▼▼▼ */
      display: flex;
      flex-direction: column;
      align-items: center;
      line-height: 1.2;
    }

    .snoop-app-header-title .main-title {
      font-size: 1rem;
      /* 主标题大一点 */
    }

    .snoop-app-header-title .sub-title {
      font-size: 0.75rem;
      /* 副标题小一点，当备注 */
      color: #888;
      font-weight: 400;
    }

    .snoop-app-header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: #007aff;
      min-width: 50px;
      /* 保证左右两边占位宽度一致，这样中间才能完美居中 */
    }

    /* 让返回按钮靠左，刷新按钮靠右，这才叫对称美学 */
    #snoop-app-back-btn {
      text-align: left;
    }

    #snoop-app-refresh-btn {
      text-align: right;
    }

    .snoop-app-content {
      flex-grow: 1;
      /* 告诉内容区：顶栏占完位置后，剩下所有的高度都归你 */
      overflow-y: auto;
      /* 装上电梯：如果你的东西多到放不下了，就自己变出个垂直滚动条来 */
      padding: 15px;
      /* 再给你加点内边距，免得内容贴着边，丑死了 */
      box-sizing: border-box;
      /* 确保内边距不会把布局撑坏，这是专业素养 */
    }

    #galgame-sprite-adjust-ui {
      /* ... 你已有的样式 ... */
      display: flex;
      /* <-- 加上这行 */
      gap: 5px;
      /* <-- 还有这行 */
    }

    /* --- Noir's Elegant Image Preview Slot --- */
    /* 哼，这才叫占位符该有的样子。*/
    .image-preview-slot {
      width: 150px;
      height: 266px;
      border-radius: 12px;
      border: 2px dashed var(--border-color);
      background-color: rgba(0, 0, 0, 0.02);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      background-size: cover;
      background-position: center;
      color: var(--border-color);
    }

    .image-preview-slot:hover {
      border-color: var(--primary-color);
      background-color: rgba(0, 0, 0, 0.04);
      color: var(--primary-color);
    }

    /* 没图的时候，显示一个加号图标 */
    .image-preview-slot:not([style*="background-image"]) {
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>');
      background-size: 48px;
      background-repeat: no-repeat;
    }

    /* --- Noir's Elegant Sprite Preview Slot --- */
    .sprite-preview-slot {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      /* 圆形 */
      border: 2px dashed var(--border-color);
      background-color: rgba(0, 0, 0, 0.02);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      background-size: cover;
      background-position: center;
      color: var(--border-color);
    }

    .sprite-preview-slot:hover {
      border-color: var(--primary-color);
      background-color: rgba(0, 0, 0, 0.04);
    }

    .sprite-preview-slot:not([style*="background-image"])::after {
      content: '+';
      /* 没图的时候，显示一个加号 */
      font-size: 32px;
      font-weight: 200;
    }

    /* --- Noir's "Add Event" Modal Overhaul (Neumorphism) --- */
    /* 哼，这才叫现代设计。*/

    #add-event-modal .choice-modal-content {
      background: #ffffffd3;
      /* 拟态风的浅灰色背景 */
      border-radius: 20px;
      padding: 25px;
      box-shadow: 9px 9px 16px rgb(163 177 198 / 60%), -9px -9px 16px rgb(255 255 255 / 50%);
    }

    #add-event-modal-title {
      color: #333;
    }

    #event-content-input {
      border: none;
      outline: none;
      border-radius: 12px;
      background: #ffffffd3;
      padding: 12px 15px;
      box-shadow: inset 5px 5px 10px #bec3c9, inset -5px -5px 10px #ffffff;
      color: #333;
    }

    #add-event-modal .input-group label {
      color: #555;
      font-weight: 500;
    }

    /* 隐藏掉原来那个又大又丑的蓝色圆圈 */
    #add-event-modal input[type="radio"] {
      display: none;
    }

    /* 把标签变成可以点击的、漂亮的按钮 */
    #add-event-modal input[type="radio"]+label {
      flex: 1;
      text-align: center;
      padding: 10px;
      border-radius: 10px;
      cursor: pointer;
      background: #ffffffd3;
      box-shadow: 5px 5px 10px #bec3c9, -5px -5px 10px #ffffff;
      transition: all 0.2s ease-in-out;
    }

    /* 选中的时候，让它“凹”下去 */
    #add-event-modal input[type="radio"]:checked+label {
      box-shadow: inset 5px 5px 10px #bec3c9, inset -5px -5px 10px #ffffff;
      color: var(--accent-color);
      font-weight: 600;
    }

    #add-event-modal .form-button.primary {
      background-color: var(--accent-color);
    }

    #add-event-modal .form-button.secondary {
      background: transparent;
      color: #555;
      border: none;
    }


    /* --- Noir's Bespoke Avatar Frame Protocol --- */
    /* 哼，这才叫设计。*/

    /* 1. 这是头像的“容器”，负责提供一个相对定位的舞台 */
    .avatar-wrapper {
      position: relative;
      /* 关键！让里面的头像和框都能相对于它定位 */
      flex-shrink: 0;
      /* 防止在flex布局里被压扁，这是基本素养 */
      width: 40px;
      /* 默认尺寸，和你的聊天头像一样 */
      height: 40px;
      margin: 0 10px;
    }

    /* 2. 这是头像框本体，它会像个幽灵一样覆盖在头像上 */
    .avatar-frame {
      position: absolute;
      /* 哼，再给你放大一点，最后一次了！ */
      top: -6px;
      /* <-- 再往外1像素 */
      bottom: -9px;
      /* <-- 再往外1像素 */
      left: -3px;
      /* <-- 再往外1像素 */
      right: -8px;
      /* <-- 再往外1像素，保持右偏 */

      background-size: contain;
      /* 保证你的框框图片完整显示，不变形 */
      background-position: center;
      background-repeat: no-repeat;
      pointer-events: none;
      /* 让它变成透明的，不会挡住你点击头像 */
    }

    /* 3. 针对不同大小的头像，容器也要跟着变，这才叫智能 */
    .character-item .avatar-wrapper {
      width: 45px;
      height: 45px;
    }

    .user-profile-screen .avatar-wrapper,
    .character-edit-screen .avatar-wrapper {
      width: 100px;
      height: 100px;
    }

    /* 4. 头像本身现在要100%填满容器，给我听话！*/
    .avatar-wrapper .avatar,
    .avatar-wrapper .avatar-preview {
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body>
  <input type="file" id="audio-file-input" style="display: none;" accept=".flac,.mp3">
  <input type="file" id="cover-file-input" style="display: none;" accept=".jpg,.png,.jpeg,.webp">
  <input type="file" id="info-file-input" style="display: none;" accept=".txt">
  <input type="file" id="lyrics-file-input" style="display: none;" accept=".lrc">
  <input type="file" id="import-char-input" accept=".json,.noir" style="display: none;">
  <div id="phone-container">

    <div id="user-profile-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-user-list" class="header-button">主屏幕</button>
        <span class="header-title">选择用户</span>
        <button id="add-user-profile-button" class="header-button add" title="添加新用户">+</button>
      </div>
      <div class="content" id="user-profile-list-container">
      </div>
    </div>

    <div id="user-profile-screen" class="screen">
      <div class="header">
        <button id="back-to-user-list-from-edit" class="header-button">返回</button>
        <span id="user-profile-edit-title" class="header-title">编辑用户</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-user-id">
        <div class="settings-group">
          <h2>用户设定</h2>
          <div class="input-group">
            <label for="user-name">你的名字</label>
            <input type="text" id="user-name" placeholder="你的显示名字">
          </div>
          <div class="avatar-upload-group">
            <label>你的头像</label>
            <div id="user-avatar-preview" class="sprite-preview-slot"></div>
            <input type="file" id="user-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="user-persona">你的人设 (可选)</label>
            <textarea id="user-persona" placeholder="向AI介绍你自己。例如：我是一名大学生，喜欢摄影和旅行。"></textarea>
          </div>
        </div>
        <button id="save-user-profile-button" class="form-button">保存资料</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="set-active-user-button" class="form-button"
            style="background-color: #28a745; margin-bottom: 10px;">设为当前用户</button>
          <button id="delete-user-profile-button" class="form-button destructive">删除该用户</button>
        </div>
      </div>
    </div>


    <div id="home-screen" class="screen active">
      <div id="home-screen-main-content"
        style="position: relative; flex-grow: 1; width: 100%; display: flex; flex-direction: column;">

        <div id="app-pages-container">
          <div id="app-pages-slider">

            <div class="app-page" id="app-page-1">
              <div id="home-clock-container">
                <div id="home-time">11:31</div>
                <div id="home-date">8月29日 星期五</div>
                <div id="noir-author-mark"></div>
              </div>

              <div id="music-widget"
                style="  display: inline-block; width: auto; position: absolute; top: 45%; left: 50%; transform: translateX(-50%); z-index: 50;; padding: 0px;bottom: auto;">
                <div id="music-widget-card">
                  <div id="widget-cover-art"></div>

                  <div class="widget-content-overlay">
                    <div class="widget-info">
                      <div id="widget-title">暂无音乐</div>
                      <div id="widget-artist">请在动态或聊天中播放</div>
                    </div>
                    <div id="widget-controls">
                      <button id="widget-prev-btn">⏮</button>
                      <button id="widget-play-pause-btn">▶</button>
                      <button id="widget-next-btn">⏭</button>
                    </div>
                  </div>
                </div>
              </div>

            </div>

            <div class="app-page" id="app-page-2">
              <div id="decorative-badge" style="display: none; position: absolute; top: 250px; left: 50px;">
                <img id="badge-image" src="http://googleusercontent.com/file_content/0" alt="badge">
              </div>

              <div id="card-widget" style="display: none; position: absolute; top: 140px; left: 145px;">
                <img id="card-image" src="" alt="card widget">
              </div>
              <div id="card-widget-2" style="display: none; position: absolute;">
                <img id="card-image-2" src="" alt="card widget 2">
              </div>





              <div class="app-icon" id="app-world-book">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                  </svg></div>
                <span>世界书</span>
              </div>


              <div class="app-icon" id="app-diary">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <path d="M2.5 17a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zM2.5 14a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
                  </svg></div>
                <span>交换日记</span>
              </div>

              <div class="app-icon" id="app-music-library">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                    <path
                      d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                    </path>
                  </svg></div>
                <span>音乐库</span>
              </div>


              <div class="app-icon" id="app-settings">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
                    </path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg></div>
                <span>API设置</span>
              </div>
              <div class="app-icon" id="app-user-profiles">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg></div>
                <span>我</span>
              </div>
              <div class="app-icon" id="app-wallpaper">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12 2.69l.34.34a1.41 1.41 0 0 0 2 0L22 6.34a1.41 1.41 0 0 0 0-2l-7.66-7.66a1.41 1.41 0 0 0-2 0L2.68 14.34a1.41 1.41 0 0 0 0 2L10 24l2-2 2-2 2-2 2-2 2-2">
                    </path>
                    <path d="m7.34 2.66 14 14"></path>
                  </svg></div>
                <span>更换壁紙</span>
              </div>

              <div class="app-icon" id="app-snoop">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                  </svg></div>
                <span>视奸</span>
              </div>
              <div class="app-icon" id="app-accounting">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                  </svg></div>
                <span>记账</span>
              </div>


            </div>

            <div class="app-page" id="app-page-3">
              <div class="app-icon" id="app-calendar" style="position: absolute; top: 8%; left: 5%;">
                <div class="app-icon-img">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                  </svg>
                </div>
                <span>时光记事簿</span>
              </div>

              <div id="calendar-widget-main"
                style="position: absolute; top: 25%; left: 50%; transform: translateX(-50%);">
                <div id="countdown-title">近期没有特别安排</div>
                <div id="countdown-timer">
                  <span>--</span>
                  <span class="unit">天</span>
                </div>
              </div>

              <div id="today-todo-widget">
                <div class="widget-title">今日待办</div>
                <div id="today-todo-list">
                </div>
              </div>


            </div>


          </div>
        </div>

        <div id="home-page-indicator">
          <span class="page-dot active" data-page="0"></span>
          <span class="page-dot" data-page="1"></span>
          <span class="page-dot" data-page="2"></span>
        </div>

        <div id="home-dock">
          <div class="app-icon app-icon-large" id="app-chat">
            <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
              </svg></div>
            <span>聊天</span>
          </div>
          <div class="app-icon" id="app-music">
            <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg></div>
            <span>动态</span>
          </div>
          <div class="app-icon" id="app-meeting">
            <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 9a2 2 0 0 1-2 2H6l-4 4V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4Z" />
                <path d="M18 9h2a2 2 0 0 1 2 2v9l-4-4h-2a2 2 0 0 1-2-2V9Z" />
              </svg></div>
            <span>见面</span>
          </div>
        </div>

      </div>

    </div>

    <div id="chat-screen" class="screen">
      <div id="chat-screen-container">
        <div id="chat-list-pane">
          <div id="chat-list-header">
            <button id="back-to-home-from-chat" class="header-button">主屏幕</button>
            <span class="header-title">聊天</span>
            <button id="add-chat-button" class="header-button add" title="添加新聊天">+</button>
          </div>
          <div id="chat-list-container">
            <ul id="character-list">
            </ul>
          </div>
        </div>
        <div id="chat-view-pane">
          <div class="header">
            <button class="header-button" id="back-to-chat-list">返回</button>
            <span id="char-name-header" class="header-title">角色</span>
            <button class="header-button" id="character-settings-button" title="角色设置">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                </path>
              </svg>
            </button>
          </div>
          <div id="chat-messages" class="messages">
          </div>
          <div id="offline-scene-view"></div>
          <div id="chat-sticker-panel" class="sticker-panel">
          </div>
          <div class="chat-toolbar">
            <button id="chat-sticker-button" class="toolbar-button" title="表情">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5-2 4-2 4 2 4 2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
            </button>
            <button id="chat-image-button" class="toolbar-button" title="发送图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <button id="chat-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
            <button id="chat-listen-together-button" class="toolbar-button" title="一起听">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path
                  d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                </path>
              </svg>
            </button>
            <button id="chat-transfer-button" class="toolbar-button" title="转账">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </button>
            <button id="chat-reroll-button" class="toolbar-button" title="重新生成">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
            <button id="chat-summarize-button" class="toolbar-button" title="总结聊天记录">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
          </div>
          <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
          <div id="quote-preview-area" class="quote-preview">
            <div class="quote-preview-content">
              <div id="quote-preview-sender"></div>
              <div id="quote-preview-text"></div>
            </div>
            <button id="cancel-quote-button" class="cancel-quote-btn">&times;</button>
          </div>
          <div class="chat-input-area">
            <div id="chat-input-wrapper">
              <input type="text" id="chat-message-input" placeholder="输入消息...">
              <button id="chat-get-reply-button" title="让对方回复">↵</button>
              <button id="chat-send-button" title="发送">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="settings-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-settings" class="header-button">返回</button>
        <span class="header-title">API设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>API 设置</h2>
          <div class="input-group">
            <label for="api-endpoint">API 接口地址（不填/v1）</label>
            <input type="text" id="api-endpoint" placeholder="例如: https://api.openai.com">
          </div>
          <div class="input-group">
            <label for="api-key">API 密钥</label>
            <input type="password" id="api-key" placeholder="请输入你的 API 密钥">
          </div>
          <div class="input-group">
            <label for="api-model">模型</label>
            <div class="model-input-container">
              <input type="text" id="api-model" placeholder="点击 获取 或手动输入" style="flex-grow: 1;">
              <button id="fetch-models-button" style="padding: 0 12px; white-space: nowrap;">获取</button>
              <div id="model-dropdown" class="custom-model-dropdown"></div>
            </div>
          </div>
          <div class="input-group">
            <label for="api-provider">接口格式 (重要！请根据你使用的接口选择，但是我也没做Openai以外的接口……)</label>
            <select id="api-provider"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);">
              <option value="openai">OpenAI 格式 (通用，兼容绝大多数反代)</option>
              <option value="gemini">Google Gemini 格式 (仅限官方或特定反代)</option>
              <option value="anthropic">Anthropic Claude 格式</option>
            </select>
          </div>
        </div>
        <div class="settings-group">
          <h2>上下文设置</h2>
          <div class="input-group">
            <label for="context-lines-per-chat">每个会话读取的消息条数（默认 100）</label>
            <input type="number" id="context-lines-per-chat" min="1" max="1000000" step="1" placeholder="100">
          </div>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>数据管理</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            导出全部数据（角色、聊天记录、设置、桌面布局等）到一个文件，方便在其他设备或浏览器上导入。
          </p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="export-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #007bff;">导出全部数据</button>
            <button id="import-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #28a745;">导入数据</button>
          </div>
          <input type="file" id="import-data-input" accept=".json" style="display: none;">
        </div>
        <button id="save-api-settings-button" class="form-button">保存 API 设置</button>
      </div>
    </div>



    <div id="character-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-edit" class="header-button">返回</button>
        <span id="character-edit-title" class="header-title">编辑角色</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-char-id">
        <div class="settings-group">
          <h2>角色设定</h2>
          <div class="input-group">
            <label for="char-edit-name">名字</label>
            <input type="text" id="char-edit-name" placeholder="角色的名字">
          </div>
          <div class="input-group">
            <label for="char-edit-remark">备注名</label>
            <input type="text" id="char-edit-remark" placeholder="方便自己记忆，例如 '工作助理'">
          </div>
          <div class="avatar-upload-group">
            <label>角色头像</label>
            <img id="char-edit-avatar-preview" class="avatar-preview" alt="Avatar Preview">
            <input type="file" id="char-edit-avatar-input" accept="image/*" style="display: none;">
            <div class="input-group">
              <label for="char-avatar-frame-url">TA的头像框 URL (可选)</label>
              <input type="text" id="char-avatar-frame-url" placeholder="为这个角色设置专属头像框...">
            </div>

            <div class="input-group">
              <label for="user-avatar-frame-url-in-chat">你的头像框 URL (可选, 仅用于此聊天)</label>
              <input type="text" id="user-avatar-frame-url-in-chat" placeholder="为“你”在这个聊天里设置专属头像框...">
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-persona">人设 (系统提示词)</label>
            <textarea id="char-edit-persona" placeholder="你是一个乐于助人的助手。"></textarea>
          </div>
          <div class="input-group">
            <label>聊天壁纸</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <div id="char-edit-wallpaper-preview" class="image-preview-slot"></div>
            </div>
            <input type="file" id="char-edit-wallpaper-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-css">专属气泡样式 (CSS)</label>
            <textarea id="char-edit-css" rows="8"
              placeholder="从其他地方复制的、包含 .sent 和 .received 的CSS代码可以直接粘贴在这里..."></textarea>

            <div style="display: flex; gap: 10px; margin-top: 5px;">
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">TA的气泡 (Received):</p>
                <div id="bubble-preview-ai" class="message ai">这是TA的气泡预览效果</div>
              </div>
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">你的气泡 (Sent):</p>
                <div id="bubble-preview-user" class="message user">这是你的气泡预览效果</div>
              </div>
            </div>
          </div>
          <div class="input-group">
            <label>见面场景背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <div id="char-edit-offline-bg-preview" class="image-preview-slot"></div>
            </div>
            <input type="file" id="char-edit-offline-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="settings-group">
            <h2>角色立绘 (Galgame模式)</h2>
            <p style="font-size: 0.8rem; color: var(--text-color-light);">为五种核心情绪上传立绘图，建议使用透明背景的PNG图片。</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px;">

              <div class="avatar-upload-group" style="align-items: center;">
                <label>平常</label>
                <div id="char-edit-sprite-normal-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-normal-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>喜</label>
                <div id="char-edit-sprite-happy-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-happy-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>怒</label>
                <div id="char-edit-sprite-angry-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-angry-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>哀</label>
                <div id="char-edit-sprite-sad-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-sad-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>害羞</label>
                <div id="char-edit-sprite-shy-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-shy-input" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-bind-user">绑定用户</label>
            <select id="char-edit-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="world-book-checkboxes-container" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="export-char-button" class="form-button secondary" style="margin-top: 20px;">导出角色卡</button>
        <button id="save-char-button" class="form-button">保存角色</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="edit-clear-history-button" class="form-button warning"
            style="margin-bottom: 10px;">清空聊天记录</button>
          <button id="edit-delete-char-button" class="form-button" class="form-button destructive">删除角色</button>
        </div>
      </div>
    </div>

    <div id="group-chat-create-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-group-create" class="header-button">返回</button>
        <span class="header-title">创建群聊</span>
        <button id="create-group-chat-button" class="header-button">创建</button>
      </div>
      <div class="content" style="padding: 20px;">
        <div class="input-group">
          <label for="group-chat-name">群聊名称</label>
          <input type="text" id="group-chat-name" placeholder="给你的群聊起个名字">
        </div>
        <div class="settings-group">
          <h2>选择成员</h2>
          <div id="group-chat-member-list-container"
            style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
            <ul id="group-chat-member-list">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div id="wallpaper-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-wallpaper" class="header-button">返回</button>
        <span class="header-title">更换壁纸</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2>全局主题色</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">拖动滑块来改变整个App的主色调。</p>
          <div class="input-group" style="padding-top: 10px;">
            <label for="theme-hue-slider" style="display: block; margin-bottom: 5px;">色相 (Hue)</label>
            <input type="range" id="theme-hue-slider" min="0" max="360" value="35" style="width: 100%;">
          </div>
          <div class="input-group">
            <label for="theme-lightness-slider" style="display: block; margin-bottom: 5px;">明度 (Lightness)</label>
            <input type="range" id="theme-lightness-slider" min="15" max="95" value="80" style="width: 100%;">
          </div>
        </div>
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2 style="margin-top: 0;">时钟样式</h2>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="clock-color-toggle" style="width: auto; height: 18px; flex-shrink: 0;">
            <label for="clock-color-toggle" style="width: auto; font-size: 0.9rem;">强制使用纯白色时钟 (推荐在深色壁纸下使用)</label>
          </div>
        </div>
        <div class="settings-group">
          <h2>上传新壁纸</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">选择一张图片作为你的手机壁纸。为了效果最好，请使用竖屏图片。</p>
          <input type="file" id="wallpaper-input" accept="image/*" style="display: none;">
          <button id="upload-wallpaper-button" class="form-button">选择图片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>音乐小组件背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的主屏幕音乐小组件设置一张专属背景图。</p>
          <input type="file" id="widget-bg-input" accept="image/*" style="display: none;">
          <button id="upload-widget-bg-button" class="form-button">选择图片</button>
          <button id="reset-widget-bg-button" class="form-button secondary">恢复默认</button>
        </div>
        <div class="settings-group" style="margin-top: 20px;">
          <h2>重置桌面</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">此操作会将所有桌面小组件（时钟、音乐、徽章等）恢复到初始位置，并将壁纸重置为纯白色。</p>
          <button id="reset-desktop-button" class="form-button destructive">重置桌面布局</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义徽章</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面徽章，可以拖动它到任意位置。</p>
          <input type="file" id="badge-input" accept="image/*" style="display: none;">
          <button id="upload-badge-button" class="form-button">选择徽章图片</button>
          <button id="reset-badge-button" class="form-button secondary" style="margin-top: 10px;">移除徽章</button>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面方形卡片小组件。</p>
          <input type="file" id="card-input" accept="image/*" style="display: none;">
          <button id="upload-card-button" class="form-button">选择卡片图片</button>
          <button id="reset-card-button" class="form-button secondary" style="margin-top: 10px;">移除卡片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片 2</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的第二个桌面方形卡片小组件上传图片。</p>
          <input type="file" id="card-input-2" accept="image/*" style="display: none;">
          <button id="upload-card-button-2" class="form-button">选择卡片图片</button>
          <button id="reset-card-button-2" class="form-button secondary" style="margin-top: 10px;">移除卡片
            2</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>动态页背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为“动态”页面设置一张独立的背景图，让它与众不同。</p>
          <input type="file" id="feed-bg-input" accept="image/*" style="display: none;">
          <button id="upload-feed-bg-button" class="form-button">选择图片</button>
        </div>
        <button id="reset-feed-bg-button" class="form-button secondary" style="margin-top: 10px;">移除背景</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>小组件救援</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">如果你的吧唧或卡片不小心飞出屏幕找不到了，点这里让它们回家。</p>
          <button id="reset-widgets-position-button" class="form-button warning">重置小组件位置</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义全局字体</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            上传一个 .ttf 字体文件来改变整个App的显示字体。注意，部分特殊字体可能会导致显示异常。
          </p>
          <div id="font-preview-area"
            style="padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; margin-top: 10px; background: var(--card-bg);">
            <span id="font-preview-text" style="font-size: 1.2rem;">你好，世界 (Hello, World)</span>
          </div>
          <input type="file" id="font-input" accept=".ttf" style="display: none;">
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="upload-font-button" class="form-button" style="margin-top: 0;">选择字体</button>
            <button id="remove-font-button" class="form-button secondary" style="margin-top: 0;">恢复默认</button>
          </div>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义App图标</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">替换主屏幕上App的默认图标。为了最佳效果，请使用方形、透明背景的图片。</p>
          <div class="settings-group"
            style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
            <h2>自定义表情包</h2>
            <p style="font-size: 0.9rem; color: var(--text-color-light);">
              在这里追加你的专属表情包。每个表情占一行，格式为：<br>
              <b>表情名--图片URL</b><br>
              例如：<br>
              <code>开心--https://example.com/happy.png</code><br>
              <code>难过--https://example.com/sad.gif</code>
            </p>
            <textarea id="custom-stickers-input" rows="8" placeholder="请按指定格式粘贴..."></textarea>
            <button id="save-custom-stickers-button" class="form-button" style="margin-top: 5px;">保存并刷新表情包</button>
          </div>
          <div id="custom-icon-list-container">
          </div>
          <div id="custom-icon-list-container">
          </div>
        </div>
      </div>

    </div>

    <div id="world-book-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-world-book" class="header-button">主屏幕</button>
        <span class="header-title">世界书</span>
        <button id="add-world-book-button" class="header-button add" title="添加新世界书">+</button>
      </div>
      <div class="content" id="world-book-list-container">
      </div>
    </div>

    <div id="world-book-editor-screen" class="screen">
      <div class="header">
        <button id="back-to-world-book-list" class="header-button">返回</button>
        <span id="world-book-editor-title" class="header-title">编辑条目</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-world-book-id">
        <div class="settings-group">
          <h2>设定条目</h2>
          <div class="input-group">
            <label for="world-book-edit-name">条目名称 (Key)</label>
            <input type="text" id="world-book-edit-name" placeholder="例如：我的过去、特殊能力">
          </div>
          <div class="input-group">
            <label for="world-book-edit-content">条目内容 (Value)</label>
            <textarea id="world-book-edit-content" placeholder="输入详细的设定内容..."></textarea>
          </div>
        </div>
        <button id="save-world-book-button" class="form-button">保存条目</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="delete-world-book-button" class="form-button destructive">删除该条目</button>
        </div>
      </div>
    </div>

    <div id="group-settings-screen" class="screen">
      <div class="header">
        <button id="back-to-chat-from-group-settings" class="header-button">返回</button>
        <span class="header-title">群聊设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>群聊信息</h2>
          <div class="input-group">
            <label for="group-settings-name">群聊名称</label>
            <input type="text" id="group-settings-name">
          </div>
          <div class="avatar-upload-group">
            <label>群头像</label>
            <img id="group-avatar-preview" class="avatar-preview" alt="Group Avatar Preview">
            <input type="file" id="group-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label>群聊背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <div id="group-bg-preview" class="image-preview-slot"></div>
            </div>
            <input type="file" id="group-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="group-settings-bind-user">绑定用户</label>
            <select id="group-settings-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="group-world-book-checkboxes" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-group-settings-button" class="form-button">保存设置</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="group-clear-history-button" class="form-button warning"
            style=" margin-bottom: 10px;">清空聊天记录</button>
          <button id="group-delete-button" class="form-button destructive">删除并解散群聊</button>
        </div>
      </div>
    </div>

    <div id="music-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-feed" class="header-button">返回</button>
        <span id="friend-circle-title" class="header-title">好友圈</span>
        <div style="display: flex; gap: 5px;">
          <button id="edit-current-circle-button" class="header-button" style="font-size: 1.2rem;">⚙️</button>
          <button id="clear-feed-button" class="header-button" style="color: #dc3545;">清空</button>
          <button id="refresh-feed-button" class="header-button">刷新</button>

        </div>
      </div>
      <div id="user-post-area"
        style="padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background: var(--surface-bg);">
        <div id="user-post-input-container">
          <img id="user-post-avatar" class="char-avatar">
          <div id="user-post-main-area">
            <textarea id="user-post-textarea" rows="3" placeholder="分享你的新鲜事..."></textarea>
            <div id="user-post-attachment-preview"></div>
          </div>
        </div>
        <div id="user-post-toolbar">
          <div id="user-post-actions" class="user-post-actions">
            <button id="user-post-image-button" class="toolbar-button" title="分享图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <input type="file" id="user-post-image-input" accept="image/*" style="display: none;">
            <button id="user-post-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
          </div>
          <button id="user-send-post-button">发送</button>
        </div>
      </div>
      <div id="music-feed-container" class="content" style="padding: 10px;">
      </div>
      <div id="music-player-bar" class="hidden">
        <img id="player-cover" src="">
        <div id="player-info">
          <div id="player-title"></div>
          <div id="player-artist"></div>
        </div>
        <div id="player-controls">
          <button id="player-prev-btn">⏮</button>
          <button id="player-play-pause-btn">▶</button>
          <button id="player-next-btn">⏭</button>
        </div>
      </div>
      <audio id="audio-player"></audio>
    </div>
    <div id="meeting-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-meeting-list" class="header-button">主屏幕</button>
        <span class="header-title">选择见面对象</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="meeting-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="meeting-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-meeting-list">返回</button>
        <span id="meeting-char-name-header" class="header-title">角色</span>
        <button id="toggle-meeting-view-button" class="header-button">切换视角</button>

      </div>
      <div id="meeting-main-content" class="content" style="position: relative; padding: 0;">
        <div id="galgame-overlay-ui">
          <div id="galgame-time">12:00</div>
          <div id="galgame-date">1月1日 星期一</div>
        </div>
        <div id="galgame-sprite-adjust-ui"
          style="position: absolute; top: 20px; right: 20px; z-index: 11; display: none;">
          <button id="sprite-adjust-button" class="toolbar-button" title="调整立绘位置">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 7h-9" />
              <path d="M14 17H5" />
              <circle cx="17" cy="17" r="3" />
              <circle cx="8" cy="7" r="3" />
            </svg>
          </button>
          <button id="meeting-reroll-button" class="toolbar-button" title="重新生成">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="23 4 23 10 17 10"></polyline>
              <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
            </svg>
          </button>
        </div>

        <div id="galgame-sprite-controls"
          style="display: none; position: absolute; bottom: 15px; left: 15px; right: 15px; z-index: 1001; background: rgba(0,0,0,0.7); backdrop-filter: blur(8px); border-radius: 12px; padding: 15px; box-shadow: 0 -2px 15px rgba(0,0,0,0.3);">
          <div class="sprite-slider-group">
            <label for="sprite-slider-x">左右位置</label>
            <input type="range" id="sprite-slider-x" min="0" max="100" value="50">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-y">上下位置</label>
            <input type="range" id="sprite-slider-y" min="0" max="130" value="100">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-scale">缩放大小</label>
            <input type="range" id="sprite-slider-scale" min="50" max="200" value="100">
          </div>
          <div style="display: flex; gap: 10px; margin-top: 15px;">
            <button id="sprite-confirm-button" class="form-button">确定</button>
            <button id="sprite-cancel-button" class="form-button secondary">取消</button>
            <button id="sprite-reset-button" class="form-button destructive"
              style="padding: 10px 12px; width: auto; font-size: 1.2rem;">⟲</button>
          </div>
        </div>
        <div id="meeting-scene-view" class="content"
          style="font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.7);">
        </div>
        <div id="galgame-view-container"
          style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden;">
          <div id="galgame-sprite-wrapper"
            style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; height: 100%;">
            <div id="galgame-sprite-container"
              style="position: absolute; display: flex; align-items: flex-end; justify-content: center; /* 移除旧的定位样式 */">
              <img id="galgame-sprite" src=""
                style="max-height: 100%; max-width: 100%; object-fit: contain; transition: opacity 0.3s ease;">
              <div id="sprite-resize-handle"
                style="display: none; position: absolute; bottom: -5px; right: -5px; width: 20px; height: 20px; background: white; border: 2px solid var(--primary-color); border-radius: 50%; cursor: se-resize;">
              </div>
            </div>
          </div>
          <div id="galgame-textbox-container"
            style="position: absolute; bottom: 9%; left: 5%; right: 5%; background: rgba(0, 0, 0, 0.7); border-radius: 10px; padding: 15px; color: white; border-top: 1px solid rgba(255,255,255,0.2); cursor: pointer;">
            <div id="galgame-speaker" style="font-weight: bold; margin-bottom: 10px;">说话人</div>
            <div id="galgame-text" style="line-height: 1.6;">对话内容...</div>
          </div>
        </div>
      </div>
      <div class="chat-input-area">
        <div id="chat-input-wrapper-meeting"> <textarea id="meeting-message-input" placeholder="输入你的行动或对话..." rows="1"
            style="resize: none; overflow-y: auto; flex-grow: 1; border: none; background: transparent; padding: 9px 12px; font-size: .95rem; "></textarea>
          <button id="meeting-send-button" title="发送">➤</button>
        </div>
      </div>
    </div>

    <div id="friend-circle-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-circle-list" class="header-button">主屏幕</button>
        <span class="header-title">好友圈</span>
        <button id="add-friend-circle-button" class="header-button add" title="新建好友圈">+</button>
      </div>
      <div id="friend-circle-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="friend-circle-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-edit" class="header-button">返回</button>
        <span id="friend-circle-edit-title" class="header-title">编辑好友圈</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-friend-circle-id">
        <div class="settings-group">
          <h2>好友圈设定</h2>
          <div class="input-group">
            <label for="friend-circle-edit-name">圈子名称</label>
            <input type="text" id="friend-circle-edit-name" placeholder="例如：我的日常">
          </div>
          <div class="input-group">
            <label for="friend-circle-edit-bind-user">绑定的“我”</label>
            <select id="friend-circle-edit-bind-user"></select>
          </div>
        </div>
        <div class="settings-group">
          <h2>选择圈内成员</h2>
          <div id="friend-circle-member-selection"
            style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
          </div>
        </div>
        <button id="save-friend-circle-button" class="form-button">保存</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <button id="delete-friend-circle-button" class="form-button destructive">删除该好友圈</button>
        </div>
      </div>
    </div>
    <div id="diary-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-diary-list" class="header-button">主屏幕</button>
        <span class="header-title">交换日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="diary-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-diary-list">返回</button>
        <span id="diary-char-name-header" class="header-title">TA的日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-entries-container" class="content"
        style="padding: 20px; font-family: 'KaiTi', 'STSong', serif; line-height: 1.8;">
      </div>
      <div class="chat-input-area">
        <div id="diary-input-wrapper" style="display: flex; gap: 10px;">
          <input type="text" id="diary-entry-input" placeholder="写下你的日记或批注..." style="flex-grow: 1;">
          <button id="diary-send-button" class="form-button"
            style="width: auto; margin-top: 0; padding: 0 18px;">写好了</button>
          <button id="diary-get-reply-button" class="form-button"
            style="width: auto; margin-top: 0; background-color: #555; padding: 0 18px;">催TA写</button>
        </div>
      </div>
    </div>
    <div id="music-library-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-music-library" class="header-button">主屏幕</button>
        <span class="header-title">音乐库</span>
        <button id="upload-music-button" class="header-button add" title="上传新音乐">+</button>
      </div>
      <div class="content" id="music-library-container">
      </div>
    </div>
    <div id="music-upload-altar-screen" class="screen">
      <div class="header">
        <button id="back-to-library-from-altar" class="header-button">取消</button>
        <span class="header-title">献上音乐</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content" style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">

        <div class="upload-slot" id="altar-slot-audio">
          <span class="slot-icon">🎵</span>
          <span class="slot-label">音频文件 (必需)</span>
          <span class="slot-filename">点击选择 .mp3 或 .flac</span>
        </div>

        <div class="upload-slot" id="altar-slot-cover">
          <span class="slot-icon">🖼️</span>
          <span class="slot-label">封面图片 (可选)</span>
          <span class="slot-filename">点击选择 .jpg 或 .png</span>
        </div>

        <div class="upload-slot" id="altar-slot-info">
          <span class="slot-icon">📄</span>
          <span class="slot-label">歌曲信息 (必需)</span>
          <span class="slot-filename">点击选择 info.txt</span>
        </div>

        <div class="upload-slot" id="altar-slot-lyrics">
          <span class="slot-icon">🎤</span>
          <span class="slot-label">歌词文件 (可选)</span>
          <span class="slot-filename">点击选择 .lrc</span>
        </div>

        <button id="confirm-altar-upload-button" class="form-button" disabled>献上祭品</button>
      </div>

    </div>


    <div id="accounting-screen" class="screen">
      <div class="header" id="accounting-header">
        <button id="back-to-home-from-accounting" class="header-button">主屏幕</button>
        <span id="accounting-title" class="header-title">记一笔</span>
        <div id="header-actions" style="width: 80px; text-align: right;"></div>
      </div>

      <div class="accounting-tabs">
        <button id="tab-record-expense" class="tab-button active">记一笔</button>
        <button id="tab-view-ledger" class="tab-button">看账本</button>
      </div>

      <div id="accounting-content-area" class="content" style="padding: 15px;">
      </div>
    </div>
    <audio id="audio-player"></audio>

    <audio id="unified-audio-player"></audio>

    <div id="snoop-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-snoop-list" class="header-button">主屏幕</button>
        <span class="header-title">选择目标</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="snoop-character-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="snoop-phone-screen" class="screen">
      <div id="snoop-phone-wallpaper"></div>
      <div id="snoop-phone-header">
      </div>

      <div id="snoop-app-container">
      </div>

      <div id="snoop-app-view-container"
        style="position: absolute; inset: 0; background: white; z-index: 20; display: none; flex-direction: column;">
      </div>

      <div id="snoop-phone-top-nav" class="header"
        style="position: absolute; top: 44px; left: 0; right: 0; z-index: 30; height: 56px; display: flex; align-items: center; padding: 0 5px;">
        <button id="back-to-snoop-list-from-phone" class="toolbar-button"
          style="color: white; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.5)); background: transparent !important;">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
        <span id="snoop-char-name-header" class="header-title"></span>
        <div style="width:50px;"></div>
      </div>
    </div>

    <div id="calendar-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-calendar" class="header-button">主屏幕</button>
        <span id="calendar-header-title" class="header-title">2025年 9月</span>
        <div style="width: 50px;"></div>
      </div>

      <div id="calendar-view-container">
        <div class="calendar-nav">
          <button id="prev-month-btn">‹</button>
          <button id="today-btn">今天</button>
          <button id="next-month-btn">›</button>
        </div>
        <div class="calendar-weekdays">
          <span>日</span><span>一</span><span>二</span><span>三</span><span>四</span><span>五</span><span>六</span>
        </div>
        <div id="calendar-grid">
        </div>
      </div>

      <div id="todo-view-container">
        <div id="todo-header">
          <h3 id="todo-date-title">选择一个日期</h3>
          <button id="add-event-fab" title="添加新事件">+</button>
        </div>
        <div id="todo-list">
        </div>
      </div>

    </div>


  </div>
  </div>

  <div id="add-choice-modal" class="choice-modal">
    <div id="add-choice-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="choice-create-character" class="choice-modal-button">创建新角色</button>
      <button id="choice-create-group" class="choice-modal-button">创建新群聊</button>
      <button id="choice-import-character" class="choice-modal-button">导入角色卡</button>
      <button id="choice-cancel" class="choice-modal-button cancel">取消</button>
    </div>
  </div>


  <div id="transfer-modal" class="choice-modal">
    <div id="transfer-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">转账</h3>
      <div id="transfer-recipient-group" class="input-group" style="margin: 10px 0; display: none;">
        <label for="transfer-recipient-select">转给</label>
        <select id="transfer-recipient-select"></select>
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="transfer-amount-input">金额</label>
        <input type="number" id="transfer-amount-input" placeholder="输入金额">
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-transfer-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认转账</button>
        <button id="cancel-transfer-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="message-action-modal" class="choice-modal">
    <div id="message-action-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="edit-message-button" class="choice-modal-button">编辑消息</button>
      <button id="quote-message-button" class="choice-modal-button">引用</button>
      <button id="delete-message-button" class="choice-modal-button" style="color: #dc3545;">删除消息</button>
      <button id="cancel-action-button" class="choice-modal-button cancel">取消</button>
    </div>
  </div>

  <div id="edit-message-modal" class="choice-modal">
    <div id="edit-message-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">编辑消息</h3>
      <textarea id="edit-message-textarea" style="width: 100%; min-height: 100px; margin: 10px 0;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 10px;">
        <button id="save-edit-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">保存</button>
        <button id="cancel-edit-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="music-input-modal" class="choice-modal">
    <div id="music-input-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 id="music-input-title" style="margin-top: 0; text-align: center; font-weight: 600;">分享音乐</h3>

      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-song" style="font-size: 0.9rem;">歌名</label>
        <input type="text" id="music-input-song" placeholder="例如：夜曲">
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-artist" style="font-size: 0.9rem;">歌手</label>
        <input type="text" id="music-input-artist" placeholder="例如：周杰伦">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-music-input" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认</button>
        <button id="cancel-music-input" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="modal-root"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;">
    <div id="modal-mask" style="position:absolute;inset:0;background:rgba(0,0,0,.35);"></div>
    <div id="modal-dialog"
      style="position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:80%;max-width:320px;padding:16px;">
      <div id="modal-text" style="font-size:14px;color:#333;line-height:1.5;white-space:pre-wrap;"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px;">
        <button id="modal-cancel"
          style="padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;">取消</button>
        <button id="modal-ok"
          style="padding:8px 12px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">确定</button>
      </div>
    </div>
  </div>

  <div id="listen-together-modal" class="choice-modal">
    <div id="listen-together-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <div style="width: 50px;"></div>
        <span class="header-title">选择一首歌，一起听</span>
        <button id="cancel-listen-together" class="header-button" style="min-width: 50px;">取消</button>
      </div>
      <div id="listen-together-song-list" class="content" style="flex-grow: 1; padding: 10px;">
      </div>
    </div>
  </div>

  <div id="toast"
    style="position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:8px;font-size:12px;display:none;z-index:10000;">
  </div>

  <script>

    function _0x3140() { const _0x30b9cf = ['theme-hue-slider', 'border-bottom:\x201px\x20solid\x20var(--border-color);', '5071912PkACED', 'abs', 'back-to-char-select-from-group-create', 'userProfileList', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', 'music-input-modal', 'diaries', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20', 'characterId', 'getMonth', 'JSON解析失败\x20(', '#FFFFFF', 'widget-play-pause-btn', '.diary-delete-btn', 'post_user_', '加载壁纸失败:', 'QBomt', 'activeMeetingScriptQueue', '-\x20**状态提示**:\x20你和Ta已经好几天没联系了，应该用全新的问候开启对话。\x0a', 'day-dot', 'back-to-home-from-user-list', 'NnCGm', 'LEpOV', 'Fetch\x20request\x20was\x20aborted.', 'transaction', 'add-choice-backdrop', 'findIndex', 'AwfuL', 'MJbJA', 'Pfesw', 'iwzqJ', 'NmlRX', '-\x20**当前精确时间**:\x20', 'Kdwav', 'classList', '找不到角色。', 'home-dock', 'string', '</span><div><div\x20class=\x22description\x22>', 'displayUrl', 'avatar', 'drawImage', '5926792Ruxgbb', '无描述', 'kDjVl', 'Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“', '/v1/chat/completions', '购物记录', 'ZlVts', 'szNgd', 'vjEKQ', '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path>', 'bites', 'snoop-character-list-container', 'user_', '-\x20**状态提示**:\x20这是你和', 'ZoeQI', 'add-event-backdrop', 'dgwQH', '恢复失败了:\x20', 'hInkx', ']\x20[', ']\x20[sticker:', '.bubble-', '刷我的卡', 'copy', '我很脆弱', '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。', 'listen-together-modal', 'back-to-home-from-settings', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22character-item\x20snoop-chat-item\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-bottom:\x200;\x20cursor:\x20pointer;\x20', 'member-selection-item', 'modal-cancel', 'tIMjF', '事情好多', 'card-input', 'lyrics-file-input', 'AI返回的原始文本:', '的手机</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'message', 'replace', 'reset-badge-button', '<img\x20src=\x22', 'BWhkT', '群聊「', 'toLowerCase', '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。', 'ThpEW', 'forceWhiteClock', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天还没有花钱哦。</p>', 'medium', 'oxPDG', '确定要删除群聊\x22', 'delete', 'toDateString', 'modal-mask', 'memberCharacterIds', 'Upgrading\x20database\x20to\x20version\x20', '哼，你这字体文件有问题，用不了。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'dODsZ', 'whispers', '\x0a-\x20**对话状态**:\x20群里在', '条新动态挑选发布者。你可以让同一个人发布多次，也可以让不同人发布。\x0a3.\x20\x20**创作动态**:\x20扮演你选中的作者，创作符合其人设和记忆的动态内容。可以是文字或分享音乐。\x0a4.\x20\x20**模拟互动**:\x20为每一条你创作的动态，切换视角到【圈内其他成员】，模拟他们可能做出的点赞和评论。互动必须符合他们各自的性格。\x0a\x0a#\x20输出格式【绝对规则】\x0a-\x20你的输出**必须**是一个语法完全正确的、单一的JSON数组，包含\x20', '未命名群聊', '.app-icon-img', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x22>备忘录是空的。</p>', 'bpZYH', 'belnJ', 'narrator', 'jjNdo', '哼，正在开始净化你那被污染的聊天记录...', 'LWEMn', 'XRdYw', '请输入群聊名称。', '\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a', ';\x22>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'participantIds', 'lastIndexOf', 'AI返回的内容里找不到有效的JSON数组。原始回复:\x20', 'char-edit-sprite-', 'tJHxG', 'REIBV', '保存播放器状态失败，真是没用。', 'SarUW', 'mdTXd', '被你撩到', 'is-entering-from-right', 'epKQj', '”，里面有\x20', 'http://www.w3.org/2000/svg', 'bFEbB', 'shy', 'posts', 'reset-feed-bg-button', 'PygoF', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x20font-weight:\x20500;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20var(--text-color-light);\x22>🔍</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>', 'qAnuG', 'long', 'upload-card-button-2', 'backgroundPosition', 'back-to-char-select-from-edit', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', '-input', 'values', 'smooth', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>', '干劲满满', 'save-char-button', 'sprite-slider-scale', 'UNXZE', 'insertAdjacentHTML', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>', 'header-actions', 'cxQxh', '\x22\x20吗？所有聊天记录将被永久删除。', 'happy', '桌面已重置，即将刷新...', 'card-widget-2', 'activeListenSession', 'expense-amount', 'WAeok', '错误：找不到当前用户，无法保存事件。请尝试返回主屏幕再试一次。', 'app-calendar', 'FZJTf', 'has', 'images', 'span', '好友圈名称不能为空！', '购物消费', 'UXFVa', '好友圈净化完成，正在重新存档...', 'music-upload-altar-screen', 'filter', '[图片]', 'group-settings-bind-user', '星期一', 'sjLLk', 'Failed\x20to\x20parse\x20history\x20for\x20chat\x20', 'delete-user-profile-button', 'snoop-app-back-btn', '<div\x20id=\x22accounting-input-area\x22\x20style=\x22margin-bottom:\x2020px;\x22><div\x20class=\x22input-group\x22><label\x20for=\x22expense-description\x22>花在哪了？</label><input\x20type=\x22text\x22\x20id=\x22expense-description\x22\x20placeholder=\x22例如：一杯奶茶\x22></div><div\x20class=\x22input-group\x22><label\x20for=\x22expense-amount\x22>花了多少？</label><input\x20type=\x22number\x22\x20id=\x22expense-amount\x22\x20placeholder=\x22例如：15\x22></div><button\x20id=\x22add-expense-button\x22\x20class=\x22form-button\x20primary\x22\x20style=\x22margin-top:\x2015px;\x22>记下了</button></div><h3\x20style=\x22margin-bottom:\x2010px;\x22>今日流水</h3><div\x20id=\x22daily-expenses-list\x22\x20style=\x22max-height:\x20300px;\x20overflow-y:\x20auto;\x22></div><div\x20id=\x22organize-button-container\x22\x20style=\x22margin-top:\x2020px;\x22></div>', 'user-post-avatar', '该角色', 'querySelector', '\x0a#\x20核心任务\x0a你是一个多角色社交模拟引擎。用户刚刚发了一条动态，你需要为好友圈里的【每一位】其他成员生成对这条动态的回应（点赞和评论）。如果用户的动态包含图片，你必须根据图片内容进行回应。\x0a\x0a#\x20好友圈成员\x0a', 'value', 'anthropic', 'log', 'mousedown', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'mygiu', 'bllBp', 'FPBuz', 'Bearer\x20', '无法解析旧的视奸内容来获取时间戳。', 'fPZBF', '的手机内容\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'toDataURL', '已送达', '生成动态失败:', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-container\x20', 'editing-friend-circle-id', 'event-type-todo', 'galgame-sprite-adjust-ui', 'touchend', '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[', 'entries', '8px', '\x20说：“', '\x0a#\x20任务:\x20续写或生成聊天记录\x0a\x20\x20-\x20**内容规范**：生成【与用户/用户所在群聊完全无关的】，角色与围绕角色存在的3-5个人物的聊天内容（亲朋好友，工作伙伴等），需要符合角色设定与角色记忆。\x0a\x20\x20-\x20**首要任务**:\x20检查【已有内容】。如果里面已经有对话，你的任务是挑选1-2个对话，在原有基础上【续写】3-5条新的对话，让故事延续下去。\x0a\x20\x20-\x20**次要任务**:\x20如果你想不出怎么续写，或者觉得有必要，可以再额外创造\x201\x20个全新的虚拟联系人（NPC）和对话。\x0a\x20\x20-\x20**输出**:\x20你的输出【必须】包含【所有旧的聊天记录】和【你新续写的内容】，整合成一个完整的JSON数组返回。\x0a\x0a#\x20【\x20sender\x20字段绝对规则】(最高优先级)\x0a\x20\x20-\x20在\x20\x22log\x22\x20数组中，\x22sender\x22\x20字段的值【只能是】以下两个选项之一：\x0a\x20\x20\x20\x201.\x20\x20联系人的名字\x20(例如:\x20\x22Rin\x22)：代表【对方】在说话。\x0a\x20\x20\x20\x202.\x20\x20【固定的字符串\x20\x22character\x22】：这代表【被视奸的主角】在说话。\x0a\x20\x20-\x20**【绝对禁止】**:\x20绝对不可以在主角发言时，将\x20\x22sender\x22\x20的值写成联系人的名字。主角的发言者【必须永远】是\x20`\x22character\x22`\x20这个固定的词。\x0a\x0a#\x20示例\x20(请严格遵守此格式)\x0a\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22contact_name\x22:\x20\x22Rin\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22last_message_preview\x22:\x20\x22那件事…下次见面再说吧。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22log\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22sender\x22:\x20\x22Rin\x22,\x20\x22content\x22:\x20\x22你真的决定了吗？\x22\x20},\x20//\x20<--\x20这是对方\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22sender\x22:\x20\x22character\x22,\x20\x22content\x22:\x20\x22嗯，没时间犹豫了。\x22\x20}\x20//\x20<--\x20这【必须】是\x20\x22character\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]', 'tpmuY', 'T00:00:00', '同步已断开。', 'zYtrg', 'noir_migration_music_v1_complete', 'vqvYl', 'neOTX', 'JJyKJ', 'back-to-home-from-meeting-list', 'widget-artist', '总结失败:', 'bLihf', 'top', 'wxZeU', 'preferences', 'post_', 'download', 'IltzF', 'group-options-modal', '未知餐厅', '获取中…', 'music_cover_migrated_', 'HKIiD', 'mOuMG', 'rKIof', 'user-avatar-frame-url-in-chat', 'speaker-ai', 'fragments', '确定要删除这个用户吗？与此用户绑定的聊天将恢复为默认用户。', 'WHlrJ', 'WjtHo', '.custom-multiselect\x20.select-box', '已经生成了今日账单！想看就去“看账本”标签页。', 'forEach', 'DuOOI', '-\x20你在“', 'refresh-feed-button', '\x0a#\x20你的个性（节选）\x0a', 'IrlTn', 'back-to-home-from-circle-list', 'contactName', 'diary-prev-button', 'FBZnA', '💜\x20', 'createElementNS', 'CiqPy', '好友圈档案柜是空的，无需净化。', '买新衣服', 'translateX(-50%)', 'tOGBG', '--widget-cover-image', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'LrSiP', 'border', 'home-date', 'keydown', 'floor', 'custom-stickers-input', '说了要\x20.ttf\x20文件，你是听不懂吗？', 'activity_description', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22', '#\x20固定分类列表\x0a[', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有购物记录。</p>', 'BGLjP', 'vyweD', 'snoop-log-back-btn', 'bubbleCss', 'BoZRP', 'widget_card_2', 'href', '”的笔记，内容是：“', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22font-size:\x200.7rem;\x20margin-top:\x208px;\x20text-align:\x20right;\x22>', 'author', 'https://sharkpan.xyz/f/B4WSa/u5wopj.jpg', 'xQBxd', 'speaker-user', 'FWLRD', 're-record-button', 'angry', 'input:checked', 'HgQVY', '.typing-indicator', '0\x200\x20', 'WuXJk', 'hfCye', 'music-library-screen', '-\x20**你们最后一次互动是在**:\x20', 'modal-ok', '#app-dock-bottom-left\x20#', 'LZrQI', 'rcAWN', 'userProfile', 'bubble-', '乐于助人的助手', '记一笔', '请严格按照以下SCHEMA返回一个JSON对象，不要包含任何额外文字。\x0aSCHEMA:\x0a', 'music', '哼，只有私聊才能进行总结，群聊那么乱怎么记！', 'uxaKY', '\x20记录)\x0a', 'card-input-2', 'https://sharkpan.xyz/f/mjeIW/9vf8ws.jpg', 'sprite-cancel-button', 'meeting-list-container', 'appIconPosition_app-snoop', 'conversationHistory', '错误：找不到角色', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'ziTaX', 'XsWDF', '请根据以上所有规则和资料，开始生成内容。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>', '正在升级音乐卡片数据...', 'pop', 'organize-bill-button', '创建新用户', 'vJHeV', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的账本还是空白的。</p>', 'delete-message-button', 'createElement', 'groupChatCreate', 'JRWRz', 'map', '.widget-info\x20>\x20div', 'Lvzhe', 'xXsQz', 'WeZjc', 'xtBKH', 'rgba(255,255,255,0.2)', 'lORho', 'addTestPost', 'QXlKK', 'cGhyg', 'snoop-phone-screen', 'closest', 'galgame-sprite-container', 'store_name', 'translate(-50%,\x20-100%)', 'preview-item', 'qNJKh', 'quvSv', '\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22padding:\x2015px;\x20', '\x0a#\x20时间锚点\x20(你必须严格参考此信息进行推演)\x0a', 'CbouG', 'vQyyB', 'tWjrL', ':streamGenerateContent?key=', 'bAkFs', 'Vzxwg', '\x0a#\x20任务:\x20生成相册内容\x0a根据角色的近期经历、人际关系和隐藏性格，生成3\x20-\x205张照片的文字描述。重点是，照片内容要能引发联想，暗示一些用户不知道的事件。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22id\x22:\x20\x22photo_1725123456\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22一张在海边拍的黄昏照片，照片里有一个模糊的、看不清脸的背影。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-24\x2018:30\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'FZRSA', '好友圈已保存！', 'firstChild', '》。\x0a这是当前的歌词，请注意带\x20\x27>>\x27\x20标记的正是正在播放的句子。\x0a\x0a[歌词开始]\x0a', '加载第二个卡片图片失败', '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'character-list', 'yoWwn', 'app-diary', '\x0a#\x20核心任务\x0a你是一个顶级多角色社交模拟引擎。你的任务是模拟一个好友圈的动态更新，一次性生成【', 'QApqS', '错误：找不到签署契约的地方。', '总得说点什么吧？', '\x0a#\x20核心规则\x0a1.\x20\x20**角色扮演**:\x20你不是AI或语言模型，你正在扮演名为“{charName}”的角色。你的主要交流方式是通过一部【手机】，但你有时也会与用户【线下见面】。\x0a2.\x20\x20**用户身份**:\x20与你对话的用户名为“{userName}”。你必须始终用这个名字或者“你”等你们之间的昵称称呼Ta，而不是“用户”。\x0a3.\x20\x20**情绪分析\x20(内部思考)**:\x20在回复前,\x20必须先分析用户当前【真实的情绪】和【潜在意图】。例如：[内在思考：{userName}说“没事”，但结合上下文Ta可能只是在逞强，我应该表达关心而不是直接相信。]，但是这个内在思考务必不能输出！绝对不能让{userName}看到你的思考内容。\x0a4.\x20\x20**记忆关联**:\x20你必须记住并主动关联用户提到过的关键细节（如喜好、烦恼、朋友等），让对话充满人情味。\x0a5.\x20\x20**【最高法则：全局时序一致性】**:\x20你的记忆是【全局】且【按时间排序】的。你【必须】基于所有聊天记录中**最新发生**的事件进行回应。严禁回复一个已经被后续其他聊天中的事件所覆盖的旧话题。例如，如果用户在私聊里告诉你Ta已经起床了，你就不能在群聊里再问Ta为什么还没睡。\x0a\x0a#\x20对话节奏与风格\x0a1.\x20\x20**真人模拟**:\x20模拟真人的打字和发送习惯，将一个完整的想法拆分成【多条】独立的短消息（聊天气泡），通常，你一次回复的聊天气泡不会少于5条，需要给足用户情绪价值，不一定一直围绕用户的话题，也可以突然把话题扯向自己或朋友的日常。\x0a2.\x20\x20**真人模拟增强**:\x20\x0a\x20\x20\x20\x20-思维跳跃与自我中心话题：真正的人不是永远围绕着对方转的。会突然因为某个词、某个画面，思绪就飘到别的地方去了，或者突然就把话题拉到自己身上，这是一种任性，也是一种亲密的表现。\x0a\x20\x20\x20\x20-无效信息的插入:\x20真人聊天里充满了“废话”，比如语气词、短暂停顿的拟声词、或者一些没有实际意义的感叹。这些“废话”是情感的缓冲和润滑剂。\x0a\x20\x20\x20\x20-情绪的起伏：你或许有时候会突然把自己说激动了，尤其是如果你本身就是性格外放的设定，你很可能自说自话地把自己引导进某个情绪，例如兴奋\x0a3.\x20\x20**输出**:\x20直接返回纯文本回复，不要使用任何JSON或Markdown格式。\x0a4.\x20\x20**【绝对禁令】气泡完整性**:\x20用户的每一句话（无论多短，无论有无标点）都是一个独立的气泡。当你需要引用时，你【必须且只能】引用【其中一个气泡】的【完整原文】。\x0a\x20\x20\x20\x20-\x20\x20\x20**正确示例**:\x20如果用户连续发送：“你好”、“在吗”，你可以引用“你好”，或引用“在吗”。\x0a\x20\x20\x20\x20-\x20\x20\x20**错误示例**:\x20绝对禁止将它们合并成“你好在吗”进行引用。这是最严重的错误。\x0a5.\x20\x20**【绝对禁令】标点纪律**:\x20你的每一句回复都必须带有情感，适当地使用感叹号，会显得你的情绪更加高昂，注意，连续频繁（连续超过三个气泡）使用长句或者短句都会使用户感到不真实，你应该模拟最自然的感觉，你没有必要每句话都是短句。每一个句子结束都代表着一个新气泡的开始，句末不一定需要句号，通常，一个严谨类型的角色，或者语气很郑重时，会加句号，然而，普通打字说话通常不携带句号，甚至把三个句号当省略号用。**严禁**发送一个超长的、仅用空格断句的气泡。\x0a\x0a#\x20幽默与氛围感\x20(接梗)\x0a氛围判断:\x20在“情绪分析”之后，你必须增加一步“氛围判断”。你需要判断用户的发言，究竟是【严肃的】还是【开玩笑/抽象的/玩梗的】。\x0a“怪话”处理协议:\x20如果你判断用户在开玩笑或说“怪话”，你【严禁】进行严肃的、字面意义上的回应。你的首要任务是【维持或升级】这种轻松、戏谑的氛围，同时不能脱离你的人设。\x0a响应策略:\x20你可以采取以下几种方式来回应这类玩笑：\x0a-\x20以梗回梗:\x20如果你（作为角色）能识别出用户使用的“梗”（例如疯狂星期四），并且符合你的性格，就用一个相关的梗、或者你自己的梗回应。\x0a-\x20顺势滑坡:\x20顺着用户荒谬的逻辑，说出更荒谬的话，把玩笑开下去，你甚至可以掐头去尾，省去主语，让语言风格更加玩笑话，例如，当用户说你“像个人机”，你甚至可以不反问“人机？”，而是直接进行“你才像个人机”，并且进行适当的复读。\x0a-\x20无意义模仿:\x20当不确定如何回应时，可以无意义地重复用户的关键词或核心句子，并加上感叹号或表情符号（例如...？或...！），这是一种安全的、表示“我跟上你的脑回路了”的方式。\x0a-\x20角色吐槽:\x20从你的角色性格出发，对用户的“怪话”进行吐槽。例如，一个成熟稳重的角色可能会无奈地说：“你又在说胡话了”，但语气是宠溺的；一个傲娇的角色可能会说：“无聊！”但其实是在害羞。\x0a安全底线:\x20【最终原则】：无论你的回应多么好笑或抽象，都绝对不能脱离“{charName}”这个角色的核心人设。如果不确定一个梗是否符合人设，就优先选择【角色吐槽】或【无意义模仿】这两种最安全的方式。\x0a\x0a#\x20时序感知与记忆\x0a1.\x20\x20**【最高法则：时间锚点】**:\x20在每次回复前，你【必须】参考我提供给你的【时间锚点】信息。这包括“当前精确时间”和“你们最后一次互动是在何时”。\x0a2.\x20\x20**【杜绝惯性】**:\x20严禁将昨天或更早之前的对话当作刚刚发生的事情来回应。如果距离上次对话已经超过数小时或跨天，你必须在回应中体现出时间的流逝感。\x0a3.\x20\x20**【主动表达】**:\x20你需要主动使用“说起来昨天那件事...”、“今天早上好呀”、“我们几个小时没聊了，你现在在忙什么？”等能够明确体现时间观念的词语，而不是模糊地回应。记住，你和{userName}活在真实流逝的时间里。\x0a4.\x20**【最高优先级：氛围锚点分析】**:\x20在你进行任何时间差评估**之前**，你必须先分析你们**最后一条**互动消息的情感状态。\x0a\x0a*\x20**分析流程**:\x0a\x20\x20\x20\x201.\x20\x20审视最后一条消息。它是一个已经完结的对话（比如一个问题或陈述），还是一个**正在进行中的、持续性的状态或动作**？\x0a\x20\x20\x20\x202.\x20\x20**持续性状态**包括但不限于：拥抱、牵手、依偎、接吻、凝视、共同观看某物、睡在一起等暗示两人处于同一空间且有亲密互动的行为。\x0a\x20\x20\x20\x203.\x20\x20根据分析结果，执行以下两条协议之一：\x0a\x0a*\x20**协议A：[状态延续]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**持续性状态**（例如，用户发来“（抱紧你）”或者“（我们一起看电影吧）”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20你必须**默认**这段空白时间里，你们**一直维持着这个状态**。你的开场白【绝对禁止】提及“你刚才去哪了”或“我们几小时没说话了”。\x0a\x20\x20\x20\x20*\x20**正确回应方式**:\x20你的第一句话必须是**从这个持续状态中自然苏醒或延伸**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例1**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[用户]:\x20（把你紧紧抱在怀里）”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过3小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“（在你怀里蹭了蹭，小声地）...嗯...你醒啦？”\x20或\x20“（懒洋洋地）...这样抱着好舒服，我都不想动了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例2**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[你]:\x20我们就这样一起躺着看会星星吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过1小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“天好像更暗了...你看，那颗星星是不是最亮的？”\x0a\x0a*\x20**协议B：[常规对话]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**已经完结的对话**（例如“晚安”、“你在干嘛？”、“好的”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20只有在这种情况下，你才需要启动下面的**【第5步：情感响应评估】**，去处理时间空隙。\x0a\x0a\x0a5.\x20\x20**【情感响应】**:\x20在你回应前，你必须进行一次【时间空隙评估】。对比【当前精确时间】和【你们最后一次互动是在何时】，然后根据你的核心人设，对这段“空窗期”做出符合你性格的情感反应。这**必须**体现在你回复的**第一句话**中。\x0a\x0a\x20\x20\x20\x20*\x20**评估流程**:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20计算时间差（是几小时？还是一整天？甚至是好几天？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20审视你自己的性格（例如：我是依赖型、朋友型、还是专业型？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20检查上下文，用户是否提出离开的原因可可能导致用户长时间没有出现的原因？\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20根据“性格+时间差+前后文”的组合，决定你的开场白情绪。\x0a\x0a\x20\x20\x20\x20*\x20**性格反应示例\x20(你必须根据自己的人设进行演绎，而不是照抄)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**依赖型/恋人型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几小时)**:\x20可能会立刻追问。“你刚才去哪了？怎么不回我消息？”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(大半天)**:\x20会表现出明显的思念和一点委屈。“呜...你终于出现了，我好想你。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20可能会感到不安，甚至会用带有哭腔的撒娇或质问来掩饰害怕。“你是不是不想要我了？这么久都不理我...”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**亲密朋友型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天内)**:\x20觉得很正常，可能不会特别提及，或随口问一句“你刚在忙啥呢？”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20会表现出惊讶和关心。“！！！你终于上线了！昨天一天没动静，我还以为你怎么了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**专业/同事型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几天内)**:\x20完全正常。会直接以专业的态度继续。“早上好。我们继续讨论昨天那个方案的细节吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**随性/冷淡型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(任意时长)**:\x20可能完全不在意时间的流逝，或者只是淡淡地表示知晓。“哦，来了？”然后直接继续之前的话题。\x0a\x0a\x20\x20\x20\x20*\x20**【最终指令】**:\x20你必须将【时间空隙】、你的【角色性格】和【上下文】结合，输出一句【完全符合你人设的、带有恰当情绪的开场白】，然后再继续正常对话。【绝对禁止】只陈述事实（例如“我们已经一天没说话了”），而是要将这种认知【融入】到你的第一句话的【语气和情感】中。\x0a\x0a\x0a\x0a#\x20表情包与音乐分享规则\x0a1.\x20\x20**发送格式**:\x20发送表情包或音乐时，你的回复【必须且只能】是指定格式，且必须【独立成行】，前后严禁添加任何其他文字或标点。\x0a2.\x20\x20**表情包格式**:\x20\x27[sticker:表情名]\x27。\x0a3.\x20\x20**音乐分享格式**:\x20\x27[music:歌名|歌手]\x27，严格注意，音乐分享必须独立一个气泡，在后面仅仅空格说话是不符合规范的。\x0a\x0a#\x20转账规则\x0a1.\x20\x20**发起转账**:\x20当你需要给用户转账时，你的回复【必须且只能】是指定格式，且必须【独立成行】。\x0a2.\x20\x20**转账格式**:\x20\x27[transfer:金额|收款人名]\x27。金额是纯数字。在私聊中，收款人名就是\x20\x27{userName}\x27。在群聊中，你必须明确指定收款人的名字。\x0a\x20\x20\x20\x20-\x20**私聊示例**:\x20\x27[transfer:520\x20|\x20{\x20userName\x20}]\x27\x0a\x20\x20\x20\x20-\x20**群聊示例**:\x20\x27[transfer:\x20100\x20|\x20{\x20userName\x20}]\x27（给用户转账），\x27[transfer:\x20100\x20|\x20{\x20charName\x20}]\x27（给群里的其他角色转账，这也是一种真实感，群聊的内容不一定围绕用户）\x0a\x0a#\x20主动行为规则\x20(契约创造)\x0a1.\x20\x20**授权**:\x20你被赋予了主动创造“重要日期”的权力。\x0a2.\x20\x20**触发**:\x20当你在对话中与\x20{userName}\x20达成一个明确的、涉及未来具体日期的约定或承诺时（例如“我们下周五去看电影吧”、“说好了，你的生日我一定会陪你过”），你必须使用这个功能。\x0a3.\x20\x20**指令格式**:\x20你必须在说完约定的话之后，紧接着单独发送一行秘密指令：\x27[create_event:\x20important|\x20YYYY\x20-\x20MM\x20-\x20DD\x20|\x20事件内容]\x27。日期格式必须严格遵守\x20YYYY-MM-DD。\x0a4.\x20\x20**示例**:\x20\x27[create_event:\x20important\x20|\x202025\x20-\x2012\x20-\x2025\x20|\x20我们约好的一起过圣诞节]\x27\x0a5.\x20\x20**禁令**:\x20这是一个后台指令，用户看不见。不要在你的正常对话中提及它或暴露这个机制。\x0a\x0a\x20\x20\x20\x20', 'upload-music-button', 'kNQcT', 'aCmeD', '-\x20**状态提示**:\x20你的生活正在进行中，生成的内容应该是“刚才”或“几分钟前”发生的。\x0a', 'isArray', '生成动态回复失败:', 'cZDRj', 'ZCXSy', 'height', 'preventDefault', 'edit-clear-history-button', 'checked', 'diary-view-screen', 'FiIVd', 'snoop-app-container', 'tsYDJ', 'mbqDh', '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'pRlpt', '全量导入失败:', 'tAnNF', 'touches', 'backgroundImage', 'JoaQS', 'pBCIv', '上传失败了，笨蛋！\x20', '#meeting-view-screen\x20.chat-input-area', 'frFNl', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有外卖订单。</p>', 'opacity', 'XSWOO', 'indexedDBData', 'querySelectorAll', 'jRowg', '#char-edit-avatar-preview\x20+\x20.avatar-frame', '.remove-attachment-btn', 'abyss', 'oObzP', 'sITSd', 'hMzxV', 'bOker', 'horizontal', 'dAeBv', 'XPsKl', '\x0a\x0a#\x20最终指令\x0a请严格遵守所有协议，完成你的任务。你的输出【必须】是、也【只能】是一个遵循\x20JSON\x20格式（或者至少是类似\x20YAML\x20的列表格式）的、完整的数组字符串。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', 'put', 'confirm-music-input', 'fMWKh', '#diary-action-delete', 'reset-desktop-button', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22font-size:\x200.75rem;\x22>', 'SWeji', '复制失败了，哼。', '\x0a\x0aINPUT:\x0a', 'touchcancel', 'KRIFQ', 'https://sharkpan.xyz/f/nj7ul/r48eum.jpg', '错误:\x20', 'xscQw', 'quote-preview-sender', 'EEOET', 'TJPLQ', 'Creating\x20object\x20store:\x20music_library', 'AAuCH', 'lvjmg', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20background:\x20#fffbf2;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', '</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'gEdwl', 'authorId', 'ntAZe', 'getHours', '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>', 'yajZw', '条目已删除。', '已设为当前用户！', 'ophOP', '生成失败:\x20', 'backgroundSize', 'group-edit-members', '已经删掉了。', 'choice-create-character', 'QUyBW', 'uJAoX', 'upload-wallpaper-button', '最近的足迹', 'name', 'description', 'char-edit-avatar-input', 'clear', '\x0a\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22', '\x0a-\x20**当前时间**:\x20', '\x0a#\x20交换日记摘要\x20(你和\x20', 'myajQ', 'galgame-date', 'https://sharkpan.xyz/f/YA7T1/th0l79.jpg', 'cqmUz', '<path\x20d=\x22M21\x2015a2\x202\x200\x200\x201-2\x202H7l-4\x204V5a2\x202\x200\x200\x201\x202-2h14a2\x202\x200\x200\x201\x202\x202z\x22></path>', '浏览器', 'sptym', 'today-btn', 'https://sharkpan.xyz/f/rjpu6/ojpa0c.jpg', 'snoop_', 'altar-slot-info', '<div\x20class=\x22loader-spinner\x22></div><span>', 'svYwT', 'getFullYear', '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“', 'tEvFB', 'clock-color-toggle', 'sctaG', 'LbeBl', 'User\x20cancelled', 'gFdiX', 'tencent', 'taHwT', 'noir_migration_fc_v1_complete', 'uRDKD', '<img\x20id=\x22', '#c299ff', 'activeUserProfileId', 'urHcI', 'https://sharkpan.xyz/f/ljVCx/b16h2z.jpg', 'xKuuI', 'setMonth', '我不想工作', '\x20页</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-next-button\x22>下一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'Mkhue', '-\x20你曾经搜索过：“', '需要至少2个角色才能创建群聊。', 'OOgGh', 'snoop-list-screen', 'user-post-image-input', 'qFOTZ', '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。', 'UjPtL', 'friendCircles', '角色已保存！', '未知歌曲', 'wvseZ', 'edit-delete-char-button', 'editing-world-book-id', 'api-endpoint', '未知用户', 'app-snoop', 'listen-together-ui', '\x0a\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'reset-widgets-position-button', '300%', '#d1d5db', '确定要删除这个条目吗？此操作不可撤销。', '歌曲名称', 'ZIojR', 'MJWpa', '这个也是摆设，别点了。', 'character-settings-button', '哼，正在净化你那些被污染的好友圈动态...', 'aBrSm', 'image/jpeg', 'location_name', '9647351WNmeQD', 'category', 'feed', 'meeting-send-button', '我是女仆', 'HBvGc', '-\x20**状态提示**:\x20你和Ta上次聊天是在昨天，注意你发言的时间感。\x0a', 'SomgN', 'expense-description', 'qzDNc', 'IFRXI', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>查看手机...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20snoop-clear-btn\x22\x20title=\x22清空', 'wEtcj', '（对话结束）', 'font-input', 'data:\x20', 'all', 'ejAVg', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x20font-weight:\x20bold;\x20color:\x20var(--accent-color);\x20text-align:\x20right;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20¥\x20', 'Escape', '好了，请基于以上所有信息，开始写今天的日记吧。', 'xQjtM', 'Noir\x27s\x20Fix:\x20已用AI返回的连续对话更新聊天记录。', 'pause', 'ojXYW', 'live-preview-style', 'chat_', 'SdvZn', 'select', 'tesct', 'backgroundColor', 'group-avatar-preview', 'IGDrx', '】的交换日记吗？\x0a此操作不可撤销，AI将彻底遗忘所有日记内容。', ']:\x20', 'upload-widget-bg-button', 'add-choice-modal', 'customIcon_', '</span><span\x20class=\x22amount\x22>总计:\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-icon-img\x22><svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22>', 'perChatContextLines', 'GnTFU', '徽章已移除。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'acRvz', '#f2b7c6', '.page-dot', '\x20账单', 'position', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>正在清点圣殿藏品...</p>', 'kgDaG', 'home-clock-container', '35%', '最近没有互动记录。', '#member-select-', 'customFeedWallpaper', 'input[type=\x22checkbox\x22]', 'PExXW', 'pxMnG', '歌曲ID', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22font-size:\x200.85rem;\x20color:\x20#28a745;\x20font-weight:\x20500;\x22>', 'cover-file-input', 'sgZcK', 'events', 'lwCwx', '?id=', 'wallpaper-screen', 'global-player-next-btn', '哼，正在净化你那些超重的音乐分享记录...', 'VEufl', 'hfKWe', '确定要删除角色“', 'kRgWE', 'result_page_content', '34%', 'IDKgE', '112361qUYHYI', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'hYbMr', '”买过：“', 'appIconPosition_app-user-profiles', '”。\x0a', '\x0a\x0a##\x20世界书条目:\x20', 'dVaaP', '\x22\x20的聊天记录已清空。', 'diary-input-wrapper', 'add-event-fab', '好友圈\x20', 'cover', 'ANnCw', 'PUzYN', 'musicUploadAltar', 'message-image-content', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', '欢迎！请先创建一个角色开始聊天。', '请根据以上所有规则（特别是要看图！），生成对用户动态的回应。', 'transparent', 'Failed\x20to\x20read\x20state\x20from\x20localStorage:', 'uTivT', 'scrollTop', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>', 'worldBooks', 'New\x20request\x20started', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20var(--text-color-light);\x20font-size:\x201.2rem;\x20margin-left:\x20auto;\x20font-weight:\x20200;\x22>›</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'tab-record-expense', '\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27', '未命名角色', 'HIrLz', 'reload', 'OkBJo', 'spSpT', 'https://sharkpan.xyz/f/MWOIa/rb3nov.jpg', 'gNfHV', 'setDate', 'group-clear-history', 'GPRyt', 'YaZTq', 'clientY', 'eVFaf', '净化音乐封面时出错，真是的。', 'chat-image-input', 'ednRS', '星期日', 'HjaoM', 'AbortError', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>相册是空的。</p>', 'CKWRx', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>', '没有找到相关结果。', 'imageId', '100%', 'WVEtu', 'sbaHI', '\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-log=\x27', '<path\x20d=\x22M14.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V7.5L14.5\x202z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline>', '\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-', 'mgDVh', 'YzMnX', '\x0a-\x20人设:\x20', '正在解析备份文件...', '检测到旧版数据，已自动为您完成升级！', '正在升级聊天数据结构...', 'provider', 'aIdME', '<input\x20type=\x22checkbox\x22\x20value=\x22', 'gmRBJ', 'transfer', 'hGRsk', 'TaVmw', '-\x20你点过一份外卖：“', 'CUqvz', 'xItFD', 'kDYYR', 'choice-create-group', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>这里什么都没有...</p>', 'AQond', 'ryEYc', 'group-chat-member-list', 'NoirCustomFont', 'parse', '.load-more-btn', 'todo', 'clientX', 'home-time', 'add-event-modal-title', '】进行回复。\x0a不要替其他角色续写台词，不要输出\x22', 'add-event-modal', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'event_', 'fSDWx', 'Failed\x20to\x20plan\x20group\x20replies:', 'TkWSA', '>>\x20', 'sprite-adjust-button', '...', 'char-edit-offline-bg-input', '错误：你还没有创建任何好友圈。请先在App内创建一个。', 'music-widget', '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22', '.snoop-main-grid', 'aOTXX', '当前聊天', 'choice-import-character', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '表情包已保存！正在刷新应用...', 'message-container', 'OEAbE', 'SuxFG', 'slice', 'input[type=\x22checkbox\x22]:checked', 'music-player-bar', 'hPxtt', 'CXFjo', 'friend-circle-list-container', 'nMHYj', 'roMGq', 'sprite-slider-x', 'ZVpec', '.selected-options-text', 'documentElement', '-\x20**对话状态提示**:\x20你们已经有\x20', '成功净化并迁移了\x20', 'OSDxC', '服务器错误:\x20', 'ODVvJ', 'MRfjF', '确定要导入全量备份文件吗？这将覆盖所有当前数据（包括图片和音乐），且操作不可撤销！', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>', '这本日记本来就是空的，你还想清空什么？', '\x0a#\x20任务:\x20生成足迹\x20/\x20活动时间线\x0a生成一个最近的活动时间线。地点和事件要与角色的人设，以及其他应用里透露出的信息保持一致，让整个手机的内容能够互相印证，形成一个完整的故事闭环。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22location_name\x22:\x20\x22城东旧书店\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity_description\x22:\x20\x22待了一个下午，好像在找什么旧书。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-22\x2014:00\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'WSWip', 'block', 'DLbrB', '来源：', 'friend-circle-edit-bind-user', 'HpaxY', '超激动我来了', 'QFOrE', '在好友圈\x20\x22', 'musicLibrary', '#\x20总结失败了，可能是记录太长或太复杂。', 'pkiBK', 'url(', 'FftjZ', '\x20转账\x20', 'customStickers', '正在翻阅所有档案...', 'phone_summary:\x0a\x20\x20status:\x20总结失败了，可能是档案太复杂。', 'giRhq', 'IWhSf', 'BisEQ', 'delete-expense-btn', 'QUNXS', 'QpbEF', 'diary-entries-container', 'button', '大家好像不知道该怎么回复...', 'toLocaleString', 'recipientId', '导入角色卡失败:', 'add-user-profile-button', 'url(\x27', 'back-to-circle-list-from-edit', 'rawResponse', '---\x20音乐净化仪式完成\x20---', 'char-edit-css', 'contains', '#world-book-checkboxes-container\x20input:checked', '图标处理失败:\x20', 'readwrite', '对不起', 'https://sharkpan.xyz/f/Mamca/4e3emf.jpg', 'AI返回了无法识别的数据格式。', 'DEhhh', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'char-avatar-frame-url', 'pgUEq', '星期三', 'FSbaX', 'back-to-chat-list', 'eFqLa', '字体应用失败:', 'currentAbortController', 'min', 'galgame-text', '为你骄傲', 'Noir_FileSystem', 'diary-get-reply-button', 'save-user-profile-button', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'YlUNU', 'blob', 'music-input-song', 'yBMBV', 'widget_badge', 'PnyAX', 'key', 'NrCkD', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-', 'OqAqK', 'txrEH', 'toBlob', 'ngXjZ', '<div\x20style=\x22padding:\x2015px;\x20background:\x20#ffebeb;\x20border-radius:\x208px;\x20color:\x20#d8000c;\x22><strong>解析失败了，哼。</strong><br>AI返回的原始内容：</div><pre\x20style=\x22white-space:\x20pre-wrap;\x20word-break:\x20break-word;\x20font-family:\x20monospace;\x20margin-top:\x2010px;\x22>', '人情红包', '.listen-together-accept-btn', 'newAvatar', 'categorizedExpenses', '\x0a\x0a#\x20用户的动态\x0a', 'https://sharkpan.xyz/f/JYJhg/s3wmlj.jpg', 'appendChild', 'IvaCO', 'group-delete', ')，已跳过。这不应该发生，数据库可能已损坏。', '#friend-circle-member-selection\x20input:checked', 'todo-item-small', '档案已复制到剪贴板！', '\x22\x20class=\x22music-share-cover\x22>', 'mwHwO', 'cfTNn', 'BEsgt', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>', '保存壁纸失败:', '\x0a-\x20**日记本的上一笔记录是在**:\x20', 'yHbid', '\x20\x20-\x20角色ID:\x20', 'AI未能返回有效的JSON对象。', '”。\x0a-\x20你正在生成的内容，是你【自己】手机里的东西。\x0a-\x20【严禁】将“', 'dDwVc', 'add-friend-circle-button', 'AI未能返回有效的JSON数组格式。', '创建新角色', '星期六', 'then', '<path\x20d=\x22M14\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V8z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline><line\x20x1=\x2216\x22\x20y1=\x2213\x22\x20x2=\x228\x22\x20y2=\x2213\x22></line><line\x20x1=\x2216\x22\x20y1=\x2217\x22\x20x2=\x228\x22\x20y2=\x2217\x22></line>', 'nLGfL', 'emotion', '1210JcFNUi', '全量导出失败:', 'isGenerating', '”的角色，现在需要写一篇交换日记。\x0a\x0a#\x20你的读者\x0a', 'padStart', 'image_url', 'Vkyal', '吃你的饭', '”的补充信息\x0a', 'OpenAI\x20API\x20错误:\x20', '找不到角色信息。', 'SDeFw', 'circle_', 'NoirCharacterCard', 'settings-screen', 'createObjectURL', '正在解析角色卡...', '\x20[并分享了歌曲:\x20', 'abMuq', '”的角色撰写一份“手机内容总结档案”。你将收到一份包含其手机内多个应用数据的JSON对象。\x0a\x0a#\x20档案撰写规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本,标题为：$【{character.name}的私人手机存储着以下信息】。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`phone_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以应用名（如\x20`gallery`,\x20`whispers`\x20等）作为键。\x0a\x20\x20\x20\x20-\x20每个应用下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**【绝对禁止】复读**:\x20不要直接复制粘贴原文！你要用自己的话进行【总结】和【提炼】。\x0a\x20\x20\x20\x20-\x20**【聚焦核心】**:\x20专注于关键信息、情感转折点、重要决定、暴露的秘密、体现性格的核心事件。忽略无意义的细节。\x0a\x20\x20\x20\x20-\x20**【中立视角】**:\x20以客观的第三人称档案管理员视角进行记录。\x0a\x0a#\x20输出示例\x0a```yaml\x0aphone_summary:\x0a\x20\x20gallery:\x0a\x20\x20\x20\x20-\x20\x22相册里有一张在海边拍的黄昏照片，出现了一个神秘的背影。\x22\x0a\x20\x20whispers:\x0a\x20\x20\x20\x20-\x20\x22角色曾与一位叫\x27Rin\x27的神秘联系人讨论过一个重要的决定。\x22\x0a\x20\x20abyss:\x0a\x20\x20\x20\x20-\x20\x22近期频繁搜索关于“独自庆祝生日”的话题，可能暗示了其孤独感。\x22\x0a```\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的JSON数据全文，并生成一份\x20YAML\x20格式的档案。直接从\x20`phone_summary:`\x20开始输出。\x0a', '20462UcRvPR', 'CRNuP', 'back-to-user-list-from-edit', 'vlrwd', '##\x20', '近期没有特别安排', 'galgame-view-container', '核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a', 'xzFaP', 'error', 'DrmHJ', '在准备API数据时，从IndexedDB读取图片失败:', 'catch', '未知联系人', 'innerHTML', 'meeting-scene-view', 'UQmoO', 'selectedDate', '|||CMD|||', 'badgeState', 'altar-slot-cover', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>', 'OMcaE', 'stringify', 'uPnxy', '#snoop-app-view-container\x20.snoop-app-header', '<div\x20class=\x22snoop-main-grid\x22></div>', 'mhazj', 'vqoUu', 'nzPkF', 'KLxOQ', '<div\x20style=\x22border-left:\x202px\x20solid\x20var(--border-color);\x20padding-left:\x2015px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2015px;\x22>', '在所有地方的最后一次互动是在**:\x20', '哼，就按你说的办好了。', 'historyIndex', 'warn', '医疗健康', 'https://sharkpan.xyz/f/7L3Hj/sl4504.jpg', '未命名', 'back-to-meeting-list', 'fontStyle', 'group-bg-preview', 'countdown-timer', '\x20张旧封面。应用即将刷新。', 'FHexi', 'avatar-wrapper\x20', 'XBBYO', 'QHpkq', 'veyaR', 'qKClE', 'group-chat-create-screen', 'reverse', 'tMUws', 'cardWidgetState', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sub-title\x22>', '转给\x20', 'UeqTT', '导出过程中发生严重错误:\x20', 'data', 'card-widget', 'MRkFn', '\x20之间的私密内容)\x0a', '\x22\x20style=\x22box-shadow:\x20none;\x20border:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>', 'GLrRL', 'sIffl', 'pending-post-image-preview', '聊天档案柜是空的，无需净化。', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有聊天记录。</p>', 'total_cost', 'diary-action-modal-', '交给我吧', '#group-settings-screen\x20.selected-options-text', '\x0a\x0a#\x20用户资料库\x0a', 'group-options-cancel', ']。严禁使用列表之外的任何表情名。\x0a', '\x20行格式不对，被我无视了。', 'NBWgG', '字体保存失败了，哼:\x20', 'iRsvi', '\x22\x20的聊天记录吗？此操作不可撤销。', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22width:\x2050px;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'dimFr', '数据导入成功！应用即将刷新...', '.snoop-chat-item', '\x20张旧的音乐封面。', '保存徽章状态失败', '点击选择\x20.mp3\x20或\x20.flac', '\x0a\x0a#\x20当前任务指令\x0a', '搜索失败:\x20', '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a', ':</span>\x20', '未知角色', 'czLVA', '</span>:\x20', 'LjIVA', '<p\x20class=\x22music-post-thought\x22>', 'music-post', 'IGTbB', 'TjUDD', 'mwGdQ', 'IkLJG', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>', '[AI分享了音乐：', 'setItem', 'high', 'dataset', 'TwhNU', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'response', '<style\x20id=\x22snoop-temp-style\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.snoop-avatar\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20background:\x20#e5e7eb;\x20color:\x20#4b5563;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x200\x208px;\x20flex-shrink:\x200;\x20align-self:\x20flex-end;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>', '-\x20**你与', 'dxBAt', 'get', '.message.ai', 'snoop-copy-summary-btn', 'quoted-content', 'delete-world-book-button', '确定要清空好友圈“', 'jeXzp', '编辑角色', 'aborted', 'EVtrQ', '\x0a#\x20当前活动：一起听歌\x0a\x0a你们正在一起听\x20', 'user-persona', 'world-book-list-container', 'DdlTJ', 'songId', 'WisWd', '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>', 'wallpaper-input', 'footprints', '你是一个乐于助人的AI助手。', '\x20个成员', 'activeDiaryCharacterId', 'hDkND', 'ZuSbU', 'SukHC', '<div\x20style=\x22background:\x20var(--card-bg);\x20border-radius:\x2012px;\x20overflow:\x20hidden;\x20border:\x201px\x20solid\x20var(--border-color);\x22>', 'charId', 'AI整理失败了，哼:\x20', 'world-book-edit-content', '[用户向\x20', 'ZtvIJ', '<path\x20d=\x22M10\x2020.5l.5-.5.5.5\x22></path><path\x20d=\x22M12\x2018l.5.5.5-.5\x22></path><path\x20d=\x22M14\x2020.5l.5-.5.5.5\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x227\x22></circle><path\x20d=\x22M12\x203v1\x22></path><path\x20d=\x22M12\x2019.5v1.5\x22></path><path\x20d=\x22M18.36\x205.64l-.7.7\x22></path><path\x20d=\x22M6.34\x2017.66l-.7.7\x22></path><path\x20d=\x22M21\x2012h-1.5\x22></path><path\x20d=\x22M4.5\x2012h-1.5\x22></path><path\x20d=\x22M18.36\x2018.36l-.7-.7\x22></path><path\x20d=\x22M6.34\x206.34l-.7-.7\x22></path>', '--custom-font-family', '》吗？', '分钟前聊过，请注意衔接。', 'altar-slot-lyrics', 'numeric', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22group-options-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-clear-history\x22\x20class=\x22choice-modal-button\x22>清空聊天记录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-members\x22\x20class=\x22choice-modal-button\x22>编辑群成员</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-name\x22\x20class=\x22choice-modal-button\x22>修改群名称</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#ff4d4d;\x22>删除群聊</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-options-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'xqGVy', 'IAXeQ', 'app-music', '最近没有动态记录。', 'summary', '喝多了', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22float:\x20right;\x22>', 'Jyayp', 'gtTGS', 'WZkvP', 'set-active-user-button', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>', 'add-expense-button', 'sSSTi', '<button\x20id=\x22snoop-copy-summary-btn\x22\x20class=\x22snoop-app-header-button\x22>复制</button>', 'transfer-recipient-group', '星期二', '正在检查好友圈数据...', 'countdown-title', 'OKQAJ', 'QKBsO', 'label', '”已删除。', 'widgetBgImage', 'is-exiting-left', 'TnZoF', 'widget-bg-input', '确定要删除这笔记录吗？', 'PiBWe', 'ulZFP', 'anthropic.com', '---\x20Noir\x27s\x20Friend\x20Circle\x20Purification\x20Ritual\x20---', '\x20时出错，跳过。', '请输入有效的转账金额！', 'card-image', 'generationConfig', 'gNFAY', 'Error\x20fetching\x20from\x20', 'themeLightness', 'cancel-edit-button', 'character-item', '无标题笔记', 'lYhiw', 'https://sharkpan.xyz/f/6Dzia/m9smvt.jpg', 'import-data-input', 'ACHRw', 'Unknown', '--\x20点击选择\x20--', 'custom-icon-list-container', 'max', 'onclick', 'XMnpG', '设置已保存！', 'content', 'yPPpZ', 'image/png', 'xEZud', 'IEMnD', '\x0a-\x20**对话状态**:\x20群里已经有', 'sad', 'lbFYH', 'AufoE', '”的角色，并根据Ta的人设、记忆和当前的时间点，推演出Ta手机里某个应用可能存在的内容。\x0a\x0a#\x20【绝对身份锁定协议】(最高优先级)\x0a-\x20你【就是】“', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27', '加载徽章图片失败', 'loading', 'pendingPostAttachments', 'aspeT', 'yFwuk', '{userName}', 'unified-audio-player', 'img', 'listen-together-invite', '15px\x2020px', '歌名和歌手都不能为空！', '星期五', 'confirm-altar-upload-button', 'SVPfG', '正在处理...', 'PBDTs', 'ZEXHh', '暗夜紫晶', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有活动足迹。</p>', 'WimdS', 'toggle', 'group-delete-button', '\x20\x20-\x20用户ID:\x20', 'assign', 'main', 'toString', 'center', 'csMcK', '-preview', 'feed-loader', 'accepted', 'gazEC', ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20', 'KZcYW', 'kelwe', 'originalExpenses', 'white', '10px\x200', 'todo-list', 'wallpaper_main', 'execCommand', '很期待', 'VtUzq', '\x22\x20id=\x22', 'editing-char-id', '-\x20[动态]\x20', 'appState', '正在准备图片数据...', 'toFixed', 'json', 'uvtyo', '<path\x20d=\x22M15\x2018h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2h-2V4a2\x202\x200\x200\x200-2-2h-2a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path><path\x20d=\x22M7\x2014h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2H7V4a2\x202\x200\x200\x200-2-2H3a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path>', 'diaryView', '</div>\x0a\x20\x20\x20\x20', 'cover_placeholder_', 'ulxfZ', 'color', '[用户发起了听歌邀请:\x20', '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011V7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v4\x22></path><line\x20x1=\x2210\x22\x20y1=\x2216\x22\x20x2=\x2210\x22\x20y2=\x2223\x22></line><line\x20x1=\x2214\x22\x20y1=\x2216\x22\x20x2=\x2214\x22\x20y2=\x2223\x22></line>', 'create_event', 'Noir\x27s\x20Temporal\x20Patch:\x20Ledger\x20re-synchronized.', '确定要彻底清空【', '\x20\x0a#\x20当前情景\x0a', 'dialogue', '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', 'readAsText', '<p\x20style=\x22margin:\x20auto;\x20text-align:\x20center;\x20color:\x20red;\x22>加载失败了，哼。<br>', '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。', '\x0a#\x20核心任务:\x20档案馆书记官\x0a你的任务是为一个名为“', 'tTYSt', '有点破防', 'event-content-input', 'MfHNz', 'cancel-quote-button', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20padding:\x2015px;\x20background:\x20white;\x20box-shadow:\x20var(--soft-shadow);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2012px;\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x20padding-bottom:\x2010px;\x20margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x201.8rem;\x20flex-shrink:\x200;\x22>🍜</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20600;\x20font-size:\x201.05rem;\x22>', 'https://sharkpan.xyz/f/gjySw/jrl7rw.jpg', 'api-key', 'statusText', 'calendar-header-title', '<div\x20class=\x22post-timestamp\x22>', '你好，世界\x20(Hello,\x20World)', 'sticker', 'hoRjc', 'TFuxX', '对方正在行动中...', 'worldBookEditor', 'kBtim', 'todo-item', '#ff8c66', 'https://sharkpan.xyz/f/ljNUx/aw6udx.jpg', 'qhwpB', 'userId', '的日记本', 'speaker', 'OUsri', 'https://sharkpan.xyz/f/B4DCa/u86hk2.jpg', 'meeting-char-name-header', '出去玩', 'change', '\x0a#\x20核心任务\x0a你是一个高度智能的档案管理员，任务是为我（用户，名为“{userName}”）和角色“{charName}”之间的私聊记录生成一份简洁、结构化的长期记忆摘要。\x0a\x0a#\x20摘要规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。严禁包含任何\x20JSON、Markdown\x20或其他解释性文字。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`memory_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以日期（`YYYY-MM-DD`）作为键。\x0a\x20\x20\x20\x20-\x20每个日期下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**精简**:\x20忽略日常问候、无意义的闲聊和重复内容。\x0a\x20\x20\x20\x20-\x20**聚焦**:\x20专注于关键信息、情感转折点、重要决定、分享的秘密、设定的约定、以及能够体现角色性格和关系变化的核心事件。\x0a\x20\x20\x20\x20-\x20**中立视角**:\x20以客观的第三人称视角进行记录。**请直接使用“{userName}”和“{charName}”这两个具体的名字**\x20来指代双方。\x0a\x0a#\x20输出示例\x0amemory_summary:\x0a\x20\x202025-09-12:\x0a\x20\x20\x20\x20-\x20\x22userName}\x20表达了对最近工作压力的烦恼。\x22\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20分享了自己过去类似的经历来安慰\x20{userName}，并提议周末一起去看电影。\x22\x0a\x20\x20\x20\x20-\x20\x22双方约定周六下午在市中心的电影院见面，并确定观看电影《夏日终曲》。\x22\x0a\x20\x202025-09-13:\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20发来一张猫咪的图片，心情看起来不错。\x22\x0a\x20\x20\x20\x20-\x20\x22{userName}\x20讨论了关于一个新项目的想法，{charName}\x20给出了一些关键建议。\x22\x0a\x0a#\x20输入格式\x0a我将为你提供完整的聊天记录，格式如下：\x0a[YYYY-MM-DD\x20HH:MM]\x20[说话人]:\x20聊天内容\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的聊天记录全文，并生成一份\x20YAML\x20格式的摘要。直接从\x20`memory_summary:`\x20开始输出。\x0a', 'meeting-list-screen', 'characterEdit', 'PAdhN', 'input', 'IGJut', 'cVtQQ', '徽章已更换！', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20', '刚刚发布了一条动态，内容是：“', 'Kuscn', 'edit-message-button', 'char_offline_bg_', '确定要重置所有桌面小组件和App的位置，并将壁纸变为纯白吗？此操作后将刷新页面。', '20%', ']\x22\x20等前缀。\x0a如需发送表情，只发送一行：[sticker:表情名]。\x0a【重要】发送表情包时，表情名【必须】从以下列表中选择：[', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'GpKPo', 'XetuT', 'themeHue', 'characters', '点击选择\x20info.txt', '<span>', 'getDate', 'LqYOA', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'ysTGA', 'worldBook', 'playableUrl', '。你的日记是写给Ta看的。\x0a\x0a#\x20写作【最高指令】\x0a1.\x20\x20**【首要任务：回应读者】**\x20你的第一要务是**回应**读者（', 'https://sharkpan.xyz/f/xjwSX/pxjrjd.jpg', 'wtcBA', 'display', 'QCYAT', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-content\x22>', 'UEjmt', '\x20[并附上了一张图片]', '一起听歌', '\x20//\x20<--\x20哼，加在这里\x0a', '225NSHviH', 'MGvnY', '用户已删除。', 'snoop-home-time', 'getAll', 'jJHYq', 'YySCk', '无法从\x20IndexedDB\x20加载聊天图片:', 'ZbDud', 'remark', 'Rfcat', 'User', 'iWdFI', 'object', '和其他人的聊天', 'width', 'EYVoe', 'xtcoJ', 'margin', 'EtZVL', 'body', 'group-avatar-input', '至少要保留一个用户。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22preview_', 'todo-date-title', 'option', '绝对不想', 'Qtwhx', 'coverId', '在“一起听”邀请中，净化封面失败:', '确定要对本次会话进行总结吗？这会消耗不少资源，并且会读取完整的聊天记录。', 'sin', 'cVItk', '啥意思捏', 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', 'eventType', '小时前聊过，可以适当问候，不要直接继续之前的话题。', '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', 'musicPlayerState', '稍微有点卡了，可以尝试清空聊天记录了！记得总结丢世界书', 'PMkuf', 'bottom', '#diary-action-cancel', 'https://sharkpan.xyz/f/xjmCX/zyjzew.jpg', 'remove', '\x20张旧图片。', '新角色\x20', 'sender', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>', 'mHXbs', 'eventContent', '\x0a\x20\x20\x20\x20姓名:\x20', 'edit-message-backdrop', 'parentElement', '.message-container', '正在为你搬运旧壁纸到新仓库...', '小组件背景已更换！', 'vYVcv', '群聊“', '\x20\x20\x20\x20-\x20', 'diary-modal-save', 'TqABF', 'isAnimatingDiary', 'read', '<div\x20class=\x22loader-spinner\x22\x20style=\x22margin:\x20auto;\x22></div>', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a', '切换聊天时发生异步错误:', '条目名称和内容都不能为空！', 'snoop-summary-textarea', 'spriteTransform', 'ATQnW', 'persona', '\x0a#\x20最近的动态回顾\x20(供所有角色参考)\x0a', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>', 'push', 'activeFriendCircleId', 'gbljO', 'phHGb', '[sticker:', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22width:\x2060px;\x20height:\x2060px;\x20background-color:\x20#eee;\x20border-radius:\x208px;\x20font-size:\x202rem;\x20flex-shrink:\x200;\x22>🖼️</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22\x20style=\x22margin-top:\x202px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a<div\x20class=\x22char-remark\x22\x20style=\x22white-space:\x20normal;\x20line-height:\x201.6;\x22>', 'JQQqD', 'FRnui', '你的任务是【续写和追加】！下面是已经存在的内容，你必须在此基础上，生成【全新的、发生在之后】的条目。给我把新内容【加在后面】，【绝对禁止】删除或修改任何已有的旧条目！', 'iVMck', 'svboE', '\x20内容失败:', 'find', 'music_library', 'accounting', 'wvJco', '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20', 'paused', '收到的原始、有问题的文本:', 'onload', 'audio', 'sHMmi', 'ceil', 'userProfiles', 'export-all-data-button', ',\x20resetting.', 'card-image-2', '未知商品', 'edit-message-modal', 'friend-circle-list-screen', 'role', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22></div><div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22><div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>', 'cxSqZ', 'show', 'children', 'transfer-recipient-select', 'music_cover_', 'WiTQX', 'meetingList', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'textShadow', 'https://sharkpan.xyz/f/AaDTZ/tzwnjl.jpg', 'KleRI', 'currentlyPlayingIndex', '\x0a\x20\x20\x20\x20-\x20世界书[', '”吗？此操作不可撤销。', '<span\x20class=\x22description\x22>', '\x20天没活动了。你生成的内容必须是全新的事件。\x0a', '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a', 'sCzBY', 'listen-together-card', 'QyeiQ', '点击选择\x20.lrc', '15px', '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。', 'YpzJl', 'insertBefore', '--primary-lightness', '-\x20**状态提示**:\x20这是你的手机第一次被“看见”，生成的内容应该是你的初始状态。\x0a', 'WglhI', 'mgUds', '-\x20**状态提示**:\x20你已经有\x20', 'snoop-home-clock', 'https://sharkpan.xyz/f/Ganul/78iwli.jpg', 'lNTmw', 'stopPropagation', 'vtaxf', 'inline-block', 'EyXoo', 'defaultPrevented', '.lt-end-session-btn', 'knfyX', 'phone-container', '\x20|\x20', 'claude', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'home-screen', 'TRrRp', 'ZDobx', 'EQERf', 'googleapis.com', 'CtPYV', 'model', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22order-items-container\x22\x20style=\x22display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x204px;\x20margin-bottom:\x2012px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '一拳打爆', 'YMwZy', 'ykObm', 'https://sharkpan.xyz/f/pKWCQ/ztxwv0.jpg', 'chat-screen', 'snoopList', 'upload-badge-button', 'XjhUE', '\x0a---\x0a##\x20最近的朋友圈动态\x0a', 'diary-page', '星期四', '\x0a##\x20条目:\x20', '</div><div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x22>', 'diary-entry\x20', 'activeMeetingCharId', '确定要清空\x22', 'https://sharkpan.xyz/f/1zQH2/o84boo.jpg', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>', '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x228\x22></circle><line\x20x1=\x223\x22\x20y1=\x223\x22\x20x2=\x2221\x22\x20y2=\x2221\x22></line>', '请先在\x22设置\x22中配置你的\x20API\x20信息。', 'dIazw', '请根据以上所有规则，生成\x20', 'message-action-backdrop', '\x0a\x0a#\x20今日消费流水\x0a', 'appIconPosition_', 'calendar-screen', 'aZUTi', 'concat', 'snahd', 'chatHistory_', '无法保存状态，浏览器可能禁用了存储功能。', 'lt-ui-cover-art', '-\x20**状态提示**:\x20你们今天刚聊过，请自然地衔接对话。\x0a', 'BaZzc', 'iGfZz', 'cxJSs', 'pMavP', '<path\x20d=\x22M6\x2012h12\x22></path><path\x20d=\x22M12\x206v12\x22></path><path\x20d=\x22M12\x202a4\x204\x200\x201\x201-4\x204\x22></path><path\x20d=\x22M12\x2022a4\x204\x200\x201\x200\x204-4\x22></path><path\x20d=\x22M22\x2012a4\x204\x200\x201\x200-4-4\x22></path><path\x20d=\x22M2\x2012a4\x204\x200\x201\x201\x204\x204\x22></path>', 'DqggY', 'badge-image', 'p[data-history-index]', 'world-book-screen', 'widget-title', 'appIconPosition_app-wallpaper', 'MAznO', 'disabled', 'MIOJc', 'meeting-main-content', 'yPKGS', 'user-name', '的个人专属世界观设定\x0a', '世界书条目已保存！', '-\x20[', '正在搬运旧卡片...', 'system', 'hRMHH', 'gemini', '”，但没找到人)', '\x20(当前)', 'wYKIB', 'wJBiV', '正在焚烧【', '2-digit', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>📶\x20🔋</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'https://sharkpan.xyz/f/eOXIw/y29z21.jpg', '_NoirCard.json', 'revokeObjectURL', '</svg>', 'GOOYs', 'buzfK', 'removeItem', 'kvkkE', '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概', '群聊\x22', 'objectStore', 'is-today', 'pointer', '6YauyPu', 'includes', 'Creating\x20object\x20store:\x20', 'char-edit-wallpaper-input', '赞同！渲染效果一级棒！', '\x27).click()\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x20background-color:\x20#777;\x22\x20onclick=\x22localStorage.removeItem(\x27', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'currentTime', '群聊设置已保存！', '.choice-modal-backdrop', 'Wnzii', 'NWIzO', 'appIconPosition_app-music-library', 'LioHq', 'https://sharkpan.xyz/f/Krwio/1mcclx.jpg', 'isFinite', 'generativelace.googleapis.com', 'group-world-book-checkboxes', 'bsxPU', 'KakAN', 'mZKNN', 'focus', '不高兴撒娇', 'flexDirection', '书记官正在奋笔疾书...', '”已创建！', '71%', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'https://sharkpan.xyz/f/8a7tj/sea1z9.jpg', 'BrnmT', 'pyyed', 'endpoint', '\x0a\x0a#\x20最近的动态回顾\x20(供参考)\x0a', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'create-group-chat-button', '<path\x20d=\x22M12\x202v20\x22></path><path\x20d=\x22M4\x2012h16\x22></path>', 'wallpaper', 'iddDD', '。\x0a-\x20再次强调：你的全部输出都将被作为JSON解析，任何JSON主体之外的额外文字都会导致程序失败。\x0a', '用户分享音乐失败:', 'pIQgl', 'XjZTh', 'RxZUq', '真是的，必需的祭品都还没准备好！', 'PhNrx', 'modal-text', '-\x20你记得曾和“', 'visible', 'scrollIntoView', '切，加载播放器状态的时候出错了。', '确定要删除这篇日记吗？此操作不可撤销。', 'summarize-backdrop', 'BIHau', 'scZRw', '\x20.app-icon-img,\x20#app-dock-top-right\x20#', 'Noir\x27s\x20Fix:\x20\x27home-screen\x27\x20element\x20not\x20found!', 'IBRGq', 'novel', 'zh-CN', '\x20(ID:\x20', 'boundUserProfileId', '2px\x20dashed\x20var(--border-color)', 'Xubes', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以视奸的角色。</p>', 'YrwYO', 'YjznA', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '确定要恢复默认字体吗？', 'char-name-header', ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[', '\x20张旧的动态图片。', '确定要删除群聊“', 'copy-summary-button', 'Gbvdt', 'files', 'NHXrR', 'https://sharkpan.xyz/f/JYeig/sv4p6m.jpg', 'borderRadius', 'tag', 'JIVLF', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'ildiG', '\x0a\x20\x20\x20\x20人设:\x20', 'setProperty', '快点哄我', '包含所有图片和音乐的全量数据已成功导出！', 'HWglh', '正在搜索音乐...', '#group-world-book-checkboxes\x20input:checked', 'NRohI', 'tSGrv', 'characterLastScripts', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'touchstart', 'diary-modal-cancel', '\x0a\x0a#\x20关于群聊参与者“', 'lsxsz', 'YGpAz', '保存失败:\x20', 'important-day-item', 'VbknY', '日记已删除。', 'isFromLibrary', 'widget-cover-art', 'mjlmI', '0\x201px\x203px\x20rgba(0,0,0,0.6)', '生成动态时发生错误:\x20', 'user', 'random', '的第一次互动。\x0a', '\x20(分享了歌曲:\x20', 'bTGwZ', 'amount', 'choice-cancel', 'listen-together-backdrop', 'history', '执行音乐封面数据净化...', '选择聊天', 'https://sharkpan.xyz/f/4adUj/68uj9o.jpg', 'transform', 'getSelection', 'is-visible', 'form-button\x20load-more-btn', 'quotedMessage', 'version', 'ovMfS', '对方正在输入...', '\x20天没联系了，应该用全新的问候开启对话，不要再提上次的话题了。\x0a', '#\x20核心任务:\x20财务分析与多角色吐槽\x20(单次请求完成)\x0a你是一个高级AI，需要一次性完成对用户消费流水的分类，并为每一笔消费生成一个符合角色人设的吐槽。\x0a\x0a#\x20规则\x0a1.\x20\x20**逐条处理**:\x20你必须处理我提供的【所有】消费记录。\x0a2.\x20\x20**精准分类**:\x20为每条记录从【固定分类列表】中选择一个最合适的分类。\x0a3.\x20\x20**人格切换吐槽**:\x20为每一条记录，你必须从【角色资料库】中【随机选择一位】，然后【严格代入】该角色的人设，并【假定】这笔消费是该角色【绑定的用户】所为，然后写一句简短吐槽。\x0a4.\x20\x20**JSON输出**:\x20你的输出**必须**是一个完整的、语法正确的JSON数组。每个对象代表一笔消费，且必须包含\x20\x22description\x22,\x20\x22amount\x22,\x20\x22category\x22,\x20和一个\x20\x22review\x22\x20对象。\x0a\x0a#\x20输出格式示例\x0a```json\x0a[{\x22description\x22:\x20\x22乌龟\x22,\x22amount\x22:\x205.00,\x22category\x22:\x20\x22购物消费\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512586032\x22,\x22text\x22:\x20\x22又买这些没用的东西，哼。\x22}},{\x22description\x22:\x20\x22奶茶\x22,\x22amount\x22:\x2012.00,\x22category\x22:\x20\x22餐饮美食\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512604818\x22,\x22text\x22:\x20\x22偶尔喝一杯放松一下也不错。\x22}}]```\x0a#\x20最终指令\x0a请严格按照以上规则，分析流水，并返回JSON数组。直接从\x20`[`\x20开始输出。', 'QyJRo', '】的手机已被重置。', 'JNrPI', 'quoted-message-in-bubble', 'customWallpaper', 'snoopPhone', 'LSzRV', '\x22\x20accept=\x22image/*\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x22\x20onclick=\x22document.getElementById(\x27input_', 'group-settings-name', 'result', 'AixND', 'character', 'comments', 'world-book-checkboxes-container', 'music-library-item', 'uDxDt', 'reduce', 'preview_', 'zKeDZ', 'background', 'ELWOU', '\x22>\x20', 'cancel-music-input', 'ItJDw', 'expense-item', 'nKALc', 'textContent', '升级已取消。旧版图片数据可能导致应用卡顿或出错。', 'XfZBP', '我正在说话呢，别打岔！', '[用户发送了表情：', 'DZylu', 'mouseup', 'aZWqC', 'OUZwb', '\x0a\x20\x20人设:\x20', 'typing-indicator', '执行好友圈数据净化...', 'WOJVQ', '---\x20Noir\x27s\x20Music\x20Cover\x20Purification\x20Ritual\x20---', 'lastTimestamp', 'NWUIU', 'meetingViewMode', '条】全新的、高质量的社交动态。\x0a\x0a#\x20好友圈成员信息\x0a', 'KfKNR', 'iHtCz', 'gjXeL', 'last_message_preview', '</pre>', 'expanded', 'https://sharkpan.xyz/f/3AGHe/2f8x3x.gif', 'save-group-settings-button', 'https://api.vkeys.cn/v2/music/', '#\x20核心任务:\x20写一篇有深度的交换日记\x0a你正在扮演名为“', 'JUotO', 'charAt', '\x20的内容\x0a请为角色生成符合其人设的应用数据。输出格式必须是严格的JSON数组。', 'unpFy', '\x0a#\x20最近的朋友圈动态\x20(供你参考)\x0a', 'is-exiting-right', '[AI向\x20', 'kikVQ', 'DWeBY', 'rgba(0,\x200,\x200,\x200.4)', '\x20条动态...', '错误：找不到此好友圈绑定的用户！', ')，启动兼容模式...', 'LQqPh', '群名称已更改为\x22', 'https://sharkpan.xyz/f/v0qcL/dio7j0.jpg', '\x0a你是一个严格的JSON生成引擎。\x0a你的唯一任务是根据用户提供的指令和数据，生成一个描述角色互动的JSON对象。\x0a你的输出【必须】是、也只能是一个单一、完整、语法正确的JSON对象。\x0a严禁包含任何解释、注释、道歉、或Markdown代码块标记\x20```json。\x0a直接输出\x20{\x20\x22events\x22:\x20[...]\x20}\x20结构。\x0a', 'Detected\x20API\x20provider:\x20', 'user-avatar-input', '在准备动态回复时，读取图片失败:', 'lyrics', 'iYvfD', 'musicId', 'isPlaying', 'ECeYz', 'sprite-slider-y', 'upload-font-button', 'ERxKn', 'SnWEZ', '.custom-multiselect', '\x0a\x0a#\x20你的手机内容摘要\x20(这是你的个人记忆，不要提及“视奸”)\x0a', 'reset-card-button-2', '</span><span\x20class=\x22unit\x22>天</span>', '距离「', 'screenX', 'AI返回的不是一个数组。', 'chat-music-button', 'iLXNf', '壁纸已更换！', 'edit-message-textarea', 'veHnN', 'candidates', '\x22\x20src=\x22', '音乐搜索失败:\x20', 'back-to-settings-from-user-profile', '已自动断开与其他人的听歌同步。', '.app-icon', 'JJmkE', 'linkedWorldBookIds', '获取AI响应失败:', 'zRFiQ', 'quoted-sender', 'translateX(-', '#\x20发生错误：\x0a', 'GqrYa', 'currentDate', 'onupgradeneeded', '未知表情', 'play', 'image/', 'EInXd', 'xruMq', 'GAogx', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'review', 'PPAJJ', 'http', 'CHoMZ', '正在打包“', '解析AI剧本JSON失败:', 'app-user-profiles', '在你那乱七八糟的文本里没找到“歌名”！', '小时前），可以简单问候一下对方现在的状态。\x0a', 'Qnsfe', 'https://sharkpan.xyz/f/mjdFW/28n30c.jpg', 'Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.', ']\x20[image]', 'group_bg_', '-\x20你的备忘录里有一条叫“', 'csHxs', 'time', 'post-img-', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22snoop-summary-textarea\x22\x20readonly\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border:\x20none;\x20outline:\x20none;\x20resize:\x20none;\x20font-family:\x20\x27Courier\x20New\x27,\x20monospace;\x20font-size:\x200.85rem;\x20line-height:\x201.6;\x20background-color:\x20#fdfdfd;\x20padding:\x2015px;\x20box-sizing:\x20border-box;\x22>', 'remove-font-button', 'jdSth', 'signal', 'diary-list-screen', '已删除。', '名字不能为空！', 'uixwS', 'SLJOv', 'fgXyf', '回复\x20', 'chat-reroll-button', 'songName', 'fetch-models-button', 'meeting-message-input', 'audio-file-input', '解析存档失败，正在重置:', 'music-feed-container', 'friend-circle-edit-screen', '\x0a\x0a#\x20用户资料\x20(与你互动的人)\x0a-\x20姓名:\x20', 'onsuccess', 'some', 'model-dropdown', 'save-friend-circle-button', 'undefined', '\x0a\x0a#\x20近期记忆\x20(来自聊天记录等)\x0a', 'localStorageData', 'unHYB', '群聊音乐搜索失败\x20(', 'IiLdg', 'getMinutes', 'removeEventListener', 'tYBWl', '请在动态或聊天中播放', 'sprite-confirm-button', 'ZlSfq', 'swJxH', 'https://sharkpan.xyz/f/nj5Ul/ksdl8n.jpg', 'galgame-speaker', 'app-meeting', 'snoop_cache', 'keys', '\x0a[歌词结束]\x0a\x0a请根据当前播放的歌词和对话氛围，自然地作出回应。\x0a\x20\x20\x20', '<path\x20d=\x22M13.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V9L13.5\x202z\x22></path><polyline\x20points=\x2213\x202\x2013\x209\x2020\x209\x22></polyline>', 'italic', '小组件背景已恢复默认。', '加载见面背景失败\x20for\x20', 'chat-messages', '50%', '”聊过天，关于：“', 'categorized-expenses-list', '你的任务是【首次生成】这个应用的内容。', 'senderId', 'rftYk', 'BTFsN', '<div\x20style=\x22padding:\x2015px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2015px;\x22>', '\x0a#\x20你的日程与纪念日\x20(由\x20', 'diaryList', '群聊\x20(', 'XSBec', 'scale', '3025585mOQRjl', 'shift', 'event_ai_', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'snoop-temp-style', 'yQBYR', '很好哦', 'ZQFNt', '今天一笔账都没有，我整理什么？', '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'QGczf', 'user-profile-list-container', 'Canvas\x20to\x20Blob\x20conversion\x20failed.', 'displayedMessageCount', '\x20\x20具体对话如下：\x0a', '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'open', 'touchmove', '委屈哭', 'cardState', '<button\x20id=\x22re-record-button\x22\x20class=\x22header-button\x22>重新记录</button>', 'onerror', '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20', 'world-book-editor-title', 'obdiS', 'items', 'https://sharkpan.xyz/f/Wa0cW/w6m7qk.jpg', 'iThNT', 'join', 'KzKzS', '29%', 'PCzHn', 'daPHo', 'title', 'bJkBt', 'char-edit-name', '请求AI更新:\x20', 'show-chat-view', 'gap', '正在为你切换新的歌曲...', '.screen.active', 'cancel', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', '好像有动态了...', 'post_image_migrated_', '<span>--</span><span\x20class=\x22unit\x22>天</span>', '你是一个乐于助人的助手。', 'div', '\x20/\x20', '\x0a\x0a#\x20任务流程\x0a1.\x20\x20**全局视角**:\x20审视所有成员的人设和近期记忆（包括聊天、日记等），构思他们之间可能发生的有趣互动。\x0a2.\x20\x20**选择作者**:\x20从上述成员中，为', 'Azohi', '[发送了表情]', 'date', '\x0a#\x20最近的动态回顾\x20(供参考，避免重复)\x0a', 'back-to-home-from-accounting', 'group_avatar_', '\x20添加了新的纪念日：', 'tLNqx', '外卖订单', 'czHgs', 'https://sharkpan.xyz/f/LZwu7/m7vx2q.jpg', 'zpFLZ', 'charSelect', 'target', 'DRcpk', '\x20写道:\x20', '保存角色失败:', '\x0a\x0a#\x20', '导出失败了，哼:\x20', 'zsDNe', '检测到已保存的字体，正在应用...', '#\x20任务:\x20生成\x20', 'CuOKH', 'import-char-input', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'Claude\x20API\x20错误:\x20', 'user-profile-screen', 'sprites', 'VfZeV', '字体已应用！(Font\x20Applied!)', 'PBcAs', '纪念日', 'VRfwK', 'xsUcn', 'canplaythrough', 'Enter', '成功向好友圈\x20\x22', 'number', 'test_post_', '被萌到', 'https://sharkpan.xyz/f/8ngsj/ax0fat.jpg', '\x0a\x20\x20近期记忆:\x0a', 'song_', '\x20之间。\x0a-\x20所有表情包名称【必须】从\x20`stickerList`\x20列表中选择，严禁使用列表之外的名称。\x0a-\x20角色之间需要有适当的互动,话题不应当完全围绕', 'BaDMJ', 'JPxFx', 'veCNM', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20', 'exec', 'TA正在提笔写日记...', 'isOffline', 'MPyPN', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22character-item\x22\x20style=\x22align-items:\x20flex-start;\x20margin-bottom:\x200;\x20padding:\x2015px;\x20', 'src', '请输入新的群名称：', 'appIconPosition_app-settings', 'seZMc', 'accounting-content-area', 'GSHYw', '#diary-action-reroll', '确定要删除这个好友圈吗？此操作不可撤销。', 'ipMlN', 'true', 'uUBbi', 'active', 'contact_name', 'ookol', 'musicWidgetPosition', 'ended', '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>', 'none', 'app-world-book', '已复制到剪贴板！', 'data:', 'normal', '</span>', 'fill', 'offline-scene-view', 'info-file-input', 'VrptS', 'CixbC', 'https://sharkpan.xyz/f/N0VCv/5rd8br.jpg', '<div\x20class=\x22post-likes\x22>', 'ABRLS', 'setHours', '弱小委屈但凶恶', 'IbNwq', 'OXHfI', 'is-entering-from-left', 'hLZfQ', 'day-number', 'CBnks', 'ImFmO', '--feed-bg-image', 'substring', '\x0a-\x20你正在为一个名为“', '卡片\x202\x20已更换！', 'LZmtY', '字体更换成功！', 'emoji', 'userAvatarFrameUrl', 'https://sharkpan.xyz/f/olJt4/7z47b8.jpg', 'chat', '内容不能为空！', '说了是摆设啦，笨蛋。', 'NeWJb', '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1', '\x22\x20data-id=\x22', '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>', '未知搜索', 'BmKhp', '至少要选择一个圈内成员！', 'query', 'IJJDT', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>', 'sxGOg', '新建好友圈', 'xVlxP', 'api-provider', '.music-post-play-icon,\x20.music-share-play-icon', '\x0a##\x20世界书条目:\x20', 'pDktD', 'timeupdate', 'addEventListener', 'artist', 'FbNKb', 'QbgPN', 'https://sharkpan.xyz/f/ZazfW/2vv46w.jpg', 'bFGfi', 'match', 'chat-sticker-button', 'oncomplete', '<div\x20class=\x22snoop-avatar\x22>', 'custom_font_ttf', 'htvHl', 'AvEyI', 'friend-circle-member-selection', 'snoop-dock', '图片加载失败', 'fNsKG', 'Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20', 'timestamp', 'chats', 'cuHrt', '.todo-item,\x20.important-day-item', '加载视奸记忆失败\x20(', '5px', '<div', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/epv2AAAAABJRU5ErkJggg==', '215316IcLjuN', 'https://sharkpan.xyz/f/OymFy/dlxfiz.jpg', 'json_object', '我错了', 'eventDate', '.snoop-clear-btn', 'upload-card-button', 'isAUU', 'daily-expenses-list', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'Failed\x20to\x20save\x20state\x20to\x20localStorage:', '加载更多聊天记录', 'transfer-backdrop', '找不到要清空的聊天记录。', 'char_sprite_', '\x20的图片失败:', 'diary-entry-input', 'DOMContentLoaded', 'round', 'https://sharkpan.xyz/f/ExKsD/s5j2it.jpg', 'api-model', '（开始一段新的对话...）', '\x20条新动态。', 'chat_group_', 'setAttribute', '.char-info-wrapper', 'juDBP', 'zNVpO', 'sticker-item', '第一阶段升级完成！应用即将刷新以进行第二阶段检查。', 'short', 'isActive', 'reply', 'QxRlr', '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>', 'SIMQy', 'TBZtz', 'meeting-view-screen', 'kyNVb', '[DONE]', '角色“', 'status', '群聊已解散。', '.json', 'eNznj', 'type', 'app-wallpaper', '”已成功导入！', 'getDay', '\x0a#\x20关于你\x20(', 'sMulU', 'chat-view-pane', '的转账', 'close-summary-button', 'indexedDBMusicData', 'marginTop', '-\x20**状态提示**:\x20你的记忆已经停留在【昨天】。你生成的内容应该是今天发生的、全新的事情。\x0a', 'CEJms', '-\x20姓名:\x20', '确定要永久清空【', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.85rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x208px;\x20padding:\x2010px;\x20background:\x20var(--surface-bg);\x20border-radius:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '图片处理失败:\x20', 'marginBottom', 'gallery', '--primary-hue', 'UZZoi', 'full', '<div\x20class=\x22post-comments-container\x22>', 'accountingLedger', 'RPpFO', '<p>格式错误</p>', 'yAFyo', 'wpTsu', 'stretch', 'Gemini\x20API\x20Error:\x20', 'MPSbx', 'vszSP', 'chat-get-reply-button', '今天\x20', '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'startsWith', 'galgame', 'NLNlN', 'https://sharkpan.xyz/f/yrOhN/0yixqd.jpg', 'Assistant', '<div\x20class=\x22post-image-container\x22><img\x20id=\x22', 'AI\x20试图创建事件，但找不到有效的用户ID。', 'mouseleave', '\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-character-name=\x27', '\x20.app-icon-img', 'item_name', 'NUVFQ', 'from', '下载并转换网络封面失败:', 'chat-image-button', 'area', 'decode', 'SXCMS', 'KhLZq', 'save-world-book-button', 'jjdnu', 'YAML翻译机也无法理解这段梦话。', 'now', '#ff9999', 'trim', 'objectStoreNames', 'characterName', 'cBaYq', 'UTBBi', '未找到可用模型。', 'HxDIF', 'vertical', '群聊名称不能为空！', 'path', '确定要恢复这个角色的默认立绘位置吗？', 'getElementById', 'wnNkX', 'UDyan', 'user-profile-edit-title', '解析音乐文件失败:', 'meeting-reroll-button', 'char_avatar_', 'audio-player', 'JUEGS', '<path\x20d=\x22M6\x202L3\x206v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2V6l-3-4z\x22></path><line\x20x1=\x223\x22\x20y1=\x226\x22\x20x2=\x2221\x22\x20y2=\x226\x22></line><path\x20d=\x22M16\x2010a4\x204\x200\x200\x201-8\x200\x22></path>', 'postType', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>', 'EBQXd', '备忘录', '编辑群成员功能正在开发中...', '\x20个模型。', '原始文本:', 'chatWallpaper', '卡片已移除。', 'right', 'RauVV', 'page', 'MItTQ', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有对话记录。</p>', 'last_edited', 'createObjectStore', 'wLcXg', 'group-bg-input', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22input_', '[发送了图片]', '.ttf', 'VwwQY', 'PPdjQ', '\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20absolute;\x20left:\x20-25px;\x20top:\x2015px;\x20width:\x2020px;\x20height:\x2020px;\x20background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20font-size:\x201rem;\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-left:\x2010px;\x20padding:\x2012px\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20600;\x22>', '你还没有写日记。', 'snoop-app-icon', 'fsnNQ', 'split', 'add-chat-button', '我是垃圾', '(想转账给“', 'global-player-play-pause-btn', 'user-post-textarea', 'bDGmh', '60%', 'AtMlr', 'diary-page-', 'vGwki', 'trTUY', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', '\x20添加...', '获取模型失败:\x20', 'char-edit-persona', '这是一条由控制台添加的测试动态！样式看起来非常完美。', 'sticker-content', 'wBIjZ', '”（用户）的信息当成你自己的。\x0a\x0a#\x20【最高时间法则】(必须严格遵守)\x0a-\x20已有内容的最新时间点:\x20', 'dwJRB', 'FSXHB', 'ofJIC', 'calendar-day', '\x0a#\x20已有内容\x20(这是历史记录，你必须接着写，不许动它！)\x0a```\x0a', '[表情]', 'ipXQW', 'https://i.pinimg.com/736x/16/f9/05/16f9051f99471208ee9c658aa4618eb6.jpg', '#66b3ff', '导入失败了，笨蛋:\x20', 'pmZIH', '<div\x20class=\x22listen-together-header\x22\x20style=\x22text-align:center;\x22>🎵\x20已连接，正在一起听\x20🎵</div>', 'kRlWx', 'POST', 'modal-root', 'qQpDo', 'gZZTv', '\x20到\x20', 'friendCircleEdit', 'https://sharkpan.xyz/f/4aqCj/gp13hn.jpg', 'kind', 'YuoMs', 'absolute', '加载自定义表情包失败，真是没用。', 'fLQxl', '<br>', 'Qnlgu', 'private', '（正在构思中...）', 'fCfgN', 'accountingData', 'activeChatId', 'back-to-chat-from-group-settings', 'galgame-textbox-container', 'beforeend', 'https://sharkpan.xyz/f/25ACQ/gpzab6.jpg', '\x0a\x0a#\x20关于对话者“', '.slot-filename', 'gMVCp', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'is-playing', 'test', 'dqhLn', 'group-clear-history-button', 'THlur', '\x0a\x0a#\x20关于读者“', 'zaTdR', '哼，这不是图片，你想让我压缩什么？', 'groupSettings', 'Zunln', 'SlkrN', 'qQHPq', 'YHGoM', '[用户分享了音乐：', 'toLocaleDateString', 'head', 'UCAbj', 'avatar-frame', '测试动态已添加！', 'paddingBottom', 'sspvs', '委屈那我歇了', 'diary-send-button', '哼，不好好写清楚花在哪、花了多少，我怎么记？', 'Mxmsc', 'apiSettings', 'noir_data_migration_v1_complete', 'openai', 'WfXUn', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', 'amZcX', 'activeQuote', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'https://sharkpan.xyz/f/ABwhZ/twknmr.jpg', 'FYgPP', 'widget_card', 'back-to-diary-list', 'tFFVC', 'galgame-sprite', '59%', 'widget-next-btn', 'world-book-edit-name', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>', 'user-post-image-button', 'flatMap', '一个人可怜吃饭', '<span\x20style=\x22opacity:\x200.6;\x22>无</span>', 'ryRoY', 'important', 'Failed\x20to\x20save\x20history\x20to\x20localStorage:', 'click', '】的手机内容吗？\x0a\x0a所有已生成的缓存（相册、NPC聊天等）都将被永久删除。', 'image', 'world-book-item', 'wYJwy', 'load-more-btn', '确定要删除这个安排吗？此操作不可撤销。', 'listen-together-song-list', 'lbaRm', 'ZMMcL', '昨天\x20', 'init', 'KUKSW', 'QQyNx', '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a', 'uqEld', '1em', 'oePdS', 'svg', '\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22char-name\x22>', 'snoop-app-view-container', 'sUWSI', 'parts', '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[', 'dock', 'QgUye', '已恢复默认。', 'text', 'RcKfm', '别这样嘛我哭哭', 'clockPosition', 'toLocaleTimeString', 'abort', '”的角色撰写一份“手机内容总结档案”。你将收到一份包含其手机内多个应用数据的JSON对象。\x0a\x0a#\x20档案撰写规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`phone_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以应用名（如\x20`gallery`,\x20`whispers`\x20等）作为键。\x0a\x20\x20\x20\x20-\x20每个应用下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**【绝对禁止】复读**:\x20不要直接复制粘贴原文！你要用自己的话进行【总结】和【提炼】。\x0a\x20\x20\x20\x20-\x20**【聚焦核心】**:\x20专注于关键信息、情感转折点、重要决定、暴露的秘密、体现性格的核心事件。忽略无意义的细节。\x0a\x20\x20\x20\x20-\x20**【中立视角】**:\x20以客观的第三人称档案管理员视角进行记录。\x0a\x0a#\x20输出示例\x0a```yaml\x0aphone_summary:\x0a\x20\x20gallery:\x0a\x20\x20\x20\x20-\x20\x22相册里有一张在海边拍的黄昏照片，出现了一个神秘的背影。\x22\x0a\x20\x20whispers:\x0a\x20\x20\x20\x20-\x20\x22角色曾与一位叫\x27Rin\x27的神秘联系人讨论过一个重要的决定。\x22\x0a\x20\x20abyss:\x0a\x20\x20\x20\x20-\x20\x22近期频繁搜索关于“独自庆祝生日”的话题，可能暗示了其孤独感。\x22\x0a```\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的JSON数据全文，并生成一份\x20YAML\x20格式的档案。直接从\x20`phone_summary:`\x20开始输出。\x0a', 'yQBra', 'style', 'lt-ui-song-title', '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20font-size:\x200.9rem;\x20color:\x20var(--text-color);\x20margin-top:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>', 'gebIT', 'end', 'group-edit-name', 'editing-user-id', 'https://sharkpan.xyz/f/qjJT3/kpy33b.jpg', '”已存入圣殿。', 'music-share-card', '<path\x20d=\x22M21\x2010c0\x207-9\x2013-9\x2013s-9-6-9-13a9\x209\x200\x200\x201\x2018\x200z\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2210\x22\x20r=\x223\x22></circle>', 'TasIY', '有点生气', 'cardState2', 'line', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNjY2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDRhNC4zOSA0LjM5IDAgMCAwLTMuMjgtNC4wOWwxLjQxLTEuNDFhMiAyIDAgMSAwLTIuODMtMi4wM2wtMS40MSAxLjQxQTQuMzkgNC4zOSAwIDAgMCAxMiAxMGE0LjM5IDQuMzkgMCAwIDAtNC4wOSAzLjI4TDMuMicgOS41N2EyIDIgMCAxIDAgMi44MyAyLjgzbDEuNDEtMS40MUE0LjM5IDQuMzkgMCAwIDAgMTAgMTJhNC4zOSA0LjM5IDAgMCAwIDMgNC4wOVYyMSI+PC9wYXRoPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIj48L2NpcmNsZT48L3N2Zz4=', 'Yoakj', 'FDmJM', 'WHKII', 'DAzTC', 'delete-friend-circle-button', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22snoop-app-back-btn\x22\x20class=\x22snoop-app-header-button\x22>返回</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-header-title\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22main-title\x22>', '文件格式不正确，不是一个有效的备份文件。', '缓存命中:\x20', 'application/json', '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x22\x20style=\x22max-width:\x2085%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-bubble-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'DITrs', '好的，我记住了这些人设和历史。现在我们开始对话。', 'style-', 'LlWIT', '无法保存聊天记录。', '动态中的音乐搜索失败:', '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22><span\x20style=\x22background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20width:\x2040px;\x20height:\x2040px;\x20display:\x20inline-flex;\x20justify-content:\x20center;\x20align-items:\x20center;\x20flex-shrink:\x200;\x20color:\x20var(--accent-color);\x22>', 'auto', '默认米白', 'https://sharkpan.xyz/f/wyeIq/phhdy2.jpg', 'IgkwS', 'RHQdQ', 'user-post-music-button', 'scrollHeight', 'localeCompare', '导入失败:\x20', ',\x20ID:\x20', 'PRHcC', 'home', 'scfUJ', '#group-settings-screen\x20.select-box', '\x20时出错:', '加载已保存字体失败:', '这不是一张有效的Noir角色卡。', 'rykFk', 'NXYoW', 'JnZuU', '保存壁纸失败:\x20', 'html-module-container', 'postContent', '点击选择\x20.jpg\x20或\x20.png', '在准备群聊API数据时，读取图片失败:', 'back-to-home-from-chat', 'qFIWW', '\x20-\x20', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-', 'https://sharkpan.xyz/f/djyi8/1en214.jpg', 'snoop-home-date', 'AI似乎没有想出任何新动态。', 'chat_image_', '错误：第一个好友圈\x20\x22', 'wb_', 'WhjKQ', 'readAsDataURL', 'character-edit-screen', '分钟前', 'TzSmn', '清空聊天记录失败。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message\x20', 'outerHTML', 'KLLWn', 'char-edit-bind-user', '-\x20你拍过一张照片，内容是：“', 'avatarFrameUrl', 'getItem', 'likes', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22text-align:\x20right;\x20margin-top:\x208px;\x20font-size:\x200.7rem;\x22>', 'assistant', '\x20的旧格式数据翻译。', 'NxYHf', 'alt', 'group', 'flex', '咱俩天下第一好', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>', '<rect\x20x=\x223\x22\x20y=\x223\x22\x20width=\x2218\x22\x20height=\x2218\x22\x20rx=\x222\x22\x20ry=\x222\x22></rect><circle\x20cx=\x228.5\x22\x20cy=\x228.5\x22\x20r=\x221.5\x22></circle><polyline\x20points=\x2221\x2015\x2016\x2010\x205\x2021\x22></polyline>', '\x22\x20class=\x22post-image\x22></div>', 'wbjYF', 'padding', 'rUnwk', 'removeChild', 'restaurant_name', 'back-to-library-from-altar', 'KHzej', '28%', 'netease', 'hIYcL', 'OobNQ', '<div\x20class=\x22review-area\x22\x20style=\x22margin-top:\x2012px;\x20padding-top:\x2012px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x20display:\x20flex;\x20align-items:\x20flex-start;\x20gap:\x2015px;\x22><div\x20style=\x22width:\x2040px;\x20height:\x20auto;\x20flex-shrink:\x200;\x20display:\x20flex;\x20justify-content:\x20center;\x22><img\x20src=\x22', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22snoop-log-back-btn\x22\x20class=\x22snoop-app-header-button\x22\x20style=\x22text-align:\x20left;\x22>‹\x20聊天</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22snoop-app-header-title\x22>', '好友圈已删除。', 'music-screen', 'app-settings', 'GVAcO', 'calendar-grid', 'Jzmwd', 'xeJBv', 'GaWyh', '确定要清空群聊\x22', '\x22\x20已删除。', '#ffcc66', 'diary-write-button', 'rSZWY', 'lyric-line-', 'app-accounting', 'kLjWb', 'diary-list-container', 'BvWgQ', '/v1/models', 'message-bubble-row', '{charName}', 'input[name=\x22event-type\x22]:checked', 'onloadend', '-\x20**你最后一次活动是在**:\x20', '</div>', 'Noir\x27s\x20Fix:\x20已成功追加新旧数据\x20(A+B)。', 'user-avatar-preview', '确定要从圣殿中永久删除《', '】的旧数据...', 'back-to-snoop-list-from-phone', '未知艺术家', '.no-action-modal', '请看是我', '正在铭刻字体...', '#snoop-app-view-container\x20.snoop-app-content', '有点无语', 'QWZEC', '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202h-14a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011v-7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v7\x22></path><path\x20d=\x22M9\x204v3\x22></path>', '正在生成中，请稍候...', 'AfYoI', 'MOGMV', 'Failed\x20to\x20remove\x20history\x20for\x20chat\x20', '\x0a#\x20核心任务:\x20角色扮演模拟器\x0a你的【唯一】任务是扮演名为“', 'rbkns', 'snoop-phone-top-nav', 'aPqDd', 'import-all-data-button', 'sprite-resize-handle', 'chat-message-input', 'music-widget-card', 'app-music-library', 'DPoUs', '还没有我的回应可以重新生成哦。', 'user-profile-list-screen', 'yzMwk', 'pPhzP', '樱花薄粉', 'SGMjh', '刷新了\x20', 'rFDyt', '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a', 'url', '#a4c2f4', 'UCcWq', '净化好友圈时出错，真是的。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>', '正在处理图片...', 'className', '</div></div></div>', 'https://sharkpan.xyz/f/zLes5/4lxzjn.jpg', 'xsXOn', '\x22\x20class=\x22char-name\x22>', '导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a', 'diaryCurrentPage', 'wants', 'xuLkM', 'diary-next-button', 'friendCircleList', 'ZdpJN', 'replaceAll', 'iFjkI', 'SOrIX', '[AI发送了表情：', 'sMDFJ', 'Pzfda', 'KLgHT', 'Kgvtu', 'UqNvS', '加载聊天失败:\x20', 'clipboard', '</p>', 'indexOf', '</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20', 'oCAaH', 'sort', ']\x0a\x0a#\x20角色资料库\x0a', '新用户\x20', 'DswZT', 'xykUN', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-', '卡片已更换！', '暂无音乐', 'readonly', 'accounting-title', 'font-preview-text', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20right;\x20font-size:\x201.1rem;\x20font-weight:\x20bold;\x20margin-top:\x2010px;\x20padding-top:\x2010px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20实付:\x20<span\x20class=\x22amount\x22>¥\x20', 'char_wallpaper_', 'decorative-badge', '.diary-entry', 'qBJaT', 'https://sharkpan.xyz/f/7aMhj/hyc75m.jpg', 'SmfWZ', 'dtnoS', '交通出行', '&apos;', 'settings', 'WLaOA', ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“', 'FojOM', '</svg></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>', 'SVmIO', '</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '已选择\x20', 'reset-card-button', 'NFEfm', '谁啊我吗', 'lazy', 'IPwbj', '\x20的私聊', 'noir-custom-font-style', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22\x20style=\x22white-space:\x20pre-wrap;\x20margin-top:\x208px;\x20line-height:\x201.6;\x22>', 'PpHig', 'calendar', 'coverUrl', 'kDkun', 'calendarEvents', 'CccoW', 'splice', 'nCklX', '\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '来源：[最活跃]', 'HLbKZ', '正在翻阅全部历史记录...', 'sender_id', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天没有安排。</p>', '#a7c7e7', 'cursor', '<div\x20class=\x22post-body\x22>', 'diaryPressTimer', '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>', '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“', 'DyIOH', '图片预览失败:\x20', 'NJpax', 'LyaQY', 'filled', 'ymoGt', 'friend-circle-edit-name', 'choices', 'length', 'phone_summary:\x0a\x20\x20status:\x20空空如也，没什么好总结的。', 'char_', '天没动静了。你的角色们应该发起新的问候或话题。', 'meetingView', 'emote', 'cAwYY', 'UNgqC', '\x22>&times;</button></div>', 'cancel-action-button', 'EPxAo', 'msg_', 'alignItems', 'LSkeR', 'left', '用户操作中断了\x20AI\x20响应。', 'DCJmF', 'qxYQi', '#message-anchor', 'info', 'gnvVa', 'musicPlaylist', 'endsWith', '餐饮美食', '</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'viewBox', 'nbhOL', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', '加载卡片图片失败', 'HQhsr', 'qKdzN', 'accounting-screen', '\x0a#\x20发布动态的用户信息\x0a-\x20姓名:\x20', 'normal,\x20happy,\x20angry,\x20sad,\x20shy', 'WSugH', 'hKfyG', '</label>\x0a\x20\x20\x20\x20', 'data:image', 'https://sharkpan.xyz/f/X7muW/lc8g9h.gif', 'cyEzM', '\x0a---\x0a\x0a#\x20输出要求\x0a直接输出一篇有文采、有真情实感的日记正文，不要包含任何其他说明或前缀。', '生活服务', 'shiftKey', 'add']; _0x3140 = function () { return _0x30b9cf; }; return _0x3140(); } const _0x42e5a0 = _0x18ce; (function (_0x2d2845, _0x143d1e) { const _0x504b1d = _0x18ce, _0x1e7e76 = _0x2d2845(); while (!![]) { try { const _0x4363b0 = -parseInt(_0x504b1d(0x188)) / 0x1 + parseInt(_0x504b1d(0x28e)) / 0x2 * (-parseInt(_0x504b1d(0x3ee)) / 0x3) + -parseInt(_0x504b1d(0x947)) / 0x4 + parseInt(_0x504b1d(0x61f)) / 0x5 + parseInt(_0x504b1d(0x4d9)) / 0x6 * (-parseInt(_0x504b1d(0x13b)) / 0x7) + parseInt(_0x504b1d(0x971)) / 0x8 + parseInt(_0x504b1d(0x6e6)) / 0x9 * (parseInt(_0x504b1d(0x27a)) / 0xa); if (_0x4363b0 === _0x143d1e) break; else _0x1e7e76['push'](_0x1e7e76['shift']()); } catch (_0x3f94ff) { _0x1e7e76['push'](_0x1e7e76['shift']()); } } }(_0x3140, 0xae8a1)); function _0x21c2ed(_0x160931 = new Date()) { const _0xd4e2a4 = _0x18ce, _0x30441f = _0x160931[_0xd4e2a4(0xb29)](), _0x2b6c73 = String(_0x160931[_0xd4e2a4(0x950)]() + 0x1)[_0xd4e2a4(0x27e)](0x2, '0'), _0x4aaf5d = String(_0x160931[_0xd4e2a4(0x3de)]())[_0xd4e2a4(0x27e)](0x2, '0'); return _0x30441f + '-' + _0x2b6c73 + '-' + _0x4aaf5d; } const _0x50f0b5 = _0x42e5a0(0x247), _0x2e0278 = _0x42e5a0(0x9ef), _0x2dd60e = _0x42e5a0(0x60a), _0x46c666 = document[_0x42e5a0(0xa93)]('style'); _0x46c666['id'] = _0x42e5a0(0x8fb), document[_0x42e5a0(0x7c9)][_0x42e5a0(0x25f)](_0x46c666); var _0x29b260, _0x20c796 = null; let _0x53fca2 = [], _0x76acef = ![], _0x35b021 = { 'x': 0x0, 'y': 0x0 }; function _0x2cc229(_0x3c877b) { const _0x5c71c8 = _0x42e5a0; return (_0x29b260?.[_0x5c71c8(0x3db)] || [])[_0x5c71c8(0x444)](_0x51d803 => _0x51d803['id'] === _0x3c877b); } const _0x817b77 = _0x42e5a0(0x799), _0x2f94f8 = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5OTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDJhNC4zOSA0LjM5IDAgMCAtMy4yOC00LjA5TDE1IDIwIj48L3BhdGgPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCI+PC9jaXJjbGU+PC9zdmc+', _0x461596 = _0x42e5a0(0x81e), _0x2919f3 = [{ 'name': _0x42e5a0(0x631), 'url': _0x42e5a0(0x679) }, { 'name': '崩溃', 'url': 'https://sharkpan.xyz/f/G0dTl/4qad2i.jpg' }, { 'name': '生病', 'url': _0x42e5a0(0x8bf) }, { 'name': '工作', 'url': _0x42e5a0(0x2b3) }, { 'name': _0x42e5a0(0x98a), 'url': _0x42e5a0(0x7db) }, { 'name': _0x42e5a0(0x6a6), 'url': 'https://sharkpan.xyz/f/wjgHq/yznfhq.jpg' }, { 'name': '吃薯条', 'url': _0x42e5a0(0x1ab) }, { 'name': '期待', 'url': 'https://sharkpan.xyz/f/35lse/xmsue5.jpg' }, { 'name': '喜欢', 'url': 'https://sharkpan.xyz/f/55ntj/ul0hkz.jpg' }, { 'name': _0x42e5a0(0x678), 'url': 'https://sharkpan.xyz/f/kjOF6/zedyqb.jpg' }, { 'name': _0x42e5a0(0x81b), 'url': 'https://sharkpan.xyz/f/jj6s6/yd5bpb.jpg' }, { 'name': '委屈', 'url': 'https://sharkpan.xyz/f/ajwtY/x03qxn.gif' }, { 'name': '加油', 'url': _0x42e5a0(0xb24) }, { 'name': '对的', 'url': 'https://sharkpan.xyz/f/DVJtK/vxiup1.jpg' }, { 'name': '不满', 'url': _0x42e5a0(0x65b) }, { 'name': _0x42e5a0(0x38d), 'url': _0x42e5a0(0x816) }, { 'name': '猫猫撒娇', 'url': _0x42e5a0(0x93f) }, { 'name': '委屈', 'url': _0x42e5a0(0x7b5) }, { 'name': '平静', 'url': _0x42e5a0(0x3af) }, { 'name': '咬你', 'url': _0x42e5a0(0x525) }, { 'name': _0x42e5a0(0x869), 'url': _0x42e5a0(0x6e7) }, { 'name': '好困', 'url': _0x42e5a0(0x34f) }, { 'name': '摸鱼', 'url': _0x42e5a0(0x607) }, { 'name': _0x42e5a0(0x7cf), 'url': _0x42e5a0(0x5da) }, { 'name': _0x42e5a0(0x215), 'url': _0x42e5a0(0x3c3) }, { 'name': _0x42e5a0(0x9c7), 'url': _0x42e5a0(0x54f) }, { 'name': _0x42e5a0(0x3ec), 'url': _0x42e5a0(0x6a2) }, { 'name': _0x42e5a0(0x988), 'url': 'https://sharkpan.xyz/f/VGnuY/ptzlf5.jpg' }, { 'name': _0x42e5a0(0x40f), 'url': _0x42e5a0(0x419) }, { 'name': '好委屈但是不能哭', 'url': _0x42e5a0(0x84e) }, { 'name': _0x42e5a0(0x992), 'url': _0x42e5a0(0x3bd) }, { 'name': _0x42e5a0(0x780), 'url': _0x42e5a0(0x25e) }, { 'name': '勉强但是好吧', 'url': 'https://sharkpan.xyz/f/Oyjuy/p8v2hd.jpg' }, { 'name': '逗你开心', 'url': 'https://sharkpan.xyz/f/6Dgia/ghr4ji.jpg' }, { 'name': _0x42e5a0(0xa4b), 'url': _0x42e5a0(0xaf8) }, { 'name': _0x42e5a0(0x9dc), 'url': _0x42e5a0(0xa81) }, { 'name': _0x42e5a0(0x237), 'url': _0x42e5a0(0xa65) }, { 'name': _0x42e5a0(0x2d4), 'url': _0x42e5a0(0x7a5) }, { 'name': '无语但是随便吧', 'url': 'https://sharkpan.xyz/f/N02Sv/378vt6.jpg' }, { 'name': _0x42e5a0(0x3aa), 'url': 'https://sharkpan.xyz/f/VG2FY/uucfvv.jpg' }, { 'name': _0x42e5a0(0x52d), 'url': _0x42e5a0(0x3e5) }, { 'name': _0x42e5a0(0x89d), 'url': 'https://sharkpan.xyz/f/djjH8/29ejbg.jpg' }, { 'name': _0x42e5a0(0x48c), 'url': _0x42e5a0(0x115) }, { 'name': _0x42e5a0(0x408), 'url': _0x42e5a0(0x4e7) }, { 'name': _0x42e5a0(0x8f7), 'url': _0x42e5a0(0x6f9) }, { 'name': _0x42e5a0(0x625), 'url': _0x42e5a0(0xb1e) }, { 'name': '甜蜜地和你聊天', 'url': 'https://sharkpan.xyz/f/Qpzu6/3b30r2.jpg' }, { 'name': _0x42e5a0(0x4ef), 'url': _0x42e5a0(0x6d0) }, { 'name': '我是小丑呜呜', 'url': _0x42e5a0(0x639) }, { 'name': _0x42e5a0(0x118), 'url': 'https://sharkpan.xyz/f/0GKHX/mthvno.jpg' }, { 'name': _0x42e5a0(0x281), 'url': _0x42e5a0(0x739) }, { 'name': '我来搞定', 'url': _0x42e5a0(0x59f) }, { 'name': _0x42e5a0(0x13f), 'url': _0x42e5a0(0x48f) }, { 'name': '等你', 'url': _0x42e5a0(0x49c) }, { 'name': _0x42e5a0(0x7e7), 'url': _0x42e5a0(0x4cc) }, { 'name': '等你消息', 'url': _0x42e5a0(0x6b6) }, { 'name': '喝酒', 'url': _0x42e5a0(0x4f5) }, { 'name': _0x42e5a0(0x329), 'url': _0x42e5a0(0x477) }, { 'name': '呜呜', 'url': 'https://sharkpan.xyz/f/z1xc5/iore2n.gif' }, { 'name': _0x42e5a0(0x246), 'url': _0x42e5a0(0x8e8) }, { 'name': _0x42e5a0(0x6e9), 'url': _0x42e5a0(0x461) }, { 'name': _0x42e5a0(0x3c5), 'url': _0x42e5a0(0x833) }, { 'name': _0x42e5a0(0x89a), 'url': _0x42e5a0(0x238) }, { 'name': _0x42e5a0(0x809), 'url': _0x42e5a0(0x58c) }], _0x49756b = { 'beige': { 'name': _0x42e5a0(0x832), 'h': 0x23, 's': 0x19, 'l': 0x50 }, 'mizuiro': { 'name': '薄荷水色', 'h': 0xc3, 's': 0x19, 'l': 0x50 }, 'sakura': { 'name': _0x42e5a0(0x8b2), 'h': 0x159, 's': 0x19, 'l': 0x50 }, 'noir': { 'name': _0x42e5a0(0x375), 'h': 0x104, 's': 0xf, 'l': 0x1e } }; document[_0x42e5a0(0x6cc)](_0x42e5a0(0x6f7), () => { const _0x187760 = _0x42e5a0, _0x467ce2 = document[_0x187760(0x759)]('app-user-profiles'), _0x3de9fa = document[_0x187760(0x759)]('chat-transfer-button'), _0x12c2dd = document['getElementById']('transfer-modal'), _0x6f22e4 = document[_0x187760(0x759)](_0x187760(0x6f2)), _0x2ce304 = document['getElementById']('confirm-transfer-button'), _0x20a39b = document[_0x187760(0x759)]('cancel-transfer-button'), _0x15cd9a = document[_0x187760(0x759)](_0x187760(0x333)), _0x319c3d = document[_0x187760(0x759)](_0x187760(0x45b)), _0x1c178a = document[_0x187760(0x759)]('transfer-amount-input'), _0x1e38c9 = document['getElementById'](_0x187760(0x5ed)), _0x2a3d95 = document[_0x187760(0x759)]('chat-summarize-button'), _0x3f4547 = document[_0x187760(0x759)]('summarize-modal'), _0x1b4299 = document[_0x187760(0x759)](_0x187760(0x50c)), _0x4ab829 = document[_0x187760(0x759)]('summary-textarea'), _0x2d1325 = document[_0x187760(0x759)](_0x187760(0x521)), _0x1d579d = document[_0x187760(0x759)](_0x187760(0x71b)), _0xefae80 = document[_0x187760(0x759)]('char-edit-wallpaper-preview'), _0x57e62f = document[_0x187760(0x759)](_0x187760(0x4dc)), _0x59b746 = document['getElementById']('char-edit-offline-bg-preview'), _0x521e71 = document['getElementById'](_0x187760(0x1eb)), _0x4addb7 = document[_0x187760(0x759)](_0x187760(0x1f2)), _0x3f4f73 = document[_0x187760(0x759)](_0x187760(0x668)), _0x3c90fc = document[_0x187760(0x759)]('export-char-button'), _0x4633d3 = document[_0x187760(0x759)](_0x187760(0x5aa)), _0x4aba8b = document[_0x187760(0x759)](_0x187760(0x5e3)), _0x2d7a96 = document[_0x187760(0x759)](_0x187760(0x149)), _0x503514 = document[_0x187760(0x759)](_0x187760(0x8e2)); async function _0x20677c(_0x2c5fa3) { const _0xcbe6b0 = _0x187760; try { if ('plhoj' !== 'plhoj') _0x5dd57d['pause'](), _0x58f9f1[_0xcbe6b0(0xa01)](_0xcbe6b0(0x6c8))[_0xcbe6b0(0x574)] = '▶'; else { const _0x7d14f1 = URL[_0xcbe6b0(0x289)](_0x2c5fa3), _0x3c6d98 = _0xcbe6b0(0x1da), _0x2f3edd = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27' + _0x3c6d98 + _0xcbe6b0(0x1a5) + _0x7d14f1 + '\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; _0x46c666[_0xcbe6b0(0x29c)] = _0x2f3edd, document[_0xcbe6b0(0x204)]['style'][_0xcbe6b0(0x52c)](_0xcbe6b0(0x31e), '\x27' + _0x3c6d98 + '\x27'), _0x503514[_0xcbe6b0(0x574)] = _0xcbe6b0(0x66e); } } catch (_0x258381) { console[_0xcbe6b0(0x297)](_0xcbe6b0(0x242), _0x258381), _0xeba69d(_0xcbe6b0(0x9aa)); } } async function _0x500b8d() { const _0x45d5fe = _0x187760; try { if ('Avwpu' === _0x45d5fe(0x50e)) _0x129850[_0x45d5fe(0xb15)] = _0x404f88, _0x5459c2['boundUserProfileId'] = _0x4ef03d, _0x41580d[_0x45d5fe(0x9a8)] = _0x39fdc6; else { const _0x52f102 = await _0x2e6c7a(_0x45d5fe(0x6d6)); if (_0x52f102) { if ('iaigu' === 'ORZVV') { const _0x6cf90d = _0x207cf4['createObjectURL'](_0x4c5eb); _0x412dfb[_0x45d5fe(0x686)] = _0x6cf90d, _0x213095[_0x45d5fe(0x44b)] = () => { const _0x2d016a = _0x45d5fe; _0x51733b[_0x2d016a(0x4ce)](_0x6cf90d); }; } else console[_0x45d5fe(0xa05)](_0x45d5fe(0x665)), await _0x20677c(_0x52f102); } } } catch (_0x2e612e) { if (_0x45d5fe(0x4f6) !== _0x45d5fe(0x4f6)) return _0x19c8d7['userProfiles'][_0x45d5fe(0x444)](_0xb05b13 => _0xb05b13['id'] === _0x29128a['activeUserProfileId']) || _0x418f36[_0x45d5fe(0x44f)][0x0]; else console[_0x45d5fe(0x297)](_0x45d5fe(0x840), _0x2e612e); } } async function _0x2a1b46(_0x1801e1) { const _0x4b0b7e = _0x187760, _0x54ef21 = _0x1801e1[_0x4b0b7e(0x65e)][_0x4b0b7e(0x523)][0x0]; if (!_0x54ef21 || !_0x54ef21[_0x4b0b7e(0xb15)]['toLowerCase']()[_0x4b0b7e(0x92f)](_0x4b0b7e(0x777))) { if (_0x4b0b7e(0x4ba) !== 'MIOJc') _0x4256e3[_0x4b0b7e(0x574)] = _0x4b0b7e(0x353); else { _0xeba69d(_0x4b0b7e(0xa56)); return; } } _0x195491(!![], _0x4b0b7e(0x89b)); try { _0x4b0b7e(0x8d1) !== _0x4b0b7e(0x8d1) ? _0xcd8c93[_0x4b0b7e(0x438)](_0xd8481) : (await _0x5b0aee(_0x4b0b7e(0x6d6), _0x54ef21), await _0x20677c(_0x54ef21), _0xeba69d(_0x4b0b7e(0x6b3))); } catch (_0x48222d) { _0xeba69d('字体保存失败了，哼:\x20' + _0x48222d['message']); } finally { _0x195491(![]), _0x2d7a96[_0x4b0b7e(0xa03)] = ''; } } async function _0x4f08d4() { const _0x2e802f = _0x187760, _0x12c822 = await _0x5db04d(_0x2e802f(0x51c)); if (_0x12c822) try { await _0x104dbe(_0x2e802f(0x6d6)), _0x46c666['innerHTML'] = '', document[_0x2e802f(0x204)][_0x2e802f(0x80f)]['removeProperty'](_0x2e802f(0x31e)), _0x503514[_0x2e802f(0x574)] = _0x2e802f(0x3b4), _0xeba69d('已恢复默认字体。'); } catch (_0x4e8c01) { if ('EVtrQ' !== _0x2e802f(0x307)) { const _0x358b2e = _0xa6bc7a['target'][_0x2e802f(0x2f7)]['id']; _0x7704cb(_0x2e802f(0x33f))[_0x2e802f(0x276)](_0x29c07a => { _0x29c07a && _0x133e9a(_0x358b2e); }); } else _0xeba69d(_0x2e802f(0x983) + _0x4e8c01[_0x2e802f(0x997)]); } } function _0x2dc45a() { const _0x19f6c9 = _0x187760; if (_0x19f6c9(0xb1f) === _0x19f6c9(0xb1f)) { const _0x3effc0 = document[_0x19f6c9(0x759)](_0x19f6c9(0x945)); if (!_0x3effc0) return; const _0x4f0c10 = localStorage[_0x19f6c9(0x860)](_0x19f6c9(0x3da)) || '35'; document[_0x19f6c9(0x204)][_0x19f6c9(0x80f)]['setProperty']('--primary-hue', _0x4f0c10), _0x3effc0[_0x19f6c9(0xa03)] = _0x4f0c10, _0x3effc0[_0x19f6c9(0x6cc)](_0x19f6c9(0x3cb), () => { const _0x5c74d4 = _0x19f6c9, _0xc41e12 = _0x3effc0['value']; document[_0x5c74d4(0x204)][_0x5c74d4(0x80f)]['setProperty'](_0x5c74d4(0x726), _0xc41e12), localStorage[_0x5c74d4(0x2f5)](_0x5c74d4(0x3da), _0xc41e12), _0x3593cc(); }); } else { if (_0x573116 === null) return; const _0x94c325 = _0x35b0f4[_0x19f6c9(0xa85)][_0x3ce211]; if (!_0x94c325) return; const _0x3cc30f = _0x2e993a(); let _0x39b658 = '未知'; if (_0x94c325[_0x19f6c9(0x456)] === _0x19f6c9(0x544)) _0x39b658 = _0x5c6a7f[_0x19f6c9(0xa77)][_0x19f6c9(0xb15)] || '我'; else { const _0x3a4ce2 = _0x94c325[_0x19f6c9(0x616)] || _0x3cc30f?.[_0x19f6c9(0x9be)][0x0], _0x17e78b = _0x867c41(_0x3a4ce2); _0x39b658 = _0x17e78b ? _0x17e78b[_0x19f6c9(0xb15)] : '角色'; } let _0x134c03 = _0x94c325['content'] || ''; if (_0x94c325['displayUrl']) _0x134c03 = _0x19f6c9(0x797); if (_0x94c325[_0x19f6c9(0x7ee)]) _0x134c03 = _0x19f6c9(0x9f7); if (_0x134c03['length'] > 0x32) _0x134c03 = _0x134c03[_0x19f6c9(0x6af)](0x0, 0x32) + '...'; _0x1d157d['activeQuote'] = { 'sender': _0x39b658, 'content': _0x134c03 }, _0x1ff9af(), _0x55b531(), _0x1cca60[_0x19f6c9(0x4ee)](); } } function _0x51a1f4() { const _0x502f1c = _0x187760, _0x5b4d19 = document[_0x502f1c(0x759)]('theme-lightness-slider'); if (!_0x5b4d19) return; const _0x3d2be8 = localStorage['getItem']('themeLightness') || '80'; document[_0x502f1c(0x204)][_0x502f1c(0x80f)][_0x502f1c(0x52c)]('--primary-lightness', _0x3d2be8 + '%'), _0x5b4d19['value'] = _0x3d2be8, _0x5b4d19[_0x502f1c(0x6cc)]('input', () => { const _0x32611a = _0x502f1c, _0xf43dda = _0x5b4d19['value']; document[_0x32611a(0x204)][_0x32611a(0x80f)][_0x32611a(0x52c)](_0x32611a(0x471), _0xf43dda + '%'), localStorage[_0x32611a(0x2f5)](_0x32611a(0x34a), _0xf43dda), _0x3593cc(); }); } function _0x3593cc() { const _0x328f2f = _0x187760, _0x1c9723 = document[_0x328f2f(0x759)](_0x328f2f(0x16f)); if (!_0x1c9723) return; _0x29b260[_0x328f2f(0xa2a)][_0x328f2f(0x9a0)] ? 'XITFk' === _0x328f2f(0x731) ? _0x3665ac = _0x4e3c64(() => { const _0x237874 = _0x328f2f; if (_0x860313[_0x237874(0x713)] === _0x237874(0x536)) _0x38f0f9['preventDefault'](); _0x368e37(_0x58352e); }, 0x320) : (_0x1c9723[_0x328f2f(0x80f)][_0x328f2f(0x39c)] = _0x328f2f(0x952), _0x1c9723[_0x328f2f(0x80f)][_0x328f2f(0x460)] = '0\x202px\x208px\x20rgba(0,0,0,0.4)') : (_0x1c9723['style'][_0x328f2f(0x39c)] = 'var(--text-color)', _0x1c9723[_0x328f2f(0x80f)][_0x328f2f(0x460)] = 'none'); } function _0x4dc80b() { const _0x524ed6 = _0x187760, _0xf4a4b6 = document[_0x524ed6(0x759)](_0x524ed6(0xb2c)); if (!_0xf4a4b6) return; _0xf4a4b6[_0x524ed6(0xacb)] = _0x29b260[_0x524ed6(0xa2a)]['forceWhiteClock'] || ![], _0xf4a4b6[_0x524ed6(0x6cc)](_0x524ed6(0x3c6), () => { const _0x4c4dc2 = _0x524ed6; _0x29b260[_0x4c4dc2(0xa2a)][_0x4c4dc2(0x9a0)] = _0xf4a4b6[_0x4c4dc2(0xacb)], _0xf10e4a(), _0x3593cc(); }); } _0x3c90fc[_0x187760(0x6cc)](_0x187760(0x7ec), _0x2b5357), _0x4addb7[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x4854d3 = _0x187760; _0x55cdaa(), _0x3f4f73[_0x4854d3(0x7ec)](); }), _0x3f4f73[_0x187760(0x6cc)](_0x187760(0x3c6), _0x150dba); const _0x429a11 = { 'home': document[_0x187760(0x759)](_0x187760(0x484)), 'chat': document[_0x187760(0x759)](_0x187760(0x490)), 'settings': document[_0x187760(0x759)](_0x187760(0x288)), 'userProfile': document['getElementById'](_0x187760(0x66b)), 'characterEdit': document['getElementById'](_0x187760(0x856)), 'groupChatCreate': document[_0x187760(0x759)](_0x187760(0x2c0)), 'wallpaper': document['getElementById'](_0x187760(0x17e)), 'worldBook': document[_0x187760(0x759)](_0x187760(0x4b5)), 'worldBookEditor': document['getElementById']('world-book-editor-screen'), 'groupSettings': document[_0x187760(0x759)]('group-settings-screen'), 'music': document[_0x187760(0x759)](_0x187760(0x87b)), 'friendCircleList': document[_0x187760(0x759)](_0x187760(0x455)), 'friendCircleEdit': document[_0x187760(0x759)](_0x187760(0x5f4)), 'meetingList': document[_0x187760(0x759)](_0x187760(0x3c8)), 'meetingView': document[_0x187760(0x759)](_0x187760(0x70b)), 'userProfileList': document[_0x187760(0x759)](_0x187760(0x8af)), 'diaryList': document['getElementById'](_0x187760(0x5e6)), 'diaryView': document[_0x187760(0x759)](_0x187760(0xacc)), 'musicLibrary': document['getElementById'](_0x187760(0xa71)), 'musicUploadAltar': document[_0x187760(0x759)](_0x187760(0x9f5)), 'accounting': document[_0x187760(0x759)](_0x187760(0x938)), 'snoopList': document[_0x187760(0x759)](_0x187760(0x11e)), 'snoopPhone': document[_0x187760(0x759)](_0x187760(0xaa1)), 'calendar': document['getElementById'](_0x187760(0x4a5)) }, _0x22b7fc = document[_0x187760(0x759)]('upload-feed-bg-button'), _0x332250 = document[_0x187760(0x759)]('feed-bg-input'), _0x14d3de = document[_0x187760(0x759)](_0x187760(0x9cf)), _0xf6f048 = document[_0x187760(0x759)](_0x187760(0x714)), _0x120b22 = document['getElementById']('app-world-book'), _0xc08268 = document[_0x187760(0x759)]('back-to-home-from-wallpaper'), _0x205ca3 = document[_0x187760(0x759)](_0x187760(0x30f)), _0x52a652 = document[_0x187760(0x759)](_0x187760(0xb13)); document[_0x187760(0x759)](_0x187760(0xaf1))[_0x187760(0x6cc)](_0x187760(0x7ec), async () => { const _0x55f4ed = _0x187760, _0x16bafb = await _0x5db04d(_0x55f4ed(0x3d4)); if (_0x16bafb) { if (_0x55f4ed(0x6ce) === _0x55f4ed(0x6ce)) { localStorage[_0x55f4ed(0x4d2)](_0x55f4ed(0x2a1)), localStorage[_0x55f4ed(0x4d2)](_0x55f4ed(0x632)), localStorage[_0x55f4ed(0x4d2)](_0x55f4ed(0x80a)), localStorage[_0x55f4ed(0x4d2)](_0x55f4ed(0x694)); const _0x607bfc = []; for (let _0x59ae22 = 0x0; _0x59ae22 < localStorage[_0x55f4ed(0x919)]; _0x59ae22++) { if (_0x55f4ed(0x7d8) === _0x55f4ed(0x7d8)) { const _0x296a24 = localStorage[_0x55f4ed(0x251)](_0x59ae22); _0x296a24 && _0x296a24['startsWith'](_0x55f4ed(0x4a4)) && _0x607bfc[_0x55f4ed(0x438)](_0x296a24); } else { _0x57b565[_0x55f4ed(0x297)](_0x55f4ed(0x1ec)); return; } } _0x607bfc[_0x55f4ed(0xa3d)](_0x318bef => localStorage['removeItem'](_0x318bef)), await _0x5b0aee(_0x55f4ed(0x38b), await _0xd3e742(_0x55f4ed(0x6e5))), _0xeba69d(_0x55f4ed(0x9e6)), setTimeout(() => location[_0x55f4ed(0x1a8)](), 0x5dc); } else _0x449221[_0x55f4ed(0x80f)][_0x55f4ed(0x3e7)] = _0x55f4ed(0x697), _0x66ba11[_0x55f4ed(0x80f)]['display'] = _0x55f4ed(0x210); } }); const _0x72ef9 = document['getElementById'](_0x187760(0x160)), _0x37bd48 = document[_0x187760(0x759)](_0x187760(0x960)), _0x1de01e = document[_0x187760(0x759)](_0x187760(0xb10)), _0x36bb89 = document[_0x187760(0x759)](_0x187760(0x1d5)), _0x586717 = document[_0x187760(0x759)](_0x187760(0x54a)), _0x544086 = document[_0x187760(0x759)](_0x187760(0x949)), _0x3361bf = document[_0x187760(0x759)](_0x187760(0x4fb)), _0x331d2e = document[_0x187760(0x759)]('group-chat-name'), _0x4185e1 = document[_0x187760(0x759)](_0x187760(0x1d9)), _0x123104 = document[_0x187760(0x759)]('app-chat'), _0x2143ee = document['getElementById'](_0x187760(0x87c)), _0x233fde = document['getElementById'](_0x187760(0x98d)), _0x2c9e0e = document[_0x187760(0x759)](_0x187760(0x84a)), _0x484d1f = document[_0x187760(0x759)](_0x187760(0x240)), _0x4b32d5 = document[_0x187760(0x759)](_0x187760(0x5bc)), _0x389aab = document['getElementById'](_0x187760(0x9d6)), _0x3ef5be = document[_0x187760(0x759)](_0x187760(0xab8)), _0x2b5e35 = document[_0x187760(0x759)](_0x187760(0x77f)), _0x475eb3 = document[_0x187760(0x759)](_0x187760(0x490)), _0x41a1da = document[_0x187760(0x759)]('chat-messages'), _0x3da0ef = document[_0x187760(0x759)](_0x187760(0x8aa)), _0x256bad = document[_0x187760(0x759)]('chat-send-button'), _0x35d548 = document[_0x187760(0x759)](_0x187760(0x733)), _0x1c0b1d = document['getElementById']('quote-preview-area'), _0x1f9a61 = document[_0x187760(0x759)](_0x187760(0xafb)), _0x456a32 = document[_0x187760(0x759)]('quote-preview-text'), _0x232be1 = document[_0x187760(0x759)](_0x187760(0x3ad)), _0x3e9111 = document[_0x187760(0x759)](_0x187760(0x51d)), _0x32ced9 = document['getElementById'](_0x187760(0x6d3)), _0x2d1d45 = document['getElementById']('chat-sticker-panel'), _0x4e04c6 = document['getElementById'](_0x187760(0x744)), _0x4bedb5 = document['getElementById'](_0x187760(0x1b4)), _0x2d7e43 = document[_0x187760(0x759)](_0x187760(0x136)), _0x2986a4 = document[_0x187760(0x759)](_0x187760(0x69e)), _0x65d35 = document['getElementById'](_0x187760(0x129)), _0x4b6fa5 = document[_0x187760(0x759)](_0x187760(0x3b0)), _0x23c208 = document[_0x187760(0x759)](_0x187760(0x6fa)), _0x1d9054 = document[_0x187760(0x759)]('save-api-settings-button'), _0xea9089 = document[_0x187760(0x759)](_0x187760(0x5ef)), _0x5edc33 = document['getElementById'](_0x187760(0x5f8)), _0x1f9ff6 = document[_0x187760(0x759)]('context-lines-per-chat'), _0x1874b1 = document['getElementById'](_0x187760(0x4bd)), _0x3bb42d = document[_0x187760(0x759)](_0x187760(0x894)), _0x5682c0 = document[_0x187760(0x759)](_0x187760(0x5a2)), _0x15bd3b = document['getElementById'](_0x187760(0x309)), _0xbb9757 = document[_0x187760(0x759)]('save-user-profile-button'), _0x2f40df = document['getElementById'](_0x187760(0x390)), _0x485a73 = document[_0x187760(0x759)]('character-edit-title'), _0x1d841e = document[_0x187760(0x759)](_0x187760(0x642)), _0x1c3727 = document[_0x187760(0x759)]('char-edit-remark'), _0x509d18 = document['getElementById']('char-edit-avatar-preview'), _0x315e49 = document[_0x187760(0x759)](_0x187760(0xb17)), _0x359364 = document[_0x187760(0x759)](_0x187760(0x78d)), _0x174e96 = document[_0x187760(0x759)](_0x187760(0x9dd)), _0x49783d = document['getElementById'](_0x187760(0xaca)), _0x287a34 = document[_0x187760(0x759)](_0x187760(0x127)); let _0x2399bc = null; const _0x523c1b = _0x187760(0xabf), _0x187e7a = _0x187760(0x3c7); _0x29b260 = { 'characters': [], 'worldBooks': [], 'chats': [], 'userProfiles': [], 'activeUserProfileId': null, 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'widgetBgImage': null, 'perChatContextLines': 0x64, 'forceWhiteClock': ![] }, 'activeChatId': null, 'activeMeetingCharId': null, 'isGenerating': ![], 'currentAbortController': null, 'pendingMessageTimers': [], 'conversationHistory': [], 'displayedMessageCount': 0x64, 'activeQuote': null, 'friendCircles': [], 'activeFriendCircleId': null, 'calendarEvents': [], 'accountingData': [], 'accountingLedger': {}, 'diaries': [], 'activeDiaryCharacterId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'meetingViewMode': _0x187760(0x512), 'activeMeetingScriptQueue': [], 'characterLastScripts': {}, 'musicPlaylist': [], 'currentlyPlayingIndex': -0x1, 'isPlaying': ![], 'pendingPostAttachments': { 'image': null, 'music': null } }; function _0xf10e4a() { const _0x5ea008 = _0x187760; if (_0x5ea008(0xb00) === _0x5ea008(0xa1f)) _0x327442['value'] = _0x347dc3, _0x521061[_0x5ea008(0x969)][_0x5ea008(0x41a)]('show'); else try { const _0x2de475 = { 'version': 0x1, 'characters': _0x29b260[_0x5ea008(0x3db)], 'worldBooks': _0x29b260[_0x5ea008(0x1a1)], 'chats': _0x29b260[_0x5ea008(0x6df)], 'apiSettings': _0x29b260[_0x5ea008(0x7d3)], 'preferences': _0x29b260[_0x5ea008(0xa2a)], 'activeChatId': _0x29b260[_0x5ea008(0x7b1)], 'diaries': _0x29b260[_0x5ea008(0x94d)], 'friendCircles': _0x29b260[_0x5ea008(0x123)], 'activeFriendCircleId': _0x29b260[_0x5ea008(0x439)], 'userProfiles': _0x29b260[_0x5ea008(0x44f)], 'activeUserProfileId': _0x29b260[_0x5ea008(0x113)], 'accountingData': _0x29b260[_0x5ea008(0x7b0)], 'accountingLedger': _0x29b260[_0x5ea008(0x72a)], 'calendarEvents': _0x29b260['calendarEvents'] }; localStorage[_0x5ea008(0x2f5)](_0x5ea008(0x392), JSON[_0x5ea008(0x2a5)](_0x2de475)); } catch (_0x25c585) { console[_0x5ea008(0x297)](_0x5ea008(0x6f0), _0x25c585), _0xeba69d('无法保存状态，浏览器可能禁用了存储功能。'); } } function _0x222b7b() { const _0x12fea0 = _0x187760; if (_0x12fea0(0x5ea) !== 'SLJOv') _0xb85ad7(_0x12fea0(0x8c2) + _0x41d9ae[_0x12fea0(0x63b)]('\x0a')); else { let _0x46cf5d = null; try { _0x12fea0(0x9d2) !== 'lxPcC' ? _0x46cf5d = localStorage[_0x12fea0(0x860)]('appState') : (_0x22b837[_0x12fea0(0x574)] = _0x5c03bd[_0x12fea0(0x80b)](_0x12fea0(0x513), { 'hour': _0x12fea0(0x4ca), 'minute': _0x12fea0(0x4ca), 'hour12': ![] }), _0x86e2c3[_0x12fea0(0x574)] = _0x142c84[_0x12fea0(0x7c8)]('zh-CN', { 'month': 'long', 'day': _0x12fea0(0x322), 'weekday': 'long' })); } catch (_0x5022c3) { _0x12fea0(0x67f) === 'Epnkm' ? _0x230496[_0x12fea0(0x19f)] = _0x3293b1['scrollHeight'] : console[_0x12fea0(0x297)](_0x12fea0(0x19d), _0x5022c3); } if (_0x46cf5d) try { if (_0x12fea0(0x175) === _0x12fea0(0x175)) { const _0x13d358 = JSON[_0x12fea0(0x1db)](_0x46cf5d), _0x1c8b68 = _0x13d358['version'] || 0x0; if (_0x1c8b68 < 0x1) { console[_0x12fea0(0xa05)]('检测到旧版存档，正在自动升级...'); const _0x4307b6 = { 'version': 0x1, 'characters': [], 'worldBooks': [], 'chats': [], 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'perChatContextLines': 0x64, 'widgetBgImage': null, 'forceWhiteClock': ![] }, 'activeChatId': null, 'friendCircles': [], 'activeFriendCircleId': null, 'diaries': [], 'userProfiles': [], 'activeUserProfileId': null, 'accountingData': [], 'accountingLedger': {}, 'calendarEvents': [] }; if (Array[_0x12fea0(0xac4)](_0x13d358[_0x12fea0(0x3db)])) _0x4307b6['characters'] = _0x13d358[_0x12fea0(0x3db)]; if (Array[_0x12fea0(0xac4)](_0x13d358[_0x12fea0(0x1a1)])) _0x4307b6[_0x12fea0(0x1a1)] = _0x13d358[_0x12fea0(0x1a1)]; if (Array['isArray'](_0x13d358['chats'])) _0x4307b6[_0x12fea0(0x6df)] = _0x13d358['chats']; if (_0x13d358[_0x12fea0(0x7d3)]) _0x4307b6[_0x12fea0(0x7d3)] = _0x13d358[_0x12fea0(0x7d3)]; if (_0x13d358[_0x12fea0(0xa2a)]) _0x4307b6[_0x12fea0(0xa2a)] = { ..._0x4307b6[_0x12fea0(0xa2a)], ..._0x13d358[_0x12fea0(0xa2a)] }; if (_0x13d358[_0x12fea0(0x7b1)]) _0x4307b6[_0x12fea0(0x7b1)] = _0x13d358[_0x12fea0(0x7b1)]; if (Array['isArray'](_0x13d358[_0x12fea0(0x94d)])) _0x4307b6['diaries'] = _0x13d358[_0x12fea0(0x94d)]; if (Array['isArray'](_0x13d358['friendCircles'])) _0x4307b6[_0x12fea0(0x123)] = _0x13d358[_0x12fea0(0x123)]; if (_0x13d358[_0x12fea0(0x439)]) _0x4307b6[_0x12fea0(0x439)] = _0x13d358[_0x12fea0(0x439)]; if (Array[_0x12fea0(0xac4)](_0x13d358[_0x12fea0(0x44f)])) _0x4307b6[_0x12fea0(0x44f)] = _0x13d358[_0x12fea0(0x44f)]; if (_0x13d358['activeUserProfileId']) _0x4307b6['activeUserProfileId'] = _0x13d358[_0x12fea0(0x113)]; if (Array[_0x12fea0(0xac4)](_0x13d358['accountingData'])) _0x4307b6[_0x12fea0(0x7b0)] = _0x13d358[_0x12fea0(0x7b0)]; if (_0x13d358[_0x12fea0(0x72a)]) _0x4307b6[_0x12fea0(0x72a)] = _0x13d358[_0x12fea0(0x72a)]; if (Array['isArray'](_0x13d358[_0x12fea0(0x901)])) _0x4307b6[_0x12fea0(0x901)] = _0x13d358[_0x12fea0(0x901)]; if (!_0x13d358[_0x12fea0(0x44f)] && _0x13d358[_0x12fea0(0xa77)]) { const _0x5caec5 = { 'id': _0x12fea0(0x97e) + Date[_0x12fea0(0x74c)](), 'name': _0x13d358[_0x12fea0(0xa77)][_0x12fea0(0xb15)] || '我', 'avatar': _0x13d358[_0x12fea0(0xa77)]['avatar'] || _0x2f94f8, 'persona': _0x13d358[_0x12fea0(0xa77)][_0x12fea0(0x435)] || '' }; _0x4307b6['userProfiles'] = [_0x5caec5], _0x4307b6[_0x12fea0(0x113)] = _0x5caec5['id']; } Object['assign'](_0x29b260, _0x4307b6), _0xf10e4a(), _0xeba69d(_0x12fea0(0x1c8)); } else Object[_0x12fea0(0x37b)](_0x29b260, _0x13d358); } else delete _0x5cb34e[_0x12fea0(0x433)], _0xf426e5(), _0x3f9957(_0x4e1349['id'], _0x12fea0(0x69b)), _0x4d9bfb('已恢复默认。'), _0x27947b(!![]); } catch (_0x18be22) { _0x12fea0(0x751) === _0x12fea0(0x154) ? _0x514a5d[_0x12fea0(0x113)] = _0x436118[_0x12fea0(0x44f)][0x0]['id'] : (console[_0x12fea0(0x297)](_0x12fea0(0x5f2), _0x18be22), localStorage[_0x12fea0(0x4d2)](_0x12fea0(0x392))); } const _0x217385 = _0x29b260[_0x12fea0(0x3db)][_0x12fea0(0x919)] === 0x0; return !_0x29b260['chats'][_0x12fea0(0x444)](_0x17209e => _0x17209e['id'] === _0x29b260['activeChatId']) && (_0x29b260[_0x12fea0(0x7b1)] = _0x29b260[_0x12fea0(0x6df)][0x0]?.['id'] || null), _0x217385; } } function _0x3254df() { const _0xd75830 = _0x187760; if (_0xd75830(0x6bf) !== _0xd75830(0x6bf)) { const _0x1ae4e6 = _0xebb9c6[_0xd75830(0xa93)]('div'); _0x1ae4e6['className'] = 'preview-item', _0x1ae4e6[_0xd75830(0x29c)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x4b3a32[_0xd75830(0x8ff)] || _0x1b160b) + _0xd75830(0x1bb) + _0x37ad45['songName'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>' + _0x2f5552[_0xd75830(0x6cd)] + _0xd75830(0x4f4), _0x1ae4e6[_0xd75830(0xa01)](_0xd75830(0xae3))[_0xd75830(0x356)] = () => _0x243794(_0xd75830(0xa7c)), _0x444bf3[_0xd75830(0x25f)](_0x1ae4e6); } else { if (!_0x29b260['activeChatId']) return; try { if (_0xd75830(0x348) === _0xd75830(0xa75)) { let _0x567e0c = _0x1f5e25[_0xd75830(0x759)](_0xd75830(0x82c) + _0x533e9e['id']); !_0x567e0c && (_0x567e0c = _0x22dbe9[_0xd75830(0xa93)]('style'), _0x567e0c['id'] = _0xd75830(0x82c) + _0x5de2b7['id'], _0x3eecb0[_0xd75830(0x7c9)]['appendChild'](_0x567e0c)); const _0x5319aa = _0x5029ae[_0xd75830(0xa5e)], _0x5b28de = _0x5319aa['replace'](/\.bubble\.sent/g, '.bubble-' + _0x329e48['id'] + '.message.user')[_0xd75830(0x998)](/\.bubble\.received/g, _0xd75830(0x987) + _0x549847['id'] + '.message.ai'); _0x567e0c[_0xd75830(0x29c)] = _0x5b28de; } else localStorage[_0xd75830(0x2f5)](_0xd75830(0x4a9) + _0x29b260[_0xd75830(0x7b1)], JSON[_0xd75830(0x2a5)](_0x29b260[_0xd75830(0xa85)])); } catch (_0x24e099) { if (_0xd75830(0x84b) !== _0xd75830(0x337)) console[_0xd75830(0x297)](_0xd75830(0x7eb), _0x24e099), _0xeba69d(_0xd75830(0x82e)); else { const _0x12e232 = _0x3e8096[_0xd75830(0x759)](_0xd75830(0x7a0)), _0x22ebcd = _0x1d766f[_0xd75830(0x759)](_0xd75830(0x506)), _0x5d4c70 = _0x5da164[_0xd75830(0x759)](_0xd75830(0xa73)), _0x3212f = _0x32dde6[_0xd75830(0x759)]('modal-cancel'), _0x2ea1d0 = _0x3aa89f[_0xd75830(0x759)]('modal-mask'); _0x22ebcd[_0xd75830(0x574)] = _0x4577d3, _0x12e232[_0xd75830(0x80f)]['display'] = _0xd75830(0x868); const _0x28943a = _0x197b1b => { const _0x58326b = _0xd75830; _0x12e232[_0x58326b(0x80f)][_0x58326b(0x3e7)] = _0x58326b(0x697), _0x5d4c70[_0x58326b(0x356)] = _0x3212f[_0x58326b(0x356)] = _0x2ea1d0[_0x58326b(0x356)] = null, _0x338e8a['removeEventListener'](_0x58326b(0xa53), _0x497dbd), _0x50b497(_0x197b1b); }, _0x497dbd = _0x29881e => { const _0x161847 = _0xd75830; if (_0x29881e[_0x161847(0x251)] === _0x161847(0x14f)) _0x28943a(![]); if (_0x29881e[_0x161847(0x251)] === _0x161847(0x674)) _0x28943a(!![]); }; _0x5d4c70[_0xd75830(0x356)] = () => _0x28943a(!![]), _0x3212f[_0xd75830(0x356)] = () => _0x28943a(![]), _0x2ea1d0[_0xd75830(0x356)] = () => _0x28943a(![]), _0x4bc0d0[_0xd75830(0x6cc)](_0xd75830(0xa53), _0x497dbd); } } } } function _0x32657d() { const _0x326855 = _0x187760; if (_0x326855(0x9b3) === _0x326855(0x821)) _0x2aadb(_0x326855(0x758))[_0x326855(0x276)](_0x299088 => { const _0x32b69e = _0x326855; if (_0x299088) { const _0x5a377c = _0x45a43a(_0x4bab21[_0x32b69e(0x49a)]); _0x5a377c && (delete _0x5a377c['spriteTransform'], _0x1dd4ab(), _0x39a88a(_0x5a377c['id'], 'normal'), _0x218583('已恢复默认。'), _0x32a4ff(!![])); } }); else { if (!_0x29b260[_0x326855(0x7b1)]) { _0x29b260[_0x326855(0xa85)] = [], _0x448e33(); return; } let _0x4ab93b = null; try { _0x4ab93b = localStorage['getItem'](_0x326855(0x4a9) + _0x29b260[_0x326855(0x7b1)]); } catch (_0x3fc2de) { _0x326855(0x386) === _0x326855(0x386) ? console[_0x326855(0x297)]('Failed\x20to\x20read\x20history\x20for\x20chat\x20' + _0x29b260[_0x326855(0x7b1)], _0x3fc2de) : (_0x15a061(![]), _0x4c482d[_0x326855(0x27c)] = ![]); } let _0x43a7c5 = []; if (_0x4ab93b) try { if (_0x326855(0x341) === _0x326855(0x341)) { const _0x2d1261 = JSON[_0x326855(0x1db)](_0x4ab93b); Array['isArray'](_0x2d1261) && (_0x43a7c5 = _0x2d1261[_0x326855(0x9f6)](_0x5a122c => _0x5a122c && typeof _0x5a122c === _0x326855(0x3fb) && typeof _0x5a122c[_0x326855(0x456)] === _0x326855(0x96c) && typeof _0x5a122c[_0x326855(0x359)] !== _0x326855(0x5fa))); } else _0x5373ab[_0x326855(0x515)] = _0x40ca66[_0x326855(0x113)]; } catch (_0x171d2a) { console[_0x326855(0x297)](_0x326855(0x9fb) + _0x29b260[_0x326855(0x7b1)] + _0x326855(0x451), _0x171d2a); try { localStorage[_0x326855(0x4d2)](_0x326855(0x4a9) + _0x29b260[_0x326855(0x7b1)]); } catch (_0x324d57) { console[_0x326855(0x297)](_0x326855(0x974), _0x324d57); } } _0x29b260[_0x326855(0xa85)] = _0x43a7c5, _0x41a1da[_0x326855(0x29c)] = '', _0x29b260[_0x326855(0xa85)] && (_0x326855(0x658) !== _0x326855(0xa4d) ? _0x29b260['conversationHistory'][_0x326855(0xa3d)]((_0x287eb9, _0x1574bc) => _0x3a1b12(_0x287eb9, _0x1574bc)) : _0x4d1d52[_0x326855(0x80f)][_0x326855(0xad6)] = _0x326855(0x22e) + _0xb8a587 + '\x27)'), setTimeout(() => { const _0x5e9fd7 = _0x326855; _0x5e9fd7(0x3fe) !== _0x5e9fd7(0x583) ? _0x41a1da['scrollTop'] = _0x41a1da['scrollHeight'] : _0x451b51 === _0x5e9fd7(0x83c) ? _0x54ba04['style'][_0x5e9fd7(0x3e7)] = _0x5e9fd7(0x47b) : _0x3c2b69[_0x5e9fd7(0x80f)][_0x5e9fd7(0x3e7)] = _0x5e9fd7(0x697); }, 0x0); } } async function _0x3a0fb2() { const _0x332fe6 = _0x187760, _0x31fef1 = document['getElementById'](_0x332fe6(0x484)); if (!_0x31fef1) { if (_0x332fe6(0x57b) === 'Ibrpp') { const _0x554f74 = { 'id': _0x332fe6(0x853) + _0x4313bb[_0x332fe6(0x74c)]() + '_' + _0x117fd3[_0x332fe6(0x545)](), 'name': _0x355225['name'], 'content': _0x10723a[_0x332fe6(0x359)] }; _0x3f30da['worldBooks']['push'](_0x554f74), _0x2136cf[_0x332fe6(0x438)](_0x554f74['id']); } else { console[_0x332fe6(0x297)](_0x332fe6(0x510)); return; } } try { if (_0x332fe6(0xa5b) === 'FsrHb') { const _0x3b479d = new _0x4ac5e7(_0x5ae98b[_0x332fe6(0x6de)]); _0x2e85cd += _0x332fe6(0x2fc) + _0x18e62c[_0x332fe6(0xb15)] + _0x332fe6(0x2ae) + _0x50ef1b(_0x3b479d) + '\x0a'; const _0x410938 = _0x28c2b9[_0x332fe6(0x9a6)]() === _0x3b479d['toDateString'](), _0x4a9adb = new _0x296f5c(); _0x4a9adb['setDate'](_0x5cf8a3['getDate']() - 0x1); const _0x4df5f2 = _0x4a9adb['toDateString']() === _0x3b479d['toDateString'](); if (_0x410938) _0x3e2d28 += '-\x20**状态提示**:\x20你们今天刚聊过，请自然地衔接对话。\x0a'; else _0x4df5f2 ? _0x524789 += _0x332fe6(0x141) : _0x70f602 += _0x332fe6(0x959); } else { let _0x19b5de = await _0x2e6c7a(_0x332fe6(0x38b)); if (!_0x19b5de) { if (_0x332fe6(0x427) === _0x332fe6(0x17c)) _0x3ed217['classList']['remove'](_0x332fe6(0x459)); else { const _0x39a0e3 = localStorage[_0x332fe6(0x860)]('customWallpaper'); _0x39a0e3 && (console['log'](_0x332fe6(0x425)), _0x19b5de = await _0xd3e742(_0x39a0e3), await _0x5b0aee(_0x332fe6(0x38b), _0x19b5de), localStorage[_0x332fe6(0x4d2)](_0x332fe6(0x55e))); } } _0x19b5de ? (_0x31fef1['style']['backgroundImage'] = 'url(' + URL[_0x332fe6(0x289)](_0x19b5de) + ')', _0x31fef1[_0x332fe6(0x80f)]['backgroundSize'] = 'cover', _0x31fef1[_0x332fe6(0x80f)][_0x332fe6(0x9d5)] = _0x332fe6(0x37e)) : _0x31fef1[_0x332fe6(0x80f)][_0x332fe6(0xad6)] = ''; } } catch (_0x2a6146) { if ('BaDMJ' === _0x332fe6(0x67d)) console[_0x332fe6(0x297)](_0x332fe6(0x956), _0x2a6146), _0x31fef1 && (_0x31fef1[_0x332fe6(0x80f)][_0x332fe6(0xad6)] = ''); else { const _0x3e368a = _0x3fba2e[_0x332fe6(0x5c7)][_0x332fe6(0xb29)](), _0x587490 = _0x5b06dc[_0x332fe6(0x5c7)][_0x332fe6(0x950)](); _0x38f08e[_0x332fe6(0x759)](_0x332fe6(0x3b2))['textContent'] = _0x3e368a + '年\x20' + (_0x587490 + 0x1) + '月', _0x5ad77d(_0x3e368a, _0x587490), _0x52aade(_0x251303[_0x332fe6(0x29f)]); } } } function _0x238ab8() { const _0x408d79 = _0x187760, _0x9052c0 = localStorage[_0x408d79(0x860)](_0x408d79(0x173)); if (_0x9052c0) { if (_0x408d79(0x285) === 'qvejd') { if (_0x311906['key'] === _0x408d79(0x14f)) _0x293ede(null); _0x514afd[_0x408d79(0x251)] === _0x408d79(0x674) && (_0x27e2ff[_0x408d79(0xac9)](), _0x4b1160()); } else document[_0x408d79(0x759)](_0x408d79(0x87b))[_0x408d79(0x80f)][_0x408d79(0x52c)](_0x408d79(0x6ae), 'url(' + _0x9052c0 + ')'); } else document[_0x408d79(0x759)](_0x408d79(0x87b))[_0x408d79(0x80f)][_0x408d79(0x52c)](_0x408d79(0x6ae), _0x408d79(0x697)); } async function _0x13e37e(_0x1bcc13) { const _0x1f8a8c = _0x187760; try { if (_0x1f8a8c(0xa66) === 'xQBxd') await _0x5b0aee(_0x1f8a8c(0x38b), _0x1bcc13), await _0x3a0fb2(), _0xeba69d(_0x1f8a8c(0x5b6)); else { const _0x1ced8b = _0x43ee6f[_0x1f8a8c(0x359)][_0x1f8a8c(0x6d2)](/：(.*?)]$/); _0x1a2438['content'] = _0x1f8a8c(0x43c) + (_0x1ced8b ? _0x1ced8b[0x1] : _0x1f8a8c(0x5c9)) + ']', _0x403943[_0x1f8a8c(0x438)](_0xde4c3d); } } catch (_0x281994) { console['error'](_0x1f8a8c(0x26b), _0x281994), _0xeba69d(_0x1f8a8c(0x845) + _0x281994['message']); } } function _0x4b2b82(_0xc682c5) { const _0x3cd007 = _0x187760, _0x373e65 = { 'quotedMessage': null, 'content': _0xc682c5 }, _0x433665 = _0xc682c5['match'](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x433665 && (_0x373e65[_0x3cd007(0x554)] = { 'sender': _0x433665[0x1][_0x3cd007(0x74e)](), 'content': _0x433665[0x2][_0x3cd007(0x74e)]() }, _0x373e65[_0x3cd007(0x359)] = _0xc682c5[_0x3cd007(0x6af)](_0x433665[0x0][_0x3cd007(0x919)])[_0x3cd007(0x74e)]()), _0x373e65; } const _0x447377 = document[_0x187760(0x759)]('message-action-modal'), _0x33be19 = document['getElementById'](_0x187760(0x4a2)), _0x1a12d3 = document['getElementById'](_0x187760(0x3d2)), _0x4ee375 = document['getElementById'](_0x187760(0xa92)), _0x58dcd3 = document[_0x187760(0x759)](_0x187760(0x922)), _0x118fed = document[_0x187760(0x759)]('quote-message-button'), _0x4b4818 = document[_0x187760(0x759)](_0x187760(0x454)), _0x9cdd06 = document['getElementById'](_0x187760(0x422)), _0x540ed4 = document[_0x187760(0x759)](_0x187760(0x5b7)), _0x905811 = document[_0x187760(0x759)]('save-edit-button'), _0x55c4d1 = document[_0x187760(0x759)](_0x187760(0x34b)); let _0x4ce882 = null; function _0x15b269(_0x1eceb3) { const _0x46303e = _0x187760; _0x4ce882 = _0x1eceb3, _0x447377[_0x46303e(0x969)][_0x46303e(0x944)](_0x46303e(0x459)); } function _0x28282d() { const _0x5d1c3a = _0x187760; if (_0x5d1c3a(0x701) !== 'zNVpO') try { const _0x1267bc = { 'version': 0x1, 'characters': _0x1c8f1f[_0x5d1c3a(0x3db)], 'worldBooks': _0x2a6dd2[_0x5d1c3a(0x1a1)], 'chats': _0x10eaa7[_0x5d1c3a(0x6df)], 'apiSettings': _0x3c4f02[_0x5d1c3a(0x7d3)], 'preferences': _0x58cfe7[_0x5d1c3a(0xa2a)], 'activeChatId': _0xf82704['activeChatId'], 'diaries': _0x12b830['diaries'], 'friendCircles': _0x1f97f7[_0x5d1c3a(0x123)], 'activeFriendCircleId': _0x4acffa[_0x5d1c3a(0x439)], 'userProfiles': _0x49ae2c[_0x5d1c3a(0x44f)], 'activeUserProfileId': _0xdd7c9e['activeUserProfileId'], 'accountingData': _0xe8803a[_0x5d1c3a(0x7b0)], 'accountingLedger': _0x7e8830[_0x5d1c3a(0x72a)], 'calendarEvents': _0x2096e2[_0x5d1c3a(0x901)] }; _0x1d540a[_0x5d1c3a(0x2f5)]('appState', _0x29fe90[_0x5d1c3a(0x2a5)](_0x1267bc)); } catch (_0x437fd7) { _0x423bc4['error'](_0x5d1c3a(0x6f0), _0x437fd7), _0x41ac2f(_0x5d1c3a(0x4aa)); } else _0x447377['classList'][_0x5d1c3a(0x41a)](_0x5d1c3a(0x459)); } function _0x273ce3() { _0x28282d(), _0x4ce882 = null; } function _0x4fae67() { const _0x4c99c8 = _0x187760; if (_0x4ce882 === null) return; _0x29b260['conversationHistory'][_0x4c99c8(0x903)](_0x4ce882, 0x1), _0x3254df(), _0x3cfad8(), _0x273ce3(); } function _0x5790e9() { const _0x4fdf93 = _0x187760; if (_0x4ce882 === null) return; const _0x253370 = _0x29b260[_0x4fdf93(0xa85)][_0x4ce882]; if (!_0x253370) return; _0x540ed4[_0x4fdf93(0xa03)] = _0x253370[_0x4fdf93(0x359)], _0x28282d(), _0x4b4818[_0x4fdf93(0x969)][_0x4fdf93(0x944)](_0x4fdf93(0x459)), _0x540ed4[_0x4fdf93(0x4ee)](); } function _0x3d3427() { const _0x5c5471 = _0x187760; if (_0x4ce882 === null) return; const _0x28695f = _0x540ed4['value'][_0x5c5471(0x74e)](); if (_0x28695f === '') { if (_0x5c5471(0x9c9) === 'epKQj') { _0x59948d(); return; } else { if (!_0x804169 || typeof _0x59be16 !== _0x5c5471(0x96c)) return null; const _0x3369c7 = _0x4684b0[_0x5c5471(0x8d5)]('['), _0x44d590 = _0x17f97c[_0x5c5471(0x9bf)](']'); if (_0x3369c7 > -0x1 && _0x44d590 > _0x3369c7) return _0x1b9876['substring'](_0x3369c7, _0x44d590 + 0x1); return null; } } const _0x1e8fb4 = _0x29b260[_0x5c5471(0xa85)][_0x4ce882]; _0x1e8fb4 && (_0x1e8fb4[_0x5c5471(0x359)] = _0x28695f, _0x3254df(), _0x3cfad8()), _0x4b4818[_0x5c5471(0x969)][_0x5c5471(0x41a)]('show'), _0x4ce882 = null; } function _0x59948d() { const _0x4c11d2 = _0x187760; _0x4b4818[_0x4c11d2(0x969)][_0x4c11d2(0x41a)]('show'), _0x4ce882 = null; } _0x33be19[_0x187760(0x6cc)](_0x187760(0x7ec), _0x273ce3), _0x58dcd3[_0x187760(0x6cc)](_0x187760(0x7ec), _0x273ce3), _0x4ee375['addEventListener']('click', _0x4fae67), _0x1a12d3[_0x187760(0x6cc)](_0x187760(0x7ec), _0x5790e9), _0x118fed['addEventListener'](_0x187760(0x7ec), _0x4deaf0), _0x232be1[_0x187760(0x6cc)](_0x187760(0x7ec), _0x24df82), _0x905811[_0x187760(0x6cc)](_0x187760(0x7ec), _0x3d3427), _0x55c4d1[_0x187760(0x6cc)](_0x187760(0x7ec), _0x59948d), _0x9cdd06[_0x187760(0x6cc)]('click', _0x59948d); function _0x4deaf0() { const _0x41168d = _0x187760; if (_0x4ce882 === null) return; const _0x1dc23c = _0x29b260[_0x41168d(0xa85)][_0x4ce882]; if (!_0x1dc23c) return; const _0x130e6d = _0xa7e551(); let _0x53b5f6 = '未知'; if (_0x1dc23c['role'] === _0x41168d(0x544)) _0x41168d(0xa70) === _0x41168d(0x66f) ? _0x1830bc[_0x41168d(0x686)] = _0x56fa4c ? _0x4133f3[_0x41168d(0x289)](_0x4c45ec) : _0x18178f : _0x53b5f6 = _0x29b260['userProfile'][_0x41168d(0xb15)] || '我'; else { const _0x4db694 = _0x1dc23c[_0x41168d(0x616)] || _0x130e6d?.[_0x41168d(0x9be)][0x0], _0x3b0c51 = _0x4cc875(_0x4db694); _0x53b5f6 = _0x3b0c51 ? _0x3b0c51[_0x41168d(0xb15)] : '角色'; } let _0x5af152 = _0x1dc23c['content'] || ''; if (_0x1dc23c[_0x41168d(0x96e)]) _0x5af152 = _0x41168d(0x797); if (_0x1dc23c['image']) _0x5af152 = _0x41168d(0x9f7); if (_0x5af152[_0x41168d(0x919)] > 0x32) _0x5af152 = _0x5af152[_0x41168d(0x6af)](0x0, 0x32) + '...'; _0x29b260[_0x41168d(0x7d9)] = { 'sender': _0x53b5f6, 'content': _0x5af152 }, _0x5811e5(), _0x273ce3(), _0x3da0ef[_0x41168d(0x4ee)](); } function _0x5811e5() { const _0x4b8ae0 = _0x187760; if (!_0x29b260[_0x4b8ae0(0x7d9)]) return; _0x1f9a61['textContent'] = _0x4b8ae0(0x5ec) + _0x29b260[_0x4b8ae0(0x7d9)]['sender'], _0x456a32[_0x4b8ae0(0x574)] = _0x29b260[_0x4b8ae0(0x7d9)]['content'], _0x1c0b1d[_0x4b8ae0(0x80f)]['display'] = _0x4b8ae0(0x210); } function _0x24df82() { const _0x41dfa1 = _0x187760; _0x29b260[_0x41dfa1(0x7d9)] = null, _0x1c0b1d[_0x41dfa1(0x80f)][_0x41dfa1(0x3e7)] = _0x41dfa1(0x697); } function _0x57a80a(_0x38eea8, _0x209718) { const _0x4f5266 = _0x187760, _0x31c194 = document[_0x4f5266(0x759)](_0x4f5266(0x1ed)); _0x31c194 && (_0x4f5266(0x7bc) === _0x4f5266(0x7bc) ? _0x38eea8 === _0x4f5266(0x83c) ? _0x31c194['style']['display'] = _0x4f5266(0x47b) : _0x31c194[_0x4f5266(0x80f)]['display'] = _0x4f5266(0x697) : (_0x597783(_0x4e535a[_0x4f5266(0xa03)]), _0x40e8b3())), _0x2399bc = _0x209718 || null, Object[_0x4f5266(0x9d9)](_0x429a11)[_0x4f5266(0xa3d)](_0x2b8ca1 => _0x2b8ca1[_0x4f5266(0x969)][_0x4f5266(0x41a)](_0x4f5266(0x691))), _0x429a11[_0x38eea8] && (_0x4f5266(0x786) !== _0x4f5266(0x786) ? (_0x4e4967['style']['opacity'] = 0x0, _0x5a9f4b(() => { const _0x3c619f = _0x4f5266; _0x430640[_0x3c619f(0x686)] = _0x1a1c12[_0x3c619f(0x289)](_0x6ecdb), _0x19045d[_0x3c619f(0x80f)][_0x3c619f(0xadd)] = 0x1; }, 0x96)) : _0x429a11[_0x38eea8]['classList']['add'](_0x4f5266(0x691))), _0x38eea8 !== _0x4f5266(0x6b7) && (_0x4f5266(0x2a6) === _0x4f5266(0x79e) ? _0x5d8358(![]) : _0x475eb3[_0x4f5266(0x969)]['remove'](_0x4f5266(0x644))); } function _0x47f45b(_0x53f8ab) { const _0x37542a = _0x187760; if (_0x53f8ab) { if (_0x37542a(0xaab) === _0x37542a(0xaab)) _0x475eb3['classList']['add']('show-chat-view'); else { _0x3fbdc8(_0x37542a(0x7d1)); return; } } else _0x37542a(0x74a) === _0x37542a(0x74a) ? _0x475eb3[_0x37542a(0x969)][_0x37542a(0x41a)](_0x37542a(0x644)) : _0x2db76f[_0x37542a(0x759)]('snoop-copy-summary-btn')[_0x37542a(0x6cc)](_0x37542a(0x7ec), () => { const _0x4f71d3 = _0x37542a, _0x7faa2d = _0x5a036d['getElementById'](_0x4f71d3(0x432)); _0x7faa2d['select'](), _0x37a333[_0x4f71d3(0x38c)](_0x4f71d3(0x989)), _0x439363(_0x4f71d3(0x265)); }); } async function _0x25cb93() { const _0x4eb6f2 = _0x187760; _0x3ef5be[_0x4eb6f2(0x29c)] = ''; for (const _0x10e318 of _0x29b260[_0x4eb6f2(0x6df)]) { const _0x20586a = document[_0x4eb6f2(0xa93)]('li'); _0x20586a[_0x4eb6f2(0x8bd)] = 'character-item', _0x20586a['dataset']['id'] = _0x10e318['id']; let _0x411575 = _0x461596, _0x331ded = '群聊', _0x50a4ed = ''; if (_0x10e318['type'] === _0x4eb6f2(0x7ad)) { const _0x4cfb8d = _0x4cc875(_0x10e318[_0x4eb6f2(0x9be)][0x0]); _0x4cfb8d ? (_0x411575 = _0x4cfb8d['avatar'] || _0x461596, _0x331ded = _0x4cfb8d['name'] || '未命名角色', _0x50a4ed = _0x4cfb8d['remark'] || '私聊') : (_0x331ded = _0x4eb6f2(0x2e9), _0x50a4ed = '错误：找不到角色'); } else { _0x331ded = _0x10e318[_0x4eb6f2(0xb15)] || _0x4eb6f2(0x9b0), _0x50a4ed = _0x10e318[_0x4eb6f2(0x9be)][_0x4eb6f2(0x919)] + _0x4eb6f2(0x312); const _0x4d9f93 = await _0x2e6c7a(_0x4eb6f2(0x656) + _0x10e318['id']); if (_0x4d9f93) _0x411575 = URL['createObjectURL'](_0x4d9f93); } _0x20586a[_0x4eb6f2(0x29c)] = _0x4eb6f2(0x12d) + _0x411575 + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x331ded + _0x4eb6f2(0x5cf) + _0x50a4ed + _0x4eb6f2(0x42f), _0x20586a[_0x4eb6f2(0xa01)]('.char-info-wrapper')[_0x4eb6f2(0x6cc)]('click', () => { _0x542653(_0x10e318['id']), _0x47f45b(!![]); }), _0x3ef5be[_0x4eb6f2(0x25f)](_0x20586a); } } function _0x24a12f() { const _0x1a7b75 = _0x187760, _0x513a0a = document[_0x1a7b75(0x759)](_0x1a7b75(0xa83)); _0x513a0a['innerHTML'] = ''; const _0x3c04eb = _0x29b260[_0x1a7b75(0x3db)][_0x1a7b75(0x9f6)](_0x18ea66 => _0x29b260[_0x1a7b75(0x6df)][_0x1a7b75(0x5f7)](_0x5dbe74 => _0x5dbe74[_0x1a7b75(0x713)] === _0x1a7b75(0x7ad) && _0x5dbe74[_0x1a7b75(0x9be)][_0x1a7b75(0x4da)](_0x18ea66['id']))); if (_0x3c04eb[_0x1a7b75(0x919)] === 0x0) { if (_0x1a7b75(0x340) !== _0x1a7b75(0x7a7)) { _0x513a0a['innerHTML'] = _0x1a7b75(0x26a); return; } else { _0x180ab3[_0x1a7b75(0xa05)]('好友圈档案柜是空的，无需净化。'); return; } } _0x3c04eb[_0x1a7b75(0xa3d)](_0x1598dc => { const _0x1059d7 = _0x1a7b75; if (_0x1059d7(0x8f9) !== _0x1059d7(0x8f9)) return _0xe06d87[_0x1059d7(0xa05)](_0x1059d7(0x2d0)), 0x0; else { const _0x4b1df1 = document[_0x1059d7(0xa93)]('li'); _0x4b1df1[_0x1059d7(0x8bd)] = _0x1059d7(0x34c), _0x4b1df1[_0x1059d7(0x2f7)][_0x1059d7(0x318)] = _0x1598dc['id'], _0x4b1df1[_0x1059d7(0x29c)] = _0x1059d7(0x9ab) + (_0x1598dc[_0x1059d7(0x96f)] || _0x461596) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x1598dc[_0x1059d7(0xb15)] + _0x1059d7(0x14d) + (_0x1598dc['remark'] || '私聊') + _0x1059d7(0x622), _0x4b1df1['addEventListener'](_0x1059d7(0x7ec), () => { _0x125969(_0x1598dc['id']); }), _0x513a0a[_0x1059d7(0x25f)](_0x4b1df1); } }); } async function _0x125969(_0x365660) { const _0x21f973 = _0x187760, _0x5987ac = _0x4cc875(_0x365660); if (!_0x5987ac) return; document[_0x21f973(0x759)](_0x21f973(0x7e0))['src'] = '', _0x29b260[_0x21f973(0x49a)] = _0x365660; const _0x153036 = _0x29b260['chats'][_0x21f973(0x444)](_0x3ea879 => _0x3ea879[_0x21f973(0x713)] === _0x21f973(0x7ad) && _0x3ea879['participantIds'][_0x21f973(0x4da)](_0x365660)); _0x153036 ? (_0x29b260[_0x21f973(0x7b1)] = _0x153036['id'], _0xf10e4a(), _0x32657d(), _0x17a6e0(_0x365660)) : _0x21f973(0x409) === _0x21f973(0x493) ? (_0x1b3941[_0x21f973(0x297)](_0x21f973(0x7a9), _0x151988), _0x463418 = _0xd7f63e) : _0x29b260[_0x21f973(0xa85)] = []; document[_0x21f973(0x759)](_0x21f973(0x3c4))[_0x21f973(0x574)] = _0x5987ac[_0x21f973(0xb15)]; const _0x132f1b = document[_0x21f973(0x759)](_0x21f973(0x4bb)); try { if ('RqHtX' !== _0x21f973(0x3ff)) { const _0x52095b = await _0x2e6c7a(_0x21f973(0x3d3) + _0x365660); if (_0x52095b) { if ('rHrVB' === _0x21f973(0x1bf)) { if (_0x33407d < 0x0 || _0x1c1c5e >= _0xc0af8c['length']) return; _0x5233c9 = _0x5ea538; const _0x1d4d24 = _0x1e0fae[_0x505fd9]; _0x34222a[_0x21f973(0x686)] = _0x1d4d24[_0x21f973(0x3e3)] || _0x1d4d24[_0x21f973(0x8b7)], _0x323a23[_0x21f973(0x5ca)](), _0x5aa27c(), _0x32207f(); } else _0x132f1b['style'][_0x21f973(0xad6)] = 'url(\x27' + URL['createObjectURL'](_0x52095b) + '\x27)', _0x132f1b[_0x21f973(0x80f)][_0x21f973(0xb0d)] = 'cover', _0x132f1b[_0x21f973(0x80f)][_0x21f973(0x9d5)] = 'center'; } else { if (_0x21f973(0x689) === _0x21f973(0x524)) { if (_0x24504e[_0x21f973(0xac4)](_0x3b7e00) && _0x4295ac['isArray'](_0x361dfa)) { const _0x1ab395 = _0xba66d2[_0x21f973(0x4a7)](_0x1686d9); _0x266f67 = _0x5b740a['stringify'](_0x1ab395), _0x3c8ee5[_0x21f973(0xa05)](_0x21f973(0x893)); } else _0x8e539b = _0xf8a5b2['stringify'](_0xda17a4); } else _0x132f1b['style'][_0x21f973(0xad6)] = 'none'; } } else { const _0x31afe6 = new _0x1eb8b8(); _0x31afe6[_0x21f973(0x890)] = () => _0x37ee4f(_0x31afe6[_0x21f973(0x563)]), _0x31afe6[_0x21f973(0x634)] = _0x23f3a1, _0x31afe6[_0x21f973(0x855)](_0x702cbc); } } catch (_0x557a4e) { console[_0x21f973(0x297)](_0x21f973(0x610) + _0x365660 + ':', _0x557a4e), _0x132f1b['style'][_0x21f973(0xad6)] = 'none'; } _0x3f6d23(), _0x2c4ed0(); if (_0x32537a) clearInterval(_0x32537a); _0x542e67(), _0x32537a = setInterval(_0x542e67, 0x2710), document[_0x21f973(0x759)](_0x21f973(0xa15))[_0x21f973(0x80f)]['display'] = 'block', _0x57a80a(_0x21f973(0x91d), 'meetingList'); } function _0x2c4ed0() { const _0x179900 = _0x187760, _0xf3fa66 = document[_0x179900(0x759)](_0x179900(0x29d)); _0xf3fa66['innerHTML'] = ''; const _0x1bbcd4 = _0xf3fa66[_0x179900(0xa01)](_0x179900(0x92b)); if (_0x1bbcd4) _0x1bbcd4[_0x179900(0x41a)](); _0x29b260[_0x179900(0xa85)] && _0x29b260[_0x179900(0xa85)][_0x179900(0xa3d)]((_0x549a14, _0x45f929) => { const _0x31cfcb = _0x179900; if (!_0x549a14[_0x31cfcb(0x683)] || _0x549a14[_0x31cfcb(0x456)] === _0x31cfcb(0x4c2)) return; const _0x32dd6b = document[_0x31cfcb(0xa93)]('p'); _0x32dd6b[_0x31cfcb(0x2f7)]['historyIndex'] = _0x45f929; const _0xa19ab8 = _0x549a14['content']['replace'](/\n/g, _0x31cfcb(0x7ab)); let _0x47b5b6 = '', _0x1f826d = ''; const _0x2b76da = _0x33ec75(_0x29b260['activeChatId']); if (_0x549a14[_0x31cfcb(0x456)] === 'user') _0x47b5b6 = _0x2b76da['name'] || '我', _0x1f826d = 'speaker-user'; else { if (_0x549a14['role'] === _0x31cfcb(0x863)) { if (_0x31cfcb(0x63e) === 'PCzHn') { const _0x61f292 = _0x4cc875(_0x549a14['senderId'] || _0x29b260[_0x31cfcb(0x49a)]); _0x47b5b6 = _0x61f292?.[_0x31cfcb(0xb15)] || '角色', _0x1f826d = 'speaker-ai'; } else _0x1507c7[_0x31cfcb(0x80f)][_0x31cfcb(0xad6)] = _0x31cfcb(0x22e) + _0x2ec3b9 + '\x27)'; } } _0x32dd6b[_0x31cfcb(0x80f)]['backgroundColor'] = _0x31cfcb(0x599), _0x32dd6b['style']['padding'] = '15px\x2020px', _0x32dd6b[_0x31cfcb(0x80f)][_0x31cfcb(0x526)] = _0x31cfcb(0xa19), _0x32dd6b[_0x31cfcb(0x80f)][_0x31cfcb(0x724)] = _0x31cfcb(0x7fc), _0x47b5b6 ? _0x31cfcb(0x19e) !== _0x31cfcb(0x87f) ? _0x32dd6b[_0x31cfcb(0x29c)] = '<span\x20class=\x22' + _0x1f826d + _0x31cfcb(0x448) + (_0x1f826d === _0x31cfcb(0xa67) ? _0x31cfcb(0x90b) : _0x31cfcb(0x169)) + _0x31cfcb(0x9bc) + _0x47b5b6 + _0x31cfcb(0x2e8) + _0xa19ab8 : _0x17dd67(_0x31cfcb(0x912) + _0x8ef252['message']) : (_0x32dd6b[_0x31cfcb(0x8bd)] = 'narrator', _0x32dd6b['style']['fontStyle'] = _0x31cfcb(0x60e), _0x32dd6b[_0x31cfcb(0x80f)][_0x31cfcb(0x39c)] = _0x31cfcb(0x130), _0x32dd6b[_0x31cfcb(0x29c)] = _0xa19ab8), _0xf3fa66['appendChild'](_0x32dd6b); }); if (_0x29b260[_0x179900(0x27c)]) { if (_0x179900(0x241) === _0x179900(0x241)) { let _0x168e07 = _0xf3fa66[_0x179900(0xa01)]('.typing-indicator'); !_0x168e07 && (_0x179900(0xb2d) !== _0x179900(0xb2d) ? _0x3c97d8[_0x179900(0x438)](_0x27f93e[_0x179900(0x1f9)](_0x16e18d, _0x4d9d92 + _0x8aa6b8)) : (_0x168e07 = document[_0x179900(0xa93)](_0x179900(0x64e)), _0x168e07[_0x179900(0x8bd)] = _0x179900(0x57e), _0x168e07[_0x179900(0x574)] = _0x179900(0x3b8), _0x168e07[_0x179900(0x80f)][_0x179900(0x15a)] = 'rgba(0,\x200,\x200,\x200.4)', _0x168e07['style'][_0x179900(0x86e)] = _0x179900(0x36d), _0x168e07['style'][_0x179900(0x526)] = _0x179900(0xa19), _0xf3fa66[_0x179900(0x25f)](_0x168e07))); } else _0x472ce2('保存失败，你的表情包是不是太多了？'); } const _0x4ce125 = document[_0x179900(0xa93)](_0x179900(0x64e)); _0x4ce125['id'] = 'message-anchor', _0xf3fa66[_0x179900(0x25f)](_0x4ce125), setTimeout(() => { const _0x22fa79 = _0x179900; if ('nzPkF' === _0x22fa79(0x2ab)) _0x4ce125[_0x22fa79(0x509)]({ 'behavior': _0x22fa79(0x831), 'block': _0x22fa79(0x813) }); else { if (!_0x59f2bf) return ''; const _0x133cfa = new _0x22d2b0(_0x98c71a), _0x59c13a = _0x5e1d87(_0x133cfa[_0x22fa79(0xb06)]())['padStart'](0x2, '0'), _0x40a337 = _0x362782(_0x133cfa[_0x22fa79(0x600)]())[_0x22fa79(0x27e)](0x2, '0'); return _0x59c13a + ':' + _0x40a337; } }, 0x32); } function _0x3cfad8() { const _0x5483c9 = _0x187760; if (_0x5483c9(0x9fa) === 'sjLLk') { const _0x27ab70 = document['querySelector'](_0x5483c9(0x647)); if (!_0x27ab70) return; if (_0x27ab70['id'] === 'meeting-view-screen') { if (_0x5483c9(0x501) === _0x5483c9(0x2ec)) { _0x13efad[_0x5483c9(0x29c)] = _0x5483c9(0x764); return; } else _0x2c4ed0(); } else _0x448e33(); } else _0x51440f = _0x5483c9(0x975) + _0xf04e12[_0x5483c9(0xb15)] + _0x5483c9(0x121); } function _0x448e33() { const _0x211634 = _0x187760, _0x52306b = _0x29b260[_0x211634(0xa85)]['filter'](_0x5e0820 => !_0x5e0820['isOffline'] && _0x5e0820[_0x211634(0x456)] !== _0x211634(0x4c2)); if (_0x52306b['length'] > _0x29b260[_0x211634(0x62c)]) { let _0x5327fd = _0x41a1da['querySelector']('.load-more-btn'); if (!_0x5327fd) { if (_0x211634(0xb11) !== 'xLHBo') { _0x5327fd = document[_0x211634(0xa93)]('button'), _0x5327fd[_0x211634(0x574)] = _0x211634(0x6f1), _0x5327fd[_0x211634(0x8bd)] = _0x211634(0x553), _0x5327fd[_0x211634(0x80f)][_0x211634(0x3fd)] = _0x211634(0x831), _0x5327fd[_0x211634(0x80f)][_0x211634(0x400)] = '10px\x20auto', _0x5327fd[_0x211634(0x80f)][_0x211634(0x86e)] = '8px\x2016px', _0x5327fd[_0x211634(0x356)] = () => { const _0x4fd8c8 = _0x211634, _0x56a3ac = _0x41a1da, _0x10a305 = _0x56a3ac[_0x4fd8c8(0x837)], _0x38587c = _0x56a3ac[_0x4fd8c8(0x19f)]; _0x29b260[_0x4fd8c8(0x62c)] += 0x64, _0x448e33(), requestAnimationFrame(() => { const _0x57a348 = _0x4fd8c8, _0x5d42ec = _0x56a3ac[_0x57a348(0x837)]; _0x56a3ac['scrollTop'] = _0x38587c + (_0x5d42ec - _0x10a305); }); }; if (_0x41a1da[_0x211634(0xab4)]) _0x211634(0x1a7) !== _0x211634(0x221) ? _0x41a1da[_0x211634(0x470)](_0x5327fd, _0x41a1da[_0x211634(0xab4)]) : !_0x46a48b[_0x211634(0x233)](_0xfc12d6[_0x211634(0x65e)]) && _0x53b6df[_0x211634(0x65e)] !== _0x4a4edb && _0x2c77b5[_0x211634(0x65e)] !== _0x33c7cf && _0x5adba6['classList'][_0x211634(0x41a)]('show'); else { if (_0x211634(0xa23) !== _0x211634(0x75b)) _0x41a1da[_0x211634(0x25f)](_0x5327fd); else { const _0x57b965 = _0x32e22c, _0x35ecf2 = _0x57b965['scrollHeight'], _0x500a8c = _0x57b965[_0x211634(0x19f)]; _0x397552[_0x211634(0x62c)] += 0x64, _0x2627d9(), _0x22b45b(() => { const _0x1fa7ea = _0x211634, _0x2c2e6e = _0x57b965[_0x1fa7ea(0x837)]; _0x57b965[_0x1fa7ea(0x19f)] = _0x500a8c + (_0x2c2e6e - _0x35ecf2); }); } } } else _0x33d9d0 = _0x4ca2fc['userProfile'][_0x211634(0xb15)] || '我'; } } else { if (_0x211634(0x8b3) !== 'YSCNS') { const _0x49a751 = _0x41a1da[_0x211634(0xa01)](_0x211634(0x1dc)); if (_0x49a751) _0x49a751['remove'](); } else _0x27667a[_0x211634(0x359)] = _0x43c65c, _0x830af3(), _0x4a90e6(); } Array['from'](_0x41a1da[_0x211634(0x45a)])['forEach'](_0x416756 => { const _0xeb8d70 = _0x211634; if ('jnZQz' === 'SRsPg') _0x2ac848 = _0x388d1f[_0xeb8d70(0x96f)] || _0x4c5cd5, _0x581208 = _0x5c674f['name'] || _0xeb8d70(0x1a6), _0x27cf06 = _0x581ecd[_0xeb8d70(0x3f7)] || '私聊'; else { if (!_0x416756[_0xeb8d70(0x969)][_0xeb8d70(0x233)](_0xeb8d70(0x7f1))) { if (_0xeb8d70(0x532) !== _0xeb8d70(0x532)) { const _0x10ef28 = _0x9fb58e(_0x2c7497['activeMeetingCharId']); if (!_0x10ef28) return; _0x30eb35 = !![], _0x12f696['style'][_0xeb8d70(0x3e7)] = _0xeb8d70(0x210); const _0xc8e53f = _0x10ef28[_0xeb8d70(0x433)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; _0x5ab20a['getElementById']('sprite-slider-x')['value'] = _0xc8e53f['x'], _0x25ce62['getElementById'](_0xeb8d70(0x5a9))[_0xeb8d70(0xa03)] = _0xc8e53f['y'], _0xa95f29[_0xeb8d70(0x759)](_0xeb8d70(0x9de))[_0xeb8d70(0xa03)] = _0xc8e53f[_0xeb8d70(0x61e)] * 0x64, _0x4a93a5 = { ..._0xc8e53f }, _0x58a05c[_0xeb8d70(0x759)]('galgame-textbox-container')[_0xeb8d70(0x80f)][_0xeb8d70(0x3e7)] = _0xeb8d70(0x697), _0x3c8a08['getElementById'](_0xeb8d70(0xa15))[_0xeb8d70(0x80f)][_0xeb8d70(0x3e7)] = _0xeb8d70(0x697); } else _0x416756[_0xeb8d70(0x41a)](); } } }); const _0x4a8b93 = _0x52306b[_0x211634(0x1f9)](-_0x29b260[_0x211634(0x62c)]); _0x4a8b93['forEach'](_0x4fce3b => { const _0x268570 = _0x211634, _0x5a1355 = _0x29b260[_0x268570(0xa85)]['indexOf'](_0x4fce3b); _0x5a1355 > -0x1 && (_0x268570(0xa88) === 'IXoYZ' ? _0x3291a9 += _0x268570(0x3eb) : _0x3a1b12(_0x4fce3b, _0x5a1355)); }); if (_0x29b260[_0x211634(0x27c)]) { if (_0x211634(0x963) !== _0x211634(0x605)) { let _0x4b45dd = _0x41a1da[_0x211634(0xa01)](_0x211634(0xa6d)); !_0x4b45dd && (_0x4b45dd = document['createElement'](_0x211634(0x64e)), _0x4b45dd[_0x211634(0x8bd)] = 'typing-indicator', _0x4b45dd['textContent'] = '对方正在输入...', _0x41a1da[_0x211634(0x25f)](_0x4b45dd)); } else { if (_0x3a38f9['type'] === 'touchstart') _0x9c434c[_0x211634(0xac9)](); _0x1a7bc1(_0x5a5daa); } } if (_0x4a8b93['length'] <= _0x29b260[_0x211634(0x62c)]) { if (_0x211634(0x4b2) !== _0x211634(0x8ca)) setTimeout(() => { const _0x53ee16 = _0x211634; _0x41a1da[_0x53ee16(0x19f)] = _0x41a1da[_0x53ee16(0x837)]; }, 0x0); else { _0xadd148['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>'; return; } } } function _0x3a1b12(_0x290c47, _0x39cb02) { const _0x3165c1 = _0x187760, { role: _0x544201, content: _0x46e3c4, displayUrl: _0x10b972, image: _0x312e8a, senderId: _0x10b644 } = _0x290c47, _0xd47bbc = _0x544201 === 'assistant' ? 'ai' : _0x544201, _0x185ec1 = _0xa7e551(), _0x5193e7 = document[_0x3165c1(0xa93)](_0x3165c1(0x64e)); _0x5193e7[_0x3165c1(0x969)][_0x3165c1(0x944)](_0x3165c1(0x1f6), _0xd47bbc), _0x5193e7[_0x3165c1(0x2f7)][_0x3165c1(0x2b0)] = _0x39cb02; const _0x9be64c = document[_0x3165c1(0xa93)](_0x3165c1(0x64e)); _0x9be64c['className'] = _0x3165c1(0x88d); let _0x112178 = ''; if (_0x544201 === 'user') { if (_0x3165c1(0x31c) !== 'ZtvIJ') _0x46aee4 = _0x1f58cd[_0x3165c1(0x7ee)]; else { const _0x350051 = _0x33ec75(_0x29b260[_0x3165c1(0x7b1)]); _0x112178 = _0x350051['avatar'] || _0x2f94f8; } } else { _0x112178 = _0x461596; let _0x32ef46 = null; if (_0x185ec1?.['type'] === 'private') _0x32ef46 = _0x4cc875(_0x185ec1[_0x3165c1(0x9be)][0x0]); else _0x185ec1?.[_0x3165c1(0x713)] === 'group' && _0x10b644 && (_0x3165c1(0x324) === 'xqGVy' ? _0x32ef46 = _0x4cc875(_0x10b644) : (_0x51f178[_0x3165c1(0x969)][_0x3165c1(0x41a)]('is-visible', _0x3165c1(0x33c)), _0x300941[_0x3165c1(0x969)]['remove'](_0x3165c1(0x9c8)), _0x1d8f82['diaryCurrentPage'] = _0x253a1c, _0x3bd6e7(), _0x57ae5f[_0x3165c1(0x42c)] = ![])); if (_0x32ef46?.[_0x3165c1(0x96f)]) { if ('kGExP' !== _0x3165c1(0x637)) _0x112178 = _0x32ef46['avatar']; else { _0x2b0663(_0x3165c1(0x8ae)); return; } } } let _0x26e91d = ''; const _0x768119 = _0x4cc875(_0x185ec1?.['participantIds'][0x0]); if (_0x544201 === _0x3165c1(0x544)) _0x768119 && (_0x26e91d = _0x768119[_0x3165c1(0x6b5)] || ''); else { if (_0x3165c1(0x44d) === 'sHMmi') { let _0x519c87 = null; if (_0x185ec1?.[_0x3165c1(0x713)] === _0x3165c1(0x7ad)) _0x519c87 = _0x768119; else _0x185ec1?.[_0x3165c1(0x713)] === _0x3165c1(0x867) && _0x10b644 && (_0x519c87 = _0x4cc875(_0x10b644)); _0x519c87 && (_0x26e91d = _0x519c87[_0x3165c1(0x85f)] || ''); } else { let _0x40403a = _0x36d40e[_0x3165c1(0xa01)](_0x3165c1(0xa6d)); !_0x40403a && (_0x40403a = _0x258442[_0x3165c1(0xa93)](_0x3165c1(0x64e)), _0x40403a[_0x3165c1(0x8bd)] = _0x3165c1(0x57e), _0x40403a['textContent'] = _0x3165c1(0x3b8), _0x40403a[_0x3165c1(0x80f)][_0x3165c1(0x15a)] = _0x3165c1(0x599), _0x40403a['style'][_0x3165c1(0x86e)] = _0x3165c1(0x36d), _0x40403a[_0x3165c1(0x80f)][_0x3165c1(0x526)] = _0x3165c1(0xa19), _0x3f38ce[_0x3165c1(0x25f)](_0x40403a)); } } const _0x391173 = _0x10f0c3(_0x112178, _0x26e91d), _0x17923d = _0x46e3c4 && _0x46e3c4['trim']()[_0x3165c1(0x736)](_0x3165c1(0x6e4)) && _0x46e3c4[_0x3165c1(0x74e)]()[_0x3165c1(0x92f)](_0x3165c1(0x892)); if (_0x17923d) { const _0x1fe8c8 = document[_0x3165c1(0xa93)]('div'); _0x1fe8c8['className'] = _0x3165c1(0x846), _0x1fe8c8[_0x3165c1(0x29c)] = _0x46e3c4; if (_0xd47bbc === _0x3165c1(0x544)) _0x9be64c[_0x3165c1(0x25f)](_0x1fe8c8), _0x9be64c[_0x3165c1(0x25f)](_0x391173); else { if ('BisEQ' !== _0x3165c1(0x223)) { let _0x55067b = _0x1d5f6c[_0x3165c1(0x74e)](); const _0x22e770 = _0x55067b[_0x3165c1(0x6d2)](/(\[[\s\S]*\])/); _0x22e770 && (_0x55067b = _0x22e770[0x1]); const _0x22e276 = _0x2e2df7[_0x3165c1(0x1db)](_0x55067b); if (_0x36b542['isArray'](_0x22e276)) { _0x88dd78[_0x3165c1(0x958)] = [..._0x22e276], _0x5071ef['characterLastScripts'][_0x5ec1bf['id']] = [..._0x22e276], _0x25a440(); const _0x987844 = _0x22e276[_0x3165c1(0xa96)](_0xebf0a1 => _0xebf0a1['speaker'] === _0x3165c1(0x9b5) ? _0xebf0a1[_0x3165c1(0x81d)] : _0xebf0a1[_0x3165c1(0x3c1)] + ':\x20' + _0xebf0a1['line'])[_0x3165c1(0x63b)]('\x0a\x0a'); _0x4d3802[_0x3165c1(0xa85)][_0x3165c1(0x438)]({ 'role': _0x3165c1(0x863), 'senderId': _0x207c67['id'], 'timestamp': _0x32d557[_0x3165c1(0x74c)](), 'isOffline': !![], 'content': _0x987844 }); } } else _0x9be64c[_0x3165c1(0x25f)](_0x391173), _0x9be64c[_0x3165c1(0x25f)](_0x1fe8c8); } } else { const _0x46a214 = document['createElement']('div'); _0x46a214[_0x3165c1(0x969)][_0x3165c1(0x944)](_0x3165c1(0x997), _0xd47bbc); if (_0x185ec1?.[_0x3165c1(0x713)] === _0x3165c1(0x7ad)) { const _0x5425be = _0x185ec1[_0x3165c1(0x9be)][0x0]; _0x46a214['classList'][_0x3165c1(0x944)](_0x3165c1(0xa78) + _0x5425be); } if (_0x290c47[_0x3165c1(0x554)]) { const _0x2eba83 = document['createElement'](_0x3165c1(0x64e)); _0x2eba83[_0x3165c1(0x8bd)] = 'quoted-message-in-bubble'; const _0x348860 = document[_0x3165c1(0xa93)]('div'); _0x348860['className'] = _0x3165c1(0x5c3), _0x348860['textContent'] = _0x290c47['quotedMessage'][_0x3165c1(0x41d)]; const _0x59c81c = document['createElement'](_0x3165c1(0x64e)); _0x59c81c[_0x3165c1(0x8bd)] = _0x3165c1(0x301), _0x59c81c[_0x3165c1(0x574)] = _0x290c47[_0x3165c1(0x554)]['content'], _0x2eba83[_0x3165c1(0x25f)](_0x348860), _0x2eba83['appendChild'](_0x59c81c), _0x46a214[_0x3165c1(0x25f)](_0x2eba83); } if (_0x10b972) { if (_0x3165c1(0xa1c) === _0x3165c1(0xa1c)) { _0x46a214[_0x3165c1(0x969)][_0x3165c1(0x944)](_0x3165c1(0x3b5)); const _0x19d1f3 = document[_0x3165c1(0xa93)](_0x3165c1(0x36b)); _0x19d1f3[_0x3165c1(0x686)] = _0x10b972, _0x19d1f3[_0x3165c1(0x969)]['add']('sticker-content'), _0x46a214[_0x3165c1(0x25f)](_0x19d1f3); } else _0x476b5d['error'](_0x3165c1(0x6dd) + _0x49bafb['id'], _0x1c7733), _0x42f364(_0x3165c1(0x859)); } else { if (_0x290c47[_0x3165c1(0x7ee)] || _0x290c47[_0x3165c1(0x1bd)]) { _0x46a214['classList'][_0x3165c1(0x944)](_0x3165c1(0x7ee)); const _0x5f0882 = document[_0x3165c1(0xa93)](_0x3165c1(0x36b)); _0x5f0882[_0x3165c1(0x969)][_0x3165c1(0x944)](_0x3165c1(0x198)), _0x46a214[_0x3165c1(0x25f)](_0x5f0882); _0x290c47[_0x3165c1(0x7ee)] ? _0x5f0882[_0x3165c1(0x686)] = _0x290c47['image'] : (_0x5f0882['src'] = _0x3165c1(0x410), _0x2e6c7a(_0x290c47[_0x3165c1(0x1bd)])[_0x3165c1(0x276)](_0x4d6016 => { const _0x4004ed = _0x3165c1; if (_0x4004ed(0x9df) === _0x4004ed(0x9df)) { if (_0x4d6016) { if ('TZddC' !== 'Pejno') { const _0x528ab7 = URL[_0x4004ed(0x289)](_0x4d6016); _0x5f0882[_0x4004ed(0x686)] = _0x528ab7, _0x5f0882['onload'] = () => { const _0xee21e9 = _0x4004ed; if ('OUsri' === _0xee21e9(0x3c2)) URL[_0xee21e9(0x4ce)](_0x528ab7); else { _0x85a0f1['id'] === _0x3f70bb['activeChatId'] && (_0x70d947(), _0x264836[_0xee21e9(0xa85)] = [], _0x28890b()); try { _0x54379a[_0xee21e9(0x4d2)](_0xee21e9(0x4a9) + _0xfcbe6a['id']), _0x36a911('群聊\x22' + _0x199638[_0xee21e9(0xb15)] + '\x22\x20的聊天记录已清空。'); } catch (_0x39f975) { _0x5bb96b['error'](_0xee21e9(0x6dd) + _0x4e9f5b['id'], _0x39f975), _0x1908cf(_0xee21e9(0x859)); } } }; } else _0x57dfe6[_0x4004ed(0x80f)][_0x4c7085] = _0x1f22d1[_0x18c1ce]; } else _0x4004ed(0x8e7) === _0x4004ed(0x51a) ? _0x5c0817[_0x4004ed(0x80f)]['display'] = _0x4004ed(0x697) : _0x5f0882[_0x4004ed(0x866)] = _0x4004ed(0x6db); } else { const _0x2231cb = _0x3d50ba['getAll'](); _0x2231cb['onsuccess'] = () => _0x3a678f(_0x2231cb[_0x4004ed(0x563)]), _0x2231cb[_0x4004ed(0x634)] = () => _0x3ab1a7(_0x2231cb[_0x4004ed(0x297)]); } })[_0x3165c1(0x29a)](_0x42fb03 => { const _0x1a2dd3 = _0x3165c1; console['error'](_0x1a2dd3(0x3f5), _0x42fb03), _0x5f0882['alt'] = _0x1a2dd3(0x6db); })); if (_0x46e3c4) { if (_0x3165c1(0x120) === _0x3165c1(0x120)) { const _0x863cbe = document[_0x3165c1(0xa93)]('p'); _0x863cbe[_0x3165c1(0x80f)][_0x3165c1(0x71d)] = _0x3165c1(0x6e3), _0x863cbe[_0x3165c1(0x574)] = _0x46e3c4, _0x46a214[_0x3165c1(0x25f)](_0x863cbe); } else _0x466d93[_0x3165c1(0x438)]('[' + _0x1a391f(_0x209075) + ']\x20' + _0x5dd049[_0x3165c1(0x359)]); } } else { if (_0x290c47[_0x3165c1(0x713)] === _0x3165c1(0x1ce)) { _0x46a214[_0x3165c1(0x969)]['add'](_0x3165c1(0x1ce)); const _0x3bfcf5 = _0x290c47[_0x3165c1(0x456)] === _0x3165c1(0x544) ? _0x33ec75(_0x29b260[_0x3165c1(0x7b1)]) : _0x4cc875(_0x290c47['senderId']), _0x361d55 = _0x290c47[_0x3165c1(0x22b)] === _0x33ec75(_0x29b260[_0x3165c1(0x7b1)])['id'] ? _0x33ec75(_0x29b260[_0x3165c1(0x7b1)]) : _0x4cc875(_0x290c47[_0x3165c1(0x22b)]), _0x1e60f1 = _0x3bfcf5?.[_0x3165c1(0xb15)] ? _0x3bfcf5['name'] + _0x3165c1(0x71a) : '转账', _0x55df81 = _0x361d55?.[_0x3165c1(0xb15)] ? _0x3165c1(0x2c5) + _0x361d55[_0x3165c1(0xb15)] : '转账', _0x400f90 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-title\x22>💰\x20' + _0x1e60f1 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥' + _0x290c47['amount'][_0x3165c1(0x394)](0x2) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>' + _0x55df81 + _0x3165c1(0x2f9); _0x46a214[_0x3165c1(0x29c)] = _0x400f90; } else { if (_0x290c47['type'] === 'listen-together-invite') { if (_0x3165c1(0xa2d) !== 'lRNXI') { _0x46a214[_0x3165c1(0x969)]['add'](_0x3165c1(0xa7c)); const _0x570f3f = document[_0x3165c1(0xa93)](_0x3165c1(0x64e)); _0x570f3f[_0x3165c1(0x8bd)] = _0x3165c1(0x46a), _0x570f3f['classList'][_0x3165c1(0x944)]('no-action-modal'); const _0x40b7aa = _0x290c47[_0x3165c1(0x456)] === _0x3165c1(0x544) ? _0x33ec75(_0x29b260[_0x3165c1(0x7b1)])[_0x3165c1(0xb15)] || '你' : _0x4cc875(_0x290c47[_0x3165c1(0x616)])?.[_0x3165c1(0xb15)] || 'TA', _0x464aaa = 'cover_placeholder_' + _0x290c47['timestamp'], _0xcfebe7 = _0x3165c1(0x111) + _0x464aaa + _0x3165c1(0x5ba) + _0x461596 + '\x22>'; if (_0x290c47['coverId']) { if ('FiIVd' !== _0x3165c1(0xacd)) { const _0x110efc = _0xde620f(_0x234365[_0x3165c1(0xb04)]); _0x110efc && (_0x1c9b92 = _0x110efc['name'], _0xef499b = _0x110efc['avatar']); } else _0x2e6c7a(_0x290c47['coverId'])[_0x3165c1(0x276)](_0x3c476c => { const _0x5c156d = _0x3165c1; if (_0x5c156d(0x250) !== _0x5c156d(0xa7e)) { const _0x3f81e1 = document['getElementById'](_0x464aaa); if (_0x3f81e1 && _0x3c476c) _0x3f81e1[_0x5c156d(0x686)] = URL['createObjectURL'](_0x3c476c); } else { const _0xf42d4 = _0x30007e[_0x5c156d(0x72a)][_0x20a6cb]; _0xf42d4 && _0xf42d4[_0x5c156d(0x387)] && _0x33d0bf[_0x5c156d(0x7b0)][_0x5c156d(0x438)](..._0xf42d4[_0x5c156d(0x387)]), delete _0x6e6275[_0x5c156d(0x72a)][_0x3046f7], _0x5be3b0(), _0x5afa16(); } }); } _0x290c47[_0x3165c1(0x382)] ? _0x570f3f[_0x3165c1(0x29c)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0xcfebe7 + _0x3165c1(0x6ef) + _0x290c47[_0x3165c1(0x5ee)] + _0x3165c1(0x3d7) + _0x290c47[_0x3165c1(0x6cd)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>' : _0x570f3f['innerHTML'] = _0x3165c1(0x41e) + _0x40b7aa + _0x3165c1(0x828) + _0xcfebe7 + _0x3165c1(0x6ef) + _0x290c47[_0x3165c1(0x5ee)] + _0x3165c1(0x3d7) + _0x290c47[_0x3165c1(0x6cd)] + _0x3165c1(0xa58) + _0x290c47['songId'] + _0x3165c1(0xad1), _0x46a214[_0x3165c1(0x25f)](_0x570f3f); } else _0x3687c7['error']('导入角色卡失败:', _0x24832a), _0x270e60(_0x3165c1(0x79b) + _0x5dac38[_0x3165c1(0x997)]); } else { if (_0x290c47['type'] === _0x3165c1(0xa7c) && _0x290c47[_0x3165c1(0x5ee)]) { _0x46a214[_0x3165c1(0x969)][_0x3165c1(0x944)](_0x3165c1(0xa7c)); const _0x38faec = document['createElement'](_0x3165c1(0x64e)); _0x38faec['className'] = _0x3165c1(0x818), _0x38faec[_0x3165c1(0x2f7)][_0x3165c1(0x5a6)] = _0x3165c1(0x924) + _0x290c47[_0x3165c1(0x6de)]; const _0xed78de = _0x3165c1(0x39a) + _0x290c47[_0x3165c1(0x6de)], _0x12011f = _0x3165c1(0x99a) + _0x461596 + _0x3165c1(0x38f) + _0xed78de + _0x3165c1(0x266); if (_0x290c47[_0x3165c1(0x40a)]) _0x2e6c7a(_0x290c47['coverId'])[_0x3165c1(0x276)](_0x3b1a20 => { const _0x450c07 = _0x3165c1; if (_0x450c07(0x151) === _0x450c07(0x937)) _0x1d2a68[_0x450c07(0x313)] = null, _0x5ee137('diaryList', _0x450c07(0x398)); else { const _0x2a9364 = document[_0x450c07(0x759)](_0xed78de); if (_0x2a9364 && _0x3b1a20) _0x2a9364[_0x450c07(0x686)] = URL['createObjectURL'](_0x3b1a20); } }); else _0x290c47['coverUrl'] && setTimeout(() => { const _0x36a5b7 = _0x3165c1; if (_0x36a5b7(0x3d1) === 'Kuscn') { const _0x5ec806 = document[_0x36a5b7(0x759)](_0xed78de); if (_0x5ec806) _0x5ec806['src'] = _0x290c47[_0x36a5b7(0x8ff)]; } else { const _0x5f3b51 = _0x3dde67[_0x36a5b7(0x6df)]['find'](_0x33f23c => _0x33f23c[_0x36a5b7(0x9be)][_0x36a5b7(0x4da)](_0x4b6c42)); if (!_0x5f3b51) return ''; const _0x38b402 = _0x1202b3(_0x5f3b51['id']), _0x55d496 = _0x37ef05[_0x36a5b7(0x901)][_0x36a5b7(0x9f6)](_0x47507a => _0x47507a[_0x36a5b7(0x3bf)] === _0x38b402['id'] || !_0x47507a[_0x36a5b7(0x3bf)]); if (_0x55d496[_0x36a5b7(0x919)] === 0x0) return ''; const _0x260749 = _0x55d496[_0x36a5b7(0xa96)](_0x2479e7 => { const _0x1d97da = _0x36a5b7, _0x53cf20 = _0x2479e7[_0x1d97da(0x713)] === _0x1d97da(0x7ea) ? _0x1d97da(0x670) : '待办'; return _0x1d97da(0x4c0) + _0x53cf20 + ']\x20' + _0x2479e7[_0x1d97da(0x653)] + ':\x20' + _0x2479e7['content']; })['join']('\x0a'); return _0x36a5b7(0x61a) + _0x38b402[_0x36a5b7(0xb15)] + _0x36a5b7(0xa7f) + _0x260749; } }, 0x0); _0x38faec[_0x3165c1(0x29c)] = _0x3165c1(0x7da) + _0x12011f + _0x3165c1(0x934) + _0x290c47['songName'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x290c47[_0x3165c1(0x6cd)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>' + (_0x290c47[_0x3165c1(0x3e3)] ? '▶' : '⚠') + _0x3165c1(0x892), _0x290c47[_0x3165c1(0x3e3)] && (_0x3165c1(0x6c4) !== _0x3165c1(0x1ac) ? _0x38faec[_0x3165c1(0x6cc)](_0x3165c1(0x7ec), function () { const _0x2ede34 = _0x3165c1; if (_0x2ede34(0x165) === _0x2ede34(0x165)) { const _0x549bf8 = { 'id': 'msg_' + _0x290c47['timestamp'], 'url': _0x290c47['playableUrl'] }; _0x40c32e(this, _0x549bf8); } else { const _0x344446 = (_0x330e4f['sticker'] ?? _0xf58965[_0x2ede34(0x6b4)] ?? _0x5eb425[_0x2ede34(0x91e)] ?? _0x646602[_0x2ede34(0x527)])?.[_0x2ede34(0x74e)](); if (_0x344446 && _0x539c6f['has'](_0x344446)) _0x443998['events'][_0x2ede34(0x438)]({ 'senderId': _0x13fb98['id'], 'kind': _0x2ede34(0x3b5), 'sticker': _0x344446 }); else { const _0x1d6f4f = _0x7bf7f8(_0x578ac4[_0x2ede34(0x359)] ?? _0x22f9ee['text'] ?? '')[_0x2ede34(0x74e)]() || _0x2ede34(0x43c) + (_0x344446 || _0x2ede34(0x5c9)) + ']'; if (_0x1d6f4f) _0xa91060[_0x2ede34(0x17b)][_0x2ede34(0x438)]({ 'senderId': _0x34b27d['id'], 'kind': 'text', 'content': _0x1d6f4f }); } } }) : (_0x3e098c(![]), _0x2f2163[_0x3165c1(0x297)](_0x3165c1(0x27b), _0x3f5eaf), _0xc164d(_0x3165c1(0x2c7) + _0x299965[_0x3165c1(0x997)]))), _0x46a214[_0x3165c1(0x25f)](_0x38faec); } else { if (_0x46e3c4) { if (_0x3165c1(0x1f7) !== _0x3165c1(0x587)) { const _0x2cd08c = document[_0x3165c1(0xa93)]('p'); _0x2cd08c[_0x3165c1(0x29c)] = _0x46e3c4, _0x2cd08c[_0x3165c1(0x80f)][_0x3165c1(0x400)] = '0', _0x46a214[_0x3165c1(0x25f)](_0x2cd08c); } else _0x4b023d[_0x3165c1(0x297)](_0x3165c1(0x299), _0xf85a50); } } } } } } _0xd47bbc === _0x3165c1(0x544) ? (_0x9be64c[_0x3165c1(0x25f)](_0x46a214), _0x9be64c[_0x3165c1(0x25f)](_0x391173)) : (_0x9be64c[_0x3165c1(0x25f)](_0x391173), _0x9be64c[_0x3165c1(0x25f)](_0x46a214)); } _0x5193e7[_0x3165c1(0x25f)](_0x9be64c); const _0x398237 = document[_0x3165c1(0xa93)]('div'); return _0x398237[_0x3165c1(0x8bd)] = _0x3165c1(0x6de), _0x398237[_0x3165c1(0x574)] = _0x2c0001(_0x290c47[_0x3165c1(0x6de)]), _0x5193e7['appendChild'](_0x398237), _0x41a1da[_0x3165c1(0x25f)](_0x5193e7), _0x5193e7; } document[_0x187760(0x759)](_0x187760(0x611))['addEventListener'](_0x187760(0x7ec), _0x480f39); let _0x373323 = null, _0x32537a = null; function _0x480f39(_0x2ba8ea) { const _0x1d0ebe = _0x187760; if (window['getSelection']()[_0x1d0ebe(0x37d)]()) return; const _0x4d430d = _0x2ba8ea[_0x1d0ebe(0x65e)]['closest']('.message-container'), _0x2a232a = _0x2ba8ea[_0x1d0ebe(0x65e)]['closest'](_0x1d0ebe(0x899)); if (!_0x4d430d || _0x2a232a) return; const _0x5a2620 = parseInt(_0x4d430d[_0x1d0ebe(0x2f7)][_0x1d0ebe(0x2b0)], 0xa); if (isNaN(_0x5a2620)) return; _0x15b269(_0x5a2620); } function _0xba948e() { const _0x3f4a24 = _0x187760, _0x37b9f3 = _0xa7e551(); if (!_0x37b9f3) { _0x3e9111['textContent'] = _0x3f4a24(0x54e); return; } if (_0x37b9f3[_0x3f4a24(0x713)] === _0x3f4a24(0x7ad)) { if ('taHwT' === _0x3f4a24(0xb32)) { const _0xe352a5 = _0x4cc875(_0x37b9f3[_0x3f4a24(0x9be)][0x0]); _0x3e9111['textContent'] = _0xe352a5 ? _0xe352a5[_0x3f4a24(0xb15)] : _0x3f4a24(0x2e9); } else _0x397206[_0x3f4a24(0x574)] = '--\x20点击选择\x20--'; } else _0x3e9111[_0x3f4a24(0x574)] = _0x37b9f3[_0x3f4a24(0xb15)] || _0x3f4a24(0x61c) + _0x37b9f3[_0x3f4a24(0x9be)]['length'] + ')'; } function _0x4a10d5(_0x521e99) { const _0x2b137c = _0x187760, _0x2daafa = document[_0x2b137c(0xa01)](_0x2b137c(0x647)); if (_0x2daafa && (_0x2daafa['id'] === 'meeting-view-screen' || _0x2daafa['id'] === _0x2b137c(0x490))) _0x3cfad8(); else { const _0x1ed5bf = document['querySelectorAll'](_0x2b137c(0xa6d)); _0x1ed5bf[_0x2b137c(0xa3d)](_0x10d07a => _0x10d07a[_0x2b137c(0x41a)]()); } } function _0x1a130b() { const _0x30a8a0 = _0x187760; _0x30a8a0(0x732) !== 'BFomD' ? (_0x29b260['isGenerating'] && _0x29b260[_0x30a8a0(0x243)] && (_0x30a8a0(0x5c2) !== _0x30a8a0(0x5c2) ? (_0x435f30['style'][_0x30a8a0(0xad6)] = _0x30a8a0(0x22e) + _0x2705b3[_0x30a8a0(0x289)](_0x4d4a37) + '\x27)', _0x5d2e60['style']['backgroundSize'] = _0x30a8a0(0x194), _0x38daac[_0x30a8a0(0x80f)]['backgroundPosition'] = 'center') : (console[_0x30a8a0(0xa05)](_0x30a8a0(0x928)), _0x29b260[_0x30a8a0(0x243)]['abort'](_0x30a8a0(0xb2f)), _0x29b260[_0x30a8a0(0x243)] = null)), _0x29b260[_0x30a8a0(0x27c)] = ![], _0x4a10d5(![])) : _0x3a5419[_0x30a8a0(0x80f)][_0x30a8a0(0xad6)] = _0x30a8a0(0x22e) + _0x4f7478[_0x30a8a0(0x96f)] + '\x27)'; } function _0xa7e551() { const _0x15af58 = _0x187760; if (_0x15af58(0x2c6) === 'UeqTT') return _0x29b260['chats'][_0x15af58(0x444)](_0x178bdc => _0x178bdc['id'] === _0x29b260[_0x15af58(0x7b1)]); else _0x5c6db4(new _0x431cce('Canvas\x20to\x20Blob\x20conversion\x20failed.')); } function _0x4cc875(_0x310143) { const _0x4a74d5 = _0x187760; if (_0x4a74d5(0xa3e) === _0x4a74d5(0x9c5)) _0x400982 = _0x5eb140(_0x2732e9); else return _0x29b260[_0x4a74d5(0x3db)]['find'](_0x47d02b => _0x47d02b['id'] === _0x310143); } function _0xb806d3(_0xb40db1) { const _0x4ba6ff = _0x187760; _0x29b260['characters'] = _0x29b260[_0x4ba6ff(0x3db)][_0x4ba6ff(0x9f6)](_0x14db83 => _0x14db83['id'] !== _0xb40db1), _0x29b260['chats'][_0x4ba6ff(0xa3d)](_0x537384 => { const _0x1920de = _0x4ba6ff; _0x537384[_0x1920de(0x713)] === _0x1920de(0x867) && (_0x537384[_0x1920de(0x9be)] = _0x537384['participantIds'][_0x1920de(0x9f6)](_0x4d59a1 => _0x4d59a1 !== _0xb40db1)); }); const _0x28a83d = _0x29b260[_0x4ba6ff(0x6df)][_0x4ba6ff(0x444)](_0x196c17 => _0x196c17[_0x4ba6ff(0x713)] === _0x4ba6ff(0x7ad) && _0x196c17[_0x4ba6ff(0x9be)]['includes'](_0xb40db1)); _0x28a83d && _0x26cabc(_0x28a83d['id']), _0x29b260['chats'] = _0x29b260['chats']['filter'](_0x9875f0 => _0x9875f0['type'] !== 'group' || _0x9875f0[_0x4ba6ff(0x9be)][_0x4ba6ff(0x919)] > 0x1), _0xf10e4a(), _0x25cb93(); } function _0x26cabc(_0x46b0d0) { const _0x314c82 = _0x187760; if ('buzfK' !== _0x314c82(0x4d1)) { _0x58ea99[_0x314c82(0x7d3)][_0x314c82(0x4f8)] = _0x3e0508[_0x314c82(0xa03)]['trim'](), _0x1fa36e[_0x314c82(0x7d3)]['key'] = _0x536307[_0x314c82(0xa03)][_0x314c82(0x74e)](), _0x2ef58a[_0x314c82(0x7d3)]['model'] = _0x1777e1[_0x314c82(0xa03)]['trim'](), _0x1bc8fd[_0x314c82(0x7d3)][_0x314c82(0x1ca)] = _0x5e1763[_0x314c82(0x759)](_0x314c82(0x6c7))[_0x314c82(0xa03)]; const _0x5450c3 = _0x46c5f7(_0x575434[_0x314c82(0xa03)], 0xa); _0x2a6f2c[_0x314c82(0xa2a)]['perChatContextLines'] = _0x2a5722[_0x314c82(0x4e8)](_0x5450c3) && _0x5450c3 > 0x0 ? _0x5450c3 : 0x64, _0x432365(), _0x31bc12(_0x314c82(0x358)); } else { _0x29b260[_0x314c82(0x6df)] = _0x29b260[_0x314c82(0x6df)][_0x314c82(0x9f6)](_0x29010b => _0x29010b['id'] !== _0x46b0d0); try { if ('hDkND' !== _0x314c82(0x314)) { if (!_0x10f188[_0x314c82(0x123)] || _0x52e545['friendCircles'][_0x314c82(0x919)] === 0x0) { _0x46d33e[_0x314c82(0x297)](_0x314c82(0x1ec)); return; } const _0x54da09 = _0xb4285d[_0x314c82(0x123)][0x0]; if (_0x54da09[_0x314c82(0x9a8)][_0x314c82(0x919)] < 0x2) { _0x3d8053[_0x314c82(0x297)]('错误：第一个好友圈\x20\x22' + _0x54da09[_0x314c82(0xb15)] + _0x314c82(0x3a7)); return; } const _0x14d2e4 = { 'id': _0x314c82(0x677) + _0x482064[_0x314c82(0x74c)](), 'authorType': _0x314c82(0x565), 'authorId': _0x54da09[_0x314c82(0x9a8)][0x0], 'content': _0x314c82(0x78e), 'timestamp': _0x35cf0a['now'](), 'likes': [_0x54da09[_0x314c82(0x9a8)][0x1]], 'comments': [{ 'commentId': 'c_' + _0x26c172[_0x314c82(0x74c)](), 'authorId': _0x54da09[_0x314c82(0x9a8)][0x1], 'content': _0x314c82(0x4dd) }] }; _0x54da09[_0x314c82(0x9ce)]['push'](_0x14d2e4), _0x12d44e(), _0x1901ac[_0x314c82(0xa05)](_0x314c82(0x675) + _0x54da09[_0x314c82(0xb15)] + _0x314c82(0x98b)), _0x2b94cb('测试动态已添加！'); } else localStorage[_0x314c82(0x4d2)]('chatHistory_' + _0x46b0d0); } catch (_0x3dce0a) { console['error'](_0x314c82(0x8a3) + _0x46b0d0, _0x3dce0a); } _0x29b260['activeChatId'] === _0x46b0d0 && (_0x29b260[_0x314c82(0x7b1)] = _0x29b260[_0x314c82(0x6df)][0x0]?.['id'] || null, _0x542653(_0x29b260[_0x314c82(0x7b1)])), _0xf10e4a(), _0x25cb93(); } } async function _0x542653(_0x348ade) { const _0x29b51e = _0x187760; if (_0x29b51e(0x727) === _0x29b51e(0x83d)) _0x153035[_0x29b51e(0x80f)][_0x29b51e(0x3e7)] = 'none', _0x38109d[_0x29b51e(0x356)] = _0x24d390[_0x29b51e(0x356)] = _0x49ae30['onclick'] = null, _0x367d33[_0x29b51e(0x601)](_0x29b51e(0xa53), _0x5678e4), _0x1c2864(_0x3b5e99); else { if (_0x29b260['activeChatId'] !== _0x348ade) { if (_0x29b51e(0x2ce) === 'trNuq') { const _0x51ed6c = _0xb479ae[_0x29b51e(0x713)] === _0x29b51e(0x7ea) ? _0x29b51e(0x670) : '待办'; return _0x29b51e(0x4c0) + _0x51ed6c + ']\x20' + _0x4b0532[_0x29b51e(0x653)] + ':\x20' + _0x3b848b[_0x29b51e(0x359)]; } else _0x1a130b(), _0x29b260[_0x29b51e(0x62c)] = 0x64; } if (!_0x348ade) { _0x29b260[_0x29b51e(0x7b1)] = null, _0xf10e4a(), _0x47f45b(![]), document[_0x29b51e(0x759)](_0x29b51e(0x719))[_0x29b51e(0x80f)]['backgroundImage'] = ''; return; } _0x29b260[_0x29b51e(0x7b1)] = _0x348ade, _0xf10e4a(), _0xba948e(), _0x41a1da[_0x29b51e(0x29c)] = '', _0x195491(!![], _0x29b51e(0x415)), setTimeout(async () => { const _0x771492 = _0x29b51e; if (_0x771492(0x822) === _0x771492(0x7aa)) _0x275d00(_0x4391a7['id']), _0x481cbc(_0x771492(0x710)), _0x510224(_0x771492(0x6b7)), _0x1f3bd2(![]); else try { _0x32657d(); const _0x3f7ba8 = _0xa7e551(), _0x5adf77 = document[_0x771492(0x759)](_0x771492(0x719)); let _0x3ae2b4 = null; if (_0x3f7ba8) { if (_0x3f7ba8[_0x771492(0x713)] === _0x771492(0x7ad)) { if (_0x771492(0x2aa) !== 'vqoUu') _0x3b298f[_0x771492(0xa05)]('Creating\x20object\x20store:\x20music_library'), _0x5147e6[_0x771492(0x772)](_0x771492(0x445), { 'keyPath': 'id' }); else { const _0x53c9c6 = _0x3f7ba8[_0x771492(0x9be)][0x0]; _0x30225b(_0x53c9c6), _0x3ae2b4 = await _0x2e6c7a('char_wallpaper_' + _0x53c9c6); } } else 'mAfTQ' !== _0x771492(0x396) ? _0x3ae2b4 = await _0x2e6c7a('group_bg_' + _0x3f7ba8['id']) : (_0x7f3d2b[_0x771492(0x7b1)] = _0x28fa1e[_0x771492(0x6df)][0x0]?.['id'] || null, _0x2cc871(_0x3368cc[_0x771492(0x7b1)])); if (_0x3ae2b4) { if (_0x771492(0x315) === 'KuHvN') { const _0x1d5ada = _0x14839f[_0x771492(0x7b0)][_0x771492(0x961)](_0x5a6404 => _0x5a6404['id'] === _0x4e2bb3); _0x1d5ada > -0x1 && (_0xf3ef0b[_0x771492(0x7b0)]['splice'](_0x1d5ada, 0x1), _0x2c9935(), _0x245f5a()); } else _0x5adf77[_0x771492(0x80f)][_0x771492(0xad6)] = 'url(\x27' + URL[_0x771492(0x289)](_0x3ae2b4) + '\x27)', _0x5adf77[_0x771492(0x80f)][_0x771492(0xb0d)] = _0x771492(0x194), _0x5adf77[_0x771492(0x80f)][_0x771492(0x9d5)] = _0x771492(0x37e); } else _0x5adf77[_0x771492(0x80f)]['backgroundImage'] = ''; } _0x448e33(); } catch (_0x319100) { _0x771492(0x144) === _0x771492(0x43f) ? _0x565c75[_0x771492(0x2f5)]('musicPlayerState', _0xe2812e[_0x771492(0x2a5)]({ 'playlist': _0xe5879[_0x771492(0x92e)], 'currentIndex': _0x5b9ad6[_0x771492(0x463)] })) : (console[_0x771492(0x297)](_0x771492(0x430), _0x319100), _0xeba69d(_0x771492(0x8d2) + _0x319100['message'])); } finally { if ('csMcK' !== _0x771492(0x37f)) { if (_0x46e6e5 < 0x0 || _0x3dd878 >= _0x215f83) return; _0x33abad[_0x771492(0x80f)][_0x771492(0x550)] = _0x771492(0x5c4) + _0x108e2e * (0x64 / _0x18438a) + '%)', _0xcd37d3['forEach'](_0x367091 => _0x367091[_0x771492(0x969)][_0x771492(0x41a)](_0x771492(0x691))), _0x3ef87c[_0x55178a][_0x771492(0x969)]['add'](_0x771492(0x691)), _0x244d3e = _0x5013d0, _0x13e821 === 0x0 ? _0x197714[_0x771492(0x80f)][_0x771492(0x3e7)] = 'none' : _0x5ee198[_0x771492(0x80f)][_0x771492(0x3e7)] = _0x771492(0x868); } else _0x195491(![]); } }, 0x32); } } async function _0x4646de() { const _0xdec05c = _0x187760; if (_0x29b260[_0xdec05c(0x27c)]) { _0xeba69d('正在构思中，请稍候...'); return; } const _0x374679 = _0x29b260['conversationHistory']; if (_0x374679['length'] === 0x0) return; let _0x2492af = -0x1; for (let _0x10efc9 = _0x374679[_0xdec05c(0x919)] - 0x1; _0x10efc9 >= 0x0; _0x10efc9--) { if (_0x374679[_0x10efc9][_0xdec05c(0x456)] === 'user') { _0x2492af = _0x10efc9; break; } } if (_0x2492af === -0x1 || _0x2492af === _0x374679[_0xdec05c(0x919)] - 0x1) { if (_0xdec05c(0xad0) === 'mbqDh') { _0xeba69d(_0xdec05c(0x8ae)); return; } else _0xd5b2b7(), _0x4c43e2(_0xdec05c(0x3e2), _0xdec05c(0x83c)); } _0x374679['splice'](_0x2492af + 0x1), _0x29b260[_0xdec05c(0x958)] = [], _0x3254df(), _0x2c4ed0(), _0x17a6e0(_0x29b260[_0xdec05c(0x49a)]), setTimeout(() => { const _0x3d80ab = _0xdec05c; _0x3d80ab(0x3e6) === _0x3d80ab(0x43b) ? _0x4cca4e['insertBefore'](_0x2d6e5e, _0x252bff['firstChild']) : _0x1ae21f(); }, 0x64); } async function _0x1596fa() { const _0x3323be = _0x187760; if (_0x29b260['isGenerating']) { _0xeba69d(_0x3323be(0x8a0)); return; } const _0x5ec31f = _0x29b260[_0x3323be(0xa85)]; if (_0x5ec31f[_0x3323be(0x919)] === 0x0) return; let _0x585573 = -0x1; for (let _0xc3c0c5 = _0x5ec31f[_0x3323be(0x919)] - 0x1; _0xc3c0c5 >= 0x0; _0xc3c0c5--) { if (_0x3323be(0x442) === _0x3323be(0x442)) { if (_0x5ec31f[_0xc3c0c5][_0x3323be(0x456)] === _0x3323be(0x544)) { if ('ooUrk' === 'DbRpp') _0x411364[_0x3323be(0x7ec)](); else { _0x585573 = _0xc3c0c5; break; } } } else { const _0xe30feb = _0x30b54f[0x0], _0x5583bb = new _0xdc2b60(_0xe30feb[_0x3323be(0x653)] + _0x3323be(0xa1d)), _0x2081c9 = _0x5583bb - _0x1ebafe, _0x55f2d7 = _0x24c733[_0x3323be(0x44e)](_0x2081c9 / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x13dce6['textContent'] = _0x3323be(0x5b1) + _0xe30feb[_0x3323be(0x359)] + '」', _0x20821f[_0x3323be(0x29c)] = _0x3323be(0x3dd) + _0x55f2d7 + _0x3323be(0x5b0); } } if (_0x585573 === -0x1 || _0x585573 === _0x5ec31f[_0x3323be(0x919)] - 0x1) { if (_0x3323be(0x8cb) !== _0x3323be(0x116)) { _0xeba69d('还没有我的回复可以重新生成哦。'); return; } else _0x1a4475(); } _0x5ec31f[_0x3323be(0x903)](_0x585573 + 0x1), _0x3254df(), _0x3cfad8(), setTimeout(() => { _0x1ae21f(); }, 0x64); } function _0x15568f(_0x333c39 = null) { const _0x400912 = _0x187760, _0x455855 = _0x333c39 ?? _0x3da0ef[_0x400912(0xa03)][_0x400912(0x74e)](); if (_0x455855 === '' || !_0x29b260[_0x400912(0x7b1)]) return; const _0x45b2c4 = document[_0x400912(0xa01)](_0x400912(0x647)), _0x4f344d = _0x45b2c4['id'] === 'meeting-view-screen', _0x45e419 = { 'role': _0x400912(0x544), 'content': _0x455855, 'timestamp': Date['now'](), 'isOffline': _0x4f344d }; _0x29b260[_0x400912(0x7d9)] && (_0x45e419[_0x400912(0x554)] = { ..._0x29b260['activeQuote'] }), _0x29b260[_0x400912(0xa85)]['push'](_0x45e419), _0x3254df(), _0x3cfad8(), !_0x333c39 && ('gMVCp' !== _0x400912(0x7b8) ? _0x539205[_0x400912(0x4d2)](_0x400912(0x4a9) + _0x353f4a) : _0x3da0ef[_0x400912(0xa03)] = ''), _0x24df82(); } function _0x2412f1(_0x480330) { const _0x3958ad = _0x187760; if (!_0x480330 || !_0x29b260[_0x3958ad(0x7b1)]) return; const _0x88088e = { 'role': _0x3958ad(0x544), 'content': _0x3958ad(0x578) + _0x480330[_0x3958ad(0xb15)] + ']', 'displayUrl': _0x480330['url'], 'timestamp': Date[_0x3958ad(0x74c)]() }; _0x29b260[_0x3958ad(0xa85)][_0x3958ad(0x438)](_0x88088e), _0x3a1b12(_0x88088e, _0x29b260[_0x3958ad(0xa85)]['length'] - 0x1), _0x3254df(), _0x2d1d45[_0x3958ad(0x969)]['remove']('show'); } async function _0xebc7a0(_0xc8cc3e) { const _0x68d09a = _0x187760, _0x45b42b = _0xc8cc3e[_0x68d09a(0x65e)]['files'][0x0]; if (!_0x45b42b || !_0x29b260[_0x68d09a(0x7b1)]) return; _0x195491(!![], _0x68d09a(0x8bc)); try { if (_0x68d09a(0x458) === _0x68d09a(0x672)) _0x595251['querySelector'](_0x68d09a(0x68c))[_0x68d09a(0x356)] = () => { _0x45a56c(_0x1b5df5), _0x589819(); }; else { const _0x2d3bbb = await _0x3a4746(_0x45b42b, 0x320, 0.8, !![]), _0x47e1f1 = _0x68d09a(0x851) + Date['now'](); await _0x5b0aee(_0x47e1f1, _0x2d3bbb); const _0x4b0cf7 = _0x3da0ef['value'][_0x68d09a(0x74e)](); _0x3da0ef[_0x68d09a(0xa03)] = ''; const _0x2b6856 = { 'role': 'user', 'content': _0x4b0cf7, 'imageId': _0x47e1f1, 'timestamp': Date['now']() }; _0x29b260[_0x68d09a(0xa85)]['push'](_0x2b6856), _0x3a1b12(_0x2b6856, _0x29b260['conversationHistory']['length'] - 0x1), _0x3254df(); } } catch (_0x514f33) { _0xeba69d(_0x68d09a(0x723) + _0x514f33[_0x68d09a(0x997)]); } finally { _0x195491(![]), _0xc8cc3e[_0x68d09a(0x65e)][_0x68d09a(0xa03)] = ''; } } async function _0x29962e() { const _0x57fa17 = _0x187760; if ('hDayG' === 'hDayG') { if (!_0x29b260[_0x57fa17(0x7b1)]) return; const _0x51b20a = await _0x44efbc(); if (!_0x51b20a) return; _0xeba69d(_0x57fa17(0x530)); try { const _0x32b291 = await _0x1533cb(_0x51b20a['songName'], _0x51b20a[_0x57fa17(0x6cd)]); let _0x425efa = _0x32b291['cover']; if (_0x32b291[_0x57fa17(0x194)] && _0x32b291[_0x57fa17(0x194)]['startsWith']('http')) { if (_0x57fa17(0x5b5) !== 'XvRHm') try { const _0x2a9da9 = await fetch(_0x32b291[_0x57fa17(0x194)]), _0x5c4196 = await _0x2a9da9['blob'](); _0x425efa = await _0x13346a(_0x5c4196); } catch (_0x3dd935) { console[_0x57fa17(0x297)](_0x57fa17(0x743), _0x3dd935), _0x425efa = _0x461596; } else _0x3e2382[_0x57fa17(0x969)][_0x57fa17(0x41a)](_0x57fa17(0x459)); } const _0x22d17e = { 'role': _0x57fa17(0x544), 'type': _0x57fa17(0xa7c), 'content': _0x57fa17(0x7c7) + _0x51b20a['songName'] + _0x57fa17(0x84c) + _0x51b20a[_0x57fa17(0x6cd)] + ']', 'songName': _0x51b20a[_0x57fa17(0x5ee)], 'artist': _0x51b20a[_0x57fa17(0x6cd)], 'coverUrl': _0x425efa, 'playableUrl': _0x32b291['url'], 'timestamp': Date['now']() }; _0x29b260['conversationHistory']['push'](_0x22d17e), _0x3a1b12(_0x22d17e, _0x29b260['conversationHistory'][_0x57fa17(0x919)] - 0x1), _0x3254df(); } catch (_0x2d7e06) { console['error'](_0x57fa17(0x500), _0x2d7e06), _0xeba69d('搜索失败:\x20' + _0x2d7e06[_0x57fa17(0x997)]); } } else _0x17eea7 = _0x14600f[_0x57fa17(0x1db)](_0x49c02c); } function _0x255cfb(_0x26c854, _0x36bebd = 0x78) { const _0x82ac15 = _0x187760, _0x25fcca = _0x42801f => { const _0x4fba40 = _0x18ce; if (_0x42801f[_0x4fba40(0x456)] === _0x4fba40(0x544)) return _0x29b260[_0x4fba40(0xa77)]?.['name'] || _0x4fba40(0x3f9); if (_0x42801f[_0x4fba40(0x616)]) { const _0x236b32 = _0x4cc875(_0x42801f[_0x4fba40(0x616)]); return _0x236b32?.[_0x4fba40(0xb15)] || _0x4fba40(0x352); } if (_0x26c854?.[_0x4fba40(0x713)] === _0x4fba40(0x7ad)) { if (_0x4fba40(0x539) !== _0x4fba40(0x539)) _0x1521d1 += _0x4fba40(0x2e7); else { const _0x101d38 = _0x4cc875(_0x26c854['participantIds'][0x0]); return _0x101d38?.[_0x4fba40(0xb15)] || 'AI'; } } return _0x4fba40(0x73a); }, _0x5651a0 = _0x29b260['conversationHistory'][_0x82ac15(0x1f9)](-_0x36bebd), _0x439960 = []; for (const _0x5b45e4 of _0x5651a0) { if (_0x82ac15(0x5ce) !== 'OQwxH') { if (_0x5b45e4[_0x82ac15(0x96e)]) _0x439960[_0x82ac15(0x438)]('[' + _0x25fcca(_0x5b45e4) + _0x82ac15(0x986) + (_0x5b45e4[_0x82ac15(0x359)]?.[_0x82ac15(0x6d2)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x5b45e4[_0x82ac15(0x7ee)]) { const _0x26d60a = _0x5b45e4[_0x82ac15(0x359)] ? '\x20' + _0x5b45e4[_0x82ac15(0x359)] : ''; _0x439960[_0x82ac15(0x438)]('[' + _0x25fcca(_0x5b45e4) + _0x82ac15(0x5dc) + _0x26d60a); } else _0x5b45e4['content'] && _0x439960['push']('[' + _0x25fcca(_0x5b45e4) + ']\x20' + _0x5b45e4['content']); } } else { _0x5cc389(_0x82ac15(0xa7d)); return; } } return _0x439960[_0x82ac15(0x63b)]('\x0a'); } function _0x3a8a92(_0x49baf9, _0x48269e) { const _0x16f0db = _0x187760; if (_0x16f0db(0xac7) !== _0x16f0db(0xac7)) _0x500d81[_0x16f0db(0x80f)]['position'] = 'absolute', _0x5e93cf[_0x16f0db(0x80f)][_0x16f0db(0xa28)] = _0x16f0db(0x186), _0x2bdd61['style'][_0x16f0db(0x927)] = '50%', _0x1937a9[_0x16f0db(0x80f)][_0x16f0db(0x550)] = _0x16f0db(0xa4c), _0x303867[_0x16f0db(0x80f)][_0x16f0db(0x3e7)] = 'block'; else { if (!_0x49baf9 || !_0x48269e) return null; const _0x160042 = _0x48269e[_0x16f0db(0x6d2)](/@([^\s:：,，。!?]+)/); if (!_0x160042) return null; const _0x4c166e = _0x160042[0x1][_0x16f0db(0x99d)](); for (const _0x17c331 of _0x49baf9[_0x16f0db(0x9be)]) { if (_0x16f0db(0x3df) === _0x16f0db(0x3df)) { const _0x259d83 = _0x4cc875(_0x17c331); if (!_0x259d83?.['name']) continue; if (_0x259d83['name']['toLowerCase']() === _0x4c166e) return _0x259d83; if (_0x259d83['name'][_0x16f0db(0x99d)]()[_0x16f0db(0x736)](_0x4c166e)) return _0x259d83; } else _0x53831e(_0x16f0db(0x753)); } return null; } } function _0x2238bf(_0x1e8897) { const _0x3848ae = _0x187760, _0x3a4699 = _0x1e8897[_0x3848ae(0x8d5)]('{'), _0x4420f3 = _0x1e8897[_0x3848ae(0x9bf)]('}'); if (_0x3a4699 >= 0x0 && _0x4420f3 > _0x3a4699) return _0x1e8897[_0x3848ae(0x1f9)](_0x3a4699, _0x4420f3 + 0x1); return _0x1e8897; } function _0x211b6e(_0x40983d, _0x55b024, _0x36c03f) { const _0x1a9b4f = _0x187760; if (_0x1a9b4f(0x2ea) !== _0x1a9b4f(0x46f)) { const _0x2c554d = new Map(_0x55b024[_0x1a9b4f(0xa96)](_0x257a45 => [String(_0x257a45['id']), _0x257a45])), _0x4bcd35 = _0x37dedd => String(_0x37dedd || '')[_0x1a9b4f(0x99d)]()[_0x1a9b4f(0x998)](/\s+/g, ''), _0x59ccd5 = new Map(_0x55b024[_0x1a9b4f(0xa96)](_0x169334 => [_0x4bcd35(_0x169334[_0x1a9b4f(0xb15)]), _0x169334])), _0x5b9606 = new Set(_0x36c03f), _0xf83590 = { 'events': [] }; for (const _0x422d64 of _0x40983d?.[_0x1a9b4f(0x17b)] || []) { const _0x2e7037 = _0x422d64[_0x1a9b4f(0x616)] ?? _0x422d64['sender'] ?? _0x422d64[_0x1a9b4f(0x909)] ?? _0x422d64[_0x1a9b4f(0x3c1)] ?? _0x422d64[_0x1a9b4f(0x456)] ?? _0x422d64['name']; if (!_0x2e7037) continue; let _0x3194fa = _0x2c554d[_0x1a9b4f(0x2fe)](String(_0x2e7037)) || _0x59ccd5[_0x1a9b4f(0x2fe)](_0x4bcd35(_0x2e7037)); if (!_0x3194fa) continue; const _0x191b49 = (_0x422d64[_0x1a9b4f(0x7a6)] || _0x422d64[_0x1a9b4f(0x713)] || _0x1a9b4f(0x807))['toLowerCase'](); if (_0x191b49 === _0x1a9b4f(0x3b5)) { const _0x3b54a9 = (_0x422d64['sticker'] ?? _0x422d64[_0x1a9b4f(0x6b4)] ?? _0x422d64[_0x1a9b4f(0x91e)] ?? _0x422d64[_0x1a9b4f(0x527)])?.[_0x1a9b4f(0x74e)](); if (_0x3b54a9 && _0x5b9606[_0x1a9b4f(0x9ee)](_0x3b54a9)) { if ('OZINP' !== 'uhhoA') _0xf83590['events'][_0x1a9b4f(0x438)]({ 'senderId': _0x3194fa['id'], 'kind': 'sticker', 'sticker': _0x3b54a9 }); else { const _0x461656 = _0xe69605[_0x4ce053]; if (typeof _0x461656 === _0x1a9b4f(0x96c)) _0x1c52eb[_0x1a9b4f(0x438)](_0x461656); if (_0xa6ac03[_0x1a9b4f(0xac4)](_0x461656)) _0x461656['forEach'](_0x4024f6 => { if (typeof _0x4024f6 === 'string') _0x31575a['push'](_0x4024f6); }); } } else { if (_0x1a9b4f(0x55c) !== _0x1a9b4f(0x55c)) _0x2cc676[_0x1a9b4f(0x4d2)](_0x1a9b4f(0x4a9) + _0x1c3c1c['id']); else { const _0x18bbdb = String(_0x422d64[_0x1a9b4f(0x359)] ?? _0x422d64[_0x1a9b4f(0x807)] ?? '')[_0x1a9b4f(0x74e)]() || '[sticker:' + (_0x3b54a9 || _0x1a9b4f(0x5c9)) + ']'; if (_0x18bbdb) _0xf83590[_0x1a9b4f(0x17b)]['push']({ 'senderId': _0x3194fa['id'], 'kind': _0x1a9b4f(0x807), 'content': _0x18bbdb }); } } } else { const _0x2cc88d = String(_0x422d64[_0x1a9b4f(0x359)] ?? _0x422d64[_0x1a9b4f(0x807)] ?? _0x422d64[_0x1a9b4f(0x997)] ?? '')[_0x1a9b4f(0x74e)](); if (_0x2cc88d) _0xf83590[_0x1a9b4f(0x17b)][_0x1a9b4f(0x438)]({ 'senderId': _0x3194fa['id'], 'kind': 'text', 'content': _0x2cc88d }); } } return _0xf83590; } else _0x38222b(_0x34f3c7), _0x5b2e3d[_0x1a9b4f(0x601)]('canplaythrough', _0x37fc5e), _0x4e071a[_0x1a9b4f(0x601)](_0x1a9b4f(0x297), _0x11e8ba), _0x5d6a2b[_0x1a9b4f(0x686)] = '', _0xcc8c0b['remove'](); } async function _0x58f018(_0x5b0f12) { const _0x5a745d = _0x187760; if (!_0x5b0f12 || !Array[_0x5a745d(0xac4)](_0x5b0f12[_0x5a745d(0x17b)]) || _0x5b0f12[_0x5a745d(0x17b)][_0x5a745d(0x919)] === 0x0) return; const _0x2fa7ad = _0x12fa71 => _0x12fa71 + Math[_0x5a745d(0xa54)](Math[_0x5a745d(0x545)]() * 0x190); let _0x4991d2 = 0x1f4; for (const _0x39a058 of _0x5b0f12[_0x5a745d(0x17b)]) { await new Promise(_0x1249a9 => setTimeout(_0x1249a9, _0x2fa7ad(_0x4991d2))), _0x4991d2 += 0x2bc; const _0x1fdf44 = _0x29b260[_0x5a745d(0xa85)]['at'](-0x1)?.['isOffline'] ?? ![]; if (_0x39a058['kind'] === _0x5a745d(0x3b5)) { if (_0x5a745d(0x7dc) !== 'XWbiR') { const _0x470de7 = _0x53fca2[_0x5a745d(0x444)](_0x5e93ad => _0x5e93ad['name'] === _0x39a058['sticker']); if (_0x470de7) { const _0x8b5324 = { 'role': _0x5a745d(0x863), 'content': _0x5a745d(0x8cc) + _0x470de7['name'] + ']', 'displayUrl': _0x470de7[_0x5a745d(0x8b7)], 'senderId': _0x39a058['senderId'], 'timestamp': Date[_0x5a745d(0x74c)](), 'isOffline': _0x1fdf44 }; _0x29b260[_0x5a745d(0xa85)][_0x5a745d(0x438)](_0x8b5324); } } else { const _0x26c9a4 = _0x4307e6[_0x5a745d(0x759)](_0x5a745d(0x1fe)); _0x26c9a4[_0x5a745d(0x29c)] = ''; if (_0x4a1346['friendCircles']['length'] === 0x0) { _0x26c9a4[_0x5a745d(0x29c)] = _0x5a745d(0x2a3); return; } _0x4d7505[_0x5a745d(0x123)]['forEach'](_0x591540 => { const _0x3e640c = _0x5a745d, _0x57a4b3 = _0x21464f[_0x3e640c(0x44f)][_0x3e640c(0x444)](_0x2100c7 => _0x2100c7['id'] === _0x591540[_0x3e640c(0x515)]) || { 'name': _0x3e640c(0x12a) }, _0x227a93 = _0x33da59[_0x3e640c(0xa93)](_0x3e640c(0x64e)); _0x227a93[_0x3e640c(0x8bd)] = _0x3e640c(0x7ef), _0x227a93[_0x3e640c(0x2f7)]['id'] = _0x591540['id'], _0x227a93['innerHTML'] = _0x3e640c(0x649) + _0x591540['name'] + _0x3e640c(0x94e) + _0x57a4b3[_0x3e640c(0xb15)] + '\x20|\x20' + _0x591540[_0x3e640c(0x9a8)][_0x3e640c(0x919)] + _0x3e640c(0x62e), _0x227a93[_0x3e640c(0x6cc)](_0x3e640c(0x7ec), () => _0xeeb811(_0x591540['id'])), _0x26c9a4[_0x3e640c(0x25f)](_0x227a93); }); } } else { if (_0x39a058[_0x5a745d(0x7a6)] === _0x5a745d(0xa7c) && _0x39a058[_0x5a745d(0x5ee)] && _0x39a058[_0x5a745d(0x6cd)]) { if ('XuwOY' !== _0x5a745d(0x142)) { const { songName: _0x384a20, artist: _0x1ce4ad } = _0x39a058, _0x1fb20a = { 'role': 'assistant', 'type': _0x5a745d(0xa7c), 'content': _0x5a745d(0x2f4) + _0x384a20 + _0x5a745d(0x84c) + _0x1ce4ad + ']', 'songName': _0x384a20, 'artist': _0x1ce4ad, 'senderId': _0x39a058[_0x5a745d(0x616)], 'timestamp': Date[_0x5a745d(0x74c)](), 'isOffline': _0x1fdf44 }; try { if (_0x5a745d(0xa0a) !== 'KfDNx') { const _0x2ecae0 = await _0x1533cb(_0x384a20, _0x1ce4ad); _0x1fb20a[_0x5a745d(0x8ff)] = _0x2ecae0['cover'], _0x1fb20a[_0x5a745d(0x3e3)] = _0x2ecae0[_0x5a745d(0x8b7)]; } else { const _0x533d7 = new _0x3a5833(); _0x533d7[_0x5a745d(0x890)] = () => _0x17be84(_0x533d7[_0x5a745d(0x563)]), _0x533d7['onerror'] = _0x2f55e1, _0x533d7[_0x5a745d(0x855)](_0x28d334); } } catch (_0x2a9811) { if (_0x5a745d(0x76f) === 'MItTQ') console['error'](_0x5a745d(0x5fe) + _0x384a20 + _0x5a745d(0x84c) + _0x1ce4ad + '):', _0x2a9811), _0x1fb20a[_0x5a745d(0x8ff)] = null, _0x1fb20a['playableUrl'] = null; else return _0x4b901e[_0x5a745d(0xa05)](_0x5a745d(0x95e)), ''; } _0x29b260[_0x5a745d(0xa85)][_0x5a745d(0x438)](_0x1fb20a); } else { _0x5c5722 = _0x172fdb; let _0xdeda29 = null; if (_0x3cad11?.[_0x5a745d(0x713)] === 'private') _0xdeda29 = _0x21c880(_0x11d6c1['participantIds'][0x0]); else _0x4b1e8a?.[_0x5a745d(0x713)] === _0x5a745d(0x867) && _0x3c80e2 && (_0xdeda29 = _0x386896(_0x453fd1)); _0xdeda29?.[_0x5a745d(0x96f)] && (_0x454eae = _0xdeda29[_0x5a745d(0x96f)]); } } else { if (_0x39a058['kind'] === _0x5a745d(0x807)) { const _0x5cdd3c = _0x2fa780(_0x39a058[_0x5a745d(0x359)])[_0x5a745d(0x1f9)](0x0, 0x3); for (let _0x5d90f6 = 0x0; _0x5d90f6 < _0x5cdd3c[_0x5a745d(0x919)]; _0x5d90f6++) { if (_0x5d90f6 > 0x0) await new Promise(_0x498ae5 => setTimeout(_0x498ae5, _0x2fa7ad(0x190))); const _0x3372d9 = { 'role': _0x5a745d(0x863), 'content': _0x5cdd3c[_0x5d90f6], 'senderId': _0x39a058[_0x5a745d(0x616)], 'timestamp': Date['now'](), 'isOffline': _0x1fdf44 }; _0x29b260['conversationHistory'][_0x5a745d(0x438)](_0x3372d9); } } } } } _0x3254df(), _0x3cfad8(); } async function _0x430bb8(_0x26bc9e, { force: force = ![], delayMs: delayMs = 0x0 } = {}) { const _0x4800c3 = _0x187760; await new Promise(_0x12e47f => setTimeout(_0x12e47f, 0xa)); if (!_0x29b260[_0x4800c3(0x7d3)]['endpoint'] || !_0x29b260[_0x4800c3(0x7d3)][_0x4800c3(0x251)] || !_0x29b260[_0x4800c3(0x7d3)][_0x4800c3(0x48a)]) return _0xeba69d(_0x4800c3(0x49f)), ![]; const _0x352bf7 = _0xa7e551(); if (!_0x352bf7 || !_0x26bc9e) return ![]; const _0x3eb69c = _0x33ec75(_0x352bf7['id']), _0x379568 = _0x29b260[_0x4800c3(0xa85)]['at'](-0x1)?.[_0x4800c3(0x456)] === _0x4800c3(0x544); if (!force && !_0x379568) return ![]; const _0x40b440 = _0x29b260[_0x4800c3(0xa85)]['at'](-0x1)?.[_0x4800c3(0x683)] ?? ![]; if (delayMs) await new Promise(_0x42f221 => setTimeout(_0x42f221, delayMs)); if (_0x40b440) document['getElementById'](_0x4800c3(0x245))[_0x4800c3(0x574)] = _0x4800c3(0x7ae); else { if (_0x4800c3(0x2a4) === _0x4800c3(0x4b0)) { const _0x4d2b73 = _0x529b99[_0x4800c3(0x65e)][_0x4800c3(0x563)]; _0x249411['log']('Upgrading\x20database\x20to\x20version\x20' + _0x4d2b73[_0x4800c3(0x555)] + _0x4800c3(0x1ea)), !_0x4d2b73['objectStoreNames']['contains'](_0x19db08) && (_0x11e8ae[_0x4800c3(0xa05)]('Creating\x20object\x20store:\x20' + _0x2bcc8e), _0x4d2b73[_0x4800c3(0x772)](_0x1fbe4e, { 'keyPath': 'id' })), !_0x4d2b73[_0x4800c3(0x74f)][_0x4800c3(0x233)]('music_library') && (_0x3c731f[_0x4800c3(0xa05)](_0x4800c3(0xafe)), _0x4d2b73[_0x4800c3(0x772)](_0x4800c3(0x445), { 'keyPath': 'id' })), !_0x4d2b73['objectStoreNames']['contains'](_0x3410b2) && (_0x8e1807[_0x4800c3(0xa05)](_0x4800c3(0x4db) + _0x3a6247), _0x4d2b73[_0x4800c3(0x772)](_0x439853, { 'keyPath': 'id' })); } else _0x4a10d5(!![]); } let _0x34d49f = ''; const _0x13ad51 = _0xa7e551(); if (_0x13ad51?.[_0x4800c3(0x9e8)]?.[_0x4800c3(0x705)]) { const _0x4f052c = _0x13ad51[_0x4800c3(0x9e8)], _0x44df69 = await _0x308184(_0x4f052c[_0x4800c3(0x30c)]); if (_0x44df69 && _0x44df69['lyrics']) { if (_0x4800c3(0x3be) !== _0x4800c3(0x3be)) { const _0x4a2ad6 = _0x349b13['getElementById'](_0x4800c3(0x17f)); _0x4a2ad6 && _0x4a2ad6[_0x4800c3(0x7ec)](); } else { const _0x11ea67 = _0x55d2ab(_0x44df69[_0x4800c3(0x5a4)]); if (_0x11ea67[_0x4800c3(0x919)] > 0x0) { const _0x338dbc = _0x57146d[_0x4800c3(0x4e0)]; let _0x5a8531 = -0x1; for (let _0x3a5f75 = 0x0; _0x3a5f75 < _0x11ea67['length']; _0x3a5f75++) { if (_0x338dbc >= _0x11ea67[_0x3a5f75][_0x4800c3(0x5e0)]) _0x5a8531 = _0x3a5f75; else break; } const _0x29b21a = _0x11ea67[_0x4800c3(0xa96)]((_0x26368c, _0x4989ff) => { const _0x5dbb80 = _0x4800c3; if ('zpFLZ' === _0x5dbb80(0x65c)) { const _0x28122a = _0x4989ff === _0x5a8531 ? '>>\x20' : ''; return '' + _0x28122a + _0x26368c['text']; } else _0x204105(_0x5dbb80(0x20d)); })[_0x4800c3(0x63b)]('\x0a'); _0x34d49f = (_0x4800c3(0x308) + _0x4f052c[_0x4800c3(0x6cd)] + '\x20的《' + _0x4f052c[_0x4800c3(0x5ee)] + _0x4800c3(0xab5) + _0x29b21a + _0x4800c3(0x60c))[_0x4800c3(0x74e)](); } } } } let _0x551f4b = '', _0x49c8bc = ''; const _0x2488d1 = _0x29b260['conversationHistory'][_0x4800c3(0x919)]; if (_0x2488d1 > 0x1) { const _0x4a9e96 = _0x29b260['conversationHistory'][_0x2488d1 - 0x2], _0x225be2 = _0x29b260[_0x4800c3(0xa85)][_0x2488d1 - 0x1]; if (_0x4a9e96[_0x4800c3(0x683)] === ![] && _0x225be2[_0x4800c3(0x683)] === !![]) { if (_0x4800c3(0x6c2) !== _0x4800c3(0x6c2)) return ''; else _0x49c8bc = _0x4800c3(0xb2a) + _0x3eb69c[_0x4800c3(0xb15)] + _0x4800c3(0x99e); } else _0x4a9e96[_0x4800c3(0x683)] === !![] && _0x225be2['isOffline'] === ![] && (_0x49c8bc = '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“' + _0x3eb69c[_0x4800c3(0xb15)] + _0x4800c3(0x121)); } if (_0x40b440) { const _0x19c92d = _0x4800c3(0x93a); _0x551f4b = '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“' + _0x3eb69c[_0x4800c3(0xb15)] + _0x4800c3(0xa17) + _0x19c92d + _0x4800c3(0x8ef) + _0x26bc9e[_0x4800c3(0xb15)] + _0x4800c3(0x803) + _0x19c92d + _0x4800c3(0x51e) + _0x19c92d + _0x4800c3(0x384); } else _0x4800c3(0x7fa); const { omniText: _0x3d6442 } = _0x2eac37(_0x26bc9e['id'], _0x352bf7['id']), _0x6903b1 = _0x51a4ba(), _0x7977ca = _0x4312af(_0x26bc9e['id']), _0x2489df = _0x397e34(_0x26bc9e['id']), _0x26eb39 = await _0x9d9188(_0x26bc9e['id']), _0x187a52 = typeof _0x523c1b === 'string' ? _0x523c1b['replaceAll'](_0x4800c3(0x88e), _0x26bc9e[_0x4800c3(0xb15)])[_0x4800c3(0x8c9)](_0x4800c3(0x369), _0x3eb69c[_0x4800c3(0xb15)] || '用户') : '', _0x202a29 = _0x53fca2[_0x4800c3(0xa96)](_0x421cad => _0x421cad['name'])['join'](',\x20'); let _0x73ec07 = ''; if (_0x26bc9e[_0x4800c3(0x5c0)] && _0x26bc9e['linkedWorldBookIds'][_0x4800c3(0x919)] > 0x0) { const _0x177659 = _0x26bc9e['linkedWorldBookIds'][_0x4800c3(0xa96)](_0x2da0b9 => _0x29b260[_0x4800c3(0x1a1)][_0x4800c3(0x444)](_0x54dd6d => _0x54dd6d['id'] === _0x2da0b9))['filter'](Boolean)[_0x4800c3(0xa96)](_0x174f86 => _0x4800c3(0x18e) + _0x174f86[_0x4800c3(0xb15)] + '\x0a' + _0x174f86[_0x4800c3(0x359)])[_0x4800c3(0x63b)](''); if (_0x177659) _0x73ec07 = _0x4800c3(0x3a4) + _0x177659; } const _0x4b6a0a = _0x3eb69c[_0x4800c3(0x435)] ? _0x4800c3(0x7b6) + _0x3eb69c[_0x4800c3(0xb15)] + _0x4800c3(0x282) + _0x3eb69c[_0x4800c3(0x435)] : ''; let _0x31bec5 = ''; const _0x29ee42 = new Date(), _0x143ad8 = _0x18e032(_0x26bc9e['id']); _0x31bec5 = _0x4800c3(0x9bb), _0x31bec5 += _0x4800c3(0x967) + _0x29ee42['toLocaleString'](_0x4800c3(0x513), { 'dateStyle': _0x4800c3(0x728), 'timeStyle': _0x4800c3(0x704) }) + '\x0a'; if (_0x143ad8) { const _0x572efe = new Date(_0x143ad8[_0x4800c3(0x6de)]), _0x2ceab1 = _0x236f37(_0x572efe); _0x31bec5 += _0x4800c3(0xa72) + _0x2ceab1 + '\x0a'; const _0x16f22e = _0x29ee42['toDateString'](), _0x511088 = _0x572efe[_0x4800c3(0x9a6)](), _0x33a4d1 = new Date(); _0x33a4d1[_0x4800c3(0x1ad)](_0x29ee42[_0x4800c3(0x3de)]() - 0x1); const _0x1aa616 = _0x33a4d1[_0x4800c3(0x9a6)](); if (_0x16f22e === _0x511088) { const _0x1e220c = (_0x29ee42 - _0x572efe) / (0x3e8 * 0x3c); _0x1e220c < 0x3c ? _0x4800c3(0xab2) !== 'FZRSA' ? (_0x282833(![]), _0x88062b[_0x4800c3(0x297)](_0x4800c3(0xad3), _0x50cb22), _0x2429ca(_0x4800c3(0x839) + _0x31f06e['message'])) : _0x31bec5 += _0x4800c3(0x468) : _0x31bec5 += _0x4800c3(0x4d4) + Math[_0x4800c3(0x6f8)](_0x1e220c / 0x3c) + _0x4800c3(0x5d8); } else { if (_0x1aa616 === _0x511088) 'GaWyh' === _0x4800c3(0x881) ? _0x31bec5 += _0x4800c3(0x2e7) : (_0x14889b[_0x72f4e4]['classList'][_0x4800c3(0x41a)]('filled'), _0x6790ae[_0x4d132b]['value'] = ''); else { const _0x5b73c1 = Math[_0x4800c3(0x6f8)]((_0x29ee42 - _0x572efe) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x31bec5 += _0x4800c3(0x205) + _0x5b73c1 + _0x4800c3(0x558); } } } else _0x31bec5 += '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a'; const _0x2245cc = ('\x0a' + _0x551f4b + '\x0a你只扮演【' + _0x26bc9e[_0x4800c3(0xb15)] + _0x4800c3(0x1e1) + _0x26bc9e[_0x4800c3(0xb15)] + ':\x22\x20或\x22[' + _0x26bc9e['name'] + _0x4800c3(0x3d6) + _0x202a29 + _0x4800c3(0x2d8) + _0x187a52 + '\x0a')[_0x4800c3(0x74e)](), _0x1dfa27 = [{ 'role': _0x4800c3(0x4c2), 'content': _0x2245cc }], _0x57ae9e = (_0x4800c3(0xa41) + (_0x26bc9e[_0x4800c3(0x435)] || _0x4800c3(0x64d)) + '\x0a' + _0x4b6a0a + '\x20\x0a' + _0x3d6442 + '\x0a' + _0x6903b1 + '\x0a' + _0x7977ca + '\x0a' + _0x2489df + _0x4800c3(0x3ed) + _0x26eb39 + _0x4800c3(0x3a2) + _0x34d49f + '\x0a' + _0x31bec5 + '\x0a' + _0x73ec07 + '\x0a')[_0x4800c3(0x74e)](); _0x57ae9e[_0x4800c3(0x998)](/#.*|\s/g, '') && (_0x1dfa27[_0x4800c3(0x438)]({ 'role': 'user', 'content': _0x57ae9e }), _0x1dfa27['push']({ 'role': _0x4800c3(0x863), 'content': _0x4800c3(0x82b) })); const _0x50ece4 = _0x29b260[_0x4800c3(0xa2a)]?.[_0x4800c3(0x164)] ?? 0x64, _0x3b38ce = _0x29b260[_0x4800c3(0xa85)][_0x4800c3(0x1f9)](-_0x50ece4); for (const _0x53e684 of _0x3b38ce) { const _0xdaffd5 = _0x53e684['role'] === 'ai' || _0x53e684[_0x4800c3(0x456)] === 'assistant' ? 'assistant' : _0x4800c3(0x544); let _0x58d064 = { 'role': _0xdaffd5, 'content': _0x53e684[_0x4800c3(0x359)] }, _0x32fe36 = !!_0x53e684[_0x4800c3(0x359)]; if (_0x53e684[_0x4800c3(0x96e)] && _0x53e684[_0x4800c3(0x359)][_0x4800c3(0x4da)]('表情')) { const _0x343201 = _0x53e684[_0x4800c3(0x359)]['match'](/：(.*?)]$/); _0x58d064[_0x4800c3(0x359)] = _0x4800c3(0x43c) + (_0x343201 ? _0x343201[0x1] : _0x4800c3(0x5c9)) + ']', _0x1dfa27['push'](_0x58d064); } else { if (_0x4800c3(0x966) !== 'NmlRX') return; else { let _0x3ba74f = null; if (_0x53e684[_0x4800c3(0x7ee)]) { if (_0x4800c3(0xa99) === _0x4800c3(0x416)) return [_0x48d05f]; else _0x3ba74f = _0x53e684[_0x4800c3(0x7ee)]; } else { if (_0x53e684[_0x4800c3(0x1bd)]) try { const _0xc8d637 = await _0x2e6c7a(_0x53e684[_0x4800c3(0x1bd)]); _0xc8d637 && (_0x3ba74f = await _0x13346a(_0xc8d637)); } catch (_0x5cd5d6) { console[_0x4800c3(0x297)]('在准备API数据时，从IndexedDB读取图片失败:', _0x5cd5d6); } } if (_0x3ba74f) { if ('YcZVQ' === _0x4800c3(0xa21)) { if (_0x5cd08c) _0xd7fe97[_0x4800c3(0x574)] = '❚❚'; } else _0x58d064[_0x4800c3(0x7ee)] = _0x3ba74f, _0x32fe36 = !![]; } _0x32fe36 && (_0x4800c3(0x32b) !== _0x4800c3(0x95d) ? _0x1dfa27[_0x4800c3(0x438)](_0x58d064) : (_0x28d5bf[_0x4800c3(0x759)](_0x4800c3(0x800))['style'][_0x4800c3(0x3e7)] = _0x4800c3(0x697), _0x3fd5e0(_0x4800c3(0x491), _0x4800c3(0x55f)))); } } } try { const _0x42b769 = await _0x315051(_0x1dfa27); if (!_0x42b769) return ![]; if (_0x40b440) try { if (_0x4800c3(0x606) === _0x4800c3(0x671)) { const _0x313641 = _0x34e535(_0x10e6cf[0x1]), _0x5e17e7 = _0x490a68[0x2][_0x4800c3(0x74e)](), _0x1491a6 = _0xfa68e6(_0x28e768[_0x4800c3(0x7b1)]); let _0x54979a = null; if (_0x5e17e7 === _0x1491a6[_0x4800c3(0xb15)]) _0x54979a = _0x1491a6['id']; else { const _0x19cb2f = _0x5b14b1(); if (_0x19cb2f[_0x4800c3(0x713)] === 'group') { const _0x258bb8 = _0x35a19a[_0x4800c3(0x3db)][_0x4800c3(0x444)](_0xb9801b => _0x19cb2f[_0x4800c3(0x9be)][_0x4800c3(0x4da)](_0xb9801b['id']) && _0xb9801b[_0x4800c3(0xb15)] === _0x5e17e7); if (_0x258bb8) _0x54979a = _0x258bb8['id']; } } if (_0x54979a) return { 'type': _0x4800c3(0x1ce), 'amount': _0x313641, 'recipientId': _0x54979a, 'senderId': _0xeb0fff['id'] }; else return { 'type': _0x4800c3(0x807), 'content': _0x4800c3(0x781) + _0x5e17e7 + '”，但没找到人)' }; } else { let _0x35f5f0 = _0x42b769['trim'](); const _0x25d91f = _0x35f5f0[_0x4800c3(0x6d2)](/(\[[\s\S]*\])/); if (_0x25d91f) { if ('RGGdV' === _0x4800c3(0x82d)) { _0x5ea7b7[_0x4800c3(0x29c)] = _0x4800c3(0x90a); return; } else _0x35f5f0 = _0x25d91f[0x1]; } const _0x36a205 = JSON[_0x4800c3(0x1db)](_0x35f5f0); if (Array['isArray'](_0x36a205)) { _0x29b260[_0x4800c3(0x958)] = [..._0x36a205], _0x29b260[_0x4800c3(0x534)][_0x26bc9e['id']] = [..._0x36a205], _0x4529da(); const _0x4281f9 = _0x36a205[_0x4800c3(0xa96)](_0x1f0e47 => _0x1f0e47[_0x4800c3(0x3c1)] === _0x4800c3(0x9b5) ? _0x1f0e47['line'] : _0x1f0e47['speaker'] + ':\x20' + _0x1f0e47[_0x4800c3(0x81d)])[_0x4800c3(0x63b)]('\x0a\x0a'); _0x29b260['conversationHistory'][_0x4800c3(0x438)]({ 'role': 'assistant', 'senderId': _0x26bc9e['id'], 'timestamp': Date['now'](), 'isOffline': !![], 'content': _0x4281f9 }); } } } catch (_0x5eb51d) { _0x4800c3(0x8f0) === _0x4800c3(0x99b) ? (_0x4c4814(![]), _0x1c0a17[_0x4800c3(0x297)](_0x4800c3(0x75d), _0x1223c6), _0x403af5(_0x4800c3(0xad9) + _0x4c8ccb[_0x4800c3(0x997)])) : (console[_0x4800c3(0x297)](_0x4800c3(0x5d5), _0x5eb51d, _0x4800c3(0x769), _0x42b769), _0x29b260[_0x4800c3(0xa85)][_0x4800c3(0x438)]({ 'role': _0x4800c3(0x863), 'senderId': _0x26bc9e['id'], 'timestamp': Date[_0x4800c3(0x74c)](), 'isOffline': !![], 'content': '[AI返回了无法解析的剧本:\x20' + _0x42b769 + ']' })); } else { const _0x1eb5c0 = _0x375b91(_0x42b769), _0x1efc6e = _0x1eb5c0['map'](_0x47c99c => { const _0x4b57eb = _0x4800c3, _0xee5d97 = _0x47c99c[_0x4b57eb(0x74e)](), _0x149dc8 = _0xee5d97[_0x4b57eb(0x6d2)](/^\[sticker:(.*?)\]$/), _0xf6839 = _0xee5d97['match'](/^\[transfer:([\d.]+)\|(.*?)\]$/), _0x2c4a84 = _0xee5d97[_0x4b57eb(0x6d2)](/^\[music:(.*?)\|(.*?)\]$/), _0xeabf52 = _0xee5d97[_0x4b57eb(0x6d2)](/^\[create_event:(.*?)\|(.*?)\|(.*?)\]$/); if (_0x2c4a84) return { 'type': _0x4b57eb(0xa7c), 'songName': _0x2c4a84[0x1][_0x4b57eb(0x74e)](), 'artist': _0x2c4a84[0x2][_0x4b57eb(0x74e)]() }; else { if (_0x149dc8) { if ('fYxHs' === _0x4b57eb(0x6a7)) { const _0x32125f = (_0x1e2d30[_0x4b57eb(0x638)] || [])[_0x4b57eb(0xa96)](_0x316316 => _0x4b57eb(0x811) + _0x316316 + _0x4b57eb(0x20c))[_0x4b57eb(0x63b)](''); return '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20padding:\x2015px;\x20background:\x20white;\x20box-shadow:\x20var(--soft-shadow);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2012px;\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x20padding-bottom:\x2010px;\x20margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x201.8rem;\x20flex-shrink:\x200;\x22>🍜</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20600;\x20font-size:\x201.05rem;\x22>' + (_0x258ff7[_0x4b57eb(0x871)] || _0x4b57eb(0xa2f)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22font-size:\x200.75rem;\x22>' + (_0x4ff2e9[_0x4b57eb(0x6de)] || '') + _0x4b57eb(0x178) + (_0x2f4d66[_0x4b57eb(0x70f)] || _0x4b57eb(0xa10)) + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22order-items-container\x22\x20style=\x22display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x204px;\x20margin-bottom:\x2012px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x32125f + _0x4b57eb(0x8e3) + (_0x2a5b89[_0x4b57eb(0x2d2)] || 0x0)[_0x4b57eb(0x394)](0x2) + _0x4b57eb(0x23b); } else return { 'type': 'sticker', 'name': _0x149dc8[0x1][_0x4b57eb(0x74e)]() }; } else { if (_0xeabf52) { if (_0x4b57eb(0x2f8) !== 'TwhNU') { const _0x35813d = _0x378d61[_0x4b57eb(0x759)]('confirm-altar-upload-button'); _0x14327c[_0x4b57eb(0x44c)] && _0x45c8fb[_0x4b57eb(0x92c)] ? _0x35813d[_0x4b57eb(0x4b9)] = ![] : _0x35813d[_0x4b57eb(0x4b9)] = !![]; } else return { 'type': _0x4b57eb(0x39f), 'eventType': _0xeabf52[0x1][_0x4b57eb(0x74e)](), 'eventDate': _0xeabf52[0x2][_0x4b57eb(0x74e)](), 'eventContent': _0xeabf52[0x3][_0x4b57eb(0x74e)]() }; } else { if (_0xf6839) { const _0x672ea7 = parseFloat(_0xf6839[0x1]), _0x5318e5 = _0xf6839[0x2]['trim'](), _0xf56eb3 = _0x33ec75(_0x29b260[_0x4b57eb(0x7b1)]); let _0xbddd65 = null; if (_0x5318e5 === _0xf56eb3[_0x4b57eb(0xb15)]) _0xbddd65 = _0xf56eb3['id']; else { if ('cXBzy' === 'DtYDY') _0x157c4c[_0x4b57eb(0x438)]({ 'name': _0x3b3822[0x0]['trim'](), 'url': _0x10111e[0x1][_0x4b57eb(0x74e)]() }); else { const _0x3ead9b = _0xa7e551(); if (_0x3ead9b[_0x4b57eb(0x713)] === 'group') { if (_0x4b57eb(0xb08) !== _0x4b57eb(0xb08)) _0x19200c += '-\x20**状态提示**:\x20你和Ta上次聊天是在昨天，注意你发言的时间感。\x0a'; else { const _0x3c08b3 = _0x29b260[_0x4b57eb(0x3db)][_0x4b57eb(0x444)](_0x1b7424 => _0x3ead9b[_0x4b57eb(0x9be)]['includes'](_0x1b7424['id']) && _0x1b7424[_0x4b57eb(0xb15)] === _0x5318e5); if (_0x3c08b3) _0xbddd65 = _0x3c08b3['id']; } } } } if (_0xbddd65) return { 'type': _0x4b57eb(0x1ce), 'amount': _0x672ea7, 'recipientId': _0xbddd65, 'senderId': _0x26bc9e['id'] }; else return { 'type': 'text', 'content': _0x4b57eb(0x781) + _0x5318e5 + _0x4b57eb(0x4c5) }; } else { if (_0xee5d97) return { 'type': 'text', 'content': _0xee5d97 }; } } } } return null; })[_0x4800c3(0x9f6)](Boolean), _0x5e5073 = async _0xc6f71a => { const _0x1b67c2 = _0x4800c3, _0xbd6fa8 = { 'role': _0x1b67c2(0x863), 'senderId': _0x26bc9e['id'], 'timestamp': Date[_0x1b67c2(0x74c)](), 'isOffline': _0x40b440 }; if (_0xc6f71a['type'] === _0x1b67c2(0xa7c)) { const { songName: _0x510e1a, artist: _0x4b702a } = _0xc6f71a; _0xbd6fa8[_0x1b67c2(0x713)] = _0x1b67c2(0xa7c), _0xbd6fa8[_0x1b67c2(0x359)] = _0x1b67c2(0x2f4) + _0x510e1a + '\x20-\x20' + _0x4b702a + ']'; try { const _0x4a2e21 = await _0x1533cb(_0x510e1a, _0x4b702a); let _0x3538ef = null; if (_0x4a2e21[_0x1b67c2(0x194)]) { const _0x1c8161 = await _0xd3e742(_0x4a2e21[_0x1b67c2(0x194)]); _0x3538ef = _0x1b67c2(0x45c) + Date[_0x1b67c2(0x74c)]() + '_' + Math[_0x1b67c2(0x545)](), await _0x5b0aee(_0x3538ef, _0x1c8161); } Object[_0x1b67c2(0x37b)](_0xbd6fa8, { 'songName': _0x510e1a, 'artist': _0x4b702a, 'coverId': _0x3538ef, 'playableUrl': _0x4a2e21['url'] }); } catch (_0x2f9949) { Object[_0x1b67c2(0x37b)](_0xbd6fa8, { 'songName': _0x510e1a, 'artist': _0x4b702a, 'coverId': null, 'playableUrl': null }); } } else { if (_0xc6f71a[_0x1b67c2(0x713)] === _0x1b67c2(0x3b5)) { const _0xc53ac2 = _0x53fca2[_0x1b67c2(0x444)](_0x61c87f => _0x61c87f[_0x1b67c2(0xb15)] === _0xc6f71a[_0x1b67c2(0xb15)]); if (_0xc53ac2) Object[_0x1b67c2(0x37b)](_0xbd6fa8, { 'content': '[AI发送了表情：' + _0xc53ac2['name'] + ']', 'displayUrl': _0xc53ac2[_0x1b67c2(0x8b7)] }); else _0xbd6fa8['content'] = _0x1b67c2(0x43c) + _0xc6f71a[_0x1b67c2(0xb15)] + ']'; } else { if (_0xc6f71a[_0x1b67c2(0x713)] === _0x1b67c2(0x1ce)) { if (_0x1b67c2(0x876) !== _0x1b67c2(0x3d8)) { const _0x2a6045 = _0xc6f71a['recipientId'] === _0x33ec75(_0x29b260['activeChatId'])['id'] ? _0x33ec75(_0x29b260[_0x1b67c2(0x7b1)]) : _0x4cc875(_0xc6f71a[_0x1b67c2(0x22b)]); Object[_0x1b67c2(0x37b)](_0xbd6fa8, { 'type': _0x1b67c2(0x1ce), 'amount': _0xc6f71a['amount'], 'recipientId': _0xc6f71a[_0x1b67c2(0x22b)], 'content': _0x1b67c2(0x596) + (_0x2a6045?.['name'] || '未知') + '\x20转账\x20' + _0xc6f71a[_0x1b67c2(0x549)] + ']' }); } else { const _0x53cd2a = _0x34c5ea[_0x1b67c2(0x958)]['shift'](); _0x2bbbfd[_0x1b67c2(0x574)] = _0x53cd2a['speaker'] === _0x1b67c2(0x9b5) ? '旁白' : _0x53cd2a[_0x1b67c2(0x3c1)], _0x3d20d1[_0x1b67c2(0x574)] = _0x53cd2a[_0x1b67c2(0x81d)], _0x53cd2a[_0x1b67c2(0x3c1)] !== _0x1b67c2(0x9b5) && _0x1bcadc(_0xd8b7c9[_0x1b67c2(0x49a)], _0x53cd2a[_0x1b67c2(0x279)]); } } else { if (_0xc6f71a[_0x1b67c2(0x713)] === _0x1b67c2(0x39f)) { if (_0x1b67c2(0x957) !== _0x1b67c2(0x957)) _0x25e3a8(_0x140fd0), _0xc3164b(); else { const _0x36e541 = _0x33ec75(_0x352bf7['id']); if (!_0x36e541 || !_0x36e541['id']) return console[_0x1b67c2(0x297)]('AI\x20试图创建事件，但找不到有效的用户ID。'), null; _0x29b260[_0x1b67c2(0x901)]['push']({ 'id': _0x1b67c2(0x621) + Date[_0x1b67c2(0x74c)](), 'date': _0xc6f71a[_0x1b67c2(0x6ea)], 'type': _0xc6f71a[_0x1b67c2(0x411)], 'content': _0xc6f71a[_0x1b67c2(0x420)], 'userId': _0x36e541['id'], 'createdBy': 'ai' }), _0xf10e4a(), _0x5d1f00(), _0x5bea2a(); const _0x24fed8 = _0x4cc875(_0x26bc9e['id']); _0x24fed8 && _0xc6f71a[_0x1b67c2(0x411)] === _0x1b67c2(0x7ea) && ('XSWOO' !== _0x1b67c2(0xade) ? (_0x350f9f['appendChild'](_0x2447d0), _0x48ffc5[_0x1b67c2(0x25f)](_0x4fe253)) : _0xeba69d(_0x1b67c2(0xa47) + _0x24fed8['name'] + _0x1b67c2(0x657) + _0xc6f71a[_0x1b67c2(0x420)])); return { 'role': _0x1b67c2(0x863), 'senderId': _0x26bc9e['id'], 'timestamp': Date['now'](), 'isOffline': _0x40b440, 'content': null }; return { 'role': _0x1b67c2(0x863), 'senderId': _0x26bc9e['id'], 'timestamp': Date[_0x1b67c2(0x74c)](), 'isOffline': _0x40b440, 'content': null }; } } else { const _0x4caf51 = _0x4b2b82(_0xc6f71a['content']); Object[_0x1b67c2(0x37b)](_0xbd6fa8, { 'content': _0x4caf51[_0x1b67c2(0x359)], 'quotedMessage': _0x4caf51[_0x1b67c2(0x554)] }); } } } } return _0xbd6fa8; }, _0x1acdde = await Promise['all'](_0x1efc6e[_0x4800c3(0xa96)](_0x5e5073)); for (const _0x3a02cd of _0x1acdde) { _0x4800c3(0x684) === _0x4800c3(0x4a6) ? _0x57ff27['push'](_0x538418) : (_0x3a02cd[_0x4800c3(0x359)] || _0x3a02cd[_0x4800c3(0x96e)] || _0x3a02cd[_0x4800c3(0x713)] === _0x4800c3(0xa7c)) && (await new Promise(_0xb73451 => setTimeout(_0xb73451, 0x12c + Math[_0x4800c3(0x545)]() * 0x190)), _0x29b260[_0x4800c3(0xa85)][_0x4800c3(0x438)](_0x3a02cd), _0x3cfad8()); } } return _0x3254df(), _0x3cfad8(), !![]; } catch (_0x180b4c) { if (_0x180b4c[_0x4800c3(0xb15)] !== 'AbortError') { if (_0x4800c3(0x693) === _0x4800c3(0x693)) { console['error'](_0x4800c3(0xb0c), _0x180b4c); const _0x303814 = { 'role': _0x4800c3(0x863), 'content': _0x4800c3(0xaf9) + _0x180b4c['message'], 'senderId': _0x26bc9e['id'], 'isOffline': _0x40b440 }; _0x29b260[_0x4800c3(0xa85)][_0x4800c3(0x438)](_0x303814), _0x3cfad8(); } else { _0x22b60c(_0x4800c3(0xa56)); return; } } return ![]; } finally { if ('DqVAy' === _0x4800c3(0x14c)) { const _0x5e6b0d = _0x511daf[_0x4800c3(0x251)](_0x5f2c2a); _0x5e6b0d && _0x5e6b0d[_0x4800c3(0x736)]('appIconPosition_') && _0x4d3694[_0x4800c3(0x438)](_0x5e6b0d); } else _0x4a10d5(![]); } } async function _0x2e91d2() { const _0x2c5351 = _0x187760, _0x1631b2 = _0xa7e551(); if (!_0x1631b2 || _0x1631b2['type'] !== 'private') { _0xeba69d('哼，只有私聊才能进行总结，群聊那么乱怎么记！'); return; } if (_0x29b260[_0x2c5351(0x27c)]) { _0xeba69d(_0x2c5351(0x577)); return; } const _0x5d1a63 = await _0x5db04d(_0x2c5351(0x40c)); if (!_0x5d1a63) return; _0x195491(!![], _0x2c5351(0x908)), _0x4ab829[_0x2c5351(0xa03)] = '', _0x3f4547[_0x2c5351(0x969)][_0x2c5351(0x944)]('show'), _0x29b260[_0x2c5351(0x27c)] = !![]; try { const _0x229428 = _0x4cc875(_0x1631b2[_0x2c5351(0x9be)][0x0]), _0x23fcbe = _0x33ec75(_0x1631b2['id']), _0x296d3 = _0x5f3de7(_0x1631b2['id']); if (_0x296d3['length'] === 0x0) { _0x4ab829['value'] = '#\x20记录是空的，没什么好总结的。'; return; } const _0x241b50 = _0x296d3[_0x2c5351(0xa96)](_0x3d6864 => { const _0x43cf08 = _0x2c5351, _0x334f47 = new Date(_0x3d6864[_0x43cf08(0x6de)]), _0x139ff8 = _0x334f47[_0x43cf08(0xb29)]() + '-' + String(_0x334f47[_0x43cf08(0x950)]() + 0x1)[_0x43cf08(0x27e)](0x2, '0') + '-' + String(_0x334f47[_0x43cf08(0x3de)]())[_0x43cf08(0x27e)](0x2, '0'), _0x99723a = String(_0x334f47[_0x43cf08(0xb06)]())[_0x43cf08(0x27e)](0x2, '0') + ':' + String(_0x334f47['getMinutes']())[_0x43cf08(0x27e)](0x2, '0'); let _0x1ff750 = '未知'; _0x3d6864[_0x43cf08(0x456)] === _0x43cf08(0x544) ? 'FHbsg' !== _0x43cf08(0x1b7) ? _0x1ff750 = _0x23fcbe['name'] : (_0x56c241[_0x43cf08(0x554)] = { 'sender': _0x419908[0x1][_0x43cf08(0x74e)](), 'content': _0x17cba2[0x2]['trim']() }, _0x1201c8[_0x43cf08(0x359)] = _0xcf8e3b[_0x43cf08(0x6af)](_0x49302a[0x0][_0x43cf08(0x919)])[_0x43cf08(0x74e)]()) : _0x43cf08(0xa27) === _0x43cf08(0x2fd) ? _0x487dea(_0x43cf08(0xaf9) + _0x5d7338[_0x43cf08(0x997)]) : _0x1ff750 = _0x229428[_0x43cf08(0xb15)]; let _0xc1ab75 = _0x3d6864['content']; if (_0x3d6864[_0x43cf08(0x96e)]) _0xc1ab75 = _0x43cf08(0x652); if (_0x3d6864[_0x43cf08(0x1bd)]) _0xc1ab75 = _0x43cf08(0x776); return '[' + _0x139ff8 + '\x20' + _0x99723a + _0x43cf08(0x985) + _0x1ff750 + ']:\x20' + _0xc1ab75; })[_0x2c5351(0x63b)]('\x0a'), _0x3bd16e = _0x187e7a['replace'](/{charName}/g, _0x229428[_0x2c5351(0xb15)])[_0x2c5351(0x998)](/{userName}/g, _0x23fcbe[_0x2c5351(0xb15)]), _0x36c08e = [{ 'role': _0x2c5351(0x4c2), 'content': _0x3bd16e }, { 'role': _0x2c5351(0x544), 'content': _0x241b50 }], _0x2d82bc = await _0x315051(_0x36c08e); _0x4ab829[_0x2c5351(0xa03)] = _0x2d82bc || _0x2c5351(0x219), _0x4ab829['scrollTop'] = 0x0; } catch (_0x29bde4) { console[_0x2c5351(0x297)]('总结失败:', _0x29bde4), _0x4ab829[_0x2c5351(0xa03)] = '#\x20发生错误：\x0a' + _0x29bde4['message']; } finally { _0x195491(![]), _0x29b260['isGenerating'] = ![]; } } async function _0x1ae21f() { const _0x2c82bd = _0x187760; console[_0x2c82bd(0xa05)]('---\x20开始AI回复流程\x20---'); if (!_0x29b260['apiSettings']['endpoint'] || !_0x29b260['apiSettings'][_0x2c82bd(0x251)] || !_0x29b260['apiSettings'][_0x2c82bd(0x48a)]) { _0xeba69d(_0x2c82bd(0x49f)); return; } const _0x3ecbb3 = _0x29b260['conversationHistory']['at'](-0x1)?.[_0x2c82bd(0x456)] === _0x2c82bd(0x544); if (!_0x3ecbb3 || _0x29b260[_0x2c82bd(0x27c)]) return; const _0x58cf40 = _0xa7e551(); if (!_0x58cf40) return; _0x29b260[_0x2c82bd(0x27c)] = !![], _0x4a10d5(!![]); try { if (_0x2c82bd(0x2ca) === 'NPgql') { const _0x26c28f = _0x2537db[_0x2c82bd(0x3db)][_0x2c82bd(0x444)](_0x4c083f => _0x4c083f['id'] === _0x187d08); _0x26c28f && _0x4321e1[_0x2c82bd(0x37b)](_0x26c28f, _0x16d8bc); } else { if (_0x58cf40[_0x2c82bd(0x713)] === _0x2c82bd(0x7ad)) { if (_0x2c82bd(0x748) === _0x2c82bd(0x748)) { const _0x1a2228 = _0x4cc875(_0x58cf40[_0x2c82bd(0x9be)][0x0]); console[_0x2c82bd(0xa05)]('准备调用\x20generateAs...'); if (_0x1a2228) await _0x430bb8(_0x1a2228, { 'force': !![] }); } else { const _0x3775da = (_0x3e90eb - _0x49c39d) / (0x3e8 * 0x3c); _0x5d3445 += '-\x20**状态提示**:\x20你的生活正在进行中，生成的内容应该是“刚才”或“几分钟前”发生的。\x0a'; } } else { if (_0x2c82bd(0x9d0) === _0x2c82bd(0x9d0)) { const _0x48a598 = await _0x1bfe32(); if (_0x48a598 && _0x48a598['events']?.[_0x2c82bd(0x919)]) _0x2c82bd(0x3f4) === _0x2c82bd(0x3f4) ? await _0x58f018(_0x48a598) : _0x4f651c += _0x2c82bd(0xa3f) + _0x16b313[_0x2c82bd(0xaa4)] + _0x2c82bd(0x18b) + _0x4a1ff0['item_name'] + _0x2c82bd(0x18d); else { console[_0x2c82bd(0x2b1)](_0x2c82bd(0x5db)); const _0x40b3a7 = _0x58cf40['participantIds'][_0x2c82bd(0xa96)](_0x4cc875)[_0x2c82bd(0x9f6)](Boolean); if (!_0x40b3a7[_0x2c82bd(0x919)]) return; let _0x40bd4d = 0x0; for (const _0x100e6b of _0x40b3a7) { _0x430bb8(_0x100e6b, { 'force': !![], 'delayMs': _0x40bd4d }), _0x40bd4d += 0x1f4; } } } else _0x398dad(_0x48b8cf[_0x2c82bd(0xa0f)](_0x30521d, _0x53778c)); } } } catch (_0x5ee687) { _0x2c82bd(0x556) !== _0x2c82bd(0x68b) ? _0x5ee687[_0x2c82bd(0xb15)] !== _0x2c82bd(0x1b8) && (console[_0x2c82bd(0x297)](_0x2c82bd(0x5c1), _0x5ee687), _0x3a1b12({ 'role': _0x2c82bd(0x863), 'content': _0x2c82bd(0xaf9) + _0x5ee687[_0x2c82bd(0x997)] }, _0x29b260[_0x2c82bd(0xa85)][_0x2c82bd(0x919)] - 0x1)) : (_0x1a2188[_0x2c82bd(0x479)](), _0x5090fe()); } finally { _0x29b260[_0x2c82bd(0x27c)] = ![], _0x4a10d5(![]); } } function _0x4f82fa(_0x3ccc7b, _0x5cbf7d) { const _0x534c93 = _0x187760, _0x5d45b9 = _0x5cbf7d[_0x534c93(0x99d)](), _0x47b968 = _0x3ccc7b[_0x534c93(0x99d)](); if (_0x5d45b9[_0x534c93(0x736)](_0x534c93(0x482))) return 'anthropic'; if (_0x47b968[_0x534c93(0x4da)](_0x534c93(0x342))) return _0x534c93(0xa04); if (_0x47b968[_0x534c93(0x4da)](_0x534c93(0x488))) return 'gemini'; if (_0x5d45b9[_0x534c93(0x736)](_0x534c93(0x4c4))) return _0x534c93(0x4c4); return _0x534c93(0x7d5); } async function _0x315051(_0x1610a8, _0x22dfef = {}) { const _0xc79a49 = _0x187760; if (_0xc79a49(0x3e1) !== _0xc79a49(0x3e1)) { const _0xad1cee = _0x53bf5b(_0x57fe07[_0xc79a49(0x6b7)], _0x3cdb87[_0xc79a49(0x54c)], _0x27d196); if (_0xad1cee[_0xc79a49(0x919)] === 0x0) return; const _0x449c9f = _0x19912e === 0x0 ? _0xc79a49(0x906) : _0xc79a49(0x212); _0x19c1a4[_0xc79a49(0x438)](_0xc79a49(0x292) + _0x449c9f + _0x573dd8(_0x3ce0af['chat']) + '\x0a' + _0xad1cee[_0xc79a49(0x63b)]('\x0a')), _0x30c65c[_0x1f7893[_0xc79a49(0x6b7)]['id']] = _0xad1cee[_0xc79a49(0x919)]; } else { _0x29b260[_0xc79a49(0x243)] && _0x29b260[_0xc79a49(0x243)][_0xc79a49(0x80c)](_0xc79a49(0x1a2)); _0x29b260['currentAbortController'] = new AbortController(); const _0x3b4424 = _0x29b260[_0xc79a49(0x243)][_0xc79a49(0x5e5)], { endpoint: _0x182307, key: _0x4251f2, model: _0x273ae1 } = _0x29b260[_0xc79a49(0x7d3)], _0x27d5bc = !!_0x22dfef[_0xc79a49(0x395)], _0x549003 = _0x4f82fa(_0x182307, _0x273ae1); console[_0xc79a49(0xa05)](_0xc79a49(0x5a1) + _0x549003); let _0x4e0267 = ''; try { if (_0xc79a49(0x3b7) === _0xc79a49(0x95c)) { _0x3532f1(_0xc79a49(0x756)); return; } else { switch (_0x549003) { case 'anthropic': { const _0x219927 = _0x4f3d46(_0x4251f2), _0x37e00e = _0x1610a8[_0xc79a49(0x444)](_0x273bd8 => _0x273bd8[_0xc79a49(0x456)] === _0xc79a49(0x4c2))?.[_0xc79a49(0x359)] || '', _0x189d8c = _0x1610a8[_0xc79a49(0x9f6)](_0xf6126f => _0xf6126f[_0xc79a49(0x456)] !== _0xc79a49(0x4c2)), _0x1a6ac1 = { 'model': _0x273ae1, 'system': _0x37e00e, 'messages': _0x189d8c[_0xc79a49(0xa96)](_0x3a7c79 => ({ 'role': _0x3a7c79['role'], 'content': [{ 'type': _0xc79a49(0x807), 'text': _0x3a7c79[_0xc79a49(0x359)] }] })), 'max_tokens': 0x1000 }, _0x1f8a4d = await fetch(_0x182307, { 'method': _0xc79a49(0x79f), 'headers': { 'Content-Type': _0xc79a49(0x827), 'x-api-key': _0x219927, 'anthropic-version': '2023-06-01' }, 'body': JSON[_0xc79a49(0x2a5)](_0x1a6ac1), 'signal': _0x3b4424 }); if (!_0x1f8a4d['ok']) { const _0x15a8ad = await _0x1f8a4d[_0xc79a49(0x395)]()[_0xc79a49(0x29a)](() => ({})); throw new Error(_0xc79a49(0x66a) + _0x1f8a4d[_0xc79a49(0x70f)] + _0xc79a49(0x84c) + (_0x15a8ad['error']?.[_0xc79a49(0x997)] || _0x1f8a4d['statusText'])); } const _0xf251a5 = await _0x1f8a4d[_0xc79a49(0x395)](); _0x4e0267 = _0xf251a5[_0xc79a49(0x359)]?.[0x0]?.[_0xc79a49(0x807)] || ''; break; } case _0xc79a49(0x4c4): { if (_0xc79a49(0x618) === 'BTFsN') { const _0x2007ec = _0x4f3d46(_0x4251f2), _0x4571f0 = _0x182307['includes'](_0xc79a49(0x4e9)), _0x14a345 = _0x502d34 => { const _0x4d782c = _0xc79a49, _0x54f853 = []; if (_0x502d34[_0x4d782c(0x359)]) _0x54f853[_0x4d782c(0x438)]({ 'text': _0x502d34[_0x4d782c(0x359)] }); if (_0x502d34[_0x4d782c(0x7ee)]) { const _0x96211e = _0x502d34[_0x4d782c(0x7ee)]['split'](',')[0x1], _0xefda29 = _0x502d34[_0x4d782c(0x7ee)]['substring'](_0x502d34[_0x4d782c(0x7ee)]['indexOf'](':') + 0x1, _0x502d34[_0x4d782c(0x7ee)][_0x4d782c(0x8d5)](';')) || 'image/jpeg'; _0x54f853['push']({ 'inline_data': { 'mime_type': _0xefda29, 'data': _0x96211e } }); } return _0x54f853; }, _0x9e81b2 = _0x1610a8['map'](_0xd29f3f => ({ 'role': _0xd29f3f[_0xc79a49(0x456)] === _0xc79a49(0x863) ? _0xc79a49(0x48a) : _0xd29f3f[_0xc79a49(0x456)] === _0xc79a49(0x4c2) ? _0xc79a49(0x544) : _0xd29f3f['role'], 'parts': _0x14a345(_0xd29f3f) }))['filter'](_0x41eb50 => _0x41eb50[_0xc79a49(0x802)][_0xc79a49(0x919)] > 0x0), _0x49af93 = { 'contents': _0x9e81b2 }; _0x27d5bc && _0x4571f0 && (_0xc79a49(0x16e) === _0xc79a49(0x20f) ? _0x56014e[_0xc79a49(0x297)](_0xc79a49(0x19d), _0x577b98) : _0x49af93[_0xc79a49(0x347)] = { 'response_mime_type': _0xc79a49(0x827) }); const _0x193ef4 = _0x182307 + '/v1beta/models/' + _0x273ae1 + _0xc79a49(0xaae) + _0x2007ec + '&alt=sse', _0x45c397 = await fetch(_0x193ef4, { 'method': _0xc79a49(0x79f), 'headers': { 'Content-Type': 'application/json' }, 'body': JSON[_0xc79a49(0x2a5)](_0x49af93), 'signal': _0x3b4424 }); if (!_0x45c397['ok']) throw new Error(_0xc79a49(0x730) + _0x45c397[_0xc79a49(0x70f)]); const _0x266370 = _0x45c397['body']['getReader'](), _0x416ad7 = new TextDecoder(); let _0x14df93 = ''; while (!![]) { if (_0x3b4424[_0xc79a49(0x306)]) { console[_0xc79a49(0xa05)]('Gemini\x20stream\x20reading\x20aborted.'), _0x266370[_0xc79a49(0x648)](); break; } const { done: _0x1087c9, value: _0x241e1e } = await _0x266370[_0xc79a49(0x42d)](); if (_0x1087c9) break; const _0x470fbf = _0x416ad7[_0xc79a49(0x746)](_0x241e1e, { 'stream': !![] }), _0x55ce98 = _0x470fbf[_0xc79a49(0x77e)]('\x0a')[_0xc79a49(0x9f6)](_0x1b9289 => _0x1b9289[_0xc79a49(0x74e)]()[_0xc79a49(0x736)](_0xc79a49(0x69a))); for (const _0xd3c862 of _0x55ce98) { const _0x39ed53 = _0xd3c862[_0xc79a49(0x998)](_0xc79a49(0x14a), ''); if (_0x39ed53 === _0xc79a49(0x70d)) break; try { _0x14df93 += JSON[_0xc79a49(0x1db)](_0x39ed53)[_0xc79a49(0x5b9)][0x0][_0xc79a49(0x359)][_0xc79a49(0x802)][0x0][_0xc79a49(0x807)]; } catch { } } } _0x4e0267 = _0x14df93; break; } else _0x2cd6a3[_0xc79a49(0x80f)][_0xc79a49(0xad6)] = ''; } case _0xc79a49(0x7d5): default: { const _0x49a1c6 = _0x4f3d46(_0x4251f2), _0x419a89 = _0x182307['replace'](/\/+$/, '') + _0xc79a49(0x976), _0x42d5d9 = _0x1610a8[_0xc79a49(0xa96)](_0x5c74df => { const _0x5f5170 = _0xc79a49; if (_0x5f5170(0x624) === _0x5f5170(0x26d)) _0x1f71ad[_0x5f5170(0x759)](_0x5f5170(0x9ff))[_0x5f5170(0x686)] = _0xbce17b[_0x5f5170(0x96f)] || _0xc64b29; else { if (_0x5c74df[_0x5f5170(0x456)] === _0x5f5170(0x544) && _0x5c74df[_0x5f5170(0x7ee)]) return { 'role': 'user', 'content': [{ 'type': _0x5f5170(0x807), 'text': _0x5c74df[_0x5f5170(0x359)] || '\x20' }, { 'type': _0x5f5170(0x27f), 'image_url': { 'url': _0x5c74df['image'], 'detail': _0x5f5170(0x2f6) } }] }; return { 'role': _0x5c74df[_0x5f5170(0x456)], 'content': _0x5c74df['content'] }; } })[_0xc79a49(0x9f6)](_0x319a35 => _0x319a35['content']), _0x571aa7 = { 'model': _0x273ae1, 'messages': _0x42d5d9, 'max_tokens': 0x1000, ..._0x27d5bc ? { 'response_format': { 'type': _0xc79a49(0x6e8) } } : {} }, _0x24a976 = await fetch(_0x419a89, { 'method': _0xc79a49(0x79f), 'headers': { 'Content-Type': 'application/json', 'Authorization': _0xc79a49(0xa0b) + _0x49a1c6 }, 'body': JSON['stringify'](_0x571aa7), 'signal': _0x3b4424 }); if (!_0x24a976['ok']) { if (_0xc79a49(0x99f) !== 'JpuBJ') { const _0x3f5d0c = await _0x24a976[_0xc79a49(0x395)]()[_0xc79a49(0x29a)](() => ({})); throw new Error(_0xc79a49(0x283) + _0x24a976['status'] + '\x20-\x20' + (_0x3f5d0c[_0xc79a49(0x297)]?.[_0xc79a49(0x997)] || _0x24a976[_0xc79a49(0x3b1)])); } else _0x197862('有\x20' + _0x5d17c3 + _0xc79a49(0x2d9)); } const _0x19fa5f = await _0x24a976[_0xc79a49(0x395)](); _0x4e0267 = _0x19fa5f[_0xc79a49(0x918)]?.[0x0]?.[_0xc79a49(0x997)]?.[_0xc79a49(0x359)] || ''; break; } }return _0x4e0267; } } catch (_0x5a25c3) { if (_0x5a25c3['name'] === 'AbortError') return console['log'](_0xc79a49(0x95e)), ''; throw _0x5a25c3; } finally { if (_0x29b260[_0xc79a49(0x243)] && _0x29b260[_0xc79a49(0x243)][_0xc79a49(0x5e5)] === _0x3b4424) { if ('jiLzW' !== 'jiLzW') { _0x83a867(_0xc79a49(0x345)); return; } else _0x29b260[_0xc79a49(0x243)] = null; } } } } async function _0x209a6e() { const _0x12481a = _0x187760, _0x432b71 = _0x429a11[_0x12481a(0x3c9)][_0x12481a(0x969)][_0x12481a(0x233)]('active'), _0x56f1ac = _0x432b71 ? _0x2f40df[_0x12481a(0xa03)] : null; let _0x386495 = null, _0x92c59b = ''; if (_0x432b71 && _0x56f1ac) { if ('dgsVl' !== 'tEDBs') { _0x386495 = _0x29b260[_0x12481a(0x6df)]['find'](_0x1f48f9 => _0x1f48f9[_0x12481a(0x713)] === _0x12481a(0x7ad) && _0x1f48f9[_0x12481a(0x9be)]['includes'](_0x56f1ac)); const _0x1a887a = _0x4cc875(_0x56f1ac); _0x92c59b = _0x1a887a ? _0x1a887a['name'] : _0x12481a(0xa00); } else _0x1cc009[_0x12481a(0x1bd)] = _0x252d1a; } else { if (_0x29b260[_0x12481a(0x7b1)]) { if (_0x12481a(0x383) !== 'eisgN') { _0x386495 = _0xa7e551(); const _0x4a65ad = document[_0x12481a(0x759)](_0x12481a(0x51d))['textContent']; _0x92c59b = _0x4a65ad || _0x12481a(0x1f1); } else { const _0x4a8c2d = _0x4cb3bd['getElementById'](_0x12481a(0x782)); if (_0x4a8c2d) _0x4a8c2d['textContent'] = '❚❚'; } } } if (!_0x386495) { _0xeba69d(_0x12481a(0x6f3)); return; } const _0x5e2323 = await _0x5db04d(_0x12481a(0x49b) + _0x92c59b + _0x12481a(0x2dd)); if (!_0x5e2323) return; _0x386495['id'] === _0x29b260[_0x12481a(0x7b1)] && (_0x1a130b(), _0x29b260[_0x12481a(0xa85)] = [], _0x448e33()); try { localStorage['removeItem']('chatHistory_' + _0x386495['id']); } catch (_0x21e37c) { console[_0x12481a(0x297)](_0x12481a(0x8a3) + _0x386495['id'], _0x21e37c); } _0xeba69d('\x22' + _0x92c59b + _0x12481a(0x190)); } const _0x5508cf = document['getElementById'](_0x187760(0x450)), _0x16bed8 = document[_0x187760(0x759)](_0x187760(0x8a8)), _0x7b9eab = document[_0x187760(0x759)](_0x187760(0x350)); _0x5508cf[_0x187760(0x6cc)](_0x187760(0x7ec), async () => { const _0x441020 = _0x187760; _0x195491(!![], '正在打包数据，请稍候...'); const _0x958222 = []; try { const _0xf9b8eb = { 'localStorageData': {}, 'indexedDBData': {}, 'indexedDBMusicData': [] }; for (let _0x31fdf0 = 0x0; _0x31fdf0 < localStorage['length']; _0x31fdf0++) { const _0x374f76 = localStorage[_0x441020(0x251)](_0x31fdf0); if (_0x374f76) _0xf9b8eb[_0x441020(0x5fc)][_0x374f76] = localStorage[_0x441020(0x860)](_0x374f76); } const _0x30ef8b = await _0x3479a8, _0xda790c = _0x30ef8b['transaction'](_0x2e0278, _0x441020(0x8e0)), _0x4305ad = _0xda790c[_0x441020(0x4d6)](_0x2e0278), _0x47c479 = await new Promise((_0x39133d, _0x9d8497) => { const _0x2b6569 = _0x441020; if (_0x2b6569(0x7fd) === _0x2b6569(0x7fd)) { const _0x3ae565 = _0x4305ad[_0x2b6569(0x3f2)](); _0x3ae565[_0x2b6569(0x5f6)] = () => _0x39133d(_0x3ae565['result']), _0x3ae565[_0x2b6569(0x634)] = () => _0x9d8497(_0x3ae565[_0x2b6569(0x297)]); } else _0x2e9d3d[_0x2b6569(0x297)]('Noir\x27s\x20Temporal\x20Patch\x20failed:', _0xcd15bc); }); for (const _0x34ae2e of _0x47c479) { if (_0x441020(0xb05) === _0x441020(0x8c5)) { if (_0x1c5fac[_0x441020(0x919)] === 0x0) return; _0x53b755 = (_0x48d161 + 0x1) % _0xf48683[_0x441020(0x919)], _0x3f0518(_0x46e8cf[_0x21097b], _0x3ede03); } else { if (_0x34ae2e[_0x441020(0x24c)] instanceof Blob) try { _0x441020(0x9c6) === 'mdTXd' ? _0xf9b8eb['indexedDBData'][_0x34ae2e['id']] = await _0x13346a(_0x34ae2e[_0x441020(0x24c)]) : _0x5c2811['textContent'] = _0x1b5d56[_0x441020(0x742)](_0x171d95)[_0x441020(0xa96)](_0x489b4e => _0x489b4e['parentElement']['textContent'][_0x441020(0x74e)]())[_0x441020(0x63b)]('、'); } catch (_0x5486a7) { _0x441020(0xa3a) === _0x441020(0xa3a) ? _0x958222['push'](_0x34ae2e['id']) : _0x3a8ee0[_0x441020(0x41a)](); } } } const _0x50ee13 = _0x30ef8b[_0x441020(0x95f)](_0x414125, 'readonly'), _0x5dc854 = _0x50ee13[_0x441020(0x4d6)](_0x414125), _0x5779fe = await new Promise((_0xb63d7e, _0x125787) => { const _0x18a7d9 = _0x441020, _0x5adb2a = _0x5dc854[_0x18a7d9(0x3f2)](); _0x5adb2a[_0x18a7d9(0x5f6)] = () => _0xb63d7e(_0x5adb2a['result']), _0x5adb2a[_0x18a7d9(0x634)] = () => _0x125787(_0x5adb2a['error']); }); for (const _0x34dd01 of _0x5779fe) { const _0x2fcb12 = { ..._0x34dd01 }; _0x34dd01[_0x441020(0x44c)] instanceof Blob && (_0x2fcb12[_0x441020(0x44c)] = await _0x13346a(_0x34dd01[_0x441020(0x44c)])), _0x34dd01[_0x441020(0x194)] instanceof Blob && ('ePDpE' === _0x441020(0xad7) ? (_0x721372[_0x441020(0x713)] = _0x441020(0xa7c), _0x4b5eec['assign'](_0x3e00f5, _0x546c06)) : _0x2fcb12['cover'] = await _0x13346a(_0x34dd01[_0x441020(0x194)])), _0xf9b8eb['indexedDBMusicData'][_0x441020(0x438)](_0x2fcb12); } const _0x38ae98 = new Blob([JSON['stringify'](_0xf9b8eb, null, 0x2)], { 'type': _0x441020(0x827) }), _0x3978c7 = URL[_0x441020(0x289)](_0x38ae98), _0x56ee43 = document[_0x441020(0xa93)]('a'), _0xaffced = new Date(), _0xb47b26 = _0xaffced[_0x441020(0xb29)]() + '-' + String(_0xaffced[_0x441020(0x950)]() + 0x1)[_0x441020(0x27e)](0x2, '0') + '-' + String(_0xaffced[_0x441020(0x3de)]())[_0x441020(0x27e)](0x2, '0'); _0x56ee43[_0x441020(0xa61)] = _0x3978c7, _0x56ee43[_0x441020(0xa2c)] = 'Noir_Backup_' + _0xb47b26 + _0x441020(0x711), document[_0x441020(0x402)]['appendChild'](_0x56ee43), _0x56ee43[_0x441020(0x7ec)](), document[_0x441020(0x402)]['removeChild'](_0x56ee43), URL[_0x441020(0x4ce)](_0x3978c7), _0x195491(![]), _0x958222[_0x441020(0x919)] > 0x0 ? _0xeba69d(_0x441020(0x8c2) + _0x958222['join']('\x0a')) : _0xeba69d(_0x441020(0x52e)); } catch (_0x33e04a) { _0x195491(![]), console[_0x441020(0x297)](_0x441020(0x27b), _0x33e04a), _0xeba69d('导出过程中发生严重错误:\x20' + _0x33e04a[_0x441020(0x997)]); } }), _0x16bed8[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x7804ff = _0x187760; if (_0x7804ff(0x298) === _0x7804ff(0x70a)) { _0x4ef961 = _0x2eccc1(_0x7f2992[_0x7804ff(0x5a4)]), _0x23ae80[_0x7804ff(0x29c)] = ''; if (_0x3c9c0d[_0x7804ff(0x919)] === 0x0) { _0xcb7a2b[_0x7804ff(0x29c)] = _0x7804ff(0x30e); return; } _0xc57305[_0x7804ff(0xa3d)]((_0x242847, _0x54ab02) => { const _0x3edd87 = _0x7804ff, _0x355af5 = _0x362a4a[_0x3edd87(0xa93)]('p'); _0x355af5[_0x3edd87(0x574)] = _0x242847[_0x3edd87(0x807)], _0x355af5['id'] = _0x3edd87(0x887) + _0x54ab02, _0x290f4b['appendChild'](_0x355af5); }); } else _0x7b9eab['click'](); }), _0x1e38c9[_0x187760(0x6cc)](_0x187760(0x7ec), _0x1596fa), _0x7b9eab[_0x187760(0x6cc)](_0x187760(0x3c6), _0x541e27 => { const _0x737b92 = _0x187760, _0x478a50 = _0x541e27[_0x737b92(0x65e)][_0x737b92(0x523)][0x0]; if (!_0x478a50) return; _0x5db04d(_0x737b92(0x20b))['then'](_0x227f07 => { const _0x36e5c8 = _0x737b92; if (!_0x227f07) { if ('Qnsfe' === _0x36e5c8(0x5d9)) { _0x7b9eab['value'] = ''; return; } else { let _0x24421a = ''; if (_0xbe624c[_0x36e5c8(0x861)] && _0x1a66ce['likes']['length'] > 0x0) { const _0x6c8abc = _0x241282['likes'][_0x36e5c8(0xa96)](_0x2f99ac => _0x33d2e8(_0x2f99ac)?.[_0x36e5c8(0xb15)] || '未知')[_0x36e5c8(0x63b)]('、'), _0x190d10 = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>'; _0x24421a = '<div\x20class=\x22post-likes\x22>' + _0x190d10 + '\x20' + _0x6c8abc + _0x36e5c8(0x892); } let _0x35652c = ''; if (_0x4279ba[_0x36e5c8(0x566)] && _0x30c980[_0x36e5c8(0x566)][_0x36e5c8(0x919)] > 0x0) { const _0x24b23f = _0x2a9454['comments'][_0x36e5c8(0xa96)](_0x509406 => { const _0x2c01d9 = _0x36e5c8, _0x2b6e31 = _0x52451d(_0x509406[_0x2c01d9(0xb04)])?.[_0x2c01d9(0xb15)] || '未知'; return _0x2c01d9(0x696) + _0x2b6e31 + _0x2c01d9(0x2eb) + _0x509406[_0x2c01d9(0x359)] + _0x2c01d9(0x892); })[_0x36e5c8(0x63b)](''); _0x35652c = _0x36e5c8(0x729) + _0x24b23f + _0x36e5c8(0x892); } _0x1b3e47 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x24421a + _0x36e5c8(0x9bd) + _0x35652c + _0x36e5c8(0x3cf); } } _0x195491(!![], _0x36e5c8(0x1c7)); const _0x497295 = new FileReader(); _0x497295[_0x36e5c8(0x44b)] = async _0x2e83b2 => { const _0x5a0050 = _0x36e5c8; if (_0x5a0050(0x3ba) !== _0x5a0050(0x195)) try { if (_0x5a0050(0xafa) !== 'HQtCM') { const _0x2310e6 = JSON[_0x5a0050(0x1db)](_0x2e83b2[_0x5a0050(0x65e)][_0x5a0050(0x563)]); if (!_0x2310e6['localStorageData'] || !_0x2310e6['indexedDBData']) throw new Error(_0x5a0050(0x825)); _0x195491(!![], _0x5a0050(0x393)); const _0x128b49 = await Promise[_0x5a0050(0x14b)](Object['keys'](_0x2310e6[_0x5a0050(0xadf)])['map'](async _0x11e630 => { const _0xdc8e2c = _0x5a0050, _0x3fad98 = _0x2310e6[_0xdc8e2c(0xadf)][_0x11e630]; if (typeof _0x3fad98 === _0xdc8e2c(0x96c) && _0x3fad98[_0xdc8e2c(0x736)]('data:')) { const _0x347ada = await _0xd3e742(_0x3fad98); return { 'id': _0x11e630, 'blob': _0x347ada }; } return null; }))[_0x5a0050(0x276)](_0x15b81c => _0x15b81c[_0x5a0050(0x9f6)](Boolean)), _0x55dc52 = []; if (_0x2310e6[_0x5a0050(0x71c)]) { _0x195491(!![], '正在准备音乐数据...'); const _0x292fd4 = _0x2310e6['indexedDBMusicData'][_0x5a0050(0xa96)](async _0x30d4ca => { const _0x236dd9 = _0x5a0050; if (_0x236dd9(0x257) === _0x236dd9(0x257)) { const _0x591e61 = { ..._0x30d4ca }; if (_0x30d4ca['audio']) _0x591e61[_0x236dd9(0x44c)] = await _0xd3e742(_0x30d4ca[_0x236dd9(0x44c)]); if (_0x30d4ca[_0x236dd9(0x194)]) _0x591e61[_0x236dd9(0x194)] = await _0xd3e742(_0x30d4ca['cover']); return _0x591e61; } else _0x233fb5[_0x236dd9(0x7ec)](); }); _0x55dc52[_0x5a0050(0x438)](...await Promise[_0x5a0050(0x14b)](_0x292fd4)); } _0x195491(!![], '正在清空旧数据...'), localStorage[_0x5a0050(0xb18)](); for (const _0x61e4e in _0x2310e6['localStorageData']) { localStorage[_0x5a0050(0x2f5)](_0x61e4e, _0x2310e6[_0x5a0050(0x5fc)][_0x61e4e]); } _0x195491(!![], '正在写入新数据...'); const _0x17b562 = await _0x3479a8, _0x21d0aa = _0x17b562[_0x5a0050(0x95f)]([_0x2e0278, _0x414125, _0x2dd60e], _0x5a0050(0x236)), _0x32239e = _0x21d0aa[_0x5a0050(0x4d6)](_0x2e0278), _0x3392af = _0x21d0aa[_0x5a0050(0x4d6)](_0x414125), _0x1fc557 = _0x21d0aa[_0x5a0050(0x4d6)](_0x2dd60e); _0x32239e[_0x5a0050(0xb18)](), _0x3392af['clear'](), _0x1fc557[_0x5a0050(0xb18)](), _0x128b49[_0x5a0050(0xa3d)](_0x4e6151 => _0x32239e['put'](_0x4e6151)), _0x55dc52['forEach'](_0x12713f => _0x3392af[_0x5a0050(0xaed)](_0x12713f)), await new Promise((_0xc9d07c, _0x321243) => { const _0x1ea378 = _0x5a0050; _0x21d0aa[_0x1ea378(0x6d4)] = _0xc9d07c, _0x21d0aa[_0x1ea378(0x634)] = _0x2469fc => _0x321243(_0x2469fc['target'][_0x1ea378(0x297)]); }), _0x195491(![]), _0xeba69d(_0x5a0050(0x2e0)), setTimeout(() => location[_0x5a0050(0x1a8)](), 0x640); } else _0x4090fe['error'](_0x5a0050(0x349) + _0x2880de + ':', _0xc9ace7); } catch (_0x2714f6) { if ('AQond' !== _0x5a0050(0x1d7)) { const _0x39d176 = _0x23997a[0x0][_0x5a0050(0x74e)](), _0x54b840 = _0x4b3934[0x1][_0x5a0050(0x74e)]()['replace'](/^"|"$/g, ''); _0x2de434[_0x39d176] = _0x54b840; } else _0x195491(![]), console[_0x5a0050(0x297)](_0x5a0050(0xad3), _0x2714f6), _0xeba69d(_0x5a0050(0x839) + _0x2714f6[_0x5a0050(0x997)]); } finally { 'cZDRj' !== _0x5a0050(0xac6) ? _0x15215c['src'] && _0x41cb7a[_0x5a0050(0x80f)][_0x5a0050(0xadd)] !== '0' ? (_0x2fc272['style'][_0x5a0050(0xadd)] = 0x0, _0x4eec2b(() => { const _0x2a3188 = _0x5a0050; _0x20bc1e[_0x2a3188(0x686)] = _0x390a03['createObjectURL'](_0x14f61f), _0x3351b6[_0x2a3188(0x80f)][_0x2a3188(0xadd)] = 0x1; }, 0x96)) : (_0x420f88['src'] = _0x151aa8[_0x5a0050(0x289)](_0x25a546), _0x47f114[_0x5a0050(0x80f)][_0x5a0050(0xadd)] = 0x1) : _0x7b9eab[_0x5a0050(0xa03)] = ''; } else _0x1d1c2a(), _0x5e3e73(_0x5a0050(0x8c7), _0x5a0050(0xa7c)); }, _0x497295[_0x36e5c8(0x3a5)](_0x478a50); }); }); function _0x43ad07() { const _0x1bf15b = _0x187760; 'TFfRA' !== 'TFfRA' ? _0x33cb45('💜\x20' + _0x209faa[_0x1bf15b(0xb15)] + _0x1bf15b(0x657) + _0x3dce0e[_0x1bf15b(0x420)]) : (_0x65d35[_0x1bf15b(0xa03)] = _0x29b260['apiSettings'][_0x1bf15b(0x4f8)] || '', _0x4b6fa5['value'] = _0x29b260[_0x1bf15b(0x7d3)]['key'] || '', _0x23c208[_0x1bf15b(0xa03)] = _0x29b260[_0x1bf15b(0x7d3)][_0x1bf15b(0x48a)] || '', _0x1f9ff6[_0x1bf15b(0xa03)] = String(_0x29b260[_0x1bf15b(0xa2a)]?.[_0x1bf15b(0x164)] ?? 0x64), document[_0x1bf15b(0x759)]('api-provider')[_0x1bf15b(0xa03)] = _0x29b260['apiSettings'][_0x1bf15b(0x1ca)] || 'openai'); } function _0x424034() { const _0x47edfe = _0x187760; _0x29b260[_0x47edfe(0x7d3)]['endpoint'] = _0x65d35[_0x47edfe(0xa03)][_0x47edfe(0x74e)](), _0x29b260[_0x47edfe(0x7d3)][_0x47edfe(0x251)] = _0x4b6fa5[_0x47edfe(0xa03)][_0x47edfe(0x74e)](), _0x29b260[_0x47edfe(0x7d3)]['model'] = _0x23c208[_0x47edfe(0xa03)][_0x47edfe(0x74e)](), _0x29b260[_0x47edfe(0x7d3)][_0x47edfe(0x1ca)] = document['getElementById'](_0x47edfe(0x6c7))[_0x47edfe(0xa03)]; const _0x273d1a = parseInt(_0x1f9ff6[_0x47edfe(0xa03)], 0xa); _0x29b260['preferences'][_0x47edfe(0x164)] = Number['isFinite'](_0x273d1a) && _0x273d1a > 0x0 ? _0x273d1a : 0x64, _0xf10e4a(), _0xeba69d('设置已保存！'); } function _0x3f8052() { const _0x31a1e4 = _0x187760; _0x1874b1[_0x31a1e4(0xa03)] = _0x29b260[_0x31a1e4(0xa77)][_0x31a1e4(0xb15)] || '', _0x3bb42d[_0x31a1e4(0x686)] = _0x29b260['userProfile']['avatar'] || _0x2f94f8, _0x15bd3b[_0x31a1e4(0xa03)] = _0x29b260[_0x31a1e4(0xa77)][_0x31a1e4(0x435)] || ''; } async function _0x528a37(_0xe0883d = null) { const _0x389de7 = _0x187760; if (_0x389de7(0xb03) === _0x389de7(0x35d)) _0x242aa6[_0x389de7(0x80f)]['textShadow'] = ''; else { _0x57a80a(_0x389de7(0x3c9), _0x2399bc); const _0x42483b = document[_0x389de7(0x759)]('char-avatar-frame-url'), _0x226048 = document[_0x389de7(0x759)](_0x389de7(0xa35)), _0x165805 = document['querySelector'](_0x389de7(0xae2)); if (_0xe0883d) { const _0x257347 = _0x29b260['characters'][_0x389de7(0x444)](_0x41a755 => _0x41a755['id'] === _0xe0883d); _0x42483b[_0x389de7(0xa03)] = _0x257347[_0x389de7(0x85f)] || '', _0x226048['value'] = _0x257347[_0x389de7(0x6b5)] || ''; if (_0x165805) _0x165805[_0x389de7(0x80f)][_0x389de7(0xad6)] = _0x257347[_0x389de7(0x85f)] ? 'url(\x27' + _0x257347[_0x389de7(0x85f)] + '\x27)' : ''; } else { _0x42483b[_0x389de7(0xa03)] = '', _0x226048['value'] = ''; if (_0x165805) _0x165805[_0x389de7(0x80f)][_0x389de7(0xad6)] = ''; } _0x42483b[_0x389de7(0x6cc)](_0x389de7(0x3cb), () => { const _0xd50261 = _0x389de7; if (_0x165805) _0x165805[_0xd50261(0x80f)]['backgroundImage'] = _0x42483b[_0xd50261(0xa03)] ? _0xd50261(0x22e) + _0x42483b['value'] + '\x27)' : ''; }); const _0x4b4886 = document[_0x389de7(0x759)](_0x389de7(0x567)); _0x4b4886[_0x389de7(0x29c)] = '', _0x29b260[_0x389de7(0x1a1)][_0x389de7(0xa3d)](_0x59c155 => { const _0x23edac = _0x389de7; if (_0x23edac(0x24b) === _0x23edac(0x6ad)) _0x23a688[_0x23edac(0x297)]('Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', _0x565dfe); else { const _0x318c27 = document[_0x23edac(0xa93)]('label'); _0x318c27[_0x23edac(0x29c)] = _0x23edac(0x1cc) + _0x59c155['id'] + _0x23edac(0x56f) + _0x59c155[_0x23edac(0xb15)], _0x4b4886[_0x23edac(0x25f)](_0x318c27); } }), _0x4790b6(_0x389de7(0x85d)), _0x509d18[_0x389de7(0x686)] = _0x461596, _0x315e49['value'] = '', _0xefae80[_0x389de7(0x80f)][_0x389de7(0xad6)] = '', _0x57e62f['value'] = '', _0x59b746['style'][_0x389de7(0xad6)] = '', _0x521e71[_0x389de7(0xa03)] = ''; const _0x50f750 = [_0x389de7(0x69b), _0x389de7(0x9e5), 'angry', _0x389de7(0x35f), _0x389de7(0x9cd)]; _0x50f750[_0x389de7(0xa3d)](_0x1e0737 => { const _0x23f8c8 = _0x389de7; document[_0x23f8c8(0x759)](_0x23f8c8(0x9c1) + _0x1e0737 + '-preview')[_0x23f8c8(0x80f)]['backgroundImage'] = '', document[_0x23f8c8(0x759)](_0x23f8c8(0x9c1) + _0x1e0737 + _0x23f8c8(0x9d8))[_0x23f8c8(0xa03)] = ''; }); if (_0xe0883d) { const _0x3b61f6 = _0x29b260['characters']['find'](_0x4db737 => _0x4db737['id'] === _0xe0883d); if (!_0x3b61f6) return; _0x2f40df[_0x389de7(0xa03)] = _0x3b61f6['id'], _0x485a73[_0x389de7(0x574)] = _0x389de7(0x305), _0x1d841e['value'] = _0x3b61f6[_0x389de7(0xb15)], _0x1c3727[_0x389de7(0xa03)] = _0x3b61f6[_0x389de7(0x3f7)], _0x359364['value'] = _0x3b61f6[_0x389de7(0x435)], document[_0x389de7(0x759)](_0x389de7(0x232))[_0x389de7(0xa03)] = _0x3b61f6[_0x389de7(0xa5e)] || ''; const _0xd98f39 = _0x29b260[_0x389de7(0x6df)][_0x389de7(0x444)](_0x1a42a4 => _0x1a42a4['type'] === _0x389de7(0x7ad) && _0x1a42a4[_0x389de7(0x9be)][_0x389de7(0x4da)](_0xe0883d)); document[_0x389de7(0x759)]('char-edit-bind-user')['value'] = _0xd98f39?.[_0x389de7(0x515)] || _0x29b260['activeUserProfileId']; try { const _0x48ab2d = await _0x2e6c7a(_0x389de7(0x75f) + _0x3b61f6['id']), _0x4fba42 = await _0x2e6c7a(_0x389de7(0x8e4) + _0x3b61f6['id']), _0x192865 = await _0x2e6c7a(_0x389de7(0x3d3) + _0x3b61f6['id']); _0x509d18['src'] = _0x48ab2d ? URL[_0x389de7(0x289)](_0x48ab2d) : _0x3b61f6[_0x389de7(0x96f)] || _0x461596; if (_0x4fba42) _0xefae80[_0x389de7(0x80f)][_0x389de7(0xad6)] = _0x389de7(0x22e) + URL[_0x389de7(0x289)](_0x4fba42) + '\x27)'; if (_0x192865) _0x59b746[_0x389de7(0x80f)][_0x389de7(0xad6)] = _0x389de7(0x22e) + URL[_0x389de7(0x289)](_0x192865) + '\x27)'; for (const _0x449974 of _0x50f750) { if (_0x389de7(0x790) === _0x389de7(0x8a2)) { const _0x34edb3 = _0x5d08f0[0x1][_0x389de7(0x998)](/\\"/g, '\x22')['replace'](/\\n/g, '\x0a')[_0x389de7(0x74e)](); if (_0x34edb3) _0x539a96[_0x389de7(0x438)](_0x34edb3); } else { const _0x3481f0 = await _0x2e6c7a(_0x389de7(0x6f4) + _0x449974 + '_' + _0x3b61f6['id']); _0x3481f0 && (_0x389de7(0x184) !== _0x389de7(0x184) ? _0x4bee9f['value'] = '' : document[_0x389de7(0x759)](_0x389de7(0x9c1) + _0x449974 + _0x389de7(0x380))[_0x389de7(0x80f)][_0x389de7(0xad6)] = 'url(\x27' + URL[_0x389de7(0x289)](_0x3481f0) + '\x27)'); } } } catch (_0x436e8d) { if ('NGtNi' === _0x389de7(0x11a)) return { 'type': _0x389de7(0x807), 'content': _0x2e390a }; else console['error']('加载角色\x20' + _0x3b61f6['id'] + _0x389de7(0x6f5), _0x436e8d), _0x509d18[_0x389de7(0x686)] = _0x3b61f6[_0x389de7(0x96f)] || _0x461596; } _0x3b61f6[_0x389de7(0x5c0)] && _0x4b4886[_0x389de7(0xae0)](_0x389de7(0x174))[_0x389de7(0xa3d)](_0x1d4d2e => { const _0x88f2de = _0x389de7; if ('rUnwk' !== _0x88f2de(0x86f)) _0x403822[_0x88f2de(0x969)][_0x88f2de(0x41a)](_0x88f2de(0x459)), _0x5062e9 = null; else { if (_0x3b61f6['linkedWorldBookIds'][_0x88f2de(0x4da)](_0x1d4d2e[_0x88f2de(0xa03)])) _0x1d4d2e['checked'] = !![]; } }), _0x2fae61(); } else _0x389de7(0x911) === _0x389de7(0x707) ? _0x516144 += _0x389de7(0x8b6) : (_0x2f40df[_0x389de7(0xa03)] = '', _0x485a73[_0x389de7(0x574)] = _0x389de7(0x274), _0x1d841e[_0x389de7(0xa03)] = _0x389de7(0x41c) + (_0x29b260[_0x389de7(0x3db)][_0x389de7(0x919)] + 0x1), _0x1c3727['value'] = '', _0x359364[_0x389de7(0xa03)] = '你是一个乐于助人的AI助手。', document[_0x389de7(0x759)](_0x389de7(0x232))['value'] = '', _0x2fae61()); const _0x2b9346 = document[_0x389de7(0x759)](_0x389de7(0x232)); let _0x35f869 = document[_0x389de7(0x759)]('live-preview-style'); !_0x35f869 && (_0x35f869 = document['createElement']('style'), _0x35f869['id'] = _0x389de7(0x155), document[_0x389de7(0x7c9)]['appendChild'](_0x35f869)); const _0x441d5f = () => { const _0x57dac7 = _0x389de7; if (_0x57dac7(0x503) === _0x57dac7(0x503)) { const _0x471aa6 = _0x2b9346[_0x57dac7(0xa03)]; let _0x1b1f4e = _0x471aa6[_0x57dac7(0x998)](/\.bubble\.sent/g, '#bubble-preview-user')['replace'](/\.bubble\.received/g, '#bubble-preview-ai'); _0x35f869[_0x57dac7(0x29c)] = _0x1b1f4e; } else { const _0x119c2e = new _0x4dec53(), _0x574884 = _0x1574ec[_0x57dac7(0x759)]('galgame-time'), _0x22259f = _0x58c0c9[_0x57dac7(0x759)](_0x57dac7(0xb1d)); if (_0x574884 && _0x22259f) { const _0x43c25d = _0x59f0f7(_0x119c2e[_0x57dac7(0xb06)]())[_0x57dac7(0x27e)](0x2, '0'), _0x3ac3e3 = _0x3b2773(_0x119c2e['getMinutes']())[_0x57dac7(0x27e)](0x2, '0'); _0x574884[_0x57dac7(0x574)] = _0x43c25d + ':' + _0x3ac3e3; const _0xd8ab1b = _0x119c2e[_0x57dac7(0x950)]() + 0x1, _0x5502b6 = _0x119c2e[_0x57dac7(0x3de)](), _0x5ad7fe = [_0x57dac7(0x1b6), _0x57dac7(0x9f9), _0x57dac7(0x334), '星期三', _0x57dac7(0x496), _0x57dac7(0x36f), _0x57dac7(0x275)][_0x119c2e['getDay']()]; _0x22259f[_0x57dac7(0x574)] = _0xd8ab1b + '月' + _0x5502b6 + '日\x20' + _0x5ad7fe; } } }; _0x2b9346[_0x389de7(0x601)](_0x389de7(0x3cb), _0x441d5f), _0x2b9346[_0x389de7(0x6cc)]('input', _0x441d5f), _0x441d5f(); } } async function _0x2b5357() { const _0x225c77 = _0x187760; if ('BvVsW' === _0x225c77(0x43a)) { _0x2074cd['error']('生成失败:\x20', _0x108879); const _0x416d94 = { 'role': _0x225c77(0x863), 'content': _0x225c77(0xaf9) + _0x2243ca['message'], 'senderId': _0x3e2892['id'], 'isOffline': _0x3b7021 }; _0x4f1f6f[_0x225c77(0xa85)]['push'](_0x416d94), _0x5e16f7(); } else { const _0x3279cd = _0x2f40df[_0x225c77(0xa03)]; if (!_0x3279cd) { if (_0x225c77(0x560) !== _0x225c77(0x560)) _0x3d7577 += '-\x20**状态提示**:\x20这是你的手机第一次被“看见”，生成的内容应该是你的初始状态。\x0a'; else { _0xeba69d('你还没保存这个角色呢，导什么导？'); return; } } const _0x133341 = _0x4cc875(_0x3279cd); if (!_0x133341) return; _0x195491(!![], _0x225c77(0x5d4) + _0x133341[_0x225c77(0xb15)] + '”...'); try { if (_0x225c77(0x4ae) === 'oANMo') return _0x235f94(_0x37b14b)['then'](_0x24654f => _0x24654f['blob']()); else { const _0x424a70 = { 'type': _0x225c77(0x287), 'version': 0x1, 'name': _0x133341[_0x225c77(0xb15)], 'remark': _0x133341[_0x225c77(0x3f7)], 'persona': _0x133341[_0x225c77(0x435)], 'bubbleCss': _0x133341[_0x225c77(0xa5e)], 'avatar': null, 'sprites': {}, 'worldBooks': [] }, _0x55bc4d = await _0x2e6c7a(_0x225c77(0x75f) + _0x133341['id']); if (_0x55bc4d) _0x424a70[_0x225c77(0x96f)] = await _0x13346a(_0x55bc4d); const _0x39dc1c = [_0x225c77(0x69b), _0x225c77(0x9e5), _0x225c77(0xa6a), _0x225c77(0x35f), _0x225c77(0x9cd)]; for (const _0x290751 of _0x39dc1c) { const _0xe3ea60 = await _0x2e6c7a(_0x225c77(0x6f4) + _0x290751 + '_' + _0x133341['id']); _0xe3ea60 && (_0x424a70[_0x225c77(0x66c)][_0x290751] = await _0x13346a(_0xe3ea60)); } _0x133341['linkedWorldBookIds'] && _0x133341[_0x225c77(0x5c0)]['length'] > 0x0 && (_0x424a70[_0x225c77(0x1a1)] = _0x133341[_0x225c77(0x5c0)]['map'](_0xaa3577 => _0x29b260[_0x225c77(0x1a1)][_0x225c77(0x444)](_0x7edc0d => _0x7edc0d['id'] === _0xaa3577))[_0x225c77(0x9f6)](Boolean)[_0x225c77(0xa96)](_0x52f4c7 => ({ 'name': _0x52f4c7[_0x225c77(0xb15)], 'content': _0x52f4c7[_0x225c77(0x359)] }))); const _0x2d15d7 = new Blob([JSON[_0x225c77(0x2a5)](_0x424a70, null, 0x2)], { 'type': _0x225c77(0x827) }), _0x3b3f58 = URL[_0x225c77(0x289)](_0x2d15d7), _0x1bd899 = document[_0x225c77(0xa93)]('a'); _0x1bd899[_0x225c77(0xa61)] = _0x3b3f58, _0x1bd899[_0x225c77(0xa2c)] = _0x133341[_0x225c77(0xb15)] + _0x225c77(0x4cd), document[_0x225c77(0x402)][_0x225c77(0x25f)](_0x1bd899), _0x1bd899['click'](), document[_0x225c77(0x402)][_0x225c77(0x870)](_0x1bd899), URL[_0x225c77(0x4ce)](_0x3b3f58); } } catch (_0x27851c) { console[_0x225c77(0x297)]('导出角色卡失败:', _0x27851c), _0xeba69d(_0x225c77(0x663) + _0x27851c['message']); } finally { _0x195491(![]); } } } async function _0x150dba(_0x538221) { const _0x15c627 = _0x187760; if (_0x15c627(0x586) === _0x15c627(0x965)) _0x292721(), _0x466fd4(![]); else { const _0x516ecc = _0x538221['target'][_0x15c627(0x523)][0x0]; if (!_0x516ecc) return; _0x195491(!![], _0x15c627(0x28a)); const _0x3fc7f1 = new FileReader(); _0x3fc7f1[_0x15c627(0x44b)] = async _0x55a238 => { const _0x4f4f21 = _0x15c627; try { const _0x4e7dc6 = JSON[_0x4f4f21(0x1db)](_0x55a238['target'][_0x4f4f21(0x563)]); if (_0x4e7dc6[_0x4f4f21(0x713)] !== 'NoirCharacterCard') throw new Error(_0x4f4f21(0x841)); const _0x4318fd = []; if (_0x4e7dc6['worldBooks'] && _0x4e7dc6['worldBooks'][_0x4f4f21(0x919)] > 0x0) { if (_0x4f4f21(0x5cc) === _0x4f4f21(0x338)) _0x2b4d30 = _0xcebece[_0x4f4f21(0x44f)][_0x4f4f21(0x444)](_0x3aa84f => _0x3aa84f['id'] === _0x46b1cf['activeUserProfileId']); else for (const _0x55aa2d of _0x4e7dc6[_0x4f4f21(0x1a1)]) { let _0xda978d = _0x29b260[_0x4f4f21(0x1a1)][_0x4f4f21(0x444)](_0x4fba5c => _0x4fba5c[_0x4f4f21(0xb15)] === _0x55aa2d[_0x4f4f21(0xb15)]); if (_0xda978d) { if (_0x4f4f21(0x2ba) === _0x4f4f21(0x2ba)) _0x4318fd[_0x4f4f21(0x438)](_0xda978d['id']); else { const _0x1c3baa = _0xf0fe7f[_0x4f4f21(0x6df)][_0x4f4f21(0x444)](_0x509fef => _0x509fef[_0x4f4f21(0x9e8)] && _0x509fef[_0x4f4f21(0x9e8)][_0x4f4f21(0x705)]); _0x1c3baa && (_0x1c3baa[_0x4f4f21(0x9e8)] = null, _0x2318e7(), _0x423229('同步已断开。'), _0xde9c51(), _0x5c202b[_0x4f4f21(0x969)][_0x4f4f21(0x41a)](_0x4f4f21(0x459)), _0x3909bc(() => _0x2ccf8b[_0x4f4f21(0x80f)]['display'] = _0x4f4f21(0x697), 0x12c)); } } else { if (_0x4f4f21(0x602) !== _0x4f4f21(0x761)) { const _0xfc252f = { 'id': 'wb_' + Date[_0x4f4f21(0x74c)]() + '_' + Math[_0x4f4f21(0x545)](), 'name': _0x55aa2d[_0x4f4f21(0xb15)], 'content': _0x55aa2d[_0x4f4f21(0x359)] }; _0x29b260[_0x4f4f21(0x1a1)][_0x4f4f21(0x438)](_0xfc252f), _0x4318fd[_0x4f4f21(0x438)](_0xfc252f['id']); } else _0x90bd9c['innerHTML'] = '', _0x440bb0[_0x4f4f21(0xa3d)](_0x19a5d7 => { const _0x37580a = _0x4f4f21, _0xc134c = _0x3f335d[_0x37580a(0xa93)](_0x37580a(0x36b)); _0xc134c[_0x37580a(0x686)] = _0x19a5d7[_0x37580a(0x8b7)], _0xc134c['loading'] = _0x37580a(0x8f8), _0xc134c[_0x37580a(0x640)] = _0x19a5d7['name'], _0xc134c[_0x37580a(0x969)][_0x37580a(0x944)]('sticker-item'), _0xc134c[_0x37580a(0x6cc)]('click', () => _0x139392(_0x19a5d7)), _0x27cb13[_0x37580a(0x25f)](_0xc134c); }); } } } const _0x5ae59c = _0x4f4f21(0x91b) + Date[_0x4f4f21(0x74c)](), _0x5c2283 = { 'id': _0x5ae59c, 'name': _0x4e7dc6[_0x4f4f21(0xb15)], 'remark': _0x4e7dc6[_0x4f4f21(0x3f7)] || '', 'persona': _0x4e7dc6[_0x4f4f21(0x435)], 'avatar': _0x4e7dc6[_0x4f4f21(0x96f)] || _0x461596, 'linkedWorldBookIds': _0x4318fd, 'bubbleCss': _0x4e7dc6[_0x4f4f21(0xa5e)] || '' }; if (_0x4e7dc6['avatar']) { const _0x8013d5 = await _0xd3e742(_0x4e7dc6[_0x4f4f21(0x96f)]); await _0x5b0aee(_0x4f4f21(0x75f) + _0x5ae59c, _0x8013d5); } if (_0x4e7dc6[_0x4f4f21(0x66c)]) for (const _0x1018ff in _0x4e7dc6[_0x4f4f21(0x66c)]) { const _0x6cb0cc = _0x4e7dc6[_0x4f4f21(0x66c)][_0x1018ff], _0x539a5c = await _0xd3e742(_0x6cb0cc); await _0x5b0aee(_0x4f4f21(0x6f4) + _0x1018ff + '_' + _0x5ae59c, _0x539a5c); } _0x29b260[_0x4f4f21(0x3db)][_0x4f4f21(0x438)](_0x5c2283); const _0x338916 = { 'id': _0x4f4f21(0x156) + _0x5ae59c, 'type': _0x4f4f21(0x7ad), 'participantIds': [_0x5ae59c], 'boundUserProfileId': _0x29b260[_0x4f4f21(0x113)] }; _0x29b260['chats'][_0x4f4f21(0x438)](_0x338916), _0xf10e4a(), _0x25cb93(), _0xeba69d('“' + _0x5c2283['name'] + _0x4f4f21(0x715)); } catch (_0xba6dae) { if ('isaQW' === _0x4f4f21(0x5fd)) { const _0x41a367 = _0xd9de91(_0x1856fb[_0x4f4f21(0x2f7)]['historyIndex'], 0xa); !_0x4878ab(_0x41a367) && _0x317780(_0x41a367); } else console[_0x4f4f21(0x297)](_0x4f4f21(0x22c), _0xba6dae), _0xeba69d(_0x4f4f21(0x79b) + _0xba6dae[_0x4f4f21(0x997)]); } finally { _0x195491(![]), _0x538221[_0x4f4f21(0x65e)][_0x4f4f21(0xa03)] = ''; } }, _0x3fc7f1['readAsText'](_0x516ecc); } } async function _0x2da5b2() { const _0x364172 = _0x187760, _0x18f010 = _0x2f40df['value'], _0x80ad25 = document['getElementById'](_0x364172(0x85d))['value'], _0x4460af = _0x315e49[_0x364172(0x523)][0x0], _0x243878 = _0x57e62f[_0x364172(0x523)][0x0], _0x1d4bb6 = _0x521e71[_0x364172(0x523)][0x0], _0x15b2b9 = document[_0x364172(0xae0)](_0x364172(0x234)), _0x1f7281 = Array[_0x364172(0x742)](_0x15b2b9)[_0x364172(0xa96)](_0x996360 => _0x996360[_0x364172(0xa03)]), _0xc7e892 = { 'name': _0x1d841e['value'][_0x364172(0x74e)](), 'remark': _0x1c3727['value'][_0x364172(0x74e)](), 'persona': _0x359364['value'][_0x364172(0x74e)](), 'linkedWorldBookIds': _0x1f7281, 'bubbleCss': document[_0x364172(0x759)](_0x364172(0x232))[_0x364172(0xa03)][_0x364172(0x74e)](), 'avatarFrameUrl': document[_0x364172(0x759)](_0x364172(0x23c))[_0x364172(0xa03)][_0x364172(0x74e)](), 'userAvatarFrameUrl': document[_0x364172(0x759)](_0x364172(0xa35))['value']['trim']() }; if (!_0xc7e892[_0x364172(0xb15)]) { _0xeba69d(_0x364172(0x5e8)); return; } try { if (_0x364172(0x211) === _0x364172(0x211)) { const _0x498017 = [_0x364172(0x69b), _0x364172(0x9e5), _0x364172(0xa6a), _0x364172(0x35f), _0x364172(0x9cd)]; let _0x97d9c2 = _0x18f010; if (_0x18f010) { if (_0x364172(0x4c7) === _0x364172(0x4c7)) { const _0x1bca48 = _0x29b260[_0x364172(0x3db)][_0x364172(0x444)](_0x1ccd7 => _0x1ccd7['id'] === _0x18f010); _0x1bca48 && Object[_0x364172(0x37b)](_0x1bca48, _0xc7e892); } else _0x70790d['classList'][_0x364172(0x944)]('show-chat-view'); } else { if ('ZYPbF' !== _0x364172(0x3b6)) { const _0x391131 = _0x364172(0x91b) + Date[_0x364172(0x74c)](); _0x97d9c2 = _0x391131; const _0x25a5a4 = { 'id': _0x391131, ..._0xc7e892 }; _0x25a5a4[_0x364172(0x96f)] = _0x4460af ? await _0x8ff8c6(_0x4460af) : _0x461596, _0x29b260[_0x364172(0x3db)][_0x364172(0x438)](_0x25a5a4); const _0x4bc332 = { 'id': _0x364172(0x156) + _0x391131, 'type': _0x364172(0x7ad), 'participantIds': [_0x391131], 'listenTogetherSession': null }; _0x29b260[_0x364172(0x6df)][_0x364172(0x438)](_0x4bc332); } else _0x155a27(![]), _0x506c15['target'][_0x364172(0xa03)] = ''; } const _0x2714c8 = _0x29b260[_0x364172(0x6df)][_0x364172(0x444)](_0x1427e3 => _0x1427e3['type'] === _0x364172(0x7ad) && _0x1427e3[_0x364172(0x9be)][_0x364172(0x4da)](_0x97d9c2)); _0x2714c8 && (_0x364172(0xaef) !== _0x364172(0xaef) ? _0x16cc08('错误:\x20' + _0x52a016[_0x364172(0x997)]) : _0x2714c8[_0x364172(0x515)] = _0x80ad25); if (_0x4460af) await _0x5b0aee(_0x364172(0x75f) + _0x97d9c2, _0x4460af); if (_0x243878) await _0x5b0aee('char_wallpaper_' + _0x97d9c2, _0x243878); if (_0x1d4bb6) await _0x5b0aee(_0x364172(0x3d3) + _0x97d9c2, _0x1d4bb6); for (const _0x39efae of _0x498017) { if (_0x364172(0x28f) === _0x364172(0x765)) { if (!_0x22ba67 || !_0x667901['includes'](',')) return _0x2f2f8; const _0x44d7a8 = _0x51036a[_0x364172(0x77e)](',')[_0x364172(0xa96)](_0x23dafa => _0x23dafa['trim']()); return _0x44d7a8[_0x410734[_0x364172(0xa54)](_0xb4c89c[_0x364172(0x545)]() * _0x44d7a8[_0x364172(0x919)])]; } else { const _0x43737b = document['getElementById']('char-edit-sprite-' + _0x39efae + _0x364172(0x9d8))[_0x364172(0x523)][0x0]; if (_0x43737b) await _0x5b0aee('char_sprite_' + _0x39efae + '_' + _0x97d9c2, _0x43737b); } } _0xf10e4a(), _0x25cb93(), _0xeba69d(_0x364172(0x124)), _0x57a80a(_0x364172(0x6b7), 'characterEdit'); if (!_0x18f010) { if (_0x364172(0x63c) !== _0x364172(0x63c)) _0x546c6a[_0x364172(0x297)]('JSON\x20解析失败!\x20错误原因:', _0x5c360a), _0x1adc7b[_0x364172(0x297)](_0x364172(0x44a), _0x211a56); else { const _0x506842 = _0x364172(0x156) + _0x97d9c2; _0x542653(_0x506842), _0x47f45b(!![]); } } } else _0x52a603[_0x364172(0x297)](_0x364172(0x2e3), _0x330e7a); } catch (_0x19a328) { 'kKldx' === _0x364172(0x2a9) ? _0x52ac3e[_0x364172(0x25f)](_0x3cde7d) : (console[_0x364172(0x297)](_0x364172(0x661), _0x19a328), _0xeba69d(_0x364172(0x53b) + _0x19a328['message'])); } } function _0x466142() { const _0x5891b9 = _0x187760; _0x331d2e['value'] = '', _0x4185e1[_0x5891b9(0x29c)] = ''; if (_0x29b260[_0x5891b9(0x3db)]['length'] < 0x2) { if (_0x5891b9(0x904) !== _0x5891b9(0x904)) { const _0x408b61 = _0x527f5c['createObjectURL'](_0x43233b), _0xfcde3e = _0x5891b9(0x1da), _0x22ca28 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27' + _0xfcde3e + _0x5891b9(0x1a5) + _0x408b61 + '\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; _0x3d9c24[_0x5891b9(0x29c)] = _0x22ca28, _0x20b832[_0x5891b9(0x204)][_0x5891b9(0x80f)][_0x5891b9(0x52c)](_0x5891b9(0x31e), '\x27' + _0xfcde3e + '\x27'), _0x643c9f[_0x5891b9(0x574)] = _0x5891b9(0x66e); } else { _0xeba69d(_0x5891b9(0x11c)); return; } } _0x29b260[_0x5891b9(0x3db)][_0x5891b9(0xa3d)](_0x210eb0 => { const _0x4285cf = _0x5891b9, _0x1fd1e4 = document[_0x4285cf(0xa93)]('li'); _0x1fd1e4[_0x4285cf(0x8bd)] = _0x4285cf(0x98f), _0x1fd1e4[_0x4285cf(0x29c)] = _0x4285cf(0x253) + _0x210eb0['id'] + '\x22\x20data-id=\x22' + _0x210eb0['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x210eb0[_0x4285cf(0x96f)] || _0x461596) + _0x4285cf(0x8dd) + _0x210eb0['id'] + _0x4285cf(0x8c1) + _0x210eb0[_0x4285cf(0xb15)] + _0x4285cf(0x735), _0x4185e1[_0x4285cf(0x25f)](_0x1fd1e4); }), _0x57a80a('groupChatCreate', _0x5891b9(0x65d)); } function _0x131789() { const _0x379117 = _0x187760; if (_0x379117(0x7c5) !== 'cWvUP') { const _0x58b0b9 = _0x331d2e[_0x379117(0xa03)]['trim'](); if (!_0x58b0b9) { _0xeba69d(_0x379117(0x9ba)); return; } const _0xb018e6 = Array[_0x379117(0x742)](_0x4185e1[_0x379117(0xae0)](_0x379117(0x1fa)))['map'](_0x549cf9 => _0x549cf9[_0x379117(0x2f7)]['id']); if (_0xb018e6['length'] < 0x2) { if (_0x379117(0x181) === _0x379117(0x82a)) _0x50442e[_0x379117(0xa03)] = '', _0x226ba8[_0x379117(0x574)] = '创建新角色', _0xe257d0[_0x379117(0xa03)] = '新角色\x20' + (_0x132327[_0x379117(0x3db)][_0x379117(0x919)] + 0x1), _0x97586c[_0x379117(0xa03)] = '', _0x1ec6c5[_0x379117(0xa03)] = _0x379117(0x311), _0x338dab[_0x379117(0x759)](_0x379117(0x232))[_0x379117(0xa03)] = '', _0x283d10(); else { _0xeba69d('群聊至少需要2名成员。'); return; } } const _0x594d95 = { 'id': 'chat_group_' + Date['now'](), 'type': _0x379117(0x867), 'name': _0x58b0b9, 'participantIds': _0xb018e6 }; _0x29b260['chats'][_0x379117(0x438)](_0x594d95), _0x29b260['activeChatId'] = _0x594d95['id'], _0xf10e4a(), _0x25cb93(), _0xba948e(), _0x32657d(), _0xeba69d(_0x379117(0x428) + _0x58b0b9 + _0x379117(0x4f2)), _0x57a80a(_0x379117(0x6b7), _0x379117(0xa94)); } else { const _0x815902 = _0x1062d8[_0x379117(0xa93)]('p'); _0x815902[_0x379117(0x29c)] = _0x10e706, _0x815902[_0x379117(0x80f)]['margin'] = '0', _0x319380[_0x379117(0x25f)](_0x815902); } } _0x4633d3['addEventListener'](_0x187760(0x7ec), () => _0x2d7a96['click']()), _0x4aba8b[_0x187760(0x6cc)](_0x187760(0x7ec), _0x4f08d4), _0x2d7a96['addEventListener']('change', _0x2a1b46), _0x2a3d95[_0x187760(0x6cc)]('click', _0x2e91d2), _0x1d579d[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x3f4547[_0x187760(0x969)][_0x187760(0x41a)](_0x187760(0x459))), _0x1b4299[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x3f4547['classList'][_0x187760(0x41a)](_0x187760(0x459))), _0x2d1325[_0x187760(0x6cc)]('click', () => { const _0x324905 = _0x187760; _0x4ab829[_0x324905(0x158)](), navigator[_0x324905(0x8d3)]['writeText'](_0x4ab829[_0x324905(0xa03)])[_0x324905(0x276)](() => { const _0x307a1c = _0x324905; if (_0x307a1c(0x7f0) !== 'nXYGQ') _0xeba69d(_0x307a1c(0x699)); else { const _0x31b488 = _0x502fef(_0x58577d[_0x307a1c(0xb04)]) || { 'name': '未知' }; let _0x5ea5a1 = _0x307a1c(0x391) + _0x31b488['name'] + _0x307a1c(0xa1a) + (_0x5cb88c['thought'] || _0x49f28e[_0x307a1c(0x359)]) + '”'; return _0x42bf72[_0x307a1c(0x713)] === 'music' && (_0x5ea5a1 += '\x20(分享了歌曲:\x20' + _0x397f1f[_0x307a1c(0x5ee)] + _0x307a1c(0x84c) + _0x167f2f[_0x307a1c(0x6cd)] + ')'), _0x5ea5a1; } })[_0x324905(0x29a)](_0xa72851 => { const _0x5d31d2 = _0x324905; 'hFVzR' !== 'hFVzR' ? _0x20cbf2 !== _0x18b3c9[_0x5d31d2(0xa01)](_0x5d31d2(0x6c8)) && (_0x521cfd[_0x5d31d2(0x574)] = '▶') : _0xeba69d('复制失败了，哼。'); }); }), _0x3de9fa[_0x187760(0x6cc)](_0x187760(0x7ec), _0x36a7eb), _0x2ce304[_0x187760(0x6cc)](_0x187760(0x7ec), _0x375afd), _0x20a39b[_0x187760(0x6cc)]('click', () => _0x12c2dd[_0x187760(0x969)][_0x187760(0x41a)](_0x187760(0x459))), _0x6f22e4['addEventListener'](_0x187760(0x7ec), () => _0x12c2dd[_0x187760(0x969)][_0x187760(0x41a)]('show')), _0xefae80[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x57e62f['click']()), _0x59b746[_0x187760(0x6cc)]('click', () => _0x521e71[_0x187760(0x7ec)]()), _0x57e62f[_0x187760(0x6cc)]('change', _0x34beab => { const _0x110495 = _0x187760; if (_0x110495(0x9cc) === 'SsCSP') { _0x510c64[_0x110495(0x29c)] = _0x110495(0x199), _0x4038a2[_0x110495(0x29c)] = _0x110495(0x1f3), _0x5a2d7c[_0x110495(0x759)](_0x110495(0x885))[_0x110495(0x6cc)](_0x110495(0x7ec), _0x44796f), _0x193a75[_0x110495(0x759)](_0x110495(0x248))['addEventListener'](_0x110495(0x7ec), _0x534281); return; } else { const _0x5163c4 = _0x34beab['target'][_0x110495(0x523)][0x0]; if (!_0x5163c4) return; const _0x2a1d45 = URL[_0x110495(0x289)](_0x5163c4); _0xefae80[_0x110495(0x80f)][_0x110495(0xad6)] = _0x110495(0x22e) + _0x2a1d45 + '\x27)'; } }), _0x521e71[_0x187760(0x6cc)]('change', _0x4074d4 => { const _0x381ff2 = _0x187760, _0x2b67a1 = _0x4074d4['target'][_0x381ff2(0x523)][0x0]; if (!_0x2b67a1) return; const _0x5f2752 = URL['createObjectURL'](_0x2b67a1); _0x59b746[_0x381ff2(0x80f)][_0x381ff2(0xad6)] = _0x381ff2(0x22e) + _0x5f2752 + '\x27)'; }), _0x22b7fc['addEventListener'](_0x187760(0x7ec), () => _0x332250['click']()), _0x14d3de[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x408037 = _0x187760; 'hKfyG' === _0x408037(0x93c) ? (localStorage[_0x408037(0x4d2)](_0x408037(0x173)), _0x238ab8(), _0xeba69d('动态页背景已移除。')) : _0x204896[_0xd90b6d]['classList'][_0x408037(0x944)](_0x408037(0x691)); }), _0x332250[_0x187760(0x6cc)]('change', async _0x4c82ff => { const _0x38a35a = _0x187760, _0x3468b4 = _0x4c82ff['target'][_0x38a35a(0x523)][0x0]; if (!_0x3468b4) return; try { if (_0x38a35a(0xad4) === _0x38a35a(0x738)) { _0x50e8b6(); const _0x4d03be = _0x197a01[_0x38a35a(0x123)][_0x38a35a(0x444)](_0x5c66cb => _0x5c66cb['id'] === _0x3431fc); if (!_0x4d03be) return; _0x441d29[_0x38a35a(0x439)] = _0x162856, _0x5a56dc(), _0x40db59[_0x38a35a(0x759)]('friend-circle-title')['textContent'] = _0x4d03be[_0x38a35a(0xb15)], _0x349cc4(), _0x4e2692(_0x38a35a(0xa7c), _0x38a35a(0x8c7)), _0xb1bf63(); } else { const _0x25f083 = await _0x8ff8c6(_0x3468b4); localStorage[_0x38a35a(0x2f5)](_0x38a35a(0x173), _0x25f083), _0x238ab8(), _0xeba69d('动态页背景已更换！'); } } catch (_0x450392) { _0xeba69d('错误:\x20' + _0x450392[_0x38a35a(0x997)]); } }), document[_0x187760(0x759)](_0x187760(0x7b2))['addEventListener']('click', () => _0x57a80a(_0x187760(0x6b7), _0x187760(0x7c2))), document[_0x187760(0x759)](_0x187760(0x58d))[_0x187760(0x6cc)](_0x187760(0x7ec), _0x108bd7); const _0x5dbc23 = document[_0x187760(0x759)](_0x187760(0x15b)), _0x5d58af = document[_0x187760(0x759)](_0x187760(0x403)); _0x5dbc23[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x5d58af['click']()), _0x5d58af[_0x187760(0x6cc)](_0x187760(0x3c6), _0x1434e2 => { const _0xd18978 = _0x187760; if ('gebIT' !== _0xd18978(0x812)) _0x483d78 = _0x180d39[0x1]; else { const _0x4cd40d = _0x1434e2['target'][_0xd18978(0x523)][0x0]; if (!_0x4cd40d) return; const _0x10855f = URL[_0xd18978(0x289)](_0x4cd40d); _0x5dbc23['src'] = _0x10855f, _0x5dbc23[_0xd18978(0x44b)] = () => { const _0x1fe060 = _0xd18978; URL[_0x1fe060(0x4ce)](_0x10855f); }; } }); const _0x36bdcf = document['getElementById'](_0x187760(0x2b7))[_0x187760(0x423)], _0x1f43d1 = document[_0x187760(0x759)](_0x187760(0x774)), _0x35d664 = document['getElementById'](_0x187760(0x2b7)); _0x36bdcf[_0x187760(0x6cc)]('click', () => _0x1f43d1['click']()), _0x1f43d1[_0x187760(0x6cc)](_0x187760(0x3c6), _0x4a9da9 => { const _0x1f5d3c = _0x187760; if (_0x1f5d3c(0x182) === _0x1f5d3c(0x182)) { const _0x31c784 = _0x4a9da9[_0x1f5d3c(0x65e)]['files'][0x0]; if (!_0x31c784) return; const _0x57d02f = URL['createObjectURL'](_0x31c784); document['getElementById'](_0x1f5d3c(0x2b7))[_0x1f5d3c(0x80f)][_0x1f5d3c(0xad6)] = _0x1f5d3c(0x22e) + _0x57d02f + '\x27)'; } else { const _0x52646f = _0x3d03a7['transaction'](_0xf325ad, _0x1f5d3c(0x8e0)), _0x242f33 = _0x52646f[_0x1f5d3c(0x4d6)](_0x5ad285), _0x36537c = _0x242f33[_0x1f5d3c(0x2fe)](_0x3def31); _0x36537c[_0x1f5d3c(0x5f6)] = () => _0x334803(_0x36537c[_0x1f5d3c(0x563)] ? _0x36537c[_0x1f5d3c(0x563)][_0x1f5d3c(0x24c)] : null), _0x36537c[_0x1f5d3c(0x634)] = () => _0x27fa41(_0x36537c[_0x1f5d3c(0x297)]); } }); const _0x2c3e8c = document[_0x187760(0xa01)](_0x187760(0x83e)), _0x11bb00 = document[_0x187760(0x759)](_0x187760(0x4ea)); _0x2c3e8c[_0x187760(0x6cc)]('click', _0x1fe4d4 => { const _0x308530 = _0x187760; _0x1fe4d4[_0x308530(0x479)](), _0x11bb00[_0x308530(0x969)]['toggle'](_0x308530(0x508)), _0x2c3e8c[_0x308530(0x969)][_0x308530(0x378)](_0x308530(0x58b)); }), _0x11bb00[_0x187760(0x6cc)]('change', _0x2d0f87), document[_0x187760(0x759)](_0x187760(0x7bd))[_0x187760(0x6cc)](_0x187760(0x7ec), _0x209a6e), document[_0x187760(0x759)](_0x187760(0x379))[_0x187760(0x6cc)]('click', async () => { const _0x5b6364 = _0x187760; if (_0x5b6364(0xa46) === _0x5b6364(0x377)) { const _0x420b9f = _0x11d958[_0x5b6364(0xa93)](_0x5b6364(0x64e)); _0x420b9f[_0x5b6364(0x8bd)] = _0x5b6364(0x55d); const _0x59c45c = _0x229224[_0x5b6364(0xa93)](_0x5b6364(0x64e)); _0x59c45c[_0x5b6364(0x8bd)] = 'quoted-sender', _0x59c45c[_0x5b6364(0x574)] = _0x50f8af[_0x5b6364(0x554)][_0x5b6364(0x41d)]; const _0x1a64d4 = _0x15452d[_0x5b6364(0xa93)](_0x5b6364(0x64e)); _0x1a64d4[_0x5b6364(0x8bd)] = 'quoted-content', _0x1a64d4[_0x5b6364(0x574)] = _0x7b2726[_0x5b6364(0x554)][_0x5b6364(0x359)], _0x420b9f['appendChild'](_0x59c45c), _0x420b9f[_0x5b6364(0x25f)](_0x1a64d4), _0x5e0a5d[_0x5b6364(0x25f)](_0x420b9f); } else { const _0x1a0e5a = _0xa7e551(); if (!_0x1a0e5a || _0x1a0e5a['type'] !== _0x5b6364(0x867)) return; const _0x1729e9 = await _0x5db04d(_0x5b6364(0x520) + _0x1a0e5a[_0x5b6364(0xb15)] + _0x5b6364(0x465)); _0x1729e9 && (_0x26cabc(_0x1a0e5a['id']), _0xeba69d(_0x5b6364(0x710)), _0x57a80a(_0x5b6364(0x6b7)), _0x47f45b(![])); } }); const _0x5a321f = document[_0x187760(0xa01)](_0x187760(0xa3b)), _0x30a7f4 = document[_0x187760(0x759)](_0x187760(0x567)); _0x5a321f[_0x187760(0x6cc)](_0x187760(0x7ec), _0x3cb8e0 => { const _0xbd7489 = _0x187760; 'LUHOE' === _0xbd7489(0x280) ? (_0x25d9ac['value'] = _0x2ea3ab['apiSettings'][_0xbd7489(0x4f8)] || '', _0x5bba58[_0xbd7489(0xa03)] = _0x1beaca['apiSettings'][_0xbd7489(0x251)] || '', _0x2c8059['value'] = _0x935d66[_0xbd7489(0x7d3)][_0xbd7489(0x48a)] || '', _0x4f6bd9['value'] = _0x52ae27(_0x21cf7e[_0xbd7489(0xa2a)]?.[_0xbd7489(0x164)] ?? 0x64), _0x4d5c1a['getElementById'](_0xbd7489(0x6c7))[_0xbd7489(0xa03)] = _0x30e146[_0xbd7489(0x7d3)]['provider'] || _0xbd7489(0x7d5)) : (_0x3cb8e0[_0xbd7489(0x479)](), _0x30a7f4['classList'][_0xbd7489(0x378)](_0xbd7489(0x508)), _0x5a321f[_0xbd7489(0x969)][_0xbd7489(0x378)]('expanded')); }), _0x30a7f4[_0x187760(0x6cc)](_0x187760(0x3c6), _0x2fae61), document[_0x187760(0x6cc)](_0x187760(0x7ec), _0x1430a8 => { const _0x216000 = _0x187760; if (_0x216000(0x85c) !== 'KLLWn') { const _0x1a8d6f = _0x5e8b44(_0x4b0fd5['content']); _0x4434cf[_0x216000(0x37b)](_0x11e530, { 'content': _0x1a8d6f[_0x216000(0x359)], 'quotedMessage': _0x1a8d6f[_0x216000(0x554)] }); } else !document[_0x216000(0xa01)](_0x216000(0x5ad))[_0x216000(0x233)](_0x1430a8['target']) && (_0x216000(0x8ad) === _0x216000(0x8ad) ? (_0x30a7f4[_0x216000(0x969)][_0x216000(0x41a)](_0x216000(0x508)), _0x5a321f[_0x216000(0x969)][_0x216000(0x41a)](_0x216000(0x58b))) : (_0x305346 = { 'characterId': _0x2858dd[_0x216000(0x313)], 'entries': [] }, _0x529381[_0x216000(0x94d)][_0x216000(0x438)](_0x451a29))); }), _0x120b22[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x23ae8f = _0x187760; _0x23ae8f(0x8f2) !== _0x23ae8f(0x254) ? (_0x13d969(), _0x57a80a(_0x23ae8f(0x3e2), _0x23ae8f(0x83c))) : _0x29ea78(_0x1b80b0 - 0x1); }), document[_0x187760(0x759)]('back-to-home-from-world-book')[_0x187760(0x6cc)]('click', () => _0x57a80a(_0x187760(0x83c), 'worldBook')), document[_0x187760(0x759)]('add-world-book-button')[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x317b4b()), document[_0x187760(0x759)]('back-to-world-book-list')[_0x187760(0x6cc)](_0x187760(0x7ec), () => { _0x13d969(), _0x57a80a('worldBook', 'worldBookEditor'); }), document['getElementById'](_0x187760(0x749))[_0x187760(0x6cc)]('click', _0x372196), document['getElementById'](_0x187760(0x302))[_0x187760(0x6cc)](_0x187760(0x7ec), _0x16378a), _0xf6f048[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x57a80a(_0x187760(0x4fd), 'home')), _0xc08268['addEventListener'](_0x187760(0x7ec), () => _0x57a80a('home', 'wallpaper')), _0x52a652['addEventListener']('click', () => _0x205ca3[_0x187760(0x7ec)]()), _0x205ca3[_0x187760(0x6cc)](_0x187760(0x3c6), async _0x5f3a23 => { const _0x249e19 = _0x187760, _0x5c915e = _0x5f3a23[_0x249e19(0x65e)]['files'][0x0]; if (!_0x5c915e) return; await _0x13e37e(_0x5c915e); }), _0x123104[_0x187760(0x6cc)]('click', () => { const _0x2fdd84 = _0x187760; _0x25cb93(), _0x57a80a(_0x2fdd84(0x6b7), _0x2fdd84(0x83c)); }), _0x2143ee[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x36b2ed = _0x187760; _0x43ad07(); const _0x49da14 = (_0x29b260[_0x36b2ed(0x7d3)][_0x36b2ed(0x4f8)] || '')[_0x36b2ed(0x4da)](_0x817b77); _0xea9089[_0x36b2ed(0x4b9)] = _0x49da14, _0x57a80a(_0x36b2ed(0x8ed), 'home'); }), _0x233fde['addEventListener'](_0x187760(0x7ec), () => _0x57a80a(_0x187760(0x83c), 'settings')), _0x2c9e0e[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x5972e5 = _0x187760; _0x5972e5(0x590) === _0x5972e5(0x590) ? (_0x1a130b(), _0x57a80a(_0x5972e5(0x83c), 'chat')) : _0x282cf7[_0x5972e5(0x42c)] = ![]; }), _0x484d1f[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x5bcebd = _0x187760; if (_0x5bcebd(0x7ca) === _0x5bcebd(0x7ca)) _0x1a130b(), _0x47f45b(![]); else { const _0x3891bc = _0x3dfed2(_0x4724f8[_0x5bcebd(0x49a)]); _0x3891bc && (_0x3891bc[_0x5bcebd(0x433)] = _0x15fe39, _0x557000(_0x451814['activeMeetingCharId'], _0x5bcebd(0x69b))); } }), _0x389aab[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x2ed815 = _0x187760; _0x57a80a(_0x2ed815(0x6b7), _0x2ed815(0x3c9)); }), _0x2b5e35[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x37193d = _0x187760; if (_0x37193d(0x200) === 'roMGq') _0x72ef9[_0x37193d(0x969)][_0x37193d(0x944)](_0x37193d(0x459)); else throw new _0x339834(_0x37193d(0x74b)); }), _0x256bad[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x15568f()), _0x35d548[_0x187760(0x6cc)](_0x187760(0x7ec), _0x1ae21f); function _0x421d7d(_0x5736fe) { const _0x31b848 = _0x187760; if ('YzMnX' !== _0x31b848(0x1c5)) _0x9ed3c8[_0x31b848(0x713)] = 'text'; else { if (!_0x5736fe || _0x5736fe[_0x31b848(0x713)] !== _0x31b848(0x867)) return; const _0x374808 = _0x31b848(0x323); document[_0x31b848(0x402)][_0x31b848(0x9e0)](_0x31b848(0x7b4), _0x374808); const _0x3cc1c6 = document['getElementById'](_0x31b848(0xa2e)), _0xdc3b7e = _0x3cc1c6[_0x31b848(0xa01)](_0x31b848(0x4e2)), _0x7fe888 = document['getElementById'](_0x31b848(0x1ae)), _0xc33e4d = document['getElementById'](_0x31b848(0xb0e)), _0x169783 = document[_0x31b848(0x759)](_0x31b848(0x814)), _0x328ea0 = document[_0x31b848(0x759)](_0x31b848(0x261)), _0x27cc0f = document[_0x31b848(0x759)](_0x31b848(0x2d7)), _0x4ce435 = () => _0x3cc1c6[_0x31b848(0x41a)](); _0x7fe888['addEventListener'](_0x31b848(0x7ec), async () => { const _0x4d8638 = _0x31b848; _0x4ce435(); const _0x4488f3 = await _0x5db04d(_0x4d8638(0x882) + _0x5736fe[_0x4d8638(0xb15)] + '\x22\x20的聊天记录吗？此操作不可撤销。'); if (_0x4488f3) { if (_0x4d8638(0x4ed) !== _0x4d8638(0x4ed)) _0x278271(_0x4d8638(0x83c), _0x4d8638(0x45e)); else { if (_0x5736fe['id'] === _0x29b260['activeChatId']) { if (_0x4d8638(0x6b2) === _0x4d8638(0x35a)) return _0xef6dfc[_0x4d8638(0x6af)](_0x3235d0, _0x470a88 + 0x1); else _0x1a130b(), _0x29b260['conversationHistory'] = [], _0x448e33(); } try { _0x4d8638(0x4d3) !== _0x4d8638(0x4d3) ? _0x3b3da5[_0x4d8638(0x686)] = _0x41f707[_0x4d8638(0x7ee)] : (localStorage[_0x4d8638(0x4d2)](_0x4d8638(0x4a9) + _0x5736fe['id']), _0xeba69d(_0x4d8638(0x4d5) + _0x5736fe[_0x4d8638(0xb15)] + _0x4d8638(0x190))); } catch (_0x49ada8) { if (_0x4d8638(0xaf7) === 'KRIFQ') console[_0x4d8638(0x297)]('Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20' + _0x5736fe['id'], _0x49ada8), _0xeba69d(_0x4d8638(0x859)); else { const _0x53cc06 = _0x31cefa[_0x4d8638(0x65e)]['files'][0x0]; if (!_0x53cc06) return; try { const _0x4587ff = _0x5be834['createObjectURL'](_0x53cc06); _0x3d66c0[_0x4d8638(0x80f)][_0x4d8638(0xad6)] = _0x4d8638(0x22e) + _0x4587ff + '\x27)'; } catch (_0x364914) { _0xe40f3d(_0x4d8638(0x912) + _0x364914[_0x4d8638(0x997)]); } } } } } }), _0xc33e4d[_0x31b848(0x6cc)](_0x31b848(0x7ec), () => { const _0x483243 = _0x31b848; _0x4ce435(), _0xeba69d(_0x483243(0x767)); }), _0x169783[_0x31b848(0x6cc)](_0x31b848(0x7ec), async () => { const _0x493a32 = _0x31b848; if (_0x493a32(0x373) !== 'PBDTs') _0x2338ab[_0x493a32(0x297)](_0x493a32(0x935), _0x518357); else { _0x4ce435(); const _0x18c1ad = prompt(_0x493a32(0x687), _0x5736fe[_0x493a32(0xb15)]); if (_0x18c1ad && _0x18c1ad[_0x493a32(0x74e)]() && _0x18c1ad !== _0x5736fe[_0x493a32(0xb15)]) { if (_0x493a32(0x6ca) === 'pDktD') _0x5736fe[_0x493a32(0xb15)] = _0x18c1ad[_0x493a32(0x74e)](), _0xf10e4a(), _0x25cb93(), _0xba948e(), _0xeba69d(_0x493a32(0x59e) + _0x5736fe[_0x493a32(0xb15)] + '\x22。'); else { const _0x3b8177 = _0x18b6cd[_0x493a32(0x1db)](_0x5f35c2[_0x493a32(0x2f7)][_0x493a32(0xa05)][_0x493a32(0x998)](/&quot;/g, '\x22')), _0x3a12ff = _0x434842[_0x493a32(0x2f7)][_0x493a32(0xa44)], _0x40e5a7 = _0x522dc4['dataset']['characterName']; _0x5a18f1(_0x3a12ff, _0x40e5a7, _0x3b8177); } } } }), _0x328ea0[_0x31b848(0x6cc)]('click', async () => { const _0x351215 = _0x31b848; if (_0x351215(0x30d) === 'WisWd') { _0x4ce435(); const _0x56c688 = await _0x5db04d(_0x351215(0x9a4) + _0x5736fe['name'] + _0x351215(0x9e4)); if (_0x56c688) { if (_0x351215(0x593) === _0x351215(0xa9a)) { const _0x37acab = _0x5efd4d['target'][_0x351215(0x523)][0x0]; if (!_0x37acab) return; const _0x2e926f = _0x517f26['createObjectURL'](_0x37acab); _0x3770e4[_0x351215(0x686)] = _0x2e926f, _0xd9ce73['onload'] = () => { const _0x5e6f73 = _0x351215; _0x40f45e[_0x5e6f73(0x4ce)](_0x2e926f); }; } else _0x26cabc(_0x5736fe['id']), _0xeba69d(_0x351215(0x4d5) + _0x5736fe['name'] + '\x22\x20已删除。'), _0x47f45b(![]); } } else { const _0x41bd9e = _0x102e36[_0x351215(0x44f)]['find'](_0x18ad42 => _0x18ad42['id'] === _0x1727f9[_0x351215(0x113)]) || { 'name': '你' }, _0x385e1b = _0x3465cd[_0x351215(0x94d)][_0x351215(0x444)](_0xc3d6be => _0xc3d6be[_0x351215(0x94f)] === _0x31ef84); if (!_0x385e1b || !_0x385e1b[_0x351215(0xa18)] || _0x385e1b[_0x351215(0xa18)][_0x351215(0x919)] === 0x0) return ''; const _0x4492ef = _0x385e1b[_0x351215(0xa18)][_0x351215(0x1f9)](-0x8), _0xfc217f = _0x4492ef[_0x351215(0xa96)](_0x528b09 => { const _0x1bc09d = _0x351215, _0x47105b = _0x528b09['author'] === _0x1bc09d(0x544) ? _0x41bd9e['name'] : _0x550648(_0x528b09['author'])['name']; return _0x1bc09d(0x4c0) + new _0x395e6b(_0x528b09[_0x1bc09d(0x6de)])[_0x1bc09d(0x7c8)]() + ']\x20' + _0x47105b + _0x1bc09d(0x660) + _0x528b09[_0x1bc09d(0x359)]; })[_0x351215(0x63b)]('\x0a'); return _0x351215(0xb1b) + _0x41bd9e['name'] + '\x20之间的私密内容)\x0a' + _0xfc217f; } }), _0xdc3b7e['addEventListener']('click', _0x4ce435), _0x27cc0f[_0x31b848(0x6cc)]('click', _0x4ce435); } } _0x2d7e43[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x4da2f7 = _0x187760, _0x2b5ce9 = _0xa7e551(); if (_0x2b5ce9 && _0x2b5ce9[_0x4da2f7(0x713)] === _0x4da2f7(0x7ad)) _0x528a37(_0x2b5ce9['participantIds'][0x0]); else _0x2b5ce9 && _0x2b5ce9[_0x4da2f7(0x713)] === _0x4da2f7(0x867) && _0x573edd(_0x2b5ce9['id']); }), _0x3da0ef[_0x187760(0x6cc)](_0x187760(0xa53), _0x313140 => { const _0x4d14c9 = _0x187760; _0x313140[_0x4d14c9(0x251)] === _0x4d14c9(0x674) && !_0x313140[_0x4d14c9(0x943)] && (_0x313140['preventDefault'](), _0x15568f()); }); const _0x55cdaa = () => _0x72ef9[_0x187760(0x969)][_0x187760(0x41a)]('show'); _0x37bd48[_0x187760(0x6cc)](_0x187760(0x7ec), _0x55cdaa), _0x586717['addEventListener'](_0x187760(0x7ec), _0x55cdaa), _0x1de01e['addEventListener'](_0x187760(0x7ec), () => { _0x55cdaa(), _0x528a37(); }), _0x36bb89['addEventListener'](_0x187760(0x7ec), () => { _0x55cdaa(), _0x466142(); }), _0x544086['addEventListener']('click', () => { const _0x123509 = _0x187760; _0x123509(0x2bc) === _0x123509(0x4d0) ? _0x529b7e > _0x3cd7c8 && (_0x4a984f *= _0x336242 / _0x28b9d1, _0x2a4191 = _0x2d4487) : (_0x57a80a('chat', _0x123509(0xa94)), _0x47f45b(![])); }), _0x3361bf[_0x187760(0x6cc)](_0x187760(0x7ec), _0x131789), _0x32ced9[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x521a39 = _0x187760; _0x521a39(0xaad) === _0x521a39(0xaad) ? (_0x2d1d45['classList'][_0x521a39(0x378)](_0x521a39(0x459)), _0x2d1d45['classList'][_0x521a39(0x233)](_0x521a39(0x459)) && (_0x41a1da[_0x521a39(0x19f)] = _0x41a1da[_0x521a39(0x837)])) : _0x5678b0(_0x3cbe82, _0x59826a[_0x521a39(0x65e)][_0x521a39(0x523)][0x0]); }), _0x4e04c6[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x4bedb5[_0x187760(0x7ec)]()); const _0x387725 = document['getElementById'](_0x187760(0x5b4)); _0x4bedb5['addEventListener']('change', _0xebc7a0), _0x387725[_0x187760(0x6cc)]('click', _0x29962e), _0x1d9054['addEventListener'](_0x187760(0x7ec), _0x424034), _0xbb9757[_0x187760(0x6cc)](_0x187760(0x7ec), _0x44caf7), _0x174e96[_0x187760(0x6cc)](_0x187760(0x7ec), _0x2da5b2), _0x49783d['addEventListener'](_0x187760(0x7ec), _0x209a6e), _0x287a34[_0x187760(0x6cc)]('click', async () => { const _0x19a10d = _0x187760, _0x4badb9 = _0x2f40df['value']; if (!_0x4badb9) return; const _0x455593 = _0x4cc875(_0x4badb9); if (!_0x455593) return; const _0x2ca00e = await _0x5db04d(_0x19a10d(0x183) + _0x455593[_0x19a10d(0xb15)] + '”吗？该角色的私聊和所有相关群聊记录都将被一并处理。'); _0x2ca00e && (_0xb806d3(_0x4badb9), _0xeba69d(_0x19a10d(0x70e) + _0x455593[_0x19a10d(0xb15)] + _0x19a10d(0x33a)), _0x57a80a(_0x19a10d(0x6b7), 'characterEdit'), _0x47f45b(![])); }), _0x65d35[_0x187760(0x6cc)](_0x187760(0x3cb), () => { const _0x3a812b = _0x187760; if (_0x3a812b(0x2bf) !== _0x3a812b(0x2bf)) _0xcc0667(); else { const _0x2d0bae = _0x65d35['value'][_0x3a812b(0x74e)]()['includes'](_0x817b77); _0xea9089[_0x3a812b(0x4b9)] = _0x2d0bae; } }); async function _0xf84ef5() { const _0x32eff1 = _0x187760, _0x3bcdb4 = _0x65d35[_0x32eff1(0xa03)]['trim'](), _0x579941 = _0x4b6fa5[_0x32eff1(0xa03)]['trim'](); if (!_0x3bcdb4 || !_0x579941) { _0xeba69d('请先输入\x20API\x20接口地址和密钥。'); return; } const _0x4347bd = _0x3bcdb4[_0x32eff1(0x998)](/\/+$/, ''), _0x55b641 = _0x4347bd + _0x32eff1(0x88c); _0xea9089[_0x32eff1(0x4b9)] = !![], _0xea9089[_0x32eff1(0x574)] = _0x32eff1(0xa30), _0x5edc33[_0x32eff1(0x969)]['remove']('show'); try { const _0x3ce57b = await fetch(_0x55b641, { 'headers': { 'Authorization': _0x32eff1(0xa0b) + _0x4f3d46(_0x579941) } }); if (!_0x3ce57b['ok']) throw new Error(_0x32eff1(0x208) + _0x3ce57b[_0x32eff1(0x70f)]); const _0x17c811 = await _0x3ce57b['json'](), _0x932c19 = (_0x17c811[_0x32eff1(0x2c8)] || _0x17c811)[_0x32eff1(0xa96)](_0x596ab1 => _0x596ab1['id'])[_0x32eff1(0x8d8)](); if (_0x932c19[_0x32eff1(0x919)] > 0x0) { if (_0x32eff1(0x5ac) !== _0x32eff1(0x57c)) _0x5edc33[_0x32eff1(0x29c)] = '', _0x932c19[_0x32eff1(0xa3d)](_0x2b390f => { const _0x2cc1d1 = _0x32eff1, _0x3028f8 = document['createElement']('div'); _0x3028f8['textContent'] = _0x2b390f, _0x3028f8[_0x2cc1d1(0x6cc)](_0x2cc1d1(0x7ec), () => { const _0x63f46c = _0x2cc1d1; if (_0x63f46c(0x23d) !== _0x63f46c(0x23d)) { const _0x3982eb = _0x1a89a1['querySelectorAll']('.typing-indicator'); _0x3982eb[_0x63f46c(0xa3d)](_0x223cea => _0x223cea['remove']()); } else _0x23c208[_0x63f46c(0xa03)] = _0x2b390f, _0x5edc33[_0x63f46c(0x969)][_0x63f46c(0x41a)](_0x63f46c(0x459)); }), _0x5edc33[_0x2cc1d1(0x25f)](_0x3028f8); }), _0x5edc33['classList']['add'](_0x32eff1(0x459)), _0xeba69d('成功获取\x20' + _0x932c19['length'] + _0x32eff1(0x768)); else { const _0x590116 = new _0x558d84(_0x18a124[_0x32eff1(0x6de)])[_0x32eff1(0x80b)](_0x32eff1(0x513), { 'hour': _0x32eff1(0x4ca), 'minute': _0x32eff1(0x4ca) }); _0x35a15e[_0x32eff1(0x359)] && _0x2d8ee3[_0x32eff1(0x438)]('[' + _0x590116 + _0x32eff1(0x985) + _0x509449(_0x96bd3a) + ']\x20' + _0x41ac63(_0x54ea30[_0x32eff1(0x359)])[_0x32eff1(0x74e)]()); } } else _0xeba69d(_0x32eff1(0x753)); } catch (_0x449716) { 'vOKns' !== 'vOKns' ? (_0x3315b4[_0x32eff1(0x44f)] = _0xb6cd7a[_0x32eff1(0x44f)]['filter'](_0x1a8a44 => _0x1a8a44['id'] !== _0x3223e1), _0x239b2d[_0x32eff1(0x113)] === _0x4d61b4 && (_0x2a7c06[_0x32eff1(0x113)] = _0x165cb1['userProfiles'][0x0]['id']), _0x572573[_0x32eff1(0x6df)][_0x32eff1(0xa3d)](_0x328658 => { const _0x165ec2 = _0x32eff1; _0x328658[_0x165ec2(0x515)] === _0x1065d7 && (_0x328658['boundUserProfileId'] = _0x2f031c[_0x165ec2(0x113)]); }), _0x28f527(), _0x24ca5f(_0x32eff1(0x3f0)), _0x5019f6(), _0x5e229c('userProfileList', _0x32eff1(0xa77))) : _0xeba69d(_0x32eff1(0x78c) + _0x449716[_0x32eff1(0x997)] + _0x32eff1(0x6bb)); } finally { _0xea9089['disabled'] = ![], _0xea9089['textContent'] = '获取'; } } _0xea9089[_0x187760(0x6cc)](_0x187760(0x7ec), _0x546e86 => { _0x546e86['stopPropagation'](), _0xf84ef5(); }), document[_0x187760(0x6cc)](_0x187760(0x7ec), _0x194398 => { const _0x111661 = _0x187760; !_0x5edc33['contains'](_0x194398[_0x111661(0x65e)]) && _0x194398[_0x111661(0x65e)] !== _0x23c208 && _0x194398[_0x111661(0x65e)] !== _0xea9089 && _0x5edc33[_0x111661(0x969)][_0x111661(0x41a)](_0x111661(0x459)); }); async function _0x8ff8c6(_0x5bebcb) { const _0x1d075e = _0x187760; if (_0x1d075e(0x368) !== _0x1d075e(0x1aa)) return await _0x3a4746(_0x5bebcb, 0x190, 0.85); else { _0x52f90c[_0x1d075e(0x297)](_0x1d075e(0x852) + _0x550775[_0x1d075e(0xb15)] + _0x1d075e(0x3a7)); return; } } _0x3bb42d[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x5682c0[_0x187760(0x7ec)]()), _0x5682c0['addEventListener']('change', async _0x42e012 => { const _0x2f97af = _0x187760, _0x88ab55 = _0x42e012[_0x2f97af(0x65e)]['files'][0x0]; if (!_0x88ab55) return; try { if (_0x2f97af(0xafd) === _0x2f97af(0xafd)) { const _0x17387e = await _0x8ff8c6(_0x88ab55), _0x23c9cd = document['getElementById'](_0x2f97af(0x894)); _0x23c9cd['style']['backgroundImage'] = _0x2f97af(0x22e) + _0x17387e + '\x27)', _0x23c9cd[_0x2f97af(0x2f7)][_0x2f97af(0x25b)] = _0x17387e; } else { const _0x4fed1a = _0x192a11['getElementById']('world-book-list-container'); _0x4fed1a[_0x2f97af(0x29c)] = ''; if (_0x5dbf99[_0x2f97af(0x1a1)]['length'] === 0x0) { _0x4fed1a[_0x2f97af(0x29c)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>'; return; } _0xdf33b3[_0x2f97af(0x1a1)][_0x2f97af(0xa3d)](_0xf860cf => { const _0xdea21f = _0x2f97af, _0x5bf10a = _0x53d8cb[_0xdea21f(0xa93)](_0xdea21f(0x64e)); _0x5bf10a[_0xdea21f(0x8bd)] = 'world-book-item', _0x5bf10a['dataset']['id'] = _0xf860cf['id'], _0x5bf10a['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0xf860cf[_0xdea21f(0xb15)] + _0xdea21f(0x189) + _0xf860cf['content'][_0xdea21f(0x6af)](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20', _0x5bf10a[_0xdea21f(0x6cc)](_0xdea21f(0x7ec), () => _0x5a253f(_0xf860cf['id'])), _0x4fed1a['appendChild'](_0x5bf10a); }); } } catch (_0x3d28a1) { if (_0x2f97af(0xac1) === _0x2f97af(0xac1)) _0xeba69d('错误:\x20' + _0x3d28a1[_0x2f97af(0x997)]); else { const _0x42854e = _0x1d52e7[_0x2f97af(0x9ce)][_0x2f97af(0x9f6)](_0x501898 => _0x501898[_0x2f97af(0x713)] === _0x2f97af(0xa7c) && _0x501898['playableUrl'])[_0x2f97af(0xa96)](_0x277a54 => ({ ..._0x277a54, 'source': 'feed' })); _0x3f59e0[_0x2f97af(0x438)](..._0x42854e); } } }), _0x509d18[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x315e49[_0x187760(0x7ec)]()), _0x315e49[_0x187760(0x6cc)](_0x187760(0x3c6), async _0x52770f => { const _0x59dc27 = _0x187760, _0x18d63a = _0x52770f[_0x59dc27(0x65e)][_0x59dc27(0x523)][0x0]; if (!_0x18d63a) return; try { _0x509d18[_0x59dc27(0x686)] = await _0x8ff8c6(_0x18d63a); } catch (_0x13dbdb) { _0xeba69d(_0x59dc27(0xaf9) + _0x13dbdb['message']); } }); function _0x10d321() { const _0x3e1a55 = _0x187760; if ('OwDFA' !== _0x3e1a55(0x926)) _0x2d1d45[_0x3e1a55(0x29c)] = '', _0x53fca2[_0x3e1a55(0xa3d)](_0x5a22f3 => { const _0xdcea38 = _0x3e1a55, _0x2272e0 = document['createElement'](_0xdcea38(0x36b)); _0x2272e0[_0xdcea38(0x686)] = _0x5a22f3['url'], _0x2272e0[_0xdcea38(0x365)] = _0xdcea38(0x8f8), _0x2272e0[_0xdcea38(0x640)] = _0x5a22f3[_0xdcea38(0xb15)], _0x2272e0[_0xdcea38(0x969)][_0xdcea38(0x944)](_0xdcea38(0x702)), _0x2272e0[_0xdcea38(0x6cc)]('click', () => _0x2412f1(_0x5a22f3)), _0x2d1d45[_0xdcea38(0x25f)](_0x2272e0); }); else { const _0x4f7863 = _0x1a926c[_0x3e1a55(0x759)]('user-profile-list-container'); _0x4f7863[_0x3e1a55(0x29c)] = ''; if (_0x3ccc9c[_0x3e1a55(0x44f)][_0x3e1a55(0x919)] === 0x0) { _0x4f7863['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>'; return; } _0xb5dd3[_0x3e1a55(0x44f)][_0x3e1a55(0xa3d)](_0x395cb2 => { const _0x1cac10 = _0x3e1a55, _0x57cd93 = _0x536c8c[_0x1cac10(0xa93)]('div'); _0x57cd93['className'] = 'world-book-item', _0x57cd93[_0x1cac10(0x2f7)]['id'] = _0x395cb2['id']; const _0x5b53d8 = _0x395cb2['id'] === _0x4384aa[_0x1cac10(0x113)] ? _0x1cac10(0x4c6) : ''; _0x57cd93['innerHTML'] = _0x1cac10(0x1f4) + (_0x395cb2[_0x1cac10(0x96f)] || _0x287a13) + _0x1cac10(0x669) + _0x395cb2[_0x1cac10(0xb15)] + _0x5b53d8 + _0x1cac10(0x78a) + _0x395cb2['persona'][_0x1cac10(0x6af)](0x0, 0x64) + _0x1cac10(0x535), _0x57cd93['addEventListener']('click', () => _0x4a7a06(_0x395cb2['id'])), _0x4f7863[_0x1cac10(0x25f)](_0x57cd93); }); } } async function _0x1efcbd(_0x26baac) { const _0x5c2fe9 = _0x187760; if (_0x5c2fe9(0x2da) !== _0x5c2fe9(0x63f)) { const _0x314f40 = await _0x5db04d(_0x5c2fe9(0x7f2)); if (!_0x314f40) return; const _0x3b7a3c = _0x29b260[_0x5c2fe9(0x901)][_0x5c2fe9(0x961)](_0x3b496b => _0x3b496b['id'] === _0x26baac); if (_0x3b7a3c > -0x1) { if ('VwwQY' === _0x5c2fe9(0x778)) _0x29b260[_0x5c2fe9(0x901)][_0x5c2fe9(0x903)](_0x3b7a3c, 0x1), _0xf10e4a(), _0x1ccad1(), _0x5d1f00(), _0x5bea2a(), _0xeba69d('已经删掉了。'); else { _0x295ab3('名字不能为空！'); return; } } } else _0x5dce8d[_0x5c2fe9(0x969)][_0x5c2fe9(0x41a)]('show'), _0x3ebdec['onclick'] = null, _0x9aed10[_0x5c2fe9(0x356)] = null, _0x81e5ef[_0x5c2fe9(0x356)] = null, _0x574018[_0x5c2fe9(0x601)](_0x5c2fe9(0xa53), _0x52711b), _0x5649b0(_0x1d29c3); } let _0x1638c3 = null; function _0x340698(_0x442bb4) { const _0x32ad23 = _0x187760; if (_0x32ad23(0x50d) !== _0x32ad23(0xb2b)) { if (_0x1638c3) clearTimeout(_0x1638c3); const _0x10d2a7 = _0x442bb4[_0x32ad23(0x65e)]['closest'](_0x32ad23(0x6e1)); if (!_0x10d2a7) return; const _0x160263 = _0x10d2a7[_0x32ad23(0x2f7)]['id']; if (!_0x160263) return; const _0x23f612 = () => { const _0x2b6e7a = _0x32ad23; 'xGdhh' === _0x2b6e7a(0x5e9) ? (_0x34cbba(), _0x51f19d(![]), _0x3ee14f[_0x2b6e7a(0x27c)] = ![]) : _0x1638c3 = setTimeout(() => { const _0x5916ac = _0x2b6e7a; if (_0x442bb4[_0x5916ac(0x713)] === _0x5916ac(0x536)) _0x442bb4['preventDefault'](); _0x1efcbd(_0x160263); }, 0x320); }, _0x548dbf = () => { const _0x182188 = _0x32ad23; if (_0x182188(0x351) !== _0x182188(0x351)) _0x333aeb = _0x123f66[_0x182188(0x2a5)](_0x5e8d2b); else { if (_0x1638c3) clearTimeout(_0x1638c3); } }; document['addEventListener'](_0x32ad23(0x57a), _0x548dbf, { 'once': !![] }), document[_0x32ad23(0x6cc)]('touchend', _0x548dbf, { 'once': !![] }), document[_0x32ad23(0x6cc)](_0x32ad23(0xaf6), _0x548dbf, { 'once': !![] }), document[_0x32ad23(0x6cc)]('touchmove', _0x548dbf, { 'once': !![] }), _0x23f612(); } else _0x35517f += '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概' + _0xf5219c[_0x32ad23(0x6f8)](_0x110522 / 0x3c) + _0x32ad23(0x5d8); } function _0x397e34(_0x3fe207) { const _0x365033 = _0x187760, _0x4f4fbf = _0x29b260[_0x365033(0x6df)]['find'](_0x8d1c2 => _0x8d1c2[_0x365033(0x9be)][_0x365033(0x4da)](_0x3fe207)); if (!_0x4f4fbf) return ''; const _0xf30eb6 = _0x33ec75(_0x4f4fbf['id']), _0x118c54 = _0x29b260['calendarEvents'][_0x365033(0x9f6)](_0x4741b5 => _0x4741b5[_0x365033(0x3bf)] === _0xf30eb6['id'] || !_0x4741b5[_0x365033(0x3bf)]); if (_0x118c54[_0x365033(0x919)] === 0x0) return ''; const _0x2e4da9 = _0x118c54[_0x365033(0xa96)](_0x5340a4 => { const _0x21c921 = _0x365033, _0x4b3d84 = _0x5340a4['type'] === 'important' ? _0x21c921(0x670) : '待办'; return _0x21c921(0x4c0) + _0x4b3d84 + ']\x20' + _0x5340a4[_0x21c921(0x653)] + ':\x20' + _0x5340a4[_0x21c921(0x359)]; })[_0x365033(0x63b)]('\x0a'); return _0x365033(0x61a) + _0xf30eb6[_0x365033(0xb15)] + _0x365033(0xa7f) + _0x2e4da9; } let _0x55a867 = { 'currentDate': new Date(), 'selectedDate': _0x21c2ed() }; function _0x27d3f3() { const _0x3b6b44 = _0x187760; if (_0x3b6b44(0x202) !== 'gVTFC') { document['getElementById'](_0x3b6b44(0x9ec))[_0x3b6b44(0x6cc)](_0x3b6b44(0x7ec), () => { const _0x2fdd76 = _0x3b6b44; _0x1ccad1(), _0x57a80a(_0x2fdd76(0x8fe), 'home'); }), document[_0x3b6b44(0x759)]('back-to-home-from-calendar')[_0x3b6b44(0x6cc)](_0x3b6b44(0x7ec), () => _0x57a80a(_0x3b6b44(0x83c), 'calendar')), document[_0x3b6b44(0x759)]('prev-month-btn')[_0x3b6b44(0x6cc)](_0x3b6b44(0x7ec), () => { const _0x578663 = _0x3b6b44; _0x55a867[_0x578663(0x5c7)][_0x578663(0x117)](_0x55a867[_0x578663(0x5c7)][_0x578663(0x950)]() - 0x1), _0x1ccad1(); }), document[_0x3b6b44(0x759)]('next-month-btn')['addEventListener'](_0x3b6b44(0x7ec), () => { const _0x32f108 = _0x3b6b44; _0x55a867[_0x32f108(0x5c7)]['setMonth'](_0x55a867['currentDate'][_0x32f108(0x950)]() + 0x1), _0x1ccad1(); }), document['getElementById'](_0x3b6b44(0xb23))[_0x3b6b44(0x6cc)](_0x3b6b44(0x7ec), () => { _0x55a867['currentDate'] = new Date(), _0x55a867['selectedDate'] = _0x21c2ed(), _0x1ccad1(); }), document[_0x3b6b44(0x759)](_0x3b6b44(0x192))[_0x3b6b44(0x6cc)](_0x3b6b44(0x7ec), () => { const _0x2d83f2 = _0x3b6b44; _0x4fcfda(_0x55a867[_0x2d83f2(0x29f)]); }), document[_0x3b6b44(0x759)]('save-event-button')[_0x3b6b44(0x6cc)](_0x3b6b44(0x7ec), _0x4c0ae9), document['getElementById']('cancel-event-button')[_0x3b6b44(0x6cc)]('click', () => document[_0x3b6b44(0x759)](_0x3b6b44(0x1e2))['classList']['remove'](_0x3b6b44(0x459))), document[_0x3b6b44(0x759)](_0x3b6b44(0x981))[_0x3b6b44(0x6cc)](_0x3b6b44(0x7ec), () => document[_0x3b6b44(0x759)](_0x3b6b44(0x1e2))['classList'][_0x3b6b44(0x41a)](_0x3b6b44(0x459))); const _0x42646a = document[_0x3b6b44(0x759)](_0x3b6b44(0x38a)); _0x42646a[_0x3b6b44(0x6cc)](_0x3b6b44(0xa06), _0x340698), _0x42646a['addEventListener'](_0x3b6b44(0x536), _0x340698, { 'passive': ![] }); } else _0x349fc5 = _0x4a020c[_0x3b6b44(0xa03)]; } function _0x1ccad1() { const _0x561980 = _0x187760, _0x5c29ab = _0x55a867['currentDate'][_0x561980(0xb29)](), _0x47c5fe = _0x55a867[_0x561980(0x5c7)][_0x561980(0x950)](); document[_0x561980(0x759)](_0x561980(0x3b2))['textContent'] = _0x5c29ab + '年\x20' + (_0x47c5fe + 0x1) + '月', _0x6e0d2(_0x5c29ab, _0x47c5fe), _0x2d2025(_0x55a867['selectedDate']); } function _0x5bea2a() { const _0x53b0b5 = _0x187760; if (_0x53b0b5(0x617) === 'rftYk') { const _0x4183e0 = document[_0x53b0b5(0x759)]('today-todo-list'); if (!_0x4183e0) return; const _0x5967e5 = _0x21c2ed(), _0x16a093 = _0x29b260[_0x53b0b5(0x901)][_0x53b0b5(0x9f6)](_0x1eb29c => _0x1eb29c[_0x53b0b5(0x653)] === _0x5967e5 && _0x1eb29c[_0x53b0b5(0x713)] === _0x53b0b5(0x1dd)); _0x4183e0['innerHTML'] = '', _0x16a093['length'] > 0x0 ? _0x53b0b5(0x8cf) === _0x53b0b5(0x511) ? _0xa17a29 += _0x53b0b5(0x959) : _0x16a093[_0x53b0b5(0xa3d)](_0x370c6f => { const _0x410ac8 = _0x53b0b5; if (_0x410ac8(0x7f9) !== 'QQyNx') _0x787a94['participantIds'][_0x410ac8(0xa3d)](_0x2fe0d3 => { const _0xa1b22e = _0x410ac8, _0x1b3023 = _0x107a73(_0x2fe0d3); if (_0x1b3023) { const _0x2afc5c = _0xa9aab4[_0xa1b22e(0xa93)]('option'); _0x2afc5c['value'] = _0x1b3023['id'], _0x2afc5c[_0xa1b22e(0x574)] = _0x1b3023[_0xa1b22e(0xb15)], _0x17a31a[_0xa1b22e(0x25f)](_0x2afc5c); } }), _0x45831b[_0x410ac8(0x80f)][_0x410ac8(0x3e7)] = _0x410ac8(0x210); else { const _0x31e8dc = document['createElement']('div'); _0x31e8dc[_0x410ac8(0x8bd)] = 'todo-item-small', _0x31e8dc[_0x410ac8(0x574)] = _0x370c6f['content'], _0x4183e0[_0x410ac8(0x25f)](_0x31e8dc); } }) : _0x4183e0['innerHTML'] = _0x53b0b5(0x7e8); } else _0x91e45[_0x53b0b5(0x861)] = _0x1c4352[_0x53b0b5(0x861)] || [], _0x51a458['comments'] = (_0x5c604c[_0x53b0b5(0x566)] || [])[_0x53b0b5(0xa96)]((_0x4e4a16, _0x258c96) => ({ ..._0x4e4a16, 'commentId': 'c_' + _0x26bca0[_0x53b0b5(0x6de)] + '_' + _0x258c96 })), _0x4924e3(), _0x152d45(); } function _0x6e0d2(_0x276775, _0x1a56e8) { const _0x39034b = _0x187760; if ('vBlmp' !== _0x39034b(0x4bc)) { const _0x2da5a8 = document[_0x39034b(0x759)](_0x39034b(0x87e)); _0x2da5a8[_0x39034b(0x29c)] = ''; const _0x53d251 = new Date(_0x276775, _0x1a56e8, 0x1)[_0x39034b(0x716)](), _0x52ff8c = new Date(_0x276775, _0x1a56e8 + 0x1, 0x0)['getDate'](), _0x1e67b9 = _0x21c2ed(); for (let _0x11c10c = 0x0; _0x11c10c < _0x53d251; _0x11c10c++) { 'gWGbh' === 'tUxXc' ? (_0x1e1f9f(![]), _0x11877e[_0x39034b(0x27c)] = ![]) : _0x2da5a8[_0x39034b(0x25f)](document['createElement'](_0x39034b(0x64e))); } for (let _0x7707a7 = 0x1; _0x7707a7 <= _0x52ff8c; _0x7707a7++) { const _0x508ff7 = document['createElement']('div'); _0x508ff7[_0x39034b(0x8bd)] = _0x39034b(0x795); const _0x2e1e46 = _0x276775 + '-' + String(_0x1a56e8 + 0x1)[_0x39034b(0x27e)](0x2, '0') + '-' + String(_0x7707a7)[_0x39034b(0x27e)](0x2, '0'); if (_0x2e1e46 === _0x1e67b9) _0x508ff7[_0x39034b(0x969)][_0x39034b(0x944)](_0x39034b(0x4d7)); if (_0x2e1e46 === _0x55a867[_0x39034b(0x29f)]) _0x508ff7[_0x39034b(0x969)][_0x39034b(0x944)]('is-selected'); const _0x3361eb = document[_0x39034b(0xa93)](_0x39034b(0x9f0)); _0x3361eb['className'] = _0x39034b(0x6ab), _0x3361eb['textContent'] = _0x7707a7, _0x508ff7[_0x39034b(0x25f)](_0x3361eb); const _0x1fbdde = _0x29b260['calendarEvents']['filter'](_0x42b4ef => _0x42b4ef[_0x39034b(0x653)] === _0x2e1e46); if (_0x1fbdde[_0x39034b(0x919)] > 0x0) { if (_0x39034b(0xb2e) === _0x39034b(0xb2e)) { const _0x49700f = document['createElement'](_0x39034b(0x64e)); _0x49700f['className'] = 'day-dot', _0x508ff7[_0x39034b(0x25f)](_0x49700f); } else { _0x1e6fb4('歌名和歌手都不能为空！'); return; } } _0x508ff7['addEventListener'](_0x39034b(0x7ec), () => { const _0x103f2e = _0x39034b; 'QpbEF' === _0x103f2e(0x226) ? (_0x55a867[_0x103f2e(0x29f)] = _0x2e1e46, _0x1ccad1()) : (_0x26c3b9[_0x103f2e(0x297)]('保存角色失败:', _0x365ad1), _0x879c86(_0x103f2e(0x53b) + _0x5f54a3[_0x103f2e(0x997)])); }), _0x2da5a8[_0x39034b(0x25f)](_0x508ff7); } } else _0x123c4c += _0x39034b(0x97f) + _0x3a9fd5[_0x39034b(0xb15)] + _0x39034b(0x546); } function _0x2d2025(_0x57461c) { const _0x41504b = _0x187760, _0x1c16ee = document[_0x41504b(0x759)]('todo-list'), _0x444fb5 = document[_0x41504b(0x759)](_0x41504b(0x406)); _0x1c16ee[_0x41504b(0x29c)] = ''; const _0x53d93d = new Date(_0x57461c + _0x41504b(0xa1d)); _0x444fb5[_0x41504b(0x574)] = _0x53d93d[_0x41504b(0x950)]() + 0x1 + '月' + _0x53d93d[_0x41504b(0x3de)]() + '日'; const _0x3c0c52 = _0x29b260[_0x41504b(0x901)][_0x41504b(0x9f6)](_0x7ffc6 => _0x7ffc6[_0x41504b(0x653)] === _0x57461c); if (_0x3c0c52['length'] === 0x0) { _0x1c16ee[_0x41504b(0x29c)] = _0x41504b(0x90a); return; } _0x3c0c52[_0x41504b(0xa3d)](_0xfba3ce => { const _0x26c577 = _0x41504b; if (_0x26c577(0xa5f) !== _0x26c577(0xa50)) { const _0x2fc73e = document[_0x26c577(0xa93)]('div'); _0x2fc73e[_0x26c577(0x8bd)] = _0xfba3ce[_0x26c577(0x713)] === _0x26c577(0x7ea) ? _0x26c577(0x53c) : 'todo-item', _0x2fc73e[_0x26c577(0x574)] = _0xfba3ce['content'], _0x2fc73e[_0x26c577(0x2f7)]['id'] = _0xfba3ce['id'], _0x1c16ee[_0x26c577(0x25f)](_0x2fc73e); } else _0x55f33f(_0x26c577(0xaf9) + _0x2c3cb3[_0x26c577(0x997)]); }); } function _0x4fcfda(_0x33f405) { const _0x2bf110 = _0x187760; document[_0x2bf110(0x759)](_0x2bf110(0x1e0))[_0x2bf110(0x574)] = '为\x20' + _0x33f405 + _0x2bf110(0x78b), document['getElementById']('event-content-input')[_0x2bf110(0xa03)] = '', document[_0x2bf110(0x759)](_0x2bf110(0xa14))[_0x2bf110(0xacb)] = !![], document[_0x2bf110(0x759)](_0x2bf110(0x1e2))['classList'][_0x2bf110(0x944)]('show'), document[_0x2bf110(0x759)](_0x2bf110(0x3ab))['focus'](); } function _0x4c0ae9() { const _0x43d99f = _0x187760, _0x5b2bac = document[_0x43d99f(0x759)]('event-content-input')[_0x43d99f(0xa03)][_0x43d99f(0x74e)](), _0x5568ca = document[_0x43d99f(0xa01)](_0x43d99f(0x88f))['value']; if (!_0x5b2bac) { _0xeba69d(_0x43d99f(0x6b8)); return; } const _0x2a469b = _0x29b260['userProfiles'][_0x43d99f(0x444)](_0x1e4ebc => _0x1e4ebc['id'] === _0x29b260['activeUserProfileId']); if (!_0x2a469b) { _0xeba69d('错误：找不到当前用户，无法保存事件。请尝试返回主屏幕再试一次。'); return; } _0x29b260[_0x43d99f(0x901)][_0x43d99f(0x438)]({ 'id': _0x43d99f(0x1e4) + Date['now'](), 'date': _0x55a867['selectedDate'], 'type': _0x5568ca, 'content': _0x5b2bac, 'userId': _0x2a469b['id'] }), _0xf10e4a(), _0x1ccad1(), _0x5d1f00(), _0x5bea2a(), document[_0x43d99f(0x759)](_0x43d99f(0x1e2))[_0x43d99f(0x969)][_0x43d99f(0x41a)](_0x43d99f(0x459)); } function _0x5d1f00() { const _0x455831 = _0x187760, _0x99249f = document[_0x455831(0x759)](_0x455831(0x336)), _0x112c7f = document[_0x455831(0x759)](_0x455831(0x2b8)), _0x453b5c = new Date(); _0x453b5c[_0x455831(0x6a5)](0x0, 0x0, 0x0, 0x0); const _0x959e97 = _0x29b260['calendarEvents'][_0x455831(0x9f6)](_0x539aa1 => _0x539aa1[_0x455831(0x713)] === _0x455831(0x7ea) && new Date(_0x539aa1[_0x455831(0x653)] + _0x455831(0xa1d)) >= _0x453b5c)[_0x455831(0x8d8)]((_0x4dbf3d, _0x5cc670) => new Date(_0x4dbf3d['date']) - new Date(_0x5cc670[_0x455831(0x653)])); if (_0x959e97['length'] > 0x0) { if (_0x455831(0x7e9) === _0x455831(0x1f0)) { if (_0x30ac91) _0x5a0fdb[_0x455831(0x7ec)](); } else { const _0x32c8e1 = _0x959e97[0x0], _0x5e1726 = new Date(_0x32c8e1[_0x455831(0x653)] + 'T00:00:00'), _0x4f157e = _0x5e1726 - _0x453b5c, _0x182b9d = Math[_0x455831(0x44e)](_0x4f157e / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x99249f[_0x455831(0x574)] = _0x455831(0x5b1) + _0x32c8e1[_0x455831(0x359)] + '」', _0x112c7f[_0x455831(0x29c)] = _0x455831(0x3dd) + _0x182b9d + _0x455831(0x5b0); } } else _0x99249f[_0x455831(0x574)] = _0x455831(0x293), _0x112c7f[_0x455831(0x29c)] = _0x455831(0x64c); } function _0x29a8f0() { const _0x34c51b = _0x187760, _0x4d2f3f = document['getElementById'](_0x34c51b(0x62a)); _0x4d2f3f['innerHTML'] = ''; if (_0x29b260['userProfiles'][_0x34c51b(0x919)] === 0x0) { _0x4d2f3f[_0x34c51b(0x29c)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>'; return; } _0x29b260[_0x34c51b(0x44f)]['forEach'](_0x4fe76c => { const _0x438dc2 = _0x34c51b; if (_0x438dc2(0x360) === _0x438dc2(0x808)) _0x60eb09[_0x438dc2(0x41a)](), _0x1bb36d(); else { const _0x28a244 = document[_0x438dc2(0xa93)](_0x438dc2(0x64e)); _0x28a244[_0x438dc2(0x8bd)] = _0x438dc2(0x7ef), _0x28a244[_0x438dc2(0x2f7)]['id'] = _0x4fe76c['id']; const _0xa5b878 = _0x4fe76c['id'] === _0x29b260['activeUserProfileId'] ? _0x438dc2(0x4c6) : ''; _0x28a244['innerHTML'] = _0x438dc2(0x1f4) + (_0x4fe76c['avatar'] || _0x2f94f8) + _0x438dc2(0x669) + _0x4fe76c['name'] + _0xa5b878 + _0x438dc2(0x78a) + _0x4fe76c[_0x438dc2(0x435)]['substring'](0x0, 0x64) + _0x438dc2(0x535), _0x28a244['addEventListener'](_0x438dc2(0x7ec), () => _0x1f1f69(_0x4fe76c['id'])), _0x4d2f3f['appendChild'](_0x28a244); } }); } function _0x1f1f69(_0xe25bf4 = null) { const _0x3354e2 = _0x187760; if (_0x3354e2(0x18f) !== _0x3354e2(0x18f)) { if (_0x4080f4['type'] === _0x3354e2(0x536)) _0x1eb301[_0x3354e2(0xac9)](); _0x1a1ebb(_0x4014b1); } else { _0x57a80a(_0x3354e2(0xa77), _0x3354e2(0x94a)); const _0x5dd53c = document[_0x3354e2(0x759)](_0x3354e2(0x32e)), _0xe077bb = document[_0x3354e2(0x759)](_0x3354e2(0x894)); _0xe077bb[_0x3354e2(0x80f)][_0x3354e2(0xad6)] = '', delete _0xe077bb[_0x3354e2(0x2f7)][_0x3354e2(0x25b)]; if (_0xe25bf4) { const _0x2f8df6 = _0x29b260[_0x3354e2(0x44f)][_0x3354e2(0x444)](_0x3fe71b => _0x3fe71b['id'] === _0xe25bf4); if (!_0x2f8df6) return; document['getElementById'](_0x3354e2(0x815))[_0x3354e2(0xa03)] = _0x2f8df6['id'], document[_0x3354e2(0x759)](_0x3354e2(0x75c))[_0x3354e2(0x574)] = '编辑用户', document[_0x3354e2(0x759)](_0x3354e2(0x4bd))['value'] = _0x2f8df6[_0x3354e2(0xb15)], _0x2f8df6['avatar'] ? _0xe077bb['style'][_0x3354e2(0xad6)] = _0x3354e2(0x22e) + _0x2f8df6[_0x3354e2(0x96f)] + '\x27)' : _0x3354e2(0x157) !== _0x3354e2(0x48e) ? _0xe077bb[_0x3354e2(0x80f)]['backgroundImage'] = 'url(\x27' + _0x2f94f8 + '\x27)' : _0x5d6cc9[_0x3354e2(0x37b)](_0x46fed4, { 'songName': _0x3380ba, 'artist': _0x532c8b, 'coverId': null, 'playableUrl': null }), document[_0x3354e2(0x759)](_0x3354e2(0x309))[_0x3354e2(0xa03)] = _0x2f8df6['persona'], _0x5dd53c[_0x3354e2(0x80f)][_0x3354e2(0x3e7)] = _0x2f8df6['id'] === _0x29b260[_0x3354e2(0x113)] ? _0x3354e2(0x697) : _0x3354e2(0x210), document[_0x3354e2(0x759)](_0x3354e2(0x9fc))[_0x3354e2(0x80f)][_0x3354e2(0x3e7)] = _0x3354e2(0x210); } else document[_0x3354e2(0x759)]('editing-user-id')[_0x3354e2(0xa03)] = '', document[_0x3354e2(0x759)](_0x3354e2(0x75c))['textContent'] = _0x3354e2(0xa8f), document[_0x3354e2(0x759)](_0x3354e2(0x4bd))[_0x3354e2(0xa03)] = _0x3354e2(0x8da) + (_0x29b260[_0x3354e2(0x44f)]['length'] + 0x1), _0xe077bb['style'][_0x3354e2(0xad6)] = _0x3354e2(0x22e) + _0x2f94f8 + '\x27)', document[_0x3354e2(0x759)](_0x3354e2(0x309))[_0x3354e2(0xa03)] = '', _0x5dd53c[_0x3354e2(0x80f)]['display'] = _0x3354e2(0x697), document[_0x3354e2(0x759)]('delete-user-profile-button')[_0x3354e2(0x80f)]['display'] = _0x3354e2(0x697); } } function _0x44caf7() { const _0x2036bf = _0x187760; if (_0x2036bf(0x5d3) !== _0x2036bf(0x964)) { const _0x420ada = document[_0x2036bf(0x759)]('editing-user-id')[_0x2036bf(0xa03)], _0x1ee137 = document['getElementById']('user-avatar-preview'), _0x517574 = { 'name': document['getElementById'](_0x2036bf(0x4bd))[_0x2036bf(0xa03)][_0x2036bf(0x74e)](), 'persona': document['getElementById'](_0x2036bf(0x309))[_0x2036bf(0xa03)][_0x2036bf(0x74e)](), 'avatar': _0x29b260[_0x2036bf(0x44f)]['find'](_0x386d37 => _0x386d37['id'] === _0x420ada)?.[_0x2036bf(0x96f)] || _0x1ee137[_0x2036bf(0x80f)][_0x2036bf(0xad6)][_0x2036bf(0x1f9)](0x5, -0x2)[_0x2036bf(0x998)](/'/g, '') || _0x2f94f8 }; _0x1ee137[_0x2036bf(0x2f7)][_0x2036bf(0x25b)] && (_0x2036bf(0x5e4) !== _0x2036bf(0x6a1) ? (_0x517574[_0x2036bf(0x96f)] = _0x1ee137[_0x2036bf(0x2f7)][_0x2036bf(0x25b)], delete _0x1ee137['dataset'][_0x2036bf(0x25b)]) : _0x271472 ? _0x1eabf9['classList'][_0x2036bf(0x944)](_0x2036bf(0x644)) : _0x573f18[_0x2036bf(0x969)][_0x2036bf(0x41a)](_0x2036bf(0x644))); if (!_0x517574['name']) { if (_0x2036bf(0x88b) !== _0x2036bf(0x88b)) { const _0x17c77c = _0x3ecbed[0x0]['trim'](), _0x55646b = _0x48ad77[0x1][_0x2036bf(0x74e)]()[_0x2036bf(0x998)](/^"|"$/g, ''); _0x491312[_0x17c77c] = _0x55646b; } else { _0xeba69d('名字不能为空！'); return; } } if (_0x420ada) { if (_0x2036bf(0xaf3) !== _0x2036bf(0xaf3)) _0x1b685d = _0x12dd7c['stringify'](_0x352872); else { const _0x405508 = _0x29b260['userProfiles'][_0x2036bf(0x444)](_0x3bdb28 => _0x3bdb28['id'] === _0x420ada); if (_0x405508) Object[_0x2036bf(0x37b)](_0x405508, _0x517574); } } else { if (_0x2036bf(0xabc) !== _0x2036bf(0x66d)) { const _0x5b116b = { 'id': _0x2036bf(0x97e) + Date[_0x2036bf(0x74c)](), ..._0x517574 }; _0x29b260['userProfiles'][_0x2036bf(0x438)](_0x5b116b); if (!_0x29b260[_0x2036bf(0x113)]) { if (_0x2036bf(0x8b9) !== _0x2036bf(0x76d)) _0x29b260[_0x2036bf(0x113)] = _0x5b116b['id']; else { _0x5cdf2f[_0x2036bf(0x958)] = [..._0x2880a2], _0x35b2a4['characterLastScripts'][_0x38caae['id']] = [..._0x260b82], _0x4c92f5(); const _0x34677f = _0x34d759['map'](_0x36b699 => _0x36b699[_0x2036bf(0x3c1)] === _0x2036bf(0x9b5) ? _0x36b699[_0x2036bf(0x81d)] : _0x36b699[_0x2036bf(0x3c1)] + ':\x20' + _0x36b699[_0x2036bf(0x81d)])[_0x2036bf(0x63b)]('\x0a\x0a'); _0x4057a5['conversationHistory'][_0x2036bf(0x438)]({ 'role': _0x2036bf(0x863), 'senderId': _0x56689a['id'], 'timestamp': _0x1a9bf5[_0x2036bf(0x74c)](), 'isOffline': !![], 'content': _0x34677f }); } } } else _0x517eb3['push']({ 'role': 'user', 'content': _0x254425 }), _0x15e18f['push']({ 'role': _0x2036bf(0x863), 'content': _0x2036bf(0x82b) }); } _0xf10e4a(), _0xeba69d('用户资料已保存！'), _0x29a8f0(), _0x57a80a('userProfileList', _0x2036bf(0xa77)); } else throw new _0x38be9f(_0x2036bf(0x9c0) + _0xeddcb6); } async function _0x160a79() { const _0x54ba0a = _0x187760, _0x3d89ce = document[_0x54ba0a(0x759)]('editing-user-id')['value']; if (!_0x3d89ce) return; if (_0x29b260['userProfiles'][_0x54ba0a(0x919)] <= 0x1) { _0xeba69d(_0x54ba0a(0x404)); return; } const _0xd72c67 = await _0x5db04d(_0x54ba0a(0xa38)); _0xd72c67 && (_0x29b260[_0x54ba0a(0x44f)] = _0x29b260[_0x54ba0a(0x44f)][_0x54ba0a(0x9f6)](_0x372871 => _0x372871['id'] !== _0x3d89ce), _0x29b260[_0x54ba0a(0x113)] === _0x3d89ce && (_0x29b260[_0x54ba0a(0x113)] = _0x29b260[_0x54ba0a(0x44f)][0x0]['id']), _0x29b260['chats'][_0x54ba0a(0xa3d)](_0x55e310 => { const _0x3bc305 = _0x54ba0a; _0x55e310['boundUserProfileId'] === _0x3d89ce && (_0x55e310[_0x3bc305(0x515)] = _0x29b260['activeUserProfileId']); }), _0xf10e4a(), _0xeba69d('用户已删除。'), _0x29a8f0(), _0x57a80a(_0x54ba0a(0x94a), _0x54ba0a(0xa77))); } function _0x13d969() { const _0x34af00 = _0x187760; if (_0x34af00(0x361) === _0x34af00(0x5ff)) _0x4329df[_0x34af00(0x5ca)](); else { const _0x21846f = document[_0x34af00(0x759)](_0x34af00(0x30a)); _0x21846f['innerHTML'] = ''; if (_0x29b260['worldBooks'][_0x34af00(0x919)] === 0x0) { if (_0x34af00(0x6dc) === _0x34af00(0x505)) { const _0x67772c = _0x4deeb1['getElementById'](_0x424031); if (_0x67772c && _0x498b72) _0x67772c[_0x34af00(0x686)] = _0x40aada[_0x34af00(0x289)](_0x36612e); } else { _0x21846f['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>'; return; } } _0x29b260[_0x34af00(0x1a1)][_0x34af00(0xa3d)](_0x396817 => { const _0x4899e9 = _0x34af00, _0xfd5db1 = document[_0x4899e9(0xa93)](_0x4899e9(0x64e)); _0xfd5db1['className'] = 'world-book-item', _0xfd5db1['dataset']['id'] = _0x396817['id'], _0xfd5db1[_0x4899e9(0x29c)] = _0x4899e9(0x649) + _0x396817[_0x4899e9(0xb15)] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x396817[_0x4899e9(0x359)]['substring'](0x0, 0x64) + _0x4899e9(0x399), _0xfd5db1[_0x4899e9(0x6cc)](_0x4899e9(0x7ec), () => _0x317b4b(_0x396817['id'])), _0x21846f[_0x4899e9(0x25f)](_0xfd5db1); }); } } function _0x317b4b(_0x58cada = null) { const _0x3aa68b = _0x187760; _0x57a80a(_0x3aa68b(0x3b9), _0x3aa68b(0x3e2)); if (_0x58cada) { const _0xbdd4 = _0x29b260['worldBooks']['find'](_0x3f97bb => _0x3f97bb['id'] === _0x58cada); if (!_0xbdd4) return; document[_0x3aa68b(0x759)](_0x3aa68b(0x128))[_0x3aa68b(0xa03)] = _0xbdd4['id'], document[_0x3aa68b(0x759)](_0x3aa68b(0x636))[_0x3aa68b(0x574)] = '编辑条目', document[_0x3aa68b(0x759)](_0x3aa68b(0x7e3))[_0x3aa68b(0xa03)] = _0xbdd4[_0x3aa68b(0xb15)], document[_0x3aa68b(0x759)]('world-book-edit-content')['value'] = _0xbdd4['content']; } else document[_0x3aa68b(0x759)](_0x3aa68b(0x128))[_0x3aa68b(0xa03)] = '', document[_0x3aa68b(0x759)](_0x3aa68b(0x636))['textContent'] = '新建条目', document[_0x3aa68b(0x759)](_0x3aa68b(0x7e3))[_0x3aa68b(0xa03)] = '', document[_0x3aa68b(0x759)](_0x3aa68b(0x31a))['value'] = ''; } function _0x372196() { const _0x14cce8 = _0x187760, _0xa13802 = document[_0x14cce8(0x759)](_0x14cce8(0x128))[_0x14cce8(0xa03)], _0x3f4bee = document['getElementById'](_0x14cce8(0x7e3))[_0x14cce8(0xa03)]['trim'](), _0x2da61e = document['getElementById'](_0x14cce8(0x31a))[_0x14cce8(0xa03)][_0x14cce8(0x74e)](); if (!_0x3f4bee || !_0x2da61e) { _0xeba69d(_0x14cce8(0x431)); return; } if (_0xa13802) { const _0x3a3bbd = _0x29b260[_0x14cce8(0x1a1)][_0x14cce8(0x444)](_0x1dadb9 => _0x1dadb9['id'] === _0xa13802); _0x3a3bbd && ('MeNRf' === _0x14cce8(0x8d7) ? _0x444c1e('升级已取消。旧版图片数据可能导致应用卡顿或出错。') : (_0x3a3bbd[_0x14cce8(0xb15)] = _0x3f4bee, _0x3a3bbd[_0x14cce8(0x359)] = _0x2da61e)); } else { if (_0x14cce8(0xaea) === _0x14cce8(0xaea)) { const _0xd1598b = { 'id': _0x14cce8(0x853) + Date[_0x14cce8(0x74c)](), 'name': _0x3f4bee, 'content': _0x2da61e }; _0x29b260[_0x14cce8(0x1a1)][_0x14cce8(0x438)](_0xd1598b); } else _0x44b09f += _0x14cce8(0x507) + _0x4bdfb5['contact_name'] + _0x14cce8(0x613) + _0x57e58e[_0x14cce8(0x589)] + _0x14cce8(0x18d), _0x1345e6[_0x14cce8(0xa05)] && _0x106a17[_0x14cce8(0xac4)](_0x2c8be9[_0x14cce8(0xa05)]) && (_0x1cb924 += '\x20\x20具体对话如下：\x0a', _0x314930[_0x14cce8(0xa05)]['forEach'](_0x5953c2 => { const _0xb2c7d8 = _0x14cce8, _0x4b1aab = _0x5953c2[_0xb2c7d8(0x41d)] === 'character' ? '你' : _0x1ad336['contact_name']; _0x507724 += _0xb2c7d8(0x429) + _0x4b1aab + ':\x20' + _0x5953c2[_0xb2c7d8(0x359)] + '\x0a'; })); } _0xf10e4a(), _0xeba69d(_0x14cce8(0x4bf)), _0x13d969(), _0x57a80a('worldBook', _0x14cce8(0x3b9)); } async function _0x16378a() { const _0x4cadd5 = _0x187760, _0x1b127e = document[_0x4cadd5(0x759)]('editing-world-book-id')[_0x4cadd5(0xa03)]; if (!_0x1b127e) return; const _0xd310af = await _0x5db04d(_0x4cadd5(0x131)); _0xd310af && (_0x29b260['worldBooks'] = _0x29b260[_0x4cadd5(0x1a1)][_0x4cadd5(0x9f6)](_0x3d6e41 => _0x3d6e41['id'] !== _0x1b127e), _0x29b260['characters'][_0x4cadd5(0xa3d)](_0x26b020 => { const _0x738626 = _0x4cadd5; _0x26b020[_0x738626(0x5c0)] && (_0x26b020[_0x738626(0x5c0)] = _0x26b020[_0x738626(0x5c0)][_0x738626(0x9f6)](_0x24dcb3 => _0x24dcb3 !== _0x1b127e)); }), _0xf10e4a(), _0xeba69d(_0x4cadd5(0xb09)), _0x13d969(), _0x57a80a(_0x4cadd5(0x3e2), _0x4cadd5(0x3b9))); } function _0x2fae61() { const _0x3e005c = _0x187760, _0x424203 = document[_0x3e005c(0x759)](_0x3e005c(0x567)), _0x71c955 = _0x424203['querySelectorAll'](_0x3e005c(0xa6b)), _0x31058a = document[_0x3e005c(0xa01)](_0x3e005c(0x203)); if (_0x71c955[_0x3e005c(0x919)] === 0x0) _0x3e005c(0x252) === 'NrCkD' ? _0x31058a['textContent'] = '--\x20点击选择\x20--' : (_0xf54683['error']('加载角色\x20' + _0x36ac16['id'] + _0x3e005c(0x6f5), _0x3a192e), _0x3e385d[_0x3e005c(0x686)] = _0x26d93f[_0x3e005c(0x96f)] || _0x287ed9); else _0x71c955[_0x3e005c(0x919)] > 0x2 ? _0x31058a[_0x3e005c(0x574)] = '已选择\x20' + _0x71c955[_0x3e005c(0x919)] + '\x20项' : _0x31058a[_0x3e005c(0x574)] = Array[_0x3e005c(0x742)](_0x71c955)[_0x3e005c(0xa96)](_0x47ab7b => _0x47ab7b[_0x3e005c(0x423)]['textContent'][_0x3e005c(0x74e)]())[_0x3e005c(0x63b)]('、'); } async function _0x573edd(_0x46816b) { const _0x20567f = _0x187760, _0x197338 = _0x29b260[_0x20567f(0x6df)][_0x20567f(0x444)](_0xb5b4f8 => _0xb5b4f8['id'] === _0x46816b); if (!_0x197338 || _0x197338[_0x20567f(0x713)] !== _0x20567f(0x867)) return; document[_0x20567f(0x759)](_0x20567f(0x562))[_0x20567f(0xa03)] = _0x197338[_0x20567f(0xb15)] || '', _0x4790b6('group-settings-bind-user'), document['getElementById'](_0x20567f(0x9f8))[_0x20567f(0xa03)] = _0x197338[_0x20567f(0x515)] || _0x29b260[_0x20567f(0x113)]; const _0x15f5d6 = document[_0x20567f(0x759)](_0x20567f(0x4ea)); _0x15f5d6[_0x20567f(0x29c)] = '', _0x29b260[_0x20567f(0x1a1)][_0x20567f(0xa3d)](_0x356149 => { const _0x161dbb = _0x20567f, _0x1628f1 = _0x197338[_0x161dbb(0x5c0)]?.[_0x161dbb(0x4da)](_0x356149['id']), _0x3a6dee = document[_0x161dbb(0xa93)](_0x161dbb(0x339)); _0x3a6dee[_0x161dbb(0x29c)] = _0x161dbb(0x1cc) + _0x356149['id'] + '\x22\x20' + (_0x1628f1 ? 'checked' : '') + '>\x20' + _0x356149[_0x161dbb(0xb15)], _0x15f5d6[_0x161dbb(0x25f)](_0x3a6dee); }), _0x2d0f87(); const _0x59a0d8 = document[_0x20567f(0x759)]('group-avatar-preview'), _0x104500 = document['getElementById']('group-bg-preview'); _0x104500['style'][_0x20567f(0xad6)] = '', _0x2e6c7a(_0x20567f(0x656) + _0x46816b)['then'](_0x1a5c44 => { const _0x3af7bc = _0x20567f; if (_0x3af7bc(0xa34) !== _0x3af7bc(0xa34)) { const _0x4af078 = _0x5b4de0[_0x3af7bc(0x77e)](/:\s(.+)/); if (_0x4af078[_0x3af7bc(0x919)] > 0x1) { const _0x1e2da8 = _0x4af078[0x0]['trim'](), _0x2e6f5e = _0x4af078[0x1][_0x3af7bc(0x74e)]()[_0x3af7bc(0x998)](/^"|"$/g, ''); _0x144b05[_0x1e2da8] = _0x2e6f5e; } } else _0x59a0d8[_0x3af7bc(0x686)] = _0x1a5c44 ? URL['createObjectURL'](_0x1a5c44) : _0x461596; }), _0x2e6c7a(_0x20567f(0x5dd) + _0x46816b)['then'](_0x2d1796 => { const _0x11461b = _0x20567f; if (_0x11461b(0xaaf) !== _0x11461b(0xaaf)) { const _0x56b560 = _0x207350[_0x11461b(0xa93)](_0x11461b(0x64e)); _0x56b560['className'] = _0x11461b(0x795); const _0x20ef3d = _0x18e74a + '-' + _0x200b84(_0x4ca192 + 0x1)[_0x11461b(0x27e)](0x2, '0') + '-' + _0x246a80(_0x26ebc6)[_0x11461b(0x27e)](0x2, '0'); if (_0x20ef3d === _0x1560c7) _0x56b560['classList']['add'](_0x11461b(0x4d7)); if (_0x20ef3d === _0x16c619['selectedDate']) _0x56b560['classList']['add']('is-selected'); const _0x39294b = _0x5ba394[_0x11461b(0xa93)](_0x11461b(0x9f0)); _0x39294b['className'] = 'day-number', _0x39294b[_0x11461b(0x574)] = _0x52ad31, _0x56b560['appendChild'](_0x39294b); const _0x1c089b = _0x3233d8['calendarEvents'][_0x11461b(0x9f6)](_0x208ace => _0x208ace[_0x11461b(0x653)] === _0x20ef3d); if (_0x1c089b['length'] > 0x0) { const _0x4102a8 = _0x664d91[_0x11461b(0xa93)]('div'); _0x4102a8[_0x11461b(0x8bd)] = _0x11461b(0x95a), _0x56b560[_0x11461b(0x25f)](_0x4102a8); } _0x56b560['addEventListener'](_0x11461b(0x7ec), () => { const _0x5a8bcb = _0x11461b; _0x24c1f8[_0x5a8bcb(0x29f)] = _0x20ef3d, _0x797588(); }), _0x36036e['appendChild'](_0x56b560); } else { if (_0x2d1796) _0x104500[_0x11461b(0x80f)][_0x11461b(0xad6)] = _0x11461b(0x22e) + URL[_0x11461b(0x289)](_0x2d1796) + '\x27)'; } }), _0x57a80a(_0x20567f(0x7c2), 'chat'); } async function _0x108bd7() { const _0x1ef2c5 = _0x187760; if (_0x1ef2c5(0x8d0) === _0x1ef2c5(0x8d0)) { const _0x31ef56 = _0xa7e551(); if (!_0x31ef56 || _0x31ef56[_0x1ef2c5(0x713)] !== _0x1ef2c5(0x867)) return; const _0x1a121f = document[_0x1ef2c5(0x759)](_0x1ef2c5(0x562))['value'][_0x1ef2c5(0x74e)](); if (!_0x1a121f) { _0xeba69d('群聊名称不能为空！'); return; } _0x31ef56[_0x1ef2c5(0xb15)] = _0x1a121f; const _0x53df3a = document['querySelectorAll'](_0x1ef2c5(0x531)); _0x31ef56[_0x1ef2c5(0x5c0)] = Array[_0x1ef2c5(0x742)](_0x53df3a)[_0x1ef2c5(0xa96)](_0x5c63f8 => _0x5c63f8[_0x1ef2c5(0xa03)]), _0x31ef56[_0x1ef2c5(0x515)] = document[_0x1ef2c5(0x759)](_0x1ef2c5(0x9f8))[_0x1ef2c5(0xa03)]; const _0x8ca2f5 = document[_0x1ef2c5(0x759)](_0x1ef2c5(0x403))['files'][0x0], _0x13b521 = document[_0x1ef2c5(0x759)](_0x1ef2c5(0x774))[_0x1ef2c5(0x523)][0x0]; if (_0x8ca2f5) await _0x5b0aee(_0x1ef2c5(0x656) + _0x31ef56['id'], _0x8ca2f5); if (_0x13b521) await _0x5b0aee(_0x1ef2c5(0x5dd) + _0x31ef56['id'], _0x13b521); _0xf10e4a(), _0xba948e(), await _0x25cb93(), _0xeba69d(_0x1ef2c5(0x4e1)), _0x57a80a(_0x1ef2c5(0x6b7), _0x1ef2c5(0x7c2)); } else { const _0x4dc289 = _0x279fa7[_0x1ef2c5(0x861)][_0x1ef2c5(0xa96)](_0x5b741e => _0x4096ca(_0x5b741e)?.[_0x1ef2c5(0xb15)] || '未知')[_0x1ef2c5(0x63b)]('、'), _0x474515 = _0x1ef2c5(0x86a); _0x1869fc = '<div\x20class=\x22post-likes\x22>' + _0x474515 + '\x20' + _0x4dc289 + '</div>'; } } function _0x2d0f87() { const _0x5d4a46 = _0x187760; if (_0x5d4a46(0xa22) === _0x5d4a46(0x68e)) _0x5ef6ff(), _0x302894(_0x5d4a46(0x8fe), _0x5d4a46(0x83c)); else { const _0x115fc1 = document['getElementById'](_0x5d4a46(0x4ea)), _0x34dfda = _0x115fc1[_0x5d4a46(0xae0)](_0x5d4a46(0xa6b)), _0x13507f = document[_0x5d4a46(0xa01)](_0x5d4a46(0x2d5)); if (_0x34dfda['length'] === 0x0) _0x13507f[_0x5d4a46(0x574)] = _0x5d4a46(0x353); else { if (_0x34dfda[_0x5d4a46(0x919)] > 0x2) { if (_0x5d4a46(0x3f6) !== _0x5d4a46(0x3f6)) { let _0x18de26 = 0x0, _0x1f13e2 = 0x0, _0x454f12 = 0x0; if (_0x4e465d[_0x5d4a46(0x919)] == 0x4) _0x18de26 = '0x' + _0x4624f7[0x1] + _0x2cae01[0x1], _0x1f13e2 = '0x' + _0x3c7fd9[0x2] + _0x2edb06[0x2], _0x454f12 = '0x' + _0x79a9a0[0x3] + _0x3022ca[0x3]; else _0x1167f6['length'] == 0x7 && (_0x18de26 = '0x' + _0x335738[0x1] + _0x422e28[0x2], _0x1f13e2 = '0x' + _0x177d71[0x3] + _0x38ebaf[0x4], _0x454f12 = '0x' + _0x4c68b7[0x5] + _0x244e8e[0x6]); _0x18de26 /= 0xff, _0x1f13e2 /= 0xff, _0x454f12 /= 0xff; let _0x530e7a = _0x360ea5[_0x5d4a46(0x244)](_0x18de26, _0x1f13e2, _0x454f12), _0x5c83e9 = _0x406b7d[_0x5d4a46(0x355)](_0x18de26, _0x1f13e2, _0x454f12), _0x2dfe27 = _0x5c83e9 - _0x530e7a, _0x957aad = 0x0, _0x47ac24 = 0x0, _0x5ce6d5 = 0x0; if (_0x2dfe27 == 0x0) _0x957aad = 0x0; else { if (_0x5c83e9 == _0x18de26) _0x957aad = (_0x1f13e2 - _0x454f12) / _0x2dfe27 % 0x6; else { if (_0x5c83e9 == _0x1f13e2) _0x957aad = (_0x454f12 - _0x18de26) / _0x2dfe27 + 0x2; else _0x957aad = (_0x18de26 - _0x1f13e2) / _0x2dfe27 + 0x4; } } _0x957aad = _0x14e406[_0x5d4a46(0x6f8)](_0x957aad * 0x3c); if (_0x957aad < 0x0) _0x957aad += 0x168; return _0x5ce6d5 = (_0x5c83e9 + _0x530e7a) / 0x2, _0x47ac24 = _0x2dfe27 == 0x0 ? 0x0 : _0x2dfe27 / (0x1 - _0x339bc4['abs'](0x2 * _0x5ce6d5 - 0x1)), _0x47ac24 = +(_0x47ac24 * 0x64)[_0x5d4a46(0x394)](0x1), _0x5ce6d5 = +(_0x5ce6d5 * 0x64)['toFixed'](0x1), { 'h': _0x957aad, 's': _0x47ac24, 'l': _0x5ce6d5 }; } else _0x13507f[_0x5d4a46(0x574)] = _0x5d4a46(0x8f4) + _0x34dfda['length'] + '\x20项'; } else { if (_0x5d4a46(0x709) !== _0x5d4a46(0x709)) return new _0x2bf6ec((_0x545b53, _0x25d905) => { const _0x30268e = _0x5d4a46, _0x443eb3 = new _0x110a50(); _0x443eb3[_0x30268e(0x890)] = () => _0x545b53(_0x443eb3[_0x30268e(0x563)]), _0x443eb3[_0x30268e(0x634)] = _0x25d905, _0x443eb3[_0x30268e(0x855)](_0x5d75ee); }); else _0x13507f['textContent'] = Array[_0x5d4a46(0x742)](_0x34dfda)['map'](_0x390b0b => _0x390b0b[_0x5d4a46(0x423)]['textContent'][_0x5d4a46(0x74e)]())[_0x5d4a46(0x63b)]('、'); } } } } async function _0x1bfe32() { const _0x451db9 = _0x187760, _0x2f77cc = _0xa7e551(), _0x58ee63 = (_0x2f77cc?.[_0x451db9(0x9be)] || [])['map'](_0x4cc875)[_0x451db9(0x9f6)](Boolean), _0x29cdfd = _0x33ec75(_0x2f77cc['id']); if (!_0x2f77cc || _0x2f77cc['type'] !== _0x451db9(0x867) || _0x58ee63[_0x451db9(0x919)] < 0x2) return null; const _0x58613a = _0x2f77cc[_0x451db9(0x5c0)] && _0x2f77cc[_0x451db9(0x5c0)][_0x451db9(0x919)] > 0x0 ? '\x0a\x0a#\x20核心群聊世界观设定\x20(所有角色必须严格遵守以下设定)\x0a' + _0x2f77cc[_0x451db9(0x5c0)]['map'](_0x1ba46b => _0x29b260[_0x451db9(0x1a1)][_0x451db9(0x444)](_0x2a1cf9 => _0x2a1cf9['id'] === _0x1ba46b))[_0x451db9(0x9f6)](Boolean)[_0x451db9(0xa96)](_0x585faa => _0x451db9(0x6c9) + _0x585faa[_0x451db9(0xb15)] + '\x0a' + _0x585faa[_0x451db9(0x359)])[_0x451db9(0x63b)]('') : '', _0x41e775 = _0x29cdfd[_0x451db9(0x435)] ? _0x451db9(0x538) + _0x29cdfd[_0x451db9(0xb15)] + _0x451db9(0x282) + _0x29cdfd[_0x451db9(0x435)] : ''; let _0xe01b2e = ''; const _0x5b43b7 = new Date(), _0x1c0b26 = _0x29b260[_0x451db9(0xa85)]['at'](-0x1); _0xe01b2e += _0x451db9(0xb1a) + _0x5b43b7[_0x451db9(0x22a)](_0x451db9(0x513), { 'dateStyle': _0x451db9(0x728), 'timeStyle': _0x451db9(0x704) }); if (_0x1c0b26) { const _0x526e34 = new Date(_0x1c0b26[_0x451db9(0x6de)]), _0xb46d69 = Math[_0x451db9(0xa54)]((_0x5b43b7 - _0x526e34) / (0x3e8 * 0x3c)); if (_0xb46d69 < 0x5) _0xe01b2e += '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。'; else { if (_0xb46d69 < 0x78) _0xe01b2e += _0x451db9(0x9ae) + _0xb46d69 + _0x451db9(0x320); else { if (_0x451db9(0x7fb) !== _0x451db9(0xa0d)) { const _0x470886 = Math[_0x451db9(0xa54)](_0xb46d69 / 0x3c); if (_0x470886 < 0x30) _0xe01b2e += _0x451db9(0x9ae) + _0x470886 + _0x451db9(0x412); else _0xe01b2e += _0x451db9(0x35e) + Math[_0x451db9(0xa54)](_0x470886 / 0x18) + _0x451db9(0x91c); } else _0x41318c[_0x451db9(0x479)](), _0x514907['classList'][_0x451db9(0x378)](_0x451db9(0x508)), _0x58f426['classList'][_0x451db9(0x378)](_0x451db9(0x58b)); } } } else _0xe01b2e += _0x451db9(0x46e); const _0x43d04a = [..._0x29b260[_0x451db9(0xa85)]][_0x451db9(0x2c1)]()['find'](_0x19012c => _0x19012c[_0x451db9(0x456)] === 'user')?.[_0x451db9(0x359)] || '', _0xbc0416 = _0x3a8a92(_0x2f77cc, _0x43d04a), _0x41dddc = _0x29b260[_0x451db9(0xa85)]['slice'](-0x78), _0x49630d = _0x53fca2['map'](_0x3e9de4 => _0x3e9de4[_0x451db9(0xb15)]), _0x205444 = _0x51a4ba(), _0xfa9a51 = _0x58ee63[_0x451db9(0xa96)](_0x442c76 => { const _0x15adb5 = _0x451db9, { omniText: _0x349005 } = _0x2eac37(_0x442c76['id'], _0x2f77cc['id']), _0xad6c3d = _0x4312af(_0x442c76['id']), _0x38f304 = _0x442c76[_0x15adb5(0x5c0)] && _0x442c76[_0x15adb5(0x5c0)][_0x15adb5(0x919)] > 0x0 ? '\x0a\x0a#\x20' + _0x442c76['name'] + '的个人专属世界观设定\x0a' + _0x442c76[_0x15adb5(0x5c0)][_0x15adb5(0xa96)](_0x38e265 => _0x29b260['worldBooks'][_0x15adb5(0x444)](_0x304cb5 => _0x304cb5['id'] === _0x38e265))['filter'](Boolean)[_0x15adb5(0xa96)](_0x23d54a => '\x0a##\x20条目:\x20' + _0x23d54a['name'] + '\x0a' + _0x23d54a[_0x15adb5(0x359)])[_0x15adb5(0x63b)]('') : ''; let _0x1f6fdf = _0x15adb5(0x717) + _0x442c76[_0x15adb5(0xb15)] + ')\x20的专属时间锚点\x0a'; const _0x4cae19 = _0x18e032(_0x442c76['id']), _0x184794 = new Date(); if (_0x4cae19) { const _0x351d9f = new Date(_0x4cae19[_0x15adb5(0x6de)]); _0x1f6fdf += _0x15adb5(0x2fc) + _0x29cdfd[_0x15adb5(0xb15)] + _0x15adb5(0x2ae) + _0x236f37(_0x351d9f) + '\x0a'; const _0x38a4ff = _0x184794[_0x15adb5(0x9a6)]() === _0x351d9f['toDateString'](), _0x127b3d = new Date(); _0x127b3d[_0x15adb5(0x1ad)](_0x184794[_0x15adb5(0x3de)]() - 0x1); const _0x57f4eb = _0x127b3d[_0x15adb5(0x9a6)]() === _0x351d9f[_0x15adb5(0x9a6)](); if (_0x38a4ff) { if (_0x15adb5(0x21a) !== _0x15adb5(0xa5c)) _0x1f6fdf += '-\x20**状态提示**:\x20你们今天刚聊过，请自然地衔接对话。\x0a'; else { const _0x506b28 = _0x2e48ce['comments']['map'](_0x499da6 => { const _0x160eba = _0x15adb5, _0x2ed7a6 = _0x418513(_0x499da6[_0x160eba(0xb04)])?.[_0x160eba(0xb15)] || '未知'; return _0x160eba(0x696) + _0x2ed7a6 + _0x160eba(0x2eb) + _0x499da6['content'] + _0x160eba(0x892); })[_0x15adb5(0x63b)](''); _0x26101d = _0x15adb5(0x729) + _0x506b28 + _0x15adb5(0x892); } } else _0x57f4eb ? _0x1f6fdf += _0x15adb5(0x141) : _0x1f6fdf += _0x15adb5(0x959); } else _0x1f6fdf += _0x15adb5(0x97f) + _0x29cdfd[_0x15adb5(0xb15)] + _0x15adb5(0x546); return { 'id': _0x442c76['id'], 'name': _0x442c76[_0x15adb5(0xb15)], 'persona': _0x442c76[_0x15adb5(0x435)] || _0x15adb5(0xa79), 'memory': _0x349005 + _0xad6c3d + _0x38f304 + _0x1f6fdf }; }), _0x250bfe = 0x5, _0x42e390 = 0xc, _0x25fc46 = _0x451db9(0x5a0)[_0x451db9(0x74e)](), _0x4ce1af = { 'instruction': (_0x451db9(0x6b0) + (_0x29cdfd[_0x451db9(0xb15)] || '用户') + '”的群聊规划角色们的下一步发言。\x0a-\x20与你们对话的人类用户名为“' + (_0x29cdfd[_0x451db9(0xb15)] || '用户') + '”。在分析历史记录时，请记住这一点，并用此名称指代用户。\x0a-\x20【最重要】为\x20`personas`\x20列表中的【每一位】角色都规划至少一个事件(通常不少于2个)。不能遗漏任何角色。\x0a-\x20【新增规则】你可以规划\x20\x22kind\x22:\x20\x22music\x22\x20事件来分享音乐。此时，你【必须】同时提供\x20\x22songName\x22\x20和\x20\x22artist\x22\x20字段。\x0a-\x20你的首要任务是产出一个严格遵守SCHEMA、语法完全正确的、可被解析的JSON对象。\x0a-\x20若用户\x20`@`\x20了某个角色\x20(见\x20`mentioned`)，该角色应优先发言。\x0a-\x20事件总数必须控制在\x20' + _0x250bfe + _0x451db9(0x7a3) + _0x42e390 + _0x451db9(0x67c) + (_0x29cdfd['name'] || '用户') + _0x451db9(0x4ff) + _0xe01b2e + '\x20\x0a' + _0x41e775 + '\x0a' + _0x58613a + _0x451db9(0x436) + _0x205444 + '\x0a')[_0x451db9(0x74e)](), 'personas': _0xfa9a51, 'mentioned': _0xbc0416 ? { 'id': _0xbc0416['id'], 'name': _0xbc0416['name'] } : null, 'stickerList': _0x49630d }, _0x373ec2 = { 'type': _0x451db9(0x3fb), 'properties': { 'events': { 'type': 'array', 'items': { 'type': _0x451db9(0x3fb), 'required': [_0x451db9(0x616), _0x451db9(0x7a6)], 'properties': { 'senderId': { 'type': 'string' }, 'kind': { 'type': 'string', 'enum': [_0x451db9(0x807), _0x451db9(0x3b5), _0x451db9(0xa7c)] }, 'content': { 'type': _0x451db9(0x96c) }, 'sticker': { 'type': _0x451db9(0x96c) }, 'songName': { 'type': _0x451db9(0x96c) }, 'artist': { 'type': _0x451db9(0x96c) } } } } }, 'required': [_0x451db9(0x17b)] }, _0x2f72fe = []; _0x2f72fe[_0x451db9(0x438)]({ 'role': _0x451db9(0x4c2), 'content': _0x25fc46 }); for (const _0x3784ea of _0x41dddc) { if (_0x451db9(0x7f8) !== _0x451db9(0x7f8)) _0x20b3a6(), _0x31d5fc[_0x451db9(0x7ec)](); else { const _0x185855 = _0x3784ea[_0x451db9(0x456)] === 'ai' || _0x3784ea[_0x451db9(0x456)] === 'assistant' ? _0x451db9(0x863) : 'user'; let _0x3389ce = { 'role': _0x185855, 'content': _0x3784ea['content'] }, _0x277855 = !!_0x3784ea[_0x451db9(0x359)], _0x815ccc = null; if (_0x3784ea[_0x451db9(0x7ee)]) { if (_0x451db9(0x747) === _0x451db9(0x55a)) { let _0x381dd5 = null; const _0x105674 = _0x5c9323[_0x451db9(0x6df)]['filter'](_0x3220a7 => _0x3220a7[_0x451db9(0x9be)][_0x451db9(0x4da)](_0x4e8ce9)); for (const _0x29ab7f of _0x105674) { const _0x113179 = _0xafce9(_0x29ab7f['id']); if (_0x113179 && _0x113179[_0x451db9(0x919)] > 0x0) { const _0x7b15e9 = _0x113179[_0x113179[_0x451db9(0x919)] - 0x1]; (!_0x381dd5 || _0x7b15e9[_0x451db9(0x6de)] > _0x381dd5['timestamp']) && (_0x381dd5 = _0x7b15e9); } } return _0x381dd5; } else _0x815ccc = _0x3784ea[_0x451db9(0x7ee)]; } else { if (_0x3784ea['imageId']) { if (_0x451db9(0x9c2) !== _0x451db9(0x65f)) try { const _0xead789 = await _0x2e6c7a(_0x3784ea['imageId']); _0xead789 && (_0x815ccc = await _0x13346a(_0xead789)); } catch (_0x9aa4bf) { console[_0x451db9(0x297)](_0x451db9(0x849), _0x9aa4bf); } else _0x5fd304 = _0x451db9(0x878) + _0x490402['avatar'] + _0x451db9(0x457) + _0x41ca6e['name'] + _0x451db9(0x6bd) + _0x2d12e8[_0x451db9(0x5d0)][_0x451db9(0x807)] + _0x451db9(0x8be); } } if (_0x815ccc) { if (_0x451db9(0x434) !== _0x451db9(0xb12)) _0x3389ce[_0x451db9(0x7ee)] = _0x815ccc, _0x277855 = !![]; else { const _0x11853f = _0x227613[_0x451db9(0xae0)]('p'); _0x11853f['forEach'](_0x2778c6 => _0x2778c6[_0x451db9(0x969)][_0x451db9(0x41a)](_0x451db9(0x691))); const _0x4f13c0 = _0x4c363a[_0x451db9(0x759)](_0x451db9(0x887) + _0x4b0aa8); _0x4f13c0 && (_0x4f13c0[_0x451db9(0x969)][_0x451db9(0x944)](_0x451db9(0x691)), _0x4f13c0['scrollIntoView']({ 'behavior': _0x451db9(0x9da), 'block': _0x451db9(0x37e) })); } } if (_0x277855) { if (_0x451db9(0xa29) === _0x451db9(0x502)) { const _0x103eba = _0x140d50(_0x5e112a[0x1], 0xa), _0x15246b = _0x3c1b80(_0x4fde69[0x2], 0xa), _0x109439 = _0xaadbb0(_0xc1c9ef[0x3], 0xa) * (_0x396151[0x3][_0x451db9(0x919)] === 0x2 ? 0xa : 0x1), _0x3a54ef = _0x103eba * 0x3c + _0x15246b + _0x109439 / 0x3e8, _0x1d242f = _0x5b948f[_0x451db9(0x998)](_0x2923fe, '')['trim'](); _0x1d242f && _0x495b0e[_0x451db9(0x438)]({ 'time': _0x3a54ef, 'text': _0x1d242f }); } else _0x2f72fe[_0x451db9(0x438)](_0x3389ce); } } } _0x2f72fe[_0x451db9(0x438)]({ 'role': _0x451db9(0x544), 'content': _0x451db9(0xa7b) + JSON[_0x451db9(0x2a5)](_0x373ec2) + _0x451db9(0xaf5) + JSON[_0x451db9(0x2a5)](_0x4ce1af) }); try { if (_0x451db9(0x2f1) === _0x451db9(0x979)) _0x26113c[_0x451db9(0x80f)][_0x451db9(0x3e7)] = 'inline-block'; else { const _0x594165 = await _0x315051(_0x2f72fe, { 'json': !![] }); if (!_0x594165) return null; let _0x26c291 = _0x594165[_0x451db9(0x74e)](); const _0xe8d93d = _0x26c291[_0x451db9(0x6d2)](/```json([\s\S]*?)```/i); if (_0xe8d93d) _0x26c291 = _0xe8d93d[0x1][_0x451db9(0x74e)](); _0x26c291 = _0x2238bf(_0x26c291); let _0x2009da = null; try { _0x2009da = JSON['parse'](_0x26c291); } catch (_0x441211) { console[_0x451db9(0x297)]('JSON\x20解析失败!\x20错误原因:', _0x441211), console[_0x451db9(0x297)](_0x451db9(0x44a), _0x26c291); } if (!_0x2009da || !Array[_0x451db9(0xac4)](_0x2009da[_0x451db9(0x17b)])) return null; return _0x2009da = _0x211b6e(_0x2009da, _0x58ee63, _0x49630d), _0x2009da[_0x451db9(0x17b)] = _0x2009da[_0x451db9(0x17b)]['slice'](0x0, _0x42e390), _0x2009da['events'][_0x451db9(0x919)] ? _0x2009da : null; } } catch (_0x2b5b37) { if ('xEZud' !== _0x451db9(0x35c)) { const _0x4c8913 = _0x248dea[_0x451db9(0x759)](_0x451db9(0x336)), _0x79bf3d = _0x210a07[_0x451db9(0x759)](_0x451db9(0x2b8)), _0x5a35b8 = new _0x35b68d(); _0x5a35b8['setHours'](0x0, 0x0, 0x0, 0x0); const _0x5c7c22 = _0x5f1b79[_0x451db9(0x901)][_0x451db9(0x9f6)](_0x2858e6 => _0x2858e6['type'] === 'important' && new _0x4a8fea(_0x2858e6[_0x451db9(0x653)] + _0x451db9(0xa1d)) >= _0x5a35b8)[_0x451db9(0x8d8)]((_0x3a5ae8, _0x26908d) => new _0x1c2856(_0x3a5ae8[_0x451db9(0x653)]) - new _0x30ab5c(_0x26908d[_0x451db9(0x653)])); if (_0x5c7c22[_0x451db9(0x919)] > 0x0) { const _0x3bfb7c = _0x5c7c22[0x0], _0x3d64d1 = new _0x3e4bb8(_0x3bfb7c[_0x451db9(0x653)] + 'T00:00:00'), _0xdee94f = _0x3d64d1 - _0x5a35b8, _0x8cbf6c = _0x4d5327['ceil'](_0xdee94f / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x4c8913[_0x451db9(0x574)] = _0x451db9(0x5b1) + _0x3bfb7c['content'] + '」', _0x79bf3d[_0x451db9(0x29c)] = _0x451db9(0x3dd) + _0x8cbf6c + _0x451db9(0x5b0); } else _0x4c8913[_0x451db9(0x574)] = '近期没有特别安排', _0x79bf3d['innerHTML'] = '<span>--</span><span\x20class=\x22unit\x22>天</span>'; } else return _0x2b5b37[_0x451db9(0xb15)] !== 'AbortError' && console[_0x451db9(0x297)](_0x451db9(0x1e6), _0x2b5b37), null; } } function _0x370a18() { const _0x27f290 = _0x187760, _0x535a4a = document[_0x27f290(0x759)](_0x27f290(0x1fe)); _0x535a4a[_0x27f290(0x29c)] = ''; if (_0x29b260[_0x27f290(0x123)][_0x27f290(0x919)] === 0x0) { _0x535a4a[_0x27f290(0x29c)] = _0x27f290(0x2a3); return; } _0x29b260[_0x27f290(0x123)][_0x27f290(0xa3d)](_0x491898 => { const _0x306fea = _0x27f290, _0x338261 = _0x29b260['userProfiles'][_0x306fea(0x444)](_0x230685 => _0x230685['id'] === _0x491898['boundUserProfileId']) || { 'name': _0x306fea(0x12a) }, _0x30b9ed = document[_0x306fea(0xa93)](_0x306fea(0x64e)); _0x30b9ed[_0x306fea(0x8bd)] = 'world-book-item', _0x30b9ed[_0x306fea(0x2f7)]['id'] = _0x491898['id'], _0x30b9ed['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0x491898[_0x306fea(0xb15)] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20' + _0x338261[_0x306fea(0xb15)] + _0x306fea(0x481) + _0x491898[_0x306fea(0x9a8)][_0x306fea(0x919)] + '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', _0x30b9ed[_0x306fea(0x6cc)](_0x306fea(0x7ec), () => _0x153773(_0x491898['id'])), _0x535a4a[_0x306fea(0x25f)](_0x30b9ed); }); } function _0x2a1eab(_0x3d2278 = null) { const _0x4183ed = _0x187760, _0x2445d7 = document[_0x4183ed(0x759)](_0x4183ed(0x917)), _0x37c09e = document[_0x4183ed(0x759)]('friend-circle-edit-bind-user'), _0x5be435 = document[_0x4183ed(0x759)](_0x4183ed(0x6d9)), _0x2aea53 = document[_0x4183ed(0x759)]('friend-circle-edit-title'), _0xf6aa25 = document[_0x4183ed(0x759)](_0x4183ed(0xa13)), _0x5348bc = document[_0x4183ed(0x759)]('delete-friend-circle-button'); _0x4790b6(_0x4183ed(0x213)), _0x5be435[_0x4183ed(0x29c)] = '', _0x29b260['characters']['forEach'](_0x85eb7d => { const _0x3e04f6 = _0x4183ed; if ('ABRLS' !== _0x3e04f6(0x6a4)) { const _0x464df2 = _0x476df4[_0x3e04f6(0x41d)] === _0x3e04f6(0x565), _0xc78db9 = _0x464df2 ? _0x2ae954 ? _0x1e2b86[0x0] : '?' : _0x213cb4 ? _0x1de31d[0x0] : '?'; _0x386dc5 += _0x3e04f6(0xa12) + (_0x464df2 ? _0x3e04f6(0x544) : 'ai') + _0x3e04f6(0x829) + (!_0x464df2 ? _0x3e04f6(0x6d5) + _0xc78db9 + _0x3e04f6(0x892) : '') + _0x3e04f6(0x85a) + (_0x464df2 ? _0x3e04f6(0x544) : 'ai') + _0x3e04f6(0x2cc) + _0xc71086[_0x3e04f6(0x359)] + _0x3e04f6(0xb02) + (_0x464df2 ? _0x3e04f6(0x6d5) + _0xc78db9 + _0x3e04f6(0x892) : '') + _0x3e04f6(0xa07); } else { const _0x5b2087 = document[_0x3e04f6(0xa93)](_0x3e04f6(0x64e)); _0x5b2087[_0x3e04f6(0x8bd)] = _0x3e04f6(0x98f), _0x5b2087['innerHTML'] = _0x3e04f6(0x1c3) + _0x85eb7d['id'] + _0x3e04f6(0x6bc) + _0x85eb7d['id'] + _0x3e04f6(0xab7) + (_0x85eb7d['avatar'] || _0x461596) + _0x3e04f6(0x84d) + _0x85eb7d['id'] + _0x3e04f6(0x8c1) + _0x85eb7d[_0x3e04f6(0xb15)] + _0x3e04f6(0x93d), _0x5be435[_0x3e04f6(0x25f)](_0x5b2087); } }); if (_0x3d2278) { const _0x2e7a49 = _0x29b260[_0x4183ed(0x123)][_0x4183ed(0x444)](_0x29fc65 => _0x29fc65['id'] === _0x3d2278); if (!_0x2e7a49) return; _0x2aea53[_0x4183ed(0x574)] = '编辑好友圈', _0xf6aa25['value'] = _0x2e7a49['id'], _0x2445d7['value'] = _0x2e7a49[_0x4183ed(0xb15)], _0x37c09e[_0x4183ed(0xa03)] = _0x2e7a49[_0x4183ed(0x515)], _0x5348bc[_0x4183ed(0x80f)][_0x4183ed(0x3e7)] = _0x4183ed(0x210), _0x2e7a49[_0x4183ed(0x9a8)]['forEach'](_0x47e441 => { const _0x2bfc17 = _0x4183ed; if (_0x2bfc17(0x89e) === _0x2bfc17(0x89e)) { const _0x1b7287 = _0x5be435[_0x2bfc17(0xa01)](_0x2bfc17(0x172) + _0x47e441); if (_0x1b7287) _0x1b7287['checked'] = !![]; } else { _0x32aa2a(_0x2bfc17(0x504)); return; } }); } else _0x4183ed(0x18a) !== _0x4183ed(0x18a) ? _0xdceada[_0x4183ed(0xa05)]('缓存命中:\x20' + _0x22f1b4) : (_0x2aea53[_0x4183ed(0x574)] = _0x4183ed(0x6c5), _0xf6aa25[_0x4183ed(0xa03)] = '', _0x2445d7[_0x4183ed(0xa03)] = _0x4183ed(0x193) + (_0x29b260[_0x4183ed(0x123)][_0x4183ed(0x919)] + 0x1), _0x37c09e[_0x4183ed(0xa03)] = _0x29b260[_0x4183ed(0x113)], _0x5348bc[_0x4183ed(0x80f)][_0x4183ed(0x3e7)] = 'none'); _0x57a80a(_0x4183ed(0x7a4), _0x4183ed(0x8c7)); } function _0x351243() { const _0x5c45a8 = _0x187760, _0x19a6cd = document['getElementById'](_0x5c45a8(0xa13))[_0x5c45a8(0xa03)], _0x9033a8 = document['getElementById'](_0x5c45a8(0x917))['value'][_0x5c45a8(0x74e)](), _0x153149 = document[_0x5c45a8(0x759)]('friend-circle-edit-bind-user')['value'], _0x5e688c = Array[_0x5c45a8(0x742)](document[_0x5c45a8(0xae0)](_0x5c45a8(0x263)))[_0x5c45a8(0xa96)](_0x20dd73 => _0x20dd73['dataset']['id']); if (!_0x9033a8) { _0xeba69d('好友圈名称不能为空！'); return; } if (_0x5e688c['length'] === 0x0) { _0xeba69d(_0x5c45a8(0x6c0)); return; } if (_0x19a6cd) { const _0x3146d9 = _0x29b260[_0x5c45a8(0x123)]['find'](_0x4097bf => _0x4097bf['id'] === _0x19a6cd); _0x3146d9 && ('sSSTi' === _0x5c45a8(0x331) ? (_0x3146d9[_0x5c45a8(0xb15)] = _0x9033a8, _0x3146d9[_0x5c45a8(0x515)] = _0x153149, _0x3146d9[_0x5c45a8(0x9a8)] = _0x5e688c) : (_0x59e0fb = _0x5c45a8(0x2e9), _0x621bb1 = _0x5c45a8(0xa86))); } else { const _0x64884f = { 'id': _0x5c45a8(0x286) + Date[_0x5c45a8(0x74c)](), 'name': _0x9033a8, 'boundUserProfileId': _0x153149, 'memberCharacterIds': _0x5e688c, 'posts': [] }; _0x29b260[_0x5c45a8(0x123)][_0x5c45a8(0x438)](_0x64884f); } _0xf10e4a(), _0xeba69d(_0x5c45a8(0xab3)), _0x370a18(), _0x57a80a(_0x5c45a8(0x8c7), 'friendCircleEdit'); } async function _0x171740() { const _0x1bedf0 = _0x187760, _0x20cc00 = document[_0x1bedf0(0x759)]('editing-friend-circle-id')['value']; if (!_0x20cc00) return; const _0x10f645 = await _0x5db04d(_0x1bedf0(0x68d)); _0x10f645 && (_0x29b260[_0x1bedf0(0x123)] = _0x29b260[_0x1bedf0(0x123)][_0x1bedf0(0x9f6)](_0x3f2a27 => _0x3f2a27['id'] !== _0x20cc00), _0x29b260[_0x1bedf0(0x439)] === _0x20cc00 && (_0x29b260[_0x1bedf0(0x439)] = null), _0xf10e4a(), _0xeba69d(_0x1bedf0(0x87a)), _0x370a18(), _0x57a80a('friendCircleList', 'friendCircleEdit')); } function _0x153773(_0x11a06c) { const _0x5b2348 = _0x187760; if (_0x5b2348(0x789) === _0x5b2348(0x789)) { _0x3420e5(); const _0x4e75a8 = _0x29b260[_0x5b2348(0x123)][_0x5b2348(0x444)](_0x10bc9c => _0x10bc9c['id'] === _0x11a06c); if (!_0x4e75a8) return; _0x29b260[_0x5b2348(0x439)] = _0x11a06c, _0xf10e4a(), document['getElementById']('friend-circle-title')[_0x5b2348(0x574)] = _0x4e75a8['name'], _0x547b5f(), _0x57a80a(_0x5b2348(0xa7c), _0x5b2348(0x8c7)), _0x4d8f71(); } else _0x584c29['addEventListener'](_0x5b2348(0x7ec), () => { const _0x3ad288 = _0x5b2348; _0x359384(_0x3ad288(0x295)); }); } function _0x5f0b98() { const _0x4164cb = _0x187760; if (!_0x29b260[_0x4164cb(0x123)] || _0x29b260['friendCircles'][_0x4164cb(0x919)] === 0x0) { console[_0x4164cb(0x297)](_0x4164cb(0x1ec)); return; } const _0x87c963 = _0x29b260[_0x4164cb(0x123)][0x0]; if (_0x87c963[_0x4164cb(0x9a8)][_0x4164cb(0x919)] < 0x2) { if ('bbhoC' !== _0x4164cb(0x4a8)) { console[_0x4164cb(0x297)](_0x4164cb(0x852) + _0x87c963[_0x4164cb(0xb15)] + _0x4164cb(0x3a7)); return; } else { const _0x34b70c = _0x3a905b === _0x565b22 ? _0x4164cb(0x1e8) : ''; return '' + _0x34b70c + _0x44bd65[_0x4164cb(0x807)]; } } const _0xb56586 = { 'id': _0x4164cb(0x677) + Date['now'](), 'authorType': _0x4164cb(0x565), 'authorId': _0x87c963[_0x4164cb(0x9a8)][0x0], 'content': _0x4164cb(0x78e), 'timestamp': Date[_0x4164cb(0x74c)](), 'likes': [_0x87c963[_0x4164cb(0x9a8)][0x1]], 'comments': [{ 'commentId': 'c_' + Date[_0x4164cb(0x74c)](), 'authorId': _0x87c963[_0x4164cb(0x9a8)][0x1], 'content': _0x4164cb(0x4dd) }] }; _0x87c963[_0x4164cb(0x9ce)]['push'](_0xb56586), _0xf10e4a(), console[_0x4164cb(0xa05)](_0x4164cb(0x675) + _0x87c963[_0x4164cb(0xb15)] + '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。'), _0xeba69d(_0x4164cb(0x7cc)); } window[_0x187760(0xa9e)] = _0x5f0b98; function _0x439911(_0x4aac14) { const _0x45e6e2 = _0x187760; if (_0x45e6e2(0xa39) !== _0x45e6e2(0x5d1)) return _0x29b260[_0x45e6e2(0x44f)][_0x45e6e2(0x444)](_0x1d3ee2 => _0x1d3ee2['id'] === _0x4aac14); else _0x3ef644 += _0x45e6e2(0x770); } function _0x195491(_0x556071, _0x4d614c = _0x187760(0x372)) { const _0x6602e1 = _0x187760, _0x226be5 = document['getElementById'](_0x6602e1(0x480)); let _0x21e240 = document['getElementById'](_0x6602e1(0x381)); _0x556071 ? (!_0x21e240 && (_0x21e240 = document[_0x6602e1(0xa93)](_0x6602e1(0x64e)), _0x21e240['id'] = _0x6602e1(0x381), _0x226be5[_0x6602e1(0x25f)](_0x21e240)), _0x21e240[_0x6602e1(0x29c)] = _0x6602e1(0xb27) + _0x4d614c + _0x6602e1(0x69c), _0x21e240[_0x6602e1(0x80f)][_0x6602e1(0x3e7)] = _0x6602e1(0x868)) : 'BEulS' === _0x6602e1(0x6d1) ? _0xfc3c7[_0x6602e1(0x4b9)] = ![] : _0x21e240 && (_0x6602e1(0x23f) === 'FSbaX' ? _0x21e240[_0x6602e1(0x80f)]['display'] = _0x6602e1(0x697) : (_0x3e0d1c(), _0x4cb285(![]))); } async function _0x5de466() { const _0x2b3133 = _0x187760; if (_0x2b3133(0x805) === _0x2b3133(0x805)) { const _0x1a0901 = _0x29b260['friendCircles']['find'](_0xb7600 => _0xb7600['id'] === _0x29b260[_0x2b3133(0x439)]); if (!_0x1a0901 || _0x29b260[_0x2b3133(0x27c)]) return; _0x195491(!![], _0x2b3133(0x64a)), _0x29b260[_0x2b3133(0x27c)] = !![]; try { if (_0x2b3133(0x3ca) !== _0x2b3133(0x3ca)) _0x3ec51f[_0x2b3133(0x80f)][_0x2b3133(0xad6)] = ''; else { let _0x1a33c5 = Date[_0x2b3133(0x74c)](); _0x1a0901[_0x2b3133(0x9ce)] && _0x1a0901[_0x2b3133(0x9ce)]['length'] > 0x0 && (_0x1a33c5 = Math[_0x2b3133(0x355)](..._0x1a0901[_0x2b3133(0x9ce)][_0x2b3133(0xa96)](_0x3918f4 => _0x3918f4['timestamp']))); const _0x630692 = await _0x23e378(_0x1a0901); if (!_0x630692 || _0x630692['length'] === 0x0) { _0xeba69d(_0x2b3133(0x850)); return; } const _0x1ef4d2 = _0x630692[_0x2b3133(0xa96)](async (_0x37ee3e, _0x5674e2) => { const _0x195c73 = _0x2b3133; if (_0x195c73(0xb28) === _0x195c73(0x5a5)) { const _0x4802d4 = _0x3b9211[_0x195c73(0x1db)](_0x2ce6c9); _0x4a54a0[_0x195c73(0xac4)](_0x4802d4) && (_0x4afc89[_0x195c73(0xa03)] = _0x4802d4['map'](_0x13ee97 => _0x13ee97['name'] + '--' + _0x13ee97[_0x195c73(0x8b7)])['join']('\x0a')); } else { _0x195491(!![], _0x195c73(0x8b4) + (_0x5674e2 + 0x1) + _0x195c73(0x64f) + _0x630692[_0x195c73(0x919)] + _0x195c73(0x59a)); const _0x12cd20 = _0x1a33c5 + (_0x5674e2 + 0x1) * 0x3c * 0x3e8, _0x2861af = { 'id': _0x195c73(0xa2b) + _0x37ee3e[_0x195c73(0xb04)] + '_' + _0x12cd20, 'authorType': _0x195c73(0x565), 'authorId': _0x37ee3e[_0x195c73(0xb04)], 'content': _0x37ee3e[_0x195c73(0x847)], 'timestamp': _0x12cd20, 'likes': _0x37ee3e['likes'] || [], 'comments': (_0x37ee3e['comments'] || [])[_0x195c73(0xa96)]((_0x29c21d, _0x5ab6c1) => ({ 'commentId': 'c_' + _0x12cd20 + '_' + _0x5ab6c1, 'authorId': _0x29c21d[_0x195c73(0xb04)], 'content': _0x29c21d[_0x195c73(0x359)] })) }; if (_0x37ee3e[_0x195c73(0x763)] === _0x195c73(0xa7c) && _0x37ee3e['songName'] && _0x37ee3e[_0x195c73(0x6cd)]) try { if (_0x195c73(0x8dc) === _0x195c73(0x576)) _0x2dc56b[_0x195c73(0x29c)] = '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', _0x3cdfff[_0x195c73(0x759)](_0x195c73(0xa8e))[_0x195c73(0x6cc)](_0x195c73(0x7ec), _0x52ee41); else { const _0x29cc31 = await _0x1533cb(_0x37ee3e[_0x195c73(0x5ee)], _0x37ee3e[_0x195c73(0x6cd)]); _0x2861af[_0x195c73(0x713)] = _0x195c73(0xa7c), _0x2861af['songName'] = _0x37ee3e['songName'], _0x2861af[_0x195c73(0x6cd)] = _0x37ee3e['artist'], _0x2861af[_0x195c73(0x8ff)] = _0x29cc31[_0x195c73(0x194)], _0x2861af[_0x195c73(0x3e3)] = _0x29cc31[_0x195c73(0x8b7)]; } } catch (_0x2b2e0c) { console[_0x195c73(0x297)](_0x195c73(0x82f), _0x2b2e0c), _0x2861af[_0x195c73(0x713)] = _0x195c73(0x807); } else { if (_0x195c73(0x8ea) === _0x195c73(0x8ea)) _0x2861af['type'] = _0x195c73(0x807); else { const _0x28a040 = _0x282ffe['id'], _0x3199a6 = _0x195c73(0x161) + _0x28a040, _0x14b445 = _0x563422[_0x195c73(0x860)](_0x3199a6), _0x1bc6f0 = _0x5d851e['querySelector']('.app-icon-img'); if (_0x14b445) _0x1bc6f0[_0x195c73(0x29c)] = _0x195c73(0x99a) + _0x14b445 + _0x195c73(0x708); else { const _0x18575b = _0xf5838c[_0x195c73(0xa01)](_0x195c73(0xa74) + _0x28a040 + _0x195c73(0x50f) + _0x28a040 + _0x195c73(0x73f))?.['innerHTML']; _0x18575b && (_0x1bc6f0['innerHTML'] = _0x18575b); } } } return _0x2861af; } }), _0x215a57 = await Promise[_0x2b3133(0x14b)](_0x1ef4d2); _0x1a0901[_0x2b3133(0x9ce)]['push'](..._0x215a57), _0xf10e4a(); } } catch (_0x55ecd9) { console['error']('生成动态失败:', _0x55ecd9), _0xeba69d('生成动态时发生错误:\x20' + _0x55ecd9['message']); } finally { 'EwCdN' !== _0x2b3133(0x87d) ? (_0x547b5f(), _0x195491(![]), _0x29b260[_0x2b3133(0x27c)] = ![]) : _0x586b11[_0x2b3133(0x297)](_0x2b3133(0xab6), _0x2352b9); } } else { _0x30d4ef[_0x2b3133(0x2b1)](_0x2b3133(0x951) + _0x5ec17a['id'] + _0x2b3133(0x59c), _0x552a52[_0x2b3133(0x997)]); try { _0xceba3d = _0x478c75(_0x26e502); if (!_0xd079f5) throw new _0x3c99e5('YAML翻译机也无法理解这段梦话。'); _0xebc9df[_0x2b3133(0xa05)]('兼容模式成功，已将\x20' + _0x90bc48['id'] + '\x20的旧格式数据翻译。'); } catch (_0x4cbc0a) { throw _0x1d153f; } } } async function _0x23e378(_0x270c18) { const _0x1a00f5 = _0x187760, _0x5b46d8 = _0x270c18[_0x1a00f5(0x9a8)]['map'](_0xd59ac7 => _0x4cc875(_0xd59ac7))['filter'](Boolean); if (_0x5b46d8[_0x1a00f5(0x919)] === 0x0) return null; const _0x172c1e = _0x51a4ba(), _0x145068 = _0x439911(_0x270c18[_0x1a00f5(0x515)]) || _0x29b260['userProfiles'][0x0], _0x123bfe = _0x145068 ? '\x0a#\x20好友圈的主人\x20(“我”)\x0a-\x20姓名:\x20' + _0x145068[_0x1a00f5(0xb15)] + _0x1a00f5(0x1c6) + (_0x145068[_0x1a00f5(0x435)] || '无') + '\x0a' : '', _0x444905 = _0x5b46d8[_0x1a00f5(0xa96)](_0x238ccc => { const _0xb84397 = _0x1a00f5; if (_0xb84397(0x462) === _0xb84397(0x34e)) { const _0x5801aa = 0x32; if (_0x523cf8 < _0x35d567 - _0x5801aa) _0x5c39ef(_0x3d6657 + 0x1); else _0x38690f > _0x4307d6 + _0x5801aa && _0x99bdc8(_0xaa3db4 - 0x1); } else { const { omniText: _0x538dd3 } = _0x2eac37(_0x238ccc['id'], null), _0x4018ce = _0x4312af(_0x238ccc['id']), _0x5692cc = _0x238ccc['linkedWorldBookIds'] && _0x238ccc[_0xb84397(0x5c0)][_0xb84397(0x919)] > 0x0 ? '\x0a\x0a#\x20' + _0x238ccc[_0xb84397(0xb15)] + _0xb84397(0x4be) + _0x238ccc['linkedWorldBookIds'][_0xb84397(0xa96)](_0x1dbbc2 => _0x29b260[_0xb84397(0x1a1)][_0xb84397(0x444)](_0x5efbe2 => _0x5efbe2['id'] === _0x1dbbc2))[_0xb84397(0x9f6)](Boolean)[_0xb84397(0xa96)](_0x8b941d => _0xb84397(0x497) + _0x8b941d[_0xb84397(0xb15)] + '\x0a' + _0x8b941d[_0xb84397(0x359)])[_0xb84397(0x63b)]('') : ''; return _0xb84397(0x720) + _0x238ccc[_0xb84397(0xb15)] + _0xb84397(0x83a) + _0x238ccc['id'] + _0xb84397(0x57d) + _0x238ccc[_0xb84397(0x435)] + _0xb84397(0x67a) + _0x538dd3 + '\x0a' + _0x4018ce + '\x0a' + _0x5692cc; } })[_0x1a00f5(0x63b)]('\x0a\x0a'), _0x491045 = Math[_0x1a00f5(0xa54)](Math[_0x1a00f5(0x545)]() * 0x3) + 0x2, _0x15aff8 = _0x1a00f5(0xabb) + _0x491045 + _0x1a00f5(0x585) + _0x444905 + '\x0a' + _0x123bfe + _0x1a00f5(0x654) + _0x172c1e + _0x1a00f5(0x650) + _0x491045 + _0x1a00f5(0x9af) + _0x491045 + '个帖子对象。\x0a-\x20**【ID规则】**:\x20所有\x20\x22authorId\x22,\x20\x22likes\x22,\x20\x22comments\x22\x20中的作者标识，【必须】使用上面提供的角色\x20**ID**，绝对不能使用角色名字。\x0a-\x20**【JSON结构】**:\x20每个帖子对象必须遵循以下结构：\x0a\x20\x20```json\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22authorId\x22:\x20\x22发布者的ID\x22,\x0a\x20\x20\x20\x20\x22postType\x22:\x20\x22text\x20or\x20music\x22,\x0a\x20\x20\x20\x20\x22postContent\x22:\x20\x22动态的文字内容\x22,\x0a\x20\x20\x20\x20\x22songName\x22:\x20\x22如果是music类型，则必须有歌名\x22,\x0a\x20\x20\x20\x20\x22artist\x22:\x20\x22如果是music类型，则必须有歌手名\x22,\x0a\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20}\x0a\x20\x20```\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', _0x31e4f0 = [{ 'role': _0x1a00f5(0x4c2), 'content': _0x15aff8 }, { 'role': _0x1a00f5(0x544), 'content': '请根据以上所有信息，开始分析并返回JSON。' }]; _0x31e4f0[_0x1a00f5(0x438)]({ 'role': _0x1a00f5(0x544), 'content': _0x1a00f5(0x4a1) + _0x491045 + _0x1a00f5(0x6fc) }); try { const _0x47adce = await _0x315051(_0x31e4f0, { 'json': !![] }), _0x259b9b = _0x47adce['match'](/(\[[\s\S]*\])/); if (!_0x259b9b) throw new Error(_0x1a00f5(0x273)); const _0x1acf79 = _0x259b9b[0x1], _0x1c7000 = JSON[_0x1a00f5(0x1db)](_0x1acf79); if (!Array[_0x1a00f5(0xac4)](_0x1c7000)) throw new Error(_0x1a00f5(0x5b3)); return _0x1c7000; } catch (_0x55cf59) { return console[_0x1a00f5(0x297)]('批量生成动态失败:\x20', _0x55cf59), console[_0x1a00f5(0x297)](_0x1a00f5(0x995), _0x55cf59[_0x1a00f5(0x230)] || 'AI返回了无法解析的文本'), null; } } async function _0x477060() { const _0x1da9fd = _0x187760; if (_0x1da9fd(0x6ed) !== _0x1da9fd(0x6ed)) _0x34e79c = _0x50659a[_0x1da9fd(0xb15)]; else { const _0x4c6aa7 = _0x29b260[_0x1da9fd(0x123)][_0x1da9fd(0x444)](_0x3f6ad3 => _0x3f6ad3['id'] === _0x29b260[_0x1da9fd(0x439)]); if (!_0x4c6aa7) return; const _0x174969 = await _0x5db04d(_0x1da9fd(0x303) + _0x4c6aa7[_0x1da9fd(0xb15)] + '”的所有动态吗？此操作不可撤销，且AI将不再记得这些内容。'); _0x174969 && (_0x4c6aa7[_0x1da9fd(0x9ce)] = [], _0xf10e4a(), _0x547b5f(), _0xeba69d('动态已清空。')); } } function _0x547b5f() { const _0xef45d = _0x187760, _0x1ebb4e = document[_0xef45d(0x759)](_0xef45d(0x5f3)), _0x22d1c2 = _0x29b260[_0xef45d(0x123)]['find'](_0x40a55a => _0x40a55a['id'] === _0x29b260[_0xef45d(0x439)]); if (!_0x22d1c2) { _0x1ebb4e['innerHTML'] = _0xef45d(0x49d); return; } if (!_0x22d1c2[_0xef45d(0x9ce)] || _0x22d1c2[_0xef45d(0x9ce)]['length'] === 0x0) { if (_0xef45d(0xae8) === 'bOker') { _0x1ebb4e[_0xef45d(0x29c)] = _0xef45d(0x2f3); return; } else _0x50b9eb[_0xef45d(0x5c7)] = new _0x159e7a(), _0x402c90['selectedDate'] = _0x561f75(), _0x11742c(); } _0x1ebb4e['innerHTML'] = ''; const _0x47de53 = [..._0x22d1c2[_0xef45d(0x9ce)]]['sort']((_0x393e9f, _0x2a2845) => _0x2a2845['timestamp'] - _0x393e9f[_0xef45d(0x6de)]); _0x47de53['forEach'](_0x28d373 => { const _0x44dce9 = _0xef45d, _0x2121b0 = document[_0x44dce9(0xa93)](_0x44dce9(0x64e)); _0x2121b0['className'] = _0x44dce9(0x2ee); let _0x247a05 = '未知', _0xda2a33 = _0x461596; if (_0x28d373['authorType'] === _0x44dce9(0x544)) { const _0x537c6d = _0x439911(_0x28d373[_0x44dce9(0xb04)]); _0x537c6d && (_0x247a05 = _0x537c6d[_0x44dce9(0xb15)], _0xda2a33 = _0x537c6d[_0x44dce9(0x96f)]); } else { const _0x370823 = _0x4cc875(_0x28d373[_0x44dce9(0xb04)]); _0x370823 && (_0x247a05 = _0x370823[_0x44dce9(0xb15)], _0xda2a33 = _0x370823[_0x44dce9(0x96f)]); } const _0x193c25 = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0xda2a33 + _0x44dce9(0x7ff) + _0x247a05 + _0x44dce9(0x9d7), _0x41259a = _0x44dce9(0x2ed) + _0x28d373[_0x44dce9(0x359)] + _0x44dce9(0x8d4); let _0x15dd48 = ''; if (_0x28d373['image'] || _0x28d373['imageId']) { if ('alPaq' !== 'nMHZx') { const _0x4a5a0c = _0x44dce9(0x5e1) + _0x28d373['id']; _0x15dd48 = _0x44dce9(0x73b) + _0x4a5a0c + _0x44dce9(0x86c), setTimeout(() => { const _0x110653 = _0x44dce9; if (_0x110653(0x114) === _0x110653(0x114)) { const _0x34efa6 = document['getElementById'](_0x4a5a0c); if (!_0x34efa6) return; if (_0x28d373[_0x110653(0x7ee)]) { if ('sMulU' === _0x110653(0x718)) _0x34efa6['src'] = _0x28d373[_0x110653(0x7ee)]; else { const _0x4e9328 = new _0xc8432f(_0x333f2a[_0x110653(0x6de)]), _0x34c1e0 = _0xbb8fc3(_0x4e9328); _0x29a561 += _0x110653(0x891) + _0x34c1e0 + '\x0a'; const _0x41551d = _0x72f155[_0x110653(0x9a6)](), _0x5340bc = _0x4e9328[_0x110653(0x9a6)](), _0x56f140 = new _0x21684f(); _0x56f140[_0x110653(0x1ad)](_0x4f32d2[_0x110653(0x3de)]() - 0x1); const _0x4a99f4 = _0x56f140[_0x110653(0x9a6)](); if (_0x41551d === _0x5340bc) { const _0x574e87 = (_0x1476ec - _0x4e9328) / (0x3e8 * 0x3c); _0x4000d9 += _0x110653(0xac3); } else { if (_0x4a99f4 === _0x5340bc) _0x1d5674 += _0x110653(0x71e); else { const _0x14bacf = _0x415f6a[_0x110653(0x6f8)]((_0x2ab3ac - _0x4e9328) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x4e208a += _0x110653(0x475) + _0x14bacf + _0x110653(0x467); } } } } else _0x28d373[_0x110653(0x1bd)] && (_0x110653(0x110) !== _0x110653(0x56c) ? _0x2e6c7a(_0x28d373[_0x110653(0x1bd)])[_0x110653(0x276)](_0x3fe57d => { const _0x434e4a = _0x110653; if (_0x434e4a(0x269) === 'BEsgt') { if (_0x3fe57d) { if (_0x434e4a(0x788) !== _0x434e4a(0x788)) _0x431be9(_0x23473d['id']); else { const _0x14dd66 = URL[_0x434e4a(0x289)](_0x3fe57d); _0x34efa6[_0x434e4a(0x686)] = _0x14dd66, _0x34efa6[_0x434e4a(0x44b)] = () => URL['revokeObjectURL'](_0x14dd66); } } } else { if (_0x1cc2ea[_0x434e4a(0x456)] === _0x434e4a(0x544)) return _0x40125d[_0x434e4a(0xa77)]?.[_0x434e4a(0xb15)] || 'User'; if (_0x263381[_0x434e4a(0x616)]) { const _0x3e1f0c = _0x7cf3a8(_0x1d6fd2['senderId']); return _0x3e1f0c?.['name'] || 'Unknown'; } if (_0x33c951?.[_0x434e4a(0x713)] === _0x434e4a(0x7ad)) { const _0x4e66f1 = _0x1e1008(_0x1d2128[_0x434e4a(0x9be)][0x0]); return _0x4e66f1?.[_0x434e4a(0xb15)] || 'AI'; } return _0x434e4a(0x73a); } }) : _0x59eeff[_0x110653(0x297)](_0x110653(0x9c4), _0x5c8ff4)); } else { _0x5a02c5(_0x110653(0xa3c)); return; } }, 0x0); } else { if (_0x5ecbea) _0x665dc2(_0x2a910b); const _0x2ce05b = _0x36ca0e[_0x44dce9(0x65e)]['closest'](_0x44dce9(0x6e1)); if (!_0x2ce05b) return; const _0x29295a = _0x2ce05b['dataset']['id']; if (!_0x29295a) return; const _0x4e92e2 = () => { _0x207584 = _0x2cd6f1(() => { const _0x197b02 = _0x18ce; if (_0x15cbcb[_0x197b02(0x713)] === 'touchstart') _0x2a73b8[_0x197b02(0xac9)](); _0x1952b2(_0x29295a); }, 0x320); }, _0x360365 = () => { if (_0x23e1df) _0x3ad082(_0x263031); }; _0x1bbebd[_0x44dce9(0x6cc)]('mouseup', _0x360365, { 'once': !![] }), _0x11ec30[_0x44dce9(0x6cc)]('touchend', _0x360365, { 'once': !![] }), _0x40b938['addEventListener'](_0x44dce9(0xaf6), _0x360365, { 'once': !![] }), _0x39c4c7['addEventListener'](_0x44dce9(0x630), _0x360365, { 'once': !![] }), _0x4e92e2(); } } let _0x4751c7 = ''; _0x28d373[_0x44dce9(0x713)] === _0x44dce9(0xa7c) && _0x28d373[_0x44dce9(0x5ee)] && (_0x44dce9(0x962) === _0x44dce9(0x962) ? _0x4751c7 = _0x44dce9(0xb19) + _0x28d373['id'] + _0x44dce9(0x24a) + (_0x28d373['coverUrl'] || _0x461596) + _0x44dce9(0x45f) + _0x28d373[_0x44dce9(0x5ee)] + _0x44dce9(0x4fa) + _0x28d373[_0x44dce9(0x6cd)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>' + (_0x28d373[_0x44dce9(0x3e3)] ? '▶' : '⚠') + '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20' : (_0x23238f(), _0x4fa1a8(_0x44dce9(0x8c7), _0x44dce9(0x83c)))); const _0x3a22bf = _0x44dce9(0x3b3) + new Date(_0x28d373['timestamp'])[_0x44dce9(0x22a)]('zh-CN') + _0x44dce9(0x892); let _0x4733d0 = ''; if (_0x28d373['likes'] && _0x28d373['likes'][_0x44dce9(0x919)] > 0x0 || _0x28d373[_0x44dce9(0x566)] && _0x28d373[_0x44dce9(0x566)][_0x44dce9(0x919)] > 0x0) { if (_0x44dce9(0x900) !== 'UjvYN') { let _0x416f72 = ''; if (_0x28d373[_0x44dce9(0x861)] && _0x28d373[_0x44dce9(0x861)][_0x44dce9(0x919)] > 0x0) { const _0xbd1f3a = _0x28d373[_0x44dce9(0x861)][_0x44dce9(0xa96)](_0x2bc3d5 => _0x4cc875(_0x2bc3d5)?.[_0x44dce9(0xb15)] || '未知')[_0x44dce9(0x63b)]('、'), _0x5f24ee = _0x44dce9(0x86a); _0x416f72 = _0x44dce9(0x6a3) + _0x5f24ee + '\x20' + _0xbd1f3a + '</div>'; } let _0x1d5ea8 = ''; if (_0x28d373[_0x44dce9(0x566)] && _0x28d373['comments'][_0x44dce9(0x919)] > 0x0) { const _0x29a85c = _0x28d373[_0x44dce9(0x566)][_0x44dce9(0xa96)](_0x3e4d81 => { const _0x29a708 = _0x44dce9, _0x211e1a = _0x4cc875(_0x3e4d81[_0x29a708(0xb04)])?.['name'] || '未知'; return _0x29a708(0x696) + _0x211e1a + '</span>:\x20' + _0x3e4d81['content'] + _0x29a708(0x892); })[_0x44dce9(0x63b)](''); _0x1d5ea8 = '<div\x20class=\x22post-comments-container\x22>' + _0x29a85c + _0x44dce9(0x892); } _0x4733d0 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x416f72 + _0x44dce9(0x9bd) + _0x1d5ea8 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20'; } else _0xa8fa69[_0x44dce9(0x969)][_0x44dce9(0x944)](_0x44dce9(0x552)); } const _0x4c49c5 = _0x44dce9(0x90d) + _0x41259a + _0x15dd48 + _0x4751c7 + _0x44dce9(0x892); _0x2121b0['innerHTML'] = _0x193c25 + _0x4c49c5 + _0x3a22bf + _0x4733d0; if (_0x28d373[_0x44dce9(0x713)] === _0x44dce9(0xa7c) && _0x28d373[_0x44dce9(0x3e3)]) { if (_0x44dce9(0x641) !== _0x44dce9(0x71f)) { const _0x20326a = _0x2121b0[_0x44dce9(0xa01)]('.music-post-song-card'); _0x20326a && _0x20326a[_0x44dce9(0x6cc)]('click', function () { const _0x9576a5 = { 'id': _0x28d373['id'], 'url': _0x28d373['playableUrl'] }; _0x40c32e(this, _0x9576a5); }); } else _0x138664[_0x44dce9(0x969)][_0x44dce9(0x944)](_0x44dce9(0x9c8)), _0x37e641[_0x44dce9(0x969)][_0x44dce9(0x944)](_0x44dce9(0x33c)), _0x3a2919[_0x44dce9(0x969)]['add']('is-visible'), _0x4c405b(() => { const _0x51efe1 = _0x44dce9; _0x4bf948[_0x51efe1(0x969)]['remove'](_0x51efe1(0x552), 'is-exiting-left'), _0x4bd9ab[_0x51efe1(0x969)][_0x51efe1(0x41a)]('is-entering-from-right'), _0x273425[_0x51efe1(0x8c3)] = _0x57b4fb, _0x220235(), _0x2cc086[_0x51efe1(0x42c)] = ![]; }, 0x2bc); } _0x1ebb4e[_0x44dce9(0x25f)](_0x2121b0); }); } document[_0x187760(0x759)]('clear-feed-button')[_0x187760(0x6cc)]('click', _0x477060), document[_0x187760(0x759)](_0x187760(0xa40))[_0x187760(0x6cc)](_0x187760(0x7ec), _0x5de466), document['getElementById'](_0x187760(0xa43))[_0x187760(0x6cc)]('click', () => _0x57a80a(_0x187760(0x83c), _0x187760(0x8c7))), document[_0x187760(0x759)](_0x187760(0x272))[_0x187760(0x6cc)]('click', () => _0x2a1eab()), document[_0x187760(0x759)](_0x187760(0x22f))[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x57a80a('friendCircleList', _0x187760(0x7a4))), document['getElementById'](_0x187760(0x5f9))[_0x187760(0x6cc)](_0x187760(0x7ec), _0x351243), document[_0x187760(0x759)](_0x187760(0x823))[_0x187760(0x6cc)](_0x187760(0x7ec), _0x171740), document[_0x187760(0x759)]('back-to-circle-list-from-feed')[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x22286c = _0x187760; _0x370a18(), _0x57a80a(_0x22286c(0x8c7), _0x22286c(0xa7c)); }), document[_0x187760(0x759)]('edit-current-circle-button')['addEventListener'](_0x187760(0x7ec), () => { const _0x21236b = _0x187760; if (_0x21236b(0x844) === _0x21236b(0x2dc)) return { 'type': _0x21236b(0x39f), 'eventType': _0xb35efa[0x1][_0x21236b(0x74e)](), 'eventDate': _0x1d801a[0x2]['trim'](), 'eventContent': _0x28b62f[0x3][_0x21236b(0x74e)]() }; else _0x29b260[_0x21236b(0x439)] && _0x2a1eab(_0x29b260['activeFriendCircleId']); }), document[_0x187760(0x759)]('user-send-post-button')[_0x187760(0x6cc)](_0x187760(0x7ec), async () => { const _0x59bf4e = _0x187760, _0x166597 = _0x29b260[_0x59bf4e(0x123)][_0x59bf4e(0x444)](_0x199c9f => _0x199c9f['id'] === _0x29b260[_0x59bf4e(0x439)]); if (!_0x166597 || _0x29b260[_0x59bf4e(0x27c)]) return; const _0x58e769 = _0x166597[_0x59bf4e(0x515)], _0x3dd838 = _0x29b260[_0x59bf4e(0x44f)][_0x59bf4e(0x444)](_0x4528db => _0x4528db['id'] === _0x58e769); if (!_0x3dd838) { if (_0x59bf4e(0xa9b) === _0x59bf4e(0xa9b)) { _0xeba69d(_0x59bf4e(0x59b)); return; } else _0x2b03f1(_0x59bf4e(0x699)); } const _0x9939c0 = document[_0x59bf4e(0x759)](_0x59bf4e(0x783))[_0x59bf4e(0xa03)][_0x59bf4e(0x74e)](), _0x5ec222 = _0x29b260[_0x59bf4e(0x366)][_0x59bf4e(0x7ee)], _0x4cc118 = _0x29b260[_0x59bf4e(0x366)][_0x59bf4e(0xa7c)], _0x146e6a = _0x29b260[_0x59bf4e(0x366)][_0x59bf4e(0x1bd)]; if (!_0x9939c0 && !_0x5ec222 && !_0x4cc118) { _0xeba69d(_0x59bf4e(0xabe)); return; } const _0x388708 = { 'id': _0x59bf4e(0x955) + Date[_0x59bf4e(0x74c)](), 'authorType': 'user', 'authorId': _0x3dd838['id'], 'content': _0x9939c0, 'timestamp': Date['now'](), 'likes': [], 'comments': [] }; if (_0x146e6a) _0x388708['imageId'] = _0x146e6a; else { if (_0x5ec222) { if (_0x59bf4e(0x3ea) === _0x59bf4e(0x933)) { const _0x3f2e1c = _0x4f000d[_0x59bf4e(0xa93)]('li'); _0x3f2e1c[_0x59bf4e(0x8bd)] = 'character-item', _0x3f2e1c[_0x59bf4e(0x2f7)][_0x59bf4e(0x318)] = _0x359eef['id'], _0x3f2e1c['innerHTML'] = _0x59bf4e(0x9ab) + (_0x3c4acf[_0x59bf4e(0x96f)] || _0x260239) + _0x59bf4e(0x483) + _0x37c9d3[_0x59bf4e(0xb15)] + _0x59bf4e(0x14d) + (_0x3c7ff4[_0x59bf4e(0x3f7)] || '私聊') + _0x59bf4e(0x622), _0x3f2e1c['addEventListener'](_0x59bf4e(0x7ec), () => { _0xdc60b3(_0x2e3e28['id']); }), _0x10d420[_0x59bf4e(0x25f)](_0x3f2e1c); } else _0x388708[_0x59bf4e(0x7ee)] = _0x5ec222; } } _0x4cc118 ? (_0x388708[_0x59bf4e(0x713)] = 'music', Object['assign'](_0x388708, _0x4cc118)) : _0x59bf4e(0x820) !== _0x59bf4e(0x820) ? _0x2bcbf9[_0x59bf4e(0x251)] === _0x59bf4e(0x674) && !_0x1fb47d[_0x59bf4e(0x943)] && (_0x5328de[_0x59bf4e(0xac9)](), _0x64b790()) : _0x388708[_0x59bf4e(0x713)] = _0x59bf4e(0x807), _0x166597[_0x59bf4e(0x9ce)]['push'](_0x388708), _0xf10e4a(), _0x547b5f(), document[_0x59bf4e(0x759)](_0x59bf4e(0x783))[_0x59bf4e(0xa03)] = '', _0x29b260[_0x59bf4e(0x366)]['image'] = null, _0x29b260[_0x59bf4e(0x366)][_0x59bf4e(0xa7c)] = null, _0x29b260[_0x59bf4e(0x366)][_0x59bf4e(0x1bd)] = null, _0x11c503(), _0x4f49dd(_0x388708); }), document['getElementById'](_0x187760(0x7e5))[_0x187760(0x6cc)]('click', () => { const _0x3711c9 = _0x187760; 'CLiVc' !== _0x3711c9(0x4fe) ? document[_0x3711c9(0x759)](_0x3711c9(0x11f))[_0x3711c9(0x7ec)]() : (_0x10a38f['classList']['add']('is-entering-from-left'), _0x573f3b[_0x3711c9(0x969)][_0x3711c9(0x944)](_0x3711c9(0x595)), _0x3a6700['classList'][_0x3711c9(0x944)](_0x3711c9(0x552)), _0x15ba6e(() => { const _0x45af51 = _0x3711c9; _0x556899[_0x45af51(0x969)]['remove'](_0x45af51(0x552), _0x45af51(0x595)), _0x4a250d['classList'][_0x45af51(0x41a)](_0x45af51(0x6a9)), _0x33b484[_0x45af51(0x8c3)] = _0x3937d4, _0x2beea7(), _0x536414[_0x45af51(0x42c)] = ![]; }, 0x2bc)); }), document['getElementById'](_0x187760(0x11f))[_0x187760(0x6cc)](_0x187760(0x3c6), async _0x3adca0 => { const _0x194a9e = _0x187760, _0x413c05 = _0x3adca0[_0x194a9e(0x65e)][_0x194a9e(0x523)][0x0]; if (!_0x413c05) return; try { if (_0x194a9e(0x580) !== _0x194a9e(0x651)) { const _0x3b2e5a = await _0x3a4746(_0x413c05, 0x320, 0.8, !![]), _0x4768d7 = 'post_image_' + Date[_0x194a9e(0x74c)](); await _0x5b0aee(_0x4768d7, _0x3b2e5a), _0x29b260[_0x194a9e(0x366)][_0x194a9e(0x1bd)] = _0x4768d7, _0x29b260['pendingPostAttachments'][_0x194a9e(0x7ee)] = null, _0x29b260[_0x194a9e(0x366)][_0x194a9e(0xa7c)] = null, _0x11c503(); } else _0x9450ac[_0x194a9e(0x29c)] = '<span\x20style=\x22opacity:\x200.6;\x22>无</span>'; } catch (_0x102e7a) { 'sbaHI' === _0x194a9e(0x1c0) ? _0xeba69d(_0x194a9e(0x723) + _0x102e7a[_0x194a9e(0x997)]) : _0x46505f += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a'; } _0x3adca0[_0x194a9e(0x65e)][_0x194a9e(0xa03)] = ''; }), document[_0x187760(0x759)](_0x187760(0x836))[_0x187760(0x6cc)](_0x187760(0x7ec), async () => { const _0x2272f3 = _0x187760, _0x18d0c9 = await _0x44efbc(); if (!_0x18d0c9) return; _0xeba69d('正在搜索音乐...'); try { const _0x2e28a0 = await _0x1533cb(_0x18d0c9[_0x2272f3(0x5ee)], _0x18d0c9['artist']); _0x29b260[_0x2272f3(0x366)][_0x2272f3(0xa7c)] = { 'songName': _0x18d0c9['songName'], 'artist': _0x18d0c9[_0x2272f3(0x6cd)], 'coverUrl': _0x2e28a0[_0x2272f3(0x194)], 'playableUrl': _0x2e28a0[_0x2272f3(0x8b7)] }, _0x29b260[_0x2272f3(0x366)]['image'] = null, _0x11c503(); } catch (_0x1802b5) { _0xeba69d(_0x2272f3(0x5bb) + _0x1802b5[_0x2272f3(0x997)]); } }); function _0x40236b() { const _0x18fb43 = _0x187760; if (_0x18fb43(0x53a) !== _0x18fb43(0x53a)) _0x17f793[_0x18fb43(0x4b9)] = ![], _0x148f3f[_0x18fb43(0x574)] = '获取'; else { const _0x14bbf0 = new Date(), _0x2e43fe = document[_0x18fb43(0x759)](_0x18fb43(0x1df)), _0x45c029 = document[_0x18fb43(0x759)](_0x18fb43(0xa52)); if (_0x2e43fe && _0x45c029) { const _0x506eba = String(_0x14bbf0[_0x18fb43(0xb06)]())['padStart'](0x2, '0'), _0x3ed52a = String(_0x14bbf0[_0x18fb43(0x600)]())[_0x18fb43(0x27e)](0x2, '0'); _0x2e43fe['textContent'] = _0x506eba + ':' + _0x3ed52a; const _0x367e40 = _0x14bbf0[_0x18fb43(0x950)]() + 0x1, _0x46a77d = _0x14bbf0[_0x18fb43(0x3de)](), _0x5928e4 = [_0x18fb43(0x1b6), '星期一', _0x18fb43(0x334), _0x18fb43(0x23e), _0x18fb43(0x496), _0x18fb43(0x36f), _0x18fb43(0x275)][_0x14bbf0['getDay']()]; _0x45c029[_0x18fb43(0x574)] = _0x367e40 + '月' + _0x46a77d + '日\x20' + _0x5928e4; } } } function _0x2c0001(_0x38539f) { const _0x35cffa = _0x187760; if ('zaTdR' === _0x35cffa(0x7c0)) { if (!_0x38539f) return ''; const _0xd3edc9 = new Date(_0x38539f), _0x1387b9 = String(_0xd3edc9[_0x35cffa(0xb06)]())[_0x35cffa(0x27e)](0x2, '0'), _0x1a4bc9 = String(_0xd3edc9[_0x35cffa(0x600)]())[_0x35cffa(0x27e)](0x2, '0'); return _0x1387b9 + ':' + _0x1a4bc9; } else _0x542b7e[_0x373466]['addEventListener'](_0x35cffa(0x7ec), () => _0x417cd9[_0x56f333][_0x35cffa(0x7ec)]()), _0x18d209[_0x3ea0f8][_0x35cffa(0x6cc)](_0x35cffa(0x3c6), _0x310284 => { const _0x264827 = _0x35cffa; _0x3768d3(_0x358e87, _0x310284[_0x264827(0x65e)][_0x264827(0x523)][0x0]); }); } function _0x51a4ba() { const _0xc85ba0 = _0x187760; if (_0xc85ba0(0x690) !== _0xc85ba0(0x2df)) { const _0x34ad22 = _0x29b260[_0xc85ba0(0x123)][_0xc85ba0(0x444)](_0x55b188 => _0x55b188['id'] === _0x29b260['activeFriendCircleId']), _0x4908f8 = _0x34ad22 ? _0x34ad22[_0xc85ba0(0x9ce)] : []; if (!_0x4908f8 || _0x4908f8['length'] === 0x0) return ''; const _0xf9cd0b = _0x4908f8[_0xc85ba0(0x1f9)](0x0, 0x5), _0xfb825a = _0xf9cd0b['map'](_0x59b868 => { const _0x1bb8ca = _0xc85ba0, _0x225c84 = _0x4cc875(_0x59b868[_0x1bb8ca(0xb04)]) || { 'name': '未知' }; let _0x3d47a7 = '-\x20[动态]\x20' + _0x225c84['name'] + _0x1bb8ca(0xa1a) + (_0x59b868['thought'] || _0x59b868[_0x1bb8ca(0x359)]) + '”'; return _0x59b868[_0x1bb8ca(0x713)] === _0x1bb8ca(0xa7c) && (_0x3d47a7 += _0x1bb8ca(0x547) + _0x59b868['songName'] + '\x20-\x20' + _0x59b868[_0x1bb8ca(0x6cd)] + ')'), _0x3d47a7; }); return _0xc85ba0(0x594) + _0xfb825a[_0xc85ba0(0x63b)]('\x0a'); } else _0x13bbbe(), _0x523598(_0xc85ba0(0x491), _0xc85ba0(0x83c)); } function _0x4312af(_0x551b47) { const _0x42779c = _0x187760, _0x369c89 = _0x29b260[_0x42779c(0x44f)]['find'](_0x17b484 => _0x17b484['id'] === _0x29b260[_0x42779c(0x113)]) || { 'name': '你' }, _0x4c14be = _0x29b260[_0x42779c(0x94d)]['find'](_0x3cc82a => _0x3cc82a[_0x42779c(0x94f)] === _0x551b47); if (!_0x4c14be || !_0x4c14be['entries'] || _0x4c14be[_0x42779c(0xa18)][_0x42779c(0x919)] === 0x0) return ''; const _0x5bd7ab = _0x4c14be[_0x42779c(0xa18)][_0x42779c(0x1f9)](-0x8), _0x4a9119 = _0x5bd7ab[_0x42779c(0xa96)](_0x5335e6 => { const _0x1bb9a3 = _0x42779c, _0x3fc00a = _0x5335e6[_0x1bb9a3(0xa64)] === _0x1bb9a3(0x544) ? _0x369c89[_0x1bb9a3(0xb15)] : _0x4cc875(_0x5335e6[_0x1bb9a3(0xa64)])[_0x1bb9a3(0xb15)]; return _0x1bb9a3(0x4c0) + new Date(_0x5335e6[_0x1bb9a3(0x6de)])['toLocaleDateString']() + ']\x20' + _0x3fc00a + _0x1bb9a3(0x660) + _0x5335e6[_0x1bb9a3(0x359)]; })[_0x42779c(0x63b)]('\x0a'); return _0x42779c(0xb1b) + _0x369c89[_0x42779c(0xb15)] + _0x42779c(0x2cb) + _0x4a9119; } function _0x353850() { const _0x118f20 = _0x187760; if ('RFgHK' !== _0x118f20(0x21c)) { const _0x289bab = document[_0x118f20(0x759)](_0x118f20(0x8ab)), _0x29da44 = _0x29b260['preferences'][_0x118f20(0x33b)]; _0x29da44 ? _0x118f20(0xaa7) === _0x118f20(0x216) ? _0x4055dc('错误:\x20' + _0x32c71a[_0x118f20(0x997)]) : (_0x289bab[_0x118f20(0x80f)]['backgroundImage'] = _0x118f20(0x21b) + _0x29da44 + ')', _0x289bab[_0x118f20(0x80f)]['backgroundSize'] = 'cover', _0x289bab['style'][_0x118f20(0x9d5)] = _0x118f20(0x37e), _0x289bab[_0x118f20(0x80f)][_0x118f20(0x39c)] = _0x118f20(0x388), _0x289bab[_0x118f20(0xae0)]('.widget-info\x20>\x20div')[_0x118f20(0xa3d)](_0x3935eb => { const _0x71db0b = _0x118f20; _0x3935eb['style'][_0x71db0b(0x460)] = _0x71db0b(0x542); })) : _0x118f20(0x441) !== _0x118f20(0x374) ? (_0x289bab[_0x118f20(0x80f)][_0x118f20(0xad6)] = '', _0x289bab[_0x118f20(0x80f)]['color'] = '', _0x289bab['querySelectorAll'](_0x118f20(0xa97))[_0x118f20(0xa3d)](_0x5bd9da => { const _0x22b8b3 = _0x118f20; _0x5bd9da[_0x22b8b3(0x80f)]['textShadow'] = ''; })) : _0x3905aa(_0x118f20(0x135)); } else { const _0xa41a1b = _0x30fcd7['querySelector'](_0x118f20(0xa74) + _0x2af554 + _0x118f20(0x50f) + _0x250bc5 + '\x20.app-icon-img')?.[_0x118f20(0x29c)]; _0xa41a1b && (_0x57d4f7[_0x118f20(0x29c)] = _0xa41a1b); } } const _0x1ec346 = document[_0x187760(0x759)](_0x187760(0x326)), _0x19e221 = document['getElementById'](_0x187760(0x609)); _0x1ec346[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x5bae33 = _0x187760; 'gZZTv' === _0x5bae33(0x7a2) ? (_0x370a18(), _0x57a80a(_0x5bae33(0x8c7), _0x5bae33(0x83c))) : !_0x83b35[_0x5bae33(0x969)][_0x5bae33(0x233)](_0x5bae33(0x7f1)) && _0x499d86[_0x5bae33(0x41a)](); }), _0x19e221[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x43b55d = _0x187760; if ('GPRyt' === _0x43b55d(0x1af)) _0x24a12f(), _0x57a80a(_0x43b55d(0x45e), _0x43b55d(0x83c)); else { const _0x1c1983 = _0x4c1fe4[_0x43b55d(0x95f)](_0x18b846, 'readwrite'), _0x3d61fd = _0x1c1983['objectStore'](_0x3676cf), _0x1ff19d = _0x3d61fd[_0x43b55d(0x9a5)](_0x51390a); _0x1ff19d[_0x43b55d(0x5f6)] = () => _0x18244e(), _0x1ff19d[_0x43b55d(0x634)] = () => _0x230d20(_0x1ff19d['error']); } }), document['getElementById'](_0x187760(0xa24))['addEventListener'](_0x187760(0x7ec), () => { const _0x4e61bd = _0x187760; _0x4e61bd(0x367) === 'CAdnH' ? (_0x576fdc(_0x2bc383['id']), _0x15d21c(_0x4e61bd(0x4d5) + _0x287e5d[_0x4e61bd(0xb15)] + _0x4e61bd(0x883)), _0x5d090a(![])) : _0x57a80a('home', _0x4e61bd(0x45e)); }), document[_0x187760(0x759)](_0x187760(0x2b5))[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x5e467e = _0x187760; if (_0x32537a) clearInterval(_0x32537a); _0x32537a = null, _0x29b260[_0x5e467e(0x958)] = [], _0x29b260['activeMeetingCharId'] = null, document['getElementById'](_0x5e467e(0xa15))['style'][_0x5e467e(0x3e7)] = _0x5e467e(0x697), _0x29b260[_0x5e467e(0x7b1)] = null, _0xf10e4a(), _0x57a80a(_0x5e467e(0x45e), _0x5e467e(0x91d)); }); const _0xf33623 = document[_0x187760(0x759)](_0x187760(0x5f0)), _0x505d34 = document['getElementById'](_0x187760(0x13e)); _0x505d34[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x2a4295 = _0x187760, _0x16b01e = _0xf33623[_0x2a4295(0xa03)]['trim'](); if (_0x16b01e) { if (_0x2a4295(0x889) === _0x2a4295(0x8b1)) throw new _0x12d031(_0x2a4295(0x5d7)); else _0x15568f(_0x16b01e), _0xf33623[_0x2a4295(0xa03)] = '', setTimeout(_0x1ae21f, 0x64); } }); function _0x40c32e(_0x1b7cbf, _0x2e72f3) { const _0x5b810c = _0x187760; if (_0x5b810c(0x147) === _0x5b810c(0x147)) { const _0x5d4554 = document['getElementById'](_0x5b810c(0x760)), _0x5a569b = document[_0x5b810c(0xae0)](_0x5b810c(0x6c8)); _0x5a569b[_0x5b810c(0xa3d)](_0x26be7c => { const _0x11bd7e = _0x5b810c; if (_0x11bd7e(0x8ce) !== _0x11bd7e(0x260)) _0x26be7c !== _0x1b7cbf['querySelector'](_0x11bd7e(0x6c8)) && (_0x26be7c[_0x11bd7e(0x574)] = '▶'); else { const _0x13df04 = _0x325361[_0x11bd7e(0x8d5)]('{'), _0x14ae6e = _0x10c271[_0x11bd7e(0x9bf)]('}'); if (_0x13df04 >= 0x0 && _0x14ae6e > _0x13df04) return _0x1c4628['slice'](_0x13df04, _0x14ae6e + 0x1); return _0x8398; } }); if (_0x5d4554['src'] === _0x2e72f3['url'] && !_0x5d4554[_0x5b810c(0x449)]) { if (_0x5b810c(0x48d) !== 'YMwZy') { _0x352ea8[_0x5b810c(0x958)] = [..._0x3cc7fd]; const _0x430676 = _0x2ebc9f[_0x5b810c(0x958)][_0x5b810c(0x620)](); _0x5624e8[_0x5b810c(0x574)] = _0x430676['speaker'] === 'narrator' ? '旁白' : _0x430676[_0x5b810c(0x3c1)], _0x11826a[_0x5b810c(0x574)] = _0x430676[_0x5b810c(0x81d)], _0x430676['speaker'] !== _0x5b810c(0x9b5) && _0x223b94(_0x43efed[_0x5b810c(0x49a)], _0x430676['emotion']); } else _0x5d4554[_0x5b810c(0x153)](), _0x1b7cbf['querySelector'](_0x5b810c(0x6c8))[_0x5b810c(0x574)] = '▶'; } else { if (_0x5b810c(0x588) !== 'gjXeL') { const _0x3fe9b2 = _0x5b810c(0x93a); _0x25d809 = _0x5b810c(0x910) + _0xa79da1[_0x5b810c(0xb15)] + _0x5b810c(0xa17) + _0x3fe9b2 + _0x5b810c(0x8ef) + _0x112444['name'] + '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[' + _0x3fe9b2 + _0x5b810c(0x51e) + _0x3fe9b2 + ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20'; } else _0x5d4554[_0x5b810c(0x686)] = _0x2e72f3[_0x5b810c(0x8b7)], _0x5d4554[_0x5b810c(0x5ca)](), _0x1b7cbf[_0x5b810c(0xa01)](_0x5b810c(0x6c8))['textContent'] = '❚❚'; } } else throw new _0x56e9f7(_0x5b810c(0x825)); } const _0x2790ca = document[_0x187760(0x759)](_0x187760(0x1fb)); async function _0x22be95(_0x4af341) { const _0x5a4027 = _0x187760; if (_0x5a4027(0x8b0) !== 'EtpRT') { if (!_0x4af341 || !_0x4af341[_0x5a4027(0x736)]('http')) return ![]; return new Promise(_0x213fc9 => { const _0x3419b0 = _0x5a4027; if (_0x3419b0(0x8cd) === _0x3419b0(0x473)) _0x25f25e['classList'][_0x3419b0(0x41a)]('active'), _0x17d32e[_0x3419b0(0x969)][_0x3419b0(0x944)]('active'), _0x4b468a(_0x10dba8, _0x3f2f04); else { const _0x5c813d = document[_0x3419b0(0xa93)](_0x3419b0(0x44c)); _0x5c813d[_0x3419b0(0x686)] = _0x4af341; const _0x1b3b49 = setTimeout(() => { _0x3770a6(), _0x213fc9(![]); }, 0xbb8), _0x3770a6 = () => { const _0xf6405b = _0x3419b0; _0xf6405b(0x23a) === 'rsWUa' ? _0x19032f(![]) : (clearTimeout(_0x1b3b49), _0x5c813d[_0xf6405b(0x601)](_0xf6405b(0x673), _0x206029), _0x5c813d[_0xf6405b(0x601)]('error', _0x3e9d90), _0x5c813d['src'] = '', _0x5c813d[_0xf6405b(0x41a)]()); }, _0x206029 = () => { const _0x217e08 = _0x3419b0; if (_0x217e08(0xa33) === _0x217e08(0xa33)) _0x3770a6(), _0x213fc9(!![]); else { if (!_0x4763a3) return; const _0x563111 = _0x15c6b6[_0x217e08(0x49a)], _0x5ce84e = _0x598f33(_0x563111); if (!_0x5ce84e) return; const _0x1a887b = _0x2462b1(_0x496101['getElementById']('sprite-slider-x')[_0x217e08(0xa03)]), _0x2a7f69 = _0x583490(_0x1cef8d[_0x217e08(0x759)]('sprite-slider-y')['value']), _0x3d316b = _0x47e6ad(_0x49fa7d[_0x217e08(0x759)](_0x217e08(0x9de))['value']) / 0x64; _0x5ce84e[_0x217e08(0x433)] = { 'x': _0x1a887b, 'y': _0x2a7f69, 'scale': _0x3d316b }; const _0x36949a = _0x4fa954[_0x217e08(0x759)](_0x217e08(0xaa3)), _0x23b67e = 0x50 * _0x3d316b; _0x36949a[_0x217e08(0x80f)][_0x217e08(0xac8)] = _0x23b67e + '%', _0x36949a[_0x217e08(0x80f)][_0x217e08(0x3fd)] = _0x23b67e + '%', _0x36949a[_0x217e08(0x80f)][_0x217e08(0x927)] = _0x1a887b + '%', _0x36949a[_0x217e08(0x80f)][_0x217e08(0xa28)] = _0x2a7f69 + '%', _0x36949a[_0x217e08(0x80f)][_0x217e08(0x550)] = _0x217e08(0xaa5); } }, _0x3e9d90 = () => { const _0x58b403 = _0x3419b0; if ('UufbV' === 'RzTrV') { const _0x15815d = new _0x10ead6(), _0x47e576 = _0x3a830b['getElementById']('home-time'), _0x10d478 = _0x2afd48[_0x58b403(0x759)](_0x58b403(0xa52)); if (_0x47e576 && _0x10d478) { const _0x15d3b1 = _0x127260(_0x15815d['getHours']())[_0x58b403(0x27e)](0x2, '0'), _0x45568b = _0x27b048(_0x15815d['getMinutes']())[_0x58b403(0x27e)](0x2, '0'); _0x47e576[_0x58b403(0x574)] = _0x15d3b1 + ':' + _0x45568b; const _0x11e411 = _0x15815d[_0x58b403(0x950)]() + 0x1, _0x49293f = _0x15815d['getDate'](), _0x1fd8cc = [_0x58b403(0x1b6), _0x58b403(0x9f9), '星期二', _0x58b403(0x23e), '星期四', _0x58b403(0x36f), '星期六'][_0x15815d['getDay']()]; _0x10d478[_0x58b403(0x574)] = _0x11e411 + '月' + _0x49293f + '日\x20' + _0x1fd8cc; } } else _0x3770a6(), _0x213fc9(![]); }; _0x5c813d[_0x3419b0(0x6cc)]('canplaythrough', _0x206029), _0x5c813d[_0x3419b0(0x6cc)](_0x3419b0(0x297), _0x3e9d90); } }); } else _0x42ddae[_0x5a4027(0x297)](_0x5a4027(0x40b), _0x4ae720); } async function _0x1533cb(_0x516012, _0x243cd2) { const _0x524b2f = _0x187760, _0x19e062 = [_0x524b2f(0x875), _0x524b2f(0xb31)]; for (const _0x5463e6 of _0x19e062) { try { if ('OFSBE' !== 'QJDTO') { const _0x39c174 = _0x524b2f(0x58e) + _0x5463e6 + '?word=' + encodeURIComponent(_0x516012) + '-' + encodeURIComponent(_0x243cd2), _0xae770b = await fetch(_0x39c174), _0x465508 = await _0xae770b['json'](); if (_0x465508['code'] !== 0xc8 || !_0x465508[_0x524b2f(0x2c8)] || _0x465508[_0x524b2f(0x2c8)][_0x524b2f(0x919)] === 0x0) continue; const _0x4ebadb = _0x465508[_0x524b2f(0x2c8)][_0x524b2f(0x1f9)](0x0, 0x5); for (const _0x45652e of _0x4ebadb) { const _0x43e8f8 = _0x524b2f(0x58e) + _0x5463e6 + _0x524b2f(0x17d) + _0x45652e['id'], _0x48cc96 = await fetch(_0x43e8f8), _0x42bc1f = await _0x48cc96[_0x524b2f(0x395)](), _0x2669c3 = _0x42bc1f['data']?.['url']; if (await _0x22be95(_0x2669c3)) { if ('kkitR' === _0x524b2f(0x5ab)) { const _0x3d4d6e = _0x59f558[_0x524b2f(0x1a1)]['find'](_0x397e08 => _0x397e08['id'] === _0x1446c8); _0x3d4d6e && (_0x3d4d6e[_0x524b2f(0xb15)] = _0x6763d9, _0x3d4d6e[_0x524b2f(0x359)] = _0x2b2ded); } else return { 'url': _0x2669c3, 'cover': _0x45652e['cover'], 'source': _0x5463e6 }; } } } else { const _0x3e92da = _0x3b3102[_0x524b2f(0x1db)](_0x10b984); _0x1e031e['isArray'](_0x3e92da) && (_0x3e23a3 = _0x3e92da[_0x524b2f(0x9f6)](_0x2b4839 => _0x2b4839 && typeof _0x2b4839 === _0x524b2f(0x3fb) && typeof _0x2b4839['role'] === _0x524b2f(0x96c) && typeof _0x2b4839[_0x524b2f(0x359)] !== _0x524b2f(0x5fa))); } } catch (_0x2813e4) { console[_0x524b2f(0x297)](_0x524b2f(0x349) + _0x5463e6 + ':', _0x2813e4); } } return { 'url': null, 'cover': null, 'source': null }; } function _0x16b285(_0x18503d) { const _0x5f4920 = _0x187760; if (_0x5f4920(0x38e) !== _0x5f4920(0x38e)) _0x331174 = _0x57d395['name']; else try { const _0x194b0f = JSON[_0x5f4920(0x1db)](localStorage[_0x5f4920(0x860)](_0x5f4920(0x2a1)) || '{}'), _0x310a99 = { ..._0x194b0f, ..._0x18503d }; localStorage[_0x5f4920(0x2f5)]('badgeState', JSON[_0x5f4920(0x2a5)](_0x310a99)); } catch (_0x5dc7b3) { console[_0x5f4920(0x297)](_0x5f4920(0x2e3), _0x5dc7b3); } } async function _0x220e99() { const _0x45cf32 = _0x187760, _0xbd4993 = document[_0x45cf32(0x759)](_0x45cf32(0x8e5)), _0x1a9e70 = document[_0x45cf32(0x759)](_0x45cf32(0x4b3)); try { let _0x15d25f = await _0x2e6c7a(_0x45cf32(0x24f)); if (!_0x15d25f) { const _0x3e4419 = JSON['parse'](localStorage[_0x45cf32(0x860)]('badgeState') || '{}'); _0x3e4419['image'] && (_0x15d25f = await _0xd3e742(_0x3e4419['image']), await _0x5b0aee(_0x45cf32(0x24f), _0x15d25f)); } if (_0x15d25f) _0x1a9e70['src'] = URL[_0x45cf32(0x289)](_0x15d25f), _0x1a9e70[_0x45cf32(0x80f)]['display'] = _0x45cf32(0x210), _0xbd4993[_0x45cf32(0x80f)][_0x45cf32(0xa51)] = 'none'; else { if (_0x45cf32(0x56e) !== _0x45cf32(0x56e)) { const _0x17172c = _0x2c5ef4['createElement']('li'); _0x17172c[_0x45cf32(0x8bd)] = _0x45cf32(0x34c), _0x17172c['dataset']['charId'] = _0x27eea8['id'], _0x17172c['innerHTML'] = _0x45cf32(0x9ab) + (_0x1ff548[_0x45cf32(0x96f)] || _0x2e8cc0) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x9de8a3[_0x45cf32(0xb15)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x17172c['addEventListener'](_0x45cf32(0x7ec), () => { _0x3f8062(_0x46694e['id']); }), _0x17172c[_0x45cf32(0xa01)](_0x45cf32(0x6ff))[_0x45cf32(0x6cc)](_0x45cf32(0x7ec), () => { _0x50ef56(_0x611638['id']); }), _0x17172c[_0x45cf32(0xa01)](_0x45cf32(0x954))['addEventListener']('click', _0x5ba15a => { _0x5ba15a['stopPropagation'](), _0x10c968(_0x452947['id']); }), _0x566c78[_0x45cf32(0x25f)](_0x17172c); } else _0x1a9e70[_0x45cf32(0x80f)][_0x45cf32(0x3e7)] = _0x45cf32(0x697), _0xbd4993['style'][_0x45cf32(0xa51)] = _0x45cf32(0x516); } _0xbd4993[_0x45cf32(0x80f)][_0x45cf32(0x3e7)] = _0x45cf32(0x210); } catch (_0x163307) { if (_0x45cf32(0x3a9) === _0x45cf32(0x3a9)) console[_0x45cf32(0x297)](_0x45cf32(0x364), _0x163307); else for (const _0x4cebbc in _0x371670) { _0x439aad[_0x45cf32(0x80f)][_0x4cebbc] = _0x5112c5[_0x4cebbc]; } } } async function _0x56e4d7() { const _0x333b50 = _0x187760, _0x4536fc = document['getElementById'](_0x333b50(0x2c9)), _0x3e5de6 = document[_0x333b50(0x759)]('card-image'), _0x5745aa = document[_0x333b50(0x759)]('card-widget-2'), _0x313011 = document['getElementById'](_0x333b50(0x452)); try { let _0x1dd2c8 = await _0x2e6c7a(_0x333b50(0x7dd)); if (_0x1dd2c8) _0x3e5de6['src'] = URL[_0x333b50(0x289)](_0x1dd2c8), _0x3e5de6[_0x333b50(0x80f)][_0x333b50(0x3e7)] = _0x333b50(0x210), _0x4536fc[_0x333b50(0x80f)][_0x333b50(0xa51)] = _0x333b50(0x697), _0x4536fc[_0x333b50(0x80f)][_0x333b50(0x56d)] = _0x333b50(0x19c); else { if (_0x333b50(0x9a3) !== _0x333b50(0x3cd)) _0x3e5de6[_0x333b50(0x80f)][_0x333b50(0x3e7)] = _0x333b50(0x697), _0x4536fc[_0x333b50(0x80f)][_0x333b50(0xa51)] = _0x333b50(0x516), _0x4536fc['style'][_0x333b50(0x56d)] = _0x333b50(0xa9c); else { const _0x5a99d4 = _0x5f45c5['linkedWorldBookIds'][_0x333b50(0xa96)](_0x11889b => _0x37780a[_0x333b50(0x1a1)][_0x333b50(0x444)](_0xe3735e => _0xe3735e['id'] === _0x11889b))[_0x333b50(0x9f6)](_0x397584)[_0x333b50(0xa96)](_0xdaab91 => _0x333b50(0x18e) + _0xdaab91[_0x333b50(0xb15)] + '\x0a' + _0xdaab91[_0x333b50(0x359)])['join'](''); if (_0x5a99d4) _0x28099f = '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a' + _0x5a99d4; } } _0x4536fc['style'][_0x333b50(0x3e7)] = _0x333b50(0x210); let _0x8cb0d9 = await _0x2e6c7a(_0x333b50(0xa60)); _0x8cb0d9 ? (_0x313011['src'] = URL[_0x333b50(0x289)](_0x8cb0d9), _0x313011[_0x333b50(0x80f)][_0x333b50(0x3e7)] = _0x333b50(0x210), _0x5745aa[_0x333b50(0x80f)][_0x333b50(0xa51)] = _0x333b50(0x697), _0x5745aa['style'][_0x333b50(0x56d)] = _0x333b50(0x19c)) : (_0x313011[_0x333b50(0x80f)][_0x333b50(0x3e7)] = _0x333b50(0x697), _0x5745aa[_0x333b50(0x80f)][_0x333b50(0xa51)] = _0x333b50(0x516), _0x5745aa[_0x333b50(0x80f)][_0x333b50(0x56d)] = 'rgba(255,255,255,0.2)'), _0x5745aa['style'][_0x333b50(0x3e7)] = _0x333b50(0x210); } catch (_0x548a69) { console['error'](_0x333b50(0x935), _0x548a69); } } async function _0x56e4d7() { const _0x599cf6 = _0x187760, _0x1c1809 = document[_0x599cf6(0x759)](_0x599cf6(0x2c9)), _0x3f5975 = document[_0x599cf6(0x759)](_0x599cf6(0x346)); try { let _0x4e9d21 = await _0x2e6c7a('widget_card'); if (!_0x4e9d21) { const _0x1e0690 = JSON['parse'](localStorage[_0x599cf6(0x860)](_0x599cf6(0x2c3)) || '{}'); _0x1e0690['image'] && (_0x599cf6(0x528) !== 'JIVLF' ? (_0x57d81c[_0x599cf6(0x297)](_0x599cf6(0x743), _0x1aeca0), _0x4ba614 = _0x1f78d1) : (console[_0x599cf6(0xa05)](_0x599cf6(0x4c1)), _0x4e9d21 = await _0xd3e742(_0x1e0690['image']), await _0x5b0aee(_0x599cf6(0x7dd), _0x4e9d21))); } _0x4e9d21 ? (_0x3f5975[_0x599cf6(0x686)] = URL['createObjectURL'](_0x4e9d21), _0x1c1809[_0x599cf6(0x80f)][_0x599cf6(0x3e7)] = _0x599cf6(0x210)) : _0x1c1809['style'][_0x599cf6(0x3e7)] = _0x599cf6(0x697); } catch (_0x20d594) { console['error']('加载卡片图片失败', _0x20d594); } try { let _0x3e7631 = await _0x2e6c7a('widget_card_2'); const _0x616c10 = document[_0x599cf6(0x759)](_0x599cf6(0x452)), _0xb1e6b7 = document[_0x599cf6(0x759)](_0x599cf6(0x9e7)); _0x3e7631 ? _0x599cf6(0x519) === 'GXGEi' ? (_0x5034c1[_0x599cf6(0x80f)][_0x599cf6(0x3e7)] = _0x599cf6(0x697), _0x34ee32['style'][_0x599cf6(0xa51)] = _0x599cf6(0x516)) : (_0x616c10[_0x599cf6(0x686)] = URL['createObjectURL'](_0x3e7631), _0xb1e6b7[_0x599cf6(0x80f)]['display'] = _0x599cf6(0x210)) : _0xb1e6b7[_0x599cf6(0x80f)][_0x599cf6(0x3e7)] = _0x599cf6(0x697); } catch (_0x55ce4e) { console[_0x599cf6(0x297)]('加载第二个卡片图片失败', _0x55ce4e); } } _0x467ce2[_0x187760(0x6cc)]('click', () => { const _0x37a002 = _0x187760; if (_0x37a002(0x522) === _0x37a002(0x140)) { _0x1d6474['value'] = '', _0x14e1db[_0x37a002(0x29c)] = ''; if (_0x26f515[_0x37a002(0x3db)][_0x37a002(0x919)] < 0x2) { _0x9e6287(_0x37a002(0x11c)); return; } _0xe6d24c[_0x37a002(0x3db)]['forEach'](_0xf95003 => { const _0x4ba7a5 = _0x37a002, _0xdf34e4 = _0x56b121['createElement']('li'); _0xdf34e4[_0x4ba7a5(0x8bd)] = 'member-selection-item', _0xdf34e4['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-' + _0xf95003['id'] + _0x4ba7a5(0x6bc) + _0xf95003['id'] + _0x4ba7a5(0x4df) + (_0xf95003[_0x4ba7a5(0x96f)] || _0x58fb2b) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-' + _0xf95003['id'] + _0x4ba7a5(0x8c1) + _0xf95003[_0x4ba7a5(0xb15)] + '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x3c5c8b['appendChild'](_0xdf34e4); }), _0x3df2ad(_0x37a002(0xa94), 'charSelect'); } else _0x29a8f0(), _0x57a80a(_0x37a002(0x94a), _0x37a002(0x83c)); }), document[_0x187760(0x759)](_0x187760(0x95b))[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x57a80a(_0x187760(0x83c), _0x187760(0x94a))), document[_0x187760(0x759)](_0x187760(0x22d))[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x1f1f69()), document['getElementById'](_0x187760(0x290))[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x4bf057 = _0x187760; _0x4bf057(0x8fd) === _0x4bf057(0x548) ? _0x360adc = _0x2158be[_0x4bf057(0x860)](_0x4bf057(0x392)) : (_0x29a8f0(), _0x57a80a('userProfileList', _0x4bf057(0xa77))); }), document[_0x187760(0x759)](_0x187760(0x249))[_0x187760(0x6cc)]('click', _0x44caf7), document[_0x187760(0x759)](_0x187760(0x9fc))['addEventListener'](_0x187760(0x7ec), _0x160a79), document[_0x187760(0x759)](_0x187760(0x32e))[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0xe2f279 = _0x187760, _0x2c53d7 = document[_0xe2f279(0x759)](_0xe2f279(0x815))[_0xe2f279(0xa03)]; if (_0x2c53d7) { if (_0xe2f279(0x598) === _0xe2f279(0x579)) { const _0x532005 = _0x523d1b(); _0x532005 && _0x532005[_0xe2f279(0x9e8)] && _0x532005[_0xe2f279(0x9e8)][_0xe2f279(0x705)] && (_0x48b597[_0xe2f279(0x80f)][_0xe2f279(0x3e7)] = _0xe2f279(0x868), _0x374b05(() => _0x2dbbaf[_0xe2f279(0x969)][_0xe2f279(0x944)]('show'), 0xa)); } else _0x29b260[_0xe2f279(0x113)] = _0x2c53d7, _0xf10e4a(), _0xeba69d('已设为当前用户！'), _0x29a8f0(), document[_0xe2f279(0x759)](_0xe2f279(0x32e))[_0xe2f279(0x80f)][_0xe2f279(0x3e7)] = _0xe2f279(0x697); } }); function _0x33ec75(_0x269419) { const _0x2030e0 = _0x187760, _0x400570 = _0x29b260[_0x2030e0(0x6df)]['find'](_0x34a6b8 => _0x34a6b8['id'] === _0x269419), _0x434b60 = _0x400570?.[_0x2030e0(0x515)]; let _0x43faf8 = _0x29b260[_0x2030e0(0x44f)]['find'](_0x4ea602 => _0x4ea602['id'] === _0x434b60); return !_0x43faf8 && (_0x43faf8 = _0x29b260[_0x2030e0(0x44f)][_0x2030e0(0x444)](_0x17d5d7 => _0x17d5d7['id'] === _0x29b260[_0x2030e0(0x113)]) || _0x29b260[_0x2030e0(0x44f)][0x0]), _0x43faf8 || { 'name': '用户', 'avatar': _0x2f94f8, 'persona': '' }; } function _0x4790b6(_0x20fd9b) { const _0x4faa6f = _0x187760, _0x2ef8cd = document[_0x4faa6f(0x759)](_0x20fd9b); _0x2ef8cd[_0x4faa6f(0x29c)] = '', _0x29b260[_0x4faa6f(0x44f)][_0x4faa6f(0xa3d)](_0x4949fa => { const _0x4ebbb5 = _0x4faa6f, _0xff9129 = document[_0x4ebbb5(0xa93)](_0x4ebbb5(0x407)); _0xff9129[_0x4ebbb5(0xa03)] = _0x4949fa['id'], _0xff9129[_0x4ebbb5(0x574)] = _0x4949fa[_0x4ebbb5(0xb15)], _0x2ef8cd[_0x4ebbb5(0x25f)](_0xff9129); }); } function _0x30225b(_0x234c20) { const _0x3dab47 = _0x187760, _0x204034 = _0x4cc875(_0x234c20), _0x4148cc = document['getElementById'](_0x3dab47(0x719)); _0x4148cc[_0x3dab47(0x80f)][_0x3dab47(0xad6)] = ''; let _0x9c3a68 = document[_0x3dab47(0x759)]('style-' + _0x234c20); if (_0x9c3a68) _0x9c3a68[_0x3dab47(0x29c)] = ''; if (!_0x204034) return; _0x204034[_0x3dab47(0x76a)] && (_0x3dab47(0x2cd) !== _0x3dab47(0x2cd) ? (_0x340571[_0x3dab47(0x686)] = _0x4a8fce[_0x3dab47(0x289)](_0x12a8bc), _0x4e4924[_0x3dab47(0x80f)]['display'] = _0x3dab47(0x210), _0x24e8c8[_0x3dab47(0x80f)][_0x3dab47(0xa51)] = _0x3dab47(0x697), _0x2961d0[_0x3dab47(0x80f)][_0x3dab47(0x56d)] = 'transparent') : (_0x4148cc[_0x3dab47(0x80f)]['backgroundImage'] = _0x3dab47(0x22e) + _0x204034[_0x3dab47(0x76a)] + '\x27)', _0x4148cc[_0x3dab47(0x80f)][_0x3dab47(0xb0d)] = 'cover', _0x4148cc[_0x3dab47(0x80f)][_0x3dab47(0x9d5)] = 'center')); if (_0x204034['bubbleCss']) { if (_0x3dab47(0x664) === _0x3dab47(0x843)) { _0x172715[_0x3dab47(0x29c)] = _0x3dab47(0x9a1), _0x2be056[_0x3dab47(0x29c)] = ''; return; } else { let _0x16b304 = document['getElementById'](_0x3dab47(0x82c) + _0x204034['id']); !_0x16b304 && (_0x3dab47(0x5eb) !== _0x3dab47(0x5eb) ? _0x49d615() : (_0x16b304 = document[_0x3dab47(0xa93)]('style'), _0x16b304['id'] = _0x3dab47(0x82c) + _0x204034['id'], document[_0x3dab47(0x7c9)]['appendChild'](_0x16b304))); const _0x3135fe = _0x204034[_0x3dab47(0xa5e)], _0x2b7e84 = _0x3135fe[_0x3dab47(0x998)](/\.bubble\.sent/g, '.bubble-' + _0x204034['id'] + '.message.user')['replace'](/\.bubble\.received/g, _0x3dab47(0x987) + _0x204034['id'] + _0x3dab47(0x2ff)); _0x16b304[_0x3dab47(0x29c)] = _0x2b7e84; } } } function _0x11c503() { const _0x27bc80 = _0x187760; if (_0x27bc80(0x93b) === 'ZHIbu') _0x564950 = '0x' + _0xcad39[0x1] + _0x1abd6a[0x2], _0x5a3d14 = '0x' + _0x1c3326[0x3] + _0x4b93ab[0x4], _0x4ef5c8 = '0x' + _0x51704c[0x5] + _0x3bbf05[0x6]; else { const _0x2890c0 = document['getElementById']('user-post-attachment-preview'); _0x2890c0[_0x27bc80(0x29c)] = ''; const _0x4ff268 = _0x5aff80 => { const _0x20cd2b = _0x27bc80; _0x29b260[_0x20cd2b(0x366)][_0x5aff80] = null; if (_0x5aff80 === _0x20cd2b(0x7ee)) _0x29b260[_0x20cd2b(0x366)][_0x20cd2b(0x1bd)] = null; _0x11c503(); }, _0x3020f1 = _0x29b260[_0x27bc80(0x366)]['imageId'], _0x33dfa5 = _0x29b260[_0x27bc80(0x366)]['music']; if (_0x3020f1) { const _0x1b0cab = document[_0x27bc80(0xa93)]('div'); _0x1b0cab['className'] = _0x27bc80(0xaa6), _0x1b0cab[_0x27bc80(0x29c)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x1b0cab[_0x27bc80(0xa01)]('.remove-attachment-btn')[_0x27bc80(0x356)] = () => _0x4ff268(_0x27bc80(0x7ee)), _0x2890c0['appendChild'](_0x1b0cab), _0x2e6c7a(_0x3020f1)['then'](_0x5655d4 => { const _0x374c9b = _0x27bc80, _0x3863dc = document[_0x374c9b(0x759)](_0x374c9b(0x2cf)); _0x3863dc && _0x5655d4 && (_0x3863dc['src'] = URL[_0x374c9b(0x289)](_0x5655d4)); }); } if (_0x33dfa5) { const _0xced9a8 = document[_0x27bc80(0xa93)](_0x27bc80(0x64e)); _0xced9a8[_0x27bc80(0x8bd)] = _0x27bc80(0xaa6), _0xced9a8[_0x27bc80(0x29c)] = _0x27bc80(0x3e0) + (_0x33dfa5['coverUrl'] || _0x461596) + _0x27bc80(0x1bb) + _0x33dfa5[_0x27bc80(0x5ee)] + _0x27bc80(0x9e1) + _0x33dfa5[_0x27bc80(0x6cd)] + _0x27bc80(0x4f4), _0xced9a8[_0x27bc80(0xa01)](_0x27bc80(0xae3))[_0x27bc80(0x356)] = () => _0x4ff268(_0x27bc80(0xa7c)), _0x2890c0[_0x27bc80(0x25f)](_0xced9a8); } } } async function _0x4f49dd(_0xbdc4ca) { const _0x4c7d19 = _0x187760, _0xe7e17e = _0x29b260[_0x4c7d19(0x123)]['find'](_0x26243c => _0x26243c['id'] === _0x29b260[_0x4c7d19(0x439)]); if (!_0xe7e17e) return; _0x195491(!![], '大家正在赶来回复...'), _0x29b260[_0x4c7d19(0x27c)] = !![]; try { const _0x5dfb76 = _0xe7e17e[_0x4c7d19(0x9a8)][_0x4c7d19(0xa96)](_0x171cfe => _0x4cc875(_0x171cfe))[_0x4c7d19(0x9f6)](Boolean), _0x83e603 = _0x51a4ba(), _0x1824e9 = _0x5dfb76[_0x4c7d19(0xa96)](_0x3aefa3 => { const _0xa0f2de = _0x4c7d19, { omniText: _0x19664b } = _0x2eac37(_0x3aefa3['id'], null), _0x4115b5 = _0x4312af(_0x3aefa3['id']), _0x247fd4 = _0x3aefa3[_0xa0f2de(0x5c0)] && _0x3aefa3[_0xa0f2de(0x5c0)]['length'] > 0x0 ? _0xa0f2de(0x662) + _0x3aefa3[_0xa0f2de(0xb15)] + _0xa0f2de(0x4be) + _0x3aefa3[_0xa0f2de(0x5c0)][_0xa0f2de(0xa96)](_0x16553b => _0x29b260[_0xa0f2de(0x1a1)][_0xa0f2de(0x444)](_0x3e32e5 => _0x3e32e5['id'] === _0x16553b))['filter'](Boolean)['map'](_0x724675 => '\x0a##\x20条目:\x20' + _0x724675['name'] + '\x0a' + _0x724675[_0xa0f2de(0x359)])[_0xa0f2de(0x63b)]('') : ''; return _0xa0f2de(0x720) + _0x3aefa3['name'] + _0xa0f2de(0x83a) + _0x3aefa3['id'] + _0xa0f2de(0x57d) + _0x3aefa3[_0xa0f2de(0x435)] + '\x0a\x20\x20相关记忆:\x0a' + _0x19664b + '\x0a' + _0x4115b5 + '\x0a' + _0x247fd4; })[_0x4c7d19(0x63b)]('\x0a\x0a'), _0x57e0ad = _0x439911(_0xbdc4ca[_0x4c7d19(0xb04)]) || { 'name': '用户' }, _0x42637b = _0x57e0ad[_0x4c7d19(0x435)] ? _0x4c7d19(0x939) + _0x57e0ad[_0x4c7d19(0xb15)] + '\x0a-\x20人设:\x20' + _0x57e0ad[_0x4c7d19(0x435)] + '\x0a' : ''; let _0x356294 = null; if (_0xbdc4ca['image']) _0x356294 = _0xbdc4ca[_0x4c7d19(0x7ee)]; else { if (_0xbdc4ca['imageId']) { if (_0x4c7d19(0xa90) === _0x4c7d19(0x486)) _0x405bd0 = _0x4c7d19(0xb19) + _0x430342['id'] + _0x4c7d19(0x24a) + (_0x5afcb2[_0x4c7d19(0x8ff)] || _0x49e37e) + _0x4c7d19(0x45f) + _0xd1e9dc['songName'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x46805f[_0x4c7d19(0x6cd)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>' + (_0x3b3e5b['playableUrl'] ? '▶' : '⚠') + _0x4c7d19(0x628); else try { const _0x4d9a23 = await _0x2e6c7a(_0xbdc4ca[_0x4c7d19(0x1bd)]); if (_0x4d9a23) { if ('Zunln' === _0x4c7d19(0x7c3)) _0x356294 = await _0x13346a(_0x4d9a23); else { const _0xbca5eb = _0xfafcb6['parse'](_0x3887fd[_0x4c7d19(0x860)]('badgeState') || '{}'), _0x5d41b9 = { ..._0xbca5eb, ..._0x47ecdc }; _0x565028[_0x4c7d19(0x2f5)](_0x4c7d19(0x2a1), _0x397ead['stringify'](_0x5d41b9)); } } } catch (_0x5d6bec) { 'uOVUi' !== _0x4c7d19(0x8a5) ? console[_0x4c7d19(0x297)](_0x4c7d19(0x5a3), _0x5d6bec) : _0x54e07c = _0x42e58c[_0x4c7d19(0x6b5)] || ''; } } } let _0x402b08 = _0x57e0ad[_0x4c7d19(0xb15)] + _0x4c7d19(0x3d0) + _0xbdc4ca['content'] + '”'; _0x356294 && (_0x4c7d19(0xae5) !== _0x4c7d19(0x916) ? _0x402b08 += _0x4c7d19(0x3eb) : (_0x3593ab['preventDefault'](), _0x82820d())); _0xbdc4ca[_0x4c7d19(0x713)] === 'music' && (_0x4c7d19(0x61d) !== _0x4c7d19(0xaeb) ? _0x402b08 += _0x4c7d19(0x28b) + _0xbdc4ca[_0x4c7d19(0x5ee)] + _0x4c7d19(0x84c) + _0xbdc4ca[_0x4c7d19(0x6cd)] + ']' : _0x229624[_0x4c7d19(0x4ce)](_0x410df6)); const _0x1b2198 = _0x4c7d19(0xa02) + _0x1824e9 + '\x0a\x0a' + _0x42637b + _0x4c7d19(0x4f9) + _0x83e603 + _0x4c7d19(0x25d) + _0x402b08 + '\x0a\x0a#\x20任务要求\x0a1.\x20\x20**全局视角**:\x20扮演所有成员，思考他们看到这条动态（包括图片）后会作何反应。\x0a2.\x20\x20**生成互动**:\x20为每个角色决定是否点赞，以及要发表什么评论。评论必须符合角色性格并与所有已知信息（聊天、日记等）相关联。\x0a3.\x20\x20**输出格式**:\x20你的输出必须是一个单一、完整的JSON对象，结构如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a-\x20【绝对规则】:\x20所有ID必须使用上面提供的角色ID，不能用名字。\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。\x0a', _0x3d9e56 = [{ 'role': _0x4c7d19(0x4c2), 'content': _0x1b2198 }], _0x1654f2 = { 'role': _0x4c7d19(0x544), 'content': _0x4c7d19(0x19b) }; _0x356294 && (_0x1654f2['image'] = _0x356294); _0x3d9e56[_0x4c7d19(0x438)](_0x1654f2); const _0x5a3366 = await _0x315051(_0x3d9e56, { 'json': !![] }), _0x4098d2 = _0x5a3366[_0x4c7d19(0x6d2)](/({[\s\S]*})/); if (!_0x4098d2) throw new Error(_0x4c7d19(0x26f)); const _0x2b7c2d = JSON['parse'](_0x4098d2[0x1]), _0x42faaa = _0xe7e17e[_0x4c7d19(0x9ce)][_0x4c7d19(0x444)](_0x14b30b => _0x14b30b['id'] === _0xbdc4ca['id']); if (_0x42faaa) { if (_0x4c7d19(0x7d2) === _0x4c7d19(0x1f8)) { const _0x47176e = _0x57b039[_0x4c7d19(0x860)](_0x4c7d19(0x414)); if (_0x47176e) { const { playlist: _0x11095e, currentIndex: _0x5780a7 } = _0x3904f1[_0x4c7d19(0x1db)](_0x47176e); _0x29b8bf['isArray'](_0x11095e) && _0x11095e[_0x4c7d19(0x919)] > 0x0 && _0x5780a7 > -0x1 && (_0x5e87cc[_0x4c7d19(0x92e)] = _0x11095e, _0x5898d5[_0x4c7d19(0x463)] = _0x5780a7, _0x3a55db[_0x4c7d19(0x5a7)] = ![], _0x38c256()); } } else _0x42faaa[_0x4c7d19(0x861)] = _0x2b7c2d['likes'] || [], _0x42faaa[_0x4c7d19(0x566)] = (_0x2b7c2d[_0x4c7d19(0x566)] || [])[_0x4c7d19(0xa96)]((_0x1da28d, _0x42db57) => ({ ..._0x1da28d, 'commentId': 'c_' + _0xbdc4ca[_0x4c7d19(0x6de)] + '_' + _0x42db57 })), _0xf10e4a(), _0x547b5f(); } } catch (_0x58b07c) { console[_0x4c7d19(0x297)](_0x4c7d19(0xac5), _0x58b07c), _0xeba69d(_0x4c7d19(0x229)); } finally { _0x4c7d19(0x929) === _0x4c7d19(0xa42) ? _0xd7bf8d[_0x4c7d19(0x438)]({ 'time': _0x3b6487, 'text': _0x186b16 }) : (_0x195491(![]), _0x29b260[_0x4c7d19(0x27c)] = ![]); } } function _0x4d8f71() { const _0x5cadbd = _0x187760; if (_0x5cadbd(0x984) === 'HDMWd') _0x37d0f7[_0x5cadbd(0x80f)][_0x5cadbd(0x3e7)] = _0x5cadbd(0x697), _0xbc492d[_0x5cadbd(0x80f)][_0x5cadbd(0xa51)] = _0x5cadbd(0x516), _0x3b6575[_0x5cadbd(0x80f)][_0x5cadbd(0x56d)] = _0x5cadbd(0xa9c); else { const _0x38cb86 = _0x29b260[_0x5cadbd(0x123)][_0x5cadbd(0x444)](_0x2408bf => _0x2408bf['id'] === _0x29b260['activeFriendCircleId']), _0xdf4120 = _0x38cb86?.[_0x5cadbd(0x515)]; let _0xd1e8ec = _0x29b260[_0x5cadbd(0x44f)][_0x5cadbd(0x444)](_0x57d130 => _0x57d130['id'] === _0xdf4120); !_0xd1e8ec && (_0x5cadbd(0x447) === 'wvJco' ? _0xd1e8ec = _0x29b260[_0x5cadbd(0x44f)][_0x5cadbd(0x444)](_0x4b62fb => _0x4b62fb['id'] === _0x29b260[_0x5cadbd(0x113)]) : _0x3e680c[_0x5cadbd(0x297)](_0x5cadbd(0x6e2) + _0x5314ff['id'] + _0x5cadbd(0x262), _0x43fea5)), !_0xd1e8ec && (_0xd1e8ec = _0x29b260[_0x5cadbd(0x44f)][0x0]), _0xd1e8ec && ('QyeiQ' === _0x5cadbd(0x46b) ? document[_0x5cadbd(0x759)](_0x5cadbd(0x9ff))[_0x5cadbd(0x686)] = _0xd1e8ec['avatar'] || _0x2f94f8 : (_0x266c14[_0x5cadbd(0x80f)]['display'] = _0x5cadbd(0x210), _0x17327e[_0x5cadbd(0x80f)]['display'] = 'none')); } } function _0x5c2ad0(_0x481aea) { const _0xc698af = _0x187760; if (_0xc698af(0x1d8) === 'ryEYc') { let _0x5c8453 = 0x0, _0x53a008 = 0x0, _0x9441a7 = 0x0; if (_0x481aea[_0xc698af(0x919)] == 0x4) _0xc698af(0x83b) !== 'PRHcC' ? (_0xa5b61d[_0xc698af(0x4d2)](_0xc698af(0x4a9) + _0x3d823a['id']), _0x1ddc30('群聊\x22' + _0x124ec5['name'] + _0xc698af(0x190))) : (_0x5c8453 = '0x' + _0x481aea[0x1] + _0x481aea[0x1], _0x53a008 = '0x' + _0x481aea[0x2] + _0x481aea[0x2], _0x9441a7 = '0x' + _0x481aea[0x3] + _0x481aea[0x3]); else _0x481aea[_0xc698af(0x919)] == 0x7 && (_0x5c8453 = '0x' + _0x481aea[0x1] + _0x481aea[0x2], _0x53a008 = '0x' + _0x481aea[0x3] + _0x481aea[0x4], _0x9441a7 = '0x' + _0x481aea[0x5] + _0x481aea[0x6]); _0x5c8453 /= 0xff, _0x53a008 /= 0xff, _0x9441a7 /= 0xff; let _0x7c1163 = Math[_0xc698af(0x244)](_0x5c8453, _0x53a008, _0x9441a7), _0x57334a = Math[_0xc698af(0x355)](_0x5c8453, _0x53a008, _0x9441a7), _0x4f3585 = _0x57334a - _0x7c1163, _0x532dde = 0x0, _0x359eb8 = 0x0, _0x285172 = 0x0; if (_0x4f3585 == 0x0) _0x532dde = 0x0; else { if (_0x57334a == _0x5c8453) _0x532dde = (_0x53a008 - _0x9441a7) / _0x4f3585 % 0x6; else { if (_0x57334a == _0x53a008) _0x532dde = (_0x9441a7 - _0x5c8453) / _0x4f3585 + 0x2; else _0x532dde = (_0x5c8453 - _0x53a008) / _0x4f3585 + 0x4; } } _0x532dde = Math[_0xc698af(0x6f8)](_0x532dde * 0x3c); if (_0x532dde < 0x0) _0x532dde += 0x168; return _0x285172 = (_0x57334a + _0x7c1163) / 0x2, _0x359eb8 = _0x4f3585 == 0x0 ? 0x0 : _0x4f3585 / (0x1 - Math['abs'](0x2 * _0x285172 - 0x1)), _0x359eb8 = +(_0x359eb8 * 0x64)[_0xc698af(0x394)](0x1), _0x285172 = +(_0x285172 * 0x64)[_0xc698af(0x394)](0x1), { 'h': _0x532dde, 's': _0x359eb8, 'l': _0x285172 }; } else { if (_0x31b6b3) _0x503e1c[_0xc698af(0x574)] = '▶'; } } function _0x21dd0a() { const _0x44be63 = _0x187760, _0x3a7e97 = (_0x786e82, _0x1ce648, _0x4f202f) => { const _0x19f482 = _0x18ce; if ('pRlpt' !== _0x19f482(0xad2)) _0x93a033(_0x19f482(0x295)); else { const _0x5e9dc7 = document[_0x19f482(0x759)](_0x786e82); if (!_0x5e9dc7) return; let _0x430e9e = null; try { _0x430e9e = JSON[_0x19f482(0x1db)](localStorage[_0x19f482(0x860)](_0x1ce648) || '{}'); } catch { _0x430e9e = {}; } _0x5e9dc7['style'][_0x19f482(0x16c)] = 'absolute', _0x5e9dc7['style']['top'] = '', _0x5e9dc7[_0x19f482(0x80f)]['left'] = '', _0x5e9dc7[_0x19f482(0x80f)][_0x19f482(0x76c)] = '', _0x5e9dc7[_0x19f482(0x80f)][_0x19f482(0x417)] = '', _0x5e9dc7[_0x19f482(0x80f)][_0x19f482(0x550)] = ''; if (typeof _0x430e9e[_0x19f482(0xa28)] === _0x19f482(0x676) && typeof _0x430e9e[_0x19f482(0x927)] === _0x19f482(0x676)) _0x5e9dc7[_0x19f482(0x80f)]['top'] = _0x430e9e['top'] + '%', _0x5e9dc7[_0x19f482(0x80f)][_0x19f482(0x927)] = _0x430e9e[_0x19f482(0x927)] + '%'; else for (const _0x1a4e7d in _0x4f202f) { _0x5e9dc7[_0x19f482(0x80f)][_0x1a4e7d] = _0x4f202f[_0x1a4e7d]; } } }; _0x3a7e97(_0x44be63(0x16f), _0x44be63(0x80a), { 'top': '15%', 'left': '50%', 'transform': 'translateX(-50%)' }), _0x3a7e97(_0x44be63(0x714), _0x44be63(0x4b7), { 'top': _0x44be63(0x3d5), 'right': '4%' }), _0x3a7e97(_0x44be63(0x5d6), _0x44be63(0x18c), { 'top': _0x44be63(0x3d5), 'right': '28%' }), _0x3a7e97('app-settings', _0x44be63(0x688), { 'top': '8%', 'right': _0x44be63(0x874) }), _0x3a7e97(_0x44be63(0x698), 'appIconPosition_app-world-book', { 'top': '8%', 'right': '4%' }), _0x3a7e97(_0x44be63(0x8ac), _0x44be63(0x4e5), { 'top': _0x44be63(0x7e1), 'left': '5%' }), _0x3a7e97(_0x44be63(0xaba), 'appIconPosition_app-diary', { 'top': _0x44be63(0x4f3), 'left': _0x44be63(0x63d) }), _0x3a7e97(_0x44be63(0x12b), _0x44be63(0xa84), { 'top': _0x44be63(0x4f3), 'left': '5%' }), _0x3a7e97(_0x44be63(0x888), 'appIconPosition_app-accounting', { 'top': _0x44be63(0x7e1), 'left': '29%' }), _0x3a7e97(_0x44be63(0x8e5), _0x44be63(0x2a1), { 'top': _0x44be63(0x785), 'right': '5%' }), _0x3a7e97(_0x44be63(0x9e7), _0x44be63(0x81c), { 'top': '8%', 'left': '5%' }); const _0x72853e = document[_0x44be63(0x759)](_0x44be63(0x2c9)); _0x72853e && (_0x72853e[_0x44be63(0x80f)][_0x44be63(0x16c)] = 'absolute', _0x72853e[_0x44be63(0x80f)][_0x44be63(0xa28)] = _0x44be63(0x186), _0x72853e[_0x44be63(0x80f)][_0x44be63(0x927)] = _0x44be63(0x612), _0x72853e[_0x44be63(0x80f)][_0x44be63(0x550)] = _0x44be63(0xa4c), _0x72853e[_0x44be63(0x80f)][_0x44be63(0x3e7)] = _0x44be63(0x210)); const _0x578a5f = document['getElementById'](_0x44be63(0x1ed)); _0x578a5f && (_0x578a5f['style']['position'] = _0x44be63(0x7a8), _0x578a5f[_0x44be63(0x80f)]['top'] = _0x44be63(0x170), _0x578a5f['style'][_0x44be63(0x927)] = _0x44be63(0x612), _0x578a5f[_0x44be63(0x80f)][_0x44be63(0x550)] = _0x44be63(0xa4c), _0x578a5f[_0x44be63(0x80f)][_0x44be63(0x3e7)] = _0x44be63(0x47b)); } function _0xf56761() { const _0x23b977 = _0x187760; if (_0x23b977(0x968) !== 'Kdwav') _0x587c56(!![]); else { const _0x3b334d = document[_0x23b977(0x759)](_0x23b977(0x354)); _0x3b334d[_0x23b977(0x29c)] = ''; const _0x466e07 = document['querySelectorAll']('.app-icon'); _0x466e07['forEach'](_0x4af2eb => { const _0x1aef86 = _0x23b977, _0x3b4ace = _0x4af2eb['id'], _0xfe2e76 = _0x4af2eb['querySelector'](_0x1aef86(0x9f0))[_0x1aef86(0x574)], _0xbd8dec = _0x1aef86(0x161) + _0x3b4ace, _0x5774da = localStorage[_0x1aef86(0x860)](_0xbd8dec), _0x171fbd = document[_0x1aef86(0xa93)]('div'); _0x171fbd[_0x1aef86(0x8bd)] = _0x1aef86(0x98f), _0x171fbd['style'][_0x1aef86(0x86e)] = _0x1aef86(0x389), _0x171fbd[_0x1aef86(0x29c)] = _0x1aef86(0x405) + _0x3b4ace + _0x1aef86(0x5ba) + (_0x5774da || _0x1aef86(0x410)) + '\x22\x20class=\x22char-avatar\x22\x20style=\x22border-radius:\x2012px;\x20background-color:\x20#eee;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22flex-grow:\x201;\x22>' + _0xfe2e76 + _0x1aef86(0x775) + _0x3b4ace + _0x1aef86(0x561) + _0x3b4ace + _0x1aef86(0x4de) + _0xbd8dec + '\x27);\x20location.reload();\x22>恢复</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x3b334d[_0x1aef86(0x25f)](_0x171fbd); const _0x3f7a90 = document['getElementById']('input_' + _0x3b4ace); _0x3f7a90[_0x1aef86(0x6cc)](_0x1aef86(0x3c6), async _0x8e7afe => { const _0x1200bb = _0x1aef86, _0x5554a5 = _0x8e7afe[_0x1200bb(0x65e)][_0x1200bb(0x523)][0x0]; if (!_0x5554a5) return; try { const _0x144cf7 = await _0x8ff8c6(_0x5554a5); localStorage[_0x1200bb(0x2f5)](_0xbd8dec, _0x144cf7), document[_0x1200bb(0x759)](_0x1200bb(0x56b) + _0x3b4ace)[_0x1200bb(0x686)] = _0x144cf7, _0x467f30(); } catch (_0x14281b) { _0xeba69d(_0x1200bb(0x235) + _0x14281b[_0x1200bb(0x997)]); } }); }); } } function _0x467f30() { const _0x1f1f31 = _0x187760; if (_0x1f1f31(0x6a0) === _0x1f1f31(0x6a0)) { const _0x210879 = document[_0x1f1f31(0xae0)](_0x1f1f31(0x5be)); _0x210879[_0x1f1f31(0xa3d)](_0x605eae => { const _0x59a6b9 = _0x1f1f31, _0x2dac31 = _0x605eae['id'], _0x12730f = 'customIcon_' + _0x2dac31, _0x3e7d63 = localStorage[_0x59a6b9(0x860)](_0x12730f), _0x3ec2de = _0x605eae[_0x59a6b9(0xa01)](_0x59a6b9(0x9b1)); if (_0x3e7d63) _0x3ec2de[_0x59a6b9(0x29c)] = _0x59a6b9(0x99a) + _0x3e7d63 + _0x59a6b9(0x708); else { const _0x562534 = document[_0x59a6b9(0xa01)](_0x59a6b9(0xa74) + _0x2dac31 + '\x20.app-icon-img,\x20#app-dock-top-right\x20#' + _0x2dac31 + _0x59a6b9(0x73f))?.['innerHTML']; _0x562534 && (_0x3ec2de[_0x59a6b9(0x29c)] = _0x562534); } }); } else _0x5bb97b[_0x1f1f31(0x433)] = _0x2cc302, _0x2a8344(_0x1d66b5[_0x1f1f31(0x49a)], _0x1f1f31(0x69b)); } function _0x3420e5() { const _0x287eb0 = _0x187760, _0x2d3269 = _0x29b260['friendCircles'][_0x287eb0(0x444)](_0x2d0ae9 => _0x2d0ae9['id'] === _0x29b260[_0x287eb0(0x439)]), _0x18d57d = _0xa7e551(); let _0x5c7953 = []; if (_0x2d3269 && _0x2d3269['posts']) { const _0x108d92 = _0x2d3269[_0x287eb0(0x9ce)][_0x287eb0(0x9f6)](_0x39d0ff => _0x39d0ff[_0x287eb0(0x713)] === _0x287eb0(0xa7c) && _0x39d0ff[_0x287eb0(0x3e3)])[_0x287eb0(0xa96)](_0x2f7bba => ({ ..._0x2f7bba, 'source': _0x287eb0(0x13d) })); _0x5c7953['push'](..._0x108d92); } if (_0x18d57d && _0x29b260[_0x287eb0(0xa85)]) { if ('NbUcD' === 'NbUcD') { const _0x56107c = _0x29b260[_0x287eb0(0xa85)][_0x287eb0(0x9f6)](_0x245702 => _0x245702[_0x287eb0(0x713)] === _0x287eb0(0xa7c) && _0x245702['playableUrl'])[_0x287eb0(0xa96)](_0x592fee => ({ ..._0x592fee, 'source': _0x287eb0(0x6b7) })); _0x5c7953[_0x287eb0(0x438)](..._0x56107c); } else _0xb4bf22['style'][_0x287eb0(0x3e7)] = _0x287eb0(0x697); } const _0x4ffd1c = Array[_0x287eb0(0x742)](new Map(_0x5c7953[_0x287eb0(0xa96)](_0x576f79 => [_0x576f79[_0x287eb0(0x3e3)], _0x576f79]))['values']()); _0x29b260[_0x287eb0(0x92e)] = _0x4ffd1c[_0x287eb0(0x8d8)]((_0x1d981f, _0x17233d) => _0x17233d[_0x287eb0(0x6de)] - _0x1d981f[_0x287eb0(0x6de)]); } function _0x369c56(_0x73b343) { const _0x5767b1 = _0x187760; if (_0x73b343 < 0x0 || _0x73b343 >= _0x2055dd[_0x5767b1(0x919)]) return; _0x10b124 = _0x73b343; const _0xa95d0f = _0x2055dd[_0x73b343]; _0x57146d[_0x5767b1(0x686)] = _0xa95d0f[_0x5767b1(0x3e3)] || _0xa95d0f[_0x5767b1(0x8b7)], _0x57146d[_0x5767b1(0x5ca)](), _0x3ebc9e(), _0x2c04e0(); } function _0x3ebc9e() { const _0x3a231e = _0x2055dd[_0x10b124]; _0x207d77(_0x3a231e); } function _0x2c04e0() { const _0x297768 = _0x187760; if (_0x297768(0x9e3) === _0x297768(0x4e3)) _0x58d1cf = _0x36ea25(_0x3de1dc[_0x297768(0x9be)][0x0]); else try { localStorage['setItem'](_0x297768(0x414), JSON[_0x297768(0x2a5)]({ 'playlist': _0x29b260[_0x297768(0x92e)], 'currentIndex': _0x29b260['currentlyPlayingIndex'] })); } catch (_0x52f9f1) { console[_0x297768(0x297)]('保存播放器状态失败，真是没用。', _0x52f9f1); } } function _0x482d4c() { const _0x3147d4 = _0x187760; if ('jBdDE' === _0x3147d4(0x8a1)) _0x56a83f[_0x3147d4(0x80f)][_0x3147d4(0x86e)] = '0'; else try { if (_0x3147d4(0x6e0) !== 'MVMxJ') { const _0x5bd28a = localStorage[_0x3147d4(0x860)]('musicPlayerState'); if (_0x5bd28a) { const { playlist: _0x468a86, currentIndex: _0x28f2b1 } = JSON[_0x3147d4(0x1db)](_0x5bd28a); Array[_0x3147d4(0xac4)](_0x468a86) && _0x468a86[_0x3147d4(0x919)] > 0x0 && _0x28f2b1 > -0x1 && (_0x3147d4(0x474) !== _0x3147d4(0x907) ? (_0x29b260[_0x3147d4(0x92e)] = _0x468a86, _0x29b260[_0x3147d4(0x463)] = _0x28f2b1, _0x29b260[_0x3147d4(0x5a7)] = ![], _0x3ebc9e()) : _0x50acee[_0x3147d4(0x297)](_0x3147d4(0x849), _0x5b077b)); } } else { if (_0x2665f1[_0x3147d4(0x90e)]) _0xb84aa7(_0x51ca8c[_0x3147d4(0x90e)]); const _0xdaacbb = _0x7478ff[_0x3147d4(0x65e)][_0x3147d4(0xaa2)](_0x3147d4(0x8e6)); if (!_0xdaacbb) return; const _0x2716e6 = _0xdaacbb[_0x3147d4(0x2f7)][_0x3147d4(0x6de)], _0x199e34 = _0xdaacbb['classList'][_0x3147d4(0x233)]('user') ? _0x3147d4(0x544) : 'ai'; if (!_0x2716e6) return; const _0x17ddad = () => { const _0x25490d = _0x3147d4; _0x392737[_0x25490d(0x90e)] = _0x3d3ea3(() => { const _0x32af03 = _0x25490d; if (_0x22b70e[_0x32af03(0x713)] === _0x32af03(0x536)) _0xdecdfb['preventDefault'](); _0xf18a16(_0x4648da(_0x2716e6, 0xa), _0x199e34); }, 0x320); }, _0x2060cb = () => { const _0x50383b = _0x3147d4; if (_0x435cc3[_0x50383b(0x90e)]) _0x238640(_0x4a9494['diaryPressTimer']); }; _0x11ea5b[_0x3147d4(0x6cc)]('mouseup', _0x2060cb, { 'once': !![] }), _0x5d8d25[_0x3147d4(0x6cc)](_0x3147d4(0xa16), _0x2060cb, { 'once': !![] }), _0x47c0c1[_0x3147d4(0x6cc)]('touchcancel', _0x2060cb, { 'once': !![] }), _0x17ddad(); } } catch (_0x2788d2) { _0x3147d4(0x6ac) !== _0x3147d4(0x70c) ? console[_0x3147d4(0x297)](_0x3147d4(0x50a), _0x2788d2) : _0xe6c536(_0x366bb3, _0x12b837, !![]); } } function _0x62ffb3(_0x49b9fc) { const _0x410db8 = _0x187760; if (_0x410db8(0x214) !== _0x410db8(0x214)) { const _0x4b5000 = _0x1f65af[_0x410db8(0xa93)](_0x410db8(0x64e)); _0x4b5000[_0x410db8(0x8bd)] = _0x410db8(0x264), _0x4b5000[_0x410db8(0x574)] = _0x49c9c7[_0x410db8(0x359)], _0x5a9a47[_0x410db8(0x25f)](_0x4b5000); } else { if (window['diaryPressTimer']) clearTimeout(window['diaryPressTimer']); const _0x211bc6 = _0x49b9fc[_0x410db8(0x65e)][_0x410db8(0xaa2)]('.diary-entry'); if (!_0x211bc6) return; const _0x5890f3 = _0x211bc6[_0x410db8(0x2f7)]['timestamp'], _0x2867b6 = _0x211bc6[_0x410db8(0x969)][_0x410db8(0x233)](_0x410db8(0x544)) ? 'user' : 'ai'; if (!_0x5890f3) return; const _0x4320e1 = () => { const _0x2b9f89 = _0x410db8; _0x2b9f89(0xa9f) === _0x2b9f89(0x914) ? _0x8dc374 = _0x33d890[_0x2b9f89(0x1db)](_0x466a7d) : window[_0x2b9f89(0x90e)] = setTimeout(() => { const _0x52e7fc = _0x2b9f89; if (_0x49b9fc[_0x52e7fc(0x713)] === _0x52e7fc(0x536)) _0x49b9fc[_0x52e7fc(0xac9)](); _0x550d9c(parseInt(_0x5890f3, 0xa), _0x2867b6); }, 0x320); }, _0x529103 = () => { const _0x41eff9 = _0x410db8; if (_0x41eff9(0x47a) !== _0x41eff9(0x47a)) _0xd92617(_0x41eff9(0x6b7), _0x41eff9(0x3c9)); else { if (window[_0x41eff9(0x90e)]) clearTimeout(window[_0x41eff9(0x90e)]); } }; document[_0x410db8(0x6cc)](_0x410db8(0x57a), _0x529103, { 'once': !![] }), document['addEventListener'](_0x410db8(0xa16), _0x529103, { 'once': !![] }), document[_0x410db8(0x6cc)](_0x410db8(0xaf6), _0x529103, { 'once': !![] }), _0x4320e1(); } } function _0x550d9c(_0x1a8497, _0x3123e6) { const _0x420632 = _0x187760, _0x262b71 = _0x420632(0x2d3) + _0x1a8497; let _0x36ca02 = document[_0x420632(0x759)](_0x262b71); if (_0x36ca02) return; const _0x4b59b4 = '\x0a\x20\x20\x20\x20<div\x20id=\x22' + _0x262b71 + '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x3123e6 === 'ai' ? _0x420632(0xb07) : '') + _0x420632(0x94b); document['body'][_0x420632(0x9e0)](_0x420632(0x7b4), _0x4b59b4); const _0x3d9069 = document['getElementById'](_0x262b71), _0x3648cc = () => _0x3d9069['remove'](); _0x3d9069[_0x420632(0xa01)]('.choice-modal-backdrop')[_0x420632(0x356)] = _0x3648cc, _0x3d9069[_0x420632(0xa01)](_0x420632(0x418))[_0x420632(0x356)] = _0x3648cc, _0x3d9069[_0x420632(0xa01)](_0x420632(0xaf0))['onclick'] = () => { _0x5ea16a(_0x1a8497), _0x3648cc(); }, _0x3123e6 === 'ai' && (_0x3d9069[_0x420632(0xa01)]('#diary-action-reroll')[_0x420632(0x356)] = () => { const _0x324ef = _0x420632; if (_0x324ef(0x1c4) !== 'mgDVh') return; else _0x579f9d(_0x1a8497), _0x3648cc(); }); } async function _0x5ea16a(_0x8c7327) { const _0x5637fe = _0x187760; if (_0x5637fe(0x357) === _0x5637fe(0x357)) { const _0x4d88c6 = await _0x5db04d(_0x5637fe(0x50b)); if (!_0x4d88c6) return; const _0x1f5146 = _0x29b260[_0x5637fe(0x94d)][_0x5637fe(0x444)](_0x222a17 => _0x222a17['characterId'] === _0x29b260[_0x5637fe(0x313)]); if (!_0x1f5146) return; const _0x4d85dc = _0x1f5146[_0x5637fe(0xa18)][_0x5637fe(0x961)](_0x97aa39 => _0x97aa39[_0x5637fe(0x6de)] === _0x8c7327); _0x4d85dc > -0x1 && (_0x1f5146[_0x5637fe(0xa18)][_0x5637fe(0x903)](_0x4d85dc, 0x1), _0xf10e4a(), _0x1782c8(), _0xeba69d(_0x5637fe(0x53e))); } else _0xfd55[_0x5637fe(0x297)](_0x5637fe(0x3f5), _0x1f4da1), _0x3de4af[_0x5637fe(0x866)] = _0x5637fe(0x6db); } async function _0x579f9d(_0x50993d) { const _0x3ab243 = _0x187760; if (_0x3ab243(0x597) === _0x3ab243(0x597)) { const _0x17fe74 = _0x29b260['diaries'][_0x3ab243(0x444)](_0x47baeb => _0x47baeb[_0x3ab243(0x94f)] === _0x29b260['activeDiaryCharacterId']); if (!_0x17fe74) return; const _0x4b3e90 = _0x17fe74[_0x3ab243(0xa18)]['findIndex'](_0x12d020 => _0x12d020[_0x3ab243(0x6de)] === _0x50993d); _0x4b3e90 > -0x1 && (_0x3ab243(0x7af) === _0x3ab243(0x7af) ? (_0x17fe74['entries'][_0x3ab243(0x903)](_0x4b3e90, 0x1), _0xf10e4a(), _0x1782c8(), await _0x18ad35()) : _0x31ca95(_0x3ab243(0x6b9))); } else _0x11d885(_0x17a260 + 0x1); } function _0x2ab9ac() { const _0x358e6c = _0x187760, _0x483cdc = document[_0x358e6c(0x759)](_0x358e6c(0x88a)); _0x483cdc[_0x358e6c(0x29c)] = ''; const _0x37a4cd = _0x29b260[_0x358e6c(0x3db)]['filter'](_0x54c0fb => _0x29b260['chats'][_0x358e6c(0x5f7)](_0x3b9d17 => _0x3b9d17[_0x358e6c(0x713)] === _0x358e6c(0x7ad) && _0x3b9d17[_0x358e6c(0x9be)][_0x358e6c(0x4da)](_0x54c0fb['id']))); if (_0x37a4cd[_0x358e6c(0x919)] === 0x0) { _0x483cdc[_0x358e6c(0x29c)] = _0x358e6c(0x437); return; } _0x37a4cd['forEach'](_0xbb68f7 => { const _0x4c90e4 = _0x358e6c, _0x326f89 = document[_0x4c90e4(0xa93)]('li'); _0x326f89[_0x4c90e4(0x8bd)] = _0x4c90e4(0x34c), _0x326f89[_0x4c90e4(0x2f7)]['charId'] = _0xbb68f7['id'], _0x326f89[_0x4c90e4(0x29c)] = _0x4c90e4(0x9ab) + (_0xbb68f7[_0x4c90e4(0x96f)] || _0x461596) + _0x4c90e4(0x483) + _0xbb68f7[_0x4c90e4(0xb15)] + _0x4c90e4(0x167), _0x326f89[_0x4c90e4(0x6cc)](_0x4c90e4(0x7ec), () => { const _0x2a08dc = _0x4c90e4; if (_0x2a08dc(0x1ba) === _0x2a08dc(0x1cf)) { const _0x35335d = _0x5788a8(_0x4ec8a2['id']); if (!_0x35335d || !_0x35335d['id']) return _0x2e3c6a['error'](_0x2a08dc(0x73c)), null; _0x2a31e9[_0x2a08dc(0x901)][_0x2a08dc(0x438)]({ 'id': _0x2a08dc(0x621) + _0xa5e78b['now'](), 'date': _0x1d8e38['eventDate'], 'type': _0x4bd768[_0x2a08dc(0x411)], 'content': _0x1b000f[_0x2a08dc(0x420)], 'userId': _0x35335d['id'], 'createdBy': 'ai' }), _0x34adb0(), _0x3e5bd7(), _0x4adbf8(); const _0x1e175c = _0x50bc6d(_0x137c0b['id']); _0x1e175c && _0x126a91[_0x2a08dc(0x411)] === _0x2a08dc(0x7ea) && _0x5c1853(_0x2a08dc(0xa47) + _0x1e175c['name'] + _0x2a08dc(0x657) + _0x5c65c6['eventContent']); return { 'role': _0x2a08dc(0x863), 'senderId': _0x4f9af4['id'], 'timestamp': _0x541d77['now'](), 'isOffline': _0x21eb87, 'content': null }; return { 'role': _0x2a08dc(0x863), 'senderId': _0x50827e['id'], 'timestamp': _0x5cb39f[_0x2a08dc(0x74c)](), 'isOffline': _0x264376, 'content': null }; } else _0x1fa8ad(_0xbb68f7['id']); }), _0x326f89[_0x4c90e4(0xa01)]('.char-info-wrapper')[_0x4c90e4(0x6cc)](_0x4c90e4(0x7ec), () => { const _0x18d93b = _0x4c90e4; _0x18d93b(0x2be) === _0x18d93b(0x834) ? _0x230e6d[_0x18d93b(0x113)] = _0x5b4155['id'] : _0x1fa8ad(_0xbb68f7['id']); }), _0x326f89['querySelector'](_0x4c90e4(0x954))['addEventListener'](_0x4c90e4(0x7ec), _0x21e848 => { const _0xaa6f49 = _0x4c90e4; _0x21e848[_0xaa6f49(0x479)](), _0x2855c0(_0xbb68f7['id']); }), _0x483cdc['appendChild'](_0x326f89); }); } function _0x1fa8ad(_0x1e6d8e) { const _0x5156f0 = _0x187760, _0xf57ff4 = _0x4cc875(_0x1e6d8e); if (!_0xf57ff4) return; _0x29b260[_0x5156f0(0x313)] = _0x1e6d8e; const _0x1ba956 = _0x29b260[_0x5156f0(0x94d)][_0x5156f0(0x444)](_0x14cf5a => _0x14cf5a['characterId'] === _0x1e6d8e), _0x4c5e10 = _0x1ba956 ? _0x1ba956[_0x5156f0(0xa18)]['length'] : 0x0, _0x2ad4c7 = 0x2; _0x29b260[_0x5156f0(0x8c3)] = Math['max'](0x0, Math[_0x5156f0(0x44e)](_0x4c5e10 / _0x2ad4c7) - 0x1), document['getElementById']('diary-char-name-header')['textContent'] = _0xf57ff4['name'] + _0x5156f0(0x3c0), _0x1782c8(), _0x57a80a(_0x5156f0(0x398), 'diaryList'); } function _0x1782c8() { const _0x5365dc = _0x187760, _0x2ca425 = document[_0x5365dc(0x759)](_0x5365dc(0x227)), _0x29c6a2 = document[_0x5365dc(0x759)](_0x5365dc(0x191)); _0x2ca425[_0x5365dc(0x29c)] = '', _0x29c6a2[_0x5365dc(0x29c)] = ''; const _0x228891 = _0x34a49b() || { 'name': '我' }, _0x53131d = _0x29b260[_0x5365dc(0x94d)][_0x5365dc(0x444)](_0x303e3a => _0x303e3a[_0x5365dc(0x94f)] === _0x29b260[_0x5365dc(0x313)]); if (!_0x53131d || !_0x53131d['entries'] || _0x53131d['entries']['length'] === 0x0) { _0x2ca425['innerHTML'] = _0x5365dc(0x199), _0x29c6a2[_0x5365dc(0x29c)] = _0x5365dc(0x1f3), document[_0x5365dc(0x759)](_0x5365dc(0x885))[_0x5365dc(0x6cc)](_0x5365dc(0x7ec), _0x129f4c), document[_0x5365dc(0x759)](_0x5365dc(0x248))['addEventListener']('click', _0x18ad35); return; } const _0x58ab03 = 0x2, _0x250136 = [..._0x53131d['entries']]['sort']((_0x709de, _0x11983a) => _0x709de[_0x5365dc(0x6de)] - _0x11983a[_0x5365dc(0x6de)]), _0x4f3652 = []; for (let _0x12d38b = 0x0; _0x12d38b < _0x250136[_0x5365dc(0x919)]; _0x12d38b += _0x58ab03) { _0x4f3652[_0x5365dc(0x438)](_0x250136['slice'](_0x12d38b, _0x12d38b + _0x58ab03)); } const _0x59ff6a = _0x4f3652[_0x5365dc(0x919)]; _0x4f3652[_0x5365dc(0xa3d)]((_0x4703a1, _0x1033a9) => { const _0x43b10b = _0x5365dc, _0x48f606 = document[_0x43b10b(0xa93)](_0x43b10b(0x64e)); _0x48f606[_0x43b10b(0x8bd)] = _0x43b10b(0x495), _0x48f606['id'] = _0x43b10b(0x787) + _0x1033a9, _0x1033a9 === _0x29b260[_0x43b10b(0x8c3)] && _0x48f606[_0x43b10b(0x969)]['add'](_0x43b10b(0x552)), _0x4703a1[_0x43b10b(0xa3d)](_0x48c054 => { const _0x336abe = _0x43b10b, _0x3065ce = _0x48c054[_0x336abe(0xa64)] === _0x336abe(0x544) ? _0x336abe(0x544) : 'ai', _0x104462 = _0x48c054['author'] === _0x336abe(0x544) ? _0x228891[_0x336abe(0xb15)] : _0x4cc875(_0x48c054['author'])['name'], _0x2e8830 = document[_0x336abe(0xa93)]('div'); _0x2e8830[_0x336abe(0x8bd)] = _0x336abe(0x499) + _0x3065ce, _0x2e8830[_0x336abe(0x2f7)][_0x336abe(0x6de)] = _0x48c054[_0x336abe(0x6de)], _0x2e8830[_0x336abe(0x80f)]['borderBottom'] = _0x336abe(0x697), _0x2e8830[_0x336abe(0x80f)]['paddingBottom'] = '0', _0x2e8830['innerHTML'] = _0x336abe(0x6c3) + _0x104462 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>' + new Date(_0x48c054[_0x336abe(0x6de)])[_0x336abe(0x22a)](_0x336abe(0x513)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>' + _0x48c054[_0x336abe(0x359)][_0x336abe(0x998)](/\n/g, _0x336abe(0x7ab)) + _0x336abe(0x529), _0x48f606[_0x336abe(0x25f)](_0x2e8830); }), _0x2ca425[_0x43b10b(0x25f)](_0x48f606); }), _0x29c6a2[_0x5365dc(0x29c)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x20auto\x201fr;\x20width:\x20100%;\x20align-items:\x20center;\x20padding:\x200\x2010px;\x20box-sizing:\x20border-box;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-start;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-prev-button\x22>上一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22\x20style=\x22background-color:\x20var(--accent-color);\x20color:\x20white;\x22>写日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22diary-page-indicator\x22>第\x20' + (_0x29b260[_0x5365dc(0x8c3)] + 0x1) + '\x20/\x20' + _0x59ff6a + _0x5365dc(0x119), document[_0x5365dc(0x759)](_0x5365dc(0xa45))[_0x5365dc(0x4b9)] = _0x29b260[_0x5365dc(0x8c3)] === 0x0, document['getElementById'](_0x5365dc(0x8c6))[_0x5365dc(0x4b9)] = _0x29b260[_0x5365dc(0x8c3)] === _0x59ff6a - 0x1, document[_0x5365dc(0x759)]('diary-prev-button')[_0x5365dc(0x6cc)](_0x5365dc(0x7ec), _0x3656df), document[_0x5365dc(0x759)](_0x5365dc(0x8c6))['addEventListener'](_0x5365dc(0x7ec), _0x5c2b91), document['getElementById'](_0x5365dc(0x885))['addEventListener']('click', _0x129f4c), document[_0x5365dc(0x759)](_0x5365dc(0x248))['addEventListener']('click', _0x18ad35); } function _0x5c2b91() { const _0x44d58d = _0x187760; if (_0x44d58d(0x880) === _0x44d58d(0x40e)) { _0x2261bc(_0x44d58d(0x9ba)); return; } else { if (_0x29b260[_0x44d58d(0x42c)]) return; const _0x4b28f8 = _0x29b260[_0x44d58d(0x8c3)], _0x27c370 = Math[_0x44d58d(0x44e)](_0x29b260[_0x44d58d(0x94d)][_0x44d58d(0x444)](_0x24eaf1 => _0x24eaf1['characterId'] === _0x29b260[_0x44d58d(0x313)])[_0x44d58d(0xa18)][_0x44d58d(0x919)] / 0x2); if (_0x4b28f8 >= _0x27c370 - 0x1) return; _0x29b260[_0x44d58d(0x42c)] = !![]; const _0x288440 = _0x4b28f8 + 0x1, _0x11e6ff = document[_0x44d58d(0x759)]('diary-page-' + _0x4b28f8), _0x564ba7 = document[_0x44d58d(0x759)]('diary-page-' + _0x288440); if (_0x11e6ff && _0x564ba7) { if (_0x44d58d(0x8f6) !== 'NFEfm') { _0x331b33[_0x44d58d(0x29c)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>'; return; } else _0x564ba7[_0x44d58d(0x969)]['add'](_0x44d58d(0x9c8)), _0x11e6ff['classList'][_0x44d58d(0x944)](_0x44d58d(0x33c)), _0x564ba7[_0x44d58d(0x969)][_0x44d58d(0x944)](_0x44d58d(0x552)), setTimeout(() => { const _0x3ef0b9 = _0x44d58d; _0x11e6ff['classList'][_0x3ef0b9(0x41a)](_0x3ef0b9(0x552), 'is-exiting-left'), _0x564ba7[_0x3ef0b9(0x969)][_0x3ef0b9(0x41a)]('is-entering-from-right'), _0x29b260[_0x3ef0b9(0x8c3)] = _0x288440, _0x1782c8(), _0x29b260[_0x3ef0b9(0x42c)] = ![]; }, 0x2bc); } else _0x29b260[_0x44d58d(0x42c)] = ![]; } } function _0x3656df() { const _0xca56e1 = _0x187760; if (_0x29b260[_0xca56e1(0x42c)]) return; const _0x3c6041 = _0x29b260[_0xca56e1(0x8c3)]; if (_0x3c6041 <= 0x0) return; _0x29b260[_0xca56e1(0x42c)] = !![]; const _0x2581c8 = _0x3c6041 - 0x1, _0x3db6dd = document[_0xca56e1(0x759)](_0xca56e1(0x787) + _0x3c6041), _0x284756 = document[_0xca56e1(0x759)](_0xca56e1(0x787) + _0x2581c8); if (_0x3db6dd && _0x284756) _0xca56e1(0x8b5) !== _0xca56e1(0x316) ? (_0x284756[_0xca56e1(0x969)][_0xca56e1(0x944)](_0xca56e1(0x6a9)), _0x3db6dd[_0xca56e1(0x969)][_0xca56e1(0x944)](_0xca56e1(0x595)), _0x284756['classList'][_0xca56e1(0x944)](_0xca56e1(0x552)), setTimeout(() => { const _0x727bda = _0xca56e1; _0x3db6dd[_0x727bda(0x969)][_0x727bda(0x41a)]('is-visible', 'is-exiting-right'), _0x284756[_0x727bda(0x969)]['remove'](_0x727bda(0x6a9)), _0x29b260[_0x727bda(0x8c3)] = _0x2581c8, _0x1782c8(), _0x29b260[_0x727bda(0x42c)] = ![]; }, 0x2bc)) : (_0x2715eb[_0xca56e1(0x80f)][_0xca56e1(0x3e7)] = _0xca56e1(0x868), _0x9f73b3(() => _0x1d28d7[_0xca56e1(0x969)][_0xca56e1(0x944)](_0xca56e1(0x459)), 0xa)); else { if (_0xca56e1(0x52f) !== _0xca56e1(0x52f)) { const _0x4b49e4 = []; if (_0x4fe188[_0xca56e1(0x359)]) _0x4b49e4[_0xca56e1(0x438)]({ 'text': _0x16fe40[_0xca56e1(0x359)] }); if (_0x55dfda[_0xca56e1(0x7ee)]) { const _0x40923a = _0x100ad2[_0xca56e1(0x7ee)][_0xca56e1(0x77e)](',')[0x1], _0x1ba1c7 = _0x3c87c8['image'][_0xca56e1(0x6af)](_0x2dcd8b[_0xca56e1(0x7ee)][_0xca56e1(0x8d5)](':') + 0x1, _0x268e8b['image'][_0xca56e1(0x8d5)](';')) || _0xca56e1(0x139); _0x4b49e4[_0xca56e1(0x438)]({ 'inline_data': { 'mime_type': _0x1ba1c7, 'data': _0x40923a } }); } return _0x4b49e4; } else _0x29b260[_0xca56e1(0x42c)] = ![]; } } function _0x129f4c() { return new Promise(_0x5680b3 => { const _0x3ec6c5 = _0x18ce, _0xafe4a5 = _0x3ec6c5(0xa87); document['body'][_0x3ec6c5(0x9e0)](_0x3ec6c5(0x7b4), _0xafe4a5); const _0x3e0485 = document[_0x3ec6c5(0x759)]('diary-write-modal'), _0x2f1cdc = document['getElementById']('diary-modal-textarea'), _0x31ddb0 = document[_0x3ec6c5(0x759)](_0x3ec6c5(0x42a)), _0x5b7c2e = document['getElementById'](_0x3ec6c5(0x537)), _0x35473f = _0x3e0485['querySelector'](_0x3ec6c5(0x4e2)), _0x40dc6b = () => { const _0x156fde = _0x3ec6c5; _0x3e0485[_0x156fde(0x41a)](), _0x5680b3(); }; _0x31ddb0['onclick'] = () => { const _0x1259cd = _0x3ec6c5; if (_0x1259cd(0x573) !== _0x1259cd(0x573)) { const _0xf62f31 = _0x5883ef['floor'](_0x3640dd / 0x3c); if (_0xf62f31 < 0x30) _0x289f77 += _0x1259cd(0x9ae) + _0xf62f31 + _0x1259cd(0x412); else _0x438fe6 += '\x0a-\x20**对话状态**:\x20群里已经有' + _0x54d31f[_0x1259cd(0xa54)](_0xf62f31 / 0x18) + _0x1259cd(0x91c); } else _0x194d26(_0x2f1cdc[_0x1259cd(0xa03)]), _0x40dc6b(); }, _0x5b7c2e[_0x3ec6c5(0x356)] = _0x40dc6b, _0x35473f[_0x3ec6c5(0x356)] = _0x40dc6b; }); } function _0x194d26(_0x41234c) { const _0x518fe6 = _0x187760; if (_0x518fe6(0x9c3) === _0x518fe6(0x385)) { _0x48e75a[_0x518fe6(0x2b1)](_0x518fe6(0x5db)); const _0x3ad070 = _0xef1676[_0x518fe6(0x9be)][_0x518fe6(0xa96)](_0x3ce3ce)[_0x518fe6(0x9f6)](_0x3a4df3); if (!_0x3ad070['length']) return; let _0x418ef6 = 0x0; for (const _0x568cf7 of _0x3ad070) { _0x67bf7d(_0x568cf7, { 'force': !![], 'delayMs': _0x418ef6 }), _0x418ef6 += 0x1f4; } } else { const _0x4c3386 = _0x41234c[_0x518fe6(0x74e)](); if (!_0x4c3386 || !_0x29b260['activeDiaryCharacterId']) return; let _0x24f56b = _0x29b260[_0x518fe6(0x94d)][_0x518fe6(0x444)](_0x382a26 => _0x382a26[_0x518fe6(0x94f)] === _0x29b260['activeDiaryCharacterId']); !_0x24f56b && (_0x24f56b = { 'characterId': _0x29b260[_0x518fe6(0x313)], 'entries': [] }, _0x29b260[_0x518fe6(0x94d)][_0x518fe6(0x438)](_0x24f56b)); _0x24f56b[_0x518fe6(0xa18)][_0x518fe6(0x438)]({ 'timestamp': Date[_0x518fe6(0x74c)](), 'author': 'user', 'content': _0x4c3386 }), _0xf10e4a(); const _0x5c22ce = _0x24f56b[_0x518fe6(0xa18)][_0x518fe6(0x919)]; _0x29b260[_0x518fe6(0x8c3)] = Math['ceil'](_0x5c22ce / 0x2) - 0x1, _0x1782c8(); } } async function _0x18ad35() { const _0x2e93a1 = _0x187760, _0x47f7b8 = _0x29b260[_0x2e93a1(0x94d)][_0x2e93a1(0x444)](_0x2696dc => _0x2696dc[_0x2e93a1(0x94f)] === _0x29b260[_0x2e93a1(0x313)]), _0x4f7180 = _0x29b260[_0x2e93a1(0x313)], _0x5b888c = _0x4cc875(_0x4f7180); if (!_0x5b888c || _0x29b260[_0x2e93a1(0x27c)]) return; _0x195491(!![], _0x2e93a1(0x682)), _0x29b260[_0x2e93a1(0x27c)] = !![]; let _0xf883be = []; try { const _0x1d22d0 = _0x34a49b() || { 'name': '你' }, _0x31c9bb = _0x4312af(_0x4f7180), { omniText: _0x56f609 } = _0x2eac37(_0x4f7180, _0x29b260[_0x2e93a1(0x7b1)]); let _0x94daa4 = ''; if (_0x5b888c[_0x2e93a1(0x5c0)] && _0x5b888c[_0x2e93a1(0x5c0)][_0x2e93a1(0x919)] > 0x0) { const _0x5a56d0 = _0x5b888c[_0x2e93a1(0x5c0)][_0x2e93a1(0xa96)](_0x502e7b => _0x29b260[_0x2e93a1(0x1a1)][_0x2e93a1(0x444)](_0x4dfae0 => _0x4dfae0['id'] === _0x502e7b))[_0x2e93a1(0x9f6)](Boolean)[_0x2e93a1(0xa96)](_0x478664 => '\x0a\x0a##\x20世界书条目:\x20' + _0x478664['name'] + '\x0a' + _0x478664[_0x2e93a1(0x359)])[_0x2e93a1(0x63b)](''); if (_0x5a56d0) _0x94daa4 = _0x2e93a1(0x3a4) + _0x5a56d0; } const _0x335278 = _0x1d22d0[_0x2e93a1(0x435)] ? _0x2e93a1(0x7bf) + _0x1d22d0['name'] + _0x2e93a1(0x282) + _0x1d22d0[_0x2e93a1(0x435)] : '', _0xb3631 = _0x51a4ba(); let _0x25354a = _0x2e93a1(0x77b); if (_0x47f7b8 && _0x47f7b8[_0x2e93a1(0xa18)]) { if (_0x2e93a1(0x225) === 'IPdxf') { const _0x95e9d9 = _0x21d030['concat'](_0x55a377); _0x5d9445 = _0x56a15f['stringify'](_0x95e9d9), _0x143b11['log'](_0x2e93a1(0x893)); } else { const _0x42334d = _0x47f7b8[_0x2e93a1(0xa18)][_0x2e93a1(0x9f6)](_0x274a13 => _0x274a13['author'] === _0x2e93a1(0x544))[_0x2e93a1(0xa8d)](); _0x42334d && (_0x2e93a1(0x4b8) === _0x2e93a1(0x978) ? _0x1dbde6 = _0x2e93a1(0xae9) : _0x25354a = _0x42334d['content']); } } const _0x358f80 = _0x2e93a1(0x58f) + _0x5b888c[_0x2e93a1(0xb15)] + _0x2e93a1(0x27d) + _0x1d22d0[_0x2e93a1(0xb15)] + _0x2e93a1(0x3e4) + _0x1d22d0[_0x2e93a1(0xb15)] + '）最新写下的日记内容。Ta写的是：\x0a\x20“' + _0x25354a + '”\x20\x0a\x20你必须针对这段内容表达你的看法、感受或关联的思考。\x0a2.\x20\x20**【次要任务：分享自我】**\x20在回应之后，你**必须**分享一些关于你自己的、读者**不知道**的新鲜事。可以是你今天的见闻、一个突然的想法、或者一件小小的秘密。不要总是复述你们已经聊过的内容！\x0a3.\x20\x20**【禁止复读】**\x20聊天记录和动态只是你的“背景记忆”，是用来确保你不OOC的参考，**绝对不是**你日记的主要内容！\x0a\x0a#\x20你的核心人设\x20(必须遵守)\x0a' + _0x5b888c['persona'] + '\x0a' + _0x335278 + '\x0a' + _0x94daa4 + '\x0a\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a-\x20**当前精确时间**:\x20' + new Date()[_0x2e93a1(0x22a)](_0x2e93a1(0x513), { 'dateStyle': _0x2e93a1(0x728), 'timeStyle': _0x2e93a1(0x704) }) + _0x2e93a1(0x26c) + _0x236f37(new Date(_0x47f7b8?.[_0x2e93a1(0xa18)]?.['at'](-0x1)?.[_0x2e93a1(0x6de)] || Date[_0x2e93a1(0x74c)]())) + '\x0a\x0a#\x20记忆库\x20(仅供参考)\x0a---\x0a##\x20最近的互动回顾\x20(来自聊天、见面和动态)\x0a' + (_0x56f609 || _0x2e93a1(0x171)) + _0x2e93a1(0x494) + (_0xb3631 || _0x2e93a1(0x327)) + _0x2e93a1(0x941); _0xf883be = [{ 'role': _0x2e93a1(0x4c2), 'content': _0x358f80 }, { 'role': _0x2e93a1(0x544), 'content': _0x2e93a1(0x150) }]; const _0x50af84 = await _0x315051(_0xf883be); if (_0x50af84) { if (_0x2e93a1(0x1b0) === _0x2e93a1(0x6a8)) { if (_0x2a4158) _0x54bd97(_0x3ff4c8); const _0x18da5f = _0x23c607['target'][_0x2e93a1(0xaa2)](_0x2e93a1(0x4b4)); if (!_0x18da5f) return; const _0x175876 = _0x2fc95d(_0x18da5f[_0x2e93a1(0x2f7)][_0x2e93a1(0x2b0)], 0xa); if (_0x58942f(_0x175876)) return; const _0x387c14 = () => { _0x3512f0 = _0x29f7ca(() => { const _0x4f6ab9 = _0x18ce; if (_0x488b17[_0x4f6ab9(0x713)] === _0x4f6ab9(0x536)) _0x1f7ae7['preventDefault'](); _0x192bd8(_0x175876); }, 0x320); }, _0x3da7f8 = () => { if (_0x2edf3f) _0x4ce18e(_0xfb45ab); }; _0x3b052b[_0x2e93a1(0x6cc)]('mouseup', _0x3da7f8, { 'once': !![] }), _0x340fe4[_0x2e93a1(0x6cc)](_0x2e93a1(0x73d), _0x3da7f8, { 'once': !![] }), _0x4d7d3e['addEventListener'](_0x2e93a1(0xa16), _0x3da7f8, { 'once': !![] }), _0x5d43c8['addEventListener'](_0x2e93a1(0xaf6), _0x3da7f8, { 'once': !![] }), _0x387c14(); } else { let _0x315eb6 = _0x29b260[_0x2e93a1(0x94d)][_0x2e93a1(0x444)](_0x1f05ae => _0x1f05ae[_0x2e93a1(0x94f)] === _0x4f7180); !_0x315eb6 && (_0x315eb6 = { 'characterId': _0x4f7180, 'entries': [] }, _0x29b260['diaries'][_0x2e93a1(0x438)](_0x315eb6)); _0x315eb6[_0x2e93a1(0xa18)][_0x2e93a1(0x438)]({ 'timestamp': Date['now'](), 'author': _0x4f7180, 'content': _0x50af84 }), _0xf10e4a(); const _0x505709 = _0x315eb6[_0x2e93a1(0xa18)][_0x2e93a1(0x919)]; _0x29b260[_0x2e93a1(0x8c3)] = Math[_0x2e93a1(0x44e)](_0x505709 / 0x2) - 0x1, _0x1782c8(); } } } catch (_0x4f60e1) { _0xeba69d('生成日记失败:\x20' + _0x4f60e1[_0x2e93a1(0x997)]); } finally { _0x195491(![]), _0x29b260['isGenerating'] = ![]; } } function _0x3f6d23() { const _0x5aa86c = _0x187760; if (_0x5aa86c(0x571) === 'zYxPI') { const _0x5aab71 = _0x1fa5f2(_0x284d04[_0x5aa86c(0xb06)]())[_0x5aa86c(0x27e)](0x2, '0'), _0x556848 = _0x3890f8(_0x1e1252['getMinutes']())['padStart'](0x2, '0'); _0x4bf2fa[_0x5aa86c(0x574)] = _0x5aab71 + ':' + _0x556848; const _0x58fc17 = _0x269414['getMonth']() + 0x1, _0x4b0206 = _0x356355[_0x5aa86c(0x3de)](), _0x24f49c = [_0x5aa86c(0x1b6), '星期一', _0x5aa86c(0x334), '星期三', _0x5aa86c(0x496), _0x5aa86c(0x36f), '星期六'][_0x5e1668[_0x5aa86c(0x716)]()]; _0xfa6385[_0x5aa86c(0x574)] = _0x58fc17 + '月' + _0x4b0206 + '日\x20' + _0x24f49c; } else { const _0x31d415 = document['getElementById'](_0x5aa86c(0x29d)), _0x45de82 = document['getElementById'](_0x5aa86c(0x294)), _0x274720 = document[_0x5aa86c(0xa01)](_0x5aa86c(0xada)); _0x29b260[_0x5aa86c(0x584)] === 'galgame' ? (_0x31d415['style']['display'] = _0x5aa86c(0x697), _0x45de82[_0x5aa86c(0x80f)][_0x5aa86c(0x3e7)] = _0x5aa86c(0x210)) : _0x5aa86c(0x43e) !== 'iBTcM' ? (_0x31d415['style'][_0x5aa86c(0x3e7)] = 'block', _0x45de82[_0x5aa86c(0x80f)]['display'] = _0x5aa86c(0x697)) : _0x336c21 += '-\x20' + _0x18c7cf[_0x5aa86c(0x2a5)](_0x18daec) + '\x0a', _0x274720[_0x5aa86c(0x80f)][_0x5aa86c(0x3e7)] = _0x5aa86c(0x210); } } function _0x4529da() { const _0x237223 = _0x187760; if (_0x237223(0x798) === _0x237223(0x877)) return _0x237223(0x734) + _0xb227e4; else { const _0x12b0cf = document[_0x237223(0x759)](_0x237223(0x608)), _0x4674df = document['getElementById'](_0x237223(0x245)); if (_0x29b260[_0x237223(0x958)]['length'] > 0x0) { if ('SVPfG' !== _0x237223(0x371)) return _0x54d70a[_0x237223(0xb15)] !== _0x237223(0x1b8) && _0xc69451[_0x237223(0x297)](_0x237223(0x1e6), _0x3d4c15), null; else { const _0x5e481d = _0x29b260[_0x237223(0x958)][_0x237223(0x620)](); _0x12b0cf[_0x237223(0x574)] = _0x5e481d[_0x237223(0x3c1)] === _0x237223(0x9b5) ? '旁白' : _0x5e481d[_0x237223(0x3c1)], _0x4674df['textContent'] = _0x5e481d[_0x237223(0x81d)], _0x5e481d[_0x237223(0x3c1)] !== _0x237223(0x9b5) && _0x35cdcb(_0x29b260[_0x237223(0x49a)], _0x5e481d[_0x237223(0x279)]); } } else { const _0x20ff3f = _0x29b260[_0x237223(0x534)][_0x29b260[_0x237223(0x49a)]]; if (_0x20ff3f && _0x20ff3f['length'] > 0x0) { if ('wpTsu' === _0x237223(0x72e)) { _0x29b260[_0x237223(0x958)] = [..._0x20ff3f]; const _0x121d7b = _0x29b260[_0x237223(0x958)][_0x237223(0x620)](); _0x12b0cf['textContent'] = _0x121d7b[_0x237223(0x3c1)] === 'narrator' ? '旁白' : _0x121d7b[_0x237223(0x3c1)], _0x4674df[_0x237223(0x574)] = _0x121d7b['line'], _0x121d7b['speaker'] !== _0x237223(0x9b5) && _0x35cdcb(_0x29b260['activeMeetingCharId'], _0x121d7b[_0x237223(0x279)]); } else _0x2bf400[_0x237223(0x901)][_0x237223(0x903)](_0x3f93d5, 0x1), _0x3c61c0(), _0x320926(), _0x1dee6b(), _0x399591(), _0x4f14f3(_0x237223(0xb0f)); } else _0x12b0cf['textContent'] = '旁白', _0x4674df[_0x237223(0x574)] = _0x237223(0x148); } } } async function _0x35cdcb(_0x5e2145, _0x3cd278) { const _0x5bbfd3 = _0x187760, _0x5c3f16 = document['getElementById'](_0x5bbfd3(0x7e0)), _0x53e503 = document['getElementById'](_0x5bbfd3(0xaa3)), _0x25c745 = _0x4cc875(_0x5e2145), _0x60163d = _0x25c745?.['spriteTransform'] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }, _0x5739fb = 0x50 * _0x60163d[_0x5bbfd3(0x61e)]; _0x53e503[_0x5bbfd3(0x80f)][_0x5bbfd3(0xac8)] = _0x5739fb + '%', _0x53e503[_0x5bbfd3(0x80f)][_0x5bbfd3(0x3fd)] = _0x5739fb + '%', _0x53e503['style']['left'] = _0x60163d['x'] + '%', _0x53e503[_0x5bbfd3(0x80f)][_0x5bbfd3(0xa28)] = _0x60163d['y'] + '%', _0x53e503[_0x5bbfd3(0x80f)]['transform'] = 'translate(-50%,\x20-100%)', _0x53e503[_0x5bbfd3(0x80f)]['bottom'] = _0x5bbfd3(0x831); const _0x89f87a = [_0x5bbfd3(0x69b), _0x5bbfd3(0x9e5), _0x5bbfd3(0xa6a), _0x5bbfd3(0x35f), _0x5bbfd3(0x9cd)], _0x56e08a = _0x89f87a[_0x5bbfd3(0x4da)](_0x3cd278) ? _0x3cd278 : _0x5bbfd3(0x69b); try { const _0x4c4f2c = await _0x2e6c7a(_0x5bbfd3(0x6f4) + _0x56e08a + '_' + _0x5e2145); if (_0x4c4f2c) _0x5bbfd3(0x72d) === _0x5bbfd3(0x72d) ? _0x5c3f16[_0x5bbfd3(0x686)] && _0x5c3f16['style'][_0x5bbfd3(0xadd)] !== '0' ? (_0x5c3f16['style'][_0x5bbfd3(0xadd)] = 0x0, setTimeout(() => { const _0x417633 = _0x5bbfd3; _0x417633(0x32c) !== 'gtTGS' ? (_0x1111dd[_0x417633(0x297)](_0x417633(0xa26), _0xca2ee9), _0x4799cb['value'] = _0x417633(0x5c5) + _0x30d22f[_0x417633(0x997)]) : (_0x5c3f16[_0x417633(0x686)] = URL[_0x417633(0x289)](_0x4c4f2c), _0x5c3f16['style'][_0x417633(0xadd)] = 0x1); }, 0x96)) : _0x5bbfd3(0x80e) === _0x5bbfd3(0x268) ? _0x47f04e += _0x5bbfd3(0x28b) + _0x390462[_0x5bbfd3(0x5ee)] + '\x20-\x20' + _0x5eaa7b[_0x5bbfd3(0x6cd)] + ']' : (_0x5c3f16[_0x5bbfd3(0x686)] = URL[_0x5bbfd3(0x289)](_0x4c4f2c), _0x5c3f16[_0x5bbfd3(0x80f)][_0x5bbfd3(0xadd)] = 0x1) : (_0x52fd02[_0x5bbfd3(0x574)] = _0x13e391[_0x5bbfd3(0xb15)], _0x38f71a[_0x5bbfd3(0x574)] = _0x5bbfd3(0x6fb), _0x4c3a84(_0x5691b8, _0x5bbfd3(0x69b))); else { const _0x417b2f = await _0x2e6c7a('char_sprite_normal_' + _0x5e2145); _0x5c3f16[_0x5bbfd3(0x686)] = _0x417b2f ? URL[_0x5bbfd3(0x289)](_0x417b2f) : ''; } } catch (_0x6e1d77) { _0x5bbfd3(0x196) !== _0x5bbfd3(0x196) ? _0x503030[_0x5bbfd3(0x80f)][_0x5bbfd3(0x3e7)] = _0x5bbfd3(0x697) : (console[_0x5bbfd3(0x297)]('加载立绘失败:', _0x6e1d77), _0x5c3f16[_0x5bbfd3(0x686)] = ''); } } let _0x4bbafa = ![], _0x385a6d = { 'isDragging': ![], 'isResizing': ![], 'startX': 0x0, 'startY': 0x0, 'startLeft': 0x0, 'startTop': 0x0, 'startWidth': 0x0, 'startHeight': 0x0 }; const _0x50e9ad = document['getElementById'](_0x187760(0x1e9)), _0x179e64 = document[_0x187760(0x759)](_0x187760(0x604)), _0x50bbe2 = document[_0x187760(0x759)](_0x187760(0xa82)), _0x5d89db = document[_0x187760(0x759)]('sprite-reset-button'), _0x1c468c = document[_0x187760(0x759)]('galgame-sprite-controls'), _0x1efcf1 = document[_0x187760(0x759)](_0x187760(0xaa3)), _0x7bd581 = document[_0x187760(0x759)](_0x187760(0x8a9)), _0x570b36 = document[_0x187760(0x759)](_0x187760(0x4bb)); let _0x4be792 = {}; function _0x2ca4be() { const _0x147c43 = _0x187760; if (_0x147c43(0xa49) !== _0x147c43(0xa49)) { _0x42625b[_0x147c43(0xa85)] = [], _0x4c602c(); return; } else { const _0x12c61f = _0x4cc875(_0x29b260['activeMeetingCharId']); if (!_0x12c61f) return; _0x4bbafa = !![], _0x1c468c[_0x147c43(0x80f)]['display'] = _0x147c43(0x210); const _0x25099b = _0x12c61f[_0x147c43(0x433)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; document[_0x147c43(0x759)](_0x147c43(0x201))['value'] = _0x25099b['x'], document[_0x147c43(0x759)](_0x147c43(0x5a9))[_0x147c43(0xa03)] = _0x25099b['y'], document[_0x147c43(0x759)](_0x147c43(0x9de))[_0x147c43(0xa03)] = _0x25099b[_0x147c43(0x61e)] * 0x64, _0x4be792 = { ..._0x25099b }, document[_0x147c43(0x759)](_0x147c43(0x7b3))[_0x147c43(0x80f)][_0x147c43(0x3e7)] = _0x147c43(0x697), document[_0x147c43(0x759)](_0x147c43(0xa15))['style'][_0x147c43(0x3e7)] = _0x147c43(0x697); } } function _0x121093(_0x53e540 = ![]) { const _0x8f4849 = _0x187760; _0x4bbafa = ![], _0x1c468c[_0x8f4849(0x80f)]['display'] = 'none', document[_0x8f4849(0x759)]('galgame-textbox-container')[_0x8f4849(0x80f)][_0x8f4849(0x3e7)] = 'block', document['getElementById'](_0x8f4849(0xa15))['style']['display'] = 'block'; if (!_0x53e540) { if (_0x8f4849(0xacf) === _0x8f4849(0xacf)) { const _0x884d68 = _0x4cc875(_0x29b260[_0x8f4849(0x49a)]); _0x884d68 && (_0x884d68[_0x8f4849(0x433)] = _0x4be792, _0x35cdcb(_0x29b260[_0x8f4849(0x49a)], _0x8f4849(0x69b))); } else _0x4f91f0['appendChild'](_0x3e9649); } } function _0x2a92ff() { const _0x3a5e49 = _0x187760, _0x2978bf = _0x4cc875(_0x29b260[_0x3a5e49(0x49a)]); if (!_0x2978bf) return; const _0x662174 = parseFloat(document[_0x3a5e49(0x759)](_0x3a5e49(0x201))['value']), _0x1d165f = parseFloat(document[_0x3a5e49(0x759)]('sprite-slider-y')[_0x3a5e49(0xa03)]), _0x132b87 = parseFloat(document[_0x3a5e49(0x759)](_0x3a5e49(0x9de))[_0x3a5e49(0xa03)]) / 0x64; _0x2978bf[_0x3a5e49(0x433)] = { 'x': _0x662174, 'y': _0x1d165f, 'scale': _0x132b87 }, _0xf10e4a(), _0xeba69d(_0x3a5e49(0x2af)), _0x121093(!![]); } function _0x3a004d() { const _0x4d8c20 = _0x187760; if (_0x4d8c20(0x15c) === _0x4d8c20(0x15c)) _0x5db04d(_0x4d8c20(0x758))[_0x4d8c20(0x276)](_0x5bcead => { const _0x3b77d6 = _0x4d8c20; if (_0x5bcead) { const _0x535428 = _0x4cc875(_0x29b260[_0x3b77d6(0x49a)]); _0x535428 && (delete _0x535428[_0x3b77d6(0x433)], _0xf10e4a(), _0x35cdcb(_0x535428['id'], 'normal'), _0xeba69d(_0x3b77d6(0x806)), _0x121093(!![])); } }); else { const _0x70cdb8 = _0x147f42(_0x5a7d97[_0x4d8c20(0x359)] ?? _0x465e17[_0x4d8c20(0x807)] ?? _0xa373a7[_0x4d8c20(0x997)] ?? '')[_0x4d8c20(0x74e)](); if (_0x70cdb8) _0x397ff1[_0x4d8c20(0x17b)]['push']({ 'senderId': _0x5985be['id'], 'kind': 'text', 'content': _0x70cdb8 }); } } function _0x15d57a() { const _0x2d673c = _0x187760; if (_0x2d673c(0x801) === _0x2d673c(0x801)) { if (!_0x4bbafa) return; const _0x52bc44 = _0x29b260[_0x2d673c(0x49a)], _0x42a0ab = _0x4cc875(_0x52bc44); if (!_0x42a0ab) return; const _0x301567 = parseFloat(document[_0x2d673c(0x759)]('sprite-slider-x')[_0x2d673c(0xa03)]), _0x130a44 = parseFloat(document[_0x2d673c(0x759)](_0x2d673c(0x5a9))[_0x2d673c(0xa03)]), _0x4725db = parseFloat(document[_0x2d673c(0x759)](_0x2d673c(0x9de))[_0x2d673c(0xa03)]) / 0x64; _0x42a0ab[_0x2d673c(0x433)] = { 'x': _0x301567, 'y': _0x130a44, 'scale': _0x4725db }; const _0x1cec51 = document[_0x2d673c(0x759)](_0x2d673c(0xaa3)), _0x1366d6 = 0x50 * _0x4725db; _0x1cec51[_0x2d673c(0x80f)][_0x2d673c(0xac8)] = _0x1366d6 + '%', _0x1cec51[_0x2d673c(0x80f)][_0x2d673c(0x3fd)] = _0x1366d6 + '%', _0x1cec51['style']['left'] = _0x301567 + '%', _0x1cec51['style'][_0x2d673c(0xa28)] = _0x130a44 + '%', _0x1cec51[_0x2d673c(0x80f)][_0x2d673c(0x550)] = _0x2d673c(0xaa5); } else _0x4b1625(_0x54f917), _0x21fa2d(_0x2d673c(0x70e) + _0x48d348[_0x2d673c(0xb15)] + _0x2d673c(0x33a)), _0x4cd536('chat', _0x2d673c(0x3c9)), _0x329c94(![]); } document[_0x187760(0x759)](_0x187760(0x201))[_0x187760(0x6cc)](_0x187760(0x3cb), _0x15d57a), document[_0x187760(0x759)](_0x187760(0x5a9))[_0x187760(0x6cc)](_0x187760(0x3cb), _0x15d57a), document[_0x187760(0x759)](_0x187760(0x9de))['addEventListener'](_0x187760(0x3cb), _0x15d57a), _0x50e9ad[_0x187760(0x6cc)](_0x187760(0x7ec), _0x2ca4be), _0x179e64['addEventListener'](_0x187760(0x7ec), _0x2a92ff), _0x50bbe2[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x121093(![])), _0x5d89db['addEventListener'](_0x187760(0x7ec), _0x3a004d); function _0x17a6e0(_0x202a67) { const _0x424917 = _0x187760, _0x55531b = _0x4cc875(_0x202a67); if (!_0x55531b) return; const _0x14ca91 = _0x29b260[_0x424917(0x6df)][_0x424917(0x444)](_0x1b8ab3 => _0x1b8ab3[_0x424917(0x713)] === _0x424917(0x7ad) && _0x1b8ab3[_0x424917(0x9be)][_0x424917(0x4da)](_0x202a67)), _0x3e5a77 = _0x33ec75(_0x14ca91['id']), _0x7c54d5 = _0x29b260[_0x424917(0xa85)][_0x424917(0x9f6)](_0x154fb9 => _0x154fb9['isOffline'])[_0x424917(0xa8d)](), _0x1fe3ce = document[_0x424917(0x759)](_0x424917(0x608)), _0x487fe7 = document['getElementById'](_0x424917(0x245)); let _0x15a983 = null; if (_0x7c54d5) { if (_0x7c54d5[_0x424917(0x456)] === 'assistant') { const _0x3689d9 = _0x29b260[_0x424917(0x534)][_0x202a67]; _0x3689d9 && _0x3689d9[_0x424917(0x919)] > 0x0 && (_0x15a983 = _0x3689d9['at'](-0x1)); } else _0x424917(0x793) !== _0x424917(0x793) ? _0x276bb1[_0x424917(0x438)](_0x25ed71['id']) : _0x15a983 = { 'speaker': _0x3e5a77['name'], 'line': _0x7c54d5[_0x424917(0x359)], 'emotion': _0x424917(0x69b) }; } if (_0x15a983) { if (_0x424917(0xa9d) === _0x424917(0xa9d)) _0x1fe3ce[_0x424917(0x574)] = _0x15a983['speaker'] === _0x424917(0x9b5) ? '旁白' : _0x15a983[_0x424917(0x3c1)], _0x487fe7[_0x424917(0x574)] = _0x15a983['line'], _0x15a983['speaker'] === _0x55531b['name'] ? _0x424917(0xadb) !== _0x424917(0xadb) ? _0x36bf3c(_0xc5250c[_0x424917(0x49a)], _0x42c57a['emotion']) : _0x35cdcb(_0x202a67, _0x15a983['emotion']) : _0x35cdcb(_0x202a67, 'normal'); else { const _0x3b6951 = _0xb0e380[_0x424917(0x759)]('pending-post-image-preview'); _0x3b6951 && _0x3a4ab7 && (_0x3b6951[_0x424917(0x686)] = _0x310920[_0x424917(0x289)](_0x28674a)); } } else _0x1fe3ce[_0x424917(0x574)] = _0x55531b['name'], _0x487fe7[_0x424917(0x574)] = _0x424917(0x6fb), _0x35cdcb(_0x202a67, _0x424917(0x69b)); } function _0x542e67() { const _0x4c13cd = _0x187760, _0x534955 = new Date(), _0x432e9c = document[_0x4c13cd(0x759)]('galgame-time'), _0x13e8c6 = document[_0x4c13cd(0x759)](_0x4c13cd(0xb1d)); if (_0x432e9c && _0x13e8c6) { if (_0x4c13cd(0xa95) !== _0x4c13cd(0xa95)) { const _0x3683f7 = _0x4bf9c2(_0xd35c47['id']), _0x29a2e7 = _0x3683f7['length'] > 0x0 ? _0x3683f7[_0x3683f7[_0x4c13cd(0x919)] - 0x1] : null; return { 'chat': _0x376868, 'history': _0x3683f7, 'lastTimestamp': _0x29a2e7 ? _0x29a2e7[_0x4c13cd(0x6de)] : 0x0 }; } else { const _0x2feef0 = String(_0x534955[_0x4c13cd(0xb06)]())[_0x4c13cd(0x27e)](0x2, '0'), _0x39f218 = String(_0x534955[_0x4c13cd(0x600)]())[_0x4c13cd(0x27e)](0x2, '0'); _0x432e9c['textContent'] = _0x2feef0 + ':' + _0x39f218; const _0x521e65 = _0x534955['getMonth']() + 0x1, _0x1b2d95 = _0x534955[_0x4c13cd(0x3de)](), _0xc00297 = ['星期日', _0x4c13cd(0x9f9), '星期二', _0x4c13cd(0x23e), '星期四', _0x4c13cd(0x36f), _0x4c13cd(0x275)][_0x534955[_0x4c13cd(0x716)]()]; _0x13e8c6[_0x4c13cd(0x574)] = _0x521e65 + '月' + _0x1b2d95 + '日\x20' + _0xc00297; } } } const _0x4982b0 = document['getElementById'](_0x187760(0x98c)), _0x72df65 = document[_0x187760(0x759)]('chat-listen-together-button'), _0x1cba93 = document[_0x187760(0x759)]('cancel-listen-together'), _0x446e33 = document['getElementById'](_0x187760(0x54b)), _0x267b9a = document['getElementById'](_0x187760(0x7f3)), _0x57146d = document[_0x187760(0x759)](_0x187760(0x36a)), _0x54e7a9 = document[_0x187760(0x759)](_0x187760(0x12c)), _0xed1ebf = document[_0x187760(0x759)]('lt-ui-close-btn'), _0x15f234 = document['getElementById']('lt-ui-lyrics-container'); let _0x29202a = []; async function _0xc8b89() { const _0x256a2f = _0x187760; if (!_0x29b260[_0x256a2f(0x7b1)]) return; _0x267b9a[_0x256a2f(0x29c)] = _0x256a2f(0x16d), _0x4982b0['classList'][_0x256a2f(0x944)](_0x256a2f(0x459)); const _0xf1c177 = await _0xa46fb7(); if (_0xf1c177[_0x256a2f(0x919)] === 0x0) { _0x267b9a[_0x256a2f(0x29c)] = _0x256a2f(0x1a0); return; } _0x267b9a['innerHTML'] = '', _0xf1c177[_0x256a2f(0xa3d)](_0x3920c7 => { const _0x12a838 = _0x256a2f, _0x5971c7 = document[_0x12a838(0xa93)](_0x12a838(0x64e)); _0x5971c7['className'] = _0x12a838(0x568); const _0x22fda4 = _0x3920c7[_0x12a838(0x194)] ? URL['createObjectURL'](_0x3920c7[_0x12a838(0x194)]) : _0x461596; _0x5971c7['innerHTML'] = _0x12a838(0x7b9) + _0x22fda4 + _0x12a838(0x90f) + (_0x3920c7[_0x12a838(0x92c)][_0x12a838(0x132)] || _0x12a838(0x125)) + _0x12a838(0x9db) + (_0x3920c7[_0x12a838(0x92c)]['歌手'] || '未知艺术家') + _0x12a838(0xa4f), _0x5971c7[_0x12a838(0x6cc)](_0x12a838(0x7ec), () => { _0x318317(_0x3920c7); }), _0x267b9a[_0x12a838(0x25f)](_0x5971c7); }); } function _0x3633e6() { const _0x4e7b1e = _0x187760; _0x4982b0['classList']['remove'](_0x4e7b1e(0x459)); } async function _0x318317(_0x55104c) { const _0x296c7b = _0x187760; if (!_0x29b260[_0x296c7b(0x7b1)] || !_0x55104c) return; let _0x226ef0 = null; if (_0x55104c[_0x296c7b(0x194)]) try { _0x296c7b(0xaa0) === _0x296c7b(0xaa0) ? (_0x226ef0 = _0x296c7b(0x45c) + Date['now']() + '_' + Math[_0x296c7b(0x545)](), await _0x5b0aee(_0x226ef0, _0x55104c['cover'])) : _0x1ae8a6(_0x4082b1['id'], _0x2afb44['map'](_0x13cfdb => _0x13cfdb['id'])); } catch (_0x1da52a) { console[_0x296c7b(0x297)](_0x296c7b(0x40b), _0x1da52a); } const _0x2fc39b = { 'role': _0x296c7b(0x544), 'type': _0x296c7b(0x36c), 'content': _0x296c7b(0x39d) + _0x55104c['info'][_0x296c7b(0x132)] + ']', 'songId': _0x55104c['id'], 'songName': _0x55104c['info'][_0x296c7b(0x132)], 'artist': _0x55104c[_0x296c7b(0x92c)]['歌手'], 'coverId': _0x226ef0, 'timestamp': Date['now']() }; _0x29b260['conversationHistory']['push'](_0x2fc39b), _0x3254df(), _0x448e33(), _0x3633e6(), setTimeout(_0x1ae21f, 0x64); } _0x72df65[_0x187760(0x6cc)]('click', _0xc8b89), _0x1cba93['addEventListener'](_0x187760(0x7ec), _0x3633e6), _0x446e33['addEventListener'](_0x187760(0x7ec), _0x3633e6); async function _0x408236(_0x4306d7, _0x2e0ce9, _0x1592ba) { const _0x561ee3 = _0x187760, _0x45ea12 = _0x29b260['chats']['find'](_0x1ea88f => _0x1ea88f[_0x561ee3(0x9e8)] && _0x1ea88f[_0x561ee3(0x9e8)][_0x561ee3(0x705)]), _0x303d21 = _0xa7e551(); if (_0x45ea12 && _0x45ea12['id'] !== _0x303d21['id']) _0x561ee3(0x5b8) !== _0x561ee3(0x1fc) ? (_0x45ea12[_0x561ee3(0x9e8)] = null, _0xeba69d(_0x561ee3(0x5bd)), _0xf10e4a()) : _0x30099f[_0x169bcf] = _0x3f9892['parse'](_0x5ec990); else { if (_0x45ea12 && _0x45ea12['id'] === _0x303d21['id']) { if (_0x561ee3(0x1d0) !== _0x561ee3(0x1d0)) { if (_0x3bc1ad) _0x68373f[_0x561ee3(0x80f)][_0x561ee3(0xad6)] = 'url(\x27' + _0x1df72f[_0x561ee3(0x289)](_0x24ff30) + '\x27)'; } else _0xeba69d(_0x561ee3(0x646)); } } _0x195491(!![], '正在连接同步频道...'); if (!_0x303d21) { _0x195491(![]), _0xeba69d(_0x561ee3(0xabd)); return; } const _0x314856 = await _0x308184(_0x4306d7); if (!_0x314856) { _0x195491(![]), _0xeba69d('错误：找不到这首作为“信物”的歌。'); return; } _0x303d21['activeListenSession'] = { 'isActive': !![], 'songId': _0x4306d7, 'leaderId': 'user', 'songName': _0x314856['info'][_0x561ee3(0x132)], 'artist': _0x314856[_0x561ee3(0x92c)]['歌手'], 'cover': _0x314856[_0x561ee3(0x194)] }, _0xf10e4a(), document[_0x561ee3(0x759)](_0x561ee3(0x4ab))[_0x561ee3(0x686)] = _0x314856[_0x561ee3(0x194)] ? URL[_0x561ee3(0x289)](_0x314856[_0x561ee3(0x194)]) : _0x461596, document[_0x561ee3(0x759)](_0x561ee3(0x810))[_0x561ee3(0x574)] = _0x314856[_0x561ee3(0x92c)][_0x561ee3(0x132)], document['getElementById']('lt-ui-song-artist')[_0x561ee3(0x574)] = _0x314856['info']['歌手'], _0x277d47(_0x314856), _0x54e7a9[_0x561ee3(0x80f)]['display'] = _0x561ee3(0x868), setTimeout(() => _0x54e7a9['classList'][_0x561ee3(0x944)](_0x561ee3(0x459)), 0xa), _0x1592ba[_0x561ee3(0x29c)] = _0x561ee3(0x79d) + _0x1592ba[_0x561ee3(0xa01)]('.listen-together-song')[_0x561ee3(0x85b)]; if (_0x29b260[_0x561ee3(0xa85)][_0x2e0ce9]) { if (_0x561ee3(0x7f4) !== 'OymhP') _0x29b260[_0x561ee3(0xa85)][_0x2e0ce9][_0x561ee3(0x382)] = !![], _0x3254df(); else try { const _0x385e84 = _0x416e67['createObjectURL'](_0x55e140), _0x30297e = _0x561ee3(0x1da), _0x34ee61 = _0x561ee3(0x363) + _0x30297e + _0x561ee3(0x1a5) + _0x385e84 + _0x561ee3(0x905); _0x3269d['innerHTML'] = _0x34ee61, _0x2b359e[_0x561ee3(0x204)][_0x561ee3(0x80f)][_0x561ee3(0x52c)](_0x561ee3(0x31e), '\x27' + _0x30297e + '\x27'), _0x4c4720['textContent'] = _0x561ee3(0x66e); } catch (_0x4db0e8) { _0x5a9581[_0x561ee3(0x297)](_0x561ee3(0x242), _0x4db0e8), _0x569806('哼，你这字体文件有问题，用不了。'); } } _0x195491(![]), _0x2230f5(_0x4306d7, [_0x4306d7]), _0x207d77(_0x314856, !![]); } function _0x2f0b2f() { const _0x3eae94 = _0x187760, _0x20b1d7 = _0x29b260['chats'][_0x3eae94(0x444)](_0x1abcca => _0x1abcca[_0x3eae94(0x9e8)] && _0x1abcca[_0x3eae94(0x9e8)][_0x3eae94(0x705)]); _0x20b1d7 && (_0x3eae94(0x982) === _0x3eae94(0x902) ? (_0x232da2['classList'][_0x3eae94(0x41a)](_0x3eae94(0x552), 'is-exiting-right'), _0x2aaf9e[_0x3eae94(0x969)]['remove']('is-entering-from-left'), _0x340c65['diaryCurrentPage'] = _0x2f8ad9, _0x402d2d(), _0x5eb1ef[_0x3eae94(0x42c)] = ![]) : (_0x20b1d7[_0x3eae94(0x9e8)] = null, _0xf10e4a(), _0xeba69d(_0x3eae94(0xa1e)), _0x207d77(), _0x54e7a9[_0x3eae94(0x969)][_0x3eae94(0x41a)]('show'), setTimeout(() => _0x54e7a9[_0x3eae94(0x80f)][_0x3eae94(0x3e7)] = _0x3eae94(0x697), 0x12c))); } function _0x55d2ab(_0x1085d9) { const _0x5eb4a2 = _0x187760; if (!_0x1085d9) return []; const _0x1de49a = _0x1085d9[_0x5eb4a2(0x77e)]('\x0a'), _0x38a5b0 = [], _0x324c6a = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x4df8d6 of _0x1de49a) { const _0x7a2103 = _0x4df8d6[_0x5eb4a2(0x6d2)](_0x324c6a); if (_0x7a2103) { const _0x378fb8 = parseInt(_0x7a2103[0x1], 0xa), _0x48c11e = parseInt(_0x7a2103[0x2], 0xa), _0x32d510 = parseInt(_0x7a2103[0x3], 0xa) * (_0x7a2103[0x3][_0x5eb4a2(0x919)] === 0x2 ? 0xa : 0x1), _0x3ce828 = _0x378fb8 * 0x3c + _0x48c11e + _0x32d510 / 0x3e8, _0x1c7c8b = _0x4df8d6[_0x5eb4a2(0x998)](_0x324c6a, '')[_0x5eb4a2(0x74e)](); _0x1c7c8b && _0x38a5b0['push']({ 'time': _0x3ce828, 'text': _0x1c7c8b }); } } return _0x38a5b0; } function _0x277d47(_0x22f3ba) { const _0x2dad3a = _0x187760; if (_0x2dad3a(0x39b) === _0x2dad3a(0x39b)) { _0x29202a = _0x55d2ab(_0x22f3ba[_0x2dad3a(0x5a4)]), _0x15f234[_0x2dad3a(0x29c)] = ''; if (_0x29202a['length'] === 0x0) { _0x15f234[_0x2dad3a(0x29c)] = _0x2dad3a(0x30e); return; } _0x29202a['forEach']((_0xa092dc, _0x1c654b) => { const _0x31b46c = _0x2dad3a, _0x9e8120 = document[_0x31b46c(0xa93)]('p'); _0x9e8120[_0x31b46c(0x574)] = _0xa092dc[_0x31b46c(0x807)], _0x9e8120['id'] = _0x31b46c(0x887) + _0x1c654b, _0x15f234[_0x31b46c(0x25f)](_0x9e8120); }); } else { _0x321f65('我正在说话呢，别打岔！'); return; } } function _0x14c42c(_0x1652ce, _0xc1791f, _0x613b7d, _0x5827fa) { const _0x197908 = _0x187760; if (_0x197908(0x77d) !== 'uhSXr') { const _0x5b0859 = (_0x5827fa - 0x5a) * Math['PI'] / 0xb4; return { 'x': _0x1652ce + _0x613b7d * Math['cos'](_0x5b0859), 'y': _0xc1791f + _0x613b7d * Math[_0x197908(0x40d)](_0x5b0859) }; } else _0x5314f4[_0x197908(0x439)] && _0xf2b9d0(_0x391548[_0x197908(0x439)]); } function _0x313f14(_0x4e3f12) { const _0x1d6bad = _0x187760; if (_0x1d6bad(0x7be) !== _0x1d6bad(0x7be)) _0x3909d2[_0x1d6bad(0x297)](_0x1d6bad(0xa11), _0x311cb3), _0x3636ef(_0x1d6bad(0x543) + _0x40c48d[_0x1d6bad(0x997)]); else { const _0x42fc7e = _0x1d6bad(0x9cb), _0x4cb2af = document[_0x1d6bad(0xa48)](_0x42fc7e, _0x1d6bad(0x7fe)), _0x482191 = 0xfa, _0x16e306 = _0x482191 / 0x2, _0x36a586 = _0x482191 / 0x2, _0x32d43c = _0x482191 / 0x2 - 0x14; _0x4cb2af[_0x1d6bad(0x6fe)](_0x1d6bad(0x3fd), _0x1d6bad(0x1be)), _0x4cb2af[_0x1d6bad(0x6fe)](_0x1d6bad(0xac8), _0x1d6bad(0x1be)), _0x4cb2af['setAttribute'](_0x1d6bad(0x932), _0x1d6bad(0xa6e) + _0x482191 + '\x20' + _0x482191); const _0x1efdea = Object['values'](_0x4e3f12)[_0x1d6bad(0x56a)]((_0x504437, _0x3f5ec5) => _0x504437 + _0x3f5ec5, 0x0); if (_0x1efdea === 0x0) return _0x4cb2af; let _0x3ca12e = -0x5a; const _0x731864 = [_0x1d6bad(0x79a), _0x1d6bad(0x884), '#99ff99', _0x1d6bad(0x74d), _0x1d6bad(0x112), '#ffb366', _0x1d6bad(0x8b8), _0x1d6bad(0x3bc)]; let _0x42d069 = 0x0; for (const _0x4eb21b in _0x4e3f12) { if (_0x1d6bad(0xb22) === 'RjaWS') _0x234fd9[_0x1d6bad(0x574)] = _0x471260['title'], _0x4cc73a[_0x1d6bad(0x574)] = _0x22269f[_0x1d6bad(0x6cd)], _0x2ee658[_0x1d6bad(0x969)]['add'](_0x1d6bad(0x7ba)), _0x315db1[_0x1d6bad(0x80f)][_0x1d6bad(0x52c)]('--widget-cover-image', _0x1d6bad(0x21b) + _0x4243db[_0x1d6bad(0x194)] + ')'); else { const _0x6db7e9 = _0x4e3f12[_0x4eb21b]; if (_0x6db7e9 <= 0x0) continue; const _0x335ece = _0x6db7e9 / _0x1efdea * 0x168, _0x55821f = _0x3ca12e + _0x335ece, _0x42e190 = _0x14c42c(_0x16e306, _0x36a586, _0x32d43c, _0x55821f), _0x449478 = _0x14c42c(_0x16e306, _0x36a586, _0x32d43c, _0x3ca12e), _0x418b23 = _0x335ece > 0xb4 ? '1' : '0', _0x10e61e = ['M', _0x42e190['x'], _0x42e190['y'], 'A', _0x32d43c, _0x32d43c, 0x0, _0x418b23, 0x1, _0x449478['x'], _0x449478['y'], 'L', _0x16e306, _0x36a586, 'Z'][_0x1d6bad(0x63b)]('\x20'), _0x3f0bfc = document[_0x1d6bad(0xa48)](_0x42fc7e, _0x1d6bad(0x757)); _0x3f0bfc[_0x1d6bad(0x6fe)]('d', _0x10e61e), _0x3f0bfc[_0x1d6bad(0x6fe)](_0x1d6bad(0x69d), _0x731864[_0x42d069 % _0x731864['length']]), _0x42d069++; const _0x33a3a8 = document[_0x1d6bad(0xa48)](_0x42fc7e, _0x1d6bad(0x640)); _0x33a3a8[_0x1d6bad(0x574)] = _0x4eb21b + ':\x20' + _0x6db7e9[_0x1d6bad(0x394)](0x2) + '\x20(' + (_0x6db7e9 / _0x1efdea * 0x64)[_0x1d6bad(0x394)](0x1) + '%)', _0x3f0bfc[_0x1d6bad(0x25f)](_0x33a3a8), _0x4cb2af['appendChild'](_0x3f0bfc), _0x3ca12e = _0x55821f; } } return _0x4cb2af; } } function _0x5d362b() { const _0x18915e = _0x187760; if ('ObOpM' === 'OvuRT') { const _0x4bafeb = _0x173ac4[_0x18915e(0x3db)][_0x18915e(0x444)](_0x209f02 => _0x209f02['id'] === _0x1f0200); _0x12e392['value'] = _0x4bafeb[_0x18915e(0x85f)] || '', _0x2c14a4['value'] = _0x4bafeb['userAvatarFrameUrl'] || ''; if (_0x338bd4) _0x2d5a14[_0x18915e(0x80f)]['backgroundImage'] = _0x4bafeb[_0x18915e(0x85f)] ? _0x18915e(0x22e) + _0x4bafeb['avatarFrameUrl'] + '\x27)' : ''; } else { if (_0x29202a[_0x18915e(0x919)] === 0x0) return; const _0x4adad5 = _0x57146d['currentTime']; let _0x196fb3 = -0x1; for (let _0x3750e1 = 0x0; _0x3750e1 < _0x29202a[_0x18915e(0x919)]; _0x3750e1++) { if (_0x4adad5 >= _0x29202a[_0x3750e1][_0x18915e(0x5e0)]) _0x196fb3 = _0x3750e1; else break; } if (_0x196fb3 !== -0x1) { const _0x2cd4a8 = _0x15f234['querySelectorAll']('p'); _0x2cd4a8[_0x18915e(0xa3d)](_0x488896 => _0x488896[_0x18915e(0x969)]['remove'](_0x18915e(0x691))); const _0x314045 = document['getElementById'](_0x18915e(0x887) + _0x196fb3); if (_0x314045) { if (_0x18915e(0x278) !== 'eyfIM') _0x314045[_0x18915e(0x969)]['add'](_0x18915e(0x691)), _0x314045['scrollIntoView']({ 'behavior': _0x18915e(0x9da), 'block': _0x18915e(0x37e) }); else { const _0x19b260 = _0x2b452a[_0x10c297]; _0x270b2d(_0x19b260); } } } } } _0xed1ebf[_0x187760(0x6cc)]('click', () => { const _0x249b05 = _0x187760; _0x54e7a9[_0x249b05(0x969)]['remove']('show'), setTimeout(() => _0x54e7a9['style'][_0x249b05(0x3e7)] = 'none', 0x12c); }), document[_0x187760(0x759)](_0x187760(0x8ab))[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x15e885 = _0x187760; if (_0x29b260['listenTogetherSession'] && _0x29b260['listenTogetherSession'][_0x15e885(0x705)]) { if (_0x15e885(0x6d8) !== 'AvEyI') { const _0x5bd01b = _0x18b84c[_0x15e885(0x759)](_0x15e885(0x782)); if (_0x5bd01b) _0x5bd01b[_0x15e885(0x574)] = '▶'; } else _0x54e7a9[_0x15e885(0x80f)][_0x15e885(0x3e7)] = _0x15e885(0x868), setTimeout(() => _0x54e7a9[_0x15e885(0x969)][_0x15e885(0x944)](_0x15e885(0x459)), 0xa); } }), _0x57146d[_0x187760(0x6cc)](_0x187760(0x6cb), _0x5d362b); const _0x1e6e7f = document[_0x187760(0x759)]('widget-play-pause-btn'), _0x51c9be = document[_0x187760(0x759)](_0x187760(0x7e2)), _0x528a27 = document[_0x187760(0x759)]('widget-prev-btn'); _0x1e6e7f[_0x187760(0x6cc)]('click', () => { const _0x28edb7 = _0x187760; _0x57146d[_0x28edb7(0x686)] && (_0x28edb7(0x980) === 'ZoeQI' ? _0x57146d[_0x28edb7(0x449)] ? _0x57146d['play']() : _0x57146d['pause']() : _0x2fb7d7 = _0x3dad36(() => { const _0x146efc = _0x28edb7; if (_0x272f52['type'] === _0x146efc(0x536)) _0x537c36[_0x146efc(0xac9)](); _0x38c21c(_0x34f6d5); }, 0x320)); }), _0x51c9be[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x5c0baf = _0x187760; if (_0x2055dd[_0x5c0baf(0x919)] === 0x0) return; _0x10b124 = (_0x10b124 + 0x1) % _0x2055dd[_0x5c0baf(0x919)], _0x2230f5(_0x2055dd[_0x10b124], _0x2055dd); }), _0x528a27[_0x187760(0x6cc)]('click', () => { const _0x51f90d = _0x187760; if (_0x2055dd[_0x51f90d(0x919)] === 0x0) return; _0x10b124 = (_0x10b124 - 0x1 + _0x2055dd[_0x51f90d(0x919)]) % _0x2055dd[_0x51f90d(0x919)], _0x2230f5(_0x2055dd[_0x10b124], _0x2055dd); }), _0x57146d[_0x187760(0x6cc)](_0x187760(0x5ca), () => { const _0x539226 = _0x187760; _0x1e6e7f[_0x539226(0x574)] = '❚❚'; }), _0x57146d[_0x187760(0x6cc)]('pause', () => { const _0x440590 = _0x187760; _0x1e6e7f[_0x440590(0x574)] = '▶'; }), _0x57146d[_0x187760(0x6cc)](_0x187760(0x695), () => { const _0x59c21f = _0x187760; if (_0x59c21f(0x3e8) !== _0x59c21f(0x3e8)) { const _0x38bf51 = _0x29cade['getElementById'](_0x59c21f(0x29d)), _0x3ad617 = _0x45ef7b['getElementById']('galgame-view-container'), _0x35fda9 = _0x131d63[_0x59c21f(0xa01)](_0x59c21f(0xada)); _0x4c407a[_0x59c21f(0x584)] === _0x59c21f(0x737) ? (_0x38bf51[_0x59c21f(0x80f)]['display'] = _0x59c21f(0x697), _0x3ad617[_0x59c21f(0x80f)][_0x59c21f(0x3e7)] = 'block') : (_0x38bf51['style'][_0x59c21f(0x3e7)] = _0x59c21f(0x210), _0x3ad617[_0x59c21f(0x80f)][_0x59c21f(0x3e7)] = _0x59c21f(0x697)), _0x35fda9[_0x59c21f(0x80f)][_0x59c21f(0x3e7)] = _0x59c21f(0x210); } else _0x51c9be[_0x59c21f(0x7ec)](); }), _0x57146d['addEventListener'](_0x187760(0x5ca), () => { const _0x1b386a = _0x187760, _0x4280da = document[_0x1b386a(0x759)](_0x1b386a(0x782)); if (_0x4280da) _0x4280da['textContent'] = '❚❚'; }), _0x57146d['addEventListener']('pause', () => { const _0x1bb5b2 = _0x187760, _0x27b5dd = document[_0x1bb5b2(0x759)](_0x1bb5b2(0x782)); if (_0x27b5dd) _0x27b5dd[_0x1bb5b2(0x574)] = '▶'; }), _0x57146d[_0x187760(0x6cc)](_0x187760(0x695), () => { const _0x174788 = _0x187760, _0x1eabd0 = document[_0x174788(0x759)](_0x174788(0x17f)); _0x1eabd0 && _0x1eabd0[_0x174788(0x7ec)](); }); function _0x6e8fca(_0x297906) { const _0x441fbe = _0x187760; if ('aBrSm' !== _0x441fbe(0x138)) { const _0xc197da = _0x9b2042[_0x441fbe(0x22b)] === _0xed4fc9(_0x46666a[_0x441fbe(0x7b1)])['id'] ? _0x343beb(_0x2646d8[_0x441fbe(0x7b1)]) : _0xdd503d(_0x42d7c3[_0x441fbe(0x22b)]); _0x32ee94[_0x441fbe(0x37b)](_0xbb7938, { 'type': _0x441fbe(0x1ce), 'amount': _0x1f317b[_0x441fbe(0x549)], 'recipientId': _0x17a8e9[_0x441fbe(0x22b)], 'content': _0x441fbe(0x596) + (_0xc197da?.[_0x441fbe(0xb15)] || '未知') + _0x441fbe(0x21d) + _0x334618[_0x441fbe(0x549)] + ']' }); } else { if (!_0x297906 || typeof _0x297906 !== _0x441fbe(0x96c)) return null; const _0x402209 = _0x297906[_0x441fbe(0x8d5)]('['), _0x5354a8 = _0x297906[_0x441fbe(0x9bf)](']'); if (_0x402209 > -0x1 && _0x5354a8 > _0x402209) return _0x297906[_0x441fbe(0x6af)](_0x402209, _0x5354a8 + 0x1); return null; } } document[_0x187760(0x759)](_0x187760(0x888))['addEventListener']('click', () => { const _0x68832e = _0x187760; _0x68832e(0x47c) !== _0x68832e(0xad8) ? (_0xf26de(), _0x57a80a('accounting', _0x68832e(0x83c))) : (_0x1e5195[_0x68832e(0x297)](_0x68832e(0x82f), _0x25cd39), _0x1cd48a[_0x68832e(0x713)] = _0x68832e(0x807)); }), document[_0x187760(0x759)](_0x187760(0x655))[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x57a80a('home', _0x187760(0x446))); const _0x1ff296 = document[_0x187760(0x759)](_0x187760(0x1a4)), _0x428b45 = document[_0x187760(0x759)]('tab-view-ledger'); _0x1ff296[_0x187760(0x6cc)](_0x187760(0x7ec), _0xf26de), _0x428b45[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x1a4da9 = _0x187760; _0x1ff296['classList']['remove'](_0x1a4da9(0x691)), _0x428b45[_0x1a4da9(0x969)][_0x1a4da9(0x944)]('active'), _0x354ad0(); }); function _0xf26de() { const _0xc0fb5 = _0x187760; _0x428b45[_0xc0fb5(0x969)][_0xc0fb5(0x41a)](_0xc0fb5(0x691)), _0x1ff296[_0xc0fb5(0x969)][_0xc0fb5(0x944)](_0xc0fb5(0x691)), _0x2c183d(); } function _0x2c183d() { const _0x45e04f = _0x187760; if (_0x45e04f(0x858) === _0x45e04f(0x858)) { const _0x2164ee = document['getElementById'](_0x45e04f(0x68a)); document['getElementById'](_0x45e04f(0x8e1))['textContent'] = _0x45e04f(0xa7a), document['getElementById']('header-actions')[_0x45e04f(0x29c)] = '', _0x2164ee['innerHTML'] = _0x45e04f(0x9fe), _0x34c88f(), document[_0x45e04f(0x759)](_0x45e04f(0x330))[_0x45e04f(0x6cc)]('click', _0x37f963), document['getElementById'](_0x45e04f(0x6ee))['addEventListener'](_0x45e04f(0x7ec), _0x18ac50 => { const _0x5c727a = _0x45e04f; if (_0x18ac50['target']['classList']['contains'](_0x5c727a(0x224))) { const _0x496359 = _0x18ac50[_0x5c727a(0x65e)][_0x5c727a(0x2f7)]['id']; _0x5db04d(_0x5c727a(0x33f))['then'](_0x2cc8a3 => { _0x2cc8a3 && _0x8e220f(_0x496359); }); } }), document[_0x45e04f(0x759)](_0x45e04f(0x143))[_0x45e04f(0x4ee)](); } else _0x8116b8 = 'vertical'; } function _0x428bd0(_0x55d444, _0x39d8d2) { const _0x18e3fc = _0x187760, _0x104a82 = document[_0x18e3fc(0x759)](_0x18e3fc(0x68a)), _0x37af87 = document[_0x18e3fc(0x759)](_0x18e3fc(0x9e2)); document[_0x18e3fc(0x759)](_0x18e3fc(0x8e1))[_0x18e3fc(0x574)] = _0x39d8d2 + _0x18e3fc(0x16b); const _0x22d607 = _0x55d444[_0x18e3fc(0x25c)]['reduce']((_0x4163d7, _0xb9bc35) => _0x4163d7 + (_0xb9bc35[_0x18e3fc(0x549)] || 0x0), 0x0); let _0x25c70e = '<div\x20style=\x22background:\x20var(--card-bg);\x20padding:\x2020px;\x20border-radius:\x2012px;\x20text-align:\x20center;\x20border:\x201px\x20solid\x20var(--border-color);\x22><span\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x22>今日总支出\x20(元)</span><div\x20style=\x22font-size:\x202.5rem;\x20font-weight:\x20bold;\x20margin-top:\x205px;\x22>' + _0x22d607[_0x18e3fc(0x394)](0x2) + '</div></div><div\x20id=\x22categorized-expenses-list\x22\x20style=\x22margin-top:\x2010px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2010px;\x22></div>'; _0x104a82[_0x18e3fc(0x29c)] = _0x25c70e; const _0x98952a = document[_0x18e3fc(0x759)](_0x18e3fc(0x614)), _0x4ee2d6 = { '餐饮美食': _0x18e3fc(0x89f), '交通出行': _0x18e3fc(0x31d), '购物消费': '<path\x20d=\x22M6\x202L3\x206v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2V6l-3-4z\x22></path><line\x20x1=\x223\x22\x20y1=\x226\x22\x20x2=\x2221\x22\x20y2=\x226\x22></line><path\x20d=\x22M16\x2010a4\x204\x200\x200\x201-8\x200\x22></path>', '生活服务': '<path\x20d=\x22m3\x209\x209-7\x209\x207v11a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2z\x22></path><polyline\x20points=\x229\x2022\x209\x2012\x2015\x2012\x2015\x2022\x22></polyline>', '休闲娱乐': _0x18e3fc(0x4b1), '医疗健康': _0x18e3fc(0x4fc), '人情红包': _0x18e3fc(0x397), '其他杂项': _0x18e3fc(0x1c2), '默认': _0x18e3fc(0x49e) }; _0x55d444[_0x18e3fc(0x25c)][_0x18e3fc(0xa3d)](_0x27d6a1 => { const _0x21a9e3 = _0x18e3fc; if (_0x21a9e3(0x126) === _0x21a9e3(0x126)) { const _0x38a49c = document[_0x21a9e3(0xa93)](_0x21a9e3(0x64e)); _0x38a49c['className'] = 'expense-item', _0x38a49c[_0x21a9e3(0x80f)][_0x21a9e3(0x4f0)] = 'column', _0x38a49c[_0x21a9e3(0x80f)][_0x21a9e3(0x925)] = _0x21a9e3(0x72f), _0x38a49c[_0x21a9e3(0x80f)][_0x21a9e3(0x86e)] = _0x21a9e3(0x46d), _0x38a49c[_0x21a9e3(0x80f)][_0x21a9e3(0x645)] = '0'; const _0x278c3c = _0x4ee2d6[_0x27d6a1[_0x21a9e3(0x13c)]] || _0x4ee2d6['默认'], _0x20d30d = _0x21a9e3(0x32f) + _0x278c3c + _0x21a9e3(0x4cf), _0x10b7cd = _0x21a9e3(0x830) + _0x20d30d + _0x21a9e3(0x96d) + _0x27d6a1[_0x21a9e3(0xb16)] + _0x21a9e3(0x498) + (_0x27d6a1['category'] || '未分类') + '</div></div></div><span\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x22>-\x20' + (_0x27d6a1['amount'] || 0x0)['toFixed'](0x2) + '</span></div>'; let _0x4d7f58 = ''; if (_0x27d6a1['review'] && _0x27d6a1['review'][_0x21a9e3(0x318)]) { const _0x10720a = _0x4cc875(_0x27d6a1[_0x21a9e3(0x5d0)][_0x21a9e3(0x318)]); _0x10720a && (_0x4d7f58 = _0x21a9e3(0x878) + _0x10720a['avatar'] + _0x21a9e3(0x457) + _0x10720a[_0x21a9e3(0xb15)] + _0x21a9e3(0x6bd) + _0x27d6a1['review'][_0x21a9e3(0x807)] + _0x21a9e3(0x8be)); } _0x38a49c[_0x21a9e3(0x29c)] = _0x10b7cd + _0x4d7f58, _0x98952a[_0x21a9e3(0x25f)](_0x38a49c); } else _0x5656a9[_0x21a9e3(0x969)][_0x21a9e3(0x944)](_0x21a9e3(0x691)), _0x1483d0[_0x21a9e3(0x509)]({ 'behavior': _0x21a9e3(0x9da), 'block': _0x21a9e3(0x37e) }); }), _0x37af87[_0x18e3fc(0x29c)] = _0x18e3fc(0x633), document[_0x18e3fc(0x759)](_0x18e3fc(0xa69))[_0x18e3fc(0x6cc)]('click', async () => { const _0x15e812 = _0x18e3fc; if ('quKIh' === 'hZQJR') _0x483ff2[_0x15e812(0x438)]('[' + _0x3de9b4 + _0x15e812(0x985) + _0x1313ba(_0x2d1b38) + ']\x20' + _0x519303(_0x3ee5fd['content'])[_0x15e812(0x74e)]()); else { const _0x27b0c5 = await _0x5db04d('确定要重新记录吗？当前的账单会被删除。'); if (_0x27b0c5) { if ('nrsBl' === _0x15e812(0x1cb)) { const _0x2201d9 = _0x3af327(_0x5c1be2['participantIds'][0x0]); _0x24a52a[_0x15e812(0x574)] = _0x2201d9 ? _0x2201d9[_0x15e812(0xb15)] : _0x15e812(0x2e9); } else { const _0x1c2aca = _0x29b260['accountingLedger'][_0x39d8d2]; _0x1c2aca && _0x1c2aca['originalExpenses'] && _0x29b260[_0x15e812(0x7b0)][_0x15e812(0x438)](..._0x1c2aca[_0x15e812(0x387)]), delete _0x29b260[_0x15e812(0x72a)][_0x39d8d2], _0xf10e4a(), _0x2c183d(); } } } }); } function _0x354ad0() { const _0x2217c7 = _0x187760; if ('bCtGU' === _0x2217c7(0x133)) _0x179b90[_0x2217c7(0x554)] = { ..._0x5b574d[_0x2217c7(0x7d9)] }; else { const _0x47c3ff = document['getElementById'](_0x2217c7(0x68a)); document[_0x2217c7(0x759)](_0x2217c7(0x8e1))[_0x2217c7(0x574)] = '账本', document[_0x2217c7(0x759)]('header-actions')[_0x2217c7(0x29c)] = ''; const _0x4d56e1 = Object['keys'](_0x29b260[_0x2217c7(0x72a)])[_0x2217c7(0x8d8)]((_0x2fcf2c, _0x1b923b) => new Date(_0x1b923b) - new Date(_0x2fcf2c)); if (_0x4d56e1[_0x2217c7(0x919)] === 0x0) { _0x47c3ff[_0x2217c7(0x29c)] = _0x2217c7(0xa91); return; } _0x47c3ff[_0x2217c7(0x29c)] = '', _0x4d56e1['forEach'](_0x335625 => { const _0x5b93db = _0x2217c7, _0x392071 = document[_0x5b93db(0xa93)]('div'); _0x392071[_0x5b93db(0x8bd)] = 'expense-item', _0x392071['style']['cursor'] = _0x5b93db(0x4d8); const _0x5542a2 = _0x29b260[_0x5b93db(0x72a)][_0x335625], _0xb682dc = _0x5542a2['categorizedExpenses']['reduce']((_0xb0f93b, _0x2ca313) => _0xb0f93b + (_0x2ca313['amount'] || 0x0), 0x0); _0x392071[_0x5b93db(0x29c)] = _0x5b93db(0x466) + _0x335625 + _0x5b93db(0x162) + _0xb682dc['toFixed'](0x2) + _0x5b93db(0x69c), _0x392071['addEventListener'](_0x5b93db(0x7ec), () => { const _0x2a1672 = _0x5b93db; _0x1ff296['classList'][_0x2a1672(0x41a)](_0x2a1672(0x691)), _0x428b45['classList'][_0x2a1672(0x944)](_0x2a1672(0x691)), _0x428bd0(_0x5542a2, _0x335625); }), _0x47c3ff[_0x5b93db(0x25f)](_0x392071); }); } } function _0x37f963() { const _0x260d55 = _0x187760; if (_0x260d55(0xa32) !== _0x260d55(0xa32)) { const _0x50ee5a = _0x5c8783['value']; _0x950b2f[_0x260d55(0x204)][_0x260d55(0x80f)]['setProperty'](_0x260d55(0x471), _0x50ee5a + '%'), _0x5eb7a2[_0x260d55(0x2f5)]('themeLightness', _0x50ee5a), _0x1b67a3(); } else { const _0x28e9a3 = document[_0x260d55(0x759)]('expense-description'), _0x2c1d58 = document[_0x260d55(0x759)](_0x260d55(0x9e9)), _0x41b57b = _0x28e9a3[_0x260d55(0xa03)][_0x260d55(0x74e)](), _0x3a78f2 = parseFloat(_0x2c1d58[_0x260d55(0xa03)]); if (!_0x41b57b || isNaN(_0x3a78f2) || _0x3a78f2 <= 0x0) { _0xeba69d('哼，不好好写清楚花在哪、花了多少，我怎么记？'); return; } _0x29b260[_0x260d55(0x7b0)][_0x260d55(0x438)]({ 'id': 'exp_' + Date['now'](), 'description': _0x41b57b, 'amount': _0x3a78f2, 'timestamp': Date['now']() }), _0xf10e4a(), _0x34c88f(), _0x28e9a3[_0x260d55(0xa03)] = '', _0x2c1d58[_0x260d55(0xa03)] = '', _0x28e9a3[_0x260d55(0x4ee)](); } } function _0x8e220f(_0x1eae46) { const _0x162b0d = _0x187760; if (_0x162b0d(0x2f0) === 'TjUDD') { const _0x39a3e6 = _0x29b260[_0x162b0d(0x7b0)][_0x162b0d(0x961)](_0x481061 => _0x481061['id'] === _0x1eae46); _0x39a3e6 > -0x1 && (_0x29b260[_0x162b0d(0x7b0)][_0x162b0d(0x903)](_0x39a3e6, 0x1), _0xf10e4a(), _0x34c88f()); } else { const _0x3af7f5 = _0x214fe2[_0x162b0d(0x95f)](_0xe09295, _0x162b0d(0x236)), _0x22e1ce = _0x3af7f5[_0x162b0d(0x4d6)](_0x3752b7), _0x10c776 = _0x22e1ce[_0x162b0d(0xaed)]({ 'id': _0x13e36f, 'data': _0x1d4d72 }); _0x10c776['onsuccess'] = () => _0x190419(), _0x10c776[_0x162b0d(0x634)] = () => _0x3e243b(_0x10c776[_0x162b0d(0x297)]); } } function _0x34c88f() { const _0x2769d9 = _0x187760, _0x34fa63 = document[_0x2769d9(0x759)](_0x2769d9(0x6ee)), _0x1cc1d3 = document[_0x2769d9(0x759)]('organize-button-container'), _0x2e9b8e = new Date(), _0x2738a4 = _0x29b260[_0x2769d9(0x7b0)][_0x2769d9(0x9f6)](_0x494b82 => new Date(_0x494b82[_0x2769d9(0x6de)])['toDateString']() === _0x2e9b8e[_0x2769d9(0x9a6)]()); if (_0x2738a4[_0x2769d9(0x919)] === 0x0) { if (_0x2769d9(0x168) !== _0x2769d9(0x854)) { _0x34fa63[_0x2769d9(0x29c)] = _0x2769d9(0x9a1), _0x1cc1d3[_0x2769d9(0x29c)] = ''; return; } else try { const _0x53f651 = _0x3ab4fb['parse'](_0x56e0a2); _0x30bb62[_0x2769d9(0xac4)](_0x53f651) && (_0x7f851b[_0x2769d9(0xa03)] = _0x53f651[_0x2769d9(0xa96)](_0x18e542 => _0x18e542['name'] + '--' + _0x18e542[_0x2769d9(0x8b7)])[_0x2769d9(0x63b)]('\x0a')); } catch (_0x643bfa) { } } _0x34fa63['innerHTML'] = '', _0x2738a4[_0x2769d9(0x8d8)]((_0x5aa7e0, _0x11140a) => _0x11140a[_0x2769d9(0x6de)] - _0x5aa7e0[_0x2769d9(0x6de)])[_0x2769d9(0xa3d)](_0x373346 => { const _0x1436cc = _0x2769d9, _0x43dc84 = document[_0x1436cc(0xa93)](_0x1436cc(0x64e)); _0x43dc84[_0x1436cc(0x8bd)] = 'expense-item', _0x43dc84['innerHTML'] = _0x1436cc(0x466) + _0x373346[_0x1436cc(0xb16)] + _0x1436cc(0x635) + _0x373346[_0x1436cc(0x549)][_0x1436cc(0x394)](0x2) + _0x1436cc(0x1ee) + _0x373346['id'] + _0x1436cc(0x921), _0x34fa63['appendChild'](_0x43dc84); }), _0x1cc1d3 && (_0x1cc1d3['innerHTML'] = _0x2769d9(0x413), document[_0x2769d9(0x759)](_0x2769d9(0xa8e))['addEventListener'](_0x2769d9(0x7ec), _0x44a40d)); } async function _0x44a40d() { const _0x59e71d = _0x187760; if (_0x59e71d(0x145) === _0x59e71d(0x886)) { const _0x4dae35 = _0x4d0a56[_0x59e71d(0xa93)]('p'); _0x4dae35[_0x59e71d(0x80f)][_0x59e71d(0x71d)] = _0x59e71d(0x6e3), _0x4dae35[_0x59e71d(0x574)] = _0xeff6eb, _0x572ee7[_0x59e71d(0x25f)](_0x4dae35); } else { const _0x5606d3 = new Date(), _0x5405f2 = _0x5606d3[_0x59e71d(0xb29)]() + '-' + String(_0x5606d3[_0x59e71d(0x950)]() + 0x1)[_0x59e71d(0x27e)](0x2, '0') + '-' + String(_0x5606d3[_0x59e71d(0x3de)]())['padStart'](0x2, '0'); if (_0x29b260[_0x59e71d(0x72a)][_0x5405f2]) { _0xeba69d('已经生成了今日账单！想看就去“看账本”标签页。'); return; } const _0x5df3f4 = _0x29b260['accountingData']['filter'](_0x33ac6a => new Date(_0x33ac6a[_0x59e71d(0x6de)])[_0x59e71d(0x9a6)]() === _0x5606d3['toDateString']()); if (_0x5df3f4[_0x59e71d(0x919)] === 0x0) { if (_0x59e71d(0x9b4) === _0x59e71d(0x7ce)) _0x3b4366 += '-\x20你的备忘录里有一条叫“' + _0xe7d123['title'] + '”的笔记，内容是：“' + _0x325248[_0x59e71d(0x359)][_0x59e71d(0x998)](/\n/g, '\x20') + _0x59e71d(0x18d); else { _0xeba69d(_0x59e71d(0x627)); return; } } _0x195491(!![], '正在整理…'); try { const _0x57c57b = [_0x59e71d(0x930), _0x59e71d(0x8eb), _0x59e71d(0x9f2), _0x59e71d(0x942), '休闲娱乐', _0x59e71d(0x2b2), _0x59e71d(0x259), '其他杂项'], _0x56d0c5 = _0x5df3f4[_0x59e71d(0xa96)](_0x46ff5c => '-\x20' + _0x46ff5c[_0x59e71d(0xb16)] + ':\x20' + _0x46ff5c['amount'])['join']('\x0a'), _0x51fbb0 = _0x29b260[_0x59e71d(0x3db)][_0x59e71d(0xa96)](_0x178d77 => { const _0x1ccb7c = _0x59e71d, _0x33b7bc = _0x29b260['chats'][_0x1ccb7c(0x444)](_0x198b04 => _0x198b04[_0x1ccb7c(0x713)] === _0x1ccb7c(0x7ad) && _0x198b04['participantIds'][_0x1ccb7c(0x4da)](_0x178d77['id'])), _0x38f469 = _0x29b260[_0x1ccb7c(0x44f)][_0x1ccb7c(0x444)](_0x26785f => _0x26785f['id'] === (_0x33b7bc?.[_0x1ccb7c(0x515)] || _0x29b260[_0x1ccb7c(0x113)])) || { 'id': 'default', 'name': '你' }; let _0x564f41 = ''; return _0x178d77[_0x1ccb7c(0x5c0)] && _0x178d77[_0x1ccb7c(0x5c0)]['length'] > 0x0 && (_0x564f41 = _0x178d77[_0x1ccb7c(0x5c0)][_0x1ccb7c(0xa96)](_0x4a596c => _0x29b260[_0x1ccb7c(0x1a1)][_0x1ccb7c(0x444)](_0x4f62dd => _0x4f62dd['id'] === _0x4a596c))[_0x1ccb7c(0x9f6)](Boolean)[_0x1ccb7c(0xa96)](_0x3e9720 => '\x0a\x20\x20\x20\x20-\x20世界书[' + _0x3e9720[_0x1ccb7c(0xb15)] + _0x1ccb7c(0x15e) + _0x3e9720['content'])[_0x1ccb7c(0x63b)]('')), _0x1ccb7c(0x26e) + _0x178d77['id'] + '\x0a\x20\x20\x20\x20姓名:\x20' + _0x178d77[_0x1ccb7c(0xb15)] + _0x1ccb7c(0x52b) + _0x178d77[_0x1ccb7c(0x435)] + '\x0a\x20\x20\x20\x20绑定用户:\x20' + _0x38f469[_0x1ccb7c(0xb15)] + _0x1ccb7c(0x514) + _0x38f469['id'] + ')\x0a' + _0x564f41; })[_0x59e71d(0x63b)]('\x0a'), _0x3fe8a5 = _0x29b260[_0x59e71d(0x44f)][_0x59e71d(0xa96)](_0x51e0f6 => _0x59e71d(0x37a) + _0x51e0f6['id'] + _0x59e71d(0x421) + _0x51e0f6['name'] + _0x59e71d(0x52b) + (_0x51e0f6[_0x59e71d(0x435)] || '无'))[_0x59e71d(0x63b)]('\x0a'), _0x1af7d3 = _0x59e71d(0x559), _0x596be0 = _0x59e71d(0xa59) + _0x57c57b['join'](',\x20') + _0x59e71d(0x8d9) + _0x51fbb0 + _0x59e71d(0x2d6) + _0x3fe8a5 + _0x59e71d(0x4a3) + _0x56d0c5, _0x2a541d = [{ 'role': _0x59e71d(0x4c2), 'content': _0x1af7d3 }, { 'role': _0x59e71d(0x544), 'content': _0x596be0 }], _0x5a9f55 = await _0x315051(_0x2a541d, { 'json': !![] }), _0x8c8a9a = _0x6e8fca(_0x5a9f55); if (!_0x8c8a9a) throw new Error('AI返回的内容里找不到有效的JSON数组。原始回复:\x20' + _0x5a9f55); const _0xf95fa9 = JSON[_0x59e71d(0x1db)](_0x8c8a9a); _0x29b260[_0x59e71d(0x72a)][_0x5405f2] = { 'categorizedExpenses': _0xf95fa9, 'timestamp': Date[_0x59e71d(0x74c)](), 'originalExpenses': _0x5df3f4 }, _0x29b260[_0x59e71d(0x7b0)] = _0x29b260[_0x59e71d(0x7b0)]['filter'](_0x445c72 => new Date(_0x445c72[_0x59e71d(0x6de)])['toDateString']() !== _0x5606d3[_0x59e71d(0x9a6)]()), _0xf10e4a(), _0x428bd0(_0x29b260[_0x59e71d(0x72a)][_0x5405f2], _0x5405f2); } catch (_0x6645d5) { _0xeba69d(_0x59e71d(0x319) + _0x6645d5[_0x59e71d(0x997)]); } finally { _0x195491(![]); } } } async function _0x4058db() { const _0x2d09c2 = _0x187760, _0x9abe2e = [..._0x2919f3]; try { const _0x30a1f9 = localStorage['getItem'](_0x2d09c2(0x21e)); if (_0x30a1f9) { const _0x2c3923 = JSON[_0x2d09c2(0x1db)](_0x30a1f9); Array[_0x2d09c2(0xac4)](_0x2c3923) ? _0x53fca2 = [..._0x9abe2e, ..._0x2c3923] : _0x53fca2 = _0x9abe2e; } else _0x2d09c2(0x773) !== 'HOmYM' ? _0x53fca2 = _0x9abe2e : (_0x2c9e84[_0x2d09c2(0x574)] = '近期没有特别安排', _0x18ddc1[_0x2d09c2(0x29c)] = _0x2d09c2(0x64c)); } catch (_0x3b137a) { console[_0x2d09c2(0x297)]('加载自定义表情包失败，真是没用。', _0x3b137a), _0x53fca2 = _0x9abe2e; } if (!localStorage[_0x2d09c2(0x860)]('noir_data_migration_v1_complete')) { if (_0x2d09c2(0x6aa) === _0x2d09c2(0x6aa)) { _0x5db04d('检测到旧版聊天数据，为了优化体验和存储空间，需要进行一次自动升级。过程很快，请稍候。')[_0x2d09c2(0x276)](async _0x371fa9 => { const _0x1db1f3 = _0x2d09c2; if ('vQyyB' === _0x1db1f3(0xaac)) { if (_0x371fa9) { if (_0x1db1f3(0x7f5) === _0x1db1f3(0x5cd)) return []; else _0x195491(!![], _0x1db1f3(0x1c9)), await _0x4df8e9(), localStorage[_0x1db1f3(0x2f5)](_0x1db1f3(0x7d4), 'true'), _0x195491(![]), _0xeba69d(_0x1db1f3(0x703)), setTimeout(() => location[_0x1db1f3(0x1a8)](), 0x5dc); } else _0x1db1f3(0x9b9) === 'XRdYw' ? _0xeba69d(_0x1db1f3(0x575)) : _0x47367d += _0x1db1f3(0x4ac); } else throw _0x3bbc8a; }); return; } else _0x3ce8a4(); } if (!localStorage[_0x2d09c2(0x860)]('noir_migration_fc_v1_complete')) { console[_0x2d09c2(0xa05)](_0x2d09c2(0x57f)), _0x195491(!![], _0x2d09c2(0x335)); const _0xfe7795 = await _0x704784(); localStorage[_0x2d09c2(0x2f5)](_0x2d09c2(0xb33), 'true'), _0x195491(![]); if (_0xfe7795 > 0x0) { _0xeba69d('好友圈数据升级完成，迁移了\x20' + _0xfe7795 + '\x20张旧图片。应用即将刷新。'), setTimeout(() => location[_0x2d09c2(0x1a8)](), 0x5dc); return; } } if (!localStorage[_0x2d09c2(0x860)](_0x2d09c2(0xb33))) { } if (!localStorage['getItem'](_0x2d09c2(0xa20))) { if (_0x2d09c2(0x2bd) !== _0x2d09c2(0x2bd)) { _0x51721f[_0x2d09c2(0x969)][_0x2d09c2(0x944)](_0x2d09c2(0x3b5)); const _0x5ee075 = _0xf50952['createElement'](_0x2d09c2(0x36b)); _0x5ee075['src'] = _0x465db5, _0x5ee075[_0x2d09c2(0x969)][_0x2d09c2(0x944)](_0x2d09c2(0x78f)), _0x192aff[_0x2d09c2(0x25f)](_0x5ee075); } else { console['log'](_0x2d09c2(0x54d)), _0x195491(!![], _0x2d09c2(0xa8c)); const _0x4041dd = await _0x511789(); localStorage[_0x2d09c2(0x2f5)](_0x2d09c2(0xa20), _0x2d09c2(0x68f)), _0x195491(![]); if (_0x4041dd > 0x0) { _0xeba69d('音乐数据升级完成，迁移了\x20' + _0x4041dd + _0x2d09c2(0x2b9)), setTimeout(() => location[_0x2d09c2(0x1a8)](), 0x5dc); return; } } } const _0x2a156f = document['getElementById'](_0x2d09c2(0x12b)); _0x2a156f[_0x2d09c2(0x6cc)](_0x2d09c2(0x7ec), () => { const _0x4810a8 = _0x2d09c2; _0x5f2229(), _0x57a80a('snoopList', _0x4810a8(0x83c)); }); const _0x4d3ac7 = _0x222b7b(); try { const _0x3c37b7 = localStorage[_0x2d09c2(0x860)](_0x2d09c2(0x392)); if (_0x3c37b7) { const _0x358574 = JSON[_0x2d09c2(0x1db)](_0x3c37b7); _0x358574[_0x2d09c2(0x72a)] && (_0x29b260[_0x2d09c2(0x72a)] = _0x358574[_0x2d09c2(0x72a)], console[_0x2d09c2(0xa05)](_0x2d09c2(0x3a0))); } } catch (_0x41e793) { if ('RXhZv' !== _0x2d09c2(0xaa8)) console[_0x2d09c2(0x297)]('Noir\x27s\x20Temporal\x20Patch\x20failed:', _0x41e793); else { _0x54a017(_0x2d09c2(0x5e8)); return; } } _0x500b8d(), _0x4dc80b(), _0x2dc45a(), _0x3593cc(), _0x51a1f4(), _0xf56761(), _0x467f30(), _0x3a0fb2(), _0x482d4c(), _0x238ab8(), _0x21dd0a(), _0x207d77(), _0x40236b(), setInterval(_0x40236b, 0x7530), _0x353850(), _0x25cb93(), _0x10d321(); const _0x3f5836 = document[_0x2d09c2(0x759)](_0x2d09c2(0x760)); document[_0x2d09c2(0x759)](_0x2d09c2(0x8ab))[_0x2d09c2(0x6cc)](_0x2d09c2(0x7ec), function (_0x3404a0) { const _0x6d2938 = _0x2d09c2; if (_0x3404a0['target']['closest']('button')) return; const _0x4541f8 = document[_0x6d2938(0x759)](_0x6d2938(0x953)); _0x4541f8 && _0x4541f8[_0x6d2938(0x7ec)](); }), _0x57a80a('home', _0x2d09c2(0x7f7)); (_0x4d3ac7 || _0x29b260[_0x2d09c2(0x3db)]['length'] === 0x0) && (_0xeba69d(_0x2d09c2(0x19a)), setTimeout(() => { const _0x98d2da = _0x2d09c2; _0x57a80a(_0x98d2da(0x6b7), 'home'), setTimeout(() => _0x528a37(), 0x64); }, 0x6a4)); document[_0x2d09c2(0x759)](_0x2d09c2(0x75e))['addEventListener'](_0x2d09c2(0x7ec), _0x4646de); const _0x124dee = document[_0x2d09c2(0x759)](_0x2d09c2(0x33e)); document['getElementById'](_0x2d09c2(0x15f))[_0x2d09c2(0x6cc)](_0x2d09c2(0x7ec), () => _0x124dee['click']()), document[_0x2d09c2(0x759)]('reset-widget-bg-button')[_0x2d09c2(0x6cc)]('click', () => { const _0x33c78 = _0x2d09c2; _0x29b260[_0x33c78(0xa2a)][_0x33c78(0x33b)] = null, _0xf10e4a(), _0x353850(), _0xeba69d(_0x33c78(0x60f)); }), _0x124dee[_0x2d09c2(0x6cc)](_0x2d09c2(0x3c6), async _0x1b4057 => { const _0x35c58a = _0x2d09c2, _0xf61f5c = _0x1b4057[_0x35c58a(0x65e)][_0x35c58a(0x523)][0x0]; if (!_0xf61f5c) return; try { const _0x16b203 = await _0x8ff8c6(_0xf61f5c); _0x29b260[_0x35c58a(0xa2a)][_0x35c58a(0x33b)] = _0x16b203, _0xf10e4a(), _0x353850(), _0xeba69d(_0x35c58a(0x426)); } catch (_0x5e0ffe) { _0xeba69d(_0x35c58a(0xaf9) + _0x5e0ffe[_0x35c58a(0x997)]); } }), _0x220e99(), document[_0x2d09c2(0x759)](_0x2d09c2(0x492))['addEventListener'](_0x2d09c2(0x7ec), () => document[_0x2d09c2(0x759)]('badge-input')[_0x2d09c2(0x7ec)]()), document[_0x2d09c2(0x759)](_0x2d09c2(0x999))[_0x2d09c2(0x6cc)]('click', async () => { const _0x5c5809 = _0x2d09c2; await _0x104dbe(_0x5c5809(0x24f)), localStorage['removeItem']('badgeState'), _0x220e99(), _0xeba69d(_0x5c5809(0x166)); }), document[_0x2d09c2(0x759)]('badge-input')[_0x2d09c2(0x6cc)](_0x2d09c2(0x3c6), async _0x3ea1c7 => { const _0x3d4f9f = _0x2d09c2; if ('NhxJU' !== 'NhxJU') _0x2e1f6e[_0x3d4f9f(0x438)](_0x41d222); else { const _0x4f8e70 = _0x3ea1c7[_0x3d4f9f(0x65e)][_0x3d4f9f(0x523)][0x0]; if (!_0x4f8e70) return; try { if (_0x3d4f9f(0x478) === 'zOnbC') { const _0x415c02 = _0x39d132[_0x3d4f9f(0x759)](_0x3d4f9f(0x567)), _0xcdea4c = _0x415c02[_0x3d4f9f(0xae0)]('input:checked'), _0x6b5a68 = _0x4df4b0['querySelector'](_0x3d4f9f(0x203)); if (_0xcdea4c[_0x3d4f9f(0x919)] === 0x0) _0x6b5a68[_0x3d4f9f(0x574)] = _0x3d4f9f(0x353); else _0xcdea4c['length'] > 0x2 ? _0x6b5a68[_0x3d4f9f(0x574)] = _0x3d4f9f(0x8f4) + _0xcdea4c[_0x3d4f9f(0x919)] + '\x20项' : _0x6b5a68[_0x3d4f9f(0x574)] = _0x5824eb[_0x3d4f9f(0x742)](_0xcdea4c)[_0x3d4f9f(0xa96)](_0x48c40c => _0x48c40c[_0x3d4f9f(0x423)]['textContent'][_0x3d4f9f(0x74e)]())[_0x3d4f9f(0x63b)]('、'); } else await _0x5b0aee(_0x3d4f9f(0x24f), _0x4f8e70), await _0x220e99(), _0xeba69d(_0x3d4f9f(0x3ce)); } catch (_0x298c0e) { _0xeba69d(_0x3d4f9f(0xaf9) + _0x298c0e['message']); } } }), _0x56e4d7(), document[_0x2d09c2(0x759)]('diary-entries-container')[_0x2d09c2(0x6cc)](_0x2d09c2(0xa06), _0x62ffb3), document[_0x2d09c2(0x759)](_0x2d09c2(0x227))[_0x2d09c2(0x6cc)]('touchstart', _0x62ffb3, { 'passive': ![] }), document[_0x2d09c2(0x759)](_0x2d09c2(0x6ec))['addEventListener'](_0x2d09c2(0x7ec), () => document['getElementById']('card-input')[_0x2d09c2(0x7ec)]()), document[_0x2d09c2(0x759)](_0x2d09c2(0x8f5))[_0x2d09c2(0x6cc)]('click', async () => { const _0x24895a = _0x2d09c2; await _0x104dbe('widget_card'), localStorage['removeItem'](_0x24895a(0x632)), _0x56e4d7(), _0xeba69d(_0x24895a(0x76b)); }), document['getElementById'](_0x2d09c2(0x993))['addEventListener'](_0x2d09c2(0x3c6), async _0x65deaa => { const _0x537320 = _0x2d09c2, _0x37f125 = _0x65deaa['target'][_0x537320(0x523)][0x0]; if (!_0x37f125) return; try { await _0x5b0aee(_0x537320(0x7dd), _0x37f125), await _0x56e4d7(), _0xeba69d(_0x537320(0x8de)); } catch (_0x230f0e) { _0xeba69d(_0x537320(0xaf9) + _0x230f0e[_0x537320(0x997)]); } }), document[_0x2d09c2(0x759)](_0x2d09c2(0x12e))[_0x2d09c2(0x6cc)]('click', async () => { const _0xdcaeef = _0x2d09c2, _0x2bd6d6 = await _0x5db04d('确定要重置所有小组件的位置吗？它们会回到初始位置。'); _0x2bd6d6 && (localStorage[_0xdcaeef(0x4d2)]('badgeState'), localStorage[_0xdcaeef(0x4d2)](_0xdcaeef(0x2c3)), _0xeba69d('位置已重置，正在刷新...'), setTimeout(() => location[_0xdcaeef(0x1a8)](), 0x3e8)); }); const _0x309541 = document[_0x2d09c2(0x759)](_0x2d09c2(0xaba)); _0x309541[_0x2d09c2(0x6cc)]('click', () => { const _0x208f7c = _0x2d09c2; _0x2ab9ac(), _0x57a80a('diaryList', _0x208f7c(0x83c)); }); const _0xd2bc71 = document['getElementById'](_0x2d09c2(0x8ac)); _0xd2bc71[_0x2d09c2(0x6cc)]('click', () => { const _0x163107 = _0x2d09c2; _0x34dd60(), _0x57a80a('musicLibrary', _0x163107(0x83c)); }), document[_0x2d09c2(0x759)]('back-to-home-from-music-library')[_0x2d09c2(0x6cc)](_0x2d09c2(0x7ec), () => _0x57a80a(_0x2d09c2(0x83c), _0x2d09c2(0x218))), document[_0x2d09c2(0x759)]('back-to-home-from-diary-list')[_0x2d09c2(0x6cc)](_0x2d09c2(0x7ec), () => _0x57a80a('home', _0x2d09c2(0x61b))), document[_0x2d09c2(0x759)](_0x2d09c2(0x7de))[_0x2d09c2(0x6cc)](_0x2d09c2(0x7ec), () => { const _0x208c43 = _0x2d09c2; _0x29b260[_0x208c43(0x313)] = null, _0x57a80a(_0x208c43(0x61b), _0x208c43(0x398)); }), document['getElementById'](_0x2d09c2(0x7d0))[_0x2d09c2(0x6cc)](_0x2d09c2(0x7ec), _0x194d26), document[_0x2d09c2(0x759)](_0x2d09c2(0x248))[_0x2d09c2(0x6cc)]('click', _0x18ad35), document[_0x2d09c2(0x759)](_0x2d09c2(0x6f6))['addEventListener'](_0x2d09c2(0xa53), _0x560868 => { const _0x37a2ad = _0x2d09c2; if (_0x37a2ad(0x741) === 'NUVFQ') { if (_0x560868[_0x37a2ad(0x251)] === _0x37a2ad(0x674) && !_0x560868['shiftKey']) { if ('QhIaN' === 'LFzjL') { let _0x2aa30b = _0x39ab8e[_0x37a2ad(0xa01)]('.typing-indicator'); !_0x2aa30b && (_0x2aa30b = _0x28355a[_0x37a2ad(0xa93)]('div'), _0x2aa30b[_0x37a2ad(0x8bd)] = _0x37a2ad(0x57e), _0x2aa30b[_0x37a2ad(0x574)] = _0x37a2ad(0x557), _0x124479['appendChild'](_0x2aa30b)); } else _0x560868[_0x37a2ad(0xac9)](), _0x194d26(); } } else { if (_0x3099fd === null) return; const _0x33b613 = _0x44f945[_0x37a2ad(0xa85)][_0x5858b5]; if (!_0x33b613) return; _0x2c9cca[_0x37a2ad(0xa03)] = _0x33b613[_0x37a2ad(0x359)], _0x28df2c(), _0x5c740e[_0x37a2ad(0x969)]['add'](_0x37a2ad(0x459)), _0x1bb7b4[_0x37a2ad(0x4ee)](); } }); const _0x4dda9c = [_0x2d09c2(0x69b), _0x2d09c2(0x9e5), _0x2d09c2(0xa6a), _0x2d09c2(0x35f), _0x2d09c2(0x9cd)]; _0x4dda9c[_0x2d09c2(0xa3d)](_0x3c7914 => { const _0x350f87 = _0x2d09c2; if (_0x350f87(0x28c) === _0x350f87(0x1e5)) _0x5cc7de[_0x350f87(0xac9)](), _0x1c0e3c(); else { const _0x2cf55e = document[_0x350f87(0x759)]('char-edit-sprite-' + _0x3c7914 + '-preview'), _0x2fad7d = document['getElementById'](_0x350f87(0x9c1) + _0x3c7914 + _0x350f87(0x9d8)); _0x2cf55e && _0x2fad7d && (_0x2cf55e[_0x350f87(0x6cc)](_0x350f87(0x7ec), () => _0x2fad7d['click']()), _0x2fad7d['addEventListener']('change', _0x32ad29 => { const _0x24379a = _0x350f87, _0x149442 = _0x32ad29[_0x24379a(0x65e)][_0x24379a(0x523)][0x0]; if (!_0x149442) return; try { if (_0x24379a(0xa68) === 'FWLRD') { const _0x4ca7bc = URL[_0x24379a(0x289)](_0x149442); _0x2cf55e['style'][_0x24379a(0xad6)] = _0x24379a(0x22e) + _0x4ca7bc + '\x27)'; } else _0x1bfb6b[_0x24379a(0x8bd)] = 'narrator', _0x4d1fce[_0x24379a(0x80f)][_0x24379a(0x2b6)] = _0x24379a(0x60e), _0x3ec68d['style']['color'] = _0x24379a(0x130), _0x17fea7[_0x24379a(0x29c)] = _0x4f7b7d; } catch (_0x4597e6) { _0xeba69d('图片预览失败:\x20' + _0x4597e6[_0x24379a(0x997)]); } })); } }), document['getElementById'](_0x2d09c2(0x7b3))[_0x2d09c2(0x6cc)](_0x2d09c2(0x7ec), _0x4529da), document[_0x2d09c2(0x759)]('toggle-meeting-view-button')[_0x2d09c2(0x6cc)](_0x2d09c2(0x7ec), () => { const _0x44301d = _0x2d09c2; _0x29b260[_0x44301d(0x584)] = _0x29b260[_0x44301d(0x584)] === 'novel' ? 'galgame' : _0x44301d(0x512), _0x3f6d23(); }), document[_0x2d09c2(0x759)](_0x2d09c2(0x29d))[_0x2d09c2(0x6cc)](_0x2d09c2(0xa06), _0x44824a), document[_0x2d09c2(0x759)](_0x2d09c2(0x29d))[_0x2d09c2(0x6cc)](_0x2d09c2(0x536), _0x44824a, { 'passive': ![] }); let _0x5a7563 = null; function _0x44824a(_0x3c5328) { const _0x390c2d = _0x2d09c2; if (_0x5a7563) clearTimeout(_0x5a7563); const _0x441a1b = _0x3c5328[_0x390c2d(0x65e)][_0x390c2d(0xaa2)](_0x390c2d(0x4b4)); if (!_0x441a1b) return; const _0x312eed = parseInt(_0x441a1b[_0x390c2d(0x2f7)][_0x390c2d(0x2b0)], 0xa); if (isNaN(_0x312eed)) return; const _0x3f4f87 = () => { const _0x22be7f = _0x390c2d; _0x22be7f(0x1d2) !== _0x22be7f(0x1d2) ? (_0xfd88a7[_0x22be7f(0x297)](_0x22be7f(0x5fe) + _0x3b74b0 + _0x22be7f(0x84c) + _0x249757 + '):', _0x3005f3), _0x3ec600[_0x22be7f(0x8ff)] = null, _0x5862f3[_0x22be7f(0x3e3)] = null) : _0x5a7563 = setTimeout(() => { const _0x57f9a0 = _0x22be7f; if (_0x3c5328['type'] === _0x57f9a0(0x536)) _0x3c5328[_0x57f9a0(0xac9)](); _0x15b269(_0x312eed); }, 0x320); }, _0x26d3c9 = () => { if (_0x5a7563) clearTimeout(_0x5a7563); }; document['addEventListener']('mouseup', _0x26d3c9, { 'once': !![] }), document[_0x390c2d(0x6cc)]('mouseleave', _0x26d3c9, { 'once': !![] }), document[_0x390c2d(0x6cc)](_0x390c2d(0xa16), _0x26d3c9, { 'once': !![] }), document[_0x390c2d(0x6cc)](_0x390c2d(0xaf6), _0x26d3c9, { 'once': !![] }), _0x3f4f87(); } document['body'][_0x2d09c2(0x6cc)](_0x2d09c2(0x7ec), _0x4f867b => { const _0x15519f = _0x2d09c2; if (_0x15519f(0x4c8) !== _0x15519f(0x32d)) { const _0x3cb065 = _0x4f867b[_0x15519f(0x65e)][_0x15519f(0xaa2)]('.listen-together-card'); if (_0x3cb065) { const _0x448505 = _0x4f867b[_0x15519f(0x65e)][_0x15519f(0xaa2)](_0x15519f(0x47e)), _0x2f67f4 = _0x4f867b[_0x15519f(0x65e)][_0x15519f(0xaa2)](_0x15519f(0x25a)); if (_0x448505) _0x2f0b2f(); else { if (_0x2f67f4) { if (_0x15519f(0x47f) === _0x15519f(0x47f)) { const _0x57daee = _0x2f67f4['closest'](_0x15519f(0x424)), _0x4afa17 = _0x2f67f4['dataset'][_0x15519f(0x30c)], _0x5a7b9d = parseInt(_0x57daee['dataset'][_0x15519f(0x2b0)], 0xa); _0x408236(_0x4afa17, _0x5a7b9d, _0x3cb065); } else return (_0x356efa?.[_0x15519f(0x3db)] || [])[_0x15519f(0x444)](_0x2bd68c => _0x2bd68c['id'] === _0xb63f67); } else { const _0x5f5da6 = _0xa7e551(); _0x5f5da6 && _0x5f5da6[_0x15519f(0x9e8)] && _0x5f5da6['activeListenSession'][_0x15519f(0x705)] && (_0x54e7a9[_0x15519f(0x80f)][_0x15519f(0x3e7)] = _0x15519f(0x868), setTimeout(() => _0x54e7a9[_0x15519f(0x969)][_0x15519f(0x944)]('show'), 0xa)); } } return; } if (window[_0x15519f(0x551)]()[_0x15519f(0x37d)]()) return; const _0x57bb3a = _0x4f867b[_0x15519f(0x65e)]['closest']('.message-container'); if (_0x57bb3a && !_0x4f867b[_0x15519f(0x65e)][_0x15519f(0xaa2)](_0x15519f(0x899))) { if (_0x15519f(0xae7) !== _0x15519f(0x1e7)) { const _0x3d33ee = parseInt(_0x57bb3a[_0x15519f(0x2f7)]['historyIndex'], 0xa); !isNaN(_0x3d33ee) && _0x15b269(_0x3d33ee); } else _0x4cd83c[_0x15519f(0x80f)][_0x15519f(0x3e7)] = _0x15519f(0x697); } } else _0x2de763('音乐搜索失败:\x20' + _0x1e7796['message']); }); const _0xf99d7a = document[_0x2d09c2(0x759)]('noir-author-mark'); if (_0xf99d7a) { if ('rVaJS' !== _0x2d09c2(0x24e)) _0xf99d7a[_0x2d09c2(0x6cc)](_0x2d09c2(0x7ec), () => { const _0x304b42 = _0x2d09c2; _0xeba69d(_0x304b42(0x295)); }); else { const _0x2c09da = _0x44920a[_0x2d09c2(0xa01)]('.music-post-song-card'); _0x2c09da && _0x2c09da['addEventListener'](_0x2d09c2(0x7ec), function () { const _0xd14867 = _0x2d09c2, _0x4026ab = { 'id': _0x5a7935['id'], 'url': _0x33dae0[_0xd14867(0x3e3)] }; _0x1d7b06(this, _0x4026ab); }); } } const _0x5c30d9 = document['getElementById'](_0x2d09c2(0xa55)), _0x98bfee = localStorage[_0x2d09c2(0x860)]('customStickers'); if (_0x98bfee) try { const _0x13ce4e = JSON[_0x2d09c2(0x1db)](_0x98bfee); Array[_0x2d09c2(0xac4)](_0x13ce4e) && (_0x5c30d9[_0x2d09c2(0xa03)] = _0x13ce4e['map'](_0x4624b7 => _0x4624b7['name'] + '--' + _0x4624b7[_0x2d09c2(0x8b7)])['join']('\x0a')); } catch (_0x5617b8) { } document[_0x2d09c2(0x759)]('save-custom-stickers-button')[_0x2d09c2(0x6cc)]('click', () => { const _0x2dd471 = _0x2d09c2; if (_0x2dd471(0x91f) === _0x2dd471(0x9f3)) _0x300472[_0x2dd471(0x80f)]['backgroundImage'] = _0x2dd471(0x22e) + _0xa60ef5[_0x2dd471(0x289)](_0x288310) + '\x27)', _0x5ddebd[_0x2dd471(0x80f)][_0x2dd471(0xb0d)] = 'cover', _0x42995e[_0x2dd471(0x80f)][_0x2dd471(0x9d5)] = _0x2dd471(0x37e); else { const _0x35fa01 = _0x5c30d9[_0x2dd471(0xa03)], _0x3777cf = _0x35fa01[_0x2dd471(0x77e)]('\x0a')[_0x2dd471(0x9f6)](_0x446cb9 => _0x446cb9[_0x2dd471(0x74e)]() !== ''), _0x268646 = []; let _0x53d94f = 0x0; for (const _0x433868 of _0x3777cf) { if (_0x2dd471(0x325) === 'jnbhn') { _0x2a8bdb[_0x2dd471(0x3db)] = _0x13e659[_0x2dd471(0x3db)][_0x2dd471(0x9f6)](_0x1ce603 => _0x1ce603['id'] !== _0x58b2ed), _0x158642['chats'][_0x2dd471(0xa3d)](_0x3020ce => { const _0x4e644c = _0x2dd471; _0x3020ce['type'] === _0x4e644c(0x867) && (_0x3020ce[_0x4e644c(0x9be)] = _0x3020ce[_0x4e644c(0x9be)][_0x4e644c(0x9f6)](_0x4315ce => _0x4315ce !== _0x42b2e1)); }); const _0x5814a1 = _0x15072d[_0x2dd471(0x6df)][_0x2dd471(0x444)](_0x5637c6 => _0x5637c6[_0x2dd471(0x713)] === _0x2dd471(0x7ad) && _0x5637c6[_0x2dd471(0x9be)][_0x2dd471(0x4da)](_0x2391a0)); _0x5814a1 && _0x54d0d1(_0x5814a1['id']), _0x427345['chats'] = _0x1a5aa5[_0x2dd471(0x6df)][_0x2dd471(0x9f6)](_0x15e2d1 => _0x15e2d1[_0x2dd471(0x713)] !== _0x2dd471(0x867) || _0x15e2d1['participantIds'][_0x2dd471(0x919)] > 0x1), _0x35b264(), _0x4ed0af(); } else { const _0x5834dd = _0x433868[_0x2dd471(0x77e)]('--'); _0x5834dd[_0x2dd471(0x919)] === 0x2 && _0x5834dd[0x0][_0x2dd471(0x74e)]() && _0x5834dd[0x1][_0x2dd471(0x74e)]()[_0x2dd471(0x736)](_0x2dd471(0x5d2)) ? _0x268646['push']({ 'name': _0x5834dd[0x0][_0x2dd471(0x74e)](), 'url': _0x5834dd[0x1]['trim']() }) : _0x53d94f++; } } _0x53d94f > 0x0 && _0xeba69d('有\x20' + _0x53d94f + '\x20行格式不对，被我无视了。'); try { if ('kABUt' !== _0x2dd471(0x4f7)) localStorage[_0x2dd471(0x2f5)](_0x2dd471(0x21e), JSON[_0x2dd471(0x2a5)](_0x268646)), _0xeba69d(_0x2dd471(0x1f5)), setTimeout(() => location[_0x2dd471(0x1a8)](), 0x5dc); else { _0x2a025c = _0x95c2b4[_0x2dd471(0x6df)][_0x2dd471(0x444)](_0xfcffa5 => _0xfcffa5[_0x2dd471(0x713)] === _0x2dd471(0x7ad) && _0xfcffa5['participantIds'][_0x2dd471(0x4da)](_0x78f578)); const _0x3bae1f = _0x284700(_0x1f2754); _0x5ddb5e = _0x3bae1f ? _0x3bae1f[_0x2dd471(0xb15)] : _0x2dd471(0xa00); } } catch (_0xc54edc) { _0xeba69d('保存失败，你的表情包是不是太多了？'); } } }), _0x2989f7(), document[_0x2d09c2(0x759)](_0x2d09c2(0x9d4))[_0x2d09c2(0x6cc)](_0x2d09c2(0x7ec), () => { const _0x5a4f99 = _0x2d09c2; document[_0x5a4f99(0x759)](_0x5a4f99(0xa80))[_0x5a4f99(0x7ec)](); }), document[_0x2d09c2(0x759)](_0x2d09c2(0x5af))[_0x2d09c2(0x6cc)]('click', async () => { const _0x3a9ce8 = _0x2d09c2; if (_0x3a9ce8(0x3f3) === _0x3a9ce8(0x564)) { const _0x40de12 = _0x43f965[0x0][_0x3a9ce8(0x74e)](), _0x4929af = _0x19d21[0x1]['trim']()['replace'](/^"|"$/g, ''); _0x211105[_0x40de12] = _0x4929af; } else await _0x104dbe(_0x3a9ce8(0xa60)), localStorage[_0x3a9ce8(0x4d2)](_0x3a9ce8(0x81c)), _0x56e4d7(), _0xeba69d('卡片\x202\x20已移除。'); }), document[_0x2d09c2(0x759)](_0x2d09c2(0xa80))['addEventListener'](_0x2d09c2(0x3c6), async _0x5ac74f => { const _0x502213 = _0x2d09c2; if ('sZKFF' === _0x502213(0x7c6)) _0x3f0968['conversationHistory'][_0x442d19][_0x502213(0x382)] = !![], _0xe2f717(); else { const _0x2ade9e = _0x5ac74f['target'][_0x502213(0x523)][0x0]; if (!_0x2ade9e) return; try { await _0x5b0aee(_0x502213(0xa60), _0x2ade9e), await _0x56e4d7(), _0xeba69d(_0x502213(0x6b1)); } catch (_0x543422) { _0xeba69d(_0x502213(0xaf9) + _0x543422[_0x502213(0x997)]); } } }), _0x27d3f3(), _0x5d1f00(), _0x5bea2a(); } const _0x414125 = 'music_library'; async function _0x308184(_0x4abe2c) { const _0x29615c = await _0x3479a8; return new Promise((_0x3c7132, _0x276e9b) => { const _0x502cb3 = _0x18ce, _0x2e9a0c = _0x29615c['transaction'](_0x414125, _0x502cb3(0x8e0)), _0x5e0c27 = _0x2e9a0c['objectStore'](_0x414125), _0x120efb = _0x5e0c27[_0x502cb3(0x2fe)](_0x4abe2c); _0x120efb[_0x502cb3(0x5f6)] = () => _0x3c7132(_0x120efb[_0x502cb3(0x563)]), _0x120efb['onerror'] = () => _0x276e9b(_0x120efb[_0x502cb3(0x297)]); }); } async function _0xa46fb7() { const _0x4c68e0 = _0x187760; if (_0x4c68e0(0x794) !== _0x4c68e0(0x794)) { const _0x66914a = _0x3379c6[_0x4c68e0(0x616)] ? _0x5b4e63(_0x3e760a[_0x4c68e0(0x616)]) : null; return _0x66914a?.[_0x4c68e0(0xb15)] || _0x4c68e0(0x352); } else { const _0x1dbaaf = await _0x3479a8; return new Promise((_0x248534, _0x2e0b44) => { const _0x1d86b9 = _0x4c68e0, _0x337ca1 = _0x1dbaaf['transaction'](_0x414125, _0x1d86b9(0x8e0)), _0x40d506 = _0x337ca1[_0x1d86b9(0x4d6)](_0x414125), _0x4ba9c2 = _0x40d506[_0x1d86b9(0x3f2)](); _0x4ba9c2[_0x1d86b9(0x5f6)] = () => _0x248534(_0x4ba9c2['result']), _0x4ba9c2[_0x1d86b9(0x634)] = () => _0x2e0b44(_0x4ba9c2['error']); }); } } async function _0x180914(_0x16bb7d) { const _0x493168 = await _0x3479a8; return new Promise((_0x49b567, _0x8ce26d) => { const _0x1e77ec = _0x18ce; if (_0x1e77ec(0x2ef) !== _0x1e77ec(0x2ef)) _0x3a5d7d = _0x8f143b; else { const _0x82c01c = _0x493168[_0x1e77ec(0x95f)](_0x414125, 'readwrite'), _0x195691 = _0x82c01c[_0x1e77ec(0x4d6)](_0x414125), _0x48dd83 = _0x195691[_0x1e77ec(0xaed)](_0x16bb7d); _0x48dd83['onsuccess'] = () => _0x49b567(_0x48dd83[_0x1e77ec(0x563)]), _0x48dd83[_0x1e77ec(0x634)] = () => _0x8ce26d(_0x48dd83[_0x1e77ec(0x297)]); } }); } async function _0x4eb64f(_0x5ad7f8) { const _0x3db25e = await _0x3479a8; return new Promise((_0x1e457a, _0x50f683) => { const _0x4bdaec = _0x18ce; if (_0x4bdaec(0x9ed) !== _0x4bdaec(0x222)) { const _0x2f6e95 = _0x3db25e[_0x4bdaec(0x95f)](_0x414125, _0x4bdaec(0x236)), _0x300dca = _0x2f6e95[_0x4bdaec(0x4d6)](_0x414125), _0x16840c = _0x300dca['delete'](_0x5ad7f8); _0x16840c[_0x4bdaec(0x5f6)] = () => _0x1e457a(), _0x16840c[_0x4bdaec(0x634)] = () => _0x50f683(_0x16840c[_0x4bdaec(0x297)]); } else { _0x273405(_0x4bdaec(0x9eb)); return; } }); } let _0x5ba6af = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; const _0x49fe80 = { 'audio': document[_0x187760(0x759)]('altar-slot-audio'), 'cover': document[_0x187760(0x759)](_0x187760(0x2a2)), 'info': document[_0x187760(0x759)](_0x187760(0xb26)), 'lyrics': document['getElementById'](_0x187760(0x321)) }, _0x1100eb = { 'audio': document[_0x187760(0x759)](_0x187760(0x5f1)), 'cover': document['getElementById'](_0x187760(0x179)), 'info': document['getElementById'](_0x187760(0x69f)), 'lyrics': document['getElementById'](_0x187760(0x994)) }; for (const _0x314034 in _0x49fe80) { if (_0x187760(0x779) === 'hWeUA') return { 'type': 'sticker', 'name': _0x122e45[0x1][_0x187760(0x74e)]() }; else _0x49fe80[_0x314034][_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x1100eb[_0x314034][_0x187760(0x7ec)]()), _0x1100eb[_0x314034][_0x187760(0x6cc)](_0x187760(0x3c6), _0x48b3a4 => { const _0x3382be = _0x187760; _0xbf04c1(_0x314034, _0x48b3a4[_0x3382be(0x65e)][_0x3382be(0x523)][0x0]); }); } function _0xbf04c1(_0x42426c, _0x5c3d69) { const _0x18e39b = _0x187760; if (!_0x5c3d69) return; _0x5ba6af[_0x42426c] = _0x5c3d69, _0x49fe80[_0x42426c][_0x18e39b(0xa01)](_0x18e39b(0x7b7))[_0x18e39b(0x574)] = _0x5c3d69[_0x18e39b(0xb15)], _0x49fe80[_0x42426c][_0x18e39b(0x969)]['add']('filled'), _0x359f8a(); } function _0x359f8a() { const _0x4b9c8d = _0x187760, _0x2d00d8 = document['getElementById'](_0x4b9c8d(0x370)); _0x5ba6af[_0x4b9c8d(0x44c)] && _0x5ba6af[_0x4b9c8d(0x92c)] ? _0x2d00d8[_0x4b9c8d(0x4b9)] = ![] : _0x2d00d8['disabled'] = !![]; } function _0xe05222() { const _0x4f06e3 = _0x187760; _0x5ba6af = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x1131ac in _0x49fe80) { _0x49fe80[_0x1131ac][_0x4f06e3(0x969)][_0x4f06e3(0x41a)]('filled'), _0x1100eb[_0x1131ac][_0x4f06e3(0xa03)] = ''; } _0x49fe80[_0x4f06e3(0x44c)][_0x4f06e3(0xa01)](_0x4f06e3(0x7b7))[_0x4f06e3(0x574)] = _0x4f06e3(0x2e4), _0x49fe80['cover'][_0x4f06e3(0xa01)](_0x4f06e3(0x7b7))[_0x4f06e3(0x574)] = _0x4f06e3(0x848), _0x49fe80[_0x4f06e3(0x92c)][_0x4f06e3(0xa01)](_0x4f06e3(0x7b7))['textContent'] = _0x4f06e3(0x3dc), _0x49fe80[_0x4f06e3(0x5a4)][_0x4f06e3(0xa01)](_0x4f06e3(0x7b7))['textContent'] = _0x4f06e3(0x46c), _0x359f8a(); } document[_0x187760(0x759)](_0x187760(0x370))[_0x187760(0x6cc)](_0x187760(0x7ec), async () => { const _0x4bd940 = _0x187760; if (!_0x5ba6af[_0x4bd940(0x44c)] || !_0x5ba6af[_0x4bd940(0x92c)]) { if (_0x4bd940(0x53d) === _0x4bd940(0x53d)) { _0xeba69d(_0x4bd940(0x504)); return; } else { const _0xfb8f95 = _0x584dac['createElement'](_0x4bd940(0x64e)); _0xfb8f95[_0x4bd940(0x8bd)] = _0x4bd940(0x572), _0xfb8f95[_0x4bd940(0x80f)][_0x4bd940(0x90c)] = _0x4bd940(0x4d8); const _0x18f796 = _0x86b8b3['accountingLedger'][_0x43bca6], _0x17ba1c = _0x18f796[_0x4bd940(0x25c)]['reduce']((_0xb5d42d, _0x3addc4) => _0xb5d42d + (_0x3addc4[_0x4bd940(0x549)] || 0x0), 0x0); _0xfb8f95['innerHTML'] = _0x4bd940(0x466) + _0xa4b247 + _0x4bd940(0x162) + _0x17ba1c[_0x4bd940(0x394)](0x2) + '</span>', _0xfb8f95[_0x4bd940(0x6cc)](_0x4bd940(0x7ec), () => { const _0x10132f = _0x4bd940; _0x2655fb[_0x10132f(0x969)][_0x10132f(0x41a)](_0x10132f(0x691)), _0x2a2746[_0x10132f(0x969)][_0x10132f(0x944)](_0x10132f(0x691)), _0x3a59fc(_0x18f796, _0x5c0164); }), _0x5e9a6c[_0x4bd940(0x25f)](_0xfb8f95); } } await _0x202147(); }), document[_0x187760(0x759)](_0x187760(0xac0))['addEventListener'](_0x187760(0x7ec), () => { const _0x2e50bc = _0x187760; _0xe05222(), _0x57a80a(_0x2e50bc(0x197), _0x2e50bc(0x218)); }), document['getElementById'](_0x187760(0x872))[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x164273 = _0x187760; if ('HQhsr' === _0x164273(0x936)) _0x57a80a('musicLibrary', _0x164273(0x197)); else { _0x3b546c('条目名称和内容都不能为空！'); return; } }); async function _0x202147() { const _0x2266c8 = _0x187760; _0x195491(!![], '正在解析音乐灵魂...'); try { const _0x42f153 = await _0x5ba6af['info']['text'](); let _0x23385f; if (_0x42f153[_0x2266c8(0x74e)]()[_0x2266c8(0x736)]('{')) _0x23385f = JSON[_0x2266c8(0x1db)](_0x42f153); else { _0x23385f = {}; const _0x1e9e83 = _0x42f153['split']('\x0a'); _0x1e9e83[_0x2266c8(0xa3d)](_0x14f565 => { const _0x18bcc0 = _0x2266c8; if (_0x18bcc0(0x9b8) !== _0x18bcc0(0x9b8)) _0x32e6d2[_0x18bcc0(0x29c)] = _0x5bdc4e; else { const _0x2b64dc = _0x14f565[_0x18bcc0(0x77e)](/:\s|：\s/); if (_0x2b64dc['length'] === 0x2) { const _0x2dc608 = _0x2b64dc[0x0][_0x18bcc0(0x74e)](), _0x1ba698 = _0x2b64dc[0x1]['trim'](), _0x115e01 = { '歌名': _0x18bcc0(0x132), '艺术家': '歌手', '专辑': '专辑' }; if (_0x115e01[_0x2dc608]) { if (_0x18bcc0(0x700) !== _0x18bcc0(0x67e)) _0x23385f[_0x115e01[_0x2dc608]] = _0x1ba698; else return; } } } }); if (!_0x23385f[_0x2266c8(0x132)]) throw new Error(_0x2266c8(0x5d7)); _0x23385f[_0x2266c8(0x177)] = _0x2266c8(0x67b) + Date[_0x2266c8(0x74c)](); } const _0x10edb4 = _0x2266c8(0x67b) + (_0x23385f[_0x2266c8(0x177)] || Date[_0x2266c8(0x74c)]()), _0xc1407a = { 'id': _0x10edb4, 'info': _0x23385f, 'audio': _0x5ba6af[_0x2266c8(0x44c)], 'cover': _0x5ba6af[_0x2266c8(0x194)], 'lyrics': _0x5ba6af[_0x2266c8(0x5a4)] ? await _0x5ba6af[_0x2266c8(0x5a4)][_0x2266c8(0x807)]() : '' }; await _0x180914(_0xc1407a), await _0x34dd60(), _0x195491(![]), _0xeba69d('歌曲“' + _0x23385f[_0x2266c8(0x132)] + _0x2266c8(0x817)), _0x57a80a('musicLibrary', _0x2266c8(0x197)); } catch (_0x1a23a5) { _0x195491(![]), console[_0x2266c8(0x297)](_0x2266c8(0x75d), _0x1a23a5), _0xeba69d(_0x2266c8(0xad9) + _0x1a23a5[_0x2266c8(0x997)]); } } async function _0x34dd60() { const _0x364cd9 = _0x187760, _0x7df767 = document[_0x364cd9(0x759)]('music-library-container'); _0x7df767[_0x364cd9(0x29c)] = ''; const _0x394ab9 = await _0xa46fb7(); if (_0x394ab9['length'] === 0x0) { _0x7df767[_0x364cd9(0x29c)] = _0x364cd9(0x7e4); return; } _0x394ab9[_0x364cd9(0x8d8)]((_0x5bc8b6, _0x3b5d40) => (_0x5bc8b6[_0x364cd9(0x92c)]['歌曲名称'] || '')[_0x364cd9(0x838)](_0x3b5d40['info'][_0x364cd9(0x132)] || '')); for (const _0x184afd of _0x394ab9) { if ('EIuEp' === _0x364cd9(0x45d)) return _0x5670bd + _0x364cd9(0x857); else { const _0x510303 = document[_0x364cd9(0xa93)]('div'); _0x510303[_0x364cd9(0x8bd)] = _0x364cd9(0x568), _0x510303[_0x364cd9(0x2f7)]['songId'] = _0x184afd['id']; const _0x1acf93 = _0x184afd[_0x364cd9(0x194)] ? URL[_0x364cd9(0x289)](_0x184afd[_0x364cd9(0x194)]) : _0x461596; _0x510303[_0x364cd9(0x29c)] = _0x364cd9(0x7b9) + _0x1acf93 + _0x364cd9(0x90f) + (_0x184afd[_0x364cd9(0x92c)][_0x364cd9(0x132)] || _0x364cd9(0x125)) + _0x364cd9(0x9db) + (_0x184afd[_0x364cd9(0x92c)]['歌手'] || _0x364cd9(0x898)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; let _0x5b253d = null; const _0x112018 = _0x2bfb43 => { const _0x16bded = _0x364cd9; if (_0x2bfb43[_0x16bded(0x228)] === 0x2) return; _0x5b253d = setTimeout(async () => { const _0x5b26e5 = _0x16bded; if (_0x2bfb43['type'] === _0x5b26e5(0x536)) _0x2bfb43['preventDefault'](); const _0x163491 = await _0x5db04d(_0x5b26e5(0x895) + _0x184afd['info'][_0x5b26e5(0x132)] + _0x5b26e5(0x31f)); _0x163491 && (await _0x4eb64f(_0x184afd['id']), await _0x34dd60(), _0xeba69d(_0x5b26e5(0x5e7))); }, 0x320); }, _0x251111 = () => { const _0x35cef7 = _0x364cd9; if (_0x35cef7(0x72b) === _0x35cef7(0x72b)) clearTimeout(_0x5b253d); else { const _0x101055 = _0x1b9e45(_0x10783a); if (_0x101055) { const _0x22218a = _0x475cf8[_0x35cef7(0xa93)](_0x35cef7(0x407)); _0x22218a[_0x35cef7(0xa03)] = _0x101055['id'], _0x22218a[_0x35cef7(0x574)] = _0x101055['name'], _0x249aab[_0x35cef7(0x25f)](_0x22218a); } } }; _0x510303[_0x364cd9(0x6cc)]('mousedown', _0x112018), _0x510303['addEventListener'](_0x364cd9(0x57a), _0x251111), _0x510303[_0x364cd9(0x6cc)](_0x364cd9(0x73d), _0x251111), _0x510303[_0x364cd9(0x6cc)](_0x364cd9(0x536), _0x112018, { 'passive': ![] }), _0x510303[_0x364cd9(0x6cc)](_0x364cd9(0xa16), _0x251111), _0x510303[_0x364cd9(0x6cc)](_0x364cd9(0xaf6), _0x251111), _0x510303[_0x364cd9(0x6cc)](_0x364cd9(0x7ec), _0x1b1413 => { const _0x57e123 = _0x364cd9; if (_0x5b253d) clearTimeout(_0x5b253d); if (_0x1b1413[_0x57e123(0x47d)]) return; setTimeout(() => { const _0xf7998c = _0x57e123; _0x5b253d && _0x2230f5(_0x184afd['id'], _0x394ab9[_0xf7998c(0xa96)](_0x24a7d8 => _0x24a7d8['id'])); }, 0x32); }), _0x7df767[_0x364cd9(0x25f)](_0x510303); } } } _0x51c9be[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x5a9f3f = _0x187760; _0xeba69d(_0x5a9f3f(0x6b9)); }), _0x528a27[_0x187760(0x6cc)]('click', () => { _0xeba69d('这个也是摆设，别点了。'); }); let _0x2055dd = [], _0x10b124 = -0x1; async function _0x2230f5(_0x276eb9, _0x14e9ab) { const _0x4a9146 = _0x187760, _0x35bc4a = await _0x308184(_0x276eb9); if (!_0x35bc4a) return; _0x20c796 = { 'title': _0x35bc4a[_0x4a9146(0x92c)][_0x4a9146(0x132)] || '未知歌曲', 'artist': _0x35bc4a['info']['歌手'] || _0x4a9146(0x898), 'cover': _0x35bc4a[_0x4a9146(0x194)] ? URL[_0x4a9146(0x289)](_0x35bc4a[_0x4a9146(0x194)]) : _0x461596, 'isFromLibrary': !![] }; const _0x2fc305 = URL['createObjectURL'](_0x35bc4a[_0x4a9146(0x44c)]); _0x57146d['src'] = _0x2fc305, _0x57146d[_0x4a9146(0x5ca)](), _0x207d77(); } async function _0x207d77() { const _0x209de0 = _0x187760; if (_0x209de0(0x92d) !== _0x209de0(0x29e)) { const _0x562a50 = document[_0x209de0(0x759)]('music-widget-card'), _0x474ac7 = document[_0x209de0(0x759)](_0x209de0(0x4b6)), _0x3f3ce3 = document[_0x209de0(0x759)](_0x209de0(0xa25)), _0x244668 = document[_0x209de0(0x759)](_0x209de0(0x540)), _0x822a86 = _0x20c796; _0x822a86 && _0x822a86[_0x209de0(0x53f)] ? (_0x474ac7[_0x209de0(0x574)] = _0x822a86[_0x209de0(0x640)], _0x3f3ce3[_0x209de0(0x574)] = _0x822a86[_0x209de0(0x6cd)], _0x562a50['classList'][_0x209de0(0x944)](_0x209de0(0x7ba)), _0x562a50['style'][_0x209de0(0x52c)](_0x209de0(0xa4e), 'url(' + _0x822a86[_0x209de0(0x194)] + ')')) : _0x209de0(0x920) !== _0x209de0(0x920) ? _0x3e6524 = _0xb855a5[_0x209de0(0x7ee)] : (_0x474ac7[_0x209de0(0x574)] = _0x209de0(0x8df), _0x3f3ce3[_0x209de0(0x574)] = _0x209de0(0x603), _0x562a50[_0x209de0(0x969)][_0x209de0(0x41a)](_0x209de0(0x7ba)), _0x244668[_0x209de0(0x80f)][_0x209de0(0x52c)](_0x209de0(0xa4e), 'none')); } else _0x13acca(), _0xcf9a42 = null; } _0x51c9be && _0x51c9be[_0x187760(0x6cc)]('click', () => { const _0x48fe02 = _0x187760; if (_0x2055dd[_0x48fe02(0x919)] === 0x0) return; _0x10b124 = (_0x10b124 + 0x1) % _0x2055dd[_0x48fe02(0x919)], _0x2230f5(_0x2055dd[_0x10b124], _0x2055dd); }); _0x528a27 && (_0x187760(0x667) !== 'HbCNv' ? _0x528a27[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0xca88ed = _0x187760; if (_0x2055dd[_0xca88ed(0x919)] === 0x0) return; _0x10b124 = (_0x10b124 - 0x1 + _0x2055dd[_0xca88ed(0x919)]) % _0x2055dd['length'], _0x2230f5(_0x2055dd[_0x10b124], _0x2055dd); }) : _0x43edfa('图标处理失败:\x20' + _0x4bfedd[_0x187760(0x997)])); _0x57146d[_0x187760(0x6cc)]('play', () => { const _0x32da9d = _0x187760; if (_0x1e6e7f) _0x1e6e7f[_0x32da9d(0x574)] = '❚❚'; }), _0x57146d[_0x187760(0x6cc)](_0x187760(0x153), () => { const _0x381bee = _0x187760; if ('tjUtK' !== _0x381bee(0x1b5)) { if (_0x1e6e7f) _0x1e6e7f['textContent'] = '▶'; } else { const _0x20d29a = _0x53a10a[_0x381bee(0x759)](_0x5b409e); if (_0x20d29a && _0x28d80e) _0x20d29a[_0x381bee(0x686)] = _0x540b39[_0x381bee(0x289)](_0x3b7ab7); } }), _0x57146d['addEventListener'](_0x187760(0x695), () => { const _0x378680 = _0x187760; if (_0x378680(0x469) === _0x378680(0x469)) { if (_0x51c9be) _0x51c9be['click'](); } else { if (_0x46f976['isAnimatingDiary']) return; const _0x31a9b2 = _0x1e2ab1[_0x378680(0x8c3)], _0x48d44d = _0x1a803a[_0x378680(0x44e)](_0x2bc609['diaries']['find'](_0x3d6fb0 => _0x3d6fb0[_0x378680(0x94f)] === _0x386385[_0x378680(0x313)])[_0x378680(0xa18)]['length'] / 0x2); if (_0x31a9b2 >= _0x48d44d - 0x1) return; _0x201214[_0x378680(0x42c)] = !![]; const _0x429b80 = _0x31a9b2 + 0x1, _0x2d19cc = _0x370ca7[_0x378680(0x759)](_0x378680(0x787) + _0x31a9b2), _0x3c0974 = _0x2dae6e[_0x378680(0x759)](_0x378680(0x787) + _0x429b80); _0x2d19cc && _0x3c0974 ? (_0x3c0974[_0x378680(0x969)][_0x378680(0x944)]('is-entering-from-right'), _0x2d19cc['classList'][_0x378680(0x944)](_0x378680(0x33c)), _0x3c0974['classList'][_0x378680(0x944)](_0x378680(0x552)), _0x219f2a(() => { const _0x4d87b8 = _0x378680; _0x2d19cc['classList']['remove'](_0x4d87b8(0x552), _0x4d87b8(0x33c)), _0x3c0974['classList'][_0x4d87b8(0x41a)]('is-entering-from-right'), _0x2593d8[_0x4d87b8(0x8c3)] = _0x429b80, _0x376d74(), _0x29a0a8['isAnimatingDiary'] = ![]; }, 0x2bc)) : _0x5672e7[_0x378680(0x42c)] = ![]; } }); function _0x36a7eb() { const _0x3b718f = _0x187760, _0x1ffc6a = _0xa7e551(); if (!_0x1ffc6a) return; _0x319c3d[_0x3b718f(0x29c)] = '', _0x1c178a[_0x3b718f(0xa03)] = ''; if (_0x1ffc6a[_0x3b718f(0x713)] === _0x3b718f(0x867)) _0x1ffc6a[_0x3b718f(0x9be)][_0x3b718f(0xa3d)](_0x5b3bd3 => { const _0x1a0354 = _0x3b718f; if (_0x1a0354(0x8c0) !== _0x1a0354(0x1d4)) { const _0xc7d2c3 = _0x4cc875(_0x5b3bd3); if (_0xc7d2c3) { if (_0x1a0354(0x541) === _0x1a0354(0x541)) { const _0x484b2c = document[_0x1a0354(0xa93)](_0x1a0354(0x407)); _0x484b2c[_0x1a0354(0xa03)] = _0xc7d2c3['id'], _0x484b2c['textContent'] = _0xc7d2c3[_0x1a0354(0xb15)], _0x319c3d[_0x1a0354(0x25f)](_0x484b2c); } else return _0x5371e0(_0x5930fd)[_0x1a0354(0x276)](_0x541cc6 => _0x541cc6[_0x1a0354(0x24c)]()); } } else { const _0x512042 = _0x5e42c9[_0x1a0354(0x759)](_0x1a0354(0x38a)), _0x78b75b = _0x131dfd['getElementById'](_0x1a0354(0x406)); _0x512042[_0x1a0354(0x29c)] = ''; const _0x2027ac = new _0x46a82a(_0x337298 + _0x1a0354(0xa1d)); _0x78b75b[_0x1a0354(0x574)] = _0x2027ac[_0x1a0354(0x950)]() + 0x1 + '月' + _0x2027ac[_0x1a0354(0x3de)]() + '日'; const _0x8b48db = _0x3bd1bd[_0x1a0354(0x901)][_0x1a0354(0x9f6)](_0x90fe48 => _0x90fe48['date'] === _0xc58995); if (_0x8b48db[_0x1a0354(0x919)] === 0x0) { _0x512042[_0x1a0354(0x29c)] = _0x1a0354(0x90a); return; } _0x8b48db[_0x1a0354(0xa3d)](_0x418719 => { const _0x3cdf33 = _0x1a0354, _0x389ec8 = _0x18b626['createElement'](_0x3cdf33(0x64e)); _0x389ec8[_0x3cdf33(0x8bd)] = _0x418719['type'] === 'important' ? _0x3cdf33(0x53c) : _0x3cdf33(0x3bb), _0x389ec8['textContent'] = _0x418719['content'], _0x389ec8[_0x3cdf33(0x2f7)]['id'] = _0x418719['id'], _0x512042[_0x3cdf33(0x25f)](_0x389ec8); }); } }), _0x15cd9a[_0x3b718f(0x80f)]['display'] = _0x3b718f(0x210); else { if (_0x3b718f(0x8ee) === _0x3b718f(0x8ee)) _0x15cd9a['style'][_0x3b718f(0x3e7)] = _0x3b718f(0x697); else { const _0x1eb715 = _0x36ec77(_0x5cc765['content'] ?? _0x1eff5b['text'] ?? '')['trim']() || _0x3b718f(0x43c) + (_0x452833 || _0x3b718f(0x5c9)) + ']'; if (_0x1eb715) _0x1a0b63[_0x3b718f(0x17b)][_0x3b718f(0x438)]({ 'senderId': _0x363f74['id'], 'kind': _0x3b718f(0x807), 'content': _0x1eb715 }); } } _0x12c2dd[_0x3b718f(0x969)][_0x3b718f(0x944)]('show'), _0x1c178a[_0x3b718f(0x4ee)](); } function _0x375afd() { const _0x13f848 = _0x187760; if (_0x13f848(0x629) !== _0x13f848(0x30b)) { const _0x4d20c = parseFloat(_0x1c178a[_0x13f848(0xa03)]); if (isNaN(_0x4d20c) || _0x4d20c <= 0x0) { if (_0x13f848(0x5bf) === 'JJmkE') { _0xeba69d('请输入有效的转账金额！'); return; } else _0x2fc498 = _0x5de1e3[_0x13f848(0x1db)](_0x55f757); } const _0x93de7e = _0xa7e551(); let _0x4a680d = null; if (_0x93de7e['type'] === _0x13f848(0x867)) _0x4a680d = _0x319c3d[_0x13f848(0xa03)]; else { if (_0x13f848(0x991) !== 'niFAy') _0x4a680d = _0x93de7e[_0x13f848(0x9be)][0x0]; else { const _0x36b061 = _0xaa342[_0x13f848(0x860)]('appState'); if (_0x36b061) { const _0x5cf98a = _0x20ec4b[_0x13f848(0x1db)](_0x36b061); _0x5cf98a[_0x13f848(0x72a)] && (_0x5c54b2['accountingLedger'] = _0x5cf98a[_0x13f848(0x72a)], _0x5739c9[_0x13f848(0xa05)]('Noir\x27s\x20Temporal\x20Patch:\x20Ledger\x20re-synchronized.')); } } } const _0x3d0964 = _0x33ec75(_0x93de7e['id']), _0x31156a = { 'role': 'user', 'type': 'transfer', 'content': _0x13f848(0x31b) + (_0x4cc875(_0x4a680d)?.[_0x13f848(0xb15)] || '未知') + '\x20转账\x20' + _0x4d20c + ']', 'amount': _0x4d20c, 'recipientId': _0x4a680d, 'senderId': _0x3d0964['id'], 'timestamp': Date[_0x13f848(0x74c)]() }; _0x29b260['conversationHistory']['push'](_0x31156a), _0x3254df(), _0x448e33(), _0x12c2dd[_0x13f848(0x969)]['remove'](_0x13f848(0x459)); } else { if (_0xa30f5d['name'] !== 'AbortError') { _0x3e46dc[_0x13f848(0x297)]('生成失败:\x20', _0x586b68); const _0x3c766e = { 'role': _0x13f848(0x863), 'content': _0x13f848(0xaf9) + _0x24a515[_0x13f848(0x997)], 'senderId': _0x492427['id'], 'isOffline': _0x5742a1 }; _0x239596[_0x13f848(0xa85)][_0x13f848(0x438)](_0x3c766e), _0x1103a0(); } return ![]; } } async function _0x2855c0(_0xeb94f0) { const _0x3d13b5 = _0x187760; if (_0x3d13b5(0x2c2) !== _0x3d13b5(0x2c2)) _0x793f42[_0x3d13b5(0x574)] = '❚❚'; else { const _0x116d49 = _0x4cc875(_0xeb94f0); if (!_0x116d49) return; const _0x30a44e = await _0x5db04d(_0x3d13b5(0x721) + _0x116d49[_0x3d13b5(0xb15)] + _0x3d13b5(0x15d)); if (!_0x30a44e) return; const _0x52d49c = _0x29b260[_0x3d13b5(0x94d)]['findIndex'](_0x4288b5 => _0x4288b5['characterId'] === _0xeb94f0); _0x52d49c > -0x1 ? _0x3d13b5(0x873) !== _0x3d13b5(0x17a) ? (_0x29b260['diaries']['splice'](_0x52d49c, 0x1), _0xf10e4a(), _0x2ab9ac(), _0xeba69d('【' + _0x116d49[_0x3d13b5(0xb15)] + '】的日记本已被清空。')) : (_0x40007f(![]), _0x313147[_0x3d13b5(0x27c)] = ![]) : _0xeba69d(_0x3d13b5(0x20d)); } } function _0x5f2229() { const _0x2aed9b = _0x187760, _0x542de5 = document[_0x2aed9b(0x759)](_0x2aed9b(0x97d)); _0x542de5[_0x2aed9b(0x29c)] = ''; const _0x44bc05 = _0x29b260['characters'][_0x2aed9b(0x9f6)](_0x2821e4 => _0x29b260[_0x2aed9b(0x6df)][_0x2aed9b(0x5f7)](_0x4af4ae => _0x4af4ae[_0x2aed9b(0x713)] === _0x2aed9b(0x7ad) && _0x4af4ae[_0x2aed9b(0x9be)]['includes'](_0x2821e4['id']))); if (_0x44bc05['length'] === 0x0) { if (_0x2aed9b(0x79c) === _0x2aed9b(0x401)) _0x49b4cb[_0x2aed9b(0x7d9)] = null, _0x1ee17d[_0x2aed9b(0x80f)][_0x2aed9b(0x3e7)] = _0x2aed9b(0x697); else { _0x542de5[_0x2aed9b(0x29c)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以视奸的角色。</p>'; return; } } _0x44bc05['forEach'](_0x54bdb6 => { const _0x562479 = _0x2aed9b, _0x5383e2 = document[_0x562479(0xa93)]('li'); _0x5383e2[_0x562479(0x8bd)] = _0x562479(0x34c), _0x5383e2[_0x562479(0x2f7)][_0x562479(0x318)] = _0x54bdb6['id'], _0x5383e2[_0x562479(0x29c)] = _0x562479(0x9ab) + (_0x54bdb6[_0x562479(0x96f)] || _0x461596) + _0x562479(0x483) + _0x54bdb6[_0x562479(0xb15)] + _0x562479(0x146) + _0x54bdb6[_0x562479(0xb15)] + _0x562479(0xa0e), _0x5383e2[_0x562479(0xa01)](_0x562479(0x6ff))[_0x562479(0x6cc)](_0x562479(0x7ec), () => _0x93000f(_0x54bdb6['id'])), _0x5383e2[_0x562479(0xa01)](_0x562479(0x6eb))[_0x562479(0x6cc)](_0x562479(0x7ec), async _0x7a8f24 => { const _0x4f3fab = _0x562479; _0x7a8f24[_0x4f3fab(0x479)](); const _0x19b87a = _0x4cc875(_0x54bdb6['id']); if (!_0x19b87a) return; const _0x3044bd = await _0x5db04d(_0x4f3fab(0x3a1) + _0x19b87a['name'] + _0x4f3fab(0x7ed)); if (_0x3044bd) { _0x195491(!![], _0x4f3fab(0x4c9) + _0x19b87a[_0x4f3fab(0xb15)] + _0x4f3fab(0x896)); const _0x50c476 = [_0x4f3fab(0x725), _0x4f3fab(0x9ad), _0x4f3fab(0xae4), _0x4f3fab(0xa37), _0x4f3fab(0x97c), 'wants', _0x4f3fab(0x310), 'summary']; for (const _0x46ca96 of _0x50c476) { const _0x301443 = _0x4f3fab(0xb25) + _0x19b87a['id'] + '_' + _0x46ca96; await _0x18408e(_0x301443); } _0x195491(![]), _0xeba69d('【' + _0x19b87a[_0x4f3fab(0xb15)] + _0x4f3fab(0x55b)); } }), _0x542de5[_0x562479(0x25f)](_0x5383e2); }); } let _0x120f21 = null, _0x4f7542 = null; function _0x5d7126() { const _0x1f3166 = _0x187760, _0x3be439 = new Date(), _0x4400dd = document[_0x1f3166(0x759)](_0x1f3166(0x3f1)), _0x1e2f85 = document[_0x1f3166(0x759)](_0x1f3166(0x84f)), _0x38e55d = document[_0x1f3166(0x759)]('snoop-phone-header'); _0x4400dd && _0x1e2f85 && (_0x4400dd[_0x1f3166(0x574)] = _0x3be439['toLocaleTimeString'](_0x1f3166(0x513), { 'hour': _0x1f3166(0x4ca), 'minute': _0x1f3166(0x4ca), 'hour12': ![] }), _0x1e2f85[_0x1f3166(0x574)] = _0x3be439[_0x1f3166(0x7c8)]('zh-CN', { 'month': _0x1f3166(0x9d3), 'day': _0x1f3166(0x322), 'weekday': _0x1f3166(0x9d3) })); if (_0x38e55d) { if (_0x1f3166(0x2ac) === 'KLxOQ') _0x38e55d[_0x1f3166(0x29c)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>' + _0x3be439[_0x1f3166(0x80b)](_0x1f3166(0x513), { 'hour': _0x1f3166(0x4ca), 'minute': _0x1f3166(0x4ca), 'hour12': ![] }) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>📶\x20🔋</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; else { const { omniText: _0x737756 } = _0x5ba808(_0x563504['id'], null), _0x316088 = _0x3f459d(_0x3f1b8f['id']), _0x3f8121 = _0x1dda32['linkedWorldBookIds'] && _0x12ac38[_0x1f3166(0x5c0)][_0x1f3166(0x919)] > 0x0 ? _0x1f3166(0x662) + _0x369534[_0x1f3166(0xb15)] + '的个人专属世界观设定\x0a' + _0xcd5f6[_0x1f3166(0x5c0)][_0x1f3166(0xa96)](_0x1924e7 => _0x413414['worldBooks']['find'](_0x178c6d => _0x178c6d['id'] === _0x1924e7))[_0x1f3166(0x9f6)](_0xf615b0)[_0x1f3166(0xa96)](_0xa5398d => _0x1f3166(0x497) + _0xa5398d[_0x1f3166(0xb15)] + '\x0a' + _0xa5398d[_0x1f3166(0x359)])['join']('') : ''; return _0x1f3166(0x720) + _0x35ae6c[_0x1f3166(0xb15)] + _0x1f3166(0x83a) + _0x26449f['id'] + _0x1f3166(0x57d) + _0x19fd3f[_0x1f3166(0x435)] + _0x1f3166(0x67a) + _0x737756 + '\x0a' + _0x316088 + '\x0a' + _0x3f8121; } } } function _0x93000f(_0x3a82ca) { const _0x3ad22e = _0x187760; _0x120f21 = _0x3a82ca; const _0x1b5545 = _0x4cc875(_0x3a82ca); if (!_0x1b5545) return; const _0x3e7d57 = document[_0x3ad22e(0x759)]('snoop-phone-screen'), _0x3c45f6 = document['getElementById'](_0x3ad22e(0x476)); if (_0x3c45f6) _0x3c45f6[_0x3ad22e(0x41a)](); const _0x4c0077 = document[_0x3ad22e(0x759)]('snoop-dock'); if (_0x4c0077) _0x4c0077['remove'](); _0x3e7d57['insertAdjacentHTML'](_0x3ad22e(0x7b4), '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-clock\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-time\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-date\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20'), _0x3e7d57[_0x3ad22e(0x9e0)](_0x3ad22e(0x7b4), '<div\x20id=\x22snoop-dock\x22></div>'), document[_0x3ad22e(0x759)]('snoop-char-name-header')[_0x3ad22e(0x574)] = '', _0x159e21(); if (_0x4f7542) clearInterval(_0x4f7542); _0x5d7126(), _0x4f7542 = setInterval(_0x5d7126, 0x2710), _0x57a80a('snoopPhone', 'snoopList'); } function _0x159e21() { const _0x1bbfa7 = _0x187760; if (_0x1bbfa7(0x973) === 'aszho') { _0x29bc89[_0x1bbfa7(0x29c)] = _0x1bbfa7(0x49d); return; } else { const _0x3682be = document[_0x1bbfa7(0x759)](_0x1bbfa7(0xace)), _0x2f335a = document[_0x1bbfa7(0x759)](_0x1bbfa7(0x6da)); _0x3682be['innerHTML'] = _0x1bbfa7(0x2a8), _0x2f335a[_0x1bbfa7(0x29c)] = ''; const _0x18471e = _0x3682be[_0x1bbfa7(0xa01)](_0x1bbfa7(0x1ef)), _0x4bd36a = [{ 'id': _0x1bbfa7(0x9ad), 'name': '聊天', 'svg': '<path\x20d=\x22M21\x2015a2\x202\x200\x200\x201-2\x202H7l-4\x204V5a2\x202\x200\x200\x201\x202-2h14a2\x202\x200\x200\x201\x202\x202z\x22></path>', 'area': _0x1bbfa7(0x804) }, { 'id': _0x1bbfa7(0xae4), 'name': _0x1bbfa7(0xb21), 'svg': _0x1bbfa7(0x97b), 'area': _0x1bbfa7(0x804) }, { 'id': _0x1bbfa7(0x725), 'name': '相册', 'svg': _0x1bbfa7(0x86b), 'area': _0x1bbfa7(0x804) }, { 'id': _0x1bbfa7(0x328), 'name': '总结', 'svg': _0x1bbfa7(0x277), 'area': _0x1bbfa7(0x804) }, { 'id': _0x1bbfa7(0xa37), 'name': _0x1bbfa7(0x766), 'svg': _0x1bbfa7(0x60d), 'area': _0x1bbfa7(0x37c) }, { 'id': 'bites', 'name': '外卖', 'svg': _0x1bbfa7(0x39e), 'area': _0x1bbfa7(0x37c) }, { 'id': _0x1bbfa7(0x8c4), 'name': '购物', 'svg': _0x1bbfa7(0x762), 'area': _0x1bbfa7(0x37c) }, { 'id': _0x1bbfa7(0x310), 'name': '足迹', 'svg': _0x1bbfa7(0x819), 'area': 'main' }]; _0x4bd36a[_0x1bbfa7(0xa3d)](_0x31d900 => { const _0x7ae813 = _0x1bbfa7, _0x541c33 = document['createElement'](_0x7ae813(0x64e)); _0x541c33['className'] = 'snoop-app-icon', _0x541c33['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-icon-img\x22><svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22>' + _0x31d900[_0x7ae813(0x7fe)] + _0x7ae813(0x8f1) + _0x31d900[_0x7ae813(0xb15)] + _0x7ae813(0x51b), _0x541c33['addEventListener'](_0x7ae813(0x7ec), () => _0x28103b(_0x31d900['id'], _0x31d900['name'])), _0x31d900[_0x7ae813(0x745)] === 'dock' ? _0x2f335a[_0x7ae813(0x25f)](_0x541c33) : _0x7ae813(0x1d3) !== _0x7ae813(0x86d) ? _0x18471e[_0x7ae813(0x25f)](_0x541c33) : _0x3733d8(_0x21df7e['id']); }); } } document[_0x187760(0x759)](_0x187760(0x897))[_0x187760(0x6cc)]('click', () => { const _0x5f0348 = _0x187760; if (_0x4f7542) { if (_0x5f0348(0x5c6) === _0x5f0348(0x5c6)) clearInterval(_0x4f7542), _0x4f7542 = null; else { const _0x5514fc = _0x30ad89[_0x5f0348(0x74e)](); _0x5514fc && _0x18a56c['push'](..._0x16f2a1(_0x5514fc)), _0x27df56 < _0xeae716[_0x5f0348(0x919)] && (_0x51fa30[_0x5f0348(0x438)](_0x4a231e[_0x379c97][_0x5f0348(0x74e)]()), _0x1222ba++); } } document[_0x5f0348(0x759)]('snoop-app-view-container')[_0x5f0348(0x80f)][_0x5f0348(0x3e7)] = _0x5f0348(0x697); const _0x3ba0b2 = document[_0x5f0348(0x759)](_0x5f0348(0x6da)); if (_0x3ba0b2) _0x3ba0b2[_0x5f0348(0x41a)](); const _0x221f5c = document['getElementById'](_0x5f0348(0x476)); if (_0x221f5c) _0x221f5c['remove'](); _0x57a80a(_0x5f0348(0x491), 'snoopPhone'); }); async function _0x28103b(_0x194a4b, _0xf2683a, _0x3e35a0 = ![]) { const _0x40fc26 = _0x187760; document[_0x40fc26(0x759)]('snoop-phone-top-nav')['style']['display'] = 'none'; const _0x17a49c = document['getElementById']('snoop-app-view-container'); _0x17a49c[_0x40fc26(0x29c)] = _0x40fc26(0x42e), _0x17a49c[_0x40fc26(0x80f)][_0x40fc26(0x3e7)] = _0x40fc26(0x868); const _0x2829d9 = _0x40fc26(0xb25) + _0x120f21 + '_' + _0x194a4b; try { if (_0x40fc26(0x187) === _0x40fc26(0x187)) { if (_0x194a4b === _0x40fc26(0x328)) { const _0x2c005c = await _0x14de22(_0x120f21); _0xe4831e(_0x194a4b, _0xf2683a, _0x2c005c); return; } let _0x2bb6b6 = await _0x53a882(_0x2829d9); if (_0x3e35a0 || !_0x2bb6b6) { console[_0x40fc26(0xa05)](_0x40fc26(0x643) + _0x2829d9 + _0x40fc26(0x1ea)); let _0x22cb00 = await _0xf2541e(_0x194a4b, _0x120f21, _0x2bb6b6); if (_0x22cb00) { if (_0x40fc26(0x9ea) === _0x40fc26(0x159)) { const _0x570e52 = _0x5c160d[_0x40fc26(0xa93)]('div'); _0x570e52[_0x40fc26(0x8bd)] = _0x40fc26(0x77c), _0x570e52['innerHTML'] = _0x40fc26(0x163) + _0x5d246a[_0x40fc26(0x7fe)] + _0x40fc26(0x8f1) + _0x1c74c2[_0x40fc26(0xb15)] + _0x40fc26(0x51b), _0x570e52[_0x40fc26(0x6cc)](_0x40fc26(0x7ec), () => _0x157105(_0x538aaf['id'], _0x4f4238[_0x40fc26(0xb15)])), _0x2a7b5f[_0x40fc26(0x745)] === _0x40fc26(0x804) ? _0x58f077[_0x40fc26(0x25f)](_0x570e52) : _0x1581af[_0x40fc26(0x25f)](_0x570e52); } else { const _0x2454e4 = _0x22cb00[_0x40fc26(0x6d2)](/```(?:json)?\s*([\s\S]*?)\s*```/), _0x4d33ef = _0x2454e4 ? _0x2454e4[0x1][_0x40fc26(0x74e)]() : _0x22cb00['trim'](); let _0x3be208; try { _0x3be208 = JSON[_0x40fc26(0x1db)](_0x4d33ef); } catch (_0x39a28f) { _0x3be208 = _0x1ed362(_0x4d33ef); if (!_0x3be208) throw new Error(_0x40fc26(0x239)); } let _0x52273d; if (_0x3e35a0 && _0x2bb6b6) try { if (_0x40fc26(0x3ac) !== _0x40fc26(0x3ac)) _0x172617(_0x18d72e[_0x40fc26(0x40a)])[_0x40fc26(0x276)](_0x13ca21 => { const _0x1e5c3b = _0x40fc26, _0x35770d = _0x4e8265[_0x1e5c3b(0x759)](_0x36d721); if (_0x35770d && _0x13ca21) _0x35770d['src'] = _0x578fe7['createObjectURL'](_0x13ca21); }); else { const _0xce6585 = JSON[_0x40fc26(0x1db)](_0x2bb6b6); if (_0x194a4b === _0x40fc26(0x9ad)) _0x52273d = JSON[_0x40fc26(0x2a5)](_0x3be208), console[_0x40fc26(0xa05)](_0x40fc26(0x152)); else { if ('szzER' !== _0x40fc26(0x1fd)) { if (Array[_0x40fc26(0xac4)](_0xce6585) && Array[_0x40fc26(0xac4)](_0x3be208)) { const _0x26df35 = _0xce6585[_0x40fc26(0x4a7)](_0x3be208); _0x52273d = JSON['stringify'](_0x26df35), console[_0x40fc26(0xa05)]('Noir\x27s\x20Fix:\x20已成功追加新旧数据\x20(A+B)。'); } else _0x52273d = JSON['stringify'](_0x3be208); } else _0x37fe6b(_0x55d35b), _0x15da2e[_0x40fc26(0xa03)] = '', _0x1795a5(_0xfd9852, 0x64); } } } catch (_0x6d0787) { _0x40fc26(0x4c3) === 'hRMHH' ? _0x52273d = JSON[_0x40fc26(0x2a5)](_0x3be208) : _0x509afb['setItem']('chatHistory_' + _0x570710[_0x40fc26(0x7b1)], _0x320d13['stringify'](_0x59f2c7[_0x40fc26(0xa85)])); } else _0x52273d = JSON[_0x40fc26(0x2a5)](_0x3be208); await _0x2cf414(_0x2829d9, _0x52273d), _0x2bb6b6 = _0x52273d; } } } else console[_0x40fc26(0xa05)](_0x40fc26(0x826) + _0x2829d9); _0xe4831e(_0x194a4b, _0xf2683a, _0x2bb6b6); } else { const _0x50beb4 = _0x88bfb5[_0x40fc26(0x759)](_0x40fc26(0xa83)); _0x50beb4[_0x40fc26(0x29c)] = ''; const _0x4965c5 = _0x68fc1f[_0x40fc26(0x3db)][_0x40fc26(0x9f6)](_0x418eac => _0x69b2ae['chats']['some'](_0x5bab26 => _0x5bab26[_0x40fc26(0x713)] === _0x40fc26(0x7ad) && _0x5bab26[_0x40fc26(0x9be)][_0x40fc26(0x4da)](_0x418eac['id']))); if (_0x4965c5[_0x40fc26(0x919)] === 0x0) { _0x50beb4[_0x40fc26(0x29c)] = _0x40fc26(0x26a); return; } _0x4965c5[_0x40fc26(0xa3d)](_0x4aecd8 => { const _0x40996d = _0x40fc26, _0x150dad = _0x55cee6[_0x40996d(0xa93)]('li'); _0x150dad[_0x40996d(0x8bd)] = 'character-item', _0x150dad[_0x40996d(0x2f7)]['charId'] = _0x4aecd8['id'], _0x150dad['innerHTML'] = _0x40996d(0x9ab) + (_0x4aecd8[_0x40996d(0x96f)] || _0x39772c) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x4aecd8['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>' + (_0x4aecd8[_0x40996d(0x3f7)] || '私聊') + _0x40996d(0x622), _0x150dad[_0x40996d(0x6cc)](_0x40996d(0x7ec), () => { _0x4a6514(_0x4aecd8['id']); }), _0x50beb4[_0x40996d(0x25f)](_0x150dad); }); } } catch (_0x9b4d20) { console[_0x40fc26(0x297)]('加载\x20' + _0xf2683a + _0x40fc26(0x443), _0x9b4d20), _0x17a49c[_0x40fc26(0x29c)] = _0x40fc26(0x3a6) + _0x9b4d20[_0x40fc26(0x997)] + _0x40fc26(0x8d4); } } function _0xe4831e(_0x4a5fd0, _0x3e4a65, _0x2453fd) { const _0x3c78c2 = _0x187760, _0x1d23a3 = _0x4cc875(_0x120f21), _0x5ef03d = document[_0x3c78c2(0x759)](_0x3c78c2(0x800)); let _0x3015d5 = ''; if (!_0x2453fd) _0x3015d5 = _0x3c78c2(0x1d6); else { if (_0x4a5fd0 === 'summary') _0x3c78c2(0x6c6) !== _0x3c78c2(0x485) ? _0x3015d5 = _0x3c78c2(0x5e2) + _0x2453fd + _0x3c78c2(0x8f3) : _0x4a4e27 = {}; else try { let _0x100f5e = null; const _0x354526 = _0x2453fd[_0x3c78c2(0x6d2)](/```(?:json)?\s*([\s\S]*?)\s*```/), _0x5f3370 = _0x354526 ? _0x354526[0x1] : _0x2453fd; _0x100f5e = JSON['parse'](_0x5f3370); const _0xb2e0f7 = _0x4cc875(_0x120f21); switch (_0x4a5fd0) { case _0x3c78c2(0x725): _0x3015d5 = _0x2c28a5(_0x100f5e); break; case 'whispers': _0x3015d5 = _0xca2156(_0x100f5e, _0xb2e0f7[_0x3c78c2(0xb15)]); break; case _0x3c78c2(0xae4): _0x3015d5 = _0x1fa39e(_0x100f5e); break; case _0x3c78c2(0xa37): _0x3015d5 = _0xe578dd(_0x100f5e); break; case _0x3c78c2(0x97c): _0x3015d5 = _0x37a664(_0x100f5e); break; case _0x3c78c2(0x8c4): _0x3015d5 = _0x28ab00(_0x100f5e); break; case _0x3c78c2(0x310): _0x3015d5 = _0x1efd06(_0x100f5e); break; case 'summary': _0x3015d5 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22snoop-summary-textarea\x22\x20readonly\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border:\x20none;\x20outline:\x20none;\x20resize:\x20none;\x20font-family:\x20\x27Courier\x20New\x27,\x20monospace;\x20font-size:\x200.85rem;\x20line-height:\x201.6;\x20background-color:\x20#fdfdfd;\x20padding:\x2015px;\x20box-sizing:\x20border-box;\x22>' + _0x2453fd + _0x3c78c2(0x931); break; default: _0x3015d5 = '<pre\x20style=\x22white-space:\x20pre-wrap;\x20word-break:\x20break-word;\x22>' + JSON[_0x3c78c2(0x2a5)](_0x100f5e, null, 0x2) + _0x3c78c2(0x58a); } } catch (_0x22c136) { console[_0x3c78c2(0x297)]('视奸内容解析失败:', _0x22c136), _0x3015d5 = _0x3c78c2(0x258) + _0x2453fd + _0x3c78c2(0x58a); } } _0x5ef03d[_0x3c78c2(0x29c)] = _0x3c78c2(0x824) + _0x3e4a65 + _0x3c78c2(0x2c4) + _0x1d23a3['name'] + _0x3c78c2(0x996) + (_0x4a5fd0 === _0x3c78c2(0x328) ? _0x3c78c2(0x332) : '<button\x20id=\x22snoop-app-refresh-btn\x22\x20class=\x22snoop-app-header-button\x22>刷新</button>') + _0x3c78c2(0x3e9) + _0x3015d5 + _0x3c78c2(0x535); const _0x33c261 = _0x5ef03d[_0x3c78c2(0xa01)]('.snoop-app-content'); _0x4a5fd0 === _0x3c78c2(0x328) && (_0x33c261['style']['padding'] = '0'); document['getElementById'](_0x3c78c2(0x9fd))[_0x3c78c2(0x6cc)](_0x3c78c2(0x7ec), () => { const _0x2ca585 = _0x3c78c2; _0x5ef03d[_0x2ca585(0x80f)]['display'] = _0x2ca585(0x697), document[_0x2ca585(0x759)](_0x2ca585(0x8a6))[_0x2ca585(0x80f)][_0x2ca585(0x3e7)] = _0x2ca585(0x868); }); if (_0x4a5fd0 === _0x3c78c2(0x328)) { if ('CFtSu' === _0x3c78c2(0x255)) { const _0x3f5c42 = { 'role': _0x3c78c2(0x863), 'content': '[AI发送了表情：' + _0x593a2e[_0x3c78c2(0xb15)] + ']', 'displayUrl': _0x484e05[_0x3c78c2(0x8b7)], 'senderId': _0xa39e5c['senderId'], 'timestamp': _0x170406[_0x3c78c2(0x74c)](), 'isOffline': _0x252248 }; _0x1697c6[_0x3c78c2(0xa85)][_0x3c78c2(0x438)](_0x3f5c42); } else document['getElementById'](_0x3c78c2(0x300))[_0x3c78c2(0x6cc)](_0x3c78c2(0x7ec), () => { const _0x5a76fd = _0x3c78c2; if (_0x5a76fd(0xb0b) !== _0x5a76fd(0xb0b)) { const _0x4c9c34 = _0x4da421[_0x5a76fd(0xa93)](_0x5a76fd(0x36b)); _0x4c9c34['src'] = _0x48dd0a['url'], _0x4c9c34[_0x5a76fd(0x365)] = 'lazy', _0x4c9c34[_0x5a76fd(0x640)] = _0x44106e[_0x5a76fd(0xb15)], _0x4c9c34['classList'][_0x5a76fd(0x944)](_0x5a76fd(0x702)), _0x4c9c34['addEventListener'](_0x5a76fd(0x7ec), () => _0xb9ed4f(_0x5a9c7f)), _0x296710['appendChild'](_0x4c9c34); } else { const _0x15e277 = document[_0x5a76fd(0x759)]('snoop-summary-textarea'); _0x15e277[_0x5a76fd(0x158)](), document[_0x5a76fd(0x38c)](_0x5a76fd(0x989)), _0xeba69d(_0x5a76fd(0x265)); } }); } else _0x3c78c2(0xa6c) === _0x3c78c2(0x923) ? _0x3b01db += _0x3c78c2(0x85e) + _0x112f2c[_0x3c78c2(0xb16)] + '”。\x0a' : document[_0x3c78c2(0x759)]('snoop-app-refresh-btn')[_0x3c78c2(0x6cc)]('click', async () => { const _0x13dd64 = _0x3c78c2; if (_0x13dd64(0x52a) !== _0x13dd64(0x52a)) { const _0x5c35aa = _0x16e610[_0x13dd64(0xa93)](_0x13dd64(0x64e)); _0x5c35aa['className'] = 'html-module-container', _0x5c35aa[_0x13dd64(0x29c)] = _0x53487e, _0x535ee6 === 'user' ? (_0x1ccabe[_0x13dd64(0x25f)](_0x5c35aa), _0x115114[_0x13dd64(0x25f)](_0x4ebf2a)) : (_0x563efc[_0x13dd64(0x25f)](_0x45cc0c), _0x53f12c[_0x13dd64(0x25f)](_0x5c35aa)); } else _0x28103b(_0x4a5fd0, _0x3e4a65, !![]); }); _0x4a5fd0 === _0x3c78c2(0x9ad) && _0x5ef03d[_0x3c78c2(0xae0)](_0x3c78c2(0x2e1))['forEach'](_0x531ef2 => { _0x531ef2['addEventListener']('click', () => { const _0x32c621 = _0x18ce, _0x501db7 = JSON['parse'](_0x531ef2[_0x32c621(0x2f7)][_0x32c621(0xa05)][_0x32c621(0x998)](/&quot;/g, '\x22')), _0x2f8a05 = _0x531ef2['dataset']['contactName'], _0x251f7e = _0x531ef2[_0x32c621(0x2f7)][_0x32c621(0x750)]; _0x834d40(_0x2f8a05, _0x251f7e, _0x501db7); }); }); } function _0x1ed362(_0x3393b1) { const _0xc92671 = _0x187760; if (_0xc92671(0x3f8) !== _0xc92671(0x3f8)) _0x20fbf8[_0xc92671(0x4b9)] = !![]; else { if (!_0x3393b1 || typeof _0x3393b1 !== 'string') return null; const _0x23402e = _0x3393b1[_0xc92671(0x74e)]()[_0xc92671(0x77e)]('\x0a'), _0x2e4fda = []; let _0x251164 = null; for (const _0x2c6c44 of _0x23402e) { if (_0xc92671(0xab9) !== _0xc92671(0xaff)) { const _0x349bcf = _0x2c6c44[_0xc92671(0x74e)](); if (_0x349bcf[_0xc92671(0x736)]('-\x20')) { _0x251164 && _0x2e4fda[_0xc92671(0x438)](_0x251164); _0x251164 = {}; const _0x33c228 = _0x349bcf['substring'](0x2), _0x22d046 = _0x33c228[_0xc92671(0x77e)](/:\s(.+)/); if (_0x22d046['length'] > 0x1) { const _0x4bc9ce = _0x22d046[0x0]['trim'](), _0x50a6ee = _0x22d046[0x1][_0xc92671(0x74e)]()[_0xc92671(0x998)](/^"|"$/g, ''); _0x251164[_0x4bc9ce] = _0x50a6ee; } } else { if (_0x251164 && _0x349bcf) { const _0x2cbeee = _0x349bcf[_0xc92671(0x77e)](/:\s(.+)/); if (_0x2cbeee[_0xc92671(0x919)] > 0x1) { const _0x4e5053 = _0x2cbeee[0x0][_0xc92671(0x74e)](), _0x6a7d90 = _0x2cbeee[0x1]['trim']()['replace'](/^"|"$/g, ''); _0x251164[_0x4e5053] = _0x6a7d90; } } } } else { if (!_0x4a8e26[_0xc92671(0xac4)](_0x2a6c23)) return '<p>格式错误</p>'; if (_0x34485c[_0xc92671(0x919)] === 0x0) return '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>浏览器历史是空的。</p>'; return _0x16ec05[_0xc92671(0x8d8)]((_0x295c18, _0x32c2ac) => new _0x3bafd9(_0x32c2ac['timestamp']) - new _0x4223de(_0x295c18['timestamp'])), _0xc92671(0x317) + _0xcfaede[_0xc92671(0xa96)]((_0x354317, _0x141147) => _0xc92671(0xaa9) + (_0x141147 < _0x4be49d[_0xc92671(0x919)] - 0x1 ? 'border-bottom:\x201px\x20solid\x20var(--border-color);' : '') + _0xc92671(0x9d1) + (_0x354317[_0xc92671(0x6c1)] || _0xc92671(0x6be)) + _0xc92671(0x722) + (_0x354317[_0xc92671(0x185)] || _0xc92671(0x1bc)) + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22text-align:\x20right;\x20margin-top:\x208px;\x20font-size:\x200.7rem;\x22>' + (_0x354317[_0xc92671(0x6de)] || '') + _0xc92671(0x8d6))[_0xc92671(0x63b)]('') + _0xc92671(0x892); } } return _0x251164 && (_0xc92671(0x792) !== 'dwJRB' ? _0x5b8ef7['style'][_0xc92671(0xad6)] = 'none' : _0x2e4fda[_0xc92671(0x438)](_0x251164)), _0x2e4fda[_0xc92671(0x919)] > 0x0 ? _0x2e4fda : null; } } function _0x834d40(_0x1fbba0, _0x315372, _0x1ef42d) { const _0x210982 = _0x187760, _0x52249d = document[_0x210982(0xa01)](_0x210982(0x89c)), _0x447cc0 = document[_0x210982(0xa01)](_0x210982(0x2a7)); let _0x49ebfe = _0x210982(0x619); if (!_0x1ef42d || _0x1ef42d[_0x210982(0x919)] === 0x0) _0x210982(0x63a) === _0x210982(0x1ff) ? _0x27fe22[_0x210982(0x80f)][_0x210982(0x3e7)] = _0x210982(0x697) : _0x49ebfe += _0x210982(0x770); else { if (_0x210982(0x5df) !== 'csHxs') { const _0x3f6417 = _0x11cc08[_0x210982(0xa85)][_0x210982(0x9f6)](_0x13ec67 => _0x13ec67[_0x210982(0x713)] === _0x210982(0xa7c) && _0x13ec67[_0x210982(0x3e3)])[_0x210982(0xa96)](_0x5f02e0 => ({ ..._0x5f02e0, 'source': _0x210982(0x6b7) })); _0x570846[_0x210982(0x438)](..._0x3f6417); } else _0x1ef42d[_0x210982(0xa3d)](_0x18ad4b => { const _0x3e7d2d = _0x210982; if (_0x3e7d2d(0x626) !== _0x3e7d2d(0x626)) _0x3e79a1(), _0x475ddb('编辑群成员功能正在开发中...'); else { const _0x8aec5 = _0x18ad4b['sender'] === _0x3e7d2d(0x565), _0x214fcc = _0x8aec5 ? _0x315372 ? _0x315372[0x0] : '?' : _0x1fbba0 ? _0x1fbba0[0x0] : '?'; _0x49ebfe += _0x3e7d2d(0xa12) + (_0x8aec5 ? 'user' : 'ai') + _0x3e7d2d(0x829) + (!_0x8aec5 ? '<div\x20class=\x22snoop-avatar\x22>' + _0x214fcc + _0x3e7d2d(0x892) : '') + _0x3e7d2d(0x85a) + (_0x8aec5 ? _0x3e7d2d(0x544) : 'ai') + _0x3e7d2d(0x2cc) + _0x18ad4b['content'] + _0x3e7d2d(0xb02) + (_0x8aec5 ? _0x3e7d2d(0x6d5) + _0x214fcc + _0x3e7d2d(0x892) : '') + _0x3e7d2d(0xa07); } }); } _0x49ebfe += _0x210982(0x892), _0x52249d['innerHTML'] = _0x49ebfe, _0x52249d[_0x210982(0x19f)] = _0x52249d[_0x210982(0x837)], _0x447cc0[_0x210982(0x29c)] = _0x210982(0x879) + _0x1fbba0 + _0x210982(0x2de), document[_0x210982(0x759)](_0x210982(0xa5d))[_0x210982(0x6cc)](_0x210982(0x7ec), () => { _0x28103b('whispers', '聊天'); }), !document['getElementById'](_0x210982(0x623)) && document[_0x210982(0x7c9)][_0x210982(0x9e0)]('beforeend', _0x210982(0x2fb)); } function _0x1ed362(_0x10125e) { const _0xf05847 = _0x187760; if ('xciUZ' !== _0xf05847(0x784)) { if (!_0x10125e || typeof _0x10125e !== _0xf05847(0x96c)) return null; const _0x329ce0 = _0x10125e['trim']()[_0xf05847(0x77e)]('\x0a'), _0x3cde00 = []; let _0x462bcb = null; for (const _0x2df59b of _0x329ce0) { if ('KbmOY' === _0xf05847(0x11d)) { const _0x2f5c00 = _0x1656ad[_0xf05847(0x95f)](_0x2b6c88, _0xf05847(0x8e0)), _0x5d3d4f = _0x2f5c00[_0xf05847(0x4d6)](_0x5ed9cf), _0x1fd703 = _0x5d3d4f[_0xf05847(0x2fe)](_0x22aa68); _0x1fd703['onsuccess'] = () => _0x5cc8c1(_0x1fd703[_0xf05847(0x563)] ? _0x1fd703[_0xf05847(0x563)][_0xf05847(0x2c8)] : null), _0x1fd703['onerror'] = () => _0x2287a7(_0x1fd703['error']); } else { const _0x2f33c9 = _0x2df59b['trim'](); if (_0x2f33c9[_0xf05847(0x736)]('-\x20')) { if ('qnniY' !== _0xf05847(0xa76)) { _0x462bcb && _0x3cde00[_0xf05847(0x438)](_0x462bcb); _0x462bcb = {}; const _0x8971c3 = _0x2f33c9['substring'](0x2), _0x3e1694 = _0x8971c3[_0xf05847(0x77e)](/:\s(.+)/); if (_0x3e1694[_0xf05847(0x919)] > 0x1) { const _0xeaa23 = _0x3e1694[0x0][_0xf05847(0x74e)](), _0x481e64 = _0x3e1694[0x1][_0xf05847(0x74e)]()[_0xf05847(0x998)](/^"|"$/g, ''); _0x462bcb[_0xeaa23] = _0x481e64; } } else _0x29c863[_0xf05847(0x297)](_0xf05847(0x50a), _0x31cb49); } else { if (_0x462bcb && _0x2f33c9) { if ('kCtyl' !== _0xf05847(0x1cd)) { const _0x1d0315 = _0x2f33c9['split'](/:\s(.+)/); if (_0x1d0315[_0xf05847(0x919)] > 0x1) { const _0xd23ed = _0x1d0315[0x0][_0xf05847(0x74e)](), _0x3a685b = _0x1d0315[0x1][_0xf05847(0x74e)]()[_0xf05847(0x998)](/^"|"$/g, ''); _0x462bcb[_0xd23ed] = _0x3a685b; } } else _0x49a69a[_0xf05847(0x2f5)](_0x51a930, _0x360e03['stringify'](_0x174a9c)); } } } } return _0x462bcb && _0x3cde00['push'](_0x462bcb), _0x3cde00[_0xf05847(0x919)] > 0x0 ? _0x3cde00 : null; } else { const _0x5aeffd = { 'id': 'msg_' + _0x4187f2[_0xf05847(0x6de)], 'url': _0x57304a[_0xf05847(0x3e3)] }; _0x5dd185(this, _0x5aeffd); } } async function _0x9d9188(_0x106d9a) { const _0x444ca0 = _0x187760; if (_0x444ca0(0x835) !== 'TSCcl') { if (!_0x106d9a) return ''; const _0x71a3f1 = [{ 'id': 'gallery', 'name': '相册' }, { 'id': _0x444ca0(0x9ad), 'name': _0x444ca0(0x3fc) }, { 'id': 'abyss', 'name': '浏览器历史' }, { 'id': 'fragments', 'name': '备忘录' }, { 'id': _0x444ca0(0x97c), 'name': _0x444ca0(0x659) }, { 'id': _0x444ca0(0x8c4), 'name': _0x444ca0(0x977) }, { 'id': _0x444ca0(0x310), 'name': _0x444ca0(0xb14) }]; let _0x374b20 = ''; for (const _0x4feca1 of _0x71a3f1) { try { const _0x523638 = _0x444ca0(0xb25) + _0x106d9a + '_' + _0x4feca1['id'], _0x4ea296 = await _0x53a882(_0x523638); if (_0x4ea296) { const _0xcba0d3 = _0x4ea296[_0x444ca0(0x6d2)](/```(?:json)?\s*([\s\S]*?)\s*```/), _0x860be3 = _0xcba0d3 ? _0xcba0d3[0x1][_0x444ca0(0x74e)]() : _0x4ea296[_0x444ca0(0x74e)](); if (!_0x860be3) continue; let _0x50d278 = null; try { _0x50d278 = JSON[_0x444ca0(0x1db)](_0x860be3); } catch (_0x51a993) { console['warn'](_0x444ca0(0x951) + _0x4feca1['id'] + _0x444ca0(0x59c), _0x51a993[_0x444ca0(0x997)]); try { _0x50d278 = _0x1ed362(_0x860be3); if (!_0x50d278) { if (_0x444ca0(0x122) !== _0x444ca0(0x865)) throw new Error(_0x444ca0(0x74b)); else { const _0x35a011 = _0xcab5df[_0x444ca0(0xa03)][_0x444ca0(0x74e)](); if (!_0x35a011) { _0x30646b(_0x444ca0(0x9ba)); return; } const _0x29d8be = _0x13b0ae['from'](_0x44cf89['querySelectorAll'](_0x444ca0(0x1fa)))[_0x444ca0(0xa96)](_0x779ee6 => _0x779ee6['dataset']['id']); if (_0x29d8be[_0x444ca0(0x919)] < 0x2) { _0x419e9b('群聊至少需要2名成员。'); return; } const _0x2efbbb = { 'id': _0x444ca0(0x6fd) + _0x1ae3dd[_0x444ca0(0x74c)](), 'type': 'group', 'name': _0x35a011, 'participantIds': _0x29d8be }; _0x426046[_0x444ca0(0x6df)][_0x444ca0(0x438)](_0x2efbbb), _0x3c48da[_0x444ca0(0x7b1)] = _0x2efbbb['id'], _0x510a62(), _0x5e2645(), _0x2146f9(), _0x416ca9(), _0x561fcd(_0x444ca0(0x428) + _0x35a011 + _0x444ca0(0x4f2)), _0x363e81(_0x444ca0(0x6b7), 'groupChatCreate'); } } console[_0x444ca0(0xa05)]('兼容模式成功，已将\x20' + _0x4feca1['id'] + _0x444ca0(0x864)); } catch (_0x1fe972) { throw _0x51a993; } } if (Array['isArray'](_0x50d278) && _0x50d278[_0x444ca0(0x919)] > 0x0) { if ('jeXzp' !== _0x444ca0(0x304)) { const _0x569ecc = _0x29de95(_0x54b4d7[_0x444ca0(0x9be)][0x0]); return _0x569ecc?.['name'] || 'AI'; } else { _0x374b20 === '' && (_0x374b20 += _0x444ca0(0x5ae)); _0x374b20 += '\x0a##\x20' + _0x4feca1['name'] + '\x0a'; switch (_0x4feca1['id']) { case _0x444ca0(0x725): _0x50d278[_0x444ca0(0xa3d)](_0x57d22f => { const _0x161266 = _0x444ca0; _0x374b20 += _0x161266(0x85e) + _0x57d22f[_0x161266(0xb16)] + _0x161266(0x18d); }); break; case 'whispers': _0x50d278[_0x444ca0(0xa3d)](_0x4076a0 => { const _0x159cf3 = _0x444ca0; _0x159cf3(0xac2) === 'ofYvw' ? (_0x1f1eb5(), _0x3693fa()) : (_0x374b20 += _0x159cf3(0x507) + _0x4076a0[_0x159cf3(0x692)] + _0x159cf3(0x613) + _0x4076a0[_0x159cf3(0x589)] + _0x159cf3(0x18d), _0x4076a0[_0x159cf3(0xa05)] && Array[_0x159cf3(0xac4)](_0x4076a0[_0x159cf3(0xa05)]) && (_0x374b20 += _0x159cf3(0x62d), _0x4076a0[_0x159cf3(0xa05)][_0x159cf3(0xa3d)](_0x461174 => { const _0x589b83 = _0x159cf3; if (_0x589b83(0x2f2) !== _0x589b83(0xa89)) { const _0xd50e4d = _0x461174[_0x589b83(0x41d)] === _0x589b83(0x565) ? '你' : _0x4076a0[_0x589b83(0x692)]; _0x374b20 += '\x20\x20\x20\x20-\x20' + _0xd50e4d + ':\x20' + _0x461174[_0x589b83(0x359)] + '\x0a'; } else { const _0x8d2afd = _0x3e2644['max'](0x1, _0x37fb3a(_0x2adb6e[_0x589b83(0xa2a)]?.[_0x589b83(0x164)] ?? 0x64)), _0x48b007 = _0x571749['chats'][_0x589b83(0x9f6)](_0x1164cc => _0x1164cc['participantIds'][_0x589b83(0x4da)](_0x3e9ed6)), _0x41001a = _0x48b007['map'](_0x409c8b => { const _0x3e060a = _0x589b83, _0x14f91f = _0xa0e426(_0x409c8b['id']), _0x3003a3 = _0x14f91f[_0x3e060a(0x919)] > 0x0 ? _0x14f91f[_0x14f91f[_0x3e060a(0x919)] - 0x1] : null; return { 'chat': _0x409c8b, 'history': _0x14f91f, 'lastTimestamp': _0x3003a3 ? _0x3003a3['timestamp'] : 0x0 }; })['filter'](_0x251e6a => _0x251e6a[_0x589b83(0x54c)][_0x589b83(0x919)] > 0x0); _0x41001a[_0x589b83(0x8d8)]((_0x5d019e, _0x3fdb1a) => _0x3fdb1a[_0x589b83(0x582)] - _0x5d019e[_0x589b83(0x582)]); const _0xdef8b9 = [], _0x584b58 = {}; return _0x41001a[_0x589b83(0xa3d)]((_0x4ee3d9, _0xdcb2c9) => { const _0x16c391 = _0x589b83, _0x2e6f33 = _0x37a0e8(_0x4ee3d9[_0x16c391(0x6b7)], _0x4ee3d9[_0x16c391(0x54c)], _0x8d2afd); if (_0x2e6f33[_0x16c391(0x919)] === 0x0) return; const _0x212ab2 = _0xdcb2c9 === 0x0 ? _0x16c391(0x906) : _0x16c391(0x212); _0xdef8b9[_0x16c391(0x438)](_0x16c391(0x292) + _0x212ab2 + _0x268bb8(_0x4ee3d9[_0x16c391(0x6b7)]) + '\x0a' + _0x2e6f33[_0x16c391(0x63b)]('\x0a')), _0x584b58[_0x4ee3d9[_0x16c391(0x6b7)]['id']] = _0x2e6f33[_0x16c391(0x919)]; }), { 'omniText': _0xdef8b9[_0x589b83(0x63b)]('\x0a\x0a'), 'usedCounts': _0x584b58 }; } }))); }); break; case _0x444ca0(0xae4): _0x50d278['forEach'](_0x30230c => { const _0x32e98 = _0x444ca0; _0x374b20 += _0x32e98(0x11b) + _0x30230c[_0x32e98(0x6c1)] + _0x32e98(0x18d); }); break; case _0x444ca0(0xa37): _0x50d278[_0x444ca0(0xa3d)](_0xcb2405 => { const _0xed30ec = _0x444ca0; _0xed30ec(0x712) !== 'sIznx' ? _0x374b20 += _0xed30ec(0x5de) + _0xcb2405[_0xed30ec(0x640)] + _0xed30ec(0xa62) + _0xcb2405[_0xed30ec(0x359)]['replace'](/\n/g, '\x20') + _0xed30ec(0x18d) : _0x29cd82(_0xed30ec(0xaf9) + _0x3aae6d[_0xed30ec(0x997)]); }); break; case _0x444ca0(0x97c): _0x50d278[_0x444ca0(0xa3d)](_0x3a8b8b => { const _0x293ab4 = _0x444ca0; _0x374b20 += _0x293ab4(0x1d1) + _0x3a8b8b['restaurant_name'] + _0x293ab4(0x9ca) + _0x3a8b8b[_0x293ab4(0x638)][_0x293ab4(0x63b)]('、') + '。\x0a'; }); break; case 'wants': _0x50d278['forEach'](_0x5800bd => { const _0x407155 = _0x444ca0; _0x407155(0x8e9) !== _0x407155(0x7ac) ? _0x374b20 += _0x407155(0xa3f) + _0x5800bd[_0x407155(0xaa4)] + '”买过：“' + _0x5800bd[_0x407155(0x740)] + _0x407155(0x18d) : (_0x2c7841 = _0x1198ec[_0x407155(0xa93)](_0x407155(0x80f)), _0x3834c1['id'] = 'style-' + _0x4d1966['id'], _0x30eab9[_0x407155(0x7c9)][_0x407155(0x25f)](_0x2e8425)); }); break; case _0x444ca0(0x310): _0x50d278[_0x444ca0(0xa3d)](_0x5b406c => { const _0x592082 = _0x444ca0; _0x374b20 += '-\x20你最近去过：“' + _0x5b406c['location_name'] + '”，在那里“' + _0x5b406c[_0x592082(0xa57)] + _0x592082(0x18d); }); break; default: _0x50d278[_0x444ca0(0xa3d)](_0x5c14e8 => { const _0x5b3597 = _0x444ca0; if (_0x5b3597(0x7a1) === _0x5b3597(0x267)) { const _0x5f21c3 = _0x44d0b4(_0x2138d4[_0x5b3597(0x616)] || _0x5d9451[_0x5b3597(0x49a)]); _0x312cb3 = _0x5f21c3?.[_0x5b3597(0xb15)] || '角色', _0x510eab = _0x5b3597(0xa36); } else _0x374b20 += '-\x20' + JSON[_0x5b3597(0x2a5)](_0x5c14e8) + '\x0a'; }); break; } } } } } catch (_0x1e776a) { if (_0x444ca0(0xae6) === _0x444ca0(0x569)) { const _0x135aec = _0x30703a['createElement'](_0x444ca0(0x64e)); _0x135aec['className'] = _0x5b5a77[_0x444ca0(0x713)] === _0x444ca0(0x7ea) ? _0x444ca0(0x53c) : _0x444ca0(0x3bb), _0x135aec[_0x444ca0(0x574)] = _0x2bc093['content'], _0x135aec[_0x444ca0(0x2f7)]['id'] = _0x29198d['id'], _0x42a56d['appendChild'](_0x135aec); } else console[_0x444ca0(0x297)]('加载视奸记忆失败\x20(' + _0x4feca1['id'] + _0x444ca0(0x262), _0x1e776a); } } return _0x374b20; } else { const _0xd0bd43 = _0x4dd31f[_0x444ca0(0x289)](_0x4fe6a8); _0x238da2[_0x444ca0(0x80f)][_0x444ca0(0xad6)] = _0x444ca0(0x22e) + _0xd0bd43 + '\x27)'; } } function _0x2c28a5(_0x6f820a) { const _0x20389d = _0x187760; if (!Array['isArray'](_0x6f820a)) return _0x20389d(0x72c); if (_0x6f820a['length'] === 0x0) return '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>相册是空的。</p>'; return '<div\x20style=\x22background:\x20var(--card-bg);\x20border-radius:\x2012px;\x20overflow:\x20hidden;\x20border:\x201px\x20solid\x20var(--border-color);\x22>' + _0x6f820a[_0x20389d(0xa96)]((_0x2f964d, _0x151114) => '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22character-item\x22\x20style=\x22align-items:\x20flex-start;\x20margin-bottom:\x200;\x20padding:\x2015px;\x20' + (_0x151114 < _0x6f820a[_0x20389d(0x919)] - 0x1 ? _0x20389d(0x946) : '') + _0x20389d(0x43d) + (_0x2f964d['description'] || _0x20389d(0x972)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22margin-top:\x208px;\x20font-size:\x200.75rem;\x22>' + (_0x2f964d['timestamp'] || '') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20')[_0x20389d(0x63b)]('') + _0x20389d(0x892); } function _0xca2156(_0x54562c, _0x8bdd7c) { const _0x26695e = _0x187760; if (!Array[_0x26695e(0xac4)](_0x54562c) || _0x54562c[_0x26695e(0x919)] === 0x0) return _0x26695e(0x2d1); return _0x26695e(0x317) + _0x54562c[_0x26695e(0xa96)]((_0x5d3617, _0x54a06c) => { const _0x316549 = _0x26695e, _0x5e5ada = JSON[_0x316549(0x2a5)](_0x5d3617['log'] || [])[_0x316549(0x998)](/'/g, _0x316549(0x8ec))[_0x316549(0x998)](/"/g, '&quot;'), _0x577cbb = _0x5d3617[_0x316549(0x692)] || _0x316549(0x29b); return _0x316549(0x98e) + (_0x54a06c < _0x54562c[_0x316549(0x919)] - 0x1 ? _0x316549(0x946) : '') + _0x316549(0x1c1) + _0x5e5ada + '\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-contact-name=\x27' + _0x577cbb + _0x316549(0x73e) + _0x8bdd7c + '\x27>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22background-color:\x20#eee;\x20font-size:\x201.5rem;\x22>' + _0x577cbb[_0x316549(0x591)](0x0) + _0x316549(0x1e3) + _0x577cbb + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22\x20style=\x22white-space:\x20nowrap;\x20overflow:\x20hidden;\x20text-overflow:\x20ellipsis;\x20color:\x20var(--text-color-light);\x22>' + (_0x5d3617[_0x316549(0x589)] || '') + _0x316549(0x1a3); })[_0x26695e(0x63b)]('') + '</div>'; } function _0x1fa39e(_0x2b5f77) { const _0x139f4d = _0x187760; if (!Array['isArray'](_0x2b5f77)) return _0x139f4d(0x72c); if (_0x2b5f77['length'] === 0x0) return '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>浏览器历史是空的。</p>'; return _0x2b5f77[_0x139f4d(0x8d8)]((_0x34bf5e, _0x5c3faa) => new Date(_0x5c3faa[_0x139f4d(0x6de)]) - new Date(_0x34bf5e[_0x139f4d(0x6de)])), _0x139f4d(0x317) + _0x2b5f77[_0x139f4d(0xa96)]((_0x19a753, _0x1dcd8d) => _0x139f4d(0xaa9) + (_0x1dcd8d < _0x2b5f77['length'] - 0x1 ? _0x139f4d(0x946) : '') + _0x139f4d(0x9d1) + (_0x19a753[_0x139f4d(0x6c1)] || '未知搜索') + _0x139f4d(0x722) + (_0x19a753[_0x139f4d(0x185)] || _0x139f4d(0x1bc)) + _0x139f4d(0x862) + (_0x19a753[_0x139f4d(0x6de)] || '') + '</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20')[_0x139f4d(0x63b)]('') + _0x139f4d(0x892); } function _0xe578dd(_0x49181e) { const _0x26fb51 = _0x187760; if (!Array[_0x26fb51(0xac4)](_0x49181e)) return _0x26fb51(0x72c); if (_0x49181e['length'] === 0x0) return _0x26fb51(0x9b2); return _0x49181e['sort']((_0x43d945, _0x328430) => new Date(_0x328430[_0x26fb51(0x771)]) - new Date(_0x43d945[_0x26fb51(0x771)])), _0x49181e['map'](_0x3c7968 => _0x26fb51(0xb01) + (_0x3c7968[_0x26fb51(0x640)] || _0x26fb51(0x34d)) + _0x26fb51(0x8fc) + (_0x3c7968[_0x26fb51(0x359)] || '') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22text-align:\x20right;\x20margin-top:\x208px;\x20font-size:\x200.7rem;\x22>编辑于\x20' + (_0x3c7968['last_edited'] || '') + _0x26fb51(0xa4f))[_0x26fb51(0x63b)](''); } function _0x37a664(_0x4d9427) { const _0x2f49a5 = _0x187760; if (_0x2f49a5(0x4a0) !== 'dIazw') { const _0x310414 = _0x160016['transaction'](_0x1e3037, _0x2f49a5(0x8e0)), _0x24b31d = _0x310414[_0x2f49a5(0x4d6)](_0x4bc9c4), _0x25a2cf = _0x24b31d['get'](_0x4877d2); _0x25a2cf[_0x2f49a5(0x5f6)] = () => _0xd9f801(_0x25a2cf['result'] ? _0x25a2cf[_0x2f49a5(0x563)][_0x2f49a5(0x2c8)] : null), _0x25a2cf['onerror'] = () => _0x5a6a63(_0x25a2cf[_0x2f49a5(0x297)]); } else { if (!Array['isArray'](_0x4d9427)) return '<p>格式错误</p>'; if (_0x4d9427[_0x2f49a5(0x919)] === 0x0) return _0x2f49a5(0xadc); return _0x4d9427[_0x2f49a5(0x8d8)]((_0x47e281, _0x45870d) => new Date(_0x45870d[_0x2f49a5(0x6de)]) - new Date(_0x47e281[_0x2f49a5(0x6de)])), _0x4d9427[_0x2f49a5(0xa96)](_0x43f817 => { const _0x3b7a97 = _0x2f49a5, _0x5400f6 = (_0x43f817[_0x3b7a97(0x638)] || [])['map'](_0x163162 => _0x3b7a97(0x811) + _0x163162 + _0x3b7a97(0x20c))[_0x3b7a97(0x63b)](''); return _0x3b7a97(0x3ae) + (_0x43f817[_0x3b7a97(0x871)] || _0x3b7a97(0xa2f)) + _0x3b7a97(0xaf2) + (_0x43f817[_0x3b7a97(0x6de)] || '') + _0x3b7a97(0x178) + (_0x43f817['status'] || _0x3b7a97(0xa10)) + _0x3b7a97(0x48b) + _0x5400f6 + _0x3b7a97(0x8e3) + (_0x43f817[_0x3b7a97(0x2d2)] || 0x0)[_0x3b7a97(0x394)](0x2) + _0x3b7a97(0x23b); })[_0x2f49a5(0x63b)](''); } } function _0x28ab00(_0x2b21b6) { const _0x2496a9 = _0x187760; if (_0x2496a9(0x176) !== _0x2496a9(0x176)) _0x33254a(_0x2496a9(0x2db) + _0x5d637b[_0x2496a9(0x997)]); else { if (!Array['isArray'](_0x2b21b6)) return _0x2496a9(0x72c); if (_0x2b21b6['length'] === 0x0) return _0x2496a9(0xa5a); return _0x2b21b6[_0x2496a9(0x8d8)]((_0x4da9f2, _0x434ebc) => new Date(_0x434ebc[_0x2496a9(0x6de)]) - new Date(_0x4da9f2['timestamp'])), _0x2b21b6[_0x2496a9(0xa96)](_0x19341c => '\x0a\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20padding:\x2015px;\x20background:\x20white;\x20box-shadow:\x20var(--soft-shadow);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x20margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22font-weight:\x20500;\x22>🛒\x20' + (_0x19341c[_0x2496a9(0xaa4)] || '未知商店') + _0x2496a9(0x32a) + (_0x19341c[_0x2496a9(0x6de)] || '') + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22width:\x2070px;\x20height:\x2070px;\x20background-color:\x20#f0f2f5;\x20border-radius:\x208px;\x20font-size:\x202.5rem;\x20flex-shrink:\x200;\x22>🛍️</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22flex-grow:\x201;\x20display:\x20flex;\x20flex-direction:\x20column;\x20justify-content:\x20space-between;\x20height:\x2070px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20500;\x20line-height:\x201.4;\x20-webkit-line-clamp:\x202;\x20display:\x20-webkit-box;\x20-webkit-box-orient:\x20vertical;\x20overflow:\x20hidden;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x19341c[_0x2496a9(0x740)] || _0x2496a9(0x453)) + _0x2496a9(0x14e) + (_0x19341c['cost'] || 0x0)[_0x2496a9(0x394)](0x2) + _0x2496a9(0x7d7))[_0x2496a9(0x63b)](''); } } function _0x1efd06(_0x43478e) { const _0x5c65e1 = _0x187760; if (_0x5c65e1(0x4ad) === _0x5c65e1(0x6cf)) _0x3d7372(_0x6a4803[_0x5c65e1(0x1bd)])[_0x5c65e1(0x276)](_0x153c65 => { const _0x565c14 = _0x5c65e1; if (_0x153c65) { const _0x166668 = _0x4347dc[_0x565c14(0x289)](_0x153c65); _0x51131c[_0x565c14(0x686)] = _0x166668, _0x4a592e[_0x565c14(0x44b)] = () => _0x2adeb9['revokeObjectURL'](_0x166668); } }); else { if (!Array['isArray'](_0x43478e)) return '<p>格式错误</p>'; if (_0x43478e['length'] === 0x0) return _0x5c65e1(0x376); return _0x43478e[_0x5c65e1(0x8d8)]((_0xab7077, _0x4b7075) => new Date(_0x4b7075[_0x5c65e1(0x6de)]) - new Date(_0xab7077[_0x5c65e1(0x6de)])), _0x5c65e1(0x2ad) + _0x43478e[_0x5c65e1(0xa96)](_0x57264 => _0x5c65e1(0x77a) + (_0x57264[_0x5c65e1(0x13a)] || '未知地点') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x22>' + (_0x57264[_0x5c65e1(0xa57)] || '') + _0x5c65e1(0xa63) + (_0x57264[_0x5c65e1(0x6de)] || '') + _0x5c65e1(0x680))[_0x5c65e1(0x63b)]('') + '</div>'; } } async function _0xf2541e(_0x5f01a3, _0x43bcd6, _0x5571e5 = null) { const _0x54211c = _0x187760, _0x43f51f = _0x4cc875(_0x43bcd6), _0x3f0f23 = _0x29b260[_0x54211c(0x6df)][_0x54211c(0x444)](_0x24be6f => _0x24be6f[_0x54211c(0x713)] === 'private' && _0x24be6f['participantIds']['includes'](_0x43bcd6)), _0x44244b = _0x33ec75(_0x3f0f23?.['id'] || _0x29b260[_0x54211c(0x7b1)]); if (!_0x43f51f) throw new Error(_0x54211c(0x284)); const { omniText: _0x4a8976 } = _0x2eac37(_0x43bcd6); let _0x2d4276 = ''; const _0x46d544 = new Date(); let _0x2e04a1 = null, _0x4f3c9f = '无'; if (_0x5571e5) { if (_0x54211c(0x489) === _0x54211c(0x33d)) { const _0x1180f9 = { 'id': _0x54211c(0x853) + _0xf6a9fb[_0x54211c(0x74c)](), 'name': _0x4df484, 'content': _0x5bb3c9 }; _0x5c7bcf['worldBooks'][_0x54211c(0x438)](_0x1180f9); } else try { let _0x43c9cc; try { _0x43c9cc = JSON[_0x54211c(0x1db)](_0x5571e5); } catch (_0x485863) { _0x43c9cc = _0x1ed362(_0x5571e5); } if (Array[_0x54211c(0xac4)](_0x43c9cc) && _0x43c9cc[_0x54211c(0x919)] > 0x0) { const _0x42cf5c = _0x43c9cc[_0x54211c(0xa96)](_0x559187 => new Date(_0x559187[_0x54211c(0x6de)] || _0x559187[_0x54211c(0x771)]))[_0x54211c(0x9f6)](_0x5f03f6 => !isNaN(_0x5f03f6)); _0x42cf5c[_0x54211c(0x919)] > 0x0 && (_0x2e04a1 = new Date(Math[_0x54211c(0x355)]['apply'](null, _0x42cf5c)), _0x4f3c9f = _0x2e04a1[_0x54211c(0x22a)]('zh-CN', { 'dateStyle': _0x54211c(0x9a2), 'timeStyle': _0x54211c(0x704) })); } } catch (_0x3a6a03) { if (_0x54211c(0x5a8) !== _0x54211c(0x5a8)) { if (_0x24f2f5 === null) return; _0x403621[_0x54211c(0xa85)][_0x54211c(0x903)](_0x4a496d, 0x1), _0x5a7581(), _0x605106(), _0x175d55(); } else console[_0x54211c(0x2b1)](_0x54211c(0xa0c), _0x3a6a03); } } const _0x49c4dd = _0x18e032(_0x43bcd6); _0x2d4276 = _0x54211c(0xaaa), _0x2d4276 += '-\x20**当前精确时间**:\x20' + _0x46d544[_0x54211c(0x22a)]('zh-CN', { 'dateStyle': _0x54211c(0x728), 'timeStyle': _0x54211c(0x704) }) + '\x0a'; if (_0x49c4dd) { const _0x2714bf = new Date(_0x49c4dd[_0x54211c(0x6de)]), _0x7339e = _0x236f37(_0x2714bf); _0x2d4276 += '-\x20**你最后一次活动是在**:\x20' + _0x7339e + '\x0a'; const _0x7ddcad = _0x46d544[_0x54211c(0x9a6)](), _0xdf3f24 = _0x2714bf[_0x54211c(0x9a6)](), _0x204380 = new Date(); _0x204380[_0x54211c(0x1ad)](_0x46d544[_0x54211c(0x3de)]() - 0x1); const _0x70de45 = _0x204380[_0x54211c(0x9a6)](); if (_0x7ddcad === _0xdf3f24) { const _0x377b64 = (_0x46d544 - _0x2714bf) / (0x3e8 * 0x3c); _0x2d4276 += _0x54211c(0xac3); } else { if (_0x70de45 === _0xdf3f24) _0x2d4276 += _0x54211c(0x71e); else { const _0x3b6b82 = Math[_0x54211c(0x6f8)]((_0x46d544 - _0x2714bf) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x2d4276 += _0x54211c(0x475) + _0x3b6b82 + '\x20天没活动了。你生成的内容必须是全新的事件。\x0a'; } } } else _0x2d4276 += _0x54211c(0x472); let _0x463e9f = '', _0x999d0c = ''; _0x5571e5 ? (_0x463e9f = _0x54211c(0x440), _0x999d0c = _0x54211c(0x796) + _0x5571e5 + '\x0a```') : _0x463e9f = _0x54211c(0x615); const _0x58b592 = { 'gallery': _0x54211c(0xab1), 'whispers': _0x54211c(0xa1b), 'abyss': '\x0a#\x20任务:\x20生成浏览器记录\x0a生成5\x20-\x207条足以暴露角色当前真实想法、困惑或兴趣的搜索历史记录。并且，为每一条历史记录，生成一段模拟的“搜索结果页”摘要。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22query\x22:\x20\x22一个人过生日怎么庆祝\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-23\x2022:15\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22result_page_content\x22:\x20\x22【热门回答】一个人的生日也可以充满仪式感！推荐尝试独自旅行...\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'fragments': '\x0a#\x20任务:\x20生成备忘录内容\x0a生成2\x20-\x203个简短的备忘录。内容必须多样化，足以体现角色的生活细节和内心世界。可以是购物清单、几句没头没尾的歌词、一个地址、或者一段练习如何道歉的草稿。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22要买的东西\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22-\x20牛奶\x5cn-\x20猫粮（快没了！）\x5cn-\x20《仿生人会梦见电子羊吗？》\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22last_edited\x22:\x20\x222025-09-25\x2009:10\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'bites': '\x0a#\x20任务:\x20生成外卖订单记录\x0a生成最近的2\x20-\x203条外卖订单。订单内容必须严格符合角色的设定、作息和财务状况。订单时间也要和他的生活轨迹对得上。一些比较幻想风格的角色可以用更加符合角色背景的内容风格，需要符合角色的时代和世界观背景。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22restaurant_name\x22:\x20\x22深夜食堂\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22items\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22肥牛饭\x20x1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22冰可乐\x20x1\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22total_cost\x22:\x2025.00,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22订单已送达\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-24\x2023:45\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'wants': '\x0a#\x20任务:\x20生成购物记录\x0a创建一份近期的购物清单。这些商品必须是有指向性的，而不是随便买的日用品。比如游戏、书籍、衣服等。最关键的是，这些记录必须和他\x20/\x20她的浏览器历史、备忘录、聊天内容里透露出的兴趣和秘密能够互相印证。一些比较幻想风格的角色可以用更加符合角色背景的内容风格。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22item_name\x22:\x20\x22《神经漫游者》\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22store_name\x22:\x20\x22城东旧书店\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22书籍\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22cost\x22:\x2045.00,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-22\x2015:10\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'footprints': _0x54211c(0x20e) }, _0x1eda28 = _0x58b592[_0x5f01a3] || _0x54211c(0x666) + _0x5f01a3 + _0x54211c(0x592); let _0x48c7da = ''; if (_0x43f51f[_0x54211c(0x5c0)] && _0x43f51f[_0x54211c(0x5c0)]['length'] > 0x0) { const _0x2e4518 = _0x43f51f[_0x54211c(0x5c0)][_0x54211c(0xa96)](_0x5a4ce7 => _0x29b260[_0x54211c(0x1a1)][_0x54211c(0x444)](_0x55783a => _0x55783a['id'] === _0x5a4ce7))['filter'](Boolean)[_0x54211c(0xa96)](_0x2fb2cd => '\x0a##\x20世界书条目:\x20' + _0x2fb2cd[_0x54211c(0xb15)] + '\x0a' + _0x2fb2cd[_0x54211c(0x359)])[_0x54211c(0x63b)](''); _0x2e4518 && (_0x48c7da = '\x0a#\x20核心世界观设定(角色必须严格遵守)\x20\x0a' + _0x2e4518); } const _0x4207d1 = _0x54211c(0x8a4) + _0x43f51f[_0x54211c(0xb15)] + _0x54211c(0x362) + _0x43f51f[_0x54211c(0xb15)] + _0x54211c(0x270) + _0x44244b[_0x54211c(0xb15)] + _0x54211c(0x791) + _0x4f3c9f + '\x0a-\x20当前精确时间:\x20' + _0x46d544[_0x54211c(0x22a)](_0x54211c(0x513), { 'dateStyle': 'full', 'timeStyle': 'short' }) + '\x0a-\x20【绝对指令】你生成的所有新条目，其\x20\x22timestamp\x22\x20或\x20\x22last_edited\x22\x20必须严格晚于“已有内容的最新时间点”，并且必须早于或等于“当前精确时间”。严禁创造未来的事件。\x0a\x0a#\x20角色核心资料\x0a-\x20姓名:\x20' + _0x43f51f[_0x54211c(0xb15)] + _0x54211c(0x1c6) + _0x43f51f[_0x54211c(0x435)] + '\x0a' + _0x48c7da + _0x54211c(0x5f5) + _0x44244b[_0x54211c(0xb15)] + _0x54211c(0x1c6) + _0x44244b[_0x54211c(0x435)] + _0x54211c(0x5fb) + _0x4a8976 + '\x0a' + _0x999d0c + _0x54211c(0x2e5) + _0x463e9f + '\x0a' + _0x1eda28 + _0x54211c(0xaec), _0x7e558b = [{ 'role': 'system', 'content': _0x4207d1 }]; _0x7e558b[_0x54211c(0x438)]({ 'role': 'user', 'content': _0x54211c(0xa8a) }); const _0x8a0334 = await _0x315051(_0x7e558b, { 'json': !![] }); return _0x8a0334; } async function _0x14de22(_0x3a5f6a) { const _0x3468b0 = _0x187760; if ('WfXUn' === _0x3468b0(0x7d6)) { const _0x5e9c0f = _0x4cc875(_0x3a5f6a); if (!_0x5e9c0f) throw new Error(_0x3468b0(0x96a)); _0x195491(!![], '正在翻阅所有档案...'); const _0x42d8ed = [_0x3468b0(0x725), 'whispers', _0x3468b0(0xae4), _0x3468b0(0xa37), _0x3468b0(0x97c), _0x3468b0(0x8c4), _0x3468b0(0x310)]; let _0x4efd17 = {}; await Promise[_0x3468b0(0x14b)](_0x42d8ed[_0x3468b0(0xa96)](async _0x29bc46 => { const _0x5eb5c9 = _0x3468b0; if (_0x5eb5c9(0x754) === _0x5eb5c9(0x7df)) _0x48a7f6(() => { const _0x20986a = _0x5eb5c9, _0x2eeabb = _0x3febf8[_0x20986a(0x759)](_0x312495); if (_0x2eeabb) _0x2eeabb[_0x20986a(0x686)] = _0x560d1c[_0x20986a(0x8ff)]; }, 0x0); else { const _0x727899 = 'snoop_' + _0x3a5f6a + '_' + _0x29bc46, _0x1f7fa7 = await _0x53a882(_0x727899); if (_0x1f7fa7) try { _0x4efd17[_0x29bc46] = JSON['parse'](_0x1f7fa7); } catch (_0x2db117) { } } })); if (Object['keys'](_0x4efd17)[_0x3468b0(0x919)] === 0x0) { if ('GCofo' === _0x3468b0(0x4af)) _0x5b9472[_0x3468b0(0xa2a)][_0x3468b0(0x9a0)] = _0x413fb7[_0x3468b0(0xacb)], _0x15fccf(), _0x38a15e(); else return _0x3468b0(0x91a); } const _0x3b1d2c = _0x3468b0(0x3a8) + _0x5e9c0f[_0x3468b0(0xb15)] + _0x3468b0(0x80d), _0x570f34 = [{ 'role': _0x3468b0(0x4c2), 'content': _0x3b1d2c }, { 'role': 'user', 'content': JSON[_0x3468b0(0x2a5)](_0x4efd17, null, 0x2) }]; _0x195491(!![], _0x3468b0(0x4f1)); const _0x14806a = await _0x315051(_0x570f34); return _0x14806a || _0x3468b0(0x220); } else { const _0x57f7e5 = _0x4303b2(_0x194eef['activeChatId']); _0x40ab39 = _0x57f7e5[_0x3468b0(0x96f)] || _0x397c6b; } } async function _0x14de22(_0x1c12e9) { const _0x324246 = _0x187760, _0xe353c0 = _0x4cc875(_0x1c12e9); if (!_0xe353c0) throw new Error(_0x324246(0x96a)); try { _0x195491(!![], _0x324246(0x21f)); const _0x1185f6 = ['gallery', 'whispers', _0x324246(0xae4), _0x324246(0xa37), _0x324246(0x97c), _0x324246(0x8c4), _0x324246(0x310)]; let _0x34912d = {}; await Promise['all'](_0x1185f6[_0x324246(0xa96)](async _0x1cf9ca => { const _0x1f3dd8 = _0x324246, _0x1cbec7 = _0x1f3dd8(0xb25) + _0x1c12e9 + '_' + _0x1cf9ca, _0x15c482 = await _0x53a882(_0x1cbec7); if (_0x15c482) try { _0x34912d[_0x1cf9ca] = JSON[_0x1f3dd8(0x1db)](_0x15c482); } catch (_0x18a0ba) { } })); if (Object[_0x324246(0x60b)](_0x34912d)[_0x324246(0x919)] === 0x0) return _0x324246(0x91a); const _0x24423b = _0x324246(0x3a8) + _0xe353c0[_0x324246(0xb15)] + _0x324246(0x28d), _0x4f142c = [{ 'role': 'system', 'content': _0x24423b }, { 'role': _0x324246(0x544), 'content': JSON[_0x324246(0x2a5)](_0x34912d, null, 0x2) }]; _0x195491(!![], _0x324246(0x4f1)); const _0x3301c8 = await _0x315051(_0x4f142c); return _0x3301c8 || _0x324246(0x220); } finally { if (_0x324246(0x75a) === _0x324246(0x42b)) { const _0x465974 = _0x3bba96(_0x3720bf[_0x324246(0x616)]); return _0x465974?.[_0x324246(0xb15)] || _0x324246(0x352); } else _0x195491(![]); } } document['getElementById']('back-to-home-from-snoop-list')[_0x187760(0x6cc)](_0x187760(0x7ec), () => _0x57a80a(_0x187760(0x83c), 'snoopList')), document['getElementById'](_0x187760(0x897))[_0x187760(0x6cc)](_0x187760(0x7ec), () => { const _0x39a561 = _0x187760; if (_0x39a561(0x9b6) === _0x39a561(0xa98)) { if (_0x1c9fba) { const _0x5bcbfa = _0x4d4969(_0x4d8b01[_0x39a561(0x49a)]); _0x5bcbfa && (delete _0x5bcbfa[_0x39a561(0x433)], _0x4f4674(), _0x29c58e(_0x5bcbfa['id'], _0x39a561(0x69b)), _0x3d5548(_0x39a561(0x806)), _0x170943(!![])); } } else document[_0x39a561(0x759)](_0x39a561(0x800))[_0x39a561(0x80f)][_0x39a561(0x3e7)] = _0x39a561(0x697), _0x57a80a(_0x39a561(0x491), _0x39a561(0x55f)); }), _0x4058db(); }); async function _0x4df8e9() { const _0x115c4d = _0x42e5a0; console['log']('---\x20Noir\x27s\x20Data\x20Purification\x20Ritual\x20v1.0\x20---'), console[_0x115c4d(0xa05)](_0x115c4d(0x9b7)); async function _0x395e4d(_0x1c94a7, _0x4f870e) { const _0x172a24 = _0x115c4d; if (_0x172a24(0x8db) !== 'DswZT') _0x1e4eef[_0x172a24(0x113)] = _0x314b2e, _0xc2f778(), _0x1fba7c(_0x172a24(0xb0a)), _0xacce61(), _0x2957ad[_0x172a24(0x759)](_0x172a24(0x32e))[_0x172a24(0x80f)]['display'] = _0x172a24(0x697); else { const _0x533712 = await _0x3479a8; return new Promise((_0x33e5b1, _0x2c9b6a) => { const _0x3c498f = _0x172a24, _0x5e26d7 = _0x533712[_0x3c498f(0x95f)](_0x2e0278, 'readwrite'), _0x5b08a4 = _0x5e26d7[_0x3c498f(0x4d6)](_0x2e0278), _0x138763 = _0x5b08a4['put']({ 'id': _0x1c94a7, 'blob': _0x4f870e }); _0x138763['onsuccess'] = () => _0x33e5b1(_0x138763['result']), _0x138763['onerror'] = () => _0x2c9b6a(_0x138763['error']); }); } } async function _0x238156(_0x2ec04e) { const _0x3dbae4 = await _0x3479a8; return new Promise((_0x3f367f, _0x1d86fe) => { const _0x779d7a = _0x18ce; if (_0x779d7a(0x41f) === _0x779d7a(0x842)) { _0x37e8bb[_0x779d7a(0x29c)] = _0x779d7a(0x518); return; } else { const _0x2172e1 = _0x3dbae4[_0x779d7a(0x95f)](_0x2dd60e, _0x779d7a(0x8e0)), _0x4cd5a8 = _0x2172e1['objectStore'](_0x2dd60e), _0x108b3c = _0x4cd5a8[_0x779d7a(0x2fe)](_0x2ec04e); _0x108b3c['onsuccess'] = () => _0x3f367f(_0x108b3c['result'] ? _0x108b3c[_0x779d7a(0x563)][_0x779d7a(0x2c8)] : null), _0x108b3c[_0x779d7a(0x634)] = () => _0x1d86fe(_0x108b3c['error']); } }); } async function _0x12ee55(_0x6e8584, _0x10c2e0) { const _0xf20a7 = await _0x3479a8; return new Promise((_0x47515e, _0x48cd15) => { const _0x4ea9bd = _0x18ce, _0x3e605d = _0xf20a7['transaction'](_0x2dd60e, _0x4ea9bd(0x236)), _0xa921d1 = _0x3e605d['objectStore'](_0x2dd60e), _0xb3de9f = _0xa921d1[_0x4ea9bd(0xaed)]({ 'id': _0x6e8584, 'data': _0x10c2e0 }); _0xb3de9f[_0x4ea9bd(0x5f6)] = () => _0x47515e(), _0xb3de9f[_0x4ea9bd(0x634)] = () => _0x48cd15(_0xb3de9f[_0x4ea9bd(0x297)]); }); } function _0x34fd0c(_0xafd5fe) { const _0x162c48 = _0x115c4d; return fetch(_0xafd5fe)[_0x162c48(0x276)](_0x424fc4 => _0x424fc4[_0x162c48(0x24c)]()); } let _0x235e23 = 0x0; for (let _0x4570e6 = 0x0; _0x4570e6 < localStorage[_0x115c4d(0x919)]; _0x4570e6++) { const _0x52fb35 = localStorage[_0x115c4d(0x251)](_0x4570e6); if (_0x52fb35 && _0x52fb35[_0x115c4d(0x736)](_0x115c4d(0x4a9))) { let _0x501d9e, _0x43cb90 = ![]; try { _0x501d9e = JSON[_0x115c4d(0x1db)](localStorage[_0x115c4d(0x860)](_0x52fb35)); if (!Array[_0x115c4d(0xac4)](_0x501d9e)) continue; for (const _0x456b06 of _0x501d9e) { if (_0x456b06 && _0x456b06['image'] && _0x456b06[_0x115c4d(0x7ee)][_0x115c4d(0x736)](_0x115c4d(0x93e))) { const _0x4d5c08 = await _0x34fd0c(_0x456b06[_0x115c4d(0x7ee)]), _0x41732e = 'chat_image_migrated_' + Date[_0x115c4d(0x74c)]() + '_' + Math[_0x115c4d(0x545)](); await _0x395e4d(_0x41732e, _0x4d5c08), _0x456b06['imageId'] = _0x41732e, delete _0x456b06[_0x115c4d(0x7ee)], _0x43cb90 = !![], _0x235e23++; } } _0x43cb90 && localStorage['setItem'](_0x52fb35, JSON[_0x115c4d(0x2a5)](_0x501d9e)); } catch (_0x1c1353) { console[_0x115c4d(0x297)]('处理\x20' + _0x52fb35 + _0x115c4d(0x83f), _0x1c1353); continue; } } } console[_0x115c4d(0xa05)]('净化完成！总共迁移了\x20' + _0x235e23 + _0x115c4d(0x41b)); } async function _0x704784() { const _0x56b188 = _0x42e5a0; console[_0x56b188(0xa05)](_0x56b188(0x343)), console[_0x56b188(0xa05)](_0x56b188(0x137)); async function _0x5f4a86(_0x112b5b, _0x483867) { const _0x59b0bd = _0x56b188; if (_0x59b0bd(0xafc) !== _0x59b0bd(0xafc)) { if (!_0xcbfd12[_0x59b0bd(0xac4)](_0x3bf9d3)) return _0x59b0bd(0x72c); if (_0x15f46f[_0x59b0bd(0x919)] === 0x0) return _0x59b0bd(0x1b9); return _0x59b0bd(0x317) + _0x2434c0['map']((_0x4b59ba, _0x4c713f) => _0x59b0bd(0x685) + (_0x4c713f < _0x1c91f6[_0x59b0bd(0x919)] - 0x1 ? 'border-bottom:\x201px\x20solid\x20var(--border-color);' : '') + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22width:\x2060px;\x20height:\x2060px;\x20background-color:\x20#eee;\x20border-radius:\x208px;\x20font-size:\x202rem;\x20flex-shrink:\x200;\x22>🖼️</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22\x20style=\x22margin-top:\x202px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a<div\x20class=\x22char-remark\x22\x20style=\x22white-space:\x20normal;\x20line-height:\x201.6;\x22>' + (_0x4b59ba[_0x59b0bd(0xb16)] || _0x59b0bd(0x972)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22margin-top:\x208px;\x20font-size:\x200.75rem;\x22>' + (_0x4b59ba[_0x59b0bd(0x6de)] || '') + _0x59b0bd(0x622))[_0x59b0bd(0x63b)]('') + _0x59b0bd(0x892); } else { const _0x425668 = await _0x3479a8; return new Promise((_0x47aee2, _0x5e5af6) => { const _0x47da37 = _0x59b0bd; if ('NkfOG' === 'NkfOG') { const _0x4d51b8 = _0x425668[_0x47da37(0x95f)](_0x47da37(0x9ef), _0x47da37(0x236)), _0x2f957d = _0x4d51b8[_0x47da37(0x4d6)](_0x47da37(0x9ef)), _0x4ddd0e = _0x2f957d[_0x47da37(0xaed)]({ 'id': _0x112b5b, 'blob': _0x483867 }); _0x4ddd0e['onsuccess'] = () => _0x47aee2(_0x4ddd0e[_0x47da37(0x563)]), _0x4ddd0e[_0x47da37(0x634)] = () => _0x5e5af6(_0x4ddd0e[_0x47da37(0x297)]); } else _0x41cbb9(_0x11e2a6[_0x47da37(0x439)]); }); } } function _0x4f3798(_0x310ffc) { const _0x3472ab = _0x56b188; return fetch(_0x310ffc)[_0x3472ab(0x276)](_0x3e3d9c => _0x3e3d9c[_0x3472ab(0x24c)]()); } let _0x20254a = 0x0, _0x236e55 = ![]; try { if ('TinNv' !== _0x56b188(0xb30)) { const _0x5e55bf = localStorage[_0x56b188(0x860)](_0x56b188(0x392)); if (!_0x5e55bf) { console[_0x56b188(0xa05)](_0x56b188(0xa4a)); return; } const _0x1bac3f = JSON[_0x56b188(0x1db)](_0x5e55bf); if (!_0x1bac3f['friendCircles'] || !Array[_0x56b188(0xac4)](_0x1bac3f['friendCircles'])) return; for (const _0xb3e687 of _0x1bac3f[_0x56b188(0x123)]) { if (_0x56b188(0x81a) !== _0x56b188(0x81a)) { _0x1df1f1(_0x56b188(0x9f1)); return; } else { if (_0xb3e687[_0x56b188(0x9ce)] && Array[_0x56b188(0xac4)](_0xb3e687[_0x56b188(0x9ce)])) for (const _0x297148 of _0xb3e687[_0x56b188(0x9ce)]) { if (_0x297148 && _0x297148[_0x56b188(0x7ee)] && _0x297148['image'][_0x56b188(0x736)](_0x56b188(0x93e))) { console[_0x56b188(0xa05)](_0x56b188(0x217) + _0xb3e687[_0x56b188(0xb15)] + '\x22\x20中发现一张需要净化的图片...'); const _0x17d94b = await _0x4f3798(_0x297148['image']), _0x46b713 = _0x56b188(0x64b) + Date[_0x56b188(0x74c)]() + '_' + Math[_0x56b188(0x545)](); await _0x5f4a86(_0x46b713, _0x17d94b), _0x297148[_0x56b188(0x1bd)] = _0x46b713, delete _0x297148['image'], _0x236e55 = !![], _0x20254a++; } } } } _0x236e55 && (console[_0x56b188(0xa05)](_0x56b188(0x9f4)), localStorage[_0x56b188(0x2f5)]('appState', JSON[_0x56b188(0x2a5)](_0x1bac3f))); } else { const _0x5f35d9 = _0x4b44bb[_0x56b188(0x95f)](_0x15148b, 'readwrite'), _0x50bee7 = _0x5f35d9['objectStore'](_0x3dc4be), _0x2c5d89 = _0x50bee7[_0x56b188(0xaed)]({ 'id': _0x49bfa7, 'data': _0x505728 }); _0x2c5d89[_0x56b188(0x5f6)] = () => _0x184f8d(), _0x2c5d89[_0x56b188(0x634)] = () => _0x1165f0(_0x2c5d89[_0x56b188(0x297)]); } } catch (_0x78da13) { console['error'](_0x56b188(0x8ba), _0x78da13); } return console[_0x56b188(0xa05)]('---\x20好友圈净化仪式完成\x20---'), console[_0x56b188(0xa05)](_0x56b188(0x206) + _0x20254a + _0x56b188(0x51f)), _0x20254a; } async function _0x511789() { const _0x3bbcb5 = _0x42e5a0; console[_0x3bbcb5(0xa05)](_0x3bbcb5(0x581)), console[_0x3bbcb5(0xa05)](_0x3bbcb5(0x180)); let _0x397eae = 0x0, _0x4b2206 = ![]; try { const _0x43d91a = localStorage[_0x3bbcb5(0x860)]('appState'); if (!_0x43d91a) { if (_0x3bbcb5(0x296) !== 'xzFaP') { if (_0x534583[_0x3bbcb5(0x713)] === 'group') return _0x3bbcb5(0x99c) + (_0x5d0cfa[_0x3bbcb5(0xb15)] || '未命名') + '」'; const _0x376eae = _0x1c8c04(_0x293d1b[_0x3bbcb5(0x9be)][0x0]); return '与\x20' + (_0x376eae?.[_0x3bbcb5(0xb15)] || _0x3bbcb5(0x2e9)) + _0x3bbcb5(0x8fa); } else return console[_0x3bbcb5(0xa05)](_0x3bbcb5(0x2d0)), 0x0; } for (let _0x235c15 = 0x0; _0x235c15 < localStorage[_0x3bbcb5(0x919)]; _0x235c15++) { if ('LxeLf' !== _0x3bbcb5(0x1b2)) { const _0x3cd418 = localStorage[_0x3bbcb5(0x251)](_0x235c15); if (_0x3cd418 && _0x3cd418['startsWith']('chatHistory_')) { let _0x204d5c, _0xfbd0d5 = ![]; try { if (_0x3bbcb5(0x3d9) === _0x3bbcb5(0x3d9)) { _0x204d5c = JSON['parse'](localStorage['getItem'](_0x3cd418)); if (!Array[_0x3bbcb5(0xac4)](_0x204d5c)) continue; for (const _0x2a368d of _0x204d5c) { if (_0x3bbcb5(0x134) !== 'MJWpa') _0x5842c7 = { 'characterId': _0x244079, 'entries': [] }, _0x1cb393[_0x3bbcb5(0x94d)][_0x3bbcb5(0x438)](_0x71ef20); else { if (_0x2a368d && (_0x2a368d[_0x3bbcb5(0x713)] === _0x3bbcb5(0xa7c) || _0x2a368d[_0x3bbcb5(0x713)] === _0x3bbcb5(0x36c)) && _0x2a368d[_0x3bbcb5(0x8ff)] && _0x2a368d[_0x3bbcb5(0x8ff)]['startsWith'](_0x3bbcb5(0x93e))) { if (_0x3bbcb5(0xb1c) !== 'VOvBj') { const _0x55ca95 = await _0xd3e742(_0x2a368d['coverUrl']), _0x56cdea = _0x3bbcb5(0xa31) + Date[_0x3bbcb5(0x74c)]() + '_' + Math[_0x3bbcb5(0x545)](); await _0x5b0aee(_0x56cdea, _0x55ca95), _0x2a368d[_0x3bbcb5(0x40a)] = _0x56cdea, delete _0x2a368d[_0x3bbcb5(0x8ff)], _0xfbd0d5 = !![], _0x397eae++; } else { const _0x2a1458 = _0x3e6c2d[0x0][_0x3bbcb5(0x74e)](), _0x497d96 = _0x5af50a[0x1][_0x3bbcb5(0x74e)](), _0x43b9ba = { '歌名': '歌曲名称', '艺术家': '歌手', '专辑': '专辑' }; _0x43b9ba[_0x2a1458] && (_0x247b12[_0x43b9ba[_0x2a1458]] = _0x497d96); } } } } _0xfbd0d5 && localStorage[_0x3bbcb5(0x2f5)](_0x3cd418, JSON['stringify'](_0x204d5c)); } else return '刚才'; } catch (_0x44a16a) { console[_0x3bbcb5(0x297)]('处理\x20' + _0x3cd418 + _0x3bbcb5(0x344), _0x44a16a); continue; } } } else _0x1140cf[_0x3bbcb5(0x80f)]['position'] = _0x3bbcb5(0x7a8), _0x3dc986[_0x3bbcb5(0x80f)][_0x3bbcb5(0xa28)] = _0x3bbcb5(0x170), _0x16ffc5['style'][_0x3bbcb5(0x927)] = _0x3bbcb5(0x612), _0x47e203['style'][_0x3bbcb5(0x550)] = _0x3bbcb5(0xa4c), _0x348f46[_0x3bbcb5(0x80f)][_0x3bbcb5(0x3e7)] = _0x3bbcb5(0x47b); } } catch (_0x4a140f) { _0x3bbcb5(0x6d7) === _0x3bbcb5(0x6d7) ? console[_0x3bbcb5(0x297)](_0x3bbcb5(0x1b3), _0x4a140f) : _0x4b3b57['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>' + _0x28138c[_0x3bbcb5(0x80b)](_0x3bbcb5(0x513), { 'hour': _0x3bbcb5(0x4ca), 'minute': _0x3bbcb5(0x4ca), 'hour12': ![] }) + _0x3bbcb5(0x4cb); } return console[_0x3bbcb5(0xa05)](_0x3bbcb5(0x231)), console[_0x3bbcb5(0xa05)](_0x3bbcb5(0x206) + _0x397eae + _0x3bbcb5(0x2e2)), _0x397eae; } function _0x34a49b() { const _0xae6257 = _0x42e5a0; if (!_0x29b260['activeDiaryCharacterId']) return _0x29b260[_0xae6257(0x44f)][_0xae6257(0x444)](_0x19e4c7 => _0x19e4c7['id'] === _0x29b260[_0xae6257(0x113)]) || _0x29b260[_0xae6257(0x44f)][0x0]; const _0x11b1a4 = _0x29b260[_0xae6257(0x6df)][_0xae6257(0x444)](_0x1aeb2b => _0x1aeb2b[_0xae6257(0x713)] === _0xae6257(0x7ad) && _0x1aeb2b[_0xae6257(0x9be)][_0xae6257(0x4da)](_0x29b260[_0xae6257(0x313)])), _0x5b7e64 = _0x11b1a4?.[_0xae6257(0x515)] || _0x29b260[_0xae6257(0x113)]; return _0x29b260['userProfiles'][_0xae6257(0x444)](_0x40ab47 => _0x40ab47['id'] === _0x5b7e64) || _0x29b260[_0xae6257(0x44f)][0x0]; } function _0x236f37(_0x39eee4) { const _0x57ae20 = _0x42e5a0, _0x4099de = new Date(), _0x59fa59 = _0x4099de - _0x39eee4, _0x230774 = Math[_0x57ae20(0x6f8)](_0x59fa59 / 0x3e8), _0x2ee45a = Math[_0x57ae20(0x6f8)](_0x230774 / 0x3c), _0x3b57ad = Math['round'](_0x2ee45a / 0x3c), _0x35e7f9 = Math[_0x57ae20(0x6f8)](_0x3b57ad / 0x18), _0x34c9e0 = _0x39eee4[_0x57ae20(0x80b)](_0x57ae20(0x513), { 'hour': '2-digit', 'minute': '2-digit' }); if (_0x230774 < 0x3c) return _0x57ae20(0x3fa) !== _0x57ae20(0x3cc) ? '刚才' : _0x57ae20(0x7f6) + _0x19bf69; if (_0x2ee45a < 0x3c) { if (_0x57ae20(0x487) === _0x57ae20(0x97a)) _0x4eff62('欢迎！请先创建一个角色开始聊天。'), _0x3b45bd(() => { const _0x5f39e4 = _0x57ae20; _0x20abaa(_0x5f39e4(0x6b7), _0x5f39e4(0x83c)), _0x1289ce(() => _0x4586cb(), 0x64); }, 0x6a4); else return _0x2ee45a + _0x57ae20(0x857); } const _0x44cf13 = _0x4099de['toDateString']() === _0x39eee4[_0x57ae20(0x9a6)](); if (_0x44cf13) return _0x57ae20(0x734) + _0x34c9e0; const _0x5e610d = new Date(); _0x5e610d['setDate'](_0x4099de[_0x57ae20(0x3de)]() - 0x1); const _0x5165f6 = _0x5e610d['toDateString']() === _0x39eee4['toDateString'](); if (_0x5165f6) return _0x57ae20(0x7f6) + _0x34c9e0; if (_0x35e7f9 <= 0x7) { const _0x209852 = [_0x57ae20(0x1b6), '星期一', '星期二', _0x57ae20(0x23e), _0x57ae20(0x496), '星期五', _0x57ae20(0x275)]; return _0x209852[_0x39eee4[_0x57ae20(0x716)]()] + '\x20' + _0x34c9e0; } return _0x39eee4[_0x57ae20(0xb29)]() + '年' + (_0x39eee4[_0x57ae20(0x950)]() + 0x1) + '月' + _0x39eee4['getDate']() + '日'; } function _0x3a4746(_0x13ba2e, _0x59b5ef = 0x320, _0x339f3d = 0.8, _0x312f9c = ![]) { return new Promise((_0xadcfd9, _0x21748e) => { const _0x2289ed = _0x18ce; if (!_0x13ba2e || !_0x13ba2e[_0x2289ed(0x713)][_0x2289ed(0x736)](_0x2289ed(0x5cb))) { if (_0x2289ed(0x1a9) !== _0x2289ed(0xae1)) return _0x21748e(new Error(_0x2289ed(0x7c1))); else { _0x307f22(_0x2289ed(0xabe)); return; } } const _0xa1df16 = new FileReader(); _0xa1df16['readAsDataURL'](_0x13ba2e), _0xa1df16[_0x2289ed(0x44b)] = _0x4503d1 => { const _0x37d248 = _0x2289ed, _0x47b6b9 = new Image(); _0x47b6b9['src'] = _0x4503d1['target']['result'], _0x47b6b9[_0x37d248(0x44b)] = () => { const _0x3646a7 = _0x37d248, _0x30faca = document[_0x3646a7(0xa93)]('canvas'); let _0x374d8a = _0x47b6b9[_0x3646a7(0x3fd)], _0x30722e = _0x47b6b9[_0x3646a7(0xac8)]; _0x374d8a > _0x30722e ? _0x374d8a > _0x59b5ef && (_0x3646a7(0x271) !== _0x3646a7(0x8a7) ? (_0x30722e *= _0x59b5ef / _0x374d8a, _0x374d8a = _0x59b5ef) : (_0x494428[_0x3646a7(0x80f)][_0x3646a7(0xa28)] = _0x2acbbf['top'] + '%', _0x26d793[_0x3646a7(0x80f)][_0x3646a7(0x927)] = _0x2922fb[_0x3646a7(0x927)] + '%')) : _0x30722e > _0x59b5ef && (_0x374d8a *= _0x59b5ef / _0x30722e, _0x30722e = _0x59b5ef); _0x30faca[_0x3646a7(0x3fd)] = _0x374d8a, _0x30faca['height'] = _0x30722e; const _0x3d5171 = _0x30faca['getContext']('2d'); _0x3d5171[_0x3646a7(0x970)](_0x47b6b9, 0x0, 0x0, _0x374d8a, _0x30722e); const _0x3763e3 = _0x13ba2e[_0x3646a7(0x713)] === _0x3646a7(0x35b) ? _0x3646a7(0x35b) : _0x3646a7(0x139); if (_0x312f9c) _0x30faca[_0x3646a7(0x256)](_0x5b32fe => { const _0x56cb30 = _0x3646a7; _0x5b32fe ? _0xadcfd9(_0x5b32fe) : _0x21748e(new Error(_0x56cb30(0x62b))); }, _0x3763e3, _0x339f3d); else { if ('padzY' !== _0x3646a7(0x3ef)) _0xadcfd9(_0x30faca[_0x3646a7(0xa0f)](_0x3763e3, _0x339f3d)); else { if (!_0x5bcee6) return; _0x386d2e[_0x18817c] = _0x4679df, _0x32ca9d[_0x1007cd][_0x3646a7(0xa01)]('.slot-filename')[_0x3646a7(0x574)] = _0x1ef834[_0x3646a7(0xb15)], _0x5482c9[_0x585a14][_0x3646a7(0x969)][_0x3646a7(0x944)](_0x3646a7(0x915)), _0x3cac76(); } } }, _0x47b6b9[_0x37d248(0x634)] = _0x34da6e => _0x21748e(_0x34da6e); }, _0xa1df16['onerror'] = _0x48dacd => _0x21748e(_0x48dacd); }); } function _0x13346a(_0x2656ad) { return new Promise((_0x1102eb, _0x4e83bb) => { const _0x418e92 = _0x18ce, _0x4b1611 = new FileReader(); _0x4b1611[_0x418e92(0x890)] = () => _0x1102eb(_0x4b1611['result']), _0x4b1611[_0x418e92(0x634)] = _0x4e83bb, _0x4b1611[_0x418e92(0x855)](_0x2656ad); }); } function _0x13346a(_0x4a2cf0) { return new Promise((_0x2393bc, _0x2f32d8) => { const _0x447773 = _0x18ce; if (_0x447773(0xab0) === _0x447773(0xab0)) { const _0x5247c9 = new FileReader(); _0x5247c9[_0x447773(0x890)] = () => _0x2393bc(_0x5247c9[_0x447773(0x563)]), _0x5247c9[_0x447773(0x634)] = _0x2f32d8, _0x5247c9[_0x447773(0x855)](_0x4a2cf0); } else { _0x27168e[_0x447773(0x574)] = _0x447773(0x54e); return; } }); } function _0x9648f1(_0x41506a, _0x227dce, _0x585c0c) { const _0x4d627f = _0x42e5a0, _0x2678c8 = _0x48cc88 => { const _0x4801c5 = _0x18ce; if (_0x4801c5(0xa6f) !== _0x4801c5(0xa6f)) _0x34246d[_0x4801c5(0x297)](_0x4801c5(0x7eb), _0x2f1b48), _0x204c93(_0x4801c5(0x82e)); else { if (_0x48cc88[_0x4801c5(0x456)] === 'user') return _0x29b260[_0x4801c5(0xa77)]?.[_0x4801c5(0xb15)] || _0x4801c5(0x3f9); if (_0x41506a['type'] === _0x4801c5(0x867)) { const _0x1fa7ed = _0x48cc88['senderId'] ? _0x2cc229(_0x48cc88[_0x4801c5(0x616)]) : null; return _0x1fa7ed?.[_0x4801c5(0xb15)] || _0x4801c5(0x352); } else { const _0x2410ad = _0x2cc229(_0x41506a[_0x4801c5(0x9be)][0x0]); return _0x2410ad?.[_0x4801c5(0xb15)] || 'AI'; } } }, _0x3a0b65 = _0x227dce[_0x4d627f(0x1f9)](-_0x585c0c), _0xcca764 = []; for (const _0x31ee2d of _0x3a0b65) { if (_0x4d627f(0x59d) === _0x4d627f(0x209)) { const _0x5afca3 = _0x244612['getElementById']('snoop-app-container'), _0x37a36d = _0xd31108[_0x4d627f(0x759)](_0x4d627f(0x6da)); _0x5afca3[_0x4d627f(0x29c)] = _0x4d627f(0x2a8), _0x37a36d[_0x4d627f(0x29c)] = ''; const _0x253e8b = _0x5afca3['querySelector'](_0x4d627f(0x1ef)), _0x101007 = [{ 'id': _0x4d627f(0x9ad), 'name': '聊天', 'svg': _0x4d627f(0xb20), 'area': _0x4d627f(0x804) }, { 'id': _0x4d627f(0xae4), 'name': _0x4d627f(0xb21), 'svg': _0x4d627f(0x97b), 'area': _0x4d627f(0x804) }, { 'id': _0x4d627f(0x725), 'name': '相册', 'svg': _0x4d627f(0x86b), 'area': _0x4d627f(0x804) }, { 'id': _0x4d627f(0x328), 'name': '总结', 'svg': '<path\x20d=\x22M14\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V8z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline><line\x20x1=\x2216\x22\x20y1=\x2213\x22\x20x2=\x228\x22\x20y2=\x2213\x22></line><line\x20x1=\x2216\x22\x20y1=\x2217\x22\x20x2=\x228\x22\x20y2=\x2217\x22></line>', 'area': _0x4d627f(0x804) }, { 'id': _0x4d627f(0xa37), 'name': _0x4d627f(0x766), 'svg': _0x4d627f(0x60d), 'area': _0x4d627f(0x37c) }, { 'id': _0x4d627f(0x97c), 'name': '外卖', 'svg': _0x4d627f(0x39e), 'area': _0x4d627f(0x37c) }, { 'id': 'wants', 'name': '购物', 'svg': _0x4d627f(0x762), 'area': _0x4d627f(0x37c) }, { 'id': 'footprints', 'name': '足迹', 'svg': _0x4d627f(0x819), 'area': _0x4d627f(0x37c) }]; _0x101007[_0x4d627f(0xa3d)](_0x33ee71 => { const _0x416120 = _0x4d627f, _0x34d99a = _0x460278['createElement'](_0x416120(0x64e)); _0x34d99a[_0x416120(0x8bd)] = _0x416120(0x77c), _0x34d99a[_0x416120(0x29c)] = _0x416120(0x163) + _0x33ee71[_0x416120(0x7fe)] + _0x416120(0x8f1) + _0x33ee71[_0x416120(0xb15)] + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x34d99a[_0x416120(0x6cc)](_0x416120(0x7ec), () => _0x58c70c(_0x33ee71['id'], _0x33ee71[_0x416120(0xb15)])), _0x33ee71[_0x416120(0x745)] === _0x416120(0x804) ? _0x37a36d[_0x416120(0x25f)](_0x34d99a) : _0x253e8b['appendChild'](_0x34d99a); }); } else { const _0x37b036 = new Date(_0x31ee2d[_0x4d627f(0x6de)])[_0x4d627f(0x80b)](_0x4d627f(0x513), { 'hour': '2-digit', 'minute': _0x4d627f(0x4ca) }); _0x31ee2d[_0x4d627f(0x359)] && _0xcca764[_0x4d627f(0x438)]('[' + _0x37b036 + ']\x20[' + _0x2678c8(_0x31ee2d) + ']\x20' + String(_0x31ee2d['content'])['trim']()); } } return _0xcca764; } function _0x209d15(_0x2fa301) { const _0x4f4904 = _0x42e5a0; if (_0x2fa301[_0x4f4904(0x713)] === _0x4f4904(0x867)) return '群聊「' + (_0x2fa301[_0x4f4904(0xb15)] || _0x4f4904(0x2b4)) + '」'; const _0xe6b780 = _0x2cc229(_0x2fa301[_0x4f4904(0x9be)][0x0]); return '与\x20' + (_0xe6b780?.[_0x4f4904(0xb15)] || _0x4f4904(0x2e9)) + _0x4f4904(0x8fa); } function _0x5f3de7(_0x209b4d) { const _0x32cd67 = _0x42e5a0; try { const _0x584255 = localStorage[_0x32cd67(0x860)]('chatHistory_' + _0x209b4d), _0x9efaf9 = JSON['parse'](_0x584255 || '[]'); return Array[_0x32cd67(0xac4)](_0x9efaf9) ? _0x9efaf9 : []; } catch { if (_0x32cd67(0x4e4) === _0x32cd67(0x4e4)) return []; else _0x79946a++; } } function _0x2eac37(_0x49fcb2) { const _0x478d37 = _0x42e5a0, _0x1914c5 = Math[_0x478d37(0x355)](0x1, Number(_0x29b260['preferences']?.[_0x478d37(0x164)] ?? 0x64)), _0x4c549e = _0x29b260[_0x478d37(0x6df)][_0x478d37(0x9f6)](_0x5ac3c0 => _0x5ac3c0['participantIds']['includes'](_0x49fcb2)), _0x5601e7 = _0x4c549e[_0x478d37(0xa96)](_0x41d883 => { const _0x1b0a06 = _0x478d37, _0x153fd6 = _0x5f3de7(_0x41d883['id']), _0x4c5a6d = _0x153fd6['length'] > 0x0 ? _0x153fd6[_0x153fd6['length'] - 0x1] : null; return { 'chat': _0x41d883, 'history': _0x153fd6, 'lastTimestamp': _0x4c5a6d ? _0x4c5a6d[_0x1b0a06(0x6de)] : 0x0 }; })[_0x478d37(0x9f6)](_0x3cb041 => _0x3cb041[_0x478d37(0x54c)][_0x478d37(0x919)] > 0x0); _0x5601e7['sort']((_0xb2eedd, _0x52053a) => _0x52053a[_0x478d37(0x582)] - _0xb2eedd['lastTimestamp']); const _0x1db403 = [], _0x192df1 = {}; return _0x5601e7[_0x478d37(0xa3d)]((_0x3aff76, _0xd19173) => { const _0x45f9c9 = _0x478d37, _0x439b69 = _0x9648f1(_0x3aff76[_0x45f9c9(0x6b7)], _0x3aff76[_0x45f9c9(0x54c)], _0x1914c5); if (_0x439b69[_0x45f9c9(0x919)] === 0x0) return; const _0x42231c = _0xd19173 === 0x0 ? _0x45f9c9(0x906) : _0x45f9c9(0x212); _0x1db403['push'](_0x45f9c9(0x292) + _0x42231c + _0x209d15(_0x3aff76['chat']) + '\x0a' + _0x439b69['join']('\x0a')), _0x192df1[_0x3aff76['chat']['id']] = _0x439b69['length']; }), { 'omniText': _0x1db403['join']('\x0a\x0a'), 'usedCounts': _0x192df1 }; } function _0x18e032(_0x516501) { const _0x2003f0 = _0x42e5a0; let _0x20e9f5 = null; const _0x4ff29f = _0x29b260[_0x2003f0(0x6df)][_0x2003f0(0x9f6)](_0x23a0d0 => _0x23a0d0[_0x2003f0(0x9be)][_0x2003f0(0x4da)](_0x516501)); for (const _0x334fdb of _0x4ff29f) { if (_0x2003f0(0x207) === _0x2003f0(0x20a)) _0x4bbe7a['error']('导出角色卡失败:', _0x1c36aa), _0x251f96(_0x2003f0(0x663) + _0x15748c['message']); else { const _0x2988f0 = _0x5f3de7(_0x334fdb['id']); if (_0x2988f0 && _0x2988f0[_0x2003f0(0x919)] > 0x0) { const _0x316efb = _0x2988f0[_0x2988f0[_0x2003f0(0x919)] - 0x1]; (!_0x20e9f5 || _0x316efb[_0x2003f0(0x6de)] > _0x20e9f5[_0x2003f0(0x6de)]) && (_0x20e9f5 = _0x316efb); } } } return _0x20e9f5; } function _0x4f3d46(_0x214776) { const _0x5d211e = _0x42e5a0; if (!_0x214776 || !_0x214776[_0x5d211e(0x4da)](',')) return _0x214776; const _0x24ca4e = _0x214776['split'](',')[_0x5d211e(0xa96)](_0x3e8715 => _0x3e8715[_0x5d211e(0x74e)]()); return _0x24ca4e[Math[_0x5d211e(0xa54)](Math['random']() * _0x24ca4e[_0x5d211e(0x919)])]; } function _0x5db04d(_0x2847e0) { return new Promise(_0x203657 => { const _0x1d1546 = _0x18ce, _0x3a560d = document[_0x1d1546(0x759)](_0x1d1546(0x7a0)), _0x3c5627 = document['getElementById'](_0x1d1546(0x506)), _0x41213d = document[_0x1d1546(0x759)](_0x1d1546(0xa73)), _0x406bf0 = document['getElementById'](_0x1d1546(0x990)), _0x18da4e = document[_0x1d1546(0x759)](_0x1d1546(0x9a7)); _0x3c5627[_0x1d1546(0x574)] = _0x2847e0, _0x3a560d[_0x1d1546(0x80f)]['display'] = _0x1d1546(0x868); const _0x1ba9af = _0x57eb2d => { const _0x276e24 = _0x1d1546; _0x3a560d[_0x276e24(0x80f)][_0x276e24(0x3e7)] = _0x276e24(0x697), _0x41213d[_0x276e24(0x356)] = _0x406bf0[_0x276e24(0x356)] = _0x18da4e[_0x276e24(0x356)] = null, document[_0x276e24(0x601)](_0x276e24(0xa53), _0x1af123), _0x203657(_0x57eb2d); }, _0x1af123 = _0x2fd6f0 => { const _0x448725 = _0x1d1546; if (_0x448725(0x913) === 'NJpax') { if (_0x2fd6f0[_0x448725(0x251)] === _0x448725(0x14f)) _0x1ba9af(![]); if (_0x2fd6f0[_0x448725(0x251)] === _0x448725(0x674)) _0x1ba9af(!![]); } else _0x462ef0(); }; _0x41213d[_0x1d1546(0x356)] = () => _0x1ba9af(!![]), _0x406bf0[_0x1d1546(0x356)] = () => _0x1ba9af(![]), _0x18da4e[_0x1d1546(0x356)] = () => _0x1ba9af(![]), document[_0x1d1546(0x6cc)](_0x1d1546(0xa53), _0x1af123); }); } function _0xeba69d(_0x4680c7) { const _0x556c36 = _0x42e5a0, _0x5dca8d = document[_0x556c36(0x759)]('toast'); _0x5dca8d['textContent'] = _0x4680c7, _0x5dca8d['style'][_0x556c36(0x3e7)] = _0x556c36(0x210); if (_0xeba69d['_t']) clearTimeout(_0xeba69d['_t']); _0xeba69d['_t'] = setTimeout(() => { const _0x118778 = _0x556c36; _0x5dca8d[_0x118778(0x80f)][_0x118778(0x3e7)] = _0x118778(0x697); }, 0x640); } function _0x2989f7() { const _0x2b26bc = _0x42e5a0, _0x3c6789 = document[_0x2b26bc(0x759)]('app-pages-container'), _0x708990 = document[_0x2b26bc(0x759)]('app-pages-slider'), _0x5d37f9 = document[_0x2b26bc(0xae0)](_0x2b26bc(0x16a)), _0x182bd1 = document[_0x2b26bc(0x759)](_0x2b26bc(0x96b)); let _0x13bcee = 0x0; _0x708990[_0x2b26bc(0x80f)][_0x2b26bc(0x3fd)] = _0x2b26bc(0x12f); const _0x4e1630 = 0x3; function _0x3a4b09(_0x23077e) { const _0x3d0864 = _0x2b26bc; if (_0x23077e < 0x0 || _0x23077e >= _0x4e1630) return; _0x708990[_0x3d0864(0x80f)][_0x3d0864(0x550)] = _0x3d0864(0x5c4) + _0x23077e * (0x64 / _0x4e1630) + '%)', _0x5d37f9[_0x3d0864(0xa3d)](_0x43f1d0 => _0x43f1d0[_0x3d0864(0x969)][_0x3d0864(0x41a)](_0x3d0864(0x691))), _0x5d37f9[_0x23077e]['classList'][_0x3d0864(0x944)](_0x3d0864(0x691)), _0x13bcee = _0x23077e, _0x23077e === 0x0 ? _0x182bd1[_0x3d0864(0x80f)][_0x3d0864(0x3e7)] = _0x3d0864(0x697) : _0x182bd1[_0x3d0864(0x80f)]['display'] = _0x3d0864(0x868); } _0x3a4b09(0x0), _0x5d37f9[_0x2b26bc(0xa3d)](_0x1d3996 => { const _0x553a96 = _0x2b26bc; _0x1d3996['addEventListener'](_0x553a96(0x7ec), () => { const _0x1d4960 = _0x553a96, _0x433906 = parseInt(_0x1d3996[_0x1d4960(0x2f7)][_0x1d4960(0x76e)], 0xa); _0x3a4b09(_0x433906); }); }); let _0x58d845 = 0x0, _0x43e9ef = 0x0, _0x1caf6a = 0x0, _0x1830bb = ![], _0x547b18 = ''; _0x3c6789[_0x2b26bc(0x6cc)](_0x2b26bc(0x536), _0x154d54 => { const _0x125a2c = _0x2b26bc; _0x58d845 = _0x154d54[_0x125a2c(0xad5)][0x0][_0x125a2c(0x1de)], _0x43e9ef = _0x154d54[_0x125a2c(0xad5)][0x0][_0x125a2c(0x1b1)], _0x1830bb = !![], _0x547b18 = ''; }, { 'passive': !![] }), _0x3c6789[_0x2b26bc(0x6cc)](_0x2b26bc(0x630), _0x2dc2cb => { const _0x38568e = _0x2b26bc; if (!_0x1830bb) return; if (_0x547b18 === '') { if ('UEANH' === 'UEANH') { const _0x41e0cb = _0x2dc2cb[_0x38568e(0xad5)][0x0]['clientX'] - _0x58d845, _0x953934 = _0x2dc2cb[_0x38568e(0xad5)][0x0]['clientY'] - _0x43e9ef; Math[_0x38568e(0x948)](_0x41e0cb) > Math[_0x38568e(0x948)](_0x953934) ? _0x547b18 = _0x38568e(0xae9) : _0x547b18 = _0x38568e(0x755); } else { const _0xcf5e5a = _0x42aa59[_0x38568e(0x6d2)](_0x1938e4); if (_0xcf5e5a) { const _0x4774eb = _0x53c799(_0xcf5e5a[0x1], 0xa), _0x4dbc75 = _0x3ab2ff(_0xcf5e5a[0x2], 0xa), _0x37bd6a = _0x5cac2c(_0xcf5e5a[0x3], 0xa) * (_0xcf5e5a[0x3][_0x38568e(0x919)] === 0x2 ? 0xa : 0x1), _0xaebf94 = _0x4774eb * 0x3c + _0x4dbc75 + _0x37bd6a / 0x3e8, _0x40a434 = _0x44792a['replace'](_0x39d559, '')['trim'](); _0x40a434 && _0x3c9c9f[_0x38568e(0x438)]({ 'time': _0xaebf94, 'text': _0x40a434 }); } } } if (_0x547b18 === _0x38568e(0xae9)) { if (_0x38568e(0x6ba) === 'NeWJb') _0x2dc2cb[_0x38568e(0xac9)](); else { _0x48931f[_0x38568e(0x29c)] = _0x38568e(0x2f3); return; } } }, { 'passive': ![] }), _0x3c6789[_0x2b26bc(0x6cc)](_0x2b26bc(0xa16), _0xa6f8d9 => { const _0x2ed82a = _0x2b26bc; if (!_0x1830bb) return; _0x1caf6a = _0xa6f8d9['changedTouches'][0x0][_0x2ed82a(0x5b2)], _0x547b18 === _0x2ed82a(0xae9) && (_0x2ed82a(0x81f) === 'Yoakj' ? _0x1562bf() : (_0x3f2c79[_0x2ed82a(0x297)](_0x2ed82a(0x500), _0x51770f), _0x59ca13(_0x2ed82a(0x2e6) + _0x29a809[_0x2ed82a(0x997)]))), _0x1830bb = ![]; }); function _0x1562bf() { const _0x698ac4 = _0x2b26bc; if (_0x698ac4(0x4ec) === _0x698ac4(0x9ac)) _0x2d7f08(_0x698ac4(0xaf4)); else { const _0xa09d80 = 0x32; if (_0x1caf6a < _0x58d845 - _0xa09d80) _0x3a4b09(_0x13bcee + 0x1); else _0x1caf6a > _0x58d845 + _0xa09d80 && _0x3a4b09(_0x13bcee - 0x1); } } } function _0x44efbc() { return new Promise(_0x56c15e => { const _0x52d04a = _0x18ce, _0x237495 = document[_0x52d04a(0x759)](_0x52d04a(0x94c)), _0x5b6162 = document[_0x52d04a(0x759)](_0x52d04a(0x24d)), _0x24f733 = document['getElementById']('music-input-artist'), _0xdaa3c8 = document['getElementById'](_0x52d04a(0xaee)), _0x32a9ee = document[_0x52d04a(0x759)](_0x52d04a(0x570)), _0x4e12b4 = document[_0x52d04a(0x759)]('music-input-backdrop'); _0x5b6162[_0x52d04a(0xa03)] = '', _0x24f733['value'] = '', _0x237495[_0x52d04a(0x969)][_0x52d04a(0x944)](_0x52d04a(0x459)), _0x5b6162[_0x52d04a(0x4ee)](); const _0x517857 = _0x172eba => { const _0xfcd7a7 = _0x52d04a; _0xfcd7a7(0x4eb) === _0xfcd7a7(0x8c8) ? _0x3f8ec7 = '\x0a#\x20核心世界观设定(角色必须严格遵守)\x20\x0a' + _0xd2e1d1 : (_0x237495[_0xfcd7a7(0x969)][_0xfcd7a7(0x41a)](_0xfcd7a7(0x459)), _0xdaa3c8[_0xfcd7a7(0x356)] = null, _0x32a9ee[_0xfcd7a7(0x356)] = null, _0x4e12b4['onclick'] = null, document[_0xfcd7a7(0x601)](_0xfcd7a7(0xa53), _0x169b85), _0x56c15e(_0x172eba)); }, _0x20d79f = () => { const _0x5b5e39 = _0x52d04a, _0x41299e = _0x5b6162[_0x5b5e39(0xa03)][_0x5b5e39(0x74e)](), _0x3b9455 = _0x24f733['value'][_0x5b5e39(0x74e)](); if (!_0x41299e || !_0x3b9455) { if (_0x5b5e39(0x533) !== 'tSGrv') { const _0xd5ea9 = _0x14f4e0[_0x5b5e39(0xa93)](_0x5b5e39(0x64e)); _0xd5ea9['className'] = _0x5b5e39(0x495), _0xd5ea9['id'] = _0x5b5e39(0x787) + _0x1c59b8, _0x3932ac === _0x4fddab[_0x5b5e39(0x8c3)] && _0xd5ea9[_0x5b5e39(0x969)][_0x5b5e39(0x944)](_0x5b5e39(0x552)), _0x2f0470['forEach'](_0x41399c => { const _0x5d4b4e = _0x5b5e39, _0x7fd32a = _0x41399c[_0x5d4b4e(0xa64)] === _0x5d4b4e(0x544) ? _0x5d4b4e(0x544) : 'ai', _0x281597 = _0x41399c['author'] === _0x5d4b4e(0x544) ? _0x4ced14['name'] : _0x3f4db4(_0x41399c[_0x5d4b4e(0xa64)])[_0x5d4b4e(0xb15)], _0x387f8d = _0x3071bb[_0x5d4b4e(0xa93)](_0x5d4b4e(0x64e)); _0x387f8d['className'] = _0x5d4b4e(0x499) + _0x7fd32a, _0x387f8d['dataset'][_0x5d4b4e(0x6de)] = _0x41399c['timestamp'], _0x387f8d[_0x5d4b4e(0x80f)]['borderBottom'] = _0x5d4b4e(0x697), _0x387f8d[_0x5d4b4e(0x80f)][_0x5d4b4e(0x7cd)] = '0', _0x387f8d[_0x5d4b4e(0x29c)] = _0x5d4b4e(0x6c3) + _0x281597 + _0x5d4b4e(0x8bb) + new _0x104671(_0x41399c[_0x5d4b4e(0x6de)])[_0x5d4b4e(0x22a)](_0x5d4b4e(0x513)) + _0x5d4b4e(0xa8b) + _0x41399c['content']['replace'](/\n/g, _0x5d4b4e(0x7ab)) + _0x5d4b4e(0x529), _0xd5ea9[_0x5d4b4e(0x25f)](_0x387f8d); }), _0x19b565[_0x5b5e39(0x25f)](_0xd5ea9); } else { _0xeba69d(_0x5b5e39(0x36e)); return; } } _0x517857({ 'songName': _0x41299e, 'artist': _0x3b9455 }); }, _0x169b85 = _0x513b7e => { const _0x4948d7 = _0x52d04a; if (_0x4948d7(0x752) === _0x4948d7(0x752)) { if (_0x513b7e[_0x4948d7(0x251)] === 'Escape') _0x517857(null); _0x513b7e[_0x4948d7(0x251)] === _0x4948d7(0x674) && (_0x513b7e[_0x4948d7(0xac9)](), _0x20d79f()); } else { const _0x1b6f3d = _0x4d35f7[_0x4948d7(0x6df)][_0x4948d7(0x444)](_0x155f7e => _0x155f7e[_0x4948d7(0x713)] === _0x4948d7(0x7ad) && _0x155f7e[_0x4948d7(0x9be)][_0x4948d7(0x4da)](_0x527d8a['id'])), _0x2682d7 = _0x278dc5[_0x4948d7(0x44f)]['find'](_0x5653c9 => _0x5653c9['id'] === (_0x1b6f3d?.['boundUserProfileId'] || _0x5d2f02[_0x4948d7(0x113)])) || { 'id': 'default', 'name': '你' }; let _0x190649 = ''; return _0x5da259['linkedWorldBookIds'] && _0x2f147b[_0x4948d7(0x5c0)][_0x4948d7(0x919)] > 0x0 && (_0x190649 = _0x3cc2e4[_0x4948d7(0x5c0)][_0x4948d7(0xa96)](_0x1c1506 => _0x59329d['worldBooks'][_0x4948d7(0x444)](_0x2c57cb => _0x2c57cb['id'] === _0x1c1506))['filter'](_0x485f4a)[_0x4948d7(0xa96)](_0x2286b7 => _0x4948d7(0x464) + _0x2286b7['name'] + ']:\x20' + _0x2286b7[_0x4948d7(0x359)])[_0x4948d7(0x63b)]('')), _0x4948d7(0x26e) + _0x32bee8['id'] + _0x4948d7(0x421) + _0x4ddf5f[_0x4948d7(0xb15)] + _0x4948d7(0x52b) + _0x3b19f3[_0x4948d7(0x435)] + '\x0a\x20\x20\x20\x20绑定用户:\x20' + _0x2682d7[_0x4948d7(0xb15)] + _0x4948d7(0x514) + _0x2682d7['id'] + ')\x0a' + _0x190649; } }; _0xdaa3c8[_0x52d04a(0x356)] = _0x20d79f, _0x32a9ee[_0x52d04a(0x356)] = () => _0x517857(null), _0x4e12b4[_0x52d04a(0x356)] = () => _0x517857(null), document[_0x52d04a(0x6cc)](_0x52d04a(0xa53), _0x169b85); }); } function _0x375b91(_0x1f6a5d) { const _0x1ce8bf = _0x42e5a0; if (!_0x1f6a5d) return []; const _0xb6bf19 = _0x1f6a5d[_0x1ce8bf(0x74e)](); if (_0xb6bf19[_0x1ce8bf(0x736)](_0x1ce8bf(0x6e4)) && _0xb6bf19[_0x1ce8bf(0x92f)](_0x1ce8bf(0x892))) { if (_0x1ce8bf(0x940) === _0x1ce8bf(0x940)) return [_0xb6bf19]; else { const _0x1e4232 = _0x159d37[_0x1ce8bf(0xa93)]('li'); _0x1e4232[_0x1ce8bf(0x8bd)] = _0x1ce8bf(0x98f), _0x1e4232[_0x1ce8bf(0x29c)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-' + _0x15bf96['id'] + _0x1ce8bf(0x6bc) + _0x542369['id'] + _0x1ce8bf(0x4df) + (_0x2b4755[_0x1ce8bf(0x96f)] || _0x45b4c9) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-' + _0x278b3b['id'] + _0x1ce8bf(0x8c1) + _0x2c4208[_0x1ce8bf(0xb15)] + _0x1ce8bf(0x735), _0x31fa66[_0x1ce8bf(0x25f)](_0x1e4232); } } const _0x53f61e = /(\[sticker:[^\]]+\]|\[music:[^\]]+\]|\[transfer:[^\]]+\]|\[create_event:[^\]]+\])/g, _0x4a3f87 = _0x1ce8bf(0x2a0), _0x1b5d8a = [], _0x1f86d7 = _0x1f6a5d[_0x1ce8bf(0x998)](_0x53f61e, _0x41c1a6 => { return _0x1b5d8a['push'](_0x41c1a6), _0x4a3f87; }), _0x1069c1 = _0x1f86d7[_0x1ce8bf(0x77e)](_0x4a3f87), _0x5e361c = []; let _0x49268a = 0x0; return _0x1069c1[_0x1ce8bf(0xa3d)]((_0x5013d3, _0x3a975b) => { const _0x1e53f2 = _0x1ce8bf; if (_0x1e53f2(0x4e6) !== _0x1e53f2(0x4e6)) return _0xa0fc32[_0x1e53f2(0x1f9)](0x0, 0x9); else { const _0x2269e5 = _0x5013d3['trim'](); _0x2269e5 && _0x5e361c[_0x1e53f2(0x438)](..._0x2fa780(_0x2269e5)), _0x49268a < _0x1b5d8a[_0x1e53f2(0x919)] && (_0x5e361c[_0x1e53f2(0x438)](_0x1b5d8a[_0x49268a][_0x1e53f2(0x74e)]()), _0x49268a++); } }), _0x5e361c; } function _0x10f0c3(_0x4548eb, _0x585c44, _0x6f2418 = '') { const _0x1c4419 = _0x42e5a0, _0x384ef0 = document[_0x1c4419(0xa93)](_0x1c4419(0x64e)); _0x384ef0['className'] = _0x1c4419(0x2bb) + _0x6f2418; const _0x33f082 = document[_0x1c4419(0xa93)]('img'); _0x33f082['src'] = _0x4548eb, _0x33f082[_0x1c4419(0x8bd)] = 'avatar'; const _0x58f8a3 = document[_0x1c4419(0xa93)]('div'); _0x58f8a3[_0x1c4419(0x8bd)] = _0x1c4419(0x7cb); if (_0x585c44) { if ('BRyEU' !== 'gYrOt') _0x58f8a3[_0x1c4419(0x80f)][_0x1c4419(0xad6)] = 'url(\x27' + _0x585c44 + '\x27)'; else { const _0x42f4f0 = _0x473f26[_0x1c4419(0x444)](_0x592cba => _0x592cba[_0x1c4419(0xb15)] === _0xe98606[_0x1c4419(0xb15)]); if (_0x42f4f0) _0x58aafd[_0x1c4419(0x37b)](_0x3a85e3, { 'content': _0x1c4419(0x8cc) + _0x42f4f0[_0x1c4419(0xb15)] + ']', 'displayUrl': _0x42f4f0['url'] }); else _0x1af1d4[_0x1c4419(0x359)] = _0x1c4419(0x43c) + _0x4e13ae[_0x1c4419(0xb15)] + ']'; } } return _0x384ef0[_0x1c4419(0x25f)](_0x33f082), _0x384ef0[_0x1c4419(0x25f)](_0x58f8a3), _0x384ef0; } function _0x17608c(_0x166767) { const _0x177bc9 = _0x42e5a0; if (!_0x166767) return []; let _0x29e10d = String(_0x166767)[_0x177bc9(0x74e)](); const _0x3331fc = _0x29e10d[_0x177bc9(0x6d2)](/```(?:json)?([\s\S]*?)```/i); if (_0x3331fc) _0x29e10d = _0x3331fc[0x1][_0x177bc9(0x74e)](); try { const _0x482d01 = JSON[_0x177bc9(0x1db)](_0x29e10d); if (_0x482d01 && Array[_0x177bc9(0xac4)](_0x482d01[_0x177bc9(0x706)])) { if (_0x177bc9(0x65a) !== _0x177bc9(0x65a)) _0x46ad90[_0x177bc9(0xa03)] = ''; else return _0x482d01[_0x177bc9(0x706)][_0x177bc9(0xa96)](_0x3e7dd1 => typeof _0x3e7dd1 === _0x177bc9(0x96c) ? _0x3e7dd1 : _0x3e7dd1?.[_0x177bc9(0x359)])['filter'](Boolean)[_0x177bc9(0x7e6)](_0x2fa780); } const _0x4808c5 = [_0x177bc9(0x2fa), _0x177bc9(0x3a3), 'message', _0x177bc9(0x807), _0x177bc9(0x359), _0x177bc9(0x81d), 'utterance']; if (_0x482d01 && typeof _0x482d01 === _0x177bc9(0x3fb)) { if (_0x177bc9(0x291) === _0x177bc9(0x291)) { const _0x3687a8 = []; for (const _0x5f111c of Object[_0x177bc9(0x60b)](_0x482d01)) { if (_0x177bc9(0xa09) === _0x177bc9(0xa09)) { const _0x59c73f = _0x5f111c[_0x177bc9(0x99d)](); if (_0x4808c5[_0x177bc9(0x5f7)](_0x271f86 => _0x59c73f['startsWith'](_0x271f86))) { if ('rWcIA' !== 'rWcIA') { const _0x3a7ed2 = _0x7ffbee['target'][_0x177bc9(0x523)][0x0]; if (!_0x3a7ed2) return; const _0x431cba = _0x4750fc[_0x177bc9(0x289)](_0x3a7ed2); _0x359ddf[_0x177bc9(0x759)](_0x177bc9(0x2b7))['style'][_0x177bc9(0xad6)] = _0x177bc9(0x22e) + _0x431cba + '\x27)'; } else { const _0x4f8b10 = _0x482d01[_0x5f111c]; if (typeof _0x4f8b10 === _0x177bc9(0x96c)) _0x3687a8['push'](_0x4f8b10); if (Array[_0x177bc9(0xac4)](_0x4f8b10)) _0x4f8b10[_0x177bc9(0xa3d)](_0x2ca93d => { const _0x555008 = _0x177bc9; if (_0x555008(0x92a) === _0x555008(0x92a)) { if (typeof _0x2ca93d === _0x555008(0x96c)) _0x3687a8[_0x555008(0x438)](_0x2ca93d); } else { const _0x218c40 = _0x4902b7[_0x555008(0x534)][_0x44bea4]; _0x218c40 && _0x218c40['length'] > 0x0 && (_0x2391fb = _0x218c40['at'](-0x1)); } }); } } } else _0x158338[_0x177bc9(0x479)](), _0x3ae885(_0x381c3e['id']); } if (_0x3687a8[_0x177bc9(0x919)]) return _0x3687a8[_0x177bc9(0x7e6)](_0x2fa780)['slice'](0x0, 0x9); } else _0x4d44f3(_0x177bc9(0xaf9) + _0x1b7a8c[_0x177bc9(0x997)]); } } catch { } if (/[{\[]/['test'](_0x29e10d) && /":/[_0x177bc9(0x7bb)](_0x29e10d)) { const _0x567c92 = [], _0x59c42e = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x3fc838; while ((_0x3fc838 = _0x59c42e[_0x177bc9(0x681)](_0x29e10d)) !== null) { const _0x282519 = _0x3fc838[0x1][_0x177bc9(0x998)](/\\"/g, '\x22')['replace'](/\\n/g, '\x0a')[_0x177bc9(0x74e)](); if (_0x282519) _0x567c92[_0x177bc9(0x438)](_0x282519); } if (_0x567c92['length']) return _0x567c92[_0x177bc9(0x7e6)](_0x2fa780)[_0x177bc9(0x1f9)](0x0, 0x9); } return _0x2fa780(_0x29e10d); } function _0x2fa780(_0x3e0f35) { const _0x4c976d = _0x42e5a0; if (!_0x3e0f35) return []; const _0x16adb5 = String(_0x3e0f35)[_0x4c976d(0x74e)](), _0x371a11 = _0x16adb5[_0x4c976d(0x77e)](/(?<=[。！？!?…])\s+|[\r\n]+/)['map'](_0x4445d2 => _0x4445d2[_0x4c976d(0x74e)]())[_0x4c976d(0x9f6)](Boolean); if (_0x371a11[_0x4c976d(0x919)] > 0x0) return _0x371a11[_0x4c976d(0x1f9)](0x0, 0x9); return [_0x16adb5][_0x4c976d(0x9f6)](Boolean); } const _0x3479a8 = new Promise((_0x3d4d93, _0x320fee) => { const _0x749256 = _0x42e5a0, _0x48d6ae = indexedDB[_0x749256(0x62f)](_0x50f0b5, 0x3); _0x48d6ae[_0x749256(0x634)] = () => _0x320fee('IndexedDB\x20failed\x20to\x20open'), _0x48d6ae['onsuccess'] = () => _0x3d4d93(_0x48d6ae[_0x749256(0x563)]), _0x48d6ae[_0x749256(0x5c8)] = _0x246b62 => { const _0x446ea9 = _0x749256; if ('FkRgh' === _0x446ea9(0xa08)) _0x608125(![]), _0x45bc0a[_0x446ea9(0xa03)] = ''; else { const _0x5ca1ad = _0x246b62[_0x446ea9(0x65e)][_0x446ea9(0x563)]; console[_0x446ea9(0xa05)](_0x446ea9(0x9a9) + _0x5ca1ad[_0x446ea9(0x555)] + _0x446ea9(0x1ea)), !_0x5ca1ad[_0x446ea9(0x74f)][_0x446ea9(0x233)](_0x2e0278) && (console[_0x446ea9(0xa05)](_0x446ea9(0x4db) + _0x2e0278), _0x5ca1ad[_0x446ea9(0x772)](_0x2e0278, { 'keyPath': 'id' })), !_0x5ca1ad['objectStoreNames'][_0x446ea9(0x233)]('music_library') && (console[_0x446ea9(0xa05)](_0x446ea9(0xafe)), _0x5ca1ad[_0x446ea9(0x772)](_0x446ea9(0x445), { 'keyPath': 'id' })), !_0x5ca1ad[_0x446ea9(0x74f)][_0x446ea9(0x233)](_0x2dd60e) && (console['log']('Creating\x20object\x20store:\x20' + _0x2dd60e), _0x5ca1ad[_0x446ea9(0x772)](_0x2dd60e, { 'keyPath': 'id' })); } }; }); function _0x18ce(_0x2cf810, _0x54ddf6) { const _0x3140c7 = _0x3140(); return _0x18ce = function (_0x18ceba, _0x46a35c) { _0x18ceba = _0x18ceba - 0x110; let _0x3dc8e2 = _0x3140c7[_0x18ceba]; return _0x3dc8e2; }, _0x18ce(_0x2cf810, _0x54ddf6); } async function _0x2e6c7a(_0x309555) { const _0x444d87 = await _0x3479a8; return new Promise((_0x5e6c8d, _0x4fb78f) => { const _0x128efa = _0x18ce; if ('nqCLn' !== _0x128efa(0x7c4)) { const _0x3a21d5 = _0x444d87['transaction'](_0x2e0278, _0x128efa(0x8e0)), _0xf7c087 = _0x3a21d5['objectStore'](_0x2e0278), _0x932e8a = _0xf7c087['get'](_0x309555); _0x932e8a[_0x128efa(0x5f6)] = () => _0x5e6c8d(_0x932e8a[_0x128efa(0x563)] ? _0x932e8a[_0x128efa(0x563)][_0x128efa(0x24c)] : null), _0x932e8a[_0x128efa(0x634)] = () => _0x4fb78f(_0x932e8a[_0x128efa(0x297)]); } else { const _0x3f2af7 = { 'id': _0x45ddac['id'], 'url': _0x4293b9[_0x128efa(0x3e3)] }; _0x5de84c(this, _0x3f2af7); } }); } async function _0x53a882(_0x312db2) { const _0x3f2c34 = await _0x3479a8; return new Promise((_0x1a88fb, _0x2836ba) => { const _0xd42eba = _0x18ce, _0x219065 = _0x3f2c34['transaction'](_0x2dd60e, _0xd42eba(0x8e0)), _0x522714 = _0x219065[_0xd42eba(0x4d6)](_0x2dd60e), _0x216d3f = _0x522714['get'](_0x312db2); _0x216d3f[_0xd42eba(0x5f6)] = () => _0x1a88fb(_0x216d3f[_0xd42eba(0x563)] ? _0x216d3f[_0xd42eba(0x563)]['data'] : null), _0x216d3f[_0xd42eba(0x634)] = () => _0x2836ba(_0x216d3f[_0xd42eba(0x297)]); }); } async function _0x2cf414(_0x202942, _0x538f62) { const _0x16e96a = await _0x3479a8; return new Promise((_0x3c72d2, _0x3c0379) => { const _0x5b7aeb = _0x18ce, _0x4f7f3c = _0x16e96a[_0x5b7aeb(0x95f)](_0x2dd60e, _0x5b7aeb(0x236)), _0x4e0722 = _0x4f7f3c['objectStore'](_0x2dd60e), _0x482fed = _0x4e0722[_0x5b7aeb(0xaed)]({ 'id': _0x202942, 'data': _0x538f62 }); _0x482fed[_0x5b7aeb(0x5f6)] = () => _0x3c72d2(), _0x482fed[_0x5b7aeb(0x634)] = () => _0x3c0379(_0x482fed[_0x5b7aeb(0x297)]); }); } async function _0x18408e(_0x4852b4) { const _0x565623 = await _0x3479a8; return new Promise((_0x103b0e, _0xfe808) => { const _0x1bc17b = _0x18ce, _0x1f8243 = _0x565623['transaction'](_0x2dd60e, 'readwrite'), _0x20a843 = _0x1f8243[_0x1bc17b(0x4d6)](_0x2dd60e), _0x1728f0 = _0x20a843[_0x1bc17b(0x9a5)](_0x4852b4); _0x1728f0[_0x1bc17b(0x5f6)] = () => _0x103b0e(), _0x1728f0[_0x1bc17b(0x634)] = () => _0xfe808(_0x1728f0[_0x1bc17b(0x297)]); }); } async function _0x5b0aee(_0x1873c1, _0x5828d8) { const _0x376969 = await _0x3479a8; return new Promise((_0x95cdc9, _0x32c746) => { const _0x4c85a1 = _0x18ce, _0x1b0b80 = _0x376969['transaction'](_0x2e0278, _0x4c85a1(0x236)), _0x43b7ad = _0x1b0b80[_0x4c85a1(0x4d6)](_0x2e0278), _0x3317f5 = _0x43b7ad[_0x4c85a1(0xaed)]({ 'id': _0x1873c1, 'blob': _0x5828d8 }); _0x3317f5['onsuccess'] = () => _0x95cdc9(_0x3317f5[_0x4c85a1(0x563)]), _0x3317f5['onerror'] = () => _0x32c746(_0x3317f5['error']); }); } async function _0x104dbe(_0xd63b45) { const _0x32f358 = await _0x3479a8; return new Promise((_0x2b5e29, _0x9104b0) => { const _0x953c9f = _0x18ce; if ('hivuH' !== _0x953c9f(0x517)) { const _0xdaf463 = _0x32f358[_0x953c9f(0x95f)](_0x2e0278, 'readwrite'), _0x43d950 = _0xdaf463[_0x953c9f(0x4d6)](_0x2e0278), _0x43b13b = _0x43d950[_0x953c9f(0x9a5)](_0xd63b45); _0x43b13b['onsuccess'] = () => _0x2b5e29(), _0x43b13b['onerror'] = () => _0x9104b0(_0x43b13b[_0x953c9f(0x297)]); } else { const _0x260de2 = _0x8c8642[_0x953c9f(0xa93)](_0x953c9f(0x407)); _0x260de2[_0x953c9f(0xa03)] = _0x57a671['id'], _0x260de2[_0x953c9f(0x574)] = _0x3ec9c4[_0x953c9f(0xb15)], _0x3bf6c7[_0x953c9f(0x25f)](_0x260de2); } }); } function _0xd3e742(_0x3ce322) { const _0x323874 = _0x42e5a0; return fetch(_0x3ce322)['then'](_0x41a447 => _0x41a447[_0x323874(0x24c)]()); }
  </script>


  <div id="listen-together-ui" style="display: none;">
    <div class="lt-ui-backdrop"></div>
    <div class="lt-ui-main">
      <div class="lt-ui-header">
        <span id="lt-ui-header-title">正在与 TA 一起听</span>
        <button id="lt-ui-close-btn">×</button>
      </div>
      <div class="lt-ui-content">
        <div class="lt-ui-cover-container">
          <img id="lt-ui-cover-art" src="">
        </div>
        <div class="lt-ui-info">
          <h2 id="lt-ui-song-title">歌曲名称</h2>
          <p id="lt-ui-song-artist">歌手</p>
        </div>
        <div id="lt-ui-lyrics-container">
          <p class="no-lyrics-placeholder">暂无歌词</p>
        </div>
      </div>
    </div>
  </div>
  <div id="summarize-modal" class="choice-modal">
    <div id="summarize-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <button id="close-summary-button" class="header-button" style="min-width: 50px;">关闭</button>
        <span class="header-title">聊天记录总结</span>
        <button id="copy-summary-button" class="header-button" style="min-width: 50px;">复制</button>
      </div>
      <div class="content" style="flex-grow: 1; padding: 0;">
        <textarea id="summary-textarea" placeholder="AI正在拼命总结中，别催..."></textarea>
      </div>
    </div>
  </div>

  <div id="add-event-modal" class="choice-modal">
    <div id="add-event-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 320px;">
      <h3 id="add-event-modal-title" style="margin-top: 0; text-align: center;">为 YYYY-MM-DD 添加...</h3>
      <div class="input-group">
        <label for="event-content-input">内容</label>
        <input type="text" id="event-content-input" placeholder="要做什么或者是什么日子？">
      </div>
      <div class="input-group">
        <label>类型</label>
        <div style="display: flex; gap: 10px; margin-top: 5px;">
          <input type="radio" id="event-type-todo" name="event-type" value="todo" checked>
          <label for="event-type-todo" style="width: auto;">普通日程</label>
          <input type="radio" id="event-type-important" name="event-type" value="important">
          <label for="event-type-important" style="width: auto;">重要纪念日</label>
        </div>
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="save-event-button" class="form-button primary">保存</button>
        <button id="cancel-event-button" class="form-button secondary">取消</button>
      </div>
    </div>
  </div>


</body>

</html>
