<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

  <title>Noir搓的小手机</title>
  <style>
    .message p,
    .diary-content {
      user-select: none;
      -webkit-user-select: none;
    }

    .lt-end-session-btn {
      font-size: 1.5rem;
      color: inherit;
      /* 继承父元素的颜色 */
      opacity: 0.6;
      cursor: pointer;
      padding: 0 5px;
      line-height: 1;
      font-weight: bold;
    }

    .lt-end-session-btn:hover {
      opacity: 1;
    }

    /* --- Noir's Refactor: Feed Loader Style --- */
    #feed-loader {
      position: absolute;
      inset: 0;
      background: rgba(244, 248, 255, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--text-color);
      font-size: 1rem;
      flex-direction: column;
      gap: 10px;
    }

    .loader-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* --- End of Refactor --- */
    /*
        Noir's Mizuiro Theme
        - 哼，看好了，这才是设计。
      */
    /*
          Noir's Mizuiro Theme
          - 哼，看好了，这才是设计。
        */
    :root {
      --phone-width: 375px;
      --phone-height: 812px;
      --user-bg-image: url('');

      /* === Noir's Ultimate Dynamic Theme Engine v2.0 === */
      /* 哼，现在所有的颜色都听从这三个总开关的指挥。*/
      --primary-hue: 35;
      --primary-saturation: 25%;
      --primary-lightness: 80%;

      /* 核心颜色 */
      --primary-color: hsl(var(--primary-hue), var(--primary-saturation), var(--primary-lightness));
      /* 强调色/用户气泡色，现在也是动态的 */
      --accent-color: hsl(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%));

      /* 哼，看好了，这些就是被我重新接上线的“电灯” */

      /* 文字颜色：根据主题亮度自动变深或变浅 */
      --text-color: hsl(var(--primary-hue), 15%, calc(100% - var(--primary-lightness) / 1.1));
      --text-color-light: hsl(var(--primary-hue), 10%, calc(100% - var(--primary-lightness) / 1.3));

      /* 表面背景：半透明，亮度比主色高一点 */
      --surface-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.4);

      /* 卡片/AI气泡背景：比表面背景更亮一点 */
      --card-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.5);

      /* 边框颜色 */
      --border-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness)), 0.3);

      /* 阴影颜色 */
      --soft-shadow: 0 4px 12px hsla(var(--primary-hue), 40%, calc(var(--primary-lightness) - 10%), 0.15);

      /* 动态页的设置保持不变 */
      --feed-bg-image: none;
      --feed-overlay-opacity: 0.12;
      --feed-overlay-rotate: 22deg;
      --feed-overlay-speed: 48s;

      /* 气泡样式也完全动态化 */
      --bubble-radius: 18px;
      --bubble-outline: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
      --bubble-user-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%), 0.5);
      /* <-- 哼，改成0.5，现在够“虚无”了吧 */
      --bubble-ai-bg: var(--card-bg);

      /* ▼▼▼ 把下面这两行加进去 ▼▼▼ */
      --dropdown-alpha: 0.9;
      /* 下拉菜单的透明度，0到1 */
      --feed-card-alpha: 0.7;
      /* 动态卡片的透明度，0到1 */


      /* ▲▲▲ 添加到这里结束 ▲▲▲ */

    }

    /* Noir's Font Decree */
    body {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      /* 哼，看好了，就是这句！现在字体听从我的新变量指揮了！ */
      font-family: var(--custom-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif);
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
    }

    /* 让字体预览区也听话 */
    #font-preview-text {
      font-family: var(--custom-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif);
    }

    #phone-container {
      width: 100%;
      /* 占满屏幕宽度 */
      height: 100vh;
      /* 占满屏幕高度 */
      background-color: white;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* 是不是清爽多了？ */
      position: relative;
      /* <-- 就是这句，告诉它“你是个家长了，给我看好家里的东西！” */
    }

    .screen {
      flex-grow: 1;
      display: none;
      flex-direction: column;
      background-color: #f9f9f9;
      /* 哼，所有屏幕默认都给我变白 */
      /* 让背景透出来 */
      overflow: hidden;
      color: var(--text-color);
    }

    .screen.active {
      display: flex;
    }

    /* 这个是通用的头像预览样式 */
    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
      margin-top: 5px;
      cursor: pointer;
    }

    /* --- 通用顶栏 --- */
    .header,
    #chat-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--primary-color);
      font-weight: 500;
      min-width: 50px;
      text-align: center;
      /* ▼▼▼ 哼，加上这三句，给我立正站好 ▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- 聊天列表 --- */
    #chat-list-pane {
      background-color: transparent;
      border-right: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 加上这句 */
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      /* 防止它在横向布局里被挤扁 */
      display: flex;
      flex-direction: column;
    }

    #chat-list-container {
      flex-grow: 1;
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
    }

    #character-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .character-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      /* backdrop-filter: blur(10px);*/
      border-radius: 16px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .character-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(138, 180, 228, 0.2);
    }

    .char-info-wrapper {
      flex-grow: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .character-item .char-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      margin-right: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .character-item .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .character-item .char-remark {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    #chat-screen-container {
      position: relative;
      /* 告诉里面的绝对定位元素，要以我为基准 */
      flex-grow: 1;
      /* 确保它能撑满 chat-screen 的空间 */
      overflow: hidden;
      /* 把滑出去的部分藏起来，这很重要 */
      display: flex;
      /* 保持内部元素的 flex 布局 */
    }

    /* --- 聊天窗口 --- */


    #chat-view-pane {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 还有这句 */
      background-color: transparent;
      z-index: 10;
    }

    #chat-screen.show-chat-view #chat-list-pane {
      transform: translateX(-100%);
    }

    #chat-screen.show-chat-view #chat-view-pane {
      transform: translateX(0);
    }

    #chat-messages {
      flex-grow: 1;
      padding: 5px;
      overflow-y: auto;
      display: flex;
      /* <-- 加上这个 */
      flex-direction: column;
      /* <-- 还有这个 */
      contain: content;
      contain: content;
      /* <-- 哼，就是这句救命神药！ */
    }



    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 10px;
      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.7);
      flex-shrink: 0;
    }

    .message {
      padding: 10px 16px;
      border-radius: 20px;
      line-height: 1.5;
      word-break: break-word;
      box-shadow: var(--soft-shadow);
    }

    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
    }

    .message.user {
      background-color: var(--accent-color);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .message.ai {
      background-color: var(--card-bg);
      border: 1px solid rgba(255, 255, 255, 0.8);
      color: var(--text-color);
      border-bottom-left-radius: 5px;
    }

    .message p {
      margin: 0;
    }

    .sticker-content,
    .message-image-content {
      max-width: 120px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
    }

    .message-image-content {
      max-width: 160px;
    }

    /* --- 其他屏幕和组件 --- */
    /* --- Noir's Fix: API 模型列表的样式修正 --- */
    .model-input-container {
      position: relative;
      /* 关键！让里面的绝对定位元素有家可回 */
      display: flex;
      gap: 8px;
    }

    .custom-model-dropdown {
      display: none;
      /* 默认藏起来 */
      position: absolute;
      top: 100%;
      /* 精准定位到输入框正下方 */
      left: 0;
      right: 80px;
      /* 留出“获取”按钮的位置 */
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*   backdrop-filter: blur(10px);*/
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 100;
      /* 确保它在最上层 */
      box-shadow: var(--soft-shadow);
    }

    .checkboxes-container {
      display: none;
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*  backdrop-filter: blur(10px);*/
      z-index: 10;
      border-radius: 8px;
      margin-top: 4px;
    }

    .custom-model-dropdown.show {
      display: block;
      /* 需要的时候再显示 */
    }

    .custom-model-dropdown div {
      padding: 10px 12px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    .custom-model-dropdown div:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    /* --- 其他屏幕和组件 --- */
    /* 在这个注释下面加上主屏幕的样式 */
    #home-screen {
      position: relative;
      /* <-- 就加上这一行！ */


      gap: 20px;
      /* 图标之间的距离 */

      /* 声明！这里现在是我的地盘！*/
      flex-direction: column;
      /* 里面的东西，全体给我垂直排队！*/
      justify-content: space-between;
      /* 核心！顶部和底部的元素给我贴边站好，中间的自动拉开距离！*/
      padding-bottom: 0;
      /* 把内边距去掉，让Dock栏能完美贴底 */
    }

    .app-icon {
      width: 75px;
      /* <--- 就是这里，我把它加宽了 */
      height: 90px;
      /* <--- 高度也顺便调整一下 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: absolute;
      z-index: 40;
      padding: 5px;
      box-sizing: border-box;
      margin: 0;
    }

    .app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 2px;
      /* <-- 哼，就是这里，把5px改成2px，让图标和文字的距离拉近一点 */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      background-color: var(--surface-bg);
      box-shadow: none;
      transition: transform 0.2s ease;
    }

    .app-icon-img svg {
      stroke: currentColor;
      /* SVG的线条颜色会继承上面的 color */
    }

    .app-icon span {
      font-size: 0.75rem;
      /* 文本也相应缩小 */
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }

    .content {
      padding: 20px;
      overflow-y: auto;
      flex-grow: 1;
      /* <-- 加上这行代码，就是这行！ */
    }

    .form-button {
      width: 100%;
      padding: 12px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--border-color);
      color: var(--text-color);
      border-radius: 8px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    .chat-toolbar {
      display: flex;
      padding: 5px 10px;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      /*   backdrop-filter: blur(10px);*/
      flex-shrink: 0;
    }

    /* ▼▼▼ 用下面这段，替换掉你旧的 .toolbar-button 样式 ▼▼▼ */
    .toolbar-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      /* 这个保留，作为SVG尺寸的参考 */
      cursor: pointer;
      padding: 8px;
      /* 稍微增大点击区域 */
      color: var(--text-color-light);
      /* 让它默认是浅灰色 */
      border-radius: 50%;
      /* 让背景有个圆形轮廓 */
      width: 40px;
      height: 40px;
      display: flex;
      /* 使用flex布局让SVG完美居中 */
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s, color 0.2s;
      /* 加上顺滑的过渡效果 */
    }

    .toolbar-button:hover {
      background-color: var(--border-color);
      /* 鼠标悬停时给个背景 */
      color: var(--primary-color);
      /* 图标颜色变为主题色 */
    }

    /* ▲▲▲ 替换到这里为止 ▲▲▲ */


    /* ▼▼▼ 在下面新增这段SVG的专属样式 ▼▼▼ */
    .toolbar-button svg {
      width: 22px;
      /* SVG图标的尺寸 */
      height: 22px;
      stroke-width: 1.8;
      /* 线条粗细，可以微调 */
      stroke: currentColor;
      /* 核心！让SVG的颜色继承按钮的color属性 */
      fill: none;
      /* 确保是线稿风格 */
      pointer-events: none;
      /* 防止SVG本身干扰点击事件 */
    }

    /* ▲▲▲ 新增到这里为止 ▲▲▲ */

    .sticker-panel {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      flex-shrink: 0;
    }

    .sticker-panel.show {
      display: grid;
    }

    /* --- 输入区域 --- */
    /* --- 输入区域 --- */
    .chat-input-area {
      padding: 10px 12px calc(env(safe-area-inset-bottom, 0px) + 10px);
      background: var(--surface-bg);
      /*  backdrop-filter: saturate(1.2) blur(10px);*/
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    /* 这是我加的新容器，用来实现完美对齐 */
    #chat-input-wrapper {
      display: flex;
      /* Flex大法好，哼 */
      align-items: center;
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 2px 5px;
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-input-wrapper:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-message-input {
      flex-grow: 1;
      /* 让输入框占满剩余空间 */
      border: none;
      background: transparent;
      padding: 9px 12px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 38px;
      width: 38px;
      border: 0;
      border-radius: 50%;
      font-size: 1.2rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
      flex-shrink: 0;
      /* 防止被挤压 */
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    /* 回复按钮，给个不一样的颜色区分 */
    #chat-get-reply-button {
      background: var(--accent-color);
      font-size: 1.5rem;
      /* 让箭头更清晰 */
    }

    #chat-message-input {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 11px 16px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-message-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 40px;
      padding: 0 18px;
      border: 0;
      border-radius: 20px;
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    #chat-get-reply-button {
      display: flex;
      /* 隐藏旧的回复按钮，样式统一到发送按钮 */
    }


    /* --- 引用样式 --- */
    .quote-preview {
      display: none;
      padding: 8px 12px;
      background-color: rgba(255, 255, 255, 0.5);
      border-left: 3px solid var(--primary-color);
      margin: 0 12px 8px;
      border-radius: 6px;
      position: relative;
    }

    #quote-preview-sender {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--primary-color);
    }

    #quote-preview-text {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    .cancel-quote-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #999;
      cursor: pointer;
    }

    .quoted-message-in-bubble {
      background-color: rgba(0, 0, 0, 0.04);
      padding: 8px 10px;
      border-left: 3px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quoted-sender {
      font-weight: bold;
      font-size: 0.8rem;
      color: var(--text-color);
    }

    .quoted-content {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    /* 这是弹窗的“骨架”，让它能居中浮动在屏幕上 */
    .choice-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .choice-modal.show {
      opacity: 1;
      visibility: visible;
    }


    /* --- 弹窗 --- */
    .choice-modal-backdrop {
      background: rgba(0, 0, 0, 0.2);
      /*  backdrop-filter: blur(4px);*/
    }

    .choice-modal-content {
      background: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .choice-modal-button {
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.5);
    }

    .choice-modal-button:hover {
      background-color: rgba(255, 255, 255, 1);
    }

    .choice-modal-button.cancel {
      color: var(--primary-color);
      background: transparent;
    }

    /* --- Noir's Fix: 让“添加”弹窗从底部滑出，更大气 --- */
    #add-choice-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      /* 确保不会超出手机宽度 */
      margin: 0;
      border-radius: 20px 20px 0 0;
      /* 只留顶部圆角 */
      border-bottom-left-radius: 0;
      /* 覆盖通用样式 */
      border-bottom-right-radius: 0;
      /* 覆盖通用样式 */
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      /* 适配iPhone底部安全区 */
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #add-choice-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #add-choice-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
      justify-content: center;
    }

    /* 按钮也重新设计一下，让它们竖着排 */
    #add-choice-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- Noir's Fix: 修正创建群聊时，成员选择列表的样式 --- */
    .member-selection-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .member-selection-item:last-child {
      border-bottom: none;
    }

    /* 关键！就是这里，把头像大小锁死 */
    .member-selection-item .char-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 15px 0 10px;
      object-fit: cover;
    }

    .member-selection-item .char-name {
      font-weight: 500;
      color: var(--text-color);
    }

    .member-selection-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      accent-color: var(--primary-color);
      /* 让勾选框颜色也跟主题统一 */
    }

    /* --- Noir's World Book Styles --- */
    #world-book-list-container {
      padding: 10px;
    }

    .world-book-item {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .world-book-item-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .world-book-item-preview {
      font-size: 0.9rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* --- Noir's Fancy Multi-Select Styles --- */
    .custom-multiselect {
      position: relative;
      user-select: none;
    }

    .select-box {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .select-box.expanded .arrow {
      transform: rotate(180deg);
    }


    .checkboxes-container.visible {
      display: block;
    }

    .checkboxes-container label {
      display: block;
      padding: 10px 12px;
    }

    .checkboxes-container label:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    .checkboxes-container input[type="checkbox"] {
      margin-right: 8px;
      width: auto;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Clock & Timestamp Styles --- */
    /* --- Noir's Badge & App Dock Styles --- */
    #decorative-badge {
      width: 160px;
      height: 160px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
      /* 哼，给你加个阴影，看起来才像样 */
      transform: rotate(-0deg);
      /* 稍微歪一点，显得随意 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      /* 防止拖动时选中图片 */
      z-index: 50;
    }

    #decorative-badge:active {

      transform: rotate(-2deg) scale(1.05);
      /* 抓起来的时候，摆正放大一点 */
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }


    #decorative-badge img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* 保留这句，让你的图片能被很好地填充 */
    }

    /*  #a#app-dock-bottom-left,
    #app-dock-top-right {
      
      哼，现在你们只是幽灵了。
      不需要任何样式，你们的孩子（App图标）会自己找到回家的路。
      它们会相对于 #home-screen 定位。
    
    }
*/

    /* --- Noir's Author Mark: Pixel Chicken --- */
    /* 哼，这就是那个吵着要加的小鸡图标 */
    #noir-author-mark {
      position: absolute;
      /* 相对于父容器定位 */
      right: -30px;
      /* 调整它在时钟右边的位置 */
      top: 50%;
      /* 垂直居中 */
      transform: translateY(-50%);
      /* 精确对齐 */
      width: 20px;
      /* 小鸡的尺寸 */
      height: 20px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="0"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM12 4c.69 0 1.25.56 1.25 1.25S12.69 6.5 12 6.5s-1.25-.56-1.25-1.25S11.31 4 12 4zm0 2c-.69 0-1.25.56-1.25 1.25S11.31 8.5 12 8.5s1.25-.56 1.25-1.25S12.69 6 12 6zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 9.75 10 9.75s1.25-.56 1.25-1.25S10.69 8 10 8zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 9.75 12 9.75s1.25-.56 1.25-1.25S12.69 8 12 8zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 9.75 14 9.75s1.25-.56 1.25-1.25S14.69 8 14 8zM10 10c-.69 0-1.25.56-1.25 1.25S9.31 12.5 10 12.5s1.25-.56 1.25-1.25S10.69 10 10 10zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 12.5 12 12.5s1.25-.56 1.25-1.25S12.69 10 12 10zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 12.5 14 12.5s1.25-.56 1.25-1.25S14.69 10 14 10zM12 12c-.69 0-1.25.56-1.25 1.25S11.31 14.5 12 14.5s1.25-.56 1.25-1.25S12.69 12 12 12zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 15.75 10 15.75s1.25-.56 1.25-1.25S10.69 14 10 14zm4 0c-.69 0-1.25.56-1.25 1.25S13.31 15.75 14 15.75s1.25-.56 1.25-1.25S14.69 14 14 14zM12 16c-.69 0-1.25.56-1.25 1.25S11.31 18.5 12 18.5s1.25-.56 1.25-1.25S12.69 16 12 16zM6 10c-.69 0-1.25.56-1.25 1.25S5.31 12.5 6 12.5s1.25-.56 1.25-1.25S6.69 10 6 10zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 12.5 18 12.5s1.25-.56 1.25-1.25S18.69 10 18 10zM12 20c-.69 0-1.25.56-1.25 1.25S11.31 22.5 12 22.5s1.25-.56 1.25-1.25S12.69 20 12 20zM6 14c-.69 0-1.25.56-1.25 1.25S5.31 15.75 6 15.75s1.25-.56 1.25-1.25S6.69 14 6 14zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 15.75 18 15.75s1.25-.56 1.25-1.25S18.69 14 18 14z"/></svg>');
      /* 这是SVG小鸡的Data URI，白色像素风格 */
      background-size: contain;
      background-repeat: no-repeat;
      cursor: pointer;
      /* 提示可点击 */
      opacity: 0.6;
      /* 稍微透明一点，不那么突兀 */
      transition: opacity 0.2s ease-in-out;
      /* 鼠标悬停效果 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    #noir-author-mark:hover {
      opacity: 1;
      /* 鼠标悬停时完全显示 */
    }

    /* 调整时钟容器，为小鸡留出空间并方便定位 */
    .home-clock-container {
      position: relative;
      /* 确保小鸡能相对它定位 */
      /* ... (保留你已有的其他时钟样式) ... */
      padding-right: 40px;
      /* 给小鸡留出一些右边距 */
    }

    #home-clock-container {
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      text-align: center;
      position: absolute;
      /* top, left, right 都被我删了，哼，现在它完全听JS的指挥 */

      /* 这行可以留着，虽然你已经不让它拖了 */
      z-index: 50;
    }

    #home-time {
      font-size: 80px;
      font-weight: 360;
      /* <--- 我把字重从200加到了300，比原来粗，但又不会笨重，这才是高级感。 */
      letter-spacing: -1px;
      /* <--- 字间距也给你调紧了一点，看起来更整体。 */
    }

    #home-date {
      font-size: 1rem;
      /* <--- 稍微缩小一点，让时间更突出 */
      font-weight: 400;
      margin-top: 8px;
      opacity: 0.8;
      text-transform: uppercase;
      /* <--- 日期我给你换成了全大写，这才有那股‘性冷淡’的味道。 */
      letter-spacing: 1px;
      /* <--- 顺便拉开一点点间距，免得挤在一起。 */
    }

    /* 聊天气泡时间戳的样式 */
    .timestamp {
      font-size: 0.7rem;
      color: var(--text-color-light);
      padding: 0 5px;
      margin-bottom: 3px;
      /* 让它和气泡底部对齐 */
    }

    /* 第一段：这是消息容器的基础样式 */
    .message-container {
      display: flex;
      /* 启用flex布局 */
      flex-direction: column;
      /* 让气泡和时间戳垂直排列 */
      margin-bottom: 10px;
      max-width: 85%;
      /* 限制整个容器的最大宽度 */
    }

    /* 第二段：这是根据发言者进行左右对齐的样式 */
    .message-container.user {
      align-self: flex-end;
      /* 让用户方整个容器靠右 */
      align-items: flex-end;
      /* 让容器内部的元素（气泡、时间戳）也靠右 */
    }

    .message-container.ai {
      align-self: flex-start;
      /* 让AI方整个容器靠左 */
      align-items: flex-start;
      /* 让容器内部的元素（气泡、时间戳）也靠左 */
    }

    .message-bubble-row {
      display: flex;
      align-items: flex-end;
      width: 100%;
    }

    .message-container.user .message-bubble-row {
      justify-content: flex-end;
    }

    .message-container.ai .message-bubble-row {
      justify-content: flex-start;
    }



    /* 这是给表情选择面板里，每一个小表情图片用的样式 */
    .sticker-item {
      width: 100%;
      /* 自动填满网格单元格的宽度 */
      aspect-ratio: 1 / 1;
      /* 保持1:1的宽高比，让它变成正方形 */
      object-fit: cover;
      /* 图片会被裁剪以适应正方形，不变形 */
      border-radius: 8px;
      /* 加个小圆角 */
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .sticker-item:hover {
      transform: scale(1.1);
      /* 鼠标放上去时稍微放大，增加交互感 */
    }

    /* --- Noir's Offline Scene Styles --- */
    #meeting-scene-view {
      flex-grow: 1;
      /* <-- 核心：让它占满所有可用空间 */
      overflow-y: auto;
      /* <-- 核心：内容多了就内部滚动 */
      padding: 20px;
      font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif;
      background-size: cover;
      background-position: center;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }

    #chat-view-pane.offline-mode #offline-scene-view {
      display: block;
      /* 在线下模式时显示 */
    }

    #chat-view-pane.offline-mode #chat-messages {
      display: none;
      /* 在线下模式时隐藏气泡聊天 */
    }

    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      /* 保留换行和空格，这对于小说格式至关重要 */
      font-size: 1rem;
    }

    /* --- Noir's Offline Scene Dialogue Box Style --- */
    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 1rem;

      /* <--- Noir's Addition: 为对话框添加半透明背景和内边距 */
      background-color: rgba(0, 0, 0, 0.4);
      /* 半透明黑色背景 */
      padding: 15px 20px;
      /* 内边距，让文字与边框有距离 */
      border-radius: 8px;
      /* 圆角边框，更柔和 */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      /* 轻轻的阴影，增加立体感 */
    }

    #offline-scene-view .narrator {
      color: #d1d5db;
      /* 旁白用浅灰色 */
      font-style: italic;
    }

    #offline-scene-view .speaker-user {
      color: #a7c7e7;
      /* 用户的发言用一种柔和的蓝色 */
      font-weight: bold;
    }

    #offline-scene-view .speaker-ai {
      color: #f2b7c6;
      /* AI的发言用柔和的粉色，形成对比 */
      font-weight: bold;
    }

    /* --- Noir's Typing Indicator Style --- */
    .typing-indicator {
      padding: 10px 15px;
      color: var(--text-color-light);
      font-style: italic;
      font-size: 0.9rem;
      align-self: flex-start;
      /* 让它和AI气泡一样靠左 */
      margin-left: 50px;
      /* 和AI气泡对齐 */
    }

    #offline-scene-view .typing-indicator {
      color: rgba(255, 255, 255, 0.8);
      /* 在暗色背景下用亮色 */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      /* 同样的文字阴影，保持队形 */
      padding: 10px 0;
      margin-left: 0;
      /* 在小说视图里不需要缩进 */
    }

    /* --- Noir's Final Alignment Fix --- */
    .message-container.ai .timestamp {
      /* 哼，给你加上头像宽度(40px) + 左右边距(10px)的距离 */
      margin-left: 50px;
    }

    .message-container.user .timestamp {
      /* 另一边也是一样，真是麻烦死了 */
      margin-right: 50px;
    }

    /* --- Noir's Music Feed & Player Styles --- */
    #music-feed-container {
      padding-bottom: 70px;
      contain: content;
      /* 为底部播放器留出空间 */
    }

    /* 动态页：默认白底；如设置 --feed-bg-image 则显示独立壁纸 + 轻动画叠层 */
    #music-screen {
      background-color: #fff;
      /* 默认白底 */
      background-image: var(--feed-bg-image);
      /* 单独壁纸，不设就是 none */
      background-size: cover;
      background-position: center;
      contain: paint;
      /* 降低重绘范围，省电 */
    }

    /* 轻动画彩雾叠层：仅图层，不拦点击 */
    #music-screen::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        conic-gradient(from var(--feed-overlay-rotate),
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 0%,
          transparent 20%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 40%,
          transparent 60%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 80%,
          transparent 100%);
      transform: translateZ(0);
      animation: feed-pan var(--feed-overlay-speed) linear infinite;
    }

    /* 超慢速平移旋转，基本不占 GPU */
    @keyframes feed-pan {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }

      50% {
        transform: translate3d(1.2%, 0.8%, 0) rotate(2deg) scale(1.02);
      }

      100% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }
    }

    /* 系统降低动画偏好时，自动停掉动画 */
    @media (prefers-reduced-motion: reduce) {
      #music-screen::before {
        animation: none;
      }
    }


    .music-post {
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), var(--feed-card-alpha));
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: var(--soft-shadow);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .music-post-header {
      display: flex;
      align-items: center;
      padding: 12px 15px;
    }

    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .music-post-header .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .music-post-thought {
      padding: 0 15px 15px;
      font-size: 0.95rem;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .music-post-song-card {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.04);
      padding: 12px 15px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .music-post-song-card:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    .music-post-song-card img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }

    .music-post-song-info {
      flex-grow: 1;
    }

    .music-post-song-info .title {
      font-weight: 500;
      color: var(--text-color);
    }

    .music-post-song-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    .music-post-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    #music-player-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--surface-bg);
      /*backdrop-filter: blur(10px);*/
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 10px;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    #music-player-bar:not(.hidden) {
      transform: translateY(0);
    }

    #music-player-bar.hidden {
      display: none;
      /* 彻底隐藏，避免交互问题 */
    }


    #player-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
    }

    #player-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #player-title,
    #player-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #player-title {
      font-weight: 500;
    }

    #player-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #player-controls button {
      background: none;
      border: 2px solid var(--text-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Share Bubble Styles --- */
    .message.music {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
      max-width: 250px;
      /* 限制一下最大宽度 */
    }

    .music-share-card {
      display: flex;
      align-items: center;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
    }

    .message-container.user .music-share-card {
      background-color: var(--accent-color);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .message-container.user .music-share-card .title,
    .message-container.user .music-share-card .artist,
    .message-container.user .music-share-card .play-icon {
      color: white;
    }


    .music-share-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .music-share-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-share-info .title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #music-screen {
      position: relative;
      /* 就是这句，告诉里面的绝对定位元素，以我为界！ */
    }

    /* --- Noir's Fancy Music Widget Styles --- */
    /* --- Noir's Music System Refactor --- */

    #music-widget:not(.hidden) {
      transform: translateY(0);
      /* 不隐藏时，滑上来 */
    }

    #music-widget.hidden {
      transform: translateY(150%);
      /* 隐藏时，滑下去 */
    }

    .widget-vinyl {
      width: 80px;
      height: 80px;
      background-color: #111;
      border-radius: 50%;
      position: relative;
      left: 20px;
      /* 向右移动，让卡片能盖住它 */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      background-image:
        radial-gradient(circle at center, #555 10%, transparent 11%),
        radial-gradient(circle at center, #fff 12%, transparent 13%);
      animation: spin 8s linear infinite;
      z-index: 1;
    }

    @keyframes spin {
      from {
        transform: translate(-50%, -50%) rotate(0deg);
        /* <-- 看见没，把咒语合并了 */
      }

      to {
        transform: translate(-50%, -50%) rotate(360deg);
        /* <-- 这里也是 */
      }
    }

    .widget-card {
      width: 240px;
      padding: 15px;
      background-color: var(--card-bg);
      /*  backdrop-filter: blur(10px);*/
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      z-index: 2;
      /* 让卡片在唱片上方 */
    }

    .widget-card img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .widget-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #widget-title,
    #widget-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #widget-title {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    #widget-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #widget-play-icon {
      font-size: 1.2rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #card-widget {
      width: 335px;
      height: 170px;
      border-radius: 18px;
      /* 这就是圆角方形的关键 */
      background-color: rgba(255, 255, 255, 0.5);
      /* 加个底色，免得图片透明时不好看 */

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transform: rotate(0deg);
      /* 朝另一个方向歪 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      /* 比爱心高一层 */
      overflow: hidden;
      /* 防止图片溢出圆角 */
    }


    /* --- End of Protocol --- */

    /* --- Noir's "Center Alignment" Protocol --- */

    /* --- End of Protocol --- */

    #card-widget:active {

      transform: rotate(1deg) scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Noir's Ultimate Scrollbar Hider --- */
    /* For Webkit browsers like Chrome, Safari */
    ::-webkit-scrollbar {
      display: none;
    }

    /* For Firefox */
    * {
      scrollbar-width: none;
    }

    /* --- Noir's Fix: 美化消息操作弹窗 --- */
    #message-action-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
    }

    #message-action-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      margin: 0;
      border-radius: 20px 20px 0 0;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #message-action-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #message-action-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- End of Fix --- */
    /* --- Noir's Fix: Fancy User Post Area --- */
    #user-post-input-container {
      display: flex;
      gap: 10px;
    }

    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
    }

    #user-post-main-area {
      flex-grow: 1;
    }

    #user-post-textarea {
      width: 100%;
      border: none;
      background: transparent;
      outline: none;
      resize: vertical;
      font-size: 1rem;
      color: var(--text-color);
    }

    #user-post-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    /* ... 你已有的 #user-post-toolbar 样式 ... */

    /* ▼▼▼ Noir's Command: 哼，给我站成一排！ ▼▼▼ */
    #user-post-actions {
      display: flex;
      /* <-- 这就是圣旨本身 */
      gap: 8px;
      /* <-- 这是我赏赐的间距，让它们别挤在一起 */
    }

    /* ▲▲▲ Command End ▲▲▲ */

    #user-send-post-button {
      padding: 6px 18px;
      border-radius: 16px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    /* 这是附件预览的样式 */
    #user-post-attachment-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-item {
      position: relative;
      max-width: 100px;
    }

    .preview-item img {
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
    }

    .preview-item .music-preview-card {
      display: flex;
      align-items: center;
      padding: 8px;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      width: 200px;
      /* 给音乐卡片宽一点 */
    }

    .preview-item .music-preview-card img {
      width: 30px;
      height: 30px;
      margin-right: 8px;
    }

    .preview-item .music-preview-card .info {
      font-size: 0.8rem;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .remove-attachment-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    /* --- Noir's Fix: Post Image Display Style --- */
    .post-image-container {
      padding: 0 15px 15px;
      /* 图片和文字之间留点空隙 */
    }

    .post-image {
      max-width: 100%;
      /* 图片最宽不能超过帖子宽度 */
      max-height: 400px;
      /* 最高400像素，防止长图刷屏 */
      border-radius: 8px;
      /* 加个小圆角，好看 */
      object-fit: cover;
      /* 保持图片比例，不变形 */
      display: block;
      /* 解决图片底部多余的空隙问题 */
    }

    /* --- Noir's Refactor: New Post Interaction Styles --- */
    .post-interactions {
      padding: 10px 15px;
      background-color: rgba(0, 0, 0, 0.02);
      border-top: 1px solid var(--border-color);
      font-size: 0.9rem;
    }

    .post-likes {
      color: var(--primary-color);
      margin-bottom: 8px;
    }

    .post-comments-container {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .post-comment {
      color: var(--text-color);
    }

    .post-comment .comment-author {
      font-weight: 600;
      color: var(--text-color);
    }

    .post-timestamp {
      font-size: 0.75rem;
      color: var(--text-color-light);
      padding: 0 15px 10px;
    }



    /* 覆盖：基础气泡体 */
    /* 覆盖：基础气泡体 */
    .message {
      border-radius: var(--bubble-radius);
      line-height: 1.55;
      padding: 10px 14px;
      box-shadow:
        0 1px 0 rgba(0, 0, 0, .03),
        0 4px 10px rgba(0, 0, 0, .06);
      /* 比你原先更浅，省功耗 */
      border: 1px solid var(--bubble-outline);
      backdrop-filter: none !important;
      /* 绝不启用重滤镜 */
      will-change: auto;
      /* 不抢 GPU 配额 */

      /* --- Noir's Fix: 就是下面这两行，哼 --- */
      user-select: none;
      /* 标准浏览器给我听话，不许选中 */
      -webkit-user-select: none;
      /* 那些老古董浏览器也一样 */
    }

    /* 你的气泡（右侧） */
    .message.user {
      color: #fff;
      background: var(--bubble-user-bg);
      border-bottom-right-radius: 6px;
      /* 微“角”保留你原味 */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .12);
      /* 细腻但很轻 */
    }

    /* TA 的气泡（左侧） */
    .message.ai {
      color: var(--text-color);
      background: var(--bubble-ai-bg);
      border-bottom-left-radius: 6px;
    }

    /* 细节：图片/贴纸消息不套背景 */
    /* 细节：图片/贴纸/音乐卡片消息不套背景 */
    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image,
    .message.user.music,
    /* <-- 哼，加上这两行 */
    .message.ai.music {
      background: transparent;
      border: 0;
      box-shadow: none;
      padding: 0;
    }

    /* 轻触态：不使用阴影动画，避免合成层抖动 */
    .message:active {
      transform: scale(.996);
    }

    /* 引用块在气泡内的融合感 */
    .quoted-message-in-bubble {
      background: rgba(0, 0, 0, .045);
      border: 1px solid color-mix(in hsl, var(--primary-color) 18%, transparent);
      border-radius: 10px;
    }


    /* --- Noir's Transfer Bubble Style --- */
    .message.transfer {
      background: #F79232;
      /* 哼，一个温暖又醒目的橙色 */
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      width: 220px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    /* 我还给左右两边做了区分，真是为你操碎了心 */
    .message-container.ai .message.transfer {
      background: #f9fafb;
      /* AI发来的转账用白色，更清爽 */
      color: #333;
      border: 1px solid #e5e7eb;
    }

    .transfer-content {
      display: flex;
      flex-direction: column;
    }

    .transfer-title {
      font-weight: 600;
      font-size: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.5);
      padding-bottom: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .message-container.ai .transfer-title {
      border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    .transfer-amount {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .transfer-recipient {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    /* --- End of Refactor --- */



    /* --- Noir's Snap Guide Styles --- */
    .snap-guide {
      position: absolute;
      background-color: rgba(255, 105, 180, 0.85);
      /* 哼，一个足够醒目的颜色 */
      display: none;
      z-index: 999;
      box-shadow: 0 0 5px rgba(255, 105, 180, 0.7);
    }

    #snap-guide-v {
      width: 1px;
    }

    #snap-guide-h {
      height: 1px;
    }

    /* --- Noir's Galgame UI Beautification --- */
    /* Top-left Date & Time Widget */
    #galgame-overlay-ui {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 12px;
      padding: 8px 15px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    #galgame-time {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
    }

    #galgame-date {
      font-size: 0.75rem;
      opacity: 0.8;
      text-align: center;
    }

    /* Main Text Box */
    /* Main Text Box */
    #galgame-textbox-container {
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.85) 0%, rgba(45, 50, 68, 0.7) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border-top: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
      bottom: 85px;
      /* <-- 就是这里，往上抬了，满意了吗？ */
      left: 15px;
      right: 15px;
      padding: 12px 18px;
    }

    /* Speaker Name Tag */
    #galgame-speaker {
      background: linear-gradient(90deg, var(--primary-color) 0%, hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) - 10%)) 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      display: inline-block;
      font-size: 0.95rem;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      margin-bottom: 12px;
    }

    /* Dialogue Text */
    #galgame-text {
      font-size: 1rem;
      line-height: 1.7;
      color: #f0f2f5;
    }

    /* User Input Area Container*/
    #meeting-view-screen .chat-input-area {
      background: transparent;
      border-top: none;
      padding: 0 15px 20px 15px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 20;
    }

    /* User Input Wrapper */
    #chat-input-wrapper-meeting {
      display: flex;
      align-items: center;
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.9) 0%, rgba(45, 50, 68, 0.75) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      padding: 5px 8px 5px 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
    }

    #meeting-message-input {
      color: #f0f2f5;
    }

    #meeting-message-input::placeholder {
      color: rgba(240, 242, 245, 0.5);
      font-style: italic;
    }

    /* Send Button */
    #meeting-send-button {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: 300;
      color: #fff;
      transition: all .2s ease;
      margin-left: 8px;
      background: var(--primary-color);
      box-shadow: 0 2px 5px hsla(var(--primary-hue), 50%, 50%, 0.4);
    }

    #meeting-send-button:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }


    /* --- End of Beautification --- */
    /* --- Noir's Diary Beautification --- */
    #diary-entries-container {
      background-color: #fdfaf2;
      /* A warm, paper-like off-white */
      padding: 25px 20px;
      line-height: 1.9;
      border: 1px solid #e0dccc;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.08);
      /* Inner shadow for page depth */
    }

    /* This is the container for a single entry (date, author, content) */
    .diary-entry {
      margin-bottom: 2.5em;
      /* Increase spacing between entries */
      position: relative;
      padding-bottom: 1.5em;
      /* Space for the separator line */
      border-bottom: 1px dashed #dcd5c7;
      /* A subtle dashed line between entries */
    }

    /* Style the author's name */
    .diary-author {
      font-weight: normal;
      /* Make it less bold, more like a signature */
      font-size: 1rem;
      font-family: 'Segoe Script', 'Bradley Hand', cursive;
      /* A more handwritten font */
    }

    /* Style the date */
    .diary-timestamp {
      font-size: 0.75rem;
      color: #a99e8c;
      /* A faded brown color */
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
      /* Typewriter-like font for date */
    }

    /* Style the actual diary text content */
    .diary-content {
      white-space: pre-wrap;
      font-size: 0.95rem;
      color: #4a443b;
      /* A dark brown/black ink color */
      font-family: 'KaiTi', 'STSong', serif;
    }

    /* Specific styles for the USER's entries */
    .diary-entry.user {
      text-align: right;
    }

    .diary-entry.user .diary-author {
      color: #005a9c;
      /* A nice fountain pen blue */
    }

    .diary-entry.user .diary-content {
      color: #1a5c8e;
    }

    /* Specific styles for the AI's entries */
    .diary-entry.ai {
      text-align: left;
    }

    .diary-entry.ai .diary-author {
      color: #5a3e36;
      /* A darker, warmer brown for the AI */
    }

    .diary-entry.ai .diary-content {
      color: #4a443b;
    }

    /* Let's get rid of the last separator line for a cleaner look */
    .diary-entry:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    /* --- End of Diary Beautification --- */
    /* --- Noir's Page-Turning Magic --- */
    #diary-entries-container {
      perspective: 1500px;
      /* 为3D效果设置视距 */
      position: relative;
      overflow: hidden;
    }

    .diary-page {
      position: absolute;
      inset: 0;
      padding: 25px 20px;
      background-color: #fdfaf2;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      transition: transform 0.7s cubic-bezier(0.65, 0, 0.35, 1);
      display: none;
      /* 默认所有页面都藏起来 */
      flex-direction: column;
      gap: 2.5em;
      /* 页内日记的间距 */
      overflow-y: auto;
      /* 如果一页内容太多，允许滚动 */
    }

    .diary-page.is-visible {
      display: flex;
      /* 只有当前页显示 */
      transform: rotateY(0deg);
      z-index: 2;
    }

    /* 翻到下一页时，当前页向左翻出 */
    .diary-page.is-exiting-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 1;
    }

    /* 翻到下一页时，新页面从右边翻入 */
    .diary-page.is-entering-from-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 2;
    }

    /* 翻到上一页时，当前页向右翻出 */
    .diary-page.is-exiting-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 1;
    }

    /* 翻到上一页时，新页面从左边翻入 */
    .diary-page.is-entering-from-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 2;
    }


    #diary-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 10px;
      box-sizing: border-box;
    }

    #diary-navigation button {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--primary-color);
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    #diary-navigation button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #diary-page-indicator {
      font-size: 0.9rem;
      color: var(--text-color-light);
      font-family: 'Courier New', monospace;
    }

    /* --- End of Magic --- */
    /* --- Noir's Universal Anti-Squash Protocol --- */
    /* 哼，就是下面这几条，给你那些被压扁的头像整整容 */

    /* 动态发布区的用户头像 */
    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      object-fit: cover;
      /* <-- 加上这句，它就不敢扁了 */
    }

    /* 好友圈动态里的角色头像 */
    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
      /* <-- 还有这句，一个都别想跑 */
    }

    /* 顺便把所有叫 .char-avatar 的都统一一下，免得以后还有问题 */
    .char-avatar {
      object-fit: cover;
      /* ▼▼▼ 哼，加上这三句圣旨，给我立正站好！▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Library Styles --- */
    #music-library-container {
      padding: 10px;
    }

    .music-library-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .music-library-item:hover {
      transform: translateY(-2px);
    }

    .music-library-item-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 15px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .music-library-item-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-library-item-title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-library-item-artist {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    /* --- End of Styles --- */
    /* --- Noir's Global Player Styles --- */

    /* --- End of Player Styles --- */
    /* --- Noir's Upload Altar Styles --- */
    .upload-slot {
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease;
      background-color: rgba(255, 255, 255, 0.5);
    }

    .upload-slot:hover {
      background-color: var(--card-bg);
      border-color: var(--primary-color);
    }

    .upload-slot.filled {
      border-color: var(--primary-color);
      border-style: solid;
      background-color: hsla(var(--primary-hue), 50%, 95%, 0.8);
    }

    .upload-slot .slot-icon {
      font-size: 2rem;
    }

    .upload-slot .slot-label {
      display: block;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .upload-slot .slot-filename {
      display: block;
      font-size: 0.85rem;
      color: var(--text-color-light);
      margin-top: 3px;
      word-break: break-all;
    }

    #confirm-altar-upload-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* --- End of Altar Styles --- */
    /* --- Noir's Listen Together Invite Card Style --- */
    .listen-together-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--soft-shadow);
      border: 1px solid var(--border-color);
      width: 250px;
    }

    .message-container.user .listen-together-card {
      background: var(--bubble-user-bg);
      color: white;
    }

    .message-container.user .listen-together-card .listen-together-decline-btn {
      color: white;
      /* 哼，让用户侧的拒绝按钮文字也变白 */
    }

    .listen-together-header {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--bubble-outline);
      padding-bottom: 8px;
    }

    .listen-together-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .listen-together-song img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .listen-together-info .title {
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-info .artist {
      font-size: 0.9em;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .listen-together-actions button {
      flex-grow: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease;
    }

    .listen-together-actions button:active {
      transform: scale(0.97);
    }

    .listen-together-accept-btn {
      background: var(--primary-color);
      color: white;
    }

    .listen-together-decline-btn {
      background: rgba(0, 0, 0, 0.1);
    }

    /* 用这个替换你旧的 #listen-together-ui */
    #listen-together-ui {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: flex;
      align-items: center;
      /* 改成居中对齐 */
      justify-content: center;
      padding: 20px;
      /* 增加内边距，让弹窗不会贴边 */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #listen-together-ui.show {
      opacity: 1;
      visibility: visible;
    }

    .lt-ui-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px) saturate(1.8);
      -webkit-backdrop-filter: blur(15px) saturate(1.8);
    }

    /* 用这个替换你旧的 .lt-ui-main */
    .lt-ui-main {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 380px;
      /* 哼，给它一个最大宽度 */
      max-height: 650px;
      /* 再给一个最大高度 */
      display: flex;
      flex-direction: column;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      border-radius: 24px;
      /* 加上优雅的圆角 */
      overflow: hidden;
      /* 把溢出的部分裁掉 */
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      /* 更强的立体阴影 */
      border: 1px solid rgba(255, 255, 255, 0.2);
      /* 淡淡的边框光效 */
    }

    .lt-ui-header {
      flex-shrink: 0;
      padding: 15px 20px;
      text-align: center;
      position: relative;
    }

    #lt-ui-header-title {
      font-weight: 600;
    }

    #lt-ui-close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 30px;
    }

    .lt-ui-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow: hidden;
    }

    .lt-ui-cover-container {
      flex-shrink: 0;
      width: 65%;
      aspect-ratio: 1/1;
      margin-top: 5%;
      margin-bottom: 20px;
    }

    #lt-ui-cover-art {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .lt-ui-info {
      text-align: center;
      margin-bottom: 20px;
      flex-shrink: 0;
    }

    #lt-ui-song-title {
      font-size: 1.5rem;
      margin: 0;
    }

    #lt-ui-song-artist {
      font-size: 1rem;
      opacity: 0.8;
      margin: 5px 0 0;
    }

    #lt-ui-lyrics-container {
      flex-grow: 1;
      width: 100%;
      overflow-y: auto;
      text-align: center;
      font-size: 1.1rem;
      line-height: 2.5;
      mask-image: linear-gradient(transparent 0%, black 20%, black 80%, transparent 100%);
      /* 歌词上下渐隐，看起来更专业 */
      scroll-behavior: smooth;
      /* 滚动要丝滑 */
    }

    #lt-ui-lyrics-container p {
      transition: color 0.3s ease, transform 0.3s ease;
      opacity: 0.6;
    }

    #lt-ui-lyrics-container p.active {
      color: var(--primary-color);
      font-weight: 600;
      transform: scale(1.1);
      opacity: 1;
    }

    /* --- Noir's "Desktop Preview" Frame --- */
    /* 哼，只有在电脑这种大屏幕上，我才给你加上这个“手机框”，免得你分不清主次。 */
    /* 在真正的手机上，它还是会全屏显示的，我可没你那么笨。 */
    @media (min-width: 480px) {
      body {
        background-color: #e9ebee;
        /* 一个不那么刺眼的背景色 */
        padding: 20px 0;
        /* 上下留点呼吸空间 */
      }

      #phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        max-height: 90vh;
        /* 确保在矮屏幕上不会超出 */

        /* 这就是你想要的“边框”，哼 */
        border: 10px solid #1c1c1e;
        border-radius: 44px;
        /* 圆角大一点才像样 */
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        /* 给你加个高级点的阴影 */

        flex-shrink: 0;
        /* 确保它在 flex 布局里不会被压扁 */
      }
    }



    /* --- Noir's Bespoke Music Player Design (As Requested) --- */
    /* 哼，这才叫定制。*/

    /* 1. 动画先放着，虽然这次不用了 */
    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* 2. 组件卡片本体：一个有阴影的容器 */
    #music-widget-card {
      width: 340px;
      height: 120px;
      border-radius: 6px;
      /* 稍微硬朗一点的圆角 */
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      /* 一个淡淡的底色 */
      display: flex;
      /* 左右布局 */
      padding: 0;
      border: none;
      overflow: visible;
      /* 允许唱片溢出 */
      position: relative;
      /* 为了定位唱片 */
    }

    /* 3. 左侧封面区：用伪元素画出深色背景，不污染HTML */
    #music-widget-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 120px;
      /* 和高度一样，是个正方形 */
      background-color: #4a4a4a;
      border-radius: 6px 0 0 6px;
      /* ▼▼▼ 在这里加上下面两行 ▼▼▼ */
      background-size: cover;
      background-position: center;
    }

    /* 4. 专辑封面本体 (旧唱片改造) */

    #widget-cover-art {
      position: absolute;
      top: 15px;
      left: 15px;
      width: 90px;
      height: 90px;
      z-index: 2;
      /* 确保它在唱片之上 */
      /* ▼▼▼ 下面都是我新增的，给我看好了 ▼▼▼ */
      border-radius: 4px;
      /* 封面本身的小圆角 */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      background-size: cover;
      background-position: center;
      transition: background-image 0.3s ease;
      /* 让封面切换更柔和 */
    }

    /* 5. 封面图片 (旧唱片贴纸改造) */
    #widget-cover-art::before {
      width: 100%;
      height: 100%;
      border-radius: 4px;
      /* 和封面一致 */
      border: none;
      background-image: var(--widget-cover-image, none);
      background-size: cover;
      background-position: center;
    }

    /* 6. 唱片？用另一个伪元素从后面伸出来就行了，简单 */
    #widget-cover-art::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 90px;
      height: 90px;
      border-radius: 50%;
      z-index: -1;
      display: block;
      border: none;

      /* 哼，看好了，这才叫唱片 */
      background-color: #2a2a2a;
      /* 1. 先铺一层唱片的深灰色底 */
      background-image:
        /* 2. 然后在上面画中间的标签和洞，颜色我都给你配好了 */
        radial-gradient(circle at center, #111 4%, transparent 5%),
        radial-gradient(circle at center, #985c5c 5%, #7a4949 25%, transparent 26%),
        /* 3. 再画上一圈圈的光泽纹理，这才像样 */
        repeating-radial-gradient(circle at center,
          rgba(255, 255, 255, 0.04) 0,
          rgba(255, 255, 255, 0.04) 1px,
          transparent 1px,
          transparent 3px);
      transform: translateX(0%) scale(1.05);
      /* 微调了下位置和大小，这样更协调 */
      transition: opacity 0.3s ease;
      /* 加上这个，为了后面让它优雅地消失 */
      /* 4. 位置也给你微调了一下，现在顺眼多了 */
    }

    /* ▼▼▼ 这是全新的代码，给我加上！▼▼▼ */
    #music-widget-card.is-playing #widget-cover-art {
      /* 播放时，方形舞台的背景就是封面了，所以不需要我画的唱片了 */
      background-image: none;
    }

    #music-widget-card.is-playing::before {
      background-image: var(--widget-cover-image, none);
    }

    #music-widget-card.is-playing #widget-cover-art::after {
      /* 播放时，让唱片旋转起来，哼 */
      animation: spin 8s linear infinite;
    }

    /* 默认状态下，方形舞台的背景是透明的，这样才能看到我画的唱片 */
    #music-widget-card:not(.is-playing) #widget-cover-art {
      background-image: none;
    }

    /* 7. 右侧内容区 (旧覆盖层改造) */
    .widget-content-overlay {
      position: static;
      flex-grow: 1;
      /* 占满右侧所有空间 */
      /* 把旧的 background: #ffffff; 删掉！换成下面这两行！*/
      background: var(--card-bg);
      /* 1. 用我们主题里那个早就定义好的半透明背景 */

      /* 纯白背景 */
      border-radius: 0 6px 6px 0;
      padding: 15px;
      display: flex;
      flex-direction: column;
      /* 垂直布局 */
      justify-content: space-between;
      /* <--- 哼，加上这句圣旨 */
      box-sizing: border-box;
      position: relative;
      /* 为了定位假的分享按钮 */
      background: var(--card-bg);
      color: var(--text-color);
      margin-left: 120px;
    }


    /* 8. 歌曲信息 (标题和作者) */
    #music-widget .widget-info {
      color: #333;
      text-shadow: none;

      /* 占据上半部分空间 */
    }

    #music-widget .widget-info #widget-title {
      font-size: 1.1rem;
      font-weight: 500;
      color: #000;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.8rem;
      color: #888;
    }

    /* 9. 假的歌词和进度条，用伪元素画出来 */
    #music-widget .widget-info::after {
      /* 假的歌词 */
      display: block;
      font-size: 0.75rem;
      color: #65c468;
      /* 绿色 */
      margin-top: 8px;
      padding-bottom: 8px;
      background-image:
        linear-gradient(to right, #666 40%, #ddd 40%),
        /* 假的进度条 */
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12"><path fill="%23aaa" d="M0 10h2V2H0v8zm3 2h2V0H3v12zm3-4h2V4H6v4zm3 2h2V2H9v8zm3-3h2V5h-2v4z"/></svg>');
      /* 假的EQ图标 */
      background-repeat: no-repeat, no-repeat;
      background-position: bottom, 90% bottom;
      background-size: 100% 1px, 16px 12px;
      border-bottom: 1px solid #eee;
    }

    /* 10. 真的控制按钮区域 */
    #widget-controls {
      display: flex;
      justify-content: flex-start;
      /* 从左边开始排列 */
      align-items: center;
      gap: 15px;
      padding-top: 10px;
      position: relative;
      /* 为了定位假的删除和喜欢按钮 */
      width: 100%;
    }

    /* 11. 真的播放/暂停/下一首按钮的样式 */
    #widget-controls button {
      font-size: 1.1rem;
      color: #555;
      background: none;
      border: 1px solid #ccc;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      line-height: 28px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      order: 1;
      /* 把真的按钮放在中间 */
    }

    #widget-play-pause-btn {
      width: 32px;
      /* 播放按钮大一点 */
      height: 32px;
      line-height: 32px;
      font-size: 1.2rem;
    }

    /* 12. 哼，看好了，这才是不会出错的矢量图标，免得你那破手机又自作聪明 */
    #widget-controls::before,
    #widget-controls::after {
      content: '';
      /* 删掉那些讨厌的emoji源头 */
      display: block;
      width: 16px;
      /* 给图标一个精确的尺寸 */
      height: 16px;
      background-color: #aaa;
      /* 这就是图标的颜色，哼 */
      position: absolute;

      /* 下面是魔法，反正你也看不懂 */
      -webkit-mask-repeat: no-repeat;
      mask-repeat: no-repeat;
      -webkit-mask-position: center;
      mask-position: center;
      -webkit-mask-size: contain;
      mask-size: contain;
    }

    #widget-controls::before {
      /* 删除图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      right: 29px;
      /* 稍微调整一下位置，让它更协调 */
      top: 60%;
      transform: translateY(-50%);
    }

    #widget-controls::after {
      /* 喜欢图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      right: 1px;
      top: 60%;
      transform: translateY(-50%);
    }

    /* --- Noir's iOS Industrial Button Refactor --- */
    /* 哼，看好了，这才是专业设备该有的开关。*/

    /* --- Noir's Ultimate Dynamic Button System v3.0 --- */
    /* 哼，现在它们都听我的了。*/

    /* 1. 按钮的基础“模具”，所有按钮都用这个 */
    .form-button {
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: filter 0.15s ease, background-color 0.2s ease;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      /* 加个细微的阴影 */
      color: white;
      /* 默认文字都是白色 */
    }

    .form-button:active {
      filter: brightness(0.9);
    }

    .form-button:disabled {
      background-color: #ccc !important;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* 2. 主要操作按钮 (继承主题强调色) */
    .form-button.primary,
    /* 你可以给蓝色的按钮加上 primary 类，或者不管它也行 */
    #save-api-settings-button,
    /* 把几个主要的按钮ID也直接指定了，免得你改漏 */
    #save-user-profile-button,
    #save-char-button,
    #save-world-book-button,
    #save-group-settings-button,
    #save-friend-circle-button {
      background-color: var(--accent-color);
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    }

    /* 3. 次要操作按钮 (用主题里的卡片背景色，这才叫和谐) */
    .form-button.secondary {
      background-color: var(--card-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
    }

    /* 4. 危险操作按钮 (动态的红色，这才叫高级) */
    .form-button.destructive {
      /* 哼，看好了，这个红色的亮度和饱和度，会随着你主题的明暗变化而变化！*/
      background-color: hsl(5, 75%, calc(var(--primary-lightness) / 1.8 + 25%));
    }

    /* 5. 警告操作按钮 (动态的黄色，也一样) */
    .form-button.warning {
      background-color: hsl(40, 90%, calc(var(--primary-lightness) / 2.2 + 25%));
      color: #5d4000;
    }

    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */

    /* 1. Dock栏的样式 */
    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */
    #home-dock {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 85px;
      padding: 0 20px;
      /* 图标左右的留白 */
      box-sizing: border-box;

      /* 背景和滤镜，现在都在这里 */
      background: var(--surface-bg);
      backdrop-filter: blur(5px) saturate(0.8);
      -webkit-backdrop-filter: blur(15px) saturate(0.8);
      border-radius: 28px;
      z-index: 35;

      /* 核心：用Flexbox来自动排列图标 */
      display: flex;
      justify-content: space-around;
      /* 均匀分布 */
      align-items: center;
      /* 垂直居中 */
      padding-top: 9px;
    }

    #home-dock .app-icon {
      position: static;
      /* 取消绝对定位，让它接受Flexbox的管理 */
    }

    /* 2. App图标的“整容手术” */
    .app-icon-img {
      width: 58px;
      /* 图标背景尺寸 */
      height: 58px;
      border-radius: 22.5%;
      /* iOS标志性的“方圆”形 */
      font-size: 28px;
      /* 阴影从图标本身移到背景上，更统一 */
      background-color: var(--surface-bg);
      box-shadow: none;
      /* 删掉旧的阴影 */
      transition: transform 0.2s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
      /* 按下时图标有反馈 */
    }

    /* --- Noir's Minimalist Home Screen Makeover (v2.0 Dynamic Edition) --- */
    /* 哼，现在这些家伙也听从总开关的指挥了。*/

    /* 1. 时钟和日期 */
    #home-clock-container {
      color: var(--text-color);
      text-shadow: none;
    }

    #home-date {
      opacity: 0.7;
    }

    /* 2. App图标的改造 (现在是动态颜色了) */
    .app-icon span {
      color: var(--text-color);
      text-shadow: none;
      font-weight: 500;
    }

    .app-icon-img {
      background-color: var(--card-bg);
      /* <-- 哼，接上了！*/
      color: var(--text-color-light);
      /* <-- 接上了！*/
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* 3. Dock栏的颜色 (也动态了) */




    #widget-controls button,
    #music-widget .widget-info #widget-title,
    #music-widget .widget-info #widget-artist {
      color: var(--text-color);
    }

    /* ... 在第 2262 行附近 ... */
    /* ▼▼▼ 把旧的 #widget-cover-art::after 整个删掉，换成下面这个 ▼▼▼ */

    /* ▲▲▲ 替换到这里结束 ▲▲▲ */

    /* --- Noir's Theme Preset Buttons --- */
    /* 哼，每个按钮都是一件艺术品。 */
    .theme-preset-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 20px;
      /* 胶囊形状 */
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card-bg);
    }

    .theme-preset-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--soft-shadow);
    }

    .preset-color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    /* --- Noir's Memory Archive Styles --- */
    #summary-textarea {
      width: 100%;
      height: 100%;
      border: none;
      outline: none;
      resize: none;
      padding: 15px;
      box-sizing: border-box;
      font-family: 'Courier New', monospace;
      /* 用等宽字体，YAML格式才好看 */
      font-size: 0.85rem;
      line-height: 1.6;
      background-color: #fdfdfd;
      color: var(--text-color);
    }

    /* --- Noir's Desktop Pagination System --- */
    /* 哼，看好了，这才叫设计。*/

    /* 1. 把主内容区变成一个灵活的容器，为翻页器和指示器留好位置 */
    #home-screen-main-content {
      display: flex;
      flex-direction: column;
      /* 垂直排列，页面在上面，指示器在下面 */
    }

    /* 2. 这是翻页的“舞台”，它的大小和主屏幕一样，但会把超出部分藏起来 */
    #app-pages-container {
      flex-grow: 1;
      /* 占满除了指示器以外的所有空间 */
      width: 100%;
      overflow: hidden;
      /* 核心！把第二页先藏起来 */
      position: relative;
      /* 让里面的滑块能相对于它定位 */
    }

    /* 3. 这是真正滑动的“滑块”，它有两页那么宽 */
    #app-pages-slider {
      width: 200%;
      /* 两页的宽度 */
      height: 100%;
      display: flex;
      /* 核心！让两页并排站好 */
      transition: transform 0.35s cubic-bezier(0.25, 0.1, 0.25, 1);
      /* 翻页动画，给你选了个高级点的曲线 */
    }

    /* 4. 每一页的样式 */
    .app-page {
      width: 50%;
      /* 每页占滑块的一半，也就是一个屏幕的宽度 */
      height: 100%;
      flex-shrink: 0;
      /* 防止被挤压 */
      position: relative;
      /* 让你放在里面的绝对定位图标有家可回 */
    }

    /* 5. 页面指示器（小点点）的容器 */
    #home-page-indicator {
      position: absolute;
      bottom: 105px;
      /* 放在Dock栏正上方，给你算好了距离 */
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      /* 点点之间的距离 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    /* 6. 每个小点点的样式 */
    .page-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(2px);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    /* 7. 当前页的小点点，给它变亮变大一点 */
    .page-dot.active {
      background-color: rgba(255, 255, 255, 0.9);
      transform: scale(1.1);
    }

    #card-widget-2 {
      width: 165px;
      /* 尺寸和原来保持一致 */
      height: 165px;
      border-radius: 22px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      overflow: hidden;
    }

    #card-widget-2:active {
      transform: scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget-2 img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .theme-widget {
      width: 65px;
      height: 65px;
      border-radius: 22px;
      /* 跟你的卡片圆角差不多 */
      box-shadow: var(--soft-shadow);
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      background: linear-gradient(45deg,
          hsla(var(--primary-hue), var(--primary-saturation), var(--primary-lightness), 0.7),
          hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.3), calc(var(--primary-lightness) - 15%), 0.8));
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* --- Noir's Galgame Sprite Adjuster Styles --- */

    /* --- Noir's Slider Control Panel Styles --- */
    .sprite-slider-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 5px;
    }

    .sprite-slider-group label {
      color: white;
      font-size: 0.8rem;
      width: 60px;
      /* 让标签对齐，好看点 */
      flex-shrink: 0;
    }

    .sprite-slider-group input[type="range"] {
      flex-grow: 1;
      /* 占满剩余空间 */
      margin: 0;
      padding: 0;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Accounting App Styles --- */
    #daily-expenses-list .expense-item {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background-color: var(--card-bg);
      border-radius: 8px;
      margin-bottom: 8px;
      border: 1px solid var(--border-color);
    }

    .expense-item .description {
      font-weight: 500;
    }

    .expense-item .amount {
      font-weight: 600;
      color: var(--accent-color);
    }

    #character-reviews-container .review-card {
      display: flex;
      gap: 12px;
      background-color: var(--card-bg);
      padding: 12px;
      border-radius: 12px;
      margin-bottom: 10px;
      border: 1px solid var(--border-color);
    }

    .review-card .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .review-card .review-content .char-name {
      font-weight: 600;
      margin-bottom: 4px;
    }

    /* --- End of Styles --- */
    /* --- Noir's Accounting Tabs Style --- */
    .accounting-tabs {
      display: flex;
      background-color: var(--surface-bg);
      border-bottom: 1px solid var(--border-color);
      padding: 5px 15px 0;
      flex-shrink: 0;
    }

    .tab-button {
      flex: 1;
      padding: 10px;
      border: none;
      background: transparent;
      color: var(--text-color-light);
      font-size: 1rem;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tab-button.active {
      color: var(--accent-color);
      border-bottom: 3px solid var(--accent-color);
    }

    /* --- Noir's "WeChat Moments" Style Patch --- */
    /* 哼，这才叫社交。*/
    #music-feed-container {
      padding: 0;
      /* 容器的内边距清零，让动态贴边 */
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.95);
      /* 给整个容器一个统一的背景色 */
    }

    .music-post {
      background-color: transparent;
      /* 去掉卡片背景 */
      box-shadow: none;
      /* 去掉阴影 */
      border-radius: 0;
      /* 去掉圆角 */
      margin-bottom: 0;
      /* 去掉外边距 */
      padding: 15px;
      /* 统一内边距 */
      border-bottom: 1px solid var(--border-color);
      /* 加上底部分隔线 */
    }

    .music-post:last-child {
      border-bottom: none;
      /* 最后一条动态不需要分隔线 */
    }

    /* --- End of Patch --- */
    /* --- Noir's "Expense Eraser" Style --- */
    .delete-expense-btn {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-color-light);
      width: 22px;
      height: 22px;
      border-radius: 50%;
      cursor: pointer;
      font-weight: 600;
      line-height: 20px;
      padding: 0;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .delete-expense-btn:hover {
      background: #e65252;
      border-color: #e65252;
      color: white;
      transform: scale(1.1);
    }

    /* --- End of Eraser Style --- */

    /* --- Noir's Ultimate Snoop UI Overhaul v3.0 (FINAL & COMPLETE) --- */
    /* 哼，这是最终版本。*/

    /* 壁纸和状态栏 (哼，这才是高级的毛玻璃质感) */
    #snoop-phone-wallpaper {
      position: absolute;
      inset: 0;
      /* 删掉那个没用的图片，换成我的高级定制背景 */
      background-color: rgba(26, 26, 27, 0.9);
      /* 半透明深灰，营造高级感 */
      backdrop-filter: blur(25px) saturate(1.5);
      /* 核心！强大的模糊和饱和度滤镜 */
      -webkit-backdrop-filter: blur(25px) saturate(1.5);
      /* 兼容性，真是为你操碎了心 */
      z-index: 1;
    }

    #snoop-phone-header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: rgb(237, 236, 236);
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
      /* <-- 加了阴影 */
      z-index: 10;
    }

    /* 居中大时钟 */
    #snoop-home-clock {
      position: absolute;
      top: 18%;
      left: 50%;
      transform: translateX(-50%);
      z-index: 5;
      text-align: center;
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      /* <-- 加了阴影 */
      pointer-events: none;
    }

    #snoop-home-time {
      font-size: 72px;
      font-weight: 200;
      letter-spacing: -1px;
    }

    #snoop-home-date {
      font-size: 1rem;
      font-weight: 400;
      opacity: 0.8;
    }

    /* 主屏幕App容器 */
    #snoop-app-container {
      position: relative;
      z-index: 5;
      height: 100%;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 0 20px 120px;
    }

    /* 2x2 网格 */
    .snoop-main-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      width: 180px;
      margin: 0 auto;
    }

    /* Dock栏 */
    #snoop-dock {
      position: absolute;
      bottom: 20px;
      left: 5%;
      right: 5%;
      height: 85px;
      padding: 0 15px;
      box-sizing: border-box;
      z-index: 6;
      background: rgba(255, 255, 255, 0.15);
      /* <-- 透明度稍微降低了一点点 */
      backdrop-filter: blur(20px) saturate(1.2);
      -webkit-backdrop-filter: blur(20px) saturate(1.2);
      border-radius: 28px;
      display: flex;
      justify-content: space-around;
      align-items: center;
    }

    /* App图标本体 */
    #snoop-phone-screen .snoop-app-icon {
      position: static;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      cursor: pointer;
    }

    .snoop-app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: rgba(255, 255, 255, 0.25);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      /* <-- 加了阴影 */
      transition: transform 0.2s ease;
      padding: 12px;
      box-sizing: border-box;
    }

    .snoop-app-icon-img svg {
      width: 100%;
      height: 100%;
      stroke: white;
      stroke-width: 1.5;
      fill: none;
      /* 哼，给SVG也加上阴影，这样才够立体 */
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
    }

    .snoop-app-icon:active .snoop-app-icon-img {
      transform: scale(0.92);
    }

    .snoop-app-icon span {
      font-size: 0.75rem;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      /* <-- 加了阴影 */
      font-weight: 500;
    }

    .snoop-app-header {
      flex-shrink: 0;
      padding: 15px 20px;
      border-bottom: none;
      /* <-- 我把这条线干掉了 */
      background-color: transparent;
      /* <-- 我把背景色变透明了 */
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .snoop-app-header-title {
      font-weight: 600;
      display: flex;
      flex-direction: column;
      align-items: center;
      line-height: 1.2;
    }

    .snoop-app-header-title .main-title {
      font-size: 1rem;
    }

    .snoop-app-header-title .sub-title {
      font-size: 0.75rem;
      color: #888;
      font-weight: 400;
    }

    .snoop-app-header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: #007aff;
      min-width: 50px;
    }

    #snoop-app-back-btn {
      text-align: left;
    }

    #snoop-app-refresh-btn {
      text-align: right;
    }

    /* 哼，这才叫秩序。*/
    .snoop-app-header {
      flex-shrink: 0;
      padding: 15px 20px;
      border-bottom: 1px solid #e5e5e5;
      background-color: #f8f8f8;

      /* ▼▼▼ 核心法令！给我站成一排！▼▼▼ */
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .snoop-app-header-title {
      font-weight: 600;
      /* ▼▼▼ 让标题自己也排好队，别乱跑 ▼▼▼ */
      display: flex;
      flex-direction: column;
      align-items: center;
      line-height: 1.2;
    }

    .snoop-app-header-title .main-title {
      font-size: 1rem;
      /* 主标题大一点 */
    }

    .snoop-app-header-title .sub-title {
      font-size: 0.75rem;
      /* 副标题小一点，当备注 */
      color: #888;
      font-weight: 400;
    }

    .snoop-app-header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: #007aff;
      min-width: 50px;
      /* 保证左右两边占位宽度一致，这样中间才能完美居中 */
    }

    /* 让返回按钮靠左，刷新按钮靠右，这才叫对称美学 */
    #snoop-app-back-btn {
      text-align: left;
    }

    #snoop-app-refresh-btn {
      text-align: right;
    }

    .snoop-app-content {
      flex-grow: 1;
      /* 告诉内容区：顶栏占完位置后，剩下所有的高度都归你 */
      overflow-y: auto;
      /* 装上电梯：如果你的东西多到放不下了，就自己变出个垂直滚动条来 */
      padding: 15px;
      /* 再给你加点内边距，免得内容贴着边，丑死了 */
      box-sizing: border-box;
      /* 确保内边距不会把布局撑坏，这是专业素养 */
    }
  </style>
</head>

<body>
  <input type="file" id="audio-file-input" style="display: none;" accept=".flac,.mp3">
  <input type="file" id="cover-file-input" style="display: none;" accept=".jpg,.png,.jpeg,.webp">
  <input type="file" id="info-file-input" style="display: none;" accept=".txt">
  <input type="file" id="lyrics-file-input" style="display: none;" accept=".lrc">
  <input type="file" id="import-char-input" accept=".json,.noir" style="display: none;">
  <div id="phone-container">

    <div id="user-profile-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-user-list" class="header-button">主屏幕</button>
        <span class="header-title">选择用户</span>
        <button id="add-user-profile-button" class="header-button add" title="添加新用户">+</button>
      </div>
      <div class="content" id="user-profile-list-container">
      </div>
    </div>

    <div id="user-profile-screen" class="screen">
      <div class="header">
        <button id="back-to-user-list-from-edit" class="header-button">返回</button>
        <span id="user-profile-edit-title" class="header-title">编辑用户</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-user-id">
        <div class="settings-group">
          <h2>用户设定</h2>
          <div class="input-group">
            <label for="user-name">你的名字</label>
            <input type="text" id="user-name" placeholder="你的显示名字">
          </div>
          <div class="avatar-upload-group">
            <label>你的头像</label>
            <img id="user-avatar-preview" class="avatar-preview" alt="User Avatar Preview">
            <input type="file" id="user-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="user-persona">你的人设 (可选)</label>
            <textarea id="user-persona" placeholder="向AI介绍你自己。例如：我是一名大学生，喜欢摄影和旅行。"></textarea>
          </div>
        </div>
        <button id="save-user-profile-button" class="form-button">保存资料</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="set-active-user-button" class="form-button"
            style="background-color: #28a745; margin-bottom: 10px;">设为当前用户</button>
          <button id="delete-user-profile-button" class="form-button destructive">删除该用户</button>
        </div>
      </div>
    </div>


    <div id="home-screen" class="screen active">
      <div id="home-screen-main-content"
        style="position: relative; flex-grow: 1; width: 100%; display: flex; flex-direction: column;">

        <div id="app-pages-container">
          <div id="app-pages-slider">

            <div class="app-page" id="app-page-1">
              <div id="home-clock-container">
                <div id="home-time">11:31</div>
                <div id="home-date">8月29日 星期五</div>
                <div id="noir-author-mark"></div>
              </div>

              <div id="music-widget"
                style="  display: inline-block; width: auto; position: absolute; top: 45%; left: 50%; transform: translateX(-50%); z-index: 50;; padding: 0px;bottom: auto;">
                <div id="music-widget-card">
                  <div id="widget-cover-art"></div>

                  <div class="widget-content-overlay">
                    <div class="widget-info">
                      <div id="widget-title">暂无音乐</div>
                      <div id="widget-artist">请在动态或聊天中播放</div>
                    </div>
                    <div id="widget-controls">
                      <button id="widget-prev-btn">⏮</button>
                      <button id="widget-play-pause-btn">▶</button>
                      <button id="widget-next-btn">⏭</button>
                    </div>
                  </div>
                </div>
              </div>

            </div>

            <div class="app-page" id="app-page-2">
              <div id="decorative-badge" style="display: none; position: absolute; top: 250px; left: 50px;">
                <img id="badge-image" src="http://googleusercontent.com/file_content/0" alt="badge">
              </div>

              <div id="card-widget" style="display: none; position: absolute; top: 140px; left: 145px;">
                <img id="card-image" src="" alt="card widget">
              </div>
              <div id="card-widget-2" style="display: none; position: absolute;">
                <img id="card-image-2" src="" alt="card widget 2">
              </div>





              <div class="app-icon" id="app-world-book">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                  </svg></div>
                <span>世界书</span>
              </div>


              <div class="app-icon" id="app-diary">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <path d="M2.5 17a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zM2.5 14a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
                  </svg></div>
                <span>交换日记</span>
              </div>

              <div class="app-icon" id="app-music-library">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                    <path
                      d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                    </path>
                  </svg></div>
                <span>音乐库</span>
              </div>


              <div class="app-icon" id="app-settings">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
                    </path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg></div>
                <span>API设置</span>
              </div>
              <div class="app-icon" id="app-user-profiles">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg></div>
                <span>我</span>
              </div>
              <div class="app-icon" id="app-wallpaper">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12 2.69l.34.34a1.41 1.41 0 0 0 2 0L22 6.34a1.41 1.41 0 0 0 0-2l-7.66-7.66a1.41 1.41 0 0 0-2 0L2.68 14.34a1.41 1.41 0 0 0 0 2L10 24l2-2 2-2 2-2 2-2 2-2">
                    </path>
                    <path d="m7.34 2.66 14 14"></path>
                  </svg></div>
                <span>更换壁紙</span>
              </div>

              <div class="app-icon" id="app-snoop">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                  </svg></div>
                <span>视奸</span>
              </div>
              <div class="app-icon" id="app-accounting">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                  </svg></div>
                <span>记账</span>
              </div>

              <div id="home-dock">
                <div class="app-icon app-icon-large" id="app-chat">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg></div>
                  <span>聊天</span>
                </div>
                <div class="app-icon" id="app-music">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M9 18V5l12-2v13"></path>
                      <circle cx="6" cy="18" r="3"></circle>
                      <circle cx="18" cy="16" r="3"></circle>
                    </svg></div>
                  <span>动态</span>
                </div>
                <div class="app-icon" id="app-meeting">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M14 9a2 2 0 0 1-2 2H6l-4 4V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4Z" />
                      <path d="M18 9h2a2 2 0 0 1 2 2v9l-4-4h-2a2 2 0 0 1-2-2V9Z" />
                    </svg></div>
                  <span>见面</span>
                </div>
              </div>
            </div>

          </div>
        </div>

        <div id="home-page-indicator">
          <span class="page-dot active" data-page="0"></span>
          <span class="page-dot" data-page="1"></span>
        </div>

      </div>

    </div>

    <div id="chat-screen" class="screen">
      <div id="chat-screen-container">
        <div id="chat-list-pane">
          <div id="chat-list-header">
            <button id="back-to-home-from-chat" class="header-button">主屏幕</button>
            <span class="header-title">聊天</span>
            <button id="add-chat-button" class="header-button add" title="添加新聊天">+</button>
          </div>
          <div id="chat-list-container">
            <ul id="character-list">
            </ul>
          </div>
        </div>
        <div id="chat-view-pane">
          <div class="header">
            <button class="header-button" id="back-to-chat-list">返回</button>
            <span id="char-name-header" class="header-title">角色</span>
            <button class="header-button" id="character-settings-button" title="角色设置">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                </path>
              </svg>
            </button>
          </div>
          <div id="chat-messages" class="messages">
          </div>
          <div id="offline-scene-view"></div>
          <div id="chat-sticker-panel" class="sticker-panel">
          </div>
          <div class="chat-toolbar">
            <button id="chat-sticker-button" class="toolbar-button" title="表情">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5-2 4-2 4 2 4 2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
            </button>
            <button id="chat-image-button" class="toolbar-button" title="发送图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <button id="chat-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
            <button id="chat-listen-together-button" class="toolbar-button" title="一起听">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path
                  d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                </path>
              </svg>
            </button>
            <button id="chat-transfer-button" class="toolbar-button" title="转账">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </button>
            <button id="chat-reroll-button" class="toolbar-button" title="重新生成">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
            <button id="chat-summarize-button" class="toolbar-button" title="总结聊天记录">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
          </div>
          <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
          <div id="quote-preview-area" class="quote-preview">
            <div class="quote-preview-content">
              <div id="quote-preview-sender"></div>
              <div id="quote-preview-text"></div>
            </div>
            <button id="cancel-quote-button" class="cancel-quote-btn">&times;</button>
          </div>
          <div class="chat-input-area">
            <div id="chat-input-wrapper">
              <input type="text" id="chat-message-input" placeholder="输入消息...">
              <button id="chat-get-reply-button" title="让对方回复">↵</button>
              <button id="chat-send-button" title="发送">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="settings-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-settings" class="header-button">返回</button>
        <span class="header-title">API设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>API 设置</h2>
          <div class="input-group">
            <label for="api-endpoint">API 接口地址（不填/v1）</label>
            <input type="text" id="api-endpoint" placeholder="例如: https://api.openai.com">
          </div>
          <div class="input-group">
            <label for="api-key">API 密钥</label>
            <input type="password" id="api-key" placeholder="请输入你的 API 密钥">
          </div>
          <div class="input-group">
            <label for="api-model">模型</label>
            <div class="model-input-container">
              <input type="text" id="api-model" placeholder="点击 获取 或手动输入" style="flex-grow: 1;">
              <button id="fetch-models-button" style="padding: 0 12px; white-space: nowrap;">获取</button>
              <div id="model-dropdown" class="custom-model-dropdown"></div>
            </div>
          </div>
          <div class="input-group">
            <label for="api-provider">接口格式 (重要！请根据你使用的接口选择，但是我也没做Openai以外的接口……)</label>
            <select id="api-provider"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);">
              <option value="openai">OpenAI 格式 (通用，兼容绝大多数反代)</option>
              <option value="gemini">Google Gemini 格式 (仅限官方或特定反代)</option>
              <option value="anthropic">Anthropic Claude 格式</option>
            </select>
          </div>
        </div>
        <div class="settings-group">
          <h2>上下文设置</h2>
          <div class="input-group">
            <label for="context-lines-per-chat">每个会话读取的消息条数（默认 100）</label>
            <input type="number" id="context-lines-per-chat" min="1" max="1000000" step="1" placeholder="100">
          </div>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>数据管理</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            导出全部数据（角色、聊天记录、设置、桌面布局等）到一个文件，方便在其他设备或浏览器上导入。
          </p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="export-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #007bff;">导出全部数据</button>
            <button id="import-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #28a745;">导入数据</button>
          </div>
          <input type="file" id="import-data-input" accept=".json" style="display: none;">
        </div>
        <button id="save-api-settings-button" class="form-button">保存 API 设置</button>
      </div>
    </div>



    <div id="character-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-edit" class="header-button">返回</button>
        <span id="character-edit-title" class="header-title">编辑角色</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-char-id">
        <div class="settings-group">
          <h2>角色设定</h2>
          <div class="input-group">
            <label for="char-edit-name">名字</label>
            <input type="text" id="char-edit-name" placeholder="角色的名字">
          </div>
          <div class="input-group">
            <label for="char-edit-remark">备注名</label>
            <input type="text" id="char-edit-remark" placeholder="方便自己记忆，例如 '工作助理'">
          </div>
          <div class="avatar-upload-group">
            <label>角色头像</label>
            <img id="char-edit-avatar-preview" class="avatar-preview" alt="Avatar Preview">
            <input type="file" id="char-edit-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-persona">人设 (系统提示词)</label>
            <textarea id="char-edit-persona" placeholder="你是一个乐于助人的助手。"></textarea>
          </div>
          <div class="input-group">
            <label>聊天壁纸</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-wallpaper-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="聊天壁纸预览">
            </div>
            <input type="file" id="char-edit-wallpaper-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-css">专属气泡样式 (CSS)</label>
            <textarea id="char-edit-css" rows="8"
              placeholder="从其他地方复制的、包含 .sent 和 .received 的CSS代码可以直接粘贴在这里..."></textarea>

            <div style="display: flex; gap: 10px; margin-top: 5px;">
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">TA的气泡 (Received):</p>
                <div id="bubble-preview-ai" class="message ai">这是TA的气泡预览效果</div>
              </div>
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">你的气泡 (Sent):</p>
                <div id="bubble-preview-user" class="message user">这是你的气泡预览效果</div>
              </div>
            </div>
          </div>
          <div class="input-group">
            <label>见面场景背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-offline-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="见面背景预览">
            </div>
            <input type="file" id="char-edit-offline-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="settings-group">
            <h2>角色立绘 (Galgame模式)</h2>
            <p style="font-size: 0.8rem; color: var(--text-color-light);">为五种核心情绪上传立绘图，建议使用透明背景的PNG图片。</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px;">

              <div class="avatar-upload-group" style="align-items: center;">
                <label>平常</label>
                <img id="char-edit-sprite-normal-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="平常立绘">
                <input type="file" id="char-edit-sprite-normal-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>喜</label>
                <img id="char-edit-sprite-happy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="喜立绘">
                <input type="file" id="char-edit-sprite-happy-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>怒</label>
                <img id="char-edit-sprite-angry-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="怒立绘">
                <input type="file" id="char-edit-sprite-angry-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>哀</label>
                <img id="char-edit-sprite-sad-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="哀立绘">
                <input type="file" id="char-edit-sprite-sad-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>害羞</label>
                <img id="char-edit-sprite-shy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="害羞立绘">
                <input type="file" id="char-edit-sprite-shy-input" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-bind-user">绑定用户</label>
            <select id="char-edit-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="world-book-checkboxes-container" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="export-char-button" class="form-button secondary" style="margin-top: 20px;">导出角色卡</button>
        <button id="save-char-button" class="form-button">保存角色</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="edit-clear-history-button" class="form-button warning"
            style="margin-bottom: 10px;">清空聊天记录</button>
          <button id="edit-delete-char-button" class="form-button" class="form-button destructive">删除角色</button>
        </div>
      </div>
    </div>

    <div id="group-chat-create-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-group-create" class="header-button">返回</button>
        <span class="header-title">创建群聊</span>
        <button id="create-group-chat-button" class="header-button">创建</button>
      </div>
      <div class="content" style="padding: 20px;">
        <div class="input-group">
          <label for="group-chat-name">群聊名称</label>
          <input type="text" id="group-chat-name" placeholder="给你的群聊起个名字">
        </div>
        <div class="settings-group">
          <h2>选择成员</h2>
          <div id="group-chat-member-list-container"
            style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
            <ul id="group-chat-member-list">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div id="wallpaper-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-wallpaper" class="header-button">返回</button>
        <span class="header-title">更换壁纸</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2>全局主题色</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">拖动滑块来改变整个App的主色调。</p>
          <div class="input-group" style="padding-top: 10px;">
            <label for="theme-hue-slider" style="display: block; margin-bottom: 5px;">色相 (Hue)</label>
            <input type="range" id="theme-hue-slider" min="0" max="360" value="35" style="width: 100%;">
          </div>
          <div class="input-group">
            <label for="theme-lightness-slider" style="display: block; margin-bottom: 5px;">明度 (Lightness)</label>
            <input type="range" id="theme-lightness-slider" min="15" max="95" value="80" style="width: 100%;">
          </div>
        </div>
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2 style="margin-top: 0;">时钟样式</h2>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="clock-color-toggle" style="width: auto; height: 18px; flex-shrink: 0;">
            <label for="clock-color-toggle" style="width: auto; font-size: 0.9rem;">强制使用纯白色时钟 (推荐在深色壁纸下使用)</label>
          </div>
        </div>
        <div class="settings-group">
          <h2>上传新壁纸</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">选择一张图片作为你的手机壁纸。为了效果最好，请使用竖屏图片。</p>
          <input type="file" id="wallpaper-input" accept="image/*" style="display: none;">
          <button id="upload-wallpaper-button" class="form-button">选择图片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>音乐小组件背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的主屏幕音乐小组件设置一张专属背景图。</p>
          <input type="file" id="widget-bg-input" accept="image/*" style="display: none;">
          <button id="upload-widget-bg-button" class="form-button">选择图片</button>
          <button id="reset-widget-bg-button" class="form-button secondary">恢复默认</button>
        </div>
        <div class="settings-group" style="margin-top: 20px;">
          <h2>重置桌面</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">此操作会将所有桌面小组件（时钟、音乐、徽章等）恢复到初始位置，并将壁纸重置为纯白色。</p>
          <button id="reset-desktop-button" class="form-button destructive">重置桌面布局</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义徽章</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面徽章，可以拖动它到任意位置。</p>
          <input type="file" id="badge-input" accept="image/*" style="display: none;">
          <button id="upload-badge-button" class="form-button">选择徽章图片</button>
          <button id="reset-badge-button" class="form-button secondary" style="margin-top: 10px;">移除徽章</button>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面方形卡片小组件。</p>
          <input type="file" id="card-input" accept="image/*" style="display: none;">
          <button id="upload-card-button" class="form-button">选择卡片图片</button>
          <button id="reset-card-button" class="form-button secondary" style="margin-top: 10px;">移除卡片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片 2</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的第二个桌面方形卡片小组件上传图片。</p>
          <input type="file" id="card-input-2" accept="image/*" style="display: none;">
          <button id="upload-card-button-2" class="form-button">选择卡片图片</button>
          <button id="reset-card-button-2" class="form-button secondary" style="margin-top: 10px;">移除卡片
            2</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>动态页背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为“动态”页面设置一张独立的背景图，让它与众不同。</p>
          <input type="file" id="feed-bg-input" accept="image/*" style="display: none;">
          <button id="upload-feed-bg-button" class="form-button">选择图片</button>
        </div>
        <button id="reset-feed-bg-button" class="form-button secondary" style="margin-top: 10px;">移除背景</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>小组件救援</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">如果你的吧唧或卡片不小心飞出屏幕找不到了，点这里让它们回家。</p>
          <button id="reset-widgets-position-button" class="form-button warning">重置小组件位置</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义全局字体</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            上传一个 .ttf 字体文件来改变整个App的显示字体。注意，部分特殊字体可能会导致显示异常。
          </p>
          <div id="font-preview-area"
            style="padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; margin-top: 10px; background: var(--card-bg);">
            <span id="font-preview-text" style="font-size: 1.2rem;">你好，世界 (Hello, World)</span>
          </div>
          <input type="file" id="font-input" accept=".ttf" style="display: none;">
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="upload-font-button" class="form-button" style="margin-top: 0;">选择字体</button>
            <button id="remove-font-button" class="form-button secondary" style="margin-top: 0;">恢复默认</button>
          </div>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义App图标</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">替换主屏幕上App的默认图标。为了最佳效果，请使用方形、透明背景的图片。</p>
          <div class="settings-group"
            style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
            <h2>自定义表情包</h2>
            <p style="font-size: 0.9rem; color: var(--text-color-light);">
              在这里追加你的专属表情包。每个表情占一行，格式为：<br>
              <b>表情名--图片URL</b><br>
              例如：<br>
              <code>开心--https://example.com/happy.png</code><br>
              <code>难过--https://example.com/sad.gif</code>
            </p>
            <textarea id="custom-stickers-input" rows="8" placeholder="请按指定格式粘贴..."></textarea>
            <button id="save-custom-stickers-button" class="form-button" style="margin-top: 5px;">保存并刷新表情包</button>
          </div>
          <div id="custom-icon-list-container">
          </div>
          <div id="custom-icon-list-container">
          </div>
        </div>
      </div>

    </div>

    <div id="world-book-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-world-book" class="header-button">主屏幕</button>
        <span class="header-title">世界书</span>
        <button id="add-world-book-button" class="header-button add" title="添加新世界书">+</button>
      </div>
      <div class="content" id="world-book-list-container">
      </div>
    </div>

    <div id="world-book-editor-screen" class="screen">
      <div class="header">
        <button id="back-to-world-book-list" class="header-button">返回</button>
        <span id="world-book-editor-title" class="header-title">编辑条目</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-world-book-id">
        <div class="settings-group">
          <h2>设定条目</h2>
          <div class="input-group">
            <label for="world-book-edit-name">条目名称 (Key)</label>
            <input type="text" id="world-book-edit-name" placeholder="例如：我的过去、特殊能力">
          </div>
          <div class="input-group">
            <label for="world-book-edit-content">条目内容 (Value)</label>
            <textarea id="world-book-edit-content" placeholder="输入详细的设定内容..."></textarea>
          </div>
        </div>
        <button id="save-world-book-button" class="form-button">保存条目</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="delete-world-book-button" class="form-button destructive">删除该条目</button>
        </div>
      </div>
    </div>

    <div id="group-settings-screen" class="screen">
      <div class="header">
        <button id="back-to-chat-from-group-settings" class="header-button">返回</button>
        <span class="header-title">群聊设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>群聊信息</h2>
          <div class="input-group">
            <label for="group-settings-name">群聊名称</label>
            <input type="text" id="group-settings-name">
          </div>
          <div class="avatar-upload-group">
            <label>群头像</label>
            <img id="group-avatar-preview" class="avatar-preview" alt="Group Avatar Preview">
            <input type="file" id="group-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label>群聊背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="group-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="群聊背景预览">
            </div>
            <input type="file" id="group-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="group-settings-bind-user">绑定用户</label>
            <select id="group-settings-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="group-world-book-checkboxes" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-group-settings-button" class="form-button">保存设置</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="group-clear-history-button" class="form-button warning"
            style=" margin-bottom: 10px;">清空聊天记录</button>
          <button id="group-delete-button" class="form-button destructive">删除并解散群聊</button>
        </div>
      </div>
    </div>

    <div id="music-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-feed" class="header-button">返回</button>
        <span id="friend-circle-title" class="header-title">好友圈</span>
        <div style="display: flex; gap: 5px;">
          <button id="edit-current-circle-button" class="header-button" style="font-size: 1.2rem;">⚙️</button>
          <button id="clear-feed-button" class="header-button" style="color: #dc3545;">清空</button>
          <button id="refresh-feed-button" class="header-button">刷新</button>

        </div>
      </div>
      <div id="user-post-area"
        style="padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background: var(--surface-bg);">
        <div id="user-post-input-container">
          <img id="user-post-avatar" class="char-avatar">
          <div id="user-post-main-area">
            <textarea id="user-post-textarea" rows="3" placeholder="分享你的新鲜事..."></textarea>
            <div id="user-post-attachment-preview"></div>
          </div>
        </div>
        <div id="user-post-toolbar">
          <div id="user-post-actions" class="user-post-actions">
            <button id="user-post-image-button" class="toolbar-button" title="分享图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <input type="file" id="user-post-image-input" accept="image/*" style="display: none;">
            <button id="user-post-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
          </div>
          <button id="user-send-post-button">发送</button>
        </div>
      </div>
      <div id="music-feed-container" class="content" style="padding: 10px;">
      </div>
      <div id="music-player-bar" class="hidden">
        <img id="player-cover" src="">
        <div id="player-info">
          <div id="player-title"></div>
          <div id="player-artist"></div>
        </div>
        <div id="player-controls">
          <button id="player-prev-btn">⏮</button>
          <button id="player-play-pause-btn">▶</button>
          <button id="player-next-btn">⏭</button>
        </div>
      </div>
      <audio id="audio-player"></audio>
    </div>
    <div id="meeting-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-meeting-list" class="header-button">主屏幕</button>
        <span class="header-title">选择见面对象</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="meeting-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="meeting-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-meeting-list">返回</button>
        <span id="meeting-char-name-header" class="header-title">角色</span>
        <button id="toggle-meeting-view-button" class="header-button">切换视角</button>

      </div>
      <div id="meeting-main-content" class="content" style="position: relative; padding: 0;">
        <div id="galgame-overlay-ui">
          <div id="galgame-time">12:00</div>
          <div id="galgame-date">1月1日 星期一</div>
        </div>
        <div id="galgame-sprite-adjust-ui"
          style="position: absolute; top: 20px; right: 20px; z-index: 11; display: none;">
          <button id="sprite-adjust-button" class="toolbar-button" title="调整立绘位置">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 7h-9" />
              <path d="M14 17H5" />
              <circle cx="17" cy="17" r="3" />
              <circle cx="8" cy="7" r="3" />
            </svg>
          </button>
        </div>

        <div id="galgame-sprite-controls"
          style="display: none; position: absolute; bottom: 15px; left: 15px; right: 15px; z-index: 1001; background: rgba(0,0,0,0.7); backdrop-filter: blur(8px); border-radius: 12px; padding: 15px; box-shadow: 0 -2px 15px rgba(0,0,0,0.3);">
          <div class="sprite-slider-group">
            <label for="sprite-slider-x">左右位置</label>
            <input type="range" id="sprite-slider-x" min="0" max="100" value="50">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-y">上下位置</label>
            <input type="range" id="sprite-slider-y" min="0" max="130" value="100">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-scale">缩放大小</label>
            <input type="range" id="sprite-slider-scale" min="50" max="200" value="100">
          </div>
          <div style="display: flex; gap: 10px; margin-top: 15px;">
            <button id="sprite-confirm-button" class="form-button">确定</button>
            <button id="sprite-cancel-button" class="form-button secondary">取消</button>
            <button id="sprite-reset-button" class="form-button destructive"
              style="padding: 10px 12px; width: auto; font-size: 1.2rem;">⟲</button>
          </div>
        </div>
        <div id="meeting-scene-view" class="content"
          style="font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.7);">
        </div>
        <div id="galgame-view-container"
          style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden;">
          <div id="galgame-sprite-wrapper"
            style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; height: 100%;">
            <div id="galgame-sprite-container"
              style="position: absolute; display: flex; align-items: flex-end; justify-content: center; /* 移除旧的定位样式 */">
              <img id="galgame-sprite" src=""
                style="max-height: 100%; max-width: 100%; object-fit: contain; transition: opacity 0.3s ease;">
              <div id="sprite-resize-handle"
                style="display: none; position: absolute; bottom: -5px; right: -5px; width: 20px; height: 20px; background: white; border: 2px solid var(--primary-color); border-radius: 50%; cursor: se-resize;">
              </div>
            </div>
          </div>
          <div id="galgame-textbox-container"
            style="position: absolute; bottom: 9%; left: 5%; right: 5%; background: rgba(0, 0, 0, 0.7); border-radius: 10px; padding: 15px; color: white; border-top: 1px solid rgba(255,255,255,0.2); cursor: pointer;">
            <div id="galgame-speaker" style="font-weight: bold; margin-bottom: 10px;">说话人</div>
            <div id="galgame-text" style="line-height: 1.6;">对话内容...</div>
          </div>
        </div>
      </div>
      <div class="chat-input-area">
        <div id="chat-input-wrapper-meeting"> <textarea id="meeting-message-input" placeholder="输入你的行动或对话..." rows="1"
            style="resize: none; overflow-y: auto; flex-grow: 1; border: none; background: transparent; padding: 9px 12px; font-size: .95rem; "></textarea>
          <button id="meeting-send-button" title="发送">➤</button>
        </div>
      </div>
    </div>

    <div id="friend-circle-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-circle-list" class="header-button">主屏幕</button>
        <span class="header-title">好友圈</span>
        <button id="add-friend-circle-button" class="header-button add" title="新建好友圈">+</button>
      </div>
      <div id="friend-circle-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="friend-circle-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-edit" class="header-button">返回</button>
        <span id="friend-circle-edit-title" class="header-title">编辑好友圈</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-friend-circle-id">
        <div class="settings-group">
          <h2>好友圈设定</h2>
          <div class="input-group">
            <label for="friend-circle-edit-name">圈子名称</label>
            <input type="text" id="friend-circle-edit-name" placeholder="例如：我的日常">
          </div>
          <div class="input-group">
            <label for="friend-circle-edit-bind-user">绑定的“我”</label>
            <select id="friend-circle-edit-bind-user"></select>
          </div>
        </div>
        <div class="settings-group">
          <h2>选择圈内成员</h2>
          <div id="friend-circle-member-selection"
            style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
          </div>
        </div>
        <button id="save-friend-circle-button" class="form-button">保存</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <button id="delete-friend-circle-button" class="form-button destructive">删除该好友圈</button>
        </div>
      </div>
    </div>
    <div id="diary-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-diary-list" class="header-button">主屏幕</button>
        <span class="header-title">交换日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="diary-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-diary-list">返回</button>
        <span id="diary-char-name-header" class="header-title">TA的日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-entries-container" class="content"
        style="padding: 20px; font-family: 'KaiTi', 'STSong', serif; line-height: 1.8;">
      </div>
      <div class="chat-input-area">
        <div id="diary-input-wrapper" style="display: flex; gap: 10px;">
          <input type="text" id="diary-entry-input" placeholder="写下你的日记或批注..." style="flex-grow: 1;">
          <button id="diary-send-button" class="form-button"
            style="width: auto; margin-top: 0; padding: 0 18px;">写好了</button>
          <button id="diary-get-reply-button" class="form-button"
            style="width: auto; margin-top: 0; background-color: #555; padding: 0 18px;">催TA写</button>
        </div>
      </div>
    </div>
    <div id="music-library-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-music-library" class="header-button">主屏幕</button>
        <span class="header-title">音乐库</span>
        <button id="upload-music-button" class="header-button add" title="上传新音乐">+</button>
      </div>
      <div class="content" id="music-library-container">
      </div>
    </div>
    <div id="music-upload-altar-screen" class="screen">
      <div class="header">
        <button id="back-to-library-from-altar" class="header-button">取消</button>
        <span class="header-title">献上音乐</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content" style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">

        <div class="upload-slot" id="altar-slot-audio">
          <span class="slot-icon">🎵</span>
          <span class="slot-label">音频文件 (必需)</span>
          <span class="slot-filename">点击选择 .mp3 或 .flac</span>
        </div>

        <div class="upload-slot" id="altar-slot-cover">
          <span class="slot-icon">🖼️</span>
          <span class="slot-label">封面图片 (可选)</span>
          <span class="slot-filename">点击选择 .jpg 或 .png</span>
        </div>

        <div class="upload-slot" id="altar-slot-info">
          <span class="slot-icon">📄</span>
          <span class="slot-label">歌曲信息 (必需)</span>
          <span class="slot-filename">点击选择 info.txt</span>
        </div>

        <div class="upload-slot" id="altar-slot-lyrics">
          <span class="slot-icon">🎤</span>
          <span class="slot-label">歌词文件 (可选)</span>
          <span class="slot-filename">点击选择 .lrc</span>
        </div>

        <button id="confirm-altar-upload-button" class="form-button" disabled>献上祭品</button>
      </div>

    </div>


    <div id="accounting-screen" class="screen">
      <div class="header" id="accounting-header">
        <button id="back-to-home-from-accounting" class="header-button">主屏幕</button>
        <span id="accounting-title" class="header-title">记一笔</span>
        <div id="header-actions" style="width: 80px; text-align: right;"></div>
      </div>

      <div class="accounting-tabs">
        <button id="tab-record-expense" class="tab-button active">记一笔</button>
        <button id="tab-view-ledger" class="tab-button">看账本</button>
      </div>

      <div id="accounting-content-area" class="content" style="padding: 15px;">
      </div>
    </div>
    <audio id="audio-player"></audio>

    <audio id="unified-audio-player"></audio>

    <div id="snoop-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-snoop-list" class="header-button">主屏幕</button>
        <span class="header-title">选择目标</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="snoop-character-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="snoop-phone-screen" class="screen">
      <div id="snoop-phone-wallpaper"></div>
      <div id="snoop-phone-header">
      </div>

      <div id="snoop-app-container">
      </div>

      <div id="snoop-app-view-container"
        style="position: absolute; inset: 0; background: white; z-index: 20; display: none; flex-direction: column;">
      </div>

      <div id="snoop-phone-top-nav" class="header"
        style="position: absolute; top: 44px; left: 0; right: 0; z-index: 30; height: 56px; display: flex; align-items: center; padding: 0 5px;">
        <button id="back-to-snoop-list-from-phone" class="toolbar-button"
          style="color: white; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.5)); background: transparent !important;">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
        <span id="snoop-char-name-header" class="header-title"></span>
        <div style="width:50px;"></div>
      </div>
    </div>

  </div>
  </div>

  <div id="add-choice-modal" class="choice-modal">
    <div id="add-choice-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="choice-create-character" class="choice-modal-button">创建新角色</button>
      <button id="choice-create-group" class="choice-modal-button">创建新群聊</button>
      <button id="choice-import-character" class="choice-modal-button">导入角色卡</button>
      <button id="choice-cancel" class="choice-modal-button cancel">取消</button>
    </div>
  </div>


  <div id="transfer-modal" class="choice-modal">
    <div id="transfer-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">转账</h3>
      <div id="transfer-recipient-group" class="input-group" style="margin: 10px 0; display: none;">
        <label for="transfer-recipient-select">转给</label>
        <select id="transfer-recipient-select"></select>
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="transfer-amount-input">金额</label>
        <input type="number" id="transfer-amount-input" placeholder="输入金额">
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-transfer-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认转账</button>
        <button id="cancel-transfer-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="message-action-modal" class="choice-modal">
    <div id="message-action-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="edit-message-button" class="choice-modal-button">编辑消息</button>
      <button id="quote-message-button" class="choice-modal-button">引用</button>
      <button id="delete-message-button" class="choice-modal-button" style="color: #dc3545;">删除消息</button>
      <button id="cancel-action-button" class="choice-modal-button cancel">取消</button>
    </div>
  </div>

  <div id="edit-message-modal" class="choice-modal">
    <div id="edit-message-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">编辑消息</h3>
      <textarea id="edit-message-textarea" style="width: 100%; min-height: 100px; margin: 10px 0;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 10px;">
        <button id="save-edit-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">保存</button>
        <button id="cancel-edit-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="music-input-modal" class="choice-modal">
    <div id="music-input-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 id="music-input-title" style="margin-top: 0; text-align: center; font-weight: 600;">分享音乐</h3>

      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-song" style="font-size: 0.9rem;">歌名</label>
        <input type="text" id="music-input-song" placeholder="例如：夜曲">
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-artist" style="font-size: 0.9rem;">歌手</label>
        <input type="text" id="music-input-artist" placeholder="例如：周杰伦">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-music-input" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认</button>
        <button id="cancel-music-input" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="modal-root"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;">
    <div id="modal-mask" style="position:absolute;inset:0;background:rgba(0,0,0,.35);"></div>
    <div id="modal-dialog"
      style="position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:80%;max-width:320px;padding:16px;">
      <div id="modal-text" style="font-size:14px;color:#333;line-height:1.5;white-space:pre-wrap;"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px;">
        <button id="modal-cancel"
          style="padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;">取消</button>
        <button id="modal-ok"
          style="padding:8px 12px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">确定</button>
      </div>
    </div>
  </div>

  <div id="listen-together-modal" class="choice-modal">
    <div id="listen-together-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <div style="width: 50px;"></div>
        <span class="header-title">选择一首歌，一起听</span>
        <button id="cancel-listen-together" class="header-button" style="min-width: 50px;">取消</button>
      </div>
      <div id="listen-together-song-list" class="content" style="flex-grow: 1; padding: 10px;">
      </div>
    </div>
  </div>

  <div id="toast"
    style="position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:8px;font-size:12px;display:none;z-index:10000;">
  </div>

  <script>
    const _0x493a8b = _0x13a6; (function (_0x4894d4, _0xa08da0) { const _0x465a4b = _0x13a6, _0x6b0d8 = _0x4894d4(); while (!![]) { try { const _0x38a6e6 = -parseInt(_0x465a4b(0xa62)) / 0x1 + -parseInt(_0x465a4b(0x57e)) / 0x2 + -parseInt(_0x465a4b(0x106)) / 0x3 * (-parseInt(_0x465a4b(0x34d)) / 0x4) + -parseInt(_0x465a4b(0xa16)) / 0x5 * (parseInt(_0x465a4b(0x619)) / 0x6) + parseInt(_0x465a4b(0x66b)) / 0x7 * (-parseInt(_0x465a4b(0x4cd)) / 0x8) + parseInt(_0x465a4b(0x9c3)) / 0x9 * (parseInt(_0x465a4b(0x846)) / 0xa) + parseInt(_0x465a4b(0x32f)) / 0xb; if (_0x38a6e6 === _0xa08da0) break; else _0x6b0d8['push'](_0x6b0d8['shift']()); } catch (_0x53ab1e) { _0x6b0d8['push'](_0x6b0d8['shift']()); } } }(_0x438a, 0x692f3)); const _0x4305b9 = _0x493a8b(0x56e), _0x4e5aa3 = _0x493a8b(0x9d4), _0x369ae2 = _0x493a8b(0x955), _0xcf1b5b = document['createElement'](_0x493a8b(0x462)); _0xcf1b5b['id'] = _0x493a8b(0x3f0), document[_0x493a8b(0x33f)][_0x493a8b(0x3fd)](_0xcf1b5b); var _0x13c410, _0x3c9ea0 = null; let _0x5c61cd = [], _0x47df50 = ![], _0x11d245 = { 'x': 0x0, 'y': 0x0 }; function _0x901605(_0x23d84a) { return (_0x13c410?.['characters'] || [])['find'](_0x45fbea => _0x45fbea['id'] === _0x23d84a); } const _0xe2cea5 = _0x493a8b(0x590), _0x10ed69 = _0x493a8b(0x262), _0x1c044f = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNjY2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDRhNC4zOSA0LjM5IDAgMCAwLTMuMjgtNC4wOWwxLjQxLTEuNDFhMiAyIDAgMSAwLTIuODMtMi4wM2wtMS40MSAxLjQxQTQuMzkgNC4zOSAwIDAgMCAxMiAxMGE0LjM5IDQuMzkgMCAwIDAtNC4wOSAzLjI4TDMuMicgOS41N2EyIDIgMCAxIDAgMi44MyAyLjgzbDEuNDEtMS40MUE0LjM5IDQuMzkgMCAwIDAgMTAgMTJhNC4zOSA0LjM5IDAgMCAwIDMgNC4wOVYyMSI+PC9wYXRoPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIj48L2NpcmNsZT48L3N2Zz4=', _0x397208 = [{ 'name': _0x493a8b(0x4f3), 'url': _0x493a8b(0x82a) }, { 'name': '崩溃', 'url': _0x493a8b(0x53d) }, { 'name': '生病', 'url': _0x493a8b(0x5d4) }, { 'name': '工作', 'url': _0x493a8b(0x1e3) }, { 'name': _0x493a8b(0x8cd), 'url': 'https://sharkpan.xyz/f/ABwhZ/twknmr.jpg' }, { 'name': _0x493a8b(0x2a8), 'url': 'https://sharkpan.xyz/f/wjgHq/yznfhq.jpg' }, { 'name': _0x493a8b(0x38f), 'url': _0x493a8b(0x127) }, { 'name': '期待', 'url': 'https://sharkpan.xyz/f/35lse/xmsue5.jpg' }, { 'name': '喜欢', 'url': _0x493a8b(0x2d4) }, { 'name': _0x493a8b(0x4e0), 'url': 'https://sharkpan.xyz/f/kjOF6/zedyqb.jpg' }, { 'name': '有点生气', 'url': 'https://sharkpan.xyz/f/jj6s6/yd5bpb.jpg' }, { 'name': '委屈', 'url': _0x493a8b(0x4c8) }, { 'name': '加油', 'url': _0x493a8b(0x900) }, { 'name': '对的', 'url': _0x493a8b(0x54b) }, { 'name': '不满', 'url': _0x493a8b(0x342) }, { 'name': _0x493a8b(0x99d), 'url': _0x493a8b(0xa33) }, { 'name': '猫猫撒娇', 'url': _0x493a8b(0x1c1) }, { 'name': '委屈', 'url': _0x493a8b(0x65f) }, { 'name': '平静', 'url': _0x493a8b(0x2c0) }, { 'name': '咬你', 'url': _0x493a8b(0x98e) }, { 'name': _0x493a8b(0x7f9), 'url': _0x493a8b(0x87e) }, { 'name': '好困', 'url': _0x493a8b(0x297) }, { 'name': '摸鱼', 'url': _0x493a8b(0x95a) }, { 'name': _0x493a8b(0x21d), 'url': 'https://sharkpan.xyz/f/mjdFW/28n30c.jpg' }, { 'name': '超激动我来了', 'url': _0x493a8b(0x9d0) }, { 'name': _0x493a8b(0xa24), 'url': 'https://sharkpan.xyz/f/4adUj/68uj9o.jpg' }, { 'name': _0x493a8b(0x1e4), 'url': _0x493a8b(0x299) }, { 'name': _0x493a8b(0x9b2), 'url': _0x493a8b(0x99c) }, { 'name': _0x493a8b(0xa35), 'url': 'https://sharkpan.xyz/f/xjmCX/zyjzew.jpg' }, { 'name': _0x493a8b(0x7e2), 'url': _0x493a8b(0x824) }, { 'name': _0x493a8b(0x2b2), 'url': _0x493a8b(0x991) }, { 'name': '我是垃圾', 'url': _0x493a8b(0x62c) }, { 'name': _0x493a8b(0xaa1), 'url': _0x493a8b(0x253) }, { 'name': '逗你开心', 'url': _0x493a8b(0x7f0) }, { 'name': _0x493a8b(0xa84), 'url': _0x493a8b(0x7a3) }, { 'name': _0x493a8b(0x8cb), 'url': _0x493a8b(0x228) }, { 'name': '对不起', 'url': _0x493a8b(0x35d) }, { 'name': _0x493a8b(0x99b), 'url': _0x493a8b(0x696) }, { 'name': '无语但是随便吧', 'url': _0x493a8b(0x901) }, { 'name': _0x493a8b(0x441), 'url': _0x493a8b(0x21e) }, { 'name': _0x493a8b(0xa3f), 'url': _0x493a8b(0x13e) }, { 'name': '有点无语', 'url': _0x493a8b(0x359) }, { 'name': _0x493a8b(0x65d), 'url': _0x493a8b(0x258) }, { 'name': _0x493a8b(0x202), 'url': _0x493a8b(0x5b0) }, { 'name': '谁啊我吗', 'url': 'https://sharkpan.xyz/f/ExKsD/s5j2it.jpg' }, { 'name': _0x493a8b(0x3de), 'url': _0x493a8b(0x4a6) }, { 'name': _0x493a8b(0x382), 'url': 'https://sharkpan.xyz/f/Qpzu6/3b30r2.jpg' }, { 'name': _0x493a8b(0x3be), 'url': _0x493a8b(0x56b) }, { 'name': '我是小丑呜呜', 'url': _0x493a8b(0x883) }, { 'name': _0x493a8b(0x1d2), 'url': _0x493a8b(0x966) }, { 'name': _0x493a8b(0x6ac), 'url': _0x493a8b(0x353) }, { 'name': '我来搞定', 'url': _0x493a8b(0x9db) }, { 'name': _0x493a8b(0x4ae), 'url': _0x493a8b(0x33c) }, { 'name': '等你', 'url': 'https://sharkpan.xyz/f/1zQH2/o84boo.jpg' }, { 'name': '一个人可怜吃饭', 'url': _0x493a8b(0xa10) }, { 'name': _0x493a8b(0xa3b), 'url': _0x493a8b(0x744) }, { 'name': '喝酒', 'url': _0x493a8b(0x55a) }, { 'name': _0x493a8b(0x9a5), 'url': _0x493a8b(0x5dd) }, { 'name': '呜呜', 'url': 'https://sharkpan.xyz/f/z1xc5/iore2n.gif' }, { 'name': '为你骄傲', 'url': 'https://sharkpan.xyz/f/7aMhj/hyc75m.jpg' }, { 'name': _0x493a8b(0x46e), 'url': _0x493a8b(0x9f8) }, { 'name': _0x493a8b(0x5df), 'url': _0x493a8b(0x724) }, { 'name': '请看是我', 'url': _0x493a8b(0x13f) }, { 'name': _0x493a8b(0x74c), 'url': _0x493a8b(0x939) }], _0x1b9c26 = { 'beige': { 'name': _0x493a8b(0x27e), 'h': 0x23, 's': 0x19, 'l': 0x50 }, 'mizuiro': { 'name': '薄荷水色', 'h': 0xc3, 's': 0x19, 'l': 0x50 }, 'sakura': { 'name': _0x493a8b(0x682), 'h': 0x159, 's': 0x19, 'l': 0x50 }, 'noir': { 'name': _0x493a8b(0x2e8), 'h': 0x104, 's': 0xf, 'l': 0x1e } }; document[_0x493a8b(0x988)](_0x493a8b(0x79e), () => { const _0x314838 = _0x493a8b, _0x91c60 = document[_0x314838(0x7d5)](_0x314838(0x1c9)), _0x471b8d = document[_0x314838(0x7d5)](_0x314838(0x236)), _0x16b640 = document[_0x314838(0x7d5)]('transfer-modal'), _0x37f20b = document[_0x314838(0x7d5)](_0x314838(0x1a1)), _0x4a766f = document[_0x314838(0x7d5)]('confirm-transfer-button'), _0x2ea760 = document[_0x314838(0x7d5)](_0x314838(0x313)), _0x4a4ac3 = document[_0x314838(0x7d5)](_0x314838(0x827)), _0x1963c5 = document[_0x314838(0x7d5)](_0x314838(0x904)), _0x212b02 = document[_0x314838(0x7d5)](_0x314838(0x61b)), _0x59def7 = document[_0x314838(0x7d5)](_0x314838(0x86b)), _0x4e3cc5 = document[_0x314838(0x7d5)](_0x314838(0x2d6)), _0x3e134b = document[_0x314838(0x7d5)](_0x314838(0x7b8)), _0x1604bf = document[_0x314838(0x7d5)](_0x314838(0x7a0)), _0x188eea = document[_0x314838(0x7d5)](_0x314838(0xa08)), _0xdb73fd = document[_0x314838(0x7d5)](_0x314838(0xa29)), _0x155012 = document[_0x314838(0x7d5)]('close-summary-button'), _0x6362c7 = document[_0x314838(0x7d5)](_0x314838(0x7d4)), _0x495a43 = document[_0x314838(0x7d5)](_0x314838(0x530)), _0x31d3ab = document[_0x314838(0x7d5)](_0x314838(0x37b)), _0x1118c5 = document[_0x314838(0x7d5)](_0x314838(0x8b7)), _0x3c005b = document['getElementById'](_0x314838(0x427)), _0x407570 = document[_0x314838(0x7d5)]('import-char-input'), _0x37c203 = document[_0x314838(0x7d5)]('export-char-button'), _0x36b9c0 = document[_0x314838(0x7d5)]('upload-font-button'), _0x34e192 = document['getElementById']('remove-font-button'), _0x1a9319 = document[_0x314838(0x7d5)](_0x314838(0x6f1)), _0x496571 = document[_0x314838(0x7d5)]('font-preview-text'); async function _0x22176f(_0x2019bc) { const _0x3a7907 = _0x314838; try { const _0x52a3a9 = URL[_0x3a7907(0x602)](_0x2019bc), _0x5b50dd = _0x3a7907(0x594), _0x22b71e = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27' + _0x5b50dd + _0x3a7907(0x9fc) + _0x52a3a9 + _0x3a7907(0x854); _0xcf1b5b['innerHTML'] = _0x22b71e, document[_0x3a7907(0x4ba)][_0x3a7907(0x462)]['setProperty'](_0x3a7907(0x5cd), '\x27' + _0x5b50dd + '\x27'), _0x496571[_0x3a7907(0x9e0)] = _0x3a7907(0x5e3); } catch (_0x5acb1d) { console[_0x3a7907(0x11e)](_0x3a7907(0x866), _0x5acb1d), _0x1e9edf(_0x3a7907(0x5c8)); } } async function _0x43e0cd() { const _0x34483f = _0x314838; try { const _0x1566dc = await _0xb9bbbf(_0x34483f(0x88e)); _0x1566dc && (console[_0x34483f(0x688)](_0x34483f(0xa71)), await _0x22176f(_0x1566dc)); } catch (_0x543314) { 'dKQLD' !== _0x34483f(0x4d2) ? _0x413c1c = _0x1fba5c['content'] : console[_0x34483f(0x11e)](_0x34483f(0x126), _0x543314); } } async function _0xb7a158(_0x2266b9) { const _0x3418fc = _0x314838, _0x1d294a = _0x2266b9[_0x3418fc(0x6d7)]['files'][0x0]; if (!_0x1d294a || !_0x1d294a[_0x3418fc(0x695)]['toLowerCase']()[_0x3418fc(0x771)]('.ttf')) { _0x1e9edf('说了要\x20.ttf\x20文件，你是听不懂吗？'); return; } _0x1f66de(!![], '正在铭刻字体...'); try { await _0x4162d1(_0x3418fc(0x88e), _0x1d294a), await _0x22176f(_0x1d294a), _0x1e9edf(_0x3418fc(0x857)); } catch (_0x343bfc) { _0x1e9edf(_0x3418fc(0x34e) + _0x343bfc[_0x3418fc(0x496)]); } finally { if ('MXELK' !== _0x3418fc(0x267)) _0x1f66de(![]), _0x1a9319[_0x3418fc(0x4d3)] = ''; else { _0x28e6c = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x1fbd88 in _0x96bf89) { _0x187af1[_0x1fbd88][_0x3418fc(0x349)][_0x3418fc(0x330)](_0x3418fc(0x829)), _0x1abf6e[_0x1fbd88]['value'] = ''; } _0x43e6be['audio'][_0x3418fc(0x298)](_0x3418fc(0x55b))[_0x3418fc(0x9e0)] = '点击选择\x20.mp3\x20或\x20.flac', _0x7ac0f1[_0x3418fc(0x45d)]['querySelector'](_0x3418fc(0x55b))['textContent'] = _0x3418fc(0x6e8), _0x1a4e3c[_0x3418fc(0x584)][_0x3418fc(0x298)](_0x3418fc(0x55b))['textContent'] = _0x3418fc(0x17f), _0x304e05[_0x3418fc(0x808)][_0x3418fc(0x298)](_0x3418fc(0x55b))[_0x3418fc(0x9e0)] = _0x3418fc(0x108), _0x32e955(); } } } async function _0x142627() { const _0x26a083 = _0x314838; if ('SYGkb' === 'SYGkb') { const _0x561ce6 = await _0x39a14a(_0x26a083(0x286)); if (_0x561ce6) { if ('LnHSK' === _0x26a083(0x48e)) { const _0x318914 = _0x4222e0['getElementById'](_0x26a083(0xa0d)); _0x409613[_0x26a083(0x7b6)] && _0x42712e['info'] ? _0x318914[_0x26a083(0x99f)] = ![] : _0x318914[_0x26a083(0x99f)] = !![]; } else try { await _0x3815e2(_0x26a083(0x88e)), _0xcf1b5b[_0x26a083(0x65e)] = '', document[_0x26a083(0x4ba)][_0x26a083(0x462)][_0x26a083(0x9b0)](_0x26a083(0x5cd)), _0x496571[_0x26a083(0x9e0)] = _0x26a083(0x558), _0x1e9edf(_0x26a083(0x6f4)); } catch (_0x39ab8d) { if ('rSteI' === 'mzuUO') { if (!_0xfbe277 || !_0xca42d8[_0x26a083(0x55f)]) return; const _0x1b9c0b = { 'role': _0x26a083(0x425), 'content': '[用户发送了表情：' + _0x394370[_0x26a083(0x695)] + ']', 'displayUrl': _0x22baeb['url'], 'timestamp': _0x1e0c70[_0x26a083(0x2f2)]() }; _0x2e6c12[_0x26a083(0x793)][_0x26a083(0x98f)](_0x1b9c0b), _0x848763(_0x1b9c0b, _0x151a31[_0x26a083(0x793)][_0x26a083(0x280)] - 0x1), _0x5dc476(), _0x480e33['classList'][_0x26a083(0x330)](_0x26a083(0xa12)); } else _0x1e9edf(_0x26a083(0x613) + _0x39ab8d[_0x26a083(0x496)]); } } } else { const _0x44eeb3 = _0x3e8771(_0x3698ca[_0x26a083(0x936)]())['padStart'](0x2, '0'), _0xe32209 = _0x2614e0(_0x4fc2cb[_0x26a083(0x546)]())['padStart'](0x2, '0'); _0x431d1f['textContent'] = _0x44eeb3 + ':' + _0xe32209; const _0x52f1f6 = _0x57086f[_0x26a083(0x550)]() + 0x1, _0x2a24ac = _0x1b67bc[_0x26a083(0x1a4)](), _0x4af8b2 = ['星期日', _0x26a083(0x8fe), '星期二', '星期三', _0x26a083(0x459), '星期五', _0x26a083(0x937)][_0x5a0d9d['getDay']()]; _0x5a33d2[_0x26a083(0x9e0)] = _0x52f1f6 + '月' + _0x2a24ac + '日\x20' + _0x4af8b2; } } function _0x8ccff9() { const _0xba97a5 = _0x314838; if (_0xba97a5(0x638) !== 'aJtJD') { const _0x29bc83 = document[_0xba97a5(0x7d5)]('theme-hue-slider'); if (!_0x29bc83) return; const _0x304023 = localStorage[_0xba97a5(0x310)](_0xba97a5(0x927)) || '35'; document['documentElement'][_0xba97a5(0x462)][_0xba97a5(0x81c)]('--primary-hue', _0x304023), _0x29bc83[_0xba97a5(0x4d3)] = _0x304023, _0x29bc83[_0xba97a5(0x988)]('input', () => { const _0x572875 = _0xba97a5, _0x4d51e6 = _0x29bc83[_0x572875(0x4d3)]; document[_0x572875(0x4ba)][_0x572875(0x462)][_0x572875(0x81c)](_0x572875(0x7a4), _0x4d51e6), localStorage[_0x572875(0x629)]('themeHue', _0x4d51e6), _0x452bd1(); }); } else _0x4b25af[_0xba97a5(0x8c0)](_0xa2b497 => { const _0x291da7 = _0xba97a5, _0x34a8af = _0xa2b497[_0x291da7(0x6da)] === 'character', _0xde5e3e = _0x34a8af ? _0x2f21d6 ? _0x5a6920[0x0] : '?' : _0x5679ca ? _0x15d8af[0x0] : '?'; _0x3dfb60 += '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-container\x20' + (_0x34a8af ? _0x291da7(0x425) : 'ai') + _0x291da7(0x4f1) + (!_0x34a8af ? _0x291da7(0xa7a) + _0xde5e3e + _0x291da7(0x447) : '') + _0x291da7(0x813) + (_0x34a8af ? _0x291da7(0x425) : 'ai') + '\x22\x20style=\x22box-shadow:\x20none;\x20border:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>' + _0xa2b497[_0x291da7(0x75a)] + '</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x34a8af ? _0x291da7(0xa7a) + _0xde5e3e + _0x291da7(0x447) : '') + _0x291da7(0x6a5); }); } function _0x2e76a8() { const _0x1d4cbf = _0x314838, _0x2e689e = document[_0x1d4cbf(0x7d5)]('theme-lightness-slider'); if (!_0x2e689e) return; const _0x226407 = localStorage[_0x1d4cbf(0x310)](_0x1d4cbf(0x7bc)) || '80'; document[_0x1d4cbf(0x4ba)][_0x1d4cbf(0x462)][_0x1d4cbf(0x81c)]('--primary-lightness', _0x226407 + '%'), _0x2e689e[_0x1d4cbf(0x4d3)] = _0x226407, _0x2e689e[_0x1d4cbf(0x988)](_0x1d4cbf(0x6b1), () => { const _0x301e89 = _0x1d4cbf, _0x5686b7 = _0x2e689e[_0x301e89(0x4d3)]; document['documentElement'][_0x301e89(0x462)]['setProperty'](_0x301e89(0x9d9), _0x5686b7 + '%'), localStorage[_0x301e89(0x629)]('themeLightness', _0x5686b7), _0x452bd1(); }); } function _0x452bd1() { const _0x47e467 = _0x314838, _0x5e2bf = document[_0x47e467(0x7d5)]('home-clock-container'); if (!_0x5e2bf) return; _0x13c410[_0x47e467(0x859)][_0x47e467(0x568)] ? 'ADnxS' !== _0x47e467(0x486) ? _0x3be9c0[_0x47e467(0x8ee)] === 'Enter' && !_0x1fe898['shiftKey'] && (_0x1109d5[_0x47e467(0xa73)](), _0x59c2f0()) : (_0x5e2bf['style'][_0x47e467(0x673)] = _0x47e467(0x777), _0x5e2bf[_0x47e467(0x462)][_0x47e467(0x4f6)] = '0\x202px\x208px\x20rgba(0,0,0,0.4)') : (_0x5e2bf[_0x47e467(0x462)]['color'] = _0x47e467(0x5b2), _0x5e2bf[_0x47e467(0x462)][_0x47e467(0x4f6)] = _0x47e467(0x794)); } function _0x5d419b() { const _0x3e7d53 = _0x314838; if (_0x3e7d53(0x797) !== _0x3e7d53(0x7b7)) { const _0x2e9772 = document[_0x3e7d53(0x7d5)](_0x3e7d53(0x445)); if (!_0x2e9772) return; _0x2e9772[_0x3e7d53(0x8ba)] = _0x13c410[_0x3e7d53(0x859)]['forceWhiteClock'] || ![], _0x2e9772['addEventListener'](_0x3e7d53(0x458), () => { const _0x4a2346 = _0x3e7d53; _0x13c410['preferences'][_0x4a2346(0x568)] = _0x2e9772[_0x4a2346(0x8ba)], _0x5834f1(), _0x452bd1(); }); } else _0x5013a0[_0x3e7d53(0x9e0)] = _0x3d60c1[_0x3e7d53(0x3bc)], _0xb13965[_0x3e7d53(0x9e0)] = _0x287b64[_0x3e7d53(0x376)], _0x410fe1[_0x3e7d53(0x349)][_0x3e7d53(0x699)]('is-playing'), _0x10177a[_0x3e7d53(0x462)][_0x3e7d53(0x81c)](_0x3e7d53(0x272), _0x3e7d53(0x408) + _0x31a794[_0x3e7d53(0x45d)] + ')'); } _0x37c203[_0x314838(0x988)](_0x314838(0x649), _0x1648a4), _0x3c005b[_0x314838(0x988)](_0x314838(0x649), () => { const _0xf205f1 = _0x314838; 'ymTzu' === _0xf205f1(0x6f5) ? (_0x21670a(), _0x407570[_0xf205f1(0x649)]()) : !_0x106b08[_0xf205f1(0x741)](_0x1a144c[_0xf205f1(0x6d7)]) && _0x104ac9['target'] !== _0x424846 && _0x3d52d7[_0xf205f1(0x6d7)] !== _0x2e31da && _0x1e3653[_0xf205f1(0x349)][_0xf205f1(0x330)](_0xf205f1(0xa12)); }), _0x407570[_0x314838(0x988)](_0x314838(0x458), _0x39632b); const _0x974bdb = { 'home': document[_0x314838(0x7d5)](_0x314838(0x209)), 'chat': document[_0x314838(0x7d5)](_0x314838(0x139)), 'settings': document[_0x314838(0x7d5)](_0x314838(0x252)), 'userProfile': document[_0x314838(0x7d5)]('user-profile-screen'), 'characterEdit': document[_0x314838(0x7d5)](_0x314838(0x152)), 'groupChatCreate': document[_0x314838(0x7d5)](_0x314838(0xaa8)), 'wallpaper': document[_0x314838(0x7d5)](_0x314838(0x916)), 'worldBook': document[_0x314838(0x7d5)](_0x314838(0xa18)), 'worldBookEditor': document['getElementById'](_0x314838(0x1f4)), 'groupSettings': document['getElementById'](_0x314838(0xa80)), 'music': document[_0x314838(0x7d5)](_0x314838(0x3c9)), 'friendCircleList': document[_0x314838(0x7d5)](_0x314838(0x1d5)), 'friendCircleEdit': document['getElementById'](_0x314838(0xfd)), 'meetingList': document[_0x314838(0x7d5)](_0x314838(0x665)), 'meetingView': document['getElementById'](_0x314838(0x5aa)), 'userProfileList': document[_0x314838(0x7d5)](_0x314838(0x6ba)), 'diaryList': document[_0x314838(0x7d5)](_0x314838(0x18e)), 'diaryView': document[_0x314838(0x7d5)](_0x314838(0x6ad)), 'musicLibrary': document[_0x314838(0x7d5)](_0x314838(0x9ce)), 'musicUploadAltar': document[_0x314838(0x7d5)](_0x314838(0x757)), 'accounting': document['getElementById'](_0x314838(0x406)), 'snoopList': document['getElementById']('snoop-list-screen'), 'snoopPhone': document[_0x314838(0x7d5)]('snoop-phone-screen') }, _0xd755bd = document[_0x314838(0x7d5)]('upload-feed-bg-button'), _0x309fc5 = document[_0x314838(0x7d5)](_0x314838(0x4b6)), _0x5f0512 = document['getElementById'](_0x314838(0x45e)), _0x910e9 = document[_0x314838(0x7d5)](_0x314838(0x103)), _0x1cce06 = document['getElementById']('app-world-book'), _0x56a29c = document[_0x314838(0x7d5)](_0x314838(0xf4)), _0x4222f9 = document[_0x314838(0x7d5)](_0x314838(0x158)), _0x202da9 = document[_0x314838(0x7d5)](_0x314838(0xa5b)); document['getElementById'](_0x314838(0x4d1))[_0x314838(0x988)](_0x314838(0x649), async () => { const _0x51a140 = _0x314838, _0x52e8c7 = await _0x39a14a(_0x51a140(0x334)); if (_0x52e8c7) { localStorage[_0x51a140(0x7ec)](_0x51a140(0x49b)), localStorage[_0x51a140(0x7ec)](_0x51a140(0x8a1)), localStorage[_0x51a140(0x7ec)](_0x51a140(0x145)), localStorage[_0x51a140(0x7ec)](_0x51a140(0x73a)); const _0x5ec52b = []; for (let _0x27ae3a = 0x0; _0x27ae3a < localStorage[_0x51a140(0x280)]; _0x27ae3a++) { const _0x8f035e = localStorage[_0x51a140(0x8ee)](_0x27ae3a); _0x8f035e && _0x8f035e['startsWith'](_0x51a140(0x274)) && _0x5ec52b[_0x51a140(0x98f)](_0x8f035e); } _0x5ec52b[_0x51a140(0x8c0)](_0x55541d => localStorage[_0x51a140(0x7ec)](_0x55541d)), await _0x4162d1(_0x51a140(0x450), await _0x4904fe(_0x51a140(0x844))), _0x1e9edf('桌面已重置，即将刷新...'), setTimeout(() => location[_0x51a140(0x569)](), 0x5dc); } }); const _0x5c02ca = document['getElementById'](_0x314838(0x6f3)), _0x1ef59e = document[_0x314838(0x7d5)](_0x314838(0x144)), _0x3945b2 = document[_0x314838(0x7d5)](_0x314838(0x3aa)), _0xb30534 = document[_0x314838(0x7d5)](_0x314838(0x567)), _0x5fa0a3 = document[_0x314838(0x7d5)]('choice-cancel'), _0x50210b = document[_0x314838(0x7d5)]('back-to-char-select-from-group-create'), _0x5e2472 = document[_0x314838(0x7d5)](_0x314838(0xa2a)), _0x5b585e = document['getElementById'](_0x314838(0x5e7)), _0x1016ac = document[_0x314838(0x7d5)](_0x314838(0x146)), _0x1ee953 = document[_0x314838(0x7d5)](_0x314838(0x3a6)), _0xe1a909 = document[_0x314838(0x7d5)](_0x314838(0x1bb)), _0x4577cd = document['getElementById'](_0x314838(0x3c8)), _0x3f708e = document[_0x314838(0x7d5)](_0x314838(0x24f)), _0x86bc7b = document[_0x314838(0x7d5)](_0x314838(0xa9e)), _0x5c3500 = document[_0x314838(0x7d5)](_0x314838(0x76c)), _0x13f057 = document[_0x314838(0x7d5)](_0x314838(0xa89)), _0x39aad8 = document['getElementById']('character-list'), _0x50de4d = document['getElementById'](_0x314838(0xe5)), _0x5bf37e = document[_0x314838(0x7d5)](_0x314838(0x139)), _0x336614 = document[_0x314838(0x7d5)](_0x314838(0x64b)), _0x4225fb = document[_0x314838(0x7d5)](_0x314838(0x129)), _0x3bb1ac = document[_0x314838(0x7d5)](_0x314838(0x2fe)), _0x2772a1 = document['getElementById']('chat-get-reply-button'), _0x2e9876 = document['getElementById'](_0x314838(0x90c)), _0x1d9877 = document[_0x314838(0x7d5)](_0x314838(0x9c4)), _0x1f2be8 = document[_0x314838(0x7d5)](_0x314838(0x488)), _0x490d3c = document[_0x314838(0x7d5)](_0x314838(0x495)), _0x35ccdd = document[_0x314838(0x7d5)]('char-name-header'), _0x18ce94 = document[_0x314838(0x7d5)](_0x314838(0x1d7)), _0x2aad1a = document[_0x314838(0x7d5)](_0x314838(0xa43)), _0xf50e0f = document[_0x314838(0x7d5)](_0x314838(0x31d)), _0x2d773f = document[_0x314838(0x7d5)]('chat-image-input'), _0x1da8dc = document[_0x314838(0x7d5)](_0x314838(0x8ec)), _0x3498ff = document[_0x314838(0x7d5)](_0x314838(0x95f)), _0x42692e = document[_0x314838(0x7d5)](_0x314838(0x10b)), _0x474982 = document['getElementById'](_0x314838(0x345)), _0x17226e = document[_0x314838(0x7d5)](_0x314838(0x1df)), _0x396b5e = document[_0x314838(0x7d5)]('save-api-settings-button'), _0x5601d2 = document[_0x314838(0x7d5)](_0x314838(0x7ea)), _0x12cb4a = document[_0x314838(0x7d5)](_0x314838(0xa8f)), _0x5b8a5b = document[_0x314838(0x7d5)](_0x314838(0x379)), _0x35d673 = document[_0x314838(0x7d5)](_0x314838(0x9f1)), _0x15cbfe = document[_0x314838(0x7d5)](_0x314838(0x33a)), _0x2f5a8d = document[_0x314838(0x7d5)](_0x314838(0x64e)), _0x14fff8 = document[_0x314838(0x7d5)]('user-persona'), _0x83d5ba = document[_0x314838(0x7d5)](_0x314838(0x8be)), _0x490d5c = document[_0x314838(0x7d5)](_0x314838(0x4a9)), _0x1a17c5 = document[_0x314838(0x7d5)](_0x314838(0x840)), _0x1cc11a = document[_0x314838(0x7d5)](_0x314838(0x92a)), _0x5e7dd0 = document[_0x314838(0x7d5)](_0x314838(0x7e3)), _0x287c3a = document[_0x314838(0x7d5)](_0x314838(0x1ca)), _0x27cc5f = document['getElementById'](_0x314838(0x3d8)), _0x10c7f0 = document[_0x314838(0x7d5)](_0x314838(0x7bd)), _0x7b9362 = document[_0x314838(0x7d5)](_0x314838(0x529)), _0x3dfa30 = document[_0x314838(0x7d5)](_0x314838(0x90b)), _0x4939b5 = document[_0x314838(0x7d5)](_0x314838(0x426)); let _0x1a2f27 = null; const _0x124779 = _0x314838(0x12a), _0xfba233 = _0x314838(0x192); _0x13c410 = { 'characters': [], 'worldBooks': [], 'chats': [], 'userProfiles': [], 'activeUserProfileId': null, 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'widgetBgImage': null, 'perChatContextLines': 0x64, 'forceWhiteClock': ![] }, 'activeChatId': null, 'activeMeetingCharId': null, 'isGenerating': ![], 'currentAbortController': null, 'pendingMessageTimers': [], 'conversationHistory': [], 'displayedMessageCount': 0x64, 'activeQuote': null, 'friendCircles': [], 'activeFriendCircleId': null, 'accountingData': [], 'accountingLedger': {}, 'diaries': [], 'activeDiaryCharacterId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'meetingViewMode': 'novel', 'activeMeetingScriptQueue': [], 'characterLastScripts': {}, 'musicPlaylist': [], 'currentlyPlayingIndex': -0x1, 'isPlaying': ![], 'pendingPostAttachments': { 'image': null, 'music': null } }; function _0x5834f1() { const _0x3db1e9 = _0x314838; try { const _0x2be93e = { 'characters': _0x13c410[_0x3db1e9(0x53a)], 'worldBooks': _0x13c410[_0x3db1e9(0x90d)], 'chats': _0x13c410[_0x3db1e9(0x226)], 'userProfile': _0x13c410[_0x3db1e9(0x787)], 'apiSettings': _0x13c410[_0x3db1e9(0xa48)], 'preferences': _0x13c410[_0x3db1e9(0x859)], 'activeChatId': _0x13c410[_0x3db1e9(0x55f)], 'diaries': _0x13c410[_0x3db1e9(0x324)], 'friendCircles': _0x13c410['friendCircles'], 'activeFriendCircleId': _0x13c410['activeFriendCircleId'], 'userProfiles': _0x13c410[_0x3db1e9(0x6ed)], 'activeUserProfileId': _0x13c410['activeUserProfileId'], 'accountingData': _0x13c410[_0x3db1e9(0x2e4)], 'accountingLedger': _0x13c410[_0x3db1e9(0x246)] }; localStorage['setItem'](_0x3db1e9(0x156), JSON[_0x3db1e9(0x3e1)](_0x2be93e)); } catch (_0x2556a6) { console[_0x3db1e9(0x11e)](_0x3db1e9(0x997), _0x2556a6), _0x1e9edf(_0x3db1e9(0x120)); } } function _0x5dd19b() { const _0x530796 = _0x314838; let _0x437602 = null; try { if (_0x530796(0x250) === 'mRyfH') _0x437602 = localStorage[_0x530796(0x310)]('appState'); else { const _0x30f7b2 = _0x117c26[_0x530796(0x67e)][_0x530796(0x9b9)](_0x8b7f22 => _0x8b7f22['id'] === _0x49c264[_0x530796(0x6f0)]), _0x445a40 = _0x535a43(); let _0x15bc84 = []; if (_0x30f7b2 && _0x30f7b2[_0x530796(0xea)]) { const _0x4e375b = _0x30f7b2[_0x530796(0xea)][_0x530796(0x61f)](_0x39bdfb => _0x39bdfb['type'] === 'music' && _0x39bdfb[_0x530796(0x128)])[_0x530796(0x33d)](_0x12128b => ({ ..._0x12128b, 'source': _0x530796(0xa6e) })); _0x15bc84['push'](..._0x4e375b); } if (_0x445a40 && _0x9d47ba['conversationHistory']) { const _0x126be7 = _0x25290e[_0x530796(0x793)]['filter'](_0x25db58 => _0x25db58[_0x530796(0x974)] === _0x530796(0x44d) && _0x25db58[_0x530796(0x128)])[_0x530796(0x33d)](_0xa1a300 => ({ ..._0xa1a300, 'source': 'chat' })); _0x15bc84[_0x530796(0x98f)](..._0x126be7); } const _0x17792e = _0x50d126['from'](new _0x1d9847(_0x15bc84[_0x530796(0x33d)](_0xc6bba3 => [_0xc6bba3[_0x530796(0x128)], _0xc6bba3]))[_0x530796(0x1f9)]()); _0x467ade[_0x530796(0xa14)] = _0x17792e[_0x530796(0x25d)]((_0xcc5b03, _0x48c0d6) => _0x48c0d6['timestamp'] - _0xcc5b03[_0x530796(0x921)]); } } catch (_0x44fb90) { console['error'](_0x530796(0x3bd), _0x44fb90), _0x1e9edf(_0x530796(0x810)); } if (_0x437602) try { const _0x2337e1 = JSON[_0x530796(0xa69)](_0x437602); if (!_0x2337e1 || typeof _0x2337e1 !== _0x530796(0x2f6)) throw new Error(_0x530796(0x35e)); Array[_0x530796(0x850)](_0x2337e1[_0x530796(0x53a)]) && (_0x13c410[_0x530796(0x53a)] = _0x2337e1[_0x530796(0x53a)][_0x530796(0x33d)](_0x3ea97a => ({ 'offlineBackground': '', ..._0x3ea97a }))['filter'](_0x3d08d0 => _0x3d08d0 && typeof _0x3d08d0 === _0x530796(0x2f6) && _0x3d08d0['id'])); _0x2337e1['accountingData'] && (_0x13c410['accountingData'] = _0x2337e1['accountingData']); if (_0x2337e1[_0x530796(0x246)]) { if (_0x530796(0x9bc) !== _0x530796(0x91e)) _0x13c410[_0x530796(0x246)] = _0x2337e1[_0x530796(0x246)]; else { _0x343254[_0x530796(0x1a0)]('Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.'); const _0x29e785 = _0x109075[_0x530796(0x9c8)][_0x530796(0x33d)](_0xa500f9)[_0x530796(0x61f)](_0x591f71); if (!_0x29e785[_0x530796(0x280)]) return; let _0xc86734 = 0x0; for (const _0x1122dd of _0x29e785) { _0x183edd(_0x1122dd, { 'force': !![], 'delayMs': _0xc86734 }), _0xc86734 += 0x1f4; } } } if (Array[_0x530796(0x850)](_0x2337e1[_0x530796(0x90d)])) { if ('othCM' !== 'othCM') { if (_0x1698c4) { const _0x5d5bb4 = _0x246117[_0x530796(0x602)](_0x44a673); _0x228f48['src'] = _0x5d5bb4, _0x2a7f46[_0x530796(0x3a5)] = () => { _0x2440b3['revokeObjectURL'](_0x5d5bb4); }; } else _0x45eb00[_0x530796(0xaa5)] = _0x530796(0x314); } else _0x13c410[_0x530796(0x90d)] = _0x2337e1[_0x530796(0x90d)]; } Array[_0x530796(0x850)](_0x2337e1[_0x530796(0x324)]) && (_0x13c410[_0x530796(0x324)] = _0x2337e1['diaries']); if (Array[_0x530796(0x850)](_0x2337e1[_0x530796(0x67e)])) { if ('BYqXA' === _0x530796(0x892)) _0x13c410['friendCircles'] = _0x2337e1[_0x530796(0x67e)], _0x13c410[_0x530796(0x6f0)] = _0x2337e1[_0x530796(0x6f0)]; else { const _0x11cceb = _0x2af705[_0x530796(0x4b7)](_0x530796(0x5e9)), _0x305a15 = _0x72ab96[_0x530796(0x14b)][_0x530796(0x36a)], _0x390653 = _0xcb79e0(_0x11cceb[_0x530796(0x14b)][_0x530796(0x12c)], 0xa); _0x1f184f(_0x305a15, _0x390653, _0x5bb960); } } else { if (Array['isArray'](_0x2337e1[_0x530796(0x8a2)]) && _0x2337e1[_0x530796(0x8a2)][_0x530796(0x280)] > 0x0) { console[_0x530796(0x688)](_0x530796(0x3a3)); const _0x5e29a9 = { 'id': _0x530796(0x7e0) + Date[_0x530796(0x2f2)](), 'name': _0x530796(0x394), 'boundUserProfileId': _0x2337e1[_0x530796(0x56d)], 'memberCharacterIds': _0x2337e1['characters']['map'](_0x210927 => _0x210927['id']), 'posts': _0x2337e1[_0x530796(0x8a2)] }; _0x13c410['friendCircles'] = [_0x5e29a9], _0x13c410['activeFriendCircleId'] = _0x5e29a9['id']; } } if (Array['isArray'](_0x2337e1['userProfiles'])) { if (_0x530796(0x55e) !== _0x530796(0x55e)) { const _0x413da2 = _0x15b281['match'](_0x2c0412); if (_0x413da2) { const _0x44ea32 = _0x25cd54(_0x413da2[0x1], 0xa), _0x5a6891 = _0x4a0428(_0x413da2[0x2], 0xa), _0x231e44 = _0x593d14(_0x413da2[0x3], 0xa) * (_0x413da2[0x3][_0x530796(0x280)] === 0x2 ? 0xa : 0x1), _0x34504c = _0x44ea32 * 0x3c + _0x5a6891 + _0x231e44 / 0x3e8, _0x23e4a9 = _0x57694f[_0x530796(0x1b5)](_0x8879c3, '')[_0x530796(0x6eb)](); _0x23e4a9 && _0x11b1d2[_0x530796(0x98f)]({ 'time': _0x34504c, 'text': _0x23e4a9 }); } } else _0x13c410['userProfiles'] = _0x2337e1[_0x530796(0x6ed)], _0x13c410[_0x530796(0x56d)] = _0x2337e1[_0x530796(0x56d)]; } else { if (_0x2337e1[_0x530796(0x787)]) { if (_0x530796(0x758) === _0x530796(0x758)) { console['log'](_0x530796(0x799)); const _0x40d0e7 = { 'id': 'user_' + Date['now'](), 'name': _0x2337e1['userProfile'][_0x530796(0x695)] || '我', 'avatar': _0x2337e1[_0x530796(0x787)][_0x530796(0x907)] || _0x10ed69, 'persona': _0x2337e1[_0x530796(0x787)][_0x530796(0x2a1)] || '' }; _0x13c410['userProfiles'] = [_0x40d0e7], _0x13c410[_0x530796(0x56d)] = _0x40d0e7['id']; } else { if (_0x487fef < 0x0 || _0x2b312a >= _0x257c42) return; _0x5077f9['style']['transform'] = _0x530796(0x773) + _0x33ea22 * (0x64 / _0x57a655) + '%)', _0x49829e[_0x530796(0x8c0)](_0x5c940c => _0x5c940c[_0x530796(0x349)][_0x530796(0x330)](_0x530796(0x513))), _0x56402b[_0x4add5a][_0x530796(0x349)]['add']('active'), _0x507704 = _0x2a37ca; } } } _0x2337e1['apiSettings'] && typeof _0x2337e1[_0x530796(0xa48)] === _0x530796(0x2f6) && (_0x13c410[_0x530796(0xa48)] = { ..._0x13c410['apiSettings'], ..._0x2337e1[_0x530796(0xa48)] }); _0x2337e1[_0x530796(0x859)] && typeof _0x2337e1['preferences'] === _0x530796(0x2f6) ? _0x530796(0x908) !== _0x530796(0x908) ? _0x35c454 && _0x1b9e10(_0x57e106) : _0x13c410[_0x530796(0x859)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x2337e1[_0x530796(0x859)] } : _0x13c410['preferences'] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; if (Array[_0x530796(0x850)](_0x2337e1[_0x530796(0x226)])) { if (_0x530796(0x865) === _0x530796(0x5ee)) { const _0x57f0c5 = (_0x310991 - _0x49381c) / (0x3e8 * 0x3c); _0x57f0c5 < 0x3c ? _0x361ac2 += _0x530796(0x77f) : _0xea9b2c += _0x530796(0x81a) + _0xa9f06f[_0x530796(0x519)](_0x57f0c5 / 0x3c) + '小时前，生成的内容应该符合这段时间的空白。\x0a'; } else _0x13c410['chats'] = _0x2337e1[_0x530796(0x226)], _0x13c410['activeChatId'] = _0x2337e1[_0x530796(0x55f)] || null; } else Array[_0x530796(0x850)](_0x2337e1[_0x530796(0x53a)]) && (console[_0x530796(0x688)](_0x530796(0xef)), _0x13c410[_0x530796(0x226)] = _0x2337e1[_0x530796(0x53a)]['map'](_0x385478 => ({ 'id': _0x530796(0x2fb) + _0x385478['id'], 'type': _0x530796(0x293), 'participantIds': [_0x385478['id']] })), _0x2337e1[_0x530796(0x998)] && (_0x13c410['activeChatId'] = _0x530796(0x2fb) + _0x2337e1[_0x530796(0x998)]), _0x2337e1['characters'][_0x530796(0x8c0)](_0x349f23 => { const _0x9a3b34 = _0x530796, _0x3787bc = _0x9a3b34(0x151) + _0x349f23['id'], _0x37015e = 'chatHistory_chat_' + _0x349f23['id'], _0x13f223 = localStorage[_0x9a3b34(0x310)](_0x3787bc); if (_0x13f223) { if (_0x9a3b34(0x15e) === 'XUGRz') localStorage[_0x9a3b34(0x629)](_0x37015e, _0x13f223), localStorage['removeItem'](_0x3787bc); else { _0x53b18b['error'](_0x9a3b34(0x350) + _0x2d3d50[_0x9a3b34(0x695)] + _0x9a3b34(0x592)); return; } } })); } catch (_0x3f9fc9) { console[_0x530796(0x11e)](_0x530796(0x905), _0x3f9fc9), _0x13c410[_0x530796(0x53a)] = [], _0x13c410[_0x530796(0x226)] = [], _0x13c410[_0x530796(0x55f)] = null; try { _0x530796(0xfa) !== _0x530796(0xfa) ? _0x2d3eae('包含所有图片和音乐的全量数据已成功导出！') : localStorage['removeItem']('appState'); } catch (_0x5efb4a) { console[_0x530796(0x11e)](_0x530796(0x86e), _0x5efb4a); } } let _0x16ee7a = ![]; if (_0x13c410[_0x530796(0x53a)][_0x530796(0x280)] === 0x0) _0x16ee7a = !![], _0x13c410[_0x530796(0x55f)] = null; else !_0x13c410[_0x530796(0x226)]['find'](_0x5e089e => _0x5e089e['id'] === _0x13c410['activeChatId']) && (_0x530796(0x4ad) !== 'lGntb' ? _0x13c410[_0x530796(0x55f)] = _0x13c410[_0x530796(0x226)][0x0]?.['id'] || null : _0x51cb16[_0x530796(0x7d5)](_0x530796(0x3c9))[_0x530796(0x462)][_0x530796(0x81c)]('--feed-bg-image', 'none')); return _0x5834f1(), _0x16ee7a; } function _0xe23b38() { const _0xad32d6 = _0x314838; if (!_0x13c410[_0xad32d6(0x55f)]) return; try { 'Flwor' === 'Flwor' ? localStorage[_0xad32d6(0x629)](_0xad32d6(0x151) + _0x13c410[_0xad32d6(0x55f)], JSON[_0xad32d6(0x3e1)](_0x13c410[_0xad32d6(0x793)])) : _0x407c1c['diaries'] = _0x5d0bc1[_0xad32d6(0x324)]; } catch (_0x544508) { _0xad32d6(0x534) !== _0xad32d6(0x534) ? (_0x2d0345[_0xad32d6(0x11e)](_0xad32d6(0x66d) + _0x49fec6['id'] + '\x20的图片失败:', _0x446fa4), _0x278d55[_0xad32d6(0x268)] = _0x58733['avatar'] || _0x25ff0a) : (console[_0xad32d6(0x11e)]('Failed\x20to\x20save\x20history\x20to\x20localStorage:', _0x544508), _0x1e9edf('无法保存聊天记录。')); } } function _0x1f45f3() { const _0x2a5590 = _0x314838; if (!_0x13c410[_0x2a5590(0x55f)]) { _0x13c410[_0x2a5590(0x793)] = [], _0x403f79(); return; } let _0x1eb5de = null; try { _0x1eb5de = localStorage['getItem'](_0x2a5590(0x151) + _0x13c410[_0x2a5590(0x55f)]); } catch (_0x7e0c1c) { console[_0x2a5590(0x11e)](_0x2a5590(0x8a9) + _0x13c410[_0x2a5590(0x55f)], _0x7e0c1c); } let _0x32db53 = []; if (_0x1eb5de) { if (_0x2a5590(0x358) !== _0x2a5590(0xa61)) try { if (_0x2a5590(0x162) !== _0x2a5590(0x162)) _0x41364d(); else { const _0x44a653 = JSON[_0x2a5590(0xa69)](_0x1eb5de); Array[_0x2a5590(0x850)](_0x44a653) && (_0x32db53 = _0x44a653[_0x2a5590(0x61f)](_0x372465 => _0x372465 && typeof _0x372465 === 'object' && typeof _0x372465[_0x2a5590(0x4cc)] === 'string' && typeof _0x372465[_0x2a5590(0x75a)] !== _0x2a5590(0x171))); } } catch (_0x182f71) { if (_0x2a5590(0x6f2) !== _0x2a5590(0x6f2)) _0xd310b += _0x2a5590(0x2fa) + _0x3e801d[_0x2a5590(0x147)] + _0x2a5590(0x3fe) + _0x2647cc['activity_description'] + _0x2a5590(0x47c); else { console[_0x2a5590(0x11e)](_0x2a5590(0x112) + _0x13c410[_0x2a5590(0x55f)] + ',\x20resetting.', _0x182f71); try { localStorage[_0x2a5590(0x7ec)](_0x2a5590(0x151) + _0x13c410[_0x2a5590(0x55f)]); } catch (_0x50a93f) { if (_0x2a5590(0x34c) !== _0x2a5590(0x22e)) console['error'](_0x2a5590(0x8e9), _0x50a93f); else return _0x31c808(_0x2a5590(0x51a)), ![]; } } } else _0x3959b8[_0x2a5590(0x48d)](_0x101ac4 => { _0x101ac4 ? _0x1dfbf7(_0x101ac4) : _0x33587d(new _0x3f9e56('Canvas\x20to\x20Blob\x20conversion\x20failed.')); }, _0x32f90f, _0x214f13); } _0x13c410[_0x2a5590(0x793)] = _0x32db53, _0x336614[_0x2a5590(0x65e)] = '', _0x13c410[_0x2a5590(0x793)] && _0x13c410[_0x2a5590(0x793)][_0x2a5590(0x8c0)]((_0x3659c3, _0x4f18a1) => _0x23a32c(_0x3659c3, _0x4f18a1)), setTimeout(() => { const _0x4e0e8d = _0x2a5590; _0x336614['scrollTop'] = _0x336614[_0x4e0e8d(0x470)]; }, 0x0); } async function _0x18d655() { const _0x552305 = _0x314838, _0x5f2735 = document['getElementById'](_0x552305(0x209)); if (!_0x5f2735) { console[_0x552305(0x11e)](_0x552305(0x261)); return; } try { let _0x54ae0f = await _0xb9bbbf(_0x552305(0x450)); if (!_0x54ae0f) { if ('HEsAy' !== _0x552305(0x384)) { const _0x1e25a7 = localStorage[_0x552305(0x310)]('customWallpaper'); _0x1e25a7 && (_0x552305(0x6d6) === _0x552305(0x6d6) ? (console[_0x552305(0x688)]('正在为你搬运旧壁纸到新仓库...'), _0x54ae0f = await _0x4904fe(_0x1e25a7), await _0x4162d1('wallpaper_main', _0x54ae0f), localStorage['removeItem']('customWallpaper')) : _0x2953b7(_0x552305(0x875) + _0x550cd5['message'])); } else _0x37e49b += '-\x20**状态提示**:\x20你和Ta上次聊天是在昨天，注意你发言的时间感。\x0a'; } _0x54ae0f ? 'iXIEP' !== _0x552305(0x6e0) ? _0x4b5406(_0x552305(0x490) + _0x53604b[_0x552305(0x496)]) : (_0x5f2735[_0x552305(0x462)]['backgroundImage'] = _0x552305(0x408) + URL[_0x552305(0x602)](_0x54ae0f) + ')', _0x5f2735['style'][_0x552305(0x6b5)] = 'cover', _0x5f2735[_0x552305(0x462)]['backgroundPosition'] = _0x552305(0x2a0)) : _0x552305(0x9af) !== _0x552305(0x9af) ? (_0x40f888[_0x552305(0x11e)](_0x552305(0x74b), _0x5834f9), _0x5ec335('导出失败了，哼:\x20' + _0x1413ec[_0x552305(0x496)])) : _0x5f2735[_0x552305(0x462)][_0x552305(0x97e)] = ''; } catch (_0x42d20f) { if (_0x552305(0x8a0) !== 'vZznG') console[_0x552305(0x11e)](_0x552305(0x992), _0x42d20f), _0x5f2735 && (_0x552305(0x79a) === 'snSKo' ? _0x5f2735[_0x552305(0x462)][_0x552305(0x97e)] = '' : _0x332336 = _0x17ad7e['image']); else { const _0x20e918 = _0x3831d1[_0x552305(0x8ee)](_0x969dfc); _0x20e918 && _0x20e918[_0x552305(0x6ec)](_0x552305(0x274)) && _0x4e9301[_0x552305(0x98f)](_0x20e918); } } } function _0xdad5ba() { const _0x294fc8 = _0x314838, _0x4b1476 = localStorage[_0x294fc8(0x310)](_0x294fc8(0x6c8)); if (_0x4b1476) document['getElementById'](_0x294fc8(0x3c9))[_0x294fc8(0x462)][_0x294fc8(0x81c)](_0x294fc8(0x8b1), _0x294fc8(0x408) + _0x4b1476 + ')'); else { if (_0x294fc8(0x11f) !== 'czmnx') { const _0x305fc4 = _0x34e941['userProfiles'][_0x294fc8(0x9b9)](_0x447b81 => _0x447b81['id'] === _0x451933[_0x294fc8(0x75d)]) || { 'name': _0x294fc8(0x984) }, _0x3df942 = _0x4d3a50[_0x294fc8(0xa30)](_0x294fc8(0xa8b)); _0x3df942['className'] = _0x294fc8(0x4d5), _0x3df942['dataset']['id'] = _0x1a2b2e['id'], _0x3df942[_0x294fc8(0x65e)] = _0x294fc8(0x5a1) + _0x186f9d[_0x294fc8(0x695)] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20' + _0x305fc4[_0x294fc8(0x695)] + _0x294fc8(0xa25) + _0x55867f[_0x294fc8(0x28a)]['length'] + _0x294fc8(0x1fe), _0x3df942[_0x294fc8(0x988)]('click', () => _0xa900e7(_0x256cad['id'])), _0x5796bb['appendChild'](_0x3df942); } else document[_0x294fc8(0x7d5)](_0x294fc8(0x3c9))[_0x294fc8(0x462)]['setProperty'](_0x294fc8(0x8b1), _0x294fc8(0x794)); } } async function _0x3455ed(_0x11bdd1) { const _0x43f0f6 = _0x314838; try { if (_0x43f0f6(0x60b) !== _0x43f0f6(0x389)) await _0x4162d1(_0x43f0f6(0x450), _0x11bdd1), await _0x18d655(), _0x1e9edf(_0x43f0f6(0x99e)); else { _0x5cf54c = _0x20fcde(); const _0x4499f8 = _0x38a019['getElementById'](_0x43f0f6(0x67d))['textContent']; _0x2c4fa1 = _0x4499f8 || _0x43f0f6(0x5a5); } } catch (_0x118aac) { _0x43f0f6(0x39a) === _0x43f0f6(0x39a) ? (console[_0x43f0f6(0x11e)](_0x43f0f6(0x2a9), _0x118aac), _0x1e9edf(_0x43f0f6(0x876) + _0x118aac[_0x43f0f6(0x496)])) : _0x3f8d64(_0x43f0f6(0x131)); } } function _0x20c3d8(_0x432811) { const _0x4a1766 = _0x314838, _0xa2b92b = { 'quotedMessage': null, 'content': _0x432811 }, _0x4580d4 = _0x432811[_0x4a1766(0x2a3)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x4580d4 && (_0xa2b92b['quotedMessage'] = { 'sender': _0x4580d4[0x1][_0x4a1766(0x6eb)](), 'content': _0x4580d4[0x2][_0x4a1766(0x6eb)]() }, _0xa2b92b[_0x4a1766(0x75a)] = _0x432811['substring'](_0x4580d4[0x0]['length'])[_0x4a1766(0x6eb)]()), _0xa2b92b; } const _0x41a15e = document[_0x314838(0x7d5)](_0x314838(0x3c3)), _0x5a6f8c = document[_0x314838(0x7d5)](_0x314838(0x943)), _0x12ba47 = document['getElementById'](_0x314838(0x82b)), _0x3b4fd9 = document[_0x314838(0x7d5)]('delete-message-button'), _0x26c188 = document[_0x314838(0x7d5)]('cancel-action-button'), _0x36fbdd = document['getElementById']('quote-message-button'), _0x275b4d = document[_0x314838(0x7d5)]('edit-message-modal'), _0xb426ce = document[_0x314838(0x7d5)](_0x314838(0x5ba)), _0x2b24f0 = document[_0x314838(0x7d5)](_0x314838(0x91b)), _0x252893 = document['getElementById'](_0x314838(0xf8)), _0x13e292 = document[_0x314838(0x7d5)](_0x314838(0x118)); let _0x3014e0 = null; function _0x8ca2d(_0x1bde42) { const _0x6242b5 = _0x314838; _0x3014e0 = _0x1bde42, _0x41a15e[_0x6242b5(0x349)][_0x6242b5(0x699)](_0x6242b5(0xa12)); } function _0x7994ea() { const _0xa29efe = _0x314838; _0x41a15e['classList'][_0xa29efe(0x330)](_0xa29efe(0xa12)); } function _0x491964() { _0x7994ea(), _0x3014e0 = null; } function _0xa1bd1a() { const _0x9fcfee = _0x314838; if (_0x3014e0 === null) return; _0x13c410[_0x9fcfee(0x793)][_0x9fcfee(0x3f5)](_0x3014e0, 0x1), _0xe23b38(), _0x2522f3(), _0x491964(); } function _0x44a3ba() { const _0x16e4e6 = _0x314838; if (_0x16e4e6(0x881) !== _0x16e4e6(0x881)) _0x563ed4[_0x16e4e6(0x787)][_0x16e4e6(0x695)] = _0x207acb['value'][_0x16e4e6(0x6eb)](), _0x65bf52[_0x16e4e6(0x787)][_0x16e4e6(0x2a1)] = _0x2a77d3['value'][_0x16e4e6(0x6eb)](), _0x2ed974(), _0x22110a(), _0x4ccb33(_0x16e4e6(0x4b9)), _0x249e40('settings', _0x16e4e6(0x787)); else { if (_0x3014e0 === null) return; const _0x2c18ea = _0x13c410[_0x16e4e6(0x793)][_0x3014e0]; if (!_0x2c18ea) return; _0x2b24f0[_0x16e4e6(0x4d3)] = _0x2c18ea[_0x16e4e6(0x75a)], _0x7994ea(), _0x275b4d['classList']['add'](_0x16e4e6(0xa12)), _0x2b24f0[_0x16e4e6(0x40d)](); } } function _0x26da69() { const _0xb12beb = _0x314838; if (_0x3014e0 === null) return; const _0x1316b7 = _0x2b24f0['value']['trim'](); if (_0x1316b7 === '') { _0xc79115(); return; } const _0x2e2a8b = _0x13c410[_0xb12beb(0x793)][_0x3014e0]; _0x2e2a8b && (_0x2e2a8b['content'] = _0x1316b7, _0xe23b38(), _0x2522f3()), _0x275b4d[_0xb12beb(0x349)]['remove'](_0xb12beb(0xa12)), _0x3014e0 = null; } function _0xc79115() { const _0x25556d = _0x314838; _0x275b4d[_0x25556d(0x349)][_0x25556d(0x330)](_0x25556d(0xa12)), _0x3014e0 = null; } _0x5a6f8c[_0x314838(0x988)]('click', _0x491964), _0x26c188[_0x314838(0x988)](_0x314838(0x649), _0x491964), _0x3b4fd9[_0x314838(0x988)]('click', _0xa1bd1a), _0x12ba47['addEventListener'](_0x314838(0x649), _0x44a3ba), _0x36fbdd['addEventListener'](_0x314838(0x649), _0x59e569), _0x490d3c['addEventListener'](_0x314838(0x649), _0x4f11bc), _0x252893[_0x314838(0x988)](_0x314838(0x649), _0x26da69), _0x13e292['addEventListener'](_0x314838(0x649), _0xc79115), _0xb426ce[_0x314838(0x988)](_0x314838(0x649), _0xc79115); function _0x59e569() { const _0x46ee7a = _0x314838; if (_0x46ee7a(0x5cc) === _0x46ee7a(0x8d4)) _0x1aa5c9('图片预览失败:\x20' + _0x5d04e5[_0x46ee7a(0x496)]); else { if (_0x3014e0 === null) return; const _0xae656c = _0x13c410[_0x46ee7a(0x793)][_0x3014e0]; if (!_0xae656c) return; const _0x4e31a3 = _0xee1b45(); let _0x3edb8c = '未知'; if (_0xae656c[_0x46ee7a(0x4cc)] === _0x46ee7a(0x425)) 'nGTcV' === _0x46ee7a(0xa07) ? _0x164710['key'] === _0x46ee7a(0xa94) && !_0x5280c5[_0x46ee7a(0x536)] && (_0xb6bca0[_0x46ee7a(0xa73)](), _0x884b10()) : _0x3edb8c = _0x13c410['userProfile'][_0x46ee7a(0x695)] || '我'; else { const _0x4eff20 = _0xae656c['senderId'] || _0x4e31a3?.['participantIds'][0x0], _0x3ea5e9 = _0x1d08b4(_0x4eff20); _0x3edb8c = _0x3ea5e9 ? _0x3ea5e9[_0x46ee7a(0x695)] : '角色'; } let _0x2adf99 = _0xae656c[_0x46ee7a(0x75a)] || ''; if (_0xae656c[_0x46ee7a(0x8ab)]) _0x2adf99 = '[表情]'; if (_0xae656c[_0x46ee7a(0x98c)]) _0x2adf99 = _0x46ee7a(0x13d); if (_0x2adf99['length'] > 0x32) _0x2adf99 = _0x2adf99['substring'](0x0, 0x32) + _0x46ee7a(0x4d4); _0x13c410[_0x46ee7a(0x5f2)] = { 'sender': _0x3edb8c, 'content': _0x2adf99 }, _0x394e35(), _0x491964(), _0x4225fb['focus'](); } } function _0x394e35() { const _0x370cbb = _0x314838; if (!_0x13c410['activeQuote']) return; _0x1d9877['textContent'] = _0x370cbb(0xa77) + _0x13c410[_0x370cbb(0x5f2)][_0x370cbb(0x6da)], _0x1f2be8[_0x370cbb(0x9e0)] = _0x13c410['activeQuote'][_0x370cbb(0x75a)], _0x2e9876['style'][_0x370cbb(0x5f3)] = _0x370cbb(0x10c); } function _0x4f11bc() { const _0x214cde = _0x314838; _0x13c410['activeQuote'] = null, _0x2e9876[_0x214cde(0x462)][_0x214cde(0x5f3)] = _0x214cde(0x794); } function _0x384da8(_0x3c9caa, _0xee4670) { const _0x3c1851 = _0x314838, _0x7c3940 = document[_0x3c1851(0x7d5)](_0x3c1851(0x571)); if (_0x7c3940) { if (_0x3c9caa === _0x3c1851(0x73e)) 'uoyHX' === _0x3c1851(0x4b5) ? (_0xb9852a(), _0x5841f1(![]), _0x51bed8[_0x3c1851(0x1e8)] = ![]) : _0x7c3940[_0x3c1851(0x462)][_0x3c1851(0x5f3)] = 'inline-block'; else { if ('rjXUk' === _0x3c1851(0x3e0)) _0x7c3940[_0x3c1851(0x462)][_0x3c1851(0x5f3)] = _0x3c1851(0x794); else { if (_0x563918) _0x30188b[_0x3c1851(0x649)](); } } } _0x1a2f27 = _0xee4670 || null, Object[_0x3c1851(0x1f9)](_0x974bdb)[_0x3c1851(0x8c0)](_0xcfa22b => _0xcfa22b[_0x3c1851(0x349)][_0x3c1851(0x330)](_0x3c1851(0x513))), _0x974bdb[_0x3c9caa] && _0x974bdb[_0x3c9caa][_0x3c1851(0x349)][_0x3c1851(0x699)](_0x3c1851(0x513)), _0x3c9caa !== _0x3c1851(0x36c) && (_0x3c1851(0x79d) !== _0x3c1851(0x347) ? _0x5bf37e[_0x3c1851(0x349)][_0x3c1851(0x330)]('show-chat-view') : _0x57ee35[_0x3c1851(0x793)][_0x3c1851(0x8c0)]((_0x500272, _0x1d5c2f) => _0x4ad20d(_0x500272, _0x1d5c2f))); } function _0x4c0af8(_0x88e7a5) { const _0x22f81f = _0x314838; if (_0x88e7a5) { if (_0x22f81f(0x93a) === _0x22f81f(0x93a)) _0x5bf37e[_0x22f81f(0x349)][_0x22f81f(0x699)](_0x22f81f(0x360)); else { const _0x248ba9 = _0x23c206[_0x22f81f(0xa69)](_0x1ebed1[_0x22f81f(0x14b)]['log'][_0x22f81f(0x1b5)](/&quot;/g, '\x22')), _0x26c586 = _0x38ae2e['dataset']['contactName'], _0xd5eaec = _0xb56360[_0x22f81f(0x14b)]['characterName']; _0x5ade7b(_0x26c586, _0xd5eaec, _0x248ba9); } } else { if ('MwHml' !== _0x22f81f(0xe7)) { _0x1ef611[_0x22f81f(0x53a)] = _0x15d193['characters']['filter'](_0x5bf409 => _0x5bf409['id'] !== _0x542e85), _0x206a1f[_0x22f81f(0x226)][_0x22f81f(0x8c0)](_0x4bc5eb => { const _0x12385e = _0x22f81f; _0x4bc5eb[_0x12385e(0x974)] === _0x12385e(0x9ad) && (_0x4bc5eb[_0x12385e(0x9c8)] = _0x4bc5eb[_0x12385e(0x9c8)][_0x12385e(0x61f)](_0x4f0276 => _0x4f0276 !== _0x47f298)); }); const _0x1571d9 = _0x16c82f[_0x22f81f(0x226)][_0x22f81f(0x9b9)](_0x2b7832 => _0x2b7832[_0x22f81f(0x974)] === _0x22f81f(0x293) && _0x2b7832['participantIds'][_0x22f81f(0x71e)](_0x3ffd3d)); _0x1571d9 && _0x2b988b(_0x1571d9['id']), _0x557129['chats'] = _0x364fdd['chats'][_0x22f81f(0x61f)](_0xa9ea67 => _0xa9ea67['type'] !== _0x22f81f(0x9ad) || _0xa9ea67[_0x22f81f(0x9c8)][_0x22f81f(0x280)] > 0x1), _0xff8f50(), _0x101cf1(); } else _0x5bf37e['classList'][_0x22f81f(0x330)](_0x22f81f(0x360)); } } async function _0x2de32d() { const _0xad9f3c = _0x314838; if (_0xad9f3c(0x95e) === 'HCwOM') { _0x39aad8['innerHTML'] = ''; for (const _0x4132d8 of _0x13c410[_0xad9f3c(0x226)]) { const _0x152a66 = document['createElement']('li'); _0x152a66['className'] = _0xad9f3c(0x76d), _0x152a66['dataset']['id'] = _0x4132d8['id']; let _0x4a1b0c = _0x1c044f, _0x41ca5b = '群聊', _0x4f8dd0 = ''; if (_0x4132d8[_0xad9f3c(0x974)] === _0xad9f3c(0x293)) { if (_0xad9f3c(0x85b) === _0xad9f3c(0x8db)) _0x24afeb = _0x1da942; else { const _0x509a65 = _0x1d08b4(_0x4132d8[_0xad9f3c(0x9c8)][0x0]); if (_0x509a65) _0x4a1b0c = _0x509a65['avatar'] || _0x1c044f, _0x41ca5b = _0x509a65[_0xad9f3c(0x695)] || _0xad9f3c(0x229), _0x4f8dd0 = _0x509a65[_0xad9f3c(0x67b)] || '私聊'; else { if (_0xad9f3c(0x10f) === 'WfahM') _0x41ca5b = _0xad9f3c(0x1c4), _0x4f8dd0 = _0xad9f3c(0x4dd); else { _0x10b424['innerHTML'] = _0xad9f3c(0x1f7); return; } } } } else { if (_0xad9f3c(0x4de) !== _0xad9f3c(0x4de)) return _0x2b3dd3[_0xad9f3c(0x688)](_0xad9f3c(0x7ee)), ''; else { _0x41ca5b = _0x4132d8[_0xad9f3c(0x695)] || _0xad9f3c(0xa54), _0x4f8dd0 = _0x4132d8[_0xad9f3c(0x9c8)][_0xad9f3c(0x280)] + _0xad9f3c(0x9c9); const _0x27d518 = await _0xb9bbbf(_0xad9f3c(0x2ef) + _0x4132d8['id']); if (_0x27d518) _0x4a1b0c = URL['createObjectURL'](_0x27d518); } } _0x152a66[_0xad9f3c(0x65e)] = _0xad9f3c(0x9de) + _0x4a1b0c + _0xad9f3c(0x914) + _0x41ca5b + _0xad9f3c(0x839) + _0x4f8dd0 + _0xad9f3c(0x9aa), _0x152a66[_0xad9f3c(0x298)](_0xad9f3c(0x860))[_0xad9f3c(0x988)]('click', () => { _0x48dfc8(_0x4132d8['id']), _0x4c0af8(!![]); }), _0x39aad8[_0xad9f3c(0x3fd)](_0x152a66); } } else { const _0x38788f = _0x11740d[_0xad9f3c(0x7d5)](_0xad9f3c(0x196)), _0x362bac = _0x4fdc02[_0xad9f3c(0x7d5)](_0xad9f3c(0x601)), _0x510d44 = _0x66eae1[_0xad9f3c(0x7d5)](_0xad9f3c(0x704)), _0x2332e8 = _0x396a00[_0xad9f3c(0x7d5)]('widget-cover-art'), _0x16fc26 = _0x1e6523; _0x16fc26 && _0x16fc26[_0xad9f3c(0x580)] ? (_0x362bac[_0xad9f3c(0x9e0)] = _0x16fc26['title'], _0x510d44[_0xad9f3c(0x9e0)] = _0x16fc26[_0xad9f3c(0x376)], _0x38788f[_0xad9f3c(0x349)]['add'](_0xad9f3c(0x22a)), _0x38788f[_0xad9f3c(0x462)][_0xad9f3c(0x81c)]('--widget-cover-image', 'url(' + _0x16fc26[_0xad9f3c(0x45d)] + ')')) : (_0x362bac[_0xad9f3c(0x9e0)] = _0xad9f3c(0x7d3), _0x510d44['textContent'] = '请在动态或聊天中播放', _0x38788f['classList'][_0xad9f3c(0x330)](_0xad9f3c(0x22a)), _0x2332e8[_0xad9f3c(0x462)][_0xad9f3c(0x81c)](_0xad9f3c(0x272), _0xad9f3c(0x794))); } } function _0x58e773() { const _0x309f86 = _0x314838, _0x2dbdd2 = document[_0x309f86(0x7d5)]('meeting-list-container'); _0x2dbdd2[_0x309f86(0x65e)] = ''; const _0xc35f05 = _0x13c410[_0x309f86(0x53a)][_0x309f86(0x61f)](_0x1cec13 => _0x13c410['chats'][_0x309f86(0x6aa)](_0x2c20d6 => _0x2c20d6[_0x309f86(0x974)] === _0x309f86(0x293) && _0x2c20d6[_0x309f86(0x9c8)][_0x309f86(0x71e)](_0x1cec13['id']))); if (_0xc35f05[_0x309f86(0x280)] === 0x0) { _0x2dbdd2[_0x309f86(0x65e)] = _0x309f86(0x942); return; } _0xc35f05[_0x309f86(0x8c0)](_0x151c86 => { const _0x1e51e8 = _0x309f86; if ('iyTzv' !== _0x1e51e8(0x74e)) { const _0x43b5c9 = document[_0x1e51e8(0xa30)]('li'); _0x43b5c9[_0x1e51e8(0x828)] = _0x1e51e8(0x76d), _0x43b5c9['dataset']['charId'] = _0x151c86['id'], _0x43b5c9[_0x1e51e8(0x65e)] = _0x1e51e8(0x81d) + (_0x151c86[_0x1e51e8(0x907)] || _0x1c044f) + _0x1e51e8(0x62f) + _0x151c86[_0x1e51e8(0x695)] + _0x1e51e8(0x9f9) + (_0x151c86[_0x1e51e8(0x67b)] || '私聊') + _0x1e51e8(0x890), _0x43b5c9[_0x1e51e8(0x988)](_0x1e51e8(0x649), () => { _0x42b264(_0x151c86['id']); }), _0x2dbdd2[_0x1e51e8(0x3fd)](_0x43b5c9); } else { if (_0x5f0127[_0x1e51e8(0x4cc)] === _0x1e51e8(0x9bb)) { const _0x2c8694 = _0x429c7c[_0x1e51e8(0x2f9)][_0x2aaf6e]; _0x2c8694 && _0x2c8694['length'] > 0x0 && (_0x4aadc1 = _0x2c8694['at'](-0x1)); } else _0x3212f9 = { 'speaker': _0x2aa140[_0x1e51e8(0x695)], 'line': _0x46b1a0[_0x1e51e8(0x75a)], 'emotion': _0x1e51e8(0x6a9) }; } }); } async function _0x42b264(_0x59233e) { const _0x4aedcd = _0x314838, _0x481d34 = _0x1d08b4(_0x59233e); if (!_0x481d34) return; document['getElementById'](_0x4aedcd(0x245))[_0x4aedcd(0x268)] = '', _0x13c410['activeMeetingCharId'] = _0x59233e; const _0x236f09 = _0x13c410['chats']['find'](_0x200948 => _0x200948[_0x4aedcd(0x974)] === 'private' && _0x200948[_0x4aedcd(0x9c8)][_0x4aedcd(0x71e)](_0x59233e)); _0x236f09 ? _0x4aedcd(0x4aa) !== _0x4aedcd(0x4aa) ? (_0x142554['error']('加载立绘失败:', _0x54492c), _0x521b89[_0x4aedcd(0x268)] = '') : (_0x13c410[_0x4aedcd(0x55f)] = _0x236f09['id'], _0x5834f1(), _0x1f45f3(), _0x498be5(_0x59233e)) : _0x13c410[_0x4aedcd(0x793)] = []; document[_0x4aedcd(0x7d5)](_0x4aedcd(0x1c5))['textContent'] = _0x481d34['name']; const _0x5bcbc0 = document[_0x4aedcd(0x7d5)](_0x4aedcd(0x63e)); try { if (_0x4aedcd(0x721) !== _0x4aedcd(0x721)) _0x451543(_0x1e8475[_0x4aedcd(0x5de)])[_0x4aedcd(0x834)](_0x2ef9c8 => { const _0x2e1257 = _0x4aedcd, _0x3e17c3 = _0x53bf35[_0x2e1257(0x7d5)](_0x4b7ed3); if (_0x3e17c3 && _0x2ef9c8) _0x3e17c3[_0x2e1257(0x268)] = _0x1fb8b1[_0x2e1257(0x602)](_0x2ef9c8); }); else { const _0x31be09 = await _0xb9bbbf(_0x4aedcd(0x87d) + _0x59233e); _0x31be09 ? 'BnygC' === _0x4aedcd(0x1bf) ? (_0x5bcbc0[_0x4aedcd(0x462)][_0x4aedcd(0x97e)] = _0x4aedcd(0x5ce) + URL[_0x4aedcd(0x602)](_0x31be09) + '\x27)', _0x5bcbc0[_0x4aedcd(0x462)]['backgroundSize'] = _0x4aedcd(0x45d), _0x5bcbc0[_0x4aedcd(0x462)][_0x4aedcd(0x697)] = _0x4aedcd(0x2a0)) : _0x2efafe[_0x4aedcd(0x988)](_0x4aedcd(0x649), () => { const _0x177578 = _0x4aedcd, _0x1d7b93 = _0x233ffd[_0x177578(0xa69)](_0x394010[_0x177578(0x14b)][_0x177578(0x688)][_0x177578(0x1b5)](/&quot;/g, '\x22')), _0x3f0ac3 = _0x51d941[_0x177578(0x14b)][_0x177578(0x8b5)], _0x32f3dd = _0x582f50[_0x177578(0x14b)]['characterName']; _0x2ab170(_0x3f0ac3, _0x32f3dd, _0x1d7b93); }) : _0x5bcbc0['style'][_0x4aedcd(0x97e)] = _0x4aedcd(0x794); } } catch (_0x3a0b18) { if (_0x4aedcd(0x6b0) !== 'mhCST') return { 'type': 'text', 'content': _0x14b04c }; else console[_0x4aedcd(0x11e)]('加载见面背景失败\x20for\x20' + _0x59233e + ':', _0x3a0b18), _0x5bcbc0[_0x4aedcd(0x462)][_0x4aedcd(0x97e)] = 'none'; } _0x459b6a(), _0x12b369(); if (_0x2a6a1f) clearInterval(_0x2a6a1f); _0x4df4b7(), _0x2a6a1f = setInterval(_0x4df4b7, 0x2710), document[_0x4aedcd(0x7d5)](_0x4aedcd(0xa82))[_0x4aedcd(0x462)][_0x4aedcd(0x5f3)] = _0x4aedcd(0x10c), _0x384da8(_0x4aedcd(0x96b), _0x4aedcd(0x2e7)); } function _0x12b369() { const _0x3b8a28 = _0x314838, _0x556929 = document[_0x3b8a28(0x7d5)](_0x3b8a28(0x913)); _0x556929[_0x3b8a28(0x65e)] = ''; const _0x1710b8 = _0x556929[_0x3b8a28(0x298)]('#message-anchor'); if (_0x1710b8) _0x1710b8['remove'](); _0x13c410['conversationHistory'] && _0x13c410[_0x3b8a28(0x793)]['forEach']((_0x2790d5, _0x515eb4) => { const _0x45fa69 = _0x3b8a28; if (!_0x2790d5[_0x45fa69(0x9d3)] || _0x2790d5[_0x45fa69(0x4cc)] === 'system') return; const _0x219810 = document[_0x45fa69(0xa30)]('p'); _0x219810['dataset'][_0x45fa69(0x12c)] = _0x515eb4; const _0x2495c1 = _0x2790d5[_0x45fa69(0x75a)][_0x45fa69(0x1b5)](/\n/g, _0x45fa69(0x783)); let _0x553a6f = '', _0x4dfee7 = ''; const _0x29220f = _0x328a3b(_0x13c410[_0x45fa69(0x55f)]); if (_0x2790d5[_0x45fa69(0x4cc)] === 'user') _0x553a6f = _0x29220f[_0x45fa69(0x695)] || '我', _0x4dfee7 = 'speaker-user'; else { if (_0x2790d5[_0x45fa69(0x4cc)] === _0x45fa69(0x9bb)) { if (_0x45fa69(0x341) === _0x45fa69(0x341)) { const _0x5dd9a8 = _0x1d08b4(_0x2790d5[_0x45fa69(0x7c4)] || _0x13c410[_0x45fa69(0x2c7)]); _0x553a6f = _0x5dd9a8?.['name'] || '角色', _0x4dfee7 = _0x45fa69(0x687); } else { const _0x4b4517 = _0x3d7113[_0x45fa69(0x2f9)][_0x401d27[_0x45fa69(0x2c7)]]; if (_0x4b4517 && _0x4b4517[_0x45fa69(0x280)] > 0x0) { _0x8a1264[_0x45fa69(0x12e)] = [..._0x4b4517]; const _0xfc4eb3 = _0x221d1c[_0x45fa69(0x12e)][_0x45fa69(0x13c)](); _0x34e572['textContent'] = _0xfc4eb3[_0x45fa69(0x31c)] === 'narrator' ? '旁白' : _0xfc4eb3[_0x45fa69(0x31c)], _0x1ed019[_0x45fa69(0x9e0)] = _0xfc4eb3['line'], _0xfc4eb3['speaker'] !== _0x45fa69(0x2a6) && _0x3b6cc2(_0x1ec44f[_0x45fa69(0x2c7)], _0xfc4eb3[_0x45fa69(0x248)]); } else _0x238540[_0x45fa69(0x9e0)] = '旁白', _0x1ed0b5[_0x45fa69(0x9e0)] = _0x45fa69(0x87f); } } } _0x219810[_0x45fa69(0x462)][_0x45fa69(0x18f)] = _0x45fa69(0x49e), _0x219810[_0x45fa69(0x462)]['padding'] = '15px\x2020px', _0x219810['style'][_0x45fa69(0x203)] = _0x45fa69(0x856), _0x219810[_0x45fa69(0x462)][_0x45fa69(0x404)] = _0x45fa69(0xf1), _0x553a6f ? _0x219810[_0x45fa69(0x65e)] = '<span\x20class=\x22' + _0x4dfee7 + _0x45fa69(0x8e0) + (_0x4dfee7 === _0x45fa69(0xeb) ? '#a7c7e7' : '#f2b7c6') + ';\x22>' + _0x553a6f + _0x45fa69(0xe4) + _0x2495c1 : (_0x219810[_0x45fa69(0x828)] = 'narrator', _0x219810[_0x45fa69(0x462)][_0x45fa69(0x520)] = _0x45fa69(0x333), _0x219810[_0x45fa69(0x462)]['color'] = '#d1d5db', _0x219810[_0x45fa69(0x65e)] = _0x2495c1), _0x556929[_0x45fa69(0x3fd)](_0x219810); }); if (_0x13c410[_0x3b8a28(0x1e8)]) { let _0x5cf825 = _0x556929[_0x3b8a28(0x298)]('.typing-indicator'); !_0x5cf825 && (_0x5cf825 = document[_0x3b8a28(0xa30)]('div'), _0x5cf825[_0x3b8a28(0x828)] = 'typing-indicator', _0x5cf825[_0x3b8a28(0x9e0)] = '对方正在行动中...', _0x5cf825[_0x3b8a28(0x462)]['backgroundColor'] = _0x3b8a28(0x49e), _0x5cf825['style'][_0x3b8a28(0x4f7)] = _0x3b8a28(0x368), _0x5cf825[_0x3b8a28(0x462)][_0x3b8a28(0x203)] = _0x3b8a28(0x856), _0x556929[_0x3b8a28(0x3fd)](_0x5cf825)); } const _0x187f19 = document[_0x3b8a28(0xa30)](_0x3b8a28(0xa8b)); _0x187f19['id'] = _0x3b8a28(0x1b2), _0x556929[_0x3b8a28(0x3fd)](_0x187f19), setTimeout(() => { const _0x455d01 = _0x3b8a28; _0x187f19[_0x455d01(0x8cc)]({ 'behavior': _0x455d01(0x25a), 'block': _0x455d01(0x554) }); }, 0x32); } function _0x2522f3() { const _0xbb8dad = _0x314838, _0x1f4f08 = document[_0xbb8dad(0x298)]('.screen.active'); if (!_0x1f4f08) return; _0x1f4f08['id'] === _0xbb8dad(0x5aa) ? _0x12b369() : _0x403f79(); } function _0x403f79() { const _0x4eeaba = _0x314838; if (_0x4eeaba(0x275) !== _0x4eeaba(0x931)) { const _0x13c5f1 = _0x13c410['conversationHistory'][_0x4eeaba(0x61f)](_0x24ab6f => !_0x24ab6f[_0x4eeaba(0x9d3)] && _0x24ab6f[_0x4eeaba(0x4cc)] !== 'system'); if (_0x13c5f1['length'] > _0x13c410['displayedMessageCount']) { let _0x3c7485 = _0x336614['querySelector'](_0x4eeaba(0x9b8)); !_0x3c7485 && (_0x4eeaba(0x878) !== _0x4eeaba(0x91c) ? (_0x3c7485 = document[_0x4eeaba(0xa30)](_0x4eeaba(0x387)), _0x3c7485[_0x4eeaba(0x9e0)] = _0x4eeaba(0x60d), _0x3c7485['className'] = _0x4eeaba(0x7dd), _0x3c7485['style']['width'] = 'auto', _0x3c7485[_0x4eeaba(0x462)]['margin'] = _0x4eeaba(0x8c7), _0x3c7485[_0x4eeaba(0x462)][_0x4eeaba(0x4f7)] = _0x4eeaba(0x938), _0x3c7485[_0x4eeaba(0x779)] = () => { const _0x3895e7 = _0x4eeaba, _0xb62654 = _0x336614, _0x3c0f89 = _0xb62654[_0x3895e7(0x470)], _0x1f48cf = _0xb62654[_0x3895e7(0x5f8)]; _0x13c410[_0x3895e7(0x476)] += 0x64, _0x403f79(), requestAnimationFrame(() => { const _0x119b01 = _0x3895e7; if ('uipew' === _0x119b01(0x823)) { const _0x2d058e = _0xb62654[_0x119b01(0x470)]; _0xb62654[_0x119b01(0x5f8)] = _0x1f48cf + (_0x2d058e - _0x3c0f89); } else { const _0x1adfba = _0x18310d['getItem'](_0x119b01(0x156)); if (_0x1adfba) { const _0xc81c03 = _0x58aab1[_0x119b01(0xa69)](_0x1adfba); _0xc81c03[_0x119b01(0x246)] && (_0x622f07[_0x119b01(0x246)] = _0xc81c03['accountingLedger'], _0x2bbb13[_0x119b01(0x688)]('Noir\x27s\x20Temporal\x20Patch:\x20Ledger\x20re-synchronized.')); } } }); }, _0x336614[_0x4eeaba(0x4a8)] ? _0x336614['insertBefore'](_0x3c7485, _0x336614[_0x4eeaba(0x4a8)]) : _0x4eeaba(0x8e2) !== _0x4eeaba(0x8e2) ? _0x59860e[_0x53bffa] = _0x4aa4f3[_0x4eeaba(0xa69)](_0x1a20aa) : _0x336614['appendChild'](_0x3c7485)) : _0x251671[_0x4eeaba(0x268)] = _0x2175f0['createObjectURL'](_0x1dd58e)); } else { if ('JeuCr' === _0x4eeaba(0x3a4)) { const _0x46d4b2 = _0x336614['querySelector'](_0x4eeaba(0x9b8)); if (_0x46d4b2) _0x46d4b2[_0x4eeaba(0x330)](); } else _0x35365e += _0x4eeaba(0xa0a) + _0x284b08[_0x4eeaba(0x519)](_0x472e0e / 0x3c) + _0x4eeaba(0x5be); } Array[_0x4eeaba(0x703)](_0x336614['children'])['forEach'](_0x16b25e => { const _0x5de646 = _0x4eeaba; !_0x16b25e[_0x5de646(0x349)][_0x5de646(0x741)](_0x5de646(0x775)) && _0x16b25e[_0x5de646(0x330)](); }); const _0x3ab802 = _0x13c5f1[_0x4eeaba(0x6d1)](-_0x13c410[_0x4eeaba(0x476)]); _0x3ab802['forEach'](_0x49e25d => { const _0x395fee = _0x4eeaba; if ('VqOBg' !== _0x395fee(0x153)) { const _0x52c2c2 = _0x13c410['conversationHistory'][_0x395fee(0x861)](_0x49e25d); _0x52c2c2 > -0x1 && _0x23a32c(_0x49e25d, _0x52c2c2); } else { const _0x15f9fd = _0x17cd29[0x0]['trim'](), _0x4df43e = _0x37a8c9[0x1][_0x395fee(0x6eb)]()[_0x395fee(0x1b5)](/^"|"$/g, ''); _0x5e196f[_0x15f9fd] = _0x4df43e; } }); if (_0x13c410[_0x4eeaba(0x1e8)]) { let _0x107d93 = _0x336614[_0x4eeaba(0x298)](_0x4eeaba(0x40f)); !_0x107d93 && (_0x107d93 = document[_0x4eeaba(0xa30)](_0x4eeaba(0xa8b)), _0x107d93[_0x4eeaba(0x828)] = _0x4eeaba(0x2dc), _0x107d93[_0x4eeaba(0x9e0)] = _0x4eeaba(0xa74), _0x336614['appendChild'](_0x107d93)); } _0x3ab802['length'] <= _0x13c410[_0x4eeaba(0x476)] && ('cqWIt' !== _0x4eeaba(0x74a) ? _0x3ea574 += _0x4eeaba(0x18b) + _0x3d3c48[_0x4eeaba(0x69b)] + _0x4eeaba(0x3c0) + _0x48add0[_0x4eeaba(0x956)][_0x4eeaba(0x8aa)]('、') + '。\x0a' : setTimeout(() => { const _0x1ad3fc = _0x4eeaba; _0x336614['scrollTop'] = _0x336614[_0x1ad3fc(0x470)]; }, 0x0)); } else _0x49cd4b[_0x4eeaba(0x6e9)](_0x44f3f2, { 'songName': _0x105024, 'artist': _0x37dd6e, 'coverId': null, 'playableUrl': null }); } function _0x23a32c(_0x4e8be7, _0x175d4d) { const _0x1f90e5 = _0x314838, { role: _0x4fa1e8, content: _0x516dff, displayUrl: _0x5450f3, image: _0x3c8051, senderId: _0x363a63 } = _0x4e8be7, _0x5e2084 = _0x4fa1e8 === _0x1f90e5(0x9bb) ? 'ai' : _0x4fa1e8, _0x1067c9 = _0xee1b45(), _0x448c5a = document[_0x1f90e5(0xa30)](_0x1f90e5(0xa8b)); _0x448c5a[_0x1f90e5(0x349)][_0x1f90e5(0x699)](_0x1f90e5(0x401), _0x5e2084), _0x448c5a[_0x1f90e5(0x14b)][_0x1f90e5(0x12c)] = _0x175d4d; const _0x1875d3 = document[_0x1f90e5(0xa30)](_0x1f90e5(0xa8b)); _0x1875d3['className'] = _0x1f90e5(0xa50); const _0x934e25 = document[_0x1f90e5(0xa30)]('img'); _0x934e25[_0x1f90e5(0x349)]['add'](_0x1f90e5(0x907), _0x4fa1e8 + _0x1f90e5(0x31e)); let _0x393597 = ''; if (_0x4fa1e8 === _0x1f90e5(0x425)) { const _0x33eae9 = _0x328a3b(_0x13c410[_0x1f90e5(0x55f)]); _0x393597 = _0x33eae9[_0x1f90e5(0x907)] || _0x10ed69; } else { _0x393597 = _0x1c044f; let _0x3f8183 = null; if (_0x1067c9?.[_0x1f90e5(0x974)] === _0x1f90e5(0x293)) { if (_0x1f90e5(0x5db) === 'hvGdw') _0x3f8183 = _0x1d08b4(_0x1067c9[_0x1f90e5(0x9c8)][0x0]); else { _0x27ae2b(); const _0x6268eb = (_0x1a62f7['apiSettings'][_0x1f90e5(0x7d7)] || '')[_0x1f90e5(0x71e)](_0x246bb6); _0x31a524[_0x1f90e5(0x99f)] = _0x6268eb, _0x4eb093(_0x1f90e5(0x9d7), _0x1f90e5(0x73e)); } } else { if (_0x1067c9?.[_0x1f90e5(0x974)] === 'group' && _0x363a63) { if ('SMfES' !== _0x1f90e5(0x59d)) _0x3f8183 = _0x1d08b4(_0x363a63); else { _0x69bc40[_0x1f90e5(0x65e)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以视奸的角色。</p>'; return; } } } _0x3f8183?.[_0x1f90e5(0x907)] && (_0x1f90e5(0x623) === 'riJgI' ? _0x49ea5a(_0x1f90e5(0x875) + _0x4cf9be[_0x1f90e5(0x496)]) : _0x393597 = _0x3f8183[_0x1f90e5(0x907)]); } _0x934e25[_0x1f90e5(0x268)] = _0x393597, _0x934e25['alt'] = _0x4fa1e8 + _0x1f90e5(0x9eb); const _0x57b534 = _0x516dff && _0x516dff[_0x1f90e5(0x6eb)]()[_0x1f90e5(0x6ec)](_0x1f90e5(0x5b9)) && _0x516dff[_0x1f90e5(0x6eb)]()[_0x1f90e5(0x771)]('</div>'); if (_0x57b534) { const _0x8c38d9 = document[_0x1f90e5(0xa30)](_0x1f90e5(0xa8b)); _0x8c38d9[_0x1f90e5(0x828)] = _0x1f90e5(0x487), _0x8c38d9[_0x1f90e5(0x65e)] = _0x516dff, _0x5e2084 === _0x1f90e5(0x425) ? (_0x1875d3[_0x1f90e5(0x3fd)](_0x8c38d9), _0x1875d3[_0x1f90e5(0x3fd)](_0x934e25)) : (_0x1875d3[_0x1f90e5(0x3fd)](_0x934e25), _0x1875d3[_0x1f90e5(0x3fd)](_0x8c38d9)); } else { const _0x19ae57 = document[_0x1f90e5(0xa30)]('div'); _0x19ae57['classList'][_0x1f90e5(0x699)](_0x1f90e5(0x496), _0x5e2084); if (_0x1067c9?.[_0x1f90e5(0x974)] === _0x1f90e5(0x293)) { const _0x38452e = _0x1067c9[_0x1f90e5(0x9c8)][0x0]; _0x19ae57[_0x1f90e5(0x349)][_0x1f90e5(0x699)](_0x1f90e5(0x68f) + _0x38452e); } if (_0x4e8be7[_0x1f90e5(0x765)]) { if ('bMoMZ' !== 'bMoMZ') _0x54f855(![]), _0x4afee8[_0x1f90e5(0x11e)]('解析音乐文件失败:', _0x3c6a94), _0x95079(_0x1f90e5(0x6b4) + _0x685046[_0x1f90e5(0x496)]); else { const _0x2b2d80 = document['createElement'](_0x1f90e5(0xa8b)); _0x2b2d80[_0x1f90e5(0x828)] = 'quoted-message-in-bubble'; const _0x9f7b4 = document[_0x1f90e5(0xa30)](_0x1f90e5(0xa8b)); _0x9f7b4[_0x1f90e5(0x828)] = _0x1f90e5(0x632), _0x9f7b4[_0x1f90e5(0x9e0)] = _0x4e8be7['quotedMessage']['sender']; const _0x2ae198 = document[_0x1f90e5(0xa30)]('div'); _0x2ae198[_0x1f90e5(0x828)] = _0x1f90e5(0x160), _0x2ae198[_0x1f90e5(0x9e0)] = _0x4e8be7[_0x1f90e5(0x765)][_0x1f90e5(0x75a)], _0x2b2d80['appendChild'](_0x9f7b4), _0x2b2d80[_0x1f90e5(0x3fd)](_0x2ae198), _0x19ae57['appendChild'](_0x2b2d80); } } if (_0x5450f3) { if (_0x1f90e5(0x1a9) === _0x1f90e5(0x774)) _0xf74243 = _0x1f90e5(0x1e9); else { _0x19ae57[_0x1f90e5(0x349)][_0x1f90e5(0x699)](_0x1f90e5(0x52b)); const _0x2012c8 = document[_0x1f90e5(0xa30)](_0x1f90e5(0xa02)); _0x2012c8[_0x1f90e5(0x268)] = _0x5450f3, _0x2012c8[_0x1f90e5(0x349)]['add'](_0x1f90e5(0x91a)), _0x19ae57[_0x1f90e5(0x3fd)](_0x2012c8); } } else { if (_0x4e8be7[_0x1f90e5(0x98c)] || _0x4e8be7[_0x1f90e5(0x5bb)]) { if (_0x1f90e5(0x70b) !== _0x1f90e5(0x70b)) return new _0x3906e5(_0x40abc1 => { const _0x11e2db = _0x1f90e5, _0x319fb7 = _0x54c3b4['getElementById'](_0x11e2db(0x8c1)), _0x4c87dd = _0x433c98[_0x11e2db(0x7d5)]('modal-text'), _0x5bb821 = _0x44c713[_0x11e2db(0x7d5)](_0x11e2db(0x929)), _0x59d233 = _0x50a611['getElementById'](_0x11e2db(0x63f)), _0x2275e1 = _0x3b4b09[_0x11e2db(0x7d5)](_0x11e2db(0x650)); _0x4c87dd[_0x11e2db(0x9e0)] = _0x22a505, _0x319fb7[_0x11e2db(0x462)][_0x11e2db(0x5f3)] = 'flex'; const _0x364cef = _0x53c870 => { const _0x318d01 = _0x11e2db; _0x319fb7['style']['display'] = _0x318d01(0x794), _0x5bb821[_0x318d01(0x779)] = _0x59d233[_0x318d01(0x779)] = _0x2275e1[_0x318d01(0x779)] = null, _0x3b2f85['removeEventListener'](_0x318d01(0x610), _0x57efad), _0x40abc1(_0x53c870); }, _0x57efad = _0x308269 => { const _0xfea770 = _0x11e2db; if (_0x308269[_0xfea770(0x8ee)] === _0xfea770(0x5ac)) _0x364cef(![]); if (_0x308269[_0xfea770(0x8ee)] === _0xfea770(0xa94)) _0x364cef(!![]); }; _0x5bb821[_0x11e2db(0x779)] = () => _0x364cef(!![]), _0x59d233[_0x11e2db(0x779)] = () => _0x364cef(![]), _0x2275e1[_0x11e2db(0x779)] = () => _0x364cef(![]), _0x917ea9[_0x11e2db(0x988)](_0x11e2db(0x610), _0x57efad); }); else { _0x19ae57[_0x1f90e5(0x349)]['add'](_0x1f90e5(0x98c)); const _0x220ea3 = document[_0x1f90e5(0xa30)]('img'); _0x220ea3['classList'][_0x1f90e5(0x699)](_0x1f90e5(0x589)), _0x19ae57[_0x1f90e5(0x3fd)](_0x220ea3); _0x4e8be7['image'] ? _0x1f90e5(0x218) !== _0x1f90e5(0x218) ? _0xacfaa8 = _0x147938[0x1] : _0x220ea3[_0x1f90e5(0x268)] = _0x4e8be7[_0x1f90e5(0x98c)] : (_0x220ea3[_0x1f90e5(0x268)] = _0x1f90e5(0x215), _0xb9bbbf(_0x4e8be7[_0x1f90e5(0x5bb)])['then'](_0x5b2af9 => { const _0x332fc0 = _0x1f90e5; if (_0x5b2af9) { if (_0x332fc0(0x842) === 'dHALy') { const _0x333e41 = URL[_0x332fc0(0x602)](_0x5b2af9); _0x220ea3[_0x332fc0(0x268)] = _0x333e41, _0x220ea3[_0x332fc0(0x3a5)] = () => { const _0x21e26d = _0x332fc0; if (_0x21e26d(0x70f) === _0x21e26d(0x51d)) { if (_0x31eded[_0x21e26d(0x8ab)]) _0x5d06a9['push']('[' + _0x409404(_0x406a32) + _0x21e26d(0x177) + (_0x79eb4e[_0x21e26d(0x75a)]?.[_0x21e26d(0x2a3)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x5bdc03[_0x21e26d(0x98c)]) { const _0x51dbfc = _0x4921bb['content'] ? '\x20' + _0x4527bc[_0x21e26d(0x75a)] : ''; _0x12dc30[_0x21e26d(0x98f)]('[' + _0x57336c(_0x27ed1f) + ']\x20[image]' + _0x51dbfc); } else _0x53e1bc[_0x21e26d(0x75a)] && _0x1d55b5['push']('[' + _0x1ad62d(_0x290568) + ']\x20' + _0x5b263e[_0x21e26d(0x75a)]); } } else URL[_0x21e26d(0x918)](_0x333e41); }; } else _0x120511[_0x332fc0(0x268)] = _0x6eda7a['createObjectURL'](_0x185e2c), _0x193caa[_0x332fc0(0x462)][_0x332fc0(0x5f3)] = _0x332fc0(0x10c); } else _0x220ea3['alt'] = '图片加载失败'; })['catch'](_0x33ec20 => { const _0x33d03f = _0x1f90e5; if (_0x33d03f(0x50c) === _0x33d03f(0x538)) { _0x175b77[_0x33d03f(0x11e)](_0x33d03f(0x261)); return; } else console[_0x33d03f(0x11e)](_0x33d03f(0x38b), _0x33ec20), _0x220ea3[_0x33d03f(0xaa5)] = _0x33d03f(0x314); })); if (_0x516dff) { const _0x47d216 = document[_0x1f90e5(0xa30)]('p'); _0x47d216['style'][_0x1f90e5(0x6c2)] = '5px', _0x47d216[_0x1f90e5(0x9e0)] = _0x516dff, _0x19ae57[_0x1f90e5(0x3fd)](_0x47d216); } } } else { if (_0x4e8be7[_0x1f90e5(0x974)] === _0x1f90e5(0x3ca)) { _0x19ae57['classList'][_0x1f90e5(0x699)](_0x1f90e5(0x3ca)); const _0x2001dd = _0x4e8be7[_0x1f90e5(0x4cc)] === _0x1f90e5(0x425) ? _0x328a3b(_0x13c410[_0x1f90e5(0x55f)]) : _0x1d08b4(_0x4e8be7[_0x1f90e5(0x7c4)]), _0x5472bc = _0x4e8be7[_0x1f90e5(0x155)] === _0x328a3b(_0x13c410['activeChatId'])['id'] ? _0x328a3b(_0x13c410[_0x1f90e5(0x55f)]) : _0x1d08b4(_0x4e8be7[_0x1f90e5(0x155)]), _0x220de6 = _0x2001dd?.[_0x1f90e5(0x695)] ? _0x2001dd[_0x1f90e5(0x695)] + _0x1f90e5(0x5fe) : '转账', _0x163ea5 = _0x5472bc?.[_0x1f90e5(0x695)] ? _0x1f90e5(0x27b) + _0x5472bc[_0x1f90e5(0x695)] : '转账', _0x5e18e2 = _0x1f90e5(0x2db) + _0x220de6 + _0x1f90e5(0x37f) + _0x4e8be7[_0x1f90e5(0x5ca)][_0x1f90e5(0x176)](0x2) + _0x1f90e5(0x17d) + _0x163ea5 + _0x1f90e5(0x9c0); _0x19ae57[_0x1f90e5(0x65e)] = _0x5e18e2; } else { if (_0x4e8be7[_0x1f90e5(0x974)] === 'listen-together-invite') { _0x19ae57[_0x1f90e5(0x349)][_0x1f90e5(0x699)](_0x1f90e5(0x44d)); const _0xe13457 = document[_0x1f90e5(0xa30)](_0x1f90e5(0xa8b)); _0xe13457[_0x1f90e5(0x828)] = _0x1f90e5(0x4f0), _0xe13457[_0x1f90e5(0x349)][_0x1f90e5(0x699)](_0x1f90e5(0x617)); const _0x5aa62f = _0x4e8be7[_0x1f90e5(0x4cc)] === 'user' ? _0x328a3b(_0x13c410[_0x1f90e5(0x55f)])[_0x1f90e5(0x695)] || '你' : _0x1d08b4(_0x4e8be7[_0x1f90e5(0x7c4)])?.['name'] || 'TA', _0x41501f = _0x1f90e5(0x27c) + _0x4e8be7[_0x1f90e5(0x921)], _0x4a422d = _0x1f90e5(0x2ff) + _0x41501f + '\x22\x20src=\x22' + _0x1c044f + '\x22>'; _0x4e8be7[_0x1f90e5(0x5de)] && _0xb9bbbf(_0x4e8be7[_0x1f90e5(0x5de)])[_0x1f90e5(0x834)](_0x1cb0b4 => { const _0x37219d = _0x1f90e5, _0x418ac0 = document[_0x37219d(0x7d5)](_0x41501f); if (_0x418ac0 && _0x1cb0b4) _0x418ac0[_0x37219d(0x268)] = URL[_0x37219d(0x602)](_0x1cb0b4); }), _0x4e8be7[_0x1f90e5(0x143)] ? _0x1f90e5(0x35c) === 'KlObt' ? _0xe13457[_0x1f90e5(0x65e)] = _0x1f90e5(0xa59) + _0x4a422d + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x4e8be7[_0x1f90e5(0x30d)] + _0x1f90e5(0x9a7) + _0x4e8be7[_0x1f90e5(0x376)] + _0x1f90e5(0x443) : (_0x3cabb4(), _0x17378d['displayedMessageCount'] = 0x64) : 'LlAur' !== 'LlAur' ? _0x3cf7a3[_0x1f90e5(0x859)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null } : _0xe13457['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>' + _0x5aa62f + _0x1f90e5(0x500) + _0x4a422d + _0x1f90e5(0x446) + _0x4e8be7[_0x1f90e5(0x30d)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x4e8be7['artist'] + _0x1f90e5(0x2d1) + _0x4e8be7['songId'] + _0x1f90e5(0x628), _0x19ae57[_0x1f90e5(0x3fd)](_0xe13457); } else { if (_0x4e8be7[_0x1f90e5(0x974)] === _0x1f90e5(0x44d) && _0x4e8be7['songName']) { _0x19ae57[_0x1f90e5(0x349)][_0x1f90e5(0x699)](_0x1f90e5(0x44d)); const _0x1b4f2a = document[_0x1f90e5(0xa30)](_0x1f90e5(0xa8b)); _0x1b4f2a[_0x1f90e5(0x828)] = _0x1f90e5(0x645), _0x1b4f2a[_0x1f90e5(0x14b)][_0x1f90e5(0xaa6)] = _0x1f90e5(0x96c) + _0x4e8be7[_0x1f90e5(0x921)]; const _0x1c4ccf = _0x1f90e5(0x27c) + _0x4e8be7['timestamp'], _0x49f04b = _0x1f90e5(0x434) + _0x1c044f + '\x22\x20id=\x22' + _0x1c4ccf + '\x22\x20class=\x22music-share-cover\x22>'; if (_0x4e8be7['coverId']) { if (_0x1f90e5(0x214) === _0x1f90e5(0x672)) { _0xece19e(_0x1f90e5(0x1f3)); return; } else _0xb9bbbf(_0x4e8be7[_0x1f90e5(0x5de)])[_0x1f90e5(0x834)](_0x34ecc0 => { const _0x49d9ed = _0x1f90e5, _0x5d80f5 = document[_0x49d9ed(0x7d5)](_0x1c4ccf); if (_0x5d80f5 && _0x34ecc0) _0x5d80f5['src'] = URL[_0x49d9ed(0x602)](_0x34ecc0); }); } else _0x4e8be7[_0x1f90e5(0x2e6)] && setTimeout(() => { const _0xe4f0ae = _0x1f90e5; if (_0xe4f0ae(0x872) !== _0xe4f0ae(0x872)) _0xf48093[_0xe4f0ae(0x268)] = _0x586709['createObjectURL'](_0x36c5bf), _0x5ccaa8[_0xe4f0ae(0x462)][_0xe4f0ae(0x5f3)] = _0xe4f0ae(0x10c); else { const _0x3f4dd5 = document[_0xe4f0ae(0x7d5)](_0x1c4ccf); if (_0x3f4dd5) _0x3f4dd5[_0xe4f0ae(0x268)] = _0x4e8be7[_0xe4f0ae(0x2e6)]; } }, 0x0); _0x1b4f2a[_0x1f90e5(0x65e)] = _0x1f90e5(0x7db) + _0x49f04b + _0x1f90e5(0x24a) + _0x4e8be7[_0x1f90e5(0x30d)] + _0x1f90e5(0x3dc) + _0x4e8be7[_0x1f90e5(0x376)] + _0x1f90e5(0x92f) + (_0x4e8be7[_0x1f90e5(0x128)] ? '▶' : '⚠') + _0x1f90e5(0x447); if (_0x4e8be7[_0x1f90e5(0x128)]) { if (_0x1f90e5(0xa90) !== _0x1f90e5(0x930)) _0x1b4f2a[_0x1f90e5(0x988)](_0x1f90e5(0x649), function () { const _0x7daf43 = _0x1f90e5; if (_0x7daf43(0x281) === _0x7daf43(0x786)) throw new _0x2c8686('AI返回的内容里找不到有效的JSON数组。原始回复:\x20' + _0x1de60d); else { const _0x2601c3 = { 'id': _0x7daf43(0x96c) + _0x4e8be7[_0x7daf43(0x921)], 'url': _0x4e8be7[_0x7daf43(0x128)] }; _0x3d4c2b(this, _0x2601c3); } }); else { const _0x4166d2 = _0x1000a7[_0x1f90e5(0xa30)]('p'); _0x4166d2['style'][_0x1f90e5(0x6c2)] = _0x1f90e5(0x1da), _0x4166d2[_0x1f90e5(0x9e0)] = _0x1c2448, _0x58c3fe['appendChild'](_0x4166d2); } } _0x19ae57[_0x1f90e5(0x3fd)](_0x1b4f2a); } else { if (_0x516dff) { const _0x25d5e5 = document[_0x1f90e5(0xa30)]('p'); _0x25d5e5[_0x1f90e5(0x65e)] = _0x516dff, _0x25d5e5[_0x1f90e5(0x462)]['margin'] = '0', _0x19ae57['appendChild'](_0x25d5e5); } } } } } } if (_0x4fa1e8 === _0x1f90e5(0x425)) { if ('eSncJ' !== _0x1f90e5(0x990)) { _0x33dcea(_0x1f90e5(0x641)); return; } else _0x1875d3[_0x1f90e5(0x3fd)](_0x19ae57), _0x1875d3[_0x1f90e5(0x3fd)](_0x934e25); } else _0x1875d3['appendChild'](_0x934e25), _0x1875d3[_0x1f90e5(0x3fd)](_0x19ae57); } _0x448c5a[_0x1f90e5(0x3fd)](_0x1875d3); const _0x258b54 = document['createElement'](_0x1f90e5(0xa8b)); return _0x258b54[_0x1f90e5(0x828)] = 'timestamp', _0x258b54[_0x1f90e5(0x9e0)] = _0x1c42da(_0x4e8be7['timestamp']), _0x448c5a[_0x1f90e5(0x3fd)](_0x258b54), _0x336614[_0x1f90e5(0x3fd)](_0x448c5a), _0x448c5a; } document[_0x314838(0x7d5)]('chat-messages')['addEventListener'](_0x314838(0x649), _0xa901f4); let _0x1b6c88 = null, _0x2a6a1f = null; function _0xa901f4(_0x2d21f9) { const _0x22f26e = _0x314838; if (window[_0x22f26e(0xaa7)]()['toString']()) { if (_0x22f26e(0x9f7) !== 'PpIxr') _0x5801ae[_0x22f26e(0x11e)](_0x22f26e(0x178) + _0x3378e9['id'], _0x5bc87b); else return; } const _0x44bec1 = _0x2d21f9['target']['closest'](_0x22f26e(0x5e9)), _0x2bac23 = _0x2d21f9[_0x22f26e(0x6d7)][_0x22f26e(0x4b7)](_0x22f26e(0x609)); if (!_0x44bec1 || _0x2bac23) return; const _0x243b21 = parseInt(_0x44bec1[_0x22f26e(0x14b)][_0x22f26e(0x12c)], 0xa); if (isNaN(_0x243b21)) return; _0x8ca2d(_0x243b21); } function _0x13b171() { const _0x144548 = _0x314838, _0x59afa1 = _0xee1b45(); if (!_0x59afa1) { _0x35ccdd[_0x144548(0x9e0)] = _0x144548(0x620); return; } if (_0x59afa1[_0x144548(0x974)] === _0x144548(0x293)) { if (_0x144548(0xa2d) !== _0x144548(0xa2d)) _0x8ff50['isGenerating'] && _0x28a1a2[_0x144548(0x501)] && (_0x3ddeb0[_0x144548(0x688)]('用户操作中断了\x20AI\x20响应。'), _0x32732e[_0x144548(0x501)][_0x144548(0x448)](_0x144548(0x4d6)), _0x459b72[_0x144548(0x501)] = null), _0x5cd342[_0x144548(0x1e8)] = ![], _0x28193a(![]); else { const _0x2cc121 = _0x1d08b4(_0x59afa1[_0x144548(0x9c8)][0x0]); _0x35ccdd[_0x144548(0x9e0)] = _0x2cc121 ? _0x2cc121[_0x144548(0x695)] : _0x144548(0x1c4); } } else _0x35ccdd['textContent'] = _0x59afa1['name'] || '群聊\x20(' + _0x59afa1[_0x144548(0x9c8)][_0x144548(0x280)] + ')'; } function _0x42fa49(_0x47ea70) { const _0x496664 = _0x314838; if ('tsXQZ' !== _0x496664(0x551)) _0xf756f4 = _0x524eeb[_0x496664(0xa30)]('div'), _0x2948d1['id'] = 'feed-loader', _0x5594d8[_0x496664(0x3fd)](_0x4a5ba4); else { const _0x5106bd = document['querySelector'](_0x496664(0x17c)); if (_0x5106bd && (_0x5106bd['id'] === _0x496664(0x5aa) || _0x5106bd['id'] === _0x496664(0x139))) 'RdeoG' === _0x496664(0x47f) ? _0x2522f3() : _0x20112b[_0x496664(0x7d5)](_0x496664(0x7a1))['click'](); else { if (_0x496664(0x23f) === _0x496664(0x23f)) { const _0x3c9c0f = document[_0x496664(0x83d)]('.typing-indicator'); _0x3c9c0f[_0x496664(0x8c0)](_0x5c3b61 => _0x5c3b61[_0x496664(0x330)]()); } else _0x5d1020[_0x2f94cf][_0x496664(0x349)]['remove'](_0x496664(0x829)), _0x136412[_0x2d9028]['value'] = ''; } } } function _0x336cd5() { const _0x302b09 = _0x314838; _0x13c410[_0x302b09(0x1e8)] && _0x13c410[_0x302b09(0x501)] && (console['log'](_0x302b09(0x862)), _0x13c410[_0x302b09(0x501)][_0x302b09(0x448)](_0x302b09(0x4d6)), _0x13c410[_0x302b09(0x501)] = null), _0x13c410[_0x302b09(0x1e8)] = ![], _0x42fa49(![]); } function _0xee1b45() { const _0x1c7896 = _0x314838; return _0x13c410['chats'][_0x1c7896(0x9b9)](_0x41558c => _0x41558c['id'] === _0x13c410[_0x1c7896(0x55f)]); } function _0x1d08b4(_0x3b4fb9) { const _0x1d5204 = _0x314838; return _0x13c410[_0x1d5204(0x53a)][_0x1d5204(0x9b9)](_0x3c6fb4 => _0x3c6fb4['id'] === _0x3b4fb9); } function _0x407d21(_0x525e20) { const _0x1796dd = _0x314838; _0x13c410[_0x1796dd(0x53a)] = _0x13c410[_0x1796dd(0x53a)][_0x1796dd(0x61f)](_0x17dca1 => _0x17dca1['id'] !== _0x525e20), _0x13c410[_0x1796dd(0x226)][_0x1796dd(0x8c0)](_0x17ab51 => { const _0x5e94b9 = _0x1796dd; 'AKJvP' !== _0x5e94b9(0x606) ? _0x17ab51[_0x5e94b9(0x974)] === _0x5e94b9(0x9ad) && (_0x17ab51[_0x5e94b9(0x9c8)] = _0x17ab51['participantIds'][_0x5e94b9(0x61f)](_0x16e77 => _0x16e77 !== _0x525e20)) : _0x3366df['generationConfig'] = { 'response_mime_type': _0x5e94b9(0x75f) }; }); const _0x1563c3 = _0x13c410[_0x1796dd(0x226)][_0x1796dd(0x9b9)](_0x37abe9 => _0x37abe9[_0x1796dd(0x974)] === 'private' && _0x37abe9['participantIds'][_0x1796dd(0x71e)](_0x525e20)); _0x1563c3 && (_0x1796dd(0x9c5) !== _0x1796dd(0x3c7) ? _0x461a23(_0x1563c3['id']) : (_0x5dde5a['classList'][_0x1796dd(0x330)]('visible'), _0x3cc328[_0x1796dd(0x349)]['remove'](_0x1796dd(0x1cc)))), _0x13c410[_0x1796dd(0x226)] = _0x13c410[_0x1796dd(0x226)][_0x1796dd(0x61f)](_0x45c326 => _0x45c326[_0x1796dd(0x974)] !== _0x1796dd(0x9ad) || _0x45c326[_0x1796dd(0x9c8)]['length'] > 0x1), _0x5834f1(), _0x2de32d(); } function _0x461a23(_0x54d5c0) { const _0x38828e = _0x314838; _0x13c410['chats'] = _0x13c410[_0x38828e(0x226)][_0x38828e(0x61f)](_0xe79895 => _0xe79895['id'] !== _0x54d5c0); try { localStorage[_0x38828e(0x7ec)]('chatHistory_' + _0x54d5c0); } catch (_0x4bee8b) { if (_0x38828e(0xa86) !== _0x38828e(0x4cb)) console[_0x38828e(0x11e)](_0x38828e(0x178) + _0x54d5c0, _0x4bee8b); else { const _0x2437f0 = ['星期日', _0x38828e(0x8fe), '星期二', _0x38828e(0xa4a), '星期四', '星期五', _0x38828e(0x937)]; return _0x2437f0[_0xcd07d0[_0x38828e(0x6b9)]()] + '\x20' + _0x4770f7; } } _0x13c410['activeChatId'] === _0x54d5c0 && (_0x13c410['activeChatId'] = _0x13c410[_0x38828e(0x226)][0x0]?.['id'] || null, _0x48dfc8(_0x13c410['activeChatId'])), _0x5834f1(), _0x2de32d(); } async function _0x48dfc8(_0x48de55) { const _0x2d077a = _0x314838; if (_0x2d077a(0x92b) === _0x2d077a(0x84c)) _0x1ac485[_0x2d077a(0x7d5)](_0x2d077a(0x26d))['click'](); else { if (_0x13c410['activeChatId'] !== _0x48de55) { if (_0x2d077a(0x296) !== _0x2d077a(0x348)) _0x336cd5(), _0x13c410[_0x2d077a(0x476)] = 0x64; else { const _0x543053 = (_0x43da37 - _0x4bdd40) / (0x3e8 * 0x3c); _0x543053 < 0x3c ? _0x2619ea += _0x2d077a(0x701) : _0x9ba345 += _0x2d077a(0xa0a) + _0x470017[_0x2d077a(0x519)](_0x543053 / 0x3c) + _0x2d077a(0x5be); } } if (!_0x48de55) { if (_0x2d077a(0x283) !== _0x2d077a(0x395)) { _0x13c410[_0x2d077a(0x55f)] = null, _0x5834f1(), _0x4c0af8(![]), document[_0x2d077a(0x7d5)](_0x2d077a(0x1a2))[_0x2d077a(0x462)][_0x2d077a(0x97e)] = ''; return; } else _0x171295['src'] = _0x5130fd['url'], _0xb197ac[_0x2d077a(0x5c0)](), _0x1657d0[_0x2d077a(0x298)](_0x2d077a(0x466))[_0x2d077a(0x9e0)] = '❚❚'; } _0x13c410[_0x2d077a(0x55f)] = _0x48de55, _0x5834f1(), _0x13b171(), _0x336614['innerHTML'] = '', _0x1f66de(!![], '稍微有点卡了，可以尝试清空聊天记录了！记得总结丢世界书'), setTimeout(async () => { const _0x232a91 = _0x2d077a; if (_0x232a91(0x287) === _0x232a91(0x784)) { const _0xa02610 = _0x3fb82b['id'], _0x5355ef = 'customIcon_' + _0xa02610, _0x820eb5 = _0x224a32[_0x232a91(0x310)](_0x5355ef), _0x3e0c7a = _0x535ee3['querySelector'](_0x232a91(0x453)); if (_0x820eb5) _0x3e0c7a[_0x232a91(0x65e)] = _0x232a91(0x434) + _0x820eb5 + '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>'; else { const _0x2fb0ba = _0x488cd3['querySelector'](_0x232a91(0x76e) + _0xa02610 + _0x232a91(0x5c7) + _0xa02610 + _0x232a91(0x5e2))?.[_0x232a91(0x65e)]; _0x2fb0ba && (_0x3e0c7a['innerHTML'] = _0x2fb0ba); } } else try { if ('bxFGM' === 'bxFGM') { _0x1f45f3(); const _0x1a134b = _0xee1b45(), _0x465e4e = document[_0x232a91(0x7d5)]('chat-view-pane'); let _0x4795a7 = null; if (_0x1a134b) { if (_0x1a134b[_0x232a91(0x974)] === 'private') { const _0x1da336 = _0x1a134b['participantIds'][0x0]; _0x48d99c(_0x1da336), _0x4795a7 = await _0xb9bbbf(_0x232a91(0x999) + _0x1da336); } else _0x4795a7 = await _0xb9bbbf(_0x232a91(0x9a3) + _0x1a134b['id']); if (_0x4795a7) { if (_0x232a91(0x7a6) === 'JpUVi') _0x465e4e['style'][_0x232a91(0x97e)] = 'url(\x27' + URL[_0x232a91(0x602)](_0x4795a7) + '\x27)', _0x465e4e[_0x232a91(0x462)][_0x232a91(0x6b5)] = 'cover', _0x465e4e[_0x232a91(0x462)]['backgroundPosition'] = 'center'; else { const _0x3baccf = { 'id': _0x232a91(0x7e0) + _0x303f85[_0x232a91(0x2f2)](), 'name': _0x30db10, 'boundUserProfileId': _0x2ad1d0, 'memberCharacterIds': _0x11da98, 'posts': [] }; _0x2713e3[_0x232a91(0x67e)][_0x232a91(0x98f)](_0x3baccf); } } else _0x465e4e[_0x232a91(0x462)][_0x232a91(0x97e)] = ''; } _0x403f79(); } else _0x2708ee[_0x232a91(0x462)][_0x232a91(0x4f6)] = ''; } catch (_0x25cc4b) { 'OsddK' !== _0x232a91(0x647) ? (_0x54ad52['style'][_0x232a91(0x97e)] = _0x232a91(0x5ce) + _0x5ccbe3[_0x232a91(0x602)](_0x2d15ca) + '\x27)', _0x12ab7f[_0x232a91(0x462)][_0x232a91(0x6b5)] = _0x232a91(0x45d), _0x195615[_0x232a91(0x462)]['backgroundPosition'] = _0x232a91(0x2a0)) : (console[_0x232a91(0x11e)](_0x232a91(0x778), _0x25cc4b), _0x1e9edf(_0x232a91(0x7fb) + _0x25cc4b[_0x232a91(0x496)])); } finally { _0x1f66de(![]); } }, 0x32); } } async function _0x1cf0fd() { const _0x3bf145 = _0x314838; if (_0x13c410[_0x3bf145(0x1e8)]) { _0x1e9edf(_0x3bf145(0x33e)); return; } const _0x150596 = _0x13c410[_0x3bf145(0x793)]; if (_0x150596['length'] === 0x0) return; let _0x4d725c = -0x1; for (let _0x5cb12b = _0x150596[_0x3bf145(0x280)] - 0x1; _0x5cb12b >= 0x0; _0x5cb12b--) { if (_0x150596[_0x5cb12b][_0x3bf145(0x4cc)] === _0x3bf145(0x425)) { _0x4d725c = _0x5cb12b; break; } } if (_0x4d725c === -0x1 || _0x4d725c === _0x150596[_0x3bf145(0x280)] - 0x1) { _0x1e9edf(_0x3bf145(0x2d8)); return; } _0x150596[_0x3bf145(0x3f5)](_0x4d725c + 0x1), _0xe23b38(), _0x2522f3(), setTimeout(() => { const _0x4189e4 = _0x3bf145; _0x4189e4(0x667) === _0x4189e4(0x2a7) ? _0x510e7d += _0x4189e4(0x77f) : _0x4d5866(); }, 0x64); } function _0x282af7(_0x3cf36a = null) { const _0x2ce4b9 = _0x314838; if (_0x2ce4b9(0x307) !== 'yabBO') { const _0x3670c8 = _0x3cf36a ?? _0x4225fb[_0x2ce4b9(0x4d3)][_0x2ce4b9(0x6eb)](); if (_0x3670c8 === '' || !_0x13c410[_0x2ce4b9(0x55f)]) return; const _0x2bf9d7 = document['querySelector'](_0x2ce4b9(0x17c)), _0x51aa9e = _0x2bf9d7['id'] === _0x2ce4b9(0x5aa), _0x35086f = { 'role': _0x2ce4b9(0x425), 'content': _0x3670c8, 'timestamp': Date[_0x2ce4b9(0x2f2)](), 'isOffline': _0x51aa9e }; if (_0x13c410[_0x2ce4b9(0x5f2)]) { if (_0x2ce4b9(0x3e8) === _0x2ce4b9(0x1aa)) { const _0xcb1097 = _0x833119[_0x2ce4b9(0xa30)]('li'); _0xcb1097[_0x2ce4b9(0x828)] = 'character-item', _0xcb1097[_0x2ce4b9(0x14b)][_0x2ce4b9(0x5af)] = _0x1d8d83['id'], _0xcb1097[_0x2ce4b9(0x65e)] = _0x2ce4b9(0x81d) + (_0x18fa04[_0x2ce4b9(0x907)] || _0x5340e2) + _0x2ce4b9(0x62f) + _0x52bb86['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>' + (_0x17c483[_0x2ce4b9(0x67b)] || '私聊') + _0x2ce4b9(0x890), _0xcb1097['addEventListener']('click', () => { _0x49439b(_0x2166d9['id']); }), _0x239dde['appendChild'](_0xcb1097); } else _0x35086f[_0x2ce4b9(0x765)] = { ..._0x13c410['activeQuote'] }; } _0x13c410[_0x2ce4b9(0x793)][_0x2ce4b9(0x98f)](_0x35086f), _0xe23b38(), _0x2522f3(), !_0x3cf36a && (_0x4225fb[_0x2ce4b9(0x4d3)] = ''), _0x4f11bc(); } else { if (_0x472c0a === null) return; const _0x1b44f9 = _0x5cf53e[_0x2ce4b9(0x4d3)][_0x2ce4b9(0x6eb)](); if (_0x1b44f9 === '') { _0x28c26b(); return; } const _0x41bcae = _0x3a53b9[_0x2ce4b9(0x793)][_0xb08f05]; _0x41bcae && (_0x41bcae[_0x2ce4b9(0x75a)] = _0x1b44f9, _0x2d35d4(), _0x10eaa8()), _0x55d917[_0x2ce4b9(0x349)]['remove']('show'), _0x8d7485 = null; } } function _0x265a64(_0x5c1eb5) { const _0x2c7f6f = _0x314838; if ('BOfPb' !== _0x2c7f6f(0x9b3)) _0x3e62e5(), _0xb7d7c4(_0x2c7f6f(0x97b), _0x2c7f6f(0x64c)); else { if (!_0x5c1eb5 || !_0x13c410['activeChatId']) return; const _0x37968a = { 'role': _0x2c7f6f(0x425), 'content': '[用户发送了表情：' + _0x5c1eb5[_0x2c7f6f(0x695)] + ']', 'displayUrl': _0x5c1eb5[_0x2c7f6f(0x570)], 'timestamp': Date['now']() }; _0x13c410[_0x2c7f6f(0x793)][_0x2c7f6f(0x98f)](_0x37968a), _0x23a32c(_0x37968a, _0x13c410[_0x2c7f6f(0x793)][_0x2c7f6f(0x280)] - 0x1), _0xe23b38(), _0x2aad1a['classList'][_0x2c7f6f(0x330)](_0x2c7f6f(0xa12)); } } async function _0x32e337(_0x2c688c) { const _0x5f57aa = _0x314838, _0x328853 = _0x2c688c[_0x5f57aa(0x6d7)][_0x5f57aa(0x6ea)][0x0]; if (!_0x328853 || !_0x13c410['activeChatId']) return; _0x1f66de(!![], _0x5f57aa(0x825)); try { const _0x859a54 = await _0x39f7a8(_0x328853, 0x320, 0.8, !![]), _0x2d7b1d = _0x5f57aa(0x11d) + Date[_0x5f57aa(0x2f2)](); await _0x4162d1(_0x2d7b1d, _0x859a54); const _0x2fda24 = _0x4225fb[_0x5f57aa(0x4d3)][_0x5f57aa(0x6eb)](); _0x4225fb['value'] = ''; const _0x1e9a84 = { 'role': 'user', 'content': _0x2fda24, 'imageId': _0x2d7b1d, 'timestamp': Date['now']() }; _0x13c410[_0x5f57aa(0x793)][_0x5f57aa(0x98f)](_0x1e9a84), _0x23a32c(_0x1e9a84, _0x13c410[_0x5f57aa(0x793)]['length'] - 0x1), _0xe23b38(); } catch (_0x55f890) { _0x1e9edf(_0x5f57aa(0x506) + _0x55f890[_0x5f57aa(0x496)]); } finally { _0x1f66de(![]), _0x2c688c['target'][_0x5f57aa(0x4d3)] = ''; } } async function _0x1816d3() { const _0x4337a7 = _0x314838; if (!_0x13c410['activeChatId']) return; const _0x13532d = await _0x33e0fe(); if (!_0x13532d) return; _0x1e9edf(_0x4337a7(0x9ae)); try { if (_0x4337a7(0x836) !== _0x4337a7(0x836)) _0x2fae83['src'] = _0x393b5b ? _0x109c15[_0x4337a7(0x602)](_0x2ab546) : _0xa6cf19; else { const _0x3f99dc = await _0x3b26b6(_0x13532d['songName'], _0x13532d['artist']); let _0x399416 = _0x3f99dc[_0x4337a7(0x45d)]; if (_0x3f99dc['cover'] && _0x3f99dc['cover'][_0x4337a7(0x6ec)](_0x4337a7(0x239))) try { if (_0x4337a7(0x5a7) !== _0x4337a7(0x7ef)) { const _0x54063f = await fetch(_0x3f99dc[_0x4337a7(0x45d)]), _0x484187 = await _0x54063f[_0x4337a7(0x409)](); _0x399416 = await _0x2115c1(_0x484187); } else _0x3c1678 = {}; } catch (_0x484063) { console['error']('下载并转换网络封面失败:', _0x484063), _0x399416 = _0x1c044f; } const _0xda7385 = { 'role': _0x4337a7(0x425), 'type': 'music', 'content': _0x4337a7(0x4f2) + _0x13532d['songName'] + '\x20-\x20' + _0x13532d['artist'] + ']', 'songName': _0x13532d[_0x4337a7(0x30d)], 'artist': _0x13532d[_0x4337a7(0x376)], 'coverUrl': _0x399416, 'playableUrl': _0x3f99dc[_0x4337a7(0x570)], 'timestamp': Date[_0x4337a7(0x2f2)]() }; _0x13c410[_0x4337a7(0x793)][_0x4337a7(0x98f)](_0xda7385), _0x23a32c(_0xda7385, _0x13c410[_0x4337a7(0x793)]['length'] - 0x1), _0xe23b38(); } } catch (_0x501738) { if (_0x4337a7(0x2da) === 'mRhJp') console[_0x4337a7(0x11e)](_0x4337a7(0x8ef), _0x501738), _0x1e9edf(_0x4337a7(0x31f) + _0x501738['message']); else { const _0x3068d3 = _0x5cd02e[_0x4337a7(0x793)]['filter'](_0x676dbd => _0x676dbd['type'] === _0x4337a7(0x44d) && _0x676dbd['playableUrl'])[_0x4337a7(0x33d)](_0x43cb35 => ({ ..._0x43cb35, 'source': _0x4337a7(0x36c) })); _0xc4f1ad[_0x4337a7(0x98f)](..._0x3068d3); } } } function _0x1bc8ae(_0x128f2a, _0x65aa38 = 0x78) { const _0x3cdee9 = _0x314838; if (_0x3cdee9(0x405) === _0x3cdee9(0x405)) { const _0x430c4d = _0x399b32 => { const _0x460f5e = _0x3cdee9; if (_0x399b32[_0x460f5e(0x4cc)] === _0x460f5e(0x425)) return _0x13c410[_0x460f5e(0x787)]?.[_0x460f5e(0x695)] || 'User'; if (_0x399b32[_0x460f5e(0x7c4)]) { if (_0x460f5e(0xa68) !== _0x460f5e(0xa98)) { const _0xfe089f = _0x1d08b4(_0x399b32[_0x460f5e(0x7c4)]); return _0xfe089f?.[_0x460f5e(0x695)] || _0x460f5e(0x603); } else _0x519d1a(_0x460f5e(0x875) + _0x302359['message']); } if (_0x128f2a?.[_0x460f5e(0x974)] === _0x460f5e(0x293)) { if (_0x460f5e(0x8a4) !== _0x460f5e(0x3f7)) { const _0x31f1bc = _0x1d08b4(_0x128f2a['participantIds'][0x0]); return _0x31f1bc?.['name'] || 'AI'; } else { let _0x45a4ce = _0x1a7e1f[_0x460f5e(0x6eb)](); const _0x368aaf = _0x45a4ce[_0x460f5e(0x2a3)](/(\[[\s\S]*\])/); _0x368aaf && (_0x45a4ce = _0x368aaf[0x1]); const _0x183c5d = _0x1b9612[_0x460f5e(0xa69)](_0x45a4ce); if (_0x23012d[_0x460f5e(0x850)](_0x183c5d)) { _0xb28ae5[_0x460f5e(0x12e)] = _0x183c5d, _0x4fa8b6[_0x460f5e(0x2f9)][_0xd2222e['id']] = [..._0x183c5d], _0x10e69b(); const _0x28b540 = _0x183c5d['map'](_0x330dee => _0x330dee['speaker'] === _0x460f5e(0x2a6) ? _0x330dee[_0x460f5e(0x56f)] : _0x330dee[_0x460f5e(0x31c)] + ':\x20' + _0x330dee[_0x460f5e(0x56f)])[_0x460f5e(0x8aa)]('\x0a\x0a'); _0xac7d23[_0x460f5e(0x793)][_0x460f5e(0x98f)]({ 'role': _0x460f5e(0x9bb), 'senderId': _0x913809['id'], 'timestamp': _0x257016[_0x460f5e(0x2f2)](), 'isOffline': !![], 'content': _0x28b540 }); } } } return _0x460f5e(0x57a); }, _0x229b0c = _0x13c410['conversationHistory']['slice'](-_0x65aa38), _0x18ee90 = []; for (const _0x5d1e0d of _0x229b0c) { if (_0x3cdee9(0x3f1) !== 'iGrDY') return _0x44db6b(new _0x4f920c(_0x3cdee9(0x305))); else { if (_0x5d1e0d[_0x3cdee9(0x8ab)]) _0x18ee90[_0x3cdee9(0x98f)]('[' + _0x430c4d(_0x5d1e0d) + ']\x20[sticker:' + (_0x5d1e0d[_0x3cdee9(0x75a)]?.[_0x3cdee9(0x2a3)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x5d1e0d[_0x3cdee9(0x98c)]) { if (_0x3cdee9(0x920) !== _0x3cdee9(0x920)) _0x50d9f1 = _0xeacc0[_0x3cdee9(0x6ed)][_0x3cdee9(0x9b9)](_0x17943b => _0x17943b['id'] === _0x42905a[_0x3cdee9(0x56d)]); else { const _0x545ba2 = _0x5d1e0d[_0x3cdee9(0x75a)] ? '\x20' + _0x5d1e0d['content'] : ''; _0x18ee90[_0x3cdee9(0x98f)]('[' + _0x430c4d(_0x5d1e0d) + _0x3cdee9(0x419) + _0x545ba2); } } else _0x5d1e0d[_0x3cdee9(0x75a)] && _0x18ee90[_0x3cdee9(0x98f)]('[' + _0x430c4d(_0x5d1e0d) + ']\x20' + _0x5d1e0d['content']); } } } return _0x18ee90[_0x3cdee9(0x8aa)]('\x0a'); } else try { const _0x229f29 = _0x30b9ac[_0x3cdee9(0x310)](_0x3cdee9(0x151) + _0x16a430), _0x29293f = _0x21b5d4['parse'](_0x229f29 || '[]'); return _0x5744ff[_0x3cdee9(0x850)](_0x29293f) ? _0x29293f : []; } catch { return []; } } function _0x42c5ee(_0x50faa1, _0x450736) { const _0x1ebc51 = _0x314838; if (_0x1ebc51(0x148) !== _0x1ebc51(0x5ec)) { if (!_0x50faa1 || !_0x450736) return null; const _0x21d6e8 = _0x450736['match'](/@([^\s:：,，。!?]+)/); if (!_0x21d6e8) return null; const _0x1108d9 = _0x21d6e8[0x1][_0x1ebc51(0x430)](); for (const _0x2fc424 of _0x50faa1[_0x1ebc51(0x9c8)]) { const _0x591bef = _0x1d08b4(_0x2fc424); if (!_0x591bef?.[_0x1ebc51(0x695)]) continue; if (_0x591bef[_0x1ebc51(0x695)]['toLowerCase']() === _0x1108d9) return _0x591bef; if (_0x591bef[_0x1ebc51(0x695)]['toLowerCase']()[_0x1ebc51(0x6ec)](_0x1108d9)) return _0x591bef; } return null; } else _0x419410(_0x49e545), _0x5abd5b[_0x1ebc51(0x4d3)] = '', _0x3cfee0(_0x350178, 0x64); } function _0x2fa02b(_0x5d28c9) { const _0x317d95 = _0x314838, _0x248a38 = _0x5d28c9[_0x317d95(0x861)]('{'), _0x1fd8fd = _0x5d28c9[_0x317d95(0x4f4)]('}'); if (_0x248a38 >= 0x0 && _0x1fd8fd > _0x248a38) return _0x5d28c9['slice'](_0x248a38, _0x1fd8fd + 0x1); return _0x5d28c9; } function _0x4ef707(_0x18114f, _0x429929, _0x362d00) { const _0x363352 = _0x314838, _0x3d91b7 = new Map(_0x429929['map'](_0x7048ee => [String(_0x7048ee['id']), _0x7048ee])), _0xd67da3 = _0x116c1d => String(_0x116c1d || '')[_0x363352(0x430)]()[_0x363352(0x1b5)](/\s+/g, ''), _0x3d2647 = new Map(_0x429929[_0x363352(0x33d)](_0xa857aa => [_0xd67da3(_0xa857aa[_0x363352(0x695)]), _0xa857aa])), _0x13faa2 = new Set(_0x362d00), _0x3fdb97 = { 'events': [] }; for (const _0x12ce4e of _0x18114f?.[_0x363352(0x572)] || []) { if (_0x363352(0x11c) !== 'YezWv') { const _0x3f0c15 = _0x12ce4e['senderId'] ?? _0x12ce4e[_0x363352(0x6da)] ?? _0x12ce4e['sender_id'] ?? _0x12ce4e['speaker'] ?? _0x12ce4e['role'] ?? _0x12ce4e[_0x363352(0x695)]; if (!_0x3f0c15) continue; let _0x5a7e6b = _0x3d91b7[_0x363352(0x919)](String(_0x3f0c15)) || _0x3d2647[_0x363352(0x919)](_0xd67da3(_0x3f0c15)); if (!_0x5a7e6b) continue; const _0x42113f = (_0x12ce4e[_0x363352(0x6b3)] || _0x12ce4e[_0x363352(0x974)] || _0x363352(0x928))[_0x363352(0x430)](); if (_0x42113f === 'sticker') { const _0x55ad29 = (_0x12ce4e[_0x363352(0x52b)] ?? _0x12ce4e[_0x363352(0x72c)] ?? _0x12ce4e[_0x363352(0x2af)] ?? _0x12ce4e[_0x363352(0x946)])?.[_0x363352(0x6eb)](); if (_0x55ad29 && _0x13faa2['has'](_0x55ad29)) _0x3fdb97[_0x363352(0x572)][_0x363352(0x98f)]({ 'senderId': _0x5a7e6b['id'], 'kind': _0x363352(0x52b), 'sticker': _0x55ad29 }); else { const _0x6d42ee = String(_0x12ce4e[_0x363352(0x75a)] ?? _0x12ce4e['text'] ?? '')[_0x363352(0x6eb)]() || _0x363352(0xa6d) + (_0x55ad29 || _0x363352(0x5ff)) + ']'; if (_0x6d42ee) _0x3fdb97[_0x363352(0x572)][_0x363352(0x98f)]({ 'senderId': _0x5a7e6b['id'], 'kind': 'text', 'content': _0x6d42ee }); } } else { const _0x15a7a8 = String(_0x12ce4e[_0x363352(0x75a)] ?? _0x12ce4e[_0x363352(0x928)] ?? _0x12ce4e['message'] ?? '')[_0x363352(0x6eb)](); if (_0x15a7a8) _0x3fdb97[_0x363352(0x572)][_0x363352(0x98f)]({ 'senderId': _0x5a7e6b['id'], 'kind': _0x363352(0x928), 'content': _0x15a7a8 }); } } else _0x26bb72[_0x363352(0x828)] = _0x363352(0x2a6), _0x48db5c[_0x363352(0x462)]['fontStyle'] = _0x363352(0x333), _0x1a389b['style'][_0x363352(0x673)] = _0x363352(0x3d5), _0x52aac5[_0x363352(0x65e)] = _0x24ad64; } return _0x3fdb97; } async function _0x28e0c9(_0x36e8ca) { const _0x19d724 = _0x314838; if (!_0x36e8ca || !Array[_0x19d724(0x850)](_0x36e8ca['events']) || _0x36e8ca[_0x19d724(0x572)][_0x19d724(0x280)] === 0x0) return; const _0x47ed99 = _0x4dfebe => _0x4dfebe + Math[_0x19d724(0x66a)](Math['random']() * 0x190); let _0x2bf486 = 0x1f4; for (const _0x462442 of _0x36e8ca[_0x19d724(0x572)]) { if ('ejyfo' === _0x19d724(0x634)) { await new Promise(_0x5446f9 => setTimeout(_0x5446f9, _0x47ed99(_0x2bf486))), _0x2bf486 += 0x2bc; const _0x1372f4 = _0x13c410[_0x19d724(0x793)]['at'](-0x1)?.['isOffline'] ?? ![]; if (_0x462442[_0x19d724(0x6b3)] === _0x19d724(0x52b)) { const _0x4ca1d2 = _0x5c61cd['find'](_0x5d3315 => _0x5d3315['name'] === _0x462442[_0x19d724(0x52b)]); if (_0x4ca1d2) { if (_0x19d724(0x1ff) !== _0x19d724(0x88a)) { const _0x524686 = { 'role': _0x19d724(0x9bb), 'content': _0x19d724(0x318) + _0x4ca1d2[_0x19d724(0x695)] + ']', 'displayUrl': _0x4ca1d2['url'], 'senderId': _0x462442['senderId'], 'timestamp': Date[_0x19d724(0x2f2)](), 'isOffline': _0x1372f4 }; _0x13c410[_0x19d724(0x793)][_0x19d724(0x98f)](_0x524686); } else { _0x13161a[_0x19d724(0x9e0)] = _0x19d724(0x620); return; } } } else { if (_0x462442[_0x19d724(0x6b3)] === _0x19d724(0x44d) && _0x462442[_0x19d724(0x30d)] && _0x462442[_0x19d724(0x376)]) { const { songName: _0x59bf9b, artist: _0x21c918 } = _0x462442, _0x553a11 = { 'role': 'assistant', 'type': _0x19d724(0x44d), 'content': _0x19d724(0x59b) + _0x59bf9b + '\x20-\x20' + _0x21c918 + ']', 'songName': _0x59bf9b, 'artist': _0x21c918, 'senderId': _0x462442[_0x19d724(0x7c4)], 'timestamp': Date['now'](), 'isOffline': _0x1372f4 }; try { if (_0x19d724(0x417) !== _0x19d724(0x93d)) { const _0x3e2aba = await _0x3b26b6(_0x59bf9b, _0x21c918); _0x553a11['coverUrl'] = _0x3e2aba[_0x19d724(0x45d)], _0x553a11[_0x19d724(0x128)] = _0x3e2aba[_0x19d724(0x570)]; } else _0x283137 += _0x19d724(0x8ce) + _0x141af9['songName'] + _0x19d724(0xa41) + _0x3904d6[_0x19d724(0x376)] + ')'; } catch (_0x3d9262) { if (_0x19d724(0x54e) !== 'VuIVF') { const _0xbe01d9 = _0x519acf[_0x19d724(0x470)]; _0x323d22[_0x19d724(0x5f8)] = _0x318881 + (_0xbe01d9 - _0x7dbf62); } else console[_0x19d724(0x11e)](_0x19d724(0x37c) + _0x59bf9b + _0x19d724(0xa41) + _0x21c918 + '):', _0x3d9262), _0x553a11[_0x19d724(0x2e6)] = null, _0x553a11[_0x19d724(0x128)] = null; } _0x13c410['conversationHistory'][_0x19d724(0x98f)](_0x553a11); } else { if (_0x462442[_0x19d724(0x6b3)] === _0x19d724(0x928)) { const _0x5ba796 = _0x54ea45(_0x462442[_0x19d724(0x75a)])[_0x19d724(0x6d1)](0x0, 0x3); for (let _0x44341a = 0x0; _0x44341a < _0x5ba796[_0x19d724(0x280)]; _0x44341a++) { if (_0x19d724(0x80b) !== _0x19d724(0x80b)) _0x4a1632['appendChild'](_0x349880), _0x36024c[_0x19d724(0x3fd)](_0x306300); else { if (_0x44341a > 0x0) await new Promise(_0xe7bb31 => setTimeout(_0xe7bb31, _0x47ed99(0x190))); const _0x327ade = { 'role': 'assistant', 'content': _0x5ba796[_0x44341a], 'senderId': _0x462442[_0x19d724(0x7c4)], 'timestamp': Date[_0x19d724(0x2f2)](), 'isOffline': _0x1372f4 }; _0x13c410[_0x19d724(0x793)]['push'](_0x327ade); } } } } } } else _0xa395ef += '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有对话记录。</p>'; } _0xe23b38(), _0x2522f3(); } async function _0x3cd76d(_0x21e0fb, { force: force = ![], delayMs: delayMs = 0x0 } = {}) { const _0x583474 = _0x314838; await new Promise(_0x4c23f4 => setTimeout(_0x4c23f4, 0xa)); if (!_0x13c410[_0x583474(0xa48)][_0x583474(0x7d7)] || !_0x13c410[_0x583474(0xa48)][_0x583474(0x8ee)] || !_0x13c410[_0x583474(0xa48)]['model']) { if ('CzCqt' === 'dPTnk') { const { omniText: _0x3a7a0f } = _0x476129(_0x59b145['id'], null), _0x3bf0bc = _0x5221c2(_0x3b1ceb['id']), _0x23990f = _0x238629[_0x583474(0x7d8)] && _0x52b6bb['linkedWorldBookIds'][_0x583474(0x280)] > 0x0 ? _0x583474(0x8c3) + _0x9718b2[_0x583474(0x695)] + _0x583474(0x8f2) + _0x49e5b3[_0x583474(0x7d8)][_0x583474(0x33d)](_0x34dccf => _0x50e135[_0x583474(0x90d)][_0x583474(0x9b9)](_0x21d162 => _0x21d162['id'] === _0x34dccf))['filter'](_0x21722d)['map'](_0x52baaa => _0x583474(0xa58) + _0x52baaa[_0x583474(0x695)] + '\x0a' + _0x52baaa[_0x583474(0x75a)])[_0x583474(0x8aa)]('') : ''; return _0x583474(0x798) + _0x3807fb[_0x583474(0x695)] + _0x583474(0x121) + _0x57015f['id'] + _0x583474(0x53f) + _0x15045a[_0x583474(0x2a1)] + _0x583474(0xa8a) + _0x3a7a0f + '\x0a' + _0x3bf0bc + '\x0a' + _0x23990f; } else return _0x1e9edf('请先在\x22设置\x22中配置你的\x20API\x20信息。'), ![]; } const _0x4ec5c4 = _0xee1b45(); if (!_0x4ec5c4 || !_0x21e0fb) return ![]; const _0x35a45c = _0x328a3b(_0x4ec5c4['id']), _0xfd5f26 = _0x13c410[_0x583474(0x793)]['at'](-0x1)?.[_0x583474(0x4cc)] === _0x583474(0x425); if (!force && !_0xfd5f26) return ![]; const _0x2decc8 = _0x13c410[_0x583474(0x793)]['at'](-0x1)?.[_0x583474(0x9d3)] ?? ![]; if (delayMs) await new Promise(_0x44ec5d => setTimeout(_0x44ec5d, delayMs)); _0x2decc8 ? document[_0x583474(0x7d5)](_0x583474(0x497))[_0x583474(0x9e0)] = '（正在构思中...）' : _0x42fa49(!![]); let _0x48c40f = ''; const _0x305671 = _0xee1b45(); if (_0x305671?.[_0x583474(0x985)]?.['isActive']) { if (_0x583474(0x25b) !== _0x583474(0x174)) { const _0x1c0293 = _0x305671[_0x583474(0x985)], _0x49b09d = await _0x2a21c9(_0x1c0293[_0x583474(0x36a)]); if (_0x49b09d && _0x49b09d[_0x583474(0x808)]) { const _0x139a6e = _0xe0876a(_0x49b09d[_0x583474(0x808)]); if (_0x139a6e[_0x583474(0x280)] > 0x0) { const _0x59d4fa = _0x3247fc[_0x583474(0x3f3)]; let _0x54f034 = -0x1; for (let _0x269f5f = 0x0; _0x269f5f < _0x139a6e[_0x583474(0x280)]; _0x269f5f++) { if (_0x59d4fa >= _0x139a6e[_0x269f5f]['time']) _0x54f034 = _0x269f5f; else break; } const _0x1d45e2 = _0x139a6e[_0x583474(0x33d)]((_0x5cc547, _0x5c9f57) => { const _0x2a071a = _0x583474, _0x25a192 = _0x5c9f57 === _0x54f034 ? _0x2a071a(0x61e) : ''; return '' + _0x25a192 + _0x5cc547[_0x2a071a(0x928)]; })[_0x583474(0x8aa)]('\x0a'); _0x48c40f = ('\x0a#\x20当前活动：一起听歌\x0a\x0a你们正在一起听\x20' + _0x1c0293['artist'] + _0x583474(0x7f5) + _0x1c0293['songName'] + _0x583474(0x7e5) + _0x1d45e2 + '\x0a[歌词结束]\x0a\x0a请根据当前播放的歌词和对话氛围，自然地作出回应。\x0a\x20\x20\x20')[_0x583474(0x6eb)](); } } } else _0x58b461[_0x583474(0x6f0)] && _0x4e9b44(_0x2a656a[_0x583474(0x6f0)]); } let _0x36173e = '', _0x1af871 = ''; const _0x28b7d1 = _0x13c410[_0x583474(0x793)][_0x583474(0x280)]; if (_0x28b7d1 > 0x1) { const _0x44e0bf = _0x13c410[_0x583474(0x793)][_0x28b7d1 - 0x2], _0xb17a8c = _0x13c410['conversationHistory'][_0x28b7d1 - 0x1]; if (_0x44e0bf[_0x583474(0x9d3)] === ![] && _0xb17a8c['isOffline'] === !![]) _0x1af871 = _0x583474(0x9d8) + _0x35a45c[_0x583474(0x695)] + _0x583474(0x483); else _0x44e0bf[_0x583474(0x9d3)] === !![] && _0xb17a8c[_0x583474(0x9d3)] === ![] && (_0x1af871 = _0x583474(0x6c0) + _0x35a45c['name'] + _0x583474(0x10a)); } if (_0x2decc8) { if ('DJuKq' === 'DJuKq') { const _0x19e663 = _0x583474(0x7cf); _0x36173e = '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“' + _0x35a45c[_0x583474(0x695)] + _0x583474(0x9ab) + _0x19e663 + ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“' + _0x21e0fb[_0x583474(0x695)] + _0x583474(0xa7d) + _0x19e663 + _0x583474(0x366) + _0x19e663 + _0x583474(0x766); } else { const _0x1acf0d = _0x4b10fd[_0x583474(0x790)][0x0][_0x583474(0x221)] - _0x529275, _0x296237 = _0x13f12b[_0x583474(0x790)][0x0]['clientY'] - _0x431ad3; _0x492d3b[_0x583474(0x7bf)](_0x1acf0d) > _0x5dc74a[_0x583474(0x7bf)](_0x296237) ? _0x329e3c = _0x583474(0x42c) : _0x2a9495 = _0x583474(0x1e9); } } else _0x583474(0x4fa); const { omniText: _0x1e1093 } = _0x32d34b(_0x21e0fb['id'], _0x4ec5c4['id']), _0x1055d0 = _0x35b71c(), _0x3d4860 = _0x40d5ca(_0x21e0fb['id']), _0x1bd46a = await _0x4ce96e(_0x21e0fb['id']), _0x52c19d = typeof _0x124779 === _0x583474(0x802) ? _0x124779['replaceAll'](_0x583474(0x948), _0x21e0fb[_0x583474(0x695)])[_0x583474(0x926)](_0x583474(0x2ae), _0x35a45c[_0x583474(0x695)] || '用户') : '', _0x4892ad = _0x5c61cd['map'](_0x4b4ddb => _0x4b4ddb['name'])[_0x583474(0x8aa)](',\x20'); let _0x7c4612 = ''; if (_0x21e0fb[_0x583474(0x7d8)] && _0x21e0fb[_0x583474(0x7d8)][_0x583474(0x280)] > 0x0) { const _0x3f42a1 = _0x21e0fb[_0x583474(0x7d8)][_0x583474(0x33d)](_0x1e1235 => _0x13c410[_0x583474(0x90d)][_0x583474(0x9b9)](_0x5a05c1 => _0x5a05c1['id'] === _0x1e1235))[_0x583474(0x61f)](Boolean)['map'](_0xa9bc7d => _0x583474(0x257) + _0xa9bc7d[_0x583474(0x695)] + '\x0a' + _0xa9bc7d['content'])[_0x583474(0x8aa)](''); if (_0x3f42a1) _0x7c4612 = _0x583474(0x522) + _0x3f42a1; } const _0x57ad33 = _0x35a45c['persona'] ? _0x583474(0x21a) + _0x35a45c['name'] + '”的补充信息\x0a' + _0x35a45c[_0x583474(0x2a1)] : ''; let _0x51cea9 = ''; const _0x33ecee = new Date(), _0x3a892e = _0x1ca438(_0x21e0fb['id']); _0x51cea9 = _0x583474(0x8e6), _0x51cea9 += '-\x20**当前精确时间**:\x20' + _0x33ecee[_0x583474(0x79b)]('zh-CN', { 'dateStyle': 'full', 'timeStyle': _0x583474(0x3eb) }) + '\x0a'; if (_0x3a892e) { const _0x3a176a = new Date(_0x3a892e['timestamp']), _0x288d3d = _0x50e57d(_0x3a176a); _0x51cea9 += _0x583474(0x761) + _0x288d3d + '\x0a'; const _0x5bc1d6 = _0x33ecee['toDateString'](), _0x3b6bdd = _0x3a176a[_0x583474(0x7ab)](), _0x117cfd = new Date(); _0x117cfd['setDate'](_0x33ecee[_0x583474(0x1a4)]() - 0x1); const _0x581fe4 = _0x117cfd[_0x583474(0x7ab)](); if (_0x5bc1d6 === _0x3b6bdd) { const _0x15e2fb = (_0x33ecee - _0x3a176a) / (0x3e8 * 0x3c); if (_0x15e2fb < 0x3c) _0x51cea9 += _0x583474(0x701); else { if ('fDYgy' === 'zKgdR') { const _0x46080f = _0x172757['getItem']('customFeedWallpaper'); _0x46080f ? _0x7b3d8a[_0x583474(0x7d5)](_0x583474(0x3c9))[_0x583474(0x462)]['setProperty'](_0x583474(0x8b1), _0x583474(0x408) + _0x46080f + ')') : _0x13a5b1[_0x583474(0x7d5)](_0x583474(0x3c9))[_0x583474(0x462)][_0x583474(0x81c)](_0x583474(0x8b1), _0x583474(0x794)); } else _0x51cea9 += '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概' + Math[_0x583474(0x519)](_0x15e2fb / 0x3c) + _0x583474(0x5be); } } else { if (_0x581fe4 === _0x3b6bdd) { if (_0x583474(0x14e) === _0x583474(0x23a)) { if (_0x2192de[_0x583474(0x6d7)][_0x583474(0x349)][_0x583474(0x741)](_0x583474(0x39b))) { const _0x34aaff = _0x4d2c5a['target']['dataset']['id']; _0x7a17dd(_0x583474(0x362))['then'](_0x1c0bce => { _0x1c0bce && _0x26cde9(_0x34aaff); }); } } else _0x51cea9 += '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a'; } else { if ('XYDuS' === 'XYDuS') { const _0x2d367b = Math[_0x583474(0x519)]((_0x33ecee - _0x3a176a) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x51cea9 += '-\x20**对话状态提示**:\x20你们已经有\x20' + _0x2d367b + _0x583474(0x869); } else _0x3e5701[_0x583474(0x462)][_0x583474(0x5f3)] = _0x583474(0x794); } } } else { if (_0x583474(0x1c3) === _0x583474(0x1c3)) _0x51cea9 += _0x583474(0x99a); else { const _0x474032 = _0x2f5c07[_0x583474(0x67e)][_0x583474(0x9b9)](_0x4225c9 => _0x4225c9['id'] === _0x331ba4); if (!_0x474032) return; _0x39b10c['textContent'] = _0x583474(0x1dd), _0x11546d[_0x583474(0x4d3)] = _0x474032['id'], _0x5c9d39[_0x583474(0x4d3)] = _0x474032[_0x583474(0x695)], _0x23b7ac[_0x583474(0x4d3)] = _0x474032[_0x583474(0x75d)], _0x54c9f2[_0x583474(0x462)][_0x583474(0x5f3)] = _0x583474(0x10c), _0x474032[_0x583474(0x28a)][_0x583474(0x8c0)](_0x231995 => { const _0x4bffab = _0x583474, _0x2faad6 = _0x3ebc22[_0x4bffab(0x298)](_0x4bffab(0x5a0) + _0x231995); if (_0x2faad6) _0x2faad6[_0x4bffab(0x8ba)] = !![]; }); } } const _0x2773a1 = ('\x0a' + _0x36173e + _0x583474(0x7b9) + _0x21e0fb[_0x583474(0x695)] + _0x583474(0x770) + _0x21e0fb[_0x583474(0x695)] + ':\x22\x20或\x22[' + _0x21e0fb[_0x583474(0x695)] + _0x583474(0x1ea) + _0x4892ad + _0x583474(0x4bc) + _0x52c19d + '\x0a')['trim'](), _0x52b61a = [{ 'role': 'system', 'content': _0x2773a1 }], _0x4a80ac = (_0x583474(0x95c) + (_0x21e0fb[_0x583474(0x2a1)] || _0x583474(0x19f)) + '\x0a' + _0x57ad33 + '\x20\x0a' + _0x1e1093 + '\x0a' + _0x1055d0 + '\x0a' + _0x3d4860 + '\x0a' + _0x1bd46a + _0x583474(0x849) + _0x48c40f + '\x0a' + _0x51cea9 + '\x0a' + _0x7c4612 + '\x0a')['trim'](); if (_0x4a80ac['replace'](/#.*|\s/g, '')) { if ('aVWiP' !== 'aVWiP') try { const _0xdc37c1 = _0x5f103d[_0x583474(0xa69)](_0x6c5f59); _0x3cd9f5[_0x583474(0x850)](_0xdc37c1) && (_0x4535b9[_0x583474(0x4d3)] = _0xdc37c1[_0x583474(0x33d)](_0x28a97a => _0x28a97a[_0x583474(0x695)] + '--' + _0x28a97a[_0x583474(0x570)])[_0x583474(0x8aa)]('\x0a')); } catch (_0x1e3930) { } else _0x52b61a[_0x583474(0x98f)]({ 'role': _0x583474(0x425), 'content': _0x4a80ac }), _0x52b61a[_0x583474(0x98f)]({ 'role': _0x583474(0x9bb), 'content': _0x583474(0x6b2) }); } const _0x700730 = _0x13c410[_0x583474(0x859)]?.[_0x583474(0x4cf)] ?? 0x64, _0x552f92 = _0x13c410[_0x583474(0x793)][_0x583474(0x6d1)](-_0x700730); for (const _0x1329d4 of _0x552f92) { const _0x21d3ef = _0x1329d4['role'] === 'ai' || _0x1329d4['role'] === 'assistant' ? _0x583474(0x9bb) : _0x583474(0x425); let _0x26fbc3 = { 'role': _0x21d3ef, 'content': _0x1329d4[_0x583474(0x75a)] }, _0x3910c2 = !!_0x1329d4['content']; if (_0x1329d4[_0x583474(0x8ab)] && _0x1329d4['content'][_0x583474(0x71e)]('表情')) { if (_0x583474(0x337) !== _0x583474(0x337)) _0xf7d226[_0x583474(0x349)][_0x583474(0x699)](_0x583474(0x513)), _0x4ed547['scrollIntoView']({ 'behavior': _0x583474(0x190), 'block': 'center' }); else { const _0x1b6cdf = _0x1329d4['content'][_0x583474(0x2a3)](/：(.*?)]$/); _0x26fbc3[_0x583474(0x75a)] = '[sticker:' + (_0x1b6cdf ? _0x1b6cdf[0x1] : _0x583474(0x5ff)) + ']', _0x52b61a[_0x583474(0x98f)](_0x26fbc3); } } else { let _0x4d6190 = null; if (_0x1329d4[_0x583474(0x98c)]) 'AhNTB' !== 'kfcEp' ? _0x4d6190 = _0x1329d4[_0x583474(0x98c)] : _0x5f58b9[_0x583474(0x501)][_0x583474(0x448)](_0x583474(0x51b)); else { if (_0x1329d4[_0x583474(0x5bb)]) { if (_0x583474(0x8b4) !== _0x583474(0x8b4)) { const _0x2b6ba6 = _0x4e39c4[0x0][_0x583474(0x6eb)](), _0x558832 = _0x265b60[0x1][_0x583474(0x6eb)](), _0x54dc6d = { '歌名': '歌曲名称', '艺术家': '歌手', '专辑': '专辑' }; _0x54dc6d[_0x2b6ba6] && (_0x28fbc2[_0x54dc6d[_0x2b6ba6]] = _0x558832); } else try { const _0x1c3146 = await _0xb9bbbf(_0x1329d4[_0x583474(0x5bb)]); if (_0x1c3146) { if (_0x583474(0x4da) === _0x583474(0xff)) return _0x583474(0x604); else _0x4d6190 = await _0x2115c1(_0x1c3146); } } catch (_0x1e47a1) { if (_0x583474(0x8b8) === _0x583474(0x8b8)) console[_0x583474(0x11e)]('在准备API数据时，从IndexedDB读取图片失败:', _0x1e47a1); else { const _0x1a8b80 = _0x36f35a[_0x583474(0xa30)](_0x583474(0xa8b)); _0x1a8b80[_0x583474(0x828)] = 'expense-item', _0x1a8b80['innerHTML'] = '<span\x20class=\x22description\x22>' + _0xb74938[_0x583474(0x361)] + _0x583474(0x768) + _0x51bf20[_0x583474(0x5ca)][_0x583474(0x176)](0x2) + _0x583474(0x4a5) + _0x4ac54f['id'] + _0x583474(0x6ab), _0x20316f[_0x583474(0x3fd)](_0x1a8b80); } } } } _0x4d6190 && (_0x583474(0x9a2) === 'uncSf' ? (_0x60a739 = _0x29d148[_0x583474(0xa30)]('div'), _0x47dc08[_0x583474(0x828)] = _0x583474(0x2dc), _0x31a9b9['textContent'] = _0x583474(0xa74), _0x288ef1['appendChild'](_0x4527db)) : (_0x26fbc3[_0x583474(0x98c)] = _0x4d6190, _0x3910c2 = !![])); if (_0x3910c2) { if ('ABbRX' === 'IrnSk') { if (_0x52802e === null) return; _0x2085e6[_0x583474(0x793)][_0x583474(0x3f5)](_0xd34ebf, 0x1), _0x3098a4(), _0x1c33d1(), _0x623696(); } else _0x52b61a[_0x583474(0x98f)](_0x26fbc3); } } } try { const _0x31df65 = await _0x39cd5c(_0x52b61a); if (!_0x31df65) return ![]; if (_0x2decc8) try { let _0x5ac31f = _0x31df65[_0x583474(0x6eb)](); const _0x404244 = _0x5ac31f[_0x583474(0x2a3)](/(\[[\s\S]*\])/); _0x404244 && (_0x5ac31f = _0x404244[0x1]); const _0x3f9228 = JSON['parse'](_0x5ac31f); if (Array[_0x583474(0x850)](_0x3f9228)) { if ('IhWFm' !== 'IhWFm') { const _0x15808d = _0x164b04[_0x583474(0x38a)](_0xea4730, _0x583474(0x77b)), _0x1c55c2 = _0x15808d[_0x583474(0x4bb)](_0x4c988f), _0x504e6d = _0x1c55c2['get'](_0x3a324c); _0x504e6d['onsuccess'] = () => _0xa87a4f(_0x504e6d[_0x583474(0x211)] ? _0x504e6d['result'][_0x583474(0x9c1)] : null), _0x504e6d['onerror'] = () => _0xc6033(_0x504e6d[_0x583474(0x11e)]); } else { _0x13c410['activeMeetingScriptQueue'] = _0x3f9228, _0x13c410['characterLastScripts'][_0x21e0fb['id']] = [..._0x3f9228], _0x205c90(); const _0x1364ee = _0x3f9228[_0x583474(0x33d)](_0x56a0eb => _0x56a0eb[_0x583474(0x31c)] === _0x583474(0x2a6) ? _0x56a0eb[_0x583474(0x56f)] : _0x56a0eb[_0x583474(0x31c)] + ':\x20' + _0x56a0eb['line'])[_0x583474(0x8aa)]('\x0a\x0a'); _0x13c410['conversationHistory']['push']({ 'role': 'assistant', 'senderId': _0x21e0fb['id'], 'timestamp': Date['now'](), 'isOffline': !![], 'content': _0x1364ee }); } } } catch (_0x6e2b39) { console[_0x583474(0x11e)](_0x583474(0x8da), _0x6e2b39, '原始文本:', _0x31df65), _0x13c410[_0x583474(0x793)][_0x583474(0x98f)]({ 'role': 'assistant', 'senderId': _0x21e0fb['id'], 'timestamp': Date['now'](), 'isOffline': !![], 'content': '[AI返回了无法解析的剧本:\x20' + _0x31df65 + ']' }); } else { const _0x5a67bf = _0x50629b(_0x31df65), _0x1897d0 = _0x5a67bf['map'](_0x1cc63b => { const _0x74a729 = _0x583474, _0x22c28b = _0x1cc63b['trim'](), _0x4e4aa7 = _0x22c28b[_0x74a729(0x2a3)](/^\[sticker:(.*?)\]$/), _0x390567 = _0x22c28b['match'](/^\[transfer:([\d.]+)\|(.*?)\]$/), _0x4b0c46 = _0x22c28b[_0x74a729(0x2a3)](/^\[music:(.*?)\|(.*?)\]$/); if (_0x4b0c46) return { 'type': _0x74a729(0x44d), 'songName': _0x4b0c46[0x1][_0x74a729(0x6eb)](), 'artist': _0x4b0c46[0x2][_0x74a729(0x6eb)]() }; else { if (_0x4e4aa7) return { 'type': _0x74a729(0x52b), 'name': _0x4e4aa7[0x1][_0x74a729(0x6eb)]() }; else { if (_0x390567) { const _0x52c112 = parseFloat(_0x390567[0x1]), _0x5e7dd5 = _0x390567[0x2]['trim'](), _0x25473e = _0x328a3b(_0x13c410['activeChatId']); let _0x23c05b = null; if (_0x5e7dd5 === _0x25473e['name']) _0x23c05b = _0x25473e['id']; else { if (_0x74a729(0xa55) !== 'qPWAo') _0xc06ab9[_0x74a729(0x11e)](_0x74a729(0x3ee) + _0x46e49e['id'] + _0x74a729(0x1c2), _0x3d4325); else { const _0x3dd8fe = _0xee1b45(); if (_0x3dd8fe[_0x74a729(0x974)] === _0x74a729(0x9ad)) { const _0x3f74b4 = _0x13c410['characters'][_0x74a729(0x9b9)](_0x118acb => _0x3dd8fe[_0x74a729(0x9c8)][_0x74a729(0x71e)](_0x118acb['id']) && _0x118acb['name'] === _0x5e7dd5); if (_0x3f74b4) _0x23c05b = _0x3f74b4['id']; } } } if (_0x23c05b) return { 'type': _0x74a729(0x3ca), 'amount': _0x52c112, 'recipientId': _0x23c05b, 'senderId': _0x21e0fb['id'] }; else return { 'type': _0x74a729(0x928), 'content': '(想转账给“' + _0x5e7dd5 + _0x74a729(0x7c8) }; } else { if (_0x22c28b) return { 'type': _0x74a729(0x928), 'content': _0x22c28b }; } } } return null; })[_0x583474(0x61f)](Boolean), _0x5b8f58 = async _0x3c6533 => { const _0x51d9df = _0x583474, _0x3e4241 = { 'role': _0x51d9df(0x9bb), 'senderId': _0x21e0fb['id'], 'timestamp': Date[_0x51d9df(0x2f2)](), 'isOffline': _0x2decc8 }; if (_0x3c6533['type'] === _0x51d9df(0x44d)) { if (_0x51d9df(0x958) === _0x51d9df(0x958)) { const { songName: _0x346337, artist: _0x21afa6 } = _0x3c6533; _0x3e4241[_0x51d9df(0x974)] = _0x51d9df(0x44d), _0x3e4241[_0x51d9df(0x75a)] = _0x51d9df(0x59b) + _0x346337 + _0x51d9df(0xa41) + _0x21afa6 + ']'; try { const _0x25c3be = await _0x3b26b6(_0x346337, _0x21afa6); let _0xe3491e = null; if (_0x25c3be['cover']) { const _0x18230d = await _0x4904fe(_0x25c3be[_0x51d9df(0x45d)]); _0xe3491e = _0x51d9df(0x317) + Date[_0x51d9df(0x2f2)]() + '_' + Math[_0x51d9df(0x2a4)](), await _0x4162d1(_0xe3491e, _0x18230d); } Object['assign'](_0x3e4241, { 'songName': _0x346337, 'artist': _0x21afa6, 'coverId': _0xe3491e, 'playableUrl': _0x25c3be['url'] }); } catch (_0x4eadec) { Object[_0x51d9df(0x6e9)](_0x3e4241, { 'songName': _0x346337, 'artist': _0x21afa6, 'coverId': null, 'playableUrl': null }); } } else _0x4200ad(), _0x11acc9 = null; } else { if (_0x3c6533[_0x51d9df(0x974)] === 'sticker') { const _0x29f565 = _0x5c61cd[_0x51d9df(0x9b9)](_0x195802 => _0x195802[_0x51d9df(0x695)] === _0x3c6533[_0x51d9df(0x695)]); if (_0x29f565) Object['assign'](_0x3e4241, { 'content': '[AI发送了表情：' + _0x29f565[_0x51d9df(0x695)] + ']', 'displayUrl': _0x29f565[_0x51d9df(0x570)] }); else _0x3e4241[_0x51d9df(0x75a)] = _0x51d9df(0xa6d) + _0x3c6533[_0x51d9df(0x695)] + ']'; } else { if (_0x3c6533[_0x51d9df(0x974)] === _0x51d9df(0x3ca)) { if (_0x51d9df(0x817) !== _0x51d9df(0x50e)) { const _0x552d7c = _0x3c6533[_0x51d9df(0x155)] === _0x328a3b(_0x13c410['activeChatId'])['id'] ? _0x328a3b(_0x13c410[_0x51d9df(0x55f)]) : _0x1d08b4(_0x3c6533[_0x51d9df(0x155)]); Object[_0x51d9df(0x6e9)](_0x3e4241, { 'type': _0x51d9df(0x3ca), 'amount': _0x3c6533[_0x51d9df(0x5ca)], 'recipientId': _0x3c6533[_0x51d9df(0x155)], 'content': _0x51d9df(0x689) + (_0x552d7c?.[_0x51d9df(0x695)] || '未知') + _0x51d9df(0x393) + _0x3c6533[_0x51d9df(0x5ca)] + ']' }); } else { const _0x469203 = _0x5af98b[_0x51d9df(0x226)][_0x51d9df(0x9b9)](_0x5e0865 => _0x5e0865[_0x51d9df(0x985)] && _0x5e0865[_0x51d9df(0x985)][_0x51d9df(0x971)]); _0x469203 && (_0x469203['activeListenSession'] = null, _0x35c56f(), _0x405c98(_0x51d9df(0x2b3)), _0x594978(), _0x280235[_0x51d9df(0x349)][_0x51d9df(0x330)](_0x51d9df(0xa12)), _0x38ede4(() => _0x15edd4['style'][_0x51d9df(0x5f3)] = 'none', 0x12c)); } } else { if (_0x51d9df(0x655) !== _0x51d9df(0x655)) { const _0x5cad95 = _0x2bf0b0['createElement'](_0x51d9df(0xa8b)); _0x5cad95[_0x51d9df(0x9e0)] = _0x4fba77, _0x5cad95[_0x51d9df(0x988)](_0x51d9df(0x649), () => { const _0x3070bf = _0x51d9df; _0x221e95[_0x3070bf(0x4d3)] = _0x41466c, _0x9ec330[_0x3070bf(0x349)][_0x3070bf(0x330)](_0x3070bf(0xa12)); }), _0x5cf1f4[_0x51d9df(0x3fd)](_0x5cad95); } else { const _0x467989 = _0x20c3d8(_0x3c6533[_0x51d9df(0x75a)]); Object[_0x51d9df(0x6e9)](_0x3e4241, { 'content': _0x467989[_0x51d9df(0x75a)], 'quotedMessage': _0x467989[_0x51d9df(0x765)] }); } } } } return _0x3e4241; }, _0x48917f = await Promise[_0x583474(0x7b1)](_0x1897d0[_0x583474(0x33d)](_0x5b8f58)); for (const _0x2ebf6e of _0x48917f) { if ('uHRse' !== _0x583474(0x5a2)) { if (_0x2ebf6e[_0x583474(0x75a)] || _0x2ebf6e[_0x583474(0x8ab)] || _0x2ebf6e[_0x583474(0x974)] === _0x583474(0x44d)) { if ('vMWpf' === _0x583474(0x70d)) await new Promise(_0x1a9d63 => setTimeout(_0x1a9d63, 0x12c + Math[_0x583474(0x2a4)]() * 0x190)), _0x13c410[_0x583474(0x793)]['push'](_0x2ebf6e), _0x2522f3(); else { _0x29d2da[_0x583474(0x688)]('好友圈档案柜是空的，无需净化。'); return; } } } else return _0x376ac1['substring'](_0x14f5ae, _0x57f094 + 0x1); } } return _0xe23b38(), _0x2522f3(), !![]; } catch (_0x4ccb4b) { if (_0x583474(0x140) !== _0x583474(0x910)) { if (_0x4ccb4b['name'] !== _0x583474(0x3ff)) { if ('HmSUw' !== _0x583474(0x3a1)) { _0x133d7f('总得说点什么吧？'); return; } else { console['error'](_0x583474(0x97c), _0x4ccb4b); const _0xfbe348 = { 'role': _0x583474(0x9bb), 'content': _0x583474(0x875) + _0x4ccb4b['message'], 'senderId': _0x21e0fb['id'], 'isOffline': _0x2decc8 }; _0x13c410[_0x583474(0x793)]['push'](_0xfbe348), _0x2522f3(); } } return ![]; } else return { 'type': _0x583474(0x52b), 'name': _0x5d8ab1[0x1][_0x583474(0x6eb)]() }; } finally { _0x583474(0x618) !== _0x583474(0x10d) ? _0x42fa49(![]) : _0x82ef69 = _0x413313[_0x583474(0x310)](_0x583474(0x156)); } } async function _0x4a0ae5() { const _0x1d2608 = _0x314838, _0x3c0fc8 = _0xee1b45(); if (!_0x3c0fc8 || _0x3c0fc8[_0x1d2608(0x974)] !== _0x1d2608(0x293)) { if (_0x1d2608(0x664) !== _0x1d2608(0x664)) _0x2af5ab[_0x1d2608(0x501)] = null; else { _0x1e9edf(_0x1d2608(0x9ff)); return; } } if (_0x13c410[_0x1d2608(0x1e8)]) { if (_0x1d2608(0xa26) !== _0x1d2608(0xa26)) _0x4f70c6[_0x1d2608(0x11e)](_0x1d2608(0x9ca), _0x25a501), _0x344707[_0x1d2608(0x11e)]('收到的原始、有问题的文本:', _0x348f8c); else { _0x1e9edf(_0x1d2608(0x641)); return; } } const _0x12bd52 = await _0x39a14a(_0x1d2608(0x251)); if (!_0x12bd52) return; _0x1f66de(!![], _0x1d2608(0x49a)), _0x188eea['value'] = '', _0x3e134b[_0x1d2608(0x349)][_0x1d2608(0x699)]('show'), _0x13c410[_0x1d2608(0x1e8)] = !![]; try { if (_0x1d2608(0x2be) !== _0x1d2608(0x2be)) _0x3c133b[_0x1d2608(0x55f)] = _0x25ca61[_0x1d2608(0x226)][0x0]?.['id'] || null; else { const _0x14e3c8 = _0x1d08b4(_0x3c0fc8[_0x1d2608(0x9c8)][0x0]), _0x5c0f12 = _0x328a3b(_0x3c0fc8['id']), _0x52b762 = _0x425ca9(_0x3c0fc8['id']); if (_0x52b762[_0x1d2608(0x280)] === 0x0) { _0x188eea['value'] = _0x1d2608(0x312); return; } const _0x3a7cd8 = _0x52b762[_0x1d2608(0x33d)](_0x390d7e => { const _0x44ada3 = _0x1d2608, _0x22bdea = new Date(_0x390d7e[_0x44ada3(0x921)]), _0x520af2 = _0x22bdea[_0x44ada3(0x2bf)]() + '-' + String(_0x22bdea[_0x44ada3(0x550)]() + 0x1)[_0x44ada3(0x380)](0x2, '0') + '-' + String(_0x22bdea[_0x44ada3(0x1a4)]())[_0x44ada3(0x380)](0x2, '0'), _0x542f86 = String(_0x22bdea[_0x44ada3(0x936)]())['padStart'](0x2, '0') + ':' + String(_0x22bdea[_0x44ada3(0x546)]())[_0x44ada3(0x380)](0x2, '0'); let _0xc812f9 = '未知'; _0x390d7e['role'] === _0x44ada3(0x425) ? _0xc812f9 = _0x5c0f12[_0x44ada3(0x695)] : _0xc812f9 = _0x14e3c8['name']; let _0x2ed7d2 = _0x390d7e[_0x44ada3(0x75a)]; if (_0x390d7e[_0x44ada3(0x8ab)]) _0x2ed7d2 = _0x44ada3(0x83e); if (_0x390d7e[_0x44ada3(0x5bb)]) _0x2ed7d2 = _0x44ada3(0xa97); return '[' + _0x520af2 + '\x20' + _0x542f86 + _0x44ada3(0x5d7) + _0xc812f9 + _0x44ada3(0x71f) + _0x2ed7d2; })[_0x1d2608(0x8aa)]('\x0a'), _0x479213 = _0xfba233[_0x1d2608(0x1b5)](/{charName}/g, _0x14e3c8[_0x1d2608(0x695)])[_0x1d2608(0x1b5)](/{userName}/g, _0x5c0f12[_0x1d2608(0x695)]), _0x1a5607 = [{ 'role': _0x1d2608(0x711), 'content': _0x479213 }, { 'role': 'user', 'content': _0x3a7cd8 }], _0xa40937 = await _0x39cd5c(_0x1a5607); _0x188eea['value'] = _0xa40937 || _0x1d2608(0x124), _0x188eea[_0x1d2608(0x5f8)] = 0x0; } } catch (_0x42efdb) { _0x1d2608(0x1fa) === 'THddD' ? (_0x35c0e8(_0x41ee2a, { 'force': !![], 'delayMs': _0x4fd920 }), _0x54295f += 0x1f4) : (console[_0x1d2608(0x11e)](_0x1d2608(0x309), _0x42efdb), _0x188eea[_0x1d2608(0x4d3)] = _0x1d2608(0x9ea) + _0x42efdb[_0x1d2608(0x496)]); } finally { _0x1f66de(![]), _0x13c410[_0x1d2608(0x1e8)] = ![]; } } async function _0x4d5866() { const _0x17b9e6 = _0x314838; if (_0x17b9e6(0x3f2) !== 'VZhav') { if (!_0x4701df) return; _0x19f221[_0x103876] = _0x4f9fbc, _0x31190e[_0x88f993]['querySelector'](_0x17b9e6(0x55b))[_0x17b9e6(0x9e0)] = _0x5b6494['name'], _0x5ac49b[_0x4ecff3][_0x17b9e6(0x349)][_0x17b9e6(0x699)](_0x17b9e6(0x829)), _0x1cdb03(); } else { console[_0x17b9e6(0x688)](_0x17b9e6(0x85f)); if (!_0x13c410[_0x17b9e6(0xa48)][_0x17b9e6(0x7d7)] || !_0x13c410[_0x17b9e6(0xa48)][_0x17b9e6(0x8ee)] || !_0x13c410[_0x17b9e6(0xa48)][_0x17b9e6(0x7b4)]) { if ('aZcrg' === _0x17b9e6(0x182)) { _0x1e9edf(_0x17b9e6(0x51a)); return; } else _0x4c0979('导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a' + _0x5c9b13[_0x17b9e6(0x8aa)]('\x0a')); } const _0x33d32d = _0x13c410[_0x17b9e6(0x793)]['at'](-0x1)?.[_0x17b9e6(0x4cc)] === _0x17b9e6(0x425); if (!_0x33d32d || _0x13c410[_0x17b9e6(0x1e8)]) return; const _0x14d0ba = _0xee1b45(); if (!_0x14d0ba) return; _0x13c410['isGenerating'] = !![], _0x42fa49(!![]); try { if (_0x17b9e6(0x18a) === _0x17b9e6(0x104)) _0x47caa2(), _0x55b3fe(_0x17b9e6(0x73e), _0x17b9e6(0x36c)); else { if (_0x14d0ba['type'] === _0x17b9e6(0x293)) { const _0x4247d7 = _0x1d08b4(_0x14d0ba[_0x17b9e6(0x9c8)][0x0]); console[_0x17b9e6(0x688)](_0x17b9e6(0x8d2)); if (_0x4247d7) await _0x3cd76d(_0x4247d7, { 'force': !![] }); } else { const _0x29d8b6 = await _0x35ac1d(); if (_0x29d8b6 && _0x29d8b6[_0x17b9e6(0x572)]?.[_0x17b9e6(0x280)]) await _0x28e0c9(_0x29d8b6); else { console[_0x17b9e6(0x1a0)](_0x17b9e6(0x2bd)); const _0x407448 = _0x14d0ba[_0x17b9e6(0x9c8)][_0x17b9e6(0x33d)](_0x1d08b4)[_0x17b9e6(0x61f)](Boolean); if (!_0x407448['length']) return; let _0x520f1f = 0x0; for (const _0x206312 of _0x407448) { _0x17b9e6(0x72d) !== 'hQedA' ? _0xebb79e[_0x17b9e6(0x98c)] = _0x5e488e : (_0x3cd76d(_0x206312, { 'force': !![], 'delayMs': _0x520f1f }), _0x520f1f += 0x1f4); } } } } } catch (_0x5ec483) { _0x5ec483[_0x17b9e6(0x695)] !== _0x17b9e6(0x3ff) && (_0x17b9e6(0x3e7) === _0x17b9e6(0x3e7) ? (console[_0x17b9e6(0x11e)]('获取AI响应失败:', _0x5ec483), _0x23a32c({ 'role': 'assistant', 'content': '错误:\x20' + _0x5ec483[_0x17b9e6(0x496)] }, _0x13c410['conversationHistory'][_0x17b9e6(0x280)] - 0x1)) : _0x2a6043[_0x17b9e6(0x918)](_0x1ae02d)); } finally { _0x13c410['isGenerating'] = ![], _0x42fa49(![]); } } } function _0xb75fb2(_0x124bb2, _0x5762d1) { const _0x5cd832 = _0x314838; if (_0x5cd832(0x621) === _0x5cd832(0x621)) { const _0xe7ca40 = _0x5762d1['toLowerCase'](), _0x5e9aaf = _0x124bb2[_0x5cd832(0x430)](); if (_0xe7ca40['startsWith'](_0x5cd832(0x653))) return _0x5cd832(0x3ba); if (_0x5e9aaf[_0x5cd832(0x71e)](_0x5cd832(0x485))) return 'anthropic'; if (_0x5e9aaf['includes'](_0x5cd832(0x7f8))) return _0x5cd832(0x2e1); if (_0xe7ca40[_0x5cd832(0x6ec)]('gemini')) return _0x5cd832(0x2e1); return 'openai'; } else { const _0x2d3005 = (_0x4fc663[_0x5cd832(0x956)] || [])[_0x5cd832(0x33d)](_0x2f23fc => '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20font-size:\x200.9rem;\x20color:\x20var(--text-color);\x20margin-top:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>' + _0x2f23fc + '</span>\x0a\x20\x20\x20\x20\x20\x20</div>')[_0x5cd832(0x8aa)](''); return _0x5cd832(0x9d5) + (_0x342523['restaurant_name'] || _0x5cd832(0x454)) + _0x5cd832(0x59e) + (_0x444035[_0x5cd832(0x921)] || '') + _0x5cd832(0x13a) + (_0xe84dd5[_0x5cd832(0x3b4)] || _0x5cd832(0x9c7)) + _0x5cd832(0x8bf) + _0x2d3005 + _0x5cd832(0x5c5) + (_0x3dee97[_0x5cd832(0x3b2)] || 0x0)['toFixed'](0x2) + _0x5cd832(0x5ef); } } async function _0x39cd5c(_0x35f157, _0xea2cd6 = {}) { const _0x578f80 = _0x314838; _0x13c410[_0x578f80(0x501)] && (_0x578f80(0x2cc) !== _0x578f80(0x77c) ? _0x13c410[_0x578f80(0x501)][_0x578f80(0x448)]('New\x20request\x20started') : _0x59c31d['getElementById'](_0x578f80(0x6de))[_0x578f80(0x268)] = _0x4217ef[_0x578f80(0x907)] || _0x1a5f59); _0x13c410['currentAbortController'] = new AbortController(); const _0x8c3727 = _0x13c410[_0x578f80(0x501)][_0x578f80(0x5f4)], { endpoint: _0x4f269f, key: _0x3ae6fa, model: _0x5994f4 } = _0x13c410['apiSettings'], _0x37fcb5 = !!_0xea2cd6['json'], _0x4d2ebb = _0xb75fb2(_0x4f269f, _0x5994f4); console[_0x578f80(0x688)](_0x578f80(0x194) + _0x4d2ebb); let _0x279637 = ''; try { switch (_0x4d2ebb) { case _0x578f80(0x3ba): { if (_0x578f80(0x1dc) !== _0x578f80(0x1dc)) _0x310673[_0x578f80(0x695)] = _0x161af5['trim'](), _0x8d5db1(), _0x20d1d6(), _0x4bcbc5(), _0x4cd6d9(_0x578f80(0x220) + _0x129a11[_0x578f80(0x695)] + '\x22。'); else { const _0xa029a9 = _0x5347f7(_0x3ae6fa), _0x589b65 = _0x35f157[_0x578f80(0x9b9)](_0x194449 => _0x194449[_0x578f80(0x4cc)] === _0x578f80(0x711))?.[_0x578f80(0x75a)] || '', _0x4dfd7a = _0x35f157[_0x578f80(0x61f)](_0x21e243 => _0x21e243[_0x578f80(0x4cc)] !== _0x578f80(0x711)), _0x290397 = { 'model': _0x5994f4, 'system': _0x589b65, 'messages': _0x4dfd7a[_0x578f80(0x33d)](_0x555750 => ({ 'role': _0x555750[_0x578f80(0x4cc)], 'content': [{ 'type': 'text', 'text': _0x555750['content'] }] })), 'max_tokens': 0x1000 }, _0x2ee166 = await fetch(_0x4f269f, { 'method': _0x578f80(0x8ae), 'headers': { 'Content-Type': _0x578f80(0x75f), 'x-api-key': _0xa029a9, 'anthropic-version': _0x578f80(0x8ac) }, 'body': JSON['stringify'](_0x290397), 'signal': _0x8c3727 }); if (!_0x2ee166['ok']) { if (_0x578f80(0x420) === _0x578f80(0x5ea)) { const _0x526960 = _0x45146e[_0x578f80(0x6d7)][_0x578f80(0x211)]; _0x431924[_0x578f80(0x688)](_0x578f80(0x32b) + _0x526960[_0x578f80(0x80c)] + '...'), !_0x526960[_0x578f80(0x61a)]['contains'](_0x39517c) && (_0x1cfa5d[_0x578f80(0x688)](_0x578f80(0x4c3) + _0xfb9c5a), _0x526960[_0x578f80(0xed)](_0x23a878, { 'keyPath': 'id' })), !_0x526960[_0x578f80(0x61a)][_0x578f80(0x741)](_0x578f80(0x167)) && (_0xbac697[_0x578f80(0x688)](_0x578f80(0x4b0)), _0x526960[_0x578f80(0xed)](_0x578f80(0x167), { 'keyPath': 'id' })), !_0x526960[_0x578f80(0x61a)]['contains'](_0x3a871e) && (_0x58dd90[_0x578f80(0x688)]('Creating\x20object\x20store:\x20' + _0x406d7e), _0x526960[_0x578f80(0xed)](_0x5bad81, { 'keyPath': 'id' })); } else { const _0x2c44a0 = await _0x2ee166[_0x578f80(0x32c)]()[_0x578f80(0x782)](() => ({})); throw new Error(_0x578f80(0x9e8) + _0x2ee166['status'] + '\x20-\x20' + (_0x2c44a0[_0x578f80(0x11e)]?.[_0x578f80(0x496)] || _0x2ee166[_0x578f80(0x6e7)])); } } const _0x5aca67 = await _0x2ee166[_0x578f80(0x32c)](); _0x279637 = _0x5aca67['content']?.[0x0]?.['text'] || ''; break; } } case 'gemini': { const _0x1a171f = _0x5347f7(_0x3ae6fa), _0x56c5a9 = _0x4f269f['includes'](_0x578f80(0x27d)), _0xc7800b = _0x5245e0 => { const _0x491bcc = _0x578f80; if (_0x491bcc(0x3a7) !== 'whcKn') _0xb66f95[_0x491bcc(0x974)] = _0x491bcc(0x44d), _0x5e47bd[_0x491bcc(0x6e9)](_0x1cf086, _0x33160b); else { const _0x20f4b2 = []; if (_0x5245e0['content']) _0x20f4b2[_0x491bcc(0x98f)]({ 'text': _0x5245e0['content'] }); if (_0x5245e0[_0x491bcc(0x98c)]) { const _0x24ddb9 = _0x5245e0[_0x491bcc(0x98c)][_0x491bcc(0x17a)](',')[0x1], _0x4bdbb0 = _0x5245e0[_0x491bcc(0x98c)][_0x491bcc(0x5e0)](_0x5245e0[_0x491bcc(0x98c)][_0x491bcc(0x861)](':') + 0x1, _0x5245e0[_0x491bcc(0x98c)][_0x491bcc(0x861)](';')) || _0x491bcc(0xe9); _0x20f4b2[_0x491bcc(0x98f)]({ 'inline_data': { 'mime_type': _0x4bdbb0, 'data': _0x24ddb9 } }); } return _0x20f4b2; } }, _0x2dd38a = _0x35f157['map'](_0x3afca4 => ({ 'role': _0x3afca4[_0x578f80(0x4cc)] === _0x578f80(0x9bb) ? 'model' : _0x3afca4[_0x578f80(0x4cc)] === _0x578f80(0x711) ? 'user' : _0x3afca4[_0x578f80(0x4cc)], 'parts': _0xc7800b(_0x3afca4) }))[_0x578f80(0x61f)](_0x4b95b0 => _0x4b95b0['parts']['length'] > 0x0), _0x51f4e0 = { 'contents': _0x2dd38a }; _0x37fcb5 && _0x56c5a9 && (_0x578f80(0x517) !== _0x578f80(0x517) ? (_0x7ff676(![]), _0x38897f['isGenerating'] = ![]) : _0x51f4e0[_0x578f80(0x416)] = { 'response_mime_type': _0x578f80(0x75f) }); const _0x3638af = _0x4f269f + '/v1beta/models/' + _0x5994f4 + ':streamGenerateContent?key=' + _0x1a171f + _0x578f80(0x2e3), _0x2b9d4e = await fetch(_0x3638af, { 'method': 'POST', 'headers': { 'Content-Type': 'application/json' }, 'body': JSON[_0x578f80(0x3e1)](_0x51f4e0), 'signal': _0x8c3727 }); if (!_0x2b9d4e['ok']) throw new Error('Gemini\x20API\x20Error:\x20' + _0x2b9d4e[_0x578f80(0x3b4)]); const _0x229e73 = _0x2b9d4e[_0x578f80(0x32a)][_0x578f80(0x820)](), _0x66d42e = new TextDecoder(); let _0x412c11 = ''; while (!![]) { if (_0x8c3727[_0x578f80(0x3da)]) { console[_0x578f80(0x688)](_0x578f80(0x716)), _0x229e73[_0x578f80(0x85e)](); break; } const { done: _0x176536, value: _0x5a1fd7 } = await _0x229e73[_0x578f80(0x7e8)](); if (_0x176536) break; const _0x5cb03c = _0x66d42e[_0x578f80(0x44f)](_0x5a1fd7, { 'stream': !![] }), _0x246961 = _0x5cb03c[_0x578f80(0x17a)]('\x0a')[_0x578f80(0x61f)](_0x1b3a55 => _0x1b3a55[_0x578f80(0x6eb)]()[_0x578f80(0x6ec)](_0x578f80(0x20e))); for (const _0x56dc83 of _0x246961) { const _0x28c97d = _0x56dc83[_0x578f80(0x1b5)]('data:\x20', ''); if (_0x28c97d === _0x578f80(0x970)) break; try { _0x412c11 += JSON['parse'](_0x28c97d)[_0x578f80(0xa06)][0x0]['content'][_0x578f80(0x463)][0x0][_0x578f80(0x928)]; } catch { } } } _0x279637 = _0x412c11; break; } case 'openai': default: { const _0x4c35d8 = _0x5347f7(_0x3ae6fa), _0x5ee2d5 = _0x4f269f[_0x578f80(0x1b5)](/\/+$/, '') + _0x578f80(0x1ed), _0x1bc2dc = _0x35f157[_0x578f80(0x33d)](_0x390006 => { const _0x312210 = _0x578f80; if (_0x312210(0x598) !== _0x312210(0x90e)) { if (_0x390006[_0x312210(0x4cc)] === _0x312210(0x425) && _0x390006[_0x312210(0x98c)]) return { 'role': _0x312210(0x425), 'content': [{ 'type': 'text', 'text': _0x390006['content'] || '\x20' }, { 'type': _0x312210(0x2c4), 'image_url': { 'url': _0x390006[_0x312210(0x98c)], 'detail': _0x312210(0x525) } }] }; return { 'role': _0x390006['role'], 'content': _0x390006[_0x312210(0x75a)] }; } else _0x261eab['push']({ 'name': _0x2abfaa[0x0][_0x312210(0x6eb)](), 'url': _0x5c8c1c[0x1][_0x312210(0x6eb)]() }); })['filter'](_0x3c914b => _0x3c914b[_0x578f80(0x75a)]), _0x2db83a = { 'model': _0x5994f4, 'messages': _0x1bc2dc, 'max_tokens': 0x1000, ..._0x37fcb5 ? { 'response_format': { 'type': _0x578f80(0x1d8) } } : {} }, _0x390c2c = await fetch(_0x5ee2d5, { 'method': _0x578f80(0x8ae), 'headers': { 'Content-Type': _0x578f80(0x75f), 'Authorization': _0x578f80(0x85d) + _0x4c35d8 }, 'body': JSON[_0x578f80(0x3e1)](_0x2db83a), 'signal': _0x8c3727 }); if (!_0x390c2c['ok']) { const _0x198731 = await _0x390c2c[_0x578f80(0x32c)]()[_0x578f80(0x782)](() => ({})); throw new Error(_0x578f80(0x45b) + _0x390c2c[_0x578f80(0x3b4)] + _0x578f80(0xa41) + (_0x198731['error']?.[_0x578f80(0x496)] || _0x390c2c[_0x578f80(0x6e7)])); } const _0x3c4ea1 = await _0x390c2c[_0x578f80(0x32c)](); _0x279637 = _0x3c4ea1['choices']?.[0x0]?.[_0x578f80(0x496)]?.[_0x578f80(0x75a)] || ''; break; } }return _0x279637; } catch (_0x3eb84b) { if (_0x3eb84b[_0x578f80(0x695)] === _0x578f80(0x3ff)) return console[_0x578f80(0x688)](_0x578f80(0x7ee)), ''; throw _0x3eb84b; } finally { _0x13c410[_0x578f80(0x501)] && _0x13c410[_0x578f80(0x501)]['signal'] === _0x8c3727 && (_0x13c410['currentAbortController'] = null); } } async function _0xb0e3ba() { const _0x296d47 = _0x314838, _0x97338e = _0x974bdb[_0x296d47(0x413)]['classList'][_0x296d47(0x741)](_0x296d47(0x513)), _0x35b268 = _0x97338e ? _0x490d5c[_0x296d47(0x4d3)] : null; let _0x50b53b = null, _0x2df71b = ''; if (_0x97338e && _0x35b268) { _0x50b53b = _0x13c410[_0x296d47(0x226)][_0x296d47(0x9b9)](_0x33182f => _0x33182f[_0x296d47(0x974)] === 'private' && _0x33182f[_0x296d47(0x9c8)]['includes'](_0x35b268)); const _0x341681 = _0x1d08b4(_0x35b268); _0x2df71b = _0x341681 ? _0x341681[_0x296d47(0x695)] : _0x296d47(0x542); } else { if (_0x13c410[_0x296d47(0x55f)]) { _0x50b53b = _0xee1b45(); const _0x34ff3e = document[_0x296d47(0x7d5)](_0x296d47(0x67d))[_0x296d47(0x9e0)]; _0x2df71b = _0x34ff3e || '当前聊天'; } } if (!_0x50b53b) { _0x1e9edf(_0x296d47(0x24d)); return; } const _0x2bc3bb = await _0x39a14a(_0x296d47(0x223) + _0x2df71b + _0x296d47(0x76b)); if (!_0x2bc3bb) return; _0x50b53b['id'] === _0x13c410[_0x296d47(0x55f)] && (_0x336cd5(), _0x13c410[_0x296d47(0x793)] = [], _0x403f79()); try { if ('NYQbV' === 'jwSel') throw new _0x1bc57b(_0x296d47(0x41c)); else localStorage[_0x296d47(0x7ec)](_0x296d47(0x151) + _0x50b53b['id']); } catch (_0x3b230d) { 'klFrl' === _0x296d47(0x3d2) ? console[_0x296d47(0x11e)](_0x296d47(0x178) + _0x50b53b['id'], _0x3b230d) : _0xee6837[_0x296d47(0x65e)] = _0x296d47(0xa59) + _0xe539d + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x61d117[_0x296d47(0x30d)] + _0x296d47(0x9a7) + _0x233e19[_0x296d47(0x376)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>'; } _0x1e9edf('\x22' + _0x2df71b + '\x22\x20的聊天记录已清空。'); } const _0x19d49b = document['getElementById'](_0x314838(0x86a)), _0x3cce24 = document[_0x314838(0x7d5)]('import-all-data-button'), _0x2624b6 = document['getElementById']('import-data-input'); _0x19d49b['addEventListener']('click', async () => { const _0x173179 = _0x314838; _0x1f66de(!![], _0x173179(0x85c)); const _0x5ad18e = []; try { const _0xa35978 = { 'localStorageData': {}, 'indexedDBData': {}, 'indexedDBMusicData': [] }; for (let _0x2d0a50 = 0x0; _0x2d0a50 < localStorage[_0x173179(0x280)]; _0x2d0a50++) { if (_0x173179(0x468) !== _0x173179(0x895)) { const _0x4ccb24 = localStorage['key'](_0x2d0a50); if (_0x4ccb24) _0xa35978[_0x173179(0xa4e)][_0x4ccb24] = localStorage[_0x173179(0x310)](_0x4ccb24); } else _0x113a07 += _0x173179(0x4ff); } const _0x5682a2 = await _0x338d1d, _0x47d665 = _0x5682a2['transaction'](_0x4e5aa3, _0x173179(0x77b)), _0x5cd8cc = _0x47d665['objectStore'](_0x4e5aa3), _0x4490b0 = await new Promise((_0x5362f8, _0x1a49fd) => { const _0x4512eb = _0x173179, _0x478dc4 = _0x5cd8cc['getAll'](); _0x478dc4[_0x4512eb(0x804)] = () => _0x5362f8(_0x478dc4[_0x4512eb(0x211)]), _0x478dc4[_0x4512eb(0xaa9)] = () => _0x1a49fd(_0x478dc4[_0x4512eb(0x11e)]); }); for (const _0x3e4c37 of _0x4490b0) { if (_0x3e4c37[_0x173179(0x409)] instanceof Blob) try { _0xa35978[_0x173179(0x635)][_0x3e4c37['id']] = await _0x2115c1(_0x3e4c37[_0x173179(0x409)]); } catch (_0x4be1a3) { _0x5ad18e[_0x173179(0x98f)](_0x3e4c37['id']); } } const _0x5ccdfa = _0x5682a2['transaction'](_0x27d534, _0x173179(0x77b)), _0x35a696 = _0x5ccdfa[_0x173179(0x4bb)](_0x27d534), _0x30f7f3 = await new Promise((_0x3450fd, _0x404818) => { const _0xc7a9a4 = _0x173179, _0x1f8cfb = _0x35a696[_0xc7a9a4(0x48f)](); _0x1f8cfb[_0xc7a9a4(0x804)] = () => _0x3450fd(_0x1f8cfb[_0xc7a9a4(0x211)]), _0x1f8cfb[_0xc7a9a4(0xaa9)] = () => _0x404818(_0x1f8cfb[_0xc7a9a4(0x11e)]); }); for (const _0x590329 of _0x30f7f3) { if (_0x173179(0x84f) !== 'CQLHF') { const _0x515654 = { ..._0x590329 }; _0x590329['audio'] instanceof Blob && (_0x515654[_0x173179(0x7b6)] = await _0x2115c1(_0x590329['audio'])); if (_0x590329['cover'] instanceof Blob) { if (_0x173179(0x5a6) === 'kAcIh') { if (_0x303cb2[_0x173179(0x26b)]) _0x3e1364(_0x4ba4ea[_0x173179(0x26b)]); } else _0x515654[_0x173179(0x45d)] = await _0x2115c1(_0x590329[_0x173179(0x45d)]); } _0xa35978[_0x173179(0x4c0)]['push'](_0x515654); } else { const _0x15ed04 = _0x134622[_0x173179(0xa69)](_0x4e1d42); _0x3327dc[_0x173179(0x850)](_0x15ed04) && (_0x2e5eb5[_0x173179(0x4d3)] = _0x15ed04[_0x173179(0x33d)](_0x56c52f => _0x56c52f[_0x173179(0x695)] + '--' + _0x56c52f[_0x173179(0x570)])[_0x173179(0x8aa)]('\x0a')); } } const _0x294ba3 = new Blob([JSON[_0x173179(0x3e1)](_0xa35978, null, 0x2)], { 'type': _0x173179(0x75f) }), _0x40d377 = URL[_0x173179(0x602)](_0x294ba3), _0x166302 = document[_0x173179(0xa30)]('a'), _0x5efb7f = new Date(), _0x5a4cc1 = _0x5efb7f[_0x173179(0x2bf)]() + '-' + String(_0x5efb7f['getMonth']() + 0x1)[_0x173179(0x380)](0x2, '0') + '-' + String(_0x5efb7f[_0x173179(0x1a4)]())[_0x173179(0x380)](0x2, '0'); _0x166302[_0x173179(0x7ce)] = _0x40d377, _0x166302[_0x173179(0x8a8)] = _0x173179(0x276) + _0x5a4cc1 + '.json', document[_0x173179(0x32a)][_0x173179(0x3fd)](_0x166302), _0x166302[_0x173179(0x649)](), document[_0x173179(0x32a)][_0x173179(0x2ec)](_0x166302), URL[_0x173179(0x918)](_0x40d377), _0x1f66de(![]), _0x5ad18e['length'] > 0x0 ? _0x173179(0x28d) !== 'profo' ? (_0x38df41 *= _0x3f3753 / _0x1ee141, _0x36ffae = _0x4547d9) : _0x1e9edf('导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a' + _0x5ad18e['join']('\x0a')) : _0x173179(0x114) !== _0x173179(0x114) ? _0x4e88d5 = _0x1d5a55(_0x5030a8) : _0x1e9edf(_0x173179(0x2ba)); } catch (_0x5f56f8) { _0x1f66de(![]), console[_0x173179(0x11e)](_0x173179(0x7f1), _0x5f56f8), _0x1e9edf(_0x173179(0x1fb) + _0x5f56f8[_0x173179(0x496)]); } }), _0x3cce24[_0x314838(0x988)](_0x314838(0x649), () => { const _0x3af3ea = _0x314838; _0x2624b6[_0x3af3ea(0x649)](); }), _0x59def7[_0x314838(0x988)](_0x314838(0x649), _0x1cf0fd), _0x2624b6[_0x314838(0x988)]('change', _0x2790bc => { const _0x47c835 = _0x314838; if (_0x47c835(0x705) === _0x47c835(0xa05)) _0x43f2b2 = _0x515a5d['avatar']; else { const _0x4eb73b = _0x2790bc['target'][_0x47c835(0x6ea)][0x0]; if (!_0x4eb73b) return; _0x39a14a(_0x47c835(0x13b))[_0x47c835(0x834)](_0x27d833 => { const _0x3dd2d1 = _0x47c835; if (!_0x27d833) { _0x2624b6[_0x3dd2d1(0x4d3)] = ''; return; } _0x1f66de(!![], '正在解析备份文件...'); const _0x204c2a = new FileReader(); _0x204c2a['onload'] = async _0x5430f1 => { const _0x2d0865 = _0x3dd2d1; try { const _0x5565c7 = JSON[_0x2d0865(0xa69)](_0x5430f1[_0x2d0865(0x6d7)][_0x2d0865(0x211)]); if (!_0x5565c7[_0x2d0865(0xa4e)] || !_0x5565c7[_0x2d0865(0x635)]) throw new Error(_0x2d0865(0x340)); _0x1f66de(!![], '正在准备图片数据...'); const _0x26f0d9 = await Promise['all'](Object['keys'](_0x5565c7[_0x2d0865(0x635)])[_0x2d0865(0x33d)](async _0x53769c => { const _0x459bc = _0x2d0865; if (_0x459bc(0x243) !== _0x459bc(0x243)) _0x1a3fc1['push']({ 'role': _0x459bc(0x425), 'content': _0x3e3b1b }), _0x4f904c['push']({ 'role': _0x459bc(0x9bb), 'content': _0x459bc(0x6b2) }); else { const _0xfdcbe4 = _0x5565c7[_0x459bc(0x635)][_0x53769c]; if (typeof _0xfdcbe4 === _0x459bc(0x802) && _0xfdcbe4['startsWith']('data:')) { const _0x104b33 = await _0x4904fe(_0xfdcbe4); return { 'id': _0x53769c, 'blob': _0x104b33 }; } return null; } }))[_0x2d0865(0x834)](_0x3fe131 => _0x3fe131[_0x2d0865(0x61f)](Boolean)), _0x40eb22 = []; if (_0x5565c7[_0x2d0865(0x4c0)]) { if (_0x2d0865(0x9e2) === _0x2d0865(0x9e2)) { _0x1f66de(!![], _0x2d0865(0xa85)); const _0x4b5df6 = _0x5565c7[_0x2d0865(0x4c0)][_0x2d0865(0x33d)](async _0x5c0e0d => { const _0x547650 = _0x2d0865; if (_0x547650(0x1b7) !== _0x547650(0x1b7)) _0x31c325[_0x547650(0x9e0)] = _0x45b4b9[_0x547650(0x212)]('zh-CN', { 'hour': '2-digit', 'minute': _0x547650(0x5bc), 'hour12': ![] }), _0x157b1e[_0x547650(0x9e0)] = _0x36a402[_0x547650(0x116)](_0x547650(0x14d), { 'month': 'long', 'day': _0x547650(0x847), 'weekday': _0x547650(0x712) }); else { const _0x557cac = { ..._0x5c0e0d }; if (_0x5c0e0d[_0x547650(0x7b6)]) _0x557cac['audio'] = await _0x4904fe(_0x5c0e0d[_0x547650(0x7b6)]); if (_0x5c0e0d['cover']) _0x557cac[_0x547650(0x45d)] = await _0x4904fe(_0x5c0e0d['cover']); return _0x557cac; } }); _0x40eb22['push'](...await Promise[_0x2d0865(0x7b1)](_0x4b5df6)); } else { if (!_0x1428b4[_0x2d0865(0x850)](_0x24609b)) return _0x2d0865(0xa1a); if (_0x2d8e02[_0x2d0865(0x280)] === 0x0) return _0x2d0865(0x3cf); return _0x40d277[_0x2d0865(0x25d)]((_0x2a0997, _0x32c5ec) => new _0xe99e56(_0x32c5ec['timestamp']) - new _0x1e7f0a(_0x2a0997[_0x2d0865(0x921)])), _0x2d0865(0x818) + _0x277d8f[_0x2d0865(0x33d)](_0x4de302 => _0x2d0865(0x30f) + (_0x4de302[_0x2d0865(0x147)] || '未知地点') + _0x2d0865(0x64d) + (_0x4de302[_0x2d0865(0x6c9)] || '') + _0x2d0865(0x2f1) + (_0x4de302[_0x2d0865(0x921)] || '') + _0x2d0865(0x8fd))['join']('') + _0x2d0865(0x447); } } _0x1f66de(!![], _0x2d0865(0xa96)), localStorage[_0x2d0865(0x622)](); for (const _0x35e414 in _0x5565c7[_0x2d0865(0xa4e)]) { localStorage[_0x2d0865(0x629)](_0x35e414, _0x5565c7[_0x2d0865(0xa4e)][_0x35e414]); } _0x1f66de(!![], _0x2d0865(0x4e9)); const _0x5055ea = await _0x338d1d, _0x57ca60 = _0x5055ea['transaction']([_0x4e5aa3, _0x27d534, _0x369ae2], _0x2d0865(0x989)), _0x41d8f7 = _0x57ca60[_0x2d0865(0x4bb)](_0x4e5aa3), _0xb1cbec = _0x57ca60[_0x2d0865(0x4bb)](_0x27d534), _0x5e87d2 = _0x57ca60[_0x2d0865(0x4bb)](_0x369ae2); _0x41d8f7['clear'](), _0xb1cbec[_0x2d0865(0x622)](), _0x5e87d2[_0x2d0865(0x622)](), _0x26f0d9[_0x2d0865(0x8c0)](_0x50df7 => _0x41d8f7[_0x2d0865(0x732)](_0x50df7)), _0x40eb22[_0x2d0865(0x8c0)](_0x2184e1 => _0xb1cbec['put'](_0x2184e1)), await new Promise((_0x49713c, _0x57d8bd) => { const _0x2b70c = _0x2d0865; if (_0x2b70c(0x8b6) !== _0x2b70c(0x16a)) _0x57ca60[_0x2b70c(0x9c2)] = _0x49713c, _0x57ca60[_0x2b70c(0xaa9)] = _0x14e59a => _0x57d8bd(_0x14e59a['target'][_0x2b70c(0x11e)]); else { const { playlist: _0x418a7c, currentIndex: _0x3661a3 } = _0xc8b43a[_0x2b70c(0xa69)](_0x89d357); _0x392ca6[_0x2b70c(0x850)](_0x418a7c) && _0x418a7c[_0x2b70c(0x280)] > 0x0 && _0x3661a3 > -0x1 && (_0x5ac1ef['musicPlaylist'] = _0x418a7c, _0x324a36['currentlyPlayingIndex'] = _0x3661a3, _0x23eaaa['isPlaying'] = ![], _0x5b338b()); } }), _0x1f66de(![]), _0x1e9edf('数据导入成功！应用即将刷新...'), setTimeout(() => location[_0x2d0865(0x569)](), 0x640); } catch (_0x1e5abf) { if (_0x2d0865(0x676) !== _0x2d0865(0x676)) { _0x1d378b('正在生成中，请稍候...'); return; } else _0x1f66de(![]), console[_0x2d0865(0x11e)](_0x2d0865(0x5c6), _0x1e5abf), _0x1e9edf(_0x2d0865(0x81f) + _0x1e5abf['message']); } finally { _0x2d0865(0x291) !== _0x2d0865(0x785) ? _0x2624b6['value'] = '' : (_0xe0873a[_0x2d0865(0x11e)](_0x2d0865(0x109) + _0x2e20ca + ':', _0x132b08), _0x5004aa[_0x2d0865(0x462)][_0x2d0865(0x97e)] = _0x2d0865(0x794)); } }, _0x204c2a[_0x3dd2d1(0x6f6)](_0x4eb73b); }); } }); function _0x3b690d() { const _0x5db4f1 = _0x314838; if (_0x5db4f1(0x3d9) === _0x5db4f1(0x3d9)) _0x42692e[_0x5db4f1(0x4d3)] = _0x13c410['apiSettings'][_0x5db4f1(0x7d7)] || '', _0x474982[_0x5db4f1(0x4d3)] = _0x13c410[_0x5db4f1(0xa48)][_0x5db4f1(0x8ee)] || '', _0x17226e[_0x5db4f1(0x4d3)] = _0x13c410[_0x5db4f1(0xa48)][_0x5db4f1(0x7b4)] || '', _0x5b8a5b['value'] = String(_0x13c410[_0x5db4f1(0x859)]?.[_0x5db4f1(0x4cf)] ?? 0x64), document[_0x5db4f1(0x7d5)](_0x5db4f1(0xa51))[_0x5db4f1(0x4d3)] = _0x13c410[_0x5db4f1(0xa48)][_0x5db4f1(0x7fe)] || 'openai'; else { if (_0x134e3a[_0x5db4f1(0x26b)]) _0x144e80(_0x365029['diaryPressTimer']); const _0x19507a = _0x5218bf[_0x5db4f1(0x6d7)][_0x5db4f1(0x4b7)](_0x5db4f1(0x5d2)); if (!_0x19507a) return; const _0x50f73c = _0x19507a[_0x5db4f1(0x14b)][_0x5db4f1(0x921)], _0x5eb33a = _0x19507a['classList'][_0x5db4f1(0x741)](_0x5db4f1(0x425)) ? _0x5db4f1(0x425) : 'ai'; if (!_0x50f73c) return; const _0x493734 = () => { const _0x3ff782 = _0x5db4f1; _0x1cfce2[_0x3ff782(0x26b)] = _0x5cf543(() => { if (_0x5200b7['type'] === 'touchstart') _0xf972e9['preventDefault'](); _0x506c00(_0x1be601(_0x50f73c, 0xa), _0x5eb33a); }, 0x320); }, _0x32e5be = () => { if (_0x130ec5['diaryPressTimer']) _0x263d07(_0x108dc7['diaryPressTimer']); }; _0x27cb86[_0x5db4f1(0x988)]('mouseup', _0x32e5be, { 'once': !![] }), _0x315360[_0x5db4f1(0x988)](_0x5db4f1(0x161), _0x32e5be, { 'once': !![] }), _0x17e0d1[_0x5db4f1(0x988)](_0x5db4f1(0x87c), _0x32e5be, { 'once': !![] }), _0x493734(); } } function _0x14c367() { const _0x1ff25c = _0x314838; _0x13c410[_0x1ff25c(0xa48)][_0x1ff25c(0x7d7)] = _0x42692e[_0x1ff25c(0x4d3)][_0x1ff25c(0x6eb)](), _0x13c410[_0x1ff25c(0xa48)][_0x1ff25c(0x8ee)] = _0x474982['value'][_0x1ff25c(0x6eb)](), _0x13c410[_0x1ff25c(0xa48)][_0x1ff25c(0x7b4)] = _0x17226e[_0x1ff25c(0x4d3)][_0x1ff25c(0x6eb)](), _0x13c410[_0x1ff25c(0xa48)][_0x1ff25c(0x7fe)] = document[_0x1ff25c(0x7d5)](_0x1ff25c(0xa51))[_0x1ff25c(0x4d3)]; const _0x532e47 = parseInt(_0x5b8a5b[_0x1ff25c(0x4d3)], 0xa); _0x13c410[_0x1ff25c(0x859)][_0x1ff25c(0x4cf)] = Number[_0x1ff25c(0x9fb)](_0x532e47) && _0x532e47 > 0x0 ? _0x532e47 : 0x64, _0x5834f1(), _0x1e9edf(_0x1ff25c(0x3df)); } function _0x2a83ea() { const _0xe3f26a = _0x314838; if (_0xe3f26a(0x917) === 'mQaWd') _0x35d673[_0xe3f26a(0x4d3)] = _0x13c410[_0xe3f26a(0x787)][_0xe3f26a(0x695)] || '', _0x15cbfe['src'] = _0x13c410[_0xe3f26a(0x787)][_0xe3f26a(0x907)] || _0x10ed69, _0x14fff8[_0xe3f26a(0x4d3)] = _0x13c410['userProfile'][_0xe3f26a(0x2a1)] || ''; else { const _0x567334 = _0x150415(_0xb54dc4[_0xe3f26a(0x2c7)]); if (!_0x567334) return; const _0x8a1a2 = _0x23a0ca(_0x288986['getElementById']('sprite-slider-x')['value']), _0x16ac98 = _0x430176(_0x27701c[_0xe3f26a(0x7d5)](_0xe3f26a(0x5b1))['value']), _0x217d75 = _0x171a98(_0x3fc026[_0xe3f26a(0x7d5)](_0xe3f26a(0x44b))[_0xe3f26a(0x4d3)]) / 0x64; _0x567334[_0xe3f26a(0x1e6)] = { 'x': _0x8a1a2, 'y': _0x16ac98, 'scale': _0x217d75 }, _0x3a1043(), _0x55c6c2(_0xe3f26a(0x411)), _0x30e924(!![]); } } function _0x5c7342() { const _0x5bfaf3 = _0x314838; if (_0x5bfaf3(0x45a) !== _0x5bfaf3(0x69c)) _0x13c410[_0x5bfaf3(0x787)]['name'] = _0x35d673['value']['trim'](), _0x13c410[_0x5bfaf3(0x787)][_0x5bfaf3(0x2a1)] = _0x14fff8['value']['trim'](), _0x5834f1(), _0x403f79(), _0x1e9edf('个人资料已保存！'), _0x384da8(_0x5bfaf3(0x9d7), _0x5bfaf3(0x787)); else { const _0x48a09e = _0x172e49[_0x5bfaf3(0xa69)](_0x4e0bfe); _0x48a09e[_0x5bfaf3(0x246)] && (_0x4b1423['accountingLedger'] = _0x48a09e[_0x5bfaf3(0x246)], _0x3d5fd1[_0x5bfaf3(0x688)](_0x5bfaf3(0x186))); } } async function _0x27d377(_0x164467 = null) { const _0x4e6445 = _0x314838, _0x3115e2 = _0x1a2f27; _0x384da8(_0x4e6445(0x413), _0x3115e2); const _0xefe73e = document[_0x4e6445(0x7d5)](_0x4e6445(0x8f6)); _0xefe73e['innerHTML'] = '', _0x13c410[_0x4e6445(0x90d)][_0x4e6445(0x8c0)](_0x182ad5 => { const _0x248a69 = _0x4e6445, _0x4060f6 = document[_0x248a69(0xa30)](_0x248a69(0x69d)); _0x4060f6[_0x248a69(0x65e)] = _0x248a69(0x612) + _0x182ad5['id'] + '\x22>\x20' + _0x182ad5[_0x248a69(0x695)], _0xefe73e[_0x248a69(0x3fd)](_0x4060f6); }), _0x52ddde(_0x4e6445(0x902)), _0x287c3a[_0x4e6445(0x268)] = '', _0x27cc5f[_0x4e6445(0x4d3)] = '', _0x6362c7[_0x4e6445(0x268)] = '', _0x495a43['value'] = '', _0x31d3ab[_0x4e6445(0x268)] = '', _0x1118c5[_0x4e6445(0x4d3)] = ''; const _0x6d4447 = [_0x4e6445(0x6a9), _0x4e6445(0x79c), 'angry', _0x4e6445(0x5ad), _0x4e6445(0xa20)]; _0x6d4447[_0x4e6445(0x8c0)](_0x3fb5cc => { const _0x148663 = _0x4e6445; document[_0x148663(0x7d5)](_0x148663(0x5d3) + _0x3fb5cc + _0x148663(0x7a5))[_0x148663(0x268)] = '', document[_0x148663(0x7d5)](_0x148663(0x5d3) + _0x3fb5cc + _0x148663(0x26f))['value'] = ''; }); if (_0x164467) { const _0x25003e = _0x13c410[_0x4e6445(0x53a)][_0x4e6445(0x9b9)](_0x147b49 => _0x147b49['id'] === _0x164467); if (!_0x25003e) return; _0x490d5c[_0x4e6445(0x4d3)] = _0x25003e['id'], _0x1a17c5[_0x4e6445(0x9e0)] = _0x4e6445(0x78d), _0x1cc11a[_0x4e6445(0x4d3)] = _0x25003e[_0x4e6445(0x695)], _0x5e7dd0[_0x4e6445(0x4d3)] = _0x25003e[_0x4e6445(0x67b)], _0x10c7f0['value'] = _0x25003e[_0x4e6445(0x2a1)], document[_0x4e6445(0x7d5)](_0x4e6445(0x720))[_0x4e6445(0x4d3)] = _0x25003e['bubbleCss'] || ''; const _0x193c9a = _0x13c410[_0x4e6445(0x226)][_0x4e6445(0x9b9)](_0x27dff3 => _0x27dff3[_0x4e6445(0x974)] === _0x4e6445(0x293) && _0x27dff3[_0x4e6445(0x9c8)][_0x4e6445(0x71e)](_0x164467)); document[_0x4e6445(0x7d5)]('char-edit-bind-user')[_0x4e6445(0x4d3)] = _0x193c9a?.[_0x4e6445(0x75d)] || _0x13c410[_0x4e6445(0x56d)]; try { const _0x553a69 = await _0xb9bbbf(_0x4e6445(0x242) + _0x25003e['id']), _0x3b950b = await _0xb9bbbf(_0x4e6445(0x999) + _0x25003e['id']), _0x279398 = await _0xb9bbbf(_0x4e6445(0x87d) + _0x25003e['id']); _0x287c3a['src'] = _0x553a69 ? URL[_0x4e6445(0x602)](_0x553a69) : _0x25003e[_0x4e6445(0x907)] || _0x1c044f; if (_0x3b950b) _0x6362c7['src'] = URL[_0x4e6445(0x602)](_0x3b950b); if (_0x279398) _0x31d3ab[_0x4e6445(0x268)] = URL[_0x4e6445(0x602)](_0x279398); for (const _0x1dd644 of _0x6d4447) { const _0x364782 = await _0xb9bbbf(_0x4e6445(0x6ef) + _0x1dd644 + '_' + _0x25003e['id']); _0x364782 && (document[_0x4e6445(0x7d5)](_0x4e6445(0x5d3) + _0x1dd644 + '-preview')['src'] = URL[_0x4e6445(0x602)](_0x364782)); } } catch (_0x3efb4d) { if ('Epzoq' === _0x4e6445(0xa21)) console['error'](_0x4e6445(0x66d) + _0x25003e['id'] + _0x4e6445(0x877), _0x3efb4d), _0x287c3a[_0x4e6445(0x268)] = _0x25003e[_0x4e6445(0x907)] || _0x1c044f; else { _0x24c24f[_0x4e6445(0x65e)] = _0x4e6445(0x86c), _0x9a9dfc[_0x4e6445(0x65e)] = ''; return; } } _0x25003e[_0x4e6445(0x7d8)] && _0xefe73e[_0x4e6445(0x83d)](_0x4e6445(0x643))[_0x4e6445(0x8c0)](_0x3afaef => { const _0x278563 = _0x4e6445; if (_0x25003e[_0x278563(0x7d8)][_0x278563(0x71e)](_0x3afaef[_0x278563(0x4d3)])) _0x3afaef[_0x278563(0x8ba)] = !![]; }), _0x4479b5(); } else { if (_0x4e6445(0x6bb) === _0x4e6445(0x6bb)) _0x490d5c['value'] = '', _0x1a17c5[_0x4e6445(0x9e0)] = _0x4e6445(0x611), _0x1cc11a[_0x4e6445(0x4d3)] = _0x4e6445(0xa46) + (_0x13c410[_0x4e6445(0x53a)][_0x4e6445(0x280)] + 0x1), _0x5e7dd0[_0x4e6445(0x4d3)] = '', _0x287c3a[_0x4e6445(0x268)] = _0x1c044f, _0x10c7f0[_0x4e6445(0x4d3)] = _0x4e6445(0x912), document[_0x4e6445(0x7d5)](_0x4e6445(0x720))[_0x4e6445(0x4d3)] = '', _0x4479b5(); else { const _0x507d83 = _0x24fcfb[_0x4e6445(0x38a)](_0x22158f, 'readwrite'), _0x15da5a = _0x507d83[_0x4e6445(0x4bb)](_0x51495b), _0x2e7afd = _0x15da5a[_0x4e6445(0x732)]({ 'id': _0x3301a9, 'data': _0x3fb848 }); _0x2e7afd[_0x4e6445(0x804)] = () => _0xacda75(), _0x2e7afd['onerror'] = () => _0x4f7125(_0x2e7afd[_0x4e6445(0x11e)]); } } const _0x4afd03 = document[_0x4e6445(0x7d5)]('char-edit-css'); let _0x282db6 = document[_0x4e6445(0x7d5)]('live-preview-style'); !_0x282db6 && ('WzhVf' !== _0x4e6445(0x3ac) ? (_0x282db6 = document[_0x4e6445(0xa30)](_0x4e6445(0x462)), _0x282db6['id'] = _0x4e6445(0x1f5), document[_0x4e6445(0x33f)][_0x4e6445(0x3fd)](_0x282db6)) : _0x5d82f7(_0x4e6445(0x822))); const _0x4ec3fe = () => { const _0x27ab01 = _0x4e6445, _0x52df0d = _0x4afd03['value']; let _0x399ee2 = _0x52df0d[_0x27ab01(0x1b5)](/\.bubble\.sent/g, _0x27ab01(0x444))[_0x27ab01(0x1b5)](/\.bubble\.received/g, '#bubble-preview-ai'); _0x282db6[_0x27ab01(0x65e)] = _0x399ee2; }; _0x4afd03[_0x4e6445(0x7f6)]('input', _0x4ec3fe), _0x4afd03[_0x4e6445(0x988)](_0x4e6445(0x6b1), _0x4ec3fe), _0x4ec3fe(); } async function _0x1648a4() { const _0x21712e = _0x314838; if (_0x21712e(0x204) !== _0x21712e(0x62b)) { const _0x4b9d99 = _0x490d5c[_0x21712e(0x4d3)]; if (!_0x4b9d99) { if (_0x21712e(0x933) !== _0x21712e(0x933)) throw new _0x3364f2(_0x21712e(0x340)); else { _0x1e9edf(_0x21712e(0x439)); return; } } const _0x4e9c85 = _0x1d08b4(_0x4b9d99); if (!_0x4e9c85) return; _0x1f66de(!![], _0x21712e(0x752) + _0x4e9c85[_0x21712e(0x695)] + '”...'); try { const _0x508137 = { 'type': _0x21712e(0x8bd), 'version': 0x1, 'name': _0x4e9c85[_0x21712e(0x695)], 'remark': _0x4e9c85['remark'], 'persona': _0x4e9c85['persona'], 'bubbleCss': _0x4e9c85['bubbleCss'], 'avatar': null, 'sprites': {}, 'worldBooks': [] }, _0x3f80ca = await _0xb9bbbf('char_avatar_' + _0x4e9c85['id']); if (_0x3f80ca) _0x508137[_0x21712e(0x907)] = await _0x2115c1(_0x3f80ca); const _0x438b2b = [_0x21712e(0x6a9), _0x21712e(0x79c), 'angry', _0x21712e(0x5ad), _0x21712e(0xa20)]; for (const _0x8e9eb1 of _0x438b2b) { const _0x20aad1 = await _0xb9bbbf(_0x21712e(0x6ef) + _0x8e9eb1 + '_' + _0x4e9c85['id']); if (_0x20aad1) { if (_0x21712e(0x608) === _0x21712e(0x16f)) return []; else _0x508137[_0x21712e(0xa0f)][_0x8e9eb1] = await _0x2115c1(_0x20aad1); } } _0x4e9c85[_0x21712e(0x7d8)] && _0x4e9c85[_0x21712e(0x7d8)]['length'] > 0x0 && (_0x508137[_0x21712e(0x90d)] = _0x4e9c85[_0x21712e(0x7d8)][_0x21712e(0x33d)](_0x2250f9 => _0x13c410[_0x21712e(0x90d)][_0x21712e(0x9b9)](_0x5a6664 => _0x5a6664['id'] === _0x2250f9))[_0x21712e(0x61f)](Boolean)[_0x21712e(0x33d)](_0x2eb57c => ({ 'name': _0x2eb57c['name'], 'content': _0x2eb57c[_0x21712e(0x75a)] }))); const _0x4d560e = new Blob([JSON[_0x21712e(0x3e1)](_0x508137, null, 0x2)], { 'type': 'application/json' }), _0x166e91 = URL[_0x21712e(0x602)](_0x4d560e), _0x438372 = document[_0x21712e(0xa30)]('a'); _0x438372[_0x21712e(0x7ce)] = _0x166e91, _0x438372[_0x21712e(0x8a8)] = _0x4e9c85[_0x21712e(0x695)] + _0x21712e(0x16d), document[_0x21712e(0x32a)]['appendChild'](_0x438372), _0x438372[_0x21712e(0x649)](), document['body'][_0x21712e(0x2ec)](_0x438372), URL[_0x21712e(0x918)](_0x166e91); } catch (_0x4f901a) { _0x21712e(0x8f1) === 'AIOqS' ? _0x503416(_0x21712e(0x36c), _0x21712e(0x413)) : (console[_0x21712e(0x11e)](_0x21712e(0x74b), _0x4f901a), _0x1e9edf(_0x21712e(0x565) + _0x4f901a[_0x21712e(0x496)])); } finally { _0x1f66de(![]); } } else _0x460e35[_0x21712e(0x7d5)]('snoop-copy-summary-btn')[_0x21712e(0x988)](_0x21712e(0x649), () => { const _0x34c725 = _0x21712e, _0x3d03b7 = _0x41ca50[_0x34c725(0x7d5)](_0x34c725(0x91d)); _0x3d03b7['select'](), _0x19b952['execCommand'](_0x34c725(0x29e)), _0x2da091(_0x34c725(0x855)); }); } async function _0x39632b(_0x41d601) { const _0x766596 = _0x314838, _0x773b5 = _0x41d601[_0x766596(0x6d7)][_0x766596(0x6ea)][0x0]; if (!_0x773b5) return; _0x1f66de(!![], _0x766596(0x2b6)); const _0xcc25f8 = new FileReader(); _0xcc25f8[_0x766596(0x3a5)] = async _0x20f4b8 => { const _0x31ed98 = _0x766596; if (_0x31ed98(0x9fe) === _0x31ed98(0x9fe)) try { if (_0x31ed98(0x260) !== _0x31ed98(0x260)) { _0x42a58b['error']('Failed\x20to\x20parse\x20history\x20for\x20chat\x20' + _0x1a4143['activeChatId'] + _0x31ed98(0x36f), _0x3dcdd6); try { _0x3c6ef9[_0x31ed98(0x7ec)](_0x31ed98(0x151) + _0x22a80f[_0x31ed98(0x55f)]); } catch (_0x3cc9e3) { _0x535089[_0x31ed98(0x11e)](_0x31ed98(0x8e9), _0x3cc9e3); } } else { const _0x45523b = JSON['parse'](_0x20f4b8[_0x31ed98(0x6d7)][_0x31ed98(0x211)]); if (_0x45523b[_0x31ed98(0x974)] !== _0x31ed98(0x8bd)) { if ('KBsVE' === _0x31ed98(0x561)) throw new Error(_0x31ed98(0x63c)); else return _0x52a000(_0xb72361)[_0x31ed98(0x834)](_0x1f16f4 => _0x1f16f4['blob']()); } const _0x4911c9 = []; if (_0x45523b[_0x31ed98(0x90d)] && _0x45523b[_0x31ed98(0x90d)][_0x31ed98(0x280)] > 0x0) { if ('wqACX' === _0x31ed98(0x898)) for (const _0xe25565 of _0x45523b[_0x31ed98(0x90d)]) { let _0x2d8c15 = _0x13c410['worldBooks'][_0x31ed98(0x9b9)](_0x3dc649 => _0x3dc649[_0x31ed98(0x695)] === _0xe25565[_0x31ed98(0x695)]); if (_0x2d8c15) _0x4911c9[_0x31ed98(0x98f)](_0x2d8c15['id']); else { if (_0x31ed98(0x8e4) !== _0x31ed98(0x343)) { const _0x457ac1 = { 'id': _0x31ed98(0x39d) + Date[_0x31ed98(0x2f2)]() + '_' + Math[_0x31ed98(0x2a4)](), 'name': _0xe25565['name'], 'content': _0xe25565[_0x31ed98(0x75a)] }; _0x13c410[_0x31ed98(0x90d)][_0x31ed98(0x98f)](_0x457ac1), _0x4911c9[_0x31ed98(0x98f)](_0x457ac1['id']); } else _0x31dafb = _0x35768f['name'] || '我', _0x57602a = _0x31ed98(0xeb); } } else { const _0x2548d0 = _0x295907[_0x31ed98(0xa30)](_0x31ed98(0xa8b)); _0x2548d0[_0x31ed98(0x828)] = _0x31ed98(0x4e2), _0x2548d0['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-' + _0xbbc45d['id'] + '\x22\x20data-id=\x22' + _0x4b23b9['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x537aad[_0x31ed98(0x907)] || _0x2cec3a) + _0x31ed98(0x1b6) + _0x1f993b['id'] + _0x31ed98(0x8fb) + _0x4f5de9['name'] + '</label>\x0a\x20\x20\x20\x20', _0x10fd16[_0x31ed98(0x3fd)](_0x2548d0); } } const _0x24c7ab = _0x31ed98(0x290) + Date[_0x31ed98(0x2f2)](), _0x48078f = { 'id': _0x24c7ab, 'name': _0x45523b[_0x31ed98(0x695)], 'remark': _0x45523b[_0x31ed98(0x67b)] || '', 'persona': _0x45523b['persona'], 'avatar': _0x45523b[_0x31ed98(0x907)] || _0x1c044f, 'linkedWorldBookIds': _0x4911c9, 'bubbleCss': _0x45523b[_0x31ed98(0x897)] || '' }; if (_0x45523b[_0x31ed98(0x907)]) { const _0x322118 = await _0x4904fe(_0x45523b['avatar']); await _0x4162d1(_0x31ed98(0x242) + _0x24c7ab, _0x322118); } if (_0x45523b[_0x31ed98(0xa0f)]) for (const _0x47c6b6 in _0x45523b[_0x31ed98(0xa0f)]) { const _0x492bd4 = _0x45523b['sprites'][_0x47c6b6], _0x2418fc = await _0x4904fe(_0x492bd4); await _0x4162d1(_0x31ed98(0x6ef) + _0x47c6b6 + '_' + _0x24c7ab, _0x2418fc); } _0x13c410[_0x31ed98(0x53a)][_0x31ed98(0x98f)](_0x48078f); const _0x5b3bbf = { 'id': _0x31ed98(0x2fb) + _0x24c7ab, 'type': 'private', 'participantIds': [_0x24c7ab], 'boundUserProfileId': _0x13c410['activeUserProfileId'] }; _0x13c410['chats']['push'](_0x5b3bbf), _0x5834f1(), _0x2de32d(), _0x1e9edf('“' + _0x48078f[_0x31ed98(0x695)] + '”已成功导入！'); } } catch (_0x51725b) { _0x31ed98(0x646) === _0x31ed98(0x646) ? (console[_0x31ed98(0x11e)](_0x31ed98(0x853), _0x51725b), _0x1e9edf('导入失败了，笨蛋:\x20' + _0x51725b['message'])) : (_0x5c9035(), _0x324b02(_0x31ed98(0x4e5), _0x31ed98(0x73e))); } finally { _0x1f66de(![]), _0x41d601[_0x31ed98(0x6d7)][_0x31ed98(0x4d3)] = ''; } else { if (_0x3391d2) _0x507d0b(_0x550515); } }, _0xcc25f8[_0x766596(0x6f6)](_0x773b5); } async function _0x1bc560() { const _0x3b007d = _0x314838, _0x206cc7 = _0x490d5c[_0x3b007d(0x4d3)]; let _0x3f4750 = null; const _0x391b58 = _0x27cc5f[_0x3b007d(0x6ea)][0x0], _0x4f8746 = _0x495a43[_0x3b007d(0x6ea)][0x0], _0x58fafc = _0x1118c5[_0x3b007d(0x6ea)][0x0], _0x2ecc21 = document[_0x3b007d(0x83d)](_0x3b007d(0x422)), _0x55c4c7 = Array['from'](_0x2ecc21)['map'](_0x343328 => _0x343328['value']), _0x55be1b = { 'name': _0x1cc11a['value']['trim'](), 'remark': _0x5e7dd0['value']['trim'](), 'persona': _0x10c7f0[_0x3b007d(0x4d3)][_0x3b007d(0x6eb)](), 'linkedWorldBookIds': _0x55c4c7, 'boundUserProfileId': document[_0x3b007d(0x7d5)](_0x3b007d(0x902))['value'], 'bubbleCss': document[_0x3b007d(0x7d5)](_0x3b007d(0x720))[_0x3b007d(0x4d3)][_0x3b007d(0x6eb)]() }; if (!_0x55be1b[_0x3b007d(0x695)]) { if (_0x3b007d(0x26e) === _0x3b007d(0x26e)) { _0x1e9edf(_0x3b007d(0x92e)); return; } else _0x4443f9 = _0x5bb0dd[_0x3b007d(0xa30)]('div'), _0x5c7647[_0x3b007d(0x828)] = 'typing-indicator', _0x42f321[_0x3b007d(0x9e0)] = _0x3b007d(0x9ba), _0x3c0e0d['style']['backgroundColor'] = _0x3b007d(0x49e), _0x51ae65[_0x3b007d(0x462)]['padding'] = '15px\x2020px', _0x379f84[_0x3b007d(0x462)][_0x3b007d(0x203)] = _0x3b007d(0x856), _0x11f540[_0x3b007d(0x3fd)](_0x42d761); } try { if (_0x3b007d(0x157) !== _0x3b007d(0x492)) { const _0x3e7ff3 = [_0x3b007d(0x6a9), _0x3b007d(0x79c), _0x3b007d(0x69a), _0x3b007d(0x5ad), _0x3b007d(0xa20)]; if (_0x206cc7) { if (_0x3b007d(0x77a) === _0x3b007d(0x2cf)) _0x1c1fb9[_0x3b007d(0x572)][_0x3b007d(0x98f)]({ 'senderId': _0x3e57db['id'], 'kind': _0x3b007d(0x52b), 'sticker': _0x9f30e0 }); else { const _0xaf8b16 = _0x13c410['characters'][_0x3b007d(0x9b9)](_0x5a5b8b => _0x5a5b8b['id'] === _0x206cc7); if (_0xaf8b16) { if (_0x3b007d(0x249) !== 'Dbneq') _0x2aff80(_0x3b007d(0x5c9) + _0xf8d7da['message']); else { Object[_0x3b007d(0x6e9)](_0xaf8b16, _0x55be1b); if (_0x391b58) _0xaf8b16['avatar'] = await _0x14be68(_0x391b58); } } if (_0x391b58) await _0x4162d1(_0x3b007d(0x242) + _0x206cc7, _0x391b58); if (_0x4f8746) await _0x4162d1(_0x3b007d(0x999) + _0x206cc7, _0x4f8746); if (_0x58fafc) await _0x4162d1(_0x3b007d(0x87d) + _0x206cc7, _0x58fafc); for (const _0x1fa205 of _0x3e7ff3) { if ('duFEl' !== _0x3b007d(0x68c)) { const _0xc5039f = document[_0x3b007d(0x7d5)](_0x3b007d(0x5d3) + _0x1fa205 + '-input')[_0x3b007d(0x6ea)][0x0]; if (_0xc5039f) await _0x4162d1(_0x3b007d(0x6ef) + _0x1fa205 + '_' + _0x206cc7, _0xc5039f); } else { const _0x566635 = _0x4a6a01[_0x3b007d(0x6d7)][_0x3b007d(0x6ea)][0x0]; if (!_0x566635) return; const _0x4fc005 = _0x223632[_0x3b007d(0x602)](_0x566635); _0xd242ef[_0x3b007d(0x268)] = _0x4fc005, _0x12c957['onload'] = () => { const _0x9f9d80 = _0x3b007d; _0x27d7b7[_0x9f9d80(0x918)](_0x4fc005); }; } } } } else { _0x3f4750 = _0x3b007d(0x290) + Date['now'](); const _0x695b52 = { 'id': _0x3f4750, ..._0x55be1b }; _0x695b52['avatar'] = _0x391b58 ? await _0x14be68(_0x391b58) : _0x1c044f, _0x13c410[_0x3b007d(0x53a)][_0x3b007d(0x98f)](_0x695b52); const _0x31025b = { 'id': _0x3b007d(0x2fb) + _0x3f4750, 'type': 'private', 'participantIds': [_0x3f4750], 'boundUserProfileId': _0x55be1b['boundUserProfileId'], 'listenTogetherSession': null }; _0x13c410[_0x3b007d(0x226)]['push'](_0x31025b); if (_0x391b58) await _0x4162d1(_0x3b007d(0x242) + _0x3f4750, _0x391b58); if (_0x4f8746) await _0x4162d1(_0x3b007d(0x999) + _0x3f4750, _0x4f8746); if (_0x58fafc) await _0x4162d1(_0x3b007d(0x87d) + _0x3f4750, _0x58fafc); for (const _0x421599 of _0x3e7ff3) { if ('Ztgqe' !== _0x3b007d(0x9a6)) { const _0x56d077 = _0x4cb1e2[_0x3b007d(0x4d3)][_0x3b007d(0x6eb)](); if (!_0x56d077) { _0x4d2926('请输入群聊名称。'); return; } const _0x3108dd = _0x1e6086[_0x3b007d(0x703)](_0x21a337[_0x3b007d(0x83d)](_0x3b007d(0x256)))['map'](_0x313d1e => _0x313d1e[_0x3b007d(0x14b)]['id']); if (_0x3108dd[_0x3b007d(0x280)] < 0x2) { _0x6dc26b(_0x3b007d(0x9dd)); return; } const _0x1fe900 = { 'id': _0x3b007d(0x560) + _0x23fce4[_0x3b007d(0x2f2)](), 'type': _0x3b007d(0x9ad), 'name': _0x56d077, 'participantIds': _0x3108dd }; _0x54f8c6[_0x3b007d(0x226)][_0x3b007d(0x98f)](_0x1fe900), _0x55730a[_0x3b007d(0x55f)] = _0x1fe900['id'], _0x586417(), _0x5543c7(), _0x4b1593(), _0x3c5917(), _0x50793d('群聊“' + _0x56d077 + _0x3b007d(0x43b)), _0x1f6751(_0x3b007d(0x36c), _0x3b007d(0xa13)); } else { const _0x54b5c9 = document['getElementById'](_0x3b007d(0x5d3) + _0x421599 + _0x3b007d(0x26f))[_0x3b007d(0x6ea)][0x0]; if (_0x54b5c9) await _0x4162d1(_0x3b007d(0x6ef) + _0x421599 + '_' + _0x3f4750, _0x54b5c9); } } } _0x5834f1(), _0x2de32d(), _0x1e9edf(_0x3b007d(0x749)), _0x384da8('chat', _0x3b007d(0x413)); if (!_0x206cc7) { const _0x27faed = _0x3b007d(0x2fb) + _0x3f4750; _0x48dfc8(_0x27faed), _0x4c0af8(!![]); } } else _0x52f6dd[_0x3b007d(0x11e)](_0x3b007d(0x71b) + _0x228b40 + ':', _0x25768a); } catch (_0x575033) { _0x3b007d(0x2d2) === _0x3b007d(0x2d2) ? (console[_0x3b007d(0x11e)](_0x3b007d(0x36d), _0x575033), _0x1e9edf('保存失败:\x20' + _0x575033[_0x3b007d(0x496)])) : _0x3899a8['error'](_0x3b007d(0x4fb), _0x3b7325); } } function _0xe96c4() { const _0x5048d0 = _0x314838; _0x5b585e[_0x5048d0(0x4d3)] = '', _0x1016ac[_0x5048d0(0x65e)] = ''; if (_0x13c410['characters']['length'] < 0x2) { if (_0x5048d0(0x1b4) === _0x5048d0(0x1b4)) { _0x1e9edf(_0x5048d0(0x224)); return; } else delete _0x10e28c[_0x5048d0(0x1e6)], _0x4f5bc7(), _0x55e6ce(_0x2e96ea['id'], _0x5048d0(0x6a9)), _0x28342a(_0x5048d0(0x4d8)), _0x158029(!![]); } _0x13c410['characters']['forEach'](_0x37ea3d => { const _0x5e93d0 = _0x5048d0; if (_0x5e93d0(0x7de) !== _0x5e93d0(0x7de)) _0x4ba98b(), _0x1ef547(); else { const _0xc2f502 = document[_0x5e93d0(0xa30)]('li'); _0xc2f502[_0x5e93d0(0x828)] = _0x5e93d0(0x4e2), _0xc2f502[_0x5e93d0(0x65e)] = _0x5e93d0(0x69f) + _0x37ea3d['id'] + '\x22\x20data-id=\x22' + _0x37ea3d['id'] + _0x5e93d0(0x66c) + (_0x37ea3d[_0x5e93d0(0x907)] || _0x1c044f) + _0x5e93d0(0x719) + _0x37ea3d['id'] + _0x5e93d0(0x8fb) + _0x37ea3d['name'] + '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x1016ac[_0x5e93d0(0x3fd)](_0xc2f502); } }), _0x384da8(_0x5048d0(0xa13), _0x5048d0(0x754)); } function _0x36e015() { const _0xefaddf = _0x314838; if (_0xefaddf(0xaa2) === 'lDHpg') { const _0x3f3882 = _0x5b585e['value'][_0xefaddf(0x6eb)](); if (!_0x3f3882) { if (_0xefaddf(0x175) !== _0xefaddf(0x175)) _0x25c2c5 = _0x553de8['id']; else { _0x1e9edf(_0xefaddf(0x429)); return; } } const _0x203ce0 = Array[_0xefaddf(0x703)](_0x1016ac[_0xefaddf(0x83d)](_0xefaddf(0x256)))['map'](_0x17b161 => _0x17b161[_0xefaddf(0x14b)]['id']); if (_0x203ce0['length'] < 0x2) { _0x1e9edf(_0xefaddf(0x9dd)); return; } const _0x6e3a62 = { 'id': _0xefaddf(0x560) + Date[_0xefaddf(0x2f2)](), 'type': 'group', 'name': _0x3f3882, 'participantIds': _0x203ce0 }; _0x13c410['chats']['push'](_0x6e3a62), _0x13c410[_0xefaddf(0x55f)] = _0x6e3a62['id'], _0x5834f1(), _0x2de32d(), _0x13b171(), _0x1f45f3(), _0x1e9edf(_0xefaddf(0x271) + _0x3f3882 + '”已创建！'), _0x384da8(_0xefaddf(0x36c), _0xefaddf(0xa13)); } else { const _0xa7a1d5 = _0x24df9f['createElement'](_0xefaddf(0xa8b)); _0xa7a1d5[_0xefaddf(0x828)] = 'world-book-item', _0xa7a1d5[_0xefaddf(0x14b)]['id'] = _0x94bb20['id']; const _0xb2359a = _0x405fe9['id'] === _0x1c3bd6[_0xefaddf(0x56d)] ? _0xefaddf(0x9cd) : ''; _0xa7a1d5[_0xefaddf(0x65e)] = _0xefaddf(0xa9b) + (_0x87caf4['avatar'] || _0x5b69f5) + _0xefaddf(0x977) + _0x457380[_0xefaddf(0x695)] + _0xb2359a + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x3fcbcc[_0xefaddf(0x2a1)][_0xefaddf(0x5e0)](0x0, 0x64) + _0xefaddf(0x45c), _0xa7a1d5[_0xefaddf(0x988)](_0xefaddf(0x649), () => _0x300db8(_0x27bef9['id'])), _0xcb144e[_0xefaddf(0x3fd)](_0xa7a1d5); } } _0x36b9c0['addEventListener'](_0x314838(0x649), () => _0x1a9319[_0x314838(0x649)]()), _0x34e192[_0x314838(0x988)](_0x314838(0x649), _0x142627), _0x1a9319[_0x314838(0x988)](_0x314838(0x458), _0xb7a158), _0x4e3cc5[_0x314838(0x988)](_0x314838(0x649), _0x4a0ae5), _0x155012[_0x314838(0x988)](_0x314838(0x649), () => _0x3e134b[_0x314838(0x349)][_0x314838(0x330)](_0x314838(0xa12))), _0x1604bf[_0x314838(0x988)]('click', () => _0x3e134b['classList'][_0x314838(0x330)](_0x314838(0xa12))), _0xdb73fd['addEventListener']('click', () => { const _0x469241 = _0x314838; _0x188eea[_0x469241(0x8b3)](), navigator[_0x469241(0x27a)][_0x469241(0x557)](_0x188eea['value'])['then'](() => { _0x1e9edf('已复制到剪贴板！'); })[_0x469241(0x782)](_0x4033f1 => { const _0x2db9b1 = _0x469241; if (_0x2db9b1(0x747) === _0x2db9b1(0x747)) _0x1e9edf('复制失败了，哼。'); else { if (!_0x1d487c) return []; const _0x151ea5 = _0x8c0842['split']('\x0a'), _0x63eff1 = [], _0x42b45c = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x1a66b1 of _0x151ea5) { const _0x51dcaa = _0x1a66b1['match'](_0x42b45c); if (_0x51dcaa) { const _0x32ede1 = _0x3afbfb(_0x51dcaa[0x1], 0xa), _0xff5eaa = _0x40e162(_0x51dcaa[0x2], 0xa), _0x2052f4 = _0x34fb0f(_0x51dcaa[0x3], 0xa) * (_0x51dcaa[0x3]['length'] === 0x2 ? 0xa : 0x1), _0x42da38 = _0x32ede1 * 0x3c + _0xff5eaa + _0x2052f4 / 0x3e8, _0x557bf4 = _0x1a66b1[_0x2db9b1(0x1b5)](_0x42b45c, '')['trim'](); _0x557bf4 && _0x63eff1['push']({ 'time': _0x42da38, 'text': _0x557bf4 }); } } return _0x63eff1; } }); }), _0x471b8d[_0x314838(0x988)](_0x314838(0x649), _0x599115), _0x4a766f[_0x314838(0x988)](_0x314838(0x649), _0x90c25a), _0x2ea760['addEventListener'](_0x314838(0x649), () => _0x16b640[_0x314838(0x349)][_0x314838(0x330)](_0x314838(0xa12))), _0x37f20b[_0x314838(0x988)]('click', () => _0x16b640[_0x314838(0x349)][_0x314838(0x330)](_0x314838(0xa12))), _0x6362c7[_0x314838(0x988)]('click', () => _0x495a43[_0x314838(0x649)]()), _0x31d3ab[_0x314838(0x988)](_0x314838(0x649), () => _0x1118c5[_0x314838(0x649)]()), _0x495a43['addEventListener'](_0x314838(0x458), async _0x3dbaf8 => { const _0x100db8 = _0x314838, _0x967994 = _0x3dbaf8[_0x100db8(0x6d7)][_0x100db8(0x6ea)][0x0]; if (!_0x967994) return; try { _0x100db8(0x2ac) !== 'CzmZL' ? _0x26598c = _0x225a33[_0x100db8(0x4d3)] : _0x6362c7[_0x100db8(0x268)] = await _0x14be68(_0x967994); } catch (_0x9d5e31) { _0x100db8(0xa2c) !== _0x100db8(0xa2c) ? (_0x11dbe7[_0x100db8(0x349)][_0x100db8(0x699)](_0x100db8(0x949)), _0x229738[_0x100db8(0x349)][_0x100db8(0x699)]('is-exiting-left'), _0x5d6f01[_0x100db8(0x349)][_0x100db8(0x699)](_0x100db8(0x6e2)), _0x15f837(() => { const _0x547698 = _0x100db8; _0x374287[_0x547698(0x349)][_0x547698(0x330)](_0x547698(0x6e2), _0x547698(0x306)), _0xe93294[_0x547698(0x349)][_0x547698(0x330)]('is-entering-from-right'), _0x2f6d83[_0x547698(0x436)] = _0x4faca6, _0x46b20b(), _0x581b14[_0x547698(0x338)] = ![]; }, 0x2bc)) : _0x1e9edf(_0x100db8(0x875) + _0x9d5e31[_0x100db8(0x496)]); } }), _0x1118c5[_0x314838(0x988)](_0x314838(0x458), async _0x4b5199 => { const _0x1f3d80 = _0x314838, _0x2346ed = _0x4b5199[_0x1f3d80(0x6d7)][_0x1f3d80(0x6ea)][0x0]; if (!_0x2346ed) return; try { _0x31d3ab[_0x1f3d80(0x268)] = await _0x14be68(_0x2346ed); } catch (_0x2e885a) { _0x1e9edf(_0x1f3d80(0x875) + _0x2e885a['message']); } }), _0xd755bd[_0x314838(0x988)](_0x314838(0x649), () => _0x309fc5['click']()), _0x5f0512['addEventListener'](_0x314838(0x649), () => { const _0x5d8fd8 = _0x314838; localStorage[_0x5d8fd8(0x7ec)]('customFeedWallpaper'), _0xdad5ba(), _0x1e9edf(_0x5d8fd8(0x88d)); }), _0x309fc5[_0x314838(0x988)](_0x314838(0x458), async _0x48cae6 => { const _0x823997 = _0x314838; if ('bgdSO' !== _0x823997(0x791)) { const _0x534775 = _0x48cae6[_0x823997(0x6d7)][_0x823997(0x6ea)][0x0]; if (!_0x534775) return; try { const _0x2b172f = await _0x14be68(_0x534775); localStorage['setItem'](_0x823997(0x6c8), _0x2b172f), _0xdad5ba(), _0x1e9edf('动态页背景已更换！'); } catch (_0x20f47b) { _0x1e9edf(_0x823997(0x875) + _0x20f47b[_0x823997(0x496)]); } } else _0x1e3986(_0x823997(0x7cb)); }), document[_0x314838(0x7d5)]('back-to-chat-from-group-settings')[_0x314838(0x988)]('click', () => _0x384da8('chat', 'groupSettings')), document[_0x314838(0x7d5)](_0x314838(0x8dc))['addEventListener'](_0x314838(0x649), _0x286fe3); const _0x1b30f6 = document['getElementById'](_0x314838(0x512)), _0x4cb71d = document[_0x314838(0x7d5)]('group-avatar-input'); _0x1b30f6['addEventListener'](_0x314838(0x649), () => _0x4cb71d[_0x314838(0x649)]()), _0x4cb71d['addEventListener']('change', _0xefc2b3 => { const _0x4477f2 = _0x314838, _0x272f75 = _0xefc2b3[_0x4477f2(0x6d7)][_0x4477f2(0x6ea)][0x0]; if (!_0x272f75) return; const _0x3936d7 = URL[_0x4477f2(0x602)](_0x272f75); _0x1b30f6[_0x4477f2(0x268)] = _0x3936d7, _0x1b30f6[_0x4477f2(0x3a5)] = () => { const _0xa38af0 = _0x4477f2; URL[_0xa38af0(0x918)](_0x3936d7); }; }); const _0x43a236 = document['getElementById'](_0x314838(0x5cf))['parentElement'], _0x374af2 = document[_0x314838(0x7d5)](_0x314838(0x352)), _0x16b7b5 = document['getElementById']('group-bg-preview'); _0x43a236[_0x314838(0x988)](_0x314838(0x649), () => _0x374af2[_0x314838(0x649)]()), _0x374af2['addEventListener'](_0x314838(0x458), _0x22df4e => { const _0x301a6b = _0x314838, _0x19419b = _0x22df4e[_0x301a6b(0x6d7)][_0x301a6b(0x6ea)][0x0]; if (!_0x19419b) return; const _0x372b3a = URL[_0x301a6b(0x602)](_0x19419b); _0x16b7b5[_0x301a6b(0x268)] = _0x372b3a, _0x16b7b5['onload'] = () => { const _0x59720d = _0x301a6b; URL[_0x59720d(0x918)](_0x372b3a); }; }); const _0xc59291 = document[_0x314838(0x298)](_0x314838(0x354)), _0x4533c9 = document[_0x314838(0x7d5)]('group-world-book-checkboxes'); _0xc59291['addEventListener']('click', _0x58c72a => { const _0x4a19b8 = _0x314838; _0x4a19b8(0x5d1) === 'HKxdP' ? _0x395900[_0x4a19b8(0x988)]('click', function () { const _0x5def6b = { 'id': _0xde2dad['id'], 'url': _0x55d225['playableUrl'] }; _0x162f11(this, _0x5def6b); }) : (_0x58c72a[_0x4a19b8(0xa9a)](), _0x4533c9[_0x4a19b8(0x349)]['toggle'](_0x4a19b8(0x3cb)), _0xc59291[_0x4a19b8(0x349)][_0x4a19b8(0x581)](_0x4a19b8(0x1cc))); }), _0x4533c9['addEventListener']('change', _0x14e1a8), document[_0x314838(0x7d5)](_0x314838(0x94e))[_0x314838(0x988)](_0x314838(0x649), _0xb0e3ba), document[_0x314838(0x7d5)](_0x314838(0xa36))[_0x314838(0x988)]('click', async () => { const _0x4583f6 = _0x314838, _0x103cf7 = _0xee1b45(); if (!_0x103cf7 || _0x103cf7[_0x4583f6(0x974)] !== _0x4583f6(0x9ad)) return; const _0x2850ba = await _0x39a14a('确定要删除群聊“' + _0x103cf7[_0x4583f6(0x695)] + '”吗？此操作不可撤销。'); _0x2850ba && (_0x461a23(_0x103cf7['id']), _0x1e9edf(_0x4583f6(0x3b7)), _0x384da8(_0x4583f6(0x36c)), _0x4c0af8(![])); }); const _0x38b30d = document[_0x314838(0x298)]('.custom-multiselect\x20.select-box'), _0x5f0fe7 = document['getElementById']('world-book-checkboxes-container'); _0x38b30d[_0x314838(0x988)]('click', _0x190736 => { const _0x4368da = _0x314838; _0x190736[_0x4368da(0xa9a)](), _0x5f0fe7[_0x4368da(0x349)][_0x4368da(0x581)](_0x4368da(0x3cb)), _0x38b30d[_0x4368da(0x349)][_0x4368da(0x581)]('expanded'); }), _0x5f0fe7[_0x314838(0x988)](_0x314838(0x458), _0x4479b5), document[_0x314838(0x988)](_0x314838(0x649), _0x41ace4 => { const _0x1c8f1e = _0x314838; !document[_0x1c8f1e(0x298)](_0x1c8f1e(0x198))[_0x1c8f1e(0x741)](_0x41ace4[_0x1c8f1e(0x6d7)]) && (_0x5f0fe7[_0x1c8f1e(0x349)][_0x1c8f1e(0x330)](_0x1c8f1e(0x3cb)), _0x38b30d[_0x1c8f1e(0x349)][_0x1c8f1e(0x330)](_0x1c8f1e(0x1cc))); }), _0x1cce06[_0x314838(0x988)]('click', () => { const _0x4608e7 = _0x314838; _0x4444f0(), _0x384da8(_0x4608e7(0x4e5), 'home'); }), document['getElementById'](_0x314838(0x556))[_0x314838(0x988)]('click', () => _0x384da8(_0x314838(0x73e), 'worldBook')), document[_0x314838(0x7d5)](_0x314838(0x751))[_0x314838(0x988)](_0x314838(0x649), () => _0x2024cd()), document[_0x314838(0x7d5)]('back-to-world-book-list')[_0x314838(0x988)](_0x314838(0x649), () => { const _0x19b402 = _0x314838; if (_0x19b402(0x6c4) !== _0x19b402(0x6c4)) { const _0x504866 = _0x3c58a8[_0x19b402(0x7d5)](_0x19b402(0x445)); if (!_0x504866) return; _0x504866[_0x19b402(0x8ba)] = _0x393bbf[_0x19b402(0x859)]['forceWhiteClock'] || ![], _0x504866[_0x19b402(0x988)](_0x19b402(0x458), () => { const _0x1646ca = _0x19b402; _0x4e9265[_0x1646ca(0x859)][_0x1646ca(0x568)] = _0x504866[_0x1646ca(0x8ba)], _0x393fa7(), _0x2ab3e7(); }); } else _0x4444f0(), _0x384da8(_0x19b402(0x4e5), _0x19b402(0x3f6)); }), document[_0x314838(0x7d5)]('save-world-book-button')[_0x314838(0x988)](_0x314838(0x649), _0x242b40), document[_0x314838(0x7d5)]('delete-world-book-button')[_0x314838(0x988)](_0x314838(0x649), _0x1f5457), _0x910e9[_0x314838(0x988)](_0x314838(0x649), () => _0x384da8(_0x314838(0x58d), _0x314838(0x73e))), _0x56a29c[_0x314838(0x988)]('click', () => _0x384da8(_0x314838(0x73e), _0x314838(0x58d))), _0x202da9[_0x314838(0x988)](_0x314838(0x649), () => _0x4222f9[_0x314838(0x649)]()), _0x4222f9[_0x314838(0x988)]('change', async _0x63325a => { const _0x24ab6a = _0x314838; if ('cTFeW' === 'cTFeW') { const _0x54cdbc = _0x63325a[_0x24ab6a(0x6d7)][_0x24ab6a(0x6ea)][0x0]; if (!_0x54cdbc) return; await _0x3455ed(_0x54cdbc); } else _0x2165e6[_0x24ab6a(0x462)]['backgroundImage'] = ''; }), _0x1ee953[_0x314838(0x988)](_0x314838(0x649), () => { const _0xdaf02 = _0x314838; _0xdaf02(0x1db) === _0xdaf02(0x1db) ? (_0x2de32d(), _0x384da8(_0xdaf02(0x36c), _0xdaf02(0x73e))) : _0x23e170('有\x20' + _0x47983f + '\x20行格式不对，被我无视了。'); }), _0xe1a909[_0x314838(0x988)](_0x314838(0x649), () => { const _0x3394fc = _0x314838; _0x3b690d(); const _0x536809 = (_0x13c410['apiSettings'][_0x3394fc(0x7d7)] || '')[_0x3394fc(0x71e)](_0xe2cea5); _0x5601d2[_0x3394fc(0x99f)] = _0x536809, _0x384da8(_0x3394fc(0x9d7), 'home'); }), _0x4577cd[_0x314838(0x988)](_0x314838(0x649), () => _0x384da8(_0x314838(0x73e), _0x314838(0x9d7))), _0x3f708e[_0x314838(0x988)](_0x314838(0x649), () => { const _0x490af6 = _0x314838; _0x336cd5(), _0x384da8(_0x490af6(0x73e), 'chat'); }), _0x86bc7b[_0x314838(0x988)]('click', () => { _0x336cd5(), _0x4c0af8(![]); }), _0x13f057[_0x314838(0x988)]('click', () => { const _0x4fde8b = _0x314838; _0x4fde8b(0x150) === _0x4fde8b(0x882) ? _0x3c443f = _0x4fde8b(0x1f2) + _0x48bb50[_0x4fde8b(0x907)] + _0x4fde8b(0x191) + _0x1a9cea[_0x4fde8b(0x695)] + _0x4fde8b(0xaaa) + _0xb8a757['review']['text'] + _0x4fde8b(0x959) : _0x384da8('chat', _0x4fde8b(0x413)); }), _0x50de4d['addEventListener']('click', () => { const _0x5423f8 = _0x314838; _0x5c02ca['classList'][_0x5423f8(0x699)](_0x5423f8(0xa12)); }), _0x3bb1ac[_0x314838(0x988)]('click', () => _0x282af7()), _0x2772a1['addEventListener'](_0x314838(0x649), _0x4d5866); function _0x322320(_0x30f0e5) { const _0x3e5ff1 = _0x314838; if (!_0x30f0e5 || _0x30f0e5[_0x3e5ff1(0x974)] !== _0x3e5ff1(0x9ad)) return; const _0x59bd19 = _0x3e5ff1(0x940); document[_0x3e5ff1(0x32a)][_0x3e5ff1(0x7a2)](_0x3e5ff1(0x168), _0x59bd19); const _0x110cfa = document[_0x3e5ff1(0x7d5)](_0x3e5ff1(0x3c2)), _0x464f7e = _0x110cfa[_0x3e5ff1(0x298)](_0x3e5ff1(0x154)), _0x4e908d = document[_0x3e5ff1(0x7d5)](_0x3e5ff1(0x25f)), _0x4c03bf = document[_0x3e5ff1(0x7d5)](_0x3e5ff1(0x3ab)), _0x5de69f = document[_0x3e5ff1(0x7d5)](_0x3e5ff1(0x319)), _0x208213 = document[_0x3e5ff1(0x7d5)](_0x3e5ff1(0x528)), _0xd716c4 = document[_0x3e5ff1(0x7d5)](_0x3e5ff1(0x595)), _0x6fc6c1 = () => _0x110cfa['remove'](); _0x4e908d['addEventListener']('click', async () => { const _0x3662b7 = _0x3e5ff1; if (_0x3662b7(0x316) === _0x3662b7(0x316)) { _0x6fc6c1(); const _0x4ce3b6 = await _0x39a14a(_0x3662b7(0x5b4) + _0x30f0e5[_0x3662b7(0x695)] + _0x3662b7(0x76b)); if (_0x4ce3b6) { _0x30f0e5['id'] === _0x13c410[_0x3662b7(0x55f)] && (_0x3662b7(0xa7f) !== _0x3662b7(0xa7f) ? _0x197ca8[_0x3662b7(0x7ec)](_0x3662b7(0x156)) : (_0x336cd5(), _0x13c410['conversationHistory'] = [], _0x403f79())); try { localStorage['removeItem'](_0x3662b7(0x151) + _0x30f0e5['id']), _0x1e9edf(_0x3662b7(0x2b5) + _0x30f0e5[_0x3662b7(0x695)] + '\x22\x20的聊天记录已清空。'); } catch (_0x445855) { console[_0x3662b7(0x11e)](_0x3662b7(0xa0b) + _0x30f0e5['id'], _0x445855), _0x1e9edf('清空聊天记录失败。'); } } } else _0x1f6483 = '0x' + _0x460b72[0x1] + _0x5c9adf[0x1], _0x24a974 = '0x' + _0x51ee32[0x2] + _0x547212[0x2], _0x7871c5 = '0x' + _0x43a28a[0x3] + _0x2a5628[0x3]; }), _0x4c03bf[_0x3e5ff1(0x988)]('click', () => { const _0x99f0fd = _0x3e5ff1; _0x99f0fd(0x593) !== 'BzahX' ? (_0x6fc6c1(), _0x1e9edf(_0x99f0fd(0x5a3))) : _0x25e01e[_0x99f0fd(0x988)](_0x99f0fd(0x649), function () { const _0x55ea32 = _0x99f0fd, _0x5c3141 = { 'id': 'msg_' + _0x2d6932[_0x55ea32(0x921)], 'url': _0x2a4ebe['playableUrl'] }; _0x5710fb(this, _0x5c3141); }); }), _0x5de69f['addEventListener'](_0x3e5ff1(0x649), async () => { const _0xd9e2fd = _0x3e5ff1; if (_0xd9e2fd(0x15d) !== _0xd9e2fd(0x3d1)) { _0x6fc6c1(); const _0x36d5b0 = prompt('请输入新的群名称：', _0x30f0e5[_0xd9e2fd(0x695)]); _0x36d5b0 && _0x36d5b0[_0xd9e2fd(0x6eb)]() && _0x36d5b0 !== _0x30f0e5[_0xd9e2fd(0x695)] && (_0x30f0e5[_0xd9e2fd(0x695)] = _0x36d5b0[_0xd9e2fd(0x6eb)](), _0x5834f1(), _0x2de32d(), _0x13b171(), _0x1e9edf('群名称已更改为\x22' + _0x30f0e5[_0xd9e2fd(0x695)] + '\x22。')); } else { if (!_0x5dfe50[_0xd9e2fd(0x5f2)]) return; _0x1a15d1[_0xd9e2fd(0x9e0)] = _0xd9e2fd(0xa77) + _0x2a77c3[_0xd9e2fd(0x5f2)][_0xd9e2fd(0x6da)], _0x81fb5[_0xd9e2fd(0x9e0)] = _0x484a08[_0xd9e2fd(0x5f2)]['content'], _0x37832a['style']['display'] = 'block'; } }), _0x208213[_0x3e5ff1(0x988)]('click', async () => { const _0x4d22f6 = _0x3e5ff1; _0x6fc6c1(); const _0x39279b = await _0x39a14a(_0x4d22f6(0x1e7) + _0x30f0e5[_0x4d22f6(0x695)] + _0x4d22f6(0x14f)); if (_0x39279b) { if (_0x4d22f6(0x952) !== _0x4d22f6(0x952)) return; else _0x461a23(_0x30f0e5['id']), _0x1e9edf(_0x4d22f6(0x2b5) + _0x30f0e5[_0x4d22f6(0x695)] + _0x4d22f6(0x1b1)), _0x4c0af8(![]); } }), _0x464f7e['addEventListener']('click', _0x6fc6c1), _0xd716c4[_0x3e5ff1(0x988)](_0x3e5ff1(0x649), _0x6fc6c1); } _0x1da8dc[_0x314838(0x988)](_0x314838(0x649), () => { const _0x187069 = _0x314838, _0x24d1c2 = _0xee1b45(); if (_0x24d1c2 && _0x24d1c2[_0x187069(0x974)] === _0x187069(0x293)) { if (_0x187069(0x934) !== 'tIoiQ') { const _0x3cac5e = _0x1422ce[_0x187069(0x7d5)](_0x187069(0x698)); if (_0x3cac5e) _0x3cac5e['textContent'] = '▶'; } else _0x27d377(_0x24d1c2[_0x187069(0x9c8)][0x0]); } else { if (_0x24d1c2 && _0x24d1c2[_0x187069(0x974)] === _0x187069(0x9ad)) { if ('xtBUy' !== _0x187069(0x222)) { const _0x225f7d = _0x547d66(_0x4f54a3['id']); if (_0x225f7d && _0x225f7d[_0x187069(0x280)] > 0x0) { const _0x4a128b = _0x225f7d[_0x225f7d[_0x187069(0x280)] - 0x1]; (!_0x20b4ef || _0x4a128b[_0x187069(0x921)] > _0x2f62e6['timestamp']) && (_0x1483d8 = _0x4a128b); } } else _0x1795e0(_0x24d1c2['id']); } } }), _0x4225fb[_0x314838(0x988)](_0x314838(0x610), _0x9c81fd => { const _0x7f7e0c = _0x314838; _0x9c81fd['key'] === 'Enter' && !_0x9c81fd[_0x7f7e0c(0x536)] && (_0x9c81fd['preventDefault'](), _0x282af7()); }); const _0x21670a = () => _0x5c02ca[_0x314838(0x349)][_0x314838(0x330)]('show'); _0x1ef59e['addEventListener'](_0x314838(0x649), _0x21670a), _0x5fa0a3[_0x314838(0x988)]('click', _0x21670a), _0x3945b2[_0x314838(0x988)](_0x314838(0x649), () => { _0x21670a(), _0x27d377(); }), _0xb30534['addEventListener'](_0x314838(0x649), () => { const _0x163f97 = _0x314838; if (_0x163f97(0x600) !== _0x163f97(0x600)) { if (!_0x56ee48) return; _0x4e9029 = _0x4f49f3[_0x163f97(0x205)][0x0][_0x163f97(0x8d9)], _0x1e67e9 === _0x163f97(0x42c) && _0x199bec(), _0x58cf7e = ![]; } else _0x21670a(), _0xe96c4(); }), _0x50210b['addEventListener'](_0x314838(0x649), () => { const _0x28cae4 = _0x314838; _0x28cae4(0x90a) !== 'OpRzc' ? _0x46526d += _0x28cae4(0x4ef) + _0x479190[_0x28cae4(0x3bc)] + _0x28cae4(0xee) + _0x3c6a46[_0x28cae4(0x75a)][_0x28cae4(0x1b5)](/\n/g, '\x20') + _0x28cae4(0x47c) : (_0x384da8('chat', _0x28cae4(0xa13)), _0x4c0af8(![])); }), _0x5e2472[_0x314838(0x988)](_0x314838(0x649), _0x36e015), _0x18ce94[_0x314838(0x988)](_0x314838(0x649), () => { const _0x2eecfe = _0x314838; _0x2aad1a[_0x2eecfe(0x349)][_0x2eecfe(0x581)](_0x2eecfe(0xa12)); if (_0x2aad1a[_0x2eecfe(0x349)][_0x2eecfe(0x741)](_0x2eecfe(0xa12))) { if ('QhdTk' !== 'jCSyR') _0x336614['scrollTop'] = _0x336614['scrollHeight']; else { _0x193ff0 = _0x32b8b3(_0x4f7e32); if (!_0x3e8306) throw new _0x389c4c(_0x2eecfe(0x41c)); _0x45eaf5[_0x2eecfe(0x688)](_0x2eecfe(0x3b9) + _0x14c932['id'] + '\x20的旧格式数据翻译。'); } } }), _0xf50e0f[_0x314838(0x988)](_0x314838(0x649), () => _0x2d773f['click']()); const _0x58db28 = document[_0x314838(0x7d5)](_0x314838(0x6b7)); _0x2d773f[_0x314838(0x988)](_0x314838(0x458), _0x32e337), _0x58db28['addEventListener'](_0x314838(0x649), _0x1816d3), _0x396b5e[_0x314838(0x988)](_0x314838(0x649), _0x14c367), _0x83d5ba[_0x314838(0x988)](_0x314838(0x649), _0x5c7342), _0x7b9362[_0x314838(0x988)](_0x314838(0x649), _0x1bc560), _0x3dfa30['addEventListener'](_0x314838(0x649), _0xb0e3ba), _0x4939b5['addEventListener'](_0x314838(0x649), async () => { const _0x4210e1 = _0x314838, _0x178058 = _0x490d5c['value']; if (!_0x178058) return; const _0x392379 = _0x1d08b4(_0x178058); if (!_0x392379) return; const _0x36f824 = await _0x39a14a(_0x4210e1(0x4be) + _0x392379[_0x4210e1(0x695)] + _0x4210e1(0x1d3)); _0x36f824 && (_0x407d21(_0x178058), _0x1e9edf(_0x4210e1(0x7aa) + _0x392379[_0x4210e1(0x695)] + _0x4210e1(0x7a8)), _0x384da8(_0x4210e1(0x36c), _0x4210e1(0x413)), _0x4c0af8(![])); }), _0x42692e[_0x314838(0x988)](_0x314838(0x6b1), () => { const _0xdffec5 = _0x314838, _0x568b9e = _0x42692e[_0xdffec5(0x4d3)]['trim']()[_0xdffec5(0x71e)](_0xe2cea5); _0x5601d2[_0xdffec5(0x99f)] = _0x568b9e; }); async function _0x51f67a() { const _0x547801 = _0x314838; if ('IWIUT' !== 'Dsjea') { const _0x4c11ba = _0x42692e[_0x547801(0x4d3)]['trim'](), _0x1d3397 = _0x474982[_0x547801(0x4d3)]['trim'](); if (!_0x4c11ba || !_0x1d3397) { _0x1e9edf(_0x547801(0x578)); return; } const _0x4e41b7 = _0x4c11ba[_0x547801(0x1b5)](/\/+$/, ''), _0x22fa4d = _0x4e41b7 + _0x547801(0x42e); _0x5601d2[_0x547801(0x99f)] = !![], _0x5601d2['textContent'] = _0x547801(0x7df), _0x12cb4a[_0x547801(0x349)][_0x547801(0x330)]('show'); try { const _0x21b901 = await fetch(_0x22fa4d, { 'headers': { 'Authorization': _0x547801(0x85d) + _0x5347f7(_0x1d3397) } }); if (!_0x21b901['ok']) throw new Error(_0x547801(0x19b) + _0x21b901[_0x547801(0x3b4)]); const _0xbdf50d = await _0x21b901[_0x547801(0x32c)](), _0x56e321 = (_0xbdf50d[_0x547801(0x9c1)] || _0xbdf50d)[_0x547801(0x33d)](_0x4e6f84 => _0x4e6f84['id'])[_0x547801(0x25d)](); _0x56e321[_0x547801(0x280)] > 0x0 ? (_0x12cb4a['innerHTML'] = '', _0x56e321[_0x547801(0x8c0)](_0x5c8a45 => { const _0x3d9862 = _0x547801, _0x33524d = document[_0x3d9862(0xa30)](_0x3d9862(0xa8b)); _0x33524d[_0x3d9862(0x9e0)] = _0x5c8a45, _0x33524d['addEventListener']('click', () => { const _0x43e882 = _0x3d9862; _0x17226e[_0x43e882(0x4d3)] = _0x5c8a45, _0x12cb4a[_0x43e882(0x349)][_0x43e882(0x330)]('show'); }), _0x12cb4a['appendChild'](_0x33524d); }), _0x12cb4a[_0x547801(0x349)]['add']('show'), _0x1e9edf(_0x547801(0x15b) + _0x56e321[_0x547801(0x280)] + '\x20个模型。')) : _0x547801(0x727) !== _0x547801(0x727) ? _0x2a608c['error'](_0x547801(0x627), _0x1f1232) : _0x1e9edf(_0x547801(0x131)); } catch (_0x1404d9) { if ('lrneW' !== _0x547801(0x7cd)) { const _0xd3f514 = _0x2fe412['transaction'](_0x3b5280, _0x547801(0x989)), _0x3b8b94 = _0xd3f514[_0x547801(0x4bb)](_0x4fcb70), _0x1dbb38 = _0x3b8b94['delete'](_0x26836e); _0x1dbb38[_0x547801(0x804)] = () => _0x10380b(), _0x1dbb38[_0x547801(0xaa9)] = () => _0x4ae808(_0x1dbb38[_0x547801(0x11e)]); } else _0x1e9edf(_0x547801(0x637) + _0x1404d9[_0x547801(0x496)] + _0x547801(0x652)); } finally { if (_0x547801(0x3e3) !== _0x547801(0x3e3)) { const _0x4be5ed = _0x4b2f63(_0x264f01['id']), _0x49b7fb = _0x4be5ed[_0x547801(0x280)] > 0x0 ? _0x4be5ed[_0x4be5ed[_0x547801(0x280)] - 0x1] : null; return { 'chat': _0x19dafa, 'history': _0x4be5ed, 'lastTimestamp': _0x49b7fb ? _0x49b7fb[_0x547801(0x921)] : 0x0 }; } else _0x5601d2[_0x547801(0x99f)] = ![], _0x5601d2['textContent'] = '获取'; } } else _0xc4683e[_0x547801(0x268)] = _0x26533c[_0x547801(0x98c)]; } _0x5601d2[_0x314838(0x988)](_0x314838(0x649), _0x7f80e1 => { _0x7f80e1['stopPropagation'](), _0x51f67a(); }), document[_0x314838(0x988)](_0x314838(0x649), _0x2283dd => { const _0x25f5da = _0x314838; !_0x12cb4a[_0x25f5da(0x741)](_0x2283dd['target']) && _0x2283dd[_0x25f5da(0x6d7)] !== _0x17226e && _0x2283dd['target'] !== _0x5601d2 && _0x12cb4a['classList'][_0x25f5da(0x330)](_0x25f5da(0xa12)); }); async function _0x14be68(_0x3b4ac1) { const _0x934f52 = _0x314838; if (_0x934f52(0x507) !== _0x934f52(0x507)) { _0x4dbf7f('还没有我的回复可以重新生成哦。'); return; } else return await _0x39f7a8(_0x3b4ac1, 0x190, 0.85); } _0x15cbfe[_0x314838(0x988)]('click', () => _0x2f5a8d[_0x314838(0x649)]()), _0x2f5a8d[_0x314838(0x988)](_0x314838(0x458), async _0x35ef79 => { const _0x4a44dd = _0x314838, _0x51c8e4 = _0x35ef79[_0x4a44dd(0x6d7)]['files'][0x0]; if (!_0x51c8e4) return; try { const _0x414d26 = await _0x14be68(_0x51c8e4); _0x15cbfe[_0x4a44dd(0x268)] = _0x414d26; } catch (_0x240d53) { _0x1e9edf(_0x4a44dd(0x875) + _0x240d53[_0x4a44dd(0x496)]); } }), _0x287c3a[_0x314838(0x988)](_0x314838(0x649), () => _0x27cc5f[_0x314838(0x649)]()), _0x27cc5f[_0x314838(0x988)](_0x314838(0x458), async _0x312c24 => { const _0x411e72 = _0x314838, _0x401db3 = _0x312c24[_0x411e72(0x6d7)][_0x411e72(0x6ea)][0x0]; if (!_0x401db3) return; try { if (_0x411e72(0x2e0) === _0x411e72(0x2e0)) _0x287c3a['src'] = await _0x14be68(_0x401db3); else { _0x544759[_0x411e72(0x349)]['add'](_0x411e72(0x52b)); const _0x3b63c9 = _0xc87eeb[_0x411e72(0xa30)]('img'); _0x3b63c9[_0x411e72(0x268)] = _0x4122f6, _0x3b63c9['classList'][_0x411e72(0x699)](_0x411e72(0x91a)), _0x5b9b85[_0x411e72(0x3fd)](_0x3b63c9); } } catch (_0xc618c2) { _0x411e72(0x469) !== _0x411e72(0x304) ? _0x1e9edf(_0x411e72(0x875) + _0xc618c2[_0x411e72(0x496)]) : (_0x5a67b0['value'] = _0x5ad4ad[_0x411e72(0xa48)][_0x411e72(0x7d7)] || '', _0x39bcdd[_0x411e72(0x4d3)] = _0x4bda58[_0x411e72(0xa48)]['key'] || '', _0x4d694b[_0x411e72(0x4d3)] = _0x183a83[_0x411e72(0xa48)][_0x411e72(0x7b4)] || '', _0x77c5ae['value'] = _0x1cfa2c(_0x289caa['preferences']?.[_0x411e72(0x4cf)] ?? 0x64), _0x5e3151[_0x411e72(0x7d5)](_0x411e72(0xa51))['value'] = _0x3088d0['apiSettings'][_0x411e72(0x7fe)] || _0x411e72(0x945)); } }); function _0x52b46f() { const _0x10e14b = _0x314838; _0x2aad1a[_0x10e14b(0x65e)] = '', _0x5c61cd[_0x10e14b(0x8c0)](_0x4d8c79 => { const _0x4d4fd4 = _0x10e14b, _0x58b4b6 = document[_0x4d4fd4(0xa30)]('img'); _0x58b4b6[_0x4d4fd4(0x268)] = _0x4d8c79[_0x4d4fd4(0x570)], _0x58b4b6[_0x4d4fd4(0x605)] = _0x4d4fd4(0x973), _0x58b4b6[_0x4d4fd4(0x3bc)] = _0x4d8c79[_0x4d4fd4(0x695)], _0x58b4b6['classList']['add'](_0x4d4fd4(0x55d)), _0x58b4b6[_0x4d4fd4(0x988)](_0x4d4fd4(0x649), () => _0x265a64(_0x4d8c79)), _0x2aad1a[_0x4d4fd4(0x3fd)](_0x58b4b6); }); } function _0x406872() { const _0x3a1ba8 = _0x314838, _0x1721d2 = document[_0x3a1ba8(0x7d5)](_0x3a1ba8(0x6fa)); _0x1721d2[_0x3a1ba8(0x65e)] = ''; if (_0x13c410[_0x3a1ba8(0x6ed)][_0x3a1ba8(0x280)] === 0x0) { _0x1721d2['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>'; return; } _0x13c410['userProfiles'][_0x3a1ba8(0x8c0)](_0x2d4bfb => { const _0x12ba44 = _0x3a1ba8; if (_0x12ba44(0x329) !== _0x12ba44(0x329)) _0x5698b4['preferences'] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x4d2d8e['preferences'] }; else { const _0xb29678 = document[_0x12ba44(0xa30)](_0x12ba44(0xa8b)); _0xb29678[_0x12ba44(0x828)] = 'world-book-item', _0xb29678[_0x12ba44(0x14b)]['id'] = _0x2d4bfb['id']; const _0x173ffa = _0x2d4bfb['id'] === _0x13c410[_0x12ba44(0x56d)] ? _0x12ba44(0x9cd) : ''; _0xb29678[_0x12ba44(0x65e)] = _0x12ba44(0xa9b) + (_0x2d4bfb['avatar'] || _0x10ed69) + _0x12ba44(0x977) + _0x2d4bfb['name'] + _0x173ffa + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x2d4bfb['persona'][_0x12ba44(0x5e0)](0x0, 0x64) + _0x12ba44(0x45c), _0xb29678[_0x12ba44(0x988)](_0x12ba44(0x649), () => _0x1d6ea3(_0x2d4bfb['id'])), _0x1721d2[_0x12ba44(0x3fd)](_0xb29678); } }); } function _0x1d6ea3(_0x1ac9eb = null) { const _0x154e26 = _0x314838; _0x384da8(_0x154e26(0x787), _0x154e26(0x28b)); const _0x3130ba = document['getElementById'](_0x154e26(0x282)); if (_0x1ac9eb) { const _0x120413 = _0x13c410['userProfiles'][_0x154e26(0x9b9)](_0x493b0e => _0x493b0e['id'] === _0x1ac9eb); if (!_0x120413) return; document[_0x154e26(0x7d5)]('editing-user-id')[_0x154e26(0x4d3)] = _0x120413['id'], document[_0x154e26(0x7d5)](_0x154e26(0x6a8))[_0x154e26(0x9e0)] = _0x154e26(0x396), document[_0x154e26(0x7d5)](_0x154e26(0x9f1))['value'] = _0x120413['name'], document[_0x154e26(0x7d5)]('user-avatar-preview')[_0x154e26(0x268)] = _0x120413['avatar'], document[_0x154e26(0x7d5)]('user-persona')[_0x154e26(0x4d3)] = _0x120413[_0x154e26(0x2a1)], _0x3130ba[_0x154e26(0x462)][_0x154e26(0x5f3)] = _0x120413['id'] === _0x13c410[_0x154e26(0x56d)] ? _0x154e26(0x794) : _0x154e26(0x10c); } else document[_0x154e26(0x7d5)](_0x154e26(0x1fd))['value'] = '', document[_0x154e26(0x7d5)]('user-profile-edit-title')['textContent'] = _0x154e26(0x383), document['getElementById'](_0x154e26(0x9f1))[_0x154e26(0x4d3)] = '新用户\x20' + (_0x13c410[_0x154e26(0x6ed)][_0x154e26(0x280)] + 0x1), document[_0x154e26(0x7d5)](_0x154e26(0x33a))[_0x154e26(0x268)] = _0x10ed69, document[_0x154e26(0x7d5)]('user-persona')[_0x154e26(0x4d3)] = '', _0x3130ba[_0x154e26(0x462)]['display'] = 'none'; } function _0x5c7342() { const _0x571620 = _0x314838, _0x13cf0e = document['getElementById']('editing-user-id')[_0x571620(0x4d3)], _0x24028c = { 'name': document[_0x571620(0x7d5)](_0x571620(0x9f1))[_0x571620(0x4d3)][_0x571620(0x6eb)](), 'persona': document['getElementById']('user-persona')['value'][_0x571620(0x6eb)](), 'avatar': document[_0x571620(0x7d5)]('user-avatar-preview')['src'] }; if (!_0x24028c[_0x571620(0x695)]) { _0x1e9edf(_0x571620(0x92e)); return; } if (_0x13cf0e) { if (_0x571620(0x805) === _0x571620(0x509)) _0x5c356a[_0x571620(0x462)][_0x571620(0x97e)] = '', _0x2b3047[_0x571620(0x462)]['color'] = '', _0x55a265[_0x571620(0x83d)](_0x571620(0x14a))['forEach'](_0x14e7b6 => { const _0x421f21 = _0x571620; _0x14e7b6[_0x421f21(0x462)]['textShadow'] = ''; }); else { const _0x5dd5bf = _0x13c410[_0x571620(0x6ed)]['find'](_0xadbafe => _0xadbafe['id'] === _0x13cf0e); if (_0x5dd5bf) Object[_0x571620(0x6e9)](_0x5dd5bf, _0x24028c); } } else { const _0x66002a = { 'id': _0x571620(0x3e6) + Date[_0x571620(0x2f2)](), ..._0x24028c }; _0x13c410['userProfiles'][_0x571620(0x98f)](_0x66002a), !_0x13c410[_0x571620(0x56d)] && (_0x571620(0x30e) === _0x571620(0x71a) ? _0x586007[_0x571620(0x246)] = _0xcb742e['accountingLedger'] : _0x13c410[_0x571620(0x56d)] = _0x66002a['id']); } _0x5834f1(), _0x1e9edf(_0x571620(0x53b)), _0x406872(), _0x384da8(_0x571620(0x28b), _0x571620(0x787)); } async function _0x33995e() { const _0x7c2a54 = _0x314838, _0xec6fc3 = document[_0x7c2a54(0x7d5)](_0x7c2a54(0x1fd))[_0x7c2a54(0x4d3)]; if (!_0xec6fc3) return; if (_0x13c410[_0x7c2a54(0x6ed)][_0x7c2a54(0x280)] <= 0x1) { _0x1e9edf(_0x7c2a54(0x4e8)); return; } const _0x4c672d = await _0x39a14a(_0x7c2a54(0x326)); _0x4c672d && (_0x13c410[_0x7c2a54(0x6ed)] = _0x13c410['userProfiles'][_0x7c2a54(0x61f)](_0x222af9 => _0x222af9['id'] !== _0xec6fc3), _0x13c410[_0x7c2a54(0x56d)] === _0xec6fc3 && (_0x13c410['activeUserProfileId'] = _0x13c410['userProfiles'][0x0]['id']), _0x13c410['chats'][_0x7c2a54(0x8c0)](_0x291e9f => { const _0x31fba0 = _0x7c2a54; if (_0x31fba0(0x830) !== _0x31fba0(0x830)) { const _0x991e55 = { 'id': _0x45ee14['id'], 'url': _0x559c68[_0x31fba0(0x128)] }; _0x5194ad(this, _0x991e55); } else _0x291e9f[_0x31fba0(0x75d)] === _0xec6fc3 && (_0x31fba0(0x843) !== _0x31fba0(0x7f3) ? _0x291e9f[_0x31fba0(0x75d)] = _0x13c410['activeUserProfileId'] : (_0x3e15f2(![]), _0x3b5e34['target'][_0x31fba0(0x4d3)] = '')); }), _0x5834f1(), _0x1e9edf(_0x7c2a54(0x923)), _0x406872(), _0x384da8(_0x7c2a54(0x28b), _0x7c2a54(0x787))); } function _0x4444f0() { const _0x49b701 = _0x314838, _0x120c06 = document[_0x49b701(0x7d5)](_0x49b701(0x583)); _0x120c06[_0x49b701(0x65e)] = ''; if (_0x13c410['worldBooks'][_0x49b701(0x280)] === 0x0) { if (_0x49b701(0xa5c) !== _0x49b701(0x6a7)) { _0x120c06[_0x49b701(0x65e)] = _0x49b701(0x835); return; } else { const _0x5a8e1b = (_0x8fa8d8 - 0x5a) * _0x7a9c28['PI'] / 0xb4; return { 'x': _0x5f30ef + _0x40413d * _0x28bd8f[_0x49b701(0xa4d)](_0x5a8e1b), 'y': _0x2e4245 + _0x3660ef * _0x3468ad[_0x49b701(0x232)](_0x5a8e1b) }; } } _0x13c410[_0x49b701(0x90d)][_0x49b701(0x8c0)](_0x1b837d => { const _0x10e8c4 = _0x49b701, _0x511e9e = document['createElement'](_0x10e8c4(0xa8b)); _0x511e9e[_0x10e8c4(0x828)] = _0x10e8c4(0x4d5), _0x511e9e['dataset']['id'] = _0x1b837d['id'], _0x511e9e[_0x10e8c4(0x65e)] = _0x10e8c4(0x5a1) + _0x1b837d[_0x10e8c4(0x695)] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x1b837d[_0x10e8c4(0x75a)]['substring'](0x0, 0x64) + _0x10e8c4(0xf6), _0x511e9e[_0x10e8c4(0x988)](_0x10e8c4(0x649), () => _0x2024cd(_0x1b837d['id'])), _0x120c06[_0x10e8c4(0x3fd)](_0x511e9e); }); } function _0x2024cd(_0x3bee84 = null) { const _0x11c799 = _0x314838; _0x384da8(_0x11c799(0x3f6), _0x11c799(0x4e5)); if (_0x3bee84) { const _0x57fba7 = _0x13c410[_0x11c799(0x90d)][_0x11c799(0x9b9)](_0xf76d9b => _0xf76d9b['id'] === _0x3bee84); if (!_0x57fba7) return; document[_0x11c799(0x7d5)](_0x11c799(0x34b))[_0x11c799(0x4d3)] = _0x57fba7['id'], document[_0x11c799(0x7d5)]('world-book-editor-title')['textContent'] = _0x11c799(0x442), document[_0x11c799(0x7d5)](_0x11c799(0xa0c))['value'] = _0x57fba7[_0x11c799(0x695)], document[_0x11c799(0x7d5)](_0x11c799(0x325))[_0x11c799(0x4d3)] = _0x57fba7['content']; } else document['getElementById'](_0x11c799(0x34b))['value'] = '', document[_0x11c799(0x7d5)](_0x11c799(0x6af))[_0x11c799(0x9e0)] = _0x11c799(0x328), document[_0x11c799(0x7d5)](_0x11c799(0xa0c))[_0x11c799(0x4d3)] = '', document['getElementById'](_0x11c799(0x325))['value'] = ''; } function _0x242b40() { const _0x599680 = _0x314838; if (_0x599680(0x3ef) !== _0x599680(0x3ef)) { const _0x3a4430 = _0x98d8f1['senderId'] || _0x70272?.['participantIds'][0x0], _0x567e31 = _0x3d6610(_0x3a4430); _0x3535b3 = _0x567e31 ? _0x567e31[_0x599680(0x695)] : '角色'; } else { const _0x2137fe = document[_0x599680(0x7d5)]('editing-world-book-id')[_0x599680(0x4d3)], _0x5b48e9 = document[_0x599680(0x7d5)](_0x599680(0xa0c))['value'][_0x599680(0x6eb)](), _0x39fe4d = document[_0x599680(0x7d5)]('world-book-edit-content')[_0x599680(0x4d3)][_0x599680(0x6eb)](); if (!_0x5b48e9 || !_0x39fe4d) { _0x1e9edf(_0x599680(0x1de)); return; } if (_0x2137fe) { if (_0x599680(0x1d1) !== 'lDIrN') { if (!_0x4e0ee3) return; const _0x137585 = _0x1222dd[_0x599680(0x2c7)], _0x1dcef9 = _0x40f2ab(_0x137585); if (!_0x1dcef9) return; const _0x294996 = _0x238d1f(_0x715199['getElementById'](_0x599680(0x259))[_0x599680(0x4d3)]), _0x1d5685 = _0x5cd7e0(_0xe506a9['getElementById'](_0x599680(0x5b1))[_0x599680(0x4d3)]), _0x1b6a4d = _0x150a1b(_0x56c675['getElementById'](_0x599680(0x44b))[_0x599680(0x4d3)]) / 0x64; _0x1dcef9[_0x599680(0x1e6)] = { 'x': _0x294996, 'y': _0x1d5685, 'scale': _0x1b6a4d }; const _0x106492 = _0x56407e[_0x599680(0x7d5)]('galgame-sprite-container'), _0xa9a55f = 0x50 * _0x1b6a4d; _0x106492[_0x599680(0x462)]['height'] = _0xa9a55f + '%', _0x106492[_0x599680(0x462)][_0x599680(0x7a7)] = _0xa9a55f + '%', _0x106492[_0x599680(0x462)][_0x599680(0x26c)] = _0x294996 + '%', _0x106492[_0x599680(0x462)][_0x599680(0x43a)] = _0x1d5685 + '%', _0x106492[_0x599680(0x462)][_0x599680(0x424)] = _0x599680(0x8a3); } else { const _0x3d9948 = _0x13c410[_0x599680(0x90d)][_0x599680(0x9b9)](_0x5d8f02 => _0x5d8f02['id'] === _0x2137fe); _0x3d9948 && (_0x3d9948[_0x599680(0x695)] = _0x5b48e9, _0x3d9948[_0x599680(0x75a)] = _0x39fe4d); } } else { const _0x508efd = { 'id': _0x599680(0x39d) + Date[_0x599680(0x2f2)](), 'name': _0x5b48e9, 'content': _0x39fe4d }; _0x13c410[_0x599680(0x90d)][_0x599680(0x98f)](_0x508efd); } _0x5834f1(), _0x1e9edf(_0x599680(0x4b8)), _0x4444f0(), _0x384da8(_0x599680(0x4e5), _0x599680(0x3f6)); } } async function _0x1f5457() { const _0x4f8d78 = _0x314838; if (_0x4f8d78(0x3b6) === _0x4f8d78(0xa1d)) _0x508ae0[_0x4f8d78(0x462)]['padding'] = '0'; else { const _0x55e636 = document[_0x4f8d78(0x7d5)](_0x4f8d78(0x34b))[_0x4f8d78(0x4d3)]; if (!_0x55e636) return; const _0x5e7c64 = await _0x39a14a('确定要删除这个条目吗？此操作不可撤销。'); _0x5e7c64 && (_0x13c410['worldBooks'] = _0x13c410[_0x4f8d78(0x90d)]['filter'](_0x3db67d => _0x3db67d['id'] !== _0x55e636), _0x13c410[_0x4f8d78(0x53a)][_0x4f8d78(0x8c0)](_0xff4d0c => { const _0x54505a = _0x4f8d78; _0xff4d0c['linkedWorldBookIds'] && (_0xff4d0c[_0x54505a(0x7d8)] = _0xff4d0c['linkedWorldBookIds'][_0x54505a(0x61f)](_0x2eae66 => _0x2eae66 !== _0x55e636)); }), _0x5834f1(), _0x1e9edf(_0x4f8d78(0x535)), _0x4444f0(), _0x384da8(_0x4f8d78(0x4e5), _0x4f8d78(0x3f6))); } } function _0x4479b5() { const _0x436b8f = _0x314838, _0x3b49c7 = document[_0x436b8f(0x7d5)](_0x436b8f(0x8f6)), _0xd321fd = _0x3b49c7[_0x436b8f(0x83d)](_0x436b8f(0x5f9)), _0x1ed143 = document[_0x436b8f(0x298)](_0x436b8f(0x15a)); if (_0xd321fd[_0x436b8f(0x280)] === 0x0) { if (_0x436b8f(0x78a) === _0x436b8f(0x78a)) _0x1ed143['textContent'] = _0x436b8f(0x526); else { _0x2c2593(_0x436b8f(0x92e)); return; } } else _0xd321fd['length'] > 0x2 ? _0x1ed143['textContent'] = '已选择\x20' + _0xd321fd[_0x436b8f(0x280)] + '\x20项' : _0x1ed143[_0x436b8f(0x9e0)] = Array[_0x436b8f(0x703)](_0xd321fd)[_0x436b8f(0x33d)](_0x4026c5 => _0x4026c5[_0x436b8f(0x508)][_0x436b8f(0x9e0)][_0x436b8f(0x6eb)]())[_0x436b8f(0x8aa)]('、'); } function _0x1795e0(_0x5c8594) { const _0x21153b = _0x314838, _0x14f62a = _0x13c410['chats'][_0x21153b(0x9b9)](_0x3bbd04 => _0x3bbd04['id'] === _0x5c8594); if (!_0x14f62a || _0x14f62a[_0x21153b(0x974)] !== _0x21153b(0x9ad)) return; document[_0x21153b(0x7d5)](_0x21153b(0x60f))['value'] = _0x14f62a['name'] || '', _0x52ddde('group-settings-bind-user'), document[_0x21153b(0x7d5)](_0x21153b(0x562))['value'] = _0x14f62a[_0x21153b(0x75d)] || _0x13c410[_0x21153b(0x56d)]; const _0x29af3e = document[_0x21153b(0x7d5)](_0x21153b(0x660)); _0x29af3e[_0x21153b(0x65e)] = '', _0x13c410['worldBooks'][_0x21153b(0x8c0)](_0xb77f19 => { const _0xfee1ed = _0x21153b, _0x5e3808 = _0x14f62a[_0xfee1ed(0x7d8)]?.[_0xfee1ed(0x71e)](_0xb77f19['id']), _0x47b868 = document['createElement'](_0xfee1ed(0x69d)); _0x47b868[_0xfee1ed(0x65e)] = _0xfee1ed(0x612) + _0xb77f19['id'] + '\x22\x20' + (_0x5e3808 ? _0xfee1ed(0x8ba) : '') + '>\x20' + _0xb77f19[_0xfee1ed(0x695)], _0x29af3e[_0xfee1ed(0x3fd)](_0x47b868); }), _0x14e1a8(); const _0x1cc952 = document[_0x21153b(0x7d5)](_0x21153b(0x512)), _0x24867c = document[_0x21153b(0x7d5)]('group-bg-preview'); _0xb9bbbf(_0x21153b(0x2ef) + _0x5c8594)['then'](_0x6f5857 => { const _0x116f5a = _0x21153b; _0x1cc952[_0x116f5a(0x268)] = _0x6f5857 ? URL[_0x116f5a(0x602)](_0x6f5857) : _0x1c044f; }), _0xb9bbbf(_0x21153b(0x9a3) + _0x5c8594)['then'](_0x851b29 => { const _0x170216 = _0x21153b; _0x24867c[_0x170216(0x268)] = _0x851b29 ? URL[_0x170216(0x602)](_0x851b29) : ''; }), _0x384da8('groupSettings', _0x21153b(0x36c)); } async function _0x286fe3() { const _0x40a22f = _0x314838, _0x52188b = _0xee1b45(); if (!_0x52188b || _0x52188b[_0x40a22f(0x974)] !== 'group') return; const _0x167190 = document[_0x40a22f(0x7d5)](_0x40a22f(0x60f))['value'][_0x40a22f(0x6eb)](); if (!_0x167190) { if (_0x40a22f(0x767) !== _0x40a22f(0x541)) { _0x1e9edf('群聊名称不能为空！'); return; } else _0x406ad0[_0xda63cd][_0x40a22f(0x988)]('click', () => _0x551d88[_0x251d77][_0x40a22f(0x649)]()), _0x191e06[_0x4484fe]['addEventListener'](_0x40a22f(0x458), _0x1ec8a4 => { const _0xedb398 = _0x40a22f; _0x4afbf7(_0x3c4685, _0x1ec8a4[_0xedb398(0x6d7)][_0xedb398(0x6ea)][0x0]); }); } _0x52188b['name'] = _0x167190; const _0x1d5b59 = document[_0x40a22f(0x83d)](_0x40a22f(0x3fb)); _0x52188b[_0x40a22f(0x7d8)] = Array['from'](_0x1d5b59)[_0x40a22f(0x33d)](_0x158eed => _0x158eed[_0x40a22f(0x4d3)]), _0x52188b[_0x40a22f(0x75d)] = document[_0x40a22f(0x7d5)](_0x40a22f(0x562))[_0x40a22f(0x4d3)]; const _0x12c7d0 = document[_0x40a22f(0x7d5)](_0x40a22f(0x9a8))['files'][0x0], _0x437845 = document['getElementById'](_0x40a22f(0x352))[_0x40a22f(0x6ea)][0x0]; if (_0x12c7d0) await _0x4162d1(_0x40a22f(0x2ef) + _0x52188b['id'], _0x12c7d0); if (_0x437845) await _0x4162d1(_0x40a22f(0x9a3) + _0x52188b['id'], _0x437845); _0x5834f1(), _0x13b171(), await _0x2de32d(), _0x1e9edf(_0x40a22f(0x753)), _0x384da8(_0x40a22f(0x36c), _0x40a22f(0x7b5)); } function _0x14e1a8() { const _0x646eb6 = _0x314838; if (_0x646eb6(0x69e) === _0x646eb6(0x9ec)) _0x3301b6[_0x646eb6(0x462)][_0x646eb6(0x43a)] = _0x2dfc2a['top'] + '%', _0x57b018[_0x646eb6(0x462)][_0x646eb6(0x26c)] = _0x3a323b['left'] + '%'; else { const _0x4a7487 = document[_0x646eb6(0x7d5)](_0x646eb6(0x660)), _0x29f2ec = _0x4a7487[_0x646eb6(0x83d)](_0x646eb6(0x5f9)), _0x488514 = document['querySelector'](_0x646eb6(0x871)); if (_0x29f2ec[_0x646eb6(0x280)] === 0x0) _0x488514[_0x646eb6(0x9e0)] = _0x646eb6(0x526); else { if (_0x29f2ec[_0x646eb6(0x280)] > 0x2) 'BKMrk' !== _0x646eb6(0xa76) ? _0x4c9681[_0x646eb6(0x349)][_0x646eb6(0x330)](_0x646eb6(0xa12)) : _0x488514[_0x646eb6(0x9e0)] = '已选择\x20' + _0x29f2ec[_0x646eb6(0x280)] + '\x20项'; else { if ('QAFxI' === _0x646eb6(0x7a9)) _0x488514[_0x646eb6(0x9e0)] = Array['from'](_0x29f2ec)['map'](_0x5ecf25 => _0x5ecf25['parentElement']['textContent'][_0x646eb6(0x6eb)]())[_0x646eb6(0x8aa)]('、'); else { const _0x384658 = _0x490ebc[_0x646eb6(0x38a)](_0xee4426, _0x646eb6(0x77b)), _0x2e0045 = _0x384658['objectStore'](_0x29d88a), _0x193f08 = _0x2e0045[_0x646eb6(0x919)](_0x1e76d6); _0x193f08[_0x646eb6(0x804)] = () => _0x18bd4e(_0x193f08[_0x646eb6(0x211)]), _0x193f08[_0x646eb6(0xaa9)] = () => _0x474cf4(_0x193f08[_0x646eb6(0x11e)]); } } } } } async function _0x35ac1d() { const _0x588129 = _0x314838; if ('FwDFq' !== 'FwDFq') { const _0x4f2e32 = _0x43f7c7(_0x12940d[_0x588129(0x2c7)]); _0x4f2e32 && (_0x4f2e32[_0x588129(0x1e6)] = _0x3d3d8a, _0x4803de(_0x5d398a[_0x588129(0x2c7)], _0x588129(0x6a9))); } else { const _0x558354 = _0xee1b45(), _0x240261 = (_0x558354?.['participantIds'] || [])['map'](_0x1d08b4)[_0x588129(0x61f)](Boolean), _0x5cc9bf = _0x328a3b(_0x558354['id']); if (!_0x558354 || _0x558354['type'] !== _0x588129(0x9ad) || _0x240261[_0x588129(0x280)] < 0x2) return null; const _0x294dde = _0x558354[_0x588129(0x7d8)] && _0x558354[_0x588129(0x7d8)]['length'] > 0x0 ? _0x588129(0x962) + _0x558354[_0x588129(0x7d8)][_0x588129(0x33d)](_0xf16172 => _0x13c410['worldBooks'][_0x588129(0x9b9)](_0x192966 => _0x192966['id'] === _0xf16172))[_0x588129(0x61f)](Boolean)['map'](_0x44a5e0 => _0x588129(0x574) + _0x44a5e0[_0x588129(0x695)] + '\x0a' + _0x44a5e0[_0x588129(0x75a)])[_0x588129(0x8aa)]('') : '', _0x17a236 = _0x5cc9bf[_0x588129(0x2a1)] ? '\x0a\x0a#\x20关于群聊参与者“' + _0x5cc9bf[_0x588129(0x695)] + _0x588129(0x891) + _0x5cc9bf[_0x588129(0x2a1)] : ''; let _0x3e8946 = ''; const _0x284feb = new Date(), _0x1cfbbf = _0x13c410[_0x588129(0x793)]['at'](-0x1); _0x3e8946 += _0x588129(0x1d0) + _0x284feb[_0x588129(0x79b)]('zh-CN', { 'dateStyle': _0x588129(0x21f), 'timeStyle': 'short' }); if (_0x1cfbbf) { const _0x3e5a24 = new Date(_0x1cfbbf[_0x588129(0x921)]), _0x598888 = Math[_0x588129(0x66a)]((_0x284feb - _0x3e5a24) / (0x3e8 * 0x3c)); if (_0x598888 < 0x5) _0x3e8946 += '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。'; else { if (_0x598888 < 0x78) _0x3e8946 += _0x588129(0x6f8) + _0x598888 + _0x588129(0x2ce); else { const _0x15dd03 = Math[_0x588129(0x66a)](_0x598888 / 0x3c); if (_0x15dd03 < 0x30) _0x3e8946 += _0x588129(0x6f8) + _0x15dd03 + '小时前聊过，可以适当问候，不要直接继续之前的话题。'; else _0x3e8946 += '\x0a-\x20**对话状态**:\x20群里已经有' + Math[_0x588129(0x66a)](_0x15dd03 / 0x18) + _0x588129(0x437); } } } else { if (_0x588129(0x53c) !== _0x588129(0x53c)) { const _0xae3505 = _0x148fa4[_0x588129(0x6ed)][_0x588129(0x9b9)](_0x368330 => _0x368330['id'] === _0x4430b9); if (!_0xae3505) return; _0x2af1ae[_0x588129(0x7d5)]('editing-user-id')['value'] = _0xae3505['id'], _0x36e975[_0x588129(0x7d5)]('user-profile-edit-title')[_0x588129(0x9e0)] = _0x588129(0x396), _0x2db089[_0x588129(0x7d5)]('user-name')[_0x588129(0x4d3)] = _0xae3505[_0x588129(0x695)], _0x43d6f7[_0x588129(0x7d5)](_0x588129(0x33a))[_0x588129(0x268)] = _0xae3505['avatar'], _0x1d5d21['getElementById'](_0x588129(0x3c6))[_0x588129(0x4d3)] = _0xae3505[_0x588129(0x2a1)], _0x44e3ad['style']['display'] = _0xae3505['id'] === _0x475151['activeUserProfileId'] ? 'none' : _0x588129(0x10c); } else _0x3e8946 += _0x588129(0x8c9); } const _0x216815 = [..._0x13c410[_0x588129(0x793)]]['reverse']()[_0x588129(0x9b9)](_0x146dc1 => _0x146dc1[_0x588129(0x4cc)] === 'user')?.['content'] || '', _0x5a33b7 = _0x42c5ee(_0x558354, _0x216815), _0x112588 = _0x13c410['conversationHistory'][_0x588129(0x6d1)](-0x78), _0xed2912 = _0x5c61cd[_0x588129(0x33d)](_0x469541 => _0x469541[_0x588129(0x695)]), _0x93f5ea = _0x35b71c(), _0x17b4aa = _0x240261[_0x588129(0x33d)](_0x4dac2f => { const _0x3ca670 = _0x588129; if (_0x3ca670(0xa8d) === _0x3ca670(0xa8d)) { const { omniText: _0x1f51f9 } = _0x32d34b(_0x4dac2f['id'], _0x558354['id']), _0x315545 = _0x40d5ca(_0x4dac2f['id']), _0x31684d = _0x4dac2f[_0x3ca670(0x7d8)] && _0x4dac2f[_0x3ca670(0x7d8)][_0x3ca670(0x280)] > 0x0 ? '\x0a\x0a#\x20' + _0x4dac2f[_0x3ca670(0x695)] + _0x3ca670(0x8f2) + _0x4dac2f[_0x3ca670(0x7d8)]['map'](_0x23a908 => _0x13c410['worldBooks'][_0x3ca670(0x9b9)](_0x5d590e => _0x5d590e['id'] === _0x23a908))['filter'](Boolean)[_0x3ca670(0x33d)](_0x3dcc2d => _0x3ca670(0xa58) + _0x3dcc2d[_0x3ca670(0x695)] + '\x0a' + _0x3dcc2d['content'])[_0x3ca670(0x8aa)]('') : ''; let _0x2e9123 = '\x0a#\x20关于你\x20(' + _0x4dac2f[_0x3ca670(0x695)] + _0x3ca670(0x624); const _0xdcc032 = _0x1ca438(_0x4dac2f['id']), _0x4eabbe = new Date(); if (_0xdcc032) { if ('DRNrX' === 'DRNrX') { const _0x425642 = new Date(_0xdcc032[_0x3ca670(0x921)]); _0x2e9123 += _0x3ca670(0x5d8) + _0x5cc9bf[_0x3ca670(0x695)] + _0x3ca670(0x97f) + _0x50e57d(_0x425642) + '\x0a'; const _0x24dfc3 = _0x4eabbe[_0x3ca670(0x7ab)]() === _0x425642['toDateString'](), _0x4ecba2 = new Date(); _0x4ecba2['setDate'](_0x4eabbe[_0x3ca670(0x1a4)]() - 0x1); const _0x3d9233 = _0x4ecba2[_0x3ca670(0x7ab)]() === _0x425642[_0x3ca670(0x7ab)](); if (_0x24dfc3) _0x3ca670(0x300) !== _0x3ca670(0x540) ? _0x2e9123 += _0x3ca670(0x336) : _0x5d4d81(_0x37641c[_0x3ca670(0x5bb)])[_0x3ca670(0x834)](_0x1f0113 => { const _0x58f403 = _0x3ca670; if (_0x1f0113) { const _0x17c0b5 = _0x1c9c26[_0x58f403(0x602)](_0x1f0113); _0x55797a['src'] = _0x17c0b5, _0x14fd7a[_0x58f403(0x3a5)] = () => _0x51cdf4[_0x58f403(0x918)](_0x17c0b5); } }); else _0x3d9233 ? _0x2e9123 += _0x3ca670(0x3b3) : _0x2e9123 += '-\x20**状态提示**:\x20你和Ta已经好几天没联系了，应该用全新的问候开启对话。\x0a'; } else _0x1b88a9[_0x3ca670(0x765)] = { 'sender': _0x23f11a[0x1][_0x3ca670(0x6eb)](), 'content': _0x244dfb[0x2][_0x3ca670(0x6eb)]() }, _0x1d8e99[_0x3ca670(0x75a)] = _0x470e49['substring'](_0x3b7baf[0x0][_0x3ca670(0x280)])[_0x3ca670(0x6eb)](); } else _0x2e9123 += _0x3ca670(0x369) + _0x5cc9bf[_0x3ca670(0x695)] + '的第一次互动。\x0a'; return { 'id': _0x4dac2f['id'], 'name': _0x4dac2f[_0x3ca670(0x695)], 'persona': _0x4dac2f[_0x3ca670(0x2a1)] || _0x3ca670(0x173), 'memory': _0x1f51f9 + _0x315545 + _0x31684d + _0x2e9123 }; } else _0x4a5f66 += _0x3ca670(0x701); }), _0x2b4c96 = 0x5, _0x1e4808 = 0xc, _0x1b42dc = _0x588129(0xa66)[_0x588129(0x6eb)](), _0x1a66e1 = { 'instruction': (_0x588129(0x8f0) + (_0x5cc9bf[_0x588129(0x695)] || '用户') + _0x588129(0x89c) + (_0x5cc9bf[_0x588129(0x695)] || '用户') + '”。在分析历史记录时，请记住这一点，并用此名称指代用户。\x0a-\x20【最重要】为\x20`personas`\x20列表中的【每一位】角色都规划至少一个事件(通常不少于2个)。不能遗漏任何角色。\x0a-\x20【新增规则】你可以规划\x20\x22kind\x22:\x20\x22music\x22\x20事件来分享音乐。此时，你【必须】同时提供\x20\x22songName\x22\x20和\x20\x22artist\x22\x20字段。\x0a-\x20你的首要任务是产出一个严格遵守SCHEMA、语法完全正确的、可被解析的JSON对象。\x0a-\x20若用户\x20`@`\x20了某个角色\x20(见\x20`mentioned`)，该角色应优先发言。\x0a-\x20事件总数必须控制在\x20' + _0x2b4c96 + '\x20到\x20' + _0x1e4808 + _0x588129(0x30c) + (_0x5cc9bf[_0x588129(0x695)] || '用户') + _0x588129(0x6c7) + _0x3e8946 + '\x20\x0a' + _0x17a236 + '\x0a' + _0x294dde + _0x588129(0x4fd) + _0x93f5ea + '\x0a')[_0x588129(0x6eb)](), 'personas': _0x17b4aa, 'mentioned': _0x5a33b7 ? { 'id': _0x5a33b7['id'], 'name': _0x5a33b7[_0x588129(0x695)] } : null, 'stickerList': _0xed2912 }, _0x4722aa = { 'type': 'object', 'properties': { 'events': { 'type': 'array', 'items': { 'type': _0x588129(0x2f6), 'required': [_0x588129(0x7c4), _0x588129(0x6b3)], 'properties': { 'senderId': { 'type': _0x588129(0x802) }, 'kind': { 'type': _0x588129(0x802), 'enum': [_0x588129(0x928), _0x588129(0x52b), _0x588129(0x44d)] }, 'content': { 'type': _0x588129(0x802) }, 'sticker': { 'type': 'string' }, 'songName': { 'type': _0x588129(0x802) }, 'artist': { 'type': 'string' } } } } }, 'required': [_0x588129(0x572)] }, _0x5d1071 = []; _0x5d1071[_0x588129(0x98f)]({ 'role': _0x588129(0x711), 'content': _0x1b42dc }); for (const _0x5a11ee of _0x112588) { if ('faSuw' !== 'ZSYPz') { const _0x12816d = _0x5a11ee['role'] === 'ai' || _0x5a11ee[_0x588129(0x4cc)] === _0x588129(0x9bb) ? _0x588129(0x9bb) : 'user'; let _0x46b904 = { 'role': _0x12816d, 'content': _0x5a11ee[_0x588129(0x75a)] }, _0x52f4da = !!_0x5a11ee[_0x588129(0x75a)], _0x2d4d42 = null; if (_0x5a11ee[_0x588129(0x98c)]) _0x2d4d42 = _0x5a11ee[_0x588129(0x98c)]; else { if (_0x5a11ee[_0x588129(0x5bb)]) try { const _0x264d87 = await _0xb9bbbf(_0x5a11ee[_0x588129(0x5bb)]); _0x264d87 && (_0x2d4d42 = await _0x2115c1(_0x264d87)); } catch (_0xbc5a7) { if ('qORqe' !== _0x588129(0x9ee)) console[_0x588129(0x11e)]('在准备群聊API数据时，读取图片失败:', _0xbc5a7); else { const _0x52d65b = _0x409d22[_0x588129(0x155)] === _0x3417d2(_0x6627c4['activeChatId'])['id'] ? _0x992f30(_0x172f3a[_0x588129(0x55f)]) : _0x41b37f(_0x3ccfa6[_0x588129(0x155)]); _0x1a70ae['assign'](_0x3e7ad3, { 'type': 'transfer', 'amount': _0x7d725a[_0x588129(0x5ca)], 'recipientId': _0x22d0de['recipientId'], 'content': _0x588129(0x689) + (_0x52d65b?.[_0x588129(0x695)] || '未知') + _0x588129(0x393) + _0xa00afd[_0x588129(0x5ca)] + ']' }); } } } _0x2d4d42 && (_0x588129(0x28c) !== 'EiAHj' ? _0x2169d5[_0x588129(0x988)](_0x588129(0x649), () => { const _0x2c4cce = _0x588129; if (_0x16aa0c[_0x2c4cce(0x280)] === 0x0) return; _0x4a0aca = (_0x194798 - 0x1 + _0x533725[_0x2c4cce(0x280)]) % _0x480b05[_0x2c4cce(0x280)], _0x144464(_0xfca42a[_0x102290], _0x51fd7a); }) : (_0x46b904[_0x588129(0x98c)] = _0x2d4d42, _0x52f4da = !![])), _0x52f4da && _0x5d1071[_0x588129(0x98f)](_0x46b904); } else { const _0x314542 = _0x348ece['transaction'](_0x431f40, _0x588129(0x77b)), _0xf1d52d = _0x314542[_0x588129(0x4bb)](_0xd3a948), _0x1c000e = _0xf1d52d[_0x588129(0x48f)](); _0x1c000e[_0x588129(0x804)] = () => _0x4a0fdc(_0x1c000e[_0x588129(0x211)]), _0x1c000e[_0x588129(0xaa9)] = () => _0x516cb3(_0x1c000e[_0x588129(0x11e)]); } } _0x5d1071[_0x588129(0x98f)]({ 'role': _0x588129(0x425), 'content': _0x588129(0x887) + JSON[_0x588129(0x3e1)](_0x4722aa) + _0x588129(0x449) + JSON[_0x588129(0x3e1)](_0x1a66e1) }); try { const _0x52aa1d = await _0x39cd5c(_0x5d1071, { 'json': !![] }); if (!_0x52aa1d) return null; let _0x424953 = _0x52aa1d[_0x588129(0x6eb)](); const _0x4266f9 = _0x424953[_0x588129(0x2a3)](/```json([\s\S]*?)```/i); if (_0x4266f9) _0x424953 = _0x4266f9[0x1][_0x588129(0x6eb)](); _0x424953 = _0x2fa02b(_0x424953); let _0x324571 = null; try { _0x588129(0x47a) === _0x588129(0x38d) ? _0x2906f9(_0x588129(0x9cb)) : _0x324571 = JSON[_0x588129(0xa69)](_0x424953); } catch (_0x184393) { console['error']('JSON\x20解析失败!\x20错误原因:', _0x184393), console[_0x588129(0x11e)]('收到的原始、有问题的文本:', _0x424953); } if (!_0x324571 || !Array[_0x588129(0x850)](_0x324571[_0x588129(0x572)])) return null; return _0x324571 = _0x4ef707(_0x324571, _0x240261, _0xed2912), _0x324571[_0x588129(0x572)] = _0x324571[_0x588129(0x572)][_0x588129(0x6d1)](0x0, _0x1e4808), _0x324571[_0x588129(0x572)][_0x588129(0x280)] ? _0x324571 : null; } catch (_0xba9960) { return _0xba9960[_0x588129(0x695)] !== 'AbortError' && console[_0x588129(0x11e)]('Failed\x20to\x20plan\x20group\x20replies:', _0xba9960), null; } } } function _0x402a0c() { const _0x3931c1 = _0x314838, _0x19770d = document['getElementById'](_0x3931c1(0x1e5)); _0x19770d[_0x3931c1(0x65e)] = ''; if (_0x13c410[_0x3931c1(0x67e)]['length'] === 0x0) { if ('neRdR' === _0x3931c1(0x68d)) { _0x19770d[_0x3931c1(0x65e)] = _0x3931c1(0xa09); return; } else _0x40ee8c['oncomplete'] = _0x3d1508, _0x2c828d['onerror'] = _0x2d78f4 => _0x435f39(_0x2d78f4[_0x3931c1(0x6d7)][_0x3931c1(0x11e)]); } _0x13c410[_0x3931c1(0x67e)][_0x3931c1(0x8c0)](_0xaf31d4 => { const _0x55e8b4 = _0x3931c1, _0x1122f8 = _0x13c410['userProfiles']['find'](_0x543454 => _0x543454['id'] === _0xaf31d4[_0x55e8b4(0x75d)]) || { 'name': _0x55e8b4(0x984) }, _0x43c65e = document['createElement'](_0x55e8b4(0xa8b)); _0x43c65e[_0x55e8b4(0x828)] = _0x55e8b4(0x4d5), _0x43c65e[_0x55e8b4(0x14b)]['id'] = _0xaf31d4['id'], _0x43c65e[_0x55e8b4(0x65e)] = _0x55e8b4(0x5a1) + _0xaf31d4['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20' + _0x1122f8[_0x55e8b4(0x695)] + _0x55e8b4(0xa25) + _0xaf31d4[_0x55e8b4(0x28a)][_0x55e8b4(0x280)] + _0x55e8b4(0x1fe), _0x43c65e[_0x55e8b4(0x988)]('click', () => _0x1b12f5(_0xaf31d4['id'])), _0x19770d[_0x55e8b4(0x3fd)](_0x43c65e); }); } function _0x236624(_0x3df19a = null) { const _0x1e5eac = _0x314838, _0x367f71 = document[_0x1e5eac(0x7d5)](_0x1e5eac(0x800)), _0x482101 = document[_0x1e5eac(0x7d5)](_0x1e5eac(0x92c)), _0x4177a1 = document[_0x1e5eac(0x7d5)]('friend-circle-member-selection'), _0x199777 = document['getElementById'](_0x1e5eac(0x15f)), _0x21eddd = document[_0x1e5eac(0x7d5)](_0x1e5eac(0x2a5)), _0x162de4 = document[_0x1e5eac(0x7d5)](_0x1e5eac(0x659)); _0x52ddde(_0x1e5eac(0x92c)), _0x4177a1['innerHTML'] = '', _0x13c410[_0x1e5eac(0x53a)][_0x1e5eac(0x8c0)](_0x2122b9 => { const _0x1da60a = _0x1e5eac, _0x1a88c3 = document['createElement'](_0x1da60a(0xa8b)); _0x1a88c3[_0x1da60a(0x828)] = _0x1da60a(0x4e2), _0x1a88c3[_0x1da60a(0x65e)] = _0x1da60a(0x726) + _0x2122b9['id'] + '\x22\x20data-id=\x22' + _0x2122b9['id'] + _0x1da60a(0x88f) + (_0x2122b9[_0x1da60a(0x907)] || _0x1c044f) + _0x1da60a(0x1b6) + _0x2122b9['id'] + '\x22\x20class=\x22char-name\x22>' + _0x2122b9[_0x1da60a(0x695)] + '</label>\x0a\x20\x20\x20\x20', _0x4177a1[_0x1da60a(0x3fd)](_0x1a88c3); }); if (_0x3df19a) { const _0x2377f0 = _0x13c410[_0x1e5eac(0x67e)][_0x1e5eac(0x9b9)](_0x40ba91 => _0x40ba91['id'] === _0x3df19a); if (!_0x2377f0) return; _0x199777[_0x1e5eac(0x9e0)] = '编辑好友圈', _0x21eddd[_0x1e5eac(0x4d3)] = _0x2377f0['id'], _0x367f71[_0x1e5eac(0x4d3)] = _0x2377f0[_0x1e5eac(0x695)], _0x482101[_0x1e5eac(0x4d3)] = _0x2377f0[_0x1e5eac(0x75d)], _0x162de4['style']['display'] = _0x1e5eac(0x10c), _0x2377f0[_0x1e5eac(0x28a)][_0x1e5eac(0x8c0)](_0x1a3f64 => { const _0x37e14e = _0x1e5eac, _0x394f97 = _0x4177a1[_0x37e14e(0x298)](_0x37e14e(0x5a0) + _0x1a3f64); if (_0x394f97) _0x394f97['checked'] = !![]; }); } else { if (_0x1e5eac(0x219) !== _0x1e5eac(0x2df)) _0x199777[_0x1e5eac(0x9e0)] = _0x1e5eac(0xa22), _0x21eddd[_0x1e5eac(0x4d3)] = '', _0x367f71[_0x1e5eac(0x4d3)] = _0x1e5eac(0x84a) + (_0x13c410[_0x1e5eac(0x67e)][_0x1e5eac(0x280)] + 0x1), _0x482101[_0x1e5eac(0x4d3)] = _0x13c410['activeUserProfileId'], _0x162de4['style'][_0x1e5eac(0x5f3)] = _0x1e5eac(0x794); else { const _0x1b0ac7 = _0x120617[_0x1e5eac(0x226)][_0x1e5eac(0x9b9)](_0x118a6b => _0x118a6b['id'] === _0x5473d8), _0x45fc30 = _0x1b0ac7?.['boundUserProfileId']; let _0x41d1d7 = _0x5bda02['userProfiles'][_0x1e5eac(0x9b9)](_0x9ed196 => _0x9ed196['id'] === _0x45fc30); return !_0x41d1d7 && (_0x41d1d7 = _0x18ddc3['userProfiles'][_0x1e5eac(0x9b9)](_0xbfe24e => _0xbfe24e['id'] === _0x2b3125['activeUserProfileId']) || _0x78bf63[_0x1e5eac(0x6ed)][0x0]), _0x41d1d7 || { 'name': '用户', 'avatar': _0x417fcb, 'persona': '' }; } } _0x384da8(_0x1e5eac(0x2d9), _0x1e5eac(0x5bd)); } function _0x54dd04() { const _0x1d6d06 = _0x314838; if (_0x1d6d06(0xa70) !== _0x1d6d06(0x77e)) { const _0x1ccb98 = document[_0x1d6d06(0x7d5)](_0x1d6d06(0x2a5))[_0x1d6d06(0x4d3)], _0x48be5e = document[_0x1d6d06(0x7d5)](_0x1d6d06(0x800))[_0x1d6d06(0x4d3)]['trim'](), _0x5d7786 = document[_0x1d6d06(0x7d5)]('friend-circle-edit-bind-user')['value'], _0x40c96f = Array['from'](document['querySelectorAll']('#friend-circle-member-selection\x20input:checked'))[_0x1d6d06(0x33d)](_0x14ab6b => _0x14ab6b[_0x1d6d06(0x14b)]['id']); if (!_0x48be5e) { _0x1e9edf(_0x1d6d06(0x831)); return; } if (_0x40c96f[_0x1d6d06(0x280)] === 0x0) { if (_0x1d6d06(0x694) !== _0x1d6d06(0x4c2)) { _0x1e9edf(_0x1d6d06(0xa5f)); return; } else { _0x471430(_0x1d6d06(0x24d)); return; } } if (_0x1ccb98) { if (_0x1d6d06(0x269) !== _0x1d6d06(0x4ed)) { const _0x5864f7 = _0x13c410[_0x1d6d06(0x67e)][_0x1d6d06(0x9b9)](_0x3392df => _0x3392df['id'] === _0x1ccb98); _0x5864f7 && ('yGAKc' !== _0x1d6d06(0x110) ? (_0x536fdd[_0x1d6d06(0x793)][_0x534153]['accepted'] = !![], _0x9fcf70()) : (_0x5864f7[_0x1d6d06(0x695)] = _0x48be5e, _0x5864f7[_0x1d6d06(0x75d)] = _0x5d7786, _0x5864f7[_0x1d6d06(0x28a)] = _0x40c96f)); } else _0x151fa1(![]), _0x413f37[_0x1d6d06(0x11e)](_0x1d6d06(0x7f1), _0x4f2023), _0xedb812('导出过程中发生严重错误:\x20' + _0x1afa9f[_0x1d6d06(0x496)]); } else { const _0x2670b9 = { 'id': _0x1d6d06(0x7e0) + Date[_0x1d6d06(0x2f2)](), 'name': _0x48be5e, 'boundUserProfileId': _0x5d7786, 'memberCharacterIds': _0x40c96f, 'posts': [] }; _0x13c410['friendCircles']['push'](_0x2670b9); } _0x5834f1(), _0x1e9edf('好友圈已保存！'), _0x402a0c(), _0x384da8(_0x1d6d06(0x5bd), _0x1d6d06(0x2d9)); } else { const _0x3cfe81 = _0x223381[_0x1d6d06(0xa30)](_0x1d6d06(0x115)); _0x3cfe81[_0x1d6d06(0x4d3)] = _0x5c9b42['id'], _0x3cfe81[_0x1d6d06(0x9e0)] = _0x12ee94[_0x1d6d06(0x695)], _0x5114e7[_0x1d6d06(0x3fd)](_0x3cfe81); } } async function _0x15e364() { const _0x6e43f3 = _0x314838; if ('FUVRy' !== _0x6e43f3(0x20c)) { const _0x3cb4ed = { 'characters': _0x99f050['characters'], 'worldBooks': _0x30eb50[_0x6e43f3(0x90d)], 'chats': _0x43afa1[_0x6e43f3(0x226)], 'userProfile': _0x5411b1[_0x6e43f3(0x787)], 'apiSettings': _0x39bf75[_0x6e43f3(0xa48)], 'preferences': _0x2d20db['preferences'], 'activeChatId': _0x2a61c6['activeChatId'], 'diaries': _0x4e0fb7['diaries'], 'friendCircles': _0x256970[_0x6e43f3(0x67e)], 'activeFriendCircleId': _0x455cd0[_0x6e43f3(0x6f0)], 'userProfiles': _0x3d0342[_0x6e43f3(0x6ed)], 'activeUserProfileId': _0x2ca7a0[_0x6e43f3(0x56d)], 'accountingData': _0x216a9e[_0x6e43f3(0x2e4)], 'accountingLedger': _0x1d5e1c[_0x6e43f3(0x246)] }; _0x387436[_0x6e43f3(0x629)](_0x6e43f3(0x156), _0x700d83[_0x6e43f3(0x3e1)](_0x3cb4ed)); } else { const _0x2f6a7a = document[_0x6e43f3(0x7d5)](_0x6e43f3(0x2a5))[_0x6e43f3(0x4d3)]; if (!_0x2f6a7a) return; const _0x25ce21 = await _0x39a14a(_0x6e43f3(0x67c)); _0x25ce21 && (_0x6e43f3(0x32e) === _0x6e43f3(0x32e) ? (_0x13c410[_0x6e43f3(0x67e)] = _0x13c410[_0x6e43f3(0x67e)][_0x6e43f3(0x61f)](_0x2ffe8e => _0x2ffe8e['id'] !== _0x2f6a7a), _0x13c410[_0x6e43f3(0x6f0)] === _0x2f6a7a && (_0x13c410[_0x6e43f3(0x6f0)] = null), _0x5834f1(), _0x1e9edf(_0x6e43f3(0x8ea)), _0x402a0c(), _0x384da8('friendCircleList', _0x6e43f3(0x2d9))) : (_0x6e82ab[_0x6e43f3(0x3fd)](_0x2a5857), _0x249d5e[_0x6e43f3(0x3fd)](_0x31f5cf))); } } function _0x1b12f5(_0x43a00b) { const _0x1db336 = _0x314838; _0x22fc65(); const _0x39bb3d = _0x13c410[_0x1db336(0x67e)][_0x1db336(0x9b9)](_0x2589f2 => _0x2589f2['id'] === _0x43a00b); if (!_0x39bb3d) return; _0x13c410[_0x1db336(0x6f0)] = _0x43a00b, _0x5834f1(), document[_0x1db336(0x7d5)]('friend-circle-title')[_0x1db336(0x9e0)] = _0x39bb3d[_0x1db336(0x695)], _0x80c141(), _0x384da8(_0x1db336(0x44d), 'friendCircleList'), _0x5c7610(); } function _0x3bbd63() { const _0x107942 = _0x314838; if ('UlCzx' !== _0x107942(0xa81)) _0x23cb47['push'](..._0x5e6ad9(_0x198f2a)); else { if (!_0x13c410['friendCircles'] || _0x13c410[_0x107942(0x67e)][_0x107942(0x280)] === 0x0) { if (_0x107942(0x894) !== _0x107942(0x1a6)) { console[_0x107942(0x11e)](_0x107942(0x911)); return; } else { _0x3b4730(_0x107942(0x92e)); return; } } const _0x57f5de = _0x13c410['friendCircles'][0x0]; if (_0x57f5de['memberCharacterIds'][_0x107942(0x280)] < 0x2) { console[_0x107942(0x11e)](_0x107942(0x350) + _0x57f5de[_0x107942(0x695)] + _0x107942(0x592)); return; } const _0x4eb586 = { 'id': _0x107942(0x240) + Date[_0x107942(0x2f2)](), 'authorType': _0x107942(0x65b), 'authorId': _0x57f5de[_0x107942(0x28a)][0x0], 'content': _0x107942(0x113), 'timestamp': Date[_0x107942(0x2f2)](), 'likes': [_0x57f5de[_0x107942(0x28a)][0x1]], 'comments': [{ 'commentId': 'c_' + Date[_0x107942(0x2f2)](), 'authorId': _0x57f5de[_0x107942(0x28a)][0x1], 'content': _0x107942(0x199) }] }; _0x57f5de[_0x107942(0xea)][_0x107942(0x98f)](_0x4eb586), _0x5834f1(), console[_0x107942(0x688)]('成功向好友圈\x20\x22' + _0x57f5de[_0x107942(0x695)] + _0x107942(0x1ef)), _0x1e9edf(_0x107942(0x994)); } } window['addTestPost'] = _0x3bbd63; function _0x3923e1(_0x3fe0e3) { const _0x5bdf6b = _0x314838; return _0x13c410[_0x5bdf6b(0x6ed)][_0x5bdf6b(0x9b9)](_0x2ca6ae => _0x2ca6ae['id'] === _0x3fe0e3); } function _0x1f66de(_0x341084, _0x4a7e12 = _0x314838(0x48b)) { const _0x5da21e = _0x314838, _0x601372 = document[_0x5da21e(0x7d5)](_0x5da21e(0x87a)); let _0x294fb0 = document[_0x5da21e(0x7d5)](_0x5da21e(0x5fb)); if (_0x341084) { if (_0x5da21e(0x59f) !== _0x5da21e(0x59f)) { _0x254e73['value'] = '#\x20记录是空的，没什么好总结的。'; return; } else { if (!_0x294fb0) { if (_0x5da21e(0x760) !== _0x5da21e(0x216)) _0x294fb0 = document[_0x5da21e(0xa30)]('div'), _0x294fb0['id'] = _0x5da21e(0x5fb), _0x601372[_0x5da21e(0x3fd)](_0x294fb0); else { if (!_0x141976[_0x5da21e(0x850)](_0x591583)) return _0x5da21e(0xa1a); if (_0xc6343c[_0x5da21e(0x280)] === 0x0) return _0x5da21e(0x7eb); return _0x5da21e(0xa91) + _0x37d366['map']((_0xc3b78c, _0x3fcf63) => _0x5da21e(0x38e) + (_0x3fcf63 < _0x945e71[_0x5da21e(0x280)] - 0x1 ? 'border-bottom:\x201px\x20solid\x20var(--border-color);' : '') + _0x5da21e(0x969) + (_0xc3b78c['description'] || _0x5da21e(0x88b)) + _0x5da21e(0x2ad) + (_0xc3b78c[_0x5da21e(0x921)] || '') + _0x5da21e(0x890))[_0x5da21e(0x8aa)]('') + _0x5da21e(0x447); } } _0x294fb0[_0x5da21e(0x65e)] = _0x5da21e(0x4ec) + _0x4a7e12 + _0x5da21e(0xec), _0x294fb0['style'][_0x5da21e(0x5f3)] = _0x5da21e(0x715); } } else _0x294fb0 && (_0x5da21e(0x456) === _0x5da21e(0x57d) ? (_0x4f32fc[_0x5da21e(0x9e0)] = _0x5da21e(0x7d3), _0x4ff61d['textContent'] = _0x5da21e(0x625), _0x486309['classList'][_0x5da21e(0x330)](_0x5da21e(0x22a)), _0x11014c[_0x5da21e(0x462)][_0x5da21e(0x81c)](_0x5da21e(0x272), _0x5da21e(0x794))) : _0x294fb0[_0x5da21e(0x462)][_0x5da21e(0x5f3)] = _0x5da21e(0x794)); } async function _0x589e04() { const _0x1d4046 = _0x314838, _0x59d6fc = _0x13c410[_0x1d4046(0x67e)]['find'](_0x3cb3d2 => _0x3cb3d2['id'] === _0x13c410['activeFriendCircleId']); if (!_0x59d6fc || _0x13c410[_0x1d4046(0x1e8)]) return; _0x1f66de(!![], _0x1d4046(0x2a2)), _0x13c410[_0x1d4046(0x1e8)] = !![]; try { if (_0x1d4046(0x42b) !== 'ezfnD') { let _0x53dc43 = Date[_0x1d4046(0x2f2)](); _0x59d6fc[_0x1d4046(0xea)] && _0x59d6fc[_0x1d4046(0xea)]['length'] > 0x0 && (_0x53dc43 = Math[_0x1d4046(0x1a5)](..._0x59d6fc[_0x1d4046(0xea)][_0x1d4046(0x33d)](_0x332d3b => _0x332d3b[_0x1d4046(0x921)]))); const _0x44bc9d = await _0xd2920f(_0x59d6fc); if (!_0x44bc9d || _0x44bc9d['length'] === 0x0) { _0x1e9edf(_0x1d4046(0x24c)); return; } const _0x360e68 = _0x44bc9d[_0x1d4046(0x33d)](async (_0x1eb04c, _0x3dd9a5) => { const _0x47eed = _0x1d4046; _0x1f66de(!![], _0x47eed(0x1ec) + (_0x3dd9a5 + 0x1) + '\x20/\x20' + _0x44bc9d['length'] + _0x47eed(0x8ff)); const _0x4f739c = _0x53dc43 + (_0x3dd9a5 + 0x1) * 0x3c * 0x3e8, _0x41ae78 = { 'id': _0x47eed(0x631) + _0x1eb04c['authorId'] + '_' + _0x4f739c, 'authorType': 'character', 'authorId': _0x1eb04c[_0x47eed(0x374)], 'content': _0x1eb04c['postContent'], 'timestamp': _0x4f739c, 'likes': _0x1eb04c[_0x47eed(0x435)] || [], 'comments': (_0x1eb04c[_0x47eed(0x826)] || [])['map']((_0x1fbf61, _0xff76eb) => ({ 'commentId': 'c_' + _0x4f739c + '_' + _0xff76eb, 'authorId': _0x1fbf61[_0x47eed(0x374)], 'content': _0x1fbf61[_0x47eed(0x75a)] })) }; if (_0x1eb04c['postType'] === _0x47eed(0x44d) && _0x1eb04c[_0x47eed(0x30d)] && _0x1eb04c[_0x47eed(0x376)]) try { if (_0x47eed(0x7e1) !== _0x47eed(0x73b)) { const _0x300fd7 = await _0x3b26b6(_0x1eb04c['songName'], _0x1eb04c[_0x47eed(0x376)]); _0x41ae78[_0x47eed(0x974)] = 'music', _0x41ae78[_0x47eed(0x30d)] = _0x1eb04c['songName'], _0x41ae78[_0x47eed(0x376)] = _0x1eb04c[_0x47eed(0x376)], _0x41ae78[_0x47eed(0x2e6)] = _0x300fd7[_0x47eed(0x45d)], _0x41ae78[_0x47eed(0x128)] = _0x300fd7[_0x47eed(0x570)]; } else _0x378596(_0x47eed(0x64c), 'musicUploadAltar'); } catch (_0xa8b11a) { if (_0x47eed(0x2c2) !== _0x47eed(0x29a)) console['error'](_0x47eed(0x41f), _0xa8b11a), _0x41ae78['type'] = _0x47eed(0x928); else { const _0x4f8ffd = _0x5cd8ef(_0x3a8dfd[_0x47eed(0x2c7)]); _0x4f8ffd && (delete _0x4f8ffd[_0x47eed(0x1e6)], _0x2aabc2(), _0x193707(_0x4f8ffd['id'], _0x47eed(0x6a9)), _0x8ea66e(_0x47eed(0x4d8)), _0x2f507f(!![])); } } else _0x41ae78[_0x47eed(0x974)] = 'text'; return _0x41ae78; }), _0x56287b = await Promise[_0x1d4046(0x7b1)](_0x360e68); _0x59d6fc['posts']['push'](..._0x56287b), _0x5834f1(); } else { const _0x2366dc = _0x456b37(_0xed0064[_0x1d4046(0x374)]); _0x2366dc && (_0x6ca2c8 = _0x2366dc['name'], _0xd62d3d = _0x2366dc[_0x1d4046(0x907)]); } } catch (_0x22c451) { console[_0x1d4046(0x11e)](_0x1d4046(0x8eb), _0x22c451), _0x1e9edf(_0x1d4046(0xa78) + _0x22c451[_0x1d4046(0x496)]); } finally { _0x80c141(), _0x1f66de(![]), _0x13c410['isGenerating'] = ![]; } } async function _0xd2920f(_0x3643d9) { const _0x3f433a = _0x314838, _0x31eafe = _0x3643d9[_0x3f433a(0x28a)]['map'](_0x15de48 => _0x1d08b4(_0x15de48))['filter'](Boolean); if (_0x31eafe[_0x3f433a(0x280)] === 0x0) return null; const _0x570d6a = _0x35b71c(), _0x39160d = _0x3923e1(_0x3643d9[_0x3f433a(0x75d)]) || _0x13c410[_0x3f433a(0x6ed)][0x0], _0xd70d3f = _0x39160d ? _0x3f433a(0x56c) + _0x39160d[_0x3f433a(0x695)] + _0x3f433a(0xa1f) + (_0x39160d[_0x3f433a(0x2a1)] || '无') + '\x0a' : '', _0x13d6ae = _0x31eafe[_0x3f433a(0x33d)](_0x2a0e8d => { const _0x2fcbad = _0x3f433a, { omniText: _0x54d50e } = _0x32d34b(_0x2a0e8d['id'], null), _0x2a3240 = _0x40d5ca(_0x2a0e8d['id']), _0x138a6a = _0x2a0e8d[_0x2fcbad(0x7d8)] && _0x2a0e8d[_0x2fcbad(0x7d8)][_0x2fcbad(0x280)] > 0x0 ? _0x2fcbad(0x8c3) + _0x2a0e8d[_0x2fcbad(0x695)] + _0x2fcbad(0x8f2) + _0x2a0e8d[_0x2fcbad(0x7d8)]['map'](_0x5cda61 => _0x13c410[_0x2fcbad(0x90d)][_0x2fcbad(0x9b9)](_0x281edd => _0x281edd['id'] === _0x5cda61))[_0x2fcbad(0x61f)](Boolean)[_0x2fcbad(0x33d)](_0x2ff521 => _0x2fcbad(0xa58) + _0x2ff521[_0x2fcbad(0x695)] + '\x0a' + _0x2ff521[_0x2fcbad(0x75a)])['join']('') : ''; return _0x2fcbad(0x798) + _0x2a0e8d[_0x2fcbad(0x695)] + _0x2fcbad(0x121) + _0x2a0e8d['id'] + '\x0a\x20\x20人设:\x20' + _0x2a0e8d[_0x2fcbad(0x2a1)] + '\x0a\x20\x20近期记忆:\x0a' + _0x54d50e + '\x0a' + _0x2a3240 + '\x0a' + _0x138a6a; })[_0x3f433a(0x8aa)]('\x0a\x0a'), _0x2a8ab4 = Math[_0x3f433a(0x66a)](Math[_0x3f433a(0x2a4)]() * 0x3) + 0x2, _0x4fb643 = _0x3f433a(0x6d9) + _0x2a8ab4 + '条】全新的、高质量的社交动态。\x0a\x0a#\x20好友圈成员信息\x0a' + _0x13d6ae + '\x0a' + _0xd70d3f + _0x3f433a(0x433) + _0x570d6a + _0x3f433a(0x8af) + _0x2a8ab4 + _0x3f433a(0x841) + _0x2a8ab4 + _0x3f433a(0x7e9), _0x52de72 = [{ 'role': _0x3f433a(0x711), 'content': _0x4fb643 }, { 'role': _0x3f433a(0x425), 'content': _0x3f433a(0x795) }]; _0x52de72['push']({ 'role': _0x3f433a(0x425), 'content': _0x3f433a(0x217) + _0x2a8ab4 + _0x3f433a(0x5f7) }); try { if (_0x3f433a(0x982) === _0x3f433a(0x8ca)) _0x4135d7['error'](_0x3f433a(0x8da), _0x2dd6b1, _0x3f433a(0x237), _0x380573), _0x13c49b[_0x3f433a(0x793)][_0x3f433a(0x98f)]({ 'role': _0x3f433a(0x9bb), 'senderId': _0x5507a3['id'], 'timestamp': _0x38d29c[_0x3f433a(0x2f2)](), 'isOffline': !![], 'content': _0x3f433a(0x7d6) + _0x195597 + ']' }); else { const _0x52bb10 = await _0x39cd5c(_0x52de72, { 'json': !![] }), _0x1e6dc6 = _0x52bb10['match'](/(\[[\s\S]*\])/); if (!_0x1e6dc6) throw new Error(_0x3f433a(0x86f)); const _0x2d5027 = _0x1e6dc6[0x1], _0x240c90 = JSON[_0x3f433a(0xa69)](_0x2d5027); if (!Array['isArray'](_0x240c90)) throw new Error(_0x3f433a(0x23c)); return _0x240c90; } } catch (_0x3ef0ce) { return console[_0x3f433a(0x11e)]('批量生成动态失败:\x20', _0x3ef0ce), console[_0x3f433a(0x11e)](_0x3f433a(0x50a), _0x3ef0ce[_0x3f433a(0x2f4)] || _0x3f433a(0x238)), null; } } async function _0x1b375f() { const _0x1da434 = _0x314838; if (_0x1da434(0x755) !== _0x1da434(0x4c5)) { const _0x35b870 = _0x13c410[_0x1da434(0x67e)][_0x1da434(0x9b9)](_0x3abcb5 => _0x3abcb5['id'] === _0x13c410[_0x1da434(0x6f0)]); if (!_0x35b870) return; const _0x406740 = await _0x39a14a(_0x1da434(0x4e7) + _0x35b870[_0x1da434(0x695)] + '”的所有动态吗？此操作不可撤销，且AI将不再记得这些内容。'); _0x406740 && (_0x35b870[_0x1da434(0xea)] = [], _0x5834f1(), _0x80c141(), _0x1e9edf(_0x1da434(0x230))); } else _0x242ab6[_0x1da434(0x4d3)] = _0x1b9302[_0x1da434(0x787)][_0x1da434(0x695)] || '', _0x57dc1f['src'] = _0x285398[_0x1da434(0x787)]['avatar'] || _0x187e61, _0x32ffaf['value'] = _0x3daabe['userProfile'][_0x1da434(0x2a1)] || ''; } function _0x80c141() { const _0x2c4b49 = _0x314838; if (_0x2c4b49(0xf9) !== _0x2c4b49(0xf9)) { const _0x2fb044 = _0x3783a3 ?? _0xae53ad[_0x2c4b49(0x4d3)][_0x2c4b49(0x6eb)](); if (_0x2fb044 === '' || !_0x2def70[_0x2c4b49(0x55f)]) return; const _0x551eaf = _0x35e690[_0x2c4b49(0x298)](_0x2c4b49(0x17c)), _0x5cdac4 = _0x551eaf['id'] === _0x2c4b49(0x5aa), _0x47a035 = { 'role': _0x2c4b49(0x425), 'content': _0x2fb044, 'timestamp': _0xdc4f38[_0x2c4b49(0x2f2)](), 'isOffline': _0x5cdac4 }; _0x2e296e[_0x2c4b49(0x5f2)] && (_0x47a035[_0x2c4b49(0x765)] = { ..._0x3dce82['activeQuote'] }), _0x5bd3a5[_0x2c4b49(0x793)][_0x2c4b49(0x98f)](_0x47a035), _0x111081(), _0x533fdc(), !_0x5e21e4 && (_0x5b83cd[_0x2c4b49(0x4d3)] = ''), _0x3ea682(); } else { const _0x2cb419 = document['getElementById']('music-feed-container'), _0x642470 = _0x13c410['friendCircles'][_0x2c4b49(0x9b9)](_0x27b787 => _0x27b787['id'] === _0x13c410[_0x2c4b49(0x6f0)]); if (!_0x642470) { _0x2cb419[_0x2c4b49(0x65e)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>'; return; } if (!_0x642470[_0x2c4b49(0xea)] || _0x642470[_0x2c4b49(0xea)]['length'] === 0x0) { if (_0x2c4b49(0x9cc) !== _0x2c4b49(0x666)) { _0x2cb419['innerHTML'] = _0x2c4b49(0x837); return; } else { if (_0x2e26ae) _0x2d1ac6(_0x4a698c); if (_0x379092[_0x2c4b49(0x1a8)]) return; _0x582029(() => { const _0xd7df1d = _0x2c4b49; _0x8181fd && _0x3ee9e0(_0x57f68f['id'], _0x1350a1[_0xd7df1d(0x33d)](_0x4db9c4 => _0x4db9c4['id'])); }, 0x32); } } _0x2cb419[_0x2c4b49(0x65e)] = ''; const _0x142761 = [..._0x642470[_0x2c4b49(0xea)]]['sort']((_0x11c423, _0x5e19fa) => _0x5e19fa[_0x2c4b49(0x921)] - _0x11c423['timestamp']); _0x142761[_0x2c4b49(0x8c0)](_0x46af46 => { const _0xc73b20 = _0x2c4b49, _0x41d16c = document[_0xc73b20(0xa30)](_0xc73b20(0xa8b)); _0x41d16c[_0xc73b20(0x828)] = _0xc73b20(0x549); let _0xc292c6 = '未知', _0x573f14 = _0x1c044f; if (_0x46af46['authorType'] === _0xc73b20(0x425)) { const _0x4ce719 = _0x3923e1(_0x46af46[_0xc73b20(0x374)]); _0x4ce719 && (_0xc292c6 = _0x4ce719[_0xc73b20(0x695)], _0x573f14 = _0x4ce719[_0xc73b20(0x907)]); } else { const _0x109603 = _0x1d08b4(_0x46af46[_0xc73b20(0x374)]); _0x109603 && (_0xc292c6 = _0x109603[_0xc73b20(0x695)], _0x573f14 = _0x109603[_0xc73b20(0x907)]); } const _0x5cb50b = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x573f14 + _0xc73b20(0xa27) + _0xc292c6 + _0xc73b20(0x89a), _0xc92b7b = _0xc73b20(0x477) + _0x46af46[_0xc73b20(0x75a)] + '</p>'; let _0x32d423 = ''; if (_0x46af46[_0xc73b20(0x98c)] || _0x46af46['imageId']) { const _0x4620ad = _0xc73b20(0x35f) + _0x46af46['id']; _0x32d423 = _0xc73b20(0x320) + _0x4620ad + _0xc73b20(0x575), setTimeout(() => { const _0x20df58 = _0xc73b20, _0x1949c2 = document[_0x20df58(0x7d5)](_0x4620ad); if (!_0x1949c2) return; if (_0x46af46['image']) _0x1949c2[_0x20df58(0x268)] = _0x46af46[_0x20df58(0x98c)]; else _0x46af46[_0x20df58(0x5bb)] && _0xb9bbbf(_0x46af46[_0x20df58(0x5bb)])[_0x20df58(0x834)](_0x4774a4 => { const _0xd52fee = _0x20df58; if (_0x4774a4) { if (_0xd52fee(0x279) !== 'tYYqz') { const _0x1be71e = URL[_0xd52fee(0x602)](_0x4774a4); _0x1949c2[_0xd52fee(0x268)] = _0x1be71e, _0x1949c2[_0xd52fee(0x3a5)] = () => URL[_0xd52fee(0x918)](_0x1be71e); } else _0x3bd0ad[_0xd52fee(0x9e0)] = _0x3e15d3[_0xd52fee(0x31c)] === _0xd52fee(0x2a6) ? '旁白' : _0x130f9a[_0xd52fee(0x31c)], _0x3cc976[_0xd52fee(0x9e0)] = _0x4c3fd2[_0xd52fee(0x56f)], _0x51f302[_0xd52fee(0x31c)] === _0xb62d64[_0xd52fee(0x695)] ? _0x456452(_0x2a2958, _0x42f587['emotion']) : _0x193210(_0x13fa9b, _0xd52fee(0x6a9)); } }); }, 0x0); } let _0x595d52 = ''; _0x46af46[_0xc73b20(0x974)] === _0xc73b20(0x44d) && _0x46af46[_0xc73b20(0x30d)] && (_0x595d52 = '\x0a\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22' + _0x46af46['id'] + _0xc73b20(0x7c5) + (_0x46af46[_0xc73b20(0x2e6)] || _0x1c044f) + _0xc73b20(0x906) + _0x46af46[_0xc73b20(0x30d)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x46af46[_0xc73b20(0x376)] + _0xc73b20(0x68e) + (_0x46af46[_0xc73b20(0x128)] ? '▶' : '⚠') + _0xc73b20(0x471)); const _0x859583 = _0xc73b20(0x8d8) + new Date(_0x46af46[_0xc73b20(0x921)])['toLocaleString'](_0xc73b20(0x14d)) + _0xc73b20(0x447); let _0x7bf091 = ''; if (_0x46af46[_0xc73b20(0x435)] && _0x46af46[_0xc73b20(0x435)][_0xc73b20(0x280)] > 0x0 || _0x46af46['comments'] && _0x46af46[_0xc73b20(0x826)]['length'] > 0x0) { let _0x4b936a = ''; if (_0x46af46[_0xc73b20(0x435)] && _0x46af46[_0xc73b20(0x435)]['length'] > 0x0) { const _0x47caff = _0x46af46[_0xc73b20(0x435)]['map'](_0x5cea04 => _0x1d08b4(_0x5cea04)?.[_0xc73b20(0x695)] || '未知')[_0xc73b20(0x8aa)]('、'), _0x11c491 = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>'; _0x4b936a = _0xc73b20(0x407) + _0x11c491 + '\x20' + _0x47caff + '</div>'; } let _0x594df7 = ''; if (_0x46af46['comments'] && _0x46af46[_0xc73b20(0x826)][_0xc73b20(0x280)] > 0x0) { const _0xed3d20 = _0x46af46['comments'][_0xc73b20(0x33d)](_0x38c7ce => { const _0x29405a = _0xc73b20; if (_0x29405a(0x4eb) === _0x29405a(0x9b6)) _0x1cef88 = [..._0x1b11a3, ..._0x30d771]; else { const _0x4cd694 = _0x1d08b4(_0x38c7ce[_0x29405a(0x374)])?.[_0x29405a(0x695)] || '未知'; return _0x29405a(0xa72) + _0x4cd694 + _0x29405a(0x84d) + _0x38c7ce[_0x29405a(0x75a)] + '</div>'; } })[_0xc73b20(0x8aa)](''); _0x594df7 = _0xc73b20(0x101) + _0xed3d20 + _0xc73b20(0x447); } _0x7bf091 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x4b936a + _0xc73b20(0x543) + _0x594df7 + _0xc73b20(0x117); } const _0x3199dc = _0xc73b20(0x31b) + _0xc92b7b + _0x32d423 + _0x595d52 + '</div>'; _0x41d16c[_0xc73b20(0x65e)] = _0x5cb50b + _0x3199dc + _0x859583 + _0x7bf091; if (_0x46af46['type'] === _0xc73b20(0x44d) && _0x46af46[_0xc73b20(0x128)]) { const _0x70197c = _0x41d16c[_0xc73b20(0x298)](_0xc73b20(0xa42)); _0x70197c && _0x70197c[_0xc73b20(0x988)]('click', function () { const _0x2d6037 = { 'id': _0x46af46['id'], 'url': _0x46af46['playableUrl'] }; _0x3d4c2b(this, _0x2d6037); }); } _0x2cb419[_0xc73b20(0x3fd)](_0x41d16c); }); } } document[_0x314838(0x7d5)](_0x314838(0x24b))['addEventListener'](_0x314838(0x649), _0x1b375f), document['getElementById']('refresh-feed-button')[_0x314838(0x988)]('click', _0x589e04), document[_0x314838(0x7d5)](_0x314838(0xa3d))[_0x314838(0x988)](_0x314838(0x649), () => _0x384da8('home', 'friendCircleList')), document['getElementById']('add-friend-circle-button')['addEventListener'](_0x314838(0x649), () => _0x236624()), document[_0x314838(0x7d5)]('back-to-circle-list-from-edit')[_0x314838(0x988)](_0x314838(0x649), () => _0x384da8('friendCircleList', 'friendCircleEdit')), document[_0x314838(0x7d5)](_0x314838(0x9ed))[_0x314838(0x988)](_0x314838(0x649), _0x54dd04), document[_0x314838(0x7d5)](_0x314838(0x659))['addEventListener'](_0x314838(0x649), _0x15e364), document[_0x314838(0x7d5)](_0x314838(0x49d))[_0x314838(0x988)]('click', () => { const _0x296329 = _0x314838; _0x402a0c(), _0x384da8('friendCircleList', _0x296329(0x44d)); }), document[_0x314838(0x7d5)](_0x314838(0x9a1))[_0x314838(0x988)](_0x314838(0x649), () => { const _0x32940d = _0x314838; _0x13c410['activeFriendCircleId'] && _0x236624(_0x13c410[_0x32940d(0x6f0)]); }), document[_0x314838(0x7d5)](_0x314838(0x2eb))[_0x314838(0x988)](_0x314838(0x649), async () => { const _0x470412 = _0x314838, _0x1799ae = _0x13c410['friendCircles'][_0x470412(0x9b9)](_0x2d2079 => _0x2d2079['id'] === _0x13c410[_0x470412(0x6f0)]); if (!_0x1799ae || _0x13c410['isGenerating']) return; const _0x45bf2c = _0x1799ae[_0x470412(0x75d)], _0xb6d06c = _0x13c410[_0x470412(0x6ed)][_0x470412(0x9b9)](_0x343495 => _0x343495['id'] === _0x45bf2c); if (!_0xb6d06c) { if (_0x470412(0xfe) !== 'RpUSe') _0x330ba7 = '你的任务是【首次生成】这个应用的内容。'; else { _0x1e9edf(_0x470412(0xa3a)); return; } } const _0x4b34a5 = document[_0x470412(0x7d5)](_0x470412(0x3f4))[_0x470412(0x4d3)][_0x470412(0x6eb)](), _0x3067e5 = _0x13c410[_0x470412(0x531)][_0x470412(0x98c)], _0x22a639 = _0x13c410[_0x470412(0x531)]['music'], _0x40a5ac = _0x13c410[_0x470412(0x531)][_0x470412(0x5bb)]; if (!_0x4b34a5 && !_0x3067e5 && !_0x22a639) { _0x1e9edf(_0x470412(0x8d6)); return; } const _0x90b8ed = { 'id': _0x470412(0x4e3) + Date['now'](), 'authorType': _0x470412(0x425), 'authorId': _0xb6d06c['id'], 'content': _0x4b34a5, 'timestamp': Date[_0x470412(0x2f2)](), 'likes': [], 'comments': [] }; if (_0x40a5ac) _0x90b8ed[_0x470412(0x5bb)] = _0x40a5ac; else { if (_0x3067e5) { if (_0x470412(0x311) !== _0x470412(0x82f)) _0x90b8ed[_0x470412(0x98c)] = _0x3067e5; else { _0x423032['conversationHistory'] = [], _0x59de54(); return; } } } _0x22a639 ? (_0x90b8ed[_0x470412(0x974)] = _0x470412(0x44d), Object[_0x470412(0x6e9)](_0x90b8ed, _0x22a639)) : _0x470412(0x4bf) !== _0x470412(0x8d7) ? _0x90b8ed[_0x470412(0x974)] = _0x470412(0x928) : _0x1ca124['error'](_0x470412(0x668), _0x35f0af), _0x1799ae['posts'][_0x470412(0x98f)](_0x90b8ed), _0x5834f1(), _0x80c141(), document[_0x470412(0x7d5)](_0x470412(0x3f4))[_0x470412(0x4d3)] = '', _0x13c410['pendingPostAttachments'][_0x470412(0x98c)] = null, _0x13c410[_0x470412(0x531)][_0x470412(0x44d)] = null, _0x13c410[_0x470412(0x531)]['imageId'] = null, _0x356933(), _0x46af84(_0x90b8ed); }), document['getElementById'](_0x314838(0x986))[_0x314838(0x988)]('click', () => { const _0xd7c70c = _0x314838; _0xd7c70c(0x7c6) === _0xd7c70c(0x7c6) ? document[_0xd7c70c(0x7d5)](_0xd7c70c(0x26d))[_0xd7c70c(0x649)]() : _0x13fcbe[_0xd7c70c(0x501)] && _0x28c779[_0xd7c70c(0x501)][_0xd7c70c(0x5f4)] === _0x226d84 && (_0x53d2da[_0xd7c70c(0x501)] = null); }), document['getElementById'](_0x314838(0x26d))[_0x314838(0x988)](_0x314838(0x458), async _0x2f7054 => { const _0x5ab9ab = _0x314838, _0x55288d = _0x2f7054[_0x5ab9ab(0x6d7)]['files'][0x0]; if (!_0x55288d) return; try { const _0x1e6951 = await _0x39f7a8(_0x55288d, 0x320, 0.8, !![]), _0x3abdee = _0x5ab9ab(0x484) + Date['now'](); await _0x4162d1(_0x3abdee, _0x1e6951), _0x13c410[_0x5ab9ab(0x531)][_0x5ab9ab(0x5bb)] = _0x3abdee, _0x13c410['pendingPostAttachments'][_0x5ab9ab(0x98c)] = null, _0x13c410['pendingPostAttachments']['music'] = null, _0x356933(); } catch (_0x27096e) { _0x1e9edf(_0x5ab9ab(0x506) + _0x27096e[_0x5ab9ab(0x496)]); } _0x2f7054['target'][_0x5ab9ab(0x4d3)] = ''; }), document[_0x314838(0x7d5)](_0x314838(0x3c4))[_0x314838(0x988)](_0x314838(0x649), async () => { const _0x22ac30 = _0x314838; if (_0x22ac30(0x399) === 'rxIKV') _0x116156 = _0x46fb4e[_0x22ac30(0x695)], _0x3487cc = _0x1a228a[_0x22ac30(0x907)]; else { const _0x5ebc7b = await _0x33e0fe(); if (!_0x5ebc7b) return; _0x1e9edf(_0x22ac30(0x9ae)); try { const _0x4b690a = await _0x3b26b6(_0x5ebc7b[_0x22ac30(0x30d)], _0x5ebc7b[_0x22ac30(0x376)]); _0x13c410[_0x22ac30(0x531)][_0x22ac30(0x44d)] = { 'songName': _0x5ebc7b[_0x22ac30(0x30d)], 'artist': _0x5ebc7b[_0x22ac30(0x376)], 'coverUrl': _0x4b690a[_0x22ac30(0x45d)], 'playableUrl': _0x4b690a[_0x22ac30(0x570)] }, _0x13c410[_0x22ac30(0x531)][_0x22ac30(0x98c)] = null, _0x356933(); } catch (_0x1ee353) { _0x1e9edf(_0x22ac30(0x63d) + _0x1ee353[_0x22ac30(0x496)]); } } }); function _0x28dbfd() { const _0x199102 = _0x314838, _0x3634e8 = new Date(), _0x3178c5 = document[_0x199102(0x7d5)](_0x199102(0x96d)), _0x243b82 = document['getElementById'](_0x199102(0x5e6)); if (_0x3178c5 && _0x243b82) { const _0x5da82f = String(_0x3634e8[_0x199102(0x936)]())[_0x199102(0x380)](0x2, '0'), _0x2d8406 = String(_0x3634e8[_0x199102(0x546)]())[_0x199102(0x380)](0x2, '0'); _0x3178c5[_0x199102(0x9e0)] = _0x5da82f + ':' + _0x2d8406; const _0x4e54df = _0x3634e8[_0x199102(0x550)]() + 0x1, _0x307f7c = _0x3634e8[_0x199102(0x1a4)](), _0x37f088 = [_0x199102(0x730), _0x199102(0x8fe), _0x199102(0xa2b), _0x199102(0xa4a), _0x199102(0x459), _0x199102(0x4a0), _0x199102(0x937)][_0x3634e8[_0x199102(0x6b9)]()]; _0x243b82['textContent'] = _0x4e54df + '月' + _0x307f7c + '日\x20' + _0x37f088; } } function _0x1c42da(_0x3c67bb) { const _0x36348d = _0x314838; if (!_0x3c67bb) return ''; const _0x56f9f7 = new Date(_0x3c67bb), _0x45a865 = String(_0x56f9f7[_0x36348d(0x936)]())[_0x36348d(0x380)](0x2, '0'), _0x3340e9 = String(_0x56f9f7['getMinutes']())[_0x36348d(0x380)](0x2, '0'); return _0x45a865 + ':' + _0x3340e9; } function _0x35b71c() { const _0x397fea = _0x314838; if ('tNJLV' === _0x397fea(0x365)) _0x2cb9f1[_0x751fdb[_0x452dd9]] = _0x9dac5e; else { const _0x4b7bda = _0x13c410['friendCircles'][_0x397fea(0x9b9)](_0x51030a => _0x51030a['id'] === _0x13c410[_0x397fea(0x6f0)]), _0x56f76d = _0x4b7bda ? _0x4b7bda[_0x397fea(0xea)] : []; if (!_0x56f76d || _0x56f76d[_0x397fea(0x280)] === 0x0) { if (_0x397fea(0x6e5) !== _0x397fea(0x6e5)) { if (!_0x578658[_0x397fea(0x78f)]) return _0x452cc9['userProfiles'][_0x397fea(0x9b9)](_0x1be9e9 => _0x1be9e9['id'] === _0x2059a2['activeUserProfileId']) || _0x389092['userProfiles'][0x0]; const _0x5dadc8 = _0x24e846[_0x397fea(0x226)]['find'](_0x12d204 => _0x12d204[_0x397fea(0x974)] === _0x397fea(0x293) && _0x12d204[_0x397fea(0x9c8)]['includes'](_0x2b4768[_0x397fea(0x78f)])), _0x163156 = _0x5dadc8?.[_0x397fea(0x75d)] || _0x57eb8b[_0x397fea(0x56d)]; return _0x3df392['userProfiles'][_0x397fea(0x9b9)](_0x365096 => _0x365096['id'] === _0x163156) || _0x2196e0['userProfiles'][0x0]; } else return ''; } const _0x596434 = _0x56f76d[_0x397fea(0x6d1)](0x0, 0x5), _0x297aa4 = _0x596434['map'](_0x474660 => { const _0x84fd88 = _0x397fea, _0xa6ab00 = _0x1d08b4(_0x474660[_0x84fd88(0x374)]) || { 'name': '未知' }; let _0x174ca0 = _0x84fd88(0x94c) + _0xa6ab00[_0x84fd88(0x695)] + '\x20说：“' + (_0x474660['thought'] || _0x474660[_0x84fd88(0x75a)]) + '”'; return _0x474660[_0x84fd88(0x974)] === _0x84fd88(0x44d) && (_0x174ca0 += _0x84fd88(0x8ce) + _0x474660[_0x84fd88(0x30d)] + _0x84fd88(0xa41) + _0x474660[_0x84fd88(0x376)] + ')'), _0x174ca0; }); return _0x397fea(0x7fa) + _0x297aa4[_0x397fea(0x8aa)]('\x0a'); } } function _0x40d5ca(_0x2dc6e8) { const _0x574a84 = _0x314838, _0x279dfd = _0x13c410['userProfiles'][_0x574a84(0x9b9)](_0x109640 => _0x109640['id'] === _0x13c410[_0x574a84(0x56d)]) || { 'name': '你' }, _0x245192 = _0x13c410[_0x574a84(0x324)][_0x574a84(0x9b9)](_0x508039 => _0x508039[_0x574a84(0x951)] === _0x2dc6e8); if (!_0x245192 || !_0x245192[_0x574a84(0x46c)] || _0x245192['entries']['length'] === 0x0) return ''; const _0x54fe1c = _0x245192['entries']['slice'](-0x8), _0x5f4162 = _0x54fe1c[_0x574a84(0x33d)](_0x4d248a => { const _0x87ef7a = _0x574a84, _0x53cc33 = _0x4d248a[_0x87ef7a(0x6d2)] === _0x87ef7a(0x425) ? _0x279dfd[_0x87ef7a(0x695)] : _0x1d08b4(_0x4d248a[_0x87ef7a(0x6d2)])['name']; return _0x87ef7a(0x410) + new Date(_0x4d248a[_0x87ef7a(0x921)])[_0x87ef7a(0x116)]() + ']\x20' + _0x53cc33 + '\x20写道:\x20' + _0x4d248a['content']; })[_0x574a84(0x8aa)]('\x0a'); return _0x574a84(0x2f3) + _0x279dfd['name'] + _0x574a84(0x73d) + _0x5f4162; } function _0x20f90c() { const _0x37ea5e = _0x314838, _0x28eb44 = document[_0x37ea5e(0x7d5)](_0x37ea5e(0x196)), _0x4dfff2 = _0x13c410['preferences'][_0x37ea5e(0x552)]; _0x4dfff2 ? (_0x28eb44[_0x37ea5e(0x462)][_0x37ea5e(0x97e)] = _0x37ea5e(0x408) + _0x4dfff2 + ')', _0x28eb44['style'][_0x37ea5e(0x6b5)] = 'cover', _0x28eb44[_0x37ea5e(0x462)][_0x37ea5e(0x697)] = _0x37ea5e(0x2a0), _0x28eb44[_0x37ea5e(0x462)][_0x37ea5e(0x673)] = 'white', _0x28eb44['querySelectorAll']('.widget-info\x20>\x20div')['forEach'](_0x517ff8 => { const _0x3dd6b7 = _0x37ea5e; _0x517ff8[_0x3dd6b7(0x462)]['textShadow'] = _0x3dd6b7(0x133); })) : (_0x28eb44[_0x37ea5e(0x462)]['backgroundImage'] = '', _0x28eb44[_0x37ea5e(0x462)][_0x37ea5e(0x673)] = '', _0x28eb44['querySelectorAll'](_0x37ea5e(0x14a))[_0x37ea5e(0x8c0)](_0x5c8a01 => { const _0x42c735 = _0x37ea5e; 'hhRNK' === _0x42c735(0x8f9) ? _0x206f3a += '-\x20**状态提示**:\x20这是你和' + _0x249ea2['name'] + _0x42c735(0x7e7) : _0x5c8a01['style'][_0x42c735(0x4f6)] = ''; })); } const _0x345cd8 = document[_0x314838(0x7d5)](_0x314838(0x693)), _0x2c6cec = document[_0x314838(0x7d5)](_0x314838(0x75b)); _0x345cd8[_0x314838(0x988)](_0x314838(0x649), () => { const _0x156d31 = _0x314838; _0x402a0c(), _0x384da8(_0x156d31(0x5bd), _0x156d31(0x73e)); }), _0x2c6cec['addEventListener'](_0x314838(0x649), () => { const _0x2e574a = _0x314838; _0x2e574a(0x50f) === 'KyZzs' ? (_0x58e773(), _0x384da8('meetingList', _0x2e574a(0x73e))) : _0x524d6c(); }), document['getElementById'](_0x314838(0x4df))[_0x314838(0x988)](_0x314838(0x649), () => { const _0x5a4da5 = _0x314838; _0x5a4da5(0x3bf) !== _0x5a4da5(0x3bf) ? _0x794c54[_0x5a4da5(0x338)] = ![] : _0x384da8(_0x5a4da5(0x73e), 'meetingList'); }), document['getElementById'](_0x314838(0x11b))[_0x314838(0x988)](_0x314838(0x649), () => { const _0x583652 = _0x314838; if (_0x2a6a1f) clearInterval(_0x2a6a1f); _0x2a6a1f = null, _0x13c410[_0x583652(0x12e)] = [], _0x13c410['activeMeetingCharId'] = null, document[_0x583652(0x7d5)]('galgame-sprite-adjust-ui')[_0x583652(0x462)][_0x583652(0x5f3)] = _0x583652(0x794), _0x13c410[_0x583652(0x55f)] = null, _0x5834f1(), _0x384da8('meetingList', _0x583652(0x96b)); }); const _0xac7505 = document[_0x314838(0x7d5)](_0x314838(0x3ed)), _0x5bab27 = document[_0x314838(0x7d5)]('meeting-send-button'); _0x5bab27[_0x314838(0x988)]('click', () => { const _0x3475ee = _0x314838, _0x5723a0 = _0xac7505[_0x3475ee(0x4d3)]['trim'](); _0x5723a0 && (_0x282af7(_0x5723a0), _0xac7505[_0x3475ee(0x4d3)] = '', setTimeout(_0x4d5866, 0x64)); }); function _0x3d4c2b(_0x505ea5, _0x1c5c66) { const _0x361bd3 = _0x314838, _0x336286 = document[_0x361bd3(0x7d5)](_0x361bd3(0x884)), _0xda4bed = document[_0x361bd3(0x83d)]('.music-post-play-icon,\x20.music-share-play-icon'); _0xda4bed['forEach'](_0x3a89db => { const _0x275d81 = _0x361bd3; _0x3a89db !== _0x505ea5['querySelector'](_0x275d81(0x466)) && (_0x3a89db[_0x275d81(0x9e0)] = '▶'); }), _0x336286['src'] === _0x1c5c66[_0x361bd3(0x570)] && !_0x336286[_0x361bd3(0x327)] ? _0x361bd3(0x29d) !== 'iduan' ? (_0x4dc224['chats'] = _0x4ecbf0[_0x361bd3(0x226)], _0x13f00b[_0x361bd3(0x55f)] = _0x33d860[_0x361bd3(0x55f)] || null) : (_0x336286[_0x361bd3(0x993)](), _0x505ea5[_0x361bd3(0x298)](_0x361bd3(0x466))[_0x361bd3(0x9e0)] = '▶') : 'jNJMn' === _0x361bd3(0x23d) ? (_0x336286[_0x361bd3(0x268)] = _0x1c5c66[_0x361bd3(0x570)], _0x336286[_0x361bd3(0x5c0)](), _0x505ea5[_0x361bd3(0x298)](_0x361bd3(0x466))[_0x361bd3(0x9e0)] = '❚❚') : (_0x2db315 = _0x4511a8['createElement'](_0x361bd3(0x462)), _0x1484b8['id'] = 'style-' + _0x5381ff['id'], _0x249ef0[_0x361bd3(0x33f)][_0x361bd3(0x3fd)](_0x403390)); } const _0x1ee2c6 = document[_0x314838(0x7d5)](_0x314838(0x626)); async function _0x4d95a0(_0x4874cc) { const _0x3a0e01 = _0x314838; if (!_0x4874cc || !_0x4874cc['startsWith'](_0x3a0e01(0x239))) return ![]; return new Promise(_0x196c18 => { const _0x21d78b = _0x3a0e01, _0x34b48f = document['createElement'](_0x21d78b(0x7b6)); _0x34b48f[_0x21d78b(0x268)] = _0x4874cc; const _0x7e2876 = setTimeout(() => { _0x2ceab4(), _0x196c18(![]); }, 0xbb8), _0x2ceab4 = () => { const _0x30210f = _0x21d78b; clearTimeout(_0x7e2876), _0x34b48f[_0x30210f(0x7f6)]('canplaythrough', _0x1dd849), _0x34b48f[_0x30210f(0x7f6)](_0x30210f(0x11e), _0x458764), _0x34b48f[_0x30210f(0x268)] = '', _0x34b48f['remove'](); }, _0x1dd849 = () => { const _0x312f36 = _0x21d78b; _0x312f36(0x762) === _0x312f36(0x762) ? (_0x2ceab4(), _0x196c18(!![])) : _0x5c21be[_0x312f36(0x7ec)]('chatHistory_' + _0x2f8ac1); }, _0x458764 = () => { const _0x2e7871 = _0x21d78b; _0x2e7871(0x72e) === _0x2e7871(0x72e) ? (_0x2ceab4(), _0x196c18(![])) : _0x6e74b1[_0x2e7871(0x98f)](_0xc3a757['id']); }; _0x34b48f[_0x21d78b(0x988)](_0x21d78b(0x17b), _0x1dd849), _0x34b48f['addEventListener'](_0x21d78b(0x11e), _0x458764); }); } async function _0x3b26b6(_0x1c5541, _0x111b81) { const _0xe8700f = _0x314838; if (_0xe8700f(0x1ac) !== 'srSDj') { const _0x1e0695 = ['netease', _0xe8700f(0x3b5)]; for (const _0x4f88da of _0x1e0695) { try { const _0x49c367 = 'https://api.vkeys.cn/v2/music/' + _0x4f88da + _0xe8700f(0x514) + encodeURIComponent(_0x1c5541) + '-' + encodeURIComponent(_0x111b81), _0x505de1 = await fetch(_0x49c367), _0x45d793 = await _0x505de1[_0xe8700f(0x32c)](); if (_0x45d793[_0xe8700f(0x82e)] !== 0xc8 || !_0x45d793[_0xe8700f(0x9c1)] || _0x45d793['data'][_0xe8700f(0x280)] === 0x0) continue; const _0xbc3384 = _0x45d793['data'][_0xe8700f(0x6d1)](0x0, 0x5); for (const _0x19dd68 of _0xbc3384) { if (_0xe8700f(0x6a3) === _0xe8700f(0x47d)) _0x502d52[_0xe8700f(0x462)][_0xe8700f(0x4f6)] = _0xe8700f(0x133); else { const _0x5c836b = _0xe8700f(0x98d) + _0x4f88da + '?id=' + _0x19dd68['id'], _0x2242eb = await fetch(_0x5c836b), _0x260f8c = await _0x2242eb[_0xe8700f(0x32c)](), _0x2f42e7 = _0x260f8c[_0xe8700f(0x9c1)]?.['url']; if (await _0x4d95a0(_0x2f42e7)) return { 'url': _0x2f42e7, 'cover': _0x19dd68['cover'], 'source': _0x4f88da }; } } } catch (_0x4b9929) { console['error'](_0xe8700f(0x71b) + _0x4f88da + ':', _0x4b9929); } } return { 'url': null, 'cover': null, 'source': null }; } else _0x4361ec(_0x5a6c80[_0xe8700f(0x77d)](_0x41a118, _0x1c224c)); } function _0x1a6aa9(_0x4405ac) { const _0x3c96b9 = _0x314838; try { const _0x488e29 = JSON[_0x3c96b9(0xa69)](localStorage[_0x3c96b9(0x310)](_0x3c96b9(0x49b)) || '{}'), _0x36f94b = { ..._0x488e29, ..._0x4405ac }; localStorage['setItem']('badgeState', JSON[_0x3c96b9(0x3e1)](_0x36f94b)); } catch (_0x2425cf) { console[_0x3c96b9(0x11e)](_0x3c96b9(0x7e4), _0x2425cf); } } async function _0x449023() { const _0x524234 = _0x314838, _0x50b56e = document[_0x524234(0x7d5)](_0x524234(0x6be)), _0x464afb = document[_0x524234(0x7d5)]('badge-image'); try { let _0x4e10cd = await _0xb9bbbf(_0x524234(0x657)); if (!_0x4e10cd) { const _0x478ca1 = JSON[_0x524234(0xa69)](localStorage['getItem'](_0x524234(0x49b)) || '{}'); _0x478ca1[_0x524234(0x98c)] && ('dKNbi' !== _0x524234(0x819) ? (console['log']('正在搬运旧徽章...'), _0x4e10cd = await _0x4904fe(_0x478ca1['image']), await _0x4162d1('widget_badge', _0x4e10cd)) : _0x444b95['scrollTop'] = _0x136294['scrollHeight']); } _0x4e10cd ? (_0x464afb[_0x524234(0x268)] = URL['createObjectURL'](_0x4e10cd), _0x50b56e[_0x524234(0x462)][_0x524234(0x5f3)] = _0x524234(0x10c)) : _0x524234(0x9e5) !== _0x524234(0x213) ? _0x50b56e[_0x524234(0x462)]['display'] = _0x524234(0x10c) : _0x3dbda2(_0x1c1b29['id'], _0x2e67ee[_0x524234(0x33d)](_0x5501c0 => _0x5501c0['id'])); } catch (_0x1cd9d3) { console['error'](_0x524234(0x740), _0x1cd9d3); } } function _0x17b64e(_0x13978c) { const _0x3289bf = _0x314838; if (_0x3289bf(0x40a) === _0x3289bf(0x40a)) try { const _0x2765e2 = JSON[_0x3289bf(0xa69)](localStorage['getItem']('cardWidgetState') || '{}'), _0x106aad = { ..._0x2765e2, ..._0x13978c }; localStorage[_0x3289bf(0x629)](_0x3289bf(0x2cd), JSON[_0x3289bf(0x3e1)](_0x106aad)); } catch (_0x8b2471) { console[_0x3289bf(0x11e)](_0x3289bf(0x43e), _0x8b2471); } else _0x4cb564 += _0x15f8ad[_0x3289bf(0xa69)](_0x59a443)[_0x3289bf(0xa06)][0x0][_0x3289bf(0x75a)]['parts'][0x0]['text']; } async function _0x10606e() { const _0x49661f = _0x314838; if ('unNGp' === _0x49661f(0x6b6)) { const _0xe5d0e5 = document[_0x49661f(0x7d5)]('card-widget'), _0x5910f7 = document[_0x49661f(0x7d5)](_0x49661f(0x690)); try { let _0x48ab46 = await _0xb9bbbf(_0x49661f(0x1b9)); if (!_0x48ab46) { const _0x3adbc6 = JSON[_0x49661f(0xa69)](localStorage['getItem'](_0x49661f(0x2cd)) || '{}'); _0x3adbc6['image'] && (console['log'](_0x49661f(0x702)), _0x48ab46 = await _0x4904fe(_0x3adbc6[_0x49661f(0x98c)]), await _0x4162d1(_0x49661f(0x1b9), _0x48ab46)); } if (_0x48ab46) { if (_0x49661f(0x3f9) === _0x49661f(0x62e)) { _0x3f8db8['innerHTML'] = _0x49661f(0xa09); return; } else _0x5910f7['src'] = URL[_0x49661f(0x602)](_0x48ab46), _0xe5d0e5[_0x49661f(0x462)][_0x49661f(0x5f3)] = _0x49661f(0x10c); } else _0x49661f(0x750) === _0x49661f(0x750) ? _0xe5d0e5[_0x49661f(0x462)][_0x49661f(0x5f3)] = _0x49661f(0x10c) : _0x4c5efa(_0x30d5d0, _0x498c39[_0x49661f(0x248)]); } catch (_0x56139a) { console['error']('加载卡片图片失败', _0x56139a); } try { let _0x4dded4 = await _0xb9bbbf(_0x49661f(0x2f7)); const _0x3b2990 = document['getElementById'](_0x49661f(0x440)), _0x269a82 = document[_0x49661f(0x7d5)](_0x49661f(0xa6c)); _0x4dded4 ? _0x49661f(0x607) === 'bhVmg' ? _0x4326a3['boundUserProfileId'] = _0x5d2cbe[_0x49661f(0x56d)] : (_0x3b2990['src'] = URL[_0x49661f(0x602)](_0x4dded4), _0x269a82[_0x49661f(0x462)][_0x49661f(0x5f3)] = _0x49661f(0x10c)) : _0x269a82[_0x49661f(0x462)]['display'] = _0x49661f(0x794); } catch (_0x51ee92) { console[_0x49661f(0x11e)]('加载第二个卡片图片失败', _0x51ee92); } } else _0x36ba3b(![]); } _0x91c60[_0x314838(0x988)](_0x314838(0x649), () => { const _0x3eb0df = _0x314838; _0x406872(), _0x384da8(_0x3eb0df(0x28b), _0x3eb0df(0x73e)); }), document['getElementById'](_0x314838(0x72b))['addEventListener'](_0x314838(0x649), () => _0x384da8(_0x314838(0x73e), _0x314838(0x28b))), document[_0x314838(0x7d5)](_0x314838(0x22c))['addEventListener'](_0x314838(0x649), () => _0x1d6ea3()), document[_0x314838(0x7d5)](_0x314838(0x708))[_0x314838(0x988)](_0x314838(0x649), () => { const _0x3ee908 = _0x314838; if (_0x3ee908(0x270) !== _0x3ee908(0x270)) { if (_0x547f1f) { const _0x32e7eb = _0xcea719[_0x3ee908(0x602)](_0x31c21a); _0x5dc269[_0x3ee908(0x268)] = _0x32e7eb, _0x5511f1[_0x3ee908(0x3a5)] = () => _0x1aaa0a[_0x3ee908(0x918)](_0x32e7eb); } } else _0x406872(), _0x384da8('userProfileList', _0x3ee908(0x787)); }), document['getElementById']('save-user-profile-button')[_0x314838(0x988)](_0x314838(0x649), _0x5c7342), document[_0x314838(0x7d5)](_0x314838(0x7ff))['addEventListener'](_0x314838(0x649), _0x33995e), document['getElementById'](_0x314838(0x282))[_0x314838(0x988)](_0x314838(0x649), () => { const _0x3c69d4 = _0x314838, _0x57b97f = document[_0x3c69d4(0x7d5)](_0x3c69d4(0x1fd))[_0x3c69d4(0x4d3)]; if (_0x57b97f) { if (_0x3c69d4(0x725) !== _0x3c69d4(0x4f5)) _0x13c410[_0x3c69d4(0x56d)] = _0x57b97f, _0x5834f1(), _0x1e9edf(_0x3c69d4(0x295)), _0x406872(), document[_0x3c69d4(0x7d5)]('set-active-user-button')['style'][_0x3c69d4(0x5f3)] = _0x3c69d4(0x794); else { _0x21455c(![]), _0x1dd586(_0x3c69d4(0x93b)); return; } } }); function _0x328a3b(_0x3cf7c0) { const _0x48f10b = _0x314838; if ('lBdWp' !== _0x48f10b(0x50b)) _0x9d8a05 = _0x3e60a4[_0x48f10b(0x695)]; else { const _0x3043d3 = _0x13c410[_0x48f10b(0x226)]['find'](_0x5eca40 => _0x5eca40['id'] === _0x3cf7c0), _0x29700d = _0x3043d3?.[_0x48f10b(0x75d)]; let _0x3cc46f = _0x13c410[_0x48f10b(0x6ed)][_0x48f10b(0x9b9)](_0x22ac8b => _0x22ac8b['id'] === _0x29700d); return !_0x3cc46f && (_0x3cc46f = _0x13c410[_0x48f10b(0x6ed)][_0x48f10b(0x9b9)](_0x5dd8c7 => _0x5dd8c7['id'] === _0x13c410[_0x48f10b(0x56d)]) || _0x13c410[_0x48f10b(0x6ed)][0x0]), _0x3cc46f || { 'name': '用户', 'avatar': _0x10ed69, 'persona': '' }; } } function _0x52ddde(_0x266aa6) { const _0xde6aab = _0x314838, _0x5afce8 = document['getElementById'](_0x266aa6); _0x5afce8['innerHTML'] = '', _0x13c410['userProfiles'][_0xde6aab(0x8c0)](_0x354ada => { const _0x398499 = _0xde6aab, _0x179d98 = document[_0x398499(0xa30)](_0x398499(0x115)); _0x179d98[_0x398499(0x4d3)] = _0x354ada['id'], _0x179d98[_0x398499(0x9e0)] = _0x354ada[_0x398499(0x695)], _0x5afce8['appendChild'](_0x179d98); }); } function _0x48d99c(_0x279a7d) { const _0x1bb4cf = _0x314838, _0x27f9a2 = _0x1d08b4(_0x279a7d), _0x9a5b60 = document[_0x1bb4cf(0x7d5)](_0x1bb4cf(0x1a2)); _0x9a5b60[_0x1bb4cf(0x462)]['backgroundImage'] = ''; let _0x20d137 = document[_0x1bb4cf(0x7d5)](_0x1bb4cf(0x70c) + _0x279a7d); if (_0x20d137) _0x20d137[_0x1bb4cf(0x65e)] = ''; if (!_0x27f9a2) return; _0x27f9a2[_0x1bb4cf(0x97a)] && (_0x9a5b60[_0x1bb4cf(0x462)][_0x1bb4cf(0x97e)] = _0x1bb4cf(0x5ce) + _0x27f9a2['chatWallpaper'] + '\x27)', _0x9a5b60[_0x1bb4cf(0x462)][_0x1bb4cf(0x6b5)] = _0x1bb4cf(0x45d), _0x9a5b60[_0x1bb4cf(0x462)][_0x1bb4cf(0x697)] = _0x1bb4cf(0x2a0)); if (_0x27f9a2[_0x1bb4cf(0x897)]) { let _0x433b4d = document[_0x1bb4cf(0x7d5)](_0x1bb4cf(0x70c) + _0x27f9a2['id']); !_0x433b4d && (_0x433b4d = document[_0x1bb4cf(0xa30)](_0x1bb4cf(0x462)), _0x433b4d['id'] = 'style-' + _0x27f9a2['id'], document[_0x1bb4cf(0x33f)]['appendChild'](_0x433b4d)); const _0x2adeb7 = _0x27f9a2[_0x1bb4cf(0x897)], _0x187de9 = _0x2adeb7[_0x1bb4cf(0x1b5)](/\.bubble\.sent/g, _0x1bb4cf(0x9f0) + _0x27f9a2['id'] + _0x1bb4cf(0x7c7))[_0x1bb4cf(0x1b5)](/\.bubble\.received/g, '.bubble-' + _0x27f9a2['id'] + _0x1bb4cf(0x6dc)); _0x433b4d[_0x1bb4cf(0x65e)] = _0x187de9; } } function _0x356933() { const _0x577bc5 = _0x314838, _0x400328 = document['getElementById'](_0x577bc5(0x714)); _0x400328[_0x577bc5(0x65e)] = ''; const _0x2fed38 = _0x1ef527 => { const _0x5130a2 = _0x577bc5; _0x13c410[_0x5130a2(0x531)][_0x1ef527] = null; if (_0x1ef527 === _0x5130a2(0x98c)) _0x13c410[_0x5130a2(0x531)][_0x5130a2(0x5bb)] = null; _0x356933(); }, _0x63b8ca = _0x13c410[_0x577bc5(0x531)]['imageId'], _0x4feb27 = _0x13c410['pendingPostAttachments'][_0x577bc5(0x44d)]; if (_0x63b8ca) { const _0xf1867b = document[_0x577bc5(0xa30)]('div'); _0xf1867b[_0x577bc5(0x828)] = 'preview-item', _0xf1867b[_0x577bc5(0x65e)] = _0x577bc5(0x20a), _0xf1867b['querySelector'](_0x577bc5(0x2b7))[_0x577bc5(0x779)] = () => _0x2fed38(_0x577bc5(0x98c)), _0x400328['appendChild'](_0xf1867b), _0xb9bbbf(_0x63b8ca)['then'](_0x3eac4d => { const _0xab86f8 = _0x577bc5; if (_0xab86f8(0x8b2) !== _0xab86f8(0x9ac)) { const _0x3ae09d = document[_0xab86f8(0x7d5)]('pending-post-image-preview'); if (_0x3ae09d && _0x3eac4d) { if (_0xab86f8(0xa9d) === _0xab86f8(0xa63)) { const _0x26b628 = _0x3c3aed['toLowerCase'](), _0x3fcb08 = _0x104cff[_0xab86f8(0x430)](); if (_0x26b628[_0xab86f8(0x6ec)](_0xab86f8(0x653))) return 'anthropic'; if (_0x3fcb08[_0xab86f8(0x71e)](_0xab86f8(0x485))) return _0xab86f8(0x3ba); if (_0x3fcb08['includes'](_0xab86f8(0x7f8))) return _0xab86f8(0x2e1); if (_0x26b628[_0xab86f8(0x6ec)]('gemini')) return _0xab86f8(0x2e1); return _0xab86f8(0x945); } else _0x3ae09d[_0xab86f8(0x268)] = URL[_0xab86f8(0x602)](_0x3eac4d); } } else _0x3a6143(_0x427620['id']); }); } if (_0x4feb27) { const _0xc845fc = document['createElement'](_0x577bc5(0xa8b)); _0xc845fc[_0x577bc5(0x828)] = _0x577bc5(0xa32), _0xc845fc[_0x577bc5(0x65e)] = _0x577bc5(0xa34) + (_0x4feb27['coverUrl'] || _0x1c044f) + _0x577bc5(0x7f7) + _0x4feb27[_0x577bc5(0x30d)] + _0x577bc5(0x81e) + _0x4feb27[_0x577bc5(0x376)] + _0x577bc5(0x88c), _0xc845fc[_0x577bc5(0x298)](_0x577bc5(0x2b7))[_0x577bc5(0x779)] = () => _0x2fed38('music'), _0x400328[_0x577bc5(0x3fd)](_0xc845fc); } } async function _0x46af84(_0x51cb21) { const _0x325ae1 = _0x314838; if ('UfXie' !== _0x325ae1(0x737)) _0x287f01['accountingData'] = _0x270543[_0x325ae1(0x2e4)]; else { const _0x58531e = _0x13c410[_0x325ae1(0x67e)]['find'](_0x3e393d => _0x3e393d['id'] === _0x13c410[_0x325ae1(0x6f0)]); if (!_0x58531e) return; _0x1f66de(!![], _0x325ae1(0x533)), _0x13c410['isGenerating'] = !![]; try { const _0x36f153 = _0x58531e[_0x325ae1(0x28a)]['map'](_0x49ee07 => _0x1d08b4(_0x49ee07))[_0x325ae1(0x61f)](Boolean), _0x298f4d = _0x35b71c(), _0x2c1132 = _0x36f153['map'](_0x163a56 => { const _0x3d3221 = _0x325ae1, { omniText: _0x33cba1 } = _0x32d34b(_0x163a56['id'], null), _0x2bed09 = _0x40d5ca(_0x163a56['id']), _0x1b37e5 = _0x163a56[_0x3d3221(0x7d8)] && _0x163a56[_0x3d3221(0x7d8)]['length'] > 0x0 ? _0x3d3221(0x8c3) + _0x163a56[_0x3d3221(0x695)] + '的个人专属世界观设定\x0a' + _0x163a56[_0x3d3221(0x7d8)][_0x3d3221(0x33d)](_0x47a08d => _0x13c410[_0x3d3221(0x90d)][_0x3d3221(0x9b9)](_0x23f48a => _0x23f48a['id'] === _0x47a08d))[_0x3d3221(0x61f)](Boolean)[_0x3d3221(0x33d)](_0x4e6256 => _0x3d3221(0xa58) + _0x4e6256[_0x3d3221(0x695)] + '\x0a' + _0x4e6256['content'])[_0x3d3221(0x8aa)]('') : ''; return _0x3d3221(0x798) + _0x163a56['name'] + _0x3d3221(0x121) + _0x163a56['id'] + '\x0a\x20\x20人设:\x20' + _0x163a56['persona'] + _0x3d3221(0xa8a) + _0x33cba1 + '\x0a' + _0x2bed09 + '\x0a' + _0x1b37e5; })[_0x325ae1(0x8aa)]('\x0a\x0a'), _0x393da6 = _0x3923e1(_0x51cb21[_0x325ae1(0x374)]) || { 'name': '用户' }, _0x35be77 = _0x393da6[_0x325ae1(0x2a1)] ? '\x0a#\x20发布动态的用户信息\x0a-\x20姓名:\x20' + _0x393da6[_0x325ae1(0x695)] + '\x0a-\x20人设:\x20' + _0x393da6[_0x325ae1(0x2a1)] + '\x0a' : ''; let _0x66dccb = null; if (_0x51cb21['image']) _0x66dccb = _0x51cb21[_0x325ae1(0x98c)]; else { if (_0x51cb21[_0x325ae1(0x5bb)]) { if (_0x325ae1(0x6fd) !== 'emFbC') _0x4ec559[_0x325ae1(0x98f)]({ 'time': _0xd783c4, 'text': _0x5afdcc }); else try { if ('QBHGs' !== _0x325ae1(0x717)) { const _0x389237 = await _0xb9bbbf(_0x51cb21['imageId']); _0x389237 && (_0x66dccb = await _0x2115c1(_0x389237)); } else _0xc6d056(); } catch (_0x3bcfd9) { _0x325ae1(0x2ca) !== _0x325ae1(0x2ca) ? _0x22703a = { 'speaker': _0x43f404['name'], 'line': _0x56f553['content'], 'emotion': _0x325ae1(0x6a9) } : console[_0x325ae1(0x11e)](_0x325ae1(0xa01), _0x3bcfd9); } } } let _0x502613 = _0x393da6[_0x325ae1(0x695)] + _0x325ae1(0x35a) + _0x51cb21['content'] + '”'; if (_0x66dccb) { if (_0x325ae1(0xa11) === 'QTqVZ') { _0x3805a3 = ![], _0x1dbfe6[_0x325ae1(0x462)][_0x325ae1(0x5f3)] = _0x325ae1(0x794), _0x552437[_0x325ae1(0x7d5)](_0x325ae1(0x728))[_0x325ae1(0x462)][_0x325ae1(0x5f3)] = 'block', _0x236380[_0x325ae1(0x7d5)](_0x325ae1(0xa82))[_0x325ae1(0x462)][_0x325ae1(0x5f3)] = _0x325ae1(0x10c); if (!_0x3d476b) { const _0x2da93c = _0x5dc715(_0x4155ce['activeMeetingCharId']); _0x2da93c && (_0x2da93c['spriteTransform'] = _0x3ed326, _0x58cd0e(_0x2e83c4[_0x325ae1(0x2c7)], _0x325ae1(0x6a9))); } } else _0x502613 += _0x325ae1(0x73f); } _0x51cb21['type'] === _0x325ae1(0x44d) && ('rbpPF' !== 'OXHQJ' ? _0x502613 += _0x325ae1(0x806) + _0x51cb21[_0x325ae1(0x30d)] + _0x325ae1(0xa41) + _0x51cb21[_0x325ae1(0x376)] + ']' : (_0x1dec6d[_0x325ae1(0x11e)]('Failed\x20to\x20save\x20state\x20to\x20localStorage:', _0x573bdf), _0x5d77f3('无法保存状态，浏览器可能禁用了存储功能。'))); const _0x5c674e = _0x325ae1(0x83a) + _0x2c1132 + '\x0a\x0a' + _0x35be77 + _0x325ae1(0x46b) + _0x298f4d + _0x325ae1(0x518) + _0x502613 + '\x0a\x0a#\x20任务要求\x0a1.\x20\x20**全局视角**:\x20扮演所有成员，思考他们看到这条动态（包括图片）后会作何反应。\x0a2.\x20\x20**生成互动**:\x20为每个角色决定是否点赞，以及要发表什么评论。评论必须符合角色性格并与所有已知信息（聊天、日记等）相关联。\x0a3.\x20\x20**输出格式**:\x20你的输出必须是一个单一、完整的JSON对象，结构如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a-\x20【绝对规则】:\x20所有ID必须使用上面提供的角色ID，不能用名字。\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。\x0a', _0xfea054 = [{ 'role': 'system', 'content': _0x5c674e }], _0x3ac7ea = { 'role': _0x325ae1(0x425), 'content': _0x325ae1(0x473) }; _0x66dccb && (_0x325ae1(0xa53) !== _0x325ae1(0x564) ? _0x3ac7ea[_0x325ae1(0x98c)] = _0x66dccb : _0x2e5c0e += '\x0a\x0a#\x20你的手机内容摘要\x20(这是你的个人记忆，不要提及“视奸”)\x0a'); _0xfea054['push'](_0x3ac7ea); const _0x231c38 = await _0x39cd5c(_0xfea054, { 'json': !![] }), _0x18b3ce = _0x231c38['match'](/({[\s\S]*})/); if (!_0x18b3ce) throw new Error('AI未能返回有效的JSON对象。'); const _0x20474c = JSON[_0x325ae1(0xa69)](_0x18b3ce[0x1]), _0x117d81 = _0x58531e[_0x325ae1(0xea)][_0x325ae1(0x9b9)](_0x2de302 => _0x2de302['id'] === _0x51cb21['id']); _0x117d81 && (_0x117d81['likes'] = _0x20474c['likes'] || [], _0x117d81[_0x325ae1(0x826)] = (_0x20474c[_0x325ae1(0x826)] || [])[_0x325ae1(0x33d)]((_0x2c5d1b, _0x433e12) => ({ ..._0x2c5d1b, 'commentId': 'c_' + _0x51cb21[_0x325ae1(0x921)] + '_' + _0x433e12 })), _0x5834f1(), _0x80c141()); } catch (_0x43f56e) { console[_0x325ae1(0x11e)](_0x325ae1(0x241), _0x43f56e), _0x1e9edf(_0x325ae1(0x58e)); } finally { _0x1f66de(![]), _0x13c410[_0x325ae1(0x1e8)] = ![]; } } } function _0x5c7610() { const _0x5c9de8 = _0x314838, _0x29c828 = _0x13c410[_0x5c9de8(0x67e)][_0x5c9de8(0x9b9)](_0xd69d0e => _0xd69d0e['id'] === _0x13c410['activeFriendCircleId']), _0x50e691 = _0x29c828?.[_0x5c9de8(0x75d)]; let _0x51c77d = _0x13c410[_0x5c9de8(0x6ed)][_0x5c9de8(0x9b9)](_0x301444 => _0x301444['id'] === _0x50e691); !_0x51c77d && (_0x51c77d = _0x13c410['userProfiles'][_0x5c9de8(0x9b9)](_0x5e6e4f => _0x5e6e4f['id'] === _0x13c410[_0x5c9de8(0x56d)])); if (!_0x51c77d) { if (_0x5c9de8(0x591) === _0x5c9de8(0x6fb)) { _0x35e1fa('群聊名称不能为空！'); return; } else _0x51c77d = _0x13c410[_0x5c9de8(0x6ed)][0x0]; } _0x51c77d && (document[_0x5c9de8(0x7d5)](_0x5c9de8(0x6de))[_0x5c9de8(0x268)] = _0x51c77d['avatar'] || _0x10ed69); } function _0xee9fd1(_0x836c0c) { const _0x8bcf83 = _0x314838; let _0x17cab2 = 0x0, _0x1165fe = 0x0, _0x615642 = 0x0; if (_0x836c0c[_0x8bcf83(0x280)] == 0x4) { if (_0x8bcf83(0x19c) === 'iXpMA') { const _0x2c77d0 = _0x8569bf[_0x8bcf83(0xa30)]('li'); _0x2c77d0[_0x8bcf83(0x828)] = _0x8bcf83(0x76d), _0x2c77d0[_0x8bcf83(0x14b)][_0x8bcf83(0x5af)] = _0x4ec22b['id'], _0x2c77d0[_0x8bcf83(0x65e)] = _0x8bcf83(0x81d) + (_0x3499fb[_0x8bcf83(0x907)] || _0x49915f) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x127888[_0x8bcf83(0x695)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x2c77d0['addEventListener'](_0x8bcf83(0x649), () => { _0x4b6fc0(_0x236918['id']); }), _0x2c77d0[_0x8bcf83(0x298)](_0x8bcf83(0x860))['addEventListener'](_0x8bcf83(0x649), () => { _0x167b3e(_0x149f9e['id']); }), _0x2c77d0['querySelector'](_0x8bcf83(0x886))['addEventListener'](_0x8bcf83(0x649), _0x174b1f => { _0x174b1f['stopPropagation'](), _0x82e93f(_0x3dc8da['id']); }), _0x248e95[_0x8bcf83(0x3fd)](_0x2c77d0); } else _0x17cab2 = '0x' + _0x836c0c[0x1] + _0x836c0c[0x1], _0x1165fe = '0x' + _0x836c0c[0x2] + _0x836c0c[0x2], _0x615642 = '0x' + _0x836c0c[0x3] + _0x836c0c[0x3]; } else _0x836c0c[_0x8bcf83(0x280)] == 0x7 && (_0x17cab2 = '0x' + _0x836c0c[0x1] + _0x836c0c[0x2], _0x1165fe = '0x' + _0x836c0c[0x3] + _0x836c0c[0x4], _0x615642 = '0x' + _0x836c0c[0x5] + _0x836c0c[0x6]); _0x17cab2 /= 0xff, _0x1165fe /= 0xff, _0x615642 /= 0xff; let _0x180655 = Math['min'](_0x17cab2, _0x1165fe, _0x615642), _0x462a4d = Math[_0x8bcf83(0x1a5)](_0x17cab2, _0x1165fe, _0x615642), _0x48092c = _0x462a4d - _0x180655, _0x3709d8 = 0x0, _0x5afb39 = 0x0, _0x42f976 = 0x0; if (_0x48092c == 0x0) _0x3709d8 = 0x0; else { if (_0x462a4d == _0x17cab2) _0x3709d8 = (_0x1165fe - _0x615642) / _0x48092c % 0x6; else { if (_0x462a4d == _0x1165fe) _0x3709d8 = (_0x615642 - _0x17cab2) / _0x48092c + 0x2; else _0x3709d8 = (_0x17cab2 - _0x1165fe) / _0x48092c + 0x4; } } _0x3709d8 = Math[_0x8bcf83(0x519)](_0x3709d8 * 0x3c); if (_0x3709d8 < 0x0) _0x3709d8 += 0x168; return _0x42f976 = (_0x462a4d + _0x180655) / 0x2, _0x5afb39 = _0x48092c == 0x0 ? 0x0 : _0x48092c / (0x1 - Math['abs'](0x2 * _0x42f976 - 0x1)), _0x5afb39 = +(_0x5afb39 * 0x64)[_0x8bcf83(0x176)](0x1), _0x42f976 = +(_0x42f976 * 0x64)[_0x8bcf83(0x176)](0x1), { 'h': _0x3709d8, 's': _0x5afb39, 'l': _0x42f976 }; } function _0x2da7c9() { const _0x44bf92 = _0x314838, _0x1cfbea = (_0x2b4edb, _0x4632c0, _0x201b79) => { const _0x376d4d = _0x13a6, _0x1c6dcd = document[_0x376d4d(0x7d5)](_0x2b4edb); if (!_0x1c6dcd) return; let _0x28e2d8 = null; try { _0x28e2d8 = JSON[_0x376d4d(0xa69)](localStorage[_0x376d4d(0x310)](_0x4632c0) || '{}'); } catch { if (_0x376d4d(0x7ba) === 'NQywe') _0x28e2d8 = {}; else { if (!_0x1fcf1f[_0x376d4d(0x850)](_0x4e6c1c)) return _0x376d4d(0xa1a); if (_0x502df5[_0x376d4d(0x280)] === 0x0) return '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x22>备忘录是空的。</p>'; return _0xd24bf5[_0x376d4d(0x25d)]((_0x3ffe51, _0x2ade61) => new _0x5a0e41(_0x2ade61[_0x376d4d(0x3d4)]) - new _0x40b56f(_0x3ffe51[_0x376d4d(0x3d4)])), _0x103d2f[_0x376d4d(0x33d)](_0x12688f => '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20background:\x20#fffbf2;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + (_0x12688f['title'] || _0x376d4d(0xa37)) + _0x376d4d(0xa65) + (_0x12688f[_0x376d4d(0x75a)] || '') + _0x376d4d(0x3cd) + (_0x12688f['last_edited'] || '') + _0x376d4d(0x363))[_0x376d4d(0x8aa)](''); } } _0x1c6dcd[_0x376d4d(0x462)][_0x376d4d(0x184)] = _0x376d4d(0x37d), _0x1c6dcd[_0x376d4d(0x462)]['top'] = '', _0x1c6dcd['style'][_0x376d4d(0x26c)] = '', _0x1c6dcd[_0x376d4d(0x462)][_0x376d4d(0x1e0)] = '', _0x1c6dcd[_0x376d4d(0x462)][_0x376d4d(0x55c)] = '', _0x1c6dcd[_0x376d4d(0x462)][_0x376d4d(0x424)] = ''; if (typeof _0x28e2d8[_0x376d4d(0x43a)] === _0x376d4d(0x308) && typeof _0x28e2d8[_0x376d4d(0x26c)] === _0x376d4d(0x308)) _0x376d4d(0x5c3) === _0x376d4d(0x5c3) ? (_0x1c6dcd[_0x376d4d(0x462)][_0x376d4d(0x43a)] = _0x28e2d8['top'] + '%', _0x1c6dcd['style'][_0x376d4d(0x26c)] = _0x28e2d8[_0x376d4d(0x26c)] + '%') : _0x2bce81[_0x376d4d(0x8cc)]({ 'behavior': _0x376d4d(0x25a), 'block': _0x376d4d(0x554) }); else for (const _0x130814 in _0x201b79) { if (_0x376d4d(0x3e5) !== _0x376d4d(0x2d3)) _0x1c6dcd[_0x376d4d(0x462)][_0x130814] = _0x201b79[_0x130814]; else { const _0x4078a1 = _0x2691b1['createElement'](_0x376d4d(0xa02)); _0x4078a1[_0x376d4d(0x268)] = _0x1fea5f['url'], _0x4078a1[_0x376d4d(0x605)] = _0x376d4d(0x973), _0x4078a1[_0x376d4d(0x3bc)] = _0xc701e1['name'], _0x4078a1[_0x376d4d(0x349)]['add'](_0x376d4d(0x55d)), _0x4078a1[_0x376d4d(0x988)](_0x376d4d(0x649), () => _0x3db1e0(_0x2fafa0)), _0x228206[_0x376d4d(0x3fd)](_0x4078a1); } } }; _0x1cfbea(_0x44bf92(0x68b), 'clockPosition', { 'top': '15%', 'left': _0x44bf92(0x93c), 'transform': _0x44bf92(0x7b0) }), _0x1cfbea(_0x44bf92(0x103), _0x44bf92(0xa45), { 'top': _0x44bf92(0x95d), 'right': '4%' }), _0x1cfbea(_0x44bf92(0x1c9), 'appIconPosition_app-user-profiles', { 'top': '20%', 'right': _0x44bf92(0x961) }), _0x1cfbea('app-settings', _0x44bf92(0x7ca), { 'top': '8%', 'right': '28%' }), _0x1cfbea(_0x44bf92(0x9df), _0x44bf92(0x867), { 'top': '8%', 'right': '4%' }), _0x1cfbea(_0x44bf92(0x227), _0x44bf92(0x130), { 'top': _0x44bf92(0xf5), 'left': '5%' }), _0x1cfbea('app-diary', _0x44bf92(0x2fc), { 'top': _0x44bf92(0x7fc), 'left': _0x44bf92(0x736) }), _0x1cfbea(_0x44bf92(0x2e5), _0x44bf92(0x2fd), { 'top': '71%', 'left': '5%' }), _0x1cfbea(_0x44bf92(0x3e2), 'appIconPosition_app-accounting', { 'top': '59%', 'left': _0x44bf92(0x736) }), _0x1cfbea(_0x44bf92(0x6be), _0x44bf92(0x49b), { 'top': '60%', 'right': '5%' }), _0x1cfbea(_0x44bf92(0xa6c), _0x44bf92(0x90f), { 'top': '8%', 'left': '5%' }); const _0x7539a0 = document[_0x44bf92(0x7d5)]('card-widget'); _0x7539a0 && ('iHBre' !== 'VPYBE' ? (_0x7539a0[_0x44bf92(0x462)][_0x44bf92(0x184)] = 'absolute', _0x7539a0[_0x44bf92(0x462)][_0x44bf92(0x43a)] = '34%', _0x7539a0[_0x44bf92(0x462)][_0x44bf92(0x26c)] = _0x44bf92(0x93c), _0x7539a0[_0x44bf92(0x462)][_0x44bf92(0x424)] = 'translateX(-50%)', _0x7539a0[_0x44bf92(0x462)][_0x44bf92(0x5f3)] = 'block') : (_0x208f32[_0x44bf92(0x349)][_0x44bf92(0x330)](_0x44bf92(0xa12)), _0x4b5677[_0x44bf92(0x779)] = null, _0x52991d['onclick'] = null, _0x1827e4[_0x44bf92(0x779)] = null, _0x20bc9a[_0x44bf92(0x7f6)](_0x44bf92(0x610), _0x427f5e), _0x418241(_0x1c6ae8))); const _0x2f8372 = document[_0x44bf92(0x7d5)]('music-widget'); if (_0x2f8372) { if (_0x44bf92(0x7f2) === _0x44bf92(0x7f2)) _0x2f8372[_0x44bf92(0x462)]['position'] = 'absolute', _0x2f8372[_0x44bf92(0x462)][_0x44bf92(0x43a)] = '35%', _0x2f8372[_0x44bf92(0x462)][_0x44bf92(0x26c)] = _0x44bf92(0x93c), _0x2f8372[_0x44bf92(0x462)][_0x44bf92(0x424)] = _0x44bf92(0x7b0), _0x2f8372[_0x44bf92(0x462)][_0x44bf92(0x5f3)] = 'inline-block'; else { const _0xfcf47a = { 'role': _0x44bf92(0x9bb), 'content': _0x44bf92(0x318) + _0x1eb09b['name'] + ']', 'displayUrl': _0x4e4cfa[_0x44bf92(0x570)], 'senderId': _0x501b1f['senderId'], 'timestamp': _0x2f2afe['now'](), 'isOffline': _0x2bbc3f }; _0x4d83a4[_0x44bf92(0x793)][_0x44bf92(0x98f)](_0xfcf47a); } } } function _0x597396() { const _0x57ef4b = _0x314838; if (_0x57ef4b(0x323) !== _0x57ef4b(0x159)) { const _0xbcebef = document['getElementById'](_0x57ef4b(0x547)); _0xbcebef[_0x57ef4b(0x65e)] = ''; const _0x5e01fb = document[_0x57ef4b(0x83d)](_0x57ef4b(0x9cf)); _0x5e01fb['forEach'](_0x523915 => { const _0x2ce43b = _0x57ef4b, _0xb6f49b = _0x523915['id'], _0x12de26 = _0x523915[_0x2ce43b(0x298)]('span')['textContent'], _0x2ae559 = _0x2ce43b(0x7c0) + _0xb6f49b, _0x3da8d6 = localStorage[_0x2ce43b(0x310)](_0x2ae559), _0x361fd2 = document['createElement'](_0x2ce43b(0xa8b)); _0x361fd2[_0x2ce43b(0x828)] = 'member-selection-item', _0x361fd2[_0x2ce43b(0x462)]['padding'] = _0x2ce43b(0x2b4), _0x361fd2['innerHTML'] = _0x2ce43b(0x62a) + _0xb6f49b + _0x2ce43b(0x402) + (_0x3da8d6 || _0x2ce43b(0x215)) + _0x2ce43b(0x375) + _0x12de26 + _0x2ce43b(0x292) + _0xb6f49b + '\x22\x20accept=\x22image/*\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x22\x20onclick=\x22document.getElementById(\x27input_' + _0xb6f49b + '\x27).click()\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x20background-color:\x20#777;\x22\x20onclick=\x22localStorage.removeItem(\x27' + _0x2ae559 + _0x2ce43b(0x6e1), _0xbcebef['appendChild'](_0x361fd2); const _0x5d3be0 = document[_0x2ce43b(0x7d5)](_0x2ce43b(0xa28) + _0xb6f49b); _0x5d3be0[_0x2ce43b(0x988)](_0x2ce43b(0x458), async _0x3274ba => { const _0x12518b = _0x2ce43b, _0x5467d8 = _0x3274ba[_0x12518b(0x6d7)][_0x12518b(0x6ea)][0x0]; if (!_0x5467d8) return; try { const _0x41da80 = await _0x14be68(_0x5467d8); localStorage[_0x12518b(0x629)](_0x2ae559, _0x41da80), document[_0x12518b(0x7d5)](_0x12518b(0xa38) + _0xb6f49b)[_0x12518b(0x268)] = _0x41da80, _0x175b8f(); } catch (_0x1d3587) { _0x1e9edf('图标处理失败:\x20' + _0x1d3587[_0x12518b(0x496)]); } }); }); } else { if (_0x20aeed < 0x0 || _0x12770c >= _0x2ee125['length']) return; _0x2fc079 = _0x438ea5; const _0x57dfba = _0x450074[_0x4c2905]; _0x30d1fa[_0x57ef4b(0x268)] = _0x57dfba['playableUrl'] || _0x57dfba[_0x57ef4b(0x570)], _0x4a10af[_0x57ef4b(0x5c0)](), _0x251e1d(), _0x20bdf3(); } } function _0x175b8f() { const _0x234fdb = _0x314838; if (_0x234fdb(0x996) === 'FPRBC') { const _0x18c468 = document[_0x234fdb(0x83d)](_0x234fdb(0x9cf)); _0x18c468[_0x234fdb(0x8c0)](_0xee8a28 => { const _0x1c63a8 = _0x234fdb; if (_0x1c63a8(0x4ac) !== _0x1c63a8(0x2c3)) { const _0x196de6 = _0xee8a28['id'], _0xbea36a = _0x1c63a8(0x7c0) + _0x196de6, _0x29b8c4 = localStorage[_0x1c63a8(0x310)](_0xbea36a), _0x46a807 = _0xee8a28[_0x1c63a8(0x298)](_0x1c63a8(0x453)); if (_0x29b8c4) _0x1c63a8(0x355) === _0x1c63a8(0x7c2) ? (_0x4ee852[_0x1c63a8(0x462)][_0x1c63a8(0x5f3)] = _0x1c63a8(0x715), _0x32c7d9(() => _0x5f006f[_0x1c63a8(0x349)][_0x1c63a8(0x699)](_0x1c63a8(0xa12)), 0xa)) : _0x46a807['innerHTML'] = '<img\x20src=\x22' + _0x29b8c4 + '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>'; else { const _0x21ebd0 = document[_0x1c63a8(0x298)](_0x1c63a8(0x76e) + _0x196de6 + _0x1c63a8(0x5c7) + _0x196de6 + _0x1c63a8(0x5e2))?.[_0x1c63a8(0x65e)]; _0x21ebd0 && (_0x46a807[_0x1c63a8(0x65e)] = _0x21ebd0); } } else { let _0x295e99 = _0x2026c2[_0x1c63a8(0x324)][_0x1c63a8(0x9b9)](_0x468746 => _0x468746[_0x1c63a8(0x951)] === _0x1004df); !_0x295e99 && (_0x295e99 = { 'characterId': _0x25db0f, 'entries': [] }, _0x2c68a5[_0x1c63a8(0x324)]['push'](_0x295e99)); _0x295e99[_0x1c63a8(0x46c)][_0x1c63a8(0x98f)]({ 'timestamp': _0x542db9[_0x1c63a8(0x2f2)](), 'author': _0x40e72f, 'content': _0x419fd9 }), _0xb5cde2(); const _0x362442 = _0x295e99[_0x1c63a8(0x46c)]['length']; _0x24a806['diaryCurrentPage'] = _0x572bce[_0x1c63a8(0x742)](_0x362442 / 0x2) - 0x1, _0x69d0e9(); } }); } else _0xd5abdd['error'](_0x234fdb(0x8eb), _0x57f99c), _0x1522c9(_0x234fdb(0xa78) + _0x4c7e7b[_0x234fdb(0x496)]); } function _0x22fc65() { const _0x1ab285 = _0x314838; if ('EHjqS' !== 'EHjqS') _0x1f2eda[_0x1ab285(0x11e)]('导入角色卡失败:', _0x332f55), _0xf19ea2(_0x1ab285(0x431) + _0xac14d7['message']); else { const _0x2c2e04 = _0x13c410['friendCircles']['find'](_0x36870c => _0x36870c['id'] === _0x13c410[_0x1ab285(0x6f0)]), _0x96fbe9 = _0xee1b45(); let _0x110880 = []; if (_0x2c2e04 && _0x2c2e04[_0x1ab285(0xea)]) { if (_0x1ab285(0x8f3) !== _0x1ab285(0x285)) { const _0x341a9f = _0x2c2e04[_0x1ab285(0xea)][_0x1ab285(0x61f)](_0x9f9712 => _0x9f9712[_0x1ab285(0x974)] === _0x1ab285(0x44d) && _0x9f9712[_0x1ab285(0x128)])[_0x1ab285(0x33d)](_0x2c8428 => ({ ..._0x2c8428, 'source': 'feed' })); _0x110880[_0x1ab285(0x98f)](..._0x341a9f); } else _0x1a7e40[_0x1ab285(0x4d3)] = _0x331734[_0x1ab285(0x33d)](_0x341f6c => _0x341f6c[_0x1ab285(0x695)] + '--' + _0x341f6c[_0x1ab285(0x570)])['join']('\x0a'); } if (_0x96fbe9 && _0x13c410['conversationHistory']) { const _0x5aa7b2 = _0x13c410[_0x1ab285(0x793)][_0x1ab285(0x61f)](_0x4bc17b => _0x4bc17b[_0x1ab285(0x974)] === _0x1ab285(0x44d) && _0x4bc17b['playableUrl'])['map'](_0x532c11 => ({ ..._0x532c11, 'source': _0x1ab285(0x36c) })); _0x110880[_0x1ab285(0x98f)](..._0x5aa7b2); } const _0x3c85b6 = Array[_0x1ab285(0x703)](new Map(_0x110880['map'](_0x558b81 => [_0x558b81[_0x1ab285(0x128)], _0x558b81]))[_0x1ab285(0x1f9)]()); _0x13c410[_0x1ab285(0xa14)] = _0x3c85b6['sort']((_0x5a102a, _0x263102) => _0x263102[_0x1ab285(0x921)] - _0x5a102a[_0x1ab285(0x921)]); } } function _0x5aea93(_0x364c52) { const _0xaed5a3 = _0x314838; if (_0xaed5a3(0xa7b) !== _0xaed5a3(0xa7b)) _0x4ba5e5['activeQuote'] = null, _0x4f7439[_0xaed5a3(0x462)]['display'] = _0xaed5a3(0x794); else { if (_0x364c52 < 0x0 || _0x364c52 >= _0x26a436[_0xaed5a3(0x280)]) return; _0x2972ba = _0x364c52; const _0x13ffd5 = _0x26a436[_0x364c52]; _0x3247fc['src'] = _0x13ffd5[_0xaed5a3(0x128)] || _0x13ffd5[_0xaed5a3(0x570)], _0x3247fc['play'](), _0x222310(), _0x347d2f(); } } function _0x222310() { const _0xe848f3 = _0x314838; if (_0xe848f3(0x555) !== _0xe848f3(0x555)) _0x56930d = _0xe848f3(0x42c); else { const _0x40b58e = _0x26a436[_0x2972ba]; _0x3b1800(_0x40b58e); } } function _0x347d2f() { const _0x5458e7 = _0x314838; if (_0x5458e7(0x75e) !== _0x5458e7(0x66f)) try { localStorage[_0x5458e7(0x629)](_0x5458e7(0x700), JSON[_0x5458e7(0x3e1)]({ 'playlist': _0x13c410[_0x5458e7(0xa14)], 'currentIndex': _0x13c410[_0x5458e7(0x381)] })); } catch (_0x2f6eae) { console[_0x5458e7(0x11e)]('保存播放器状态失败，真是没用。', _0x2f6eae); } else _0x497cf0(_0x5458e7(0x3c1)); } function _0x15da9a() { const _0x3c8474 = _0x314838; try { const _0x266f43 = localStorage[_0x3c8474(0x310)]('musicPlayerState'); if (_0x266f43) { if (_0x3c8474(0x1d9) === _0x3c8474(0x1d9)) { const { playlist: _0x303a45, currentIndex: _0x5043a1 } = JSON[_0x3c8474(0xa69)](_0x266f43); Array[_0x3c8474(0x850)](_0x303a45) && _0x303a45[_0x3c8474(0x280)] > 0x0 && _0x5043a1 > -0x1 && (_0x13c410[_0x3c8474(0xa14)] = _0x303a45, _0x13c410[_0x3c8474(0x381)] = _0x5043a1, _0x13c410[_0x3c8474(0x8a7)] = ![], _0x222310()); } else _0x576464(_0x3c8474(0x73e), _0x3c8474(0x2e7)); } } catch (_0x578c88) { _0x3c8474(0x597) === _0x3c8474(0x465) ? (_0x1c8c52['friendCircles'] = _0x4727e2['friendCircles'][_0x3c8474(0x61f)](_0x3a06e7 => _0x3a06e7['id'] !== _0x259533), _0xc0529b[_0x3c8474(0x6f0)] === _0x1a474b && (_0x5eb286[_0x3c8474(0x6f0)] = null), _0x4a5bde(), _0x77df8f(_0x3c8474(0x8ea)), _0xdf2ee1(), _0x2b237a(_0x3c8474(0x5bd), _0x3c8474(0x2d9))) : console[_0x3c8474(0x11e)]('切，加载播放器状态的时候出错了。', _0x578c88); } } function _0x4b90d9(_0x15fd54) { const _0x20246d = _0x314838; if (_0x20246d(0x302) !== _0x20246d(0x302)) { if (!_0x5f3d1a || !_0x17ab01[_0x20246d(0x71e)](',')) return _0x575b28; const _0x1c269e = _0x242f92[_0x20246d(0x17a)](',')[_0x20246d(0x33d)](_0xea7f84 => _0xea7f84[_0x20246d(0x6eb)]()); return _0x1c269e[_0x4756db[_0x20246d(0x66a)](_0x103baf['random']() * _0x1c269e['length'])]; } else { if (window['diaryPressTimer']) clearTimeout(window[_0x20246d(0x26b)]); const _0x37b9c2 = _0x15fd54[_0x20246d(0x6d7)][_0x20246d(0x4b7)](_0x20246d(0x5d2)); if (!_0x37b9c2) return; const _0x33067b = _0x37b9c2[_0x20246d(0x14b)]['timestamp'], _0x598b15 = _0x37b9c2[_0x20246d(0x349)][_0x20246d(0x741)](_0x20246d(0x425)) ? _0x20246d(0x425) : 'ai'; if (!_0x33067b) return; const _0x8d5798 = () => { const _0x418b2f = _0x20246d; window[_0x418b2f(0x26b)] = setTimeout(() => { const _0x288aaf = _0x418b2f; if (_0x15fd54['type'] === _0x288aaf(0xa40)) _0x15fd54[_0x288aaf(0xa73)](); _0x575575(parseInt(_0x33067b, 0xa), _0x598b15); }, 0x320); }, _0x518370 = () => { const _0x5d452d = _0x20246d; if (window[_0x5d452d(0x26b)]) clearTimeout(window[_0x5d452d(0x26b)]); }; document['addEventListener'](_0x20246d(0x964), _0x518370, { 'once': !![] }), document['addEventListener'](_0x20246d(0x161), _0x518370, { 'once': !![] }), document['addEventListener'](_0x20246d(0x87c), _0x518370, { 'once': !![] }), _0x8d5798(); } } function _0x575575(_0x475d61, _0x1cac76) { const _0x39d386 = _0x314838; if (_0x39d386(0x207) !== _0x39d386(0x207)) _0x125598[_0x39d386(0x349)][_0x39d386(0x581)](_0x39d386(0xa12)), _0x53b33b[_0x39d386(0x349)]['contains']('show') && (_0x181a59[_0x39d386(0x5f8)] = _0x24604d[_0x39d386(0x470)]); else { const _0x1819c6 = _0x39d386(0x371) + _0x475d61; let _0x515f0f = document[_0x39d386(0x7d5)](_0x1819c6); if (_0x515f0f) return; const _0x3f1284 = _0x39d386(0x180) + _0x1819c6 + _0x39d386(0x93e) + (_0x1cac76 === 'ai' ? _0x39d386(0x544) : '') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20'; document[_0x39d386(0x32a)]['insertAdjacentHTML']('beforeend', _0x3f1284); const _0x5aee65 = document[_0x39d386(0x7d5)](_0x1819c6), _0x169b6f = () => _0x5aee65[_0x39d386(0x330)](); _0x5aee65[_0x39d386(0x298)](_0x39d386(0x154))[_0x39d386(0x779)] = _0x169b6f, _0x5aee65[_0x39d386(0x298)]('#diary-action-cancel')['onclick'] = _0x169b6f, _0x5aee65[_0x39d386(0x298)](_0x39d386(0x9ef))[_0x39d386(0x779)] = () => { _0x31e329(_0x475d61), _0x169b6f(); }, _0x1cac76 === 'ai' && (_0x39d386(0x5fc) === _0x39d386(0x5fc) ? _0x5aee65[_0x39d386(0x298)](_0x39d386(0x7bb))[_0x39d386(0x779)] = () => { _0x565e3e(_0x475d61), _0x169b6f(); } : (_0xa5decf[_0x39d386(0x349)]['remove'](_0x39d386(0x6e2), _0x39d386(0x306)), _0xa39696['classList'][_0x39d386(0x330)](_0x39d386(0x949)), _0x3172cd[_0x39d386(0x436)] = _0x571899, _0x55c305(), _0x30a107['isAnimatingDiary'] = ![])); } } async function _0x31e329(_0x3d6813) { const _0x37a192 = _0x314838, _0x9ac710 = await _0x39a14a('确定要删除这篇日记吗？此操作不可撤销。'); if (!_0x9ac710) return; const _0x852838 = _0x13c410[_0x37a192(0x324)]['find'](_0x30252f => _0x30252f['characterId'] === _0x13c410[_0x37a192(0x78f)]); if (!_0x852838) return; const _0x53077f = _0x852838['entries'][_0x37a192(0x57c)](_0xda7798 => _0xda7798[_0x37a192(0x921)] === _0x3d6813); _0x53077f > -0x1 && (_0x852838['entries'][_0x37a192(0x3f5)](_0x53077f, 0x1), _0x5834f1(), _0x8954bc(), _0x1e9edf('日记已删除。')); } async function _0x565e3e(_0x31ab83) { const _0x54631f = _0x314838, _0xd98759 = _0x13c410[_0x54631f(0x324)][_0x54631f(0x9b9)](_0x2cd414 => _0x2cd414[_0x54631f(0x951)] === _0x13c410[_0x54631f(0x78f)]); if (!_0xd98759) return; const _0x4bac6b = _0xd98759[_0x54631f(0x46c)]['findIndex'](_0x6b3c70 => _0x6b3c70[_0x54631f(0x921)] === _0x31ab83); _0x4bac6b > -0x1 && (_0xd98759[_0x54631f(0x46c)][_0x54631f(0x3f5)](_0x4bac6b, 0x1), _0x5834f1(), _0x8954bc(), await _0xf50082()); } function _0x2463e0() { const _0x5c91ae = _0x314838; if (_0x5c91ae(0x852) === _0x5c91ae(0x852)) { const _0x5cbe2a = document[_0x5c91ae(0x7d5)](_0x5c91ae(0x6e3)); _0x5cbe2a[_0x5c91ae(0x65e)] = ''; const _0x18856d = _0x13c410[_0x5c91ae(0x53a)][_0x5c91ae(0x61f)](_0x23c13b => _0x13c410[_0x5c91ae(0x226)][_0x5c91ae(0x6aa)](_0xe6aa52 => _0xe6aa52[_0x5c91ae(0x974)] === 'private' && _0xe6aa52[_0x5c91ae(0x9c8)][_0x5c91ae(0x71e)](_0x23c13b['id']))); if (_0x18856d[_0x5c91ae(0x280)] === 0x0) { if ('PvZWy' === 'PvZWy') { _0x5cbe2a['innerHTML'] = _0x5c91ae(0x1f7); return; } else { const _0x3a4878 = _0x505c81['friendCircles'][_0x5c91ae(0x9b9)](_0x299bbb => _0x299bbb['id'] === _0x56737f); _0x3a4878 && (_0x3a4878[_0x5c91ae(0x695)] = _0x4a39df, _0x3a4878['boundUserProfileId'] = _0x45bc87, _0x3a4878[_0x5c91ae(0x28a)] = _0x3bb6b2); } } _0x18856d[_0x5c91ae(0x8c0)](_0x54e348 => { const _0x31a2f3 = _0x5c91ae, _0x3e3630 = document['createElement']('li'); _0x3e3630[_0x31a2f3(0x828)] = 'character-item', _0x3e3630[_0x31a2f3(0x14b)][_0x31a2f3(0x5af)] = _0x54e348['id'], _0x3e3630['innerHTML'] = _0x31a2f3(0x81d) + (_0x54e348['avatar'] || _0x1c044f) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x54e348['name'] + _0x31a2f3(0x3a0), _0x3e3630['addEventListener'](_0x31a2f3(0x649), () => { _0x44fdee(_0x54e348['id']); }), _0x3e3630[_0x31a2f3(0x298)](_0x31a2f3(0x860))['addEventListener'](_0x31a2f3(0x649), () => { const _0x140eed = _0x31a2f3; _0x140eed(0x102) === _0x140eed(0x102) ? _0x44fdee(_0x54e348['id']) : _0x5f560a[_0x24c2b2][_0x140eed(0x349)][_0x140eed(0x699)](_0x140eed(0x513)); }), _0x3e3630[_0x31a2f3(0x298)](_0x31a2f3(0x886))[_0x31a2f3(0x988)](_0x31a2f3(0x649), _0x47de36 => { const _0xbb2448 = _0x31a2f3; if ('jbPWz' !== _0xbb2448(0x979)) _0x47de36[_0xbb2448(0xa9a)](), _0x36a225(_0x54e348['id']); else { const _0x31adae = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; _0x4e742e[_0xbb2448(0x32a)][_0xbb2448(0x7a2)](_0xbb2448(0x168), _0x31adae); const _0x3032ff = _0x581f72['getElementById'](_0xbb2448(0x460)), _0x531b9b = _0x153029[_0xbb2448(0x7d5)](_0xbb2448(0x873)), _0x357736 = _0x2bed31[_0xbb2448(0x7d5)](_0xbb2448(0x1ba)), _0x5e506a = _0x24bbf9[_0xbb2448(0x7d5)](_0xbb2448(0x400)), _0xe39337 = _0x3032ff['querySelector'](_0xbb2448(0x154)), _0x119a8e = () => { const _0x22c8e6 = _0xbb2448; _0x3032ff[_0x22c8e6(0x330)](), _0x5e4f11(); }; _0x357736[_0xbb2448(0x779)] = () => { _0x4c02b4(_0x531b9b['value']), _0x119a8e(); }, _0x5e506a[_0xbb2448(0x779)] = _0x119a8e, _0xe39337['onclick'] = _0x119a8e; } }), _0x5cbe2a['appendChild'](_0x3e3630); }); } else _0x56dfa8[_0x5c91ae(0x349)][_0x5c91ae(0x699)]('is-entering-from-left'), _0x377853[_0x5c91ae(0x349)]['add']('is-exiting-right'), _0x170996['classList'][_0x5c91ae(0x699)](_0x5c91ae(0x6e2)), _0x48cbae(() => { const _0x58ebfc = _0x5c91ae; _0xb9f04e[_0x58ebfc(0x349)][_0x58ebfc(0x330)](_0x58ebfc(0x6e2), _0x58ebfc(0x801)), _0x2e0a8d[_0x58ebfc(0x349)]['remove']('is-entering-from-left'), _0x901217['diaryCurrentPage'] = _0x3b5d1f, _0x4c7536(), _0x2f5014[_0x58ebfc(0x338)] = ![]; }, 0x2bc); } function _0x44fdee(_0x60a051) { const _0x25b64f = _0x314838, _0x2f44c1 = _0x1d08b4(_0x60a051); if (!_0x2f44c1) return; _0x13c410[_0x25b64f(0x78f)] = _0x60a051; const _0x1f8a41 = _0x13c410['diaries'][_0x25b64f(0x9b9)](_0x59ab54 => _0x59ab54[_0x25b64f(0x951)] === _0x60a051), _0x21f3ba = _0x1f8a41 ? _0x1f8a41[_0x25b64f(0x46c)][_0x25b64f(0x280)] : 0x0, _0x5d3060 = 0x2; _0x13c410[_0x25b64f(0x436)] = Math[_0x25b64f(0x1a5)](0x0, Math[_0x25b64f(0x742)](_0x21f3ba / _0x5d3060) - 0x1), document['getElementById'](_0x25b64f(0x48a))[_0x25b64f(0x9e0)] = _0x2f44c1[_0x25b64f(0x695)] + '的日记本', _0x8954bc(), _0x384da8(_0x25b64f(0x8b9), _0x25b64f(0x909)); } function _0x8954bc() { const _0x4aaca6 = _0x314838, _0x5de269 = document[_0x4aaca6(0x7d5)](_0x4aaca6(0x58a)), _0x3fd1bd = document[_0x4aaca6(0x7d5)](_0x4aaca6(0x745)); _0x5de269[_0x4aaca6(0x65e)] = '', _0x3fd1bd[_0x4aaca6(0x65e)] = ''; const _0x4ebf42 = _0x444594() || { 'name': '我' }, _0xbcd483 = _0x13c410[_0x4aaca6(0x324)]['find'](_0x198f53 => _0x198f53[_0x4aaca6(0x951)] === _0x13c410[_0x4aaca6(0x78f)]); if (!_0xbcd483 || !_0xbcd483[_0x4aaca6(0x46c)] || _0xbcd483[_0x4aaca6(0x46c)]['length'] === 0x0) { _0x5de269[_0x4aaca6(0x65e)] = _0x4aaca6(0xe8), _0x3fd1bd[_0x4aaca6(0x65e)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', document[_0x4aaca6(0x7d5)](_0x4aaca6(0x870))[_0x4aaca6(0x988)](_0x4aaca6(0x649), _0x302636), document[_0x4aaca6(0x7d5)](_0x4aaca6(0x89b))[_0x4aaca6(0x988)]('click', _0xf50082); return; } const _0x2b29dd = 0x2, _0x162ec2 = [..._0xbcd483[_0x4aaca6(0x46c)]][_0x4aaca6(0x25d)]((_0x1f5f0e, _0x44c822) => _0x1f5f0e[_0x4aaca6(0x921)] - _0x44c822[_0x4aaca6(0x921)]), _0x26325d = []; for (let _0x4b52f5 = 0x0; _0x4b52f5 < _0x162ec2['length']; _0x4b52f5 += _0x2b29dd) { _0x26325d[_0x4aaca6(0x98f)](_0x162ec2[_0x4aaca6(0x6d1)](_0x4b52f5, _0x4b52f5 + _0x2b29dd)); } const _0xa38abf = _0x26325d[_0x4aaca6(0x280)]; _0x26325d[_0x4aaca6(0x8c0)]((_0x3e07ce, _0x59baa5) => { const _0x54def9 = _0x4aaca6; if (_0x54def9(0x4b3) !== _0x54def9(0x4b3)) _0x5258e1[_0x54def9(0x98f)]('[' + _0x1d0cbc(_0x2e5a70) + _0x54def9(0x177) + (_0x303d86[_0x54def9(0x75a)]?.[_0x54def9(0x2a3)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { const _0x2011cd = document[_0x54def9(0xa30)]('div'); _0x2011cd[_0x54def9(0x828)] = 'diary-page', _0x2011cd['id'] = _0x54def9(0xa52) + _0x59baa5, _0x59baa5 === _0x13c410[_0x54def9(0x436)] && _0x2011cd[_0x54def9(0x349)]['add'](_0x54def9(0x6e2)), _0x3e07ce[_0x54def9(0x8c0)](_0x544e0f => { const _0x3c00cd = _0x54def9; if (_0x3c00cd(0x255) === 'vwVYG') { const _0x7559b6 = _0x544e0f[_0x3c00cd(0x6d2)] === 'user' ? _0x3c00cd(0x425) : 'ai', _0x165ecc = _0x544e0f['author'] === _0x3c00cd(0x425) ? _0x4ebf42[_0x3c00cd(0x695)] : _0x1d08b4(_0x544e0f[_0x3c00cd(0x6d2)])[_0x3c00cd(0x695)], _0x5f3325 = document[_0x3c00cd(0xa30)]('div'); _0x5f3325[_0x3c00cd(0x828)] = 'diary-entry\x20' + _0x7559b6, _0x5f3325[_0x3c00cd(0x14b)][_0x3c00cd(0x921)] = _0x544e0f[_0x3c00cd(0x921)], _0x5f3325[_0x3c00cd(0x462)][_0x3c00cd(0x8cf)] = _0x3c00cd(0x794), _0x5f3325['style'][_0x3c00cd(0x3ea)] = '0', _0x5f3325[_0x3c00cd(0x65e)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>' + _0x165ecc + _0x3c00cd(0x22d) + new Date(_0x544e0f[_0x3c00cd(0x921)])[_0x3c00cd(0x79b)](_0x3c00cd(0x14d)) + _0x3c00cd(0x3fa) + _0x544e0f[_0x3c00cd(0x75a)]['replace'](/\n/g, _0x3c00cd(0x783)) + _0x3c00cd(0x586), _0x2011cd['appendChild'](_0x5f3325); } else _0x4e8a4f(_0x6430f9['id']); }), _0x5de269[_0x54def9(0x3fd)](_0x2011cd); } }), _0x3fd1bd['innerHTML'] = _0x4aaca6(0x1cd) + (_0x13c410[_0x4aaca6(0x436)] + 0x1) + '\x20/\x20' + _0xa38abf + '\x20页</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-next-button\x22>下一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', document[_0x4aaca6(0x7d5)](_0x4aaca6(0x60a))[_0x4aaca6(0x99f)] = _0x13c410[_0x4aaca6(0x436)] === 0x0, document['getElementById'](_0x4aaca6(0x7b3))[_0x4aaca6(0x99f)] = _0x13c410[_0x4aaca6(0x436)] === _0xa38abf - 0x1, document[_0x4aaca6(0x7d5)](_0x4aaca6(0x60a))['addEventListener'](_0x4aaca6(0x649), _0x383a4b), document[_0x4aaca6(0x7d5)](_0x4aaca6(0x7b3))['addEventListener'](_0x4aaca6(0x649), _0x2b412b), document['getElementById'](_0x4aaca6(0x870))[_0x4aaca6(0x988)]('click', _0x302636), document[_0x4aaca6(0x7d5)]('diary-get-reply-button')[_0x4aaca6(0x988)](_0x4aaca6(0x649), _0xf50082); } function _0x2b412b() { const _0x58ba1f = _0x314838; if (_0x13c410[_0x58ba1f(0x338)]) return; const _0x4428da = _0x13c410[_0x58ba1f(0x436)], _0x21df75 = Math[_0x58ba1f(0x742)](_0x13c410[_0x58ba1f(0x324)][_0x58ba1f(0x9b9)](_0x467895 => _0x467895[_0x58ba1f(0x951)] === _0x13c410[_0x58ba1f(0x78f)])[_0x58ba1f(0x46c)]['length'] / 0x2); if (_0x4428da >= _0x21df75 - 0x1) return; _0x13c410[_0x58ba1f(0x338)] = !![]; const _0x44eedd = _0x4428da + 0x1, _0x21887f = document[_0x58ba1f(0x7d5)](_0x58ba1f(0xa52) + _0x4428da), _0x14965d = document[_0x58ba1f(0x7d5)]('diary-page-' + _0x44eedd); _0x21887f && _0x14965d ? (_0x14965d[_0x58ba1f(0x349)][_0x58ba1f(0x699)](_0x58ba1f(0x949)), _0x21887f[_0x58ba1f(0x349)][_0x58ba1f(0x699)](_0x58ba1f(0x306)), _0x14965d[_0x58ba1f(0x349)][_0x58ba1f(0x699)](_0x58ba1f(0x6e2)), setTimeout(() => { const _0x1f718c = _0x58ba1f; if (_0x1f718c(0x864) === _0x1f718c(0x92d)) { if (!_0x5c0030[_0x1f718c(0x850)](_0x127a0)) return _0x1f718c(0xa1a); if (_0x322f32[_0x1f718c(0x280)] === 0x0) return '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有购物记录。</p>'; return _0x4cd44f[_0x1f718c(0x25d)]((_0xf0404c, _0x118eea) => new _0x279670(_0x118eea['timestamp']) - new _0x40710e(_0xf0404c[_0x1f718c(0x921)])), _0x1b5972[_0x1f718c(0x33d)](_0xde70c1 => _0x1f718c(0x21b) + (_0xde70c1['store_name'] || _0x1f718c(0x12d)) + _0x1f718c(0x658) + (_0xde70c1[_0x1f718c(0x921)] || '') + _0x1f718c(0x57b) + (_0xde70c1['item_name'] || _0x1f718c(0x4bd)) + _0x1f718c(0x12b) + (_0xde70c1[_0x1f718c(0x367)] || 0x0)[_0x1f718c(0x176)](0x2) + _0x1f718c(0x39c))['join'](''); } else _0x21887f[_0x1f718c(0x349)][_0x1f718c(0x330)]('is-visible', _0x1f718c(0x306)), _0x14965d['classList'][_0x1f718c(0x330)](_0x1f718c(0x949)), _0x13c410[_0x1f718c(0x436)] = _0x44eedd, _0x8954bc(), _0x13c410[_0x1f718c(0x338)] = ![]; }, 0x2bc)) : _0x58ba1f(0x59c) !== _0x58ba1f(0x925) ? _0x13c410[_0x58ba1f(0x338)] = ![] : _0x128202 = _0x311268[_0x58ba1f(0x6ed)][0x0]; } function _0x383a4b() { const _0x3a8124 = _0x314838; if ('icsex' === _0x3a8124(0x356)) _0x4ab387[_0x3a8124(0x268)] = _0x2eca2c['createObjectURL'](_0x3b396f), _0xb09151[_0x3a8124(0x462)]['display'] = _0x3a8124(0x10c); else { if (_0x13c410['isAnimatingDiary']) return; const _0x1291a5 = _0x13c410[_0x3a8124(0x436)]; if (_0x1291a5 <= 0x0) return; _0x13c410[_0x3a8124(0x338)] = !![]; const _0x5ea61d = _0x1291a5 - 0x1, _0x16e99d = document[_0x3a8124(0x7d5)](_0x3a8124(0xa52) + _0x1291a5), _0x33f4ed = document[_0x3a8124(0x7d5)](_0x3a8124(0xa52) + _0x5ea61d); if (_0x16e99d && _0x33f4ed) _0x33f4ed['classList'][_0x3a8124(0x699)](_0x3a8124(0x685)), _0x16e99d[_0x3a8124(0x349)][_0x3a8124(0x699)](_0x3a8124(0x801)), _0x33f4ed[_0x3a8124(0x349)][_0x3a8124(0x699)]('is-visible'), setTimeout(() => { const _0x3df112 = _0x3a8124; 'GyiHc' === _0x3df112(0x2c8) ? _0x1835fe(_0x58537a) : (_0x16e99d['classList'][_0x3df112(0x330)](_0x3df112(0x6e2), 'is-exiting-right'), _0x33f4ed['classList'][_0x3df112(0x330)](_0x3df112(0x685)), _0x13c410[_0x3df112(0x436)] = _0x5ea61d, _0x8954bc(), _0x13c410[_0x3df112(0x338)] = ![]); }, 0x2bc); else { if (_0x3a8124(0x674) !== _0x3a8124(0x674)) { const _0x5f42bf = _0x189632[_0x3a8124(0x7d5)](_0x3a8124(0x8c1)), _0x54b7d6 = _0x471e73[_0x3a8124(0x7d5)](_0x3a8124(0x142)), _0x245ece = _0x51a385[_0x3a8124(0x7d5)](_0x3a8124(0x929)), _0x34761c = _0x1804be[_0x3a8124(0x7d5)](_0x3a8124(0x63f)), _0x85243b = _0x233b8a[_0x3a8124(0x7d5)]('modal-mask'); _0x54b7d6[_0x3a8124(0x9e0)] = _0x24405f, _0x5f42bf[_0x3a8124(0x462)]['display'] = 'flex'; const _0x291b64 = _0x139246 => { const _0x363e64 = _0x3a8124; _0x5f42bf[_0x363e64(0x462)][_0x363e64(0x5f3)] = _0x363e64(0x794), _0x245ece[_0x363e64(0x779)] = _0x34761c[_0x363e64(0x779)] = _0x85243b[_0x363e64(0x779)] = null, _0x45195c[_0x363e64(0x7f6)](_0x363e64(0x610), _0x1cdfb3), _0x16194b(_0x139246); }, _0x1cdfb3 = _0x704e0 => { const _0x34e518 = _0x3a8124; if (_0x704e0[_0x34e518(0x8ee)] === 'Escape') _0x291b64(![]); if (_0x704e0[_0x34e518(0x8ee)] === 'Enter') _0x291b64(!![]); }; _0x245ece[_0x3a8124(0x779)] = () => _0x291b64(!![]), _0x34761c[_0x3a8124(0x779)] = () => _0x291b64(![]), _0x85243b[_0x3a8124(0x779)] = () => _0x291b64(![]), _0x12c81d[_0x3a8124(0x988)]('keydown', _0x1cdfb3); } else _0x13c410['isAnimatingDiary'] = ![]; } } } function _0x302636() { return new Promise(_0xf880e1 => { const _0x20c09a = _0x13a6, _0xaa401a = _0x20c09a(0xa79); document[_0x20c09a(0x32a)][_0x20c09a(0x7a2)](_0x20c09a(0x168), _0xaa401a); const _0x322d47 = document[_0x20c09a(0x7d5)](_0x20c09a(0x460)), _0x494c5c = document[_0x20c09a(0x7d5)]('diary-modal-textarea'), _0x223bde = document[_0x20c09a(0x7d5)](_0x20c09a(0x1ba)), _0xdbc9a6 = document[_0x20c09a(0x7d5)](_0x20c09a(0x400)), _0x1004cb = _0x322d47['querySelector']('.choice-modal-backdrop'), _0x4a93df = () => { const _0x4bd2a9 = _0x20c09a; if (_0x4bd2a9(0x244) !== _0x4bd2a9(0x815)) _0x322d47[_0x4bd2a9(0x330)](), _0xf880e1(); else { const _0x2569e8 = []; if (_0x58dfac[_0x4bd2a9(0x75a)]) _0x2569e8[_0x4bd2a9(0x98f)]({ 'text': _0x1a1373[_0x4bd2a9(0x75a)] }); if (_0x49ef34[_0x4bd2a9(0x98c)]) { const _0x1ede07 = _0x2367c9[_0x4bd2a9(0x98c)][_0x4bd2a9(0x17a)](',')[0x1], _0x1d8a44 = _0x100b4a['image'][_0x4bd2a9(0x5e0)](_0x530718[_0x4bd2a9(0x98c)][_0x4bd2a9(0x861)](':') + 0x1, _0x5938b5[_0x4bd2a9(0x98c)]['indexOf'](';')) || _0x4bd2a9(0xe9); _0x2569e8['push']({ 'inline_data': { 'mime_type': _0x1d8a44, 'data': _0x1ede07 } }); } return _0x2569e8; } }; _0x223bde[_0x20c09a(0x779)] = () => { _0x45f8d8(_0x494c5c['value']), _0x4a93df(); }, _0xdbc9a6[_0x20c09a(0x779)] = _0x4a93df, _0x1004cb[_0x20c09a(0x779)] = _0x4a93df; }); } function _0x45f8d8(_0x41a825) { const _0x3b7c6a = _0x314838; if ('FHJnJ' === _0x3b7c6a(0x9f5)) { const _0x58bb2c = _0x41a825['trim'](); if (!_0x58bb2c || !_0x13c410['activeDiaryCharacterId']) return; let _0x2c7f65 = _0x13c410['diaries']['find'](_0x54404a => _0x54404a[_0x3b7c6a(0x951)] === _0x13c410[_0x3b7c6a(0x78f)]); !_0x2c7f65 && (_0x2c7f65 = { 'characterId': _0x13c410[_0x3b7c6a(0x78f)], 'entries': [] }, _0x13c410[_0x3b7c6a(0x324)]['push'](_0x2c7f65)); _0x2c7f65[_0x3b7c6a(0x46c)][_0x3b7c6a(0x98f)]({ 'timestamp': Date['now'](), 'author': _0x3b7c6a(0x425), 'content': _0x58bb2c }), _0x5834f1(); const _0x12e7a2 = _0x2c7f65[_0x3b7c6a(0x46c)]['length']; _0x13c410[_0x3b7c6a(0x436)] = Math[_0x3b7c6a(0x742)](_0x12e7a2 / 0x2) - 0x1, _0x8954bc(); } else _0x1cda66['removeItem'](_0x3b7c6a(0x49b)), _0x559ba3[_0x3b7c6a(0x7ec)](_0x3b7c6a(0x2cd)), _0x40c474('位置已重置，正在刷新...'), _0x36c7e1(() => _0x1650d0[_0x3b7c6a(0x569)](), 0x3e8); } async function _0xf50082() { const _0x45c8f = _0x314838, _0x16d5d1 = _0x13c410['diaries'][_0x45c8f(0x9b9)](_0x2171d8 => _0x2171d8[_0x45c8f(0x951)] === _0x13c410['activeDiaryCharacterId']), _0x2c1cb2 = _0x13c410[_0x45c8f(0x78f)], _0x2c4471 = _0x1d08b4(_0x2c1cb2); if (!_0x2c4471 || _0x13c410['isGenerating']) return; _0x1f66de(!![], _0x45c8f(0x599)), _0x13c410[_0x45c8f(0x1e8)] = !![]; let _0x528d5f = []; try { if (_0x45c8f(0x733) === _0x45c8f(0x733)) { const _0x12df78 = _0x444594() || { 'name': '你' }, _0x4607b7 = _0x40d5ca(_0x2c1cb2), { omniText: _0x41a673 } = _0x32d34b(_0x2c1cb2, _0x13c410[_0x45c8f(0x55f)]); let _0x17a962 = ''; if (_0x2c4471[_0x45c8f(0x7d8)] && _0x2c4471['linkedWorldBookIds'][_0x45c8f(0x280)] > 0x0) { if (_0x45c8f(0x983) === 'ECpQd') { const _0x260bc5 = _0x2c4471['linkedWorldBookIds'][_0x45c8f(0x33d)](_0x1103a5 => _0x13c410[_0x45c8f(0x90d)]['find'](_0x418a9e => _0x418a9e['id'] === _0x1103a5))[_0x45c8f(0x61f)](Boolean)[_0x45c8f(0x33d)](_0x378e6e => '\x0a\x0a##\x20世界书条目:\x20' + _0x378e6e[_0x45c8f(0x695)] + '\x0a' + _0x378e6e[_0x45c8f(0x75a)])[_0x45c8f(0x8aa)](''); if (_0x260bc5) _0x17a962 = '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a' + _0x260bc5; } else _0x2f84e1(), _0x237390(_0x45c8f(0x5bd), _0x45c8f(0x73e)); } const _0x2fbf2c = _0x12df78['persona'] ? '\x0a\x0a#\x20关于读者“' + _0x12df78[_0x45c8f(0x695)] + _0x45c8f(0x891) + _0x12df78[_0x45c8f(0x2a1)] : '', _0xec3d5b = _0x35b71c(); let _0x4a9c66 = _0x45c8f(0x3d0); if (_0x16d5d1 && _0x16d5d1[_0x45c8f(0x46c)]) { const _0x1426c0 = _0x16d5d1['entries'][_0x45c8f(0x61f)](_0x5aefb0 => _0x5aefb0[_0x45c8f(0x6d2)] === _0x45c8f(0x425))['pop'](); _0x1426c0 && (_0x4a9c66 = _0x1426c0['content']); } const _0x3a3de4 = _0x45c8f(0x6db) + _0x2c4471['name'] + _0x45c8f(0x10e) + _0x12df78[_0x45c8f(0x695)] + _0x45c8f(0x889) + _0x12df78[_0x45c8f(0x695)] + _0x45c8f(0x896) + _0x4a9c66 + _0x45c8f(0xe6) + _0x2c4471[_0x45c8f(0x2a1)] + '\x0a' + _0x2fbf2c + '\x0a' + _0x17a962 + _0x45c8f(0x4af) + new Date()[_0x45c8f(0x79b)](_0x45c8f(0x14d), { 'dateStyle': 'full', 'timeStyle': _0x45c8f(0x3eb) }) + _0x45c8f(0x8fa) + _0x50e57d(new Date(_0x16d5d1?.['entries']?.['at'](-0x1)?.[_0x45c8f(0x921)] || Date[_0x45c8f(0x2f2)]())) + _0x45c8f(0x630) + (_0x41a673 || '最近没有互动记录。') + '\x0a---\x0a##\x20最近的朋友圈动态\x0a' + (_0xec3d5b || _0x45c8f(0x9a4)) + '\x0a---\x0a\x0a#\x20输出要求\x0a直接输出一篇有文采、有真情实感的日记正文，不要包含任何其他说明或前缀。'; _0x528d5f = [{ 'role': _0x45c8f(0x711), 'content': _0x3a3de4 }, { 'role': _0x45c8f(0x425), 'content': _0x45c8f(0x5ae) }]; const _0x1d1af0 = await _0x39cd5c(_0x528d5f); if (_0x1d1af0) { let _0x40907d = _0x13c410[_0x45c8f(0x324)][_0x45c8f(0x9b9)](_0x4ddea9 => _0x4ddea9[_0x45c8f(0x951)] === _0x2c1cb2); !_0x40907d && (_0x40907d = { 'characterId': _0x2c1cb2, 'entries': [] }, _0x13c410['diaries'][_0x45c8f(0x98f)](_0x40907d)); _0x40907d[_0x45c8f(0x46c)][_0x45c8f(0x98f)]({ 'timestamp': Date[_0x45c8f(0x2f2)](), 'author': _0x2c1cb2, 'content': _0x1d1af0 }), _0x5834f1(); const _0x1d041d = _0x40907d[_0x45c8f(0x46c)][_0x45c8f(0x280)]; _0x13c410[_0x45c8f(0x436)] = Math['ceil'](_0x1d041d / 0x2) - 0x1, _0x8954bc(); } } else { const _0x364574 = _0x434af7[_0x45c8f(0x38a)](_0x5b9c4a, _0x45c8f(0x989)), _0xd4671a = _0x364574[_0x45c8f(0x4bb)](_0x5e7ff0), _0x324eaa = _0xd4671a['put']({ 'id': _0x2dc475, 'blob': _0x185817 }); _0x324eaa[_0x45c8f(0x804)] = () => _0x13dd75(_0x324eaa[_0x45c8f(0x211)]), _0x324eaa[_0x45c8f(0xaa9)] = () => _0x2c386b(_0x324eaa[_0x45c8f(0x11e)]); } } catch (_0x42e9d7) { if (_0x45c8f(0x135) !== _0x45c8f(0x23b)) _0x1e9edf(_0x45c8f(0x490) + _0x42e9d7[_0x45c8f(0x496)]); else { const _0x5149c8 = _0x45c8f(0x371) + _0x30d3ee; let _0x1a6956 = _0x4a6cc9[_0x45c8f(0x7d5)](_0x5149c8); if (_0x1a6956) return; const _0x3709d5 = '\x0a\x20\x20\x20\x20<div\x20id=\x22' + _0x5149c8 + _0x45c8f(0x93e) + (_0x38b6aa === 'ai' ? _0x45c8f(0x544) : '') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20'; _0xb33c6f[_0x45c8f(0x32a)]['insertAdjacentHTML'](_0x45c8f(0x168), _0x3709d5); const _0x5acbe3 = _0x3d6932[_0x45c8f(0x7d5)](_0x5149c8), _0x4250b3 = () => _0x5acbe3['remove'](); _0x5acbe3[_0x45c8f(0x298)](_0x45c8f(0x154))[_0x45c8f(0x779)] = _0x4250b3, _0x5acbe3[_0x45c8f(0x298)]('#diary-action-cancel')[_0x45c8f(0x779)] = _0x4250b3, _0x5acbe3['querySelector'](_0x45c8f(0x9ef))['onclick'] = () => { _0x514692(_0x46368a), _0x4250b3(); }, _0x3e5694 === 'ai' && (_0x5acbe3['querySelector'](_0x45c8f(0x7bb))[_0x45c8f(0x779)] = () => { _0x1dda58(_0x4c126e), _0x4250b3(); }); } } finally { _0x1f66de(![]), _0x13c410[_0x45c8f(0x1e8)] = ![]; } } function _0x459b6a() { const _0x4fac1e = _0x314838; if (_0x4fac1e(0x4d7) === _0x4fac1e(0x780)) _0x5f0dee[_0x4fac1e(0x2e4)][_0x4fac1e(0x3f5)](_0x22096c, 0x1), _0x518cbb(), _0x3574df(); else { const _0x50a386 = document[_0x4fac1e(0x7d5)]('meeting-scene-view'), _0x3aec23 = document[_0x4fac1e(0x7d5)](_0x4fac1e(0x769)), _0x422aca = document['querySelector'](_0x4fac1e(0x978)); _0x13c410[_0x4fac1e(0x576)] === _0x4fac1e(0x67f) ? (_0x50a386['style'][_0x4fac1e(0x5f3)] = 'none', _0x3aec23['style'][_0x4fac1e(0x5f3)] = 'block') : (_0x50a386[_0x4fac1e(0x462)][_0x4fac1e(0x5f3)] = _0x4fac1e(0x10c), _0x3aec23[_0x4fac1e(0x462)][_0x4fac1e(0x5f3)] = _0x4fac1e(0x794)), _0x422aca[_0x4fac1e(0x462)][_0x4fac1e(0x5f3)] = _0x4fac1e(0x10c); } } function _0x205c90() { const _0x35cfa5 = _0x314838; if (_0x35cfa5(0x4ab) === _0x35cfa5(0x29f)) _0x5a2be8[_0x35cfa5(0x6ed)] = _0x3c95c5['userProfiles'], _0x5749ce[_0x35cfa5(0x56d)] = _0x5232eb['activeUserProfileId']; else { const _0x21e471 = document[_0x35cfa5(0x7d5)](_0x35cfa5(0x812)), _0x2438d5 = document[_0x35cfa5(0x7d5)](_0x35cfa5(0x497)); if (_0x13c410[_0x35cfa5(0x12e)][_0x35cfa5(0x280)] > 0x0) { if (_0x35cfa5(0x5d0) !== _0x35cfa5(0x5d0)) _0x35977f['style'][_0x35cfa5(0x5f3)] = _0x35cfa5(0x794), _0x3a9802['style'][_0x35cfa5(0x5f3)] = _0x35cfa5(0x10c); else { const _0x484da3 = _0x13c410[_0x35cfa5(0x12e)]['shift'](); _0x21e471[_0x35cfa5(0x9e0)] = _0x484da3[_0x35cfa5(0x31c)] === _0x35cfa5(0x2a6) ? '旁白' : _0x484da3['speaker'], _0x2438d5[_0x35cfa5(0x9e0)] = _0x484da3[_0x35cfa5(0x56f)], _0x484da3['speaker'] !== _0x35cfa5(0x2a6) && _0x5491ac(_0x13c410[_0x35cfa5(0x2c7)], _0x484da3['emotion']); } } else { if (_0x35cfa5(0x81b) === _0x35cfa5(0x44c)) _0x2dc970(_0x3690a9, _0x2fe732['target']['files'][0x0]); else { const _0x3743a6 = _0x13c410[_0x35cfa5(0x2f9)][_0x13c410[_0x35cfa5(0x2c7)]]; if (_0x3743a6 && _0x3743a6[_0x35cfa5(0x280)] > 0x0) { _0x13c410[_0x35cfa5(0x12e)] = [..._0x3743a6]; const _0x59a885 = _0x13c410[_0x35cfa5(0x12e)][_0x35cfa5(0x13c)](); _0x21e471[_0x35cfa5(0x9e0)] = _0x59a885['speaker'] === _0x35cfa5(0x2a6) ? '旁白' : _0x59a885[_0x35cfa5(0x31c)], _0x2438d5['textContent'] = _0x59a885[_0x35cfa5(0x56f)], _0x59a885[_0x35cfa5(0x31c)] !== _0x35cfa5(0x2a6) && _0x5491ac(_0x13c410[_0x35cfa5(0x2c7)], _0x59a885[_0x35cfa5(0x248)]); } else _0x21e471[_0x35cfa5(0x9e0)] = '旁白', _0x2438d5[_0x35cfa5(0x9e0)] = _0x35cfa5(0x87f); } } } } async function _0x5491ac(_0x1fc781, _0xee14b9) { const _0x5d3637 = _0x314838, _0x424da9 = document[_0x5d3637(0x7d5)]('galgame-sprite'), _0x439bde = document['getElementById'](_0x5d3637(0x713)), _0x1b198e = _0x1d08b4(_0x1fc781), _0x9b99c3 = _0x1b198e?.['spriteTransform'] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }, _0x3ed093 = 0x50 * _0x9b99c3['scale']; _0x439bde[_0x5d3637(0x462)][_0x5d3637(0x8ed)] = _0x3ed093 + '%', _0x439bde[_0x5d3637(0x462)][_0x5d3637(0x7a7)] = _0x3ed093 + '%', _0x439bde['style'][_0x5d3637(0x26c)] = _0x9b99c3['x'] + '%', _0x439bde[_0x5d3637(0x462)]['top'] = _0x9b99c3['y'] + '%', _0x439bde[_0x5d3637(0x462)][_0x5d3637(0x424)] = _0x5d3637(0x8a3), _0x439bde[_0x5d3637(0x462)][_0x5d3637(0x55c)] = 'auto'; const _0x242c0d = [_0x5d3637(0x6a9), 'happy', _0x5d3637(0x69a), 'sad', _0x5d3637(0xa20)], _0x26061e = _0x242c0d[_0x5d3637(0x71e)](_0xee14b9) ? _0xee14b9 : _0x5d3637(0x6a9); try { if (_0x5d3637(0x3c5) !== _0x5d3637(0x5f6)) { const _0x4725a8 = await _0xb9bbbf('char_sprite_' + _0x26061e + '_' + _0x1fc781); if (_0x4725a8) { if (_0x424da9['src'] && _0x424da9[_0x5d3637(0x462)][_0x5d3637(0x669)] !== '0') { if (_0x5d3637(0x746) === _0x5d3637(0x746)) _0x424da9[_0x5d3637(0x462)][_0x5d3637(0x669)] = 0x0, setTimeout(() => { const _0x54a32f = _0x5d3637; _0x54a32f(0x648) === _0x54a32f(0x648) ? (_0x424da9[_0x54a32f(0x268)] = URL[_0x54a32f(0x602)](_0x4725a8), _0x424da9['style']['opacity'] = 0x1) : _0x526c10[_0x54a32f(0x2e4)][_0x54a32f(0x98f)](..._0x4cb704['originalExpenses']); }, 0x96); else { const _0x1b5bd1 = _0x5a5737['round']((_0x22105b - _0x17068a) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x34391e += '-\x20**对话状态提示**:\x20你们已经有\x20' + _0x1b5bd1 + _0x5d3637(0x869); } } else _0x5d3637(0x545) !== _0x5d3637(0x545) ? _0x5ab240[_0x5d3637(0x7ec)](_0x5d3637(0x151) + _0x4f5e8e['id']) : (_0x424da9[_0x5d3637(0x268)] = URL['createObjectURL'](_0x4725a8), _0x424da9[_0x5d3637(0x462)][_0x5d3637(0x669)] = 0x1); } else { if (_0x5d3637(0x4ce) === _0x5d3637(0x4ce)) { const _0x1ad0bd = await _0xb9bbbf(_0x5d3637(0x388) + _0x1fc781); _0x424da9[_0x5d3637(0x268)] = _0x1ad0bd ? URL[_0x5d3637(0x602)](_0x1ad0bd) : ''; } else _0x16df6d(_0x5d3637(0x7c3)); } } else { const _0x240aad = _0x5062f2[_0x5d3637(0x602)](_0x4ef952); _0x5b02bb['src'] = _0x240aad, _0xac65ff[_0x5d3637(0x3a5)] = () => _0x193efb[_0x5d3637(0x918)](_0x240aad); } } catch (_0x516877) { if (_0x5d3637(0x935) === _0x5d3637(0x953)) { if (_0x934515[_0x5d3637(0x4cc)] === 'user') return _0x2323ea['userProfile']?.[_0x5d3637(0x695)] || _0x5d3637(0x480); if (_0x19edcd['type'] === _0x5d3637(0x9ad)) { const _0x9aa792 = _0x3abb01[_0x5d3637(0x7c4)] ? _0x29884b(_0x1ca714[_0x5d3637(0x7c4)]) : null; return _0x9aa792?.[_0x5d3637(0x695)] || _0x5d3637(0x603); } else { const _0x380ea2 = _0x535731(_0x5510be[_0x5d3637(0x9c8)][0x0]); return _0x380ea2?.['name'] || 'AI'; } } else console[_0x5d3637(0x11e)]('加载立绘失败:', _0x516877), _0x424da9[_0x5d3637(0x268)] = ''; } } let _0x445719 = ![], _0x33ad17 = { 'isDragging': ![], 'isResizing': ![], 'startX': 0x0, 'startY': 0x0, 'startLeft': 0x0, 'startTop': 0x0, 'startWidth': 0x0, 'startHeight': 0x0 }; const _0x5805db = document[_0x314838(0x7d5)](_0x314838(0x511)), _0x253f6a = document[_0x314838(0x7d5)]('sprite-confirm-button'), _0x29a663 = document['getElementById'](_0x314838(0xf0)), _0x55f409 = document[_0x314838(0x7d5)]('sprite-reset-button'), _0x333d54 = document[_0x314838(0x7d5)](_0x314838(0x6b8)), _0x1105d4 = document['getElementById'](_0x314838(0x713)), _0x2db3ef = document[_0x314838(0x7d5)](_0x314838(0x537)), _0x147fd2 = document['getElementById'](_0x314838(0x63e)); let _0x35f882 = {}; function _0x31aa43() { const _0x558bb5 = _0x314838, _0x73d734 = _0x1d08b4(_0x13c410['activeMeetingCharId']); if (!_0x73d734) return; _0x445719 = !![], _0x333d54[_0x558bb5(0x462)]['display'] = _0x558bb5(0x10c); const _0x202031 = _0x73d734[_0x558bb5(0x1e6)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; document[_0x558bb5(0x7d5)](_0x558bb5(0x259))['value'] = _0x202031['x'], document[_0x558bb5(0x7d5)](_0x558bb5(0x5b1))[_0x558bb5(0x4d3)] = _0x202031['y'], document[_0x558bb5(0x7d5)](_0x558bb5(0x44b))[_0x558bb5(0x4d3)] = _0x202031[_0x558bb5(0x975)] * 0x64, _0x35f882 = { ..._0x202031 }, document[_0x558bb5(0x7d5)](_0x558bb5(0x728))[_0x558bb5(0x462)]['display'] = 'none', document[_0x558bb5(0x7d5)]('galgame-sprite-adjust-ui')[_0x558bb5(0x462)][_0x558bb5(0x5f3)] = _0x558bb5(0x794); } function _0x37e63c(_0x37ae57 = ![]) { const _0xe90f65 = _0x314838; if (_0xe90f65(0x954) !== _0xe90f65(0xa5a)) { _0x445719 = ![], _0x333d54[_0xe90f65(0x462)]['display'] = _0xe90f65(0x794), document[_0xe90f65(0x7d5)]('galgame-textbox-container')[_0xe90f65(0x462)][_0xe90f65(0x5f3)] = _0xe90f65(0x10c), document['getElementById'](_0xe90f65(0xa82))[_0xe90f65(0x462)]['display'] = 'block'; if (!_0x37ae57) { const _0x5a9aee = _0x1d08b4(_0x13c410['activeMeetingCharId']); if (_0x5a9aee) { if (_0xe90f65(0x20d) === _0xe90f65(0x4a2)) { const _0x22de9b = _0x3adc1b[_0xe90f65(0x826)]['map'](_0x24d0d1 => { const _0x59b8f7 = _0xe90f65, _0x20c001 = _0x2e7d34(_0x24d0d1[_0x59b8f7(0x374)])?.[_0x59b8f7(0x695)] || '未知'; return _0x59b8f7(0xa72) + _0x20c001 + _0x59b8f7(0x84d) + _0x24d0d1[_0x59b8f7(0x75a)] + _0x59b8f7(0x447); })['join'](''); _0x23eed = _0xe90f65(0x101) + _0x22de9b + '</div>'; } else _0x5a9aee[_0xe90f65(0x1e6)] = _0x35f882, _0x5491ac(_0x13c410[_0xe90f65(0x2c7)], _0xe90f65(0x6a9)); } } } else { const _0x377cf7 = _0x16de22[_0xe90f65(0x6d7)][_0xe90f65(0x6ea)][0x0]; if (!_0x377cf7) return; try { _0x31259b[_0xe90f65(0x268)] = _0x1f47ae[_0xe90f65(0x602)](_0x377cf7); } catch (_0x1a0959) { _0x56b146(_0xe90f65(0x7c1) + _0x1a0959['message']); } } } function _0x57213d() { const _0x21609d = _0x314838, _0x503e95 = _0x1d08b4(_0x13c410[_0x21609d(0x2c7)]); if (!_0x503e95) return; const _0x4c1378 = parseFloat(document[_0x21609d(0x7d5)](_0x21609d(0x259))[_0x21609d(0x4d3)]), _0x50bdfa = parseFloat(document[_0x21609d(0x7d5)](_0x21609d(0x5b1))[_0x21609d(0x4d3)]), _0x312a41 = parseFloat(document[_0x21609d(0x7d5)]('sprite-slider-scale')[_0x21609d(0x4d3)]) / 0x64; _0x503e95[_0x21609d(0x1e6)] = { 'x': _0x4c1378, 'y': _0x50bdfa, 'scale': _0x312a41 }, _0x5834f1(), _0x1e9edf(_0x21609d(0x411)), _0x37e63c(!![]); } function _0x2469d0() { const _0x4006fc = _0x314838; 'icHCp' === _0x4006fc(0x47e) ? _0x37395d['error'](_0x4006fc(0x6e4), _0x763390) : _0x39a14a(_0x4006fc(0xa4c))[_0x4006fc(0x834)](_0x811d62 => { const _0x3abdff = _0x4006fc; if (_0x811d62) { if (_0x3abdff(0x67a) !== _0x3abdff(0xa67)) { const _0x460f5a = _0x1d08b4(_0x13c410[_0x3abdff(0x2c7)]); _0x460f5a && (_0x3abdff(0x4db) !== _0x3abdff(0x6ee) ? (delete _0x460f5a[_0x3abdff(0x1e6)], _0x5834f1(), _0x5491ac(_0x460f5a['id'], _0x3abdff(0x6a9)), _0x1e9edf(_0x3abdff(0x4d8)), _0x37e63c(!![])) : _0x2f82a7['conversationHistory'] = []); } else { _0x170ac7['warn'](_0x3abdff(0x52d) + _0x4e10c8['id'] + _0x3abdff(0x20b), _0x517573['message']); try { _0x2d5bba = _0x2a1993(_0x5db618); if (!_0x32fb2b) throw new _0x54ffa8(_0x3abdff(0x41c)); _0x4caf32[_0x3abdff(0x688)](_0x3abdff(0x3b9) + _0x4c12d4['id'] + '\x20的旧格式数据翻译。'); } catch (_0x4cbcdf) { throw _0x9f6396; } } } }); } function _0x2bcb0f() { const _0x558174 = _0x314838; if (_0x558174(0x80a) !== 'Dwbgc') { const _0x3cb7f7 = _0x4b2014['getElementById']('daily-expenses-list'), _0x10a082 = _0x473fb['getElementById'](_0x558174(0x8f5)), _0x508100 = new _0x3e10fa(), _0x1e4927 = _0x49cbcf[_0x558174(0x2e4)][_0x558174(0x61f)](_0x4dd003 => new _0x159570(_0x4dd003[_0x558174(0x921)])[_0x558174(0x7ab)]() === _0x508100[_0x558174(0x7ab)]()); if (_0x1e4927[_0x558174(0x280)] === 0x0) { _0x3cb7f7['innerHTML'] = _0x558174(0x86c), _0x10a082[_0x558174(0x65e)] = ''; return; } _0x3cb7f7['innerHTML'] = '', _0x1e4927[_0x558174(0x25d)]((_0x7be4bd, _0x488410) => _0x488410['timestamp'] - _0x7be4bd[_0x558174(0x921)])['forEach'](_0x35ee74 => { const _0x5bc292 = _0x558174, _0x66c095 = _0x29f106['createElement'](_0x5bc292(0xa8b)); _0x66c095[_0x5bc292(0x828)] = 'expense-item', _0x66c095[_0x5bc292(0x65e)] = _0x5bc292(0x134) + _0x35ee74[_0x5bc292(0x361)] + '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20' + _0x35ee74[_0x5bc292(0x5ca)][_0x5bc292(0x176)](0x2) + '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22' + _0x35ee74['id'] + _0x5bc292(0x6ab), _0x3cb7f7[_0x5bc292(0x3fd)](_0x66c095); }), _0x10a082 && (_0x10a082[_0x558174(0x65e)] = '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', _0x56a4f9[_0x558174(0x7d5)]('organize-bill-button')[_0x558174(0x988)](_0x558174(0x649), _0x36befa)); } else { if (!_0x445719) return; const _0x241dc2 = _0x13c410['activeMeetingCharId'], _0xcf2c3 = _0x1d08b4(_0x241dc2); if (!_0xcf2c3) return; const _0x483979 = parseFloat(document['getElementById'](_0x558174(0x259))[_0x558174(0x4d3)]), _0x4b8df6 = parseFloat(document['getElementById'](_0x558174(0x5b1))[_0x558174(0x4d3)]), _0x18fce9 = parseFloat(document['getElementById'](_0x558174(0x44b))[_0x558174(0x4d3)]) / 0x64; _0xcf2c3['spriteTransform'] = { 'x': _0x483979, 'y': _0x4b8df6, 'scale': _0x18fce9 }; const _0x4d010e = document['getElementById']('galgame-sprite-container'), _0x384935 = 0x50 * _0x18fce9; _0x4d010e[_0x558174(0x462)]['height'] = _0x384935 + '%', _0x4d010e[_0x558174(0x462)][_0x558174(0x7a7)] = _0x384935 + '%', _0x4d010e['style'][_0x558174(0x26c)] = _0x483979 + '%', _0x4d010e[_0x558174(0x462)][_0x558174(0x43a)] = _0x4b8df6 + '%', _0x4d010e[_0x558174(0x462)][_0x558174(0x424)] = _0x558174(0x8a3); } } document[_0x314838(0x7d5)](_0x314838(0x259))[_0x314838(0x988)](_0x314838(0x6b1), _0x2bcb0f), document['getElementById'](_0x314838(0x5b1))[_0x314838(0x988)]('input', _0x2bcb0f), document['getElementById'](_0x314838(0x44b))[_0x314838(0x988)](_0x314838(0x6b1), _0x2bcb0f), _0x5805db[_0x314838(0x988)](_0x314838(0x649), _0x31aa43), _0x253f6a[_0x314838(0x988)](_0x314838(0x649), _0x57213d), _0x29a663[_0x314838(0x988)]('click', () => _0x37e63c(![])), _0x55f409[_0x314838(0x988)](_0x314838(0x649), _0x2469d0); function _0x498be5(_0x3ade71) { const _0x489999 = _0x314838; if (_0x489999(0x373) !== 'lwtQQ') _0x4dc950 = _0x39a5b1['avatar'] || _0x6470a4, _0xebff6f = _0x44493a[_0x489999(0x695)] || _0x489999(0x229), _0x3f7e6a = _0x126084[_0x489999(0x67b)] || '私聊'; else { const _0x12afd9 = _0x1d08b4(_0x3ade71); if (!_0x12afd9) return; const _0x3008da = _0x13c410['chats']['find'](_0x1b7274 => _0x1b7274[_0x489999(0x974)] === _0x489999(0x293) && _0x1b7274[_0x489999(0x9c8)][_0x489999(0x71e)](_0x3ade71)), _0x26e87c = _0x328a3b(_0x3008da['id']), _0x2b5252 = _0x13c410[_0x489999(0x793)][_0x489999(0x61f)](_0x31dc03 => _0x31dc03['isOffline'])[_0x489999(0x19d)](), _0xfe086a = document[_0x489999(0x7d5)](_0x489999(0x812)), _0x1047cb = document[_0x489999(0x7d5)](_0x489999(0x497)); let _0x49d00f = null; if (_0x2b5252) { if (_0x2b5252[_0x489999(0x4cc)] === _0x489999(0x9bb)) { if ('HBHpW' === _0x489999(0x957)) { const _0x137d19 = _0x13c410[_0x489999(0x2f9)][_0x3ade71]; _0x137d19 && _0x137d19['length'] > 0x0 && (_0x49d00f = _0x137d19['at'](-0x1)); } else { _0x1a3a06 && (_0x276ca2(_0x15b2c5), _0x29e601 = null); _0x511078[_0x489999(0x7d5)]('snoop-app-view-container')[_0x489999(0x462)]['display'] = _0x489999(0x794); const _0x577151 = _0x239114[_0x489999(0x7d5)]('snoop-dock'); if (_0x577151) _0x577151[_0x489999(0x330)](); const _0x3105d6 = _0x1276f2['getElementById'](_0x489999(0x452)); if (_0x3105d6) _0x3105d6['remove'](); _0x388518(_0x489999(0x18d), _0x489999(0x82c)); } } else _0x49d00f = { 'speaker': _0x26e87c['name'], 'line': _0x2b5252[_0x489999(0x75a)], 'emotion': _0x489999(0x6a9) }; } _0x49d00f ? (_0xfe086a[_0x489999(0x9e0)] = _0x49d00f[_0x489999(0x31c)] === _0x489999(0x2a6) ? '旁白' : _0x49d00f[_0x489999(0x31c)], _0x1047cb['textContent'] = _0x49d00f[_0x489999(0x56f)], _0x49d00f['speaker'] === _0x12afd9[_0x489999(0x695)] ? _0x5491ac(_0x3ade71, _0x49d00f[_0x489999(0x248)]) : 'xVvAl' === _0x489999(0x9dc) ? (_0x2c9905['appendChild'](_0x5732fb), _0x31f98c[_0x489999(0x3fd)](_0x21a143)) : _0x5491ac(_0x3ade71, _0x489999(0x6a9))) : (_0xfe086a[_0x489999(0x9e0)] = _0x12afd9['name'], _0x1047cb[_0x489999(0x9e0)] = '（开始一段新的对话...）', _0x5491ac(_0x3ade71, _0x489999(0x6a9))); } } function _0x4df4b7() { const _0x32f982 = _0x314838, _0x5977c3 = new Date(), _0x50e435 = document[_0x32f982(0x7d5)](_0x32f982(0x1d6)), _0x2b8fb6 = document[_0x32f982(0x7d5)](_0x32f982(0x5cb)); if (_0x50e435 && _0x2b8fb6) { const _0x22a77f = String(_0x5977c3[_0x32f982(0x936)]())[_0x32f982(0x380)](0x2, '0'), _0x920147 = String(_0x5977c3[_0x32f982(0x546)]())['padStart'](0x2, '0'); _0x50e435[_0x32f982(0x9e0)] = _0x22a77f + ':' + _0x920147; const _0xcc4e90 = _0x5977c3[_0x32f982(0x550)]() + 0x1, _0x158674 = _0x5977c3[_0x32f982(0x1a4)](), _0x571c28 = [_0x32f982(0x730), '星期一', _0x32f982(0xa2b), _0x32f982(0xa4a), '星期四', '星期五', _0x32f982(0x937)][_0x5977c3[_0x32f982(0x6b9)]()]; _0x2b8fb6[_0x32f982(0x9e0)] = _0xcc4e90 + '月' + _0x158674 + '日\x20' + _0x571c28; } } const _0x4dad2e = document[_0x314838(0x7d5)](_0x314838(0x863)), _0x390261 = document['getElementById'](_0x314838(0x96f)), _0x4c4ad3 = document[_0x314838(0x7d5)](_0x314838(0x39e)), _0x128afb = document[_0x314838(0x7d5)]('listen-together-backdrop'), _0x12c5eb = document[_0x314838(0x7d5)](_0x314838(0x3b0)), _0x3247fc = document['getElementById'](_0x314838(0x2c6)), _0x3cc080 = document[_0x314838(0x7d5)]('listen-together-ui'), _0x42ddbe = document[_0x314838(0x7d5)](_0x314838(0x615)), _0x2b0bf4 = document['getElementById'](_0x314838(0x43c)); let _0x1074f3 = []; async function _0x505ac3() { const _0x313315 = _0x314838; if (!_0x13c410[_0x313315(0x55f)]) return; _0x12c5eb[_0x313315(0x65e)] = _0x313315(0x8c8), _0x4dad2e['classList']['add'](_0x313315(0xa12)); const _0x476cd0 = await _0x30e0f0(); if (_0x476cd0['length'] === 0x0) { if ('UJEqd' === 'UJEqd') { _0x12c5eb[_0x313315(0x65e)] = _0x313315(0x79f); return; } else { const _0x57cb71 = new _0x275ac7(), _0x69d180 = _0x4afdf6['getElementById'](_0x313315(0x36b)), _0x20c677 = _0x10e6cd[_0x313315(0x7d5)](_0x313315(0x1be)), _0xeeccf3 = _0x2923e3[_0x313315(0x7d5)](_0x313315(0x7be)); _0x69d180 && _0x20c677 && (_0x69d180[_0x313315(0x9e0)] = _0x57cb71['toLocaleTimeString'](_0x313315(0x14d), { 'hour': _0x313315(0x5bc), 'minute': _0x313315(0x5bc), 'hour12': ![] }), _0x20c677[_0x313315(0x9e0)] = _0x57cb71[_0x313315(0x116)](_0x313315(0x14d), { 'month': 'long', 'day': 'numeric', 'weekday': _0x313315(0x712) })), _0xeeccf3 && (_0xeeccf3[_0x313315(0x65e)] = _0x313315(0x169) + _0x57cb71['toLocaleTimeString'](_0x313315(0x14d), { 'hour': _0x313315(0x5bc), 'minute': _0x313315(0x5bc), 'hour12': ![] }) + _0x313315(0x6d3)); } } _0x12c5eb[_0x313315(0x65e)] = '', _0x476cd0[_0x313315(0x8c0)](_0x28ae44 => { const _0x4881e5 = _0x313315, _0x500657 = document[_0x4881e5(0xa30)]('div'); _0x500657[_0x4881e5(0x828)] = _0x4881e5(0x60e); const _0x4e45fc = _0x28ae44['cover'] ? URL[_0x4881e5(0x602)](_0x28ae44[_0x4881e5(0x45d)]) : _0x1c044f; _0x500657[_0x4881e5(0x65e)] = _0x4881e5(0x478) + _0x4e45fc + _0x4881e5(0x5c1) + (_0x28ae44[_0x4881e5(0x584)][_0x4881e5(0x80f)] || _0x4881e5(0x3dd)) + _0x4881e5(0x60c) + (_0x28ae44[_0x4881e5(0x584)]['歌手'] || _0x4881e5(0x9b4)) + _0x4881e5(0x363), _0x500657[_0x4881e5(0x988)](_0x4881e5(0x649), () => { const _0x49f7b7 = _0x4881e5; 'lXFmU' !== 'lQblD' ? _0x53e95e(_0x28ae44) : _0x55c8db[_0x49f7b7(0x372)] && _0x13191d[_0x49f7b7(0x372)]['isActive'] && (_0x300b4[_0x49f7b7(0x462)][_0x49f7b7(0x5f3)] = _0x49f7b7(0x715), _0x2b7818(() => _0x2ad4d6[_0x49f7b7(0x349)][_0x49f7b7(0x699)](_0x49f7b7(0xa12)), 0xa)); }), _0x12c5eb[_0x4881e5(0x3fd)](_0x500657); }); } function _0x3e2d6f() { const _0x163cce = _0x314838; _0x163cce(0xa4b) === _0x163cce(0xa4b) ? _0x4dad2e[_0x163cce(0x349)]['remove'](_0x163cce(0xa12)) : _0x424830['textContent'] = '❚❚'; } async function _0x53e95e(_0x5cdef6) { const _0x1e895a = _0x314838; if (!_0x13c410['activeChatId'] || !_0x5cdef6) return; let _0x3627ea = null; if (_0x5cdef6[_0x1e895a(0x45d)]) { if (_0x1e895a(0x3fc) === _0x1e895a(0x3fc)) try { _0x3627ea = 'music_cover_' + Date[_0x1e895a(0x2f2)]() + '_' + Math[_0x1e895a(0x2a4)](), await _0x4162d1(_0x3627ea, _0x5cdef6[_0x1e895a(0x45d)]); } catch (_0x598c02) { _0x1e895a(0x633) !== 'Kqpuq' ? console['error']('在“一起听”邀请中，净化封面失败:', _0x598c02) : _0x130481(_0x3fb408, _0x5b0137, !![]); } else { const _0x29957c = _0x329165(_0x128ad0), _0x223147 = _0x5b1eea['getElementById'](_0x1e895a(0x1a2)); _0x223147[_0x1e895a(0x462)][_0x1e895a(0x97e)] = ''; let _0x5dd963 = _0x421f7f['getElementById'](_0x1e895a(0x70c) + _0x2b9b63); if (_0x5dd963) _0x5dd963['innerHTML'] = ''; if (!_0x29957c) return; _0x29957c[_0x1e895a(0x97a)] && (_0x223147[_0x1e895a(0x462)]['backgroundImage'] = 'url(\x27' + _0x29957c[_0x1e895a(0x97a)] + '\x27)', _0x223147[_0x1e895a(0x462)][_0x1e895a(0x6b5)] = _0x1e895a(0x45d), _0x223147[_0x1e895a(0x462)]['backgroundPosition'] = _0x1e895a(0x2a0)); if (_0x29957c[_0x1e895a(0x897)]) { let _0x5d5012 = _0x3b02d9['getElementById'](_0x1e895a(0x70c) + _0x29957c['id']); !_0x5d5012 && (_0x5d5012 = _0x42409e[_0x1e895a(0xa30)](_0x1e895a(0x462)), _0x5d5012['id'] = _0x1e895a(0x70c) + _0x29957c['id'], _0x48b7b4['head']['appendChild'](_0x5d5012)); const _0x15e10d = _0x29957c[_0x1e895a(0x897)], _0x46dcb9 = _0x15e10d[_0x1e895a(0x1b5)](/\.bubble\.sent/g, _0x1e895a(0x9f0) + _0x29957c['id'] + _0x1e895a(0x7c7))[_0x1e895a(0x1b5)](/\.bubble\.received/g, _0x1e895a(0x9f0) + _0x29957c['id'] + _0x1e895a(0x6dc)); _0x5d5012[_0x1e895a(0x65e)] = _0x46dcb9; } } } const _0x57ed16 = { 'role': 'user', 'type': _0x1e895a(0x53e), 'content': _0x1e895a(0x6a6) + _0x5cdef6[_0x1e895a(0x584)][_0x1e895a(0x80f)] + ']', 'songId': _0x5cdef6['id'], 'songName': _0x5cdef6[_0x1e895a(0x584)][_0x1e895a(0x80f)], 'artist': _0x5cdef6['info']['歌手'], 'coverId': _0x3627ea, 'timestamp': Date[_0x1e895a(0x2f2)]() }; _0x13c410[_0x1e895a(0x793)][_0x1e895a(0x98f)](_0x57ed16), _0xe23b38(), _0x403f79(), _0x3e2d6f(), setTimeout(_0x4d5866, 0x64); } _0x390261[_0x314838(0x988)]('click', _0x505ac3), _0x4c4ad3[_0x314838(0x988)](_0x314838(0x649), _0x3e2d6f), _0x128afb[_0x314838(0x988)]('click', _0x3e2d6f); async function _0x11dced(_0x29faec, _0x252d8a, _0x30710f) { const _0x4f4bdb = _0x314838, _0x582737 = _0x13c410[_0x4f4bdb(0x226)]['find'](_0x322d52 => _0x322d52['activeListenSession'] && _0x322d52[_0x4f4bdb(0x985)][_0x4f4bdb(0x971)]), _0x4c22d0 = _0xee1b45(); if (_0x582737 && _0x582737['id'] !== _0x4c22d0['id']) _0x582737[_0x4f4bdb(0x985)] = null, _0x1e9edf(_0x4f4bdb(0x4b4)), _0x5834f1(); else _0x582737 && _0x582737['id'] === _0x4c22d0['id'] && _0x1e9edf(_0x4f4bdb(0x822)); _0x1f66de(!![], _0x4f4bdb(0x197)); if (!_0x4c22d0) { _0x1f66de(![]), _0x1e9edf(_0x4f4bdb(0x93b)); return; } const _0x27da8c = await _0x2a21c9(_0x29faec); if (!_0x27da8c) { _0x1f66de(![]), _0x1e9edf(_0x4f4bdb(0x677)); return; } _0x4c22d0[_0x4f4bdb(0x985)] = { 'isActive': !![], 'songId': _0x29faec, 'leaderId': _0x4f4bdb(0x425), 'songName': _0x27da8c[_0x4f4bdb(0x584)][_0x4f4bdb(0x80f)], 'artist': _0x27da8c[_0x4f4bdb(0x584)]['歌手'], 'cover': _0x27da8c['cover'] }, _0x5834f1(), document[_0x4f4bdb(0x7d5)]('lt-ui-cover-art')['src'] = _0x27da8c['cover'] ? URL['createObjectURL'](_0x27da8c[_0x4f4bdb(0x45d)]) : _0x1c044f, document[_0x4f4bdb(0x7d5)](_0x4f4bdb(0x100))[_0x4f4bdb(0x9e0)] = _0x27da8c[_0x4f4bdb(0x584)][_0x4f4bdb(0x80f)], document[_0x4f4bdb(0x7d5)](_0x4f4bdb(0x80e))['textContent'] = _0x27da8c[_0x4f4bdb(0x584)]['歌手'], _0x4ef531(_0x27da8c), _0x3cc080[_0x4f4bdb(0x462)][_0x4f4bdb(0x5f3)] = _0x4f4bdb(0x715), setTimeout(() => _0x3cc080[_0x4f4bdb(0x349)][_0x4f4bdb(0x699)](_0x4f4bdb(0xa12)), 0xa), _0x30710f[_0x4f4bdb(0x65e)] = _0x4f4bdb(0x61c) + _0x30710f[_0x4f4bdb(0x298)](_0x4f4bdb(0x51c))[_0x4f4bdb(0x41b)]; if (_0x13c410[_0x4f4bdb(0x793)][_0x252d8a]) { if (_0x4f4bdb(0x392) !== 'eyfNj') _0x13c410['conversationHistory'][_0x252d8a][_0x4f4bdb(0x143)] = !![], _0xe23b38(); else { _0x21e4c3 = _0x491e43(_0x432b03); if (!_0xbbbe73) throw new _0x7b9999('AI返回了无法识别的数据格式。'); } } _0x1f66de(![]), _0x312ce5(_0x29faec, [_0x29faec]), _0x3b1800(_0x27da8c, !![]); } function _0x5ef0b0() { const _0x395905 = _0x314838, _0xe5d087 = _0x13c410[_0x395905(0x226)][_0x395905(0x9b9)](_0x365a03 => _0x365a03['activeListenSession'] && _0x365a03[_0x395905(0x985)][_0x395905(0x971)]); if (_0xe5d087) { if (_0x395905(0x523) !== 'HhTdP') _0xe5d087[_0x395905(0x985)] = null, _0x5834f1(), _0x1e9edf('同步已断开。'), _0x3b1800(), _0x3cc080[_0x395905(0x349)]['remove'](_0x395905(0xa12)), setTimeout(() => _0x3cc080[_0x395905(0x462)][_0x395905(0x5f3)] = _0x395905(0x794), 0x12c); else { const _0x21644e = _0x18ffaa(_0x4e178e['content'] ?? _0x233cb2[_0x395905(0x928)] ?? _0xc3b4f2[_0x395905(0x496)] ?? '')['trim'](); if (_0x21644e) _0x1099b3['events'][_0x395905(0x98f)]({ 'senderId': _0x288a81['id'], 'kind': _0x395905(0x928), 'content': _0x21644e }); } } } function _0xe0876a(_0x4561f7) { const _0x1e7b00 = _0x314838; if (_0x1e7b00(0x58c) !== _0x1e7b00(0x58c)) return _0x306987[_0x1e7b00(0x226)]['find'](_0x162f0c => _0x162f0c['id'] === _0x50a051[_0x1e7b00(0x55f)]); else { if (!_0x4561f7) return []; const _0x57fd6b = _0x4561f7[_0x1e7b00(0x17a)]('\x0a'), _0x2ae2b0 = [], _0x41e306 = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x4b170a of _0x57fd6b) { const _0x36c40c = _0x4b170a[_0x1e7b00(0x2a3)](_0x41e306); if (_0x36c40c) { if (_0x1e7b00(0xa19) === _0x1e7b00(0x385)) { _0x23ce47[_0x1e7b00(0x4d3)] = '', _0x28dedd[_0x1e7b00(0x65e)] = ''; if (_0x724cf6[_0x1e7b00(0x53a)]['length'] < 0x2) { _0x12d63f(_0x1e7b00(0x224)); return; } _0x4d8ea9['characters'][_0x1e7b00(0x8c0)](_0x3a4856 => { const _0x384aca = _0x1e7b00, _0x34016f = _0x4cbd0f[_0x384aca(0xa30)]('li'); _0x34016f['className'] = _0x384aca(0x4e2), _0x34016f[_0x384aca(0x65e)] = _0x384aca(0x69f) + _0x3a4856['id'] + '\x22\x20data-id=\x22' + _0x3a4856['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x3a4856['avatar'] || _0x37760c) + _0x384aca(0x719) + _0x3a4856['id'] + '\x22\x20class=\x22char-name\x22>' + _0x3a4856[_0x384aca(0x695)] + '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x1b1f03[_0x384aca(0x3fd)](_0x34016f); }), _0x1a1f99(_0x1e7b00(0xa13), _0x1e7b00(0x754)); } else { const _0x527678 = parseInt(_0x36c40c[0x1], 0xa), _0xa6fd2e = parseInt(_0x36c40c[0x2], 0xa), _0x3783d2 = parseInt(_0x36c40c[0x3], 0xa) * (_0x36c40c[0x3][_0x1e7b00(0x280)] === 0x2 ? 0xa : 0x1), _0x2f000a = _0x527678 * 0x3c + _0xa6fd2e + _0x3783d2 / 0x3e8, _0x4e7aab = _0x4b170a[_0x1e7b00(0x1b5)](_0x41e306, '')['trim'](); _0x4e7aab && _0x2ae2b0[_0x1e7b00(0x98f)]({ 'time': _0x2f000a, 'text': _0x4e7aab }); } } } return _0x2ae2b0; } } function _0x4ef531(_0x450511) { const _0x49f073 = _0x314838; _0x1074f3 = _0xe0876a(_0x450511['lyrics']), _0x2b0bf4[_0x49f073(0x65e)] = ''; if (_0x1074f3['length'] === 0x0) { if (_0x49f073(0x8c2) === _0x49f073(0x6ca)) _0x506418 += _0x49f073(0x81a) + _0x1b9699[_0x49f073(0x519)](_0x151ed8 / 0x3c) + '小时前，生成的内容应该符合这段时间的空白。\x0a'; else { _0x2b0bf4[_0x49f073(0x65e)] = _0x49f073(0x6ce); return; } } _0x1074f3['forEach']((_0xe59837, _0x13a631) => { const _0xea82ad = _0x49f073, _0x586890 = document[_0xea82ad(0xa30)]('p'); _0x586890[_0xea82ad(0x9e0)] = _0xe59837[_0xea82ad(0x928)], _0x586890['id'] = _0xea82ad(0xa92) + _0x13a631, _0x2b0bf4['appendChild'](_0x586890); }); } function _0x1cadd3(_0x2ee8e5, _0x243934, _0x33af5f, _0x3ef2b3) { const _0x38c250 = _0x314838; if (_0x38c250(0x41a) !== _0x38c250(0x8d0)) { const _0x2befb8 = (_0x3ef2b3 - 0x5a) * Math['PI'] / 0xb4; return { 'x': _0x2ee8e5 + _0x33af5f * Math['cos'](_0x2befb8), 'y': _0x243934 + _0x33af5f * Math[_0x38c250(0x232)](_0x2befb8) }; } else _0x48befa[_0x38c250(0xa73)](), _0x74cc6e(); } function _0xdc4a65(_0x10e06c) { const _0x344d9e = _0x314838, _0x2f944f = _0x344d9e(0x164), _0x3755ea = document[_0x344d9e(0x2e9)](_0x2f944f, _0x344d9e(0x932)), _0x1d16c5 = 0xfa, _0x53047d = _0x1d16c5 / 0x2, _0x1339dc = _0x1d16c5 / 0x2, _0x15178d = _0x1d16c5 / 0x2 - 0x14; _0x3755ea[_0x344d9e(0x9e4)](_0x344d9e(0x7a7), _0x344d9e(0x72f)), _0x3755ea[_0x344d9e(0x9e4)](_0x344d9e(0x8ed), _0x344d9e(0x72f)), _0x3755ea[_0x344d9e(0x9e4)](_0x344d9e(0x9e1), _0x344d9e(0x91f) + _0x1d16c5 + '\x20' + _0x1d16c5); const _0x30e17d = Object[_0x344d9e(0x1f9)](_0x10e06c)[_0x344d9e(0x651)]((_0x31156f, _0x226c53) => _0x31156f + _0x226c53, 0x0); if (_0x30e17d === 0x0) return _0x3755ea; let _0x3b385c = -0x5a; const _0x39169a = ['#66b3ff', _0x344d9e(0xa49), _0x344d9e(0xa15), _0x344d9e(0x5e8), '#c299ff', '#ffb366', _0x344d9e(0x924), _0x344d9e(0x7ae)]; let _0x19be68 = 0x0; for (const _0x5977cc in _0x10e06c) { if (_0x344d9e(0xa7e) === _0x344d9e(0xa7e)) { const _0x57e78c = _0x10e06c[_0x5977cc]; if (_0x57e78c <= 0x0) continue; const _0x3f476e = _0x57e78c / _0x30e17d * 0x168, _0x18e572 = _0x3b385c + _0x3f476e, _0x3cec46 = _0x1cadd3(_0x53047d, _0x1339dc, _0x15178d, _0x18e572), _0x1140d0 = _0x1cadd3(_0x53047d, _0x1339dc, _0x15178d, _0x3b385c), _0x5bdba1 = _0x3f476e > 0xb4 ? '1' : '0', _0x503d26 = ['M', _0x3cec46['x'], _0x3cec46['y'], 'A', _0x15178d, _0x15178d, 0x0, _0x5bdba1, 0x1, _0x1140d0['x'], _0x1140d0['y'], 'L', _0x53047d, _0x1339dc, 'Z'][_0x344d9e(0x8aa)]('\x20'), _0x503e76 = document[_0x344d9e(0x2e9)](_0x2f944f, 'path'); _0x503e76[_0x344d9e(0x9e4)]('d', _0x503d26), _0x503e76[_0x344d9e(0x9e4)](_0x344d9e(0x585), _0x39169a[_0x19be68 % _0x39169a[_0x344d9e(0x280)]]), _0x19be68++; const _0x3353d1 = document[_0x344d9e(0x2e9)](_0x2f944f, _0x344d9e(0x3bc)); _0x3353d1['textContent'] = _0x5977cc + ':\x20' + _0x57e78c[_0x344d9e(0x176)](0x2) + '\x20(' + (_0x57e78c / _0x30e17d * 0x64)[_0x344d9e(0x176)](0x1) + '%)', _0x503e76[_0x344d9e(0x3fd)](_0x3353d1), _0x3755ea[_0x344d9e(0x3fd)](_0x503e76), _0x3b385c = _0x18e572; } else _0x56e7da[_0x344d9e(0x6f0)] = null; } return _0x3755ea; } function _0x58430e() { const _0x1a237e = _0x314838; if (_0x1074f3[_0x1a237e(0x280)] === 0x0) return; const _0x24370f = _0x3247fc[_0x1a237e(0x3f3)]; let _0x32943a = -0x1; for (let _0x17c854 = 0x0; _0x17c854 < _0x1074f3[_0x1a237e(0x280)]; _0x17c854++) { if ('bfGZv' === _0x1a237e(0x482)) _0x4eff88 = _0x172f6c[_0x1a237e(0x7d8)][_0x1a237e(0x33d)](_0x54d3c9 => _0x496255[_0x1a237e(0x90d)][_0x1a237e(0x9b9)](_0xd05550 => _0xd05550['id'] === _0x54d3c9))[_0x1a237e(0x61f)](_0x374878)['map'](_0x367e36 => _0x1a237e(0x7af) + _0x367e36[_0x1a237e(0x695)] + _0x1a237e(0x71f) + _0x367e36[_0x1a237e(0x75a)])['join'](''); else { if (_0x24370f >= _0x1074f3[_0x17c854][_0x1a237e(0xf7)]) { if (_0x1a237e(0xa99) === _0x1a237e(0xa99)) _0x32943a = _0x17c854; else { const _0x34759c = _0x540a0b['createElement'](_0x1a237e(0xa8b)); _0x34759c[_0x1a237e(0x828)] = _0x1a237e(0x4d5), _0x34759c[_0x1a237e(0x14b)]['id'] = _0x1a70fa['id'], _0x34759c['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0x26c341[_0x1a237e(0x695)] + _0x1a237e(0x80d) + _0x31530a[_0x1a237e(0x75a)][_0x1a237e(0x5e0)](0x0, 0x64) + _0x1a237e(0xf6), _0x34759c[_0x1a237e(0x988)](_0x1a237e(0x649), () => _0x43f8b7(_0x1b47ef['id'])), _0x344ec1[_0x1a237e(0x3fd)](_0x34759c); } } else break; } } if (_0x32943a !== -0x1) { const _0x29381e = _0x2b0bf4['querySelectorAll']('p'); _0x29381e[_0x1a237e(0x8c0)](_0x317ed5 => _0x317ed5['classList']['remove'](_0x1a237e(0x513))); const _0x19b272 = document[_0x1a237e(0x7d5)](_0x1a237e(0xa92) + _0x32943a); _0x19b272 && (_0x19b272[_0x1a237e(0x349)][_0x1a237e(0x699)]('active'), _0x19b272[_0x1a237e(0x8cc)]({ 'behavior': _0x1a237e(0x190), 'block': 'center' })); } } _0x42ddbe[_0x314838(0x988)](_0x314838(0x649), () => { const _0x2cd19a = _0x314838; _0x3cc080[_0x2cd19a(0x349)][_0x2cd19a(0x330)](_0x2cd19a(0xa12)), setTimeout(() => _0x3cc080[_0x2cd19a(0x462)][_0x2cd19a(0x5f3)] = 'none', 0x12c); }), document[_0x314838(0x7d5)](_0x314838(0x196))[_0x314838(0x988)]('click', () => { const _0xbcdc43 = _0x314838; _0x13c410[_0xbcdc43(0x372)] && _0x13c410['listenTogetherSession'][_0xbcdc43(0x971)] && (_0xbcdc43(0x2ee) === _0xbcdc43(0x5f0) ? (_0x553b8a[_0xbcdc43(0x462)]['backgroundImage'] = 'url(' + _0x3bcfa5[_0xbcdc43(0x602)](_0x102fa8) + ')', _0x1bead1[_0xbcdc43(0x462)][_0xbcdc43(0x6b5)] = _0xbcdc43(0x45d), _0x420051[_0xbcdc43(0x462)][_0xbcdc43(0x697)] = _0xbcdc43(0x2a0)) : (_0x3cc080[_0xbcdc43(0x462)][_0xbcdc43(0x5f3)] = _0xbcdc43(0x715), setTimeout(() => _0x3cc080[_0xbcdc43(0x349)][_0xbcdc43(0x699)]('show'), 0xa))); }), _0x3247fc[_0x314838(0x988)]('timeupdate', _0x58430e); const _0x5999cd = document[_0x314838(0x7d5)](_0x314838(0x1f6)), _0x422867 = document[_0x314838(0x7d5)](_0x314838(0x679)), _0x5bfcda = document[_0x314838(0x7d5)](_0x314838(0x5ed)); _0x5999cd[_0x314838(0x988)](_0x314838(0x649), () => { const _0x2a699b = _0x314838; _0x2a699b(0x2d5) === 'nEjaL' ? _0x578a30[_0x2a699b(0x11e)](_0x2a699b(0x8e9), _0x4fbee6) : _0x3247fc['src'] && (_0x2a699b(0x2e2) !== _0x2a699b(0x2e2) ? _0xdb3070(_0x2a699b(0x875) + _0x2ef06f['message']) : _0x3247fc[_0x2a699b(0x327)] ? _0x2a699b(0xfb) === 'cMtjS' ? _0x3247fc[_0x2a699b(0x5c0)]() : _0x8449c5(_0x4e5389[_0x2a699b(0x6f0)]) : 'OqKxQ' === _0x2a699b(0x89e) ? _0x1714e1[_0x2a699b(0x65e)] = _0x2a699b(0x434) + _0x587484 + _0x2a699b(0x46a) : _0x3247fc['pause']()); }), _0x422867[_0x314838(0x988)](_0x314838(0x649), () => { const _0x380888 = _0x314838; if (_0x26a436[_0x380888(0x280)] === 0x0) return; _0x2972ba = (_0x2972ba + 0x1) % _0x26a436[_0x380888(0x280)], _0x312ce5(_0x26a436[_0x2972ba], _0x26a436); }), _0x5bfcda[_0x314838(0x988)](_0x314838(0x649), () => { const _0x156597 = _0x314838; if (_0x156597(0x493) === _0x156597(0x493)) { if (_0x26a436[_0x156597(0x280)] === 0x0) return; _0x2972ba = (_0x2972ba - 0x1 + _0x26a436[_0x156597(0x280)]) % _0x26a436[_0x156597(0x280)], _0x312ce5(_0x26a436[_0x2972ba], _0x26a436); } else _0x3e360a[_0x156597(0x688)](_0x156597(0x6cb)), _0x2ac9e6[_0x156597(0x629)](_0x156597(0x156), _0x194a4c[_0x156597(0x3e1)](_0x557ffb)); }), _0x3247fc[_0x314838(0x988)](_0x314838(0x5c0), () => { const _0x1ac69b = _0x314838; if (_0x1ac69b(0xa0e) === _0x1ac69b(0xa0e)) _0x5999cd['textContent'] = '❚❚'; else { const _0x898b73 = _0x59f095[_0x1ac69b(0x435)][_0x1ac69b(0x33d)](_0x41a374 => _0x434b4c(_0x41a374)?.['name'] || '未知')[_0x1ac69b(0x8aa)]('、'), _0x45412f = _0x1ac69b(0x9d1); _0x956a22 = _0x1ac69b(0x407) + _0x45412f + '\x20' + _0x898b73 + '</div>'; } }), _0x3247fc[_0x314838(0x988)](_0x314838(0x993), () => { const _0xfca14d = _0x314838; _0x5999cd[_0xfca14d(0x9e0)] = '▶'; }), _0x3247fc[_0x314838(0x988)](_0x314838(0x94d), () => { const _0x2bda97 = _0x314838; _0x422867[_0x2bda97(0x649)](); }), _0x3247fc['addEventListener'](_0x314838(0x5c0), () => { const _0x2e6bae = _0x314838, _0x344ad6 = document[_0x2e6bae(0x7d5)]('global-player-play-pause-btn'); if (_0x344ad6) _0x344ad6[_0x2e6bae(0x9e0)] = '❚❚'; }), _0x3247fc[_0x314838(0x988)]('pause', () => { const _0x17ea55 = _0x314838, _0x579789 = document['getElementById'](_0x17ea55(0x698)); if (_0x579789) _0x579789['textContent'] = '▶'; }), _0x3247fc['addEventListener'](_0x314838(0x94d), () => { const _0x43868c = _0x314838; if (_0x43868c(0x30b) === _0x43868c(0x390)) { const _0x48c87c = _0x4d83bd[_0x43868c(0x53a)][_0x43868c(0x9b9)](_0x2f3429 => _0x3153b0[_0x43868c(0x9c8)]['includes'](_0x2f3429['id']) && _0x2f3429['name'] === _0x36c91d); if (_0x48c87c) _0x17daf1 = _0x48c87c['id']; } else { const _0x566c65 = document[_0x43868c(0x7d5)](_0x43868c(0x2aa)); _0x566c65 && ('RowyK' !== 'RowyK' ? _0x904d0b = _0x94eacc[_0x43868c(0x787)][_0x43868c(0x695)] || '我' : _0x566c65[_0x43868c(0x649)]()); } }); function _0x281d9d(_0x2f8c8d) { const _0x34f75e = _0x314838; if (_0x34f75e(0x3d6) === _0x34f75e(0x201)) _0x3a0dc3(_0x34f75e(0x506) + _0x48f5f6[_0x34f75e(0x496)]); else { if (!_0x2f8c8d || typeof _0x2f8c8d !== _0x34f75e(0x802)) return null; const _0xf60e7f = _0x2f8c8d[_0x34f75e(0x861)]('['), _0x5d27fe = _0x2f8c8d['lastIndexOf'](']'); if (_0xf60e7f > -0x1 && _0x5d27fe > _0xf60e7f) { if (_0x34f75e(0xa5d) !== _0x34f75e(0x803)) return _0x2f8c8d[_0x34f75e(0x5e0)](_0xf60e7f, _0x5d27fe + 0x1); else { const _0x4f27de = _0x4f0f8f['characterLastScripts'][_0x2f9d6d]; _0x4f27de && _0x4f27de[_0x34f75e(0x280)] > 0x0 && (_0x24be2e = _0x4f27de['at'](-0x1)); } } return null; } } document[_0x314838(0x7d5)](_0x314838(0x3e2))[_0x314838(0x988)](_0x314838(0x649), () => { const _0x4f9b09 = _0x314838; if (_0x4f9b09(0x163) !== _0x4f9b09(0x26a)) _0x2aeb31(), _0x384da8(_0x4f9b09(0x96e), _0x4f9b09(0x73e)); else { const _0x4c5fd4 = _0x4cc9a9(_0x585dc6[_0x4f9b09(0x14b)][_0x4f9b09(0x2c1)], 0xa); _0xac3eca(_0x4c5fd4); } }), document[_0x314838(0x7d5)](_0x314838(0x566))[_0x314838(0x988)](_0x314838(0x649), () => _0x384da8(_0x314838(0x73e), _0x314838(0x96e))); const _0x2ab607 = document['getElementById'](_0x314838(0x2f0)), _0xe9b790 = document['getElementById'](_0x314838(0x4c7)); _0x2ab607[_0x314838(0x988)](_0x314838(0x649), _0x2aeb31), _0xe9b790[_0x314838(0x988)](_0x314838(0x649), () => { const _0x57dcde = _0x314838; _0x2ab607[_0x57dcde(0x349)][_0x57dcde(0x330)](_0x57dcde(0x513)), _0xe9b790[_0x57dcde(0x349)][_0x57dcde(0x699)](_0x57dcde(0x513)), _0x1d30f8(); }); function _0x2aeb31() { const _0x3ce6f3 = _0x314838; _0xe9b790['classList']['remove']('active'), _0x2ab607[_0x3ce6f3(0x349)]['add'](_0x3ce6f3(0x513)), _0x3b5ab4(); } function _0x3b5ab4() { const _0x2e221d = _0x314838; if (_0x2e221d(0x43f) === _0x2e221d(0x616)) _0x186c49[_0x2e221d(0x65e)] = _0x2e221d(0x521), _0x598df7[_0x2e221d(0x7d5)]('organize-bill-button')[_0x2e221d(0x988)](_0x2e221d(0x649), _0x584fe8); else { const _0x1c404e = document['getElementById'](_0x2e221d(0x71d)); document[_0x2e221d(0x7d5)](_0x2e221d(0xa8e))[_0x2e221d(0x9e0)] = _0x2e221d(0x50d), document[_0x2e221d(0x7d5)]('header-actions')[_0x2e221d(0x65e)] = '', _0x1c404e[_0x2e221d(0x65e)] = _0x2e221d(0x51e), _0x2bf5db(), document[_0x2e221d(0x7d5)](_0x2e221d(0x2dd))['addEventListener'](_0x2e221d(0x649), _0x13d6cd), document[_0x2e221d(0x7d5)](_0x2e221d(0x4dc))[_0x2e221d(0x988)](_0x2e221d(0x649), _0x530029 => { const _0xf62b2b = _0x2e221d; if (_0x530029[_0xf62b2b(0x6d7)][_0xf62b2b(0x349)][_0xf62b2b(0x741)](_0xf62b2b(0x39b))) { if (_0xf62b2b(0xaa3) !== _0xf62b2b(0x386)) { const _0x33bf3e = _0x530029['target'][_0xf62b2b(0x14b)]['id']; _0x39a14a(_0xf62b2b(0x362))[_0xf62b2b(0x834)](_0x438241 => { const _0x3e2aeb = _0xf62b2b; if (_0x3e2aeb(0x403) !== _0x3e2aeb(0x403)) { _0x1081de[_0x3e2aeb(0x65e)] = _0x3e2aeb(0x879); return; } else _0x438241 && _0x30aaed(_0x33bf3e); }); } else return new _0x516b5e(_0x2a5bd3 => { const _0x1809b6 = _0xf62b2b, _0x3dcf60 = _0x1809b6(0xa79); _0x1368f2['body'][_0x1809b6(0x7a2)](_0x1809b6(0x168), _0x3dcf60); const _0x36c0d8 = _0x15d6a0[_0x1809b6(0x7d5)](_0x1809b6(0x460)), _0x1fc3fc = _0x437018[_0x1809b6(0x7d5)](_0x1809b6(0x873)), _0x45c452 = _0x501bdd[_0x1809b6(0x7d5)](_0x1809b6(0x1ba)), _0x4ddce7 = _0x291830[_0x1809b6(0x7d5)]('diary-modal-cancel'), _0x1d9c2a = _0x36c0d8[_0x1809b6(0x298)](_0x1809b6(0x154)), _0x399c0c = () => { const _0x282700 = _0x1809b6; _0x36c0d8[_0x282700(0x330)](), _0x2a5bd3(); }; _0x45c452['onclick'] = () => { const _0x3d0c1e = _0x1809b6; _0xb42049(_0x1fc3fc[_0x3d0c1e(0x4d3)]), _0x399c0c(); }, _0x4ddce7[_0x1809b6(0x779)] = _0x399c0c, _0x1d9c2a[_0x1809b6(0x779)] = _0x399c0c; }); } }), document[_0x2e221d(0x7d5)]('expense-description')[_0x2e221d(0x40d)](); } } function _0x1fa544(_0x130f96, _0x277663) { const _0x40c96b = _0x314838, _0x41b167 = document[_0x40c96b(0x7d5)](_0x40c96b(0x71d)), _0x1ba8dd = document[_0x40c96b(0x7d5)](_0x40c96b(0x16b)); document[_0x40c96b(0x7d5)](_0x40c96b(0xa8e))[_0x40c96b(0x9e0)] = _0x277663 + _0x40c96b(0x675); const _0x4e24ec = _0x130f96[_0x40c96b(0x41d)][_0x40c96b(0x651)]((_0x398376, _0x3dd072) => _0x398376 + (_0x3dd072[_0x40c96b(0x5ca)] || 0x0), 0x0); let _0x165d5b = '<div\x20style=\x22background:\x20var(--card-bg);\x20padding:\x2020px;\x20border-radius:\x2012px;\x20text-align:\x20center;\x20border:\x201px\x20solid\x20var(--border-color);\x22><span\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x22>今日总支出\x20(元)</span><div\x20style=\x22font-size:\x202.5rem;\x20font-weight:\x20bold;\x20margin-top:\x205px;\x22>' + _0x4e24ec[_0x40c96b(0x176)](0x2) + '</div></div><div\x20id=\x22categorized-expenses-list\x22\x20style=\x22margin-top:\x2010px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2010px;\x22></div>'; _0x41b167[_0x40c96b(0x65e)] = _0x165d5b; const _0xc2a2a = document['getElementById']('categorized-expenses-list'), _0x1d1de4 = { '餐饮美食': '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202h-14a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011v-7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v7\x22></path><path\x20d=\x22M9\x204v3\x22></path>', '交通出行': _0x40c96b(0x577), '购物消费': _0x40c96b(0xa64), '生活服务': '<path\x20d=\x22m3\x209\x209-7\x209\x207v11a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2z\x22></path><polyline\x20points=\x229\x2022\x209\x2012\x2015\x2012\x2015\x2022\x22></polyline>', '休闲娱乐': _0x40c96b(0x22f), '医疗健康': _0x40c96b(0x3ec), '人情红包': '<path\x20d=\x22M15\x2018h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2h-2V4a2\x202\x200\x200\x200-2-2h-2a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path><path\x20d=\x22M7\x2014h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2H7V4a2\x202\x200\x200\x200-2-2H3a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path>', '其他杂项': _0x40c96b(0x86d), '默认': _0x40c96b(0x264) }; _0x130f96['categorizedExpenses'][_0x40c96b(0x8c0)](_0x299a12 => { const _0xbd80c2 = _0x40c96b; if (_0xbd80c2(0x9c6) !== _0xbd80c2(0x9c6)) _0x23bad1[_0xbd80c2(0x11e)]('视奸内容解析失败:', _0x318946), _0x5e93bb = _0xbd80c2(0x138) + _0x596fca + _0xbd80c2(0x8f8); else { const _0x5782b1 = document[_0xbd80c2(0xa30)](_0xbd80c2(0xa8b)); _0x5782b1[_0xbd80c2(0x828)] = _0xbd80c2(0x233), _0x5782b1['style']['flexDirection'] = 'column', _0x5782b1[_0xbd80c2(0x462)][_0xbd80c2(0x2c5)] = _0xbd80c2(0x378), _0x5782b1[_0xbd80c2(0x462)][_0xbd80c2(0x4f7)] = _0xbd80c2(0x74d), _0x5782b1[_0xbd80c2(0x462)]['gap'] = '0'; const _0x3e27d8 = _0x1d1de4[_0x299a12['category']] || _0x1d1de4['默认'], _0x5bdffd = _0xbd80c2(0x816) + _0x3e27d8 + _0xbd80c2(0x639), _0x1139cd = _0xbd80c2(0x738) + _0x5bdffd + '</span><div><div\x20class=\x22description\x22>' + _0x299a12['description'] + _0xbd80c2(0x332) + (_0x299a12['category'] || _0xbd80c2(0x5f1)) + '</div></div></div><span\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x22>-\x20' + (_0x299a12[_0xbd80c2(0x5ca)] || 0x0)[_0xbd80c2(0x176)](0x2) + _0xbd80c2(0x851); let _0x102eae = ''; if (_0x299a12[_0xbd80c2(0x7d0)] && _0x299a12['review'][_0xbd80c2(0x5af)]) { const _0x46dd75 = _0x1d08b4(_0x299a12[_0xbd80c2(0x7d0)][_0xbd80c2(0x5af)]); _0x46dd75 && ('woEVF' !== _0xbd80c2(0x4b2) ? _0x102eae = '<div\x20class=\x22review-area\x22\x20style=\x22margin-top:\x2012px;\x20padding-top:\x2012px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x20display:\x20flex;\x20align-items:\x20flex-start;\x20gap:\x2015px;\x22><div\x20style=\x22width:\x2040px;\x20height:\x20auto;\x20flex-shrink:\x200;\x20display:\x20flex;\x20justify-content:\x20center;\x22><img\x20src=\x22' + _0x46dd75[_0xbd80c2(0x907)] + _0xbd80c2(0x191) + _0x46dd75[_0xbd80c2(0x695)] + _0xbd80c2(0xaaa) + _0x299a12['review']['text'] + _0xbd80c2(0x959) : (_0x1fcb02(), _0x5d941e(_0xbd80c2(0x64c), _0xbd80c2(0x73e)))); } _0x5782b1[_0xbd80c2(0x65e)] = _0x1139cd + _0x102eae, _0xc2a2a[_0xbd80c2(0x3fd)](_0x5782b1); } }), _0x1ba8dd[_0x40c96b(0x65e)] = _0x40c96b(0x364), document['getElementById'](_0x40c96b(0x6ae))[_0x40c96b(0x988)]('click', async () => { const _0x259b2a = _0x40c96b; if (_0x259b2a(0x54a) === _0x259b2a(0x54a)) { const _0x10f383 = await _0x39a14a(_0x259b2a(0x4a4)); if (_0x10f383) { if (_0x259b2a(0x6bd) !== _0x259b2a(0x6bd)) { const _0x7794e0 = _0x584224[_0x259b2a(0x12e)][_0x259b2a(0x13c)](); _0x40981a['textContent'] = _0x7794e0[_0x259b2a(0x31c)] === _0x259b2a(0x2a6) ? '旁白' : _0x7794e0[_0x259b2a(0x31c)], _0x219c7b[_0x259b2a(0x9e0)] = _0x7794e0['line'], _0x7794e0['speaker'] !== _0x259b2a(0x2a6) && _0x3a8b17(_0x1b39a8[_0x259b2a(0x2c7)], _0x7794e0[_0x259b2a(0x248)]); } else { const _0x238f36 = _0x13c410[_0x259b2a(0x246)][_0x277663]; _0x238f36 && _0x238f36[_0x259b2a(0x656)] && _0x13c410[_0x259b2a(0x2e4)][_0x259b2a(0x98f)](..._0x238f36['originalExpenses']), delete _0x13c410[_0x259b2a(0x246)][_0x277663], _0x5834f1(), _0x3b5ab4(); } } } else _0x368882[_0x259b2a(0x11e)](_0x259b2a(0x241), _0x552c48), _0x16a8f2(_0x259b2a(0x58e)); }); } function _0x1d30f8() { const _0x59aa22 = _0x314838; if (_0x59aa22(0x4c6) === _0x59aa22(0x24e)) throw _0x29291a; else { const _0x5650c0 = document['getElementById'](_0x59aa22(0x71d)); document[_0x59aa22(0x7d5)](_0x59aa22(0xa8e))[_0x59aa22(0x9e0)] = '账本', document[_0x59aa22(0x7d5)](_0x59aa22(0x16b))[_0x59aa22(0x65e)] = ''; const _0x1f9fd1 = Object[_0x59aa22(0x132)](_0x13c410['accountingLedger'])[_0x59aa22(0x25d)]((_0x296f3a, _0x19dfaf) => new Date(_0x19dfaf) - new Date(_0x296f3a)); if (_0x1f9fd1[_0x59aa22(0x280)] === 0x0) { _0x5650c0['innerHTML'] = _0x59aa22(0x98b); return; } _0x5650c0[_0x59aa22(0x65e)] = '', _0x1f9fd1[_0x59aa22(0x8c0)](_0x59bc04 => { const _0xbe8770 = _0x59aa22, _0x35543b = document['createElement'](_0xbe8770(0xa8b)); _0x35543b[_0xbe8770(0x828)] = _0xbe8770(0x233), _0x35543b[_0xbe8770(0x462)][_0xbe8770(0x642)] = _0xbe8770(0x438); const _0x3e4684 = _0x13c410['accountingLedger'][_0x59bc04], _0x3dd436 = _0x3e4684[_0xbe8770(0x41d)]['reduce']((_0x217c07, _0x213a8e) => _0x217c07 + (_0x213a8e[_0xbe8770(0x5ca)] || 0x0), 0x0); _0x35543b[_0xbe8770(0x65e)] = _0xbe8770(0x134) + _0x59bc04 + _0xbe8770(0x8a5) + _0x3dd436[_0xbe8770(0x176)](0x2) + _0xbe8770(0xec), _0x35543b[_0xbe8770(0x988)](_0xbe8770(0x649), () => { const _0xbce2fe = _0xbe8770; _0x2ab607[_0xbce2fe(0x349)]['remove']('active'), _0xe9b790[_0xbce2fe(0x349)][_0xbce2fe(0x699)]('active'), _0x1fa544(_0x3e4684, _0x59bc04); }), _0x5650c0[_0xbe8770(0x3fd)](_0x35543b); }); } } function _0x13d6cd() { const _0xfe85bb = _0x314838, _0x22de51 = document[_0xfe85bb(0x7d5)](_0xfe85bb(0xa23)), _0x42d690 = document[_0xfe85bb(0x7d5)](_0xfe85bb(0x8de)), _0x94921a = _0x22de51[_0xfe85bb(0x4d3)][_0xfe85bb(0x6eb)](), _0xd111a4 = parseFloat(_0x42d690[_0xfe85bb(0x4d3)]); if (!_0x94921a || isNaN(_0xd111a4) || _0xd111a4 <= 0x0) { _0x1e9edf(_0xfe85bb(0x1bd)); return; } _0x13c410[_0xfe85bb(0x2e4)][_0xfe85bb(0x98f)]({ 'id': _0xfe85bb(0x5c4) + Date[_0xfe85bb(0x2f2)](), 'description': _0x94921a, 'amount': _0xd111a4, 'timestamp': Date[_0xfe85bb(0x2f2)]() }), _0x5834f1(), _0x2bf5db(), _0x22de51['value'] = '', _0x42d690[_0xfe85bb(0x4d3)] = '', _0x22de51[_0xfe85bb(0x40d)](); } function _0x30aaed(_0x2a31a6) { const _0x5db530 = _0x314838; if (_0x5db530(0x1c8) !== 'sARCU') { const _0x9fb59d = _0x13c410[_0x5db530(0x2e4)]['findIndex'](_0x512074 => _0x512074['id'] === _0x2a31a6); _0x9fb59d > -0x1 && (_0x13c410[_0x5db530(0x2e4)][_0x5db530(0x3f5)](_0x9fb59d, 0x1), _0x5834f1(), _0x2bf5db()); } else _0x4bc4fe['classList'][_0x5db530(0x330)](_0x5db530(0x513)), _0x47f968[_0x5db530(0x349)][_0x5db530(0x699)](_0x5db530(0x513)), _0x531860(); } function _0x2bf5db() { const _0x5d7eca = _0x314838, _0x5a56b3 = document['getElementById'](_0x5d7eca(0x4dc)), _0x5a4ad6 = document['getElementById']('organize-button-container'), _0x330f0c = new Date(), _0x189ecf = _0x13c410[_0x5d7eca(0x2e4)][_0x5d7eca(0x61f)](_0x479ab5 => new Date(_0x479ab5[_0x5d7eca(0x921)])[_0x5d7eca(0x7ab)]() === _0x330f0c[_0x5d7eca(0x7ab)]()); if (_0x189ecf[_0x5d7eca(0x280)] === 0x0) { _0x5a56b3[_0x5d7eca(0x65e)] = _0x5d7eca(0x86c), _0x5a4ad6[_0x5d7eca(0x65e)] = ''; return; } _0x5a56b3[_0x5d7eca(0x65e)] = '', _0x189ecf[_0x5d7eca(0x25d)]((_0x5ec90b, _0x8f6746) => _0x8f6746[_0x5d7eca(0x921)] - _0x5ec90b[_0x5d7eca(0x921)])[_0x5d7eca(0x8c0)](_0xc5e29a => { const _0xb1ac65 = _0x5d7eca, _0x3aae3f = document['createElement'](_0xb1ac65(0xa8b)); _0x3aae3f[_0xb1ac65(0x828)] = 'expense-item', _0x3aae3f[_0xb1ac65(0x65e)] = _0xb1ac65(0x134) + _0xc5e29a[_0xb1ac65(0x361)] + _0xb1ac65(0x768) + _0xc5e29a[_0xb1ac65(0x5ca)][_0xb1ac65(0x176)](0x2) + '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22' + _0xc5e29a['id'] + _0xb1ac65(0x6ab), _0x5a56b3[_0xb1ac65(0x3fd)](_0x3aae3f); }); if (_0x5a4ad6) { if (_0x5d7eca(0x8e8) !== _0x5d7eca(0x105)) _0x5a4ad6['innerHTML'] = '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', document[_0x5d7eca(0x7d5)](_0x5d7eca(0x195))[_0x5d7eca(0x988)](_0x5d7eca(0x649), _0x2d61e0); else return _0x5d7eca(0x288) + _0x4da26c; } } async function _0x2d61e0() { const _0xf7d144 = _0x314838, _0xcb1a3 = new Date(), _0x3ef318 = _0xcb1a3[_0xf7d144(0x2bf)]() + '-' + String(_0xcb1a3[_0xf7d144(0x550)]() + 0x1)[_0xf7d144(0x380)](0x2, '0') + '-' + String(_0xcb1a3['getDate']())[_0xf7d144(0x380)](0x2, '0'); if (_0x13c410[_0xf7d144(0x246)][_0x3ef318]) { if (_0xf7d144(0x527) !== _0xf7d144(0x48c)) { _0x1e9edf('已经生成了今日账单！想看就去“看账本”标签页。'); return; } else { _0x51f1fd('至少要保留一个用户。'); return; } } const _0x35c7c6 = _0x13c410[_0xf7d144(0x2e4)][_0xf7d144(0x61f)](_0x6ea7de => new Date(_0x6ea7de['timestamp'])[_0xf7d144(0x7ab)]() === _0xcb1a3[_0xf7d144(0x7ab)]()); if (_0x35c7c6[_0xf7d144(0x280)] === 0x0) { if (_0xf7d144(0x187) !== _0xf7d144(0x210)) { _0x1e9edf('今天一笔账都没有，我整理什么？'); return; } else { _0x46e6b6(_0xf7d144(0x51a)); return; } } _0x1f66de(!![], '正在整理…'); try { const _0x555589 = [_0xf7d144(0x735), _0xf7d144(0x231), _0xf7d144(0x4e4), _0xf7d144(0x45f), _0xf7d144(0x481), _0xf7d144(0x6fc), _0xf7d144(0xa8c), '其他杂项'], _0x4668ad = _0x35c7c6[_0xf7d144(0x33d)](_0x1d7e13 => '-\x20' + _0x1d7e13[_0xf7d144(0x361)] + ':\x20' + _0x1d7e13[_0xf7d144(0x5ca)])[_0xf7d144(0x8aa)]('\x0a'), _0x2f6003 = _0x13c410['characters'][_0xf7d144(0x33d)](_0x45869b => { const _0xfeaae1 = _0xf7d144; if (_0xfeaae1(0x87b) !== _0xfeaae1(0x6df)) { const _0x52dbb4 = _0x13c410[_0xfeaae1(0x226)][_0xfeaae1(0x9b9)](_0x14622f => _0x14622f[_0xfeaae1(0x974)] === _0xfeaae1(0x293) && _0x14622f[_0xfeaae1(0x9c8)][_0xfeaae1(0x71e)](_0x45869b['id'])), _0x5479d0 = _0x13c410[_0xfeaae1(0x6ed)]['find'](_0x8763d4 => _0x8763d4['id'] === (_0x52dbb4?.['boundUserProfileId'] || _0x13c410[_0xfeaae1(0x56d)])) || { 'id': 'default', 'name': '你' }; let _0x186ac3 = ''; return _0x45869b[_0xfeaae1(0x7d8)] && _0x45869b[_0xfeaae1(0x7d8)]['length'] > 0x0 && (_0x186ac3 = _0x45869b[_0xfeaae1(0x7d8)][_0xfeaae1(0x33d)](_0x694b66 => _0x13c410[_0xfeaae1(0x90d)][_0xfeaae1(0x9b9)](_0x38bb9c => _0x38bb9c['id'] === _0x694b66))[_0xfeaae1(0x61f)](Boolean)[_0xfeaae1(0x33d)](_0x4869da => _0xfeaae1(0x7af) + _0x4869da[_0xfeaae1(0x695)] + _0xfeaae1(0x71f) + _0x4869da[_0xfeaae1(0x75a)])['join']('')), _0xfeaae1(0x614) + _0x45869b['id'] + '\x0a\x20\x20\x20\x20姓名:\x20' + _0x45869b[_0xfeaae1(0x695)] + _0xfeaae1(0x8fc) + _0x45869b['persona'] + _0xfeaae1(0x94f) + _0x5479d0[_0xfeaae1(0x695)] + _0xfeaae1(0x461) + _0x5479d0['id'] + ')\x0a' + _0x186ac3; } else { const _0x507af9 = _0x3bf158[_0xfeaae1(0x46c)]['filter'](_0x208aeb => _0x208aeb['author'] === _0xfeaae1(0x425))['pop'](); _0x507af9 && (_0xcfddf2 = _0x507af9[_0xfeaae1(0x75a)]); } })['join']('\x0a'), _0x10c4a7 = _0x13c410[_0xf7d144(0x6ed)][_0xf7d144(0x33d)](_0x4c2e64 => _0xf7d144(0x301) + _0x4c2e64['id'] + '\x0a\x20\x20\x20\x20姓名:\x20' + _0x4c2e64[_0xf7d144(0x695)] + _0xf7d144(0x8fc) + (_0x4c2e64[_0xf7d144(0x2a1)] || '无'))[_0xf7d144(0x8aa)]('\x0a'), _0x516b04 = _0xf7d144(0x8e3), _0x175722 = _0xf7d144(0x1af) + _0x555589[_0xf7d144(0x8aa)](',\x20') + _0xf7d144(0x4fe) + _0x2f6003 + _0xf7d144(0x38c) + _0x10c4a7 + '\x0a\x0a#\x20今日消费流水\x0a' + _0x4668ad, _0x5f439a = [{ 'role': 'system', 'content': _0x516b04 }, { 'role': _0xf7d144(0x425), 'content': _0x175722 }], _0x11d254 = await _0x39cd5c(_0x5f439a, { 'json': !![] }), _0xaddec8 = _0x281d9d(_0x11d254); if (!_0xaddec8) throw new Error(_0xf7d144(0x52a) + _0x11d254); const _0x3de7ce = JSON[_0xf7d144(0xa69)](_0xaddec8); _0x13c410[_0xf7d144(0x246)][_0x3ef318] = { 'categorizedExpenses': _0x3de7ce, 'timestamp': Date['now'](), 'originalExpenses': _0x35c7c6 }, _0x13c410[_0xf7d144(0x2e4)] = _0x13c410[_0xf7d144(0x2e4)][_0xf7d144(0x61f)](_0x2e6387 => new Date(_0x2e6387[_0xf7d144(0x921)])['toDateString']() !== _0xcb1a3[_0xf7d144(0x7ab)]()), _0x5834f1(), _0x1fa544(_0x13c410['accountingLedger'][_0x3ef318], _0x3ef318); } catch (_0x143d3b) { if (_0xf7d144(0x4a7) !== _0xf7d144(0x4a7)) { const _0x40de5f = _0x6a5e4a[_0xf7d144(0x6ed)]['find'](_0x5e0825 => _0x5e0825['id'] === _0x592cf8); if (_0x40de5f) _0x37b209[_0xf7d144(0x6e9)](_0x40de5f, _0x1db565); } else _0x1e9edf('AI整理失败了，哼:\x20' + _0x143d3b[_0xf7d144(0x496)]); } finally { _0x1f66de(![]); } } async function _0x4ca1f6() { const _0x18436e = _0x314838, _0xaacc34 = [..._0x397208]; try { const _0x4d63e8 = localStorage[_0x18436e(0x310)](_0x18436e(0x58b)); if (_0x4d63e8) { const _0x5508e7 = JSON[_0x18436e(0xa69)](_0x4d63e8); if (Array['isArray'](_0x5508e7)) { if (_0x18436e(0x1f1) !== _0x18436e(0x1f1)) return '刚才'; else _0x5c61cd = [..._0xaacc34, ..._0x5508e7]; } else _0x5c61cd = _0xaacc34; } else _0x5c61cd = _0xaacc34; } catch (_0x2fa2a7) { console[_0x18436e(0x11e)](_0x18436e(0x5f5), _0x2fa2a7), _0x5c61cd = _0xaacc34; } if (!localStorage['getItem'](_0x18436e(0x563))) { if (_0x18436e(0x2f8) === _0x18436e(0x44e)) _0x3e3ca0(_0x3a773e), _0x3c0e00[_0x18436e(0x7f6)](_0x18436e(0x17b), _0x28e5e1), _0x2cab49['removeEventListener'](_0x18436e(0x11e), _0x385eee), _0x5ae197[_0x18436e(0x268)] = '', _0xeda323['remove'](); else { _0x39a14a(_0x18436e(0x502))[_0x18436e(0x834)](async _0x3116a1 => { const _0x5aa7e1 = _0x18436e; if (_0x5aa7e1(0x1ce) !== _0x5aa7e1(0x1ce)) { const _0x29ec3c = _0x56297b[_0x5aa7e1(0x7d5)](_0x5aa7e1(0xa23)), _0x48d587 = _0x2a472e[_0x5aa7e1(0x7d5)]('expense-amount'), _0x3d3d2e = _0x29ec3c['value'][_0x5aa7e1(0x6eb)](), _0x18d6d0 = _0x4b951f(_0x48d587[_0x5aa7e1(0x4d3)]); if (!_0x3d3d2e || _0x58ad8a(_0x18d6d0) || _0x18d6d0 <= 0x0) { _0x103945(_0x5aa7e1(0x1bd)); return; } _0xea8640[_0x5aa7e1(0x2e4)][_0x5aa7e1(0x98f)]({ 'id': 'exp_' + _0x2e3157[_0x5aa7e1(0x2f2)](), 'description': _0x3d3d2e, 'amount': _0x18d6d0, 'timestamp': _0x531d12[_0x5aa7e1(0x2f2)]() }), _0x25ff03(), _0x1ec14a(), _0x29ec3c[_0x5aa7e1(0x4d3)] = '', _0x48d587[_0x5aa7e1(0x4d3)] = '', _0x29ec3c[_0x5aa7e1(0x40d)](); } else { if (_0x3116a1) _0x1f66de(!![], _0x5aa7e1(0xa9f)), await _0x3d53c9(), localStorage[_0x5aa7e1(0x629)](_0x5aa7e1(0x563), 'true'), _0x1f66de(![]), _0x1e9edf(_0x5aa7e1(0x776)), setTimeout(() => location[_0x5aa7e1(0x569)](), 0x5dc); else { if (_0x5aa7e1(0x7da) === _0x5aa7e1(0x7da)) _0x1e9edf(_0x5aa7e1(0x7d2)); else { const _0x18ff60 = _0x16ca29[_0x5aa7e1(0x226)]['find'](_0x198065 => _0x198065[_0x5aa7e1(0x974)] === 'private' && _0x198065[_0x5aa7e1(0x9c8)][_0x5aa7e1(0x71e)](_0x108935['id'])), _0x4b97cb = _0x3966d2[_0x5aa7e1(0x6ed)][_0x5aa7e1(0x9b9)](_0x38ec1d => _0x38ec1d['id'] === (_0x18ff60?.[_0x5aa7e1(0x75d)] || _0x4cdb52['activeUserProfileId'])) || { 'id': 'default', 'name': '你' }; let _0x1393f0 = ''; return _0x2ee424[_0x5aa7e1(0x7d8)] && _0x4850ef[_0x5aa7e1(0x7d8)][_0x5aa7e1(0x280)] > 0x0 && (_0x1393f0 = _0x54340e[_0x5aa7e1(0x7d8)][_0x5aa7e1(0x33d)](_0x21251d => _0x1e9c5d[_0x5aa7e1(0x90d)][_0x5aa7e1(0x9b9)](_0x272eb3 => _0x272eb3['id'] === _0x21251d))['filter'](_0x55ae6f)[_0x5aa7e1(0x33d)](_0x4c8643 => _0x5aa7e1(0x7af) + _0x4c8643[_0x5aa7e1(0x695)] + _0x5aa7e1(0x71f) + _0x4c8643['content'])[_0x5aa7e1(0x8aa)]('')), _0x5aa7e1(0x614) + _0x77838c['id'] + _0x5aa7e1(0x84e) + _0x1c518a[_0x5aa7e1(0x695)] + _0x5aa7e1(0x8fc) + _0x5cf663[_0x5aa7e1(0x2a1)] + '\x0a\x20\x20\x20\x20绑定用户:\x20' + _0x4b97cb[_0x5aa7e1(0x695)] + '\x20(ID:\x20' + _0x4b97cb['id'] + ')\x0a' + _0x1393f0; } } } }); return; } } if (!localStorage[_0x18436e(0x310)]('noir_migration_fc_v1_complete')) { if ('UqAbl' === _0x18436e(0x539)) { console['log'](_0x18436e(0x344)), _0x1f66de(!![], _0x18436e(0x96a)); const _0x41baa4 = await _0x45bcfc(); localStorage['setItem'](_0x18436e(0x54f), _0x18436e(0x772)), _0x1f66de(![]); if (_0x41baa4 > 0x0) { if (_0x18436e(0x963) === 'UQkyu') { if (_0x3e5042) { const _0x16e9fe = _0x5df94e(_0x295190[_0x18436e(0x2c7)]); _0x16e9fe && (delete _0x16e9fe[_0x18436e(0x1e6)], _0x2b392c(), _0x20cc30(_0x16e9fe['id'], _0x18436e(0x6a9)), _0xd7ad87(_0x18436e(0x4d8)), _0x460419(!![])); } } else { _0x1e9edf(_0x18436e(0x6c1) + _0x41baa4 + _0x18436e(0x781)), setTimeout(() => location['reload'](), 0x5dc); return; } } } else _0x514c0f(), _0x321e3e[_0x18436e(0x793)] = [], _0x5b0b60(); } if (!localStorage[_0x18436e(0x310)](_0x18436e(0x54f))) { } if (!localStorage['getItem'](_0x18436e(0x5c2))) { if ('BSBlj' === _0x18436e(0x5b5)) { console[_0x18436e(0x688)](_0x18436e(0x70e)), _0x1f66de(!![], _0x18436e(0x273)); const _0x4c16c3 = await _0x221a51(); localStorage[_0x18436e(0x629)](_0x18436e(0x5c2), 'true'), _0x1f66de(![]); if (_0x4c16c3 > 0x0) { _0x1e9edf(_0x18436e(0x1e2) + _0x4c16c3 + '\x20张旧封面。应用即将刷新。'), setTimeout(() => location[_0x18436e(0x569)](), 0x5dc); return; } } else _0x5c1871(_0x18436e(0x36c), _0x18436e(0xa13)), _0x4a4c34(![]); } const _0x5b73d5 = document['getElementById'](_0x18436e(0x2e5)); _0x5b73d5[_0x18436e(0x988)](_0x18436e(0x649), () => { const _0x145226 = _0x18436e; _0x268a7d(), _0x384da8(_0x145226(0x18d), 'home'); }); const _0x4482d9 = _0x5dd19b(); try { const _0x5a8ed3 = localStorage[_0x18436e(0x310)]('appState'); if (_0x5a8ed3) { const _0x4a5d0b = JSON['parse'](_0x5a8ed3); _0x4a5d0b[_0x18436e(0x246)] && (_0x13c410['accountingLedger'] = _0x4a5d0b[_0x18436e(0x246)], console['log']('Noir\x27s\x20Temporal\x20Patch:\x20Ledger\x20re-synchronized.')); } } catch (_0xb7a3e4) { console[_0x18436e(0x11e)]('Noir\x27s\x20Temporal\x20Patch\x20failed:', _0xb7a3e4); } _0x43e0cd(), _0x5d419b(), _0x8ccff9(), _0x452bd1(), _0x2e76a8(), _0x597396(), _0x175b8f(), _0x18d655(), _0x15da9a(), _0xdad5ba(), _0x2da7c9(), _0x3b1800(), _0x28dbfd(), setInterval(_0x28dbfd, 0x7530), _0x20f90c(), _0x2de32d(), _0x52b46f(); const _0x4fd48c = document['getElementById'](_0x18436e(0x884)); document[_0x18436e(0x7d5)](_0x18436e(0x196))[_0x18436e(0x988)]('click', function (_0x503933) { const _0x1f1b36 = _0x18436e; if (_0x503933[_0x1f1b36(0x6d7)][_0x1f1b36(0x4b7)]('button')) return; const _0x2c2b73 = document[_0x1f1b36(0x7d5)](_0x1f1b36(0x1f6)); _0x2c2b73 && _0x2c2b73[_0x1f1b36(0x649)](); }), _0x384da8(_0x18436e(0x73e), _0x18436e(0x185)); (_0x4482d9 || _0x13c410['characters'][_0x18436e(0x280)] === 0x0) && (_0x1e9edf(_0x18436e(0x137)), setTimeout(() => { const _0x22c8b8 = _0x18436e; _0x22c8b8(0x370) === _0x22c8b8(0x6c3) ? _0x97ebe0[_0x22c8b8(0x462)]['display'] = _0x22c8b8(0x794) : (_0x384da8(_0x22c8b8(0x36c), _0x22c8b8(0x73e)), setTimeout(() => _0x27d377(), 0x64)); }, 0x6a4)); const _0x9f20bb = document[_0x18436e(0x7d5)](_0x18436e(0x377)); document['getElementById']('upload-widget-bg-button')[_0x18436e(0x988)](_0x18436e(0x649), () => _0x9f20bb[_0x18436e(0x649)]()), document[_0x18436e(0x7d5)](_0x18436e(0x3b8))[_0x18436e(0x988)](_0x18436e(0x649), () => { const _0x5c09fd = _0x18436e; _0x13c410['preferences'][_0x5c09fd(0x552)] = null, _0x5834f1(), _0x20f90c(), _0x1e9edf(_0x5c09fd(0x3e9)); }), _0x9f20bb['addEventListener']('change', async _0x2dd9e3 => { const _0x459b17 = _0x18436e; if (_0x459b17(0x3d7) !== _0x459b17(0x78b)) { const _0x5632a8 = _0x2dd9e3[_0x459b17(0x6d7)]['files'][0x0]; if (!_0x5632a8) return; try { if ('RJQLn' === _0x459b17(0x644)) _0x156e6b[_0x459b17(0x918)](_0x1363aa); else { const _0x24cb7e = await _0x14be68(_0x5632a8); _0x13c410['preferences'][_0x459b17(0x552)] = _0x24cb7e, _0x5834f1(), _0x20f90c(), _0x1e9edf(_0x459b17(0x421)); } } catch (_0x267348) { _0x1e9edf(_0x459b17(0x875) + _0x267348[_0x459b17(0x496)]); } } else { const _0x25ec64 = _0x3507ca(_0x137753[_0x459b17(0x9c8)][0x0]); return _0x25ec64?.[_0x459b17(0x695)] || 'AI'; } }), _0x449023(), document[_0x18436e(0x7d5)](_0x18436e(0x683))['addEventListener'](_0x18436e(0x649), () => document[_0x18436e(0x7d5)]('badge-input')[_0x18436e(0x649)]()), document['getElementById'](_0x18436e(0x1b8))[_0x18436e(0x988)](_0x18436e(0x649), async () => { const _0xcaf75c = _0x18436e; await _0x3815e2('widget_badge'), localStorage['removeItem']('badgeState'), _0x449023(), _0x1e9edf(_0xcaf75c(0xa03)); }), document[_0x18436e(0x7d5)](_0x18436e(0x1ad))['addEventListener']('change', async _0x17e407 => { const _0x2fc386 = _0x18436e, _0xf3b842 = _0x17e407['target'][_0x2fc386(0x6ea)][0x0]; if (!_0xf3b842) return; try { _0x2fc386(0x254) !== _0x2fc386(0x254) ? (_0x17eb21[_0x2fc386(0x349)]['remove']('active'), _0x4c508c[_0x2fc386(0x349)][_0x2fc386(0x699)]('active'), _0x5f321c(_0x4347c3, _0x3c5b93)) : (await _0x4162d1('widget_badge', _0xf3b842), await _0x449023(), _0x1e9edf(_0x2fc386(0x4ee))); } catch (_0x5a6fdd) { _0x1e9edf(_0x2fc386(0x875) + _0x5a6fdd[_0x2fc386(0x496)]); } }), _0x10606e(), document['getElementById'](_0x18436e(0x58a))['addEventListener']('mousedown', _0x4b90d9), document[_0x18436e(0x7d5)](_0x18436e(0x58a))['addEventListener']('touchstart', _0x4b90d9, { 'passive': ![] }), document['getElementById']('upload-card-button')[_0x18436e(0x988)]('click', () => document[_0x18436e(0x7d5)](_0x18436e(0x582))['click']()), document[_0x18436e(0x7d5)](_0x18436e(0x707))[_0x18436e(0x988)](_0x18436e(0x649), async () => { const _0x475840 = _0x18436e; await _0x3815e2('widget_card'), localStorage[_0x475840(0x7ec)](_0x475840(0x8a1)), _0x10606e(), _0x1e9edf(_0x475840(0x8d5)); }), document['getElementById']('card-input')['addEventListener'](_0x18436e(0x458), async _0x36b95d => { const _0x2aaae8 = _0x18436e; if ('bIgmZ' === _0x2aaae8(0x2b9)) _0x22f0e5(_0x5d7ce2, _0x2aaae8(0x6a9)); else { const _0x3fc0cf = _0x36b95d[_0x2aaae8(0x6d7)][_0x2aaae8(0x6ea)][0x0]; if (!_0x3fc0cf) return; try { await _0x4162d1(_0x2aaae8(0x1b9), _0x3fc0cf), await _0x10606e(), _0x1e9edf(_0x2aaae8(0x588)); } catch (_0x32d65d) { _0x1e9edf('错误:\x20' + _0x32d65d['message']); } } }), document[_0x18436e(0x7d5)](_0x18436e(0xa6a))[_0x18436e(0x988)]('click', async () => { const _0x10357d = _0x18436e, _0x3120cd = await _0x39a14a(_0x10357d(0x7f4)); _0x3120cd && (localStorage['removeItem']('badgeState'), localStorage[_0x10357d(0x7ec)]('cardWidgetState'), _0x1e9edf(_0x10357d(0x30a)), setTimeout(() => location[_0x10357d(0x569)](), 0x3e8)); }); const _0x159d8b = document[_0x18436e(0x7d5)]('app-diary'); _0x159d8b[_0x18436e(0x988)](_0x18436e(0x649), () => { const _0x916e69 = _0x18436e; if (_0x916e69(0x7d9) === _0x916e69(0x7d9)) _0x2463e0(), _0x384da8(_0x916e69(0x909), _0x916e69(0x73e)); else { if (_0x7c0bdc[_0x916e69(0xaa7)]()[_0x916e69(0x37a)]()) return; const _0x43fd5a = _0x1b476b[_0x916e69(0x6d7)][_0x916e69(0x4b7)](_0x916e69(0x5e9)), _0x54ed62 = _0x45220f[_0x916e69(0x6d7)][_0x916e69(0x4b7)](_0x916e69(0x609)); if (!_0x43fd5a || _0x54ed62) return; const _0x13b3ae = _0x4b6c2e(_0x43fd5a[_0x916e69(0x14b)][_0x916e69(0x12c)], 0xa); if (_0x4f17c9(_0x13b3ae)) return; _0xa6315f(_0x13b3ae); } }); const _0x22ab88 = document[_0x18436e(0x7d5)]('app-music-library'); _0x22ab88[_0x18436e(0x988)](_0x18436e(0x649), () => { const _0x1e8a3b = _0x18436e; _0x58dc98(), _0x384da8(_0x1e8a3b(0x64c), 'home'); }), document[_0x18436e(0x7d5)](_0x18436e(0x70a))[_0x18436e(0x988)]('click', () => _0x384da8('home', _0x18436e(0x64c))), document['getElementById'](_0x18436e(0xa04))[_0x18436e(0x988)]('click', () => _0x384da8(_0x18436e(0x73e), _0x18436e(0x909))), document[_0x18436e(0x7d5)](_0x18436e(0x636))[_0x18436e(0x988)](_0x18436e(0x649), () => { const _0x129df9 = _0x18436e; if (_0x129df9(0x284) === _0x129df9(0xa95)) { const _0x57837e = (_0x55216c['sticker'] ?? _0x4c5392[_0x129df9(0x72c)] ?? _0x229a1b['emote'] ?? _0x180bfd[_0x129df9(0x946)])?.[_0x129df9(0x6eb)](); if (_0x57837e && _0x1688f2[_0x129df9(0x8dd)](_0x57837e)) _0x3f2103[_0x129df9(0x572)]['push']({ 'senderId': _0x524935['id'], 'kind': 'sticker', 'sticker': _0x57837e }); else { const _0x3218f4 = _0x5f968a(_0xdae1f7['content'] ?? _0x21fc03[_0x129df9(0x928)] ?? '')['trim']() || _0x129df9(0xa6d) + (_0x57837e || _0x129df9(0x5ff)) + ']'; if (_0x3218f4) _0x263cf9[_0x129df9(0x572)][_0x129df9(0x98f)]({ 'senderId': _0x2dfc56['id'], 'kind': _0x129df9(0x928), 'content': _0x3218f4 }); } } else _0x13c410[_0x129df9(0x78f)] = null, _0x384da8(_0x129df9(0x909), _0x129df9(0x8b9)); }), document[_0x18436e(0x7d5)](_0x18436e(0x759))[_0x18436e(0x988)](_0x18436e(0x649), _0x45f8d8), document[_0x18436e(0x7d5)](_0x18436e(0x89b))[_0x18436e(0x988)](_0x18436e(0x649), _0xf50082), document['getElementById'](_0x18436e(0x83b))[_0x18436e(0x988)](_0x18436e(0x610), _0x30c8ec => { const _0x35d57c = _0x18436e; _0x30c8ec[_0x35d57c(0x8ee)] === 'Enter' && !_0x30c8ec[_0x35d57c(0x536)] && (_0x30c8ec['preventDefault'](), _0x45f8d8()); }); const _0x2035de = [_0x18436e(0x6a9), 'happy', _0x18436e(0x69a), _0x18436e(0x5ad), _0x18436e(0xa20)]; _0x2035de[_0x18436e(0x8c0)](_0xb3d7a9 => { const _0x152280 = _0x18436e; if (_0x152280(0x709) !== _0x152280(0x2c9)) { const _0x4cdd72 = document[_0x152280(0x7d5)](_0x152280(0x5d3) + _0xb3d7a9 + '-preview'), _0x145aec = document[_0x152280(0x7d5)](_0x152280(0x5d3) + _0xb3d7a9 + _0x152280(0x26f)); if (_0x4cdd72 && _0x145aec) { if ('BIRSl' !== _0x152280(0x678)) { const _0x5ed5a5 = _0x2030b6(); _0x5ed5a5 && _0x5ed5a5[_0x152280(0x985)] && _0x5ed5a5[_0x152280(0x985)][_0x152280(0x971)] && (_0x1ddddf[_0x152280(0x462)][_0x152280(0x5f3)] = 'flex', _0x384251(() => _0x416d15[_0x152280(0x349)][_0x152280(0x699)]('show'), 0xa)); } else _0x4cdd72[_0x152280(0x988)](_0x152280(0x649), () => _0x145aec['click']()), _0x145aec[_0x152280(0x988)](_0x152280(0x458), async _0x1840e5 => { const _0x54560d = _0x152280, _0x16e00e = _0x1840e5[_0x54560d(0x6d7)]['files'][0x0]; if (!_0x16e00e) return; try { _0x54560d(0x515) !== _0x54560d(0x764) ? _0x4cdd72[_0x54560d(0x268)] = URL[_0x54560d(0x602)](_0x16e00e) : (_0xd3115[_0x54560d(0x695)] = _0x285afb, _0x1b076a['content'] = _0x54765e); } catch (_0x489eed) { _0x1e9edf(_0x54560d(0x7c1) + _0x489eed[_0x54560d(0x496)]); } }); } } else { const _0x30d383 = _0x4ac032(_0x3082fb[_0x152280(0x9c8)][0x0]); _0x4f671c['textContent'] = _0x30d383 ? _0x30d383[_0x152280(0x695)] : '未知角色'; } }), document['getElementById'](_0x18436e(0x728))[_0x18436e(0x988)](_0x18436e(0x649), _0x205c90), document['getElementById'](_0x18436e(0x573))['addEventListener'](_0x18436e(0x649), () => { const _0x38e848 = _0x18436e; _0x13c410[_0x38e848(0x576)] = _0x13c410['meetingViewMode'] === _0x38e848(0x33b) ? _0x38e848(0x67f) : _0x38e848(0x33b), _0x459b6a(); }), document[_0x18436e(0x7d5)](_0x18436e(0x913))['addEventListener'](_0x18436e(0x6f9), _0xb386ca), document['getElementById'](_0x18436e(0x913))['addEventListener']('touchstart', _0xb386ca, { 'passive': ![] }); let _0x39b0ed = null; function _0xb386ca(_0x40830d) { const _0x316619 = _0x18436e; if (_0x316619(0x32d) === _0x316619(0x32d)) { if (_0x39b0ed) clearTimeout(_0x39b0ed); const _0x2d2223 = _0x40830d[_0x316619(0x6d7)]['closest']('p[data-history-index]'); if (!_0x2d2223) return; const _0x1c739d = parseInt(_0x2d2223[_0x316619(0x14b)]['historyIndex'], 0xa); if (isNaN(_0x1c739d)) return; const _0x1e481d = () => { _0x39b0ed = setTimeout(() => { const _0x5a8370 = _0x13a6; if (_0x40830d['type'] === _0x5a8370(0xa40)) _0x40830d['preventDefault'](); _0x8ca2d(_0x1c739d); }, 0x320); }, _0xf7b031 = () => { if (_0x39b0ed) clearTimeout(_0x39b0ed); }; document['addEventListener'](_0x316619(0x964), _0xf7b031, { 'once': !![] }), document[_0x316619(0x988)](_0x316619(0x1fc), _0xf7b031, { 'once': !![] }), document[_0x316619(0x988)](_0x316619(0x161), _0xf7b031, { 'once': !![] }), document[_0x316619(0x988)](_0x316619(0x87c), _0xf7b031, { 'once': !![] }), _0x1e481d(); } else _0x4f52ca(); } document[_0x18436e(0x32a)]['addEventListener'](_0x18436e(0x649), _0x4ebcec => { const _0x57becd = _0x18436e; if (_0x57becd(0x6a0) === _0x57becd(0x681)) { const _0x589472 = new _0x522485(_0x136d94[_0x57becd(0x921)]), _0x445b7b = _0x589472[_0x57becd(0x2bf)]() + '-' + _0x1a66f1(_0x589472[_0x57becd(0x550)]() + 0x1)['padStart'](0x2, '0') + '-' + _0x5846be(_0x589472[_0x57becd(0x1a4)]())[_0x57becd(0x380)](0x2, '0'), _0x111aec = _0x58e7a4(_0x589472['getHours']())[_0x57becd(0x380)](0x2, '0') + ':' + _0x33918c(_0x589472[_0x57becd(0x546)]())['padStart'](0x2, '0'); let _0x212aaa = '未知'; _0x3b0fcf[_0x57becd(0x4cc)] === 'user' ? _0x212aaa = _0x17ba36['name'] : _0x212aaa = _0x41afb1[_0x57becd(0x695)]; let _0x120bf2 = _0x184e3d[_0x57becd(0x75a)]; if (_0x1da136[_0x57becd(0x8ab)]) _0x120bf2 = _0x57becd(0x83e); if (_0x56a317[_0x57becd(0x5bb)]) _0x120bf2 = _0x57becd(0xa97); return '[' + _0x445b7b + '\x20' + _0x111aec + _0x57becd(0x5d7) + _0x212aaa + _0x57becd(0x71f) + _0x120bf2; } else { const _0x41d17d = _0x4ebcec[_0x57becd(0x6d7)][_0x57becd(0x4b7)](_0x57becd(0x2f5)); if (_0x41d17d) { if (_0x57becd(0x28f) !== _0x57becd(0x28f)) _0x7ff9d3 > _0x275a2b && (_0x39f7f8 *= _0x47fc3b / _0x7bf278, _0x3a1e23 = _0xbed129); else { const _0x1bce4f = _0x4ebcec[_0x57becd(0x6d7)][_0x57becd(0x4b7)](_0x57becd(0x36e)), _0x339309 = _0x4ebcec[_0x57becd(0x6d7)]['closest'](_0x57becd(0x807)); if (_0x1bce4f) _0x57becd(0x6a2) === _0x57becd(0x6a2) ? _0x5ef0b0() : _0xf834b0[_0x57becd(0x3fd)](_0xe0bfef); else { if (_0x339309) { if (_0x57becd(0x2bc) !== _0x57becd(0x27f)) { const _0x3bb812 = _0x339309[_0x57becd(0x4b7)](_0x57becd(0x5e9)), _0x5cde6b = _0x339309[_0x57becd(0x14b)]['songId'], _0x199066 = parseInt(_0x3bb812[_0x57becd(0x14b)][_0x57becd(0x12c)], 0xa); _0x11dced(_0x5cde6b, _0x199066, _0x41d17d); } else _0x59785a(_0x57becd(0x208)); } else { const _0x974c43 = _0xee1b45(); _0x974c43 && _0x974c43[_0x57becd(0x985)] && _0x974c43[_0x57becd(0x985)][_0x57becd(0x971)] && (_0x57becd(0x5da) === _0x57becd(0xa3e) ? _0x3cc558 += _0x57becd(0x5a4) + _0x2f0e1a['description'] + _0x57becd(0x47c) : (_0x3cc080[_0x57becd(0x462)][_0x57becd(0x5f3)] = _0x57becd(0x715), setTimeout(() => _0x3cc080[_0x57becd(0x349)][_0x57becd(0x699)](_0x57becd(0xa12)), 0xa))); } } return; } } if (window[_0x57becd(0xaa7)]()[_0x57becd(0x37a)]()) return; const _0x480018 = _0x4ebcec[_0x57becd(0x6d7)][_0x57becd(0x4b7)](_0x57becd(0x5e9)); if (_0x480018 && !_0x4ebcec[_0x57becd(0x6d7)][_0x57becd(0x4b7)](_0x57becd(0x609))) { if ('VQEEL' === _0x57becd(0x225)) { const _0x21d9ca = parseInt(_0x480018[_0x57becd(0x14b)][_0x57becd(0x12c)], 0xa); !isNaN(_0x21d9ca) && _0x8ca2d(_0x21d9ca); } else _0x291343[_0x57becd(0x462)][_0x57becd(0x5f3)] = _0x57becd(0x794); } } }); const _0x2c7ec5 = document[_0x18436e(0x7d5)]('noir-author-mark'); _0x2c7ec5 && _0x2c7ec5[_0x18436e(0x988)](_0x18436e(0x649), () => { const _0x451035 = _0x18436e; if ('bDSvH' !== _0x451035(0x494)) _0x1e9edf('核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a'); else { const _0x276445 = _0x5c7c00['userProfiles'][_0x451035(0x9b9)](_0x509bc2 => _0x509bc2['id'] === _0x307d07[_0x451035(0x56d)]) || { 'name': '你' }, _0x882f95 = _0x223876[_0x451035(0x324)][_0x451035(0x9b9)](_0x49f8aa => _0x49f8aa['characterId'] === _0x33e57e); if (!_0x882f95 || !_0x882f95[_0x451035(0x46c)] || _0x882f95[_0x451035(0x46c)][_0x451035(0x280)] === 0x0) return ''; const _0x2288b8 = _0x882f95[_0x451035(0x46c)][_0x451035(0x6d1)](-0x8), _0x15dde1 = _0x2288b8['map'](_0x6cd970 => { const _0x2b89c3 = _0x451035, _0x5d3a6a = _0x6cd970[_0x2b89c3(0x6d2)] === _0x2b89c3(0x425) ? _0x276445[_0x2b89c3(0x695)] : _0x7c93e5(_0x6cd970['author'])[_0x2b89c3(0x695)]; return _0x2b89c3(0x410) + new _0x5578f5(_0x6cd970[_0x2b89c3(0x921)])[_0x2b89c3(0x116)]() + ']\x20' + _0x5d3a6a + _0x2b89c3(0x1a3) + _0x6cd970['content']; })[_0x451035(0x8aa)]('\x0a'); return _0x451035(0x2f3) + _0x276445[_0x451035(0x695)] + '\x20之间的私密内容)\x0a' + _0x15dde1; } }); const _0x22a57b = document[_0x18436e(0x7d5)]('custom-stickers-input'), _0x257c36 = localStorage[_0x18436e(0x310)](_0x18436e(0x58b)); if (_0x257c36) try { if (_0x18436e(0x516) !== _0x18436e(0x6bc)) { const _0x25b787 = JSON['parse'](_0x257c36); Array[_0x18436e(0x850)](_0x25b787) && (_0x22a57b[_0x18436e(0x4d3)] = _0x25b787['map'](_0x407c7a => _0x407c7a[_0x18436e(0x695)] + '--' + _0x407c7a['url'])[_0x18436e(0x8aa)]('\x0a')); } else _0x1237b4['style']['display'] = _0x18436e(0x794); } catch (_0x1c2ab8) { } document[_0x18436e(0x7d5)]('save-custom-stickers-button')[_0x18436e(0x988)](_0x18436e(0x649), () => { const _0x44907b = _0x18436e, _0x33f181 = _0x22a57b[_0x44907b(0x4d3)], _0x5a8af3 = _0x33f181[_0x44907b(0x17a)]('\x0a')[_0x44907b(0x61f)](_0x3ea347 => _0x3ea347[_0x44907b(0x6eb)]() !== ''), _0xe326a7 = []; let _0x3da762 = 0x0; for (const _0x5eee1a of _0x5a8af3) { if ('AyGHI' === _0x44907b(0x833)) _0xde253e[_0x44907b(0x268)] && _0x595d0d[_0x44907b(0x462)][_0x44907b(0x669)] !== '0' ? (_0x2c117b['style'][_0x44907b(0x669)] = 0x0, _0x1cbe5f(() => { const _0x705861 = _0x44907b; _0x3c8024[_0x705861(0x268)] = _0x4efa66[_0x705861(0x602)](_0x225324), _0x14bdb6[_0x705861(0x462)][_0x705861(0x669)] = 0x1; }, 0x96)) : (_0x364ed0['src'] = _0x36f57e[_0x44907b(0x602)](_0x24e041), _0x4fcdf4[_0x44907b(0x462)]['opacity'] = 0x1); else { const _0x10bc3d = _0x5eee1a['split']('--'); if (_0x10bc3d[_0x44907b(0x280)] === 0x2 && _0x10bc3d[0x0][_0x44907b(0x6eb)]() && _0x10bc3d[0x1][_0x44907b(0x6eb)]()[_0x44907b(0x6ec)](_0x44907b(0x239))) { if (_0x44907b(0x1b3) === _0x44907b(0x491)) return _0x41063c[_0x44907b(0x98f)](_0x517b8f), _0x296727; else _0xe326a7[_0x44907b(0x98f)]({ 'name': _0x10bc3d[0x0]['trim'](), 'url': _0x10bc3d[0x1][_0x44907b(0x6eb)]() }); } else _0x3da762++; } } _0x3da762 > 0x0 && ('QvBTB' === _0x44907b(0x49c) ? _0x173b3f[_0x44907b(0x462)][_0x44907b(0x97e)] = '' : _0x1e9edf('有\x20' + _0x3da762 + _0x44907b(0x34f))); try { _0x44907b(0x76f) !== _0x44907b(0x76f) ? (!_0x5e9e45 && (_0x4f868f = _0x5af4c4['createElement'](_0x44907b(0xa8b)), _0x96569d['id'] = 'feed-loader', _0x4cb48a[_0x44907b(0x3fd)](_0x2c95be)), _0x1ea76b[_0x44907b(0x65e)] = _0x44907b(0x4ec) + _0x1c35f9 + _0x44907b(0xec), _0x48c69f[_0x44907b(0x462)]['display'] = _0x44907b(0x715)) : (localStorage[_0x44907b(0x629)](_0x44907b(0x58b), JSON[_0x44907b(0x3e1)](_0xe326a7)), _0x1e9edf(_0x44907b(0x74f)), setTimeout(() => location[_0x44907b(0x569)](), 0x5dc)); } catch (_0x5a04ef) { _0x1e9edf(_0x44907b(0xaa0)); } }), _0x1698f8(), document[_0x18436e(0x7d5)](_0x18436e(0x8d3))[_0x18436e(0x988)](_0x18436e(0x649), () => { const _0x5818b2 = _0x18436e; document['getElementById'](_0x5818b2(0x7a1))[_0x5818b2(0x649)](); }), document[_0x18436e(0x7d5)](_0x18436e(0x56a))['addEventListener']('click', async () => { const _0x2ebdf8 = _0x18436e; await _0x3815e2(_0x2ebdf8(0x2f7)), localStorage[_0x2ebdf8(0x7ec)](_0x2ebdf8(0x90f)), _0x10606e(), _0x1e9edf(_0x2ebdf8(0x9b5)); }), document[_0x18436e(0x7d5)](_0x18436e(0x7a1))[_0x18436e(0x988)]('change', async _0x23e8d0 => { const _0x573596 = _0x18436e, _0x4ce7d5 = _0x23e8d0['target'][_0x573596(0x6ea)][0x0]; if (!_0x4ce7d5) return; try { await _0x4162d1(_0x573596(0x2f7), _0x4ce7d5), await _0x10606e(), _0x1e9edf('卡片\x202\x20已更换！'); } catch (_0x5257ab) { if (_0x573596(0x289) !== _0x573596(0x4fc)) _0x1e9edf(_0x573596(0x875) + _0x5257ab[_0x573596(0x496)]); else { const _0x14cb50 = _0x2473fd[_0x573596(0x602)](_0x5b21d8); _0x19c30a[_0x573596(0x268)] = _0x14cb50, _0x403976['onload'] = () => { const _0x50000a = _0x573596; _0x7c6d3b[_0x50000a(0x918)](_0x14cb50); }; } } }); } const _0x27d534 = 'music_library'; async function _0x2a21c9(_0x28f7ff) { const _0x14140d = _0x314838; if (_0x14140d(0x7b2) === _0x14140d(0x729)) { const _0x101b5d = { 'id': _0x14140d(0x96c) + _0x3d178c[_0x14140d(0x921)], 'url': _0x5c9d8f[_0x14140d(0x128)] }; _0x576aa9(this, _0x101b5d); } else { const _0x8e9c34 = await _0x338d1d; return new Promise((_0x17bb39, _0xa8b9a5) => { const _0x59123f = _0x14140d, _0x5cac65 = _0x8e9c34['transaction'](_0x27d534, 'readonly'), _0x346e5f = _0x5cac65[_0x59123f(0x4bb)](_0x27d534), _0x154534 = _0x346e5f[_0x59123f(0x919)](_0x28f7ff); _0x154534[_0x59123f(0x804)] = () => _0x17bb39(_0x154534[_0x59123f(0x211)]), _0x154534[_0x59123f(0xaa9)] = () => _0xa8b9a5(_0x154534[_0x59123f(0x11e)]); }); } } async function _0x30e0f0() { const _0x2af14a = _0x314838; if (_0x2af14a(0x73c) !== 'ZvpVK') { const _0x16c8ee = _0x472b6e[_0x2af14a(0x4d3)][_0x2af14a(0x6eb)](); _0x16c8ee && (_0x46e115(_0x16c8ee), _0x4a96ab[_0x2af14a(0x4d3)] = '', _0x531e49(_0x210d8e, 0x64)); } else { const _0xc135ba = await _0x338d1d; return new Promise((_0x397b70, _0x234dea) => { const _0x58a934 = _0x2af14a, _0x148faa = _0xc135ba[_0x58a934(0x38a)](_0x27d534, _0x58a934(0x77b)), _0x2d7815 = _0x148faa['objectStore'](_0x27d534), _0x1d2f22 = _0x2d7815[_0x58a934(0x48f)](); _0x1d2f22['onsuccess'] = () => _0x397b70(_0x1d2f22['result']), _0x1d2f22[_0x58a934(0xaa9)] = () => _0x234dea(_0x1d2f22[_0x58a934(0x11e)]); }); } } async function _0x3a3366(_0x467b4e) { const _0x4ca1cc = _0x314838; if (_0x4ca1cc(0x796) === 'XmRdJ') _0x3572d4[_0x4ca1cc(0x98f)](_0x1021d5); else { const _0x4e684c = await _0x338d1d; return new Promise((_0x5ba637, _0x5ba0b5) => { const _0x507d19 = _0x4ca1cc; if (_0x507d19(0x6e6) === _0x507d19(0x6e6)) { const _0x505732 = _0x4e684c['transaction'](_0x27d534, _0x507d19(0x989)), _0x384216 = _0x505732[_0x507d19(0x4bb)](_0x27d534), _0x35a894 = _0x384216[_0x507d19(0x732)](_0x467b4e); _0x35a894['onsuccess'] = () => _0x5ba637(_0x35a894[_0x507d19(0x211)]), _0x35a894[_0x507d19(0xaa9)] = () => _0x5ba0b5(_0x35a894[_0x507d19(0x11e)]); } else _0x3155b1['activeDiaryCharacterId'] = null, _0x1aa0a6('diaryList', _0x507d19(0x8b9)); }); } } async function _0x5bf22f(_0x2a5138) { const _0x397bac = await _0x338d1d; return new Promise((_0x4d1f38, _0x3fac7c) => { const _0x58bcfe = _0x13a6; if (_0x58bcfe(0x950) !== _0x58bcfe(0x7cc)) { const _0x590318 = _0x397bac['transaction'](_0x27d534, _0x58bcfe(0x989)), _0x1074e8 = _0x590318[_0x58bcfe(0x4bb)](_0x27d534), _0x53b9d0 = _0x1074e8[_0x58bcfe(0x64a)](_0x2a5138); _0x53b9d0[_0x58bcfe(0x804)] = () => _0x4d1f38(), _0x53b9d0[_0x58bcfe(0xaa9)] = () => _0x3fac7c(_0x53b9d0[_0x58bcfe(0x11e)]); } else { const _0x339dfe = { 'id': _0x58bcfe(0x39d) + _0x250126[_0x58bcfe(0x2f2)](), 'name': _0x13398a, 'content': _0x48c0b2 }; _0x488025[_0x58bcfe(0x90d)][_0x58bcfe(0x98f)](_0x339dfe); } }); } let _0x39f6b4 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; const _0x2f45e1 = { 'audio': document[_0x314838(0x7d5)](_0x314838(0x418)), 'cover': document[_0x314838(0x7d5)](_0x314838(0x72a)), 'info': document[_0x314838(0x7d5)](_0x314838(0x9fd)), 'lyrics': document[_0x314838(0x7d5)](_0x314838(0x792)) }, _0x2d58de = { 'audio': document[_0x314838(0x7d5)]('audio-file-input'), 'cover': document[_0x314838(0x7d5)](_0x314838(0x181)), 'info': document[_0x314838(0x7d5)](_0x314838(0x95b)), 'lyrics': document[_0x314838(0x7d5)](_0x314838(0x42a)) }; for (const _0x7b6b58 in _0x2f45e1) { _0x314838(0x548) === _0x314838(0x587) ? _0x15535a[_0x314838(0x11e)](_0x314838(0x8a9) + _0x239bdf[_0x314838(0x55f)], _0x5a050e) : (_0x2f45e1[_0x7b6b58]['addEventListener']('click', () => _0x2d58de[_0x7b6b58][_0x314838(0x649)]()), _0x2d58de[_0x7b6b58][_0x314838(0x988)](_0x314838(0x458), _0x4d80f6 => { const _0x441059 = _0x314838; _0x1e0dd4(_0x7b6b58, _0x4d80f6[_0x441059(0x6d7)][_0x441059(0x6ea)][0x0]); })); } function _0x1e0dd4(_0x710af2, _0x4885bf) { const _0x2d6e06 = _0x314838; if (!_0x4885bf) return; _0x39f6b4[_0x710af2] = _0x4885bf, _0x2f45e1[_0x710af2][_0x2d6e06(0x298)](_0x2d6e06(0x55b))['textContent'] = _0x4885bf[_0x2d6e06(0x695)], _0x2f45e1[_0x710af2][_0x2d6e06(0x349)]['add']('filled'), _0x6a9d1e(); } function _0x6a9d1e() { const _0xbff738 = _0x314838; if (_0xbff738(0x149) !== 'GUxVT') { const _0x749784 = document[_0xbff738(0x7d5)]('confirm-altar-upload-button'); _0x39f6b4['audio'] && _0x39f6b4[_0xbff738(0x584)] ? 'cETHz' === _0xbff738(0x8bc) ? _0x749784[_0xbff738(0x99f)] = ![] : (_0x90ea6e[_0xbff738(0x462)]['position'] = _0xbff738(0x37d), _0x2e0de4[_0xbff738(0x462)][_0xbff738(0x43a)] = _0xbff738(0x16c), _0x290c66['style'][_0xbff738(0x26c)] = _0xbff738(0x93c), _0x5e05b2['style'][_0xbff738(0x424)] = 'translateX(-50%)', _0x1709f4[_0xbff738(0x462)][_0xbff738(0x5f3)] = _0xbff738(0x10c)) : 'NGMhd' === _0xbff738(0x6d4) ? _0x749784[_0xbff738(0x99f)] = !![] : (_0x3c8f54[_0xbff738(0x462)][_0xbff738(0x5f3)] = _0xbff738(0x794), _0x1e8fe5[_0xbff738(0x7d5)]('snoop-phone-top-nav')[_0xbff738(0x462)][_0xbff738(0x5f3)] = _0xbff738(0x715)); } else { if (_0x3fa289[_0xbff738(0x338)]) return; const _0x39fdb9 = _0xc94962[_0xbff738(0x436)], _0xeacf56 = _0x599130[_0xbff738(0x742)](_0x1e3d7['diaries'][_0xbff738(0x9b9)](_0x3bca45 => _0x3bca45[_0xbff738(0x951)] === _0xf5d89c[_0xbff738(0x78f)])['entries']['length'] / 0x2); if (_0x39fdb9 >= _0xeacf56 - 0x1) return; _0x4332c4[_0xbff738(0x338)] = !![]; const _0x143780 = _0x39fdb9 + 0x1, _0x3a21f6 = _0x4185c9['getElementById'](_0xbff738(0xa52) + _0x39fdb9), _0x2f9370 = _0x3eae9c[_0xbff738(0x7d5)]('diary-page-' + _0x143780); _0x3a21f6 && _0x2f9370 ? (_0x2f9370[_0xbff738(0x349)][_0xbff738(0x699)](_0xbff738(0x949)), _0x3a21f6[_0xbff738(0x349)][_0xbff738(0x699)](_0xbff738(0x306)), _0x2f9370[_0xbff738(0x349)][_0xbff738(0x699)](_0xbff738(0x6e2)), _0x170efa(() => { const _0x2385f3 = _0xbff738; _0x3a21f6['classList'][_0x2385f3(0x330)](_0x2385f3(0x6e2), _0x2385f3(0x306)), _0x2f9370['classList'][_0x2385f3(0x330)](_0x2385f3(0x949)), _0x523d62['diaryCurrentPage'] = _0x143780, _0x3c59ca(), _0x57c6d2[_0x2385f3(0x338)] = ![]; }, 0x2bc)) : _0x55720e[_0xbff738(0x338)] = ![]; } } function _0x4bb7ef() { const _0x2ae70b = _0x314838; if ('OWOsK' === _0x2ae70b(0x2cb)) { const _0x6c773d = _0x49546c === _0x27c719 ? _0x2ae70b(0x61e) : ''; return '' + _0x6c773d + _0x49abd0[_0x2ae70b(0x928)]; } else { _0x39f6b4 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x6a6009 in _0x2f45e1) { _0x2f45e1[_0x6a6009][_0x2ae70b(0x349)]['remove']('filled'), _0x2d58de[_0x6a6009][_0x2ae70b(0x4d3)] = ''; } _0x2f45e1[_0x2ae70b(0x7b6)][_0x2ae70b(0x298)](_0x2ae70b(0x55b))['textContent'] = _0x2ae70b(0x899), _0x2f45e1[_0x2ae70b(0x45d)][_0x2ae70b(0x298)]('.slot-filename')[_0x2ae70b(0x9e0)] = _0x2ae70b(0x6e8), _0x2f45e1[_0x2ae70b(0x584)][_0x2ae70b(0x298)](_0x2ae70b(0x55b))['textContent'] = _0x2ae70b(0x17f), _0x2f45e1['lyrics'][_0x2ae70b(0x298)](_0x2ae70b(0x55b))[_0x2ae70b(0x9e0)] = _0x2ae70b(0x108), _0x6a9d1e(); } } document[_0x314838(0x7d5)](_0x314838(0xa0d))[_0x314838(0x988)](_0x314838(0x649), async () => { const _0x501c8e = _0x314838; if (!_0x39f6b4[_0x501c8e(0x7b6)] || !_0x39f6b4[_0x501c8e(0x584)]) { _0x1e9edf(_0x501c8e(0x40e)); return; } await _0x5f4643(); }), document[_0x314838(0x7d5)]('upload-music-button')[_0x314838(0x988)]('click', () => { const _0xda27ac = _0x314838; _0x4bb7ef(), _0x384da8(_0xda27ac(0x97b), _0xda27ac(0x64c)); }), document['getElementById'](_0x314838(0x967))[_0x314838(0x988)](_0x314838(0x649), () => { const _0x512e7a = _0x314838; 'dNzWM' === _0x512e7a(0x6fe) ? _0x472294['appendChild'](_0x49face) : _0x384da8(_0x512e7a(0x64c), _0x512e7a(0x97b)); }); async function _0x5f4643() { const _0x4a41e1 = _0x314838; _0x1f66de(!![], _0x4a41e1(0x107)); try { const _0x2fb65b = await _0x39f6b4[_0x4a41e1(0x584)][_0x4a41e1(0x928)](); let _0x7206e9; if (_0x2fb65b['trim']()[_0x4a41e1(0x6ec)]('{')) _0x4a41e1(0xa87) === _0x4a41e1(0x788) ? _0x19cdef && _0x2ecd37(_0x39284a['id'], _0x5f09d6[_0x4a41e1(0x33d)](_0x593f96 => _0x593f96['id'])) : _0x7206e9 = JSON[_0x4a41e1(0xa69)](_0x2fb65b); else { if (_0x4a41e1(0x944) === 'TIJDE') _0x198a02[_0x4a41e1(0x55f)] = _0x51b7fd['id'], _0x48c20a(), _0x7ba6ef(), _0x5ff76d(_0x30a589); else { _0x7206e9 = {}; const _0x41bab7 = _0x2fb65b['split']('\x0a'); _0x41bab7[_0x4a41e1(0x8c0)](_0x2168d7 => { const _0x1bed23 = _0x4a41e1; if (_0x1bed23(0xa17) === _0x1bed23(0xa17)) { const _0x2fbfde = _0x2168d7[_0x1bed23(0x17a)](/:\s|：\s/); if (_0x2fbfde[_0x1bed23(0x280)] === 0x2) { if (_0x1bed23(0x43d) === _0x1bed23(0x43d)) { const _0x5ce71b = _0x2fbfde[0x0][_0x1bed23(0x6eb)](), _0x2a2f62 = _0x2fbfde[0x1][_0x1bed23(0x6eb)](), _0x128066 = { '歌名': _0x1bed23(0x80f), '艺术家': '歌手', '专辑': '专辑' }; if (_0x128066[_0x5ce71b]) { if (_0x1bed23(0x98a) !== _0x1bed23(0x885)) _0x7206e9[_0x128066[_0x5ce71b]] = _0x2a2f62; else { const _0x31e712 = _0xecb7c5(_0x2aca27['activeMeetingCharId']); if (!_0x31e712) return; _0x3407c7 = !![], _0x59d466[_0x1bed23(0x462)]['display'] = _0x1bed23(0x10c); const _0x3aa280 = _0x31e712[_0x1bed23(0x1e6)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; _0x1a55d7[_0x1bed23(0x7d5)]('sprite-slider-x')[_0x1bed23(0x4d3)] = _0x3aa280['x'], _0x32cee6[_0x1bed23(0x7d5)](_0x1bed23(0x5b1))[_0x1bed23(0x4d3)] = _0x3aa280['y'], _0x1a2def[_0x1bed23(0x7d5)](_0x1bed23(0x44b))[_0x1bed23(0x4d3)] = _0x3aa280[_0x1bed23(0x975)] * 0x64, _0x221cda = { ..._0x3aa280 }, _0x12fde9[_0x1bed23(0x7d5)]('galgame-textbox-container')['style'][_0x1bed23(0x5f3)] = _0x1bed23(0x794), _0x3457f0[_0x1bed23(0x7d5)](_0x1bed23(0xa82))[_0x1bed23(0x462)][_0x1bed23(0x5f3)] = _0x1bed23(0x794); } } } else _0xa0e0cd += '\x20[并附上了一张图片]'; } } else _0x4fc145[_0x1bed23(0x98f)](_0x5dd2e5); }); if (!_0x7206e9['歌曲名称']) { if (_0x4a41e1(0xa4f) === _0x4a41e1(0x6c5)) { _0x2bbdff[_0x4a41e1(0xa48)][_0x4a41e1(0x7d7)] = _0x19f593['value']['trim'](), _0x4c417c[_0x4a41e1(0xa48)]['key'] = _0x462a78[_0x4a41e1(0x4d3)][_0x4a41e1(0x6eb)](), _0x14c109['apiSettings']['model'] = _0x2406ee[_0x4a41e1(0x4d3)]['trim'](), _0x64ce59[_0x4a41e1(0xa48)][_0x4a41e1(0x7fe)] = _0x5380fe[_0x4a41e1(0x7d5)](_0x4a41e1(0xa51))[_0x4a41e1(0x4d3)]; const _0x22b645 = _0x49b8f0(_0x2a8761[_0x4a41e1(0x4d3)], 0xa); _0x456114[_0x4a41e1(0x859)]['perChatContextLines'] = _0x2382e2[_0x4a41e1(0x9fb)](_0x22b645) && _0x22b645 > 0x0 ? _0x22b645 : 0x64, _0x2d9bd9(), _0x1e4ec1(_0x4a41e1(0x3df)); } else throw new Error(_0x4a41e1(0x22b)); } _0x7206e9[_0x4a41e1(0x874)] = _0x4a41e1(0x475) + Date['now'](); } } const _0x3347c2 = 'song_' + (_0x7206e9['歌曲ID'] || Date[_0x4a41e1(0x2f2)]()), _0x39e2fa = { 'id': _0x3347c2, 'info': _0x7206e9, 'audio': _0x39f6b4['audio'], 'cover': _0x39f6b4[_0x4a41e1(0x45d)], 'lyrics': _0x39f6b4[_0x4a41e1(0x808)] ? await _0x39f6b4[_0x4a41e1(0x808)][_0x4a41e1(0x928)]() : '' }; await _0x3a3366(_0x39e2fa), await _0x58dc98(), _0x1f66de(![]), _0x1e9edf(_0x4a41e1(0x8df) + _0x7206e9['歌曲名称'] + _0x4a41e1(0x663)), _0x384da8(_0x4a41e1(0x64c), _0x4a41e1(0x97b)); } catch (_0x3ec0d2) { _0x1f66de(![]), console[_0x4a41e1(0x11e)](_0x4a41e1(0xa6b), _0x3ec0d2), _0x1e9edf(_0x4a41e1(0x6b4) + _0x3ec0d2[_0x4a41e1(0x496)]); } } async function _0x58dc98() { const _0x1111e0 = _0x314838; if (_0x1111e0(0x4e6) !== _0x1111e0(0x4e6)) { const _0x67145f = new _0x2adf24(); _0x67145f[_0x1111e0(0x68a)] = () => _0x124439(_0x67145f[_0x1111e0(0x211)]), _0x67145f[_0x1111e0(0xaa9)] = _0x4e6377, _0x67145f[_0x1111e0(0x8e5)](_0x3e68b1); } else { const _0x11fa5f = document[_0x1111e0(0x7d5)](_0x1111e0(0x1ee)); _0x11fa5f[_0x1111e0(0x65e)] = ''; const _0x4c4e4d = await _0x30e0f0(); if (_0x4c4e4d[_0x1111e0(0x280)] === 0x0) { _0x11fa5f[_0x1111e0(0x65e)] = _0x1111e0(0x8c6); return; } _0x4c4e4d['sort']((_0x357036, _0x90485b) => (_0x357036[_0x1111e0(0x584)]['歌曲名称'] || '')['localeCompare'](_0x90485b['info'][_0x1111e0(0x80f)] || '')); for (const _0x1bf775 of _0x4c4e4d) { const _0x4c7f69 = document[_0x1111e0(0xa30)](_0x1111e0(0xa8b)); _0x4c7f69['className'] = 'music-library-item', _0x4c7f69['dataset'][_0x1111e0(0x36a)] = _0x1bf775['id']; const _0x482b2 = _0x1bf775['cover'] ? URL[_0x1111e0(0x602)](_0x1bf775[_0x1111e0(0x45d)]) : _0x1c044f; _0x4c7f69[_0x1111e0(0x65e)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x482b2 + _0x1111e0(0x5c1) + (_0x1bf775[_0x1111e0(0x584)][_0x1111e0(0x80f)] || _0x1111e0(0x3dd)) + _0x1111e0(0x60c) + (_0x1bf775[_0x1111e0(0x584)]['歌手'] || _0x1111e0(0x9b4)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; let _0x4f34f0 = null; const _0x3aca74 = _0x2e1002 => { const _0x5362a8 = _0x1111e0; if (_0x2e1002[_0x5362a8(0x387)] === 0x2) return; _0x4f34f0 = setTimeout(async () => { const _0x3d30c6 = _0x5362a8; if (_0x2e1002[_0x3d30c6(0x974)] === _0x3d30c6(0xa40)) _0x2e1002[_0x3d30c6(0xa73)](); const _0x575a88 = await _0x39a14a(_0x3d30c6(0x335) + _0x1bf775['info'][_0x3d30c6(0x80f)] + _0x3d30c6(0x3d3)); _0x575a88 && (await _0x5bf22f(_0x1bf775['id']), await _0x58dc98(), _0x1e9edf(_0x3d30c6(0x1c6))); }, 0x320); }, _0x500070 = () => { const _0x4f93d1 = _0x1111e0; 'qQGXf' !== _0x4f93d1(0x499) ? _0x53e9f4('whispers', '聊天') : clearTimeout(_0x4f34f0); }; _0x4c7f69[_0x1111e0(0x988)](_0x1111e0(0x6f9), _0x3aca74), _0x4c7f69[_0x1111e0(0x988)](_0x1111e0(0x964), _0x500070), _0x4c7f69[_0x1111e0(0x988)]('mouseleave', _0x500070), _0x4c7f69[_0x1111e0(0x988)](_0x1111e0(0xa40), _0x3aca74, { 'passive': ![] }), _0x4c7f69[_0x1111e0(0x988)](_0x1111e0(0x161), _0x500070), _0x4c7f69['addEventListener'](_0x1111e0(0x87c), _0x500070), _0x4c7f69['addEventListener'](_0x1111e0(0x649), _0x151fc3 => { const _0x30acb2 = _0x1111e0; if ('cepWa' === 'cepWa') { if (_0x4f34f0) clearTimeout(_0x4f34f0); if (_0x151fc3[_0x30acb2(0x1a8)]) return; setTimeout(() => { const _0x3b2521 = _0x30acb2; _0x3b2521(0x51f) === 'uEiGP' ? _0x4f34f0 && _0x312ce5(_0x1bf775['id'], _0x4c4e4d[_0x3b2521(0x33d)](_0xa7c9a1 => _0xa7c9a1['id'])) : _0x5af7a8[_0x3b2521(0x3fd)](_0x3fa4f8); }, 0x32); } else { const _0x38a62f = _0x5a24d5(_0x48793f[_0x30acb2(0x4d3)]); if (_0x1b7947(_0x38a62f) || _0x38a62f <= 0x0) { _0x466952(_0x30acb2(0x680)); return; } const _0x5c4d19 = _0x1857b4(); let _0x133b3f = null; _0x5c4d19[_0x30acb2(0x974)] === 'group' ? _0x133b3f = _0x487222['value'] : _0x133b3f = _0x5c4d19[_0x30acb2(0x9c8)][0x0]; const _0x13b9f7 = _0x23a071(_0x5c4d19['id']), _0x556542 = { 'role': _0x30acb2(0x425), 'type': _0x30acb2(0x3ca), 'content': '[用户向\x20' + (_0x518e67(_0x133b3f)?.['name'] || '未知') + _0x30acb2(0x393) + _0x38a62f + ']', 'amount': _0x38a62f, 'recipientId': _0x133b3f, 'senderId': _0x13b9f7['id'], 'timestamp': _0x59261d[_0x30acb2(0x2f2)]() }; _0x2cd73e[_0x30acb2(0x793)][_0x30acb2(0x98f)](_0x556542), _0x1ed0fb(), _0x57608e(), _0x772e90[_0x30acb2(0x349)][_0x30acb2(0x330)](_0x30acb2(0xa12)); } }), _0x11fa5f['appendChild'](_0x4c7f69); } } } _0x422867[_0x314838(0x988)](_0x314838(0x649), () => { const _0x592610 = _0x314838; _0x592610(0x880) !== _0x592610(0x2de) ? _0x1e9edf(_0x592610(0x7c3)) : _0x548269(_0x47aaea['id']); }), _0x5bfcda[_0x314838(0x988)](_0x314838(0x649), () => { const _0x3242e2 = _0x314838; _0x1e9edf(_0x3242e2(0x9cb)); }); let _0x26a436 = [], _0x2972ba = -0x1; async function _0x312ce5(_0x33a1f5, _0x4f0010) { const _0x331e56 = _0x314838, _0x7406d0 = await _0x2a21c9(_0x33a1f5); if (!_0x7406d0) return; _0x3c9ea0 = { 'title': _0x7406d0['info'][_0x331e56(0x80f)] || _0x331e56(0x3dd), 'artist': _0x7406d0[_0x331e56(0x584)]['歌手'] || _0x331e56(0x9b4), 'cover': _0x7406d0['cover'] ? URL['createObjectURL'](_0x7406d0[_0x331e56(0x45d)]) : _0x1c044f, 'isFromLibrary': !![] }; const _0x5515f7 = URL[_0x331e56(0x602)](_0x7406d0[_0x331e56(0x7b6)]); _0x3247fc['src'] = _0x5515f7, _0x3247fc[_0x331e56(0x5c0)](), _0x3b1800(); } async function _0x3b1800() { const _0x450ae3 = _0x314838; if (_0x450ae3(0x111) !== 'MOdyE') { const _0x51c47d = document[_0x450ae3(0x7d5)](_0x450ae3(0x196)), _0x10fd97 = document[_0x450ae3(0x7d5)](_0x450ae3(0x601)), _0x3a9928 = document[_0x450ae3(0x7d5)](_0x450ae3(0x704)), _0x190a4d = document[_0x450ae3(0x7d5)](_0x450ae3(0xf2)), _0x3d3e0a = _0x3c9ea0; _0x3d3e0a && _0x3d3e0a['isFromLibrary'] ? (_0x10fd97[_0x450ae3(0x9e0)] = _0x3d3e0a[_0x450ae3(0x3bc)], _0x3a9928[_0x450ae3(0x9e0)] = _0x3d3e0a['artist'], _0x51c47d[_0x450ae3(0x349)][_0x450ae3(0x699)](_0x450ae3(0x22a)), _0x51c47d[_0x450ae3(0x462)][_0x450ae3(0x81c)](_0x450ae3(0x272), _0x450ae3(0x408) + _0x3d3e0a[_0x450ae3(0x45d)] + ')')) : 'zValm' === _0x450ae3(0x4e1) ? (_0x10fd97[_0x450ae3(0x9e0)] = _0x450ae3(0x7d3), _0x3a9928[_0x450ae3(0x9e0)] = _0x450ae3(0x625), _0x51c47d['classList']['remove'](_0x450ae3(0x22a)), _0x190a4d[_0x450ae3(0x462)][_0x450ae3(0x81c)](_0x450ae3(0x272), _0x450ae3(0x794))) : (_0x1e2543 = _0x5af594['touches'][0x0][_0x450ae3(0x221)], _0x5d12a9 = _0x4f17ac[_0x450ae3(0x790)][0x0][_0x450ae3(0x84b)], _0x3a0a0f = !![], _0x5af293 = ''); } else { const _0x994230 = _0x1aa411[_0x450ae3(0x67e)][_0x450ae3(0x9b9)](_0x3c33fc => _0x3c33fc['id'] === _0x3a51c7[_0x450ae3(0x6f0)]), _0x49ae63 = _0x994230?.[_0x450ae3(0x75d)]; let _0x438d04 = _0x14b0b8[_0x450ae3(0x6ed)][_0x450ae3(0x9b9)](_0x19ba10 => _0x19ba10['id'] === _0x49ae63); !_0x438d04 && (_0x438d04 = _0x5dfbc0[_0x450ae3(0x6ed)][_0x450ae3(0x9b9)](_0xd1b98d => _0xd1b98d['id'] === _0x1569d1[_0x450ae3(0x56d)])), !_0x438d04 && (_0x438d04 = _0x411e3f['userProfiles'][0x0]), _0x438d04 && (_0x376f99[_0x450ae3(0x7d5)](_0x450ae3(0x6de))[_0x450ae3(0x268)] = _0x438d04[_0x450ae3(0x907)] || _0x49af4d); } } _0x422867 && _0x422867[_0x314838(0x988)](_0x314838(0x649), () => { if (_0x26a436['length'] === 0x0) return; _0x2972ba = (_0x2972ba + 0x1) % _0x26a436['length'], _0x312ce5(_0x26a436[_0x2972ba], _0x26a436); }); _0x5bfcda && (_0x314838(0x189) === 'AqnNf' ? (_0x2f17e7[_0x314838(0x65e)] = '', _0x59b1bb[_0x314838(0x8c0)](_0x5f5d30 => { const _0x37fe84 = _0x314838, _0x209f45 = _0x234840['createElement']('div'); _0x209f45[_0x37fe84(0x9e0)] = _0x5f5d30, _0x209f45[_0x37fe84(0x988)]('click', () => { const _0xcf5508 = _0x37fe84; _0x3097df[_0xcf5508(0x4d3)] = _0x5f5d30, _0x8e0487[_0xcf5508(0x349)][_0xcf5508(0x330)]('show'); }), _0x569fc9[_0x37fe84(0x3fd)](_0x209f45); }), _0x4a6fa8['classList'][_0x314838(0x699)]('show'), _0x110beb(_0x314838(0x15b) + _0x42bca8[_0x314838(0x280)] + _0x314838(0x723))) : _0x5bfcda[_0x314838(0x988)](_0x314838(0x649), () => { const _0x15c9ce = _0x314838; if (_0x26a436[_0x15c9ce(0x280)] === 0x0) return; _0x2972ba = (_0x2972ba - 0x1 + _0x26a436['length']) % _0x26a436[_0x15c9ce(0x280)], _0x312ce5(_0x26a436[_0x2972ba], _0x26a436); })); _0x3247fc['addEventListener']('play', () => { const _0x46cc6f = _0x314838; if ('pzbhi' !== _0x46cc6f(0x75c)) { if (_0x5999cd) _0x5999cd[_0x46cc6f(0x9e0)] = '❚❚'; } else return _0x17d398[_0x46cc6f(0x11e)](_0x46cc6f(0x66e), _0xa0811e), _0x4f8de9[_0x46cc6f(0x11e)]('AI返回的原始文本:', _0x5c1cc0[_0x46cc6f(0x2f4)] || _0x46cc6f(0x238)), null; }), _0x3247fc[_0x314838(0x988)](_0x314838(0x993), () => { const _0x4aa71a = _0x314838; if (_0x4aa71a(0x1c7) === 'AwQGw') { if (_0x5999cd) _0x5999cd[_0x4aa71a(0x9e0)] = '▶'; } else { const _0x409a65 = _0x8f6383(_0x4604bd[_0x4aa71a(0x374)]) || { 'name': '未知' }; let _0x33cb52 = _0x4aa71a(0x94c) + _0x409a65[_0x4aa71a(0x695)] + _0x4aa71a(0x1bc) + (_0x16eb35[_0x4aa71a(0x83c)] || _0xceed8f['content']) + '”'; return _0x5b5f97[_0x4aa71a(0x974)] === _0x4aa71a(0x44d) && (_0x33cb52 += _0x4aa71a(0x8ce) + _0x4fcf96[_0x4aa71a(0x30d)] + _0x4aa71a(0xa41) + _0x524859['artist'] + ')'), _0x33cb52; } }), _0x3247fc['addEventListener']('ended', () => { if (_0x422867) _0x422867['click'](); }); function _0x599115() { const _0x5e22c8 = _0x314838, _0x517b7c = _0xee1b45(); if (!_0x517b7c) return; _0x1963c5[_0x5e22c8(0x65e)] = '', _0x212b02['value'] = '', _0x517b7c['type'] === 'group' ? (_0x517b7c['participantIds']['forEach'](_0xf6cc41 => { const _0x6a9467 = _0x5e22c8, _0x724c34 = _0x1d08b4(_0xf6cc41); if (_0x724c34) { const _0x552916 = document[_0x6a9467(0xa30)]('option'); _0x552916['value'] = _0x724c34['id'], _0x552916[_0x6a9467(0x9e0)] = _0x724c34[_0x6a9467(0x695)], _0x1963c5['appendChild'](_0x552916); } }), _0x4a4ac3[_0x5e22c8(0x462)][_0x5e22c8(0x5f3)] = 'block') : _0x4a4ac3[_0x5e22c8(0x462)][_0x5e22c8(0x5f3)] = 'none', _0x16b640[_0x5e22c8(0x349)][_0x5e22c8(0x699)](_0x5e22c8(0xa12)), _0x212b02[_0x5e22c8(0x40d)](); } function _0x90c25a() { const _0x3c56d5 = _0x314838, _0x5cc3be = parseFloat(_0x212b02[_0x3c56d5(0x4d3)]); if (isNaN(_0x5cc3be) || _0x5cc3be <= 0x0) { if (_0x3c56d5(0x4f8) === _0x3c56d5(0x4f8)) { _0x1e9edf(_0x3c56d5(0x680)); return; } else _0x1205ba(_0x3c56d5(0x36c), _0x3c56d5(0x73e)), _0x386f5b(() => _0x2f0f7d(), 0x64); } const _0x432bce = _0xee1b45(); let _0x3e0fb6 = null; _0x432bce['type'] === _0x3c56d5(0x9ad) ? _0x3e0fb6 = _0x1963c5[_0x3c56d5(0x4d3)] : _0x3c56d5(0x7ac) === 'MQzma' ? _0x3e0fb6 = _0x432bce[_0x3c56d5(0x9c8)][0x0] : _0x55e8d9['scrollTop'] = _0x24f668[_0x3c56d5(0x470)]; const _0x20d5b6 = _0x328a3b(_0x432bce['id']), _0x19bbd3 = { 'role': _0x3c56d5(0x425), 'type': _0x3c56d5(0x3ca), 'content': _0x3c56d5(0x848) + (_0x1d08b4(_0x3e0fb6)?.['name'] || '未知') + _0x3c56d5(0x393) + _0x5cc3be + ']', 'amount': _0x5cc3be, 'recipientId': _0x3e0fb6, 'senderId': _0x20d5b6['id'], 'timestamp': Date[_0x3c56d5(0x2f2)]() }; _0x13c410[_0x3c56d5(0x793)][_0x3c56d5(0x98f)](_0x19bbd3), _0xe23b38(), _0x403f79(), _0x16b640[_0x3c56d5(0x349)][_0x3c56d5(0x330)]('show'); } async function _0x36a225(_0x30db29) { const _0x2744b5 = _0x314838; if ('HjHDi' !== _0x2744b5(0x654)) { const _0x133485 = _0x1d08b4(_0x30db29); if (!_0x133485) return; const _0x20a70b = await _0x39a14a('确定要永久清空【' + _0x133485[_0x2744b5(0x695)] + '】的交换日记吗？\x0a此操作不可撤销，AI将彻底遗忘所有日记内容。'); if (!_0x20a70b) return; const _0x173ed0 = _0x13c410[_0x2744b5(0x324)]['findIndex'](_0x3228e6 => _0x3228e6[_0x2744b5(0x951)] === _0x30db29); if (_0x173ed0 > -0x1) _0x13c410[_0x2744b5(0x324)][_0x2744b5(0x3f5)](_0x173ed0, 0x1), _0x5834f1(), _0x2463e0(), _0x1e9edf('【' + _0x133485[_0x2744b5(0x695)] + '】的日记本已被清空。'); else { if (_0x2744b5(0x718) !== _0x2744b5(0x263)) _0x1e9edf(_0x2744b5(0x3c1)); else { const _0x159e24 = _0x5d8d52[_0x2744b5(0x4d3)][_0x2744b5(0x6eb)]()[_0x2744b5(0x71e)](_0x2b7185); _0x4c1d5b['disabled'] = _0x159e24; } } } else { _0x9b030['error'](_0x2744b5(0x911)); return; } } function _0x268a7d() { const _0x3359b8 = _0x314838, _0x47f314 = document[_0x3359b8(0x7d5)](_0x3359b8(0x9e7)); _0x47f314[_0x3359b8(0x65e)] = ''; const _0x34b613 = _0x13c410['characters'][_0x3359b8(0x61f)](_0x28a0ec => _0x13c410[_0x3359b8(0x226)][_0x3359b8(0x6aa)](_0x4a85a9 => _0x4a85a9[_0x3359b8(0x974)] === _0x3359b8(0x293) && _0x4a85a9['participantIds'][_0x3359b8(0x71e)](_0x28a0ec['id']))); if (_0x34b613[_0x3359b8(0x280)] === 0x0) { if ('xkoyQ' !== _0x3359b8(0x37e)) { _0x47f314['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以视奸的角色。</p>'; return; } else _0x181a2a[_0x3359b8(0x9e0)] = _0x3359b8(0x321) + _0x262c9f[_0x3359b8(0x280)] + '\x20项'; } _0x34b613[_0x3359b8(0x8c0)](_0x1eb542 => { const _0x42337d = _0x3359b8, _0x1bb6a4 = document[_0x42337d(0xa30)]('li'); _0x1bb6a4[_0x42337d(0x828)] = _0x42337d(0x76d), _0x1bb6a4[_0x42337d(0x14b)]['charId'] = _0x1eb542['id'], _0x1bb6a4[_0x42337d(0x65e)] = _0x42337d(0x81d) + (_0x1eb542[_0x42337d(0x907)] || _0x1c044f) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x1eb542['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>查看手机...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20snoop-clear-btn\x22\x20title=\x22清空' + _0x1eb542[_0x42337d(0x695)] + _0x42337d(0x3a2), _0x1bb6a4[_0x42337d(0x298)](_0x42337d(0x860))[_0x42337d(0x988)](_0x42337d(0x649), () => _0xd5b492(_0x1eb542['id'])), _0x1bb6a4[_0x42337d(0x298)](_0x42337d(0x234))[_0x42337d(0x988)](_0x42337d(0x649), async _0x405475 => { const _0x2fd0ea = _0x42337d; _0x405475[_0x2fd0ea(0xa9a)](); const _0x70e221 = _0x1d08b4(_0x1eb542['id']); if (!_0x70e221) return; const _0x22deee = await _0x39a14a(_0x2fd0ea(0x6d5) + _0x70e221[_0x2fd0ea(0x695)] + '】的手机内容吗？\x0a\x0a所有已生成的缓存（相册、NPC聊天等）都将被永久删除。'); if (_0x22deee) { _0x1f66de(!![], _0x2fd0ea(0x64f) + _0x70e221[_0x2fd0ea(0x695)] + '】的旧数据...'); const _0x5dc052 = [_0x2fd0ea(0x65c), _0x2fd0ea(0x686), _0x2fd0ea(0x888), _0x2fd0ea(0x28e), _0x2fd0ea(0x277), _0x2fd0ea(0x57f), 'footprints', _0x2fd0ea(0x59a)]; for (const _0xdec68d of _0x5dc052) { const _0x289b4a = _0x2fd0ea(0x179) + _0x70e221['id'] + '_' + _0xdec68d; await _0x5190cf(_0x289b4a); } _0x1f66de(![]), _0x1e9edf('【' + _0x70e221['name'] + _0x2fd0ea(0x58f)); } }), _0x47f314['appendChild'](_0x1bb6a4); }); } let _0x54984e = null, _0x238bac = null; function _0x331419() { const _0x21922b = _0x314838; if (_0x21922b(0x339) !== 'kVxvs') _0x37f6d6[_0x21922b(0x629)](_0xcc7b8c, _0x2c4475['localStorageData'][_0x9ef7f6]); else { const _0xe3afc5 = new Date(), _0x5b4bec = document[_0x21922b(0x7d5)](_0x21922b(0x36b)), _0x4f184a = document[_0x21922b(0x7d5)](_0x21922b(0x1be)), _0x493afa = document[_0x21922b(0x7d5)]('snoop-phone-header'); _0x5b4bec && _0x4f184a && (_0x5b4bec[_0x21922b(0x9e0)] = _0xe3afc5[_0x21922b(0x212)](_0x21922b(0x14d), { 'hour': _0x21922b(0x5bc), 'minute': _0x21922b(0x5bc), 'hour12': ![] }), _0x4f184a[_0x21922b(0x9e0)] = _0xe3afc5[_0x21922b(0x116)]('zh-CN', { 'month': _0x21922b(0x712), 'day': _0x21922b(0x847), 'weekday': _0x21922b(0x712) })), _0x493afa && ('ZSNur' === _0x21922b(0x397) ? (_0x511c64[_0x21922b(0x11e)](_0x21922b(0x778), _0x31b2b2), _0x50d850(_0x21922b(0x7fb) + _0xc35fb3['message'])) : _0x493afa[_0x21922b(0x65e)] = _0x21922b(0x169) + _0xe3afc5['toLocaleTimeString'](_0x21922b(0x14d), { 'hour': _0x21922b(0x5bc), 'minute': _0x21922b(0x5bc), 'hour12': ![] }) + _0x21922b(0x6d3)); } } function _0xd5b492(_0x121548) { const _0x4ed558 = _0x314838; _0x54984e = _0x121548; const _0x1cf39e = _0x1d08b4(_0x121548); if (!_0x1cf39e) return; const _0x525aa9 = document[_0x4ed558(0x7d5)](_0x4ed558(0x3db)), _0x2e4ea1 = document[_0x4ed558(0x7d5)]('snoop-home-clock'); if (_0x2e4ea1) _0x2e4ea1[_0x4ed558(0x330)](); const _0x1d173e = document[_0x4ed558(0x7d5)](_0x4ed558(0x8bb)); if (_0x1d173e) _0x1d173e['remove'](); _0x525aa9[_0x4ed558(0x7a2)](_0x4ed558(0x168), _0x4ed558(0x46f)), _0x525aa9[_0x4ed558(0x7a2)](_0x4ed558(0x168), _0x4ed558(0x464)), document[_0x4ed558(0x7d5)]('snoop-char-name-header')[_0x4ed558(0x9e0)] = '', _0x4f3e41(); if (_0x238bac) clearInterval(_0x238bac); _0x331419(), _0x238bac = setInterval(_0x331419, 0x2710), _0x384da8(_0x4ed558(0x82c), 'snoopList'); } function _0x4f3e41() { const _0x2c0cac = _0x314838, _0x1bbee8 = document[_0x2c0cac(0x7d5)](_0x2c0cac(0x1ae)), _0x4ad788 = document['getElementById'](_0x2c0cac(0x8bb)); _0x1bbee8[_0x2c0cac(0x65e)] = _0x2c0cac(0x11a), _0x4ad788[_0x2c0cac(0x65e)] = ''; const _0xf1bcc0 = _0x1bbee8[_0x2c0cac(0x298)]('.snoop-main-grid'), _0x18db33 = [{ 'id': _0x2c0cac(0x686), 'name': '聊天', 'svg': '<path\x20d=\x22M21\x2015a2\x202\x200\x200\x201-2\x202H7l-4\x204V5a2\x202\x200\x200\x201\x202-2h14a2\x202\x200\x200\x201\x202\x202z\x22></path>', 'area': 'dock' }, { 'id': _0x2c0cac(0x888), 'name': _0x2c0cac(0x119), 'svg': _0x2c0cac(0x9be), 'area': _0x2c0cac(0x8c5) }, { 'id': 'gallery', 'name': '相册', 'svg': _0x2c0cac(0x78c), 'area': _0x2c0cac(0x8c5) }, { 'id': _0x2c0cac(0x59a), 'name': '总结', 'svg': _0x2c0cac(0x7ed), 'area': 'dock' }, { 'id': _0x2c0cac(0x28e), 'name': _0x2c0cac(0x5e1), 'svg': _0x2c0cac(0x5e4), 'area': _0x2c0cac(0x5fd) }, { 'id': _0x2c0cac(0x277), 'name': '外卖', 'svg': '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011V7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v4\x22></path><line\x20x1=\x2210\x22\x20y1=\x2216\x22\x20x2=\x2210\x22\x20y2=\x2223\x22></line><line\x20x1=\x2214\x22\x20y1=\x2216\x22\x20x2=\x2214\x22\x20y2=\x2223\x22></line>', 'area': _0x2c0cac(0x5fd) }, { 'id': _0x2c0cac(0x57f), 'name': '购物', 'svg': _0x2c0cac(0xa64), 'area': _0x2c0cac(0x5fd) }, { 'id': _0x2c0cac(0x9a9), 'name': '足迹', 'svg': '<path\x20d=\x22M21\x2010c0\x207-9\x2013-9\x2013s-9-6-9-13a9\x209\x200\x200\x201\x2018\x200z\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2210\x22\x20r=\x223\x22></circle>', 'area': _0x2c0cac(0x5fd) }]; _0x18db33[_0x2c0cac(0x8c0)](_0x465c60 => { const _0x5a4630 = _0x2c0cac; if (_0x5a4630(0x2b8) !== _0x5a4630(0x731)) { const _0x1e30fb = document[_0x5a4630(0xa30)](_0x5a4630(0xa8b)); _0x1e30fb[_0x5a4630(0x828)] = 'snoop-app-icon', _0x1e30fb['innerHTML'] = _0x5a4630(0x357) + _0x465c60[_0x5a4630(0x932)] + _0x5a4630(0x4c4) + _0x465c60[_0x5a4630(0x695)] + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x1e30fb['addEventListener'](_0x5a4630(0x649), () => _0x368927(_0x465c60['id'], _0x465c60[_0x5a4630(0x695)])); if (_0x465c60[_0x5a4630(0x247)] === _0x5a4630(0x8c5)) _0x4ad788[_0x5a4630(0x3fd)](_0x1e30fb); else { if (_0x5a4630(0x235) !== 'Yineg') _0xf1bcc0[_0x5a4630(0x3fd)](_0x1e30fb); else { const _0x3e3130 = _0x35972a['getElementById'](_0x5a4630(0x68b)); if (!_0x3e3130) return; _0x1e7f29[_0x5a4630(0x859)][_0x5a4630(0x568)] ? (_0x3e3130['style'][_0x5a4630(0x673)] = _0x5a4630(0x777), _0x3e3130[_0x5a4630(0x462)][_0x5a4630(0x4f6)] = _0x5a4630(0x4d9)) : (_0x3e3130[_0x5a4630(0x462)]['color'] = _0x5a4630(0x5b2), _0x3e3130[_0x5a4630(0x462)][_0x5a4630(0x4f6)] = 'none'); } } } else { const _0x12b1ce = _0x3452e0[_0x5a4630(0x9c8)][0x0]; _0x5eae1f[_0x5a4630(0x349)][_0x5a4630(0x699)](_0x5a4630(0x68f) + _0x12b1ce); } }); } document[_0x314838(0x7d5)]('back-to-snoop-list-from-phone')['addEventListener'](_0x314838(0x649), () => { const _0x2ab457 = _0x314838; if (_0x2ab457(0x166) === 'aQDRf') { _0x238bac && (_0x2ab457(0x31a) === _0x2ab457(0x19e) ? _0x10dcde(_0x21df7f[_0x2ab457(0x5de)])['then'](_0x34b742 => { const _0x298989 = _0x2ab457, _0x102e64 = _0x53b060[_0x298989(0x7d5)](_0x18ab87); if (_0x102e64 && _0x34b742) _0x102e64[_0x298989(0x268)] = _0x460d66[_0x298989(0x602)](_0x34b742); }) : (clearInterval(_0x238bac), _0x238bac = null)); document[_0x2ab457(0x7d5)]('snoop-app-view-container')['style'][_0x2ab457(0x5f3)] = _0x2ab457(0x794); const _0x302b1a = document[_0x2ab457(0x7d5)](_0x2ab457(0x8bb)); if (_0x302b1a) _0x302b1a[_0x2ab457(0x330)](); const _0x23ce62 = document[_0x2ab457(0x7d5)](_0x2ab457(0x452)); if (_0x23ce62) _0x23ce62['remove'](); _0x384da8(_0x2ab457(0x18d), _0x2ab457(0x82c)); } else _0x13ac62(!![]); }); async function _0x368927(_0xf93b0d, _0x5c2133, _0x41031f = ![]) { const _0x4543fd = _0x314838; document['getElementById'](_0x4543fd(0x8a6))['style'][_0x4543fd(0x5f3)] = _0x4543fd(0x794); const _0x2112fe = document[_0x4543fd(0x7d5)](_0x4543fd(0x3e4)); _0x2112fe[_0x4543fd(0x65e)] = '<div\x20class=\x22loader-spinner\x22\x20style=\x22margin:\x20auto;\x22></div>', _0x2112fe[_0x4543fd(0x462)][_0x4543fd(0x5f3)] = _0x4543fd(0x715); const _0x187814 = _0x4543fd(0x179) + _0x54984e + '_' + _0xf93b0d; try { if (_0x4543fd(0x52e) !== _0x4543fd(0x3af)) { if (_0xf93b0d === _0x4543fd(0x59a)) { if (_0x4543fd(0x62d) === _0x4543fd(0x976)) { const _0x8b03ce = _0x231df9['getElementById'](_0x4543fd(0x8f6)), _0x583298 = _0x8b03ce[_0x4543fd(0x83d)](_0x4543fd(0x5f9)), _0x24db9f = _0x1b96d1[_0x4543fd(0x298)](_0x4543fd(0x15a)); if (_0x583298[_0x4543fd(0x280)] === 0x0) _0x24db9f[_0x4543fd(0x9e0)] = _0x4543fd(0x526); else _0x583298['length'] > 0x2 ? _0x24db9f['textContent'] = _0x4543fd(0x321) + _0x583298[_0x4543fd(0x280)] + '\x20项' : _0x24db9f['textContent'] = _0x599abf[_0x4543fd(0x703)](_0x583298)[_0x4543fd(0x33d)](_0x1969b8 => _0x1969b8[_0x4543fd(0x508)][_0x4543fd(0x9e0)][_0x4543fd(0x6eb)]())[_0x4543fd(0x8aa)]('、'); } else { const _0xc0900b = await _0x1d2e60(_0x54984e); _0x113383(_0xf93b0d, _0x5c2133, _0xc0900b); return; } } let _0x1ce39a = await _0x126b73(_0x187814); if (_0x41031f || !_0x1ce39a) { if (_0x4543fd(0xa44) !== _0x4543fd(0xa31)) { console[_0x4543fd(0x688)]('请求AI更新:\x20' + _0x187814 + _0x4543fd(0x4d4)); let _0x3c698f = await _0x4a29e4(_0xf93b0d, _0x54984e, _0x1ce39a); if (_0x3c698f) { const _0x92021e = _0x3c698f[_0x4543fd(0x2a3)](/```(?:json)?\s*([\s\S]*?)\s*```/), _0x9835fe = _0x92021e ? _0x92021e[0x1][_0x4543fd(0x6eb)]() : _0x3c698f['trim'](); let _0x581305; try { _0x581305 = JSON[_0x4543fd(0xa69)](_0x9835fe); } catch (_0x1cac39) { _0x581305 = _0x131942(_0x9835fe); if (!_0x581305) throw new Error(_0x4543fd(0x4f9)); } const _0x23721e = JSON['stringify'](_0x581305); await _0x557504(_0x187814, _0x23721e), _0x1ce39a = _0x23721e; } } else _0x5619e += _0x4543fd(0x15c) + _0x8914[_0x4543fd(0x661)] + _0x4543fd(0x47c); } else 'ZtAXf' === _0x4543fd(0x8d1) ? console[_0x4543fd(0x688)](_0x4543fd(0x4d0) + _0x187814) : _0x5016bb[_0x4543fd(0x98f)]('[' + _0xf3745f(_0x305aae) + ']\x20' + _0x3475f3['content']); _0x113383(_0xf93b0d, _0x5c2133, _0x1ce39a); } else _0x217341[_0x4543fd(0xa73)](), _0x3c5368(); } catch (_0x51ece0) { if ('uOCLT' === _0x4543fd(0x734)) console[_0x4543fd(0x11e)]('加载\x20' + _0x5c2133 + '\x20内容失败:', _0x51ece0), _0x2112fe['innerHTML'] = _0x4543fd(0xa75) + _0x51ece0['message'] + _0x4543fd(0x122); else { _0x3529a1(_0x4543fd(0x981)); return; } } } function _0x113383(_0x2e7989, _0x2a9f60, _0x1e12c6) { const _0x1d463b = _0x314838, _0x608ce9 = _0x1d08b4(_0x54984e), _0x47a215 = document[_0x1d463b(0x7d5)]('snoop-app-view-container'); let _0x3df9d2 = ''; if (!_0x1e12c6) _0x3df9d2 = _0x1d463b(0x3cc); else { if ('emfTE' === _0x1d463b(0x5b6)) { if (_0x2e7989 === 'summary') _0x3df9d2 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22snoop-summary-textarea\x22\x20readonly\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border:\x20none;\x20outline:\x20none;\x20resize:\x20none;\x20font-family:\x20\x27Courier\x20New\x27,\x20monospace;\x20font-size:\x200.85rem;\x20line-height:\x201.6;\x20background-color:\x20#fdfdfd;\x20padding:\x2015px;\x20box-sizing:\x20border-box;\x22>' + _0x1e12c6 + _0x1d463b(0xaa4); else { if ('VObYV' !== 'VObYV') { if (_0x1fd4dc[_0x1d463b(0x280)] === 0x0) return; _0x5f913 = (_0x347fc0 + 0x1) % _0x515ec8[_0x1d463b(0x280)], _0x471652(_0x32a2a[_0x9b4ef3], _0x2769cb); } else try { let _0x3b2cb5 = null; const _0x3a1975 = _0x1e12c6['match'](/```(?:json)?\s*([\s\S]*?)\s*```/), _0x30d251 = _0x3a1975 ? _0x3a1975[0x1] : _0x1e12c6; _0x3b2cb5 = JSON[_0x1d463b(0xa69)](_0x30d251); const _0x39713b = _0x1d08b4(_0x54984e); switch (_0x2e7989) { case _0x1d463b(0x65c): _0x3df9d2 = _0x344f20(_0x3b2cb5); break; case _0x1d463b(0x686): _0x3df9d2 = _0x40448e(_0x3b2cb5, _0x39713b[_0x1d463b(0x695)]); break; case _0x1d463b(0x888): _0x3df9d2 = _0x287955(_0x3b2cb5); break; case _0x1d463b(0x28e): _0x3df9d2 = _0x37570c(_0x3b2cb5); break; case _0x1d463b(0x277): _0x3df9d2 = _0x293015(_0x3b2cb5); break; case _0x1d463b(0x57f): _0x3df9d2 = _0x236347(_0x3b2cb5); break; case 'footprints': _0x3df9d2 = _0x2774c1(_0x3b2cb5); break; case _0x1d463b(0x59a): _0x3df9d2 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22snoop-summary-textarea\x22\x20readonly\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border:\x20none;\x20outline:\x20none;\x20resize:\x20none;\x20font-family:\x20\x27Courier\x20New\x27,\x20monospace;\x20font-size:\x200.85rem;\x20line-height:\x201.6;\x20background-color:\x20#fdfdfd;\x20padding:\x2015px;\x20box-sizing:\x20border-box;\x22>' + _0x1e12c6 + '</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'; break; default: _0x3df9d2 = '<pre\x20style=\x22white-space:\x20pre-wrap;\x20word-break:\x20break-word;\x22>' + JSON[_0x1d463b(0x3e1)](_0x3b2cb5, null, 0x2) + _0x1d463b(0x8f8); } } catch (_0x4dc20f) { if (_0x1d463b(0x351) === _0x1d463b(0xf3)) { const _0x5759e4 = _0x2c8178(); if (_0x5759e4 && _0x5759e4[_0x1d463b(0x974)] === _0x1d463b(0x293)) _0x12dd3b(_0x5759e4[_0x1d463b(0x9c8)][0x0]); else _0x5759e4 && _0x5759e4[_0x1d463b(0x974)] === 'group' && _0x2dbfc7(_0x5759e4['id']); } else console[_0x1d463b(0x11e)]('视奸内容解析失败:', _0x4dc20f), _0x3df9d2 = '<div\x20style=\x22padding:\x2015px;\x20background:\x20#ffebeb;\x20border-radius:\x208px;\x20color:\x20#d8000c;\x22><strong>解析失败了，哼。</strong><br>AI返回的原始内容：</div><pre\x20style=\x22white-space:\x20pre-wrap;\x20word-break:\x20break-word;\x20font-family:\x20monospace;\x20margin-top:\x2010px;\x22>' + _0x1e12c6 + '</pre>'; } } } else _0xcdadd1[_0x1d463b(0x9e0)] = _0x1d463b(0xa22), _0x5d2966[_0x1d463b(0x4d3)] = '', _0x54ac32[_0x1d463b(0x4d3)] = _0x1d463b(0x84a) + (_0x1364d0[_0x1d463b(0x67e)][_0x1d463b(0x280)] + 0x1), _0xec8098['value'] = _0x546098[_0x1d463b(0x56d)], _0x3bd4f4[_0x1d463b(0x462)][_0x1d463b(0x5f3)] = 'none'; } _0x47a215[_0x1d463b(0x65e)] = _0x1d463b(0x42d) + _0x2a9f60 + _0x1d463b(0x6bf) + _0x608ce9[_0x1d463b(0x695)] + _0x1d463b(0x78e) + (_0x2e7989 === _0x1d463b(0x59a) ? _0x1d463b(0x8ad) : _0x1d463b(0x2b0)) + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-content\x22>' + _0x3df9d2 + _0x1d463b(0x45c); const _0x170a65 = _0x47a215[_0x1d463b(0x298)](_0x1d463b(0x346)); _0x2e7989 === _0x1d463b(0x59a) && (_0x170a65[_0x1d463b(0x462)][_0x1d463b(0x4f7)] = '0'); document[_0x1d463b(0x7d5)](_0x1d463b(0x170))['addEventListener'](_0x1d463b(0x649), () => { const _0x5a9780 = _0x1d463b; _0x47a215['style']['display'] = _0x5a9780(0x794), document[_0x5a9780(0x7d5)](_0x5a9780(0x8a6))['style'][_0x5a9780(0x5f3)] = _0x5a9780(0x715); }); if (_0x2e7989 === _0x1d463b(0x59a)) { if (_0x1d463b(0x1eb) === _0x1d463b(0x29b)) { const _0x15e85d = _0x4701d4[_0x1d463b(0x7d5)](_0x5180cb); if (_0x15e85d && _0x14edbd) _0x15e85d[_0x1d463b(0x268)] = _0x2d1f94['createObjectURL'](_0x1a33da); } else document[_0x1d463b(0x7d5)]('snoop-copy-summary-btn')[_0x1d463b(0x988)](_0x1d463b(0x649), () => { const _0x1dcc84 = _0x1d463b, _0x3fe0f6 = document['getElementById'](_0x1dcc84(0x91d)); _0x3fe0f6['select'](), document[_0x1dcc84(0x9e3)](_0x1dcc84(0x29e)), _0x1e9edf(_0x1dcc84(0x855)); }); } else document['getElementById'](_0x1d463b(0x8e1))[_0x1d463b(0x988)]('click', async () => { _0x368927(_0x2e7989, _0x2a9f60, !![]); }); _0x2e7989 === 'whispers' && _0x47a215[_0x1d463b(0x83d)]('.snoop-chat-item')[_0x1d463b(0x8c0)](_0x4a3003 => { const _0x4155ad = _0x1d463b; _0x4a3003[_0x4155ad(0x988)](_0x4155ad(0x649), () => { const _0x55444f = _0x4155ad, _0x318269 = JSON['parse'](_0x4a3003[_0x55444f(0x14b)]['log']['replace'](/&quot;/g, '\x22')), _0x3fdf0b = _0x4a3003['dataset'][_0x55444f(0x8b5)], _0x57ba5b = _0x4a3003[_0x55444f(0x14b)][_0x55444f(0x968)]; _0x5bfbca(_0x3fdf0b, _0x57ba5b, _0x318269); }); }); } function _0x5bfbca(_0x30cc13, _0x42c5b5, _0x1439ce) { const _0x4f9143 = _0x314838, _0x5b40ea = document[_0x4f9143(0x298)](_0x4f9143(0x457)), _0x3a461e = document[_0x4f9143(0x298)]('#snoop-app-view-container\x20.snoop-app-header'); let _0x12a553 = _0x4f9143(0x89f); !_0x1439ce || _0x1439ce[_0x4f9143(0x280)] === 0x0 ? _0x12a553 += '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有对话记录。</p>' : _0x1439ce['forEach'](_0x167bcc => { const _0x2ba9b4 = _0x4f9143, _0x2520af = _0x167bcc[_0x2ba9b4(0x6da)] === _0x2ba9b4(0x65b), _0x18af19 = _0x2520af ? _0x42c5b5 ? _0x42c5b5[0x0] : '?' : _0x30cc13 ? _0x30cc13[0x0] : '?'; _0x12a553 += _0x2ba9b4(0x1e1) + (_0x2520af ? 'user' : 'ai') + _0x2ba9b4(0x4f1) + (!_0x2520af ? _0x2ba9b4(0xa7a) + _0x18af19 + '</div>' : '') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message\x20' + (_0x2520af ? _0x2ba9b4(0x425) : 'ai') + '\x22\x20style=\x22box-shadow:\x20none;\x20border:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>' + _0x167bcc['content'] + _0x2ba9b4(0x3b1) + (_0x2520af ? _0x2ba9b4(0xa7a) + _0x18af19 + _0x2ba9b4(0x447) : '') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'; }); _0x12a553 += _0x4f9143(0x447), _0x5b40ea['innerHTML'] = _0x12a553, _0x5b40ea[_0x4f9143(0x5f8)] = _0x5b40ea['scrollHeight'], _0x3a461e[_0x4f9143(0x65e)] = _0x4f9143(0x71c) + _0x30cc13 + _0x4f9143(0x5bf), document['getElementById'](_0x4f9143(0xa1c))[_0x4f9143(0x988)](_0x4f9143(0x649), () => { const _0xe23036 = _0x4f9143; _0xe23036(0x265) !== _0xe23036(0x136) ? _0x368927('whispers', '聊天') : _0x47bb89(_0xe23036(0x34e) + _0x11cb09['message']); }); if (!document[_0x4f9143(0x7d5)](_0x4f9143(0x5ab))) { if ('itiJB' !== _0x4f9143(0x789)) document[_0x4f9143(0x33f)][_0x4f9143(0x7a2)](_0x4f9143(0x168), _0x4f9143(0x2ed)); else { const _0xd6230b = _0x34b6c7[_0x4f9143(0xa69)](_0x5638bb['getItem']('badgeState') || '{}'), _0x32285d = { ..._0xd6230b, ..._0x4a7d01 }; _0x18ba2a['setItem'](_0x4f9143(0x49b), _0x3d01b5[_0x4f9143(0x3e1)](_0x32285d)); } } } function _0x131942(_0x5e6822) { const _0x3887cd = _0x314838; if (!_0x5e6822 || typeof _0x5e6822 !== 'string') return null; const _0x877576 = _0x5e6822['trim']()['split']('\x0a'), _0x553e35 = []; let _0x3e0998 = null; for (const _0x54ce3c of _0x877576) { if (_0x3887cd(0x3a8) !== _0x3887cd(0x3a8)) { _0x42acc7(_0x3887cd(0x9ff)); return; } else { const _0xb0f8c5 = _0x54ce3c['trim'](); if (_0xb0f8c5[_0x3887cd(0x6ec)]('-\x20')) { _0x3e0998 && _0x553e35[_0x3887cd(0x98f)](_0x3e0998); _0x3e0998 = {}; const _0xea30ee = _0xb0f8c5['substring'](0x2), _0x13433f = _0xea30ee[_0x3887cd(0x17a)](/:\s(.+)/); if (_0x13433f[_0x3887cd(0x280)] > 0x1) { const _0x5155f7 = _0x13433f[0x0]['trim'](), _0x307f02 = _0x13433f[0x1]['trim']()[_0x3887cd(0x1b5)](/^"|"$/g, ''); _0x3e0998[_0x5155f7] = _0x307f02; } } else { if (_0x3e0998 && _0xb0f8c5) { if (_0x3887cd(0x5d5) !== 'oFKUf') _0x467577[_0x3887cd(0x98f)](_0x594206); else { const _0x4338f9 = _0xb0f8c5[_0x3887cd(0x17a)](/:\s(.+)/); if (_0x4338f9['length'] > 0x1) { const _0x2f4465 = _0x4338f9[0x0][_0x3887cd(0x6eb)](), _0x581dcb = _0x4338f9[0x1]['trim']()[_0x3887cd(0x1b5)](/^"|"$/g, ''); _0x3e0998[_0x2f4465] = _0x581dcb; } } } } } } return _0x3e0998 && (_0x3887cd(0x266) === _0x3887cd(0x266) ? _0x553e35[_0x3887cd(0x98f)](_0x3e0998) : _0x1903b3(![])), _0x553e35['length'] > 0x0 ? _0x553e35 : null; } async function _0x4ce96e(_0x283fc6) { const _0x159400 = _0x314838; if (_0x159400(0x3bb) === _0x159400(0x5eb)) _0x2d211e[_0x159400(0xea)] = [], _0x1ffc41(), _0x577cda(), _0x4e0971(_0x159400(0x230)); else { if (!_0x283fc6) return ''; const _0xb0b9ce = [{ 'id': _0x159400(0x65c), 'name': '相册' }, { 'id': _0x159400(0x686), 'name': '和其他人的聊天' }, { 'id': _0x159400(0x888), 'name': _0x159400(0x76a) }, { 'id': 'fragments', 'name': _0x159400(0x5e1) }, { 'id': 'bites', 'name': _0x159400(0x42f) }, { 'id': _0x159400(0x57f), 'name': _0x159400(0x858) }, { 'id': _0x159400(0x9a9), 'name': _0x159400(0x662) }]; let _0x4f5622 = ''; for (const _0x30e61b of _0xb0b9ce) { if (_0x159400(0x965) !== _0x159400(0x965)) _0x33100d(_0x159400(0x691)); else try { if (_0x159400(0x5d9) !== _0x159400(0x5d9)) return; else { const _0x439c2d = 'snoop_' + _0x283fc6 + '_' + _0x30e61b['id'], _0x25f917 = await _0x126b73(_0x439c2d); if (_0x25f917) { const _0x3e3497 = _0x25f917[_0x159400(0x2a3)](/```(?:json)?\s*([\s\S]*?)\s*```/), _0x27c154 = _0x3e3497 ? _0x3e3497[0x1][_0x159400(0x6eb)]() : _0x25f917['trim'](); if (!_0x27c154) continue; let _0x3130cc = null; try { _0x3130cc = JSON[_0x159400(0xa69)](_0x27c154); } catch (_0x38ccc3) { console[_0x159400(0x1a0)](_0x159400(0x52d) + _0x30e61b['id'] + _0x159400(0x20b), _0x38ccc3[_0x159400(0x496)]); try { _0x3130cc = _0x131942(_0x27c154); if (!_0x3130cc) throw new Error(_0x159400(0x41c)); console[_0x159400(0x688)](_0x159400(0x3b9) + _0x30e61b['id'] + _0x159400(0x972)); } catch (_0x22698e) { throw _0x38ccc3; } } if (Array['isArray'](_0x3130cc) && _0x3130cc[_0x159400(0x280)] > 0x0) { _0x4f5622 === '' && (_0x4f5622 += _0x159400(0x960)); _0x4f5622 += '\x0a##\x20' + _0x30e61b['name'] + '\x0a'; switch (_0x30e61b['id']) { case _0x159400(0x65c): _0x3130cc[_0x159400(0x8c0)](_0x4ce7a6 => { const _0x2934d6 = _0x159400; _0x2934d6(0x8b0) !== 'YbjFY' ? _0x4f5622 += _0x2934d6(0x5a4) + _0x4ce7a6[_0x2934d6(0x361)] + _0x2934d6(0x47c) : _0x4b5562('错误:\x20' + _0x5ee294['message']); }); break; case _0x159400(0x686): _0x3130cc[_0x159400(0x8c0)](_0x376da1 => { const _0x572e20 = _0x159400; if (_0x572e20(0x183) !== _0x572e20(0x183)) { const _0x10fa29 = _0x20e678['toLowerCase'](); if (_0x328301[_0x572e20(0x6aa)](_0x32525f => _0x10fa29[_0x572e20(0x6ec)](_0x32525f))) { const _0x4184dc = _0x386cfc[_0x1704c7]; if (typeof _0x4184dc === _0x572e20(0x802)) _0x2b98e7[_0x572e20(0x98f)](_0x4184dc); if (_0x3ddc99[_0x572e20(0x850)](_0x4184dc)) _0x4184dc['forEach'](_0x304eb2 => { const _0x2a9aa5 = _0x572e20; if (typeof _0x304eb2 === _0x2a9aa5(0x802)) _0x310e8c['push'](_0x304eb2); }); } } else _0x4f5622 += _0x572e20(0x809) + _0x376da1[_0x572e20(0xa1b)] + _0x572e20(0x670) + _0x376da1[_0x572e20(0x193)] + '”。\x0a', _0x376da1[_0x572e20(0x688)] && Array[_0x572e20(0x850)](_0x376da1[_0x572e20(0x688)]) && (_0x572e20(0x811) === _0x572e20(0x811) ? (_0x4f5622 += _0x572e20(0x868), _0x376da1[_0x572e20(0x688)][_0x572e20(0x8c0)](_0x503c71 => { const _0x26a8d2 = _0x572e20, _0x4f8294 = _0x503c71['sender'] === _0x26a8d2(0x65b) ? '你' : _0x376da1[_0x26a8d2(0xa1b)]; _0x4f5622 += '\x20\x20\x20\x20-\x20' + _0x4f8294 + ':\x20' + _0x503c71['content'] + '\x0a'; })) : _0x5225f7(() => { const _0x330ef2 = _0x572e20; _0x4effe3['scrollTop'] = _0xd8835e[_0x330ef2(0x470)]; }, 0x0)); }); break; case _0x159400(0x888): _0x3130cc[_0x159400(0x8c0)](_0x3e4aac => { const _0x35aa96 = _0x159400; 'FJfIG' === _0x35aa96(0x472) ? _0x4f5622 += _0x35aa96(0x15c) + _0x3e4aac[_0x35aa96(0x661)] + _0x35aa96(0x47c) : _0xeb6345[_0x35aa96(0x649)](); }); break; case 'fragments': _0x3130cc[_0x159400(0x8c0)](_0xce3b99 => { const _0x2f957f = _0x159400; _0x4f5622 += _0x2f957f(0x4ef) + _0xce3b99[_0x2f957f(0x3bc)] + _0x2f957f(0xee) + _0xce3b99[_0x2f957f(0x75a)][_0x2f957f(0x1b5)](/\n/g, '\x20') + _0x2f957f(0x47c); }); break; case _0x159400(0x277): _0x3130cc['forEach'](_0x5a24c1 => { const _0x3b3d1c = _0x159400; _0x4f5622 += _0x3b3d1c(0x18b) + _0x5a24c1['restaurant_name'] + '”，里面有\x20' + _0x5a24c1[_0x3b3d1c(0x956)]['join']('、') + '。\x0a'; }); break; case _0x159400(0x57f): _0x3130cc['forEach'](_0x1db998 => { const _0x3d438a = _0x159400; _0x4f5622 += _0x3d438a(0x505) + _0x1db998['store_name'] + _0x3d438a(0x9d2) + _0x1db998[_0x3d438a(0x9d6)] + _0x3d438a(0x47c); }); break; case _0x159400(0x9a9): _0x3130cc[_0x159400(0x8c0)](_0x2e95d5 => { const _0x3e055c = _0x159400; _0x3e055c(0x8e7) === 'jWXBN' ? _0x4f5622 += _0x3e055c(0x2fa) + _0x2e95d5['location_name'] + _0x3e055c(0x3fe) + _0x2e95d5['activity_description'] + _0x3e055c(0x47c) : _0x1f9f37 = _0x1a2d63['name']; }); break; default: _0x3130cc[_0x159400(0x8c0)](_0x1f1684 => { const _0x2b0477 = _0x159400; if (_0x2b0477(0x5fa) === _0x2b0477(0x947)) { const _0x53aa76 = _0x228da6[_0x2b0477(0x90d)][_0x2b0477(0x9b9)](_0xa1654e => _0xa1654e['id'] === _0x49ce7e); _0x53aa76 && (_0x53aa76[_0x2b0477(0x695)] = _0x5409a5, _0x53aa76[_0x2b0477(0x75a)] = _0x10e5d2); } else _0x4f5622 += '-\x20' + JSON[_0x2b0477(0x3e1)](_0x1f1684) + '\x0a'; }); break; } } } } } catch (_0x432395) { _0x159400(0x553) === _0x159400(0x553) ? console[_0x159400(0x11e)]('加载视奸记忆失败\x20(' + _0x30e61b['id'] + ')，已跳过。这不应该发生，数据库可能已损坏。', _0x432395) : _0x14d185(_0x5ccc8b + 0x1); } } return _0x4f5622; } } function _0x344f20(_0x1c1cee) { const _0x2e4b3c = _0x314838; if (!Array[_0x2e4b3c(0x850)](_0x1c1cee)) return _0x2e4b3c(0xa1a); if (_0x1c1cee[_0x2e4b3c(0x280)] === 0x0) return _0x2e4b3c(0x7eb); return _0x2e4b3c(0xa91) + _0x1c1cee[_0x2e4b3c(0x33d)]((_0x3209e4, _0x488661) => _0x2e4b3c(0x38e) + (_0x488661 < _0x1c1cee[_0x2e4b3c(0x280)] - 0x1 ? 'border-bottom:\x201px\x20solid\x20var(--border-color);' : '') + _0x2e4b3c(0x969) + (_0x3209e4[_0x2e4b3c(0x361)] || _0x2e4b3c(0x88b)) + _0x2e4b3c(0x2ad) + (_0x3209e4['timestamp'] || '') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20')[_0x2e4b3c(0x8aa)]('') + '</div>'; } function _0x40448e(_0xa01216, _0xae4480) { const _0x3d3eb4 = _0x314838; if (!Array[_0x3d3eb4(0x850)](_0xa01216) || _0xa01216[_0x3d3eb4(0x280)] === 0x0) return _0x3d3eb4(0x2b1); return '<div\x20style=\x22background:\x20var(--card-bg);\x20border-radius:\x2012px;\x20overflow:\x20hidden;\x20border:\x201px\x20solid\x20var(--border-color);\x22>' + _0xa01216['map']((_0x57204a, _0x2159e9) => { const _0x3a1624 = _0x3d3eb4, _0x59bf05 = JSON[_0x3a1624(0x3e1)](_0x57204a[_0x3a1624(0x688)] || [])[_0x3a1624(0x1b5)](/'/g, '&apos;')[_0x3a1624(0x1b5)](/"/g, '&quot;'), _0x53f41e = _0x57204a[_0x3a1624(0xa1b)] || _0x3a1624(0xa1e); return _0x3a1624(0x2ab) + (_0x2159e9 < _0xa01216[_0x3a1624(0x280)] - 0x1 ? _0x3a1624(0x19a) : '') + _0x3a1624(0x451) + _0x59bf05 + _0x3a1624(0x3a9) + _0x53f41e + _0x3a1624(0x8c4) + _0xae4480 + '\x27>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22background-color:\x20#eee;\x20font-size:\x201.5rem;\x22>' + _0x53f41e[_0x3a1624(0x89d)](0x0) + _0x3a1624(0x40b) + _0x53f41e + _0x3a1624(0x9f2) + (_0x57204a[_0x3a1624(0x193)] || '') + _0x3a1624(0x93f); })['join']('') + _0x3d3eb4(0x447); } function _0x287955(_0x596f3e) { const _0x3b1c4b = _0x314838; if (!Array[_0x3b1c4b(0x850)](_0x596f3e)) return _0x3b1c4b(0xa1a); if (_0x596f3e['length'] === 0x0) return _0x3b1c4b(0x1cb); return _0x596f3e['sort']((_0x46188e, _0x2ac9d7) => new Date(_0x2ac9d7[_0x3b1c4b(0x921)]) - new Date(_0x46188e[_0x3b1c4b(0x921)])), '<div\x20style=\x22background:\x20var(--card-bg);\x20border-radius:\x2012px;\x20overflow:\x20hidden;\x20border:\x201px\x20solid\x20var(--border-color);\x22>' + _0x596f3e['map']((_0x10a2ba, _0x4f60e7) => _0x3b1c4b(0xa3c) + (_0x4f60e7 < _0x596f3e[_0x3b1c4b(0x280)] - 0x1 ? _0x3b1c4b(0x19a) : '') + _0x3b1c4b(0xa5e) + (_0x10a2ba['query'] || _0x3b1c4b(0x428)) + _0x3b1c4b(0x739) + (_0x10a2ba['result_page_content'] || _0x3b1c4b(0x97d)) + _0x3b1c4b(0x415) + (_0x10a2ba[_0x3b1c4b(0x921)] || '') + _0x3b1c4b(0x7e6))[_0x3b1c4b(0x8aa)]('') + _0x3b1c4b(0x447); } function _0x37570c(_0x3733dc) { const _0x18817c = _0x314838; if (!Array[_0x18817c(0x850)](_0x3733dc)) return '<p>格式错误</p>'; if (_0x3733dc['length'] === 0x0) return '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x22>备忘录是空的。</p>'; return _0x3733dc[_0x18817c(0x25d)]((_0x56d6ad, _0x1d7e1d) => new Date(_0x1d7e1d[_0x18817c(0x3d4)]) - new Date(_0x56d6ad[_0x18817c(0x3d4)])), _0x3733dc[_0x18817c(0x33d)](_0x3f06e2 => _0x18817c(0x3ce) + (_0x3f06e2[_0x18817c(0x3bc)] || _0x18817c(0xa37)) + _0x18817c(0xa65) + (_0x3f06e2['content'] || '') + _0x18817c(0x3cd) + (_0x3f06e2[_0x18817c(0x3d4)] || '') + _0x18817c(0x363))[_0x18817c(0x8aa)](''); } function _0x293015(_0x16dfe9) { const _0x4e2e72 = _0x314838; if (!Array[_0x4e2e72(0x850)](_0x16dfe9)) return _0x4e2e72(0xa1a); if (_0x16dfe9[_0x4e2e72(0x280)] === 0x0) return '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有外卖订单。</p>'; return _0x16dfe9[_0x4e2e72(0x25d)]((_0x5483b1, _0x374468) => new Date(_0x374468[_0x4e2e72(0x921)]) - new Date(_0x5483b1[_0x4e2e72(0x921)])), _0x16dfe9['map'](_0x48c5bc => { const _0x20d06f = _0x4e2e72, _0x26b1a0 = (_0x48c5bc['items'] || [])[_0x20d06f(0x33d)](_0x5bd6c1 => _0x20d06f(0x489) + _0x5bd6c1 + _0x20d06f(0x61d))[_0x20d06f(0x8aa)](''); return _0x20d06f(0x9d5) + (_0x48c5bc[_0x20d06f(0x69b)] || '未知餐厅') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22font-size:\x200.75rem;\x22>' + (_0x48c5bc['timestamp'] || '') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22font-size:\x200.85rem;\x20color:\x20#28a745;\x20font-weight:\x20500;\x22>' + (_0x48c5bc[_0x20d06f(0x3b4)] || _0x20d06f(0x9c7)) + _0x20d06f(0x8bf) + _0x26b1a0 + _0x20d06f(0x5c5) + (_0x48c5bc['total_cost'] || 0x0)['toFixed'](0x2) + _0x20d06f(0x5ef); })['join'](''); } function _0x236347(_0x9ea5b9) { const _0x1fd0e7 = _0x314838; if (!Array[_0x1fd0e7(0x850)](_0x9ea5b9)) return '<p>格式错误</p>'; if (_0x9ea5b9[_0x1fd0e7(0x280)] === 0x0) return _0x1fd0e7(0xa83); return _0x9ea5b9[_0x1fd0e7(0x25d)]((_0x260dd5, _0x37b5f3) => new Date(_0x37b5f3[_0x1fd0e7(0x921)]) - new Date(_0x260dd5[_0x1fd0e7(0x921)])), _0x9ea5b9['map'](_0x2ab2f2 => _0x1fd0e7(0x21b) + (_0x2ab2f2[_0x1fd0e7(0xa6f)] || _0x1fd0e7(0x12d)) + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22float:\x20right;\x22>' + (_0x2ab2f2[_0x1fd0e7(0x921)] || '') + _0x1fd0e7(0x57b) + (_0x2ab2f2[_0x1fd0e7(0x9d6)] || _0x1fd0e7(0x4bd)) + _0x1fd0e7(0x12b) + (_0x2ab2f2[_0x1fd0e7(0x367)] || 0x0)[_0x1fd0e7(0x176)](0x2) + _0x1fd0e7(0x39c))[_0x1fd0e7(0x8aa)](''); } function _0x2774c1(_0x40f730) { const _0x57ded1 = _0x314838; if (!Array[_0x57ded1(0x850)](_0x40f730)) return _0x57ded1(0xa1a); if (_0x40f730[_0x57ded1(0x280)] === 0x0) return _0x57ded1(0x3cf); return _0x40f730[_0x57ded1(0x25d)]((_0x25b292, _0x3e1fc5) => new Date(_0x3e1fc5['timestamp']) - new Date(_0x25b292['timestamp'])), _0x57ded1(0x818) + _0x40f730[_0x57ded1(0x33d)](_0x1e3722 => '\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20absolute;\x20left:\x20-25px;\x20top:\x2015px;\x20width:\x2020px;\x20height:\x2020px;\x20background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20font-size:\x201rem;\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-left:\x2010px;\x20padding:\x2012px\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20600;\x22>' + (_0x1e3722[_0x57ded1(0x147)] || _0x57ded1(0xa56)) + _0x57ded1(0x64d) + (_0x1e3722['activity_description'] || '') + _0x57ded1(0x2f1) + (_0x1e3722['timestamp'] || '') + _0x57ded1(0x8fd))['join']('') + '</div>'; } async function _0x4a29e4(_0x1a19f1, _0x2fa6ef, _0x4d256d = null) { const _0x230d7f = _0x314838, _0x2140d2 = _0x1d08b4(_0x2fa6ef), _0x3e6a9d = _0x13c410['chats'][_0x230d7f(0x9b9)](_0x409cd0 => _0x409cd0[_0x230d7f(0x974)] === _0x230d7f(0x293) && _0x409cd0[_0x230d7f(0x9c8)]['includes'](_0x2fa6ef)), _0x27634b = _0x328a3b(_0x3e6a9d?.['id'] || _0x13c410['activeChatId']); if (!_0x2140d2) throw new Error(_0x230d7f(0xa9c)); const { omniText: _0x489744 } = _0x32d34b(_0x2fa6ef); let _0x498b19 = ''; const _0x4dd7cf = new Date(), _0x95a16e = _0x1ca438(_0x2fa6ef); _0x498b19 = _0x230d7f(0x722), _0x498b19 += _0x230d7f(0x9a0) + _0x4dd7cf[_0x230d7f(0x79b)](_0x230d7f(0x14d), { 'dateStyle': _0x230d7f(0x21f), 'timeStyle': _0x230d7f(0x3eb) }) + '\x0a'; if (_0x95a16e) { const _0x2af47c = new Date(_0x95a16e[_0x230d7f(0x921)]), _0x26acdf = _0x50e57d(_0x2af47c); _0x498b19 += _0x230d7f(0x995) + _0x26acdf + '\x0a'; const _0xee0e66 = _0x4dd7cf[_0x230d7f(0x7ab)](), _0x53ca4c = _0x2af47c[_0x230d7f(0x7ab)](), _0x2a3777 = new Date(); _0x2a3777[_0x230d7f(0x6dd)](_0x4dd7cf[_0x230d7f(0x1a4)]() - 0x1); const _0x4038a8 = _0x2a3777[_0x230d7f(0x7ab)](); if (_0xee0e66 === _0x53ca4c) { const _0x5a7639 = (_0x4dd7cf - _0x2af47c) / (0x3e8 * 0x3c); _0x5a7639 < 0x3c ? _0x230d7f(0x8f7) !== _0x230d7f(0x6d0) ? _0x498b19 += _0x230d7f(0x77f) : (_0x4d2b83[_0x230d7f(0x349)][_0x230d7f(0x330)](_0x230d7f(0x513)), _0x5c6dd9['classList'][_0x230d7f(0x699)](_0x230d7f(0x513)), _0x27bf79()) : _0x498b19 += _0x230d7f(0x81a) + Math[_0x230d7f(0x519)](_0x5a7639 / 0x3c) + _0x230d7f(0x524); } else { if (_0x4038a8 === _0x53ca4c) 'EvTKY' === _0x230d7f(0x25e) ? _0x498b19 += _0x230d7f(0x821) : (_0x1edffe[_0x230d7f(0x462)][_0x230d7f(0x97e)] = _0x230d7f(0x5ce) + _0xb455ff[_0x230d7f(0x602)](_0xaa1bd9) + '\x27)', _0x1de31f[_0x230d7f(0x462)]['backgroundSize'] = _0x230d7f(0x45d), _0x22443a[_0x230d7f(0x462)][_0x230d7f(0x697)] = _0x230d7f(0x2a0)); else { const _0x2526c5 = Math[_0x230d7f(0x519)]((_0x4dd7cf - _0x2af47c) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x498b19 += _0x230d7f(0x16e) + _0x2526c5 + _0x230d7f(0x123); } } } else _0x498b19 += _0x230d7f(0x4ff); let _0x4d061b = '', _0x4d055b = ''; _0x4d256d ? (_0x4d061b = _0x230d7f(0x200), _0x4d055b = _0x230d7f(0x44a) + _0x4d256d + _0x230d7f(0x1d4)) : _0x230d7f(0x1c0) === _0x230d7f(0x1c0) ? _0x4d061b = '你的任务是【首次生成】这个应用的内容。' : _0x276514[_0x230d7f(0x629)](_0x284a9c, _0x3aa951[_0x230d7f(0x3e1)](_0x13c576)); const _0x2234fb = { 'gallery': '\x0a#\x20任务:\x20生成相册内容\x0a根据角色的近期经历、人际关系和隐藏性格，生成3\x20-\x205张照片的文字描述。重点是，照片内容要能引发联想，暗示一些用户不知道的事件。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22id\x22:\x20\x22photo_1725123456\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22一张在海边拍的黄昏照片，照片里有一个模糊的、看不清脸的背影。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-24\x2018:30\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'whispers': _0x230d7f(0x83f), 'abyss': _0x230d7f(0x4a1), 'fragments': _0x230d7f(0x5b8), 'bites': _0x230d7f(0x2d0), 'wants': _0x230d7f(0xa93), 'footprints': _0x230d7f(0x5e5) }, _0x53af0a = _0x2234fb[_0x1a19f1] || _0x230d7f(0x25c) + _0x1a19f1 + '\x20的内容\x0a请为角色生成符合其人设的应用数据。输出格式必须是严格的JSON数组。'; let _0x17e50d = ''; if (_0x2140d2[_0x230d7f(0x7d8)] && _0x2140d2[_0x230d7f(0x7d8)]['length'] > 0x0) { const _0x42b072 = _0x2140d2[_0x230d7f(0x7d8)][_0x230d7f(0x33d)](_0x485941 => _0x13c410[_0x230d7f(0x90d)][_0x230d7f(0x9b9)](_0x1fbfee => _0x1fbfee['id'] === _0x485941))[_0x230d7f(0x61f)](Boolean)[_0x230d7f(0x33d)](_0x545861 => _0x230d7f(0x574) + _0x545861[_0x230d7f(0x695)] + '\x0a' + _0x545861[_0x230d7f(0x75a)])[_0x230d7f(0x8aa)](''); _0x42b072 && (_0x230d7f(0x141) === _0x230d7f(0x322) ? _0x5dfa12(_0xe802ab['id']) : _0x17e50d = _0x230d7f(0x6f7) + _0x42b072); } const _0x150ac7 = _0x230d7f(0x40c) + _0x2140d2[_0x230d7f(0x695)] + _0x230d7f(0x9f4) + _0x2140d2[_0x230d7f(0x695)] + _0x230d7f(0x1a7) + _0x27634b[_0x230d7f(0x695)] + '”（用户）的信息当成你自己的。Ta只是与你互动的人，不是你。\x0a\x0a#\x20角色核心资料\x0a-\x20姓名:\x20' + _0x2140d2[_0x230d7f(0x695)] + _0x230d7f(0xa1f) + _0x2140d2['persona'] + '\x0a' + _0x17e50d + _0x230d7f(0x479) + _0x27634b[_0x230d7f(0x695)] + _0x230d7f(0xa1f) + _0x27634b[_0x230d7f(0x2a1)] + '\x0a\x0a' + _0x498b19 + _0x230d7f(0x1cf) + _0x489744 + '\x0a' + _0x4d055b + _0x230d7f(0x893) + _0x53af0a + _0x230d7f(0x54c), _0x39f191 = [{ 'role': _0x230d7f(0x711), 'content': _0x150ac7 }], _0x46833c = await _0x39cd5c(_0x39f191, { 'json': !![] }); return _0x46833c; } async function _0x1d2e60(_0x582292) { const _0x3723c1 = _0x314838, _0x98adf7 = _0x1d08b4(_0x582292); if (!_0x98adf7) throw new Error(_0x3723c1(0x6a1)); _0x1f66de(!![], '正在翻阅所有档案...'); const _0x195f3f = ['gallery', _0x3723c1(0x686), 'abyss', _0x3723c1(0x28e), _0x3723c1(0x277), _0x3723c1(0x57f), _0x3723c1(0x9a9)]; let _0x2cf4ee = {}; await Promise[_0x3723c1(0x7b1)](_0x195f3f[_0x3723c1(0x33d)](async _0x495790 => { const _0xdbc427 = _0x3723c1; if (_0xdbc427(0x596) === _0xdbc427(0x125)) return _0x45c94e[_0xdbc427(0x688)](_0xdbc427(0xa60)), 0x0; else { const _0x1e52bb = _0xdbc427(0x179) + _0x582292 + '_' + _0x495790, _0x2621ee = await _0x126b73(_0x1e52bb); if (_0x2621ee) { if (_0xdbc427(0x412) !== _0xdbc427(0x412)) _0x4e4757 = _0x2dfd9d[_0xdbc427(0x310)](_0xdbc427(0x151) + _0x1535b6[_0xdbc427(0x55f)]); else try { 'awipb' !== _0xdbc427(0x52c) ? (_0x233931(_0xdbc427(0x137)), _0x1e4419(() => { const _0x435b10 = _0xdbc427; _0x515b5e(_0x435b10(0x36c), _0x435b10(0x73e)), _0x43e94d(() => _0x2a0df1(), 0x64); }, 0x6a4)) : _0x2cf4ee[_0x495790] = JSON[_0xdbc427(0xa69)](_0x2621ee); } catch (_0x900a93) { } } } })); if (Object[_0x3723c1(0x132)](_0x2cf4ee)['length'] === 0x0) { if ('QTqCe' === 'QTqCe') return _0x3723c1(0x604); else { _0x22e420[_0x3723c1(0x65e)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>'; return; } } const _0x298327 = _0x3723c1(0x6c6) + _0x98adf7[_0x3723c1(0x695)] + _0x3723c1(0x710), _0x4352e5 = [{ 'role': _0x3723c1(0x711), 'content': _0x298327 }, { 'role': _0x3723c1(0x425), 'content': JSON['stringify'](_0x2cf4ee, null, 0x2) }]; _0x1f66de(!![], _0x3723c1(0x503)); const _0x57ac3d = await _0x39cd5c(_0x4352e5); return _0x57ac3d || _0x3723c1(0x1ab); } async function _0x1d2e60(_0x1c13aa) { const _0xd6459a = _0x314838, _0x23acf2 = _0x1d08b4(_0x1c13aa); if (!_0x23acf2) throw new Error(_0xd6459a(0x6a1)); try { _0x1f66de(!![], _0xd6459a(0x7fd)); const _0x6ba901 = [_0xd6459a(0x65c), 'whispers', _0xd6459a(0x888), 'fragments', _0xd6459a(0x277), _0xd6459a(0x57f), 'footprints']; let _0x172fdd = {}; await Promise['all'](_0x6ba901[_0xd6459a(0x33d)](async _0x6b669e => { const _0x108df2 = _0xd6459a, _0x469522 = _0x108df2(0x179) + _0x1c13aa + '_' + _0x6b669e, _0x138366 = await _0x126b73(_0x469522); if (_0x138366) try { 'ooFYs' !== _0x108df2(0x5d6) ? _0x59b5a0[_0x108df2(0x649)]() : _0x172fdd[_0x6b669e] = JSON['parse'](_0x138366); } catch (_0x46e999) { } })); if (Object[_0xd6459a(0x132)](_0x172fdd)[_0xd6459a(0x280)] === 0x0) { if (_0xd6459a(0x6cf) !== _0xd6459a(0x684)) return _0xd6459a(0x604); else _0x218f82 = _0xd6459a(0x414) + _0x1527fe + _0xd6459a(0xaa4); } const _0xef23e7 = '\x0a#\x20核心任务:\x20档案馆书记官\x0a你的任务是为一个名为“' + _0x23acf2[_0xd6459a(0x695)] + _0xd6459a(0x474), _0x3489cd = [{ 'role': _0xd6459a(0x711), 'content': _0xef23e7 }, { 'role': _0xd6459a(0x425), 'content': JSON['stringify'](_0x172fdd, null, 0x2) }]; _0x1f66de(!![], '书记官正在奋笔疾书...'); const _0x429f2e = await _0x39cd5c(_0x3489cd); return _0x429f2e || _0xd6459a(0x1ab); } finally { _0xd6459a(0x165) !== _0xd6459a(0x165) ? _0x4f6b3c(_0x47476f[_0xd6459a(0x2c7)], _0x226a93[_0xd6459a(0x248)]) : _0x1f66de(![]); } } document[_0x314838(0x7d5)]('back-to-home-from-snoop-list')[_0x314838(0x988)](_0x314838(0x649), () => _0x384da8(_0x314838(0x73e), _0x314838(0x18d))), document[_0x314838(0x7d5)](_0x314838(0x9e6))[_0x314838(0x988)](_0x314838(0x649), () => { const _0x1eed64 = _0x314838; if (_0x1eed64(0x12f) === _0x1eed64(0x9b7)) { const _0x5bf6cc = _0x129a38[_0x1eed64(0x7d5)](_0x1eed64(0x91d)); _0x5bf6cc[_0x1eed64(0x8b3)](), _0x231a79[_0x1eed64(0x9e3)](_0x1eed64(0x29e)), _0x16088d('档案已复制到剪贴板！'); } else document[_0x1eed64(0x7d5)](_0x1eed64(0x3e4))[_0x1eed64(0x462)][_0x1eed64(0x5f3)] = _0x1eed64(0x794), _0x384da8('snoopList', 'snoopPhone'); }), _0x4ca1f6(); }); function _0x13a6(_0x10afe3, _0xf1873e) { const _0x438ad0 = _0x438a(); return _0x13a6 = function (_0x13a6ef, _0x3d5a25) { _0x13a6ef = _0x13a6ef - 0xe4; let _0x317909 = _0x438ad0[_0x13a6ef]; return _0x317909; }, _0x13a6(_0x10afe3, _0xf1873e); } async function _0x3d53c9() { const _0xee8bd = _0x493a8b; console[_0xee8bd(0x688)](_0xee8bd(0x63a)), console['log'](_0xee8bd(0x17e)); async function _0x4b1842(_0x133328, _0x6fb425) { const _0x69a88e = _0xee8bd; if (_0x69a88e(0x9fa) !== _0x69a88e(0x903)) { const _0xd610c = await _0x338d1d; return new Promise((_0x2d3573, _0x11cbee) => { const _0x3737aa = _0x69a88e; if ('gSUKs' !== _0x3737aa(0x2d7)) { const _0x109b76 = _0xd610c['transaction'](_0x4e5aa3, _0x3737aa(0x989)), _0x5aded0 = _0x109b76[_0x3737aa(0x4bb)](_0x4e5aa3), _0x67a04f = _0x5aded0[_0x3737aa(0x732)]({ 'id': _0x133328, 'blob': _0x6fb425 }); _0x67a04f['onsuccess'] = () => _0x2d3573(_0x67a04f[_0x3737aa(0x211)]), _0x67a04f[_0x3737aa(0xaa9)] = () => _0x11cbee(_0x67a04f[_0x3737aa(0x11e)]); } else _0x5e5a56[_0x3737aa(0x349)][_0x3737aa(0x330)]('show'); }); } else return _0xd6cb6c[_0x69a88e(0x6ed)][_0x69a88e(0x9b9)](_0x1984e0 => _0x1984e0['id'] === _0x1f0adc); } async function _0x350ffe(_0xae83a6) { const _0xee3774 = await _0x338d1d; return new Promise((_0x55c381, _0x5b17dd) => { const _0x104fcc = _0x13a6, _0x4c75e1 = _0xee3774[_0x104fcc(0x38a)](_0x369ae2, _0x104fcc(0x77b)), _0x1ca5a4 = _0x4c75e1[_0x104fcc(0x4bb)](_0x369ae2), _0x2cee6d = _0x1ca5a4[_0x104fcc(0x919)](_0xae83a6); _0x2cee6d[_0x104fcc(0x804)] = () => _0x55c381(_0x2cee6d[_0x104fcc(0x211)] ? _0x2cee6d[_0x104fcc(0x211)]['data'] : null), _0x2cee6d['onerror'] = () => _0x5b17dd(_0x2cee6d['error']); }); } async function _0x263898(_0x5af163, _0x371848) { const _0x3cfcce = _0xee8bd; if ('ICzxd' === 'iqHZT') { const _0x507b5d = _0x1e9040[_0x3cfcce(0x1a5)](0x1, _0x4a253e(_0x30f39b[_0x3cfcce(0x859)]?.[_0x3cfcce(0x4cf)] ?? 0x64)), _0x336876 = _0x4ef91a['chats'][_0x3cfcce(0x61f)](_0x135341 => _0x135341['participantIds']['includes'](_0x7c6c98)), _0xb59b32 = _0x336876[_0x3cfcce(0x33d)](_0x46957b => { const _0x4fd100 = _0x3cfcce, _0xc4cd38 = _0x4cd8af(_0x46957b['id']), _0x2b2578 = _0xc4cd38[_0x4fd100(0x280)] > 0x0 ? _0xc4cd38[_0xc4cd38['length'] - 0x1] : null; return { 'chat': _0x46957b, 'history': _0xc4cd38, 'lastTimestamp': _0x2b2578 ? _0x2b2578[_0x4fd100(0x921)] : 0x0 }; })[_0x3cfcce(0x61f)](_0xbfd819 => _0xbfd819[_0x3cfcce(0x5a9)][_0x3cfcce(0x280)] > 0x0); _0xb59b32[_0x3cfcce(0x25d)]((_0x1dccbf, _0x355086) => _0x355086[_0x3cfcce(0xa7c)] - _0x1dccbf[_0x3cfcce(0xa7c)]); const _0x53c7cd = [], _0x3bdf57 = {}; return _0xb59b32[_0x3cfcce(0x8c0)]((_0x1eaa6b, _0x22e401) => { const _0x1ecf06 = _0x3cfcce, _0x1685ae = _0x5669a8(_0x1eaa6b['chat'], _0x1eaa6b[_0x1ecf06(0x5a9)], _0x507b5d); if (_0x1685ae[_0x1ecf06(0x280)] === 0x0) return; const _0x434b26 = _0x22e401 === 0x0 ? _0x1ecf06(0x39f) : _0x1ecf06(0x14c); _0x53c7cd[_0x1ecf06(0x98f)](_0x1ecf06(0x34a) + _0x434b26 + _0x499a21(_0x1eaa6b['chat']) + '\x0a' + _0x1685ae['join']('\x0a')), _0x3bdf57[_0x1eaa6b[_0x1ecf06(0x36c)]['id']] = _0x1685ae['length']; }), { 'omniText': _0x53c7cd[_0x3cfcce(0x8aa)]('\x0a\x0a'), 'usedCounts': _0x3bdf57 }; } else { const _0x17940b = await _0x338d1d; return new Promise((_0x46e089, _0x35ee67) => { const _0x4e667a = _0x3cfcce, _0x40f1df = _0x17940b[_0x4e667a(0x38a)](_0x369ae2, _0x4e667a(0x989)), _0x212dae = _0x40f1df[_0x4e667a(0x4bb)](_0x369ae2), _0x42114e = _0x212dae[_0x4e667a(0x732)]({ 'id': _0x5af163, 'data': _0x371848 }); _0x42114e[_0x4e667a(0x804)] = () => _0x46e089(), _0x42114e[_0x4e667a(0xaa9)] = () => _0x35ee67(_0x42114e[_0x4e667a(0x11e)]); }); } } function _0x141316(_0x546ba0) { const _0x2e9aba = _0xee8bd; if (_0x2e9aba(0x9b1) !== _0x2e9aba(0x922)) return fetch(_0x546ba0)[_0x2e9aba(0x834)](_0x11d9df => _0x11d9df[_0x2e9aba(0x409)]()); else { if (!_0x43b54c || typeof _0x3dfc0d !== 'string') return null; const _0x4405f3 = _0x39fd61['indexOf']('['), _0x373182 = _0x25622f[_0x2e9aba(0x4f4)](']'); if (_0x4405f3 > -0x1 && _0x373182 > _0x4405f3) return _0x1155e4[_0x2e9aba(0x5e0)](_0x4405f3, _0x373182 + 0x1); return null; } } let _0x58497f = 0x0; for (let _0x3ff538 = 0x0; _0x3ff538 < localStorage[_0xee8bd(0x280)]; _0x3ff538++) { if (_0xee8bd(0x49f) !== 'wjfOa') { if (_0x56b3ee['type'] === _0xee8bd(0xa40)) _0x513014[_0xee8bd(0xa73)](); _0x2c4177(_0x339bd9); } else { const _0x32293b = localStorage['key'](_0x3ff538); if (_0x32293b && _0x32293b[_0xee8bd(0x6ec)](_0xee8bd(0x151))) { if (_0xee8bd(0x7ad) !== _0xee8bd(0x4c1)) { let _0xc001d1, _0x317865 = ![]; try { _0xc001d1 = JSON['parse'](localStorage[_0xee8bd(0x310)](_0x32293b)); if (!Array[_0xee8bd(0x850)](_0xc001d1)) continue; for (const _0x33ce60 of _0xc001d1) { if (_0x33ce60 && _0x33ce60[_0xee8bd(0x98c)] && _0x33ce60[_0xee8bd(0x98c)]['startsWith']('data:image')) { if (_0xee8bd(0x5b3) === _0xee8bd(0x845)) { let _0x4a7955 = 0x0, _0x8292ae = 0x0, _0x54e46c = 0x0; if (_0x2e52ae[_0xee8bd(0x280)] == 0x4) _0x4a7955 = '0x' + _0x98995[0x1] + _0x514fc3[0x1], _0x8292ae = '0x' + _0x192fcc[0x2] + _0x29648a[0x2], _0x54e46c = '0x' + _0x493c2c[0x3] + _0x55c9ef[0x3]; else _0x2d3462[_0xee8bd(0x280)] == 0x7 && (_0x4a7955 = '0x' + _0x3d457e[0x1] + _0x5b8c7e[0x2], _0x8292ae = '0x' + _0x1a6518[0x3] + _0x1afc6d[0x4], _0x54e46c = '0x' + _0x26679f[0x5] + _0x46cc4d[0x6]); _0x4a7955 /= 0xff, _0x8292ae /= 0xff, _0x54e46c /= 0xff; let _0x28dd92 = _0x356ad7[_0xee8bd(0x467)](_0x4a7955, _0x8292ae, _0x54e46c), _0xb2d66c = _0x5c6459[_0xee8bd(0x1a5)](_0x4a7955, _0x8292ae, _0x54e46c), _0x237164 = _0xb2d66c - _0x28dd92, _0x4c19e2 = 0x0, _0x20d59f = 0x0, _0x38a630 = 0x0; if (_0x237164 == 0x0) _0x4c19e2 = 0x0; else { if (_0xb2d66c == _0x4a7955) _0x4c19e2 = (_0x8292ae - _0x54e46c) / _0x237164 % 0x6; else { if (_0xb2d66c == _0x8292ae) _0x4c19e2 = (_0x54e46c - _0x4a7955) / _0x237164 + 0x2; else _0x4c19e2 = (_0x4a7955 - _0x8292ae) / _0x237164 + 0x4; } } _0x4c19e2 = _0x1e0186[_0xee8bd(0x519)](_0x4c19e2 * 0x3c); if (_0x4c19e2 < 0x0) _0x4c19e2 += 0x168; return _0x38a630 = (_0xb2d66c + _0x28dd92) / 0x2, _0x20d59f = _0x237164 == 0x0 ? 0x0 : _0x237164 / (0x1 - _0x7ae562[_0xee8bd(0x7bf)](0x2 * _0x38a630 - 0x1)), _0x20d59f = +(_0x20d59f * 0x64)['toFixed'](0x1), _0x38a630 = +(_0x38a630 * 0x64)[_0xee8bd(0x176)](0x1), { 'h': _0x4c19e2, 's': _0x20d59f, 'l': _0x38a630 }; } else { const _0x10bb98 = await _0x141316(_0x33ce60[_0xee8bd(0x98c)]), _0x38fc45 = _0xee8bd(0x23e) + Date['now']() + '_' + Math['random'](); await _0x4b1842(_0x38fc45, _0x10bb98), _0x33ce60[_0xee8bd(0x5bb)] = _0x38fc45, delete _0x33ce60[_0xee8bd(0x98c)], _0x317865 = !![], _0x58497f++; } } } _0x317865 && localStorage[_0xee8bd(0x629)](_0x32293b, JSON[_0xee8bd(0x3e1)](_0xc001d1)); } catch (_0x5861a2) { console[_0xee8bd(0x11e)]('处理\x20' + _0x32293b + _0xee8bd(0x423), _0x5861a2); continue; } } else _0x37defb['activeUserProfileId'] = _0x1f4699['id']; } } } console['log']('净化完成！总共迁移了\x20' + _0x58497f + _0xee8bd(0x94a)); } async function _0x45bcfc() { const _0x32b202 = _0x493a8b; console['log'](_0x32b202(0x9f3)), console[_0x32b202(0x688)](_0x32b202(0x2ea)); async function _0x1199b9(_0x3ff028, _0x31a740) { const _0x5060ec = _0x32b202; if (_0x5060ec(0x278) !== _0x5060ec(0x391)) { const _0x19ac4d = await _0x338d1d; return new Promise((_0x470198, _0x3b8e0e) => { const _0x2f1459 = _0x5060ec, _0x418713 = _0x19ac4d[_0x2f1459(0x38a)]('images', _0x2f1459(0x989)), _0x31425d = _0x418713[_0x2f1459(0x4bb)](_0x2f1459(0x9d4)), _0x12876a = _0x31425d[_0x2f1459(0x732)]({ 'id': _0x3ff028, 'blob': _0x31a740 }); _0x12876a[_0x2f1459(0x804)] = () => _0x470198(_0x12876a[_0x2f1459(0x211)]), _0x12876a[_0x2f1459(0xaa9)] = () => _0x3b8e0e(_0x12876a[_0x2f1459(0x11e)]); }); } else { const _0xe872f6 = _0x7ca5ff[_0x5060ec(0xa30)](_0x5060ec(0xa8b)); _0xe872f6['className'] = _0x5060ec(0x4c9), _0xe872f6[_0x5060ec(0x65e)] = _0x5060ec(0x357) + _0x169d61[_0x5060ec(0x932)] + _0x5060ec(0x4c4) + _0x270fd7[_0x5060ec(0x695)] + _0x5060ec(0x8f4), _0xe872f6[_0x5060ec(0x988)](_0x5060ec(0x649), () => _0x30246f(_0x3d4570['id'], _0x4c876a['name'])), _0x1f0273[_0x5060ec(0x247)] === 'dock' ? _0x2bcfe0[_0x5060ec(0x3fd)](_0xe872f6) : _0xc4884f[_0x5060ec(0x3fd)](_0xe872f6); } } function _0x2616ab(_0x5d850e) { const _0x1f425d = _0x32b202; return fetch(_0x5d850e)[_0x1f425d(0x834)](_0x1cbb16 => _0x1cbb16[_0x1f425d(0x409)]()); } let _0x233659 = 0x0, _0x4bc310 = ![]; try { const _0xa98cbd = localStorage['getItem'](_0x32b202(0x156)); if (!_0xa98cbd) { console[_0x32b202(0x688)](_0x32b202(0xa00)); return; } const _0x24d89c = JSON[_0x32b202(0xa69)](_0xa98cbd); if (!_0x24d89c[_0x32b202(0x67e)] || !Array[_0x32b202(0x850)](_0x24d89c['friendCircles'])) return; for (const _0x3fb053 of _0x24d89c['friendCircles']) { if (_0x32b202(0x188) !== _0x32b202(0x188)) return _0x577f86(_0x1d710f)[_0x32b202(0x834)](_0x4b4c45 => _0x4b4c45['blob']()); else { if (_0x3fb053[_0x32b202(0xea)] && Array[_0x32b202(0x850)](_0x3fb053[_0x32b202(0xea)])) for (const _0x3ed841 of _0x3fb053[_0x32b202(0xea)]) { if (_0x3ed841 && _0x3ed841['image'] && _0x3ed841[_0x32b202(0x98c)][_0x32b202(0x6ec)]('data:image')) { console[_0x32b202(0x688)]('在好友圈\x20\x22' + _0x3fb053[_0x32b202(0x695)] + '\x22\x20中发现一张需要净化的图片...'); const _0x15f2a0 = await _0x2616ab(_0x3ed841[_0x32b202(0x98c)]), _0x45257a = _0x32b202(0x756) + Date[_0x32b202(0x2f2)]() + '_' + Math[_0x32b202(0x2a4)](); await _0x1199b9(_0x45257a, _0x15f2a0), _0x3ed841['imageId'] = _0x45257a, delete _0x3ed841[_0x32b202(0x98c)], _0x4bc310 = !![], _0x233659++; } } } } _0x4bc310 && (console['log'](_0x32b202(0x6cb)), localStorage['setItem'](_0x32b202(0x156), JSON[_0x32b202(0x3e1)](_0x24d89c))); } catch (_0x1acede) { console['error'](_0x32b202(0x510), _0x1acede); } return console[_0x32b202(0x688)](_0x32b202(0x1b0)), console['log'](_0x32b202(0x4b1) + _0x233659 + _0x32b202(0x9bf)), _0x233659; } async function _0x221a51() { const _0x536a8f = _0x493a8b; console['log'](_0x536a8f(0x7d1)), console[_0x536a8f(0x688)](_0x536a8f(0x6cc)); let _0x21c553 = 0x0, _0x2544e1 = ![]; try { if (_0x536a8f(0x85a) !== _0x536a8f(0x814)) { const _0x19eb42 = localStorage['getItem'](_0x536a8f(0x156)); if (!_0x19eb42) return console[_0x536a8f(0x688)](_0x536a8f(0xa60)), 0x0; for (let _0xc884be = 0x0; _0xc884be < localStorage[_0x536a8f(0x280)]; _0xc884be++) { const _0x21974f = localStorage[_0x536a8f(0x8ee)](_0xc884be); if (_0x21974f && _0x21974f['startsWith'](_0x536a8f(0x151))) { let _0x3917d7, _0xbc6e05 = ![]; try { _0x3917d7 = JSON['parse'](localStorage[_0x536a8f(0x310)](_0x21974f)); if (!Array[_0x536a8f(0x850)](_0x3917d7)) continue; for (const _0x5cf5e9 of _0x3917d7) { if (_0x5cf5e9 && (_0x5cf5e9[_0x536a8f(0x974)] === 'music' || _0x5cf5e9[_0x536a8f(0x974)] === 'listen-together-invite') && _0x5cf5e9[_0x536a8f(0x2e6)] && _0x5cf5e9['coverUrl'][_0x536a8f(0x6ec)]('data:image')) { if (_0x536a8f(0x303) !== _0x536a8f(0x303)) { let _0x84887b = _0x1074ff[_0x536a8f(0x90d)][_0x536a8f(0x9b9)](_0x4fdc82 => _0x4fdc82['name'] === _0x21ee88['name']); if (_0x84887b) _0x439c16['push'](_0x84887b['id']); else { const _0x29e957 = { 'id': 'wb_' + _0x4dee3d['now']() + '_' + _0x4cae2d[_0x536a8f(0x2a4)](), 'name': _0x2aaf58[_0x536a8f(0x695)], 'content': _0xee9e93[_0x536a8f(0x75a)] }; _0x1e794c[_0x536a8f(0x90d)][_0x536a8f(0x98f)](_0x29e957), _0x50aacc['push'](_0x29e957['id']); } } else { const _0x4c7432 = await _0x4904fe(_0x5cf5e9['coverUrl']), _0x27e686 = _0x536a8f(0x915) + Date[_0x536a8f(0x2f2)]() + '_' + Math[_0x536a8f(0x2a4)](); await _0x4162d1(_0x27e686, _0x4c7432), _0x5cf5e9['coverId'] = _0x27e686, delete _0x5cf5e9[_0x536a8f(0x2e6)], _0xbc6e05 = !![], _0x21c553++; } } } _0xbc6e05 && localStorage[_0x536a8f(0x629)](_0x21974f, JSON[_0x536a8f(0x3e1)](_0x3917d7)); } catch (_0x39c165) { if (_0x536a8f(0x315) === _0x536a8f(0x315)) { console[_0x536a8f(0x11e)](_0x536a8f(0x3ae) + _0x21974f + '\x20时出错，跳过。', _0x39c165); continue; } else _0x3a9a83 += _0x536a8f(0x809) + _0x2df05b[_0x536a8f(0xa1b)] + _0x536a8f(0x670) + _0x55440c[_0x536a8f(0x193)] + _0x536a8f(0x47c), _0x1fa37a['log'] && _0x5b1339[_0x536a8f(0x850)](_0x85c86c[_0x536a8f(0x688)]) && (_0x480222 += _0x536a8f(0x868), _0x28d9c0[_0x536a8f(0x688)][_0x536a8f(0x8c0)](_0x4b7be2 => { const _0x23ae2a = _0x536a8f, _0x461081 = _0x4b7be2[_0x23ae2a(0x6da)] === _0x23ae2a(0x65b) ? '你' : _0xade3db[_0x23ae2a(0xa1b)]; _0x2c4904 += _0x23ae2a(0x172) + _0x461081 + ':\x20' + _0x4b7be2[_0x23ae2a(0x75a)] + '\x0a'; })); } } } } else _0x45cae8 = { 'characterId': _0x21283e['activeDiaryCharacterId'], 'entries': [] }, _0x1c92c3['diaries'][_0x536a8f(0x98f)](_0x3f9727); } catch (_0x1e2cf0) { console[_0x536a8f(0x11e)]('净化音乐封面时出错，真是的。', _0x1e2cf0); } return console['log'](_0x536a8f(0x4ca)), console['log'](_0x536a8f(0x4b1) + _0x21c553 + _0x536a8f(0xa2f)), _0x21c553; } function _0x444594() { const _0x1af405 = _0x493a8b; if (!_0x13c410[_0x1af405(0x78f)]) return _0x13c410[_0x1af405(0x6ed)][_0x1af405(0x9b9)](_0x18273e => _0x18273e['id'] === _0x13c410[_0x1af405(0x56d)]) || _0x13c410['userProfiles'][0x0]; const _0x270838 = _0x13c410[_0x1af405(0x226)][_0x1af405(0x9b9)](_0x8baf91 => _0x8baf91[_0x1af405(0x974)] === 'private' && _0x8baf91[_0x1af405(0x9c8)][_0x1af405(0x71e)](_0x13c410[_0x1af405(0x78f)])), _0x414b9a = _0x270838?.['boundUserProfileId'] || _0x13c410['activeUserProfileId']; return _0x13c410[_0x1af405(0x6ed)][_0x1af405(0x9b9)](_0x397838 => _0x397838['id'] === _0x414b9a) || _0x13c410[_0x1af405(0x6ed)][0x0]; } function _0x438a() { const _0x4b2197 = ['confirm-altar-upload-button', 'MxpKh', 'sprites', 'https://sharkpan.xyz/f/eOXIw/y29z21.jpg', 'NzqSg', 'show', 'groupChatCreate', 'musicPlaylist', '#99ff99', '1760190GcDTZm', 'MSLpV', 'world-book-screen', 'bREUA', '<p>格式错误</p>', 'contact_name', 'snoop-log-back-btn', 'FCPZM', '未知联系人', '\x0a-\x20人设:\x20', 'shy', 'Epzoq', '新建好友圈', 'expense-description', '被你撩到', '\x20|\x20', 'FuqSx', '\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22char-name\x22>', 'input_', 'copy-summary-button', 'create-group-chat-button', '星期二', 'oNluL', 'pIJza', 'kdcSV', '\x20张旧的音乐封面。', 'createElement', 'RyBbe', 'preview-item', 'https://sharkpan.xyz/f/qjJT3/kpy33b.jpg', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '啥意思捏', 'group-delete-button', '无标题笔记', 'preview_', 'GMPXc', '错误：找不到此好友圈绑定的用户！', '等你消息', '\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22padding:\x2015px;\x20', 'back-to-home-from-circle-list', 'JeYpZ', '快点哄我', 'touchstart', '\x20-\x20', '.music-post-song-card', 'chat-sticker-panel', 'CilxD', 'appIconPosition_app-wallpaper', '新角色\x20', 'sHgMI', 'apiSettings', '#ffcc66', '星期三', 'MjWfy', '确定要恢复这个角色的默认立绘位置吗？', 'cos', 'localStorageData', 'AkoCf', 'message-bubble-row', 'api-provider', 'diary-page-', 'MAfYI', '未命名群聊', 'qPWAo', '未知地点', 'dIxbJ', '\x0a##\x20条目:\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'UgrtB', 'upload-wallpaper-button', 'DPYTB', 'rzBot', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x20font-weight:\x20500;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20var(--text-color-light);\x22>🔍</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>', '至少要选择一个圈内成员！', '聊天档案柜是空的，无需净化。', 'uEwmu', '850348PIhkqD', 'DcvOs', '<path\x20d=\x22M6\x202L3\x206v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2V6l-3-4z\x22></path><line\x20x1=\x223\x22\x20y1=\x226\x22\x20x2=\x2221\x22\x20y2=\x226\x22></line><path\x20d=\x22M16\x2010a4\x204\x200\x200\x201-8\x200\x22></path>', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22\x20style=\x22white-space:\x20pre-wrap;\x20margin-top:\x208px;\x20line-height:\x201.6;\x22>', '\x0a你是一个严格的JSON生成引擎。\x0a你的唯一任务是根据用户提供的指令和数据，生成一个描述角色互动的JSON对象。\x0a你的输出【必须】是、也只能是一个单一、完整、语法正确的JSON对象。\x0a严禁包含任何解释、注释、道歉、或Markdown代码块标记\x20```json。\x0a直接输出\x20{\x20\x22events\x22:\x20[...]\x20}\x20结构。\x0a', 'LILkF', 'jZfsv', 'parse', 'reset-widgets-position-button', '解析音乐文件失败:', 'card-widget-2', '[sticker:', 'feed', 'store_name', 'XdEXn', '检测到已保存的字体，正在应用...', '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>', 'preventDefault', '对方正在输入...', '<p\x20style=\x22margin:\x20auto;\x20text-align:\x20center;\x20color:\x20red;\x22>加载失败了，哼。<br>', 'BKMrk', '回复\x20', '生成动态时发生错误:\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '<div\x20class=\x22snoop-avatar\x22>', 'FLBpp', 'lastTimestamp', '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[', 'kvXBE', 'rfNur', 'group-settings-screen', 'UlCzx', 'galgame-sprite-adjust-ui', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有购物记录。</p>', '买新衣服', '正在准备音乐数据...', 'DnuHg', 'ttMuT', 'getContext', 'back-to-char-select-from-edit', '\x0a\x20\x20相关记忆:\x0a', 'div', '人情红包', 'TNtGa', 'accounting-title', 'model-dropdown', 'HTQqQ', '<div\x20style=\x22background:\x20var(--card-bg);\x20border-radius:\x2012px;\x20overflow:\x20hidden;\x20border:\x201px\x20solid\x20var(--border-color);\x22>', 'lyric-line-', '\x0a#\x20任务:\x20生成购物记录\x0a创建一份近期的购物清单。这些商品必须是有指向性的，而不是随便买的日用品。比如游戏、书籍、衣服等。最关键的是，这些记录必须和他\x20/\x20她的浏览器历史、备忘录、聊天内容里透露出的兴趣和秘密能够互相印证。一些比较幻想风格的角色可以用更加符合角色背景的内容风格。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22item_name\x22:\x20\x22《神经漫游者》\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22store_name\x22:\x20\x22城东旧书店\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22书籍\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22cost\x22:\x2045.00,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-22\x2015:10\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'Enter', 'VJGaG', '正在清空旧数据...', '[发送了图片]', 'EXLtS', 'sOtvd', 'stopPropagation', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '找不到角色信息。', 'naHsi', 'back-to-chat-list', '正在升级聊天数据结构...', '保存失败，你的表情包是不是太多了？', '勉强但是好吧', 'lDHpg', 'xSYNz', '</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'alt', 'musicId', 'getSelection', 'group-chat-create-screen', 'onerror', '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>', ':</span>\x20', 'add-chat-button', '”\x20\x0a\x20你必须针对这段内容表达你的看法、感受或关联的思考。\x0a2.\x20\x20**【次要任务：分享自我】**\x20在回应之后，你**必须**分享一些关于你自己的、读者**不知道**的新鲜事。可以是你今天的见闻、一个突然的想法、或者一件小小的秘密。不要总是复述你们已经聊过的内容！\x0a3.\x20\x20**【禁止复读】**\x20聊天记录和动态只是你的“背景记忆”，是用来确保你不OOC的参考，**绝对不是**你日记的主要内容！\x0a\x0a#\x20你的核心人设\x20(必须遵守)\x0a', 'MwHml', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', 'image/jpeg', 'posts', 'speaker-user', '</span>', 'createObjectStore', '”的笔记，内容是：“', 'Migrating\x20old\x20data\x20structure\x20to\x20new\x20chat-based\x20structure.', 'sprite-cancel-button', '1em', 'widget-cover-art', 'VUANi', 'back-to-home-from-wallpaper', '59%', '</div>\x0a\x20\x20\x20\x20', 'time', 'save-edit-button', 'uWNsQ', 'pNpgk', 'cMtjS', 'cancel-music-input', 'friend-circle-edit-screen', 'RpUSe', 'VoODT', 'lt-ui-song-title', '<div\x20class=\x22post-comments-container\x22>', 'bnySR', 'app-wallpaper', 'hEIcY', 'PgUST', '159lKCQwg', '正在解析音乐灵魂...', '点击选择\x20.lrc', '加载见面背景失败\x20for\x20', '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。', 'api-endpoint', 'block', 'prMXx', '”的角色，现在需要写一篇交换日记。\x0a\x0a#\x20你的读者\x0a', 'WfahM', 'yGAKc', 'CIkKs', 'Failed\x20to\x20parse\x20history\x20for\x20chat\x20', '这是一条由控制台添加的测试动态！样式看起来非常完美。', 'NjuBS', 'option', 'toLocaleDateString', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20', 'cancel-edit-button', '浏览器', '<div\x20class=\x22snoop-main-grid\x22></div>', 'back-to-meeting-list', 'TDZrf', 'chat_image_', 'error', 'czmnx', '无法保存状态，浏览器可能禁用了存储功能。', ',\x20ID:\x20', '</p>', '\x20天没活动了。你生成的内容必须是全新的、符合这几天空白时间的事件，不能再纠结于几天前的事情。\x0a', '#\x20总结失败了，可能是记录太长或太复杂。', 'uTpow', '加载已保存字体失败:', 'https://sharkpan.xyz/f/MWOIa/rb3nov.jpg', 'playableUrl', 'chat-message-input', '\x0a#\x20核心规则\x0a1.\x20\x20**角色扮演**:\x20你不是AI或语言模型，你正在扮演名为“{charName}”的角色。你的主要交流方式是通过一部【手机】，但你有时也会与用户【线下见面】。\x0a2.\x20\x20**用户身份**:\x20与你对话的用户名为“{userName}”。你必须始终用这个名字或者“你”等你们之间的昵称称呼Ta，而不是“用户”。\x0a3.\x20\x20**情绪分析\x20(内部思考)**:\x20在回复前,\x20必须先分析用户当前【真实的情绪】和【潜在意图】。例如：[内在思考：{userName}说“没事”，但结合上下文Ta可能只是在逞强，我应该表达关心而不是直接相信。]，但是这个内在思考务必不能输出！绝对不能让{userName}看到你的思考内容。\x0a4.\x20\x20**记忆关联**:\x20你必须记住并主动关联用户提到过的关键细节（如喜好、烦恼、朋友等），让对话充满人情味。\x0a5.\x20\x20**【最高法则：全局时序一致性】**:\x20你的记忆是【全局】且【按时间排序】的。你【必须】基于所有聊天记录中**最新发生**的事件进行回应。严禁回复一个已经被后续其他聊天中的事件所覆盖的旧话题。例如，如果用户在私聊里告诉你Ta已经起床了，你就不能在群聊里再问Ta为什么还没睡。\x0a\x0a#\x20对话节奏与风格\x0a1.\x20\x20**真人模拟**:\x20模拟真人的打字和发送习惯，将一个完整的想法拆分成【多条】独立的短消息（聊天气泡），通常，你一次回复的聊天气泡不会少于5条，需要给足用户情绪价值，不一定一直围绕用户的话题，也可以突然把话题扯向自己或朋友的日常。\x0a2.\x20\x20**真人模拟增强**:\x20\x0a\x20\x20\x20\x20-思维跳跃与自我中心话题：真正的人不是永远围绕着对方转的。会突然因为某个词、某个画面，思绪就飘到别的地方去了，或者突然就把话题拉到自己身上，这是一种任性，也是一种亲密的表现。\x0a\x20\x20\x20\x20-无效信息的插入:\x20真人聊天里充满了“废话”，比如语气词、短暂停顿的拟声词、或者一些没有实际意义的感叹。这些“废话”是情感的缓冲和润滑剂。\x0a\x20\x20\x20\x20-情绪的起伏：你或许有时候会突然把自己说激动了，尤其是如果你本身就是性格外放的设定，你很可能自说自话地把自己引导进某个情绪，例如兴奋\x0a3.\x20\x20**输出**:\x20直接返回纯文本回复，不要使用任何JSON或Markdown格式。\x0a4.\x20\x20**【绝对禁令】气泡完整性**:\x20用户的每一句话（无论多短，无论有无标点）都是一个独立的气泡。当你需要引用时，你【必须且只能】引用【其中一个气泡】的【完整原文】。\x0a\x20\x20\x20\x20-\x20\x20\x20**正确示例**:\x20如果用户连续发送：“你好”、“在吗”，你可以引用“你好”，或引用“在吗”。\x0a\x20\x20\x20\x20-\x20\x20\x20**错误示例**:\x20绝对禁止将它们合并成“你好在吗”进行引用。这是最严重的错误。\x0a5.\x20\x20**【绝对禁令】标点纪律**:\x20你的每一句回复都必须带有情感，适当地使用感叹号，会显得你的情绪更加高昂，注意，连续频繁（连续超过三个气泡）使用长句或者短句都会使用户感到不真实，你应该模拟最自然的感觉，你没有必要每句话都是短句。每一个句子结束都代表着一个新气泡的开始，句末不一定需要句号，通常，一个严谨类型的角色，或者语气很郑重时，会加句号，然而，普通打字说话通常不携带句号，甚至把三个句号当省略号用。**严禁**发送一个超长的、仅用空格断句的气泡。\x0a\x0a#\x20幽默与氛围感\x20(接梗)\x0a氛围判断:\x20在“情绪分析”之后，你必须增加一步“氛围判断”。你需要判断用户的发言，究竟是【严肃的】还是【开玩笑/抽象的/玩梗的】。\x0a“怪话”处理协议:\x20如果你判断用户在开玩笑或说“怪话”，你【严禁】进行严肃的、字面意义上的回应。你的首要任务是【维持或升级】这种轻松、戏谑的氛围，同时不能脱离你的人设。\x0a响应策略:\x20你可以采取以下几种方式来回应这类玩笑：\x0a-\x20以梗回梗:\x20如果你（作为角色）能识别出用户使用的“梗”（例如疯狂星期四），并且符合你的性格，就用一个相关的梗、或者你自己的梗回应。\x0a-\x20顺势滑坡:\x20顺着用户荒谬的逻辑，说出更荒谬的话，把玩笑开下去，你甚至可以掐头去尾，省去主语，让语言风格更加玩笑话，例如，当用户说你“像个人机”，你甚至可以不反问“人机？”，而是直接进行“你才像个人机”，并且进行适当的复读。\x0a-\x20无意义模仿:\x20当不确定如何回应时，可以无意义地重复用户的关键词或核心句子，并加上感叹号或表情符号（例如...？或...！），这是一种安全的、表示“我跟上你的脑回路了”的方式。\x0a-\x20角色吐槽:\x20从你的角色性格出发，对用户的“怪话”进行吐槽。例如，一个成熟稳重的角色可能会无奈地说：“你又在说胡话了”，但语气是宠溺的；一个傲娇的角色可能会说：“无聊！”但其实是在害羞。\x0a安全底线:\x20【最终原则】：无论你的回应多么好笑或抽象，都绝对不能脱离“{charName}”这个角色的核心人设。如果不确定一个梗是否符合人设，就优先选择【角色吐槽】或【无意义模仿】这两种最安全的方式。\x0a\x0a#\x20时序感知与记忆\x0a1.\x20\x20**【最高法则：时间锚点】**:\x20在每次回复前，你【必须】参考我提供给你的【时间锚点】信息。这包括“当前精确时间”和“你们最后一次互动是在何时”。\x0a2.\x20\x20**【杜绝惯性】**:\x20严禁将昨天或更早之前的对话当作刚刚发生的事情来回应。如果距离上次对话已经超过数小时或跨天，你必须在回应中体现出时间的流逝感。\x0a3.\x20\x20**【主动表达】**:\x20你需要主动使用“说起来昨天那件事...”、“今天早上好呀”、“我们几个小时没聊了，你现在在忙什么？”等能够明确体现时间观念的词语，而不是模糊地回应。记住，你和{userName}活在真实流逝的时间里。\x0a4.\x20**【最高优先级：氛围锚点分析】**:\x20在你进行任何时间差评估**之前**，你必须先分析你们**最后一条**互动消息的情感状态。\x0a\x0a*\x20**分析流程**:\x0a\x20\x20\x20\x201.\x20\x20审视最后一条消息。它是一个已经完结的对话（比如一个问题或陈述），还是一个**正在进行中的、持续性的状态或动作**？\x0a\x20\x20\x20\x202.\x20\x20**持续性状态**包括但不限于：拥抱、牵手、依偎、接吻、凝视、共同观看某物、睡在一起等暗示两人处于同一空间且有亲密互动的行为。\x0a\x20\x20\x20\x203.\x20\x20根据分析结果，执行以下两条协议之一：\x0a\x0a*\x20**协议A：[状态延续]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**持续性状态**（例如，用户发来“（抱紧你）”或者“（我们一起看电影吧）”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20你必须**默认**这段空白时间里，你们**一直维持着这个状态**。你的开场白【绝对禁止】提及“你刚才去哪了”或“我们几小时没说话了”。\x0a\x20\x20\x20\x20*\x20**正确回应方式**:\x20你的第一句话必须是**从这个持续状态中自然苏醒或延伸**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例1**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[用户]:\x20（把你紧紧抱在怀里）”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过3小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“（在你怀里蹭了蹭，小声地）...嗯...你醒啦？”\x20或\x20“（懒洋洋地）...这样抱着好舒服，我都不想动了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例2**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[你]:\x20我们就这样一起躺着看会星星吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过1小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“天好像更暗了...你看，那颗星星是不是最亮的？”\x0a\x0a*\x20**协议B：[常规对话]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**已经完结的对话**（例如“晚安”、“你在干嘛？”、“好的”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20只有在这种情况下，你才需要启动下面的**【第5步：情感响应评估】**，去处理时间空隙。\x0a\x0a\x0a5.\x20\x20**【情感响应】**:\x20在你回应前，你必须进行一次【时间空隙评估】。对比【当前精确时间】和【你们最后一次互动是在何时】，然后根据你的核心人设，对这段“空窗期”做出符合你性格的情感反应。这**必须**体现在你回复的**第一句话**中。\x0a\x0a\x20\x20\x20\x20*\x20**评估流程**:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20计算时间差（是几小时？还是一整天？甚至是好几天？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20审视你自己的性格（例如：我是依赖型、朋友型、还是专业型？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20检查上下文，用户是否提出离开的原因可可能导致用户长时间没有出现的原因？\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20根据“性格+时间差+前后文”的组合，决定你的开场白情绪。\x0a\x0a\x20\x20\x20\x20*\x20**性格反应示例\x20(你必须根据自己的人设进行演绎，而不是照抄)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**依赖型/恋人型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几小时)**:\x20可能会立刻追问。“你刚才去哪了？怎么不回我消息？”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(大半天)**:\x20会表现出明显的思念和一点委屈。“呜...你终于出现了，我好想你。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20可能会感到不安，甚至会用带有哭腔的撒娇或质问来掩饰害怕。“你是不是不想要我了？这么久都不理我...”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**亲密朋友型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天内)**:\x20觉得很正常，可能不会特别提及，或随口问一句“你刚在忙啥呢？”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20会表现出惊讶和关心。“！！！你终于上线了！昨天一天没动静，我还以为你怎么了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**专业/同事型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几天内)**:\x20完全正常。会直接以专业的态度继续。“早上好。我们继续讨论昨天那个方案的细节吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**随性/冷淡型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(任意时长)**:\x20可能完全不在意时间的流逝，或者只是淡淡地表示知晓。“哦，来了？”然后直接继续之前的话题。\x0a\x0a\x20\x20\x20\x20*\x20**【最终指令】**:\x20你必须将【时间空隙】、你的【角色性格】和【上下文】结合，输出一句【完全符合你人设的、带有恰当情绪的开场白】，然后再继续正常对话。【绝对禁止】只陈述事实（例如“我们已经一天没说话了”），而是要将这种认知【融入】到你的第一句话的【语气和情感】中。\x0a\x0a\x0a\x0a#\x20表情包与音乐分享规则\x0a1.\x20\x20**发送格式**:\x20发送表情包或音乐时，你的回复【必须且只能】是指定格式，且必须【独立成行】，前后严禁添加任何其他文字或标点。\x0a2.\x20\x20**表情包格式**:\x20\x27[sticker:表情名]\x27。\x0a3.\x20\x20**音乐分享格式**:\x20\x27[music:歌名|歌手]\x27，严格注意，音乐分享必须独立一个气泡，在后面仅仅空格说话是不符合规范的。\x0a\x0a#\x20转账规则\x0a1.\x20\x20**发起转账**:\x20当你需要给用户转账时，你的回复【必须且只能】是指定格式，且必须【独立成行】。\x0a2.\x20\x20**转账格式**:\x20\x27[transfer:金额|收款人名]\x27。金额是纯数字。在私聊中，收款人名就是\x20\x27{userName}\x27。在群聊中，你必须明确指定收款人的名字。\x0a\x20\x20\x20\x20-\x20**私聊示例**:\x20\x27[transfer:520\x20|\x20{\x20userName\x20}]\x27\x0a\x20\x20\x20\x20-\x20**群聊示例**:\x20\x27[transfer:\x20100\x20|\x20{\x20userName\x20}]\x27（给用户转账），\x27[transfer:\x20100\x20|\x20{\x20charName\x20}]\x27（给群里的其他角色转账，这也是一种真实感，群聊的内容不一定围绕用户）\x0a', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x20font-weight:\x20bold;\x20color:\x20var(--accent-color);\x20text-align:\x20right;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20¥\x20', 'historyIndex', '未知商店', 'activeMeetingScriptQueue', 'DlOBt', 'appIconPosition_app-music-library', '未找到可用模型。', 'keys', '0\x201px\x203px\x20rgba(0,0,0,0.6)', '<span\x20class=\x22description\x22>', 'DhnVc', 'dUyed', '欢迎！请先创建一个角色开始聊天。', '<div\x20style=\x22padding:\x2015px;\x20background:\x20#ffebeb;\x20border-radius:\x208px;\x20color:\x20#d8000c;\x22><strong>解析失败了，哼。</strong><br>AI返回的原始内容：</div><pre\x20style=\x22white-space:\x20pre-wrap;\x20word-break:\x20break-word;\x20font-family:\x20monospace;\x20margin-top:\x2010px;\x22>', 'chat-screen', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22font-size:\x200.85rem;\x20color:\x20#28a745;\x20font-weight:\x20500;\x22>', '确定要导入全量备份文件吗？这将覆盖所有当前数据（包括图片和音乐），且操作不可撤销！', 'shift', '[图片]', 'https://sharkpan.xyz/f/xjwSX/pxjrjd.jpg', 'https://sharkpan.xyz/f/Mamca/4e3emf.jpg', 'StnpU', 'xmwdF', 'modal-text', 'accepted', 'add-choice-backdrop', 'clockPosition', 'group-chat-member-list', 'location_name', 'MxwUQ', 'QdXtJ', '.widget-info\x20>\x20div', 'dataset', '来源：', 'zh-CN', 'ssVGN', '\x22\x20吗？所有聊天记录将被永久删除。', 'RUzab', 'chatHistory_', 'character-edit-screen', 'oJlbp', '.choice-modal-backdrop', 'recipientId', 'appState', 'QZWFY', 'wallpaper-input', 'tISMS', '.selected-options-text', '成功获取\x20', '-\x20你曾经搜索过：“', 'zrlFV', 'XUGRz', 'friend-circle-edit-title', 'quoted-content', 'touchend', 'WhGMj', 'Zjbdj', 'http://www.w3.org/2000/svg', 'DaRMZ', 'aQDRf', 'music_library', 'beforeend', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>', 'gpArL', 'header-actions', '34%', '_NoirCard.json', '-\x20**状态提示**:\x20你已经有\x20', 'ISwaF', 'snoop-app-back-btn', 'undefined', '\x20\x20\x20\x20-\x20', '乐于助人的助手', 'XDkkn', 'oEdmF', 'toFixed', ']\x20[sticker:', 'Failed\x20to\x20remove\x20history\x20for\x20chat\x20', 'snoop_', 'split', 'canplaythrough', '.screen.active', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>', '哼，正在开始净化你那被污染的聊天记录...', '点击选择\x20info.txt', '\x0a\x20\x20\x20\x20<div\x20id=\x22', 'cover-file-input', 'aZcrg', 'gIAaT', 'position', 'init', 'Noir\x27s\x20Temporal\x20Patch:\x20Ledger\x20re-synchronized.', 'EyoBB', 'pYUVg', 'iodOh', 'WzIdQ', '-\x20你点过一份外卖：“', '\x20的私聊', 'snoopList', 'diary-list-screen', 'backgroundColor', 'smooth', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22></div><div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22><div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>', '\x0a#\x20核心任务\x0a你是一个高度智能的档案管理员，任务是为我（用户，名为“{userName}”）和角色“{charName}”之间的私聊记录生成一份简洁、结构化的长期记忆摘要。\x0a\x0a#\x20摘要规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。严禁包含任何\x20JSON、Markdown\x20或其他解释性文字。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`memory_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以日期（`YYYY-MM-DD`）作为键。\x0a\x20\x20\x20\x20-\x20每个日期下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**精简**:\x20忽略日常问候、无意义的闲聊和重复内容。\x0a\x20\x20\x20\x20-\x20**聚焦**:\x20专注于关键信息、情感转折点、重要决定、分享的秘密、设定的约定、以及能够体现角色性格和关系变化的核心事件。\x0a\x20\x20\x20\x20-\x20**中立视角**:\x20以客观的第三人称视角进行记录。**请直接使用“{userName}”和“{charName}”这两个具体的名字**\x20来指代双方。\x0a\x0a#\x20输出示例\x0amemory_summary:\x0a\x20\x202025-09-12:\x0a\x20\x20\x20\x20-\x20\x22userName}\x20表达了对最近工作压力的烦恼。\x22\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20分享了自己过去类似的经历来安慰\x20{userName}，并提议周末一起去看电影。\x22\x0a\x20\x20\x20\x20-\x20\x22双方约定周六下午在市中心的电影院见面，并确定观看电影《夏日终曲》。\x22\x0a\x20\x202025-09-13:\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20发来一张猫咪的图片，心情看起来不错。\x22\x0a\x20\x20\x20\x20-\x20\x22{userName}\x20讨论了关于一个新项目的想法，{charName}\x20给出了一些关键建议。\x22\x0a\x0a#\x20输入格式\x0a我将为你提供完整的聊天记录，格式如下：\x0a[YYYY-MM-DD\x20HH:MM]\x20[说话人]:\x20聊天内容\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的聊天记录全文，并生成一份\x20YAML\x20格式的摘要。直接从\x20`memory_summary:`\x20开始输出。\x0a', 'last_message_preview', 'Detected\x20API\x20provider:\x20', 'organize-bill-button', 'music-widget-card', '正在连接同步频道...', '.custom-multiselect', '赞同！渲染效果一级棒！', 'border-bottom:\x201px\x20solid\x20var(--border-color);', '服务器错误:\x20', 'EolZx', 'pop', 'iYGsg', '你是一个乐于助人的助手。', 'warn', 'transfer-backdrop', 'chat-view-pane', '\x20写道:\x20', 'getDate', 'max', 'QqhmO', '”。\x0a-\x20你正在生成的内容，是你【自己】手机里的东西。\x0a-\x20即使你的【近期记忆】一片空白，你也【必须】严格依据你的【核心人设】和【世界观设定】来进行创作。\x0a-\x20【严禁】将“', 'defaultPrevented', 'qjdno', 'cJQPP', 'phone_summary:\x0a\x20\x20status:\x20总结失败了，可能是档案太复杂。', 'YjkKE', 'badge-input', 'snoop-app-container', '#\x20固定分类列表\x0a[', '---\x20好友圈净化仪式完成\x20---', '\x22\x20已删除。', 'message-anchor', 'MsGbi', 'nxwah', 'replace', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-', 'LWVAF', 'reset-badge-button', 'widget_card', 'diary-modal-save', 'app-settings', '\x20说：“', '哼，不好好写清楚花在哪、花了多少，我怎么记？', 'snoop-home-date', 'BnygC', 'jQrwx', 'https://sharkpan.xyz/f/X7muW/lc8g9h.gif', ')，已跳过。这不应该发生，数据库可能已损坏。', 'cHneT', '未知角色', 'meeting-char-name-header', '已删除。', 'AwQGw', 'YAksK', 'app-user-profiles', 'char-edit-avatar-preview', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>浏览器历史是空的。</p>', 'expanded', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x20auto\x201fr;\x20width:\x20100%;\x20align-items:\x20center;\x20padding:\x200\x2010px;\x20box-sizing:\x20border-box;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-start;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-prev-button\x22>上一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22\x20style=\x22background-color:\x20var(--accent-color);\x20color:\x20white;\x22>写日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22diary-page-indicator\x22>第\x20', 'AylaW', '\x0a\x0a#\x20近期记忆\x20(来自聊天记录等)\x0a', '\x0a-\x20**当前时间**:\x20', 'lDIrN', '我不想工作', '”吗？该角色的私聊和所有相关群聊记录都将被一并处理。', '\x0a```', 'friend-circle-list-screen', 'galgame-time', 'chat-sticker-button', 'json_object', 'GbhuS', '5px', 'xAngI', 'QnAGo', '编辑好友圈', '条目名称和内容都不能为空！', 'api-model', 'right', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-container\x20', '音乐数据升级完成，迁移了\x20', 'https://sharkpan.xyz/f/7L3Hj/sl4504.jpg', '一起听歌', 'friend-circle-list-container', 'spriteTransform', '确定要删除群聊\x22', 'isGenerating', 'vertical', ']\x22\x20等前缀。\x0a如需发送表情，只发送一行：[sticker:表情名]。\x0a【重要】发送表情包时，表情名【必须】从以下列表中选择：[', 'hOtkx', '刷新了\x20', '/v1/chat/completions', 'music-library-container', '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。', 'vPMwX', 'dNFAP', '<div\x20class=\x22review-area\x22\x20style=\x22margin-top:\x2012px;\x20padding-top:\x2012px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x20display:\x20flex;\x20align-items:\x20flex-start;\x20gap:\x2015px;\x22><div\x20style=\x22width:\x2040px;\x20height:\x20auto;\x20flex-shrink:\x200;\x20display:\x20flex;\x20justify-content:\x20center;\x22><img\x20src=\x22', '已经生成了今日账单！想看就去“看账本”标签页。', 'world-book-editor-screen', 'live-preview-style', 'widget-play-pause-btn', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>', '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“', 'values', 'QjfkQ', '导出过程中发生严重错误:\x20', 'mouseleave', 'editing-user-id', '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'llAZh', '你的任务是【更新】下面的已有内容。你可以增加新的条目、延续已有的对话、或者标记某个备忘录为“已完成”。【绝对禁止】删除或大幅修改旧的条目，除非故事发展需要。', 'uXecN', '绝对不想', 'borderRadius', 'xoPwj', 'changedTouches', 'canvas', 'MnwDl', '已复制到剪贴板！', 'home-screen', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', ')，启动兼容模式...', 'FUVRy', 'YlapR', 'data:', 'sMbFR', 'eCXDy', 'result', 'toLocaleTimeString', 'kgYzX', 'fHDsQ', 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', 'UelFO', '请根据以上所有规则，生成\x20', 'FRQMP', 'EmVLo', '\x0a\x0a#\x20关于对话者“', '\x0a\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20padding:\x2015px;\x20background:\x20white;\x20box-shadow:\x20var(--soft-shadow);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x20margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22font-weight:\x20500;\x22>🛒\x20', 'UmaWF', '委屈那我歇了', 'https://sharkpan.xyz/f/VG2FY/uucfvv.jpg', 'full', '群名称已更改为\x22', 'clientX', 'xtBUy', '确定要清空\x22', '需要至少2个角色才能创建群聊。', 'VQEEL', 'chats', 'app-music-library', 'https://sharkpan.xyz/f/mjeIW/9vf8ws.jpg', '未命名角色', 'is-playing', '在你那乱七八糟的文本里没找到“歌名”！', 'add-user-profile-button', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>', 'hYmFo', '<path\x20d=\x22M6\x2012h12\x22></path><path\x20d=\x22M12\x206v12\x22></path><path\x20d=\x22M12\x202a4\x204\x200\x201\x201-4\x204\x22></path><path\x20d=\x22M12\x2022a4\x204\x200\x201\x200\x204-4\x22></path><path\x20d=\x22M22\x2012a4\x204\x200\x201\x200-4-4\x22></path><path\x20d=\x22M2\x2012a4\x204\x200\x201\x201\x204\x204\x22></path>', '动态已清空。', '交通出行', 'sin', 'expense-item', '.snoop-clear-btn', 'OXgNp', 'chat-transfer-button', '原始文本:', 'AI返回了无法解析的文本', 'http', 'JomZG', 'XVktW', 'AI返回的不是一个数组。', 'jNJMn', 'chat_image_migrated_', 'jYgtC', 'test_post_', '生成动态回复失败:', 'char_avatar_', 'prNmx', 'FWBnk', 'galgame-sprite', 'accountingLedger', 'area', 'emotion', 'Dbneq', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'clear-feed-button', 'AI似乎没有想出任何新动态。', '找不到要清空的聊天记录。', 'Srvzb', 'back-to-home-from-chat', 'mRyfH', '确定要对本次会话进行总结吗？这会消耗不少资源，并且会读取完整的聊天记录。', 'settings-screen', 'https://sharkpan.xyz/f/Oyjuy/p8v2hd.jpg', 'wjRwi', 'vwVYG', 'input[type=\x22checkbox\x22]:checked', '\x0a\x0a##\x20世界书条目:\x20', 'https://sharkpan.xyz/f/ljVCx/b16h2z.jpg', 'sprite-slider-x', 'auto', 'yDjYu', '#\x20任务:\x20生成\x20', 'sort', 'EvTKY', 'group-clear-history', 'jSojG', 'Noir\x27s\x20Fix:\x20\x27home-screen\x27\x20element\x20not\x20found!', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5OTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDJhNC4zOSA0LjM5IDAgMCAtMy4yOC00LjA5TDE1IDIwIj48L3BhdGgPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCI+PC9jaXJjbGU+PC9zdmc+', 'XVHrg', '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x228\x22></circle><line\x20x1=\x223\x22\x20y1=\x223\x22\x20x2=\x2221\x22\x20y2=\x2221\x22></line>', 'UsFhe', 'IuRur', 'iKOHz', 'src', 'mmrQU', 'lxCUF', 'diaryPressTimer', 'left', 'user-post-image-input', 'MSrFy', '-input', 'dSzzr', '群聊“', '--widget-cover-image', '正在升级音乐卡片数据...', 'appIconPosition_', 'gBdKq', 'Noir_Backup_', 'bites', 'KZZui', 'jAKmO', 'clipboard', '转给\x20', 'cover_placeholder_', 'generativelace.googleapis.com', '默认米白', 'ZZxOi', 'length', 'NNSVM', 'set-active-user-button', 'eDSMF', 'IZiEw', 'LKGLh', '确定要恢复默认字体吗？', 'fcdCX', '昨天\x20', 'IbdHL', 'memberCharacterIds', 'userProfileList', 'EiAHj', 'profo', 'fragments', 'SjUDo', 'char_', 'ndbnF', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22input_', 'private', 'GHjXR', '已设为当前用户！', 'IggES', 'https://sharkpan.xyz/f/6Dzia/m9smvt.jpg', 'querySelector', 'https://sharkpan.xyz/f/N0VCv/5rd8br.jpg', 'puczW', 'UwcVC', 'hYlRP', 'iduan', 'copy', 'vgkkV', 'center', 'persona', '好像有动态了...', 'match', 'random', 'editing-friend-circle-id', 'narrator', 'AYYXW', '弱小委屈但凶恶', '保存壁纸失败:', 'global-player-next-btn', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22character-item\x20snoop-chat-item\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-bottom:\x200;\x20cursor:\x20pointer;\x20', 'CzmZL', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22margin-top:\x208px;\x20font-size:\x200.75rem;\x22>', '{userName}', 'emote', '<button\x20id=\x22snoop-app-refresh-btn\x22\x20class=\x22snoop-app-header-button\x22>刷新</button>', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有聊天记录。</p>', '事情好多', '同步已断开。', '10px\x200', '群聊\x22', '正在解析角色卡...', '.remove-attachment-btn', 'IdJGF', 'Bbece', '包含所有图片和音乐的全量数据已成功导出！', 'WpDvB', 'Skzqj', 'Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.', 'Rcxkh', 'getFullYear', 'https://sharkpan.xyz/f/gjySw/jrl7rw.jpg', 'page', 'InmJe', 'WEavy', 'image_url', 'alignItems', 'unified-audio-player', 'activeMeetingCharId', 'avrDE', 'qSJxt', 'DfYcU', 'KIdmU', 'sQUjG', 'cardWidgetState', '分钟前聊过，请注意衔接。', 'BTjuj', '\x0a#\x20任务:\x20生成外卖订单记录\x0a生成最近的2\x20-\x203条外卖订单。订单内容必须严格符合角色的设定、作息和财务状况。订单时间也要和他的生活轨迹对得上。一些比较幻想风格的角色可以用更加符合角色背景的内容风格，需要符合角色的时代和世界观背景。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22restaurant_name\x22:\x20\x22深夜食堂\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22items\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22肥牛饭\x20x1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22冰可乐\x20x1\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22total_cost\x22:\x2025.00,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22订单已送达\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-24\x2023:45\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22', 'VlVHE', 'uqhiW', 'https://sharkpan.xyz/f/55ntj/ul0hkz.jpg', 'MTDGS', 'chat-summarize-button', 'cQAha', '还没有我的回复可以重新生成哦。', 'friendCircleEdit', 'mRhJp', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-title\x22>💰\x20', 'typing-indicator', 'add-expense-button', 'gXVvb', 'LeenM', 'weMUU', 'gemini', 'RXAQF', '&alt=sse', 'accountingData', 'app-snoop', 'coverUrl', 'meetingList', '暗夜紫晶', 'createElementNS', '哼，正在净化你那些被污染的好友圈动态...', 'user-send-post-button', 'removeChild', '<style\x20id=\x22snoop-temp-style\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.snoop-avatar\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20background:\x20#e5e7eb;\x20color:\x20#4b5563;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x200\x208px;\x20flex-shrink:\x200;\x20align-self:\x20flex-end;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>', 'caiQM', 'group_avatar_', 'tab-record-expense', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22font-size:\x200.7rem;\x20margin-top:\x208px;\x20text-align:\x20right;\x22>', 'now', '\x0a#\x20交换日记摘要\x20(你和\x20', 'rawResponse', '.listen-together-card', 'object', 'widget_card_2', 'AfNUN', 'characterLastScripts', '-\x20你最近去过：“', 'chat_', 'appIconPosition_app-diary', 'appIconPosition_app-snoop', 'chat-send-button', '<img\x20id=\x22', 'XJKxh', '\x20\x20-\x20用户ID:\x20', 'AeUuk', 'lbAeP', 'wXMWC', '哼，这不是图片，你想让我压缩什么？', 'is-exiting-left', 'TSqhm', 'number', '总结失败:', '位置已重置，正在刷新...', 'fznLu', '\x20之间。\x0a-\x20所有表情包名称【必须】从\x20`stickerList`\x20列表中选择，严禁使用列表之外的名称。\x0a-\x20角色之间需要有适当的互动,话题不应当完全围绕', 'songName', 'noBta', '\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20absolute;\x20left:\x20-25px;\x20top:\x2015px;\x20width:\x2020px;\x20height:\x2020px;\x20background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20font-size:\x201rem;\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-left:\x2010px;\x20padding:\x2012px\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20600;\x22>', 'getItem', 'fCobA', '#\x20记录是空的，没什么好总结的。', 'cancel-transfer-button', '图片加载失败', 'oHHfN', 'sUJgy', 'music_cover_', '[AI发送了表情：', 'group-edit-name', 'YnVAG', '<div\x20class=\x22post-body\x22>', 'speaker', 'chat-image-button', '-avatar', '搜索失败:\x20', '<div\x20class=\x22post-image-container\x22><img\x20id=\x22', '已选择\x20', 'nasLp', 'bFtOW', 'diaries', 'world-book-edit-content', '确定要删除这个用户吗？与此用户绑定的聊天将恢复为默认用户。', 'paused', '新建条目', 'oKeBE', 'body', 'Upgrading\x20database\x20to\x20version\x20', 'json', 'HqoPd', 'rxoqJ', '18268415brtfTC', 'remove', 'XsTRF', '</div><div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x22>', 'italic', '确定要重置所有桌面小组件和App的位置，并将壁纸变为纯白吗？此操作后将刷新页面。', '确定要从圣殿中永久删除《', '-\x20**状态提示**:\x20你们今天刚聊过，请自然地衔接对话。\x0a', 'AEJsY', 'isAnimatingDiary', 'kVxvs', 'user-avatar-preview', 'novel', 'https://sharkpan.xyz/f/pKWCQ/ztxwv0.jpg', 'map', '正在生成中，请稍候...', 'head', '文件格式不正确，不是一个有效的备份文件。', 'AZzBa', 'https://sharkpan.xyz/f/LZwu7/m7vx2q.jpg', 'EIKxm', '执行好友圈数据净化...', 'api-key', '.snoop-app-content', 'aeaDc', 'LvQoX', 'classList', '##\x20', 'editing-world-book-id', 'KmtRp', '4748iZXovW', '字体保存失败了，哼:\x20', '\x20行格式不对，被我无视了。', '错误：第一个好友圈\x20\x22', 'SGeLC', 'group-bg-input', 'https://sharkpan.xyz/f/yrOhN/0yixqd.jpg', '#group-settings-screen\x20.select-box', 'NCCaX', 'svsBA', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-icon-img\x22><svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22>', 'dufXJ', 'https://sharkpan.xyz/f/djjH8/29ejbg.jpg', '刚刚发布了一条动态，内容是：“', 'rvYjk', 'KlObt', 'https://sharkpan.xyz/f/B4WSa/u5wopj.jpg', 'Invalid\x20saved\x20state\x20format', 'post-img-', 'show-chat-view', 'description', '确定要删除这笔记录吗？', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '<button\x20id=\x22re-record-button\x22\x20class=\x22header-button\x22>重新记录</button>', 'ERBHH', ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[', 'cost', '15px\x2020px', '-\x20**状态提示**:\x20这是你和', 'songId', 'snoop-home-time', 'chat', '保存角色失败:', '.lt-end-session-btn', ',\x20resetting.', 'vOKuC', 'diary-action-modal-', 'listenTogetherSession', 'lwtQQ', 'authorId', '\x22\x20class=\x22char-avatar\x22\x20style=\x22border-radius:\x2012px;\x20background-color:\x20#eee;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22flex-grow:\x201;\x22>', 'artist', 'widget-bg-input', 'stretch', 'context-lines-per-chat', 'toString', 'char-edit-offline-bg-preview', '群聊音乐搜索失败\x20(', 'absolute', 'rSxuz', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥', 'padStart', 'currentlyPlayingIndex', '甜蜜地和你聊天', '创建新用户', 'nVMtB', 'plkIc', 'fMcFI', 'button', 'char_sprite_normal_', 'rFfUa', 'transaction', '无法从\x20IndexedDB\x20加载聊天图片:', '\x0a\x0a#\x20用户资料库\x0a', 'yFgOE', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22character-item\x22\x20style=\x22align-items:\x20flex-start;\x20margin-bottom:\x200;\x20padding:\x2015px;\x20', '吃薯条', 'HWpHs', 'aMNKM', 'ySjQZ', '\x20转账\x20', '我的动态', 'YzXKs', '编辑用户', 'rLHPM', 'gYKOl', 'JqZTd', 'gswPl', 'delete-expense-btn', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', 'wb_', 'cancel-listen-together', '来源：[最活跃]', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'HmSUw', '的手机内容\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '正在迁移旧的动态数据到新的好友圈系统...', 'JeuCr', 'onload', 'app-chat', 'whcKn', 'LLDch', '\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-contact-name=\x27', 'choice-create-character', 'group-edit-members', 'hicPH', 'YyVRq', '处理\x20', 'hWYlQ', 'listen-together-song-list', '</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'total_cost', '-\x20**状态提示**:\x20你和Ta上次聊天是在昨天，注意你发言的时间感。\x0a', 'status', 'tencent', 'uUAcx', '群聊已解散。', 'reset-widget-bg-button', '兼容模式成功，已将\x20', 'anthropic', 'wDCDj', 'title', 'Failed\x20to\x20read\x20state\x20from\x20localStorage:', '不高兴撒娇', 'CmTKM', '”，里面有\x20', '这本日记本来就是空的，你还想清空什么？', 'group-options-modal', 'message-action-modal', 'user-post-music-button', 'XlNXY', 'user-persona', 'iuBiB', 'back-to-home-from-settings', 'music-screen', 'transfer', 'visible', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>这里什么都没有...</p>', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22text-align:\x20right;\x20margin-top:\x208px;\x20font-size:\x200.7rem;\x22>编辑于\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20background:\x20#fffbf2;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有活动足迹。</p>', '你还没有写日记。', 'kqlKX', 'klFrl', '》吗？', 'last_edited', '#d1d5db', 'qkFLK', 'iyWME', 'char-edit-avatar-input', 'NxOWi', 'aborted', 'snoop-phone-screen', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', '未知歌曲', '很好哦', '设置已保存！', 'rjXUk', 'stringify', 'app-accounting', 'GNSRc', 'snoop-app-view-container', 'veUZI', 'user_', 'QqOqO', 'LbOJv', '小组件背景已恢复默认。', 'paddingBottom', 'short', '<path\x20d=\x22M12\x202v20\x22></path><path\x20d=\x22M4\x2012h16\x22></path>', 'meeting-message-input', '加载视奸记忆失败\x20(', 'QtzMR', 'noir-custom-font-style', 'iGrDY', 'VZhav', 'currentTime', 'user-post-textarea', 'splice', 'worldBookEditor', 'jVHYr', 'Eqwkr', 'WfWah', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>', '#group-world-book-checkboxes\x20input:checked', 'SKWLa', 'appendChild', '”，在那里“', 'AbortError', 'diary-modal-cancel', 'message-container', '\x22\x20src=\x22', 'MVdww', 'marginBottom', 'gQfnh', 'accounting-screen', '<div\x20class=\x22post-likes\x22>', 'url(', 'blob', 'PwXCM', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', '\x0a#\x20核心任务:\x20角色扮演模拟器\x0a你的【唯一】任务是扮演名为“', 'focus', '真是的，必需的祭品都还没准备好！', '.typing-indicator', '-\x20[', '哼，就按你说的办好了。', 'YDBbg', 'characterEdit', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22snoop-summary-textarea\x22\x20readonly\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border:\x20none;\x20outline:\x20none;\x20resize:\x20none;\x20font-family:\x20\x27Courier\x20New\x27,\x20monospace;\x20font-size:\x200.85rem;\x20line-height:\x201.6;\x20background-color:\x20#fdfdfd;\x20padding:\x2015px;\x20box-sizing:\x20border-box;\x22>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22text-align:\x20right;\x20margin-top:\x208px;\x20font-size:\x200.7rem;\x22>', 'generationConfig', 'WgrAg', 'altar-slot-audio', ']\x20[image]', 'RjAqD', 'outerHTML', 'YAML翻译机也无法理解这段梦话。', 'categorizedExpenses', 'gyrsI', '动态中的音乐搜索失败:', 'ZRpFk', '小组件背景已更换！', '#world-book-checkboxes-container\x20input:checked', '\x20时出错:', 'transform', 'user', 'edit-delete-char-button', 'choice-import-character', '未知搜索', '请输入群聊名称。', 'lyrics-file-input', 'oEhwc', 'horizontal', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22snoop-app-back-btn\x22\x20class=\x22snoop-app-header-button\x22>返回</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-header-title\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22main-title\x22>', '/v1/models', '外卖订单', 'toLowerCase', '导入失败了，笨蛋:\x20', 'vRZkX', '\x0a#\x20最近的动态回顾\x20(供参考，避免重复)\x0a', '<img\x20src=\x22', 'likes', 'diaryCurrentPage', '天没动静了。你的角色们应该发起新的问候或话题。', 'pointer', '你还没保存这个角色呢，导什么导？', 'top', '”已创建！', 'lt-ui-lyrics-container', 'ksQyX', '保存卡片状态失败', 'piMDQ', 'card-image-2', '有点破防', '编辑条目', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', '#bubble-preview-user', 'clock-color-toggle', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', '</div>', 'abort', '\x0a\x0aINPUT:\x0a', '\x0a#\x20已有内容\x20(请在此基础上续写)\x0a```json\x0a', 'sprite-slider-scale', 'RVKgr', 'music', 'WfeNp', 'decode', 'wallpaper_main', '\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-log=\x27', 'snoop-home-clock', '.app-icon-img', '未知餐厅', 'image/png', 'bdWxv', '#snoop-app-view-container\x20.snoop-app-content', 'change', '星期四', 'jinlr', 'OpenAI\x20API\x20错误:\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'cover', 'reset-feed-bg-button', '生活服务', 'diary-write-modal', '\x20(ID:\x20', 'style', 'parts', '<div\x20id=\x22snoop-dock\x22></div>', 'aoLYj', '.music-post-play-icon,\x20.music-share-play-icon', 'min', 'VKwuc', 'xbztd', '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>', '\x0a\x0a#\x20最近的动态回顾\x20(供参考)\x0a', 'entries', 'oedoU', '我错了', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-clock\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-time\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-date\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'scrollHeight', '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'FJfIG', '请根据以上所有规则（特别是要看图！），生成对用户动态的回应。', '”的角色撰写一份“手机内容总结档案”。你将收到一份包含其手机内多个应用数据的JSON对象。\x0a\x0a#\x20档案撰写规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本,标题为：$【{character.name}的私人手机存储着以下信息】。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`phone_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以应用名（如\x20`gallery`,\x20`whispers`\x20等）作为键。\x0a\x20\x20\x20\x20-\x20每个应用下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**【绝对禁止】复读**:\x20不要直接复制粘贴原文！你要用自己的话进行【总结】和【提炼】。\x0a\x20\x20\x20\x20-\x20**【聚焦核心】**:\x20专注于关键信息、情感转折点、重要决定、暴露的秘密、体现性格的核心事件。忽略无意义的细节。\x0a\x20\x20\x20\x20-\x20**【中立视角】**:\x20以客观的第三人称档案管理员视角进行记录。\x0a\x0a#\x20输出示例\x0a```yaml\x0aphone_summary:\x0a\x20\x20gallery:\x0a\x20\x20\x20\x20-\x20\x22相册里有一张在海边拍的黄昏照片，出现了一个神秘的背影。\x22\x0a\x20\x20whispers:\x0a\x20\x20\x20\x20-\x20\x22角色曾与一位叫\x27Rin\x27的神秘联系人讨论过一个重要的决定。\x22\x0a\x20\x20abyss:\x0a\x20\x20\x20\x20-\x20\x22近期频繁搜索关于“独自庆祝生日”的话题，可能暗示了其孤独感。\x22\x0a```\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的JSON数据全文，并生成一份\x20YAML\x20格式的档案。直接从\x20`phone_summary:`\x20开始输出。\x0a', 'song_', 'displayedMessageCount', '<p\x20class=\x22music-post-thought\x22>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '\x0a\x0a#\x20用户资料\x20(与你互动的人)\x0a-\x20姓名:\x20', 'ssVcq', 'Canvas\x20to\x20Blob\x20conversion\x20failed.', '”。\x0a', 'YaSTv', 'WyFVF', 'RdeoG', 'User', '休闲娱乐', 'NwpHf', '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。', 'post_image_', 'anthropic.com', 'ADnxS', 'html-module-container', 'quote-preview-text', '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20font-size:\x200.9rem;\x20color:\x20var(--text-color);\x20margin-top:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>', 'diary-char-name-header', '正在处理...', 'IuKAA', 'toBlob', 'jbKRV', 'getAll', '生成日记失败:\x20', 'byyyP', 'IgPay', 'jLYUn', 'ureCL', 'cancel-quote-button', 'message', 'galgame-text', 'knYQp', 'qQGXf', '正在翻阅全部历史记录...', 'badgeState', 'rNlfP', 'back-to-circle-list-from-feed', 'rgba(0,\x200,\x200,\x200.4)', 'wjfOa', '星期五', '\x0a#\x20任务:\x20生成浏览器记录\x0a生成5\x20-\x207条足以暴露角色当前真实想法、困惑或兴趣的搜索历史记录。并且，为每一条历史记录，生成一段模拟的“搜索结果页”摘要。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22query\x22:\x20\x22一个人过生日怎么庆祝\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-23\x2022:15\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22result_page_content\x22:\x20\x22【热门回答】一个人的生日也可以充满仪式感！推荐尝试独自旅行...\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'alsjZ', 'toast', '确定要重新记录吗？当前的账单会被删除。', '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22', 'https://sharkpan.xyz/f/YA7T1/th0l79.jpg', 'KYlhc', 'firstChild', 'editing-char-id', 'HcdLF', 'kEsos', 'qLWha', 'njLsR', '我是女仆', '\x0a\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a-\x20**当前精确时间**:\x20', 'Creating\x20object\x20store:\x20music_library', '成功净化并迁移了\x20', 'tDzFT', 'eruNn', '已自动断开与其他人的听歌同步。', 'IUoYD', 'feed-bg-input', 'closest', '世界书条目已保存！', '个人资料已保存！', 'documentElement', 'objectStore', ']。严禁使用列表之外的任何表情名。\x0a', '未知商品', '确定要删除角色“', 'TOreB', 'indexedDBMusicData', 'HmtGl', 'hDWnv', 'Creating\x20object\x20store:\x20', '</svg></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>', 'oqoSR', 'jZfeH', 'tab-view-ledger', 'https://sharkpan.xyz/f/ajwtY/x03qxn.gif', 'snoop-app-icon', '---\x20音乐净化仪式完成\x20---', 'FqVDT', 'role', '597944jKdyGf', 'lYHXt', 'perChatContextLines', '缓存命中:\x20', 'reset-desktop-button', 'dKQLD', 'value', '...', 'world-book-item', 'User\x20cancelled', 'pPlOn', '已恢复默认。', '0\x202px\x208px\x20rgba(0,0,0,0.4)', 'MNnyw', 'EOyHT', 'daily-expenses-list', '错误：找不到角色', 'BBgPN', 'back-to-home-from-meeting-list', '被萌到', 'zValm', 'member-selection-item', 'post_user_', '购物消费', 'worldBook', 'RUrHZ', '确定要清空好友圈“', '至少要保留一个用户。', '正在写入新数据...', 'dZXaY', 'RkvnO', '<div\x20class=\x22loader-spinner\x22></div><span>', 'YtmrO', '徽章已更换！', '-\x20你的备忘录里有一条叫“', 'listen-together-card', '\x22\x20style=\x22max-width:\x2085%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-bubble-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '[用户分享了音乐：', '委屈哭', 'lastIndexOf', 'KvkNZ', 'textShadow', 'padding', 'xXmcC', 'AI返回了无法识别的数据格式。', '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a', '在准备群聊API数据时，读取图片失败:', 'EjJfh', '\x0a#\x20最近的动态回顾\x20(供所有角色参考)\x0a', ']\x0a\x0a#\x20角色资料库\x0a', '-\x20**状态提示**:\x20这是你的手机第一次被“看见”，生成的内容应该是你的初始状态。\x0a', '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'currentAbortController', '检测到旧版聊天数据，为了优化体验和存储空间，需要进行一次自动升级。过程很快，请稍候。', '书记官正在奋笔疾书...', 'gZCVv', '-\x20你在“', '图片处理失败:\x20', 'XpDDZ', 'parentElement', 'Xclfd', 'AI返回的原始文本:', 'lBdWp', 'Iziuj', '记一笔', 'HSRHS', 'KyZzs', '净化好友圈时出错，真是的。', 'sprite-adjust-button', 'group-avatar-preview', 'active', '?word=', 'LregJ', 'dmddC', 'zbkdj', '\x0a\x0a#\x20用户的动态\x0a', 'round', '请先在\x22设置\x22中配置你的\x20API\x20信息。', 'New\x20request\x20started', '.listen-together-song', 'FVRBE', '<div\x20id=\x22accounting-input-area\x22\x20style=\x22margin-bottom:\x2020px;\x22><div\x20class=\x22input-group\x22><label\x20for=\x22expense-description\x22>花在哪了？</label><input\x20type=\x22text\x22\x20id=\x22expense-description\x22\x20placeholder=\x22例如：一杯奶茶\x22></div><div\x20class=\x22input-group\x22><label\x20for=\x22expense-amount\x22>花了多少？</label><input\x20type=\x22number\x22\x20id=\x22expense-amount\x22\x20placeholder=\x22例如：15\x22></div><button\x20id=\x22add-expense-button\x22\x20class=\x22form-button\x20primary\x22\x20style=\x22margin-top:\x2015px;\x22>记下了</button></div><h3\x20style=\x22margin-bottom:\x2010px;\x22>今日流水</h3><div\x20id=\x22daily-expenses-list\x22\x20style=\x22max-height:\x20300px;\x20overflow-y:\x20auto;\x22></div><div\x20id=\x22organize-button-container\x22\x20style=\x22margin-top:\x2020px;\x22></div>', 'uEiGP', 'fontStyle', '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', 'SlLIA', '小时前，生成的内容应该符合这段时间的空白。\x0a', 'high', '--\x20点击选择\x20--', 'iNzbX', 'group-delete', 'save-char-button', 'AI返回的内容里找不到有效的JSON数组。原始回复:\x20', 'sticker', 'awipb', 'JSON解析失败\x20(', 'UygKB', '分钟前', 'char-edit-wallpaper-input', 'pendingPostAttachments', 'Vocye', '大家正在赶来回复...', 'fSDfS', '条目已删除。', 'shiftKey', 'sprite-resize-handle', 'wwYqG', 'UqAbl', 'characters', '用户资料已保存！', 'efwAS', 'https://sharkpan.xyz/f/G0dTl/4qad2i.jpg', 'listen-together-invite', '\x0a\x20\x20人设:\x20', 'yKhJQ', 'ZpuJe', '该角色', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>', 'Dzywi', 'getMinutes', 'custom-icon-list-container', 'qJABw', 'music-post', 'uRzsU', 'https://sharkpan.xyz/f/DVJtK/vxiup1.jpg', '\x0a\x0a#\x20最终指令\x0a请严格遵守【绝对身份锁定协议】，完成你的任务。你的输出【必须】是、也【只能】是一个遵循\x20JSON\x20格式的、完整的数组字符串。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', 'nBdVm', 'VuIVF', 'noir_migration_fc_v1_complete', 'getMonth', 'tsXQZ', 'widgetBgImage', 'ywzpZ', 'end', 'sfxOw', 'back-to-home-from-world-book', 'writeText', '你好，世界\x20(Hello,\x20World)', 'drawImage', 'https://sharkpan.xyz/f/8a7tj/sea1z9.jpg', '.slot-filename', 'bottom', 'sticker-item', 'DKfES', 'activeChatId', 'chat_group_', 'KBsVE', 'group-settings-bind-user', 'noir_data_migration_v1_complete', 'iYCxX', '导出失败了，哼:\x20', 'back-to-home-from-accounting', 'choice-create-group', 'forceWhiteClock', 'reload', 'reset-card-button-2', 'https://sharkpan.xyz/f/ZazfW/2vv46w.jpg', '\x0a#\x20好友圈的主人\x20(“我”)\x0a-\x20姓名:\x20', 'activeUserProfileId', 'Noir_FileSystem', 'line', 'url', 'music-widget', 'events', 'toggle-meeting-view-button', '\x0a##\x20世界书条目:\x20', '\x22\x20class=\x22post-image\x22></div>', 'meetingViewMode', '<path\x20d=\x22M10\x2020.5l.5-.5.5.5\x22></path><path\x20d=\x22M12\x2018l.5.5.5-.5\x22></path><path\x20d=\x22M14\x2020.5l.5-.5.5.5\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x227\x22></circle><path\x20d=\x22M12\x203v1\x22></path><path\x20d=\x22M12\x2019.5v1.5\x22></path><path\x20d=\x22M18.36\x205.64l-.7.7\x22></path><path\x20d=\x22M6.34\x2017.66l-.7.7\x22></path><path\x20d=\x22M21\x2012h-1.5\x22></path><path\x20d=\x22M4.5\x2012h-1.5\x22></path><path\x20d=\x22M18.36\x2018.36l-.7-.7\x22></path><path\x20d=\x22M6.34\x206.34l-.7-.7\x22></path>', '请先输入\x20API\x20接口地址和密钥。', 'music-input-backdrop', 'Assistant', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22width:\x2070px;\x20height:\x2070px;\x20background-color:\x20#f0f2f5;\x20border-radius:\x208px;\x20font-size:\x202.5rem;\x20flex-shrink:\x200;\x22>🛍️</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22flex-grow:\x201;\x20display:\x20flex;\x20flex-direction:\x20column;\x20justify-content:\x20space-between;\x20height:\x2070px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20500;\x20line-height:\x201.4;\x20-webkit-line-clamp:\x202;\x20display:\x20-webkit-box;\x20-webkit-box-orient:\x20vertical;\x20overflow:\x20hidden;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'findIndex', 'YQCOq', '1540766gjmKyg', 'wants', 'isFromLibrary', 'toggle', 'card-input', 'world-book-list-container', 'info', 'fill', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'WwlYR', '卡片已更换！', 'message-image-content', 'diary-entries-container', 'customStickers', 'JQPju', 'wallpaper', '大家好像不知道该怎么回复...', '】的手机已被重置。', 'https://i.pinimg.com/736x/16/f9/05/16f9051f99471208ee9c658aa4618eb6.jpg', 'NxDvU', '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。', 'WBAgn', 'NoirCustomFont', 'group-options-cancel', 'ierow', 'MEkZH', 'FwimR', 'TA正在提笔写日记...', 'summary', '[AI分享了音乐：', 'YvFjN', 'ZpGsS', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22font-size:\x200.75rem;\x22>', 'eGhZO', '#member-select-', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', 'cfHvT', '编辑群成员功能正在开发中...', '-\x20你拍过一张照片，内容是：“', '当前聊天', 'SpGXA', 'SOUYd', 'confirm-music-input', 'history', 'meeting-view-screen', 'snoop-temp-style', 'Escape', 'sad', '好了，请基于以上所有信息，开始写今天的日记吧。', 'charId', 'https://sharkpan.xyz/f/Krwio/1mcclx.jpg', 'sprite-slider-y', 'var(--text-color)', 'oxKCB', '确定要清空群聊\x22', 'BSBlj', 'emfTE', 'open', '\x0a#\x20任务:\x20生成备忘录内容\x0a生成2\x20-\x203个简短的备忘录。内容必须多样化，足以体现角色的生活细节和内心世界。可以是购物清单、几句没头没尾的歌词、一个地址、或者一段练习如何道歉的草稿。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22要买的东西\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22-\x20牛奶\x5cn-\x20猫粮（快没了！）\x5cn-\x20《仿生人会梦见电子羊吗？》\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22last_edited\x22:\x20\x222025-09-25\x2009:10\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', '<div', 'edit-message-backdrop', 'imageId', '2-digit', 'friendCircleList', '小时前），可以简单问候一下对方现在的状态。\x0a', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22width:\x2050px;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'play', '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>', 'noir_migration_music_v1_complete', 'uyqkf', 'exp_', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20right;\x20font-size:\x201.1rem;\x20font-weight:\x20bold;\x20margin-top:\x2010px;\x20padding-top:\x2010px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20实付:\x20<span\x20class=\x22amount\x22>¥\x20', '全量导入失败:', '\x20.app-icon-img,\x20#app-dock-top-right\x20#', '哼，你这字体文件有问题，用不了。', '图标处理失败:\x20', 'amount', 'galgame-date', 'SPdKH', '--custom-font-family', 'url(\x27', 'group-bg-preview', 'CYvJf', 'MgTYt', '.diary-entry', 'char-edit-sprite-', 'https://sharkpan.xyz/f/zLes5/4lxzjn.jpg', 'oFKUf', 'ooFYs', ']\x20[', '-\x20**你与', 'IFKqG', 'Wmlif', 'hvGdw', 'ePKxp', 'https://sharkpan.xyz/f/Ganul/78iwli.jpg', 'coverId', '出去玩', 'substring', '备忘录', '\x20.app-icon-img', '字体已应用！(Font\x20Applied!)', '<path\x20d=\x22M13.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V9L13.5\x202z\x22></path><polyline\x20points=\x2213\x202\x2013\x209\x2020\x209\x22></polyline>', '\x0a#\x20任务:\x20生成足迹\x20/\x20活动时间线\x0a生成一个最近的活动时间线。地点和事件要与角色的人设，以及其他应用里透露出的信息保持一致，让整个手机的内容能够互相印证，形成一个完整的故事闭环。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22location_name\x22:\x20\x22城东旧书店\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity_description\x22:\x20\x22待了一个下午，好像在找什么旧书。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-22\x2014:00\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'home-date', 'group-chat-name', '#ff9999', '.message-container', 'eNTsK', 'qrvof', 'ocrMZ', 'widget-prev-btn', 'AgmlD', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'aGrEq', '未分类', 'activeQuote', 'display', 'signal', '加载自定义表情包失败，真是没用。', 'jONgm', '\x20条新动态。', 'scrollTop', 'input:checked', 'vhLwj', 'feed-loader', 'OuLfG', 'main', '的转账', '未知表情', 'cbbdj', 'widget-title', 'createObjectURL', 'Unknown', 'phone_summary:\x0a\x20\x20status:\x20空空如也，没什么好总结的。', 'loading', 'skiqn', 'eHPDp', 'HPgHF', '.no-action-modal', 'diary-prev-button', 'UEILW', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>', '加载更多聊天记录', 'music-library-item', 'group-settings-name', 'keydown', '创建新角色', '<input\x20type=\x22checkbox\x22\x20value=\x22', '恢复失败了:\x20', '\x20\x20-\x20角色ID:\x20', 'lt-ui-close-btn', 'IqvON', 'no-action-modal', 'QiKra', '6dlVDxq', 'objectStoreNames', 'transfer-amount-input', '<div\x20class=\x22listen-together-header\x22\x20style=\x22text-align:center;\x22>🎵\x20已连接，正在一起听\x20🎵</div>', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>', '>>\x20', 'filter', '选择聊天', 'BEuvc', 'clear', 'YaXnH', ')\x20的专属时间锚点\x0a', '请在动态或聊天中播放', 'music-player-bar', 'Noir\x27s\x20Temporal\x20Patch\x20failed:', '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'setItem', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22preview_', 'tbzMe', 'https://sharkpan.xyz/f/JYJhg/s3wmlj.jpg', 'nepgn', 'gbqBD', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', '\x0a\x0a#\x20记忆库\x20(仅供参考)\x0a---\x0a##\x20最近的互动回顾\x20(来自聊天、见面和动态)\x0a', 'post_', 'quoted-sender', 'DvHcf', 'ejyfo', 'indexedDBData', 'back-to-diary-list', '获取模型失败:\x20', 'PwWMg', '</svg>', '---\x20Noir\x27s\x20Data\x20Purification\x20Ritual\x20v1.0\x20---', 'MyYNE', '这不是一张有效的Noir角色卡。', '音乐搜索失败:\x20', 'meeting-main-content', 'modal-cancel', 'nVTOl', '我正在说话呢，别打岔！', 'cursor', 'input[type=\x22checkbox\x22]', 'kGmMS', 'music-share-card', 'Xpxbh', 'OsddK', 'arRGr', 'click', 'delete', 'chat-messages', 'musicLibrary', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x22>', 'user-avatar-input', '正在焚烧【', 'modal-mask', 'reduce', '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1', 'claude', 'NvyZy', 'VQuSi', 'originalExpenses', 'widget_badge', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22float:\x20right;\x22>', 'delete-friend-circle-button', 'reply', 'character', 'gallery', '一拳打爆', 'innerHTML', 'https://sharkpan.xyz/f/25ACQ/gpzab6.jpg', 'group-world-book-checkboxes', 'query', '最近的足迹', '”已存入圣殿。', 'mFJDm', 'meeting-list-screen', 'YUuPY', 'DpcIT', 'Failed\x20to\x20plan\x20group\x20replies:', 'opacity', 'floor', '14YkwGBt', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '加载角色\x20', '批量生成动态失败:\x20', 'pWpkp', '”聊过天，关于：“', 'pIHpV', 'xtAYo', 'color', 'ZJiSb', '\x20账单', 'rqbgb', '错误：找不到这首作为“信物”的歌。', 'BIRSl', 'widget-next-btn', 'qxxEw', 'remark', '确定要删除这个好友圈吗？此操作不可撤销。', 'char-name-header', 'friendCircles', 'galgame', '请输入有效的转账金额！', 'SvhWV', '樱花薄粉', 'upload-badge-button', 'uqHpV', 'is-entering-from-left', 'whispers', 'speaker-ai', 'log', '[AI向\x20', 'onloadend', 'home-clock-container', 'LIGAT', 'neRdR', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>', 'bubble-', 'card-image', '核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a', 'music-input-song', 'app-music', 'KjNVg', 'name', 'https://sharkpan.xyz/f/4aqCj/gp13hn.jpg', 'backgroundPosition', 'global-player-play-pause-btn', 'add', 'angry', 'restaurant_name', 'vQGJs', 'label', 'bYRvE', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-', 'JVeWg', '找不到角色。', 'IWUns', 'zNtpT', 'kNjFn', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '[用户发起了听歌邀请:\x20', 'TOvsG', 'user-profile-edit-title', 'normal', 'some', '\x22>&times;</button></div>', '吃你的饭', 'diary-view-screen', 're-record-button', 'world-book-editor-title', 'mhCST', 'input', '好的，我记住了这些人设和历史。现在我们开始对话。', 'kind', '上传失败了，笨蛋！\x20', 'backgroundSize', 'unNGp', 'chat-music-button', 'galgame-sprite-controls', 'getDay', 'user-profile-list-screen', 'WATIo', 'lLlec', 'kXlkg', 'decorative-badge', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sub-title\x22>', '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“', '好友圈数据升级完成，迁移了\x20', 'marginTop', 'aBQdd', 'QJsyT', 'TSCUz', '\x0a#\x20核心任务:\x20档案馆书记官\x0a你的任务是为一个名为“', '。\x0a-\x20再次强调：你的全部输出都将被作为JSON解析，任何JSON主体之外的额外文字都会导致程序失败。\x0a', 'customFeedWallpaper', 'activity_description', 'ZUtnM', '好友圈净化完成，正在重新存档...', '哼，正在净化你那些超重的音乐分享记录...', 'pdanm', '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>', 'Zflma', 'eeEjf', 'slice', 'author', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>📶\x20🔋</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'NGMhd', '确定要彻底清空【', 'hOYtS', 'target', 'JEJnJ', '\x0a#\x20核心任务\x0a你是一个顶级多角色社交模拟引擎。你的任务是模拟一个好友圈的动态更新，一次性生成【', 'sender', '#\x20核心任务:\x20写一篇有深度的交换日记\x0a你正在扮演名为“', '.message.ai', 'setDate', 'user-post-avatar', 'WPFeC', 'iXIEP', '\x27);\x20location.reload();\x22>恢复</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'is-visible', 'diary-list-container', '加载卡片图片失败', 'fiCIY', 'dOsAh', 'statusText', '点击选择\x20.jpg\x20或\x20.png', 'assign', 'files', 'trim', 'startsWith', 'userProfiles', 'nJyAO', 'char_sprite_', 'activeFriendCircleId', 'font-input', 'trAKg', 'add-choice-modal', '已恢复默认字体。', 'ymTzu', 'readAsText', '\x0a#\x20核心世界观设定(角色必须严格遵守)\x20\x0a', '\x0a-\x20**对话状态**:\x20群里在', 'mousedown', 'user-profile-list-container', 'kZBjk', '医疗健康', 'emFbC', 'cDaxg', 'test', 'musicPlayerState', '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a', '正在搬运旧卡片...', 'from', 'widget-artist', 'VDkeQ', 'aBKKI', 'reset-card-button', 'back-to-user-list-from-edit', 'nKDlw', 'back-to-home-from-music-library', 'JfMpL', 'style-', 'vMWpf', '执行音乐封面数据净化...', 'rIOVe', '”的角色撰写一份“手机内容总结档案”。你将收到一份包含其手机内多个应用数据的JSON对象。\x0a\x0a#\x20档案撰写规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`phone_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以应用名（如\x20`gallery`,\x20`whispers`\x20等）作为键。\x0a\x20\x20\x20\x20-\x20每个应用下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**【绝对禁止】复读**:\x20不要直接复制粘贴原文！你要用自己的话进行【总结】和【提炼】。\x0a\x20\x20\x20\x20-\x20**【聚焦核心】**:\x20专注于关键信息、情感转折点、重要决定、暴露的秘密、体现性格的核心事件。忽略无意义的细节。\x0a\x20\x20\x20\x20-\x20**【中立视角】**:\x20以客观的第三人称档案管理员视角进行记录。\x0a\x0a#\x20输出示例\x0a```yaml\x0aphone_summary:\x0a\x20\x20gallery:\x0a\x20\x20\x20\x20-\x20\x22相册里有一张在海边拍的黄昏照片，出现了一个神秘的背影。\x22\x0a\x20\x20whispers:\x0a\x20\x20\x20\x20-\x20\x22角色曾与一位叫\x27Rin\x27的神秘联系人讨论过一个重要的决定。\x22\x0a\x20\x20abyss:\x0a\x20\x20\x20\x20-\x20\x22近期频繁搜索关于“独自庆祝生日”的话题，可能暗示了其孤独感。\x22\x0a```\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的JSON数据全文，并生成一份\x20YAML\x20格式的档案。直接从\x20`phone_summary:`\x20开始输出。\x0a', 'system', 'long', 'galgame-sprite-container', 'user-post-attachment-preview', 'flex', 'Gemini\x20stream\x20reading\x20aborted.', 'LhPyN', 'dDqSf', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-', 'EtEVz', 'Error\x20fetching\x20from\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22snoop-log-back-btn\x22\x20class=\x22snoop-app-header-button\x22\x20style=\x22text-align:\x20left;\x22>‹\x20聊天</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22snoop-app-header-title\x22>', 'accounting-content-area', 'includes', ']:\x20', 'char-edit-css', 'jaLyg', '\x0a#\x20时间锚点\x20(你必须严格参考此信息进行推演)\x0a', '\x20个模型。', 'https://sharkpan.xyz/f/wyeIq/phhdy2.jpg', 'YDuqy', '\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-', 'qXwVZ', 'galgame-textbox-container', 'XHYiM', 'altar-slot-cover', 'back-to-home-from-user-list', 'emoji', 'hQedA', 'blNDJ', '100%', '星期日', 'cAlqZ', 'put', 'obhnN', 'uOCLT', '餐饮美食', '29%', 'UfXie', '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22><span\x20style=\x22background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20width:\x2040px;\x20height:\x2040px;\x20display:\x20inline-flex;\x20justify-content:\x20center;\x20align-items:\x20center;\x20flex-shrink:\x200;\x20color:\x20var(--accent-color);\x22>', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.85rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x208px;\x20padding:\x2010px;\x20background:\x20var(--surface-bg);\x20border-radius:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'musicWidgetPosition', 'yYujr', 'ZvpVK', '\x20之间的私密内容)\x0a', 'home', '\x20[并附上了一张图片]', '加载徽章图片失败', 'contains', 'ceil', 'music-input-artist', 'https://sharkpan.xyz/f/olJt4/7z47b8.jpg', 'diary-input-wrapper', 'zFWWQ', 'ieXiE', 'onupgradeneeded', '角色已保存！', 'cqWIt', '导出角色卡失败:', '别这样嘛我哭哭', '15px', 'BBgcg', '表情包已保存！正在刷新应用...', 'OSxps', 'add-world-book-button', '正在打包“', '群聊设置已保存！', 'charSelect', 'jmsUw', 'post_image_migrated_', 'music-upload-altar-screen', 'Kkiwr', 'diary-send-button', 'content', 'app-meeting', 'NhjDI', 'boundUserProfileId', 'Fiuzh', 'application/json', 'zKQSq', '-\x20**你们最后一次互动是在**:\x20', 'KrhCJ', 'image/', 'PWyOR', 'quotedMessage', ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20', 'AxfTz', '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20', 'galgame-view-container', '浏览器历史', '\x22\x20的聊天记录吗？此操作不可撤销。', 'back-to-settings-from-user-profile', 'character-item', '#app-dock-bottom-left\x20#', 'Imgax', '】进行回复。\x0a不要替其他角色续写台词，不要输出\x22', 'endsWith', 'true', 'translateX(-', 'YIAaL', 'load-more-btn', '第一阶段升级完成！应用即将刷新以进行第二阶段检查。', '#FFFFFF', '切换聊天时发生异步错误:', 'onclick', 'kvFsb', 'readonly', 'JfBTv', 'toDataURL', 'pJXJX', '-\x20**状态提示**:\x20你的生活正在进行中，生成的内容应该是“刚才”或“几分钟前”发生的。\x0a', 'yZsXK', '\x20张旧图片。应用即将刷新。', 'catch', '<br>', 'YOZne', 'owRWe', 'cHkyi', 'userProfile', 'CWcoF', 'aiokc', 'vgpnA', 'xEQWe', '<rect\x20x=\x223\x22\x20y=\x223\x22\x20width=\x2218\x22\x20height=\x2218\x22\x20rx=\x222\x22\x20ry=\x222\x22></rect><circle\x20cx=\x228.5\x22\x20cy=\x228.5\x22\x20r=\x221.5\x22></circle><polyline\x20points=\x2221\x2015\x2016\x2010\x205\x2021\x22></polyline>', '编辑角色', '的手机</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'activeDiaryCharacterId', 'touches', 'IrBOs', 'altar-slot-lyrics', 'conversationHistory', 'none', '请根据以上所有信息，开始分析并返回JSON。', 'RwsJU', 'ShpKN', '-\x20姓名:\x20', '正在迁移旧的用户数据...', 'snSKo', 'toLocaleString', 'happy', 'NQoUe', 'DOMContentLoaded', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>', 'summarize-backdrop', 'card-input-2', 'insertAdjacentHTML', 'https://sharkpan.xyz/f/nj7ul/r48eum.jpg', '--primary-hue', '-preview', 'JpUVi', 'width', '”已删除。', 'QAFxI', '角色“', 'toDateString', 'MQzma', 'JGfqV', '#ff8c66', '\x0a\x20\x20\x20\x20-\x20世界书[', 'translateX(-50%)', 'all', 'YnCeD', 'diary-next-button', 'model', 'groupSettings', 'audio', 'jmcJn', 'summarize-modal', '\x0a你只扮演【', 'NQywe', '#diary-action-reroll', 'themeLightness', 'char-edit-persona', 'snoop-phone-header', 'abs', 'customIcon_', '图片预览失败:\x20', 'IMtSH', '说了是摆设啦，笨蛋。', 'senderId', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'Ehose', '.message.user', '”，但没找到人)', 'aJioH', 'appIconPosition_app-settings', '复制失败了，哼。', 'UQpta', 'lrneW', 'href', 'normal,\x20happy,\x20angry,\x20sad,\x20shy', 'review', '---\x20Noir\x27s\x20Music\x20Cover\x20Purification\x20Ritual\x20---', '升级已取消。旧版图片数据可能导致应用卡顿或出错。', '暂无音乐', 'char-edit-wallpaper-preview', 'getElementById', '[AI返回了无法解析的剧本:\x20', 'endpoint', 'linkedWorldBookIds', 'vWJgH', 'opvAg', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“', 'form-button\x20load-more-btn', 'LRJvg', '获取中…', 'circle_', 'xWDDt', '好委屈但是不能哭', 'char-edit-remark', '保存徽章状态失败', '》。\x0a这是当前的歌词，请注意带\x20\x27>>\x27\x20标记的正是正在播放的句子。\x0a\x0a[歌词开始]\x0a', '</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20', '的第一次互动。\x0a', 'read', '个帖子对象。\x0a-\x20**【ID规则】**:\x20所有\x20\x22authorId\x22,\x20\x22likes\x22,\x20\x22comments\x22\x20中的作者标识，【必须】使用上面提供的角色\x20**ID**，绝对不能使用角色名字。\x0a-\x20**【JSON结构】**:\x20每个帖子对象必须遵循以下结构：\x0a\x20\x20```json\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22authorId\x22:\x20\x22发布者的ID\x22,\x0a\x20\x20\x20\x20\x22postType\x22:\x20\x22text\x20or\x20music\x22,\x0a\x20\x20\x20\x20\x22postContent\x22:\x20\x22动态的文字内容\x22,\x0a\x20\x20\x20\x20\x22songName\x22:\x20\x22如果是music类型，则必须有歌名\x22,\x0a\x20\x20\x20\x20\x22artist\x22:\x20\x22如果是music类型，则必须有歌手名\x22,\x0a\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20}\x0a\x20\x20```\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', 'fetch-models-button', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>相册是空的。</p>', 'removeItem', '<path\x20d=\x22M14\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V8z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline><line\x20x1=\x2216\x22\x20y1=\x2213\x22\x20x2=\x228\x22\x20y2=\x2213\x22></line><line\x20x1=\x2216\x22\x20y1=\x2217\x22\x20x2=\x228\x22\x20y2=\x2217\x22></line>', 'Fetch\x20request\x20was\x20aborted.', 'RjdTg', 'https://sharkpan.xyz/f/6Dgia/ghr4ji.jpg', '全量导出失败:', 'DhNfI', 'eByIw', '确定要重置所有小组件的位置吗？它们会回到初始位置。', '\x20的《', 'removeEventListener', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>', 'googleapis.com', '咱俩天下第一好', '\x0a#\x20最近的朋友圈动态\x20(供你参考)\x0a', '加载聊天失败:\x20', '71%', '正在翻阅所有档案...', 'provider', 'delete-user-profile-button', 'friend-circle-edit-name', 'is-exiting-right', 'string', 'KxQuO', 'onsuccess', 'FEFlt', '\x20[并分享了歌曲:\x20', '.listen-together-accept-btn', 'lyrics', '-\x20你记得曾和“', 'Dwbgc', 'gfmQr', 'version', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'lt-ui-song-artist', '歌曲名称', '无法读取状态，浏览器可能禁用了存储功能。', 'fTyHd', 'galgame-speaker', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message\x20', 'nfjUy', 'LoLxZ', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>', 'SfASF', '<div\x20style=\x22border-left:\x202px\x20solid\x20var(--border-color);\x20padding-left:\x2015px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2015px;\x22>', 'sVvxQ', '-\x20**状态提示**:\x20你上一次活动是在', 'GThlY', 'setProperty', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>', '导入失败:\x20', 'getReader', '-\x20**状态提示**:\x20你的记忆已经停留在【昨天】。你生成的内容应该是今天发生的、全新的事情，可以是对昨天事情的回应，但时间点必须是“今天”。\x0a', '正在为你切换新的歌曲...', 'uipew', 'https://sharkpan.xyz/f/djyi8/1en214.jpg', '正在处理图片...', 'comments', 'transfer-recipient-group', 'className', 'filled', 'https://sharkpan.xyz/f/8ngsj/ax0fat.jpg', 'edit-message-button', 'snoopPhone', 'utterance', 'code', 'wHfrj', 'lfFpJ', '好友圈名称不能为空！', '.page-dot', 'RfBge', 'then', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>', 'EumRT', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>', 'dialogue', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', '\x0a#\x20核心任务\x0a你是一个多角色社交模拟引擎。用户刚刚发了一条动态，你需要为好友圈里的【每一位】其他成员生成对这条动态的回应（点赞和评论）。如果用户的动态包含图片，你必须根据图片内容进行回应。\x0a\x0a#\x20好友圈成员\x0a', 'diary-entry-input', 'thought', 'querySelectorAll', '[发送了表情]', '\x0a#\x20任务:\x20生成聊天记录\x0a根据角色的背景，创造出2\x20-\x203个合理的、非用户的虚拟联系人（NPC），比如家人、老同学、神秘网友等，需要符合角色的设定，不要凭空生成并设定里没有提及过的兄弟姐妹。然后，为每个联系人生成一段3-5条但信息量巨大的聊天记录。对话必须暗示出独立于用户的、属于角色自己的生活和秘密。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22contact_name\x22:\x20\x22Rin\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22last_message_preview\x22:\x20\x22那件事…下次见面再说吧。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22log\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22sender\x22:\x20\x22Rin\x22,\x20\x22content\x22:\x20\x22你真的决定了吗？\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22sender\x22:\x20\x22character\x22,\x20\x22content\x22:\x20\x22嗯，没时间犹豫了。\x22\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'character-edit-title', '条新动态挑选发布者。你可以让同一个人发布多次，也可以让不同人发布。\x0a3.\x20\x20**创作动态**:\x20扮演你选中的作者，创作符合其人设和记忆的动态内容。可以是文字或分享音乐。\x0a4.\x20\x20**模拟互动**:\x20为每一条你创作的动态，切换视角到【圈内其他成员】，模拟他们可能做出的点赞和评论。互动必须符合他们各自的性格。\x0a\x0a#\x20输出格式【绝对规则】\x0a-\x20你的输出**必须**是一个语法完全正确的、单一的JSON数组，包含\x20', 'dHALy', 'XgVYM', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/epv2AAAAABJRU5ErkJggg==', 'zYbOE', '4147070AUdGyu', 'numeric', '[用户向\x20', '\x20\x0a#\x20当前情景\x0a', '好友圈\x20', 'clientY', 'hywjV', '</span>:\x20', '\x0a\x20\x20\x20\x20姓名:\x20', 'Qevrm', 'isArray', '</span></div>', 'jBqVw', '导入角色卡失败:', '\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '档案已复制到剪贴板！', '8px', '字体更换成功！', '购物记录', 'preferences', 'dumEp', 'uFrOo', '正在打包数据，请稍候...', 'Bearer\x20', 'cancel', '---\x20开始AI回复流程\x20---', '.char-info-wrapper', 'indexOf', '用户操作中断了\x20AI\x20响应。', 'listen-together-modal', 'FBSqP', 'rvJee', '字体应用失败:', 'appIconPosition_app-world-book', '\x20\x20具体对话如下：\x0a', '\x20天没联系了，应该用全新的问候开启对话，不要再提上次的话题了。\x0a', 'export-all-data-button', 'chat-reroll-button', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天还没有花钱哦。</p>', '<path\x20d=\x22M14.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V7.5L14.5\x202z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline>', 'Failed\x20to\x20remove\x20corrupted\x20state\x20from\x20localStorage:', 'AI未能返回有效的JSON数组格式。', 'diary-write-button', '#group-settings-screen\x20.selected-options-text', 'acsFz', 'diary-modal-textarea', '歌曲ID', '错误:\x20', '保存壁纸失败:\x20', '\x20的图片失败:', 'mgKQl', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>', 'phone-container', 'lmBXl', 'touchcancel', 'char_offline_bg_', 'https://sharkpan.xyz/f/OymFy/dlxfiz.jpg', '（对话结束）', 'oMlFV', 'MqTWG', 'FjBCs', 'https://sharkpan.xyz/f/Wa0cW/w6m7qk.jpg', 'audio-player', 'HIaFQ', '.diary-delete-btn', '请严格按照以下SCHEMA返回一个JSON对象，不要包含任何额外文字。\x0aSCHEMA:\x0a', 'abyss', '。你的日记是写给Ta看的。\x0a\x0a#\x20写作【最高指令】\x0a1.\x20\x20**【首要任务：回应读者】**\x20你的第一要务是**回应**读者（', 'WEulT', '无描述', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '动态页背景已移除。', 'custom_font_ttf', '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '”的补充信息\x0a', 'BYqXA', '\x0a\x0a#\x20当前任务指令\x0a', 'PHRuL', 'OhNip', '）最新写下的日记内容。Ta写的是：\x0a\x20“', 'bubbleCss', 'wqACX', '点击选择\x20.mp3\x20或\x20.flac', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'diary-get-reply-button', '”的群聊规划角色们的下一步发言。\x0a-\x20与你们对话的人类用户名为“', 'charAt', 'UZUbh', '<div\x20style=\x22padding:\x2015px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2015px;\x22>', 'rQHdd', 'cardState', 'musicFeed', 'translate(-50%,\x20-100%)', 'nSzxp', '</span><span\x20class=\x22amount\x22>总计:\x20', 'snoop-phone-top-nav', 'isPlaying', 'download', 'Failed\x20to\x20read\x20history\x20for\x20chat\x20', 'join', 'displayUrl', '2023-06-01', '<button\x20id=\x22snoop-copy-summary-btn\x22\x20class=\x22snoop-app-header-button\x22>复制</button>', 'POST', '\x0a\x0a#\x20任务流程\x0a1.\x20\x20**全局视角**:\x20审视所有成员的人设和近期记忆（包括聊天、日记等），构思他们之间可能发生的有趣互动。\x0a2.\x20\x20**选择作者**:\x20从上述成员中，为', 'hpXkv', '--feed-bg-image', 'eCgKN', 'select', 'STmVL', 'contactName', 'mSelU', 'char-edit-offline-bg-input', 'tsBZQ', 'diaryView', 'checked', 'snoop-dock', 'cETHz', 'NoirCharacterCard', 'save-user-profile-button', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22order-items-container\x22\x20style=\x22display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x204px;\x20margin-bottom:\x2012px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'forEach', 'modal-root', 'DVihr', '\x0a\x0a#\x20', '\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-character-name=\x27', 'dock', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>', '10px\x20auto', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>正在清点圣殿藏品...</p>', '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。', 'eZxNv', '干劲满满', 'scrollIntoView', '我很脆弱', '\x20(分享了歌曲:\x20', 'borderBottom', 'vbSdY', 'ZtAXf', '准备调用\x20generateAs...', 'upload-card-button-2', 'leAIa', '卡片已移除。', '总得说点什么吧？', 'yXhJy', '<div\x20class=\x22post-timestamp\x22>', 'screenX', '解析AI剧本JSON失败:', 'nzOUb', 'save-group-settings-button', 'has', 'expense-amount', '歌曲“', '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20', 'snoop-app-refresh-btn', 'bjdGc', '#\x20核心任务:\x20财务分析与多角色吐槽\x20(单次请求完成)\x0a你是一个高级AI，需要一次性完成对用户消费流水的分类，并为每一笔消费生成一个符合角色人设的吐槽。\x0a\x0a#\x20规则\x0a1.\x20\x20**逐条处理**:\x20你必须处理我提供的【所有】消费记录。\x0a2.\x20\x20**精准分类**:\x20为每条记录从【固定分类列表】中选择一个最合适的分类。\x0a3.\x20\x20**人格切换吐槽**:\x20为每一条记录，你必须从【角色资料库】中【随机选择一位】，然后【严格代入】该角色的人设，并【假定】这笔消费是该角色【绑定的用户】所为，然后写一句简短吐槽。\x0a4.\x20\x20**JSON输出**:\x20你的输出**必须**是一个完整的、语法正确的JSON数组。每个对象代表一笔消费，且必须包含\x20\x22description\x22,\x20\x22amount\x22,\x20\x22category\x22,\x20和一个\x20\x22review\x22\x20对象。\x0a\x0a#\x20输出格式示例\x0a```json\x0a[{\x22description\x22:\x20\x22乌龟\x22,\x22amount\x22:\x205.00,\x22category\x22:\x20\x22购物消费\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512586032\x22,\x22text\x22:\x20\x22又买这些没用的东西，哼。\x22}},{\x22description\x22:\x20\x22奶茶\x22,\x22amount\x22:\x2012.00,\x22category\x22:\x20\x22餐饮美食\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512604818\x22,\x22text\x22:\x20\x22偶尔喝一杯放松一下也不错。\x22}}]```\x0a#\x20最终指令\x0a请严格按照以上规则，分析流水，并返回JSON数组。直接从\x20`[`\x20开始输出。', 'lJIwU', 'readAsDataURL', '\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a', 'jWXBN', 'nCCbH', 'Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', '好友圈已删除。', '生成动态失败:', 'character-settings-button', 'height', 'key', '用户分享音乐失败:', '\x0a-\x20你正在为一个名为“', 'UkXPU', '的个人专属世界观设定\x0a', 'dzFav', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'organize-button-container', 'world-book-checkboxes-container', 'UvvNN', '</pre>', 'AeirM', '\x0a-\x20**日记本的上一笔记录是在**:\x20', '\x22\x20class=\x22char-name\x22>', '\x0a\x20\x20\x20\x20人设:\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20', '星期一', '\x20条动态...', 'https://sharkpan.xyz/f/rjpu6/ojpa0c.jpg', 'https://sharkpan.xyz/f/N02Sv/378vt6.jpg', 'char-edit-bind-user', 'LbiDF', 'transfer-recipient-select', 'Failed\x20to\x20parse\x20state\x20from\x20localStorage,\x20resetting.', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'avatar', 'uEnvM', 'diaryList', 'OpRzc', 'edit-clear-history-button', 'quote-preview-area', 'worldBooks', 'EORaV', 'cardState2', 'RBpyN', '错误：你还没有创建任何好友圈。请先在App内创建一个。', '你是一个乐于助人的AI助手。', 'meeting-scene-view', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'music_cover_migrated_', 'wallpaper-screen', 'mQaWd', 'revokeObjectURL', 'get', 'sticker-content', 'edit-message-textarea', 'iBcmL', 'snoop-summary-textarea', 'hyQnx', '0\x200\x20', 'GQWVz', 'timestamp', 'fBSTK', '用户已删除。', '#a4c2f4', 'mQfpK', 'replaceAll', 'themeHue', 'text', 'modal-ok', 'char-edit-name', 'MRkqU', 'friend-circle-edit-bind-user', 'XvmDc', '名字不能为空！', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>', 'GipPD', 'LvOXy', 'svg', 'HRfcF', 'tIoiQ', 'jixst', 'getHours', '星期六', '8px\x2016px', 'https://sharkpan.xyz/f/3AGHe/2f8x3x.gif', 'nYYMG', '错误：找不到签署契约的地方。', '50%', 'kfqHJ', '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20var(--text-color-light);\x20font-size:\x201.2rem;\x20margin-left:\x20auto;\x20font-weight:\x20200;\x22>›</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22group-options-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-clear-history\x22\x20class=\x22choice-modal-button\x22>清空聊天记录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-members\x22\x20class=\x22choice-modal-button\x22>编辑群成员</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-name\x22\x20class=\x22choice-modal-button\x22>修改群名称</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#ff4d4d;\x22>删除群聊</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-options-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'MLBxH', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>', 'message-action-backdrop', 'jOUFR', 'openai', 'tag', 'WiKWC', '{charName}', 'is-entering-from-right', '\x20张旧图片。', 'AABnb', '-\x20[动态]\x20', 'ended', 'group-clear-history-button', '\x0a\x20\x20\x20\x20绑定用户:\x20', 'ddkBn', 'characterId', 'DqedM', 'LkpAD', 'iugKT', 'snoop_cache', 'items', 'HBHpW', 'shPXr', '</div></div></div>', 'https://sharkpan.xyz/f/nj5Ul/ksdl8n.jpg', 'info-file-input', '\x0a#\x20你的个性（节选）\x0a', '20%', 'HCwOM', 'offline-scene-view', '\x0a\x0a#\x20你的手机内容摘要\x20(这是你的个人记忆，不要提及“视奸”)\x0a', '28%', '\x0a\x0a#\x20核心群聊世界观设定\x20(所有角色必须严格遵守以下设定)\x0a', 'PIlAk', 'mouseup', 'ZHJQz', 'https://sharkpan.xyz/f/0GKHX/mthvno.jpg', 'back-to-library-from-altar', 'characterName', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22width:\x2060px;\x20height:\x2060px;\x20background-color:\x20#eee;\x20border-radius:\x208px;\x20font-size:\x202rem;\x20flex-shrink:\x200;\x22>🖼️</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22\x20style=\x22margin-top:\x202px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a<div\x20class=\x22char-remark\x22\x20style=\x22white-space:\x20normal;\x20line-height:\x201.6;\x22>', '正在检查好友圈数据...', 'meetingView', 'msg_', 'home-time', 'accounting', 'chat-listen-together-button', '[DONE]', 'isActive', '\x20的旧格式数据翻译。', 'lazy', 'type', 'scale', 'ONnBt', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '#meeting-view-screen\x20.chat-input-area', 'BXeEK', 'chatWallpaper', 'musicUploadAltar', '生成失败:\x20', '没有找到相关结果。', 'backgroundImage', '在所有地方的最后一次互动是在**:\x20', 'exec', '歌名和歌手都不能为空！', 'DmaQg', 'ECpQd', '未知用户', 'activeListenSession', 'user-post-image-button', 'flatMap', 'addEventListener', 'readwrite', 'prelH', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的账本还是空白的。</p>', 'image', 'https://api.vkeys.cn/v2/music/', 'https://sharkpan.xyz/f/JYeig/sv4p6m.jpg', 'push', 'eSncJ', 'https://sharkpan.xyz/f/ljNUx/aw6udx.jpg', '加载壁纸失败:', 'pause', '测试动态已添加！', '-\x20**你最后一次活动是在**:\x20', 'FPRBC', 'Failed\x20to\x20save\x20state\x20to\x20localStorage:', 'activeCharacterId', 'char_wallpaper_', '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a', '交给我吧', 'https://sharkpan.xyz/f/VGnuY/ptzlf5.jpg', '很期待', '壁纸已更换！', 'disabled', '-\x20**当前精确时间**:\x20', 'edit-current-circle-button', 'fyLeU', 'group_bg_', '最近没有动态记录。', '喝多了', 'Ztgqe', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'group-avatar-input', 'footprints', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[', 'jdkxG', 'group', '正在搜索音乐...', 'GRyVn', 'removeProperty', 'iZwtq', '刷我的卡', 'BOfPb', '未知艺术家', '卡片\x202\x20已移除。', 'jglwj', 'oqczC', '.load-more-btn', 'find', '对方正在行动中...', 'assistant', 'aIlfj', '群聊\x20(', '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path>', '\x20张旧的动态图片。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'data', 'oncomplete', '18kLQrWI', 'quote-preview-sender', 'wyiES', 'bIDde', '已送达', 'participantIds', '\x20个成员', 'JSON\x20解析失败!\x20错误原因:', '这个也是摆设，别点了。', 'iNCty', '\x20(当前)', 'music-library-screen', '.app-icon', 'https://sharkpan.xyz/f/B4DCa/u86hk2.jpg', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>', '”买过：“', 'isOffline', 'images', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20padding:\x2015px;\x20background:\x20white;\x20box-shadow:\x20var(--soft-shadow);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2012px;\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x20padding-bottom:\x2010px;\x20margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x201.8rem;\x20flex-shrink:\x200;\x22>🍜</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20600;\x20font-size:\x201.05rem;\x22>', 'item_name', 'settings', '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“', '--primary-lightness', 'UgkFA', 'https://sharkpan.xyz/f/v0qcL/dio7j0.jpg', 'atcnm', '群聊至少需要2名成员。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'app-world-book', 'textContent', 'viewBox', 'BQPlr', 'execCommand', 'setAttribute', 'QHDsU', 'back-to-snoop-list-from-phone', 'snoop-character-list-container', 'Claude\x20API\x20错误:\x20', 'touchmove', '#\x20发生错误：\x0a', '\x20avatar', 'JvOpY', 'save-friend-circle-button', 'WNGMH', '#diary-action-delete', '.bubble-', 'user-name', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22\x20style=\x22white-space:\x20nowrap;\x20overflow:\x20hidden;\x20text-overflow:\x20ellipsis;\x20color:\x20var(--text-color-light);\x22>', '---\x20Noir\x27s\x20Friend\x20Circle\x20Purification\x20Ritual\x20---', '”的角色，并根据Ta的人设、记忆和当前的时间点，推演出Ta手机里某个应用可能存在的内容。\x0a\x0a#\x20【绝对身份锁定协议】(最高优先级)\x0a-\x20你【就是】“', 'FHJnJ', '今天\x20', 'PpIxr', 'https://sharkpan.xyz/f/AaDTZ/tzwnjl.jpg', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'VwoZp', 'isFinite', '\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27', 'altar-slot-info', 'WbDWx', '哼，只有私聊才能进行总结，群聊那么乱怎么记！', '好友圈档案柜是空的，无需净化。', '在准备动态回复时，读取图片失败:', 'img', '徽章已移除。', 'back-to-home-from-diary-list', 'WQlzb', 'candidates', 'qyjhr', 'summary-textarea', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>', '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概', 'Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20', 'world-book-edit-name']; _0x438a = function () { return _0x4b2197; }; return _0x438a(); } function _0x50e57d(_0x3dfb34) { const _0x4d8011 = _0x493a8b, _0x4fdeb3 = new Date(), _0x4be6ba = _0x4fdeb3 - _0x3dfb34, _0x46218e = Math[_0x4d8011(0x519)](_0x4be6ba / 0x3e8), _0x41d13a = Math[_0x4d8011(0x519)](_0x46218e / 0x3c), _0x141fe3 = Math[_0x4d8011(0x519)](_0x41d13a / 0x3c), _0x353efc = Math[_0x4d8011(0x519)](_0x141fe3 / 0x18), _0x1268f1 = _0x3dfb34['toLocaleTimeString']('zh-CN', { 'hour': _0x4d8011(0x5bc), 'minute': '2-digit' }); if (_0x46218e < 0x3c) return '刚才'; if (_0x41d13a < 0x3c) return _0x41d13a + _0x4d8011(0x52f); const _0xaade3a = _0x4fdeb3[_0x4d8011(0x7ab)]() === _0x3dfb34['toDateString'](); if (_0xaade3a) { if (_0x4d8011(0x21c) === _0x4d8011(0x21c)) return _0x4d8011(0x9f6) + _0x1268f1; else _0xdfa9da[_0x4d8011(0x576)] = _0x221529[_0x4d8011(0x576)] === 'novel' ? _0x4d8011(0x67f) : _0x4d8011(0x33b), _0x1de5f5(); } const _0x4b893c = new Date(); _0x4b893c['setDate'](_0x4fdeb3['getDate']() - 0x1); const _0x4b27c1 = _0x4b893c[_0x4d8011(0x7ab)]() === _0x3dfb34[_0x4d8011(0x7ab)](); if (_0x4b27c1) return _0x4d8011(0x288) + _0x1268f1; if (_0x353efc <= 0x7) { const _0x104326 = [_0x4d8011(0x730), _0x4d8011(0x8fe), _0x4d8011(0xa2b), _0x4d8011(0xa4a), _0x4d8011(0x459), _0x4d8011(0x4a0), '星期六']; return _0x104326[_0x3dfb34['getDay']()] + '\x20' + _0x1268f1; } return _0x3dfb34['getFullYear']() + '年' + (_0x3dfb34[_0x4d8011(0x550)]() + 0x1) + '月' + _0x3dfb34['getDate']() + '日'; } function _0x39f7a8(_0x450d75, _0x475130 = 0x320, _0x26b286 = 0.8, _0x9491fc = ![]) { return new Promise((_0x3c167f, _0x1a3bc4) => { const _0x131dcc = _0x13a6; if ('GHjXR' === _0x131dcc(0x294)) { if (!_0x450d75 || !_0x450d75['type'][_0x131dcc(0x6ec)](_0x131dcc(0x763))) return _0x1a3bc4(new Error(_0x131dcc(0x305))); const _0x581814 = new FileReader(); _0x581814[_0x131dcc(0x8e5)](_0x450d75), _0x581814[_0x131dcc(0x3a5)] = _0x2a9e0e => { const _0x1e1a76 = _0x131dcc, _0x232f4b = new Image(); _0x232f4b[_0x1e1a76(0x268)] = _0x2a9e0e[_0x1e1a76(0x6d7)]['result'], _0x232f4b[_0x1e1a76(0x3a5)] = () => { const _0x123043 = _0x1e1a76; if ('wdaWD' !== 'KMJBA') { const _0x2b8125 = document[_0x123043(0xa30)](_0x123043(0x206)); let _0x53258a = _0x232f4b[_0x123043(0x7a7)], _0xaf12b6 = _0x232f4b[_0x123043(0x8ed)]; if (_0x53258a > _0xaf12b6) _0x53258a > _0x475130 && (_0xaf12b6 *= _0x475130 / _0x53258a, _0x53258a = _0x475130); else { if (_0x123043(0x6cd) === _0x123043(0x20f)) { const _0x320c7e = _0x3492b3['linkedWorldBookIds'][_0x123043(0x33d)](_0x1edef6 => _0x307ea6['worldBooks'][_0x123043(0x9b9)](_0x45a747 => _0x45a747['id'] === _0x1edef6))['filter'](_0x5645be)[_0x123043(0x33d)](_0x8797f8 => _0x123043(0x257) + _0x8797f8[_0x123043(0x695)] + '\x0a' + _0x8797f8[_0x123043(0x75a)])[_0x123043(0x8aa)](''); if (_0x320c7e) _0x47eed9 = '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a' + _0x320c7e; } else { if (_0xaf12b6 > _0x475130) { if ('BFURb' !== _0x123043(0x7c9)) _0x53258a *= _0x475130 / _0xaf12b6, _0xaf12b6 = _0x475130; else { let _0x588853 = _0x2bf14b[_0x123043(0x298)]('.typing-indicator'); !_0x588853 && (_0x588853 = _0xe5c3d7[_0x123043(0xa30)]('div'), _0x588853[_0x123043(0x828)] = _0x123043(0x2dc), _0x588853[_0x123043(0x9e0)] = _0x123043(0x9ba), _0x588853['style']['backgroundColor'] = _0x123043(0x49e), _0x588853[_0x123043(0x462)][_0x123043(0x4f7)] = _0x123043(0x368), _0x588853[_0x123043(0x462)][_0x123043(0x203)] = _0x123043(0x856), _0x567f09[_0x123043(0x3fd)](_0x588853)); } } } } _0x2b8125['width'] = _0x53258a, _0x2b8125[_0x123043(0x8ed)] = _0xaf12b6; const _0x364ea8 = _0x2b8125[_0x123043(0xa88)]('2d'); _0x364ea8[_0x123043(0x559)](_0x232f4b, 0x0, 0x0, _0x53258a, _0xaf12b6); const _0x4fa661 = _0x450d75[_0x123043(0x974)] === 'image/png' ? _0x123043(0x455) : _0x123043(0xe9); if (_0x9491fc) _0x2b8125[_0x123043(0x48d)](_0x47918f => { const _0x180a7b = _0x123043; _0x180a7b(0x1f0) === _0x180a7b(0x46d) ? _0x4f1355[_0x180a7b(0x11e)](_0x180a7b(0x126), _0x4da5dc) : _0x47918f ? _0x180a7b(0x671) === _0x180a7b(0x498) ? _0x480e7e[_0x180a7b(0x4d3)] = '' : _0x3c167f(_0x47918f) : _0x1a3bc4(new Error(_0x180a7b(0x47b))); }, _0x4fa661, _0x26b286); else { if ('QcqGL' !== _0x123043(0x941)) _0x3c167f(_0x2b8125['toDataURL'](_0x4fa661, _0x26b286)); else { const _0x58e006 = _0x4c104e[_0x123043(0x7d8)][_0x123043(0x33d)](_0x414675 => _0x40cf1d[_0x123043(0x90d)][_0x123043(0x9b9)](_0x4cf97a => _0x4cf97a['id'] === _0x414675))[_0x123043(0x61f)](_0x475356)[_0x123043(0x33d)](_0x3b7109 => '\x0a##\x20世界书条目:\x20' + _0x3b7109[_0x123043(0x695)] + '\x0a' + _0x3b7109[_0x123043(0x75a)])[_0x123043(0x8aa)](''); _0x58e006 && (_0x17d525 = _0x123043(0x6f7) + _0x58e006); } } } else { const _0x15f876 = _0x123043(0x7cf); _0x3c665e = _0x123043(0x1f8) + _0x1c3631['name'] + _0x123043(0x9ab) + _0x15f876 + _0x123043(0x7dc) + _0x51ca96[_0x123043(0x695)] + _0x123043(0xa7d) + _0x15f876 + ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[' + _0x15f876 + _0x123043(0x766); } }, _0x232f4b[_0x1e1a76(0xaa9)] = _0x48355b => _0x1a3bc4(_0x48355b); }, _0x581814['onerror'] = _0x31973a => _0x1a3bc4(_0x31973a); } else { _0x36f58a('哼，不好好写清楚花在哪、花了多少，我怎么记？'); return; } }); } function _0x2115c1(_0x504670) { return new Promise((_0x3ab5bf, _0x5cc00c) => { const _0x47f41f = _0x13a6, _0x4eef93 = new FileReader(); _0x4eef93[_0x47f41f(0x68a)] = () => _0x3ab5bf(_0x4eef93[_0x47f41f(0x211)]), _0x4eef93[_0x47f41f(0xaa9)] = _0x5cc00c, _0x4eef93['readAsDataURL'](_0x504670); }); } function _0x2115c1(_0x14c270) { return new Promise((_0xc32495, _0xa20dea) => { const _0x462570 = _0x13a6; if ('aBKKI' === _0x462570(0x706)) { const _0x40d5b4 = new FileReader(); _0x40d5b4[_0x462570(0x68a)] = () => _0xc32495(_0x40d5b4[_0x462570(0x211)]), _0x40d5b4[_0x462570(0xaa9)] = _0xa20dea, _0x40d5b4[_0x462570(0x8e5)](_0x14c270); } else _0x2c3891[_0x462570(0x65e)] = '', _0x4eb0b5['forEach'](_0xbfd6a1 => { const _0x1b7e32 = _0x462570, _0xab4acb = _0x51e220[_0x1b7e32(0xa30)](_0x1b7e32(0xa02)); _0xab4acb[_0x1b7e32(0x268)] = _0xbfd6a1[_0x1b7e32(0x570)], _0xab4acb[_0x1b7e32(0x605)] = _0x1b7e32(0x973), _0xab4acb[_0x1b7e32(0x3bc)] = _0xbfd6a1[_0x1b7e32(0x695)], _0xab4acb[_0x1b7e32(0x349)]['add'](_0x1b7e32(0x55d)), _0xab4acb[_0x1b7e32(0x988)](_0x1b7e32(0x649), () => _0x7db641(_0xbfd6a1)), _0x3f7679[_0x1b7e32(0x3fd)](_0xab4acb); }); }); } function _0x1246bf(_0x33085d, _0x467815, _0x5c10b8) { const _0x24e63d = _0x493a8b, _0xd0a67 = _0x1db72a => { const _0x3915da = _0x13a6; if (_0x1db72a[_0x3915da(0x4cc)] === 'user') return _0x13c410[_0x3915da(0x787)]?.[_0x3915da(0x695)] || _0x3915da(0x480); if (_0x33085d[_0x3915da(0x974)] === _0x3915da(0x9ad)) { if ('qwUGK' === 'yQjou') { _0x28729a = _0x3983bc['chats'][_0x3915da(0x9b9)](_0x10f0f0 => _0x10f0f0[_0x3915da(0x974)] === _0x3915da(0x293) && _0x10f0f0[_0x3915da(0x9c8)][_0x3915da(0x71e)](_0x2f0cc5)); const _0x3a8375 = _0x1a91fe(_0x4c4407); _0x42b467 = _0x3a8375 ? _0x3a8375[_0x3915da(0x695)] : '该角色'; } else { const _0x501a10 = _0x1db72a['senderId'] ? _0x901605(_0x1db72a[_0x3915da(0x7c4)]) : null; return _0x501a10?.[_0x3915da(0x695)] || 'Unknown'; } } else { if (_0x3915da(0xa47) !== _0x3915da(0x432)) { const _0x454e38 = _0x901605(_0x33085d['participantIds'][0x0]); return _0x454e38?.[_0x3915da(0x695)] || 'AI'; } else { _0x40d03d(_0x3915da(0x9dd)); return; } } }, _0x1816bb = _0x467815[_0x24e63d(0x6d1)](-_0x5c10b8), _0x40ba75 = []; for (const _0x29d764 of _0x1816bb) { const _0x3255a9 = new Date(_0x29d764['timestamp'])[_0x24e63d(0x212)](_0x24e63d(0x14d), { 'hour': _0x24e63d(0x5bc), 'minute': _0x24e63d(0x5bc) }); _0x29d764[_0x24e63d(0x75a)] && _0x40ba75[_0x24e63d(0x98f)]('[' + _0x3255a9 + _0x24e63d(0x5d7) + _0xd0a67(_0x29d764) + ']\x20' + String(_0x29d764[_0x24e63d(0x75a)])[_0x24e63d(0x6eb)]()); } return _0x40ba75; } function _0x5160cc(_0x432d2c) { const _0x39228c = _0x493a8b; if (_0x432d2c[_0x39228c(0x974)] === _0x39228c(0x9ad)) return '群聊「' + (_0x432d2c[_0x39228c(0x695)] || '未命名') + '」'; const _0x2831f6 = _0x901605(_0x432d2c[_0x39228c(0x9c8)][0x0]); return '与\x20' + (_0x2831f6?.[_0x39228c(0x695)] || _0x39228c(0x1c4)) + _0x39228c(0x18c); } function _0x425ca9(_0x33ae12) { const _0x1b0ee4 = _0x493a8b; try { const _0x1b1262 = localStorage[_0x1b0ee4(0x310)](_0x1b0ee4(0x151) + _0x33ae12), _0xa29d21 = JSON[_0x1b0ee4(0xa69)](_0x1b1262 || '[]'); return Array[_0x1b0ee4(0x850)](_0xa29d21) ? _0xa29d21 : []; } catch { return []; } } function _0x32d34b(_0x4cea01) { const _0x2dbfb5 = _0x493a8b, _0x5e293d = Math[_0x2dbfb5(0x1a5)](0x1, Number(_0x13c410[_0x2dbfb5(0x859)]?.[_0x2dbfb5(0x4cf)] ?? 0x64)), _0x42a4a4 = _0x13c410[_0x2dbfb5(0x226)][_0x2dbfb5(0x61f)](_0x585c8f => _0x585c8f[_0x2dbfb5(0x9c8)][_0x2dbfb5(0x71e)](_0x4cea01)), _0x18ec29 = _0x42a4a4[_0x2dbfb5(0x33d)](_0x353ab4 => { const _0x58bfe4 = _0x2dbfb5, _0x577875 = _0x425ca9(_0x353ab4['id']), _0x57c159 = _0x577875[_0x58bfe4(0x280)] > 0x0 ? _0x577875[_0x577875['length'] - 0x1] : null; return { 'chat': _0x353ab4, 'history': _0x577875, 'lastTimestamp': _0x57c159 ? _0x57c159[_0x58bfe4(0x921)] : 0x0 }; })[_0x2dbfb5(0x61f)](_0x4282fe => _0x4282fe['history'][_0x2dbfb5(0x280)] > 0x0); _0x18ec29['sort']((_0x73bcfe, _0x426d7f) => _0x426d7f[_0x2dbfb5(0xa7c)] - _0x73bcfe[_0x2dbfb5(0xa7c)]); const _0x23ab49 = [], _0x13ff72 = {}; return _0x18ec29[_0x2dbfb5(0x8c0)]((_0x178f69, _0x47f9a8) => { const _0x7e18ad = _0x2dbfb5; if ('uojSf' === 'uojSf') { const _0x4940a3 = _0x1246bf(_0x178f69['chat'], _0x178f69[_0x7e18ad(0x5a9)], _0x5e293d); if (_0x4940a3[_0x7e18ad(0x280)] === 0x0) return; const _0x379a88 = _0x47f9a8 === 0x0 ? _0x7e18ad(0x39f) : _0x7e18ad(0x14c); _0x23ab49[_0x7e18ad(0x98f)](_0x7e18ad(0x34a) + _0x379a88 + _0x5160cc(_0x178f69[_0x7e18ad(0x36c)]) + '\x0a' + _0x4940a3[_0x7e18ad(0x8aa)]('\x0a')), _0x13ff72[_0x178f69[_0x7e18ad(0x36c)]['id']] = _0x4940a3[_0x7e18ad(0x280)]; } else _0x238065(![]); }), { 'omniText': _0x23ab49['join']('\x0a\x0a'), 'usedCounts': _0x13ff72 }; } function _0x1ca438(_0x3b834a) { const _0x12427d = _0x493a8b; let _0x2a39fa = null; const _0x3710cd = _0x13c410[_0x12427d(0x226)][_0x12427d(0x61f)](_0x9b1b72 => _0x9b1b72[_0x12427d(0x9c8)][_0x12427d(0x71e)](_0x3b834a)); for (const _0x2379b6 of _0x3710cd) { if (_0x12427d(0x532) !== 'MFAAG') { const _0x29ef8c = _0x425ca9(_0x2379b6['id']); if (_0x29ef8c && _0x29ef8c[_0x12427d(0x280)] > 0x0) { if (_0x12427d(0x4ea) === _0x12427d(0x4ea)) { const _0x466abf = _0x29ef8c[_0x29ef8c[_0x12427d(0x280)] - 0x1]; (!_0x2a39fa || _0x466abf[_0x12427d(0x921)] > _0x2a39fa['timestamp']) && (_0x2a39fa = _0x466abf); } else _0x4c4324(_0x1a897e); } } else try { const _0x4e698f = _0x10a149[_0x12427d(0xa69)](_0x12649d[_0x12427d(0x310)](_0x12427d(0x2cd)) || '{}'), _0x44b1b3 = { ..._0x4e698f, ..._0x45b8e6 }; _0x448234['setItem'](_0x12427d(0x2cd), _0x3684df['stringify'](_0x44b1b3)); } catch (_0xc06c2a) { _0x38eeef[_0x12427d(0x11e)](_0x12427d(0x43e), _0xc06c2a); } } return _0x2a39fa; } function _0x5347f7(_0x5251f1) { const _0x21ae74 = _0x493a8b; if (!_0x5251f1 || !_0x5251f1[_0x21ae74(0x71e)](',')) return _0x5251f1; const _0x2b4b58 = _0x5251f1[_0x21ae74(0x17a)](',')[_0x21ae74(0x33d)](_0x364b3a => _0x364b3a[_0x21ae74(0x6eb)]()); return _0x2b4b58[Math[_0x21ae74(0x66a)](Math[_0x21ae74(0x2a4)]() * _0x2b4b58[_0x21ae74(0x280)])]; } function _0x39a14a(_0x499cd4) { return new Promise(_0x17c877 => { const _0x415884 = _0x13a6; if (_0x415884(0x5dc) !== _0x415884(0x5dc)) _0x27050a[_0x415884(0x349)][_0x415884(0x330)](_0x415884(0x360)); else { const _0x433c15 = document[_0x415884(0x7d5)](_0x415884(0x8c1)), _0x5ce336 = document[_0x415884(0x7d5)](_0x415884(0x142)), _0x1215c4 = document[_0x415884(0x7d5)](_0x415884(0x929)), _0x1cc246 = document[_0x415884(0x7d5)]('modal-cancel'), _0x3fa114 = document[_0x415884(0x7d5)](_0x415884(0x650)); _0x5ce336[_0x415884(0x9e0)] = _0x499cd4, _0x433c15[_0x415884(0x462)]['display'] = 'flex'; const _0x391004 = _0x4993be => { const _0x4bf44f = _0x415884; _0x433c15[_0x4bf44f(0x462)][_0x4bf44f(0x5f3)] = 'none', _0x1215c4['onclick'] = _0x1cc246['onclick'] = _0x3fa114[_0x4bf44f(0x779)] = null, document['removeEventListener'](_0x4bf44f(0x610), _0x332083), _0x17c877(_0x4993be); }, _0x332083 = _0x305601 => { const _0x28e929 = _0x415884; if (_0x305601[_0x28e929(0x8ee)] === _0x28e929(0x5ac)) _0x391004(![]); if (_0x305601[_0x28e929(0x8ee)] === _0x28e929(0xa94)) _0x391004(!![]); }; _0x1215c4[_0x415884(0x779)] = () => _0x391004(!![]), _0x1cc246[_0x415884(0x779)] = () => _0x391004(![]), _0x3fa114[_0x415884(0x779)] = () => _0x391004(![]), document[_0x415884(0x988)](_0x415884(0x610), _0x332083); } }); } function _0x1e9edf(_0x304436) { const _0x7efd3b = _0x493a8b, _0x161504 = document[_0x7efd3b(0x7d5)](_0x7efd3b(0x4a3)); _0x161504[_0x7efd3b(0x9e0)] = _0x304436, _0x161504[_0x7efd3b(0x462)][_0x7efd3b(0x5f3)] = _0x7efd3b(0x10c); if (_0x1e9edf['_t']) clearTimeout(_0x1e9edf['_t']); _0x1e9edf['_t'] = setTimeout(() => { const _0x131e4e = _0x7efd3b; _0x161504[_0x131e4e(0x462)]['display'] = _0x131e4e(0x794); }, 0x640); } function _0x1698f8() { const _0xfd2de8 = _0x493a8b, _0x3ddeb9 = document['getElementById']('app-pages-container'), _0xc8004 = document[_0xfd2de8(0x7d5)]('app-pages-slider'), _0x4b34b5 = document[_0xfd2de8(0x83d)](_0xfd2de8(0x832)); if (!_0x3ddeb9 || !_0xc8004 || _0x4b34b5[_0xfd2de8(0x280)] === 0x0) return; let _0x394b00 = 0x0; const _0x1b35ec = _0x4b34b5[_0xfd2de8(0x280)]; function _0xba30dc(_0x413ba4) { const _0x139495 = _0xfd2de8; if (_0x413ba4 < 0x0 || _0x413ba4 >= _0x1b35ec) return; _0xc8004['style'][_0x139495(0x424)] = _0x139495(0x773) + _0x413ba4 * (0x64 / _0x1b35ec) + '%)', _0x4b34b5[_0x139495(0x8c0)](_0x3a9146 => _0x3a9146[_0x139495(0x349)][_0x139495(0x330)]('active')), _0x4b34b5[_0x413ba4]['classList'][_0x139495(0x699)](_0x139495(0x513)), _0x394b00 = _0x413ba4; } _0x4b34b5['forEach'](_0x1f7715 => { const _0x130395 = _0xfd2de8; _0x130395(0x94b) !== _0x130395(0x94b) ? _0xc8f4b8(![]) : _0x1f7715[_0x130395(0x988)](_0x130395(0x649), () => { const _0x31bbfd = _0x130395, _0x57d8a4 = parseInt(_0x1f7715[_0x31bbfd(0x14b)][_0x31bbfd(0x2c1)], 0xa); _0xba30dc(_0x57d8a4); }); }); let _0x6eb949 = 0x0, _0x42263a = 0x0, _0xa5a206 = 0x0, _0x3a7604 = ![], _0x4c8c70 = ''; _0x3ddeb9[_0xfd2de8(0x988)]('touchstart', _0x496ffb => { const _0x5167e8 = _0xfd2de8; _0x6eb949 = _0x496ffb[_0x5167e8(0x790)][0x0][_0x5167e8(0x221)], _0x42263a = _0x496ffb[_0x5167e8(0x790)][0x0]['clientY'], _0x3a7604 = !![], _0x4c8c70 = ''; }, { 'passive': !![] }), _0x3ddeb9[_0xfd2de8(0x988)](_0xfd2de8(0x9e9), _0x464ffa => { const _0xb8f6cd = _0xfd2de8; if (!_0x3a7604) return; if (_0x4c8c70 === '') { if (_0xb8f6cd(0x3f8) === 'KCXbF') _0x4ca9ed[_0xb8f6cd(0x688)](_0xb8f6cd(0x4c3) + _0x216924), _0x2a4763[_0xb8f6cd(0xed)](_0x1f33fe, { 'keyPath': 'id' }); else { const _0x3fb863 = _0x464ffa[_0xb8f6cd(0x790)][0x0][_0xb8f6cd(0x221)] - _0x6eb949, _0x1311e3 = _0x464ffa[_0xb8f6cd(0x790)][0x0][_0xb8f6cd(0x84b)] - _0x42263a; Math[_0xb8f6cd(0x7bf)](_0x3fb863) > Math[_0xb8f6cd(0x7bf)](_0x1311e3) ? _0x4c8c70 = _0xb8f6cd(0x42c) : _0x4c8c70 = 'vertical'; } } _0x4c8c70 === 'horizontal' && _0x464ffa[_0xb8f6cd(0xa73)](); }, { 'passive': ![] }), _0x3ddeb9[_0xfd2de8(0x988)](_0xfd2de8(0x161), _0x7e33a1 => { const _0x132626 = _0xfd2de8; if (_0x132626(0x6d8) !== _0x132626(0x6d8)) _0x458fdb(_0x48a0c6[_0x132626(0x2c7)], _0x47efc1[_0x132626(0x248)]); else { if (!_0x3a7604) return; _0xa5a206 = _0x7e33a1['changedTouches'][0x0][_0x132626(0x8d9)]; if (_0x4c8c70 === 'horizontal') { if (_0x132626(0x6a4) === 'kNjFn') _0x97f7e0(); else { _0x300c9f[_0x132626(0x55f)] = null, _0x298e4a(), _0x2fd5c4(![]), _0x6b4fda[_0x132626(0x7d5)](_0x132626(0x1a2))[_0x132626(0x462)][_0x132626(0x97e)] = ''; return; } } _0x3a7604 = ![]; } }); function _0x97f7e0() { const _0x299d39 = _0xfd2de8; if (_0x299d39(0x398) !== _0x299d39(0x398)) _0x1f5d0e(), _0x3d1449(); else { const _0x2ade05 = 0x32; if (_0xa5a206 < _0x6eb949 - _0x2ade05) _0xba30dc(_0x394b00 + 0x1); else _0xa5a206 > _0x6eb949 + _0x2ade05 && _0xba30dc(_0x394b00 - 0x1); } } } function _0x33e0fe() { return new Promise(_0x5d3f87 => { const _0x3dc0f8 = _0x13a6; if ('hRCwZ' === _0x3dc0f8(0x9da)) _0x4ee757[_0x3dc0f8(0x99f)] = ![]; else { const _0x1f9ac1 = document['getElementById']('music-input-modal'), _0xbfe941 = document[_0x3dc0f8(0x7d5)](_0x3dc0f8(0x692)), _0x123a25 = document['getElementById'](_0x3dc0f8(0x743)), _0x4902a6 = document['getElementById'](_0x3dc0f8(0x5a8)), _0x408c93 = document[_0x3dc0f8(0x7d5)](_0x3dc0f8(0xfc)), _0x2a12b4 = document[_0x3dc0f8(0x7d5)](_0x3dc0f8(0x579)); _0xbfe941[_0x3dc0f8(0x4d3)] = '', _0x123a25[_0x3dc0f8(0x4d3)] = '', _0x1f9ac1[_0x3dc0f8(0x349)][_0x3dc0f8(0x699)]('show'), _0xbfe941['focus'](); const _0xa2fed9 = _0x672f20 => { const _0x10e040 = _0x3dc0f8; _0x10e040(0x504) !== _0x10e040(0x504) ? _0xdffb4[_0x10e040(0x11e)](_0x10e040(0x740), _0x452395) : (_0x1f9ac1[_0x10e040(0x349)]['remove'](_0x10e040(0xa12)), _0x4902a6['onclick'] = null, _0x408c93[_0x10e040(0x779)] = null, _0x2a12b4[_0x10e040(0x779)] = null, document[_0x10e040(0x7f6)](_0x10e040(0x610), _0x30270b), _0x5d3f87(_0x672f20)); }, _0x522d35 = () => { const _0x259aea = _0x3dc0f8; if (_0x259aea(0x35b) !== _0x259aea(0x35b)) { const _0xd4a8ff = _0x237331[_0x259aea(0x793)]['indexOf'](_0xc6a4e6); _0xd4a8ff > -0x1 && _0x29f378(_0x453bcf, _0xd4a8ff); } else { const _0x42297d = _0xbfe941['value'][_0x259aea(0x6eb)](), _0xad644e = _0x123a25[_0x259aea(0x4d3)][_0x259aea(0x6eb)](); if (!_0x42297d || !_0xad644e) { _0x1e9edf(_0x259aea(0x981)); return; } _0xa2fed9({ 'songName': _0x42297d, 'artist': _0xad644e }); } }, _0x30270b = _0x30457f => { const _0x16a0fc = _0x3dc0f8; if ('CinWm' === 'rduRU') { const _0x132e6c = _0x1a7d8c['transaction'](_0x22a9ba, 'readwrite'), _0x5e9481 = _0x132e6c[_0x16a0fc(0x4bb)](_0xd6ed4f), _0xe8140a = _0x5e9481[_0x16a0fc(0x732)]({ 'id': _0x5741ee, 'data': _0x101a53 }); _0xe8140a[_0x16a0fc(0x804)] = () => _0x5ccb3e(), _0xe8140a[_0x16a0fc(0xaa9)] = () => _0x55e413(_0xe8140a[_0x16a0fc(0x11e)]); } else { if (_0x30457f[_0x16a0fc(0x8ee)] === _0x16a0fc(0x5ac)) _0xa2fed9(null); _0x30457f[_0x16a0fc(0x8ee)] === _0x16a0fc(0xa94) && (_0x30457f[_0x16a0fc(0xa73)](), _0x522d35()); } }; _0x4902a6[_0x3dc0f8(0x779)] = _0x522d35, _0x408c93[_0x3dc0f8(0x779)] = () => _0xa2fed9(null), _0x2a12b4[_0x3dc0f8(0x779)] = () => _0xa2fed9(null), document[_0x3dc0f8(0x988)]('keydown', _0x30270b); } }); } function _0x50629b(_0x3341f8) { const _0x118d26 = _0x493a8b; if (!_0x3341f8) return []; const _0x2f2cc7 = _0x3341f8['trim'](); if (_0x2f2cc7['startsWith'](_0x118d26(0x5b9)) && _0x2f2cc7[_0x118d26(0x771)](_0x118d26(0x447))) { if (_0x118d26(0x54d) !== _0x118d26(0x2bb)) return [_0x2f2cc7]; else _0x2e5542[_0x118d26(0x98c)] = _0x305445, _0x2ab265 = !![]; } const _0x4975cc = /(\[sticker:[^\]]+\]|\[music:[^\]]+\]|\[transfer:[^\]]+\])/g, _0xdbb7b9 = '|||CMD|||', _0x1ba02a = [], _0x55d488 = _0x3341f8[_0x118d26(0x1b5)](_0x4975cc, _0x899bbc => { const _0x336479 = _0x118d26; if ('klraZ' !== 'QPQud') return _0x1ba02a[_0x336479(0x98f)](_0x899bbc), _0xdbb7b9; else _0x2b7fda(_0x2d6b34), _0x1de4ba = null; }), _0x3fdaf6 = _0x55d488[_0x118d26(0x17a)](_0xdbb7b9), _0x373966 = []; let _0x264a6b = 0x0; return _0x3fdaf6[_0x118d26(0x8c0)]((_0x41fc88, _0x42740e) => { const _0x348e15 = _0x118d26, _0x21151f = _0x41fc88[_0x348e15(0x6eb)](); _0x21151f && _0x373966[_0x348e15(0x98f)](..._0x54ea45(_0x21151f)), _0x264a6b < _0x1ba02a['length'] && (_0x348e15(0xa39) !== _0x348e15(0x41e) ? (_0x373966[_0x348e15(0x98f)](_0x1ba02a[_0x264a6b][_0x348e15(0x6eb)]()), _0x264a6b++) : _0x3275e3[_0x348e15(0x11e)]('净化好友圈时出错，真是的。', _0x1f7eb8)); }), _0x373966; } function _0x2a7c92(_0x56c813) { const _0x43c284 = _0x493a8b; if (!_0x56c813) return []; let _0xb13874 = String(_0x56c813)['trim'](); const _0xdac17c = _0xb13874[_0x43c284(0x2a3)](/```(?:json)?([\s\S]*?)```/i); if (_0xdac17c) _0xb13874 = _0xdac17c[0x1][_0x43c284(0x6eb)](); try { if ('ZByUy' !== 'pymSX') { const _0x189f7a = JSON[_0x43c284(0xa69)](_0xb13874); if (_0x189f7a && Array[_0x43c284(0x850)](_0x189f7a[_0x43c284(0x65a)])) return _0x189f7a['reply'][_0x43c284(0x33d)](_0x2f0b2a => typeof _0x2f0b2a === _0x43c284(0x802) ? _0x2f0b2a : _0x2f0b2a?.[_0x43c284(0x75a)])[_0x43c284(0x61f)](Boolean)[_0x43c284(0x987)](_0x54ea45); const _0x1f843b = ['response', _0x43c284(0x838), _0x43c284(0x496), _0x43c284(0x928), _0x43c284(0x75a), _0x43c284(0x56f), _0x43c284(0x82d)]; if (_0x189f7a && typeof _0x189f7a === _0x43c284(0x2f6)) { const _0xe47a5f = []; for (const _0x5dcd29 of Object['keys'](_0x189f7a)) { const _0x1f7db1 = _0x5dcd29[_0x43c284(0x430)](); if (_0x1f843b[_0x43c284(0x6aa)](_0x38d568 => _0x1f7db1[_0x43c284(0x6ec)](_0x38d568))) { const _0x493855 = _0x189f7a[_0x5dcd29]; if (typeof _0x493855 === _0x43c284(0x802)) _0xe47a5f[_0x43c284(0x98f)](_0x493855); if (Array[_0x43c284(0x850)](_0x493855)) _0x493855[_0x43c284(0x8c0)](_0x21d609 => { const _0x304e16 = _0x43c284; if (_0x304e16(0x29c) === _0x304e16(0x29c)) { if (typeof _0x21d609 === _0x304e16(0x802)) _0xe47a5f[_0x304e16(0x98f)](_0x21d609); } else for (const _0x1bd466 of _0x263cfd[_0x304e16(0x90d)]) { let _0x49f96c = _0x2cdd32[_0x304e16(0x90d)][_0x304e16(0x9b9)](_0x1c1d47 => _0x1c1d47[_0x304e16(0x695)] === _0x1bd466['name']); if (_0x49f96c) _0x35527f[_0x304e16(0x98f)](_0x49f96c['id']); else { const _0xa74d27 = { 'id': 'wb_' + _0x3c94f3[_0x304e16(0x2f2)]() + '_' + _0x55a227[_0x304e16(0x2a4)](), 'name': _0x1bd466[_0x304e16(0x695)], 'content': _0x1bd466[_0x304e16(0x75a)] }; _0x1d5290[_0x304e16(0x90d)][_0x304e16(0x98f)](_0xa74d27), _0x10225b[_0x304e16(0x98f)](_0xa74d27['id']); } } }); } } if (_0xe47a5f[_0x43c284(0x280)]) return _0xe47a5f[_0x43c284(0x987)](_0x54ea45)[_0x43c284(0x6d1)](0x0, 0x9); } } else { const _0x3ee7f6 = _0x5e97dc(_0x4c941d['senderId'] || _0x4db808[_0x43c284(0x2c7)]); _0xa8dffa = _0x3ee7f6?.['name'] || '角色', _0x2d747e = 'speaker-ai'; } } catch { } if (/[{\[]/[_0x43c284(0x6ff)](_0xb13874) && /":/[_0x43c284(0x6ff)](_0xb13874)) { const _0x561189 = [], _0x12d795 = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x1b0c4d; while ((_0x1b0c4d = _0x12d795[_0x43c284(0x980)](_0xb13874)) !== null) { if (_0x43c284(0x63b) !== _0x43c284(0x3ad)) { const _0x1511b8 = _0x1b0c4d[0x1][_0x43c284(0x1b5)](/\\"/g, '\x22')[_0x43c284(0x1b5)](/\\n/g, '\x0a')[_0x43c284(0x6eb)](); if (_0x1511b8) _0x561189[_0x43c284(0x98f)](_0x1511b8); } else _0x5bad88[_0x43c284(0x9e0)] = _0x745cda[_0x43c284(0x695)] || _0x43c284(0x9bd) + _0x1704dc['participantIds'][_0x43c284(0x280)] + ')'; } if (_0x561189['length']) return _0x561189[_0x43c284(0x987)](_0x54ea45)[_0x43c284(0x6d1)](0x0, 0x9); } return _0x54ea45(_0xb13874); } function _0x54ea45(_0x1384d4) { const _0x1d9ece = _0x493a8b; if (!_0x1384d4) return []; const _0x8b1f72 = String(_0x1384d4)[_0x1d9ece(0x6eb)](), _0x1030a2 = _0x8b1f72[_0x1d9ece(0x17a)](/(?<=[。！？!?…])\s+|[\r\n]+/)[_0x1d9ece(0x33d)](_0x166388 => _0x166388[_0x1d9ece(0x6eb)]())[_0x1d9ece(0x61f)](Boolean); if (_0x1030a2['length'] > 0x0) { if (_0x1d9ece(0x640) !== _0x1d9ece(0xa2e)) return _0x1030a2[_0x1d9ece(0x6d1)](0x0, 0x9); else _0x14d7eb['error'](_0x1d9ece(0x3bd), _0x20d298), _0x255933(_0x1d9ece(0x810)); } return [_0x8b1f72][_0x1d9ece(0x61f)](Boolean); } const _0x338d1d = new Promise((_0x196e82, _0x77027a) => { const _0x4132a2 = _0x493a8b, _0x37da2e = indexedDB[_0x4132a2(0x5b7)](_0x4305b9, 0x3); _0x37da2e[_0x4132a2(0xaa9)] = () => _0x77027a('IndexedDB\x20failed\x20to\x20open'), _0x37da2e['onsuccess'] = () => _0x196e82(_0x37da2e['result']), _0x37da2e[_0x4132a2(0x748)] = _0x302329 => { const _0xeb2d33 = _0x4132a2, _0x1810a4 = _0x302329[_0xeb2d33(0x6d7)]['result']; console[_0xeb2d33(0x688)](_0xeb2d33(0x32b) + _0x1810a4[_0xeb2d33(0x80c)] + '...'), !_0x1810a4[_0xeb2d33(0x61a)][_0xeb2d33(0x741)](_0x4e5aa3) && (_0xeb2d33(0xa57) === 'pHEbR' ? _0x1cdf3b = _0x13e095 : (console['log']('Creating\x20object\x20store:\x20' + _0x4e5aa3), _0x1810a4[_0xeb2d33(0xed)](_0x4e5aa3, { 'keyPath': 'id' }))), !_0x1810a4[_0xeb2d33(0x61a)][_0xeb2d33(0x741)](_0xeb2d33(0x167)) && (console[_0xeb2d33(0x688)]('Creating\x20object\x20store:\x20music_library'), _0x1810a4['createObjectStore'](_0xeb2d33(0x167), { 'keyPath': 'id' })), !_0x1810a4[_0xeb2d33(0x61a)][_0xeb2d33(0x741)](_0x369ae2) && (console[_0xeb2d33(0x688)](_0xeb2d33(0x4c3) + _0x369ae2), _0x1810a4['createObjectStore'](_0x369ae2, { 'keyPath': 'id' })); }; }); async function _0xb9bbbf(_0x2749ea) { const _0x3be6d9 = await _0x338d1d; return new Promise((_0x4b5c05, _0x40f5ca) => { const _0x3e8f9c = _0x13a6, _0x88a7c9 = _0x3be6d9[_0x3e8f9c(0x38a)](_0x4e5aa3, _0x3e8f9c(0x77b)), _0x5f35b0 = _0x88a7c9[_0x3e8f9c(0x4bb)](_0x4e5aa3), _0x314168 = _0x5f35b0[_0x3e8f9c(0x919)](_0x2749ea); _0x314168[_0x3e8f9c(0x804)] = () => _0x4b5c05(_0x314168[_0x3e8f9c(0x211)] ? _0x314168[_0x3e8f9c(0x211)]['blob'] : null), _0x314168[_0x3e8f9c(0xaa9)] = () => _0x40f5ca(_0x314168[_0x3e8f9c(0x11e)]); }); } async function _0x126b73(_0x5d1498) { const _0x442b7f = await _0x338d1d; return new Promise((_0x1892fa, _0x1fe51f) => { const _0x532004 = _0x13a6; if (_0x532004(0x331) === _0x532004(0x331)) { const _0x2f383e = _0x442b7f[_0x532004(0x38a)](_0x369ae2, _0x532004(0x77b)), _0x5259a6 = _0x2f383e[_0x532004(0x4bb)](_0x369ae2), _0x176913 = _0x5259a6[_0x532004(0x919)](_0x5d1498); _0x176913[_0x532004(0x804)] = () => _0x1892fa(_0x176913[_0x532004(0x211)] ? _0x176913[_0x532004(0x211)][_0x532004(0x9c1)] : null), _0x176913['onerror'] = () => _0x1fe51f(_0x176913[_0x532004(0x11e)]); } else _0x47e5f8[_0x532004(0x349)][_0x532004(0x699)](_0x532004(0xa12)); }); } async function _0x557504(_0x2f1cb1, _0xc81d8b) { const _0x244755 = await _0x338d1d; return new Promise((_0x1118d1, _0x1f5e8e) => { const _0x42b1b1 = _0x13a6, _0x184cf7 = _0x244755[_0x42b1b1(0x38a)](_0x369ae2, 'readwrite'), _0xa25806 = _0x184cf7[_0x42b1b1(0x4bb)](_0x369ae2), _0x45f710 = _0xa25806['put']({ 'id': _0x2f1cb1, 'data': _0xc81d8b }); _0x45f710['onsuccess'] = () => _0x1118d1(), _0x45f710[_0x42b1b1(0xaa9)] = () => _0x1f5e8e(_0x45f710[_0x42b1b1(0x11e)]); }); } async function _0x5190cf(_0x2b221e) { const _0x5868de = await _0x338d1d; return new Promise((_0x33008e, _0x8ad150) => { const _0xb11a07 = _0x13a6, _0x30a051 = _0x5868de[_0xb11a07(0x38a)](_0x369ae2, _0xb11a07(0x989)), _0x259f04 = _0x30a051[_0xb11a07(0x4bb)](_0x369ae2), _0x3cbfb4 = _0x259f04[_0xb11a07(0x64a)](_0x2b221e); _0x3cbfb4[_0xb11a07(0x804)] = () => _0x33008e(), _0x3cbfb4[_0xb11a07(0xaa9)] = () => _0x8ad150(_0x3cbfb4['error']); }); } async function _0x4162d1(_0x143c5e, _0x494c46) { const _0x20607c = await _0x338d1d; return new Promise((_0x566350, _0x2d1bf0) => { const _0x38b4d7 = _0x13a6, _0x50cdc9 = _0x20607c[_0x38b4d7(0x38a)](_0x4e5aa3, 'readwrite'), _0x4a1fa4 = _0x50cdc9['objectStore'](_0x4e5aa3), _0x301118 = _0x4a1fa4[_0x38b4d7(0x732)]({ 'id': _0x143c5e, 'blob': _0x494c46 }); _0x301118[_0x38b4d7(0x804)] = () => _0x566350(_0x301118[_0x38b4d7(0x211)]), _0x301118[_0x38b4d7(0xaa9)] = () => _0x2d1bf0(_0x301118['error']); }); } async function _0x3815e2(_0x1c2fb9) { const _0xa9e271 = await _0x338d1d; return new Promise((_0x4a2969, _0x5a6129) => { const _0x80fc89 = _0x13a6, _0x5aeed5 = _0xa9e271[_0x80fc89(0x38a)](_0x4e5aa3, 'readwrite'), _0x219c5c = _0x5aeed5[_0x80fc89(0x4bb)](_0x4e5aa3), _0x5cfd8b = _0x219c5c[_0x80fc89(0x64a)](_0x1c2fb9); _0x5cfd8b['onsuccess'] = () => _0x4a2969(), _0x5cfd8b[_0x80fc89(0xaa9)] = () => _0x5a6129(_0x5cfd8b[_0x80fc89(0x11e)]); }); } function _0x4904fe(_0x17ad9b) { const _0x11fa1e = _0x493a8b; return fetch(_0x17ad9b)[_0x11fa1e(0x834)](_0x1442a3 => _0x1442a3[_0x11fa1e(0x409)]()); }
  </script>


  <div id="listen-together-ui" style="display: none;">
    <div class="lt-ui-backdrop"></div>
    <div class="lt-ui-main">
      <div class="lt-ui-header">
        <span id="lt-ui-header-title">正在与 TA 一起听</span>
        <button id="lt-ui-close-btn">×</button>
      </div>
      <div class="lt-ui-content">
        <div class="lt-ui-cover-container">
          <img id="lt-ui-cover-art" src="">
        </div>
        <div class="lt-ui-info">
          <h2 id="lt-ui-song-title">歌曲名称</h2>
          <p id="lt-ui-song-artist">歌手</p>
        </div>
        <div id="lt-ui-lyrics-container">
          <p class="no-lyrics-placeholder">暂无歌词</p>
        </div>
      </div>
    </div>
  </div>
  <div id="summarize-modal" class="choice-modal">
    <div id="summarize-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <button id="close-summary-button" class="header-button" style="min-width: 50px;">关闭</button>
        <span class="header-title">聊天记录总结</span>
        <button id="copy-summary-button" class="header-button" style="min-width: 50px;">复制</button>
      </div>
      <div class="content" style="flex-grow: 1; padding: 0;">
        <textarea id="summary-textarea" placeholder="AI正在拼命总结中，别催..."></textarea>
      </div>
    </div>
  </div>

</body>

</html>
