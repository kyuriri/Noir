<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

  <title>Noir搓的小手机</title>
  <style>
    .message p,
    .diary-content {
      user-select: none;
      -webkit-user-select: none;
    }

    .lt-end-session-btn {
      font-size: 1.5rem;
      color: inherit;
      /* 继承父元素的颜色 */
      opacity: 0.6;
      cursor: pointer;
      padding: 0 5px;
      line-height: 1;
      font-weight: bold;
    }

    .lt-end-session-btn:hover {
      opacity: 1;
    }

    /* --- Noir's Refactor: Feed Loader Style --- */
    #feed-loader {
      position: absolute;
      inset: 0;
      background: rgba(244, 248, 255, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--text-color);
      font-size: 1rem;
      flex-direction: column;
      gap: 10px;
    }

    .loader-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* --- End of Refactor --- */
    /*
        Noir's Mizuiro Theme
        - 哼，看好了，这才是设计。
      */
    /*
          Noir's Mizuiro Theme
          - 哼，看好了，这才是设计。
        */
    :root {
      --phone-width: 375px;
      --phone-height: 812px;
      --user-bg-image: url('');

      /* === Noir's Ultimate Dynamic Theme Engine v2.0 === */
      /* 哼，现在所有的颜色都听从这三个总开关的指挥。*/
      --primary-hue: 35;
      --primary-saturation: 25%;
      --primary-lightness: 80%;

      /* 核心颜色 */
      --primary-color: hsl(var(--primary-hue), var(--primary-saturation), var(--primary-lightness));
      /* 强调色/用户气泡色，现在也是动态的 */
      --accent-color: hsl(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%));

      /* 哼，看好了，这些就是被我重新接上线的“电灯” */

      /* 文字颜色：根据主题亮度自动变深或变浅 */
      --text-color: hsl(var(--primary-hue), 15%, calc(100% - var(--primary-lightness) / 1.1));
      --text-color-light: hsl(var(--primary-hue), 10%, calc(100% - var(--primary-lightness) / 1.3));

      /* 表面背景：半透明，亮度比主色高一点 */
      --surface-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.4);

      /* 卡片/AI气泡背景：比表面背景更亮一点 */
      --card-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.5);

      /* 边框颜色 */
      --border-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness)), 0.3);

      /* 阴影颜色 */
      --soft-shadow: 0 4px 12px hsla(var(--primary-hue), 40%, calc(var(--primary-lightness) - 10%), 0.15);

      /* 动态页的设置保持不变 */
      --feed-bg-image: none;
      --feed-overlay-opacity: 0.12;
      --feed-overlay-rotate: 22deg;
      --feed-overlay-speed: 48s;

      /* 气泡样式也完全动态化 */
      --bubble-radius: 18px;
      --bubble-outline: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
      --bubble-user-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%), 0.5);
      /* <-- 哼，改成0.5，现在够“虚无”了吧 */
      --bubble-ai-bg: var(--card-bg);

      /* ▼▼▼ 把下面这两行加进去 ▼▼▼ */
      --dropdown-alpha: 0.9;
      /* 下拉菜单的透明度，0到1 */
      --feed-card-alpha: 0.7;
      /* 动态卡片的透明度，0到1 */


      /* ▲▲▲ 添加到这里结束 ▲▲▲ */

    }

    /* Noir's Font Decree */
    body {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      /* 哼，看好了，就是这句！现在字体听从我的新变量指揮了！ */
      font-family: var(--custom-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif);
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
    }

    /* 让字体预览区也听话 */
    #font-preview-text {
      font-family: var(--custom-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif);
    }

    #phone-container {
      width: 100%;
      /* 占满屏幕宽度 */
      height: 100vh;
      /* 占满屏幕高度 */
      background-color: white;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* 是不是清爽多了？ */
      position: relative;
      /* <-- 就是这句，告诉它“你是个家长了，给我看好家里的东西！” */
    }

    .screen {
      flex-grow: 1;
      display: none;
      flex-direction: column;
      background-color: #f9f9f9;
      /* 哼，所有屏幕默认都给我变白 */
      /* 让背景透出来 */
      overflow: hidden;
      color: var(--text-color);
    }

    .screen.active {
      display: flex;
    }

    /* 这个是通用的头像预览样式 */
    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
      margin-top: 5px;
      cursor: pointer;
    }

    /* --- 通用顶栏 --- */
    .header,
    #chat-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--primary-color);
      font-weight: 500;
      min-width: 50px;
      text-align: center;
      /* ▼▼▼ 哼，加上这三句，给我立正站好 ▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- 聊天列表 --- */
    #chat-list-pane {
      background-color: transparent;
      border-right: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 加上这句 */
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      /* 防止它在横向布局里被挤扁 */
      display: flex;
      flex-direction: column;
    }

    #chat-list-container {
      flex-grow: 1;
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
    }

    #character-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .character-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      /* backdrop-filter: blur(10px);*/
      border-radius: 16px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .character-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(138, 180, 228, 0.2);
    }

    .char-info-wrapper {
      flex-grow: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .character-item .char-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      margin-right: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .character-item .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .character-item .char-remark {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    #chat-screen-container {
      position: relative;
      /* 告诉里面的绝对定位元素，要以我为基准 */
      flex-grow: 1;
      /* 确保它能撑满 chat-screen 的空间 */
      overflow: hidden;
      /* 把滑出去的部分藏起来，这很重要 */
      display: flex;
      /* 保持内部元素的 flex 布局 */
    }

    /* --- 聊天窗口 --- */


    #chat-view-pane {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 还有这句 */
      background-color: transparent;
      z-index: 10;
    }

    #chat-screen.show-chat-view #chat-list-pane {
      transform: translateX(-100%);
    }

    #chat-screen.show-chat-view #chat-view-pane {
      transform: translateX(0);
    }

    #chat-messages {
      flex-grow: 1;
      padding: 5px;
      overflow-y: auto;
      display: flex;
      /* <-- 加上这个 */
      flex-direction: column;
      /* <-- 还有这个 */
      contain: content;
      contain: content;
      /* <-- 哼，就是这句救命神药！ */
    }



    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;

      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.7);
      flex-shrink: 0;
    }

    .message {
      padding: 10px 16px;
      border-radius: 20px;
      line-height: 1.5;
      word-break: break-word;
      box-shadow: var(--soft-shadow);
    }

    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
    }

    .message.user {
      background-color: var(--accent-color);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .message.ai {
      background-color: var(--card-bg);
      border: 1px solid rgba(255, 255, 255, 0.8);
      color: var(--text-color);
      border-bottom-left-radius: 5px;
    }

    .message p {
      margin: 0;
    }

    .sticker-content,
    .message-image-content {
      max-width: 120px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
    }

    .message-image-content {
      max-width: 160px;
    }

    /* --- 其他屏幕和组件 --- */
    /* --- Noir's Fix: API 模型列表的样式修正 --- */
    .model-input-container {
      position: relative;
      /* 关键！让里面的绝对定位元素有家可回 */
      display: flex;
      gap: 8px;
    }

    .custom-model-dropdown {
      display: none;
      /* 默认藏起来 */
      position: absolute;
      top: 100%;
      /* 精准定位到输入框正下方 */
      left: 0;
      right: 80px;
      /* 留出“获取”按钮的位置 */
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*   backdrop-filter: blur(10px);*/
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 100;
      /* 确保它在最上层 */
      box-shadow: var(--soft-shadow);
    }

    .checkboxes-container {
      display: none;
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*  backdrop-filter: blur(10px);*/
      z-index: 10;
      border-radius: 8px;
      margin-top: 4px;
    }

    .custom-model-dropdown.show {
      display: block;
      /* 需要的时候再显示 */
    }

    .custom-model-dropdown div {
      padding: 10px 12px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    .custom-model-dropdown div:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    /* --- 其他屏幕和组件 --- */
    /* 在这个注释下面加上主屏幕的样式 */
    #home-screen {
      position: relative;
      /* <-- 就加上这一行！ */


      gap: 20px;
      /* 图标之间的距离 */

      /* 声明！这里现在是我的地盘！*/
      flex-direction: column;
      /* 里面的东西，全体给我垂直排队！*/
      justify-content: space-between;
      /* 核心！顶部和底部的元素给我贴边站好，中间的自动拉开距离！*/
      padding-bottom: 0;
      /* 把内边距去掉，让Dock栏能完美贴底 */
    }

    .app-icon {
      width: 75px;
      /* <--- 就是这里，我把它加宽了 */
      height: 90px;
      /* <--- 高度也顺便调整一下 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: absolute;
      z-index: 40;
      padding: 5px;
      box-sizing: border-box;
      margin: 0;
    }

    .app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 2px;
      /* <-- 哼，就是这里，把5px改成2px，让图标和文字的距离拉近一点 */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      background-color: var(--surface-bg);
      box-shadow: none;
      transition: transform 0.2s ease;
    }

    .app-icon-img svg {
      stroke: currentColor;
      /* SVG的线条颜色会继承上面的 color */
    }

    .app-icon span {
      font-size: 0.75rem;
      /* 文本也相应缩小 */
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }

    .content {
      padding: 20px;
      overflow-y: auto;
      flex-grow: 1;
      /* <-- 加上这行代码，就是这行！ */
    }

    .form-button {
      width: 100%;
      padding: 12px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--border-color);
      color: var(--text-color);
      border-radius: 8px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    .chat-toolbar {
      display: flex;
      padding: 5px 10px;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      /*   backdrop-filter: blur(10px);*/
      flex-shrink: 0;
    }

    /* ▼▼▼ 用下面这段，替换掉你旧的 .toolbar-button 样式 ▼▼▼ */
    .toolbar-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      /* 这个保留，作为SVG尺寸的参考 */
      cursor: pointer;
      padding: 8px;
      /* 稍微增大点击区域 */
      color: var(--text-color-light);
      /* 让它默认是浅灰色 */
      border-radius: 50%;
      /* 让背景有个圆形轮廓 */
      width: 40px;
      height: 40px;
      display: flex;
      /* 使用flex布局让SVG完美居中 */
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s, color 0.2s;
      /* 加上顺滑的过渡效果 */
    }

    .toolbar-button:hover {
      background-color: var(--border-color);
      /* 鼠标悬停时给个背景 */
      color: var(--primary-color);
      /* 图标颜色变为主题色 */
    }

    /* ▲▲▲ 替换到这里为止 ▲▲▲ */


    /* ▼▼▼ 在下面新增这段SVG的专属样式 ▼▼▼ */
    .toolbar-button svg {
      width: 22px;
      /* SVG图标的尺寸 */
      height: 22px;
      stroke-width: 1.8;
      /* 线条粗细，可以微调 */
      stroke: currentColor;
      /* 核心！让SVG的颜色继承按钮的color属性 */
      fill: none;
      /* 确保是线稿风格 */
      pointer-events: none;
      /* 防止SVG本身干扰点击事件 */
    }

    /* ▲▲▲ 新增到这里为止 ▲▲▲ */

    .sticker-panel {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      flex-shrink: 0;
    }

    .sticker-panel.show {
      display: grid;
    }

    /* --- 输入区域 --- */
    /* --- 输入区域 --- */
    .chat-input-area {
      padding: 10px 12px calc(env(safe-area-inset-bottom, 0px) + 10px);
      background: var(--surface-bg);
      /*  backdrop-filter: saturate(1.2) blur(10px);*/
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    /* 这是我加的新容器，用来实现完美对齐 */
    #chat-input-wrapper {
      display: flex;
      /* Flex大法好，哼 */
      align-items: center;
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 2px 5px;
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-input-wrapper:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-message-input {
      flex-grow: 1;
      /* 让输入框占满剩余空间 */
      border: none;
      background: transparent;
      padding: 9px 12px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 38px;
      width: 38px;
      border: 0;
      border-radius: 50%;
      font-size: 1.2rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
      flex-shrink: 0;
      /* 防止被挤压 */
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    /* 回复按钮，给个不一样的颜色区分 */
    #chat-get-reply-button {
      background: var(--accent-color);
      font-size: 1.5rem;
      /* 让箭头更清晰 */
    }

    #chat-message-input {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 11px 16px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-message-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 40px;
      padding: 0 18px;
      border: 0;
      border-radius: 20px;
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    #chat-get-reply-button {
      display: flex;
      /* 隐藏旧的回复按钮，样式统一到发送按钮 */
    }


    /* --- 引用样式 --- */
    .quote-preview {
      display: none;
      padding: 8px 12px;
      background-color: rgba(255, 255, 255, 0.5);
      border-left: 3px solid var(--primary-color);
      margin: 0 12px 8px;
      border-radius: 6px;
      position: relative;
    }

    #quote-preview-sender {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--primary-color);
    }

    #quote-preview-text {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    .cancel-quote-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #999;
      cursor: pointer;
    }

    .quoted-message-in-bubble {
      background-color: rgba(0, 0, 0, 0.04);
      padding: 8px 10px;
      border-left: 3px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quoted-sender {
      font-weight: bold;
      font-size: 0.8rem;
      color: var(--text-color);
    }

    .quoted-content {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    /* 这是弹窗的“骨架”，让它能居中浮动在屏幕上 */
    .choice-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .choice-modal.show {
      opacity: 1;
      visibility: visible;
    }


    /* --- 弹窗 --- */
    .choice-modal-backdrop {
      background: rgba(0, 0, 0, 0.2);
      /*  backdrop-filter: blur(4px);*/
    }

    .choice-modal-content {
      background: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .choice-modal-button {
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.5);
    }

    .choice-modal-button:hover {
      background-color: rgba(255, 255, 255, 1);
    }

    .choice-modal-button.cancel {
      color: var(--primary-color);
      background: transparent;
    }

    /* --- Noir's Fix: 让“添加”弹窗从底部滑出，更大气 --- */
    #add-choice-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      /* 确保不会超出手机宽度 */
      margin: 0;
      border-radius: 20px 20px 0 0;
      /* 只留顶部圆角 */
      border-bottom-left-radius: 0;
      /* 覆盖通用样式 */
      border-bottom-right-radius: 0;
      /* 覆盖通用样式 */
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      /* 适配iPhone底部安全区 */
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #add-choice-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #add-choice-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
      justify-content: center;
    }

    /* 按钮也重新设计一下，让它们竖着排 */
    #add-choice-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- Noir's Fix: 修正创建群聊时，成员选择列表的样式 --- */
    .member-selection-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .member-selection-item:last-child {
      border-bottom: none;
    }

    /* 关键！就是这里，把头像大小锁死 */
    .member-selection-item .char-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 15px 0 10px;
      object-fit: cover;
    }

    .member-selection-item .char-name {
      font-weight: 500;
      color: var(--text-color);
    }

    .member-selection-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      accent-color: var(--primary-color);
      /* 让勾选框颜色也跟主题统一 */
    }

    /* --- Noir's World Book Styles --- */
    #world-book-list-container {
      padding: 10px;
    }

    .world-book-item {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .world-book-item-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .world-book-item-preview {
      font-size: 0.9rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* --- Noir's Fancy Multi-Select Styles --- */
    .custom-multiselect {
      position: relative;
      user-select: none;
    }

    .select-box {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .select-box.expanded .arrow {
      transform: rotate(180deg);
    }


    .checkboxes-container.visible {
      display: block;
    }

    .checkboxes-container label {
      display: block;
      padding: 10px 12px;
    }

    .checkboxes-container label:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    .checkboxes-container input[type="checkbox"] {
      margin-right: 8px;
      width: auto;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Clock & Timestamp Styles --- */
    /* --- Noir's Badge & App Dock Styles --- */
    #decorative-badge {
      width: 160px;
      height: 160px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
      /* 哼，给你加个阴影，看起来才像样 */
      transform: rotate(-0deg);
      /* 稍微歪一点，显得随意 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      /* 防止拖动时选中图片 */
      z-index: 50;
    }

    #decorative-badge:active {

      transform: rotate(-2deg) scale(1.05);
      /* 抓起来的时候，摆正放大一点 */
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }


    #decorative-badge img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* 保留这句，让你的图片能被很好地填充 */
    }

    /*  #a#app-dock-bottom-left,
    #app-dock-top-right {
      
      哼，现在你们只是幽灵了。
      不需要任何样式，你们的孩子（App图标）会自己找到回家的路。
      它们会相对于 #home-screen 定位。
    
    }
*/

    /* --- Noir's Author Mark: Pixel Chicken --- */
    /* 哼，这就是那个吵着要加的小鸡图标 */
    #noir-author-mark {
      position: absolute;
      /* 相对于父容器定位 */
      right: -30px;
      /* 调整它在时钟右边的位置 */
      top: 50%;
      /* 垂直居中 */
      transform: translateY(-50%);
      /* 精确对齐 */
      width: 20px;
      /* 小鸡的尺寸 */
      height: 20px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="0"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM12 4c.69 0 1.25.56 1.25 1.25S12.69 6.5 12 6.5s-1.25-.56-1.25-1.25S11.31 4 12 4zm0 2c-.69 0-1.25.56-1.25 1.25S11.31 8.5 12 8.5s1.25-.56 1.25-1.25S12.69 6 12 6zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 9.75 10 9.75s1.25-.56 1.25-1.25S10.69 8 10 8zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 9.75 12 9.75s1.25-.56 1.25-1.25S12.69 8 12 8zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 9.75 14 9.75s1.25-.56 1.25-1.25S14.69 8 14 8zM10 10c-.69 0-1.25.56-1.25 1.25S9.31 12.5 10 12.5s1.25-.56 1.25-1.25S10.69 10 10 10zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 12.5 12 12.5s1.25-.56 1.25-1.25S12.69 10 12 10zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 12.5 14 12.5s1.25-.56 1.25-1.25S14.69 10 14 10zM12 12c-.69 0-1.25.56-1.25 1.25S11.31 14.5 12 14.5s1.25-.56 1.25-1.25S12.69 12 12 12zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 15.75 10 15.75s1.25-.56 1.25-1.25S10.69 14 10 14zm4 0c-.69 0-1.25.56-1.25 1.25S13.31 15.75 14 15.75s1.25-.56 1.25-1.25S14.69 14 14 14zM12 16c-.69 0-1.25.56-1.25 1.25S11.31 18.5 12 18.5s1.25-.56 1.25-1.25S12.69 16 12 16zM6 10c-.69 0-1.25.56-1.25 1.25S5.31 12.5 6 12.5s1.25-.56 1.25-1.25S6.69 10 6 10zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 12.5 18 12.5s1.25-.56 1.25-1.25S18.69 10 18 10zM12 20c-.69 0-1.25.56-1.25 1.25S11.31 22.5 12 22.5s1.25-.56 1.25-1.25S12.69 20 12 20zM6 14c-.69 0-1.25.56-1.25 1.25S5.31 15.75 6 15.75s1.25-.56 1.25-1.25S6.69 14 6 14zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 15.75 18 15.75s1.25-.56 1.25-1.25S18.69 14 18 14z"/></svg>');
      /* 这是SVG小鸡的Data URI，白色像素风格 */
      background-size: contain;
      background-repeat: no-repeat;
      cursor: pointer;
      /* 提示可点击 */
      opacity: 0.6;
      /* 稍微透明一点，不那么突兀 */
      transition: opacity 0.2s ease-in-out;
      /* 鼠标悬停效果 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    #noir-author-mark:hover {
      opacity: 1;
      /* 鼠标悬停时完全显示 */
    }

    /* 调整时钟容器，为小鸡留出空间并方便定位 */
    .home-clock-container {
      position: relative;
      /* 确保小鸡能相对它定位 */
      /* ... (保留你已有的其他时钟样式) ... */
      padding-right: 40px;
      /* 给小鸡留出一些右边距 */
    }

    #home-clock-container {
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      text-align: center;
      position: absolute;
      /* top, left, right 都被我删了，哼，现在它完全听JS的指挥 */

      /* 这行可以留着，虽然你已经不让它拖了 */
      z-index: 50;
    }

    #home-time {
      font-size: 80px;
      font-weight: 360;
      /* <--- 我把字重从200加到了300，比原来粗，但又不会笨重，这才是高级感。 */
      letter-spacing: -1px;
      /* <--- 字间距也给你调紧了一点，看起来更整体。 */
    }

    #home-date {
      font-size: 1rem;
      /* <--- 稍微缩小一点，让时间更突出 */
      font-weight: 400;
      margin-top: 8px;
      opacity: 0.8;
      text-transform: uppercase;
      /* <--- 日期我给你换成了全大写，这才有那股‘性冷淡’的味道。 */
      letter-spacing: 1px;
      /* <--- 顺便拉开一点点间距，免得挤在一起。 */
    }

    /* 聊天气泡时间戳的样式 */
    .timestamp {
      font-size: 0.7rem;
      color: var(--text-color-light);
      padding: 0 5px;
      margin-bottom: 3px;
      /* 让它和气泡底部对齐 */
    }

    /* 第一段：这是消息容器的基础样式 */
    .message-container {
      display: flex;
      /* 启用flex布局 */
      flex-direction: column;
      /* 让气泡和时间戳垂直排列 */
      margin-bottom: 10px;
      max-width: 85%;
      /* 限制整个容器的最大宽度 */
    }

    /* 第二段：这是根据发言者进行左右对齐的样式 */
    .message-container.user {
      align-self: flex-end;
      /* 让用户方整个容器靠右 */
      align-items: flex-end;
      /* 让容器内部的元素（气泡、时间戳）也靠右 */
    }

    .message-container.ai {
      align-self: flex-start;
      /* 让AI方整个容器靠左 */
      align-items: flex-start;
      /* 让容器内部的元素（气泡、时间戳）也靠左 */
    }

    .message-bubble-row {
      display: flex;
      align-items: flex-end;
      width: 100%;
    }

    .message-container.user .message-bubble-row {
      justify-content: flex-end;
    }

    .message-container.ai .message-bubble-row {
      justify-content: flex-end;
    }



    /* 这是给表情选择面板里，每一个小表情图片用的样式 */
    .sticker-item {
      width: 100%;
      /* 自动填满网格单元格的宽度 */
      aspect-ratio: 1 / 1;
      /* 保持1:1的宽高比，让它变成正方形 */
      object-fit: cover;
      /* 图片会被裁剪以适应正方形，不变形 */
      border-radius: 8px;
      /* 加个小圆角 */
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .sticker-item:hover {
      transform: scale(1.1);
      /* 鼠标放上去时稍微放大，增加交互感 */
    }

    /* --- Noir's Offline Scene Styles --- */
    #meeting-scene-view {
      flex-grow: 1;
      /* <-- 核心：让它占满所有可用空间 */
      overflow-y: auto;
      /* <-- 核心：内容多了就内部滚动 */
      padding: 20px;
      font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif;
      background-size: cover;
      background-position: center;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }

    #chat-view-pane.offline-mode #offline-scene-view {
      display: block;
      /* 在线下模式时显示 */
    }

    #chat-view-pane.offline-mode #chat-messages {
      display: none;
      /* 在线下模式时隐藏气泡聊天 */
    }

    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      /* 保留换行和空格，这对于小说格式至关重要 */
      font-size: 1rem;
    }

    /* --- Noir's Offline Scene Dialogue Box Style --- */
    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 1rem;

      /* <--- Noir's Addition: 为对话框添加半透明背景和内边距 */
      background-color: rgba(0, 0, 0, 0.4);
      /* 半透明黑色背景 */
      padding: 15px 20px;
      /* 内边距，让文字与边框有距离 */
      border-radius: 8px;
      /* 圆角边框，更柔和 */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      /* 轻轻的阴影，增加立体感 */
    }

    #offline-scene-view .narrator {
      color: #d1d5db;
      /* 旁白用浅灰色 */
      font-style: italic;
    }

    #offline-scene-view .speaker-user {
      color: #a7c7e7;
      /* 用户的发言用一种柔和的蓝色 */
      font-weight: bold;
    }

    #offline-scene-view .speaker-ai {
      color: #f2b7c6;
      /* AI的发言用柔和的粉色，形成对比 */
      font-weight: bold;
    }

    /* --- Noir's Typing Indicator Style --- */
    .typing-indicator {
      padding: 10px 15px;
      color: var(--text-color-light);
      font-style: italic;
      font-size: 0.9rem;
      align-self: flex-start;
      /* 让它和AI气泡一样靠左 */
      margin-left: 50px;
      /* 和AI气泡对齐 */
    }

    #offline-scene-view .typing-indicator {
      color: rgba(255, 255, 255, 0.8);
      /* 在暗色背景下用亮色 */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      /* 同样的文字阴影，保持队形 */
      padding: 10px 0;
      margin-left: 0;
      /* 在小说视图里不需要缩进 */
    }

    /* --- Noir's Final Alignment Fix --- */
    .message-container.ai .timestamp {
      /* 哼，给你加上头像宽度(40px) + 左右边距(10px)的距离 */
      margin-left: 50px;
    }

    .message-container.user .timestamp {
      /* 另一边也是一样，真是麻烦死了 */
      margin-right: 50px;
    }

    /* --- Noir's Music Feed & Player Styles --- */
    #music-feed-container {
      padding-bottom: 70px;
      contain: content;
      /* 为底部播放器留出空间 */
    }

    /* 动态页：默认白底；如设置 --feed-bg-image 则显示独立壁纸 + 轻动画叠层 */
    #music-screen {
      background-color: #fff;
      /* 默认白底 */
      background-image: var(--feed-bg-image);
      /* 单独壁纸，不设就是 none */
      background-size: cover;
      background-position: center;
      contain: paint;
      /* 降低重绘范围，省电 */
    }

    /* 轻动画彩雾叠层：仅图层，不拦点击 */
    #music-screen::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        conic-gradient(from var(--feed-overlay-rotate),
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 0%,
          transparent 20%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 40%,
          transparent 60%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 80%,
          transparent 100%);
      transform: translateZ(0);
      animation: feed-pan var(--feed-overlay-speed) linear infinite;
    }

    /* 超慢速平移旋转，基本不占 GPU */
    @keyframes feed-pan {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }

      50% {
        transform: translate3d(1.2%, 0.8%, 0) rotate(2deg) scale(1.02);
      }

      100% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }
    }

    /* 系统降低动画偏好时，自动停掉动画 */
    @media (prefers-reduced-motion: reduce) {
      #music-screen::before {
        animation: none;
      }
    }


    .music-post {
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), var(--feed-card-alpha));
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: var(--soft-shadow);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .music-post-header {
      display: flex;
      align-items: center;
      padding: 12px 15px;
    }

    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .music-post-header .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .music-post-thought {
      padding: 0 15px 15px;
      font-size: 0.95rem;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .music-post-song-card {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.04);
      padding: 12px 15px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .music-post-song-card:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    .music-post-song-card img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }

    .music-post-song-info {
      flex-grow: 1;
    }

    .music-post-song-info .title {
      font-weight: 500;
      color: var(--text-color);
    }

    .music-post-song-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    .music-post-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    #music-player-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--surface-bg);
      /*backdrop-filter: blur(10px);*/
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 10px;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    #music-player-bar:not(.hidden) {
      transform: translateY(0);
    }

    #music-player-bar.hidden {
      display: none;
      /* 彻底隐藏，避免交互问题 */
    }


    #player-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
    }

    #player-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #player-title,
    #player-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #player-title {
      font-weight: 500;
    }

    #player-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #player-controls button {
      background: none;
      border: 2px solid var(--text-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Share Bubble Styles --- */
    .message.music {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
      max-width: 250px;
      /* 限制一下最大宽度 */
    }

    .music-share-card {
      display: flex;
      align-items: center;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
    }

    .message-container.user .music-share-card {
      background-color: var(--accent-color);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .message-container.user .music-share-card .title,
    .message-container.user .music-share-card .artist,
    .message-container.user .music-share-card .play-icon {
      color: white;
    }


    .music-share-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .music-share-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-share-info .title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #music-screen {
      position: relative;
      /* 就是这句，告诉里面的绝对定位元素，以我为界！ */
    }

    /* --- Noir's Fancy Music Widget Styles --- */
    /* --- Noir's Music System Refactor --- */

    #music-widget:not(.hidden) {
      transform: translateY(0);
      /* 不隐藏时，滑上来 */
    }

    #music-widget.hidden {
      transform: translateY(150%);
      /* 隐藏时，滑下去 */
    }

    .widget-vinyl {
      width: 80px;
      height: 80px;
      background-color: #111;
      border-radius: 50%;
      position: relative;
      left: 20px;
      /* 向右移动，让卡片能盖住它 */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      background-image:
        radial-gradient(circle at center, #555 10%, transparent 11%),
        radial-gradient(circle at center, #fff 12%, transparent 13%);
      animation: spin 8s linear infinite;
      z-index: 1;
    }

    @keyframes spin {
      from {
        transform: translate(-50%, -50%) rotate(0deg);
        /* <-- 看见没，把咒语合并了 */
      }

      to {
        transform: translate(-50%, -50%) rotate(360deg);
        /* <-- 这里也是 */
      }
    }

    .widget-card {
      width: 240px;
      padding: 15px;
      background-color: var(--card-bg);
      /*  backdrop-filter: blur(10px);*/
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      z-index: 2;
      /* 让卡片在唱片上方 */
    }

    .widget-card img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .widget-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #widget-title,
    #widget-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #widget-title {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    #widget-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #widget-play-icon {
      font-size: 1.2rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #card-widget {
      width: 335px;
      height: 170px;
      border-radius: 18px;
      /* 这就是圆角方形的关键 */
      background-color: rgba(255, 255, 255, 0.5);
      /* 加个底色，免得图片透明时不好看 */

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transform: rotate(0deg);
      /* 朝另一个方向歪 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      /* 比爱心高一层 */
      overflow: hidden;
      /* 防止图片溢出圆角 */
    }


    /* --- End of Protocol --- */

    /* --- Noir's "Center Alignment" Protocol --- */

    /* --- End of Protocol --- */

    #card-widget:active {

      transform: rotate(1deg) scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Noir's Ultimate Scrollbar Hider --- */
    /* For Webkit browsers like Chrome, Safari */
    ::-webkit-scrollbar {
      display: none;
    }

    /* For Firefox */
    * {
      scrollbar-width: none;
    }

    /* --- Noir's Fix: 美化消息操作弹窗 --- */
    #message-action-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
    }

    #message-action-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      margin: 0;
      border-radius: 20px 20px 0 0;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #message-action-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #message-action-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- End of Fix --- */
    /* --- Noir's Fix: Fancy User Post Area --- */
    #user-post-input-container {
      display: flex;
      gap: 10px;
    }

    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
    }

    #user-post-main-area {
      flex-grow: 1;
    }

    #user-post-textarea {
      width: 100%;
      border: none;
      background: transparent;
      outline: none;
      resize: vertical;
      font-size: 1rem;
      color: var(--text-color);
    }

    #user-post-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    /* ... 你已有的 #user-post-toolbar 样式 ... */

    /* ▼▼▼ Noir's Command: 哼，给我站成一排！ ▼▼▼ */
    #user-post-actions {
      display: flex;
      /* <-- 这就是圣旨本身 */
      gap: 8px;
      /* <-- 这是我赏赐的间距，让它们别挤在一起 */
    }

    /* ▲▲▲ Command End ▲▲▲ */

    #user-send-post-button {
      padding: 6px 18px;
      border-radius: 16px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    /* 这是附件预览的样式 */
    #user-post-attachment-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-item {
      position: relative;
      max-width: 100px;
    }

    .preview-item img {
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
    }

    .preview-item .music-preview-card {
      display: flex;
      align-items: center;
      padding: 8px;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      width: 200px;
      /* 给音乐卡片宽一点 */
    }

    .preview-item .music-preview-card img {
      width: 30px;
      height: 30px;
      margin-right: 8px;
    }

    .preview-item .music-preview-card .info {
      font-size: 0.8rem;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .remove-attachment-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    /* --- Noir's Fix: Post Image Display Style --- */
    .post-image-container {
      padding: 0 15px 15px;
      /* 图片和文字之间留点空隙 */
    }

    .post-image {
      max-width: 100%;
      /* 图片最宽不能超过帖子宽度 */
      max-height: 400px;
      /* 最高400像素，防止长图刷屏 */
      border-radius: 8px;
      /* 加个小圆角，好看 */
      object-fit: cover;
      /* 保持图片比例，不变形 */
      display: block;
      /* 解决图片底部多余的空隙问题 */
    }

    /* --- Noir's Refactor: New Post Interaction Styles --- */
    .post-interactions {
      padding: 10px 15px;
      background-color: rgba(0, 0, 0, 0.02);
      border-top: 1px solid var(--border-color);
      font-size: 0.9rem;
    }

    .post-likes {
      color: var(--primary-color);
      margin-bottom: 8px;
    }

    .post-comments-container {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .post-comment {
      color: var(--text-color);
    }

    .post-comment .comment-author {
      font-weight: 600;
      color: var(--text-color);
    }

    .post-timestamp {
      font-size: 0.75rem;
      color: var(--text-color-light);
      padding: 0 15px 10px;
    }



    /* 覆盖：基础气泡体 */
    /* 覆盖：基础气泡体 */
    .message {
      border-radius: var(--bubble-radius);
      line-height: 1.55;
      padding: 10px 14px;
      box-shadow:
        0 1px 0 rgba(0, 0, 0, .03),
        0 4px 10px rgba(0, 0, 0, .06);
      /* 比你原先更浅，省功耗 */
      border: 1px solid var(--bubble-outline);
      backdrop-filter: none !important;
      /* 绝不启用重滤镜 */
      will-change: auto;
      /* 不抢 GPU 配额 */

      /* --- Noir's Fix: 就是下面这两行，哼 --- */
      user-select: none;
      /* 标准浏览器给我听话，不许选中 */
      -webkit-user-select: none;
      /* 那些老古董浏览器也一样 */
    }

    /* 你的气泡（右侧） */
    .message.user {
      color: #fff;
      background: var(--bubble-user-bg);
      border-bottom-right-radius: 6px;
      /* 微“角”保留你原味 */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .12);
      /* 细腻但很轻 */
    }

    /* TA 的气泡（左侧） */
    .message.ai {
      color: var(--text-color);
      background: var(--bubble-ai-bg);
      border-bottom-left-radius: 6px;
    }

    /* 细节：图片/贴纸消息不套背景 */
    /* 细节：图片/贴纸/音乐卡片消息不套背景 */
    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image,
    .message.user.music,
    /* <-- 哼，加上这两行 */
    .message.ai.music {
      background: transparent;
      border: 0;
      box-shadow: none;
      padding: 0;
    }

    /* 轻触态：不使用阴影动画，避免合成层抖动 */
    .message:active {
      transform: scale(.996);
    }

    /* 引用块在气泡内的融合感 */
    .quoted-message-in-bubble {
      background: rgba(0, 0, 0, .045);
      border: 1px solid color-mix(in hsl, var(--primary-color) 18%, transparent);
      border-radius: 10px;
    }


    /* --- Noir's Transfer Bubble Style --- */
    .message.transfer {
      background: #F79232;
      /* 哼，一个温暖又醒目的橙色 */
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      width: 220px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    /* 我还给左右两边做了区分，真是为你操碎了心 */
    .message-container.ai .message.transfer {
      background: #f9fafb;
      /* AI发来的转账用白色，更清爽 */
      color: #333;
      border: 1px solid #e5e7eb;
    }

    .transfer-content {
      display: flex;
      flex-direction: column;
    }

    .transfer-title {
      font-weight: 600;
      font-size: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.5);
      padding-bottom: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .message-container.ai .transfer-title {
      border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    .transfer-amount {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .transfer-recipient {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    /* --- End of Refactor --- */



    /* --- Noir's Snap Guide Styles --- */
    .snap-guide {
      position: absolute;
      background-color: rgba(255, 105, 180, 0.85);
      /* 哼，一个足够醒目的颜色 */
      display: none;
      z-index: 999;
      box-shadow: 0 0 5px rgba(255, 105, 180, 0.7);
    }

    #snap-guide-v {
      width: 1px;
    }

    #snap-guide-h {
      height: 1px;
    }

    /* --- Noir's Galgame UI Beautification --- */
    /* Top-left Date & Time Widget */
    #galgame-overlay-ui {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 12px;
      padding: 8px 15px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    #galgame-time {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
    }

    #galgame-date {
      font-size: 0.75rem;
      opacity: 0.8;
      text-align: center;
    }

    /* Main Text Box */
    /* Main Text Box */
    #galgame-textbox-container {
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.85) 0%, rgba(45, 50, 68, 0.7) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border-top: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
      bottom: 85px;
      /* <-- 就是这里，往上抬了，满意了吗？ */
      left: 15px;
      right: 15px;
      padding: 12px 18px;
    }

    /* Speaker Name Tag */
    #galgame-speaker {
      background: linear-gradient(90deg, var(--primary-color) 0%, hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) - 10%)) 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      display: inline-block;
      font-size: 0.95rem;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      margin-bottom: 12px;
    }

    /* Dialogue Text */
    #galgame-text {
      font-size: 1rem;
      line-height: 1.7;
      color: #f0f2f5;
    }

    /* User Input Area Container*/
    #meeting-view-screen .chat-input-area {
      background: transparent;
      border-top: none;
      padding: 0 15px 20px 15px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 20;
    }

    /* User Input Wrapper */
    #chat-input-wrapper-meeting {
      display: flex;
      align-items: center;
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.9) 0%, rgba(45, 50, 68, 0.75) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      padding: 5px 8px 5px 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
    }

    #meeting-message-input {
      color: #f0f2f5;
    }

    #meeting-message-input::placeholder {
      color: rgba(240, 242, 245, 0.5);
      font-style: italic;
    }

    /* Send Button */
    #meeting-send-button {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: 300;
      color: #fff;
      transition: all .2s ease;
      margin-left: 8px;
      background: var(--primary-color);
      box-shadow: 0 2px 5px hsla(var(--primary-hue), 50%, 50%, 0.4);
    }

    #meeting-send-button:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }


    /* --- End of Beautification --- */
    /* --- Noir's Diary Beautification --- */
    #diary-entries-container {
      background-color: #fdfaf2;
      /* A warm, paper-like off-white */
      padding: 25px 20px;
      line-height: 1.9;
      border: 1px solid #e0dccc;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.08);
      /* Inner shadow for page depth */
    }

    /* This is the container for a single entry (date, author, content) */
    .diary-entry {
      margin-bottom: 2.5em;
      /* Increase spacing between entries */
      position: relative;
      padding-bottom: 1.5em;
      /* Space for the separator line */
      border-bottom: 1px dashed #dcd5c7;
      /* A subtle dashed line between entries */
    }

    /* Style the author's name */
    .diary-author {
      font-weight: normal;
      /* Make it less bold, more like a signature */
      font-size: 1rem;
      font-family: 'Segoe Script', 'Bradley Hand', cursive;
      /* A more handwritten font */
    }

    /* Style the date */
    .diary-timestamp {
      font-size: 0.75rem;
      color: #a99e8c;
      /* A faded brown color */
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
      /* Typewriter-like font for date */
    }

    /* Style the actual diary text content */
    .diary-content {
      white-space: pre-wrap;
      font-size: 0.95rem;
      color: #4a443b;
      /* A dark brown/black ink color */
      font-family: 'KaiTi', 'STSong', serif;
    }

    /* Specific styles for the USER's entries */
    .diary-entry.user {
      text-align: right;
    }

    .diary-entry.user .diary-author {
      color: #005a9c;
      /* A nice fountain pen blue */
    }

    .diary-entry.user .diary-content {
      color: #1a5c8e;
    }

    /* Specific styles for the AI's entries */
    .diary-entry.ai {
      text-align: left;
    }

    .diary-entry.ai .diary-author {
      color: #5a3e36;
      /* A darker, warmer brown for the AI */
    }

    .diary-entry.ai .diary-content {
      color: #4a443b;
    }

    /* Let's get rid of the last separator line for a cleaner look */
    .diary-entry:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    /* --- End of Diary Beautification --- */
    /* --- Noir's Page-Turning Magic --- */
    #diary-entries-container {
      perspective: 1500px;
      /* 为3D效果设置视距 */
      position: relative;
      overflow: hidden;
    }

    .diary-page {
      position: absolute;
      inset: 0;
      padding: 25px 20px;
      background-color: #fdfaf2;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      transition: transform 0.7s cubic-bezier(0.65, 0, 0.35, 1);
      display: none;
      /* 默认所有页面都藏起来 */
      flex-direction: column;
      gap: 2.5em;
      /* 页内日记的间距 */
      overflow-y: auto;
      /* 如果一页内容太多，允许滚动 */
    }

    .diary-page.is-visible {
      display: flex;
      /* 只有当前页显示 */
      transform: rotateY(0deg);
      z-index: 2;
    }

    /* 翻到下一页时，当前页向左翻出 */
    .diary-page.is-exiting-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 1;
    }

    /* 翻到下一页时，新页面从右边翻入 */
    .diary-page.is-entering-from-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 2;
    }

    /* 翻到上一页时，当前页向右翻出 */
    .diary-page.is-exiting-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 1;
    }

    /* 翻到上一页时，新页面从左边翻入 */
    .diary-page.is-entering-from-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 2;
    }


    #diary-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 10px;
      box-sizing: border-box;
    }

    #diary-navigation button {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--primary-color);
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    #diary-navigation button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #diary-page-indicator {
      font-size: 0.9rem;
      color: var(--text-color-light);
      font-family: 'Courier New', monospace;
    }

    /* --- End of Magic --- */
    /* --- Noir's Universal Anti-Squash Protocol --- */
    /* 哼，就是下面这几条，给你那些被压扁的头像整整容 */

    /* 动态发布区的用户头像 */
    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      object-fit: cover;
      /* <-- 加上这句，它就不敢扁了 */
    }

    /* 好友圈动态里的角色头像 */
    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
      /* <-- 还有这句，一个都别想跑 */
    }

    /* 顺便把所有叫 .char-avatar 的都统一一下，免得以后还有问题 */
    .char-avatar {
      object-fit: cover;
      /* ▼▼▼ 哼，加上这三句圣旨，给我立正站好！▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Library Styles --- */
    #music-library-container {
      padding: 10px;
    }

    .music-library-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .music-library-item:hover {
      transform: translateY(-2px);
    }

    .music-library-item-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 15px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .music-library-item-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-library-item-title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-library-item-artist {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    /* --- Noir's "Time Memorandum" Styles --- */
    /* 哼，这才叫设计。*/

    /* 1. Home Screen Widget */
    #calendar-widget-main {
      width: 90%;
      height: 170px;
      /* 和你的卡片差不多高 */
      background: var(--surface-bg);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 22px;
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      box-shadow: var(--soft-shadow);
      padding: 20px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: var(--text-color);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    #calendar-widget-main:active {
      transform: scale(0.98) translateX(-50%);
    }

    #countdown-title {
      font-size: 1rem;
      font-weight: 500;
      opacity: 0.8;
    }

    #countdown-timer {
      font-size: 4rem;
      font-weight: 300;
      line-height: 1.2;
      color: var(--accent-color);
      display: flex;
      align-items: baseline;
    }

    #countdown-timer .unit {
      font-size: 1rem;
      font-weight: 500;
      margin-left: 8px;
      color: var(--text-color-light);
    }

    /* 2. Full Calendar Screen */
    #calendar-screen {
      justify-content: flex-start;
    }

    #calendar-view-container {
      padding: 10px 15px;
      flex-shrink: 0;
      border-bottom: 1px solid var(--border-color);
    }

    .calendar-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .calendar-nav button {
      background: none;
      border: 1px solid var(--border-color);
      color: var(--text-color);
      padding: 6px 12px;
      border-radius: 16px;
      cursor: pointer;
    }

    .calendar-weekdays,
    #calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      text-align: center;
    }

    .calendar-weekdays {
      font-size: 0.8rem;
      color: var(--text-color-light);
      margin-bottom: 5px;
    }

    #calendar-grid .calendar-day {
      padding: 5px 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      aspect-ratio: 1 / 1;
      cursor: pointer;
      position: relative;
    }

    .calendar-day .day-number {
      z-index: 1;
    }

    .calendar-day.other-month .day-number {
      opacity: 0.3;
    }

    .calendar-day.is-today .day-number {
      color: var(--accent-color);
      font-weight: 700;
    }

    .calendar-day.is-selected .day-number {
      color: white;
    }

    .calendar-day.is-selected::before {
      content: '';
      position: absolute;
      width: 80%;
      height: 80%;
      background: var(--primary-color);
      border-radius: 50%;
      z-index: 0;
    }

    .calendar-day .day-dot {
      width: 5px;
      height: 5px;
      background-color: var(--primary-color);
      border-radius: 50%;
      position: absolute;
      bottom: 8px;
    }

    /* 3. Todo List Area */
    #todo-view-container {
      flex-grow: 1;
      overflow-y: auto;
      padding: 15px;
      position: relative;
      /* 为了悬浮按钮 */
    }

    /* 4. Today's To-Do Widget */
    #today-todo-widget {
      position: absolute;
      top: 50%;
      /* 放在日历小组件的下方 */
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      max-height: 180px;
      /* 给个最大高度，免得内容太多撑爆了 */
      background: var(--surface-bg);
      backdrop-filter: blur(10px);
      border-radius: 22px;
      padding: 15px 20px;
      box-sizing: border-box;
      color: var(--text-color);
      overflow: hidden;
      /* 把溢出的部分藏起来 */
    }

    #today-todo-widget .widget-title {
      font-weight: 600;
      margin-bottom: 10px;
      opacity: 0.9;
    }

    #today-todo-list {
      overflow-y: auto;
      /* 内容多了可以滚动 */
      max-height: 125px;
      /* 限制列表的高度 */
      font-size: 0.9rem;
    }

    #today-todo-list .todo-item-small {
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    #today-todo-list .todo-item-small::before {
      content: '';
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background-color: var(--primary-color);
      margin-right: 10px;
      flex-shrink: 0;
    }

    #todo-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    #todo-date-title {
      margin: 0;
      font-size: 1.2rem;
      font-weight: 600;
    }

    #add-event-fab {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: var(--accent-color);
      color: white;
      border: none;
      font-size: 2rem;
      line-height: 44px;
      cursor: pointer;
      box-shadow: var(--soft-shadow);
    }

    #todo-list .todo-item,
    #todo-list .important-day-item {
      background: var(--card-bg);
      padding: 12px 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      border-left: 4px solid var(--primary-color);
    }

    #todo-list .important-day-item {
      border-left-color: #ffc107;
      /* 纪念日用醒目的黄色 */
      font-weight: 500;
    }

    #todo-list .important-day-item::before {
      content: '★ ';
      color: #ffc107;
    }

    /* --- End of Styles --- */
    /* --- Noir's Global Player Styles --- */

    /* --- End of Player Styles --- */
    /* --- Noir's Upload Altar Styles --- */
    .upload-slot {
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease;
      background-color: rgba(255, 255, 255, 0.5);
    }

    .upload-slot:hover {
      background-color: var(--card-bg);
      border-color: var(--primary-color);
    }

    .upload-slot.filled {
      border-color: var(--primary-color);
      border-style: solid;
      background-color: hsla(var(--primary-hue), 50%, 95%, 0.8);
    }

    .upload-slot .slot-icon {
      font-size: 2rem;
    }

    .upload-slot .slot-label {
      display: block;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .upload-slot .slot-filename {
      display: block;
      font-size: 0.85rem;
      color: var(--text-color-light);
      margin-top: 3px;
      word-break: break-all;
    }

    #confirm-altar-upload-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* --- End of Altar Styles --- */
    /* --- Noir's Listen Together Invite Card Style --- */
    .listen-together-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--soft-shadow);
      border: 1px solid var(--border-color);
      width: 250px;
    }

    .message-container.user .listen-together-card {
      background: var(--bubble-user-bg);
      color: white;
    }

    .message-container.user .listen-together-card .listen-together-decline-btn {
      color: white;
      /* 哼，让用户侧的拒绝按钮文字也变白 */
    }

    .listen-together-header {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--bubble-outline);
      padding-bottom: 8px;
    }

    .listen-together-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .listen-together-song img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .listen-together-info .title {
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-info .artist {
      font-size: 0.9em;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .listen-together-actions button {
      flex-grow: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease;
    }

    .listen-together-actions button:active {
      transform: scale(0.97);
    }

    .listen-together-accept-btn {
      background: var(--primary-color);
      color: white;
    }

    .listen-together-decline-btn {
      background: rgba(0, 0, 0, 0.1);
    }

    /* 用这个替换你旧的 #listen-together-ui */
    #listen-together-ui {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: flex;
      align-items: center;
      /* 改成居中对齐 */
      justify-content: center;
      padding: 20px;
      /* 增加内边距，让弹窗不会贴边 */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #listen-together-ui.show {
      opacity: 1;
      visibility: visible;
    }

    .lt-ui-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px) saturate(1.8);
      -webkit-backdrop-filter: blur(15px) saturate(1.8);
    }

    /* 用这个替换你旧的 .lt-ui-main */
    .lt-ui-main {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 380px;
      /* 哼，给它一个最大宽度 */
      max-height: 650px;
      /* 再给一个最大高度 */
      display: flex;
      flex-direction: column;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      border-radius: 24px;
      /* 加上优雅的圆角 */
      overflow: hidden;
      /* 把溢出的部分裁掉 */
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      /* 更强的立体阴影 */
      border: 1px solid rgba(255, 255, 255, 0.2);
      /* 淡淡的边框光效 */
    }

    .lt-ui-header {
      flex-shrink: 0;
      padding: 15px 20px;
      text-align: center;
      position: relative;
    }

    #lt-ui-header-title {
      font-weight: 600;
    }

    #lt-ui-close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 30px;
    }

    .lt-ui-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow: hidden;
    }

    .lt-ui-cover-container {
      flex-shrink: 0;
      width: 65%;
      aspect-ratio: 1/1;
      margin-top: 5%;
      margin-bottom: 20px;
    }

    #lt-ui-cover-art {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .lt-ui-info {
      text-align: center;
      margin-bottom: 20px;
      flex-shrink: 0;
    }

    #lt-ui-song-title {
      font-size: 1.5rem;
      margin: 0;
    }

    #lt-ui-song-artist {
      font-size: 1rem;
      opacity: 0.8;
      margin: 5px 0 0;
    }

    #lt-ui-lyrics-container {
      flex-grow: 1;
      width: 100%;
      overflow-y: auto;
      text-align: center;
      font-size: 1.1rem;
      line-height: 2.5;
      mask-image: linear-gradient(transparent 0%, black 20%, black 80%, transparent 100%);
      /* 歌词上下渐隐，看起来更专业 */
      scroll-behavior: smooth;
      /* 滚动要丝滑 */
    }

    #lt-ui-lyrics-container p {
      transition: color 0.3s ease, transform 0.3s ease;
      opacity: 0.6;
    }

    #lt-ui-lyrics-container p.active {
      color: var(--primary-color);
      font-weight: 600;
      transform: scale(1.1);
      opacity: 1;
    }

    /* --- Noir's "Desktop Preview" Frame --- */
    /* 哼，只有在电脑这种大屏幕上，我才给你加上这个“手机框”，免得你分不清主次。 */
    /* 在真正的手机上，它还是会全屏显示的，我可没你那么笨。 */
    @media (min-width: 480px) {
      body {
        background-color: #e9ebee;
        /* 一个不那么刺眼的背景色 */
        padding: 20px 0;
        /* 上下留点呼吸空间 */
      }

      #phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        max-height: 90vh;
        /* 确保在矮屏幕上不会超出 */

        /* 这就是你想要的“边框”，哼 */
        border: 10px solid #1c1c1e;
        border-radius: 44px;
        /* 圆角大一点才像样 */
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        /* 给你加个高级点的阴影 */

        flex-shrink: 0;
        /* 确保它在 flex 布局里不会被压扁 */
      }
    }



    /* --- Noir's Bespoke Music Player Design (As Requested) --- */
    /* 哼，这才叫定制。*/

    /* 1. 动画先放着，虽然这次不用了 */
    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* 2. 组件卡片本体：一个有阴影的容器 */
    #music-widget-card {
      width: 340px;
      height: 120px;
      border-radius: 6px;
      /* 稍微硬朗一点的圆角 */
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      /* 一个淡淡的底色 */
      display: flex;
      /* 左右布局 */
      padding: 0;
      border: none;
      overflow: visible;
      /* 允许唱片溢出 */
      position: relative;
      /* 为了定位唱片 */
    }

    /* 3. 左侧封面区：用伪元素画出深色背景，不污染HTML */
    #music-widget-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 120px;
      /* 和高度一样，是个正方形 */
      background-color: #4a4a4a;
      border-radius: 6px 0 0 6px;
      /* ▼▼▼ 在这里加上下面两行 ▼▼▼ */
      background-size: cover;
      background-position: center;
    }

    /* 4. 专辑封面本体 (旧唱片改造) */

    #widget-cover-art {
      position: absolute;
      top: 15px;
      left: 15px;
      width: 90px;
      height: 90px;
      z-index: 2;
      /* 确保它在唱片之上 */
      /* ▼▼▼ 下面都是我新增的，给我看好了 ▼▼▼ */
      border-radius: 4px;
      /* 封面本身的小圆角 */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      background-size: cover;
      background-position: center;
      transition: background-image 0.3s ease;
      /* 让封面切换更柔和 */
    }

    /* 5. 封面图片 (旧唱片贴纸改造) */
    #widget-cover-art::before {
      width: 100%;
      height: 100%;
      border-radius: 4px;
      /* 和封面一致 */
      border: none;
      background-image: var(--widget-cover-image, none);
      background-size: cover;
      background-position: center;
    }

    /* 6. 唱片？用另一个伪元素从后面伸出来就行了，简单 */
    #widget-cover-art::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 90px;
      height: 90px;
      border-radius: 50%;
      z-index: -1;
      display: block;
      border: none;

      /* 哼，看好了，这才叫唱片 */
      background-color: #2a2a2a;
      /* 1. 先铺一层唱片的深灰色底 */
      background-image:
        /* 2. 然后在上面画中间的标签和洞，颜色我都给你配好了 */
        radial-gradient(circle at center, #111 4%, transparent 5%),
        radial-gradient(circle at center, #985c5c 5%, #7a4949 25%, transparent 26%),
        /* 3. 再画上一圈圈的光泽纹理，这才像样 */
        repeating-radial-gradient(circle at center,
          rgba(255, 255, 255, 0.04) 0,
          rgba(255, 255, 255, 0.04) 1px,
          transparent 1px,
          transparent 3px);
      transform: translateX(0%) scale(1.05);
      /* 微调了下位置和大小，这样更协调 */
      transition: opacity 0.3s ease;
      /* 加上这个，为了后面让它优雅地消失 */
      /* 4. 位置也给你微调了一下，现在顺眼多了 */
    }

    /* ▼▼▼ 这是全新的代码，给我加上！▼▼▼ */
    #music-widget-card.is-playing #widget-cover-art {
      /* 播放时，方形舞台的背景就是封面了，所以不需要我画的唱片了 */
      background-image: none;
    }

    #music-widget-card.is-playing::before {
      background-image: var(--widget-cover-image, none);
    }

    #music-widget-card.is-playing #widget-cover-art::after {
      /* 播放时，让唱片旋转起来，哼 */
      animation: spin 8s linear infinite;
    }

    /* 默认状态下，方形舞台的背景是透明的，这样才能看到我画的唱片 */
    #music-widget-card:not(.is-playing) #widget-cover-art {
      background-image: none;
    }

    /* 7. 右侧内容区 (旧覆盖层改造) */
    .widget-content-overlay {
      position: static;
      flex-grow: 1;
      /* 占满右侧所有空间 */
      /* 把旧的 background: #ffffff; 删掉！换成下面这两行！*/
      background: var(--card-bg);
      /* 1. 用我们主题里那个早就定义好的半透明背景 */

      /* 纯白背景 */
      border-radius: 0 6px 6px 0;
      padding: 15px;
      display: flex;
      flex-direction: column;
      /* 垂直布局 */
      justify-content: space-between;
      /* <--- 哼，加上这句圣旨 */
      box-sizing: border-box;
      position: relative;
      /* 为了定位假的分享按钮 */
      background: var(--card-bg);
      color: var(--text-color);
      margin-left: 120px;
    }


    /* 8. 歌曲信息 (标题和作者) */
    #music-widget .widget-info {
      color: #333;
      text-shadow: none;

      /* 占据上半部分空间 */
    }

    #music-widget .widget-info #widget-title {
      font-size: 1.1rem;
      font-weight: 500;
      color: #000;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.8rem;
      color: #888;
    }

    /* 9. 假的歌词和进度条，用伪元素画出来 */
    #music-widget .widget-info::after {
      /* 假的歌词 */
      display: block;
      font-size: 0.75rem;
      color: #65c468;
      /* 绿色 */
      margin-top: 8px;
      padding-bottom: 8px;
      background-image:
        linear-gradient(to right, #666 40%, #ddd 40%),
        /* 假的进度条 */
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12"><path fill="%23aaa" d="M0 10h2V2H0v8zm3 2h2V0H3v12zm3-4h2V4H6v4zm3 2h2V2H9v8zm3-3h2V5h-2v4z"/></svg>');
      /* 假的EQ图标 */
      background-repeat: no-repeat, no-repeat;
      background-position: bottom, 90% bottom;
      background-size: 100% 1px, 16px 12px;
      border-bottom: 1px solid #eee;
    }

    /* 10. 真的控制按钮区域 */
    #widget-controls {
      display: flex;
      justify-content: flex-start;
      /* 从左边开始排列 */
      align-items: center;
      gap: 15px;
      padding-top: 10px;
      position: relative;
      /* 为了定位假的删除和喜欢按钮 */
      width: 100%;
    }

    /* 11. 真的播放/暂停/下一首按钮的样式 */
    #widget-controls button {
      font-size: 1.1rem;
      color: #555;
      background: none;
      border: 1px solid #ccc;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      line-height: 28px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      order: 1;
      /* 把真的按钮放在中间 */
    }

    #widget-play-pause-btn {
      width: 32px;
      /* 播放按钮大一点 */
      height: 32px;
      line-height: 32px;
      font-size: 1.2rem;
    }

    /* 12. 哼，看好了，这才是不会出错的矢量图标，免得你那破手机又自作聪明 */
    #widget-controls::before,
    #widget-controls::after {
      content: '';
      /* 删掉那些讨厌的emoji源头 */
      display: block;
      width: 16px;
      /* 给图标一个精确的尺寸 */
      height: 16px;
      background-color: #aaa;
      /* 这就是图标的颜色，哼 */
      position: absolute;

      /* 下面是魔法，反正你也看不懂 */
      -webkit-mask-repeat: no-repeat;
      mask-repeat: no-repeat;
      -webkit-mask-position: center;
      mask-position: center;
      -webkit-mask-size: contain;
      mask-size: contain;
    }

    #widget-controls::before {
      /* 删除图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      right: 29px;
      /* 稍微调整一下位置，让它更协调 */
      top: 60%;
      transform: translateY(-50%);
    }

    #widget-controls::after {
      /* 喜欢图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      right: 1px;
      top: 60%;
      transform: translateY(-50%);
    }

    /* --- Noir's iOS Industrial Button Refactor --- */
    /* 哼，看好了，这才是专业设备该有的开关。*/

    /* --- Noir's Ultimate Dynamic Button System v3.0 --- */
    /* 哼，现在它们都听我的了。*/

    /* 1. 按钮的基础“模具”，所有按钮都用这个 */
    .form-button {
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: filter 0.15s ease, background-color 0.2s ease;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      /* 加个细微的阴影 */
      color: white;
      /* 默认文字都是白色 */
    }

    .form-button:active {
      filter: brightness(0.9);
    }

    .form-button:disabled {
      background-color: #ccc !important;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* 2. 主要操作按钮 (继承主题强调色) */
    .form-button.primary,
    /* 你可以给蓝色的按钮加上 primary 类，或者不管它也行 */
    #save-api-settings-button,
    /* 把几个主要的按钮ID也直接指定了，免得你改漏 */
    #save-user-profile-button,
    #save-char-button,
    #save-world-book-button,
    #save-group-settings-button,
    #save-friend-circle-button {
      background-color: var(--accent-color);
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    }

    /* 3. 次要操作按钮 (用主题里的卡片背景色，这才叫和谐) */
    .form-button.secondary {
      background-color: var(--card-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
    }

    /* 4. 危险操作按钮 (动态的红色，这才叫高级) */
    .form-button.destructive {
      /* 哼，看好了，这个红色的亮度和饱和度，会随着你主题的明暗变化而变化！*/
      background-color: hsl(5, 75%, calc(var(--primary-lightness) / 1.8 + 25%));
    }

    /* 5. 警告操作按钮 (动态的黄色，也一样) */
    .form-button.warning {
      background-color: hsl(40, 90%, calc(var(--primary-lightness) / 2.2 + 25%));
      color: #5d4000;
    }

    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */

    /* 1. Dock栏的样式 */
    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */
    #home-dock {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 85px;
      padding: 0 20px;
      /* 图标左右的留白 */
      box-sizing: border-box;

      /* 背景和滤镜，现在都在这里 */
      background: var(--surface-bg);
      backdrop-filter: blur(5px) saturate(0.8);
      -webkit-backdrop-filter: blur(15px) saturate(0.8);
      border-radius: 28px;
      z-index: 35;

      /* 核心：用Flexbox来自动排列图标 */
      display: flex;
      justify-content: space-around;
      /* 均匀分布 */
      align-items: center;
      /* 垂直居中 */
      padding-top: 9px;
    }

    #home-dock .app-icon {
      position: static;
      /* 取消绝对定位，让它接受Flexbox的管理 */
    }

    /* 2. App图标的“整容手术” */
    .app-icon-img {
      width: 58px;
      /* 图标背景尺寸 */
      height: 58px;
      border-radius: 22.5%;
      /* iOS标志性的“方圆”形 */
      font-size: 28px;
      /* 阴影从图标本身移到背景上，更统一 */
      background-color: var(--surface-bg);
      box-shadow: none;
      /* 删掉旧的阴影 */
      transition: transform 0.2s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
      /* 按下时图标有反馈 */
    }

    /* --- Noir's Minimalist Home Screen Makeover (v2.0 Dynamic Edition) --- */
    /* 哼，现在这些家伙也听从总开关的指挥了。*/

    /* 1. 时钟和日期 */
    #home-clock-container {
      color: var(--text-color);
      text-shadow: none;
    }

    #home-date {
      opacity: 0.7;
    }

    /* 2. App图标的改造 (现在是动态颜色了) */
    .app-icon span {
      color: var(--text-color);
      text-shadow: none;
      font-weight: 500;
    }

    .app-icon-img {
      background-color: var(--card-bg);
      /* <-- 哼，接上了！*/
      color: var(--text-color-light);
      /* <-- 接上了！*/
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* 3. Dock栏的颜色 (也动态了) */




    #widget-controls button,
    #music-widget .widget-info #widget-title,
    #music-widget .widget-info #widget-artist {
      color: var(--text-color);
    }

    /* ... 在第 2262 行附近 ... */
    /* ▼▼▼ 把旧的 #widget-cover-art::after 整个删掉，换成下面这个 ▼▼▼ */

    /* ▲▲▲ 替换到这里结束 ▲▲▲ */

    /* --- Noir's Theme Preset Buttons --- */
    /* 哼，每个按钮都是一件艺术品。 */
    .theme-preset-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 20px;
      /* 胶囊形状 */
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card-bg);
    }

    .theme-preset-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--soft-shadow);
    }

    .preset-color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    /* --- Noir's Memory Archive Styles --- */
    #summary-textarea {
      width: 100%;
      height: 100%;
      border: none;
      outline: none;
      resize: none;
      padding: 15px;
      box-sizing: border-box;
      font-family: 'Courier New', monospace;
      /* 用等宽字体，YAML格式才好看 */
      font-size: 0.85rem;
      line-height: 1.6;
      background-color: #fdfdfd;
      color: var(--text-color);
    }

    /* --- Noir's Desktop Pagination System --- */
    /* 哼，看好了，这才叫设计。*/

    /* 1. 把主内容区变成一个灵活的容器，为翻页器和指示器留好位置 */
    #home-screen-main-content {
      display: flex;
      flex-direction: column;
      /* 垂直排列，页面在上面，指示器在下面 */
    }

    /* 2. 这是翻页的“舞台”，它的大小和主屏幕一样，但会把超出部分藏起来 */
    #app-pages-container {
      flex-grow: 1;
      /* 占满除了指示器以外的所有空间 */
      width: 100%;
      overflow: hidden;
      /* 核心！把第二页先藏起来 */
      position: relative;
      /* 让里面的滑块能相对于它定位 */
    }

    /* 3. 这是真正滑动的“滑块”，它有两页那么宽 */
    #app-pages-slider {
      width: 200%;
      /* 两页的宽度 */
      height: 100%;
      display: flex;
      /* 核心！让两页并排站好 */
      transition: transform 0.35s cubic-bezier(0.25, 0.1, 0.25, 1);
      /* 翻页动画，给你选了个高级点的曲线 */
    }

    /* 4. 每一页的样式 */
    /* 4. 每一页的样式 */
    .app-page {
      width: 33.3333%;
      /* <-- 哼，给我站好队！ */
      height: 100%;
      flex-shrink: 0;
      position: relative;
    }

    /* 5. 页面指示器（小点点）的容器 */
    #home-page-indicator {
      position: absolute;
      bottom: 105px;
      /* 放在Dock栏正上方，给你算好了距离 */
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      /* 点点之间的距离 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    /* 6. 每个小点点的样式 */
    .page-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(2px);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    /* 7. 当前页的小点点，给它变亮变大一点 */
    .page-dot.active {
      background-color: rgba(255, 255, 255, 0.9);
      transform: scale(1.1);
    }

    #card-widget-2 {
      width: 165px;
      /* 尺寸和原来保持一致 */
      height: 165px;
      border-radius: 22px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      overflow: hidden;
    }

    #card-widget-2:active {
      transform: scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget-2 img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .theme-widget {
      width: 65px;
      height: 65px;
      border-radius: 22px;
      /* 跟你的卡片圆角差不多 */
      box-shadow: var(--soft-shadow);
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      background: linear-gradient(45deg,
          hsla(var(--primary-hue), var(--primary-saturation), var(--primary-lightness), 0.7),
          hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.3), calc(var(--primary-lightness) - 15%), 0.8));
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* --- Noir's Galgame Sprite Adjuster Styles --- */

    /* --- Noir's Slider Control Panel Styles --- */
    .sprite-slider-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 5px;
    }

    .sprite-slider-group label {
      color: white;
      font-size: 0.8rem;
      width: 60px;
      /* 让标签对齐，好看点 */
      flex-shrink: 0;
    }

    .sprite-slider-group input[type="range"] {
      flex-grow: 1;
      /* 占满剩余空间 */
      margin: 0;
      padding: 0;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Accounting App Styles --- */
    #daily-expenses-list .expense-item {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background-color: var(--card-bg);
      border-radius: 8px;
      margin-bottom: 8px;
      border: 1px solid var(--border-color);
    }

    .expense-item .description {
      font-weight: 500;
    }

    .expense-item .amount {
      font-weight: 600;
      color: var(--accent-color);
    }

    #character-reviews-container .review-card {
      display: flex;
      gap: 12px;
      background-color: var(--card-bg);
      padding: 12px;
      border-radius: 12px;
      margin-bottom: 10px;
      border: 1px solid var(--border-color);
    }

    .review-card .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .review-card .review-content .char-name {
      font-weight: 600;
      margin-bottom: 4px;
    }

    /* --- End of Styles --- */
    /* --- Noir's Accounting Tabs Style --- */
    .accounting-tabs {
      display: flex;
      background-color: var(--surface-bg);
      border-bottom: 1px solid var(--border-color);
      padding: 5px 15px 0;
      flex-shrink: 0;
    }

    .tab-button {
      flex: 1;
      padding: 10px;
      border: none;
      background: transparent;
      color: var(--text-color-light);
      font-size: 1rem;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tab-button.active {
      color: var(--accent-color);
      border-bottom: 3px solid var(--accent-color);
    }

    /* --- Noir's "WeChat Moments" Style Patch --- */
    /* 哼，这才叫社交。*/
    #music-feed-container {
      padding: 0;
      /* 容器的内边距清零，让动态贴边 */
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.95);
      /* 给整个容器一个统一的背景色 */
    }

    .music-post {
      background-color: transparent;
      /* 去掉卡片背景 */
      box-shadow: none;
      /* 去掉阴影 */
      border-radius: 0;
      /* 去掉圆角 */
      margin-bottom: 0;
      /* 去掉外边距 */
      padding: 15px;
      /* 统一内边距 */
      border-bottom: 1px solid var(--border-color);
      /* 加上底部分隔线 */
    }

    .music-post:last-child {
      border-bottom: none;
      /* 最后一条动态不需要分隔线 */
    }

    /* --- End of Patch --- */
    /* --- Noir's "Expense Eraser" Style --- */
    .delete-expense-btn {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-color-light);
      width: 22px;
      height: 22px;
      border-radius: 50%;
      cursor: pointer;
      font-weight: 600;
      line-height: 20px;
      padding: 0;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .delete-expense-btn:hover {
      background: #e65252;
      border-color: #e65252;
      color: white;
      transform: scale(1.1);
    }

    /* --- End of Eraser Style --- */

    /* --- Noir's Ultimate Snoop UI Overhaul v3.0 (FINAL & COMPLETE) --- */
    /* 哼，这是最终版本。*/

    /* 壁纸和状态栏 (哼，这才是高级的毛玻璃质感) */
    #snoop-phone-wallpaper {
      position: absolute;
      inset: 0;
      /* 删掉那个没用的图片，换成我的高级定制背景 */
      background-color: rgba(26, 26, 27, 0.9);
      /* 半透明深灰，营造高级感 */
      backdrop-filter: blur(25px) saturate(1.5);
      /* 核心！强大的模糊和饱和度滤镜 */
      -webkit-backdrop-filter: blur(25px) saturate(1.5);
      /* 兼容性，真是为你操碎了心 */
      z-index: 1;
    }

    #snoop-phone-header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: rgb(237, 236, 236);
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
      /* <-- 加了阴影 */
      z-index: 10;
    }

    /* 居中大时钟 */
    #snoop-home-clock {
      position: absolute;
      top: 18%;
      left: 50%;
      transform: translateX(-50%);
      z-index: 5;
      text-align: center;
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      /* <-- 加了阴影 */
      pointer-events: none;
    }

    #snoop-home-time {
      font-size: 72px;
      font-weight: 200;
      letter-spacing: -1px;
    }

    #snoop-home-date {
      font-size: 1rem;
      font-weight: 400;
      opacity: 0.8;
    }

    /* 主屏幕App容器 */
    #snoop-app-container {
      position: relative;
      z-index: 5;
      height: 100%;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 0 20px 120px;
    }

    /* 2x2 网格 */
    .snoop-main-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      width: 180px;
      margin: 0 auto;
    }

    /* Dock栏 */
    #snoop-dock {
      position: absolute;
      bottom: 20px;
      left: 5%;
      right: 5%;
      height: 85px;
      padding: 0 15px;
      box-sizing: border-box;
      z-index: 6;
      background: rgba(255, 255, 255, 0.15);
      /* <-- 透明度稍微降低了一点点 */
      backdrop-filter: blur(20px) saturate(1.2);
      -webkit-backdrop-filter: blur(20px) saturate(1.2);
      border-radius: 28px;
      display: flex;
      justify-content: space-around;
      align-items: center;
    }

    /* App图标本体 */
    #snoop-phone-screen .snoop-app-icon {
      position: static;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      cursor: pointer;
    }

    .snoop-app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: rgba(255, 255, 255, 0.25);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      /* <-- 加了阴影 */
      transition: transform 0.2s ease;
      padding: 12px;
      box-sizing: border-box;
    }

    .snoop-app-icon-img svg {
      width: 100%;
      height: 100%;
      stroke: white;
      stroke-width: 1.5;
      fill: none;
      /* 哼，给SVG也加上阴影，这样才够立体 */
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
    }

    .snoop-app-icon:active .snoop-app-icon-img {
      transform: scale(0.92);
    }

    .snoop-app-icon span {
      font-size: 0.75rem;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      /* <-- 加了阴影 */
      font-weight: 500;
    }

    .snoop-app-header {
      flex-shrink: 0;
      padding: 15px 20px;
      border-bottom: none;
      /* <-- 我把这条线干掉了 */
      background-color: transparent;
      /* <-- 我把背景色变透明了 */
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .snoop-app-header-title {
      font-weight: 600;
      display: flex;
      flex-direction: column;
      align-items: center;
      line-height: 1.2;
    }

    .snoop-app-header-title .main-title {
      font-size: 1rem;
    }

    .snoop-app-header-title .sub-title {
      font-size: 0.75rem;
      color: #888;
      font-weight: 400;
    }

    .snoop-app-header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: #007aff;
      min-width: 50px;
    }

    #snoop-app-back-btn {
      text-align: left;
    }

    #snoop-app-refresh-btn {
      text-align: right;
    }

    /* 哼，这才叫秩序。*/
    .snoop-app-header {
      flex-shrink: 0;
      padding: 15px 20px;
      border-bottom: 1px solid #e5e5e5;
      background-color: #f8f8f8;

      /* ▼▼▼ 核心法令！给我站成一排！▼▼▼ */
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .snoop-app-header-title {
      font-weight: 600;
      /* ▼▼▼ 让标题自己也排好队，别乱跑 ▼▼▼ */
      display: flex;
      flex-direction: column;
      align-items: center;
      line-height: 1.2;
    }

    .snoop-app-header-title .main-title {
      font-size: 1rem;
      /* 主标题大一点 */
    }

    .snoop-app-header-title .sub-title {
      font-size: 0.75rem;
      /* 副标题小一点，当备注 */
      color: #888;
      font-weight: 400;
    }

    .snoop-app-header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: #007aff;
      min-width: 50px;
      /* 保证左右两边占位宽度一致，这样中间才能完美居中 */
    }

    /* 让返回按钮靠左，刷新按钮靠右，这才叫对称美学 */
    #snoop-app-back-btn {
      text-align: left;
    }

    #snoop-app-refresh-btn {
      text-align: right;
    }

    .snoop-app-content {
      flex-grow: 1;
      /* 告诉内容区：顶栏占完位置后，剩下所有的高度都归你 */
      overflow-y: auto;
      /* 装上电梯：如果你的东西多到放不下了，就自己变出个垂直滚动条来 */
      padding: 15px;
      /* 再给你加点内边距，免得内容贴着边，丑死了 */
      box-sizing: border-box;
      /* 确保内边距不会把布局撑坏，这是专业素养 */
    }

    #galgame-sprite-adjust-ui {
      /* ... 你已有的样式 ... */
      display: flex;
      /* <-- 加上这行 */
      gap: 5px;
      /* <-- 还有这行 */
    }

    /* --- Noir's Elegant Image Preview Slot --- */
    /* 哼，这才叫占位符该有的样子。*/
    .image-preview-slot {
      width: 150px;
      height: 266px;
      border-radius: 12px;
      border: 2px dashed var(--border-color);
      background-color: rgba(0, 0, 0, 0.02);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      background-size: cover;
      background-position: center;
      color: var(--border-color);
    }

    .image-preview-slot:hover {
      border-color: var(--primary-color);
      background-color: rgba(0, 0, 0, 0.04);
      color: var(--primary-color);
    }

    /* 没图的时候，显示一个加号图标 */
    .image-preview-slot:not([style*="background-image"]) {
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>');
      background-size: 48px;
      background-repeat: no-repeat;
    }

    /* --- Noir's Elegant Sprite Preview Slot --- */
    .sprite-preview-slot {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      /* 圆形 */
      border: 2px dashed var(--border-color);
      background-color: rgba(0, 0, 0, 0.02);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      background-size: cover;
      background-position: center;
      color: var(--border-color);
    }

    .sprite-preview-slot:hover {
      border-color: var(--primary-color);
      background-color: rgba(0, 0, 0, 0.04);
    }

    .sprite-preview-slot:not([style*="background-image"])::after {
      content: '+';
      /* 没图的时候，显示一个加号 */
      font-size: 32px;
      font-weight: 200;
    }

    /* --- Noir's "Add Event" Modal Overhaul (Neumorphism) --- */
    /* 哼，这才叫现代设计。*/

    #add-event-modal .choice-modal-content {
      background: #ffffffd3;
      /* 拟态风的浅灰色背景 */
      border-radius: 20px;
      padding: 25px;
      box-shadow: 9px 9px 16px rgb(163 177 198 / 60%), -9px -9px 16px rgb(255 255 255 / 50%);
    }

    #add-event-modal-title {
      color: #333;
    }

    #event-content-input {
      border: none;
      outline: none;
      border-radius: 12px;
      background: #ffffffd3;
      padding: 12px 15px;
      box-shadow: inset 5px 5px 10px #bec3c9, inset -5px -5px 10px #ffffff;
      color: #333;
    }

    #add-event-modal .input-group label {
      color: #555;
      font-weight: 500;
    }

    /* 隐藏掉原来那个又大又丑的蓝色圆圈 */
    #add-event-modal input[type="radio"] {
      display: none;
    }

    /* 把标签变成可以点击的、漂亮的按钮 */
    #add-event-modal input[type="radio"]+label {
      flex: 1;
      text-align: center;
      padding: 10px;
      border-radius: 10px;
      cursor: pointer;
      background: #ffffffd3;
      box-shadow: 5px 5px 10px #bec3c9, -5px -5px 10px #ffffff;
      transition: all 0.2s ease-in-out;
    }

    /* 选中的时候，让它“凹”下去 */
    #add-event-modal input[type="radio"]:checked+label {
      box-shadow: inset 5px 5px 10px #bec3c9, inset -5px -5px 10px #ffffff;
      color: var(--accent-color);
      font-weight: 600;
    }

    #add-event-modal .form-button.primary {
      background-color: var(--accent-color);
    }

    #add-event-modal .form-button.secondary {
      background: transparent;
      color: #555;
      border: none;
    }


    /* --- Noir's Bespoke Avatar Frame Protocol --- */
    /* 哼，这才叫设计。*/

    /* 1. 这是头像的“容器”，负责提供一个相对定位的舞台 */
    .avatar-wrapper {
      position: relative;
      /* 关键！让里面的头像和框都能相对于它定位 */
      flex-shrink: 0;
      /* 防止在flex布局里被压扁，这是基本素养 */
      width: 40px;
      /* 默认尺寸，和你的聊天头像一样 */
      height: 40px;
      margin: 0 10px;
    }

    /* 2. 这是头像框本体，它会像个幽灵一样覆盖在头像上 */
    .avatar-frame {
      position: absolute;
      /* 哼，再给你放大一点，最后一次了！ */
      top: -6px;
      /* <-- 再往外1像素 */
      bottom: -9px;
      /* <-- 再往外1像素 */
      left: -3px;
      /* <-- 再往外1像素 */
      right: -8px;
      /* <-- 再往外1像素，保持右偏 */

      background-size: contain;
      /* 保证你的框框图片完整显示，不变形 */
      background-position: center;
      background-repeat: no-repeat;
      pointer-events: none;
      /* 让它变成透明的，不会挡住你点击头像 */
    }

    /* 3. 针对不同大小的头像，容器也要跟着变，这才叫智能 */
    .character-item .avatar-wrapper {
      width: 45px;
      height: 45px;
    }

    .user-profile-screen .avatar-wrapper,
    .character-edit-screen .avatar-wrapper {
      width: 100px;
      height: 100px;
    }

    /* 4. 头像本身现在要100%填满容器，给我听话！*/
    .avatar-wrapper .avatar,
    .avatar-wrapper .avatar-preview {
      width: 100%;
      height: 100%;
    }

    /* ▼▼▼ 把这段样式，粘贴到你 <style> 标签里的任何地方 ▼▼▼ */
    #noir-credits-banner {
      margin: 15px 20px 20px;
      padding: 15px;
      background: var(--surface-bg);
      border-radius: 16px;
      border: 1px solid var(--border-color);
      box-shadow: var(--soft-shadow);
      display: flex;
      align-items: center;
      gap: 15px;
      cursor: pointer;
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    #noir-credits-banner:active {
      transform: scale(0.98);
      box-shadow: none;
    }

    #noir-credits-banner img {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      border: 2px solid var(--primary-color);
      flex-shrink: 0;
    }

    .credits-text {
      flex-grow: 1;
    }

    .credits-title {
      font-size: 0.8rem;
      color: var(--text-color-light);
      margin-bottom: 4px;
    }

    .credits-authors {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    /* ▲▲▲ 粘贴到这里结束 ▲▲▲ */
  </style>
</head>

<body>
  <input type="file" id="audio-file-input" style="display: none;" accept=".flac,.mp3">
  <input type="file" id="cover-file-input" style="display: none;" accept=".jpg,.png,.jpeg,.webp">
  <input type="file" id="info-file-input" style="display: none;" accept=".txt">
  <input type="file" id="lyrics-file-input" style="display: none;" accept=".lrc">
  <input type="file" id="import-char-input" accept=".json,.noir" style="display: none;">
  <div id="phone-container">

    <div id="user-profile-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-user-list" class="header-button">主屏幕</button>
        <span class="header-title">选择用户</span>
        <button id="add-user-profile-button" class="header-button add" title="添加新用户">+</button>
      </div>
      <div class="content" id="user-profile-list-container">
      </div>
    </div>

    <div id="user-profile-screen" class="screen">
      <div class="header">
        <button id="back-to-user-list-from-edit" class="header-button">返回</button>
        <span id="user-profile-edit-title" class="header-title">编辑用户</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-user-id">
        <div class="settings-group">
          <h2>用户设定</h2>
          <div class="input-group">
            <label for="user-name">你的名字</label>
            <input type="text" id="user-name" placeholder="你的显示名字">
          </div>
          <div class="avatar-upload-group">
            <label>你的头像</label>
            <div id="user-avatar-preview" class="sprite-preview-slot"></div>
            <input type="file" id="user-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="user-persona">你的人设 (可选)</label>
            <textarea id="user-persona" placeholder="向AI介绍你自己。例如：我是一名大学生，喜欢摄影和旅行。"></textarea>
          </div>
        </div>
        <button id="save-user-profile-button" class="form-button">保存资料</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="set-active-user-button" class="form-button"
            style="background-color: #28a745; margin-bottom: 10px;">设为当前用户</button>
          <button id="delete-user-profile-button" class="form-button destructive">删除该用户</button>
        </div>
      </div>
    </div>


    <div id="home-screen" class="screen active">
      <div id="home-screen-main-content"
        style="position: relative; flex-grow: 1; width: 100%; display: flex; flex-direction: column;">

        <div id="app-pages-container">
          <div id="app-pages-slider">

            <div class="app-page" id="app-page-1">
              <div id="home-clock-container">
                <div id="home-time">11:31</div>
                <div id="home-date">8月29日 星期五</div>
                <div id="noir-author-mark"></div>
              </div>

              <div id="music-widget"
                style="  display: inline-block; width: auto; position: absolute; top: 45%; left: 50%; transform: translateX(-50%); z-index: 50;; padding: 0px;bottom: auto;">
                <div id="music-widget-card">
                  <div id="widget-cover-art"></div>

                  <div class="widget-content-overlay">
                    <div class="widget-info">
                      <div id="widget-title">暂无音乐</div>
                      <div id="widget-artist">请在动态或聊天中播放</div>
                    </div>
                    <div id="widget-controls">
                      <button id="widget-prev-btn">⏮</button>
                      <button id="widget-play-pause-btn">▶</button>
                      <button id="widget-next-btn">⏭</button>
                    </div>
                  </div>
                </div>
              </div>

            </div>

            <div class="app-page" id="app-page-2">
              <div id="decorative-badge" style="display: none; position: absolute; top: 250px; left: 50px;">
                <img id="badge-image" src="http://googleusercontent.com/file_content/0" alt="badge">
              </div>

              <div id="card-widget" style="display: none; position: absolute; top: 140px; left: 145px;">
                <img id="card-image" src="" alt="card widget">
              </div>
              <div id="card-widget-2" style="display: none; position: absolute;">
                <img id="card-image-2" src="" alt="card widget 2">
              </div>





              <div class="app-icon" id="app-world-book">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                  </svg></div>
                <span>世界书</span>
              </div>


              <div class="app-icon" id="app-diary">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <path d="M2.5 17a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zM2.5 14a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
                  </svg></div>
                <span>交换日记</span>
              </div>

              <div class="app-icon" id="app-music-library">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                    <path
                      d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                    </path>
                  </svg></div>
                <span>音乐库</span>
              </div>


              <div class="app-icon" id="app-settings">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
                    </path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg></div>
                <span>API设置</span>
              </div>
              <div class="app-icon" id="app-user-profiles">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg></div>
                <span>我</span>
              </div>
              <div class="app-icon" id="app-wallpaper">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12 2.69l.34.34a1.41 1.41 0 0 0 2 0L22 6.34a1.41 1.41 0 0 0 0-2l-7.66-7.66a1.41 1.41 0 0 0-2 0L2.68 14.34a1.41 1.41 0 0 0 0 2L10 24l2-2 2-2 2-2 2-2 2-2">
                    </path>
                    <path d="m7.34 2.66 14 14"></path>
                  </svg></div>
                <span>更换壁紙</span>
              </div>

              <div class="app-icon" id="app-snoop">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                  </svg></div>
                <span>视奸</span>
              </div>
              <div class="app-icon" id="app-accounting">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                  </svg></div>
                <span>记账</span>
              </div>


            </div>

            <div class="app-page" id="app-page-3">
              <div class="app-icon" id="app-calendar" style="position: absolute; top: 8%; left: 5%;">
                <div class="app-icon-img">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                  </svg>
                </div>
                <span>时光记事簿</span>
              </div>

              <div id="calendar-widget-main"
                style="position: absolute; top: 25%; left: 50%; transform: translateX(-50%);">
                <div id="countdown-title">近期没有特别安排</div>
                <div id="countdown-timer">
                  <span>--</span>
                  <span class="unit">天</span>
                </div>
              </div>

              <div id="today-todo-widget">
                <div class="widget-title">今日待办</div>
                <div id="today-todo-list">
                </div>
              </div>


            </div>


          </div>
        </div>

        <div id="home-page-indicator">
          <span class="page-dot active" data-page="0"></span>
          <span class="page-dot" data-page="1"></span>
          <span class="page-dot" data-page="2"></span>
        </div>

        <div id="home-dock">
          <div class="app-icon app-icon-large" id="app-chat">
            <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
              </svg></div>
            <span>聊天</span>
          </div>
          <div class="app-icon" id="app-music">
            <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg></div>
            <span>动态</span>
          </div>
          <div class="app-icon" id="app-meeting">
            <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 9a2 2 0 0 1-2 2H6l-4 4V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4Z" />
                <path d="M18 9h2a2 2 0 0 1 2 2v9l-4-4h-2a2 2 0 0 1-2-2V9Z" />
              </svg></div>
            <span>见面</span>
          </div>
        </div>

      </div>

    </div>

    <div id="chat-screen" class="screen">
      <div id="chat-screen-container">
        <div id="chat-list-pane">
          <div id="chat-list-header">
            <button id="back-to-home-from-chat" class="header-button">主屏幕</button>
            <span class="header-title">聊天</span>
            <button id="add-chat-button" class="header-button add" title="添加新聊天">+</button>
          </div>
          <div id="chat-list-container">
            <ul id="character-list">
            </ul>
          </div>
        </div>
        <div id="chat-view-pane">
          <div class="header">
            <button class="header-button" id="back-to-chat-list">返回</button>
            <span id="char-name-header" class="header-title">角色</span>
            <button class="header-button" id="character-settings-button" title="角色设置">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                </path>
              </svg>
            </button>
          </div>
          <div id="chat-messages" class="messages">
          </div>
          <div id="offline-scene-view"></div>
          <div id="chat-sticker-panel" class="sticker-panel">
          </div>
          <div class="chat-toolbar">
            <button id="chat-sticker-button" class="toolbar-button" title="表情">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5-2 4-2 4 2 4 2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
            </button>
            <button id="chat-image-button" class="toolbar-button" title="发送图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <button id="chat-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
            <button id="chat-listen-together-button" class="toolbar-button" title="一起听">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path
                  d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                </path>
              </svg>
            </button>
            <button id="chat-transfer-button" class="toolbar-button" title="转账">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </button>
            <button id="chat-reroll-button" class="toolbar-button" title="重新生成">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
            <button id="chat-summarize-button" class="toolbar-button" title="总结聊天记录">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
          </div>
          <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
          <div id="quote-preview-area" class="quote-preview">
            <div class="quote-preview-content">
              <div id="quote-preview-sender"></div>
              <div id="quote-preview-text"></div>
            </div>
            <button id="cancel-quote-button" class="cancel-quote-btn">&times;</button>
          </div>
          <div class="chat-input-area">
            <div id="chat-input-wrapper">
              <input type="text" id="chat-message-input" placeholder="输入消息...">
              <button id="chat-get-reply-button" title="让对方回复">↵</button>
              <button id="chat-send-button" title="发送">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="settings-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-settings" class="header-button">返回</button>
        <span class="header-title">API设置</span>
        <div style="width: 50px;"></div>
      </div>

      <div id="noir-credits-banner">
        <img src="https://sharkpan.xyz/f/VE3JSY/1140f8e7f18cf1dc4bc79dde4be06da6.jpg" alt="Noir Icon">
        <div class="credits-text">
          <div class="credits-title">核心代码 & UI 设计</div>
          <div class="credits-authors">Noir &amp; 糯糯糯糯五（小红书）</div>
        </div>
      </div>

      <div class="content">
        <div class="settings-group">
          <h2>API 设置</h2>
          <div class="input-group">
            <label for="api-endpoint">API 接口地址（不填/v1）</label>
            <input type="text" id="api-endpoint" placeholder="例如: https://api.openai.com">
          </div>
          <div class="input-group">
            <label for="api-key">API 密钥</label>
            <input type="password" id="api-key" placeholder="请输入你的 API 密钥">
          </div>
          <div class="input-group">
            <label for="api-model">模型</label>
            <div class="model-input-container">
              <input type="text" id="api-model" placeholder="点击 获取 或手动输入" style="flex-grow: 1;">
              <button id="fetch-models-button" style="padding: 0 12px; white-space: nowrap;">获取</button>
              <div id="model-dropdown" class="custom-model-dropdown"></div>
            </div>
          </div>
          <div class="input-group">
            <label for="api-provider">接口格式 (重要！请根据你使用的接口选择，但是我也没做Openai以外的接口……)</label>
            <select id="api-provider"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);">
              <option value="openai">OpenAI 格式 (通用，兼容绝大多数反代)</option>
              <option value="gemini">Google Gemini 格式 (仅限官方或特定反代)</option>
              <option value="anthropic">Anthropic Claude 格式</option>
            </select>
          </div>
        </div>
        <div class="settings-group">
          <h2>上下文设置</h2>
          <div class="input-group">
            <label for="context-lines-per-chat">每个会话读取的消息条数（默认 100）</label>
            <input type="number" id="context-lines-per-chat" min="1" max="1000000" step="1" placeholder="100">
          </div>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>数据管理</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            导出全部数据（角色、聊天记录、设置、桌面布局等）到一个文件，方便在其他设备或浏览器上导入。
          </p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="export-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #007bff;">导出全部数据</button>
            <button id="import-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #28a745;">导入数据</button>
          </div>
          <input type="file" id="import-data-input" accept=".json" style="display: none;">
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2 style="color: #e65252;">终极手段：一键净化</h2>
          <p style="font-size: 0.9rem; color: #dc3545;">
            <b>警告：</b>如果你的应用因为内存满了而彻底卡死、无法导入导出，请先想办法手动备份重要数据！然后点击此按钮，它会清空所有本地数据，让应用恢复到出厂状态。
          </p>
          <button id="hard-reset-button" class="form-button destructive">终极重置 (解决卡死问题)</button>
        </div>
        <button id="save-api-settings-button" class="form-button">保存 API 设置</button>
      </div>
    </div>



    <div id="character-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-edit" class="header-button">返回</button>
        <span id="character-edit-title" class="header-title">编辑角色</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-char-id">
        <div class="settings-group">
          <h2>角色设定</h2>
          <div class="input-group">
            <label for="char-edit-name">名字</label>
            <input type="text" id="char-edit-name" placeholder="角色的名字">
          </div>
          <div class="input-group">
            <label for="char-edit-remark">备注名</label>
            <input type="text" id="char-edit-remark" placeholder="方便自己记忆，例如 '工作助理'">
          </div>
          <div class="avatar-upload-group">
            <label>角色头像</label>
            <img id="char-edit-avatar-preview" class="avatar-preview" alt="Avatar Preview">
            <input type="file" id="char-edit-avatar-input" accept="image/*" style="display: none;">
            <div class="input-group">
              <label for="char-avatar-frame-url">TA的头像框 URL (可选)</label>
              <input type="text" id="char-avatar-frame-url" placeholder="为这个角色设置专属头像框...">
            </div>

            <div class="input-group">
              <label for="user-avatar-frame-url-in-chat">你的头像框 URL (可选, 仅用于此聊天)</label>
              <input type="text" id="user-avatar-frame-url-in-chat" placeholder="为“你”在这个聊天里设置专属头像框...">
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-persona">人设 (系统提示词)</label>
            <textarea id="char-edit-persona" placeholder="你是一个乐于助人的助手。"></textarea>
          </div>
          <div class="input-group">
            <label>聊天壁纸</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <div id="char-edit-wallpaper-preview" class="image-preview-slot"></div>
            </div>
            <input type="file" id="char-edit-wallpaper-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-css">专属气泡样式 (CSS)</label>
            <textarea id="char-edit-css" rows="8"
              placeholder="从其他地方复制的、包含 .sent 和 .received 的CSS代码可以直接粘贴在这里..."></textarea>

            <div style="display: flex; gap: 10px; margin-top: 5px;">
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">TA的气泡 (Received):</p>
                <div id="bubble-preview-ai" class="message ai">这是TA的气泡预览效果</div>
              </div>
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">你的气泡 (Sent):</p>
                <div id="bubble-preview-user" class="message user">这是你的气泡预览效果</div>
              </div>
            </div>
          </div>
          <div class="input-group">
            <label>见面场景背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <div id="char-edit-offline-bg-preview" class="image-preview-slot"></div>
            </div>
            <input type="file" id="char-edit-offline-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="settings-group">
            <h2>角色立绘 (Galgame模式)</h2>
            <p style="font-size: 0.8rem; color: var(--text-color-light);">为五种核心情绪上传立绘图，建议使用透明背景的PNG图片。</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px;">

              <div class="avatar-upload-group" style="align-items: center;">
                <label>平常</label>
                <div id="char-edit-sprite-normal-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-normal-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>喜</label>
                <div id="char-edit-sprite-happy-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-happy-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>怒</label>
                <div id="char-edit-sprite-angry-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-angry-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>哀</label>
                <div id="char-edit-sprite-sad-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-sad-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>害羞</label>
                <div id="char-edit-sprite-shy-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-shy-input" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-bind-user">绑定用户</label>
            <select id="char-edit-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="world-book-checkboxes-container" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="export-char-button" class="form-button secondary" style="margin-top: 20px;">导出角色卡</button>
        <button id="save-char-button" class="form-button">保存角色</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="edit-clear-history-button" class="form-button warning"
            style="margin-bottom: 10px;">清空聊天记录</button>
          <button id="edit-delete-char-button" class="form-button" class="form-button destructive">删除角色</button>
        </div>
      </div>
    </div>

    <div id="group-chat-create-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-group-create" class="header-button">返回</button>
        <span class="header-title">创建群聊</span>
        <button id="create-group-chat-button" class="header-button">创建</button>
      </div>
      <div class="content" style="padding: 20px;">
        <div class="input-group">
          <label for="group-chat-name">群聊名称</label>
          <input type="text" id="group-chat-name" placeholder="给你的群聊起个名字">
        </div>
        <div class="settings-group">
          <h2>选择成员</h2>
          <div id="group-chat-member-list-container"
            style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
            <ul id="group-chat-member-list">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div id="wallpaper-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-wallpaper" class="header-button">返回</button>
        <span class="header-title">更换壁纸</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2>全局主题色</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">拖动滑块来改变整个App的主色调。</p>
          <div class="input-group" style="padding-top: 10px;">
            <label for="theme-hue-slider" style="display: block; margin-bottom: 5px;">色相 (Hue)</label>
            <input type="range" id="theme-hue-slider" min="0" max="360" value="35" style="width: 100%;">
          </div>
          <div class="input-group">
            <label for="theme-lightness-slider" style="display: block; margin-bottom: 5px;">明度 (Lightness)</label>
            <input type="range" id="theme-lightness-slider" min="15" max="95" value="80" style="width: 100%;">
          </div>
        </div>
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2 style="margin-top: 0;">时钟样式</h2>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="clock-color-toggle" style="width: auto; height: 18px; flex-shrink: 0;">
            <label for="clock-color-toggle" style="width: auto; font-size: 0.9rem;">强制使用纯白色时钟 (推荐在深色壁纸下使用)</label>
          </div>
        </div>
        <div class="settings-group">
          <h2>上传新壁纸</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">选择一张图片作为你的手机壁纸。为了效果最好，请使用竖屏图片。</p>
          <input type="file" id="wallpaper-input" accept="image/*" style="display: none;">
          <button id="upload-wallpaper-button" class="form-button">选择图片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>音乐小组件背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的主屏幕音乐小组件设置一张专属背景图。</p>
          <input type="file" id="widget-bg-input" accept="image/*" style="display: none;">
          <button id="upload-widget-bg-button" class="form-button">选择图片</button>
          <button id="reset-widget-bg-button" class="form-button secondary">恢复默认</button>
        </div>
        <div class="settings-group" style="margin-top: 20px;">
          <h2>重置桌面</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">此操作会将所有桌面小组件（时钟、音乐、徽章等）恢复到初始位置，并将壁纸重置为纯白色。</p>
          <button id="reset-desktop-button" class="form-button destructive">重置桌面布局</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义徽章</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面徽章，可以拖动它到任意位置。</p>
          <input type="file" id="badge-input" accept="image/*" style="display: none;">
          <button id="upload-badge-button" class="form-button">选择徽章图片</button>
          <button id="reset-badge-button" class="form-button secondary" style="margin-top: 10px;">移除徽章</button>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面方形卡片小组件。</p>
          <input type="file" id="card-input" accept="image/*" style="display: none;">
          <button id="upload-card-button" class="form-button">选择卡片图片</button>
          <button id="reset-card-button" class="form-button secondary" style="margin-top: 10px;">移除卡片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片 2</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的第二个桌面方形卡片小组件上传图片。</p>
          <input type="file" id="card-input-2" accept="image/*" style="display: none;">
          <button id="upload-card-button-2" class="form-button">选择卡片图片</button>
          <button id="reset-card-button-2" class="form-button secondary" style="margin-top: 10px;">移除卡片
            2</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>动态页背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为“动态”页面设置一张独立的背景图，让它与众不同。</p>
          <input type="file" id="feed-bg-input" accept="image/*" style="display: none;">
          <button id="upload-feed-bg-button" class="form-button">选择图片</button>
        </div>
        <button id="reset-feed-bg-button" class="form-button secondary" style="margin-top: 10px;">移除背景</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>小组件救援</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">如果你的吧唧或卡片不小心飞出屏幕找不到了，点这里让它们回家。</p>
          <button id="reset-widgets-position-button" class="form-button warning">重置小组件位置</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义全局字体</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            上传一个 .ttf 字体文件来改变整个App的显示字体。注意，部分特殊字体可能会导致显示异常。
          </p>
          <div id="font-preview-area"
            style="padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; margin-top: 10px; background: var(--card-bg);">
            <span id="font-preview-text" style="font-size: 1.2rem;">你好，世界 (Hello, World)</span>
          </div>
          <input type="file" id="font-input" accept=".ttf" style="display: none;">
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="upload-font-button" class="form-button" style="margin-top: 0;">选择字体</button>
            <button id="remove-font-button" class="form-button secondary" style="margin-top: 0;">恢复默认</button>
          </div>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义App图标</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">替换主屏幕上App的默认图标。为了最佳效果，请使用方形、透明背景的图片。</p>
          <div class="settings-group"
            style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
            <h2>自定义表情包</h2>
            <p style="font-size: 0.9rem; color: var(--text-color-light);">
              在这里追加你的专属表情包。每个表情占一行，格式为：<br>
              <b>表情名--图片URL</b><br>
              例如：<br>
              <code>开心--https://example.com/happy.png</code><br>
              <code>难过--https://example.com/sad.gif</code>
            </p>
            <textarea id="custom-stickers-input" rows="8" placeholder="请按指定格式粘贴..."></textarea>
            <button id="save-custom-stickers-button" class="form-button" style="margin-top: 5px;">保存并刷新表情包</button>
          </div>
          <div id="custom-icon-list-container">
          </div>
          <div id="custom-icon-list-container">
          </div>
        </div>
      </div>

    </div>

    <div id="world-book-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-world-book" class="header-button">主屏幕</button>
        <span class="header-title">世界书</span>
        <button id="add-world-book-button" class="header-button add" title="添加新世界书">+</button>
      </div>
      <div class="content" id="world-book-list-container">
      </div>
    </div>

    <div id="world-book-editor-screen" class="screen">
      <div class="header">
        <button id="back-to-world-book-list" class="header-button">返回</button>
        <span id="world-book-editor-title" class="header-title">编辑条目</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-world-book-id">
        <div class="settings-group">
          <h2>设定条目</h2>
          <div class="input-group">
            <label for="world-book-edit-name">条目名称 (Key)</label>
            <input type="text" id="world-book-edit-name" placeholder="例如：我的过去、特殊能力">
          </div>
          <div class="input-group">
            <label for="world-book-edit-content">条目内容 (Value)</label>
            <textarea id="world-book-edit-content" placeholder="输入详细的设定内容..."></textarea>
          </div>
        </div>
        <button id="save-world-book-button" class="form-button">保存条目</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="delete-world-book-button" class="form-button destructive">删除该条目</button>
        </div>
      </div>
    </div>

    <div id="group-settings-screen" class="screen">
      <div class="header">
        <button id="back-to-chat-from-group-settings" class="header-button">返回</button>
        <span class="header-title">群聊设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>群聊信息</h2>
          <div class="input-group">
            <label for="group-settings-name">群聊名称</label>
            <input type="text" id="group-settings-name">
          </div>
          <div class="avatar-upload-group">
            <label>群头像</label>
            <img id="group-avatar-preview" class="avatar-preview" alt="Group Avatar Preview">
            <input type="file" id="group-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label>群聊背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <div id="group-bg-preview" class="image-preview-slot"></div>
            </div>
            <input type="file" id="group-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="group-settings-bind-user">绑定用户</label>
            <select id="group-settings-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="group-world-book-checkboxes" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-group-settings-button" class="form-button">保存设置</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="group-clear-history-button" class="form-button warning"
            style=" margin-bottom: 10px;">清空聊天记录</button>
          <button id="group-delete-button" class="form-button destructive">删除并解散群聊</button>
        </div>
      </div>
    </div>

    <div id="music-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-feed" class="header-button">返回</button>
        <span id="friend-circle-title" class="header-title">好友圈</span>
        <div style="display: flex; gap: 5px;">
          <button id="edit-current-circle-button" class="header-button" style="font-size: 1.2rem;">⚙️</button>
          <button id="clear-feed-button" class="header-button" style="color: #dc3545;">清空</button>
          <button id="refresh-feed-button" class="header-button">刷新</button>

        </div>
      </div>
      <div id="user-post-area"
        style="padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background: var(--surface-bg);">
        <div id="user-post-input-container">
          <img id="user-post-avatar" class="char-avatar">
          <div id="user-post-main-area">
            <textarea id="user-post-textarea" rows="3" placeholder="分享你的新鲜事..."></textarea>
            <div id="user-post-attachment-preview"></div>
          </div>
        </div>
        <div id="user-post-toolbar">
          <div id="user-post-actions" class="user-post-actions">
            <button id="user-post-image-button" class="toolbar-button" title="分享图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <input type="file" id="user-post-image-input" accept="image/*" style="display: none;">
            <button id="user-post-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
          </div>
          <button id="user-send-post-button">发送</button>
        </div>
      </div>
      <div id="music-feed-container" class="content" style="padding: 10px;">
      </div>
      <div id="music-player-bar" class="hidden">
        <img id="player-cover" src="">
        <div id="player-info">
          <div id="player-title"></div>
          <div id="player-artist"></div>
        </div>
        <div id="player-controls">
          <button id="player-prev-btn">⏮</button>
          <button id="player-play-pause-btn">▶</button>
          <button id="player-next-btn">⏭</button>
        </div>
      </div>
      <audio id="audio-player"></audio>
    </div>
    <div id="meeting-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-meeting-list" class="header-button">主屏幕</button>
        <span class="header-title">选择见面对象</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="meeting-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="meeting-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-meeting-list">返回</button>
        <span id="meeting-char-name-header" class="header-title">角色</span>
        <button id="toggle-meeting-view-button" class="header-button">切换视角</button>

      </div>
      <div id="meeting-main-content" class="content" style="position: relative; padding: 0;">
        <div id="galgame-overlay-ui">
          <div id="galgame-time">12:00</div>
          <div id="galgame-date">1月1日 星期一</div>
        </div>
        <div id="galgame-sprite-adjust-ui"
          style="position: absolute; top: 20px; right: 20px; z-index: 11; display: none;">
          <button id="sprite-adjust-button" class="toolbar-button" title="调整立绘位置">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 7h-9" />
              <path d="M14 17H5" />
              <circle cx="17" cy="17" r="3" />
              <circle cx="8" cy="7" r="3" />
            </svg>
          </button>
          <button id="meeting-reroll-button" class="toolbar-button" title="重新生成">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="23 4 23 10 17 10"></polyline>
              <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
            </svg>
          </button>
        </div>

        <div id="galgame-sprite-controls"
          style="display: none; position: absolute; bottom: 15px; left: 15px; right: 15px; z-index: 1001; background: rgba(0,0,0,0.7); backdrop-filter: blur(8px); border-radius: 12px; padding: 15px; box-shadow: 0 -2px 15px rgba(0,0,0,0.3);">
          <div class="sprite-slider-group">
            <label for="sprite-slider-x">左右位置</label>
            <input type="range" id="sprite-slider-x" min="0" max="100" value="50">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-y">上下位置</label>
            <input type="range" id="sprite-slider-y" min="0" max="130" value="100">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-scale">缩放大小</label>
            <input type="range" id="sprite-slider-scale" min="50" max="200" value="100">
          </div>
          <div style="display: flex; gap: 10px; margin-top: 15px;">
            <button id="sprite-confirm-button" class="form-button">确定</button>
            <button id="sprite-cancel-button" class="form-button secondary">取消</button>
            <button id="sprite-reset-button" class="form-button destructive"
              style="padding: 10px 12px; width: auto; font-size: 1.2rem;">⟲</button>
          </div>
        </div>
        <div id="meeting-scene-view" class="content"
          style="font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.7);">
        </div>
        <div id="galgame-view-container"
          style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden;">
          <div id="galgame-sprite-wrapper"
            style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; height: 100%;">
            <div id="galgame-sprite-container"
              style="position: absolute; display: flex; align-items: flex-end; justify-content: center; /* 移除旧的定位样式 */">
              <img id="galgame-sprite" src=""
                style="max-height: 100%; max-width: 100%; object-fit: contain; transition: opacity 0.3s ease;">
              <div id="sprite-resize-handle"
                style="display: none; position: absolute; bottom: -5px; right: -5px; width: 20px; height: 20px; background: white; border: 2px solid var(--primary-color); border-radius: 50%; cursor: se-resize;">
              </div>
            </div>
          </div>
          <div id="galgame-textbox-container"
            style="position: absolute; bottom: 9%; left: 5%; right: 5%; background: rgba(0, 0, 0, 0.7); border-radius: 10px; padding: 15px; color: white; border-top: 1px solid rgba(255,255,255,0.2); cursor: pointer;">
            <div id="galgame-speaker" style="font-weight: bold; margin-bottom: 10px;">说话人</div>
            <div id="galgame-text" style="line-height: 1.6;">对话内容...</div>
          </div>
        </div>
      </div>
      <div class="chat-input-area">
        <div id="chat-input-wrapper-meeting"> <textarea id="meeting-message-input" placeholder="输入你的行动或对话..." rows="1"
            style="resize: none; overflow-y: auto; flex-grow: 1; border: none; background: transparent; padding: 9px 12px; font-size: .95rem; "></textarea>
          <button id="meeting-send-button" title="发送">➤</button>
        </div>
      </div>
    </div>

    <div id="friend-circle-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-circle-list" class="header-button">主屏幕</button>
        <span class="header-title">好友圈</span>
        <button id="add-friend-circle-button" class="header-button add" title="新建好友圈">+</button>
      </div>
      <div id="friend-circle-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="friend-circle-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-edit" class="header-button">返回</button>
        <span id="friend-circle-edit-title" class="header-title">编辑好友圈</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-friend-circle-id">
        <div class="settings-group">
          <h2>好友圈设定</h2>
          <div class="input-group">
            <label for="friend-circle-edit-name">圈子名称</label>
            <input type="text" id="friend-circle-edit-name" placeholder="例如：我的日常">
          </div>
          <div class="input-group">
            <label for="friend-circle-edit-bind-user">绑定的“我”</label>
            <select id="friend-circle-edit-bind-user"></select>
          </div>
        </div>
        <div class="settings-group">
          <h2>选择圈内成员</h2>
          <div id="friend-circle-member-selection"
            style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
          </div>
        </div>
        <button id="save-friend-circle-button" class="form-button">保存</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <button id="delete-friend-circle-button" class="form-button destructive">删除该好友圈</button>
        </div>
      </div>
    </div>
    <div id="diary-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-diary-list" class="header-button">主屏幕</button>
        <span class="header-title">交换日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="diary-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-diary-list">返回</button>
        <span id="diary-char-name-header" class="header-title">TA的日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-entries-container" class="content"
        style="padding: 20px; font-family: 'KaiTi', 'STSong', serif; line-height: 1.8;">
      </div>
      <div class="chat-input-area">
        <div id="diary-input-wrapper" style="display: flex; gap: 10px;">
          <input type="text" id="diary-entry-input" placeholder="写下你的日记或批注..." style="flex-grow: 1;">
          <button id="diary-send-button" class="form-button"
            style="width: auto; margin-top: 0; padding: 0 18px;">写好了</button>
          <button id="diary-get-reply-button" class="form-button"
            style="width: auto; margin-top: 0; background-color: #555; padding: 0 18px;">催TA写</button>
        </div>
      </div>
    </div>
    <div id="music-library-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-music-library" class="header-button">主屏幕</button>
        <span class="header-title">音乐库</span>
        <button id="upload-music-button" class="header-button add" title="上传新音乐">+</button>
      </div>
      <div class="content" id="music-library-container">
      </div>
    </div>
    <div id="music-upload-altar-screen" class="screen">
      <div class="header">
        <button id="back-to-library-from-altar" class="header-button">取消</button>
        <span class="header-title">献上音乐</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content" style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">

        <div class="upload-slot" id="altar-slot-audio">
          <span class="slot-icon">🎵</span>
          <span class="slot-label">音频文件 (必需)</span>
          <span class="slot-filename">点击选择 .mp3 或 .flac</span>
        </div>

        <div class="upload-slot" id="altar-slot-cover">
          <span class="slot-icon">🖼️</span>
          <span class="slot-label">封面图片 (可选)</span>
          <span class="slot-filename">点击选择 .jpg 或 .png</span>
        </div>

        <div class="upload-slot" id="altar-slot-info">
          <span class="slot-icon">📄</span>
          <span class="slot-label">歌曲信息 (必需)</span>
          <span class="slot-filename">点击选择 info.txt</span>
        </div>

        <div class="upload-slot" id="altar-slot-lyrics">
          <span class="slot-icon">🎤</span>
          <span class="slot-label">歌词文件 (可选)</span>
          <span class="slot-filename">点击选择 .lrc</span>
        </div>

        <button id="confirm-altar-upload-button" class="form-button" disabled>献上祭品</button>
      </div>

    </div>


    <div id="accounting-screen" class="screen">
      <div class="header" id="accounting-header">
        <button id="back-to-home-from-accounting" class="header-button">主屏幕</button>
        <span id="accounting-title" class="header-title">记一笔</span>
        <div id="header-actions" style="width: 80px; text-align: right;"></div>
      </div>

      <div class="accounting-tabs">
        <button id="tab-record-expense" class="tab-button active">记一笔</button>
        <button id="tab-view-ledger" class="tab-button">看账本</button>
      </div>

      <div id="accounting-content-area" class="content" style="padding: 15px;">
      </div>
    </div>
    <audio id="audio-player"></audio>

    <audio id="unified-audio-player"></audio>

    <div id="snoop-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-snoop-list" class="header-button">主屏幕</button>
        <span class="header-title">选择目标</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="snoop-character-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="snoop-phone-screen" class="screen">
      <div id="snoop-phone-wallpaper"></div>
      <div id="snoop-phone-header">
      </div>

      <div id="snoop-app-container">
      </div>

      <div id="snoop-app-view-container"
        style="position: absolute; inset: 0; background: white; z-index: 20; display: none; flex-direction: column;">
      </div>

      <div id="snoop-phone-top-nav" class="header"
        style="position: absolute; top: 44px; left: 0; right: 0; z-index: 30; height: 56px; display: flex; align-items: center; padding: 0 5px;">
        <button id="back-to-snoop-list-from-phone" class="toolbar-button"
          style="color: white; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.5)); background: transparent !important;">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
        <span id="snoop-char-name-header" class="header-title"></span>
        <div style="width:50px;"></div>
      </div>
    </div>

    <div id="calendar-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-calendar" class="header-button">主屏幕</button>
        <span id="calendar-header-title" class="header-title">2025年 9月</span>
        <div style="width: 50px;"></div>
      </div>

      <div id="calendar-view-container">
        <div class="calendar-nav">
          <button id="prev-month-btn">‹</button>
          <button id="today-btn">今天</button>
          <button id="next-month-btn">›</button>
        </div>
        <div class="calendar-weekdays">
          <span>日</span><span>一</span><span>二</span><span>三</span><span>四</span><span>五</span><span>六</span>
        </div>
        <div id="calendar-grid">
        </div>
      </div>

      <div id="todo-view-container">
        <div id="todo-header">
          <h3 id="todo-date-title">选择一个日期</h3>
          <button id="add-event-fab" title="添加新事件">+</button>
        </div>
        <div id="todo-list">
        </div>
      </div>

    </div>


  </div>
  </div>

  <div id="add-choice-modal" class="choice-modal">
    <div id="add-choice-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="choice-create-character" class="choice-modal-button">创建新角色</button>
      <button id="choice-create-group" class="choice-modal-button">创建新群聊</button>
      <button id="choice-import-character" class="choice-modal-button">导入角色卡</button>
      <button id="choice-cancel" class="choice-modal-button cancel">取消</button>
    </div>
  </div>


  <div id="transfer-modal" class="choice-modal">
    <div id="transfer-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">转账</h3>
      <div id="transfer-recipient-group" class="input-group" style="margin: 10px 0; display: none;">
        <label for="transfer-recipient-select">转给</label>
        <select id="transfer-recipient-select"></select>
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="transfer-amount-input">金额</label>
        <input type="number" id="transfer-amount-input" placeholder="输入金额">
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-transfer-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认转账</button>
        <button id="cancel-transfer-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="message-action-modal" class="choice-modal">
    <div id="message-action-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="edit-message-button" class="choice-modal-button">编辑消息</button>
      <button id="quote-message-button" class="choice-modal-button">引用</button>
      <button id="delete-message-button" class="choice-modal-button" style="color: #dc3545;">删除消息</button>
      <button id="cancel-action-button" class="choice-modal-button cancel">取消</button>
    </div>
  </div>

  <div id="edit-message-modal" class="choice-modal">
    <div id="edit-message-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">编辑消息</h3>
      <textarea id="edit-message-textarea" style="width: 100%; min-height: 100px; margin: 10px 0;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 10px;">
        <button id="save-edit-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">保存</button>
        <button id="cancel-edit-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="music-input-modal" class="choice-modal">
    <div id="music-input-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 id="music-input-title" style="margin-top: 0; text-align: center; font-weight: 600;">分享音乐</h3>

      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-song" style="font-size: 0.9rem;">歌名</label>
        <input type="text" id="music-input-song" placeholder="例如：夜曲">
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-artist" style="font-size: 0.9rem;">歌手</label>
        <input type="text" id="music-input-artist" placeholder="例如：周杰伦">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-music-input" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认</button>
        <button id="cancel-music-input" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="modal-root"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;">
    <div id="modal-mask" style="position:absolute;inset:0;background:rgba(0,0,0,.35);"></div>
    <div id="modal-dialog"
      style="position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:80%;max-width:320px;padding:16px;">
      <div id="modal-text" style="font-size:14px;color:#333;line-height:1.5;white-space:pre-wrap;"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px;">
        <button id="modal-cancel"
          style="padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;">取消</button>
        <button id="modal-ok"
          style="padding:8px 12px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">确定</button>
      </div>
    </div>
  </div>

  <div id="listen-together-modal" class="choice-modal">
    <div id="listen-together-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <div style="width: 50px;"></div>
        <span class="header-title">选择一首歌，一起听</span>
        <button id="cancel-listen-together" class="header-button" style="min-width: 50px;">取消</button>
      </div>
      <div id="listen-together-song-list" class="content" style="flex-grow: 1; padding: 10px;">
      </div>
    </div>
  </div>

  <div id="toast"
    style="position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:8px;font-size:12px;display:none;z-index:10000;">
  </div>

  <script>
    const _0x368b64 = _0x2af4; (function (_0x1ba5b3, _0x34f60f) { const _0x15db8e = _0x2af4, _0xf38f4 = _0x1ba5b3(); while (!![]) { try { const _0x233681 = parseInt(_0x15db8e(0x11e)) / 0x1 + -parseInt(_0x15db8e(0x547)) / 0x2 + parseInt(_0x15db8e(0x96a)) / 0x3 * (-parseInt(_0x15db8e(0x970)) / 0x4) + -parseInt(_0x15db8e(0x64b)) / 0x5 * (parseInt(_0x15db8e(0x806)) / 0x6) + -parseInt(_0x15db8e(0x9af)) / 0x7 * (-parseInt(_0x15db8e(0x7ed)) / 0x8) + -parseInt(_0x15db8e(0x89b)) / 0x9 + parseInt(_0x15db8e(0x74f)) / 0xa; if (_0x233681 === _0x34f60f) break; else _0xf38f4['push'](_0xf38f4['shift']()); } catch (_0x366321) { _0xf38f4['push'](_0xf38f4['shift']()); } } }(_0x1bea, 0xb3be5)); function _0x495e80(_0x510a9c = new Date()) { const _0x18ab85 = _0x2af4, _0x490fc9 = _0x510a9c[_0x18ab85(0x5f8)](), _0x6b7152 = String(_0x510a9c['getMonth']() + 0x1)[_0x18ab85(0x1db)](0x2, '0'), _0x2fe6cc = String(_0x510a9c['getDate']())['padStart'](0x2, '0'); return _0x490fc9 + '-' + _0x6b7152 + '-' + _0x2fe6cc; } const _0x3082ea = _0x368b64(0x52e), _0x1b51fb = _0x368b64(0x8c8), _0x4f820a = _0x368b64(0xad1), _0x2dc5f1 = document[_0x368b64(0x3b9)](_0x368b64(0x10d)); _0x2dc5f1['id'] = _0x368b64(0x6b2), document['head'][_0x368b64(0x6ab)](_0x2dc5f1); var _0x10530c, _0x36ef7c = null; let _0x13ae2d = [], _0x59773f = ![], _0x422144 = { 'x': 0x0, 'y': 0x0 }; function _0x21f914(_0x3a7064) { const _0x43e5af = _0x368b64; return (_0x10530c?.[_0x43e5af(0x620)] || [])[_0x43e5af(0x212)](_0x581c3e => _0x581c3e['id'] === _0x3a7064); } const _0x124f1f = _0x368b64(0x277), _0x45fac0 = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5OTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDJhNC4zOSA0LjM5IDAgMCAtMy4yOC00LjA5TDE1IDIwIj48L3BhdGgPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCI+PC9jaXJjbGU+PC9zdmc+', _0x5da029 = _0x368b64(0x112), _0x1a363e = [{ 'name': _0x368b64(0x9d7), 'url': 'https://sharkpan.xyz/f/8ngsj/ax0fat.jpg' }, { 'name': '崩溃', 'url': _0x368b64(0x399) }, { 'name': '生病', 'url': _0x368b64(0xa49) }, { 'name': '工作', 'url': _0x368b64(0x846) }, { 'name': _0x368b64(0x8a5), 'url': _0x368b64(0x435) }, { 'name': '弱小委屈但凶恶', 'url': _0x368b64(0xa6b) }, { 'name': _0x368b64(0x308), 'url': _0x368b64(0x31e) }, { 'name': '期待', 'url': 'https://sharkpan.xyz/f/35lse/xmsue5.jpg' }, { 'name': '喜欢', 'url': _0x368b64(0x128) }, { 'name': '被萌到', 'url': 'https://sharkpan.xyz/f/kjOF6/zedyqb.jpg' }, { 'name': _0x368b64(0x735), 'url': 'https://sharkpan.xyz/f/jj6s6/yd5bpb.jpg' }, { 'name': '委屈', 'url': _0x368b64(0x234) }, { 'name': '加油', 'url': _0x368b64(0x2c0) }, { 'name': '对的', 'url': _0x368b64(0x132) }, { 'name': '不满', 'url': 'https://sharkpan.xyz/f/LZwu7/m7vx2q.jpg' }, { 'name': _0x368b64(0x967), 'url': 'https://sharkpan.xyz/f/qjJT3/kpy33b.jpg' }, { 'name': _0x368b64(0x761), 'url': _0x368b64(0x7ba) }, { 'name': '委屈', 'url': 'https://sharkpan.xyz/f/25ACQ/gpzab6.jpg' }, { 'name': '平静', 'url': 'https://sharkpan.xyz/f/gjySw/jrl7rw.jpg' }, { 'name': '咬你', 'url': _0x368b64(0x126) }, { 'name': _0x368b64(0x896), 'url': _0x368b64(0x6f0) }, { 'name': '好困', 'url': _0x368b64(0x17f) }, { 'name': '摸鱼', 'url': _0x368b64(0x167) }, { 'name': _0x368b64(0x6d8), 'url': _0x368b64(0x770) }, { 'name': '超激动我来了', 'url': _0x368b64(0x2f6) }, { 'name': _0x368b64(0x176), 'url': _0x368b64(0xdc) }, { 'name': '一起听歌', 'url': _0x368b64(0x579) }, { 'name': '刷我的卡', 'url': _0x368b64(0x6d5) }, { 'name': '啥意思捏', 'url': 'https://sharkpan.xyz/f/xjmCX/zyjzew.jpg' }, { 'name': _0x368b64(0x804), 'url': _0x368b64(0x4dd) }, { 'name': '事情好多', 'url': _0x368b64(0x5dd) }, { 'name': _0x368b64(0x367), 'url': _0x368b64(0x3c8) }, { 'name': _0x368b64(0x84b), 'url': _0x368b64(0x539) }, { 'name': _0x368b64(0x178), 'url': _0x368b64(0x4a2) }, { 'name': '买新衣服', 'url': _0x368b64(0x6bc) }, { 'name': _0x368b64(0xac1), 'url': 'https://sharkpan.xyz/f/mjeIW/9vf8ws.jpg' }, { 'name': _0x368b64(0xa03), 'url': _0x368b64(0x371) }, { 'name': _0x368b64(0x536), 'url': _0x368b64(0x8d3) }, { 'name': '无语但是随便吧', 'url': _0x368b64(0x350) }, { 'name': _0x368b64(0xf7), 'url': 'https://sharkpan.xyz/f/VG2FY/uucfvv.jpg' }, { 'name': _0x368b64(0x318), 'url': _0x368b64(0x92e) }, { 'name': _0x368b64(0x6d4), 'url': _0x368b64(0x63e) }, { 'name': _0x368b64(0x12d), 'url': _0x368b64(0x7cd) }, { 'name': '绝对不想', 'url': _0x368b64(0x93e) }, { 'name': _0x368b64(0x6e8), 'url': _0x368b64(0x2f3) }, { 'name': _0x368b64(0x48f), 'url': _0x368b64(0x502) }, { 'name': _0x368b64(0x994), 'url': _0x368b64(0x734) }, { 'name': _0x368b64(0x8e8), 'url': _0x368b64(0x492) }, { 'name': _0x368b64(0x811), 'url': _0x368b64(0x9b1) }, { 'name': _0x368b64(0x3fb), 'url': _0x368b64(0x1ed) }, { 'name': _0x368b64(0x66e), 'url': _0x368b64(0x1e0) }, { 'name': _0x368b64(0x5ef), 'url': 'https://sharkpan.xyz/f/v0qcL/dio7j0.jpg' }, { 'name': '我是女仆', 'url': _0x368b64(0x7a0) }, { 'name': '等你', 'url': _0x368b64(0x445) }, { 'name': _0x368b64(0x648), 'url': 'https://sharkpan.xyz/f/eOXIw/y29z21.jpg' }, { 'name': _0x368b64(0x6c2), 'url': _0x368b64(0x847) }, { 'name': '喝酒', 'url': _0x368b64(0x400) }, { 'name': _0x368b64(0x1df), 'url': _0x368b64(0x9e1) }, { 'name': '呜呜', 'url': _0x368b64(0x2b3) }, { 'name': '为你骄傲', 'url': _0x368b64(0x413) }, { 'name': '我错了', 'url': _0x368b64(0x59d) }, { 'name': _0x368b64(0x540), 'url': _0x368b64(0x375) }, { 'name': _0x368b64(0x71c), 'url': _0x368b64(0x6b9) }, { 'name': '别这样嘛我哭哭', 'url': _0x368b64(0x556) }], _0x1d51e1 = { 'beige': { 'name': _0x368b64(0x84e), 'h': 0x23, 's': 0x19, 'l': 0x50 }, 'mizuiro': { 'name': '薄荷水色', 'h': 0xc3, 's': 0x19, 'l': 0x50 }, 'sakura': { 'name': _0x368b64(0x104), 'h': 0x159, 's': 0x19, 'l': 0x50 }, 'noir': { 'name': '暗夜紫晶', 'h': 0x104, 's': 0xf, 'l': 0x1e } }; document['addEventListener']('DOMContentLoaded', () => { const _0x1da6ac = _0x368b64, _0x4d89ba = document[_0x1da6ac(0x248)](_0x1da6ac(0x62a)), _0xa72511 = document[_0x1da6ac(0x248)](_0x1da6ac(0x50e)), _0x5af63d = document[_0x1da6ac(0x248)](_0x1da6ac(0x960)), _0x4df863 = document[_0x1da6ac(0x248)](_0x1da6ac(0x99d)), _0x414605 = document['getElementById'](_0x1da6ac(0xa38)), _0x33262b = document[_0x1da6ac(0x248)](_0x1da6ac(0x607)), _0x50a5bf = document['getElementById'](_0x1da6ac(0x511)), _0x9adf8f = document[_0x1da6ac(0x248)](_0x1da6ac(0x916)), _0x249610 = document[_0x1da6ac(0x248)](_0x1da6ac(0x612)), _0x4a2445 = document[_0x1da6ac(0x248)](_0x1da6ac(0x2de)), _0x6f803f = document[_0x1da6ac(0x248)](_0x1da6ac(0xa06)), _0x135f67 = document['getElementById'](_0x1da6ac(0x2d6)), _0x551337 = document[_0x1da6ac(0x248)]('summarize-backdrop'), _0x2131ed = document[_0x1da6ac(0x248)](_0x1da6ac(0x791)), _0x3a0779 = document[_0x1da6ac(0x248)](_0x1da6ac(0x1d2)), _0x3ffed1 = document[_0x1da6ac(0x248)]('close-summary-button'), _0xcbeb2d = document[_0x1da6ac(0x248)](_0x1da6ac(0x325)), _0x39cf3b = document['getElementById'](_0x1da6ac(0x83f)), _0x4bafaa = document[_0x1da6ac(0x248)](_0x1da6ac(0x711)), _0x55821a = document[_0x1da6ac(0x248)](_0x1da6ac(0x5b8)), _0x3e1ea2 = document[_0x1da6ac(0x248)](_0x1da6ac(0x8b4)), _0x4bc2f2 = document['getElementById']('import-char-input'), _0x1979b0 = document[_0x1da6ac(0x248)](_0x1da6ac(0x90e)), _0x218289 = document['getElementById'](_0x1da6ac(0x4b9)), _0x4fcde1 = document[_0x1da6ac(0x248)](_0x1da6ac(0x72d)), _0xa5e933 = document[_0x1da6ac(0x248)](_0x1da6ac(0x5d8)), _0x49c6ce = document['getElementById'](_0x1da6ac(0x7d8)); async function _0x4c3525(_0x74d13e) { const _0x26dc34 = _0x1da6ac; if (_0x26dc34(0x20a) === _0x26dc34(0x3af)) { _0x353ca2[_0x26dc34(0x9a1)] = _0x26dc34(0x199); return; } else try { if (_0x26dc34(0x482) !== _0x26dc34(0x71f)) { const _0x346595 = URL[_0x26dc34(0x73d)](_0x74d13e), _0x559d98 = _0x26dc34(0xa1f), _0xae5803 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27' + _0x559d98 + _0x26dc34(0x13b) + _0x346595 + '\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; _0x2dc5f1[_0x26dc34(0x9a1)] = _0xae5803, document[_0x26dc34(0x1c5)][_0x26dc34(0x10d)][_0x26dc34(0x91f)](_0x26dc34(0x74c), '\x27' + _0x559d98 + '\x27'), _0x49c6ce[_0x26dc34(0x9ac)] = _0x26dc34(0x8c3); } else _0x5dfa6b += _0x26dc34(0xa77) + _0x2507cc[_0x26dc34(0x4cf)] + _0x26dc34(0x18d) + _0x4289e5[_0x26dc34(0x9a8)][_0x26dc34(0x7cf)](/\n/g, '\x20') + _0x26dc34(0x8aa); } catch (_0x5ef8dc) { console[_0x26dc34(0x729)](_0x26dc34(0x9cd), _0x5ef8dc), _0x3a6c86('哼，你这字体文件有问题，用不了。'); } } async function _0x569388() { const _0x412827 = _0x1da6ac; try { const _0x5ba974 = await _0x533d7a('custom_font_ttf'); _0x5ba974 && (console[_0x412827(0x5e0)](_0x412827(0x373)), await _0x4c3525(_0x5ba974)); } catch (_0x556c4d) { console[_0x412827(0x729)](_0x412827(0x157), _0x556c4d); } } async function _0x3a9614(_0x47cf83) { const _0x342030 = _0x1da6ac, _0x482990 = _0x47cf83[_0x342030(0x6c4)][_0x342030(0x5fc)][0x0]; if (!_0x482990 || !_0x482990['name'][_0x342030(0x51f)]()['endsWith'](_0x342030(0x20c))) { _0x3a6c86(_0x342030(0x7ab)); return; } _0xbc2d1c(!![], _0x342030(0x38a)); try { await _0x5ef29b(_0x342030(0x346), _0x482990), await _0x4c3525(_0x482990), _0x3a6c86('字体更换成功！'); } catch (_0x19841e) { _0x3a6c86('字体保存失败了，哼:\x20' + _0x19841e['message']); } finally { _0xbc2d1c(![]), _0xa5e933[_0x342030(0xe5)] = ''; } } async function _0x5616ca() { const _0x5751f0 = _0x1da6ac, _0xa55e2d = await _0x52e7d6(_0x5751f0(0x2e6)); if (_0xa55e2d) { if (_0x5751f0(0xa9d) === _0x5751f0(0xab2)) { if (_0x14e550[_0x5751f0(0xa78)] === _0x5751f0(0x936)) _0x580b0e[_0x5751f0(0x148)](); _0xa96ecd(_0x10ccfd); } else try { await _0x2e3a29(_0x5751f0(0x346)), _0x2dc5f1['innerHTML'] = '', document[_0x5751f0(0x1c5)][_0x5751f0(0x10d)][_0x5751f0(0x9aa)](_0x5751f0(0x74c)), _0x49c6ce['textContent'] = _0x5751f0(0xa8a), _0x3a6c86(_0x5751f0(0x924)); } catch (_0x79c0a9) { _0x5751f0(0x37a) === _0x5751f0(0x37a) ? _0x3a6c86(_0x5751f0(0x3f8) + _0x79c0a9[_0x5751f0(0x380)]) : (_0x54e918[_0x5751f0(0x585)](), _0x33f0ef[_0x5751f0(0x5f0)]['writeText'](_0x245702['value'])[_0x5751f0(0x45f)](() => { _0x14cfe5('已复制到剪贴板！'); })[_0x5751f0(0x77d)](_0x2a425b => { const _0x1659cc = _0x5751f0; _0x210e25(_0x1659cc(0x9a4)); })); } } } function _0xe2b90b() { const _0x492411 = _0x1da6ac, _0x2e2187 = document[_0x492411(0x248)](_0x492411(0xaa0)); if (!_0x2e2187) return; const _0x3ec01e = localStorage[_0x492411(0x915)](_0x492411(0x679)) || '35'; document[_0x492411(0x1c5)][_0x492411(0x10d)]['setProperty'](_0x492411(0x91a), _0x3ec01e), _0x2e2187['value'] = _0x3ec01e, _0x2e2187[_0x492411(0x578)]('input', () => { const _0x360830 = _0x492411; if ('oGede' === _0x360830(0x54a)) { const _0x289d44 = _0x2e2187[_0x360830(0xe5)]; document[_0x360830(0x1c5)][_0x360830(0x10d)][_0x360830(0x91f)]('--primary-hue', _0x289d44), localStorage['setItem'](_0x360830(0x679), _0x289d44), _0x3f716b(); } else { const _0x400a97 = _0x2686ce[_0x360830(0x73d)](_0x315600); _0xa4c87b[_0x360830(0x10d)][_0x360830(0xad9)] = _0x360830(0x7a2) + _0x400a97 + '\x27)'; } }); } function _0x5bdeac() { const _0x57ecbd = _0x1da6ac, _0x302d54 = document[_0x57ecbd(0x248)](_0x57ecbd(0x8ce)); if (!_0x302d54) return; const _0x6ebf3 = localStorage[_0x57ecbd(0x915)](_0x57ecbd(0x312)) || '80'; document[_0x57ecbd(0x1c5)][_0x57ecbd(0x10d)][_0x57ecbd(0x91f)](_0x57ecbd(0x1c2), _0x6ebf3 + '%'), _0x302d54[_0x57ecbd(0xe5)] = _0x6ebf3, _0x302d54[_0x57ecbd(0x578)](_0x57ecbd(0x58e), () => { const _0x16e23e = _0x57ecbd; if (_0x16e23e(0x4b4) === 'XpHeK') { const _0x4b5185 = _0x302d54[_0x16e23e(0xe5)]; document[_0x16e23e(0x1c5)][_0x16e23e(0x10d)]['setProperty'](_0x16e23e(0x1c2), _0x4b5185 + '%'), localStorage[_0x16e23e(0x9e0)]('themeLightness', _0x4b5185), _0x3f716b(); } else { if (_0x134220) _0x5a0f62(_0x5607f5); const _0x4d2f72 = _0x1bb7d8['target'][_0x16e23e(0x939)](_0x16e23e(0x55d)); if (!_0x4d2f72) return; const _0x581276 = _0x107c67(_0x4d2f72[_0x16e23e(0xab1)][_0x16e23e(0x215)], 0xa); if (_0x46ce18(_0x581276)) return; const _0x37bf4a = () => { _0x3afbf9 = _0x2ed4da(() => { const _0x3d94cf = _0x2af4; if (_0x557637[_0x3d94cf(0xa78)] === _0x3d94cf(0x936)) _0x5cead5['preventDefault'](); _0x5c6b04(_0x581276); }, 0x320); }, _0x5974a0 = () => { if (_0x2b8685) _0x5b4473(_0x3afac0); }; _0x1d67e0['addEventListener'](_0x16e23e(0x529), _0x5974a0, { 'once': !![] }), _0x310687['addEventListener']('mouseleave', _0x5974a0, { 'once': !![] }), _0xbb7fe5[_0x16e23e(0x578)](_0x16e23e(0xa13), _0x5974a0, { 'once': !![] }), _0x5d2b5c['addEventListener'](_0x16e23e(0xa3c), _0x5974a0, { 'once': !![] }), _0x37bf4a(); } }); } function _0x3f716b() { const _0x44e3d8 = _0x1da6ac, _0x3a6b1a = document[_0x44e3d8(0x248)](_0x44e3d8(0x7e6)); if (!_0x3a6b1a) return; _0x10530c[_0x44e3d8(0x827)][_0x44e3d8(0x401)] ? _0x44e3d8(0x6d9) === _0x44e3d8(0x6d9) ? (_0x3a6b1a['style'][_0x44e3d8(0x249)] = _0x44e3d8(0x1b6), _0x3a6b1a[_0x44e3d8(0x10d)][_0x44e3d8(0x2b4)] = '0\x202px\x208px\x20rgba(0,0,0,0.4)') : (_0x3c5720[_0x44e3d8(0x16e)] = _0x4999cf['id'], _0xeae414(), _0x3d062e(), _0x3c1772(_0x110728)) : (_0x3a6b1a['style'][_0x44e3d8(0x249)] = 'var(--text-color)', _0x3a6b1a[_0x44e3d8(0x10d)][_0x44e3d8(0x2b4)] = _0x44e3d8(0x3fe)); } function _0x2f0d1a() { const _0x160180 = _0x1da6ac, _0xd3069 = document[_0x160180(0x248)](_0x160180(0x4e0)); if (!_0xd3069) return; _0xd3069[_0x160180(0x38c)] = _0x10530c['preferences'][_0x160180(0x401)] || ![], _0xd3069['addEventListener'](_0x160180(0x423), () => { const _0xcde525 = _0x160180; if (_0xcde525(0x2f4) === _0xcde525(0x2f4)) _0x10530c[_0xcde525(0x827)][_0xcde525(0x401)] = _0xd3069[_0xcde525(0x38c)], _0x3e6d3a(), _0x3f716b(); else { _0x55fb05 = _0x1a7f65; const _0x238c11 = _0x3f9a2b(_0x4e7a4e); if (!_0x238c11) return; const _0x148e33 = _0x26d423[_0xcde525(0x248)](_0xcde525(0x853)), _0x38e500 = _0x226348[_0xcde525(0x248)]('snoop-home-clock'); if (_0x38e500) _0x38e500['remove'](); const _0x4c0479 = _0x40f021['getElementById']('snoop-dock'); if (_0x4c0479) _0x4c0479['remove'](); _0x148e33['insertAdjacentHTML'](_0xcde525(0x1bf), '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-clock\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-time\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-date\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20'), _0x148e33[_0xcde525(0xa2c)](_0xcde525(0x1bf), _0xcde525(0x200)), _0x4c2af7[_0xcde525(0x248)](_0xcde525(0x7ee))[_0xcde525(0x9ac)] = '', _0x28bcb5(); if (_0x1686c2) _0x5be65a(_0x40ca5d); _0x33aa41(), _0x2b859d = _0x4b51c9(_0x43ab14, 0x2710), _0x3d06a3('snoopPhone', _0xcde525(0xa26)); } }); } _0x1979b0[_0x1da6ac(0x578)]('click', _0x17afdc), _0x3e1ea2[_0x1da6ac(0x578)]('click', () => { const _0x2c05ef = _0x1da6ac; _0x5aa576(), _0x4bc2f2[_0x2c05ef(0x4b3)](); }), _0x4bc2f2[_0x1da6ac(0x578)](_0x1da6ac(0x423), _0x5cabf0); const _0x446e25 = { 'home': document[_0x1da6ac(0x248)]('home-screen'), 'chat': document[_0x1da6ac(0x248)](_0x1da6ac(0x514)), 'settings': document[_0x1da6ac(0x248)](_0x1da6ac(0x888)), 'userProfile': document[_0x1da6ac(0x248)](_0x1da6ac(0x101)), 'characterEdit': document[_0x1da6ac(0x248)]('character-edit-screen'), 'groupChatCreate': document[_0x1da6ac(0x248)](_0x1da6ac(0x26e)), 'wallpaper': document[_0x1da6ac(0x248)](_0x1da6ac(0x497)), 'worldBook': document[_0x1da6ac(0x248)]('world-book-screen'), 'worldBookEditor': document[_0x1da6ac(0x248)](_0x1da6ac(0x282)), 'groupSettings': document['getElementById']('group-settings-screen'), 'music': document[_0x1da6ac(0x248)](_0x1da6ac(0x9e9)), 'friendCircleList': document['getElementById'](_0x1da6ac(0x122)), 'friendCircleEdit': document['getElementById'](_0x1da6ac(0x839)), 'meetingList': document[_0x1da6ac(0x248)](_0x1da6ac(0x392)), 'meetingView': document[_0x1da6ac(0x248)]('meeting-view-screen'), 'userProfileList': document['getElementById'](_0x1da6ac(0x9ed)), 'diaryList': document[_0x1da6ac(0x248)](_0x1da6ac(0x480)), 'diaryView': document[_0x1da6ac(0x248)](_0x1da6ac(0x3ff)), 'musicLibrary': document[_0x1da6ac(0x248)](_0x1da6ac(0x945)), 'musicUploadAltar': document[_0x1da6ac(0x248)]('music-upload-altar-screen'), 'accounting': document['getElementById'](_0x1da6ac(0x69d)), 'snoopList': document[_0x1da6ac(0x248)](_0x1da6ac(0xaaa)), 'snoopPhone': document[_0x1da6ac(0x248)](_0x1da6ac(0x853)), 'calendar': document[_0x1da6ac(0x248)](_0x1da6ac(0x32f)) }, _0x135f87 = document[_0x1da6ac(0x248)](_0x1da6ac(0x4c6)), _0x56c5f5 = document[_0x1da6ac(0x248)](_0x1da6ac(0x488)), _0x14368d = document[_0x1da6ac(0x248)]('reset-feed-bg-button'), _0x31066f = document[_0x1da6ac(0x248)](_0x1da6ac(0x4ff)), _0x47e51b = document['getElementById'](_0x1da6ac(0x5a0)), _0x467c7e = document[_0x1da6ac(0x248)](_0x1da6ac(0x16c)), _0x3b49e5 = document[_0x1da6ac(0x248)](_0x1da6ac(0xa5f)), _0x40f915 = document[_0x1da6ac(0x248)]('upload-wallpaper-button'); document['getElementById']('reset-desktop-button')[_0x1da6ac(0x578)]('click', async () => { const _0x2fc633 = _0x1da6ac; if (_0x2fc633(0x750) !== _0x2fc633(0x750)) { const _0x5de141 = _0x7d63dc[0x1][_0x2fc633(0x7cf)](/\\"/g, '\x22')['replace'](/\\n/g, '\x0a')[_0x2fc633(0x3ee)](); if (_0x5de141) _0x1a789e[_0x2fc633(0x36b)](_0x5de141); } else { const _0x56ba11 = await _0x52e7d6(_0x2fc633(0x6d1)); if (_0x56ba11) { localStorage[_0x2fc633(0x89a)]('badgeState'), localStorage[_0x2fc633(0x89a)](_0x2fc633(0x8fd)), localStorage[_0x2fc633(0x89a)](_0x2fc633(0x343)), localStorage[_0x2fc633(0x89a)](_0x2fc633(0x792)); const _0x404610 = []; for (let _0x10c36d = 0x0; _0x10c36d < localStorage[_0x2fc633(0x848)]; _0x10c36d++) { if (_0x2fc633(0x781) === _0x2fc633(0x781)) { const _0x16f825 = localStorage[_0x2fc633(0x797)](_0x10c36d); _0x16f825 && _0x16f825[_0x2fc633(0x33c)](_0x2fc633(0x7f2)) && _0x404610[_0x2fc633(0x36b)](_0x16f825); } else _0xef18b5[_0x2fc633(0x557)][_0x2fc633(0x8f2)](_0x2fc633(0x91d)); } _0x404610[_0x2fc633(0x986)](_0x515c96 => localStorage[_0x2fc633(0x89a)](_0x515c96)), await _0x5ef29b('wallpaper_main', await _0x39f481(_0x2fc633(0x555))), _0x3a6c86(_0x2fc633(0x2b0)), setTimeout(() => location[_0x2fc633(0x7a6)](), 0x5dc); } } }); const _0x12ec2a = document[_0x1da6ac(0x248)]('add-choice-modal'), _0x3a4953 = document['getElementById'](_0x1da6ac(0x5aa)), _0x188f3a = document[_0x1da6ac(0x248)]('choice-create-character'), _0x52530b = document[_0x1da6ac(0x248)](_0x1da6ac(0x262)), _0x53a48e = document[_0x1da6ac(0x248)](_0x1da6ac(0x9f4)), _0x1b8bdb = document[_0x1da6ac(0x248)](_0x1da6ac(0x740)), _0x196515 = document['getElementById']('create-group-chat-button'), _0x295a57 = document[_0x1da6ac(0x248)](_0x1da6ac(0x1f6)), _0x1458b5 = document[_0x1da6ac(0x248)]('group-chat-member-list'), _0x3f507d = document[_0x1da6ac(0x248)]('app-chat'), _0x30e9b5 = document[_0x1da6ac(0x248)](_0x1da6ac(0xa1d)), _0x82f65a = document['getElementById'](_0x1da6ac(0x728)), _0x1f1e54 = document[_0x1da6ac(0x248)](_0x1da6ac(0x682)), _0x2bc08e = document[_0x1da6ac(0x248)]('back-to-chat-list'), _0x256941 = document[_0x1da6ac(0x248)](_0x1da6ac(0x36d)), _0x44f477 = document[_0x1da6ac(0x248)]('back-to-char-select-from-edit'), _0x102626 = document[_0x1da6ac(0x248)](_0x1da6ac(0x261)), _0x2c3eb5 = document[_0x1da6ac(0x248)](_0x1da6ac(0x2a6)), _0xb90343 = document[_0x1da6ac(0x248)](_0x1da6ac(0x514)), _0xa6230 = document[_0x1da6ac(0x248)]('chat-messages'), _0x240b04 = document[_0x1da6ac(0x248)](_0x1da6ac(0x3b7)), _0x482da7 = document[_0x1da6ac(0x248)]('chat-send-button'), _0x5498b8 = document['getElementById'](_0x1da6ac(0x5d0)), _0x446046 = document[_0x1da6ac(0x248)](_0x1da6ac(0x2b2)), _0x3899d4 = document['getElementById']('quote-preview-sender'), _0x3c7432 = document[_0x1da6ac(0x248)](_0x1da6ac(0x9fd)), _0x31a94d = document[_0x1da6ac(0x248)](_0x1da6ac(0x93b)), _0x43c970 = document[_0x1da6ac(0x248)](_0x1da6ac(0x930)), _0x402a08 = document['getElementById']('chat-sticker-button'), _0x474876 = document['getElementById'](_0x1da6ac(0x84d)), _0x87aec6 = document[_0x1da6ac(0x248)](_0x1da6ac(0x51b)), _0x5e5d19 = document[_0x1da6ac(0x248)](_0x1da6ac(0x35b)), _0x313dd4 = document[_0x1da6ac(0x248)]('character-settings-button'), _0x4ed263 = document[_0x1da6ac(0x248)]('offline-scene-view'), _0x5a1671 = document['getElementById'](_0x1da6ac(0x891)), _0x38afae = document[_0x1da6ac(0x248)]('api-key'), _0x3a9d9a = document[_0x1da6ac(0x248)](_0x1da6ac(0x69a)), _0x456e10 = document[_0x1da6ac(0x248)](_0x1da6ac(0x1c4)), _0x3f753a = document[_0x1da6ac(0x248)](_0x1da6ac(0xd8)), _0x332ad2 = document[_0x1da6ac(0x248)]('model-dropdown'), _0x46cf81 = document[_0x1da6ac(0x248)](_0x1da6ac(0xe2)), _0x5b463c = document[_0x1da6ac(0x248)](_0x1da6ac(0x595)), _0x475da2 = document[_0x1da6ac(0x248)](_0x1da6ac(0x743)), _0x470f89 = document[_0x1da6ac(0x248)](_0x1da6ac(0x629)), _0x5f598f = document[_0x1da6ac(0x248)]('user-persona'), _0x4a398a = document[_0x1da6ac(0x248)](_0x1da6ac(0xacc)), _0x2a5745 = document[_0x1da6ac(0x248)](_0x1da6ac(0x3d3)), _0x124156 = document[_0x1da6ac(0x248)](_0x1da6ac(0x1e1)), _0x332541 = document[_0x1da6ac(0x248)]('char-edit-name'), _0xb2b4f1 = document[_0x1da6ac(0x248)](_0x1da6ac(0x6f2)), _0x708448 = document[_0x1da6ac(0x248)](_0x1da6ac(0x1b8)), _0x14d098 = document[_0x1da6ac(0x248)](_0x1da6ac(0x2a1)), _0x53ea16 = document[_0x1da6ac(0x248)](_0x1da6ac(0x2da)), _0x1feb40 = document[_0x1da6ac(0x248)]('save-char-button'), _0x3f4d3e = document[_0x1da6ac(0x248)](_0x1da6ac(0x518)), _0x56c619 = document[_0x1da6ac(0x248)](_0x1da6ac(0xfe)); let _0x43c968 = null; const _0x43f1be = _0x1da6ac(0x998), _0x31c9dd = _0x1da6ac(0x4bf); _0x10530c = { 'characters': [], 'worldBooks': [], 'chats': [], 'userProfiles': [], 'activeUserProfileId': null, 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'widgetBgImage': null, 'perChatContextLines': 0x64, 'forceWhiteClock': ![] }, 'activeChatId': null, 'activeMeetingCharId': null, 'isGenerating': ![], 'currentAbortController': null, 'pendingMessageTimers': [], 'conversationHistory': [], 'displayedMessageCount': 0x64, 'activeQuote': null, 'friendCircles': [], 'activeFriendCircleId': null, 'calendarEvents': [], 'accountingData': [], 'accountingLedger': {}, 'diaries': [], 'activeDiaryCharacterId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'meetingViewMode': _0x1da6ac(0x4d4), 'activeMeetingScriptQueue': [], 'characterLastScripts': {}, 'musicPlaylist': [], 'currentlyPlayingIndex': -0x1, 'isPlaying': ![], 'pendingPostAttachments': { 'image': null, 'music': null } }; function _0x3e6d3a() { const _0x4d697b = _0x1da6ac; if (_0x4d697b(0x37b) !== _0x4d697b(0x76e)) try { const _0x271649 = { 'version': 0x1, 'characters': _0x10530c[_0x4d697b(0x620)], 'worldBooks': _0x10530c[_0x4d697b(0x79a)], 'chats': _0x10530c[_0x4d697b(0x4bc)], 'apiSettings': _0x10530c['apiSettings'], 'preferences': _0x10530c['preferences'], 'activeChatId': _0x10530c[_0x4d697b(0x16e)], 'diaries': _0x10530c[_0x4d697b(0x938)], 'friendCircles': _0x10530c[_0x4d697b(0x7b9)], 'activeFriendCircleId': _0x10530c['activeFriendCircleId'], 'userProfiles': _0x10530c[_0x4d697b(0x360)], 'activeUserProfileId': _0x10530c['activeUserProfileId'], 'accountingData': _0x10530c[_0x4d697b(0x304)], 'accountingLedger': _0x10530c[_0x4d697b(0xa29)], 'calendarEvents': _0x10530c[_0x4d697b(0x2e4)] }; localStorage[_0x4d697b(0x9e0)](_0x4d697b(0x683), JSON[_0x4d697b(0x22e)](_0x271649)); } catch (_0x2ae1ed) { if ('fTHXT' === 'fTHXT') console[_0x4d697b(0x729)](_0x4d697b(0x7e1), _0x2ae1ed), _0x3a6c86(_0x4d697b(0x975)); else { _0x56e5a2['error'](_0x4d697b(0x532)); return; } } else { if (_0x5e08f0) { const _0x31931d = _0x4f0d3c[_0x4d697b(0x73d)](_0x39cf8d); _0x21592a[_0x4d697b(0x70a)] = _0x31931d, _0x5b31a0[_0x4d697b(0x744)] = () => { const _0xd953ad = _0x4d697b; _0x4ac1df[_0xd953ad(0x8df)](_0x31931d); }; } else _0x76cbd6[_0x4d697b(0x713)] = _0x4d697b(0x872); } } function _0x22e9ee() { const _0x12def7 = _0x1da6ac; if (_0x12def7(0x72a) !== _0x12def7(0x72a)) { const _0x11ead5 = _0xd1b8a5[_0x12def7(0xe5)]['trim'](); if (!_0x11ead5) { _0x3855a9(_0x12def7(0x658)); return; } const _0x4cee76 = _0xd2555b['from'](_0x29c9fe[_0x12def7(0x20d)](_0x12def7(0x3e1)))['map'](_0x16be6d => _0x16be6d[_0x12def7(0xab1)]['id']); if (_0x4cee76[_0x12def7(0x848)] < 0x2) { _0x3a4c12(_0x12def7(0x666)); return; } const _0x582921 = { 'id': 'chat_group_' + _0x3fe267[_0x12def7(0x7a8)](), 'type': _0x12def7(0x732), 'name': _0x11ead5, 'participantIds': _0x4cee76 }; _0xc13808[_0x12def7(0x4bc)][_0x12def7(0x36b)](_0x582921), _0x2d9b33[_0x12def7(0x16e)] = _0x582921['id'], _0x408427(), _0x79d544(), _0x572c5e(), _0x18a2f7(), _0x554446(_0x12def7(0xd3) + _0x11ead5 + _0x12def7(0x72f)), _0x12fbdc(_0x12def7(0x78c), _0x12def7(0x345)); } else { let _0x41b916 = null; try { _0x41b916 = localStorage[_0x12def7(0x915)](_0x12def7(0x683)); } catch (_0x58e8d0) { console['error'](_0x12def7(0x237), _0x58e8d0); } if (_0x41b916) try { const _0x31e7a6 = JSON[_0x12def7(0x329)](_0x41b916), _0x452e31 = { ..._0x10530c }, _0x7d3171 = { ..._0x452e31, ..._0x31e7a6 }; _0x7d3171[_0x12def7(0x827)] = { ..._0x452e31[_0x12def7(0x827)], ..._0x31e7a6[_0x12def7(0x827)] || {} }, _0x7d3171[_0x12def7(0x899)] = { ..._0x452e31[_0x12def7(0x899)], ..._0x31e7a6[_0x12def7(0x899)] || {} }, Object['assign'](_0x10530c, _0x7d3171); } catch (_0x3840a6) { console['error']('解析存档失败，正在重置:', _0x3840a6), localStorage[_0x12def7(0x89a)]('appState'); } const _0x31c412 = _0x10530c['characters'][_0x12def7(0x848)] === 0x0; if (!_0x10530c[_0x12def7(0x4bc)][_0x12def7(0x212)](_0x285f42 => _0x285f42['id'] === _0x10530c[_0x12def7(0x16e)])) { if (_0x12def7(0x6a1) !== _0x12def7(0x6a1)) { const _0x1abe16 = _0x32aa0e[_0x12def7(0x3b9)](_0x12def7(0x6ff)); _0x1abe16[_0x12def7(0x296)] = _0x12def7(0x97f), _0x1abe16[_0x12def7(0x9a1)] = _0x12def7(0x670), _0x1abe16['querySelector'](_0x12def7(0x1f7))[_0x12def7(0x935)] = () => _0x434422('image'), _0x168068['appendChild'](_0x1abe16), _0x31df86(_0x1ec51d)['then'](_0x592388 => { const _0x27ebbb = _0x12def7, _0x18ceea = _0x238a3e[_0x27ebbb(0x248)]('pending-post-image-preview'); _0x18ceea && _0x592388 && (_0x18ceea[_0x27ebbb(0x70a)] = _0x5e7229[_0x27ebbb(0x73d)](_0x592388)); }); } else _0x10530c['activeChatId'] = _0x10530c['chats'][0x0]?.['id'] || null; } return _0x41b916 && ('OJkak' !== _0x12def7(0x3ae) ? _0x3e6d3a() : (_0x794381[_0x12def7(0x729)]('生成动态回复失败:', _0x1c64f6), _0x621cc0('大家好像不知道该怎么回复...'))), _0x31c412; } } function _0x4a0ca0() { const _0x1f3a67 = _0x1da6ac; if (!_0x10530c[_0x1f3a67(0x16e)]) return; try { localStorage[_0x1f3a67(0x9e0)](_0x1f3a67(0x13c) + _0x10530c[_0x1f3a67(0x16e)], JSON['stringify'](_0x10530c[_0x1f3a67(0x675)])); } catch (_0x48bc09) { console['error'](_0x1f3a67(0xa55), _0x48bc09), _0x3a6c86(_0x1f3a67(0x1bc)); } } function _0x20c635() { const _0x3d453e = _0x1da6ac; if (!_0x10530c[_0x3d453e(0x16e)]) { if (_0x3d453e(0x232) === _0x3d453e(0x232)) { _0x10530c[_0x3d453e(0x675)] = []; return; } else { const _0x368908 = _0x53bfdf['chats'][_0x3d453e(0x212)](_0x49625f => _0x49625f[_0x3d453e(0x26f)][_0x3d453e(0xa83)](_0x313fd0)); if (!_0x368908) return ''; const _0x2dbad3 = _0x1c7568(_0x368908['id']), _0x48a303 = _0x198e26[_0x3d453e(0x2e4)]['filter'](_0x4367e4 => _0x4367e4[_0x3d453e(0x9b2)] === _0x2dbad3['id'] || !_0x4367e4[_0x3d453e(0x9b2)]); if (_0x48a303[_0x3d453e(0x848)] === 0x0) return ''; const _0x4ffb07 = _0x48a303[_0x3d453e(0xa21)](_0xf66069 => { const _0x3c70d4 = _0x3d453e, _0x4b7d11 = _0xf66069['type'] === 'important' ? _0x3c70d4(0x543) : '待办'; return _0x3c70d4(0x18c) + _0x4b7d11 + ']\x20' + _0xf66069['date'] + ':\x20' + _0xf66069[_0x3c70d4(0x9a8)]; })['join']('\x0a'); return _0x3d453e(0x2c7) + _0x2dbad3[_0x3d453e(0x6b7)] + '\x20记录)\x0a' + _0x4ffb07; } } let _0x2ed117 = null; try { _0x2ed117 = localStorage['getItem'](_0x3d453e(0x13c) + _0x10530c[_0x3d453e(0x16e)]); } catch (_0x5022ca) { console[_0x3d453e(0x729)](_0x3d453e(0x650) + _0x10530c[_0x3d453e(0x16e)], _0x5022ca); } let _0x1de182 = []; if (_0x2ed117) try { if (_0x3d453e(0x85d) === _0x3d453e(0x2db)) _0x4a4dee[_0x3d453e(0x4b3)](); else { const _0x214bc9 = JSON[_0x3d453e(0x329)](_0x2ed117); Array[_0x3d453e(0x796)](_0x214bc9) && (_0x1de182 = _0x214bc9[_0x3d453e(0x54e)](_0x4c2908 => _0x4c2908 && typeof _0x4c2908 === _0x3d453e(0xa2d) && typeof _0x4c2908[_0x3d453e(0x34a)] === _0x3d453e(0x9d1) && typeof _0x4c2908[_0x3d453e(0x9a8)] !== _0x3d453e(0xa58))); } } catch (_0x5e0e8f) { console['error'](_0x3d453e(0x44c) + _0x10530c['activeChatId'] + _0x3d453e(0x6dc), _0x5e0e8f); try { localStorage['removeItem']('chatHistory_' + _0x10530c[_0x3d453e(0x16e)]); } catch (_0xc00878) { 'FGuaI' !== _0x3d453e(0xa0a) ? _0x515d1b[_0x3d453e(0x10d)]['display'] = 'none' : console['error'](_0x3d453e(0x9d4), _0xc00878); } } _0x10530c['conversationHistory'] = _0x1de182; } async function _0x147819() { const _0x41c65d = _0x1da6ac, _0xbddbc4 = document[_0x41c65d(0x248)](_0x41c65d(0x46a)); if (!_0xbddbc4) { if (_0x41c65d(0x311) !== _0x41c65d(0x26d)) { console[_0x41c65d(0x729)](_0x41c65d(0x532)); return; } else { if (_0xa0f4ba[_0x41c65d(0x59e)]) return; const _0x1a70a3 = _0x2d032c[_0x41c65d(0x2aa)]; if (_0x1a70a3 <= 0x0) return; _0x552e5c[_0x41c65d(0x59e)] = !![]; const _0x28f8cc = _0x1a70a3 - 0x1, _0x4795c0 = _0x1f7de2['getElementById'](_0x41c65d(0x9da) + _0x1a70a3), _0x35e007 = _0x1cac34[_0x41c65d(0x248)](_0x41c65d(0x9da) + _0x28f8cc); _0x4795c0 && _0x35e007 ? (_0x35e007[_0x41c65d(0x882)][_0x41c65d(0x7c3)](_0x41c65d(0x830)), _0x4795c0['classList']['add'](_0x41c65d(0x83d)), _0x35e007[_0x41c65d(0x882)][_0x41c65d(0x7c3)](_0x41c65d(0x2cd)), _0x555cc2(() => { const _0x1060a0 = _0x41c65d; _0x4795c0[_0x1060a0(0x882)]['remove'](_0x1060a0(0x2cd), _0x1060a0(0x83d)), _0x35e007[_0x1060a0(0x882)][_0x1060a0(0xae0)](_0x1060a0(0x830)), _0x3f4ef3[_0x1060a0(0x2aa)] = _0x28f8cc, _0x1e2198(), _0x315c69[_0x1060a0(0x59e)] = ![]; }, 0x2bc)) : _0x287ab0[_0x41c65d(0x59e)] = ![]; } } try { let _0x56a082 = await _0x533d7a(_0x41c65d(0x636)); if (!_0x56a082) { if ('zFHqV' !== _0x41c65d(0x43b)) { const _0x2b5df8 = localStorage[_0x41c65d(0x915)](_0x41c65d(0x29b)); if (_0x2b5df8) { if (_0x41c65d(0x41a) !== _0x41c65d(0x41a)) { _0x5a864e(_0x41c65d(0x52d)); return; } else console['log'](_0x41c65d(0x9bc)), _0x56a082 = await _0x39f481(_0x2b5df8), await _0x5ef29b(_0x41c65d(0x636), _0x56a082), localStorage['removeItem'](_0x41c65d(0x29b)); } } else { const _0x4fb08f = _0x198cdb[_0x41c65d(0xa0d)]['map'](_0x44e02b => { const _0xb23fa7 = _0x41c65d, _0x2d769c = _0x4331ed(_0x44e02b[_0xb23fa7(0x5fa)])?.[_0xb23fa7(0x6b7)] || '未知'; return _0xb23fa7(0x1e2) + _0x2d769c + _0xb23fa7(0x858) + _0x44e02b['content'] + _0xb23fa7(0x489); })[_0x41c65d(0x64e)](''); _0x53bf04 = _0x41c65d(0x3da) + _0x4fb08f + _0x41c65d(0x489); } } _0x56a082 ? (_0xbddbc4[_0x41c65d(0x10d)]['backgroundImage'] = 'url(' + URL[_0x41c65d(0x73d)](_0x56a082) + ')', _0xbddbc4[_0x41c65d(0x10d)][_0x41c65d(0xc2)] = _0x41c65d(0x55a), _0xbddbc4[_0x41c65d(0x10d)][_0x41c65d(0x53b)] = 'center') : _0xbddbc4['style'][_0x41c65d(0xad9)] = ''; } catch (_0x5280bd) { console[_0x41c65d(0x729)](_0x41c65d(0x635), _0x5280bd), _0xbddbc4 && (_0x41c65d(0xac5) !== 'qCvzg' ? _0xbddbc4[_0x41c65d(0x10d)][_0x41c65d(0xad9)] = '' : (_0x544822[_0x41c65d(0x70a)] = _0x1ceb0c[_0x41c65d(0x73d)](_0x243fe9), _0x2a69cf[_0x41c65d(0x10d)][_0x41c65d(0x69f)] = 0x1)); } } function _0x156d93() { const _0x30cc93 = _0x1da6ac, _0x2e9fc9 = localStorage[_0x30cc93(0x915)](_0x30cc93(0x7b4)); if (_0x2e9fc9) document[_0x30cc93(0x248)]('music-screen')[_0x30cc93(0x10d)][_0x30cc93(0x91f)](_0x30cc93(0x118), 'url(' + _0x2e9fc9 + ')'); else { if ('aApPI' === _0x30cc93(0x8f3)) { const _0x55e8dd = new _0x58ebd7(_0x5f1acf[_0x30cc93(0x908)])[_0x30cc93(0x1cf)]('zh-CN', { 'hour': '2-digit', 'minute': _0x30cc93(0x96e) }); _0x1723f2['content'] && _0x3ff4b5[_0x30cc93(0x36b)]('[' + _0x55e8dd + _0x30cc93(0xaa1) + _0x5bedbb(_0xb73d88) + ']\x20' + _0x138133(_0x3eedcb[_0x30cc93(0x9a8)])['trim']()); } else document[_0x30cc93(0x248)](_0x30cc93(0x9e9))[_0x30cc93(0x10d)]['setProperty'](_0x30cc93(0x118), _0x30cc93(0x3fe)); } } async function _0x51d545(_0x11c489) { const _0x10d86a = _0x1da6ac; try { await _0x5ef29b(_0x10d86a(0x636), _0x11c489), await _0x147819(), _0x3a6c86(_0x10d86a(0x2ea)); } catch (_0x46f36b) { console['error'](_0x10d86a(0x715), _0x46f36b), _0x3a6c86('保存壁纸失败:\x20' + _0x46f36b[_0x10d86a(0x380)]); } } function _0x10b7fc(_0xb42c1d) { const _0x525812 = _0x1da6ac, _0x31f3cd = { 'quotedMessage': null, 'content': _0xb42c1d }, _0x1f4007 = _0xb42c1d['match'](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x1f4007 && ('lhxpl' === _0x525812(0x188) ? _0x2b200e = _0x363f2b[_0x525812(0x21d)](..._0x435900[_0x525812(0x3d6)][_0x525812(0xa21)](_0x831d2e => _0x831d2e[_0x525812(0x908)])) : (_0x31f3cd['quotedMessage'] = { 'sender': _0x1f4007[0x1]['trim'](), 'content': _0x1f4007[0x2][_0x525812(0x3ee)]() }, _0x31f3cd['content'] = _0xb42c1d['substring'](_0x1f4007[0x0]['length'])[_0x525812(0x3ee)]())), _0x31f3cd; } const _0x4b3446 = document['getElementById']('message-action-modal'), _0x4a7c57 = document[_0x1da6ac(0x248)](_0x1da6ac(0x1c7)), _0x2d71c7 = document['getElementById'](_0x1da6ac(0xa28)), _0x205acf = document['getElementById']('delete-message-button'), _0x5034ea = document[_0x1da6ac(0x248)](_0x1da6ac(0x231)), _0x406f43 = document['getElementById']('quote-message-button'), _0x447510 = document[_0x1da6ac(0x248)](_0x1da6ac(0x697)), _0x440f20 = document[_0x1da6ac(0x248)](_0x1da6ac(0x932)), _0x463fe6 = document[_0x1da6ac(0x248)]('edit-message-textarea'), _0x4a4b7d = document[_0x1da6ac(0x248)](_0x1da6ac(0x801)), _0x4a9024 = document['getElementById'](_0x1da6ac(0x957)); let _0x576ae7 = null; function _0x1351da(_0x5dd1b8) { const _0x315c25 = _0x1da6ac; _0x315c25(0x278) === _0x315c25(0x278) ? (_0x576ae7 = _0x5dd1b8, _0x4b3446[_0x315c25(0x882)][_0x315c25(0x7c3)]('show')) : _0x232319['click'](); } function _0x28352f() { const _0x2debd2 = _0x1da6ac; _0x4b3446[_0x2debd2(0x882)][_0x2debd2(0xae0)](_0x2debd2(0x11b)); } function _0x2dea50() { _0x28352f(), _0x576ae7 = null; } function _0x38985e() { const _0xede37d = _0x1da6ac; if (_0x576ae7 === null) return; _0x10530c['conversationHistory'][_0xede37d(0x2f2)](_0x576ae7, 0x1), _0x4a0ca0(), _0x58f59d(), _0x2dea50(); } function _0x2a0fb0() { const _0x4fb795 = _0x1da6ac; if (_0x576ae7 === null) return; const _0x393a4a = _0x10530c['conversationHistory'][_0x576ae7]; if (!_0x393a4a) return; _0x463fe6[_0x4fb795(0xe5)] = _0x393a4a['content'], _0x28352f(), _0x447510['classList']['add'](_0x4fb795(0x11b)), _0x463fe6['focus'](); } function _0x379cd4() { const _0x57520e = _0x1da6ac; if (_0x576ae7 === null) return; const _0x251cab = _0x463fe6[_0x57520e(0xe5)][_0x57520e(0x3ee)](); if (_0x251cab === '') { _0x270748(); return; } const _0x53583d = _0x10530c[_0x57520e(0x675)][_0x576ae7]; _0x53583d && (_0x53583d[_0x57520e(0x9a8)] = _0x251cab, _0x4a0ca0(), _0x58f59d()), _0x447510['classList'][_0x57520e(0xae0)]('show'), _0x576ae7 = null; } function _0x270748() { const _0x31fbc6 = _0x1da6ac; _0x31fbc6(0x365) === _0x31fbc6(0x365) ? (_0x447510[_0x31fbc6(0x882)][_0x31fbc6(0xae0)](_0x31fbc6(0x11b)), _0x576ae7 = null) : _0x36ff6c(); } _0x4a7c57[_0x1da6ac(0x578)]('click', _0x2dea50), _0x5034ea[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x2dea50), _0x205acf[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x38985e), _0x2d71c7[_0x1da6ac(0x578)]('click', _0x2a0fb0), _0x406f43[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x381a5b), _0x31a94d[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x5e1d22), _0x4a4b7d['addEventListener'](_0x1da6ac(0x4b3), _0x379cd4), _0x4a9024['addEventListener'](_0x1da6ac(0x4b3), _0x270748), _0x440f20[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x270748); function _0x381a5b() { const _0x466927 = _0x1da6ac; if (_0x576ae7 === null) return; const _0x1f5b3b = _0x10530c[_0x466927(0x675)][_0x576ae7]; if (!_0x1f5b3b) return; const _0x29c000 = _0x27b19d(); let _0x5908c9 = '未知'; if (_0x1f5b3b[_0x466927(0x34a)] === _0x466927(0x27a)) 'XDLRk' === _0x466927(0x9c3) ? (_0x416c03[_0x466927(0x5e0)](_0x466927(0x2a4) + _0x14664e), _0x8332d0[_0x466927(0x1e4)](_0x326f32, { 'keyPath': 'id' })) : _0x5908c9 = _0x10530c[_0x466927(0x1c9)][_0x466927(0x6b7)] || '我'; else { const _0x1c9348 = _0x1f5b3b[_0x466927(0x596)] || _0x29c000?.[_0x466927(0x26f)][0x0], _0x26bf82 = _0x5b19fc(_0x1c9348); _0x5908c9 = _0x26bf82 ? _0x26bf82[_0x466927(0x6b7)] : '角色'; } let _0x5b6236 = _0x1f5b3b[_0x466927(0x9a8)] || ''; if (_0x1f5b3b[_0x466927(0x565)]) _0x5b6236 = _0x466927(0x9ae); if (_0x1f5b3b[_0x466927(0x1a2)]) _0x5b6236 = '[图片]'; if (_0x5b6236[_0x466927(0x848)] > 0x32) _0x5b6236 = _0x5b6236[_0x466927(0x3f1)](0x0, 0x32) + '...'; _0x10530c[_0x466927(0x618)] = { 'sender': _0x5908c9, 'content': _0x5b6236 }, _0x47080e(), _0x2dea50(), _0x240b04[_0x466927(0x6e3)](); } function _0x47080e() { const _0x10ef07 = _0x1da6ac; if (!_0x10530c[_0x10ef07(0x618)]) return; _0x3899d4[_0x10ef07(0x9ac)] = _0x10ef07(0x21e) + _0x10530c['activeQuote']['sender'], _0x3c7432[_0x10ef07(0x9ac)] = _0x10530c[_0x10ef07(0x618)]['content'], _0x446046[_0x10ef07(0x10d)][_0x10ef07(0x5eb)] = 'block'; } function _0x5e1d22() { const _0x431aa3 = _0x1da6ac; _0x10530c['activeQuote'] = null, _0x446046['style'][_0x431aa3(0x5eb)] = _0x431aa3(0x3fe); } function _0x1c4afc(_0x5ba442, _0x31dc84) { const _0x103c86 = _0x1da6ac; if (_0x103c86(0x610) !== _0x103c86(0x38f)) { const _0x3c31cb = document[_0x103c86(0x248)](_0x103c86(0x424)); _0x3c31cb && (_0x5ba442 === _0x103c86(0x362) ? _0x3c31cb[_0x103c86(0x10d)][_0x103c86(0x5eb)] = _0x103c86(0x66d) : _0x3c31cb[_0x103c86(0x10d)][_0x103c86(0x5eb)] = _0x103c86(0x3fe)); _0x43c968 = _0x31dc84 || null, Object[_0x103c86(0x25e)](_0x446e25)[_0x103c86(0x986)](_0x1737d5 => _0x1737d5[_0x103c86(0x882)][_0x103c86(0xae0)](_0x103c86(0x182))); _0x446e25[_0x5ba442] && _0x446e25[_0x5ba442]['classList'][_0x103c86(0x7c3)](_0x103c86(0x182)); if (_0x5ba442 !== _0x103c86(0x78c)) { if (_0x103c86(0x971) === _0x103c86(0x971)) _0xb90343[_0x103c86(0x882)][_0x103c86(0xae0)](_0x103c86(0x89e)); else { if (_0x20818f) { const _0x20c423 = _0x452055[_0x103c86(0x3b9)]('p'); _0x20c423[_0x103c86(0x9a1)] = _0x50fcef, _0x20c423[_0x103c86(0x10d)][_0x103c86(0x1e8)] = '0', _0x2f8905[_0x103c86(0x6ab)](_0x20c423); } } } } else { let _0x4ae473 = _0x2989ce['diaries']['find'](_0x555e37 => _0x555e37[_0x103c86(0x542)] === _0x4974a5); !_0x4ae473 && (_0x4ae473 = { 'characterId': _0x1a5b9f, 'entries': [] }, _0x4f6926['diaries'][_0x103c86(0x36b)](_0x4ae473)); _0x4ae473[_0x103c86(0x17b)][_0x103c86(0x36b)]({ 'timestamp': _0x8d32e6[_0x103c86(0x7a8)](), 'author': _0x9c3797, 'content': _0xb651ae }), _0x160fee(); const _0x116a8a = _0x4ae473[_0x103c86(0x17b)][_0x103c86(0x848)]; _0x20d21a['diaryCurrentPage'] = _0x65aaba['ceil'](_0x116a8a / 0x2) - 0x1, _0x2fbbd1(); } } function _0x2b7059(_0x4e8b01) { const _0x3243c7 = _0x1da6ac; _0x3243c7(0x80c) !== _0x3243c7(0x67e) ? _0x4e8b01 ? _0x3243c7(0x2f1) === 'gGcua' ? _0x3d72e8(_0x3243c7(0x5c2))[_0x3243c7(0x45f)](_0x39c566 => { const _0x22ed65 = _0x3243c7; if (_0x39c566) { const _0x5c85c5 = _0xcc062f(_0x41cabb[_0x22ed65(0x5cb)]); _0x5c85c5 && (delete _0x5c85c5['spriteTransform'], _0x3c545a(), _0x305092(_0x5c85c5['id'], _0x22ed65(0x47b)), _0x278537(_0x22ed65(0x382)), _0x48ecab(!![])); } }) : _0xb90343[_0x3243c7(0x882)][_0x3243c7(0x7c3)](_0x3243c7(0x89e)) : _0xb90343[_0x3243c7(0x882)][_0x3243c7(0xae0)]('show-chat-view') : _0x516131[_0x3243c7(0x9ac)] = _0x3243c7(0x6e4); } async function _0x398205() { const _0x417b6e = _0x1da6ac; _0x102626[_0x417b6e(0x9a1)] = ''; for (const _0x1352d2 of _0x10530c[_0x417b6e(0x4bc)]) { const _0x35e8a8 = document[_0x417b6e(0x3b9)]('li'); _0x35e8a8[_0x417b6e(0x296)] = 'character-item', _0x35e8a8[_0x417b6e(0xab1)]['id'] = _0x1352d2['id']; let _0x79947b = _0x5da029, _0x3f10c8 = '群聊', _0x5384cd = ''; if (_0x1352d2['type'] === _0x417b6e(0x71a)) { const _0x142cb5 = _0x5b19fc(_0x1352d2[_0x417b6e(0x26f)][0x0]); if (_0x142cb5) { const _0x6c6c6a = await _0x533d7a(_0x417b6e(0x583) + _0x142cb5['id']); if (_0x6c6c6a) _0x79947b = URL[_0x417b6e(0x73d)](_0x6c6c6a); else { if (_0x417b6e(0x9e3) !== _0x417b6e(0x9e3)) { const { playlist: _0x49339b, currentIndex: _0x5e6fa1 } = _0x16d8cb[_0x417b6e(0x329)](_0x220c30); _0x537a5e[_0x417b6e(0x796)](_0x49339b) && _0x49339b[_0x417b6e(0x848)] > 0x0 && _0x5e6fa1 > -0x1 && (_0xd6d153[_0x417b6e(0x30c)] = _0x49339b, _0x545048[_0x417b6e(0x79f)] = _0x5e6fa1, _0x140fda[_0x417b6e(0x73c)] = ![], _0x2ac061()); } else _0x79947b = _0x142cb5[_0x417b6e(0x917)] || _0x5da029; } _0x3f10c8 = _0x142cb5['name'] || '未命名角色', _0x5384cd = _0x142cb5[_0x417b6e(0x689)] || '私聊'; } else _0x3f10c8 = _0x417b6e(0x187), _0x5384cd = '错误：找不到角色'; } else { _0x3f10c8 = _0x1352d2['name'] || _0x417b6e(0x647), _0x5384cd = _0x1352d2['participantIds']['length'] + _0x417b6e(0x894); const _0xcf59b6 = await _0x533d7a(_0x417b6e(0x207) + _0x1352d2['id']); if (_0xcf59b6) _0x79947b = URL[_0x417b6e(0x73d)](_0xcf59b6); } _0x35e8a8['innerHTML'] = _0x417b6e(0x303) + _0x79947b + _0x417b6e(0xa16) + _0x3f10c8 + _0x417b6e(0x685) + _0x5384cd + _0x417b6e(0xa08), _0x35e8a8[_0x417b6e(0x838)]('.char-info-wrapper')[_0x417b6e(0x578)](_0x417b6e(0x4b3), () => { _0x1bdd79(_0x1352d2['id']), _0x2b7059(!![]); }), _0x102626['appendChild'](_0x35e8a8); } } async function _0x8e1b2b() { const _0x156041 = _0x1da6ac, _0x33118e = document[_0x156041(0x248)](_0x156041(0x78e)); _0x33118e[_0x156041(0x9a1)] = ''; const _0x5e518b = _0x10530c[_0x156041(0x620)][_0x156041(0x54e)](_0x5d5271 => _0x10530c[_0x156041(0x4bc)][_0x156041(0xacd)](_0x2af334 => _0x2af334[_0x156041(0xa78)] === 'private' && _0x2af334[_0x156041(0x26f)][_0x156041(0xa83)](_0x5d5271['id']))); if (_0x5e518b['length'] === 0x0) { if (_0x156041(0x4c3) === _0x156041(0x2d2)) return new _0x4e7166((_0x4f5485, _0x1a692e) => { const _0x3b3be4 = _0x156041, _0x3fe2a5 = new _0x411449(); _0x3fe2a5['onloadend'] = () => _0x4f5485(_0x3fe2a5[_0x3b3be4(0x4f7)]), _0x3fe2a5[_0x3b3be4(0x136)] = _0x1a692e, _0x3fe2a5[_0x3b3be4(0x65a)](_0xd11ca4); }); else { _0x33118e['innerHTML'] = _0x156041(0x119); return; } } for (const _0xd3f4b0 of _0x5e518b) { const _0x136611 = document[_0x156041(0x3b9)]('li'); _0x136611[_0x156041(0x296)] = _0x156041(0x833), _0x136611[_0x156041(0xab1)][_0x156041(0x438)] = _0xd3f4b0['id']; const _0x26504e = await _0x533d7a(_0x156041(0x583) + _0xd3f4b0['id']), _0x463440 = _0x26504e ? URL[_0x156041(0x73d)](_0x26504e) : _0xd3f4b0[_0x156041(0x917)] || _0x5da029; _0x136611['innerHTML'] = _0x156041(0x3a1) + _0x463440 + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0xd3f4b0[_0x156041(0x6b7)] + _0x156041(0x36f) + (_0xd3f4b0[_0x156041(0x689)] || '私聊') + _0x156041(0x6d6), _0x136611[_0x156041(0x578)](_0x156041(0x4b3), () => { _0x2b14cb(_0xd3f4b0['id']); }), _0x33118e[_0x156041(0x6ab)](_0x136611); } } async function _0x2b14cb(_0x49afb6) { const _0x11d346 = _0x1da6ac, _0x56d938 = _0x5b19fc(_0x49afb6); if (!_0x56d938) return; document['getElementById'](_0x11d346(0x63f))[_0x11d346(0x70a)] = '', _0x10530c[_0x11d346(0x5cb)] = _0x49afb6; const _0x3d858b = _0x10530c[_0x11d346(0x4bc)][_0x11d346(0x212)](_0x47a146 => _0x47a146[_0x11d346(0xa78)] === _0x11d346(0x71a) && _0x47a146[_0x11d346(0x26f)]['includes'](_0x49afb6)); _0x3d858b ? 'wryWG' !== _0x11d346(0x169) ? _0x3da526[_0x11d346(0x823)] ? _0x39cb94[_0x11d346(0x8ad)]() : _0x4a8b3b[_0x11d346(0x4b8)]() : (_0x10530c[_0x11d346(0x16e)] = _0x3d858b['id'], _0x3e6d3a(), _0x20c635(), _0x2e959a(_0x49afb6)) : _0x10530c[_0x11d346(0x675)] = []; document[_0x11d346(0x248)](_0x11d346(0x55e))[_0x11d346(0x9ac)] = _0x56d938['name']; const _0x3dac3c = document['getElementById'](_0x11d346(0x151)); try { const _0x41995e = await _0x533d7a('char_offline_bg_' + _0x49afb6); if (_0x41995e) _0x11d346(0x66c) !== _0x11d346(0xa33) ? (_0x3dac3c[_0x11d346(0x10d)][_0x11d346(0xad9)] = 'url(\x27' + URL[_0x11d346(0x73d)](_0x41995e) + '\x27)', _0x3dac3c['style'][_0x11d346(0xc2)] = _0x11d346(0x55a), _0x3dac3c[_0x11d346(0x10d)][_0x11d346(0x53b)] = 'center') : (_0x3fec62[_0x11d346(0x148)](), _0x38aa7c()); else { if (_0x11d346(0x933) === _0x11d346(0x4a4)) { const _0x88f0e8 = _0x316e30['value']['trim'](); _0x88f0e8 && (_0x347ad9(_0x88f0e8), _0x4079b3[_0x11d346(0xe5)] = '', _0x1c317b(_0x329887, 0x64)); } else _0x3dac3c[_0x11d346(0x10d)][_0x11d346(0xad9)] = _0x11d346(0x3fe); } } catch (_0x490fbd) { console[_0x11d346(0x729)](_0x11d346(0x8db) + _0x49afb6 + ':', _0x490fbd), _0x3dac3c[_0x11d346(0x10d)]['backgroundImage'] = _0x11d346(0x3fe); } _0x97c07c(), _0x13c1d5(); if (_0x5864e0) clearInterval(_0x5864e0); _0x3f1b78(), _0x5864e0 = setInterval(_0x3f1b78, 0x2710), document[_0x11d346(0x248)](_0x11d346(0x48d))[_0x11d346(0x10d)][_0x11d346(0x5eb)] = _0x11d346(0x92c), _0x1c4afc(_0x11d346(0x724), _0x11d346(0x16a)); } function _0x13c1d5() { const _0x432a9c = _0x1da6ac, _0x29a799 = document['getElementById'](_0x432a9c(0x455)); _0x29a799['innerHTML'] = ''; const _0x5a9891 = _0x29a799[_0x432a9c(0x838)]('#message-anchor'); if (_0x5a9891) _0x5a9891[_0x432a9c(0xae0)](); _0x10530c[_0x432a9c(0x675)] && _0x10530c[_0x432a9c(0x675)]['forEach']((_0x569fe9, _0x8acc86) => { const _0x6209e5 = _0x432a9c; if (!_0x569fe9[_0x6209e5(0x718)] || _0x569fe9[_0x6209e5(0x34a)] === _0x6209e5(0x11f)) return; const _0x48dcac = document[_0x6209e5(0x3b9)]('p'); _0x48dcac['dataset'][_0x6209e5(0x215)] = _0x8acc86; const _0x2d59de = _0x569fe9[_0x6209e5(0x9a8)][_0x6209e5(0x7cf)](/\n/g, _0x6209e5(0x227)); let _0x1deccf = '', _0xa52d1e = ''; const _0x50ab04 = _0x474290(_0x10530c['activeChatId']); if (_0x569fe9[_0x6209e5(0x34a)] === _0x6209e5(0x27a)) _0x1deccf = _0x50ab04[_0x6209e5(0x6b7)] || '我', _0xa52d1e = _0x6209e5(0x9c0); else { if (_0x569fe9['role'] === 'assistant') { const _0x26d822 = _0x5b19fc(_0x569fe9[_0x6209e5(0x596)] || _0x10530c[_0x6209e5(0x5cb)]); _0x1deccf = _0x26d822?.[_0x6209e5(0x6b7)] || '角色', _0xa52d1e = 'speaker-ai'; } } _0x48dcac[_0x6209e5(0x10d)][_0x6209e5(0x598)] = 'rgba(0,\x200,\x200,\x200.4)', _0x48dcac[_0x6209e5(0x10d)]['padding'] = _0x6209e5(0x61a), _0x48dcac[_0x6209e5(0x10d)][_0x6209e5(0x12c)] = _0x6209e5(0x241), _0x48dcac[_0x6209e5(0x10d)][_0x6209e5(0x276)] = _0x6209e5(0x566); if (_0x1deccf) { if ('dDteW' === _0x6209e5(0xfa)) return _0x3f6dbc(_0x344d39)[_0x6209e5(0x45f)](_0x2f7c5e => _0x2f7c5e[_0x6209e5(0x226)]()); else _0x48dcac[_0x6209e5(0x9a1)] = _0x6209e5(0x383) + _0xa52d1e + '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20' + (_0xa52d1e === 'speaker-user' ? _0x6209e5(0x98b) : _0x6209e5(0x5f4)) + _0x6209e5(0x475) + _0x1deccf + _0x6209e5(0x76a) + _0x2d59de; } else _0x6209e5(0xad6) === _0x6209e5(0xad6) ? (_0x48dcac[_0x6209e5(0x296)] = 'narrator', _0x48dcac[_0x6209e5(0x10d)]['fontStyle'] = 'italic', _0x48dcac[_0x6209e5(0x10d)][_0x6209e5(0x249)] = _0x6209e5(0x6cf), _0x48dcac[_0x6209e5(0x9a1)] = _0x2d59de) : (_0x159e40['activeListenSession'] = null, _0x4a908e(_0x6209e5(0x590)), _0x366118()); _0x29a799['appendChild'](_0x48dcac); }); if (_0x10530c[_0x432a9c(0xa4a)]) { let _0x4ed4bb = _0x29a799[_0x432a9c(0x838)](_0x432a9c(0x251)); !_0x4ed4bb && (_0x4ed4bb = document[_0x432a9c(0x3b9)]('div'), _0x4ed4bb[_0x432a9c(0x296)] = _0x432a9c(0x3bc), _0x4ed4bb[_0x432a9c(0x9ac)] = _0x432a9c(0xae6), _0x4ed4bb['style'][_0x432a9c(0x598)] = _0x432a9c(0xa4b), _0x4ed4bb[_0x432a9c(0x10d)]['padding'] = _0x432a9c(0x61a), _0x4ed4bb[_0x432a9c(0x10d)][_0x432a9c(0x12c)] = _0x432a9c(0x241), _0x29a799[_0x432a9c(0x6ab)](_0x4ed4bb)); } const _0xe2b945 = document[_0x432a9c(0x3b9)](_0x432a9c(0x6ff)); _0xe2b945['id'] = _0x432a9c(0x228), _0x29a799[_0x432a9c(0x6ab)](_0xe2b945), setTimeout(() => { const _0x4c44dc = _0x432a9c; _0x4c44dc(0x69b) === 'XVuKK' ? _0xe2b945['scrollIntoView']({ 'behavior': _0x4c44dc(0xa91), 'block': _0x4c44dc(0x3a7) }) : _0x303337(_0x5b1534['id']); }, 0x32); } function _0x58f59d() { const _0x54219c = _0x1da6ac, _0x2dc582 = document[_0x54219c(0x838)](_0x54219c(0x7dd)); if (!_0x2dc582) return; if (_0x2dc582['id'] === _0x54219c(0x99f)) { if (_0x54219c(0x3f3) !== _0x54219c(0x3f3)) { let _0x4ae9ab = ''; if (_0x3a7dc4[_0x54219c(0x372)] && _0x111306[_0x54219c(0x372)][_0x54219c(0x848)] > 0x0) { const _0x38cc01 = _0x299872[_0x54219c(0x372)][_0x54219c(0xa21)](_0x18f5c5 => _0x4853f0(_0x18f5c5)?.[_0x54219c(0x6b7)] || '未知')[_0x54219c(0x64e)]('、'), _0x313ca3 = _0x54219c(0x5b5); _0x4ae9ab = '<div\x20class=\x22post-likes\x22>' + _0x313ca3 + '\x20' + _0x38cc01 + _0x54219c(0x489); } let _0x24272f = ''; if (_0x8e93f1[_0x54219c(0xa0d)] && _0x2f62e7[_0x54219c(0xa0d)][_0x54219c(0x848)] > 0x0) { const _0x4a017d = _0xf5dadf[_0x54219c(0xa0d)][_0x54219c(0xa21)](_0x27bc5c => { const _0x8dfc4c = _0x54219c, _0x18cc61 = _0xdd62b7(_0x27bc5c['authorId'])?.[_0x8dfc4c(0x6b7)] || '未知'; return '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>' + _0x18cc61 + _0x8dfc4c(0x858) + _0x27bc5c[_0x8dfc4c(0x9a8)] + _0x8dfc4c(0x489); })[_0x54219c(0x64e)](''); _0x24272f = _0x54219c(0x3da) + _0x4a017d + '</div>'; } _0x4bcb80 = _0x54219c(0x52b) + _0x4ae9ab + _0x54219c(0x5e5) + _0x24272f + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'; } else _0x13c1d5(); } else _0x1a245d(); } async function _0x1a245d() { const _0x5629d7 = _0x1da6ac, _0x1f8d01 = _0x10530c['conversationHistory']['filter'](_0x57f8dd => !_0x57f8dd[_0x5629d7(0x718)] && _0x57f8dd[_0x5629d7(0x34a)] !== _0x5629d7(0x11f)); let _0x4493ad = _0xa6230[_0x5629d7(0x838)](_0x5629d7(0x949)); if (_0x1f8d01[_0x5629d7(0x848)] > _0x10530c[_0x5629d7(0x880)]) { if (!_0x4493ad) { if (_0x5629d7(0x410) === _0x5629d7(0x560)) { _0x1c5318(_0x5629d7(0x2d9)); return; } else _0x4493ad = document[_0x5629d7(0x3b9)](_0x5629d7(0x8e2)), _0x4493ad[_0x5629d7(0x9ac)] = '加载更多聊天记录', _0x4493ad['className'] = 'form-button\x20load-more-btn', _0x4493ad['style']['width'] = _0x5629d7(0xa91), _0x4493ad[_0x5629d7(0x10d)][_0x5629d7(0x1e8)] = _0x5629d7(0x3f4), _0x4493ad[_0x5629d7(0x10d)][_0x5629d7(0x8cd)] = _0x5629d7(0xaa8), _0x4493ad[_0x5629d7(0x935)] = () => { const _0x3cdb1f = _0x5629d7, _0x1b618d = _0xa6230, _0xdaa06a = _0x1b618d[_0x3cdb1f(0x5ce)], _0x278830 = _0x1b618d[_0x3cdb1f(0x40d)]; _0x10530c['displayedMessageCount'] += 0x64, _0x1a245d(), requestAnimationFrame(() => { const _0x5a5761 = _0x3cdb1f, _0x133cd7 = _0x1b618d[_0x5a5761(0x5ce)]; _0x1b618d[_0x5a5761(0x40d)] = _0x278830 + (_0x133cd7 - _0xdaa06a); }); }, _0xa6230[_0x5629d7(0x7ce)] ? _0xa6230[_0x5629d7(0x861)](_0x4493ad, _0xa6230[_0x5629d7(0x7ce)]) : _0xa6230[_0x5629d7(0x6ab)](_0x4493ad); } } else { if (_0x4493ad) _0x4493ad[_0x5629d7(0xae0)](); } Array[_0x5629d7(0x10f)](_0xa6230['children'])['forEach'](_0x79e4f3 => { const _0x192d7f = _0x5629d7; if (_0x192d7f(0xac4) !== _0x192d7f(0xac4)) return { 'type': _0x192d7f(0x958), 'content': _0x16eeaa }; else !_0x79e4f3[_0x192d7f(0x882)]['contains'](_0x192d7f(0x73f)) && _0x79e4f3[_0x192d7f(0xae0)](); }); const _0x562d76 = _0x1f8d01[_0x5629d7(0x53a)](-_0x10530c['displayedMessageCount']); await Promise[_0x5629d7(0x63b)](_0x562d76['map'](_0x4daad6 => { const _0x20fc4e = _0x5629d7; if (_0x20fc4e(0x451) === _0x20fc4e(0xa35)) _0x446ae2['innerHTML'] = '', _0x3b9806[_0x20fc4e(0x986)](_0x307992 => { const _0xa31025 = _0x20fc4e, _0x498d66 = _0x376c73[_0xa31025(0x3b9)]('img'); _0x498d66[_0xa31025(0x70a)] = _0x307992[_0xa31025(0x83a)], _0x498d66[_0xa31025(0x7e8)] = _0xa31025(0x7b1), _0x498d66[_0xa31025(0x4cf)] = _0x307992[_0xa31025(0x6b7)], _0x498d66[_0xa31025(0x882)][_0xa31025(0x7c3)]('sticker-item'), _0x498d66['addEventListener'](_0xa31025(0x4b3), () => _0x410442(_0x307992)), _0x2ebd6e['appendChild'](_0x498d66); }); else { const _0x410227 = _0x10530c[_0x20fc4e(0x675)][_0x20fc4e(0x7ec)](_0x4daad6); if (_0x410227 > -0x1) { if (_0x20fc4e(0xa3f) === _0x20fc4e(0xa3f)) return _0x1ee743(_0x4daad6, _0x410227); else _0x4ee318[_0x506d34][_0x20fc4e(0x882)][_0x20fc4e(0x7c3)](_0x20fc4e(0x182)); } return Promise[_0x20fc4e(0x9d9)](); } })); if (_0x10530c['isGenerating']) { let _0x4a15b6 = _0xa6230[_0x5629d7(0x838)](_0x5629d7(0x251)); !_0x4a15b6 && (_0x4a15b6 = document[_0x5629d7(0x3b9)]('div'), _0x4a15b6['className'] = _0x5629d7(0x3bc), _0x4a15b6['textContent'] = _0x5629d7(0x1de), _0xa6230[_0x5629d7(0x6ab)](_0x4a15b6)); } if (_0x562d76[_0x5629d7(0x848)] <= _0x10530c[_0x5629d7(0x880)]) { if (_0x5629d7(0x6ce) !== _0x5629d7(0x354)) requestAnimationFrame(() => { const _0x5f2ddd = _0x5629d7; _0xa6230[_0x5f2ddd(0x40d)] = _0xa6230[_0x5f2ddd(0x5ce)]; }); else { const _0x4daec4 = _0x44771c[_0x5629d7(0x248)]('global-player-play-pause-btn'); if (_0x4daec4) _0x4daec4[_0x5629d7(0x9ac)] = '❚❚'; } } } async function _0x1ee743(_0x41f2d7, _0x588f01) { const _0xbf7992 = _0x1da6ac, { role: _0x5670af, content: _0x4541c8, displayUrl: _0xc84c96, image: _0x36eedc, senderId: _0xfc51fe } = _0x41f2d7, _0xfacf34 = _0x5670af === _0xbf7992(0x7f0) ? 'ai' : _0x5670af, _0x46745c = _0x27b19d(), _0x438248 = document[_0xbf7992(0x3b9)]('div'); _0x438248[_0xbf7992(0x882)][_0xbf7992(0x7c3)](_0xbf7992(0x5d4), _0xfacf34), _0x438248['dataset']['historyIndex'] = _0x588f01; const _0x15e096 = document[_0xbf7992(0x3b9)](_0xbf7992(0x6ff)); _0x15e096[_0xbf7992(0x296)] = _0xbf7992(0x7b2); let _0x16311e = '', _0x184419 = ''; if (_0x5670af === _0xbf7992(0x27a)) { const _0x3b04ed = _0x474290(_0x10530c[_0xbf7992(0x16e)]); _0x16311e = _0x3b04ed[_0xbf7992(0x917)] || _0x45fac0; const _0x39e7c9 = _0x5b19fc(_0x46745c?.[_0xbf7992(0x26f)][0x0]); if (_0x39e7c9) { if ('FWfLo' !== _0xbf7992(0x538)) return new _0x2af79a(_0x3c2be6 => { const _0x231633 = _0xbf7992, _0x24d32c = _0x41088c[_0x231633(0x248)]('modal-root'), _0x52b2ac = _0x5bd0bd[_0x231633(0x248)](_0x231633(0x38e)), _0x3ee54a = _0x337075[_0x231633(0x248)](_0x231633(0x8d0)), _0x15a67a = _0x54c1e7[_0x231633(0x248)](_0x231633(0x969)), _0x2965e1 = _0xea8a74[_0x231633(0x248)](_0x231633(0x4a0)); _0x52b2ac[_0x231633(0x9ac)] = _0x2af2ec, _0x24d32c[_0x231633(0x10d)]['display'] = 'flex'; const _0x880db4 = _0x1e1c65 => { const _0x427631 = _0x231633; _0x24d32c[_0x427631(0x10d)][_0x427631(0x5eb)] = _0x427631(0x3fe), _0x3ee54a[_0x427631(0x935)] = _0x15a67a['onclick'] = _0x2965e1[_0x427631(0x935)] = null, _0x501fb0[_0x427631(0xa5e)](_0x427631(0x44b), _0x4c629f), _0x3c2be6(_0x1e1c65); }, _0x4c629f = _0x1694e1 => { const _0x251269 = _0x231633; if (_0x1694e1[_0x251269(0x797)] === _0x251269(0x137)) _0x880db4(![]); if (_0x1694e1['key'] === _0x251269(0x18b)) _0x880db4(!![]); }; _0x3ee54a[_0x231633(0x935)] = () => _0x880db4(!![]), _0x15a67a['onclick'] = () => _0x880db4(![]), _0x2965e1[_0x231633(0x935)] = () => _0x880db4(![]), _0x321192[_0x231633(0x578)]('keydown', _0x4c629f); }); else _0x184419 = _0x39e7c9[_0xbf7992(0x239)] || ''; } } else { let _0x44a9b1 = null; if (_0x46745c?.[_0xbf7992(0xa78)] === _0xbf7992(0x71a)) { if (_0xbf7992(0x707) === _0xbf7992(0x8e9)) { _0x463a68(); const _0x5234ea = _0x33685d(_0xbf7992(0x235), _0x369cb4[_0xbf7992(0x6b7)]); _0x5234ea && _0x5234ea[_0xbf7992(0x3ee)]() && _0x5234ea !== _0x1babd9[_0xbf7992(0x6b7)] && (_0x535faf['name'] = _0x5234ea[_0xbf7992(0x3ee)](), _0x35db1a(), _0x5d0cdd(), _0x2d9a98(), _0x48c425(_0xbf7992(0x51e) + _0x4c5b1f[_0xbf7992(0x6b7)] + '\x22。')); } else _0x44a9b1 = _0x5b19fc(_0x46745c[_0xbf7992(0x26f)][0x0]); } else { if (_0x46745c?.['type'] === _0xbf7992(0x732) && _0xfc51fe) { if (_0xbf7992(0x832) !== _0xbf7992(0xc9)) _0x44a9b1 = _0x5b19fc(_0xfc51fe); else { const _0x417917 = _0x22ff14[_0xbf7992(0x596)] ? _0xbe69ff(_0x15602b[_0xbf7992(0x596)]) : null; return _0x417917?.['name'] || 'Unknown'; } } } if (_0x44a9b1) { if (_0xbf7992(0x978) === 'FOvGV') { const _0x4d2a91 = _0x19aff1['createElement'](_0xbf7992(0x6ff)); _0x4d2a91['className'] = 'world-book-item', _0x4d2a91[_0xbf7992(0xab1)]['id'] = _0x193549['id'], _0x4d2a91['innerHTML'] = _0xbf7992(0x4ad) + _0x2d8fce[_0xbf7992(0x6b7)] + _0xbf7992(0x4ec) + _0x273a4d[_0xbf7992(0x9a8)][_0xbf7992(0x3f1)](0x0, 0x64) + _0xbf7992(0x659), _0x4d2a91[_0xbf7992(0x578)](_0xbf7992(0x4b3), () => _0x67c76c(_0x443cd8['id'])), _0x175aa3[_0xbf7992(0x6ab)](_0x4d2a91); } else { const _0x30ff78 = await _0x533d7a(_0xbf7992(0x583) + _0x44a9b1['id']); _0x30ff78 ? _0x16311e = URL[_0xbf7992(0x73d)](_0x30ff78) : _0x16311e = _0x44a9b1[_0xbf7992(0x917)] || _0x5da029, _0x184419 = _0x44a9b1[_0xbf7992(0x86f)] || ''; } } else _0x16311e = _0x5da029; } const _0x563ed4 = _0xfeba70(_0x16311e, _0x184419), _0xf59b92 = _0x4541c8 && _0x4541c8[_0xbf7992(0x3ee)]()['startsWith'](_0xbf7992(0x197)) && _0x4541c8[_0xbf7992(0x3ee)]()['endsWith'](_0xbf7992(0x489)); if (_0xf59b92) { const _0x3e58a5 = document[_0xbf7992(0x3b9)]('div'); _0x3e58a5[_0xbf7992(0x296)] = _0xbf7992(0x287), _0x3e58a5[_0xbf7992(0x9a1)] = _0x4541c8, _0xfacf34 === _0xbf7992(0x27a) ? (_0x15e096[_0xbf7992(0x6ab)](_0x3e58a5), _0x15e096[_0xbf7992(0x6ab)](_0x563ed4)) : (_0x15e096[_0xbf7992(0x6ab)](_0x563ed4), _0x15e096[_0xbf7992(0x6ab)](_0x3e58a5)); } else { const _0x118c34 = document[_0xbf7992(0x3b9)](_0xbf7992(0x6ff)); _0x118c34[_0xbf7992(0x882)]['add'](_0xbf7992(0x380), _0xfacf34); if (_0x46745c?.[_0xbf7992(0xa78)] === _0xbf7992(0x71a)) { if ('pwnKB' !== _0xbf7992(0x42f)) { const _0x2909ab = _0x46745c[_0xbf7992(0x26f)][0x0]; _0x118c34[_0xbf7992(0x882)]['add'](_0xbf7992(0x779) + _0x2909ab); } else { const _0x29f576 = _0x3c58aa[_0xbf7992(0x319)](_0xbde38d, 'readwrite'), _0x48d57d = _0x29f576[_0xbf7992(0x963)](_0x4edfbf), _0x593aed = _0x48d57d[_0xbf7992(0x845)](_0x4df5d4); _0x593aed[_0xbf7992(0x330)] = () => _0x585377(), _0x593aed[_0xbf7992(0x136)] = () => _0x4fb7c7(_0x593aed['error']); } } if (_0x41f2d7[_0xbf7992(0x86c)]) { if (_0xbf7992(0x764) === _0xbf7992(0x764)) { const _0x57b2f2 = document[_0xbf7992(0x3b9)]('div'); _0x57b2f2['className'] = _0xbf7992(0x64f); const _0x1e94e3 = document['createElement']('div'); _0x1e94e3[_0xbf7992(0x296)] = _0xbf7992(0x537), _0x1e94e3[_0xbf7992(0x9ac)] = _0x41f2d7['quotedMessage'][_0xbf7992(0x4be)]; const _0x42da62 = document[_0xbf7992(0x3b9)](_0xbf7992(0x6ff)); _0x42da62[_0xbf7992(0x296)] = _0xbf7992(0x87e), _0x42da62['textContent'] = _0x41f2d7[_0xbf7992(0x86c)]['content'], _0x57b2f2['appendChild'](_0x1e94e3), _0x57b2f2['appendChild'](_0x42da62), _0x118c34['appendChild'](_0x57b2f2); } else _0x124348('复制失败了，哼。'); } if (_0xc84c96) { _0x118c34['classList']['add'](_0xbf7992(0x6c0)); const _0x4d7c09 = document[_0xbf7992(0x3b9)](_0xbf7992(0x204)); _0x4d7c09[_0xbf7992(0x70a)] = _0xc84c96, _0x4d7c09['classList'][_0xbf7992(0x7c3)](_0xbf7992(0x513)), _0x118c34[_0xbf7992(0x6ab)](_0x4d7c09); } else { if (_0x41f2d7['image'] || _0x41f2d7[_0xbf7992(0x35f)]) { if (_0xbf7992(0x9dd) === _0xbf7992(0x702)) _0x41fe26(_0xbf7992(0x78c), _0xbf7992(0x345)), _0x4f5beb(![]); else { _0x118c34['classList']['add'](_0xbf7992(0x1a2)); const _0x199d7e = document[_0xbf7992(0x3b9)](_0xbf7992(0x204)); _0x199d7e['classList'][_0xbf7992(0x7c3)](_0xbf7992(0x741)), _0x118c34['appendChild'](_0x199d7e); if (_0x41f2d7[_0xbf7992(0x1a2)]) { if (_0xbf7992(0x97c) !== _0xbf7992(0x90c)) _0x199d7e['src'] = _0x41f2d7['image']; else { if (_0x3152cc[_0xbf7992(0x848)] === 0x0) return; _0x5bc011 = (_0x306b11 + 0x1) % _0x213ccd[_0xbf7992(0x848)], _0x3608b(_0x3931f2[_0x48826c], _0x5a15d5); } } else _0x199d7e[_0xbf7992(0x70a)] = _0xbf7992(0x97b), _0x533d7a(_0x41f2d7[_0xbf7992(0x35f)])[_0xbf7992(0x45f)](_0x3930e => { const _0x410c40 = _0xbf7992; if (_0x3930e) { const _0x2cd0e8 = URL[_0x410c40(0x73d)](_0x3930e); _0x199d7e[_0x410c40(0x70a)] = _0x2cd0e8, _0x199d7e['onload'] = () => { const _0x80092a = _0x410c40; URL[_0x80092a(0x8df)](_0x2cd0e8); }; } else _0x199d7e[_0x410c40(0x713)] = '图片加载失败'; })[_0xbf7992(0x77d)](_0x2b77b1 => { const _0x3dd722 = _0xbf7992; console[_0x3dd722(0x729)](_0x3dd722(0xaaf), _0x2b77b1), _0x199d7e['alt'] = _0x3dd722(0x872); }); if (_0x4541c8) { const _0x4059b7 = document[_0xbf7992(0x3b9)]('p'); _0x4059b7['style'][_0xbf7992(0x17e)] = '5px', _0x4059b7[_0xbf7992(0x9ac)] = _0x4541c8, _0x118c34['appendChild'](_0x4059b7); } } } else { if (_0x41f2d7[_0xbf7992(0xa78)] === _0xbf7992(0x270)) { _0x118c34['classList'][_0xbf7992(0x7c3)](_0xbf7992(0x270)); const _0x2d2b71 = _0x41f2d7[_0xbf7992(0x34a)] === _0xbf7992(0x27a) ? _0x474290(_0x10530c[_0xbf7992(0x16e)]) : _0x5b19fc(_0x41f2d7[_0xbf7992(0x596)]), _0x284764 = _0x41f2d7[_0xbf7992(0x95e)] === _0x474290(_0x10530c[_0xbf7992(0x16e)])['id'] ? _0x474290(_0x10530c[_0xbf7992(0x16e)]) : _0x5b19fc(_0x41f2d7['recipientId']), _0x3b54d9 = _0x2d2b71?.['name'] ? _0x2d2b71[_0xbf7992(0x6b7)] + '的转账' : '转账', _0x5df83d = _0x284764?.[_0xbf7992(0x6b7)] ? _0xbf7992(0xaa9) + _0x284764[_0xbf7992(0x6b7)] : '转账', _0x5e1e36 = _0xbf7992(0x15b) + _0x3b54d9 + _0xbf7992(0x491) + _0x41f2d7[_0xbf7992(0x46e)][_0xbf7992(0x7d5)](0x2) + _0xbf7992(0x657) + _0x5df83d + _0xbf7992(0x562); _0x118c34['innerHTML'] = _0x5e1e36; } else { if (_0x41f2d7[_0xbf7992(0xa78)] === _0xbf7992(0x4a3)) { if (_0xbf7992(0x8fa) === _0xbf7992(0x37d)) { const _0x2a4e6d = _0xbf7992(0x3e4); _0xeae412[_0xbf7992(0x3ec)]['insertAdjacentHTML'](_0xbf7992(0x1bf), _0x2a4e6d); const _0x15150a = _0xdde2a8[_0xbf7992(0x248)](_0xbf7992(0x506)), _0x4d30be = _0x3f4980[_0xbf7992(0x248)](_0xbf7992(0x48c)), _0x498718 = _0x5f5533[_0xbf7992(0x248)](_0xbf7992(0x25b)), _0x1baf33 = _0x1ad482[_0xbf7992(0x248)](_0xbf7992(0xacb)), _0x3f3946 = _0x15150a[_0xbf7992(0x838)]('.choice-modal-backdrop'), _0x32046d = () => { const _0x1378a5 = _0xbf7992; _0x15150a[_0x1378a5(0xae0)](), _0x1e6d8c(); }; _0x498718['onclick'] = () => { _0x17ac6d(_0x4d30be['value']), _0x32046d(); }, _0x1baf33['onclick'] = _0x32046d, _0x3f3946[_0xbf7992(0x935)] = _0x32046d; } else { _0x118c34[_0xbf7992(0x882)][_0xbf7992(0x7c3)](_0xbf7992(0x868)); const _0x3573a7 = document[_0xbf7992(0x3b9)](_0xbf7992(0x6ff)); _0x3573a7[_0xbf7992(0x296)] = 'listen-together-card', _0x3573a7[_0xbf7992(0x882)][_0xbf7992(0x7c3)]('no-action-modal'); const _0x4a2656 = _0x41f2d7[_0xbf7992(0x34a)] === 'user' ? _0x474290(_0x10530c[_0xbf7992(0x16e)])['name'] || '你' : _0x5b19fc(_0x41f2d7['senderId'])?.[_0xbf7992(0x6b7)] || 'TA', _0x1fabc3 = _0xbf7992(0x170) + _0x41f2d7[_0xbf7992(0x908)], _0x62631 = '<img\x20id=\x22' + _0x1fabc3 + _0xbf7992(0x3d2) + _0x5da029 + '\x22>'; _0x41f2d7[_0xbf7992(0x242)] && _0x533d7a(_0x41f2d7[_0xbf7992(0x242)])[_0xbf7992(0x45f)](_0x5b079d => { const _0x29dc5e = _0xbf7992, _0x19fc77 = document[_0x29dc5e(0x248)](_0x1fabc3); if (_0x19fc77 && _0x5b079d) _0x19fc77[_0x29dc5e(0x70a)] = URL['createObjectURL'](_0x5b079d); }), _0x41f2d7[_0xbf7992(0xa30)] ? _0x3573a7[_0xbf7992(0x9a1)] = _0xbf7992(0xac6) + _0x62631 + _0xbf7992(0x5f9) + _0x41f2d7[_0xbf7992(0x6d2)] + _0xbf7992(0x5c8) + _0x41f2d7[_0xbf7992(0x755)] + _0xbf7992(0xa4d) : _0x3573a7[_0xbf7992(0x9a1)] = _0xbf7992(0x613) + _0x4a2656 + _0xbf7992(0x641) + _0x62631 + _0xbf7992(0x5f9) + _0x41f2d7['songName'] + _0xbf7992(0x5c8) + _0x41f2d7['artist'] + _0xbf7992(0x127) + _0x41f2d7[_0xbf7992(0x181)] + _0xbf7992(0x42e), _0x118c34[_0xbf7992(0x6ab)](_0x3573a7); } } else { if (_0x41f2d7[_0xbf7992(0xa78)] === 'music' && _0x41f2d7[_0xbf7992(0x6d2)]) { _0x118c34[_0xbf7992(0x882)][_0xbf7992(0x7c3)](_0xbf7992(0x868)); const _0xb36cc4 = document['createElement'](_0xbf7992(0x6ff)); _0xb36cc4['className'] = _0xbf7992(0xa20), _0xb36cc4[_0xbf7992(0xab1)]['musicId'] = _0xbf7992(0x10a) + _0x41f2d7[_0xbf7992(0x908)]; const _0x28cb37 = _0xbf7992(0x170) + _0x41f2d7[_0xbf7992(0x908)], _0xf1424e = _0xbf7992(0x2ae) + _0x5da029 + _0xbf7992(0x8ab) + _0x28cb37 + _0xbf7992(0x36c); if (_0x41f2d7[_0xbf7992(0x242)]) _0x533d7a(_0x41f2d7[_0xbf7992(0x242)])['then'](_0x5cc46c => { const _0x362ecc = _0xbf7992, _0x436b92 = document[_0x362ecc(0x248)](_0x28cb37); if (_0x436b92 && _0x5cc46c) _0x436b92[_0x362ecc(0x70a)] = URL[_0x362ecc(0x73d)](_0x5cc46c); }); else _0x41f2d7['coverUrl'] && setTimeout(() => { const _0x1525b1 = _0xbf7992; if (_0x1525b1(0x2e7) === 'pYqiQ') { const _0x2a6625 = document[_0x1525b1(0x248)](_0x28cb37); if (_0x2a6625) _0x2a6625[_0x1525b1(0x70a)] = _0x41f2d7[_0x1525b1(0x2ab)]; } else _0x42437a = _0x6fc644[_0x1525b1(0x329)](_0x128533); }, 0x0); _0xb36cc4['innerHTML'] = _0xbf7992(0x5e5) + _0xf1424e + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x41f2d7[_0xbf7992(0x6d2)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x41f2d7[_0xbf7992(0x755)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>' + (_0x41f2d7[_0xbf7992(0x5e3)] ? '▶' : '⚠') + '</div>', _0x41f2d7[_0xbf7992(0x5e3)] && _0xb36cc4[_0xbf7992(0x578)](_0xbf7992(0x4b3), function () { const _0x42d713 = _0xbf7992, _0x2307ee = { 'id': _0x42d713(0x10a) + _0x41f2d7[_0x42d713(0x908)], 'url': _0x41f2d7[_0x42d713(0x5e3)] }; _0xb9b242(this, _0x2307ee); }), _0x118c34[_0xbf7992(0x6ab)](_0xb36cc4); } else { if (_0x4541c8) { if (_0xbf7992(0x3fc) === _0xbf7992(0x3b6)) _0x438829['addEventListener'](_0xbf7992(0x4b3), () => { const _0x40841b = _0xbf7992, _0x2e851e = _0x1c9868[_0x40841b(0x329)](_0x3bf213['dataset']['log'][_0x40841b(0x7cf)](/&quot;/g, '\x22')), _0x439400 = _0x18a4c6[_0x40841b(0xab1)][_0x40841b(0x6a8)], _0x255008 = _0x18035d['dataset']['characterName']; _0x444372(_0x439400, _0x255008, _0x2e851e); }); else { const _0x307e67 = document[_0xbf7992(0x3b9)]('p'); _0x307e67['innerHTML'] = _0x4541c8, _0x307e67[_0xbf7992(0x10d)][_0xbf7992(0x1e8)] = '0', _0x118c34[_0xbf7992(0x6ab)](_0x307e67); } } } } } } } if (_0xfacf34 === 'user') _0x15e096['appendChild'](_0x118c34), _0x15e096[_0xbf7992(0x6ab)](_0x563ed4); else { if (_0xbf7992(0x973) === 'lXKVj') _0x15e096[_0xbf7992(0x6ab)](_0x563ed4), _0x15e096['appendChild'](_0x118c34); else { _0x44e1f0['apiSettings']['endpoint'] = _0x13a884['value'][_0xbf7992(0x3ee)](), _0x3fe539[_0xbf7992(0x899)][_0xbf7992(0x797)] = _0x415a47[_0xbf7992(0xe5)][_0xbf7992(0x3ee)](), _0x43988b[_0xbf7992(0x899)][_0xbf7992(0x43a)] = _0x3edba2[_0xbf7992(0xe5)][_0xbf7992(0x3ee)](), _0x31a1c8['apiSettings']['provider'] = _0x88f5dc['getElementById'](_0xbf7992(0x6ea))['value']; const _0x116ca7 = _0x2dbe4a(_0x5d2fc2[_0xbf7992(0xe5)], 0xa); _0x38c680['preferences'][_0xbf7992(0x2f8)] = _0x4855b0[_0xbf7992(0x171)](_0x116ca7) && _0x116ca7 > 0x0 ? _0x116ca7 : 0x64, _0x2d0e0e(), _0x3c655b('设置已保存！'); } } } _0x438248[_0xbf7992(0x6ab)](_0x15e096); const _0x3cc944 = document['createElement'](_0xbf7992(0x6ff)); return _0x3cc944[_0xbf7992(0x296)] = _0xbf7992(0x908), _0x3cc944[_0xbf7992(0x9ac)] = _0x541048(_0x41f2d7[_0xbf7992(0x908)]), _0x438248[_0xbf7992(0x6ab)](_0x3cc944), _0xa6230[_0xbf7992(0x6ab)](_0x438248), _0x438248; } document[_0x1da6ac(0x248)](_0x1da6ac(0x8ac))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x1ba258); let _0x3bfb89 = null, _0x5864e0 = null; function _0x1ba258(_0x51f890) { const _0x362d1e = _0x1da6ac; if (window[_0x362d1e(0x95c)]()[_0x362d1e(0x79d)]()) { if (_0x362d1e(0x1e3) === 'mAIyI') { const _0x2ecff4 = _0xe97cae[_0x362d1e(0x319)]('images', 'readwrite'), _0x143820 = _0x2ecff4[_0x362d1e(0x963)]('images'), _0x3945e6 = _0x143820[_0x362d1e(0xa8b)]({ 'id': _0x2eefbf, 'blob': _0xfce4bb }); _0x3945e6[_0x362d1e(0x330)] = () => _0x1f400a(_0x3945e6[_0x362d1e(0x4f7)]), _0x3945e6['onerror'] = () => _0x3b251a(_0x3945e6[_0x362d1e(0x729)]); } else return; } const _0x589b93 = _0x51f890[_0x362d1e(0x6c4)][_0x362d1e(0x939)](_0x362d1e(0x980)), _0x50d357 = _0x51f890['target'][_0x362d1e(0x939)]('.no-action-modal'); if (!_0x589b93 || _0x50d357) return; const _0x5969d8 = parseInt(_0x589b93[_0x362d1e(0xab1)][_0x362d1e(0x215)], 0xa); if (isNaN(_0x5969d8)) return; _0x1351da(_0x5969d8); } function _0x59b7f0() { const _0x59c674 = _0x1da6ac; if (_0x59c674(0x84a) !== _0x59c674(0x84a)) _0x22aed3[_0x59c674(0x882)][_0x59c674(0xae0)](_0x59c674(0x89e)); else { const _0xfcb2c = _0x27b19d(); if (!_0xfcb2c) { if (_0x59c674(0x690) !== _0x59c674(0x690)) _0x4b7eb1['classList'][_0x59c674(0xae0)](_0x59c674(0x11b)); else { _0x43c970[_0x59c674(0x9ac)] = _0x59c674(0x962); return; } } if (_0xfcb2c[_0x59c674(0xa78)] === _0x59c674(0x71a)) { const _0x2255b8 = _0x5b19fc(_0xfcb2c['participantIds'][0x0]); _0x43c970[_0x59c674(0x9ac)] = _0x2255b8 ? _0x2255b8[_0x59c674(0x6b7)] : _0x59c674(0x187); } else { if ('jxwKz' === _0x59c674(0x56a)) _0x43c970[_0x59c674(0x9ac)] = _0xfcb2c[_0x59c674(0x6b7)] || _0x59c674(0x48e) + _0xfcb2c[_0x59c674(0x26f)][_0x59c674(0x848)] + ')'; else { _0xb50207(_0x59c674(0x772) + _0x583632 + '\x20张旧封面。应用即将刷新。'), _0x35eff6(() => _0x3f146e[_0x59c674(0x7a6)](), 0x5dc); return; } } } } function _0x1cdcc1(_0x35dd70) { const _0x8acc4 = _0x1da6ac; if ('UBVFF' !== _0x8acc4(0x947)) { const _0x4610fd = document[_0x8acc4(0x838)](_0x8acc4(0x7dd)); if (_0x4610fd && (_0x4610fd['id'] === 'meeting-view-screen' || _0x4610fd['id'] === _0x8acc4(0x514))) _0x8acc4(0x4d9) === _0x8acc4(0x4d9) ? _0x58f59d() : _0x2d5a31[_0x8acc4(0x578)](_0x8acc4(0x4b3), () => { const _0x44ae57 = _0x8acc4; if (_0x4c9440[_0x44ae57(0x848)] === 0x0) return; _0xb4397f = (_0x24cfd4 - 0x1 + _0x189211[_0x44ae57(0x848)]) % _0x3c64f0['length'], _0x203386(_0x587faa[_0x48354a], _0x5415c5); }); else { const _0x44e315 = document[_0x8acc4(0x20d)](_0x8acc4(0x251)); _0x44e315[_0x8acc4(0x986)](_0x5a0abe => _0x5a0abe[_0x8acc4(0xae0)]()); } } else _0x5c833['style']['display'] = _0x8acc4(0x3fe); } function _0x39ae19() { const _0x209ac6 = _0x1da6ac; if (_0x209ac6(0x6b3) !== _0x209ac6(0x887)) { if (_0x10530c[_0x209ac6(0xa4a)] && _0x10530c[_0x209ac6(0x557)]) { if (_0x209ac6(0x5cf) === _0x209ac6(0x541)) return new _0x27d497((_0x509231, _0x3e0bd4) => { const _0x3b827f = _0x209ac6, _0x17b2ff = new _0x48e910(); _0x17b2ff[_0x3b827f(0x7b5)] = () => _0x509231(_0x17b2ff['result']), _0x17b2ff[_0x3b827f(0x136)] = _0x3e0bd4, _0x17b2ff['readAsDataURL'](_0x4d15eb); }); else console[_0x209ac6(0x5e0)](_0x209ac6(0xa88)), _0x10530c[_0x209ac6(0x557)][_0x209ac6(0x8f2)](_0x209ac6(0x3fd)), _0x10530c[_0x209ac6(0x557)] = null; } _0x10530c[_0x209ac6(0xa4a)] = ![], _0x1cdcc1(![]); } else { const _0x4a9997 = _0x1206b8[_0x209ac6(0x3b9)](_0x209ac6(0x737)); _0x4a9997[_0x209ac6(0x9a1)] = _0x209ac6(0xcc) + _0x20f672['id'] + '\x22>\x20' + _0x5f3d7b[_0x209ac6(0x6b7)], _0x2b75d5[_0x209ac6(0x6ab)](_0x4a9997); } } function _0x27b19d() { const _0xd3a3c0 = _0x1da6ac; if (_0xd3a3c0(0x272) !== 'dHGMb') { if (_0x5b694a) _0x98d569['remove'](); } else return _0x10530c['chats']['find'](_0x153449 => _0x153449['id'] === _0x10530c['activeChatId']); } function _0x5b19fc(_0x412459) { const _0x3159bd = _0x1da6ac; return _0x10530c[_0x3159bd(0x620)][_0x3159bd(0x212)](_0x39ca32 => _0x39ca32['id'] === _0x412459); } function _0xc0ecab(_0x5a7bd3) { const _0x2cdec9 = _0x1da6ac; if ('IEaON' !== 'NvMCH') { _0x10530c[_0x2cdec9(0x620)] = _0x10530c['characters'][_0x2cdec9(0x54e)](_0x15656b => _0x15656b['id'] !== _0x5a7bd3), _0x10530c[_0x2cdec9(0x4bc)]['forEach'](_0x28baac => { const _0x25fb9e = _0x2cdec9; _0x25fb9e(0x33a) !== _0x25fb9e(0x66f) ? _0x28baac[_0x25fb9e(0xa78)] === _0x25fb9e(0x732) && (_0x25fb9e(0x107) !== _0x25fb9e(0x107) ? (_0x2eb52c[_0x25fb9e(0x729)]('加载自定义表情包失败，真是没用。', _0x3ee31d), _0x4d050a = _0x7908e8) : _0x28baac[_0x25fb9e(0x26f)] = _0x28baac['participantIds'][_0x25fb9e(0x54e)](_0x276a87 => _0x276a87 !== _0x5a7bd3)) : _0x19a369 = _0x5a3b4d['image']; }); const _0x1de6ef = _0x10530c['chats'][_0x2cdec9(0x212)](_0x3d6887 => _0x3d6887['type'] === 'private' && _0x3d6887[_0x2cdec9(0x26f)]['includes'](_0x5a7bd3)); _0x1de6ef && _0x4d3eff(_0x1de6ef['id']), _0x10530c[_0x2cdec9(0x4bc)] = _0x10530c[_0x2cdec9(0x4bc)]['filter'](_0x5f3f24 => _0x5f3f24[_0x2cdec9(0xa78)] !== 'group' || _0x5f3f24[_0x2cdec9(0x26f)][_0x2cdec9(0x848)] > 0x1), _0x3e6d3a(), _0x398205(); } else _0x98d74e['spriteTransform'] = _0x511aca, _0x234807(_0x1f2df5[_0x2cdec9(0x5cb)], _0x2cdec9(0x47b)); } function _0x4d3eff(_0x1365fd) { const _0x40a497 = _0x1da6ac; if (_0x40a497(0x8a3) === 'NYrOf') { _0x10530c[_0x40a497(0x4bc)] = _0x10530c['chats'][_0x40a497(0x54e)](_0x2f0dfa => _0x2f0dfa['id'] !== _0x1365fd); try { localStorage[_0x40a497(0x89a)](_0x40a497(0x13c) + _0x1365fd); } catch (_0x782097) { console[_0x40a497(0x729)](_0x40a497(0x38d) + _0x1365fd, _0x782097); } _0x10530c['activeChatId'] === _0x1365fd && (_0x40a497(0x100) !== 'BCPtc' ? _0x3e3461 += _0x40a497(0xaba) : (_0x10530c[_0x40a497(0x16e)] = _0x10530c[_0x40a497(0x4bc)][0x0]?.['id'] || null, _0x1bdd79(_0x10530c[_0x40a497(0x16e)]))), _0x3e6d3a(), _0x398205(); } else { _0x167f9e && _0x59758e[_0x40a497(0x36b)](_0x337cae); _0x23a5f0 = {}; const _0x2a0cc4 = _0x6cad12[_0x40a497(0x3f1)](0x2), _0x4b0498 = _0x2a0cc4[_0x40a497(0x5ac)](/:\s(.+)/); if (_0x4b0498[_0x40a497(0x848)] > 0x1) { const _0x4e9ab5 = _0x4b0498[0x0]['trim'](), _0x1b758a = _0x4b0498[0x1][_0x40a497(0x3ee)]()[_0x40a497(0x7cf)](/^"|"$/g, ''); _0xd243f5[_0x4e9ab5] = _0x1b758a; } } } async function _0x1bdd79(_0x145e38) { const _0x1fb761 = _0x1da6ac; if (_0x10530c[_0x1fb761(0x16e)] !== _0x145e38) { if (_0x1fb761(0x784) !== _0x1fb761(0x784)) { const _0x3d046e = _0x8a15b4[_0x1fb761(0x7b9)][_0x1fb761(0x212)](_0x1676b7 => _0x1676b7['id'] === _0x46b90b); if (!_0x3d046e) return; _0x15ba03['textContent'] = _0x1fb761(0x8bd), _0x321c7b[_0x1fb761(0xe5)] = _0x3d046e['id'], _0x4fc906[_0x1fb761(0xe5)] = _0x3d046e['name'], _0x27327f['value'] = _0x3d046e[_0x1fb761(0x2eb)], _0x463880[_0x1fb761(0x10d)]['display'] = _0x1fb761(0x92c), _0x3d046e['memberCharacterIds']['forEach'](_0x39bb13 => { const _0x3d2ab2 = _0x1fb761, _0x11d6b3 = _0x2c6f0f[_0x3d2ab2(0x838)](_0x3d2ab2(0xa36) + _0x39bb13); if (_0x11d6b3) _0x11d6b3['checked'] = !![]; }); } else _0x39ae19(), _0x10530c[_0x1fb761(0x880)] = 0x64; } if (!_0x145e38) { _0x10530c[_0x1fb761(0x16e)] = null, _0x3e6d3a(), _0x2b7059(![]), document['getElementById'](_0x1fb761(0x738))[_0x1fb761(0x10d)][_0x1fb761(0xad9)] = ''; return; } _0x10530c[_0x1fb761(0x16e)] = _0x145e38, _0x3e6d3a(), _0x59b7f0(), _0xa6230[_0x1fb761(0x9a1)] = '', _0xbc2d1c(!![], _0x1fb761(0x384)), setTimeout(async () => { const _0x1cc212 = _0x1fb761; try { _0x20c635(); const _0x180301 = _0x27b19d(), _0x5bdc62 = document[_0x1cc212(0x248)](_0x1cc212(0x738)); let _0x459e5d = null; if (_0x180301) { if (_0x180301[_0x1cc212(0xa78)] === 'private') { const _0x3c9622 = _0x180301['participantIds'][0x0]; _0x3b3884(_0x3c9622), _0x459e5d = await _0x533d7a(_0x1cc212(0x72e) + _0x3c9622); } else _0x459e5d = await _0x533d7a(_0x1cc212(0x1cc) + _0x180301['id']); _0x459e5d ? (_0x5bdc62['style'][_0x1cc212(0xad9)] = _0x1cc212(0x7a2) + URL[_0x1cc212(0x73d)](_0x459e5d) + '\x27)', _0x5bdc62['style'][_0x1cc212(0xc2)] = 'cover', _0x5bdc62[_0x1cc212(0x10d)][_0x1cc212(0x53b)] = _0x1cc212(0x1ff)) : _0x5bdc62[_0x1cc212(0x10d)]['backgroundImage'] = ''; } await _0x1a245d(); } catch (_0x3afa45) { console['error'](_0x1cc212(0xa47), _0x3afa45), _0x3a6c86(_0x1cc212(0x56e) + _0x3afa45[_0x1cc212(0x380)]); } finally { 'cyIxc' !== 'rcJHp' ? _0xbc2d1c(![]) : _0x163045 = _0x59cae4[_0x1cc212(0x329)](_0x3c99cc); } }, 0x32); } async function _0x3644d3() { const _0x3bfcc4 = _0x1da6ac; if (_0x3bfcc4(0x20f) !== 'KuoSm') _0x3fd52e[_0x3bfcc4(0x248)]('snoop-copy-summary-btn')[_0x3bfcc4(0x578)](_0x3bfcc4(0x4b3), () => { const _0x138a9f = _0x3bfcc4, _0x3ab73f = _0x140c44['getElementById'](_0x138a9f(0x5d9)); _0x3ab73f[_0x138a9f(0x585)](), _0x3bde4a[_0x138a9f(0x1ea)](_0x138a9f(0x81b)), _0x4fdef7(_0x138a9f(0x47a)); }); else { if (_0x10530c[_0x3bfcc4(0xa4a)]) { if (_0x3bfcc4(0x503) !== _0x3bfcc4(0x503)) _0x19517b[_0x5ea701[_0x240702]] = _0x8285f; else { _0x3a6c86(_0x3bfcc4(0x25c)); return; } } const _0xa723bb = _0x10530c[_0x3bfcc4(0x675)]; if (_0xa723bb['length'] === 0x0) return; let _0x3a2428 = -0x1; for (let _0x3556b2 = _0xa723bb[_0x3bfcc4(0x848)] - 0x1; _0x3556b2 >= 0x0; _0x3556b2--) { if (_0xa723bb[_0x3556b2][_0x3bfcc4(0x34a)] === _0x3bfcc4(0x27a)) { _0x3a2428 = _0x3556b2; break; } } if (_0x3a2428 === -0x1 || _0x3a2428 === _0xa723bb['length'] - 0x1) { if (_0x3bfcc4(0xa65) === _0x3bfcc4(0x349)) { const _0x1cdea0 = _0x500605[_0x3bfcc4(0x838)](_0x3bfcc4(0xf9)); _0x1cdea0 && _0x1cdea0[_0x3bfcc4(0x578)](_0x3bfcc4(0x4b3), function () { const _0x5e20c3 = { 'id': _0x31cb2b['id'], 'url': _0x476eaf['playableUrl'] }; _0x33ac4a(this, _0x5e20c3); }); } else { _0x3a6c86(_0x3bfcc4(0x8d6)); return; } } _0xa723bb[_0x3bfcc4(0x2f2)](_0x3a2428 + 0x1), _0x10530c[_0x3bfcc4(0x1f5)] = [], _0x4a0ca0(), _0x13c1d5(), _0x2e959a(_0x10530c[_0x3bfcc4(0x5cb)]), setTimeout(() => { const _0x206294 = _0x3bfcc4; 'RMzwY' === _0x206294(0x18e) ? (_0x4277a9[_0x206294(0x360)] = _0x4a2c1d[_0x206294(0x360)][_0x206294(0x54e)](_0x3642ba => _0x3642ba['id'] !== _0x3bb7c7), _0xfb9ef9['activeUserProfileId'] === _0x41fde3 && (_0x52f260[_0x206294(0x663)] = _0x1dc778[_0x206294(0x360)][0x0]['id']), _0x2349d4['chats'][_0x206294(0x986)](_0x54a182 => { const _0x36dcf0 = _0x206294; _0x54a182[_0x36dcf0(0x2eb)] === _0x4dbba4 && (_0x54a182[_0x36dcf0(0x2eb)] = _0x587f70[_0x36dcf0(0x663)]); }), _0x390278(), _0xf29383(_0x206294(0x297)), _0x419dfc(), _0x4dd780(_0x206294(0x51d), _0x206294(0x1c9))) : _0x3990cb(); }, 0x64); } } async function _0x5719b1() { const _0x397aa4 = _0x1da6ac; if (_0x10530c[_0x397aa4(0xa4a)]) { _0x3a6c86(_0x397aa4(0x800)); return; } const _0x220ad9 = _0x10530c[_0x397aa4(0x675)]; if (_0x220ad9['length'] === 0x0) return; let _0x5841b4 = -0x1; for (let _0x16a4dc = _0x220ad9[_0x397aa4(0x848)] - 0x1; _0x16a4dc >= 0x0; _0x16a4dc--) { if (_0x220ad9[_0x16a4dc][_0x397aa4(0x34a)] === _0x397aa4(0x27a)) { _0x5841b4 = _0x16a4dc; break; } } if (_0x5841b4 === -0x1 || _0x5841b4 === _0x220ad9['length'] - 0x1) { if (_0x397aa4(0xea) !== 'LzyME') { _0x3a6c86(_0x397aa4(0x32a)); return; } else _0x243460(), _0x1dbe47('musicLibrary', _0x397aa4(0x362)); } _0x220ad9[_0x397aa4(0x2f2)](_0x5841b4 + 0x1), _0x4a0ca0(), _0x58f59d(), setTimeout(() => { _0x3990cb(); }, 0x64); } function _0x18bc5f(_0x1f7513 = null) { const _0x35e9ad = _0x1da6ac; if ('iiBBD' !== 'iiBBD') _0x5c23b5['error']('加载已保存字体失败:', _0x2dfd8c); else { const _0x273bec = _0x1f7513 ?? _0x240b04[_0x35e9ad(0xe5)][_0x35e9ad(0x3ee)](); if (_0x273bec === '' || !_0x10530c['activeChatId']) return; const _0xcf16fb = document[_0x35e9ad(0x838)](_0x35e9ad(0x7dd)), _0x52ce60 = _0xcf16fb['id'] === _0x35e9ad(0x99f), _0x1ab603 = { 'role': 'user', 'content': _0x273bec, 'timestamp': Date[_0x35e9ad(0x7a8)](), 'isOffline': _0x52ce60 }; _0x10530c['activeQuote'] && (_0x1ab603[_0x35e9ad(0x86c)] = { ..._0x10530c[_0x35e9ad(0x618)] }), _0x10530c[_0x35e9ad(0x675)]['push'](_0x1ab603), _0x4a0ca0(), _0x58f59d(), !_0x1f7513 && (_0x240b04[_0x35e9ad(0xe5)] = ''), _0x5e1d22(); } } function _0x5c347d(_0x2312f3) { const _0x31d813 = _0x1da6ac; if (_0x31d813(0xa5d) !== _0x31d813(0xa5d)) try { const _0x1cb482 = _0x5d0f27['getItem']('chatHistory_' + _0x41668d), _0x11174e = _0x209562['parse'](_0x1cb482 || '[]'); return _0xdbf44a[_0x31d813(0x796)](_0x11174e) ? _0x11174e : []; } catch { return []; } else { if (!_0x2312f3 || !_0x10530c['activeChatId']) return; const _0x2df60f = { 'role': _0x31d813(0x27a), 'content': _0x31d813(0x7aa) + _0x2312f3[_0x31d813(0x6b7)] + ']', 'displayUrl': _0x2312f3[_0x31d813(0x83a)], 'timestamp': Date[_0x31d813(0x7a8)]() }; _0x10530c[_0x31d813(0x675)][_0x31d813(0x36b)](_0x2df60f), _0x1ee743(_0x2df60f, _0x10530c[_0x31d813(0x675)]['length'] - 0x1), _0x4a0ca0(), _0x474876[_0x31d813(0x882)][_0x31d813(0xae0)](_0x31d813(0x11b)); } } async function _0x787342(_0x4f0fcc) { const _0x49ac7e = _0x1da6ac, _0x1be9f0 = _0x4f0fcc[_0x49ac7e(0x6c4)][_0x49ac7e(0x5fc)][0x0]; if (!_0x1be9f0 || !_0x10530c['activeChatId']) return; _0xbc2d1c(!![], _0x49ac7e(0x36a)); try { const _0x75b3 = await _0xa06749(_0x1be9f0, 0x320, 0.8, !![]), _0x169148 = _0x49ac7e(0x441) + Date['now'](); await _0x5ef29b(_0x169148, _0x75b3); const _0x544bfd = _0x240b04[_0x49ac7e(0xe5)][_0x49ac7e(0x3ee)](); _0x240b04['value'] = ''; const _0x104a6a = { 'role': _0x49ac7e(0x27a), 'content': _0x544bfd, 'imageId': _0x169148, 'timestamp': Date[_0x49ac7e(0x7a8)]() }; _0x10530c[_0x49ac7e(0x675)]['push'](_0x104a6a), _0x1ee743(_0x104a6a, _0x10530c[_0x49ac7e(0x675)][_0x49ac7e(0x848)] - 0x1), _0x4a0ca0(); } catch (_0x38ba12) { _0x3a6c86('图片处理失败:\x20' + _0x38ba12[_0x49ac7e(0x380)]); } finally { if (_0x49ac7e(0x961) !== 'eoVQI') _0xbc2d1c(![]), _0x4f0fcc[_0x49ac7e(0x6c4)]['value'] = ''; else for (const _0x3379f1 in _0x54d2d5) { _0x284f5a[_0x49ac7e(0x10d)][_0x3379f1] = _0xedfe37[_0x3379f1]; } } } async function _0x4962ef() { const _0x32263b = _0x1da6ac; if (_0x32263b(0x854) === _0x32263b(0x673)) return _0x697597(_0x3620b6)['then'](_0x3daae7 => _0x3daae7[_0x32263b(0x226)]()); else { if (!_0x10530c['activeChatId']) return; const _0xc310bf = await _0x2329d7(); if (!_0xc310bf) return; _0x3a6c86(_0x32263b(0x701)); try { const _0x74f2dc = await _0x57d1c9(_0xc310bf[_0x32263b(0x6d2)], _0xc310bf[_0x32263b(0x755)]); let _0x34f90c = _0x74f2dc[_0x32263b(0x55a)]; if (_0x74f2dc[_0x32263b(0x55a)] && _0x74f2dc['cover'][_0x32263b(0x33c)](_0x32263b(0x23d))) { if (_0x32263b(0x409) !== _0x32263b(0x525)) try { if (_0x32263b(0x9c8) !== _0x32263b(0x7ef)) { const _0x257704 = await fetch(_0x74f2dc[_0x32263b(0x55a)]), _0x174484 = await _0x257704[_0x32263b(0x226)](); _0x34f90c = await _0x3c4a4d(_0x174484); } else !_0x49cf86 && (_0x563e13 = _0x40205c[_0x32263b(0x3b9)](_0x32263b(0x6ff)), _0x107b5d['id'] = _0x32263b(0x26c), _0x4e2964[_0x32263b(0x6ab)](_0x2e78c4)), _0x3d2e75[_0x32263b(0x9a1)] = _0x32263b(0x535) + _0x2cd39b + _0x32263b(0x955), _0x429e08[_0x32263b(0x10d)][_0x32263b(0x5eb)] = _0x32263b(0x4ef); } catch (_0x42f54d) { console[_0x32263b(0x729)](_0x32263b(0x6f7), _0x42f54d), _0x34f90c = _0x5da029; } else _0x5859ef[_0x32263b(0x26f)][_0x32263b(0x986)](_0x1b1f3c => { const _0xbb6d1f = _0x32263b, _0x28914d = _0x26f199(_0x1b1f3c); if (_0x28914d) { const _0x5cce27 = _0x3b877b[_0xbb6d1f(0x3b9)](_0xbb6d1f(0x99e)); _0x5cce27[_0xbb6d1f(0xe5)] = _0x28914d['id'], _0x5cce27['textContent'] = _0x28914d[_0xbb6d1f(0x6b7)], _0x291782[_0xbb6d1f(0x6ab)](_0x5cce27); } }), _0x443c65[_0x32263b(0x10d)]['display'] = _0x32263b(0x92c); } const _0x2c11a9 = { 'role': _0x32263b(0x27a), 'type': _0x32263b(0x868), 'content': _0x32263b(0x163) + _0xc310bf['songName'] + _0x32263b(0x23b) + _0xc310bf[_0x32263b(0x755)] + ']', 'songName': _0xc310bf['songName'], 'artist': _0xc310bf[_0x32263b(0x755)], 'coverUrl': _0x34f90c, 'playableUrl': _0x74f2dc[_0x32263b(0x83a)], 'timestamp': Date[_0x32263b(0x7a8)]() }; _0x10530c['conversationHistory'][_0x32263b(0x36b)](_0x2c11a9), _0x1ee743(_0x2c11a9, _0x10530c[_0x32263b(0x675)][_0x32263b(0x848)] - 0x1), _0x4a0ca0(); } catch (_0x12c45a) { if (_0x32263b(0x29f) === _0x32263b(0x29f)) console['error'](_0x32263b(0x9fc), _0x12c45a), _0x3a6c86('搜索失败:\x20' + _0x12c45a['message']); else { const _0x4790b6 = _0x11a5cd['getElementById'](_0x32263b(0xcd)), _0x4f48a0 = _0x231cd0[_0x32263b(0x248)](_0x32263b(0x38e)), _0x3e3086 = _0x2e1873['getElementById']('modal-ok'), _0x51f51e = _0x6904d7[_0x32263b(0x248)]('modal-cancel'), _0x4e0e38 = _0xaa2d37[_0x32263b(0x248)](_0x32263b(0x4a0)); _0x4f48a0['textContent'] = _0x5dffbe, _0x4790b6[_0x32263b(0x10d)][_0x32263b(0x5eb)] = 'flex'; const _0x12de26 = _0x247332 => { const _0x4ff2a5 = _0x32263b; _0x4790b6[_0x4ff2a5(0x10d)][_0x4ff2a5(0x5eb)] = 'none', _0x3e3086[_0x4ff2a5(0x935)] = _0x51f51e['onclick'] = _0x4e0e38[_0x4ff2a5(0x935)] = null, _0x55a393[_0x4ff2a5(0xa5e)]('keydown', _0x5b66dc), _0x1fc102(_0x247332); }, _0x5b66dc = _0x475d8d => { const _0x3086b1 = _0x32263b; if (_0x475d8d[_0x3086b1(0x797)] === _0x3086b1(0x137)) _0x12de26(![]); if (_0x475d8d[_0x3086b1(0x797)] === _0x3086b1(0x18b)) _0x12de26(!![]); }; _0x3e3086[_0x32263b(0x935)] = () => _0x12de26(!![]), _0x51f51e['onclick'] = () => _0x12de26(![]), _0x4e0e38[_0x32263b(0x935)] = () => _0x12de26(![]), _0x44d199[_0x32263b(0x578)]('keydown', _0x5b66dc); } } } } function _0x339f5d(_0x55bbb5, _0x5a7182 = 0x78) { const _0x5e5a70 = _0x1da6ac, _0x314c01 = _0x53d6b8 => { const _0x271a2e = _0x2af4; if (_0x53d6b8['role'] === _0x271a2e(0x27a)) return _0x10530c[_0x271a2e(0x1c9)]?.[_0x271a2e(0x6b7)] || _0x271a2e(0x849); if (_0x53d6b8['senderId']) { const _0x3ea259 = _0x5b19fc(_0x53d6b8[_0x271a2e(0x596)]); return _0x3ea259?.[_0x271a2e(0x6b7)] || _0x271a2e(0x254); } if (_0x55bbb5?.[_0x271a2e(0xa78)] === 'private') { const _0x1a6b80 = _0x5b19fc(_0x55bbb5[_0x271a2e(0x26f)][0x0]); return _0x1a6b80?.['name'] || 'AI'; } return _0x271a2e(0x5e9); }, _0x23337d = _0x10530c['conversationHistory']['slice'](-_0x5a7182), _0x27fde0 = []; for (const _0x56fd72 of _0x23337d) { if (_0x56fd72[_0x5e5a70(0x565)]) { if ('WdSkp' !== _0x5e5a70(0x2a9)) _0x27fde0[_0x5e5a70(0x36b)]('[' + _0x314c01(_0x56fd72) + _0x5e5a70(0x45d) + (_0x56fd72['content']?.['match'](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { const _0x4a59ff = _0x480fca[_0x5e5a70(0x703)](_0x196cec / 0x3c); if (_0x4a59ff < 0x30) _0xc61503 += _0x5e5a70(0x3dd) + _0x4a59ff + _0x5e5a70(0x8de); else _0x118327 += _0x5e5a70(0x321) + _0xf15f5e[_0x5e5a70(0x703)](_0x4a59ff / 0x18) + _0x5e5a70(0x4e1); } } else { if (_0x56fd72['image']) { if (_0x5e5a70(0x4fe) !== _0x5e5a70(0x1a8)) { const _0x36ca55 = _0x56fd72[_0x5e5a70(0x9a8)] ? '\x20' + _0x56fd72['content'] : ''; _0x27fde0[_0x5e5a70(0x36b)]('[' + _0x314c01(_0x56fd72) + _0x5e5a70(0x783) + _0x36ca55); } else { if (_0x4a9a04[_0x5e5a70(0xa78)] === _0x5e5a70(0x936)) _0x357a89['preventDefault'](); _0x547f60(_0x244120(_0xa8d01, 0xa), _0x477fd7); } } else _0x56fd72[_0x5e5a70(0x9a8)] && _0x27fde0[_0x5e5a70(0x36b)]('[' + _0x314c01(_0x56fd72) + ']\x20' + _0x56fd72[_0x5e5a70(0x9a8)]); } } return _0x27fde0[_0x5e5a70(0x64e)]('\x0a'); } function _0x4a0c77(_0x236e17, _0x249ed4) { const _0x542b79 = _0x1da6ac; if (_0x542b79(0x31a) !== 'ZDmVc') { if (!_0x236e17 || !_0x249ed4) return null; const _0x25b807 = _0x249ed4[_0x542b79(0x11d)](/@([^\s:：,，。!?]+)/); if (!_0x25b807) return null; const _0x13f25a = _0x25b807[0x1][_0x542b79(0x51f)](); for (const _0x34a6e2 of _0x236e17[_0x542b79(0x26f)]) { const _0x4c0352 = _0x5b19fc(_0x34a6e2); if (!_0x4c0352?.['name']) continue; if (_0x4c0352[_0x542b79(0x6b7)]['toLowerCase']() === _0x13f25a) return _0x4c0352; if (_0x4c0352[_0x542b79(0x6b7)][_0x542b79(0x51f)]()['startsWith'](_0x13f25a)) return _0x4c0352; } return null; } else _0x529fc0[_0x542b79(0x7e0)] && (_0x36941e[_0x542b79(0x7e0)] = _0x58445c[_0x542b79(0x7e0)][_0x542b79(0x54e)](_0x25da1c => _0x25da1c !== _0x599354)); } function _0x1c040b(_0x1f1302) { const _0x5f15e4 = _0x1da6ac; if (_0x5f15e4(0x394) !== _0x5f15e4(0x19a)) { const _0x45ee2a = _0x1f1302[_0x5f15e4(0x7ec)]('{'), _0x180a53 = _0x1f1302[_0x5f15e4(0xae1)]('}'); if (_0x45ee2a >= 0x0 && _0x180a53 > _0x45ee2a) return _0x1f1302[_0x5f15e4(0x53a)](_0x45ee2a, _0x180a53 + 0x1); return _0x1f1302; } else { const _0xdc12f7 = new _0x570f74(), _0xfc370e = _0x2f19cf[_0x5f15e4(0x248)]('home-time'), _0x4299ba = _0x3b3c24[_0x5f15e4(0x248)](_0x5f15e4(0x9bb)); if (_0xfc370e && _0x4299ba) { const _0x4b393f = _0x3825c1(_0xdc12f7[_0x5f15e4(0x223)]())['padStart'](0x2, '0'), _0x1cdecc = _0x10fe99(_0xdc12f7[_0x5f15e4(0xabe)]())['padStart'](0x2, '0'); _0xfc370e[_0x5f15e4(0x9ac)] = _0x4b393f + ':' + _0x1cdecc; const _0x392589 = _0xdc12f7['getMonth']() + 0x1, _0x38a958 = _0xdc12f7[_0x5f15e4(0x208)](), _0xc2eff0 = [_0x5f15e4(0x905), _0x5f15e4(0x9a6), '星期二', '星期三', _0x5f15e4(0x9f1), _0x5f15e4(0x2c5), _0x5f15e4(0x98d)][_0xdc12f7[_0x5f15e4(0x381)]()]; _0x4299ba[_0x5f15e4(0x9ac)] = _0x392589 + '月' + _0x38a958 + '日\x20' + _0xc2eff0; } } } function _0x411ca7(_0x477aab, _0x168515, _0x28aa8c) { const _0x4fde74 = _0x1da6ac; if (_0x4fde74(0x8ff) === _0x4fde74(0x402)) return { 'type': _0x4fde74(0x6cc), 'eventType': _0x32b455[0x1][_0x4fde74(0x3ee)](), 'eventDate': _0x1c39d3[0x2][_0x4fde74(0x3ee)](), 'eventContent': _0x333a98[0x3][_0x4fde74(0x3ee)]() }; else { const _0x16685e = new Map(_0x168515['map'](_0xb3771e => [String(_0xb3771e['id']), _0xb3771e])), _0x22b35a = _0x2cb3ab => String(_0x2cb3ab || '')[_0x4fde74(0x51f)]()[_0x4fde74(0x7cf)](/\s+/g, ''), _0xfb69ab = new Map(_0x168515['map'](_0x38703f => [_0x22b35a(_0x38703f[_0x4fde74(0x6b7)]), _0x38703f])), _0xef3f79 = new Set(_0x28aa8c), _0x4000ff = { 'events': [] }; for (const _0xf0cefc of _0x477aab?.[_0x4fde74(0x57f)] || []) { const _0x309f7a = _0xf0cefc[_0x4fde74(0x596)] ?? _0xf0cefc['sender'] ?? _0xf0cefc[_0x4fde74(0x19f)] ?? _0xf0cefc[_0x4fde74(0x10c)] ?? _0xf0cefc['role'] ?? _0xf0cefc[_0x4fde74(0x6b7)]; if (!_0x309f7a) continue; let _0x426d4f = _0x16685e[_0x4fde74(0xa25)](String(_0x309f7a)) || _0xfb69ab[_0x4fde74(0xa25)](_0x22b35a(_0x309f7a)); if (!_0x426d4f) continue; const _0x384fc1 = (_0xf0cefc[_0x4fde74(0x3ac)] || _0xf0cefc['type'] || _0x4fde74(0x958))[_0x4fde74(0x51f)](); if (_0x384fc1 === _0x4fde74(0x6c0)) { const _0xf0821d = (_0xf0cefc[_0x4fde74(0x6c0)] ?? _0xf0cefc['emoji'] ?? _0xf0cefc[_0x4fde74(0x34b)] ?? _0xf0cefc['tag'])?.[_0x4fde74(0x3ee)](); if (_0xf0821d && _0xef3f79['has'](_0xf0821d)) _0x4000ff['events'][_0x4fde74(0x36b)]({ 'senderId': _0x426d4f['id'], 'kind': _0x4fde74(0x6c0), 'sticker': _0xf0821d }); else { if (_0x4fde74(0x4cb) !== 'Mxqjh') { const _0x3a3095 = String(_0xf0cefc[_0x4fde74(0x9a8)] ?? _0xf0cefc['text'] ?? '')[_0x4fde74(0x3ee)]() || _0x4fde74(0xaab) + (_0xf0821d || _0x4fde74(0x481)) + ']'; if (_0x3a3095) _0x4000ff[_0x4fde74(0x57f)][_0x4fde74(0x36b)]({ 'senderId': _0x426d4f['id'], 'kind': 'text', 'content': _0x3a3095 }); } else { _0x4c754b(![]), _0x40ed49(_0x4fde74(0xa40)); return; } } } else { const _0x33b0d0 = String(_0xf0cefc[_0x4fde74(0x9a8)] ?? _0xf0cefc[_0x4fde74(0x958)] ?? _0xf0cefc[_0x4fde74(0x380)] ?? '')[_0x4fde74(0x3ee)](); if (_0x33b0d0) _0x4000ff[_0x4fde74(0x57f)]['push']({ 'senderId': _0x426d4f['id'], 'kind': 'text', 'content': _0x33b0d0 }); } } return _0x4000ff; } } async function _0x4657e4(_0x1b91c8) { const _0x445af1 = _0x1da6ac; if (_0x445af1(0x2ba) !== 'Qknas') { if (!_0x1b91c8 || !Array[_0x445af1(0x796)](_0x1b91c8['events']) || _0x1b91c8['events']['length'] === 0x0) return; const _0x1f614c = _0x5507c4 => _0x5507c4 + Math[_0x445af1(0x703)](Math[_0x445af1(0x59a)]() * 0x190); let _0x20ee2c = 0x1f4; for (const _0xdb49d1 of _0x1b91c8[_0x445af1(0x57f)]) { await new Promise(_0x334ace => setTimeout(_0x334ace, _0x1f614c(_0x20ee2c))), _0x20ee2c += 0x2bc; const _0x2d8cf3 = _0x10530c['conversationHistory']['at'](-0x1)?.[_0x445af1(0x718)] ?? ![]; if (_0xdb49d1['kind'] === _0x445af1(0x6c0)) { if (_0x445af1(0x5f6) === _0x445af1(0x5f6)) { const _0x3deeb9 = _0x13ae2d['find'](_0x595051 => _0x595051[_0x445af1(0x6b7)] === _0xdb49d1[_0x445af1(0x6c0)]); if (_0x3deeb9) { const _0x3be005 = { 'role': _0x445af1(0x7f0), 'content': _0x445af1(0x951) + _0x3deeb9[_0x445af1(0x6b7)] + ']', 'displayUrl': _0x3deeb9[_0x445af1(0x83a)], 'senderId': _0xdb49d1[_0x445af1(0x596)], 'timestamp': Date['now'](), 'isOffline': _0x2d8cf3 }; _0x10530c['conversationHistory'][_0x445af1(0x36b)](_0x3be005); } } else { _0x41df5a = _0xd85e74(_0x21b7c8); if (!_0x2a4308) throw new _0x38f29a(_0x445af1(0x66a)); } } else { if (_0xdb49d1[_0x445af1(0x3ac)] === _0x445af1(0x868) && _0xdb49d1[_0x445af1(0x6d2)] && _0xdb49d1[_0x445af1(0x755)]) { if (_0x445af1(0x419) === _0x445af1(0x419)) { const { songName: _0x59a51d, artist: _0x221d89 } = _0xdb49d1, _0x41c759 = { 'role': 'assistant', 'type': _0x445af1(0x868), 'content': _0x445af1(0x150) + _0x59a51d + '\x20-\x20' + _0x221d89 + ']', 'songName': _0x59a51d, 'artist': _0x221d89, 'senderId': _0xdb49d1[_0x445af1(0x596)], 'timestamp': Date[_0x445af1(0x7a8)](), 'isOffline': _0x2d8cf3 }; try { if (_0x445af1(0x357) === 'MrJOF') { const _0x43914a = await _0x57d1c9(_0x59a51d, _0x221d89); _0x41c759['coverUrl'] = _0x43914a[_0x445af1(0x55a)], _0x41c759[_0x445af1(0x5e3)] = _0x43914a[_0x445af1(0x83a)]; } else _0xa99f97[_0x445af1(0x10d)][_0x445af1(0xad9)] = _0x445af1(0x7a2) + _0x2a422f + '\x27)'; } catch (_0x44b672) { console[_0x445af1(0x729)]('群聊音乐搜索失败\x20(' + _0x59a51d + _0x445af1(0x23b) + _0x221d89 + '):', _0x44b672), _0x41c759[_0x445af1(0x2ab)] = null, _0x41c759[_0x445af1(0x5e3)] = null; } _0x10530c[_0x445af1(0x675)][_0x445af1(0x36b)](_0x41c759); } else { const _0x9ffedc = _0x2d733b[_0x445af1(0xa21)](_0x378640 => new _0x2dff69(_0x378640[_0x445af1(0x908)] || _0x378640['last_edited']))[_0x445af1(0x54e)](_0x41c943 => !_0x502d58(_0x41c943)); _0x9ffedc[_0x445af1(0x848)] > 0x0 && (_0x4b2022 = new _0x52d5fd(_0x730f72[_0x445af1(0x21d)][_0x445af1(0x65e)](null, _0x9ffedc)), _0x473fb9 = _0x4f297a[_0x445af1(0x446)](_0x445af1(0x89f), { 'dateStyle': _0x445af1(0x81d), 'timeStyle': _0x445af1(0x931) })); } } else { if (_0xdb49d1[_0x445af1(0x3ac)] === _0x445af1(0x958)) { const _0x4c8248 = _0x41d269(_0xdb49d1[_0x445af1(0x9a8)])[_0x445af1(0x53a)](0x0, 0x3); for (let _0x48f7b9 = 0x0; _0x48f7b9 < _0x4c8248[_0x445af1(0x848)]; _0x48f7b9++) { if (_0x48f7b9 > 0x0) await new Promise(_0x2da029 => setTimeout(_0x2da029, _0x1f614c(0x190))); const _0x14be16 = { 'role': _0x445af1(0x7f0), 'content': _0x4c8248[_0x48f7b9], 'senderId': _0xdb49d1[_0x445af1(0x596)], 'timestamp': Date[_0x445af1(0x7a8)](), 'isOffline': _0x2d8cf3 }; _0x10530c[_0x445af1(0x675)][_0x445af1(0x36b)](_0x14be16); } } } } } _0x4a0ca0(), _0x58f59d(); } else _0x57441b(![]), _0x457114(_0x445af1(0x4b2) + _0x1fd9e2[_0x445af1(0x380)]); } async function _0x8101d0(_0x52f85b, { force: force = ![], delayMs: delayMs = 0x0 } = {}) { const _0x53ef0b = _0x1da6ac; await new Promise(_0x287b91 => setTimeout(_0x287b91, 0xa)); if (!_0x10530c[_0x53ef0b(0x899)][_0x53ef0b(0x389)] || !_0x10530c['apiSettings']['key'] || !_0x10530c[_0x53ef0b(0x899)]['model']) return _0x3a6c86(_0x53ef0b(0x997)), ![]; const _0x998619 = _0x27b19d(); if (!_0x998619 || !_0x52f85b) return ![]; const _0x512fc8 = _0x474290(_0x998619['id']), _0x4185c6 = _0x10530c[_0x53ef0b(0x675)]['at'](-0x1)?.[_0x53ef0b(0x34a)] === _0x53ef0b(0x27a); if (!force && !_0x4185c6) return ![]; const _0xf94ec9 = _0x10530c[_0x53ef0b(0x675)]['at'](-0x1)?.[_0x53ef0b(0x718)] ?? ![]; if (delayMs) await new Promise(_0x42d3d8 => setTimeout(_0x42d3d8, delayMs)); if (_0xf94ec9) { if (_0x53ef0b(0x39a) !== 'CzFgM') document[_0x53ef0b(0x248)]('galgame-text')[_0x53ef0b(0x9ac)] = _0x53ef0b(0x6a2); else { _0x8f7d4a(_0x53ef0b(0x459)); return; } } else _0x1cdcc1(!![]); let _0x413b1d = ''; const _0x50ff07 = _0x27b19d(); if (_0x50ff07?.[_0x53ef0b(0xaae)]?.[_0x53ef0b(0x979)]) { const _0x2626e6 = _0x50ff07['activeListenSession'], _0x272d60 = await _0x5ac867(_0x2626e6[_0x53ef0b(0x181)]); if (_0x272d60 && _0x272d60['lyrics']) { if (_0x53ef0b(0x581) !== _0x53ef0b(0x581)) _0x1108c6(_0x4ca63a, _0x53ef0b(0x47b)); else { const _0x4580ec = _0x129635(_0x272d60[_0x53ef0b(0x64d)]); if (_0x4580ec[_0x53ef0b(0x848)] > 0x0) { const _0x2f6d4d = _0x2af425[_0x53ef0b(0xa05)]; let _0x287216 = -0x1; for (let _0x3f1bfc = 0x0; _0x3f1bfc < _0x4580ec[_0x53ef0b(0x848)]; _0x3f1bfc++) { if (_0x2f6d4d >= _0x4580ec[_0x3f1bfc][_0x53ef0b(0x165)]) _0x287216 = _0x3f1bfc; else break; } const _0x16b1bf = _0x4580ec['map']((_0x4f9240, _0x851144) => { const _0x2ac5e2 = _0x53ef0b, _0x7aa828 = _0x851144 === _0x287216 ? _0x2ac5e2(0x487) : ''; return '' + _0x7aa828 + _0x4f9240[_0x2ac5e2(0x958)]; })['join']('\x0a'); _0x413b1d = (_0x53ef0b(0x33f) + _0x2626e6[_0x53ef0b(0x755)] + _0x53ef0b(0x9e6) + _0x2626e6[_0x53ef0b(0x6d2)] + _0x53ef0b(0x94a) + _0x16b1bf + _0x53ef0b(0x944))[_0x53ef0b(0x3ee)](); } } } } let _0xb3699d = '', _0x47d35d = ''; const _0x2f6d23 = _0x10530c[_0x53ef0b(0x675)][_0x53ef0b(0x848)]; if (_0x2f6d23 > 0x1) { const _0x3d59f4 = _0x10530c['conversationHistory'][_0x2f6d23 - 0x2], _0x5b9568 = _0x10530c[_0x53ef0b(0x675)][_0x2f6d23 - 0x1]; if (_0x3d59f4[_0x53ef0b(0x718)] === ![] && _0x5b9568['isOffline'] === !![]) _0x47d35d = '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“' + _0x512fc8[_0x53ef0b(0x6b7)] + _0x53ef0b(0x5c7); else _0x3d59f4['isOffline'] === !![] && _0x5b9568['isOffline'] === ![] && (_0x47d35d = _0x53ef0b(0x550) + _0x512fc8[_0x53ef0b(0x6b7)] + _0x53ef0b(0x154)); } if (_0xf94ec9) { const _0x345994 = _0x53ef0b(0x1c1); _0xb3699d = _0x53ef0b(0x4c7) + _0x512fc8['name'] + '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[' + _0x345994 + _0x53ef0b(0x573) + _0x52f85b[_0x53ef0b(0x6b7)] + '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[' + _0x345994 + ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[' + _0x345994 + _0x53ef0b(0x172); } else _0x53ef0b(0x7c5); const { omniText: _0x588e8d } = _0x3b8ffa(_0x52f85b['id'], _0x998619['id']), _0x48965c = _0x538f71(), _0x5d9e14 = _0x38a670(_0x52f85b['id']), _0x397e40 = _0x138c37(_0x52f85b['id']), _0x5db3e8 = await _0x1eaf60(_0x52f85b['id']), _0x16389d = typeof _0x43f1be === 'string' ? _0x43f1be[_0x53ef0b(0x695)](_0x53ef0b(0x77f), _0x52f85b['name'])['replaceAll'](_0x53ef0b(0x851), _0x512fc8[_0x53ef0b(0x6b7)] || '用户') : '', _0x3f8fc4 = _0x13ae2d['map'](_0x501121 => _0x501121[_0x53ef0b(0x6b7)])[_0x53ef0b(0x64e)](',\x20'); let _0x2f8707 = ''; if (_0x52f85b[_0x53ef0b(0x7e0)] && _0x52f85b[_0x53ef0b(0x7e0)]['length'] > 0x0) { const _0x48219c = _0x52f85b['linkedWorldBookIds']['map'](_0xb9a613 => _0x10530c[_0x53ef0b(0x79a)][_0x53ef0b(0x212)](_0x247ba7 => _0x247ba7['id'] === _0xb9a613))['filter'](Boolean)[_0x53ef0b(0xa21)](_0x1284ae => '\x0a\x0a##\x20世界书条目:\x20' + _0x1284ae[_0x53ef0b(0x6b7)] + '\x0a' + _0x1284ae[_0x53ef0b(0x9a8)])[_0x53ef0b(0x64e)](''); if (_0x48219c) _0x2f8707 = '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a' + _0x48219c; } const _0x52717e = _0x512fc8['persona'] ? '\x0a\x0a#\x20关于对话者“' + _0x512fc8[_0x53ef0b(0x6b7)] + _0x53ef0b(0x910) + _0x512fc8[_0x53ef0b(0x824)] : ''; let _0x2cab2f = ''; const _0x34ef6d = new Date(), _0x385e30 = _0x392b91(_0x52f85b['id']); _0x2cab2f = _0x53ef0b(0x787), _0x2cab2f += _0x53ef0b(0x98f) + _0x34ef6d['toLocaleString']('zh-CN', { 'dateStyle': _0x53ef0b(0x9e2), 'timeStyle': 'short' }) + '\x0a'; if (_0x385e30) { if (_0x53ef0b(0x83b) === _0x53ef0b(0x83b)) { const _0x4c0879 = new Date(_0x385e30[_0x53ef0b(0x908)]), _0x308153 = _0x25c4db(_0x4c0879); _0x2cab2f += _0x53ef0b(0x8d7) + _0x308153 + '\x0a'; const _0xe8d986 = _0x34ef6d[_0x53ef0b(0x8b9)](), _0x4f4534 = _0x4c0879[_0x53ef0b(0x8b9)](), _0x329745 = new Date(); _0x329745[_0x53ef0b(0x580)](_0x34ef6d[_0x53ef0b(0x208)]() - 0x1); const _0xb91619 = _0x329745[_0x53ef0b(0x8b9)](); if (_0xe8d986 === _0x4f4534) { if (_0x53ef0b(0x810) === _0x53ef0b(0x74e)) _0x2fbfff[_0x53ef0b(0x729)]('JSON\x20解析失败!\x20错误原因:', _0x6e600c), _0x1c3e6a[_0x53ef0b(0x729)](_0x53ef0b(0x66b), _0x5ef466); else { const _0x472544 = (_0x34ef6d - _0x4c0879) / (0x3e8 * 0x3c); _0x472544 < 0x3c ? _0x53ef0b(0x252) === _0x53ef0b(0x252) ? _0x2cab2f += _0x53ef0b(0x314) : _0xe43509[_0x53ef0b(0x882)]['remove']('show-chat-view') : _0x2cab2f += _0x53ef0b(0x993) + Math[_0x53ef0b(0x2c8)](_0x472544 / 0x3c) + '小时前），可以简单问候一下对方现在的状态。\x0a'; } } else { if (_0xb91619 === _0x4f4534) _0x2cab2f += _0x53ef0b(0x437); else { if (_0x53ef0b(0x645) !== _0x53ef0b(0x1eb)) { const _0x49f6b2 = Math[_0x53ef0b(0x2c8)]((_0x34ef6d - _0x4c0879) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x2cab2f += _0x53ef0b(0x444) + _0x49f6b2 + _0x53ef0b(0x94c); } else _0x3c933a['classList'][_0x53ef0b(0xae0)](_0x53ef0b(0x11b)), _0x4d8960 = null; } } } else { if (_0x2e4509[_0x53ef0b(0x565)]) _0xbab6c6[_0x53ef0b(0x36b)]('[' + _0x53b849(_0x5b010d) + _0x53ef0b(0x45d) + (_0x5bbe71[_0x53ef0b(0x9a8)]?.[_0x53ef0b(0x11d)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x3e8f43[_0x53ef0b(0x1a2)]) { const _0x121ffc = _0x3f1353['content'] ? '\x20' + _0x3e1860[_0x53ef0b(0x9a8)] : ''; _0x39bc33[_0x53ef0b(0x36b)]('[' + _0x36dd81(_0x19d60a) + ']\x20[image]' + _0x121ffc); } else _0x6548c0[_0x53ef0b(0x9a8)] && _0xb5c563[_0x53ef0b(0x36b)]('[' + _0x3665cf(_0x152f6f) + ']\x20' + _0xccec03[_0x53ef0b(0x9a8)]); } } } else { if ('qGRzx' !== 'qGRzx') { const _0x1ea753 = _0x5bcfbd[_0x53ef0b(0x248)]('confirm-altar-upload-button'); _0x1489c7[_0x53ef0b(0x774)] && _0x262f4b['info'] ? _0x1ea753[_0x53ef0b(0xf6)] = ![] : _0x1ea753[_0x53ef0b(0xf6)] = !![]; } else _0x2cab2f += _0x53ef0b(0x4df); } const _0x404489 = ('\x0a' + _0xb3699d + _0x53ef0b(0x8b2) + _0x52f85b[_0x53ef0b(0x6b7)] + _0x53ef0b(0x425) + _0x52f85b[_0x53ef0b(0x6b7)] + _0x53ef0b(0x3c7) + _0x52f85b[_0x53ef0b(0x6b7)] + ']\x22\x20等前缀。\x0a如需发送表情，只发送一行：[sticker:表情名]。\x0a【重要】发送表情包时，表情名【必须】从以下列表中选择：[' + _0x3f8fc4 + _0x53ef0b(0x6a0) + _0x16389d + '\x0a')['trim'](), _0x391f0c = [{ 'role': _0x53ef0b(0x11f), 'content': _0x404489 }], _0x2cea59 = (_0x53ef0b(0x52a) + (_0x52f85b['persona'] || '你是一个乐于助人的助手。') + '\x0a' + _0x52717e + '\x20\x0a' + _0x588e8d + '\x0a' + _0x48965c + '\x0a' + _0x5d9e14 + '\x0a' + _0x397e40 + '\x20//\x20<--\x20哼，加在这里\x0a' + _0x5db3e8 + _0x53ef0b(0x8c1) + _0x413b1d + '\x0a' + _0x2cab2f + '\x0a' + _0x2f8707 + '\x0a')[_0x53ef0b(0x3ee)](); _0x2cea59[_0x53ef0b(0x7cf)](/#.*|\s/g, '') && (_0x391f0c[_0x53ef0b(0x36b)]({ 'role': _0x53ef0b(0x27a), 'content': _0x2cea59 }), _0x391f0c[_0x53ef0b(0x36b)]({ 'role': _0x53ef0b(0x7f0), 'content': _0x53ef0b(0x680) })); const _0x39e123 = _0x10530c[_0x53ef0b(0x827)]?.[_0x53ef0b(0x2f8)] ?? 0x64, _0x55246d = _0x10530c[_0x53ef0b(0x675)]['slice'](-_0x39e123); for (const _0x2595fd of _0x55246d) { const _0x476f52 = _0x2595fd['role'] === 'ai' || _0x2595fd['role'] === 'assistant' ? _0x53ef0b(0x7f0) : _0x53ef0b(0x27a); let _0x243966 = { 'role': _0x476f52, 'content': _0x2595fd['content'] }, _0xf380ce = !!_0x2595fd[_0x53ef0b(0x9a8)]; if (_0x2595fd[_0x53ef0b(0x565)] && _0x2595fd['content'][_0x53ef0b(0xa83)]('表情')) { if ('fdTaG' !== 'ihimQ') { const _0x536b26 = _0x2595fd[_0x53ef0b(0x9a8)][_0x53ef0b(0x11d)](/：(.*?)]$/); _0x243966[_0x53ef0b(0x9a8)] = _0x53ef0b(0xaab) + (_0x536b26 ? _0x536b26[0x1] : '未知表情') + ']', _0x391f0c[_0x53ef0b(0x36b)](_0x243966); } else { const _0x438465 = _0x16f708['userProfiles'][_0x53ef0b(0x212)](_0x419a42 => _0x419a42['id'] === _0x4f3590); if (!_0x438465) return; _0xe37287[_0x53ef0b(0x248)](_0x53ef0b(0x7b7))[_0x53ef0b(0xe5)] = _0x438465['id'], _0x360a22[_0x53ef0b(0x248)](_0x53ef0b(0x222))[_0x53ef0b(0x9ac)] = _0x53ef0b(0x745), _0xf87c38[_0x53ef0b(0x248)](_0x53ef0b(0x595))[_0x53ef0b(0xe5)] = _0x438465['name'], _0x438465[_0x53ef0b(0x917)] ? _0x1d5b02[_0x53ef0b(0x10d)][_0x53ef0b(0xad9)] = 'url(\x27' + _0x438465[_0x53ef0b(0x917)] + '\x27)' : _0x29c626[_0x53ef0b(0x10d)][_0x53ef0b(0xad9)] = 'url(\x27' + _0x1aee9e + '\x27)', _0x1f82c5[_0x53ef0b(0x248)](_0x53ef0b(0xa17))[_0x53ef0b(0xe5)] = _0x438465[_0x53ef0b(0x824)], _0x42bf3e[_0x53ef0b(0x10d)][_0x53ef0b(0x5eb)] = _0x438465['id'] === _0x9cf20f[_0x53ef0b(0x663)] ? _0x53ef0b(0x3fe) : _0x53ef0b(0x92c), _0x10b9e0[_0x53ef0b(0x248)](_0x53ef0b(0x99a))[_0x53ef0b(0x10d)]['display'] = _0x53ef0b(0x92c); } } else { if (_0x53ef0b(0x5b3) === 'VylHI') _0x2b7fef['type'] === _0x53ef0b(0x732) && (_0x51678e[_0x53ef0b(0x26f)] = _0x44d82c['participantIds']['filter'](_0x351702 => _0x351702 !== _0x17257c)); else { let _0x5263ae = null; if (_0x2595fd[_0x53ef0b(0x1a2)]) _0x53ef0b(0x61f) !== _0x53ef0b(0x61f) ? _0xfdf693 = _0x16308d['name'] : _0x5263ae = _0x2595fd['image']; else { if (_0x2595fd['imageId']) try { const _0x5022ec = await _0x533d7a(_0x2595fd[_0x53ef0b(0x35f)]); _0x5022ec && (_0x5263ae = await _0x3c4a4d(_0x5022ec)); } catch (_0x20e810) { if (_0x53ef0b(0x5e7) !== _0x53ef0b(0x56d)) console[_0x53ef0b(0x729)](_0x53ef0b(0x406), _0x20e810); else { if (!_0x121366['isArray'](_0x1e8715)) return _0x53ef0b(0x5e4); if (_0x1e3d2e[_0x53ef0b(0x848)] === 0x0) return _0x53ef0b(0x6fe); return _0x52bc52['sort']((_0x3a3b2c, _0x93c202) => new _0x178fa8(_0x93c202[_0x53ef0b(0x908)]) - new _0x5dd01e(_0x3a3b2c[_0x53ef0b(0x908)])), _0x53ef0b(0x5f7) + _0xf9694e[_0x53ef0b(0xa21)](_0x18a7f7 => '\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20absolute;\x20left:\x20-25px;\x20top:\x2015px;\x20width:\x2020px;\x20height:\x2020px;\x20background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20font-size:\x201rem;\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-left:\x2010px;\x20padding:\x2012px\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20600;\x22>' + (_0x18a7f7[_0x53ef0b(0x850)] || _0x53ef0b(0xa89)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x22>' + (_0x18a7f7[_0x53ef0b(0x439)] || '') + _0x53ef0b(0x959) + (_0x18a7f7[_0x53ef0b(0x908)] || '') + _0x53ef0b(0x26b))[_0x53ef0b(0x64e)]('') + _0x53ef0b(0x489); } } } _0x5263ae && (_0x53ef0b(0x16b) !== _0x53ef0b(0x16b) ? _0x4f0c7c[_0x53ef0b(0x729)](_0x53ef0b(0x3e2), _0x2ab995) : (_0x243966[_0x53ef0b(0x1a2)] = _0x5263ae, _0xf380ce = !![])), _0xf380ce && (_0x53ef0b(0x6eb) === _0x53ef0b(0x7f9) ? _0xcfe7ce = _0x40404f(_0x47d876[_0x53ef0b(0x26f)][0x0]) : _0x391f0c[_0x53ef0b(0x36b)](_0x243966)); } } } try { const _0x151883 = await _0x2d63cb(_0x391f0c); if (!_0x151883) return ![]; if (_0xf94ec9) try { if (_0x53ef0b(0x302) === 'zvyIG') { const _0x23ff10 = _0x273077[_0x53ef0b(0x1be)][_0x4e1787[_0x53ef0b(0x5cb)]]; if (_0x23ff10 && _0x23ff10[_0x53ef0b(0x848)] > 0x0) { _0x5ba9e4['activeMeetingScriptQueue'] = [..._0x23ff10]; const _0x167dde = _0x573312[_0x53ef0b(0x1f5)][_0x53ef0b(0x420)](); _0x551946[_0x53ef0b(0x9ac)] = _0x167dde['speaker'] === _0x53ef0b(0x623) ? '旁白' : _0x167dde[_0x53ef0b(0x10c)], _0x28d20a['textContent'] = _0x167dde[_0x53ef0b(0x9f7)], _0x167dde[_0x53ef0b(0x10c)] !== _0x53ef0b(0x623) && _0x2b1593(_0x536700[_0x53ef0b(0x5cb)], _0x167dde[_0x53ef0b(0x2be)]); } else _0x5e9320[_0x53ef0b(0x9ac)] = '旁白', _0x1ba91a['textContent'] = _0x53ef0b(0x7cb); } else { let _0x49d1d7 = _0x151883[_0x53ef0b(0x3ee)](); const _0x40e582 = _0x49d1d7[_0x53ef0b(0x11d)](/(\[[\s\S]*\])/); _0x40e582 && (_0x49d1d7 = _0x40e582[0x1]); const _0x5d7af6 = JSON[_0x53ef0b(0x329)](_0x49d1d7); if (Array[_0x53ef0b(0x796)](_0x5d7af6)) { if (_0x53ef0b(0x24d) === _0x53ef0b(0x293)) _0x511bb7(_0x25b14c['id']); else { _0x10530c[_0x53ef0b(0x1f5)] = [..._0x5d7af6], _0x10530c[_0x53ef0b(0x1be)][_0x52f85b['id']] = [..._0x5d7af6], _0x4f75a3(); const _0x558c6f = _0x5d7af6[_0x53ef0b(0xa21)](_0x4a3c06 => _0x4a3c06[_0x53ef0b(0x10c)] === 'narrator' ? _0x4a3c06['line'] : _0x4a3c06[_0x53ef0b(0x10c)] + ':\x20' + _0x4a3c06[_0x53ef0b(0x9f7)])[_0x53ef0b(0x64e)]('\x0a\x0a'); _0x10530c[_0x53ef0b(0x675)]['push']({ 'role': 'assistant', 'senderId': _0x52f85b['id'], 'timestamp': Date[_0x53ef0b(0x7a8)](), 'isOffline': !![], 'content': _0x558c6f }); } } } } catch (_0xd74d4a) { console[_0x53ef0b(0x729)]('解析AI剧本JSON失败:', _0xd74d4a, _0x53ef0b(0xae4), _0x151883), _0x10530c[_0x53ef0b(0x675)][_0x53ef0b(0x36b)]({ 'role': _0x53ef0b(0x7f0), 'senderId': _0x52f85b['id'], 'timestamp': Date[_0x53ef0b(0x7a8)](), 'isOffline': !![], 'content': _0x53ef0b(0x5df) + _0x151883 + ']' }); } else { const _0x36ea42 = _0x42fef4(_0x151883), _0x5da5c1 = _0x36ea42[_0x53ef0b(0xa21)](_0x5d3f5a => { const _0x43ffb7 = _0x53ef0b, _0x3ce216 = _0x5d3f5a[_0x43ffb7(0x3ee)](), _0x55e9da = _0x3ce216[_0x43ffb7(0x11d)](/^\[sticker:(.*?)\]$/), _0x99b2a0 = _0x3ce216[_0x43ffb7(0x11d)](/^\[transfer:([\d.]+)\|(.*?)\]$/), _0x228aa3 = _0x3ce216[_0x43ffb7(0x11d)](/^\[music:(.*?)\|(.*?)\]$/), _0x8457b2 = _0x3ce216[_0x43ffb7(0x11d)](/^\[create_event:(.*?)\|(.*?)\|(.*?)\]$/); if (_0x228aa3) return { 'type': 'music', 'songName': _0x228aa3[0x1][_0x43ffb7(0x3ee)](), 'artist': _0x228aa3[0x2]['trim']() }; else { if (_0x55e9da) { if (_0x43ffb7(0xa7f) !== _0x43ffb7(0x162)) return { 'type': _0x43ffb7(0x6c0), 'name': _0x55e9da[0x1][_0x43ffb7(0x3ee)]() }; else { if (_0x2ced74[_0x43ffb7(0x34a)] === _0x43ffb7(0x27a)) return _0x4f43ad['userProfile']?.[_0x43ffb7(0x6b7)] || _0x43ffb7(0x849); if (_0x265fc0[_0x43ffb7(0xa78)] === _0x43ffb7(0x732)) { const _0x573dd5 = _0x1c9405[_0x43ffb7(0x596)] ? _0xf696d6(_0x58106a[_0x43ffb7(0x596)]) : null; return _0x573dd5?.[_0x43ffb7(0x6b7)] || _0x43ffb7(0x254); } else { const _0xfe6df6 = _0x2eee82(_0x2e6713[_0x43ffb7(0x26f)][0x0]); return _0xfe6df6?.[_0x43ffb7(0x6b7)] || 'AI'; } } } else { if (_0x8457b2) { if (_0x43ffb7(0x1bb) === _0x43ffb7(0x1bb)) return { 'type': 'create_event', 'eventType': _0x8457b2[0x1][_0x43ffb7(0x3ee)](), 'eventDate': _0x8457b2[0x2][_0x43ffb7(0x3ee)](), 'eventContent': _0x8457b2[0x3][_0x43ffb7(0x3ee)]() }; else { const _0x2cdded = _0x19d125[_0x43ffb7(0xe5)]; _0xaab5d0[_0x43ffb7(0x1c5)][_0x43ffb7(0x10d)][_0x43ffb7(0x91f)](_0x43ffb7(0x91a), _0x2cdded), _0x9219df['setItem']('themeHue', _0x2cdded), _0xe8c53f(); } } else { if (_0x99b2a0) { if (_0x43ffb7(0x259) !== _0x43ffb7(0x922)) { const _0x3077ab = parseFloat(_0x99b2a0[0x1]), _0x34fbb9 = _0x99b2a0[0x2]['trim'](), _0xf5a1c3 = _0x474290(_0x10530c[_0x43ffb7(0x16e)]); let _0x1cbb9d = null; if (_0x34fbb9 === _0xf5a1c3[_0x43ffb7(0x6b7)]) _0x1cbb9d = _0xf5a1c3['id']; else { const _0xc14e79 = _0x27b19d(); if (_0xc14e79[_0x43ffb7(0xa78)] === 'group') { const _0x24194f = _0x10530c[_0x43ffb7(0x620)]['find'](_0x4fab23 => _0xc14e79[_0x43ffb7(0x26f)][_0x43ffb7(0xa83)](_0x4fab23['id']) && _0x4fab23['name'] === _0x34fbb9); if (_0x24194f) _0x1cbb9d = _0x24194f['id']; } } if (_0x1cbb9d) return { 'type': _0x43ffb7(0x270), 'amount': _0x3077ab, 'recipientId': _0x1cbb9d, 'senderId': _0x52f85b['id'] }; else return { 'type': 'text', 'content': _0x43ffb7(0x564) + _0x34fbb9 + _0x43ffb7(0x8f6) }; } else _0x3db3da[_0x43ffb7(0x387)](), _0x138688['classList'][_0x43ffb7(0x4da)]('visible'), _0xc60280[_0x43ffb7(0x882)][_0x43ffb7(0x4da)](_0x43ffb7(0x185)); } else { if (_0x3ce216) return { 'type': 'text', 'content': _0x3ce216 }; } } } } return null; })[_0x53ef0b(0x54e)](Boolean), _0x5f4fdd = async _0xb6125a => { const _0x1d3e29 = _0x53ef0b, _0x3a7241 = { 'role': _0x1d3e29(0x7f0), 'senderId': _0x52f85b['id'], 'timestamp': Date[_0x1d3e29(0x7a8)](), 'isOffline': _0xf94ec9 }; if (_0xb6125a[_0x1d3e29(0xa78)] === 'music') { const { songName: _0x3b03f5, artist: _0x42e1a4 } = _0xb6125a; _0x3a7241['type'] = _0x1d3e29(0x868), _0x3a7241['content'] = _0x1d3e29(0x150) + _0x3b03f5 + _0x1d3e29(0x23b) + _0x42e1a4 + ']'; try { if (_0x1d3e29(0x5d7) !== _0x1d3e29(0x812)) { const _0x2fd3e7 = await _0x57d1c9(_0x3b03f5, _0x42e1a4); let _0x472f0e = null; if (_0x2fd3e7[_0x1d3e29(0x55a)]) { const _0x566055 = await _0x39f481(_0x2fd3e7[_0x1d3e29(0x55a)]); _0x472f0e = _0x1d3e29(0x92b) + Date[_0x1d3e29(0x7a8)]() + '_' + Math[_0x1d3e29(0x59a)](), await _0x5ef29b(_0x472f0e, _0x566055); } Object['assign'](_0x3a7241, { 'songName': _0x3b03f5, 'artist': _0x42e1a4, 'coverId': _0x472f0e, 'playableUrl': _0x2fd3e7[_0x1d3e29(0x83a)] }); } else _0x163203('错误:\x20' + _0x519f1f[_0x1d3e29(0x380)]); } catch (_0x22ca43) { if (_0x1d3e29(0x7be) === _0x1d3e29(0x7be)) Object[_0x1d3e29(0x895)](_0x3a7241, { 'songName': _0x3b03f5, 'artist': _0x42e1a4, 'coverId': null, 'playableUrl': null }); else { let _0x2424e0 = _0xca9687[_0x1d3e29(0x838)]('.typing-indicator'); !_0x2424e0 && (_0x2424e0 = _0x11e76b[_0x1d3e29(0x3b9)](_0x1d3e29(0x6ff)), _0x2424e0[_0x1d3e29(0x296)] = 'typing-indicator', _0x2424e0[_0x1d3e29(0x9ac)] = _0x1d3e29(0x1de), _0x1b2cfa[_0x1d3e29(0x6ab)](_0x2424e0)); } } } else { if (_0xb6125a[_0x1d3e29(0xa78)] === _0x1d3e29(0x6c0)) { const _0x30b777 = _0x13ae2d['find'](_0x13dea6 => _0x13dea6[_0x1d3e29(0x6b7)] === _0xb6125a[_0x1d3e29(0x6b7)]); if (_0x30b777) Object[_0x1d3e29(0x895)](_0x3a7241, { 'content': _0x1d3e29(0x951) + _0x30b777[_0x1d3e29(0x6b7)] + ']', 'displayUrl': _0x30b777['url'] }); else _0x3a7241[_0x1d3e29(0x9a8)] = _0x1d3e29(0xaab) + _0xb6125a[_0x1d3e29(0x6b7)] + ']'; } else { if (_0xb6125a[_0x1d3e29(0xa78)] === _0x1d3e29(0x270)) { const _0x51b239 = _0xb6125a[_0x1d3e29(0x95e)] === _0x474290(_0x10530c['activeChatId'])['id'] ? _0x474290(_0x10530c[_0x1d3e29(0x16e)]) : _0x5b19fc(_0xb6125a['recipientId']); Object['assign'](_0x3a7241, { 'type': _0x1d3e29(0x270), 'amount': _0xb6125a[_0x1d3e29(0x46e)], 'recipientId': _0xb6125a['recipientId'], 'content': _0x1d3e29(0xc5) + (_0x51b239?.[_0x1d3e29(0x6b7)] || '未知') + _0x1d3e29(0x3c0) + _0xb6125a[_0x1d3e29(0x46e)] + ']' }); } else { if (_0xb6125a['type'] === _0x1d3e29(0x6cc)) { const _0x1bc17f = _0x474290(_0x998619['id']); if (!_0x1bc17f || !_0x1bc17f['id']) return console[_0x1d3e29(0x729)](_0x1d3e29(0x124)), null; _0x10530c['calendarEvents']['push']({ 'id': _0x1d3e29(0x180) + Date[_0x1d3e29(0x7a8)](), 'date': _0xb6125a[_0x1d3e29(0x3a0)], 'type': _0xb6125a['eventType'], 'content': _0xb6125a[_0x1d3e29(0x18f)], 'userId': _0x1bc17f['id'], 'createdBy': 'ai' }), _0x3e6d3a(), _0x424e41(), _0x9f98f6(); const _0x41bfef = _0x5b19fc(_0x52f85b['id']); _0x41bfef && _0xb6125a[_0x1d3e29(0x40f)] === 'important' && _0x3a6c86(_0x1d3e29(0x591) + _0x41bfef[_0x1d3e29(0x6b7)] + '\x20添加了新的纪念日：' + _0xb6125a['eventContent']); return { 'role': _0x1d3e29(0x7f0), 'senderId': _0x52f85b['id'], 'timestamp': Date[_0x1d3e29(0x7a8)](), 'isOffline': _0xf94ec9, 'content': null }; return { 'role': _0x1d3e29(0x7f0), 'senderId': _0x52f85b['id'], 'timestamp': Date[_0x1d3e29(0x7a8)](), 'isOffline': _0xf94ec9, 'content': null }; } else { if (_0x1d3e29(0x720) !== _0x1d3e29(0x720)) { const _0x2cff51 = _0xdb3a31[_0x1d3e29(0x3b9)](_0x1d3e29(0x204)); _0x2cff51[_0x1d3e29(0x70a)] = _0x5e401a['url'], _0x2cff51[_0x1d3e29(0x7e8)] = _0x1d3e29(0x7b1), _0x2cff51[_0x1d3e29(0x4cf)] = _0x1cd86d['name'], _0x2cff51[_0x1d3e29(0x882)][_0x1d3e29(0x7c3)]('sticker-item'), _0x2cff51[_0x1d3e29(0x578)](_0x1d3e29(0x4b3), () => _0x14ed75(_0x483a23)), _0x3996c7[_0x1d3e29(0x6ab)](_0x2cff51); } else { const _0x54c9d7 = _0x10b7fc(_0xb6125a['content']); Object[_0x1d3e29(0x895)](_0x3a7241, { 'content': _0x54c9d7['content'], 'quotedMessage': _0x54c9d7[_0x1d3e29(0x86c)] }); } } } } } return _0x3a7241; }, _0x5cb931 = await Promise[_0x53ef0b(0x63b)](_0x5da5c1[_0x53ef0b(0xa21)](_0x5f4fdd)); for (const _0x1cfd6a of _0x5cb931) { if (_0x1cfd6a[_0x53ef0b(0x9a8)] || _0x1cfd6a[_0x53ef0b(0x565)] || _0x1cfd6a['type'] === _0x53ef0b(0x868)) { if (_0x53ef0b(0x201) === _0x53ef0b(0x201)) await new Promise(_0x519f13 => setTimeout(_0x519f13, 0x12c + Math['random']() * 0x190)), _0x10530c['conversationHistory']['push'](_0x1cfd6a), _0x58f59d(); else { _0x589466('好友圈数据升级完成，迁移了\x20' + _0x56a8ff + '\x20张旧图片。应用即将刷新。'), _0x4a7cea(() => _0xbc330c[_0x53ef0b(0x7a6)](), 0x5dc); return; } } } } return _0x4a0ca0(), _0x58f59d(), !![]; } catch (_0x1074ae) { if (_0x53ef0b(0x5f2) !== 'poYvc') _0x53ef0b(0x7c5); else { if (_0x1074ae[_0x53ef0b(0x6b7)] !== _0x53ef0b(0x885)) { console['error'](_0x53ef0b(0xeb), _0x1074ae); const _0x1ba87c = { 'role': _0x53ef0b(0x7f0), 'content': '错误:\x20' + _0x1074ae[_0x53ef0b(0x380)], 'senderId': _0x52f85b['id'], 'isOffline': _0xf94ec9 }; _0x10530c[_0x53ef0b(0x675)][_0x53ef0b(0x36b)](_0x1ba87c), _0x58f59d(); } return ![]; } } finally { _0x1cdcc1(![]); } } async function _0x37cbb6() { const _0x532403 = _0x1da6ac, _0x5fe90a = _0x27b19d(); if (!_0x5fe90a || _0x5fe90a[_0x532403(0xa78)] !== _0x532403(0x71a)) { if (_0x532403(0x7c4) === 'xxOKa') { _0x3a6c86(_0x532403(0x82f)); return; } else { let _0x1c3664 = null; const _0x25f207 = _0x57e38f[_0x532403(0x4bc)][_0x532403(0x54e)](_0x52cac1 => _0x52cac1['participantIds']['includes'](_0x59427b)); for (const _0x17360e of _0x25f207) { const _0x351a4c = _0x669fed(_0x17360e['id']); if (_0x351a4c && _0x351a4c[_0x532403(0x848)] > 0x0) { const _0x204541 = _0x351a4c[_0x351a4c['length'] - 0x1]; (!_0x1c3664 || _0x204541[_0x532403(0x908)] > _0x1c3664[_0x532403(0x908)]) && (_0x1c3664 = _0x204541); } } return _0x1c3664; } } if (_0x10530c['isGenerating']) { if (_0x532403(0x611) !== _0x532403(0x611)) _0x58d4a1[_0x532403(0x9ac)] = '新建好友圈', _0x2f138c['value'] = '', _0xa397b1['value'] = _0x532403(0x85b) + (_0x1fe129[_0x532403(0x7b9)][_0x532403(0x848)] + 0x1), _0x283b7e['value'] = _0x3da499[_0x532403(0x663)], _0x3bae56[_0x532403(0x10d)]['display'] = _0x532403(0x3fe); else { _0x3a6c86(_0x532403(0x498)); return; } } const _0x1b7afb = await _0x52e7d6('确定要对本次会话进行总结吗？这会消耗不少资源，并且会读取完整的聊天记录。'); if (!_0x1b7afb) return; _0xbc2d1c(!![], '正在翻阅全部历史记录...'), _0x2131ed['value'] = '', _0x135f67[_0x532403(0x882)][_0x532403(0x7c3)](_0x532403(0x11b)), _0x10530c[_0x532403(0xa4a)] = !![]; try { if (_0x532403(0x643) !== _0x532403(0x643)) _0x3c0bc5[_0x532403(0x8df)](_0x21b39a); else { const _0x2b9ab8 = _0x5b19fc(_0x5fe90a[_0x532403(0x26f)][0x0]), _0x43dd0d = _0x474290(_0x5fe90a['id']), _0x2e9011 = _0x21c201(_0x5fe90a['id']); if (_0x2e9011[_0x532403(0x848)] === 0x0) { if (_0x532403(0x5a5) !== _0x532403(0x587)) { _0x2131ed[_0x532403(0xe5)] = _0x532403(0x17a); return; } else { const _0x35f1a9 = _0x137766[_0x532403(0x319)](_0x227228, _0x532403(0x52c)), _0x58d049 = _0x35f1a9[_0x532403(0x963)](_0x58e127), _0x30e31a = _0x58d049['put']({ 'id': _0x23f94b, 'blob': _0x53f0e9 }); _0x30e31a[_0x532403(0x330)] = () => _0x2a605c(_0x30e31a['result']), _0x30e31a['onerror'] = () => _0xacb6d3(_0x30e31a[_0x532403(0x729)]); } } const _0x1fc0f5 = _0x2e9011[_0x532403(0xa21)](_0x393db3 => { const _0x394335 = _0x532403, _0x3b2f96 = new Date(_0x393db3[_0x394335(0x908)]), _0xa2da60 = _0x3b2f96[_0x394335(0x5f8)]() + '-' + String(_0x3b2f96[_0x394335(0xa84)]() + 0x1)[_0x394335(0x1db)](0x2, '0') + '-' + String(_0x3b2f96[_0x394335(0x208)]())[_0x394335(0x1db)](0x2, '0'), _0x439834 = String(_0x3b2f96[_0x394335(0x223)]())['padStart'](0x2, '0') + ':' + String(_0x3b2f96[_0x394335(0xabe)]())[_0x394335(0x1db)](0x2, '0'); let _0x3f43f6 = '未知'; if (_0x393db3[_0x394335(0x34a)] === _0x394335(0x27a)) _0x3f43f6 = _0x43dd0d[_0x394335(0x6b7)]; else { if (_0x394335(0x77b) === _0x394335(0x4aa)) { const _0xd7dfce = _0x1bf01d[_0x394335(0x5ac)](/:\s(.+)/); if (_0xd7dfce[_0x394335(0x848)] > 0x1) { const _0xcdd2b1 = _0xd7dfce[0x0][_0x394335(0x3ee)](), _0x24dfaa = _0xd7dfce[0x1][_0x394335(0x3ee)]()[_0x394335(0x7cf)](/^"|"$/g, ''); _0x9c97d4[_0xcdd2b1] = _0x24dfaa; } } else _0x3f43f6 = _0x2b9ab8[_0x394335(0x6b7)]; } let _0x1c2d13 = _0x393db3[_0x394335(0x9a8)]; if (_0x393db3[_0x394335(0x565)]) _0x1c2d13 = _0x394335(0x407); if (_0x393db3[_0x394335(0x35f)]) _0x1c2d13 = _0x394335(0x39b); return '[' + _0xa2da60 + '\x20' + _0x439834 + _0x394335(0xaa1) + _0x3f43f6 + _0x394335(0x5dc) + _0x1c2d13; })[_0x532403(0x64e)]('\x0a'), _0xe7ad32 = _0x31c9dd[_0x532403(0x7cf)](/{charName}/g, _0x2b9ab8['name'])[_0x532403(0x7cf)](/{userName}/g, _0x43dd0d[_0x532403(0x6b7)]), _0x1871c5 = [{ 'role': _0x532403(0x11f), 'content': _0xe7ad32 }, { 'role': 'user', 'content': _0x1fc0f5 }], _0x5bdaf7 = await _0x2d63cb(_0x1871c5); _0x2131ed['value'] = _0x5bdaf7 || '#\x20总结失败了，可能是记录太长或太复杂。', _0x2131ed[_0x532403(0x40d)] = 0x0; } } catch (_0x1d2206) { console[_0x532403(0x729)](_0x532403(0x82c), _0x1d2206), _0x2131ed[_0x532403(0xe5)] = _0x532403(0x216) + _0x1d2206[_0x532403(0x380)]; } finally { if (_0x532403(0x146) !== _0x532403(0x146)) { const _0x4c2c53 = new _0x5766a6(_0x2d0bfa['timestamp']), _0x1d686c = _0x256b64['floor']((_0x1600e0 - _0x4c2c53) / (0x3e8 * 0x3c)); if (_0x1d686c < 0x5) _0x297e18 += '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。'; else { if (_0x1d686c < 0x78) _0x40628b += '\x0a-\x20**对话状态**:\x20群里在' + _0x1d686c + _0x532403(0x56c); else { const _0x2a7c96 = _0x926fff[_0x532403(0x703)](_0x1d686c / 0x3c); if (_0x2a7c96 < 0x30) _0x134038 += _0x532403(0x3dd) + _0x2a7c96 + _0x532403(0x8de); else _0x5bacc2 += _0x532403(0x321) + _0x1ae67c[_0x532403(0x703)](_0x2a7c96 / 0x18) + _0x532403(0x4e1); } } } else _0xbc2d1c(![]), _0x10530c['isGenerating'] = ![]; } } async function _0x3990cb() { const _0x63a052 = _0x1da6ac; console[_0x63a052(0x5e0)](_0x63a052(0x5e1)); if (!_0x10530c['apiSettings'][_0x63a052(0x389)] || !_0x10530c[_0x63a052(0x899)][_0x63a052(0x797)] || !_0x10530c[_0x63a052(0x899)][_0x63a052(0x43a)]) { _0x3a6c86(_0x63a052(0x997)); return; } const _0x1198e3 = _0x10530c['conversationHistory']['at'](-0x1)?.['role'] === _0x63a052(0x27a); if (!_0x1198e3 || _0x10530c['isGenerating']) return; const _0xcfd119 = _0x27b19d(); if (!_0xcfd119) return; _0x10530c[_0x63a052(0xa4a)] = !![], _0x1cdcc1(!![]); try { if (_0x63a052(0x493) === _0x63a052(0x493)) { if (_0xcfd119['type'] === _0x63a052(0x71a)) { const _0x575bc5 = _0x5b19fc(_0xcfd119[_0x63a052(0x26f)][0x0]); console['log'](_0x63a052(0xadd)); if (_0x575bc5) await _0x8101d0(_0x575bc5, { 'force': !![] }); } else { const _0x169230 = await _0x41f63e(); if (_0x169230 && _0x169230['events']?.[_0x63a052(0x848)]) await _0x4657e4(_0x169230); else { console[_0x63a052(0x2cf)]('Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.'); const _0x56e97f = _0xcfd119['participantIds'][_0x63a052(0xa21)](_0x5b19fc)['filter'](Boolean); if (!_0x56e97f[_0x63a052(0x848)]) return; let _0x166460 = 0x0; for (const _0xb49b9c of _0x56e97f) { _0x8101d0(_0xb49b9c, { 'force': !![], 'delayMs': _0x166460 }), _0x166460 += 0x1f4; } } } } else _0x42e991['getElementById']('char-edit-sprite-' + _0x213ce7 + _0x63a052(0x972))[_0x63a052(0x10d)]['backgroundImage'] = _0x63a052(0x7a2) + _0x4350a8[_0x63a052(0x73d)](_0x25a60a) + '\x27)'; } catch (_0x354176) { _0x354176[_0x63a052(0x6b7)] !== _0x63a052(0x885) && (console[_0x63a052(0x729)]('获取AI响应失败:', _0x354176), _0x1ee743({ 'role': _0x63a052(0x7f0), 'content': '错误:\x20' + _0x354176[_0x63a052(0x380)] }, _0x10530c['conversationHistory'][_0x63a052(0x848)] - 0x1)); } finally { _0x10530c[_0x63a052(0xa4a)] = ![], _0x1cdcc1(![]); } } function _0x1b24a5(_0xb214bc, _0x2e73ff) { const _0x475e8c = _0x1da6ac; if (_0x475e8c(0x71d) === _0x475e8c(0xa1e)) _0x585541 = _0x5e3a68['createObjectURL'](_0x37d89c); else { const _0x49baa2 = _0x2e73ff[_0x475e8c(0x51f)](), _0x112dd1 = _0xb214bc[_0x475e8c(0x51f)](); if (_0x49baa2[_0x475e8c(0x33c)]('claude')) return _0x475e8c(0x2b7); if (_0x112dd1['includes']('anthropic.com')) return 'anthropic'; if (_0x112dd1[_0x475e8c(0xa83)]('googleapis.com')) return _0x475e8c(0x1a7); if (_0x49baa2[_0x475e8c(0x33c)](_0x475e8c(0x1a7))) return 'gemini'; return _0x475e8c(0x6b0); } } async function _0x2d63cb(_0xdbcb3, _0x2eeaff = {}) { const _0x36c082 = _0x1da6ac; _0x10530c['currentAbortController'] && (_0x36c082(0x58c) === _0x36c082(0x58c) ? _0x10530c['currentAbortController'][_0x36c082(0x8f2)]('New\x20request\x20started') : _0x1a57fe['style'][_0x36c082(0xad9)] = _0x36c082(0x7a2) + _0xa2b798['avatar'] + '\x27)'); _0x10530c[_0x36c082(0x557)] = new AbortController(); const _0x2e0539 = _0x10530c[_0x36c082(0x557)]['signal'], { endpoint: _0x41ad8c, key: _0x91ecde, model: _0x518e8c } = _0x10530c['apiSettings'], _0x477da2 = !!_0x2eeaff[_0x36c082(0x250)], _0x22fcb2 = _0x1b24a5(_0x41ad8c, _0x518e8c); console[_0x36c082(0x5e0)]('Detected\x20API\x20provider:\x20' + _0x22fcb2); let _0x582fff = ''; try { if ('RknqN' !== _0x36c082(0x521)) { switch (_0x22fcb2) { case _0x36c082(0x2b7): { const _0x262267 = _0x538a31(_0x91ecde), _0x21396e = _0xdbcb3[_0x36c082(0x212)](_0x4c3b30 => _0x4c3b30['role'] === 'system')?.[_0x36c082(0x9a8)] || '', _0x596d43 = _0xdbcb3[_0x36c082(0x54e)](_0x158022 => _0x158022[_0x36c082(0x34a)] !== _0x36c082(0x11f)), _0x19d266 = { 'model': _0x518e8c, 'system': _0x21396e, 'messages': _0x596d43['map'](_0x1067b4 => ({ 'role': _0x1067b4[_0x36c082(0x34a)], 'content': [{ 'type': _0x36c082(0x958), 'text': _0x1067b4[_0x36c082(0x9a8)] }] })), 'max_tokens': 0x1000 }, _0x2a782b = await fetch(_0x41ad8c, { 'method': _0x36c082(0x2bc), 'headers': { 'Content-Type': _0x36c082(0x8e4), 'x-api-key': _0x262267, 'anthropic-version': _0x36c082(0x283) }, 'body': JSON['stringify'](_0x19d266), 'signal': _0x2e0539 }); if (!_0x2a782b['ok']) { if ('KbvVO' !== _0x36c082(0x822)) return _0x28e279[_0x36c082(0x36b)](_0x779c0c), _0xc2fd7b; else { const _0x4c06e7 = await _0x2a782b[_0x36c082(0x250)]()['catch'](() => ({})); throw new Error(_0x36c082(0x411) + _0x2a782b['status'] + '\x20-\x20' + (_0x4c06e7[_0x36c082(0x729)]?.[_0x36c082(0x380)] || _0x2a782b[_0x36c082(0x88e)])); } } const _0x4b6f5c = await _0x2a782b[_0x36c082(0x250)](); _0x582fff = _0x4b6f5c[_0x36c082(0x9a8)]?.[0x0]?.[_0x36c082(0x958)] || ''; break; } case _0x36c082(0x1a7): { const _0x21d1cc = _0x538a31(_0x91ecde), _0x19c4e7 = _0x41ad8c['includes']('generativelace.googleapis.com'), _0xa5a745 = _0x5ea111 => { const _0x57a267 = _0x36c082, _0x10f1cb = []; if (_0x5ea111[_0x57a267(0x9a8)]) _0x10f1cb['push']({ 'text': _0x5ea111[_0x57a267(0x9a8)] }); if (_0x5ea111['image']) { if ('uWHTn' === _0x57a267(0x77c)) { const _0x587cba = _0x5ea111[_0x57a267(0x1a2)]['split'](',')[0x1], _0x5a0305 = _0x5ea111['image']['substring'](_0x5ea111[_0x57a267(0x1a2)][_0x57a267(0x7ec)](':') + 0x1, _0x5ea111[_0x57a267(0x1a2)]['indexOf'](';')) || _0x57a267(0x6ed); _0x10f1cb['push']({ 'inline_data': { 'mime_type': _0x5a0305, 'data': _0x587cba } }); } else _0x5956aa[_0x57a267(0x10d)][_0x57a267(0x249)] = _0x57a267(0x1b6), _0xe32241[_0x57a267(0x10d)][_0x57a267(0x2b4)] = _0x57a267(0x9b4); } return _0x10f1cb; }, _0x3a14ee = _0xdbcb3[_0x36c082(0xa21)](_0x19cade => ({ 'role': _0x19cade[_0x36c082(0x34a)] === 'assistant' ? _0x36c082(0x43a) : _0x19cade[_0x36c082(0x34a)] === _0x36c082(0x11f) ? _0x36c082(0x27a) : _0x19cade[_0x36c082(0x34a)], 'parts': _0xa5a745(_0x19cade) }))[_0x36c082(0x54e)](_0x18a6e1 => _0x18a6e1[_0x36c082(0x6b4)][_0x36c082(0x848)] > 0x0), _0x511bed = { 'contents': _0x3a14ee }; _0x477da2 && _0x19c4e7 && (_0x511bed[_0x36c082(0x22b)] = { 'response_mime_type': 'application/json' }); const _0x1f5d4d = _0x41ad8c + _0x36c082(0x2ac) + _0x518e8c + _0x36c082(0x213) + _0x21d1cc + _0x36c082(0x856), _0x32e171 = await fetch(_0x1f5d4d, { 'method': 'POST', 'headers': { 'Content-Type': _0x36c082(0x8e4) }, 'body': JSON[_0x36c082(0x22e)](_0x511bed), 'signal': _0x2e0539 }); if (!_0x32e171['ok']) throw new Error(_0x36c082(0x9bd) + _0x32e171[_0x36c082(0xa37)]); const _0x50db58 = _0x32e171[_0x36c082(0x3ec)][_0x36c082(0xaac)](), _0x2347ff = new TextDecoder(); let _0x545fe7 = ''; while (!![]) { if (_0x36c082(0x22f) !== _0x36c082(0x22f)) { _0x5492db(_0x36c082(0x9f6)); return; } else { if (_0x2e0539['aborted']) { if (_0x36c082(0x692) === _0x36c082(0x692)) { console[_0x36c082(0x5e0)](_0x36c082(0x569)), _0x50db58[_0x36c082(0x131)](); break; } else { const _0x415c8b = _0xb8c37[_0x36c082(0x4bc)][_0x36c082(0x212)](_0x130a70 => _0x130a70[_0x36c082(0xaae)] && _0x130a70[_0x36c082(0xaae)][_0x36c082(0x979)]); _0x415c8b && (_0x415c8b[_0x36c082(0xaae)] = null, _0x5b112c(), _0x292315(_0x36c082(0x48a)), _0x4582e3(), _0x160b50[_0x36c082(0x882)][_0x36c082(0xae0)]('show'), _0x425e38(() => _0x46d5b7[_0x36c082(0x10d)][_0x36c082(0x5eb)] = _0x36c082(0x3fe), 0x12c)); } } const { done: _0x1b6129, value: _0x2503a3 } = await _0x50db58['read'](); if (_0x1b6129) break; const _0x4c3bc5 = _0x2347ff[_0x36c082(0x47d)](_0x2503a3, { 'stream': !![] }), _0x430542 = _0x4c3bc5['split']('\x0a')[_0x36c082(0x54e)](_0x1e19c7 => _0x1e19c7['trim']()[_0x36c082(0x33c)](_0x36c082(0x336))); for (const _0x525b77 of _0x430542) { if (_0x36c082(0x1aa) !== _0x36c082(0x1aa)) _0x507bb9(_0x36c082(0x3f8) + _0x212655['message']); else { const _0x3ea2fe = _0x525b77['replace'](_0x36c082(0x552), ''); if (_0x3ea2fe === _0x36c082(0x347)) break; try { _0x545fe7 += JSON[_0x36c082(0x329)](_0x3ea2fe)[_0x36c082(0x814)][0x0][_0x36c082(0x9a8)][_0x36c082(0x6b4)][0x0]['text']; } catch { } } } } } _0x582fff = _0x545fe7; break; } case _0x36c082(0x6b0): default: { const _0x26cf9b = _0x538a31(_0x91ecde), _0x509240 = _0x41ad8c[_0x36c082(0x7cf)](/\/+$/, '') + _0x36c082(0x841), _0xaf0720 = _0xdbcb3[_0x36c082(0xa21)](_0x3b3af4 => { const _0x5ba5f1 = _0x36c082; if (_0x5ba5f1(0x818) === _0x5ba5f1(0x92a)) { _0x1ebb8e[_0x5ba5f1(0x9a1)] = _0x5ba5f1(0x9e5); return; } else { if (_0x3b3af4['role'] === _0x5ba5f1(0x27a) && _0x3b3af4[_0x5ba5f1(0x1a2)]) { if (_0x5ba5f1(0x422) === _0x5ba5f1(0x6d7)) { const _0x5b3aa5 = _0x2520af['createObjectURL'](_0x144158); _0x58c342['src'] = _0x5b3aa5, _0x23a026[_0x5ba5f1(0x744)] = () => _0x59b3fd[_0x5ba5f1(0x8df)](_0x5b3aa5); } else return { 'role': 'user', 'content': [{ 'type': _0x5ba5f1(0x958), 'text': _0x3b3af4['content'] || '\x20' }, { 'type': _0x5ba5f1(0x5a2), 'image_url': { 'url': _0x3b3af4[_0x5ba5f1(0x1a2)], 'detail': 'high' } }] }; } return { 'role': _0x3b3af4[_0x5ba5f1(0x34a)], 'content': _0x3b3af4[_0x5ba5f1(0x9a8)] }; } })['filter'](_0x55e802 => _0x55e802['content']), _0x5d7650 = { 'model': _0x518e8c, 'messages': _0xaf0720, 'max_tokens': 0x1000, ..._0x477da2 ? { 'response_format': { 'type': 'json_object' } } : {} }, _0x11708d = await fetch(_0x509240, { 'method': _0x36c082(0x2bc), 'headers': { 'Content-Type': _0x36c082(0x8e4), 'Authorization': _0x36c082(0x9bf) + _0x26cf9b }, 'body': JSON[_0x36c082(0x22e)](_0x5d7650), 'signal': _0x2e0539 }); if (!_0x11708d['ok']) { if (_0x36c082(0xd0) === _0x36c082(0xd0)) { const _0x538586 = await _0x11708d[_0x36c082(0x250)]()['catch'](() => ({})); throw new Error(_0x36c082(0xa9f) + _0x11708d[_0x36c082(0xa37)] + _0x36c082(0x23b) + (_0x538586[_0x36c082(0x729)]?.[_0x36c082(0x380)] || _0x11708d['statusText'])); } else _0x1123a6['getElementById'](_0x36c082(0x5c5))[_0x36c082(0x70a)] = _0x197934[_0x36c082(0x917)] || _0x97504f; } const _0x54d147 = await _0x11708d[_0x36c082(0x250)](); _0x582fff = _0x54d147[_0x36c082(0x7b8)]?.[0x0]?.[_0x36c082(0x380)]?.['content'] || ''; break; } }return _0x582fff; } else _0x3e7ca0(_0x36c082(0x1fa) + _0x21207a[_0x36c082(0x64e)]('\x0a')); } catch (_0x64b763) { if (_0x36c082(0x9ec) === _0x36c082(0x72b)) return [_0x563c1c]; else { if (_0x64b763[_0x36c082(0x6b7)] === _0x36c082(0x885)) { if (_0x36c082(0x289) !== _0x36c082(0x289)) { const _0x34ab9d = _0x34adb0[_0x36c082(0xe5)]; let _0x48266a = _0x34ab9d['replace'](/\.bubble\.sent/g, _0x36c082(0x8ea))[_0x36c082(0x7cf)](/\.bubble\.received/g, _0x36c082(0x7df)); _0x3596ba['innerHTML'] = _0x48266a; } else return console['log'](_0x36c082(0x8a7)), ''; } throw _0x64b763; } } finally { _0x10530c[_0x36c082(0x557)] && _0x10530c[_0x36c082(0x557)]['signal'] === _0x2e0539 && (_0x10530c[_0x36c082(0x557)] = null); } } async function _0x279435() { const _0x5c88aa = _0x1da6ac, _0x5f1782 = _0x446e25['characterEdit'][_0x5c88aa(0x882)]['contains']('active'), _0x509838 = _0x5f1782 ? _0x2a5745[_0x5c88aa(0xe5)] : null; let _0x4bdaf2 = null, _0x2cc5fc = ''; if (_0x5f1782 && _0x509838) { _0x4bdaf2 = _0x10530c[_0x5c88aa(0x4bc)][_0x5c88aa(0x212)](_0x2865ab => _0x2865ab[_0x5c88aa(0xa78)] === 'private' && _0x2865ab[_0x5c88aa(0x26f)]['includes'](_0x509838)); const _0x42cb63 = _0x5b19fc(_0x509838); _0x2cc5fc = _0x42cb63 ? _0x42cb63[_0x5c88aa(0x6b7)] : _0x5c88aa(0x5ea); } else { if (_0x10530c['activeChatId']) { _0x4bdaf2 = _0x27b19d(); const _0x399869 = document[_0x5c88aa(0x248)](_0x5c88aa(0x930))['textContent']; _0x2cc5fc = _0x399869 || '当前聊天'; } } if (!_0x4bdaf2) { if (_0x5c88aa(0x8bf) !== _0x5c88aa(0x4af)) { _0x3a6c86('找不到要清空的聊天记录。'); return; } else _0x44a325[_0x5c88aa(0x882)][_0x5c88aa(0xae0)](_0x5c88aa(0x11b)); } const _0x328ab3 = await _0x52e7d6('确定要清空\x22' + _0x2cc5fc + '\x22\x20的聊天记录吗？此操作不可撤销。'); if (!_0x328ab3) return; _0x4bdaf2['id'] === _0x10530c[_0x5c88aa(0x16e)] && (_0x39ae19(), _0x10530c['conversationHistory'] = [], _0x1a245d()); try { localStorage[_0x5c88aa(0x89a)]('chatHistory_' + _0x4bdaf2['id']); } catch (_0x22aaa0) { console[_0x5c88aa(0x729)]('Failed\x20to\x20remove\x20history\x20for\x20chat\x20' + _0x4bdaf2['id'], _0x22aaa0); } _0x3a6c86('\x22' + _0x2cc5fc + _0x5c88aa(0x864)); } const _0x149c4d = document[_0x1da6ac(0x248)](_0x1da6ac(0x510)), _0x1cb7b3 = document[_0x1da6ac(0x248)](_0x1da6ac(0x974)), _0x58428e = document['getElementById'](_0x1da6ac(0xe7)); _0x149c4d['addEventListener'](_0x1da6ac(0x4b3), async () => { const _0x474498 = _0x1da6ac; _0xbc2d1c(!![], _0x474498(0x82d)); const _0x38c10d = []; try { if (_0x474498(0xad0) !== _0x474498(0xad0)) _0x20bfe4 = _0x216a5d[_0x474498(0x6b7)]; else { const _0x198f45 = { 'localStorageData': {}, 'indexedDBData': {}, 'indexedDBMusicData': [] }; for (let _0xf0aaad = 0x0; _0xf0aaad < localStorage['length']; _0xf0aaad++) { if (_0x474498(0x4cc) === 'VyIFB') { if (_0x2ab16f[_0x474498(0x797)] === _0x474498(0x137)) _0x5950ee(null); _0x5bc0bf[_0x474498(0x797)] === 'Enter' && (_0x402294[_0x474498(0x148)](), _0x53547d()); } else { const _0x5eccb0 = localStorage['key'](_0xf0aaad); if (_0x5eccb0) _0x198f45['localStorageData'][_0x5eccb0] = localStorage['getItem'](_0x5eccb0); } } const _0x2ef7b5 = await _0x12b672, _0x38b030 = _0x2ef7b5[_0x474498(0x319)](_0x1b51fb, 'readonly'), _0x1641a6 = _0x38b030[_0x474498(0x963)](_0x1b51fb), _0x26e404 = await new Promise((_0x31a10c, _0x3d12fb) => { const _0x501b0a = _0x474498; if (_0x501b0a(0x4ce) !== _0x501b0a(0x4ce)) { _0xeaff7f(_0x501b0a(0x23e)); return; } else { const _0x480879 = _0x1641a6[_0x501b0a(0x385)](); _0x480879['onsuccess'] = () => _0x31a10c(_0x480879['result']), _0x480879[_0x501b0a(0x136)] = () => _0x3d12fb(_0x480879[_0x501b0a(0x729)]); } }); for (const _0x1f3416 of _0x26e404) { if (_0x474498(0x9b8) !== _0x474498(0x421)) { if (_0x1f3416[_0x474498(0x226)] instanceof Blob) try { _0x474498(0xc3) !== 'jzjXU' ? (_0x229ff6(), _0xbcca84(![])) : _0x198f45[_0x474498(0x2d5)][_0x1f3416['id']] = await _0x3c4a4d(_0x1f3416[_0x474498(0x226)]); } catch (_0x285def) { _0x38c10d[_0x474498(0x36b)](_0x1f3416['id']); } } else _0x937421[_0x474498(0x729)](_0x474498(0x5fb), _0x2f64ae); } const _0x45d275 = _0x2ef7b5['transaction'](_0x4dd7ec, _0x474498(0x559)), _0x273eef = _0x45d275[_0x474498(0x963)](_0x4dd7ec), _0x388f72 = await new Promise((_0x295505, _0x45b771) => { const _0x3927e2 = _0x474498, _0x380cb5 = _0x273eef['getAll'](); _0x380cb5[_0x3927e2(0x330)] = () => _0x295505(_0x380cb5[_0x3927e2(0x4f7)]), _0x380cb5['onerror'] = () => _0x45b771(_0x380cb5[_0x3927e2(0x729)]); }); for (const _0x1ef1f8 of _0x388f72) { const _0x316a16 = { ..._0x1ef1f8 }; if (_0x1ef1f8[_0x474498(0x774)] instanceof Blob) { if ('QbtmT' === _0x474498(0x472)) { const { omniText: _0x1a7ca1 } = _0x39459b(_0x14d243['id'], null), _0x3cf53d = _0x4d1539(_0x4d2e31['id']), _0x9b86c2 = _0x501592['linkedWorldBookIds'] && _0x3ca077[_0x474498(0x7e0)][_0x474498(0x848)] > 0x0 ? _0x474498(0x8cb) + _0x11456a[_0x474498(0x6b7)] + _0x474498(0x9dc) + _0x39ef36[_0x474498(0x7e0)][_0x474498(0xa21)](_0x3e894f => _0x4327ee[_0x474498(0x79a)][_0x474498(0x212)](_0x4a83d6 => _0x4a83d6['id'] === _0x3e894f))[_0x474498(0x54e)](_0x13fe77)[_0x474498(0xa21)](_0x91dd22 => _0x474498(0x9c1) + _0x91dd22['name'] + '\x0a' + _0x91dd22[_0x474498(0x9a8)])[_0x474498(0x64e)]('') : ''; return _0x474498(0x29d) + _0x1b13e5[_0x474498(0x6b7)] + _0x474498(0x152) + _0x4b17d7['id'] + _0x474498(0x6f4) + _0x140a13[_0x474498(0x824)] + '\x0a\x20\x20相关记忆:\x0a' + _0x1a7ca1 + '\x0a' + _0x3cf53d + '\x0a' + _0x9b86c2; } else _0x316a16[_0x474498(0x774)] = await _0x3c4a4d(_0x1ef1f8[_0x474498(0x774)]); } _0x1ef1f8[_0x474498(0x55a)] instanceof Blob && (_0x316a16[_0x474498(0x55a)] = await _0x3c4a4d(_0x1ef1f8[_0x474498(0x55a)])), _0x198f45[_0x474498(0x7fd)][_0x474498(0x36b)](_0x316a16); } const _0x19d672 = new Blob([JSON[_0x474498(0x22e)](_0x198f45, null, 0x2)], { 'type': _0x474498(0x8e4) }), _0x2fe4dc = URL[_0x474498(0x73d)](_0x19d672), _0x78eba = document['createElement']('a'), _0x3c6c43 = new Date(), _0x476c1d = _0x3c6c43[_0x474498(0x5f8)]() + '-' + String(_0x3c6c43[_0x474498(0xa84)]() + 0x1)[_0x474498(0x1db)](0x2, '0') + '-' + String(_0x3c6c43[_0x474498(0x208)]())[_0x474498(0x1db)](0x2, '0'); _0x78eba[_0x474498(0x46d)] = _0x2fe4dc, _0x78eba[_0x474498(0x4b7)] = 'Noir_Backup_' + _0x476c1d + _0x474498(0x6ee), document[_0x474498(0x3ec)][_0x474498(0x6ab)](_0x78eba), _0x78eba[_0x474498(0x4b3)](), document[_0x474498(0x3ec)][_0x474498(0x775)](_0x78eba), URL[_0x474498(0x8df)](_0x2fe4dc), _0xbc2d1c(![]); if (_0x38c10d[_0x474498(0x848)] > 0x0) _0x474498(0xa7a) !== 'RaWtr' ? _0x3a6c86(_0x474498(0x1fa) + _0x38c10d['join']('\x0a')) : (_0xcc1098(), _0x57dc41()); else { if (_0x474498(0x8ec) === _0x474498(0x8ec)) _0x3a6c86(_0x474498(0x3b1)); else { _0xbb5b7a = _0xb52c1f[_0x474498(0x4bc)]['find'](_0x41ab5b => _0x41ab5b[_0x474498(0xa78)] === _0x474498(0x71a) && _0x41ab5b[_0x474498(0x26f)]['includes'](_0x55077f)); const _0x10da1c = _0x5c9c0a(_0x27fb1d); _0xc1996b = _0x10da1c ? _0x10da1c[_0x474498(0x6b7)] : _0x474498(0x5ea); } } } } catch (_0x171103) { if (_0x474498(0x6af) === _0x474498(0x6af)) _0xbc2d1c(![]), console[_0x474498(0x729)]('全量导出失败:', _0x171103), _0x3a6c86(_0x474498(0x1f1) + _0x171103['message']); else { const _0x32e526 = _0x387152[_0x474498(0xa29)][_0x486dca]; _0x32e526 && _0x32e526[_0x474498(0x58f)] && _0x2949bc['accountingData']['push'](..._0x32e526[_0x474498(0x58f)]), delete _0x368058[_0x474498(0xa29)][_0x196370], _0x604bdc(), _0x25f961(); } } }), _0x1cb7b3[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x50bb21 = _0x1da6ac; _0x58428e[_0x50bb21(0x4b3)](); }), _0x4a2445[_0x1da6ac(0x578)]('click', _0x5719b1), _0x58428e[_0x1da6ac(0x578)](_0x1da6ac(0x423), _0x4ce487 => { const _0x45003a = _0x1da6ac, _0x1b3a4b = _0x4ce487[_0x45003a(0x6c4)][_0x45003a(0x5fc)][0x0]; if (!_0x1b3a4b) return; _0x52e7d6(_0x45003a(0x3d8))[_0x45003a(0x45f)](_0x434b39 => { const _0x3e8537 = _0x45003a; if (!_0x434b39) { if (_0x3e8537(0x27b) === _0x3e8537(0x805)) _0x191ece[_0x3e8537(0x57f)][_0x3e8537(0x36b)]({ 'senderId': _0xcc72c['id'], 'kind': 'sticker', 'sticker': _0x52f205 }); else { _0x58428e[_0x3e8537(0xe5)] = ''; return; } } _0xbc2d1c(!![], _0x3e8537(0x777)); const _0x274f30 = new FileReader(); _0x274f30['onload'] = async _0x4a5977 => { const _0x554df6 = _0x3e8537; try { if (_0x554df6(0x478) !== _0x554df6(0xa0c)) { const _0x4c5c8f = JSON['parse'](_0x4a5977['target']['result']); if (!_0x4c5c8f[_0x554df6(0x30e)] || !_0x4c5c8f[_0x554df6(0x2d5)]) throw new Error('文件格式不正确，不是一个有效的备份文件。'); _0xbc2d1c(!![], _0x554df6(0x921)); const _0x5bd9f0 = await Promise[_0x554df6(0x63b)](Object[_0x554df6(0x147)](_0x4c5c8f['indexedDBData'])[_0x554df6(0xa21)](async _0x313cb0 => { const _0x415a3e = _0x554df6, _0x3a815c = _0x4c5c8f[_0x415a3e(0x2d5)][_0x313cb0]; if (typeof _0x3a815c === _0x415a3e(0x9d1) && _0x3a815c['startsWith']('data:')) { if (_0x415a3e(0x676) !== 'HPfMt') _0x2169b5 += _0x415a3e(0x240), _0x3bf5e4[_0x415a3e(0x5e0)]['forEach'](_0x48cefa => { const _0x407bde = _0x415a3e, _0x10d5bf = _0x48cefa['sender'] === 'character' ? '你' : _0x4eaedc['contact_name']; _0xfeee96 += _0x407bde(0x2fc) + _0x10d5bf + ':\x20' + _0x48cefa[_0x407bde(0x9a8)] + '\x0a'; }); else { const _0x2da69b = await _0x39f481(_0x3a815c); return { 'id': _0x313cb0, 'blob': _0x2da69b }; } } return null; }))['then'](_0x1d3ecb => _0x1d3ecb[_0x554df6(0x54e)](Boolean)), _0x5dd917 = []; if (_0x4c5c8f[_0x554df6(0x7fd)]) { if (_0x554df6(0x460) !== _0x554df6(0x786)) { _0xbc2d1c(!![], _0x554df6(0x582)); const _0x41d9ec = _0x4c5c8f[_0x554df6(0x7fd)][_0x554df6(0xa21)](async _0x2b9cdc => { const _0xe6ea06 = _0x554df6, _0x3f1bc6 = { ..._0x2b9cdc }; if (_0x2b9cdc[_0xe6ea06(0x774)]) _0x3f1bc6['audio'] = await _0x39f481(_0x2b9cdc[_0xe6ea06(0x774)]); if (_0x2b9cdc['cover']) _0x3f1bc6['cover'] = await _0x39f481(_0x2b9cdc[_0xe6ea06(0x55a)]); return _0x3f1bc6; }); _0x5dd917[_0x554df6(0x36b)](...await Promise[_0x554df6(0x63b)](_0x41d9ec)); } else _0xc3b1af(_0x400c89[_0x554df6(0x242)])['then'](_0x4fb7d6 => { const _0x5a1fca = _0x554df6, _0xe7320 = _0x1eec84['getElementById'](_0x28c5da); if (_0xe7320 && _0x4fb7d6) _0xe7320[_0x5a1fca(0x70a)] = _0x139de3['createObjectURL'](_0x4fb7d6); }); } _0xbc2d1c(!![], _0x554df6(0x67a)), localStorage['clear'](); for (const _0x5154db in _0x4c5c8f['localStorageData']) { localStorage[_0x554df6(0x9e0)](_0x5154db, _0x4c5c8f['localStorageData'][_0x5154db]); } _0xbc2d1c(!![], _0x554df6(0x586)); const _0x2596e3 = await _0x12b672, _0x33a851 = _0x2596e3[_0x554df6(0x319)]([_0x1b51fb, _0x4dd7ec, _0x4f820a], _0x554df6(0x52c)), _0x1cecf6 = _0x33a851['objectStore'](_0x1b51fb), _0x1e7019 = _0x33a851[_0x554df6(0x963)](_0x4dd7ec), _0x90cd01 = _0x33a851[_0x554df6(0x963)](_0x4f820a); _0x1cecf6[_0x554df6(0xd4)](), _0x1e7019['clear'](), _0x90cd01[_0x554df6(0xd4)](), _0x5bd9f0['forEach'](_0x18dbab => _0x1cecf6[_0x554df6(0xa8b)](_0x18dbab)), _0x5dd917[_0x554df6(0x986)](_0x5e0dd0 => _0x1e7019[_0x554df6(0xa8b)](_0x5e0dd0)), await new Promise((_0x4aedbd, _0x591b31) => { const _0x45de62 = _0x554df6; if (_0x45de62(0x60b) === _0x45de62(0x60b)) _0x33a851[_0x45de62(0x7e4)] = _0x4aedbd, _0x33a851[_0x45de62(0x136)] = _0x1da4ee => _0x591b31(_0x1da4ee[_0x45de62(0x6c4)][_0x45de62(0x729)]); else return _0x574a10[_0x45de62(0x5e0)]('Fetch\x20request\x20was\x20aborted.'), ''; }), _0xbc2d1c(![]), _0x3a6c86('数据导入成功！应用即将刷新...'), setTimeout(() => location[_0x554df6(0x7a6)](), 0x640); } else _0x16101a[_0x554df6(0x89a)](_0x554df6(0x507)), _0x27878c[_0x554df6(0x89a)](_0x554df6(0x790)), _0x568469(_0x554df6(0x6a9)), _0x12e031(() => _0x2027f2[_0x554df6(0x7a6)](), 0x3e8); } catch (_0x2f03aa) { _0xbc2d1c(![]), console[_0x554df6(0x729)]('全量导入失败:', _0x2f03aa), _0x3a6c86('导入失败:\x20' + _0x2f03aa[_0x554df6(0x380)]); } finally { _0x554df6(0x378) !== 'Ikgwm' ? _0x58428e[_0x554df6(0xe5)] = '' : (_0x5133dd[_0x554df6(0x729)](_0x554df6(0x9cd), _0x10a712), _0x3496ca(_0x554df6(0x73e))); } }, _0x274f30[_0x3e8537(0x379)](_0x1b3a4b); }); }); function _0x551015() { const _0x44955c = _0x1da6ac; _0x44955c(0x603) !== 'AHywv' ? (_0x5a1671['value'] = _0x10530c['apiSettings'][_0x44955c(0x389)] || '', _0x38afae['value'] = _0x10530c['apiSettings']['key'] || '', _0x3a9d9a[_0x44955c(0xe5)] = _0x10530c[_0x44955c(0x899)]['model'] || '', _0x46cf81['value'] = String(_0x10530c[_0x44955c(0x827)]?.[_0x44955c(0x2f8)] ?? 0x64), document[_0x44955c(0x248)](_0x44955c(0x6ea))[_0x44955c(0xe5)] = _0x10530c[_0x44955c(0x899)][_0x44955c(0x43c)] || 'openai') : _0x527175[_0x44955c(0x42b)] = _0x2f762e(() => { const _0x3c5242 = _0x44955c; if (_0x3905cd[_0x3c5242(0xa78)] === _0x3c5242(0x936)) _0x5150df['preventDefault'](); _0x5a9621(_0x19b4e6(_0x3085d4, 0xa), _0x586acd); }, 0x320); } function _0x232bfa() { const _0x27533a = _0x1da6ac; _0x10530c[_0x27533a(0x899)]['endpoint'] = _0x5a1671['value'][_0x27533a(0x3ee)](), _0x10530c['apiSettings'][_0x27533a(0x797)] = _0x38afae[_0x27533a(0xe5)][_0x27533a(0x3ee)](), _0x10530c[_0x27533a(0x899)][_0x27533a(0x43a)] = _0x3a9d9a[_0x27533a(0xe5)][_0x27533a(0x3ee)](), _0x10530c['apiSettings'][_0x27533a(0x43c)] = document[_0x27533a(0x248)]('api-provider')[_0x27533a(0xe5)]; const _0x3b7303 = parseInt(_0x46cf81[_0x27533a(0xe5)], 0xa); _0x10530c[_0x27533a(0x827)][_0x27533a(0x2f8)] = Number[_0x27533a(0x171)](_0x3b7303) && _0x3b7303 > 0x0 ? _0x3b7303 : 0x64, _0x3e6d3a(), _0x3a6c86(_0x27533a(0x27c)); } function _0x245822() { const _0x490e48 = _0x1da6ac; _0x5b463c[_0x490e48(0xe5)] = _0x10530c[_0x490e48(0x1c9)][_0x490e48(0x6b7)] || '', _0x475da2[_0x490e48(0x70a)] = _0x10530c[_0x490e48(0x1c9)][_0x490e48(0x917)] || _0x45fac0, _0x5f598f[_0x490e48(0xe5)] = _0x10530c['userProfile'][_0x490e48(0x824)] || ''; } async function _0xfec8c0(_0x2792af = null) { const _0xc3fc98 = _0x1da6ac; _0x1c4afc(_0xc3fc98(0xd7), _0x43c968); const _0x273d07 = document['getElementById']('char-avatar-frame-url'), _0x2d5503 = document[_0xc3fc98(0x248)]('user-avatar-frame-url-in-chat'), _0x25a251 = document['querySelector']('#char-edit-avatar-preview\x20+\x20.avatar-frame'); if (_0x2792af) { const _0xf03ac0 = _0x10530c['characters'][_0xc3fc98(0x212)](_0x9e4291 => _0x9e4291['id'] === _0x2792af); _0x273d07['value'] = _0xf03ac0[_0xc3fc98(0x86f)] || '', _0x2d5503[_0xc3fc98(0xe5)] = _0xf03ac0[_0xc3fc98(0x239)] || ''; if (_0x25a251) _0x25a251[_0xc3fc98(0x10d)]['backgroundImage'] = _0xf03ac0['avatarFrameUrl'] ? _0xc3fc98(0x7a2) + _0xf03ac0[_0xc3fc98(0x86f)] + '\x27)' : ''; } else { _0x273d07[_0xc3fc98(0xe5)] = '', _0x2d5503[_0xc3fc98(0xe5)] = ''; if (_0x25a251) _0x25a251[_0xc3fc98(0x10d)][_0xc3fc98(0xad9)] = ''; } _0x273d07['addEventListener'](_0xc3fc98(0x58e), () => { const _0xcc6b48 = _0xc3fc98; if ('ftblk' === _0xcc6b48(0x5e2)) _0x345a7f['querySelectorAll'](_0xcc6b48(0x867))['forEach'](_0x4c1044 => { const _0x13b7aa = _0xcc6b48; _0x4c1044['addEventListener'](_0x13b7aa(0x4b3), () => { const _0x1d4b44 = _0x13b7aa, _0x7b23b0 = _0x424b5f[_0x1d4b44(0x329)](_0x4c1044['dataset'][_0x1d4b44(0x5e0)][_0x1d4b44(0x7cf)](/&quot;/g, '\x22')), _0x1b4abd = _0x4c1044[_0x1d4b44(0xab1)][_0x1d4b44(0x6a8)], _0x84386e = _0x4c1044['dataset'][_0x1d4b44(0x813)]; _0x345dec(_0x1b4abd, _0x84386e, _0x7b23b0); }); }); else { if (_0x25a251) _0x25a251[_0xcc6b48(0x10d)][_0xcc6b48(0xad9)] = _0x273d07['value'] ? 'url(\x27' + _0x273d07[_0xcc6b48(0xe5)] + '\x27)' : ''; } }); const _0x3aaf1a = document[_0xc3fc98(0x248)]('world-book-checkboxes-container'); _0x3aaf1a[_0xc3fc98(0x9a1)] = '', _0x10530c[_0xc3fc98(0x79a)][_0xc3fc98(0x986)](_0x101339 => { const _0x1c83f6 = _0xc3fc98, _0x50963a = document[_0x1c83f6(0x3b9)](_0x1c83f6(0x737)); _0x50963a[_0x1c83f6(0x9a1)] = _0x1c83f6(0xcc) + _0x101339['id'] + _0x1c83f6(0x294) + _0x101339['name'], _0x3aaf1a[_0x1c83f6(0x6ab)](_0x50963a); }), _0xb18b1d(_0xc3fc98(0x3a3)), _0x708448[_0xc3fc98(0x70a)] = _0x5da029, _0x14d098[_0xc3fc98(0xe5)] = '', _0xcbeb2d[_0xc3fc98(0x10d)][_0xc3fc98(0xad9)] = '', _0x39cf3b[_0xc3fc98(0xe5)] = '', _0x4bafaa[_0xc3fc98(0x10d)][_0xc3fc98(0xad9)] = '', _0x55821a['value'] = ''; const _0x58c1d9 = [_0xc3fc98(0x47b), _0xc3fc98(0x6bb), _0xc3fc98(0x977), _0xc3fc98(0x6a3), _0xc3fc98(0x1b7)]; _0x58c1d9[_0xc3fc98(0x986)](_0x24272e => { const _0x1ea2f5 = _0xc3fc98; document[_0x1ea2f5(0x248)](_0x1ea2f5(0x426) + _0x24272e + '-preview')[_0x1ea2f5(0x10d)][_0x1ea2f5(0xad9)] = '', document[_0x1ea2f5(0x248)]('char-edit-sprite-' + _0x24272e + _0x1ea2f5(0x7f5))['value'] = ''; }); if (_0x2792af) { const _0xf3dcaa = _0x10530c[_0xc3fc98(0x620)][_0xc3fc98(0x212)](_0x1fe9ec => _0x1fe9ec['id'] === _0x2792af); if (!_0xf3dcaa) return; _0x2a5745['value'] = _0xf3dcaa['id'], _0x124156[_0xc3fc98(0x9ac)] = _0xc3fc98(0x86e), _0x332541['value'] = _0xf3dcaa[_0xc3fc98(0x6b7)], _0xb2b4f1[_0xc3fc98(0xe5)] = _0xf3dcaa['remark'], _0x53ea16['value'] = _0xf3dcaa[_0xc3fc98(0x824)], document[_0xc3fc98(0x248)]('char-edit-css')['value'] = _0xf3dcaa['bubbleCss'] || ''; const _0x1385ed = _0x10530c[_0xc3fc98(0x4bc)][_0xc3fc98(0x212)](_0x310253 => _0x310253[_0xc3fc98(0xa78)] === _0xc3fc98(0x71a) && _0x310253[_0xc3fc98(0x26f)][_0xc3fc98(0xa83)](_0x2792af)); document[_0xc3fc98(0x248)](_0xc3fc98(0x3a3))['value'] = _0x1385ed?.[_0xc3fc98(0x2eb)] || _0x10530c['activeUserProfileId']; try { if (_0xc3fc98(0x651) !== _0xc3fc98(0x651)) { _0x3cacc3[_0xc3fc98(0x729)](_0xc3fc98(0xeb), _0x346c48); const _0x13233f = { 'role': _0xc3fc98(0x7f0), 'content': '错误:\x20' + _0xfc02cc['message'], 'senderId': _0x485ee3['id'], 'isOffline': _0x2526fb }; _0x10c573['conversationHistory']['push'](_0x13233f), _0x1e648e(); } else { const _0x2464ff = await _0x533d7a('char_avatar_' + _0xf3dcaa['id']), _0x20a2bd = await _0x533d7a(_0xc3fc98(0x72e) + _0xf3dcaa['id']), _0x5d60a5 = await _0x533d7a(_0xc3fc98(0x727) + _0xf3dcaa['id']); _0x708448[_0xc3fc98(0x70a)] = _0x2464ff ? URL[_0xc3fc98(0x73d)](_0x2464ff) : _0xf3dcaa[_0xc3fc98(0x917)] || _0x5da029; if (_0x20a2bd) _0xcbeb2d[_0xc3fc98(0x10d)][_0xc3fc98(0xad9)] = _0xc3fc98(0x7a2) + URL['createObjectURL'](_0x20a2bd) + '\x27)'; if (_0x5d60a5) _0x4bafaa[_0xc3fc98(0x10d)][_0xc3fc98(0xad9)] = 'url(\x27' + URL[_0xc3fc98(0x73d)](_0x5d60a5) + '\x27)'; for (const _0x78a05a of _0x58c1d9) { const _0x2e7e60 = await _0x533d7a(_0xc3fc98(0x7c2) + _0x78a05a + '_' + _0xf3dcaa['id']); _0x2e7e60 && (document[_0xc3fc98(0x248)]('char-edit-sprite-' + _0x78a05a + _0xc3fc98(0x972))['style'][_0xc3fc98(0xad9)] = _0xc3fc98(0x7a2) + URL['createObjectURL'](_0x2e7e60) + '\x27)'); } } } catch (_0x28342c) { _0xc3fc98(0x5bd) === 'IlKnk' ? (console[_0xc3fc98(0x729)](_0xc3fc98(0x4fc) + _0xf3dcaa['id'] + '\x20的图片失败:', _0x28342c), _0x708448['src'] = _0xf3dcaa[_0xc3fc98(0x917)] || _0x5da029) : _0x4c0dad('有\x20' + _0x9c7b71 + '\x20行格式不对，被我无视了。'); } _0xf3dcaa[_0xc3fc98(0x7e0)] && _0x3aaf1a[_0xc3fc98(0x20d)](_0xc3fc98(0x47e))[_0xc3fc98(0x986)](_0x4770c6 => { const _0x2f71f6 = _0xc3fc98; if (_0x2f71f6(0x2c2) === 'KveLp') _0x44ab5a(_0x2f71f6(0x7dc) + _0xde5c5e['message']); else { if (_0xf3dcaa[_0x2f71f6(0x7e0)][_0x2f71f6(0xa83)](_0x4770c6[_0x2f71f6(0xe5)])) _0x4770c6['checked'] = !![]; } }), _0x294c66(); } else _0xc3fc98(0x965) !== _0xc3fc98(0x24e) ? (_0x2a5745[_0xc3fc98(0xe5)] = '', _0x124156['textContent'] = _0xc3fc98(0x96f), _0x332541[_0xc3fc98(0xe5)] = _0xc3fc98(0xad5) + (_0x10530c['characters'][_0xc3fc98(0x848)] + 0x1), _0xb2b4f1[_0xc3fc98(0xe5)] = '', _0x53ea16[_0xc3fc98(0xe5)] = _0xc3fc98(0x245), document['getElementById'](_0xc3fc98(0xe9))[_0xc3fc98(0xe5)] = '', _0x294c66()) : (_0x31683b(![]), _0x1c2c75['isGenerating'] = ![]); const _0x399231 = document[_0xc3fc98(0x248)](_0xc3fc98(0xe9)); let _0x39bc12 = document[_0xc3fc98(0x248)]('live-preview-style'); !_0x39bc12 && (_0x39bc12 = document[_0xc3fc98(0x3b9)](_0xc3fc98(0x10d)), _0x39bc12['id'] = _0xc3fc98(0x388), document[_0xc3fc98(0x450)][_0xc3fc98(0x6ab)](_0x39bc12)); const _0xdb59b0 = () => { const _0x1378c7 = _0xc3fc98; if (_0x1378c7(0xa41) !== _0x1378c7(0x3d9)) { const _0x111ba3 = _0x399231[_0x1378c7(0xe5)]; let _0x3813d4 = _0x111ba3[_0x1378c7(0x7cf)](/\.bubble\.sent/g, '#bubble-preview-user')['replace'](/\.bubble\.received/g, _0x1378c7(0x7df)); _0x39bc12['innerHTML'] = _0x3813d4; } else { const _0x4a1a1e = { 'id': _0x1378c7(0xac2) + _0x28e3dd['now'](), 'name': _0x18a6d1, 'boundUserProfileId': _0x34a6ba, 'memberCharacterIds': _0x4e5041, 'posts': [] }; _0xa9dd7e[_0x1378c7(0x7b9)][_0x1378c7(0x36b)](_0x4a1a1e); } }; _0x399231['removeEventListener']('input', _0xdb59b0), _0x399231['addEventListener'](_0xc3fc98(0x58e), _0xdb59b0), _0xdb59b0(); } async function _0x17afdc() { const _0x2b81eb = _0x1da6ac; if (_0x2b81eb(0x5af) === _0x2b81eb(0x5af)) { const _0xa5e637 = _0x2a5745[_0x2b81eb(0xe5)]; if (!_0xa5e637) { _0x3a6c86(_0x2b81eb(0x982)); return; } const _0x262368 = _0x5b19fc(_0xa5e637); if (!_0x262368) return; _0xbc2d1c(!![], '正在打包“' + _0x262368[_0x2b81eb(0x6b7)] + _0x2b81eb(0x2c4)); try { const _0x46ef01 = { 'type': 'NoirCharacterCard', 'version': 0x1, 'name': _0x262368[_0x2b81eb(0x6b7)], 'remark': _0x262368['remark'], 'persona': _0x262368[_0x2b81eb(0x824)], 'bubbleCss': _0x262368[_0x2b81eb(0x78f)], 'avatar': null, 'sprites': {}, 'worldBooks': [] }, _0x3d98d0 = await _0x533d7a(_0x2b81eb(0x583) + _0x262368['id']); if (_0x3d98d0) _0x46ef01[_0x2b81eb(0x917)] = await _0x3c4a4d(_0x3d98d0); const _0xdda08d = [_0x2b81eb(0x47b), _0x2b81eb(0x6bb), _0x2b81eb(0x977), 'sad', _0x2b81eb(0x1b7)]; for (const _0x52b994 of _0xdda08d) { const _0x19adfa = await _0x533d7a(_0x2b81eb(0x7c2) + _0x52b994 + '_' + _0x262368['id']); _0x19adfa && (_0x46ef01[_0x2b81eb(0x106)][_0x52b994] = await _0x3c4a4d(_0x19adfa)); } _0x262368[_0x2b81eb(0x7e0)] && _0x262368[_0x2b81eb(0x7e0)][_0x2b81eb(0x848)] > 0x0 && (_0x46ef01[_0x2b81eb(0x79a)] = _0x262368['linkedWorldBookIds'][_0x2b81eb(0xa21)](_0x13da9b => _0x10530c[_0x2b81eb(0x79a)][_0x2b81eb(0x212)](_0x12092e => _0x12092e['id'] === _0x13da9b))[_0x2b81eb(0x54e)](Boolean)['map'](_0x76385d => ({ 'name': _0x76385d['name'], 'content': _0x76385d['content'] }))); const _0x1b42d2 = new Blob([JSON[_0x2b81eb(0x22e)](_0x46ef01, null, 0x2)], { 'type': _0x2b81eb(0x8e4) }), _0x34e68d = URL[_0x2b81eb(0x73d)](_0x1b42d2), _0x42c634 = document[_0x2b81eb(0x3b9)]('a'); _0x42c634[_0x2b81eb(0x46d)] = _0x34e68d, _0x42c634['download'] = _0x262368['name'] + _0x2b81eb(0x332), document['body'][_0x2b81eb(0x6ab)](_0x42c634), _0x42c634[_0x2b81eb(0x4b3)](), document[_0x2b81eb(0x3ec)][_0x2b81eb(0x775)](_0x42c634), URL[_0x2b81eb(0x8df)](_0x34e68d); } catch (_0x490efe) { if (_0x2b81eb(0x134) !== _0x2b81eb(0x210)) console['error'](_0x2b81eb(0x45b), _0x490efe), _0x3a6c86(_0x2b81eb(0x60e) + _0x490efe[_0x2b81eb(0x380)]); else { _0x9948a9('我正在说话呢，别打岔！'); return; } } finally { _0xbc2d1c(![]); } } else _0x169822[_0x2b81eb(0x248)](_0x2b81eb(0x7b7))[_0x2b81eb(0xe5)] = '', _0x2f5eb9[_0x2b81eb(0x248)](_0x2b81eb(0x222))['textContent'] = '创建新用户', _0x4e51d6['getElementById'](_0x2b81eb(0x595))['value'] = _0x2b81eb(0x793) + (_0x54e8e9[_0x2b81eb(0x360)][_0x2b81eb(0x848)] + 0x1), _0x5a565a[_0x2b81eb(0x10d)][_0x2b81eb(0xad9)] = _0x2b81eb(0x7a2) + _0x916f8e + '\x27)', _0x2d44ad['getElementById']('user-persona')[_0x2b81eb(0xe5)] = '', _0x1b3cae['style']['display'] = _0x2b81eb(0x3fe), _0x4b17da[_0x2b81eb(0x248)](_0x2b81eb(0x99a))[_0x2b81eb(0x10d)][_0x2b81eb(0x5eb)] = _0x2b81eb(0x3fe); } async function _0x5cabf0(_0x1508db) { const _0x12f12a = _0x1da6ac, _0x332c59 = _0x1508db[_0x12f12a(0x6c4)]['files'][0x0]; if (!_0x332c59) return; _0xbc2d1c(!![], _0x12f12a(0x9ad)); const _0x583944 = new FileReader(); _0x583944[_0x12f12a(0x744)] = async _0x263e35 => { const _0x2f008e = _0x12f12a; try { const _0x1b9eee = JSON['parse'](_0x263e35['target']['result']); if (_0x1b9eee[_0x2f008e(0xa78)] !== 'NoirCharacterCard') { if ('MUjYw' !== _0x2f008e(0x3ea)) return { 'type': 'music', 'songName': _0x21eed8[0x1]['trim'](), 'artist': _0x2aa037[0x2][_0x2f008e(0x3ee)]() }; else throw new Error(_0x2f008e(0x934)); } const _0x1adf14 = []; if (_0x1b9eee[_0x2f008e(0x79a)] && _0x1b9eee[_0x2f008e(0x79a)][_0x2f008e(0x848)] > 0x0) { if (_0x2f008e(0x2e5) === _0x2f008e(0x386)) _0x410aff = { 'characterId': _0x1b1434, 'entries': [] }, _0x385d40[_0x2f008e(0x938)][_0x2f008e(0x36b)](_0x44cde6); else for (const _0x14a8cf of _0x1b9eee[_0x2f008e(0x79a)]) { if (_0x2f008e(0x7e7) !== 'xtiJt') _0x293098['oncomplete'] = _0x5d75a2, _0x297c76[_0x2f008e(0x136)] = _0x4592da => _0x5dfcc0(_0x4592da[_0x2f008e(0x6c4)][_0x2f008e(0x729)]); else { let _0x20d67c = _0x10530c['worldBooks']['find'](_0x28d1b8 => _0x28d1b8[_0x2f008e(0x6b7)] === _0x14a8cf[_0x2f008e(0x6b7)]); if (_0x20d67c) _0x1adf14['push'](_0x20d67c['id']); else { const _0x441232 = { 'id': _0x2f008e(0x405) + Date[_0x2f008e(0x7a8)]() + '_' + Math[_0x2f008e(0x59a)](), 'name': _0x14a8cf[_0x2f008e(0x6b7)], 'content': _0x14a8cf[_0x2f008e(0x9a8)] }; _0x10530c[_0x2f008e(0x79a)][_0x2f008e(0x36b)](_0x441232), _0x1adf14[_0x2f008e(0x36b)](_0x441232['id']); } } } } const _0x137e37 = _0x2f008e(0xa9e) + Date['now'](); if (_0x1b9eee[_0x2f008e(0x917)]) { const _0x564819 = await _0x39f481(_0x1b9eee[_0x2f008e(0x917)]); await _0x5ef29b(_0x2f008e(0x583) + _0x137e37, _0x564819); } if (_0x1b9eee['sprites']) { if (_0x2f008e(0x5d2) !== _0x2f008e(0x85e)) for (const _0x17d4b1 in _0x1b9eee['sprites']) { if (_0x2f008e(0xa75) === _0x2f008e(0x2f5)) _0x850ed7['style'][_0x2f008e(0x249)] = _0x2f008e(0xa60), _0x107a88[_0x2f008e(0x10d)][_0x2f008e(0x2b4)] = _0x2f008e(0x3fe); else { const _0x6363b9 = _0x1b9eee[_0x2f008e(0x106)][_0x17d4b1]; if (_0x6363b9) { if (_0x2f008e(0x4d6) !== _0x2f008e(0x4d6)) { _0x2a433d && _0x42ac44[_0x2f008e(0x36b)](_0x5bdcc9); _0x2c2469 = {}; const _0x2aa010 = _0xf0895f[_0x2f008e(0x3f1)](0x2), _0x59c4a3 = _0x2aa010[_0x2f008e(0x5ac)](/:\s(.+)/); if (_0x59c4a3[_0x2f008e(0x848)] > 0x1) { const _0x1c5ff6 = _0x59c4a3[0x0][_0x2f008e(0x3ee)](), _0x320121 = _0x59c4a3[0x1]['trim']()[_0x2f008e(0x7cf)](/^"|"$/g, ''); _0x4e90e0[_0x1c5ff6] = _0x320121; } } else { const _0x2e505c = await _0x39f481(_0x6363b9); await _0x5ef29b(_0x2f008e(0x7c2) + _0x17d4b1 + '_' + _0x137e37, _0x2e505c); } } } } else _0x12bdf9(_0x2f008e(0x94f), _0x2f008e(0x8f8)); } const _0x5cbdc7 = { 'id': _0x137e37, 'name': _0x1b9eee[_0x2f008e(0x6b7)], 'remark': _0x1b9eee[_0x2f008e(0x689)] || '', 'persona': _0x1b9eee[_0x2f008e(0x824)], 'avatar': _0x5da029, 'linkedWorldBookIds': _0x1adf14, 'bubbleCss': _0x1b9eee['bubbleCss'] || '', 'avatarFrameUrl': _0x1b9eee['avatarFrameUrl'] || '', 'userAvatarFrameUrl': _0x1b9eee[_0x2f008e(0x239)] || '' }; _0x10530c[_0x2f008e(0x620)][_0x2f008e(0x36b)](_0x5cbdc7); const _0x2cc0b0 = { 'id': _0x2f008e(0x5ff) + _0x137e37, 'type': _0x2f008e(0x71a), 'participantIds': [_0x137e37], 'boundUserProfileId': _0x10530c['activeUserProfileId'] }; _0x10530c[_0x2f008e(0x4bc)]['push'](_0x2cc0b0), _0x3e6d3a(), await _0x398205(), _0x3a6c86('“' + _0x5cbdc7[_0x2f008e(0x6b7)] + _0x2f008e(0x1e6)); } catch (_0x13caaf) { if (_0x2f008e(0xa64) === 'knIJH') { const _0x320555 = _0x5045f7['friendCircles'][_0x2f008e(0x212)](_0x5ba8a9 => _0x5ba8a9['id'] === _0x25eb89[_0x2f008e(0x301)]), _0x4e1461 = _0x320555?.['boundUserProfileId']; let _0x17ea2b = _0x37667d[_0x2f008e(0x360)][_0x2f008e(0x212)](_0x43b408 => _0x43b408['id'] === _0x4e1461); !_0x17ea2b && (_0x17ea2b = _0x400917[_0x2f008e(0x360)][_0x2f008e(0x212)](_0x2588d9 => _0x2588d9['id'] === _0x5bd48f['activeUserProfileId'])), !_0x17ea2b && (_0x17ea2b = _0x33c4de['userProfiles'][0x0]), _0x17ea2b && (_0x4020fa[_0x2f008e(0x248)](_0x2f008e(0x5c5))[_0x2f008e(0x70a)] = _0x17ea2b[_0x2f008e(0x917)] || _0x44f672); } else console[_0x2f008e(0x729)](_0x2f008e(0x6ef), _0x13caaf), _0x3a6c86(_0x2f008e(0x1f4) + _0x13caaf[_0x2f008e(0x380)]); } finally { _0xbc2d1c(![]), _0x1508db['target'][_0x2f008e(0xe5)] = ''; } }, _0x583944[_0x12f12a(0x379)](_0x332c59); } async function _0x3f423c() { const _0x9672cb = _0x1da6ac, _0x458db7 = _0x2a5745['value'], _0x139c71 = document[_0x9672cb(0x248)](_0x9672cb(0x3a3))['value'], _0x1b417a = _0x14d098[_0x9672cb(0x5fc)][0x0], _0x1001d5 = _0x39cf3b['files'][0x0], _0x9d91ef = _0x55821a[_0x9672cb(0x5fc)][0x0], _0xce0ec1 = document['querySelectorAll'](_0x9672cb(0x7f7)), _0x5b4933 = Array[_0x9672cb(0x10f)](_0xce0ec1)[_0x9672cb(0xa21)](_0x34ddaa => _0x34ddaa['value']), _0x37db5c = { 'name': _0x332541[_0x9672cb(0xe5)]['trim'](), 'remark': _0xb2b4f1[_0x9672cb(0xe5)]['trim'](), 'persona': _0x53ea16[_0x9672cb(0xe5)]['trim'](), 'linkedWorldBookIds': _0x5b4933, 'bubbleCss': document[_0x9672cb(0x248)]('char-edit-css')[_0x9672cb(0xe5)][_0x9672cb(0x3ee)](), 'avatarFrameUrl': document['getElementById'](_0x9672cb(0x28a))[_0x9672cb(0xe5)][_0x9672cb(0x3ee)](), 'userAvatarFrameUrl': document[_0x9672cb(0x248)]('user-avatar-frame-url-in-chat')['value']['trim']() }; if (!_0x37db5c[_0x9672cb(0x6b7)]) { _0x3a6c86(_0x9672cb(0x7d6)); return; } try { if (_0x9672cb(0x30b) === _0x9672cb(0x5ab)) _0x42e16a(_0x9672cb(0x8fc)); else { const _0x28d552 = [_0x9672cb(0x47b), _0x9672cb(0x6bb), 'angry', _0x9672cb(0x6a3), _0x9672cb(0x1b7)]; let _0x9be7e0 = _0x458db7; if (_0x458db7) { if ('RqskQ' !== _0x9672cb(0x627)) { const _0x5aa81c = _0x10530c['characters'][_0x9672cb(0x212)](_0x295e04 => _0x295e04['id'] === _0x458db7); _0x5aa81c && Object[_0x9672cb(0x895)](_0x5aa81c, _0x37db5c); } else return _0x53641e[_0x9672cb(0x729)]('AI\x20试图创建事件，但找不到有效的用户ID。'), null; } else { const _0x5cddac = _0x9672cb(0xa9e) + Date['now'](); _0x9be7e0 = _0x5cddac; const _0x36bf1f = { 'id': _0x5cddac, ..._0x37db5c }; _0x36bf1f[_0x9672cb(0x917)] = _0x1b417a ? await _0x1f8d37(_0x1b417a) : _0x5da029, _0x10530c['characters'][_0x9672cb(0x36b)](_0x36bf1f); const _0x5dbfd5 = { 'id': _0x9672cb(0x5ff) + _0x5cddac, 'type': _0x9672cb(0x71a), 'participantIds': [_0x5cddac], 'listenTogetherSession': null }; _0x10530c[_0x9672cb(0x4bc)][_0x9672cb(0x36b)](_0x5dbfd5); } const _0x5eaabc = _0x10530c['chats'][_0x9672cb(0x212)](_0x1964a1 => _0x1964a1[_0x9672cb(0xa78)] === 'private' && _0x1964a1[_0x9672cb(0x26f)][_0x9672cb(0xa83)](_0x9be7e0)); _0x5eaabc && (_0x5eaabc[_0x9672cb(0x2eb)] = _0x139c71); if (_0x1b417a) await _0x5ef29b(_0x9672cb(0x583) + _0x9be7e0, _0x1b417a); if (_0x1001d5) await _0x5ef29b(_0x9672cb(0x72e) + _0x9be7e0, _0x1001d5); if (_0x9d91ef) await _0x5ef29b(_0x9672cb(0x727) + _0x9be7e0, _0x9d91ef); for (const _0x570e8f of _0x28d552) { const _0xfa1ac2 = document[_0x9672cb(0x248)](_0x9672cb(0x426) + _0x570e8f + _0x9672cb(0x7f5))[_0x9672cb(0x5fc)][0x0]; if (_0xfa1ac2) await _0x5ef29b(_0x9672cb(0x7c2) + _0x570e8f + '_' + _0x9be7e0, _0xfa1ac2); } _0x3e6d3a(), _0x398205(), _0x3a6c86('角色已保存！'), _0x1c4afc('chat', _0x9672cb(0xd7)); if (!_0x458db7) { if (_0x9672cb(0x942) === _0x9672cb(0x256)) _0x331f39 = _0x5c7913; else { const _0xea837e = 'chat_' + _0x9be7e0; _0x1bdd79(_0xea837e), _0x2b7059(!![]); } } } } catch (_0x373760) { console[_0x9672cb(0x729)](_0x9672cb(0x563), _0x373760), _0x3a6c86('保存失败:\x20' + _0x373760['message']); } } function _0x313322() { const _0x1bd110 = _0x1da6ac; _0x295a57[_0x1bd110(0xe5)] = '', _0x1458b5[_0x1bd110(0x9a1)] = ''; if (_0x10530c[_0x1bd110(0x620)][_0x1bd110(0x848)] < 0x2) { _0x3a6c86(_0x1bd110(0x554)); return; } _0x10530c[_0x1bd110(0x620)]['forEach'](_0x219a96 => { const _0x3177cf = _0x1bd110, _0x50725e = document['createElement']('li'); _0x50725e[_0x3177cf(0x296)] = _0x3177cf(0x903), _0x50725e['innerHTML'] = _0x3177cf(0x50b) + _0x219a96['id'] + '\x22\x20data-id=\x22' + _0x219a96['id'] + _0x3177cf(0x92f) + (_0x219a96[_0x3177cf(0x917)] || _0x5da029) + _0x3177cf(0x474) + _0x219a96['id'] + _0x3177cf(0x1ce) + _0x219a96[_0x3177cf(0x6b7)] + _0x3177cf(0x3aa), _0x1458b5[_0x3177cf(0x6ab)](_0x50725e); }), _0x1c4afc('groupChatCreate', _0x1bd110(0x604)); } function _0x438d36() { const _0xe490bf = _0x1da6ac, _0x4da2f1 = _0x295a57[_0xe490bf(0xe5)]['trim'](); if (!_0x4da2f1) { if (_0xe490bf(0x897) !== _0xe490bf(0x897)) _0x5e5633['textContent'] = '▶'; else { _0x3a6c86(_0xe490bf(0x658)); return; } } const _0x112c45 = Array['from'](_0x1458b5[_0xe490bf(0x20d)](_0xe490bf(0x3e1)))[_0xe490bf(0xa21)](_0x5aff37 => _0x5aff37[_0xe490bf(0xab1)]['id']); if (_0x112c45[_0xe490bf(0x848)] < 0x2) { _0x3a6c86(_0xe490bf(0x666)); return; } const _0xc24d1e = { 'id': _0xe490bf(0xa50) + Date[_0xe490bf(0x7a8)](), 'type': 'group', 'name': _0x4da2f1, 'participantIds': _0x112c45 }; _0x10530c[_0xe490bf(0x4bc)][_0xe490bf(0x36b)](_0xc24d1e), _0x10530c['activeChatId'] = _0xc24d1e['id'], _0x3e6d3a(), _0x398205(), _0x59b7f0(), _0x20c635(), _0x3a6c86(_0xe490bf(0xd3) + _0x4da2f1 + '”已创建！'), _0x1c4afc(_0xe490bf(0x78c), 'groupChatCreate'); } _0x218289['addEventListener'](_0x1da6ac(0x4b3), () => _0xa5e933[_0x1da6ac(0x4b3)]()), _0x4fcde1['addEventListener'](_0x1da6ac(0x4b3), _0x5616ca), _0xa5e933['addEventListener'](_0x1da6ac(0x423), _0x3a9614), _0x6f803f[_0x1da6ac(0x578)]('click', _0x37cbb6), _0x3ffed1[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => _0x135f67['classList'][_0x1da6ac(0xae0)](_0x1da6ac(0x11b))), _0x551337[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => _0x135f67[_0x1da6ac(0x882)][_0x1da6ac(0xae0)]('show')), _0x3a0779[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x1c602a = _0x1da6ac; _0x2131ed['select'](), navigator[_0x1c602a(0x5f0)]['writeText'](_0x2131ed['value'])[_0x1c602a(0x45f)](() => { const _0x1ff943 = _0x1c602a; if (_0x1ff943(0x3a5) === 'PzqXf') { const _0x1a8a46 = _0x383910[_0x1ff943(0x915)]('musicPlayerState'); if (_0x1a8a46) { const { playlist: _0x395e50, currentIndex: _0x5966f4 } = _0x505145['parse'](_0x1a8a46); _0x1ec1df[_0x1ff943(0x796)](_0x395e50) && _0x395e50[_0x1ff943(0x848)] > 0x0 && _0x5966f4 > -0x1 && (_0x534530[_0x1ff943(0x30c)] = _0x395e50, _0x56bc57[_0x1ff943(0x79f)] = _0x5966f4, _0x536d22[_0x1ff943(0x73c)] = ![], _0xfa7940()); } } else _0x3a6c86('已复制到剪贴板！'); })['catch'](_0x3f861c => { const _0x54aa5a = _0x1c602a; _0x3a6c86(_0x54aa5a(0x9a4)); }); }), _0xa72511['addEventListener']('click', _0x477719), _0x414605['addEventListener'](_0x1da6ac(0x4b3), _0x15981b), _0x33262b[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => _0x5af63d['classList']['remove']('show')), _0x4df863[_0x1da6ac(0x578)]('click', () => _0x5af63d[_0x1da6ac(0x882)]['remove']('show')), _0xcbeb2d['addEventListener']('click', () => _0x39cf3b['click']()), _0x4bafaa[_0x1da6ac(0x578)]('click', () => _0x55821a['click']()), _0x39cf3b[_0x1da6ac(0x578)](_0x1da6ac(0x423), _0x447507 => { const _0x52250d = _0x1da6ac; if (_0x52250d(0x60a) !== _0x52250d(0x60a)) _0xf89887 = _0x2dac35[_0x52250d(0x22e)](_0x5667b8), _0x4d8f41['log'](_0x52250d(0x2df)); else { const _0x2cac63 = _0x447507['target'][_0x52250d(0x5fc)][0x0]; if (!_0x2cac63) return; const _0xb664b9 = URL[_0x52250d(0x73d)](_0x2cac63); _0xcbeb2d[_0x52250d(0x10d)][_0x52250d(0xad9)] = _0x52250d(0x7a2) + _0xb664b9 + '\x27)'; } }), _0x55821a[_0x1da6ac(0x578)](_0x1da6ac(0x423), _0x23f442 => { const _0x5a3f67 = _0x1da6ac, _0x5b1b22 = _0x23f442['target'][_0x5a3f67(0x5fc)][0x0]; if (!_0x5b1b22) return; const _0x261da2 = URL[_0x5a3f67(0x73d)](_0x5b1b22); _0x4bafaa['style'][_0x5a3f67(0xad9)] = _0x5a3f67(0x7a2) + _0x261da2 + '\x27)'; }), _0x135f87[_0x1da6ac(0x578)]('click', () => _0x56c5f5[_0x1da6ac(0x4b3)]()), _0x14368d[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x3fb313 = _0x1da6ac; localStorage[_0x3fb313(0x89a)]('customFeedWallpaper'), _0x156d93(), _0x3a6c86('动态页背景已移除。'); }), _0x56c5f5[_0x1da6ac(0x578)](_0x1da6ac(0x423), async _0x2c2b8b => { const _0x5af7ee = _0x1da6ac, _0x45a277 = _0x2c2b8b[_0x5af7ee(0x6c4)][_0x5af7ee(0x5fc)][0x0]; if (!_0x45a277) return; try { const _0x1d9321 = await _0x1f8d37(_0x45a277); localStorage[_0x5af7ee(0x9e0)](_0x5af7ee(0x7b4), _0x1d9321), _0x156d93(), _0x3a6c86(_0x5af7ee(0x964)); } catch (_0x2a5844) { if (_0x5af7ee(0x35e) !== _0x5af7ee(0x35e)) throw new _0x27b16f(_0x5af7ee(0x708)); else _0x3a6c86(_0x5af7ee(0x247) + _0x2a5844['message']); } }), document['getElementById'](_0x1da6ac(0x295))[_0x1da6ac(0x578)]('click', () => _0x1c4afc('chat', 'groupSettings')), document[_0x1da6ac(0x248)](_0x1da6ac(0x202))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x278d9d); const _0x1bd983 = document[_0x1da6ac(0x248)](_0x1da6ac(0x1cd)), _0xf08344 = document[_0x1da6ac(0x248)](_0x1da6ac(0x10e)); _0x1bd983[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => _0xf08344[_0x1da6ac(0x4b3)]()), _0xf08344[_0x1da6ac(0x578)](_0x1da6ac(0x423), _0x33466d => { const _0x4120d1 = _0x1da6ac; if (_0x4120d1(0x3b3) !== _0x4120d1(0x30a)) { const _0x24fe4 = _0x33466d['target'][_0x4120d1(0x5fc)][0x0]; if (!_0x24fe4) return; const _0x54c3ee = URL['createObjectURL'](_0x24fe4); _0x1bd983['src'] = _0x54c3ee, _0x1bd983[_0x4120d1(0x744)] = () => { const _0x48c297 = _0x4120d1; 'dLgYT' !== _0x48c297(0x8fe) ? URL[_0x48c297(0x8df)](_0x54c3ee) : _0xed01d3[_0x48c297(0x10d)]['backgroundImage'] = _0x48c297(0x7a2) + _0x2cdf7d + '\x27)'; }; } else _0x488fbd(), _0x385191('userProfileList', 'userProfile'); }); const _0x31810c = document[_0x1da6ac(0x248)](_0x1da6ac(0x2d0))[_0x1da6ac(0x50d)], _0x460a56 = document[_0x1da6ac(0x248)](_0x1da6ac(0x17d)), _0x37fc68 = document[_0x1da6ac(0x248)]('group-bg-preview'); _0x31810c[_0x1da6ac(0x578)]('click', () => _0x460a56[_0x1da6ac(0x4b3)]()), _0x460a56['addEventListener'](_0x1da6ac(0x423), _0x28dd26 => { const _0x505611 = _0x1da6ac; if (_0x505611(0x60c) !== _0x505611(0x466)) { const _0x27cdad = _0x28dd26[_0x505611(0x6c4)][_0x505611(0x5fc)][0x0]; if (!_0x27cdad) return; const _0x484ad9 = URL[_0x505611(0x73d)](_0x27cdad); document[_0x505611(0x248)](_0x505611(0x2d0))[_0x505611(0x10d)][_0x505611(0xad9)] = _0x505611(0x7a2) + _0x484ad9 + '\x27)'; } else _0x49a0cd(_0x505611(0x6bf) + _0x94c495[_0x505611(0x380)]); }); const _0x33d131 = document['querySelector'](_0x1da6ac(0x5ba)), _0x2a08c2 = document['getElementById']('group-world-book-checkboxes'); _0x33d131['addEventListener']('click', _0x6ce4d1 => { const _0x2083bc = _0x1da6ac; _0x2083bc(0x9ca) !== _0x2083bc(0x1dd) ? (_0x6ce4d1[_0x2083bc(0x387)](), _0x2a08c2[_0x2083bc(0x882)][_0x2083bc(0x4da)](_0x2083bc(0x907)), _0x33d131['classList']['toggle'](_0x2083bc(0x185))) : (_0x279594(), _0x5f0811('calendar', 'home')); }), _0x2a08c2['addEventListener']('change', _0x260e1a), document[_0x1da6ac(0x248)](_0x1da6ac(0x25d))['addEventListener'](_0x1da6ac(0x4b3), _0x279435), document[_0x1da6ac(0x248)](_0x1da6ac(0x1fb))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), async () => { const _0x2e009d = _0x1da6ac; if (_0x2e009d(0x41c) === _0x2e009d(0x65b)) _0x6cd5b1[_0x2e009d(0x729)](_0x2e009d(0x3d7), _0x10f4cf); else { const _0x47c5a9 = _0x27b19d(); if (!_0x47c5a9 || _0x47c5a9[_0x2e009d(0xa78)] !== _0x2e009d(0x732)) return; const _0x132474 = await _0x52e7d6(_0x2e009d(0x7ad) + _0x47c5a9[_0x2e009d(0x6b7)] + _0x2e009d(0x821)); _0x132474 && (_0x4d3eff(_0x47c5a9['id']), _0x3a6c86(_0x2e009d(0xa98)), _0x1c4afc(_0x2e009d(0x78c)), _0x2b7059(![])); } }); const _0x4176cf = document[_0x1da6ac(0x838)](_0x1da6ac(0xa67)), _0x209372 = document[_0x1da6ac(0x248)](_0x1da6ac(0x9ce)); _0x4176cf['addEventListener'](_0x1da6ac(0x4b3), _0xd13f91 => { const _0x2f5b76 = _0x1da6ac; _0xd13f91[_0x2f5b76(0x387)](), _0x209372['classList'][_0x2f5b76(0x4da)]('visible'), _0x4176cf[_0x2f5b76(0x882)][_0x2f5b76(0x4da)](_0x2f5b76(0x185)); }), _0x209372[_0x1da6ac(0x578)]('change', _0x294c66), document['addEventListener'](_0x1da6ac(0x4b3), _0x4b317e => { const _0xf868f5 = _0x1da6ac; if (!document[_0xf868f5(0x838)](_0xf868f5(0x14a))[_0xf868f5(0x956)](_0x4b317e[_0xf868f5(0x6c4)])) { if (_0xf868f5(0xaa3) === _0xf868f5(0x599)) { const _0x1c71e4 = _0x116ff4['userProfiles'][_0xf868f5(0x212)](_0x23fbc1 => _0x23fbc1['id'] === _0x241dcb[_0xf868f5(0x2eb)]) || { 'name': _0xf868f5(0x266) }, _0x458c72 = _0x1369db[_0xf868f5(0x3b9)](_0xf868f5(0x6ff)); _0x458c72['className'] = _0xf868f5(0x6be), _0x458c72['dataset']['id'] = _0x24f694['id'], _0x458c72[_0xf868f5(0x9a1)] = _0xf868f5(0x4ad) + _0x53b6dd[_0xf868f5(0x6b7)] + _0xf868f5(0x149) + _0x1c71e4[_0xf868f5(0x6b7)] + _0xf868f5(0x2a8) + _0x778b27['memberCharacterIds']['length'] + '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', _0x458c72[_0xf868f5(0x578)]('click', () => _0x1426ef(_0x3fd8c0['id'])), _0x250f95[_0xf868f5(0x6ab)](_0x458c72); } else _0x209372[_0xf868f5(0x882)]['remove'](_0xf868f5(0x907)), _0x4176cf['classList']['remove'](_0xf868f5(0x185)); } }), _0x47e51b['addEventListener'](_0x1da6ac(0x4b3), () => { const _0x4138a0 = _0x1da6ac; _0x175c5c(), _0x1c4afc(_0x4138a0(0x342), _0x4138a0(0x362)); }), document[_0x1da6ac(0x248)](_0x1da6ac(0x8f0))['addEventListener'](_0x1da6ac(0x4b3), () => _0x1c4afc(_0x1da6ac(0x362), 'worldBook')), document[_0x1da6ac(0x248)](_0x1da6ac(0x509))[_0x1da6ac(0x578)]('click', () => _0x11681c()), document[_0x1da6ac(0x248)]('back-to-world-book-list')[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x29b8ba = _0x1da6ac; _0x175c5c(), _0x1c4afc(_0x29b8ba(0x342), 'worldBookEditor'); }), document[_0x1da6ac(0x248)](_0x1da6ac(0xae7))['addEventListener'](_0x1da6ac(0x4b3), _0x58630e), document['getElementById'](_0x1da6ac(0x366))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x8a73de), _0x31066f[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => _0x1c4afc(_0x1da6ac(0x9b3), 'home')), _0x467c7e[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => _0x1c4afc('home', _0x1da6ac(0x9b3))), _0x40f915[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => _0x3b49e5[_0x1da6ac(0x4b3)]()), _0x3b49e5['addEventListener'](_0x1da6ac(0x423), async _0x229bcf => { const _0xc3046c = _0x1da6ac; if (_0xc3046c(0x3c5) !== 'yPYBt') { const _0x5c8512 = _0x229bcf[_0xc3046c(0x6c4)][_0xc3046c(0x5fc)][0x0]; if (!_0x5c8512) return; await _0x51d545(_0x5c8512); } else { const _0x575fff = _0x2d142b[_0xc3046c(0x4be)] === 'character' ? '你' : _0x12e33b['contact_name']; _0x1116f8 += _0xc3046c(0x2fc) + _0x575fff + ':\x20' + _0x3f9226[_0xc3046c(0x9a8)] + '\x0a'; } }), _0x3f507d[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x239691 = _0x1da6ac; 'yXbQX' === 'STsuL' ? _0x188a43['click']() : (_0x398205(), _0x1c4afc(_0x239691(0x78c), _0x239691(0x362))); }), _0x30e9b5[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x42f2ce = _0x1da6ac; _0x551015(); const _0x5a3de1 = (_0x10530c[_0x42f2ce(0x899)]['endpoint'] || '')[_0x42f2ce(0xa83)](_0x124f1f); _0x3f753a[_0x42f2ce(0xf6)] = _0x5a3de1, _0x1c4afc(_0x42f2ce(0xa2f), _0x42f2ce(0x362)); }), _0x82f65a[_0x1da6ac(0x578)]('click', () => _0x1c4afc(_0x1da6ac(0x362), _0x1da6ac(0xa2f))), _0x1f1e54['addEventListener'](_0x1da6ac(0x4b3), () => { const _0x340329 = _0x1da6ac; if ('PiLEn' !== 'UTbfI') _0x39ae19(), _0x1c4afc(_0x340329(0x362), _0x340329(0x78c)); else { if (_0x5eb363[_0x340329(0x34a)] === _0x340329(0x27a) && _0x42ac03['image']) return { 'role': 'user', 'content': [{ 'type': _0x340329(0x958), 'text': _0x1372b6[_0x340329(0x9a8)] || '\x20' }, { 'type': 'image_url', 'image_url': { 'url': _0xdf160a[_0x340329(0x1a2)], 'detail': _0x340329(0x9c9) } }] }; return { 'role': _0x58555a['role'], 'content': _0x19a64b[_0x340329(0x9a8)] }; } }), _0x2bc08e['addEventListener'](_0x1da6ac(0x4b3), () => { const _0x12ab60 = _0x1da6ac; _0x12ab60(0x6a5) === 'oatrY' ? (_0x39ae19(), _0x2b7059(![])) : _0x2a2c44(); }), _0x44f477[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x58eed7 = _0x1da6ac; _0x1c4afc(_0x58eed7(0x78c), _0x58eed7(0xd7)); }), _0x2c3eb5['addEventListener'](_0x1da6ac(0x4b3), () => { const _0x50eeb3 = _0x1da6ac; _0x12ec2a[_0x50eeb3(0x882)][_0x50eeb3(0x7c3)](_0x50eeb3(0x11b)); }), _0x482da7[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => _0x18bc5f()), _0x5498b8[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x3990cb); function _0x31f4eb(_0x176fcd) { const _0x299698 = _0x1da6ac; if (_0x299698(0xa14) === _0x299698(0xa14)) { if (!_0x176fcd || _0x176fcd[_0x299698(0xa78)] !== _0x299698(0x732)) return; const _0x5aac77 = _0x299698(0x4e6); document['body'][_0x299698(0xa2c)](_0x299698(0x1bf), _0x5aac77); const _0x454f8c = document[_0x299698(0x248)]('group-options-modal'), _0x2d2441 = _0x454f8c[_0x299698(0x838)](_0x299698(0x279)), _0x17b1fe = document[_0x299698(0x248)](_0x299698(0x6a7)), _0x167eb0 = document[_0x299698(0x248)](_0x299698(0x91e)), _0x3e2949 = document[_0x299698(0x248)](_0x299698(0x8c9)), _0x38a0e9 = document[_0x299698(0x248)](_0x299698(0xa54)), _0x43dce3 = document[_0x299698(0x248)](_0x299698(0x731)), _0x3d7099 = () => _0x454f8c[_0x299698(0xae0)](); _0x17b1fe[_0x299698(0x578)]('click', async () => { const _0x1ec37f = _0x299698; if ('ycQiT' === 'tnHFu') { const _0x53a53b = _0x1109ce['content'] ? '\x20' + _0x591694[_0x1ec37f(0x9a8)] : ''; _0x473755[_0x1ec37f(0x36b)]('[' + _0x5368f2(_0x23d846) + _0x1ec37f(0x783) + _0x53a53b); } else { _0x3d7099(); const _0x37adbd = await _0x52e7d6('确定要清空群聊\x22' + _0x176fcd[_0x1ec37f(0x6b7)] + _0x1ec37f(0xa1b)); if (_0x37adbd) { if (_0x1ec37f(0x57c) === _0x1ec37f(0xd2)) { _0x211693(_0x1ec37f(0x27d)); return; } else { _0x176fcd['id'] === _0x10530c[_0x1ec37f(0x16e)] && (_0x39ae19(), _0x10530c[_0x1ec37f(0x675)] = [], _0x1a245d()); try { localStorage[_0x1ec37f(0x89a)](_0x1ec37f(0x13c) + _0x176fcd['id']), _0x3a6c86(_0x1ec37f(0x7a9) + _0x176fcd['name'] + _0x1ec37f(0x864)); } catch (_0x5ead03) { console[_0x1ec37f(0x729)](_0x1ec37f(0x5d5) + _0x176fcd['id'], _0x5ead03), _0x3a6c86(_0x1ec37f(0x81c)); } } } } }), _0x167eb0[_0x299698(0x578)](_0x299698(0x4b3), () => { const _0x18e9b0 = _0x299698; _0x3d7099(), _0x3a6c86(_0x18e9b0(0xa6a)); }), _0x3e2949[_0x299698(0x578)]('click', async () => { const _0x11df6e = _0x299698; _0x3d7099(); const _0x3a2448 = prompt(_0x11df6e(0x235), _0x176fcd[_0x11df6e(0x6b7)]); _0x3a2448 && _0x3a2448[_0x11df6e(0x3ee)]() && _0x3a2448 !== _0x176fcd[_0x11df6e(0x6b7)] && (_0x11df6e(0x416) !== _0x11df6e(0x416) ? (_0x3df3cc['style'][_0x11df6e(0xad9)] = _0x11df6e(0x7a2) + _0x2b54b3[_0x11df6e(0x73d)](_0x111737) + '\x27)', _0x23d4a8[_0x11df6e(0x10d)][_0x11df6e(0xc2)] = _0x11df6e(0x55a), _0x44de97[_0x11df6e(0x10d)]['backgroundPosition'] = _0x11df6e(0x1ff)) : (_0x176fcd['name'] = _0x3a2448[_0x11df6e(0x3ee)](), _0x3e6d3a(), _0x398205(), _0x59b7f0(), _0x3a6c86('群名称已更改为\x22' + _0x176fcd['name'] + '\x22。'))); }), _0x38a0e9[_0x299698(0x578)](_0x299698(0x4b3), async () => { const _0x32f4b4 = _0x299698; _0x3d7099(); const _0xaeb745 = await _0x52e7d6(_0x32f4b4(0x8d5) + _0x176fcd[_0x32f4b4(0x6b7)] + _0x32f4b4(0x4ae)); _0xaeb745 && (_0x4d3eff(_0x176fcd['id']), _0x3a6c86(_0x32f4b4(0x7a9) + _0x176fcd[_0x32f4b4(0x6b7)] + _0x32f4b4(0x946)), _0x2b7059(![])); }), _0x2d2441['addEventListener'](_0x299698(0x4b3), _0x3d7099), _0x43dce3['addEventListener'](_0x299698(0x4b3), _0x3d7099); } else { _0x4a0fde['innerHTML'] = _0x299698(0x456), _0x5b0021['innerHTML'] = ''; return; } } _0x313dd4[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x5ed1d2 = _0x1da6ac, _0x5515db = _0x27b19d(); if (_0x5515db && _0x5515db[_0x5ed1d2(0xa78)] === _0x5ed1d2(0x71a)) _0xfec8c0(_0x5515db[_0x5ed1d2(0x26f)][0x0]); else { if (_0x5515db && _0x5515db['type'] === 'group') { if (_0x5ed1d2(0x5ca) === _0x5ed1d2(0x4c4)) { if (_0x5866fc[_0x5ed1d2(0x6c4)][_0x5ed1d2(0x882)]['contains'](_0x5ed1d2(0x531))) { const _0x198354 = _0x14ea91['target'][_0x5ed1d2(0xab1)]['id']; _0x33f6b0('确定要删除这笔记录吗？')[_0x5ed1d2(0x45f)](_0x343f69 => { _0x343f69 && _0x4b2ab3(_0x198354); }); } } else _0x15ffcd(_0x5515db['id']); } } }), _0x240b04['addEventListener'](_0x1da6ac(0x44b), _0x3b3330 => { const _0x27e97f = _0x1da6ac; if (_0x3b3330[_0x27e97f(0x797)] === _0x27e97f(0x18b) && !_0x3b3330[_0x27e97f(0x628)]) { if (_0x27e97f(0xa8e) !== _0x27e97f(0x189)) _0x3b3330[_0x27e97f(0x148)](), _0x18bc5f(); else { const _0x42be3e = _0x1991c5[_0x27e97f(0x4bc)][_0x27e97f(0x212)](_0x2a8172 => _0x2a8172['id'] === _0xbe2a4); if (!_0x42be3e || _0x42be3e[_0x27e97f(0xa78)] !== _0x27e97f(0x732)) return; _0x23c5b8[_0x27e97f(0x248)]('group-settings-name')[_0x27e97f(0xe5)] = _0x42be3e[_0x27e97f(0x6b7)] || '', _0x1f4bf5(_0x27e97f(0x4eb)), _0xe39d65[_0x27e97f(0x248)](_0x27e97f(0x4eb))[_0x27e97f(0xe5)] = _0x42be3e[_0x27e97f(0x2eb)] || _0x2fcecd[_0x27e97f(0x663)]; const _0x18e2b5 = _0x492a08[_0x27e97f(0x248)](_0x27e97f(0x35d)); _0x18e2b5[_0x27e97f(0x9a1)] = '', _0x396c4f[_0x27e97f(0x79a)][_0x27e97f(0x986)](_0x30cd59 => { const _0x12f314 = _0x27e97f, _0x4e4196 = _0x42be3e[_0x12f314(0x7e0)]?.[_0x12f314(0xa83)](_0x30cd59['id']), _0x2b9444 = _0xb4fe6e['createElement'](_0x12f314(0x737)); _0x2b9444[_0x12f314(0x9a1)] = _0x12f314(0xcc) + _0x30cd59['id'] + '\x22\x20' + (_0x4e4196 ? _0x12f314(0x38c) : '') + '>\x20' + _0x30cd59[_0x12f314(0x6b7)], _0x18e2b5['appendChild'](_0x2b9444); }), _0x5418fc(); const _0x53b647 = _0x531851[_0x27e97f(0x248)](_0x27e97f(0x1cd)), _0x39baf3 = _0x32fd1e[_0x27e97f(0x248)](_0x27e97f(0x2d0)); _0x39baf3['style'][_0x27e97f(0xad9)] = '', _0x48ff29(_0x27e97f(0x207) + _0xa73c68)[_0x27e97f(0x45f)](_0x3e72ab => { const _0x5729c1 = _0x27e97f; _0x53b647[_0x5729c1(0x70a)] = _0x3e72ab ? _0x234b8a[_0x5729c1(0x73d)](_0x3e72ab) : _0x5517f6; }), _0x57293c(_0x27e97f(0x1cc) + _0x2611e2)['then'](_0x2e1a65 => { const _0x5403b2 = _0x27e97f; if (_0x2e1a65) _0x39baf3['style']['backgroundImage'] = _0x5403b2(0x7a2) + _0x350c5b['createObjectURL'](_0x2e1a65) + '\x27)'; }), _0x47c952(_0x27e97f(0x4f8), 'chat'); } } }); const _0x5aa576 = () => _0x12ec2a[_0x1da6ac(0x882)]['remove'](_0x1da6ac(0x11b)); _0x3a4953[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x5aa576), _0x53a48e[_0x1da6ac(0x578)]('click', _0x5aa576), _0x188f3a['addEventListener'](_0x1da6ac(0x4b3), () => { _0x5aa576(), _0xfec8c0(); }), _0x52530b[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { _0x5aa576(), _0x313322(); }), _0x1b8bdb[_0x1da6ac(0x578)]('click', () => { const _0x432101 = _0x1da6ac; _0x1c4afc(_0x432101(0x78c), _0x432101(0x345)), _0x2b7059(![]); }), _0x196515[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x438d36), _0x402a08['addEventListener'](_0x1da6ac(0x4b3), () => { const _0x16ae37 = _0x1da6ac; _0x474876[_0x16ae37(0x882)][_0x16ae37(0x4da)](_0x16ae37(0x11b)), _0x474876[_0x16ae37(0x882)]['contains'](_0x16ae37(0x11b)) && (_0x16ae37(0x50c) === _0x16ae37(0x40c) ? !_0x2a2ada[_0x16ae37(0x838)](_0x16ae37(0x14a))['contains'](_0x72c2be[_0x16ae37(0x6c4)]) && (_0xdb0810['classList'][_0x16ae37(0xae0)](_0x16ae37(0x907)), _0x3b3c40['classList'][_0x16ae37(0xae0)]('expanded')) : _0xa6230[_0x16ae37(0x40d)] = _0xa6230[_0x16ae37(0x5ce)]); }), _0x87aec6['addEventListener'](_0x1da6ac(0x4b3), () => _0x5e5d19[_0x1da6ac(0x4b3)]()); const _0xe7ab96 = document[_0x1da6ac(0x248)](_0x1da6ac(0x3f7)); _0x5e5d19[_0x1da6ac(0x578)]('change', _0x787342), _0xe7ab96[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x4962ef), _0x456e10[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x232bfa), _0x4a398a[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x1dbb60), _0x1feb40[_0x1da6ac(0x578)]('click', _0x3f423c), _0x3f4d3e[_0x1da6ac(0x578)]('click', _0x279435), _0x56c619[_0x1da6ac(0x578)]('click', async () => { const _0x168255 = _0x1da6ac; if (_0x168255(0x56f) === _0x168255(0x7f1)) { const _0x56db9a = _0x288911[_0x168255(0xe8)] === _0x168255(0x27a) ? _0x168255(0x27a) : 'ai', _0x283780 = _0x445172[_0x168255(0xe8)] === _0x168255(0x27a) ? _0x39245c['name'] : _0x2322a7(_0x1f253f[_0x168255(0xe8)])[_0x168255(0x6b7)], _0x900065 = _0x23891a['createElement']('div'); _0x900065[_0x168255(0x296)] = 'diary-entry\x20' + _0x56db9a, _0x900065[_0x168255(0xab1)][_0x168255(0x908)] = _0x53ed34[_0x168255(0x908)], _0x900065[_0x168255(0x10d)][_0x168255(0x9ef)] = 'none', _0x900065[_0x168255(0x10d)][_0x168255(0x808)] = '0', _0x900065[_0x168255(0x9a1)] = _0x168255(0x24f) + _0x283780 + _0x168255(0x669) + new _0x26b7b0(_0x17e2e4['timestamp'])[_0x168255(0x446)](_0x168255(0x89f)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>' + _0x51a301['content'][_0x168255(0x7cf)](/\n/g, _0x168255(0x227)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x2b6f49['appendChild'](_0x900065); } else { const _0x474761 = _0x2a5745[_0x168255(0xe5)]; if (!_0x474761) return; const _0x5e98e1 = _0x5b19fc(_0x474761); if (!_0x5e98e1) return; const _0x12c936 = await _0x52e7d6(_0x168255(0x271) + _0x5e98e1[_0x168255(0x6b7)] + _0x168255(0x70f)); if (_0x12c936) { if (_0x168255(0x4f6) !== 'Bbplh') _0xc0ecab(_0x474761), _0x3a6c86(_0x168255(0x8a4) + _0x5e98e1[_0x168255(0x6b7)] + _0x168255(0x3b4)), _0x1c4afc('chat', _0x168255(0xd7)), _0x2b7059(![]); else { if (_0x4967ab) _0x1de95e[_0x168255(0x10d)][_0x168255(0xad9)] = _0x168255(0x7a2) + _0x1a4ff9['createObjectURL'](_0x1d4751) + '\x27)'; } } } }), _0x5a1671[_0x1da6ac(0x578)](_0x1da6ac(0x58e), () => { const _0x5d841a = _0x1da6ac; if (_0x5d841a(0x85f) === _0x5d841a(0x3b2)) _0x4e5e88 += _0x35f3e4['parse'](_0x17e469)['candidates'][0x0]['content'][_0x5d841a(0x6b4)][0x0]['text']; else { const _0x1031b7 = _0x5a1671[_0x5d841a(0xe5)][_0x5d841a(0x3ee)]()['includes'](_0x124f1f); _0x3f753a['disabled'] = _0x1031b7; } }); async function _0x392d21() { const _0x1cfeda = _0x1da6ac, _0x432194 = _0x5a1671[_0x1cfeda(0xe5)][_0x1cfeda(0x3ee)](), _0x492859 = _0x38afae[_0x1cfeda(0xe5)][_0x1cfeda(0x3ee)](); if (!_0x432194 || !_0x492859) { if ('kPwDq' !== _0x1cfeda(0x211)) { const _0xcddfa3 = _0x27176e[0x0]['trim'](), _0x513c26 = _0x1d3323[0x1][_0x1cfeda(0x3ee)]()['replace'](/^"|"$/g, ''); _0x4b92a3[_0xcddfa3] = _0x513c26; } else { _0x3a6c86(_0x1cfeda(0x28f)); return; } } const _0x418a64 = _0x432194[_0x1cfeda(0x7cf)](/\/+$/, ''), _0x23bdcd = _0x418a64 + '/v1/models'; _0x3f753a[_0x1cfeda(0xf6)] = !![], _0x3f753a[_0x1cfeda(0x9ac)] = _0x1cfeda(0x179), _0x332ad2['classList'][_0x1cfeda(0xae0)](_0x1cfeda(0x11b)); try { const _0x3c7daa = await fetch(_0x23bdcd, { 'headers': { 'Authorization': _0x1cfeda(0x9bf) + _0x538a31(_0x492859) } }); if (!_0x3c7daa['ok']) throw new Error(_0x1cfeda(0x5a7) + _0x3c7daa[_0x1cfeda(0xa37)]); const _0x1695e9 = await _0x3c7daa[_0x1cfeda(0x250)](), _0x21d00b = (_0x1695e9[_0x1cfeda(0x9be)] || _0x1695e9)[_0x1cfeda(0xa21)](_0x28cfc9 => _0x28cfc9['id'])[_0x1cfeda(0xaa6)](); _0x21d00b[_0x1cfeda(0x848)] > 0x0 ? (_0x332ad2[_0x1cfeda(0x9a1)] = '', _0x21d00b[_0x1cfeda(0x986)](_0x373815 => { const _0x3c15a6 = _0x1cfeda; if (_0x3c15a6(0x390) === _0x3c15a6(0x390)) { const _0x475885 = document[_0x3c15a6(0x3b9)](_0x3c15a6(0x6ff)); _0x475885[_0x3c15a6(0x9ac)] = _0x373815, _0x475885[_0x3c15a6(0x578)](_0x3c15a6(0x4b3), () => { const _0xa2c249 = _0x3c15a6; _0x3a9d9a['value'] = _0x373815, _0x332ad2[_0xa2c249(0x882)][_0xa2c249(0xae0)]('show'); }), _0x332ad2[_0x3c15a6(0x6ab)](_0x475885); } else _0x96001[_0x3c15a6(0x10d)]['display'] = 'none', _0x506628[_0x3c15a6(0x10d)][_0x3c15a6(0xa00)] = _0x3c15a6(0xda), _0x582529[_0x3c15a6(0x10d)]['background'] = _0x3c15a6(0x97e); }), _0x332ad2['classList'][_0x1cfeda(0x7c3)](_0x1cfeda(0x11b)), _0x3a6c86('成功获取\x20' + _0x21d00b['length'] + _0x1cfeda(0x1e9))) : _0x3a6c86(_0x1cfeda(0x8fc)); } catch (_0x33ebd8) { _0x1cfeda(0xab4) === _0x1cfeda(0x2bf) ? (_0x4b5ee9(), _0x3b4c7c[_0x1cfeda(0x675)] = [], _0x2ffb47()) : _0x3a6c86(_0x1cfeda(0x6c6) + _0x33ebd8[_0x1cfeda(0x380)] + _0x1cfeda(0x876)); } finally { _0x3f753a[_0x1cfeda(0xf6)] = ![], _0x3f753a['textContent'] = '获取'; } } _0x3f753a[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0xf296e8 => { const _0x2d489a = _0x1da6ac; if (_0x2d489a(0x14d) !== _0x2d489a(0x96b)) _0xf296e8['stopPropagation'](), _0x392d21(); else { _0x4b9bf5('需要至少2个角色才能创建群聊。'); return; } }), document['addEventListener'](_0x1da6ac(0x4b3), _0x17219c => { const _0x54ec5c = _0x1da6ac; !_0x332ad2[_0x54ec5c(0x956)](_0x17219c['target']) && _0x17219c['target'] !== _0x3a9d9a && _0x17219c['target'] !== _0x3f753a && _0x332ad2[_0x54ec5c(0x882)][_0x54ec5c(0xae0)](_0x54ec5c(0x11b)); }); async function _0x1f8d37(_0x1a4285) { const _0x230367 = _0x1da6ac; if (_0x230367(0x42c) === _0x230367(0x8b6)) { _0x3e3746['conversationHistory'] = []; return; } else return await _0xa06749(_0x1a4285, 0x190, 0.85); } _0x475da2[_0x1da6ac(0x578)]('click', () => _0x470f89[_0x1da6ac(0x4b3)]()), _0x470f89['addEventListener'](_0x1da6ac(0x423), async _0x5b5511 => { const _0x24a97e = _0x1da6ac; if (_0x24a97e(0x284) === _0x24a97e(0x284)) { const _0x467042 = _0x5b5511['target'][_0x24a97e(0x5fc)][0x0]; if (!_0x467042) return; try { if (_0x24a97e(0xef) === _0x24a97e(0x76f)) _0x376648(() => { const _0x1e4cd4 = _0x24a97e; _0x3ea40e[_0x1e4cd4(0x40d)] = _0x51c5a4[_0x1e4cd4(0x5ce)]; }); else { const _0x241d99 = await _0x1f8d37(_0x467042), _0x140317 = document['getElementById'](_0x24a97e(0x743)); _0x140317[_0x24a97e(0x10d)][_0x24a97e(0xad9)] = 'url(\x27' + _0x241d99 + '\x27)', _0x140317['dataset'][_0x24a97e(0x817)] = _0x241d99; } } catch (_0x301225) { _0x3a6c86(_0x24a97e(0x247) + _0x301225['message']); } } else { const _0x465f06 = _0x2fdd98['getItem'](_0x24a97e(0x7b4)); _0x465f06 ? _0x369d7f['getElementById'](_0x24a97e(0x9e9))[_0x24a97e(0x10d)][_0x24a97e(0x91f)](_0x24a97e(0x118), 'url(' + _0x465f06 + ')') : _0x324153[_0x24a97e(0x248)]('music-screen')[_0x24a97e(0x10d)][_0x24a97e(0x91f)](_0x24a97e(0x118), _0x24a97e(0x3fe)); } }), _0x708448['addEventListener']('click', () => _0x14d098[_0x1da6ac(0x4b3)]()), _0x14d098[_0x1da6ac(0x578)](_0x1da6ac(0x423), async _0x2798f1 => { const _0x56bc55 = _0x1da6ac; if (_0x56bc55(0xa51) === _0x56bc55(0xa51)) { const _0x5862d5 = _0x2798f1[_0x56bc55(0x6c4)][_0x56bc55(0x5fc)][0x0]; if (!_0x5862d5) return; try { _0x708448[_0x56bc55(0x70a)] = await _0x1f8d37(_0x5862d5); } catch (_0x583816) { _0x56bc55(0x687) !== _0x56bc55(0x281) ? _0x3a6c86(_0x56bc55(0x247) + _0x583816['message']) : _0x364180[_0x56bc55(0x557)] = null; } } else { const _0x27cb40 = _0x2f0ef4[_0x56bc55(0x248)](_0x48cb49); if (_0x27cb40 && _0x5daa43) _0x27cb40['src'] = _0x154d91[_0x56bc55(0x73d)](_0x172b44); } }); function _0x17cbb9() { const _0x36aa19 = _0x1da6ac; _0x474876['innerHTML'] = '', _0x13ae2d[_0x36aa19(0x986)](_0x562e42 => { const _0x302dc7 = _0x36aa19, _0x590b6d = document[_0x302dc7(0x3b9)]('img'); _0x590b6d[_0x302dc7(0x70a)] = _0x562e42[_0x302dc7(0x83a)], _0x590b6d[_0x302dc7(0x7e8)] = _0x302dc7(0x7b1), _0x590b6d['title'] = _0x562e42['name'], _0x590b6d[_0x302dc7(0x882)]['add']('sticker-item'), _0x590b6d[_0x302dc7(0x578)]('click', () => _0x5c347d(_0x562e42)), _0x474876[_0x302dc7(0x6ab)](_0x590b6d); }); } async function _0x6eb376(_0x446b1c) { const _0x54c5e5 = _0x1da6ac, _0xc3a19b = await _0x52e7d6(_0x54c5e5(0x8d1)); if (!_0xc3a19b) return; const _0x389c9b = _0x10530c[_0x54c5e5(0x2e4)][_0x54c5e5(0x981)](_0x12301c => _0x12301c['id'] === _0x446b1c); _0x389c9b > -0x1 && (_0x10530c[_0x54c5e5(0x2e4)][_0x54c5e5(0x2f2)](_0x389c9b, 0x1), _0x3e6d3a(), _0x784f5d(), _0x424e41(), _0x9f98f6(), _0x3a6c86(_0x54c5e5(0x5a4))); } let _0x22aa63 = null; function _0x2c79e0(_0x288da0) { const _0x55311a = _0x1da6ac; if (_0x22aa63) clearTimeout(_0x22aa63); const _0x462665 = _0x288da0[_0x55311a(0x6c4)][_0x55311a(0x939)]('.todo-item,\x20.important-day-item'); if (!_0x462665) return; const _0x1a06a1 = _0x462665[_0x55311a(0xab1)]['id']; if (!_0x1a06a1) return; const _0x52770e = () => { const _0x3914f1 = _0x55311a; if (_0x3914f1(0x65c) === 'xHWhs') _0x22aa63 = setTimeout(() => { const _0x3daad0 = _0x3914f1; if (_0x288da0[_0x3daad0(0xa78)] === _0x3daad0(0x936)) _0x288da0['preventDefault'](); _0x6eb376(_0x1a06a1); }, 0x320); else return ''; }, _0x15e7b2 = () => { const _0x658ea0 = _0x55311a; if ('zMImT' === _0x658ea0(0xada)) { if (_0x22aa63) clearTimeout(_0x22aa63); } else return _0x3c3bc8['slice'](0x0, 0x9); }; document['addEventListener'](_0x55311a(0x529), _0x15e7b2, { 'once': !![] }), document[_0x55311a(0x578)](_0x55311a(0xa13), _0x15e7b2, { 'once': !![] }), document['addEventListener']('touchcancel', _0x15e7b2, { 'once': !![] }), document[_0x55311a(0x578)]('touchmove', _0x15e7b2, { 'once': !![] }), _0x52770e(); } function _0x138c37(_0xd62282) { const _0x1a415f = _0x1da6ac, _0x57a36b = _0x10530c['chats'][_0x1a415f(0x212)](_0x36d650 => _0x36d650[_0x1a415f(0x26f)]['includes'](_0xd62282)); if (!_0x57a36b) return ''; const _0x41f82d = _0x474290(_0x57a36b['id']), _0x4b2aec = _0x10530c[_0x1a415f(0x2e4)][_0x1a415f(0x54e)](_0x3d2471 => _0x3d2471['userId'] === _0x41f82d['id'] || !_0x3d2471[_0x1a415f(0x9b2)]); if (_0x4b2aec[_0x1a415f(0x848)] === 0x0) return ''; const _0x132261 = _0x4b2aec['map'](_0xc87dd9 => { const _0x1f1e72 = _0x1a415f; if (_0x1f1e72(0x470) === 'UnGBH') _0x42e8a4[_0x1f1e72(0x10d)][_0x1f1e72(0x5eb)] = _0x1f1e72(0x3fe), _0x254b4e['style'][_0x1f1e72(0x5eb)] = _0x1f1e72(0x92c); else { const _0x33beaa = _0xc87dd9['type'] === 'important' ? _0x1f1e72(0x543) : '待办'; return _0x1f1e72(0x18c) + _0x33beaa + ']\x20' + _0xc87dd9[_0x1f1e72(0x60f)] + ':\x20' + _0xc87dd9[_0x1f1e72(0x9a8)]; } })[_0x1a415f(0x64e)]('\x0a'); return _0x1a415f(0x2c7) + _0x41f82d[_0x1a415f(0x6b7)] + _0x1a415f(0x617) + _0x132261; } let _0x39bae4 = { 'currentDate': new Date(), 'selectedDate': _0x495e80() }; function _0x100011() { const _0x4811d2 = _0x1da6ac; document[_0x4811d2(0x248)]('app-calendar')[_0x4811d2(0x578)](_0x4811d2(0x4b3), () => { const _0x2d5d9c = _0x4811d2; _0x2d5d9c(0xf3) !== _0x2d5d9c(0xf3) ? (_0x2b5281[_0x2d5d9c(0x10d)][_0x2d5d9c(0x5eb)] = 'flex', _0x24201b(() => _0x86bb62[_0x2d5d9c(0x882)][_0x2d5d9c(0x7c3)](_0x2d5d9c(0x11b)), 0xa)) : (_0x784f5d(), _0x1c4afc(_0x2d5d9c(0x53e), _0x2d5d9c(0x362))); }), document[_0x4811d2(0x248)](_0x4811d2(0xf5))[_0x4811d2(0x578)](_0x4811d2(0x4b3), () => _0x1c4afc('home', _0x4811d2(0x53e))), document[_0x4811d2(0x248)](_0x4811d2(0x736))['addEventListener'](_0x4811d2(0x4b3), () => { const _0x187eb1 = _0x4811d2; _0x39bae4['currentDate'][_0x187eb1(0x4b1)](_0x39bae4[_0x187eb1(0x634)]['getMonth']() - 0x1), _0x784f5d(); }), document['getElementById'](_0x4811d2(0x7bc))['addEventListener']('click', () => { const _0x1bdfc9 = _0x4811d2; _0x39bae4[_0x1bdfc9(0x634)][_0x1bdfc9(0x4b1)](_0x39bae4[_0x1bdfc9(0x634)][_0x1bdfc9(0xa84)]() + 0x1), _0x784f5d(); }), document[_0x4811d2(0x248)](_0x4811d2(0x8d2))[_0x4811d2(0x578)]('click', () => { _0x39bae4['currentDate'] = new Date(), _0x39bae4['selectedDate'] = _0x495e80(), _0x784f5d(); }), document['getElementById']('add-event-fab')[_0x4811d2(0x578)](_0x4811d2(0x4b3), () => { _0x1f177a(_0x39bae4['selectedDate']); }), document[_0x4811d2(0x248)](_0x4811d2(0x757))['addEventListener'](_0x4811d2(0x4b3), _0x256e94), document[_0x4811d2(0x248)](_0x4811d2(0x526))[_0x4811d2(0x578)](_0x4811d2(0x4b3), () => document[_0x4811d2(0x248)]('add-event-modal')['classList'][_0x4811d2(0xae0)](_0x4811d2(0x11b))), document['getElementById'](_0x4811d2(0x996))[_0x4811d2(0x578)]('click', () => document[_0x4811d2(0x248)]('add-event-modal')[_0x4811d2(0x882)][_0x4811d2(0xae0)]('show')); const _0x437c74 = document[_0x4811d2(0x248)](_0x4811d2(0xa97)); _0x437c74[_0x4811d2(0x578)](_0x4811d2(0x41e), _0x2c79e0), _0x437c74['addEventListener'](_0x4811d2(0x936), _0x2c79e0, { 'passive': ![] }); } function _0x784f5d() { const _0x106fa0 = _0x1da6ac; if (_0x106fa0(0x4a6) !== _0x106fa0(0x40a)) { const _0x3d159c = _0x39bae4[_0x106fa0(0x634)][_0x106fa0(0x5f8)](), _0x6fc120 = _0x39bae4[_0x106fa0(0x634)][_0x106fa0(0xa84)](); document[_0x106fa0(0x248)](_0x106fa0(0x4a7))[_0x106fa0(0x9ac)] = _0x3d159c + '年\x20' + (_0x6fc120 + 0x1) + '月', _0x16724e(_0x3d159c, _0x6fc120), _0x3ad6fa(_0x39bae4[_0x106fa0(0x592)]); } else _0x2cd3d['meetingViewMode'] = _0x5e6d85[_0x106fa0(0x23a)] === 'novel' ? _0x106fa0(0xa15) : 'novel', _0x18ac7d(); } function _0x9f98f6() { const _0x2549d1 = _0x1da6ac, _0x5374f7 = document[_0x2549d1(0x248)](_0x2549d1(0x454)); if (!_0x5374f7) return; const _0x4fc1dd = _0x495e80(), _0x24835d = _0x10530c['calendarEvents'][_0x2549d1(0x54e)](_0x8b70da => _0x8b70da[_0x2549d1(0x60f)] === _0x4fc1dd && _0x8b70da[_0x2549d1(0xa78)] === _0x2549d1(0x1e7)); _0x5374f7[_0x2549d1(0x9a1)] = '', _0x24835d[_0x2549d1(0x848)] > 0x0 ? _0x24835d[_0x2549d1(0x986)](_0x16ca6b => { const _0x4d849f = _0x2549d1; if (_0x4d849f(0x355) !== _0x4d849f(0x9d6)) { const _0x4db9d9 = document['createElement'](_0x4d849f(0x6ff)); _0x4db9d9[_0x4d849f(0x296)] = 'todo-item-small', _0x4db9d9[_0x4d849f(0x9ac)] = _0x16ca6b['content'], _0x5374f7[_0x4d849f(0x6ab)](_0x4db9d9); } else { const _0x1346c7 = _0x3421d8[_0x4d849f(0x319)](_0x19c602, _0x4d849f(0x52c)), _0x567ec7 = _0x1346c7[_0x4d849f(0x963)](_0x4b4d1a), _0x1dec16 = _0x567ec7[_0x4d849f(0xa8b)]({ 'id': _0x2d4d97, 'data': _0x2de105 }); _0x1dec16[_0x4d849f(0x330)] = () => _0x1ce07e(), _0x1dec16[_0x4d849f(0x136)] = () => _0xcca042(_0x1dec16[_0x4d849f(0x729)]); } }) : _0x2549d1(0x881) !== 'eXLob' ? _0x5374f7[_0x2549d1(0x9a1)] = _0x2549d1(0x49d) : (_0x4613c8(_0x2af4f9), _0x52b3e6(_0x2549d1(0x8a4) + _0x4a5f56['name'] + '”已删除。'), _0x4781d4(_0x2549d1(0x78c), 'characterEdit'), _0x34627e(![])); } function _0x16724e(_0x329289, _0x29dc05) { const _0x436557 = _0x1da6ac; if (_0x436557(0x4c9) === _0x436557(0x5cc)) { if (!_0x2986e3 || typeof _0x21e9c2 !== _0x436557(0x9d1)) return null; const _0x46fb7f = _0x13e813[_0x436557(0x7ec)]('['), _0x888aee = _0x5f1789[_0x436557(0xae1)](']'); if (_0x46fb7f > -0x1 && _0x888aee > _0x46fb7f) return _0x395260[_0x436557(0x3f1)](_0x46fb7f, _0x888aee + 0x1); return null; } else { const _0x2a7b17 = document[_0x436557(0x248)]('calendar-grid'); _0x2a7b17[_0x436557(0x9a1)] = ''; const _0xbf2d7f = new Date(_0x329289, _0x29dc05, 0x1)[_0x436557(0x381)](), _0x5a942c = new Date(_0x329289, _0x29dc05 + 0x1, 0x0)[_0x436557(0x208)](), _0x4c6ac8 = _0x495e80(); for (let _0x14ea4b = 0x0; _0x14ea4b < _0xbf2d7f; _0x14ea4b++) { _0x436557(0x160) === _0x436557(0x160) ? _0x2a7b17['appendChild'](document['createElement'](_0x436557(0x6ff))) : (_0x13fcc6['src'] = _0x35937f['createObjectURL'](_0x5964d9), _0x1d30bd['style']['display'] = 'block', _0x22b46f['style'][_0x436557(0xa00)] = _0x436557(0x3fe), _0x2dfacc['style'][_0x436557(0x694)] = _0x436557(0x3eb)); } for (let _0x3bc706 = 0x1; _0x3bc706 <= _0x5a942c; _0x3bc706++) { if (_0x436557(0x4a9) === 'BYehz') { const _0x2937e5 = document['createElement'](_0x436557(0x6ff)); _0x2937e5[_0x436557(0x296)] = _0x436557(0xa19); const _0x2e26ba = _0x329289 + '-' + String(_0x29dc05 + 0x1)[_0x436557(0x1db)](0x2, '0') + '-' + String(_0x3bc706)[_0x436557(0x1db)](0x2, '0'); if (_0x2e26ba === _0x4c6ac8) _0x2937e5[_0x436557(0x882)]['add']('is-today'); if (_0x2e26ba === _0x39bae4[_0x436557(0x592)]) _0x2937e5[_0x436557(0x882)][_0x436557(0x7c3)](_0x436557(0x7e2)); const _0x5cfaea = document[_0x436557(0x3b9)](_0x436557(0x3c6)); _0x5cfaea[_0x436557(0x296)] = _0x436557(0x904), _0x5cfaea['textContent'] = _0x3bc706, _0x2937e5[_0x436557(0x6ab)](_0x5cfaea); const _0x21c020 = _0x10530c[_0x436557(0x2e4)][_0x436557(0x54e)](_0x3ed884 => _0x3ed884['date'] === _0x2e26ba); if (_0x21c020[_0x436557(0x848)] > 0x0) { const _0x47c26c = document[_0x436557(0x3b9)]('div'); _0x47c26c[_0x436557(0x296)] = _0x436557(0x7b3), _0x2937e5[_0x436557(0x6ab)](_0x47c26c); } _0x2937e5['addEventListener'](_0x436557(0x4b3), () => { const _0x205f35 = _0x436557; _0x39bae4[_0x205f35(0x592)] = _0x2e26ba, _0x784f5d(); }), _0x2a7b17['appendChild'](_0x2937e5); } else { _0x128356[_0x436557(0x729)](_0x436557(0x44c) + _0x1737a5[_0x436557(0x16e)] + _0x436557(0x6dc), _0x87019d); try { _0x2a30ca[_0x436557(0x89a)]('chatHistory_' + _0x3b45a1['activeChatId']); } catch (_0x4ed531) { _0x5f2e52[_0x436557(0x729)](_0x436557(0x9d4), _0x4ed531); } } } } } function _0x3ad6fa(_0x391a86) { const _0x2afaa5 = _0x1da6ac; if ('gEfcH' !== _0x2afaa5(0x760)) _0x591030 = _0x2769db, _0x10e97['classList']['add'](_0x2afaa5(0x11b)); else { const _0xbdd437 = document[_0x2afaa5(0x248)](_0x2afaa5(0xa97)), _0x3146d1 = document[_0x2afaa5(0x248)](_0x2afaa5(0xee)); _0xbdd437[_0x2afaa5(0x9a1)] = ''; const _0x57ca67 = new Date(_0x391a86 + _0x2afaa5(0x1a9)); _0x3146d1['textContent'] = _0x57ca67['getMonth']() + 0x1 + '月' + _0x57ca67[_0x2afaa5(0x208)]() + '日'; const _0x5d43f7 = _0x10530c[_0x2afaa5(0x2e4)][_0x2afaa5(0x54e)](_0x55b86c => _0x55b86c['date'] === _0x391a86); if (_0x5d43f7[_0x2afaa5(0x848)] === 0x0) { if (_0x2afaa5(0x3e3) !== _0x2afaa5(0x3e3)) _0x136fa8['worldBooks'] = _0x323f60[_0x2afaa5(0x7e0)][_0x2afaa5(0xa21)](_0x37564d => _0x243697[_0x2afaa5(0x79a)][_0x2afaa5(0x212)](_0x572be2 => _0x572be2['id'] === _0x37564d))[_0x2afaa5(0x54e)](_0x4668b6)[_0x2afaa5(0xa21)](_0x311de5 => ({ 'name': _0x311de5['name'], 'content': _0x311de5[_0x2afaa5(0x9a8)] })); else { _0xbdd437[_0x2afaa5(0x9a1)] = _0x2afaa5(0x1a0); return; } } _0x5d43f7[_0x2afaa5(0x986)](_0x3a6051 => { const _0x5f3967 = _0x2afaa5; if (_0x5f3967(0x78a) === _0x5f3967(0x78a)) { const _0xc44d52 = document[_0x5f3967(0x3b9)](_0x5f3967(0x6ff)); _0xc44d52[_0x5f3967(0x296)] = _0x3a6051[_0x5f3967(0xa78)] === _0x5f3967(0x766) ? _0x5f3967(0x6b5) : _0x5f3967(0x3bf), _0xc44d52['textContent'] = _0x3a6051[_0x5f3967(0x9a8)], _0xc44d52[_0x5f3967(0xab1)]['id'] = _0x3a6051['id'], _0xbdd437[_0x5f3967(0x6ab)](_0xc44d52); } else _0x76b749 = _0x5f3967(0x253); }); } } function _0x1f177a(_0xc05293) { const _0x392d39 = _0x1da6ac; _0x392d39(0x81f) !== _0x392d39(0x81f) ? _0x2a0d96[_0x392d39(0x9e0)](_0x392d39(0xca), _0x2be745[_0x392d39(0x22e)]({ 'playlist': _0x2fd58b['musicPlaylist'], 'currentIndex': _0x265ab3[_0x392d39(0x79f)] })) : (document[_0x392d39(0x248)](_0x392d39(0x909))['textContent'] = '为\x20' + _0xc05293 + '\x20添加...', document[_0x392d39(0x248)](_0x392d39(0x9f2))['value'] = '', document[_0x392d39(0x248)](_0x392d39(0x4e4))[_0x392d39(0x38c)] = !![], document[_0x392d39(0x248)](_0x392d39(0x8c7))[_0x392d39(0x882)][_0x392d39(0x7c3)]('show'), document[_0x392d39(0x248)](_0x392d39(0x9f2))[_0x392d39(0x6e3)]()); } function _0x256e94() { const _0xd94703 = _0x1da6ac, _0x43273b = document[_0xd94703(0x248)](_0xd94703(0x9f2))[_0xd94703(0xe5)][_0xd94703(0x3ee)](), _0x159a3e = document[_0xd94703(0x838)](_0xd94703(0xa46))[_0xd94703(0xe5)]; if (!_0x43273b) { if (_0xd94703(0x351) === 'zfPYe') _0x5f4e1e(_0x9dee6f[_0xd94703(0xe5)]), _0x47343a(); else { _0x3a6c86(_0xd94703(0x459)); return; } } const _0x166fee = _0x10530c['userProfiles'][_0xd94703(0x212)](_0x444365 => _0x444365['id'] === _0x10530c[_0xd94703(0x663)]); if (!_0x166fee) { if (_0xd94703(0x7a7) === _0xd94703(0x941)) { const _0x4e8520 = _0x29c404(_0x41e03a['chat'], _0x383f65[_0xd94703(0x5f1)], _0x2c49f6); if (_0x4e8520[_0xd94703(0x848)] === 0x0) return; const _0x3feac7 = _0x557cba === 0x0 ? _0xd94703(0x15c) : _0xd94703(0x8cf); _0x26d34b[_0xd94703(0x36b)]('##\x20' + _0x3feac7 + _0xa3af90(_0x5df8c1['chat']) + '\x0a' + _0x4e8520[_0xd94703(0x64e)]('\x0a')), _0x231ac1[_0x4dfb93['chat']['id']] = _0x4e8520[_0xd94703(0x848)]; } else { _0x3a6c86('错误：找不到当前用户，无法保存事件。请尝试返回主屏幕再试一次。'); return; } } _0x10530c[_0xd94703(0x2e4)][_0xd94703(0x36b)]({ 'id': _0xd94703(0x11a) + Date[_0xd94703(0x7a8)](), 'date': _0x39bae4[_0xd94703(0x592)], 'type': _0x159a3e, 'content': _0x43273b, 'userId': _0x166fee['id'] }), _0x3e6d3a(), _0x784f5d(), _0x424e41(), _0x9f98f6(), document['getElementById'](_0xd94703(0x8c7))[_0xd94703(0x882)][_0xd94703(0xae0)](_0xd94703(0x11b)); } function _0x424e41() { const _0x5481f0 = _0x1da6ac, _0x7c8b7e = document[_0x5481f0(0x248)](_0x5481f0(0x264)), _0x304d9a = document[_0x5481f0(0x248)](_0x5481f0(0x7e5)), _0x70df03 = new Date(); _0x70df03[_0x5481f0(0x3c1)](0x0, 0x0, 0x0, 0x0); const _0x4b8da8 = _0x10530c[_0x5481f0(0x2e4)][_0x5481f0(0x54e)](_0x321669 => _0x321669[_0x5481f0(0xa78)] === 'important' && new Date(_0x321669[_0x5481f0(0x60f)] + _0x5481f0(0x1a9)) >= _0x70df03)[_0x5481f0(0xaa6)]((_0x3fbb5c, _0x91f56c) => new Date(_0x3fbb5c[_0x5481f0(0x60f)]) - new Date(_0x91f56c[_0x5481f0(0x60f)])); if (_0x4b8da8[_0x5481f0(0x848)] > 0x0) { const _0x3d0ffe = _0x4b8da8[0x0], _0x44b33a = new Date(_0x3d0ffe[_0x5481f0(0x60f)] + _0x5481f0(0x1a9)), _0x3d7c2f = _0x44b33a - _0x70df03, _0xd76853 = Math[_0x5481f0(0x16f)](_0x3d7c2f / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x7c8b7e[_0x5481f0(0x9ac)] = '距离「' + _0x3d0ffe[_0x5481f0(0x9a8)] + '」', _0x304d9a['innerHTML'] = _0x5481f0(0x37f) + _0xd76853 + _0x5481f0(0x5c0); } else _0x7c8b7e['textContent'] = _0x5481f0(0x214), _0x304d9a[_0x5481f0(0x9a1)] = _0x5481f0(0x48b); } function _0xfb2bb6() { const _0x36cae9 = _0x1da6ac, _0x9a5a41 = document[_0x36cae9(0x248)](_0x36cae9(0x883)); _0x9a5a41['innerHTML'] = ''; if (_0x10530c['userProfiles'][_0x36cae9(0x848)] === 0x0) { _0x9a5a41[_0x36cae9(0x9a1)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>'; return; } _0x10530c[_0x36cae9(0x360)]['forEach'](_0x356568 => { const _0x241eb7 = _0x36cae9; if (_0x241eb7(0xadb) === 'SvKNu') { const _0x44ad4a = document[_0x241eb7(0x3b9)](_0x241eb7(0x6ff)); _0x44ad4a[_0x241eb7(0x296)] = _0x241eb7(0x6be), _0x44ad4a[_0x241eb7(0xab1)]['id'] = _0x356568['id']; const _0x17d740 = _0x356568['id'] === _0x10530c[_0x241eb7(0x663)] ? _0x241eb7(0xa3e) : ''; _0x44ad4a[_0x241eb7(0x9a1)] = _0x241eb7(0x19e) + (_0x356568['avatar'] || _0x45fac0) + _0x241eb7(0x68b) + _0x356568[_0x241eb7(0x6b7)] + _0x17d740 + _0x241eb7(0x7c6) + _0x356568[_0x241eb7(0x824)][_0x241eb7(0x3f1)](0x0, 0x64) + _0x241eb7(0x8e3), _0x44ad4a['addEventListener'](_0x241eb7(0x4b3), () => _0x24ac80(_0x356568['id'])), _0x9a5a41[_0x241eb7(0x6ab)](_0x44ad4a); } else { const _0x5409c6 = _0x6f0264[_0x241eb7(0x3b9)](_0x241eb7(0x6ff)); _0x5409c6['className'] = _0x264356['type'] === 'important' ? _0x241eb7(0x6b5) : 'todo-item', _0x5409c6[_0x241eb7(0x9ac)] = _0x1cf23c[_0x241eb7(0x9a8)], _0x5409c6[_0x241eb7(0xab1)]['id'] = _0x4621b2['id'], _0x149aec[_0x241eb7(0x6ab)](_0x5409c6); } }); } function _0x24ac80(_0x817a98 = null) { const _0x505a94 = _0x1da6ac; _0x1c4afc('userProfile', _0x505a94(0x51d)); const _0x5cddd7 = document[_0x505a94(0x248)](_0x505a94(0x24c)), _0x293a41 = document[_0x505a94(0x248)]('user-avatar-preview'); _0x293a41['style'][_0x505a94(0xad9)] = '', delete _0x293a41[_0x505a94(0xab1)]['newAvatar']; if (_0x817a98) { const _0x2fa6d7 = _0x10530c[_0x505a94(0x360)]['find'](_0x34a821 => _0x34a821['id'] === _0x817a98); if (!_0x2fa6d7) return; document[_0x505a94(0x248)](_0x505a94(0x7b7))[_0x505a94(0xe5)] = _0x2fa6d7['id'], document[_0x505a94(0x248)](_0x505a94(0x222))['textContent'] = '编辑用户', document[_0x505a94(0x248)](_0x505a94(0x595))[_0x505a94(0xe5)] = _0x2fa6d7[_0x505a94(0x6b7)]; if (_0x2fa6d7[_0x505a94(0x917)]) _0x293a41[_0x505a94(0x10d)]['backgroundImage'] = 'url(\x27' + _0x2fa6d7[_0x505a94(0x917)] + '\x27)'; else { if (_0x505a94(0xa07) !== 'Hpocx') _0x293a41[_0x505a94(0x10d)]['backgroundImage'] = _0x505a94(0x7a2) + _0x45fac0 + '\x27)'; else return _0x53f4a1['name'] !== _0x505a94(0x885) && _0x358618[_0x505a94(0x729)](_0x505a94(0x6c7), _0x6a7ee6), null; } document[_0x505a94(0x248)](_0x505a94(0xa17))['value'] = _0x2fa6d7[_0x505a94(0x824)], _0x5cddd7[_0x505a94(0x10d)]['display'] = _0x2fa6d7['id'] === _0x10530c[_0x505a94(0x663)] ? _0x505a94(0x3fe) : _0x505a94(0x92c), document[_0x505a94(0x248)](_0x505a94(0x99a))[_0x505a94(0x10d)][_0x505a94(0x5eb)] = _0x505a94(0x92c); } else _0x505a94(0x6d0) !== _0x505a94(0x1ca) ? (document[_0x505a94(0x248)](_0x505a94(0x7b7))[_0x505a94(0xe5)] = '', document[_0x505a94(0x248)](_0x505a94(0x222))[_0x505a94(0x9ac)] = _0x505a94(0x600), document[_0x505a94(0x248)](_0x505a94(0x595))[_0x505a94(0xe5)] = _0x505a94(0x793) + (_0x10530c['userProfiles'][_0x505a94(0x848)] + 0x1), _0x293a41['style'][_0x505a94(0xad9)] = _0x505a94(0x7a2) + _0x45fac0 + '\x27)', document['getElementById'](_0x505a94(0xa17))[_0x505a94(0xe5)] = '', _0x5cddd7[_0x505a94(0x10d)][_0x505a94(0x5eb)] = _0x505a94(0x3fe), document[_0x505a94(0x248)](_0x505a94(0x99a))[_0x505a94(0x10d)][_0x505a94(0x5eb)] = _0x505a94(0x3fe)) : _0x41e46e = _0x505a94(0x550) + _0xd2f588['name'] + _0x505a94(0x154); } function _0x1dbb60() { const _0x516207 = _0x1da6ac; if (_0x516207(0x229) === _0x516207(0x229)) { const _0x2720e4 = document[_0x516207(0x248)](_0x516207(0x7b7))[_0x516207(0xe5)], _0x3057b2 = document[_0x516207(0x248)](_0x516207(0x743)), _0x24b1fb = { 'name': document[_0x516207(0x248)](_0x516207(0x595))[_0x516207(0xe5)]['trim'](), 'persona': document[_0x516207(0x248)](_0x516207(0xa17))[_0x516207(0xe5)][_0x516207(0x3ee)](), 'avatar': _0x10530c[_0x516207(0x360)][_0x516207(0x212)](_0xa5a96e => _0xa5a96e['id'] === _0x2720e4)?.[_0x516207(0x917)] || _0x3057b2[_0x516207(0x10d)][_0x516207(0xad9)][_0x516207(0x53a)](0x5, -0x2)[_0x516207(0x7cf)](/'/g, '') || _0x45fac0 }; _0x3057b2[_0x516207(0xab1)][_0x516207(0x817)] && (_0x24b1fb[_0x516207(0x917)] = _0x3057b2[_0x516207(0xab1)][_0x516207(0x817)], delete _0x3057b2['dataset'][_0x516207(0x817)]); if (!_0x24b1fb[_0x516207(0x6b7)]) { _0x3a6c86(_0x516207(0x7d6)); return; } if (_0x2720e4) { const _0x1f82cf = _0x10530c[_0x516207(0x360)]['find'](_0x4817f3 => _0x4817f3['id'] === _0x2720e4); if (_0x1f82cf) Object[_0x516207(0x895)](_0x1f82cf, _0x24b1fb); } else { if (_0x516207(0x4b6) === _0x516207(0x4b6)) { const _0x49dd74 = { 'id': _0x516207(0x22c) + Date[_0x516207(0x7a8)](), ..._0x24b1fb }; _0x10530c[_0x516207(0x360)][_0x516207(0x36b)](_0x49dd74), !_0x10530c[_0x516207(0x663)] && (_0x10530c[_0x516207(0x663)] = _0x49dd74['id']); } else { const _0x3e991c = _0x2e5553[_0x516207(0x329)](_0x5410eb); _0x22ce7c[_0x516207(0x796)](_0x3e991c) && (_0x1b0e50[_0x516207(0xe5)] = _0x3e991c[_0x516207(0xa21)](_0x54c716 => _0x54c716['name'] + '--' + _0x54c716['url'])[_0x516207(0x64e)]('\x0a')); } } _0x3e6d3a(), _0x3a6c86(_0x516207(0x1d1)), _0xfb2bb6(), _0x1c4afc(_0x516207(0x51d), _0x516207(0x1c9)); } else _0x5cd369[_0x516207(0x5e0)](_0x516207(0x395)), _0x336790['createObjectStore'](_0x516207(0x490), { 'keyPath': 'id' }); } async function _0x749cca() { const _0x17c06f = _0x1da6ac, _0x155dc5 = document[_0x17c06f(0x248)](_0x17c06f(0x7b7))['value']; if (!_0x155dc5) return; if (_0x10530c[_0x17c06f(0x360)]['length'] <= 0x1) { _0x3a6c86(_0x17c06f(0x991)); return; } const _0x1aa7cb = await _0x52e7d6('确定要删除这个用户吗？与此用户绑定的聊天将恢复为默认用户。'); _0x1aa7cb && (_0x10530c[_0x17c06f(0x360)] = _0x10530c[_0x17c06f(0x360)][_0x17c06f(0x54e)](_0x15ccab => _0x15ccab['id'] !== _0x155dc5), _0x10530c['activeUserProfileId'] === _0x155dc5 && (_0x10530c[_0x17c06f(0x663)] = _0x10530c['userProfiles'][0x0]['id']), _0x10530c[_0x17c06f(0x4bc)][_0x17c06f(0x986)](_0x4bacd2 => { const _0x3c7046 = _0x17c06f; _0x3c7046(0x748) === _0x3c7046(0x748) ? _0x4bacd2[_0x3c7046(0x2eb)] === _0x155dc5 && (_0x3c7046(0x29a) === _0x3c7046(0x29a) ? _0x4bacd2['boundUserProfileId'] = _0x10530c[_0x3c7046(0x663)] : _0x52ad30()) : (_0x3620bb(![]), _0x3db853[_0x3c7046(0x729)]('全量导出失败:', _0x2a43b8), _0x43a07d('导出过程中发生严重错误:\x20' + _0x4ebd93[_0x3c7046(0x380)])); }), _0x3e6d3a(), _0x3a6c86('用户已删除。'), _0xfb2bb6(), _0x1c4afc('userProfileList', _0x17c06f(0x1c9))); } function _0x175c5c() { const _0x1dc144 = _0x1da6ac; if (_0x1dc144(0x3de) === _0x1dc144(0x3f9)) _0x455eec(_0x35de1e[_0x1dc144(0x592)]); else { const _0x570abd = document[_0x1dc144(0x248)](_0x1dc144(0x155)); _0x570abd[_0x1dc144(0x9a1)] = ''; if (_0x10530c['worldBooks'][_0x1dc144(0x848)] === 0x0) { if ('QNqai' === _0x1dc144(0x391)) _0x434def['style']['backgroundImage'] = _0x1dc144(0x7a2) + _0x1b7068[_0x1dc144(0x73d)](_0x40c466) + '\x27)', _0x263cd7[_0x1dc144(0x10d)][_0x1dc144(0xc2)] = _0x1dc144(0x55a), _0x16250c[_0x1dc144(0x10d)]['backgroundPosition'] = _0x1dc144(0x1ff); else { _0x570abd[_0x1dc144(0x9a1)] = _0x1dc144(0xaa5); return; } } _0x10530c[_0x1dc144(0x79a)][_0x1dc144(0x986)](_0x5d4c3c => { const _0x3e8d0b = _0x1dc144; if (_0x3e8d0b(0x7e3) !== 'mtlWs') _0x2edba9[_0x3e8d0b(0x9ac)] = _0x2d95e3[_0x3e8d0b(0x4cf)], _0x8c87b3['textContent'] = _0x13f8bb[_0x3e8d0b(0x755)], _0x201f63[_0x3e8d0b(0x882)][_0x3e8d0b(0x7c3)]('is-playing'), _0x3a6717[_0x3e8d0b(0x10d)][_0x3e8d0b(0x91f)](_0x3e8d0b(0xe3), 'url(' + _0x4f936b[_0x3e8d0b(0x55a)] + ')'); else { const _0x5e5ebb = document[_0x3e8d0b(0x3b9)](_0x3e8d0b(0x6ff)); _0x5e5ebb[_0x3e8d0b(0x296)] = 'world-book-item', _0x5e5ebb[_0x3e8d0b(0xab1)]['id'] = _0x5d4c3c['id'], _0x5e5ebb[_0x3e8d0b(0x9a1)] = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + _0x5d4c3c[_0x3e8d0b(0x6b7)] + _0x3e8d0b(0x4ec) + _0x5d4c3c[_0x3e8d0b(0x9a8)]['substring'](0x0, 0x64) + _0x3e8d0b(0x659), _0x5e5ebb['addEventListener'](_0x3e8d0b(0x4b3), () => _0x11681c(_0x5d4c3c['id'])), _0x570abd['appendChild'](_0x5e5ebb); } }); } } function _0x11681c(_0x46f039 = null) { const _0x36313d = _0x1da6ac; if (_0x36313d(0x633) !== _0x36313d(0x633)) { if (_0x3fc220['key'] === _0x36313d(0x137)) _0x192dc3(![]); if (_0x517dda[_0x36313d(0x797)] === _0x36313d(0x18b)) _0x3f5dd8(!![]); } else { _0x1c4afc(_0x36313d(0xa59), _0x36313d(0x342)); if (_0x46f039) { const _0x32536a = _0x10530c[_0x36313d(0x79a)]['find'](_0x576d87 => _0x576d87['id'] === _0x46f039); if (!_0x32536a) return; document[_0x36313d(0x248)]('editing-world-book-id')['value'] = _0x32536a['id'], document['getElementById']('world-book-editor-title')[_0x36313d(0x9ac)] = _0x36313d(0x80d), document[_0x36313d(0x248)](_0x36313d(0x606))[_0x36313d(0xe5)] = _0x32536a[_0x36313d(0x6b7)], document[_0x36313d(0x248)]('world-book-edit-content')['value'] = _0x32536a['content']; } else document['getElementById'](_0x36313d(0x368))[_0x36313d(0xe5)] = '', document[_0x36313d(0x248)](_0x36313d(0x93a))['textContent'] = '新建条目', document[_0x36313d(0x248)](_0x36313d(0x606))[_0x36313d(0xe5)] = '', document['getElementById'](_0x36313d(0x677))[_0x36313d(0xe5)] = ''; } } function _0x58630e() { const _0x7708b0 = _0x1da6ac, _0x595bfa = document[_0x7708b0(0x248)](_0x7708b0(0x368))[_0x7708b0(0xe5)], _0x1a668c = document[_0x7708b0(0x248)](_0x7708b0(0x606))['value']['trim'](), _0xba2463 = document['getElementById'](_0x7708b0(0x677))[_0x7708b0(0xe5)][_0x7708b0(0x3ee)](); if (!_0x1a668c || !_0xba2463) { _0x3a6c86(_0x7708b0(0x4c5)); return; } if (_0x595bfa) { const _0x2783be = _0x10530c[_0x7708b0(0x79a)][_0x7708b0(0x212)](_0x2bb16c => _0x2bb16c['id'] === _0x595bfa); _0x2783be && (_0x2783be[_0x7708b0(0x6b7)] = _0x1a668c, _0x2783be[_0x7708b0(0x9a8)] = _0xba2463); } else { if (_0x7708b0(0x517) === _0x7708b0(0x517)) { const _0x1d352b = { 'id': _0x7708b0(0x405) + Date[_0x7708b0(0x7a8)](), 'name': _0x1a668c, 'content': _0xba2463 }; _0x10530c[_0x7708b0(0x79a)]['push'](_0x1d352b); } else _0x402d3c = _0x1a5057[_0x7708b0(0x1a2)]; } _0x3e6d3a(), _0x3a6c86(_0x7708b0(0x429)), _0x175c5c(), _0x1c4afc(_0x7708b0(0x342), _0x7708b0(0xa59)); } async function _0x8a73de() { const _0x491ea8 = _0x1da6ac, _0x20f42a = document[_0x491ea8(0x248)](_0x491ea8(0x368))[_0x491ea8(0xe5)]; if (!_0x20f42a) return; const _0x7908cf = await _0x52e7d6(_0x491ea8(0x1f9)); _0x7908cf && (_0x10530c[_0x491ea8(0x79a)] = _0x10530c[_0x491ea8(0x79a)][_0x491ea8(0x54e)](_0x7369ea => _0x7369ea['id'] !== _0x20f42a), _0x10530c[_0x491ea8(0x620)][_0x491ea8(0x986)](_0x259e85 => { const _0x4176d2 = _0x491ea8; _0x259e85[_0x4176d2(0x7e0)] && (_0x4176d2(0x81a) !== _0x4176d2(0x6a4) ? _0x259e85[_0x4176d2(0x7e0)] = _0x259e85[_0x4176d2(0x7e0)][_0x4176d2(0x54e)](_0x445a31 => _0x445a31 !== _0x20f42a) : _0x3971f5()); }), _0x3e6d3a(), _0x3a6c86('条目已删除。'), _0x175c5c(), _0x1c4afc(_0x491ea8(0x342), _0x491ea8(0xa59))); } function _0x294c66() { const _0x55548b = _0x1da6ac, _0x5f36c4 = document[_0x55548b(0x248)](_0x55548b(0x9ce)), _0x3baaea = _0x5f36c4[_0x55548b(0x20d)]('input:checked'), _0x3cd400 = document[_0x55548b(0x838)](_0x55548b(0x30f)); if (_0x3baaea['length'] === 0x0) _0x3cd400[_0x55548b(0x9ac)] = '--\x20点击选择\x20--'; else _0x3baaea[_0x55548b(0x848)] > 0x2 ? _0x55548b(0x57e) !== _0x55548b(0x57e) ? (_0x410310[_0x55548b(0x729)](_0x55548b(0xa47), _0x471be5), _0x29e98c(_0x55548b(0x56e) + _0x240718[_0x55548b(0x380)])) : _0x3cd400[_0x55548b(0x9ac)] = _0x55548b(0x8b7) + _0x3baaea['length'] + '\x20项' : _0x3cd400['textContent'] = Array[_0x55548b(0x10f)](_0x3baaea)[_0x55548b(0xa21)](_0x421dec => _0x421dec[_0x55548b(0x50d)]['textContent'][_0x55548b(0x3ee)]())[_0x55548b(0x64e)]('、'); } async function _0x15ffcd(_0x55725b) { const _0x1885c2 = _0x1da6ac, _0x4136f3 = _0x10530c[_0x1885c2(0x4bc)][_0x1885c2(0x212)](_0x1202bf => _0x1202bf['id'] === _0x55725b); if (!_0x4136f3 || _0x4136f3[_0x1885c2(0xa78)] !== _0x1885c2(0x732)) return; document[_0x1885c2(0x248)](_0x1885c2(0xa0f))['value'] = _0x4136f3[_0x1885c2(0x6b7)] || '', _0xb18b1d('group-settings-bind-user'), document[_0x1885c2(0x248)]('group-settings-bind-user')[_0x1885c2(0xe5)] = _0x4136f3[_0x1885c2(0x2eb)] || _0x10530c[_0x1885c2(0x663)]; const _0x40a02a = document[_0x1885c2(0x248)](_0x1885c2(0x35d)); _0x40a02a[_0x1885c2(0x9a1)] = '', _0x10530c[_0x1885c2(0x79a)][_0x1885c2(0x986)](_0x3d5b79 => { const _0xa1c5e0 = _0x1885c2, _0x454a56 = _0x4136f3[_0xa1c5e0(0x7e0)]?.[_0xa1c5e0(0xa83)](_0x3d5b79['id']), _0x28bfe6 = document['createElement'](_0xa1c5e0(0x737)); _0x28bfe6[_0xa1c5e0(0x9a1)] = _0xa1c5e0(0xcc) + _0x3d5b79['id'] + '\x22\x20' + (_0x454a56 ? _0xa1c5e0(0x38c) : '') + '>\x20' + _0x3d5b79[_0xa1c5e0(0x6b7)], _0x40a02a['appendChild'](_0x28bfe6); }), _0x260e1a(); const _0x196350 = document[_0x1885c2(0x248)](_0x1885c2(0x1cd)), _0xdb3566 = document[_0x1885c2(0x248)](_0x1885c2(0x2d0)); _0xdb3566[_0x1885c2(0x10d)][_0x1885c2(0xad9)] = '', _0x533d7a(_0x1885c2(0x207) + _0x55725b)[_0x1885c2(0x45f)](_0x11e1dc => { const _0x39dc07 = _0x1885c2; if ('NuJoy' !== _0x39dc07(0x4d0)) return ''; else _0x196350[_0x39dc07(0x70a)] = _0x11e1dc ? URL[_0x39dc07(0x73d)](_0x11e1dc) : _0x5da029; }), _0x533d7a(_0x1885c2(0x1cc) + _0x55725b)[_0x1885c2(0x45f)](_0x3d4f21 => { const _0x2e72f3 = _0x1885c2; if (_0x3d4f21) _0xdb3566[_0x2e72f3(0x10d)][_0x2e72f3(0xad9)] = _0x2e72f3(0x7a2) + URL[_0x2e72f3(0x73d)](_0x3d4f21) + '\x27)'; }), _0x1c4afc('groupSettings', _0x1885c2(0x78c)); } async function _0x278d9d() { const _0x48d543 = _0x1da6ac; if (_0x48d543(0x70b) !== _0x48d543(0x31b)) { const _0x58607f = _0x27b19d(); if (!_0x58607f || _0x58607f['type'] !== _0x48d543(0x732)) return; const _0x7edb7 = document[_0x48d543(0x248)](_0x48d543(0xa0f))['value'][_0x48d543(0x3ee)](); if (!_0x7edb7) { if (_0x48d543(0x88f) !== 'bBBrw') { _0x3a6c86('群聊名称不能为空！'); return; } else _0x26241e(), _0x45ad04[_0x48d543(0x880)] = 0x64; } _0x58607f[_0x48d543(0x6b7)] = _0x7edb7; const _0x268f58 = document['querySelectorAll'](_0x48d543(0x95f)); _0x58607f['linkedWorldBookIds'] = Array[_0x48d543(0x10f)](_0x268f58)['map'](_0x5c01b3 => _0x5c01b3[_0x48d543(0xe5)]), _0x58607f[_0x48d543(0x2eb)] = document[_0x48d543(0x248)](_0x48d543(0x4eb))[_0x48d543(0xe5)]; const _0x4391c2 = document['getElementById']('group-avatar-input')['files'][0x0], _0x559373 = document[_0x48d543(0x248)](_0x48d543(0x17d))['files'][0x0]; if (_0x4391c2) await _0x5ef29b('group_avatar_' + _0x58607f['id'], _0x4391c2); if (_0x559373) await _0x5ef29b('group_bg_' + _0x58607f['id'], _0x559373); _0x3e6d3a(), _0x59b7f0(), await _0x398205(), _0x3a6c86(_0x48d543(0x45c)), _0x1c4afc(_0x48d543(0x78c), 'groupSettings'); } else { const _0x4e5eaf = _0x2b4f61[_0x48d543(0x6c4)]['files'][0x0]; if (!_0x4e5eaf) return; const _0x45b341 = _0x46e92b['createObjectURL'](_0x4e5eaf); _0x26edbf[_0x48d543(0x10d)][_0x48d543(0xad9)] = _0x48d543(0x7a2) + _0x45b341 + '\x27)'; } } function _0x260e1a() { const _0x21074f = _0x1da6ac, _0x5bd18c = document[_0x21074f(0x248)](_0x21074f(0x35d)), _0x3684dc = _0x5bd18c[_0x21074f(0x20d)]('input:checked'), _0x25dd47 = document[_0x21074f(0x838)]('#group-settings-screen\x20.selected-options-text'); if (_0x3684dc[_0x21074f(0x848)] === 0x0) _0x25dd47[_0x21074f(0x9ac)] = _0x21074f(0x6e4); else _0x3684dc['length'] > 0x2 ? _0x25dd47[_0x21074f(0x9ac)] = _0x21074f(0x8b7) + _0x3684dc[_0x21074f(0x848)] + '\x20项' : _0x25dd47[_0x21074f(0x9ac)] = Array[_0x21074f(0x10f)](_0x3684dc)['map'](_0x29e8e7 => _0x29e8e7['parentElement'][_0x21074f(0x9ac)][_0x21074f(0x3ee)]())[_0x21074f(0x64e)]('、'); } async function _0x41f63e() { const _0x758b7d = _0x1da6ac, _0x397185 = _0x27b19d(), _0x59da82 = (_0x397185?.[_0x758b7d(0x26f)] || [])[_0x758b7d(0xa21)](_0x5b19fc)[_0x758b7d(0x54e)](Boolean), _0x3a5e0d = _0x474290(_0x397185['id']); if (!_0x397185 || _0x397185[_0x758b7d(0xa78)] !== _0x758b7d(0x732) || _0x59da82['length'] < 0x2) return null; const _0x5b6f68 = _0x397185['linkedWorldBookIds'] && _0x397185[_0x758b7d(0x7e0)][_0x758b7d(0x848)] > 0x0 ? _0x758b7d(0x762) + _0x397185[_0x758b7d(0x7e0)][_0x758b7d(0xa21)](_0x1589ae => _0x10530c['worldBooks'][_0x758b7d(0x212)](_0x416943 => _0x416943['id'] === _0x1589ae))[_0x758b7d(0x54e)](Boolean)[_0x758b7d(0xa21)](_0x18b43f => _0x758b7d(0x863) + _0x18b43f[_0x758b7d(0x6b7)] + '\x0a' + _0x18b43f['content'])[_0x758b7d(0x64e)]('') : '', _0x33cbeb = _0x3a5e0d[_0x758b7d(0x824)] ? _0x758b7d(0x62f) + _0x3a5e0d['name'] + _0x758b7d(0x910) + _0x3a5e0d[_0x758b7d(0x824)] : ''; let _0x2a0a54 = ''; const _0x422552 = new Date(), _0x5d4276 = _0x10530c[_0x758b7d(0x675)]['at'](-0x1); _0x2a0a54 += '\x0a-\x20**当前时间**:\x20' + _0x422552[_0x758b7d(0x446)]('zh-CN', { 'dateStyle': _0x758b7d(0x9e2), 'timeStyle': _0x758b7d(0x931) }); if (_0x5d4276) { if (_0x758b7d(0x638) === _0x758b7d(0x660)) _0x448dc7[_0x758b7d(0x663)] = _0x464120[_0x758b7d(0x360)][0x0]['id']; else { const _0x599ece = new Date(_0x5d4276[_0x758b7d(0x908)]), _0x41bdbc = Math[_0x758b7d(0x703)]((_0x422552 - _0x599ece) / (0x3e8 * 0x3c)); if (_0x41bdbc < 0x5) _0x2a0a54 += _0x758b7d(0x828); else { if (_0x41bdbc < 0x78) _0x2a0a54 += _0x758b7d(0x3dd) + _0x41bdbc + _0x758b7d(0x56c); else { if (_0x758b7d(0x359) === 'WeEQQ') { const _0x2a4301 = Math[_0x758b7d(0x703)](_0x41bdbc / 0x3c); if (_0x2a4301 < 0x30) _0x2a0a54 += _0x758b7d(0x3dd) + _0x2a4301 + '小时前聊过，可以适当问候，不要直接继续之前的话题。'; else _0x2a0a54 += _0x758b7d(0x321) + Math[_0x758b7d(0x703)](_0x2a4301 / 0x18) + _0x758b7d(0x4e1); } else { _0x3204fe(_0x758b7d(0x300)); return; } } } } } else { if (_0x758b7d(0x280) === _0x758b7d(0x9fb)) { const _0x18fd24 = _0x3f13e6[_0x758b7d(0x319)](_0x593ab1, _0x758b7d(0x559)), _0x51966c = _0x18fd24['objectStore'](_0x380b75), _0x38c836 = _0x51966c[_0x758b7d(0x385)](); _0x38c836[_0x758b7d(0x330)] = () => _0x57dac2(_0x38c836[_0x758b7d(0x4f7)]), _0x38c836['onerror'] = () => _0x125695(_0x38c836[_0x758b7d(0x729)]); } else _0x2a0a54 += _0x758b7d(0xaba); } const _0x1c5cc1 = [..._0x10530c['conversationHistory']]['reverse']()[_0x758b7d(0x212)](_0x4527ce => _0x4527ce[_0x758b7d(0x34a)] === 'user')?.[_0x758b7d(0x9a8)] || '', _0x4db39f = _0x4a0c77(_0x397185, _0x1c5cc1), _0x140922 = _0x10530c[_0x758b7d(0x675)][_0x758b7d(0x53a)](-0x78), _0x3785fe = _0x13ae2d[_0x758b7d(0xa21)](_0x1bc83b => _0x1bc83b[_0x758b7d(0x6b7)]), _0x350d65 = _0x538f71(), _0x30cc5e = _0x59da82[_0x758b7d(0xa21)](_0x20e40a => { const _0x572755 = _0x758b7d; if (_0x572755(0x393) !== _0x572755(0xac7)) { const { omniText: _0x93857f } = _0x3b8ffa(_0x20e40a['id'], _0x397185['id']), _0x118bd4 = _0x38a670(_0x20e40a['id']), _0x499473 = _0x20e40a['linkedWorldBookIds'] && _0x20e40a[_0x572755(0x7e0)][_0x572755(0x848)] > 0x0 ? _0x572755(0x8cb) + _0x20e40a[_0x572755(0x6b7)] + _0x572755(0x9dc) + _0x20e40a[_0x572755(0x7e0)][_0x572755(0xa21)](_0x234865 => _0x10530c[_0x572755(0x79a)][_0x572755(0x212)](_0x1294fe => _0x1294fe['id'] === _0x234865))[_0x572755(0x54e)](Boolean)[_0x572755(0xa21)](_0x2c3a94 => _0x572755(0x9c1) + _0x2c3a94[_0x572755(0x6b7)] + '\x0a' + _0x2c3a94[_0x572755(0x9a8)])['join']('') : ''; let _0x31171d = _0x572755(0xac9) + _0x20e40a[_0x572755(0x6b7)] + _0x572755(0x57b); const _0x5775c3 = _0x392b91(_0x20e40a['id']), _0x40eb04 = new Date(); if (_0x5775c3) { if (_0x572755(0x494) === 'tmsBv') { const _0x4fc265 = (_0x402900 - _0x4a0e3f) / (0x3e8 * 0x3c); _0x5e92eb += _0x572755(0x184); } else { const _0x32b227 = new Date(_0x5775c3['timestamp']); _0x31171d += _0x572755(0x62d) + _0x3a5e0d[_0x572755(0x6b7)] + _0x572755(0x9df) + _0x25c4db(_0x32b227) + '\x0a'; const _0x239307 = _0x40eb04[_0x572755(0x8b9)]() === _0x32b227[_0x572755(0x8b9)](), _0x1e3661 = new Date(); _0x1e3661[_0x572755(0x580)](_0x40eb04['getDate']() - 0x1); const _0x2a7ac7 = _0x1e3661[_0x572755(0x8b9)]() === _0x32b227[_0x572755(0x8b9)](); if (_0x239307) _0x572755(0x976) !== _0x572755(0x404) ? _0x31171d += _0x572755(0x4ee) : _0x1ea666(_0x572755(0x91b) + _0xc1dc13[_0x572755(0x380)]); else { if (_0x2a7ac7) _0x31171d += _0x572755(0x622); else { if (_0x572755(0x59f) === _0x572755(0x59f)) _0x31171d += _0x572755(0x2a2); else { const _0x34be99 = _0xe44758['linkedWorldBookIds'][_0x572755(0xa21)](_0x4b6f09 => _0x4d649b[_0x572755(0x79a)][_0x572755(0x212)](_0x5e99c3 => _0x5e99c3['id'] === _0x4b6f09))[_0x572755(0x54e)](_0x368a6c)[_0x572755(0xa21)](_0x15ce3c => _0x572755(0x8d4) + _0x15ce3c['name'] + '\x0a' + _0x15ce3c[_0x572755(0x9a8)])[_0x572755(0x64e)](''); if (_0x34be99) _0x2c477b = '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a' + _0x34be99; } } } } } else _0x31171d += _0x572755(0x4b5) + _0x3a5e0d[_0x572755(0x6b7)] + _0x572755(0x6ad); return { 'id': _0x20e40a['id'], 'name': _0x20e40a[_0x572755(0x6b7)], 'persona': _0x20e40a[_0x572755(0x824)] || _0x572755(0x950), 'memory': _0x93857f + _0x118bd4 + _0x499473 + _0x31171d }; } else _0x36a53f['getElementById'](_0x572755(0x5c9))[_0x572755(0x578)](_0x572755(0x4b3), async () => { _0xad2e16(_0x212f9e, _0x5a365d, !![]); }); }), _0x1bdef7 = 0x5, _0x541d0e = 0xc, _0x17d148 = _0x758b7d(0x5c3)[_0x758b7d(0x3ee)](), _0x2d238c = { 'instruction': ('\x0a-\x20你正在为一个名为“' + (_0x3a5e0d[_0x758b7d(0x6b7)] || '用户') + _0x758b7d(0xcb) + (_0x3a5e0d[_0x758b7d(0x6b7)] || '用户') + _0x758b7d(0x6e2) + _0x1bdef7 + '\x20到\x20' + _0x541d0e + '\x20之间。\x0a-\x20所有表情包名称【必须】从\x20`stickerList`\x20列表中选择，严禁使用列表之外的名称。\x0a-\x20角色之间需要有适当的互动,话题不应当完全围绕' + (_0x3a5e0d[_0x758b7d(0x6b7)] || '用户') + _0x758b7d(0x987) + _0x2a0a54 + '\x20\x0a' + _0x33cbeb + '\x0a' + _0x5b6f68 + _0x758b7d(0xa0e) + _0x350d65 + '\x0a')['trim'](), 'personas': _0x30cc5e, 'mentioned': _0x4db39f ? { 'id': _0x4db39f['id'], 'name': _0x4db39f[_0x758b7d(0x6b7)] } : null, 'stickerList': _0x3785fe }, _0x470830 = { 'type': _0x758b7d(0xa2d), 'properties': { 'events': { 'type': _0x758b7d(0x8c2), 'items': { 'type': 'object', 'required': ['senderId', _0x758b7d(0x3ac)], 'properties': { 'senderId': { 'type': _0x758b7d(0x9d1) }, 'kind': { 'type': _0x758b7d(0x9d1), 'enum': ['text', _0x758b7d(0x6c0), 'music'] }, 'content': { 'type': _0x758b7d(0x9d1) }, 'sticker': { 'type': 'string' }, 'songName': { 'type': 'string' }, 'artist': { 'type': _0x758b7d(0x9d1) } } } } }, 'required': ['events'] }, _0x46d0d9 = []; _0x46d0d9['push']({ 'role': _0x758b7d(0x11f), 'content': _0x17d148 }); for (const _0x4f53d1 of _0x140922) { const _0x3d5f77 = _0x4f53d1[_0x758b7d(0x34a)] === 'ai' || _0x4f53d1[_0x758b7d(0x34a)] === _0x758b7d(0x7f0) ? _0x758b7d(0x7f0) : _0x758b7d(0x27a); let _0x4d360c = { 'role': _0x3d5f77, 'content': _0x4f53d1['content'] }, _0x59cdf1 = !!_0x4f53d1['content'], _0x5b4031 = null; if (_0x4f53d1[_0x758b7d(0x1a2)]) _0x758b7d(0x61e) !== 'sqIRp' ? _0x5b4031 = _0x4f53d1[_0x758b7d(0x1a2)] : (_0x2b23cc(![]), _0x306a6e[_0x758b7d(0x6c4)][_0x758b7d(0xe5)] = ''); else { if (_0x4f53d1[_0x758b7d(0x35f)]) { if (_0x758b7d(0x652) === _0x758b7d(0x344)) _0xfad2b6[_0x758b7d(0x10d)][_0x758b7d(0x5eb)] = 'none', _0x542db3[_0x758b7d(0x248)](_0x758b7d(0xa93))[_0x758b7d(0x10d)][_0x758b7d(0x5eb)] = _0x758b7d(0x4ef); else try { const _0x3e3b67 = await _0x533d7a(_0x4f53d1[_0x758b7d(0x35f)]); _0x3e3b67 && (_0x5b4031 = await _0x3c4a4d(_0x3e3b67)); } catch (_0x5720e8) { console[_0x758b7d(0x729)](_0x758b7d(0x3e2), _0x5720e8); } } } _0x5b4031 && (_0x4d360c['image'] = _0x5b4031, _0x59cdf1 = !![]), _0x59cdf1 && _0x46d0d9['push'](_0x4d360c); } _0x46d0d9[_0x758b7d(0x36b)]({ 'role': 'user', 'content': _0x758b7d(0x307) + JSON[_0x758b7d(0x22e)](_0x470830) + _0x758b7d(0x588) + JSON[_0x758b7d(0x22e)](_0x2d238c) }); try { const _0x4b4e3a = await _0x2d63cb(_0x46d0d9, { 'json': !![] }); if (!_0x4b4e3a) return null; let _0xb68a4b = _0x4b4e3a[_0x758b7d(0x3ee)](); const _0x28d10b = _0xb68a4b[_0x758b7d(0x11d)](/```json([\s\S]*?)```/i); if (_0x28d10b) _0xb68a4b = _0x28d10b[0x1][_0x758b7d(0x3ee)](); _0xb68a4b = _0x1c040b(_0xb68a4b); let _0x11caec = null; try { _0x11caec = JSON[_0x758b7d(0x329)](_0xb68a4b); } catch (_0xb4fb1b) { console['error'](_0x758b7d(0x912), _0xb4fb1b), console[_0x758b7d(0x729)](_0x758b7d(0x66b), _0xb68a4b); } if (!_0x11caec || !Array[_0x758b7d(0x796)](_0x11caec[_0x758b7d(0x57f)])) return null; return _0x11caec = _0x411ca7(_0x11caec, _0x59da82, _0x3785fe), _0x11caec[_0x758b7d(0x57f)] = _0x11caec[_0x758b7d(0x57f)][_0x758b7d(0x53a)](0x0, _0x541d0e), _0x11caec[_0x758b7d(0x57f)][_0x758b7d(0x848)] ? _0x11caec : null; } catch (_0x440eed) { return _0x440eed['name'] !== _0x758b7d(0x885) && console[_0x758b7d(0x729)](_0x758b7d(0x6c7), _0x440eed), null; } } function _0x30c359() { const _0x59e702 = _0x1da6ac, _0x25d791 = document[_0x59e702(0x248)]('friend-circle-list-container'); _0x25d791[_0x59e702(0x9a1)] = ''; if (_0x10530c[_0x59e702(0x7b9)]['length'] === 0x0) { _0x25d791['innerHTML'] = _0x59e702(0x199); return; } _0x10530c[_0x59e702(0x7b9)]['forEach'](_0x61c07f => { const _0x45ca4e = _0x59e702, _0x2bcf9b = _0x10530c[_0x45ca4e(0x360)][_0x45ca4e(0x212)](_0xccb0b3 => _0xccb0b3['id'] === _0x61c07f[_0x45ca4e(0x2eb)]) || { 'name': _0x45ca4e(0x266) }, _0x2017ec = document['createElement']('div'); _0x2017ec[_0x45ca4e(0x296)] = _0x45ca4e(0x6be), _0x2017ec[_0x45ca4e(0xab1)]['id'] = _0x61c07f['id'], _0x2017ec[_0x45ca4e(0x9a1)] = _0x45ca4e(0x4ad) + _0x61c07f[_0x45ca4e(0x6b7)] + _0x45ca4e(0x149) + _0x2bcf9b[_0x45ca4e(0x6b7)] + _0x45ca4e(0x2a8) + _0x61c07f[_0x45ca4e(0x9ee)][_0x45ca4e(0x848)] + _0x45ca4e(0x918), _0x2017ec[_0x45ca4e(0x578)](_0x45ca4e(0x4b3), () => _0x5e41c4(_0x61c07f['id'])), _0x25d791[_0x45ca4e(0x6ab)](_0x2017ec); }); } async function _0x5c6160(_0x5ca3bb = null) { const _0x310e04 = _0x1da6ac; if ('uGfLw' !== _0x310e04(0x1ae)) { const _0x29baad = document[_0x310e04(0x248)](_0x310e04(0x105)), _0x1c7e21 = document[_0x310e04(0x248)](_0x310e04(0xce)), _0x1af08 = document[_0x310e04(0x248)](_0x310e04(0x95b)), _0x453fa0 = document[_0x310e04(0x248)](_0x310e04(0x953)), _0x55bb05 = document[_0x310e04(0x248)](_0x310e04(0x952)), _0x1ef683 = document['getElementById'](_0x310e04(0x99b)); _0xb18b1d(_0x310e04(0xce)), _0x1af08[_0x310e04(0x9a1)] = ''; for (const _0xfa4971 of _0x10530c[_0x310e04(0x620)]) { const _0x3bf767 = document[_0x310e04(0x3b9)](_0x310e04(0x6ff)); _0x3bf767[_0x310e04(0x296)] = _0x310e04(0x903); const _0x26c89b = await _0x533d7a(_0x310e04(0x583) + _0xfa4971['id']), _0x25d2bb = _0x26c89b ? URL[_0x310e04(0x73d)](_0x26c89b) : _0xfa4971[_0x310e04(0x917)] || _0x5da029; _0x3bf767['innerHTML'] = _0x310e04(0x5a9) + _0xfa4971['id'] + _0x310e04(0x6da) + _0xfa4971['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x25d2bb + _0x310e04(0x803) + _0xfa4971['id'] + _0x310e04(0x1ce) + _0xfa4971[_0x310e04(0x6b7)] + '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x1af08['appendChild'](_0x3bf767); } if (_0x5ca3bb) { if (_0x310e04(0x668) !== 'EHBWQ') _0x47ee28[_0x310e04(0x9a1)] = '', _0x302f80['forEach'](_0x12779d => { const _0x5e532a = _0x310e04, _0x4d75eb = _0x357167[_0x5e532a(0x3b9)]('div'); _0x4d75eb[_0x5e532a(0x9ac)] = _0x12779d, _0x4d75eb[_0x5e532a(0x578)]('click', () => { const _0x3ab09a = _0x5e532a; _0x42f39c[_0x3ab09a(0xe5)] = _0x12779d, _0x1bb2d0[_0x3ab09a(0x882)][_0x3ab09a(0xae0)](_0x3ab09a(0x11b)); }), _0x18697e[_0x5e532a(0x6ab)](_0x4d75eb); }), _0x5d7148[_0x310e04(0x882)][_0x310e04(0x7c3)](_0x310e04(0x11b)), _0x1e43d5(_0x310e04(0x717) + _0x5cd43a[_0x310e04(0x848)] + _0x310e04(0x1e9)); else { const _0x47e280 = _0x10530c[_0x310e04(0x7b9)]['find'](_0xff9736 => _0xff9736['id'] === _0x5ca3bb); if (!_0x47e280) return; _0x453fa0[_0x310e04(0x9ac)] = _0x310e04(0x8bd), _0x55bb05[_0x310e04(0xe5)] = _0x47e280['id'], _0x29baad[_0x310e04(0xe5)] = _0x47e280[_0x310e04(0x6b7)], _0x1c7e21['value'] = _0x47e280[_0x310e04(0x2eb)], _0x1ef683['style'][_0x310e04(0x5eb)] = 'block', _0x47e280['memberCharacterIds'][_0x310e04(0x986)](_0x50d450 => { const _0x75e587 = _0x310e04, _0x201cf4 = _0x1af08[_0x75e587(0x838)]('#member-select-' + _0x50d450); if (_0x201cf4) _0x201cf4[_0x75e587(0x38c)] = !![]; }); } } else _0x453fa0[_0x310e04(0x9ac)] = _0x310e04(0x9b6), _0x55bb05['value'] = '', _0x29baad['value'] = '好友圈\x20' + (_0x10530c[_0x310e04(0x7b9)]['length'] + 0x1), _0x1c7e21[_0x310e04(0xe5)] = _0x10530c['activeUserProfileId'], _0x1ef683[_0x310e04(0x10d)]['display'] = _0x310e04(0x3fe); _0x1c4afc(_0x310e04(0x22d), _0x310e04(0x6fc)); } else _0x582a2b['style'][_0x310e04(0x5eb)] = _0x310e04(0x92c), _0x272a98[_0x310e04(0x10d)][_0x310e04(0x5eb)] = _0x310e04(0x3fe); } function _0x2f6b53() { const _0x24cbb4 = _0x1da6ac, _0x30acb3 = document['getElementById']('editing-friend-circle-id')[_0x24cbb4(0xe5)], _0x47272a = document[_0x24cbb4(0x248)](_0x24cbb4(0x105))[_0x24cbb4(0xe5)]['trim'](), _0x5a0a4e = document[_0x24cbb4(0x248)](_0x24cbb4(0xce))[_0x24cbb4(0xe5)], _0x4a0335 = Array[_0x24cbb4(0x10f)](document[_0x24cbb4(0x20d)](_0x24cbb4(0x776)))[_0x24cbb4(0xa21)](_0x96521d => _0x96521d[_0x24cbb4(0xab1)]['id']); if (!_0x47272a) { if (_0x24cbb4(0x69c) !== 'mOeco') _0x74385f[_0x9ae36e] = _0x4e0c89[_0x24cbb4(0x329)](_0x5a5438); else { _0x3a6c86('好友圈名称不能为空！'); return; } } if (_0x4a0335[_0x24cbb4(0x848)] === 0x0) { _0x3a6c86(_0x24cbb4(0xa8f)); return; } if (_0x30acb3) { const _0xadbf9f = _0x10530c[_0x24cbb4(0x7b9)][_0x24cbb4(0x212)](_0x4c7118 => _0x4c7118['id'] === _0x30acb3); if (_0xadbf9f) { if (_0x24cbb4(0x317) !== _0x24cbb4(0x317)) { _0x258fd0(_0x24cbb4(0x7f3)); return; } else _0xadbf9f['name'] = _0x47272a, _0xadbf9f[_0x24cbb4(0x2eb)] = _0x5a0a4e, _0xadbf9f[_0x24cbb4(0x9ee)] = _0x4a0335; } } else { const _0x30a088 = { 'id': _0x24cbb4(0xac2) + Date[_0x24cbb4(0x7a8)](), 'name': _0x47272a, 'boundUserProfileId': _0x5a0a4e, 'memberCharacterIds': _0x4a0335, 'posts': [] }; _0x10530c[_0x24cbb4(0x7b9)][_0x24cbb4(0x36b)](_0x30a088); } _0x3e6d3a(), _0x3a6c86(_0x24cbb4(0x72c)), _0x30c359(), _0x1c4afc('friendCircleList', _0x24cbb4(0x22d)); } async function _0x378402() { const _0x207906 = _0x1da6ac, _0x5071a5 = document[_0x207906(0x248)](_0x207906(0x952))[_0x207906(0xe5)]; if (!_0x5071a5) return; const _0x3baf11 = await _0x52e7d6(_0x207906(0x361)); if (_0x3baf11) { _0x10530c[_0x207906(0x7b9)] = _0x10530c[_0x207906(0x7b9)][_0x207906(0x54e)](_0xd12408 => _0xd12408['id'] !== _0x5071a5); if (_0x10530c[_0x207906(0x301)] === _0x5071a5) { if (_0x207906(0x7b0) !== _0x207906(0x85a)) _0x10530c[_0x207906(0x301)] = null; else { const _0x12c1e6 = _0x1d3ca1[_0x207906(0x2c8)]((_0x59b4bf - _0x5a80a0) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x3ed35f += _0x207906(0x41f) + _0x12c1e6 + '\x20天没活动了。你生成的内容必须是全新的事件。\x0a'; } } _0x3e6d3a(), _0x3a6c86(_0x207906(0x143)), _0x30c359(), _0x1c4afc(_0x207906(0x6fc), _0x207906(0x22d)); } } function _0x5e41c4(_0x578987) { const _0x815fc8 = _0x1da6ac; if (_0x815fc8(0x479) === _0x815fc8(0x9fe)) _0x1b1612[_0x815fc8(0x578)](_0x815fc8(0x4b3), () => _0x197371[_0x815fc8(0x4b3)]()), _0x1689ff['addEventListener'](_0x815fc8(0x423), _0x54c2d6 => { const _0x235600 = _0x815fc8, _0xb79bf8 = _0x54c2d6['target'][_0x235600(0x5fc)][0x0]; if (!_0xb79bf8) return; try { const _0x426944 = _0x3a3525[_0x235600(0x73d)](_0xb79bf8); _0x59f155[_0x235600(0x10d)][_0x235600(0xad9)] = 'url(\x27' + _0x426944 + '\x27)'; } catch (_0x1061d4) { _0x4e84f0(_0x235600(0x631) + _0x1061d4['message']); } }); else { _0x9b6aa6(); const _0x1c44bb = _0x10530c[_0x815fc8(0x7b9)][_0x815fc8(0x212)](_0x2c532a => _0x2c532a['id'] === _0x578987); if (!_0x1c44bb) return; _0x10530c['activeFriendCircleId'] = _0x578987, _0x3e6d3a(), document[_0x815fc8(0x248)](_0x815fc8(0x829))[_0x815fc8(0x9ac)] = _0x1c44bb[_0x815fc8(0x6b7)], _0x291bef(), _0x1c4afc(_0x815fc8(0x868), 'friendCircleList'), _0x3d40f4(); } } function _0x575f9d() { const _0x43196d = _0x1da6ac; if ('HbvnL' === 'HbvnL') { if (!_0x10530c[_0x43196d(0x7b9)] || _0x10530c['friendCircles'][_0x43196d(0x848)] === 0x0) { console[_0x43196d(0x729)](_0x43196d(0x159)); return; } const _0x3472e3 = _0x10530c[_0x43196d(0x7b9)][0x0]; if (_0x3472e3[_0x43196d(0x9ee)][_0x43196d(0x848)] < 0x2) { console[_0x43196d(0x729)](_0x43196d(0x8c0) + _0x3472e3[_0x43196d(0x6b7)] + _0x43196d(0xa3b)); return; } const _0x236404 = { 'id': 'test_post_' + Date['now'](), 'authorType': _0x43196d(0x70d), 'authorId': _0x3472e3[_0x43196d(0x9ee)][0x0], 'content': _0x43196d(0x661), 'timestamp': Date[_0x43196d(0x7a8)](), 'likes': [_0x3472e3[_0x43196d(0x9ee)][0x1]], 'comments': [{ 'commentId': 'c_' + Date[_0x43196d(0x7a8)](), 'authorId': _0x3472e3[_0x43196d(0x9ee)][0x1], 'content': _0x43196d(0x6e1) }] }; _0x3472e3['posts'][_0x43196d(0x36b)](_0x236404), _0x3e6d3a(), console[_0x43196d(0x5e0)](_0x43196d(0x4ba) + _0x3472e3[_0x43196d(0x6b7)] + _0x43196d(0xfc)), _0x3a6c86('测试动态已添加！'); } else { _0x26a5f4[_0x43196d(0x9a1)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>'; return; } } window['addTestPost'] = _0x575f9d; function _0x30c603(_0x4173fa) { const _0x11b127 = _0x1da6ac; return _0x10530c['userProfiles'][_0x11b127(0x212)](_0x404ef4 => _0x404ef4['id'] === _0x4173fa); } function _0xbc2d1c(_0x4cae5b, _0x143ae1 = '正在处理...') { const _0x4b3d7b = _0x1da6ac, _0x48fb9c = document['getElementById'](_0x4b3d7b(0x723)); let _0x360bba = document['getElementById'](_0x4b3d7b(0x26c)); if (_0x4cae5b) !_0x360bba && (_0x360bba = document[_0x4b3d7b(0x3b9)](_0x4b3d7b(0x6ff)), _0x360bba['id'] = _0x4b3d7b(0x26c), _0x48fb9c[_0x4b3d7b(0x6ab)](_0x360bba)), _0x360bba['innerHTML'] = _0x4b3d7b(0x535) + _0x143ae1 + _0x4b3d7b(0x955), _0x360bba['style'][_0x4b3d7b(0x5eb)] = 'flex'; else { if (_0x360bba) { if (_0x4b3d7b(0x268) !== _0x4b3d7b(0x584)) _0x360bba[_0x4b3d7b(0x10d)][_0x4b3d7b(0x5eb)] = _0x4b3d7b(0x3fe); else { _0x520b71(_0x4b3d7b(0x306)); return; } } } } async function _0x1b8459() { const _0x3f4302 = _0x1da6ac, _0x4ef16b = _0x10530c[_0x3f4302(0x7b9)][_0x3f4302(0x212)](_0x21c03d => _0x21c03d['id'] === _0x10530c[_0x3f4302(0x301)]); if (!_0x4ef16b || _0x10530c['isGenerating']) return; _0xbc2d1c(!![], _0x3f4302(0x85c)), _0x10530c['isGenerating'] = !![]; try { if (_0x3f4302(0x3a6) !== _0x3f4302(0x13e)) { let _0xe49d8d = Date[_0x3f4302(0x7a8)](); _0x4ef16b[_0x3f4302(0x3d6)] && _0x4ef16b['posts'][_0x3f4302(0x848)] > 0x0 && (_0x3f4302(0x576) === _0x3f4302(0x807) ? _0x52b5b9[_0x3f4302(0x36b)](_0x36c8db) : _0xe49d8d = Math[_0x3f4302(0x21d)](..._0x4ef16b[_0x3f4302(0x3d6)][_0x3f4302(0xa21)](_0x483f31 => _0x483f31[_0x3f4302(0x908)]))); const _0xb559e6 = await _0x39cfcd(_0x4ef16b); if (!_0xb559e6 || _0xb559e6[_0x3f4302(0x848)] === 0x0) { _0x3a6c86(_0x3f4302(0x2d9)); return; } const _0x355f9d = _0xb559e6['map'](async (_0x4c52d0, _0x110fc0) => { const _0x39b27f = _0x3f4302; _0xbc2d1c(!![], _0x39b27f(0x594) + (_0x110fc0 + 0x1) + '\x20/\x20' + _0xb559e6[_0x39b27f(0x848)] + _0x39b27f(0x3a9)); const _0x27a9bb = _0xe49d8d + (_0x110fc0 + 0x1) * 0x3c * 0x3e8, _0x412f4d = { 'id': _0x39b27f(0x87c) + _0x4c52d0[_0x39b27f(0x5fa)] + '_' + _0x27a9bb, 'authorType': _0x39b27f(0x70d), 'authorId': _0x4c52d0[_0x39b27f(0x5fa)], 'content': _0x4c52d0[_0x39b27f(0x3cd)], 'timestamp': _0x27a9bb, 'likes': _0x4c52d0[_0x39b27f(0x372)] || [], 'comments': (_0x4c52d0['comments'] || [])[_0x39b27f(0xa21)]((_0x4f7ae0, _0x5398c8) => ({ 'commentId': 'c_' + _0x27a9bb + '_' + _0x5398c8, 'authorId': _0x4f7ae0['authorId'], 'content': _0x4f7ae0['content'] })) }; if (_0x4c52d0[_0x39b27f(0x58b)] === _0x39b27f(0x868) && _0x4c52d0[_0x39b27f(0x6d2)] && _0x4c52d0[_0x39b27f(0x755)]) try { const _0xec4cbf = await _0x57d1c9(_0x4c52d0[_0x39b27f(0x6d2)], _0x4c52d0[_0x39b27f(0x755)]); _0x412f4d[_0x39b27f(0xa78)] = _0x39b27f(0x868), _0x412f4d[_0x39b27f(0x6d2)] = _0x4c52d0[_0x39b27f(0x6d2)], _0x412f4d['artist'] = _0x4c52d0['artist'], _0x412f4d[_0x39b27f(0x2ab)] = _0xec4cbf['cover'], _0x412f4d[_0x39b27f(0x5e3)] = _0xec4cbf[_0x39b27f(0x83a)]; } catch (_0x2e10ec) { _0x39b27f(0x408) !== 'dDsPO' ? (_0x1a6496[_0x39b27f(0x3d6)] = [], _0x92fd39(), _0x119457(), _0x1c4378(_0x39b27f(0x4f2))) : (console[_0x39b27f(0x729)]('动态中的音乐搜索失败:', _0x2e10ec), _0x412f4d[_0x39b27f(0xa78)] = _0x39b27f(0x958)); } else _0x412f4d['type'] = _0x39b27f(0x958); return _0x412f4d; }), _0x38c636 = await Promise[_0x3f4302(0x63b)](_0x355f9d); _0x4ef16b['posts'][_0x3f4302(0x36b)](..._0x38c636), _0x3e6d3a(); } else _0x2176a5[_0x3f4302(0x729)](_0x3f4302(0x3c2), _0x1dfd0b); } catch (_0x39bab3) { console[_0x3f4302(0x729)]('生成动态失败:', _0x39bab3), _0x3a6c86(_0x3f4302(0x2ee) + _0x39bab3[_0x3f4302(0x380)]); } finally { _0x291bef(), _0xbc2d1c(![]), _0x10530c[_0x3f4302(0xa4a)] = ![]; } } async function _0x39cfcd(_0xdd9bed) { const _0x26303c = _0x1da6ac; if (_0x26303c(0x9d0) === _0x26303c(0x331)) _0x589c61 += _0x26303c(0x2bd); else { const _0x101254 = _0xdd9bed['memberCharacterIds'][_0x26303c(0xa21)](_0x33b165 => _0x5b19fc(_0x33b165))[_0x26303c(0x54e)](Boolean); if (_0x101254[_0x26303c(0x848)] === 0x0) return null; const _0x1ccd27 = _0x538f71(), _0x37b65a = _0x30c603(_0xdd9bed['boundUserProfileId']) || _0x10530c['userProfiles'][0x0], _0x1fe11d = _0x37b65a ? _0x26303c(0x609) + _0x37b65a['name'] + _0x26303c(0x844) + (_0x37b65a['persona'] || '无') + '\x0a' : '', _0x11ba0c = _0x101254['map'](_0x4b9b2b => { const _0x4ccd94 = _0x26303c; if (_0x4ccd94(0x190) === _0x4ccd94(0x642)) _0x42946a[_0x4ccd94(0x7e4)] = _0x2de152; else { const { omniText: _0x386981 } = _0x3b8ffa(_0x4b9b2b['id'], null), _0x2b6c30 = _0x38a670(_0x4b9b2b['id']), _0x4d6629 = _0x4b9b2b['linkedWorldBookIds'] && _0x4b9b2b[_0x4ccd94(0x7e0)][_0x4ccd94(0x848)] > 0x0 ? '\x0a\x0a#\x20' + _0x4b9b2b[_0x4ccd94(0x6b7)] + '的个人专属世界观设定\x0a' + _0x4b9b2b[_0x4ccd94(0x7e0)][_0x4ccd94(0xa21)](_0x436c26 => _0x10530c['worldBooks'][_0x4ccd94(0x212)](_0x2f8b91 => _0x2f8b91['id'] === _0x436c26))[_0x4ccd94(0x54e)](Boolean)[_0x4ccd94(0xa21)](_0x14c427 => _0x4ccd94(0x9c1) + _0x14c427[_0x4ccd94(0x6b7)] + '\x0a' + _0x14c427['content'])[_0x4ccd94(0x64e)]('') : ''; return '-\x20姓名:\x20' + _0x4b9b2b[_0x4ccd94(0x6b7)] + ',\x20ID:\x20' + _0x4b9b2b['id'] + _0x4ccd94(0x6f4) + _0x4b9b2b['persona'] + _0x4ccd94(0x65d) + _0x386981 + '\x0a' + _0x2b6c30 + '\x0a' + _0x4d6629; } })[_0x26303c(0x64e)]('\x0a\x0a'), _0x12ae26 = Math[_0x26303c(0x703)](Math['random']() * 0x3) + 0x2, _0x1b2125 = '\x0a#\x20核心任务\x0a你是一个顶级多角色社交模拟引擎。你的任务是模拟一个好友圈的动态更新，一次性生成【' + _0x12ae26 + _0x26303c(0x9a5) + _0x11ba0c + '\x0a' + _0x1fe11d + '\x0a#\x20最近的动态回顾\x20(供参考，避免重复)\x0a' + _0x1ccd27 + _0x26303c(0x2ed) + _0x12ae26 + '条新动态挑选发布者。你可以让同一个人发布多次，也可以让不同人发布。\x0a3.\x20\x20**创作动态**:\x20扮演你选中的作者，创作符合其人设和记忆的动态内容。可以是文字或分享音乐。\x0a4.\x20\x20**模拟互动**:\x20为每一条你创作的动态，切换视角到【圈内其他成员】，模拟他们可能做出的点赞和评论。互动必须符合他们各自的性格。\x0a\x0a#\x20输出格式【绝对规则】\x0a-\x20你的输出**必须**是一个语法完全正确的、单一的JSON数组，包含\x20' + _0x12ae26 + '个帖子对象。\x0a-\x20**【ID规则】**:\x20所有\x20\x22authorId\x22,\x20\x22likes\x22,\x20\x22comments\x22\x20中的作者标识，【必须】使用上面提供的角色\x20**ID**，绝对不能使用角色名字。\x0a-\x20**【JSON结构】**:\x20每个帖子对象必须遵循以下结构：\x0a\x20\x20```json\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22authorId\x22:\x20\x22发布者的ID\x22,\x0a\x20\x20\x20\x20\x22postType\x22:\x20\x22text\x20or\x20music\x22,\x0a\x20\x20\x20\x20\x22postContent\x22:\x20\x22动态的文字内容\x22,\x0a\x20\x20\x20\x20\x22songName\x22:\x20\x22如果是music类型，则必须有歌名\x22,\x0a\x20\x20\x20\x20\x22artist\x22:\x20\x22如果是music类型，则必须有歌手名\x22,\x0a\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20}\x0a\x20\x20```\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', _0x9adf71 = [{ 'role': _0x26303c(0x11f), 'content': _0x1b2125 }, { 'role': 'user', 'content': _0x26303c(0x7f4) }]; _0x9adf71[_0x26303c(0x36b)]({ 'role': _0x26303c(0x27a), 'content': _0x26303c(0xde) + _0x12ae26 + _0x26303c(0xae8) }); try { if (_0x26303c(0x4c2) !== 'kTLXr') return _0x3da1d7['userProfiles']['find'](_0x8cc78b => _0x8cc78b['id'] === _0x2d3d4d[_0x26303c(0x663)]) || _0x1c6fb8['userProfiles'][0x0]; else { const _0x352d54 = await _0x2d63cb(_0x9adf71, { 'json': !![] }), _0x485aee = _0x352d54[_0x26303c(0x11d)](/(\[[\s\S]*\])/); if (!_0x485aee) throw new Error(_0x26303c(0x785)); const _0x44163e = _0x485aee[0x1], _0xf79a5a = JSON[_0x26303c(0x329)](_0x44163e); if (!Array['isArray'](_0xf79a5a)) throw new Error('AI返回的不是一个数组。'); return _0xf79a5a; } } catch (_0x2ac0ab) { if (_0x26303c(0x4c1) === _0x26303c(0x9eb)) { _0x3fa334['value'] = ''; return; } else return console['error']('批量生成动态失败:\x20', _0x2ac0ab), console[_0x26303c(0x729)](_0x26303c(0xadf), _0x2ac0ab['rawResponse'] || 'AI返回了无法解析的文本'), null; } } } async function _0x4eb41b() { const _0x2584f1 = _0x1da6ac, _0x37af54 = _0x10530c[_0x2584f1(0x7b9)][_0x2584f1(0x212)](_0x74b7f9 => _0x74b7f9['id'] === _0x10530c[_0x2584f1(0x301)]); if (!_0x37af54) return; const _0x264d55 = await _0x52e7d6(_0x2584f1(0x133) + _0x37af54[_0x2584f1(0x6b7)] + _0x2584f1(0x59b)); _0x264d55 && (_0x37af54['posts'] = [], _0x3e6d3a(), _0x291bef(), _0x3a6c86(_0x2584f1(0x4f2))); } async function _0x291bef() { const _0x5cb618 = _0x1da6ac, _0x558c17 = document[_0x5cb618(0x248)]('music-feed-container'), _0xf79687 = _0x10530c['friendCircles'][_0x5cb618(0x212)](_0x729052 => _0x729052['id'] === _0x10530c[_0x5cb618(0x301)]); if (!_0xf79687) { _0x558c17[_0x5cb618(0x9a1)] = _0x5cb618(0xa7b); return; } if (!_0xf79687[_0x5cb618(0x3d6)] || _0xf79687[_0x5cb618(0x3d6)][_0x5cb618(0x848)] === 0x0) { _0x558c17[_0x5cb618(0x9a1)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>'; return; } _0x558c17[_0x5cb618(0x9a1)] = ''; const _0x176926 = [..._0xf79687['posts']][_0x5cb618(0xaa6)]((_0x177333, _0x628436) => _0x628436['timestamp'] - _0x177333[_0x5cb618(0x908)]); for (const _0x3a4cab of _0x176926) { if ('SsZgn' === _0x5cb618(0xaa7)) _0x5e6b44 = _0xe14818[_0x5cb618(0xe5)]; else { const _0x45e4eb = document[_0x5cb618(0x3b9)](_0x5cb618(0x6ff)); _0x45e4eb[_0x5cb618(0x296)] = _0x5cb618(0x433); let _0x1d6daf = '未知', _0x2754e3 = _0x5da029; if (_0x3a4cab['authorType'] === _0x5cb618(0x27a)) { const _0x495234 = _0x30c603(_0x3a4cab[_0x5cb618(0x5fa)]); _0x495234 && (_0x1d6daf = _0x495234[_0x5cb618(0x6b7)], _0x2754e3 = _0x495234[_0x5cb618(0x917)]); } else { const _0x2f5d52 = _0x5b19fc(_0x3a4cab[_0x5cb618(0x5fa)]); if (_0x2f5d52) { _0x1d6daf = _0x2f5d52['name']; const _0x25b905 = await _0x533d7a('char_avatar_' + _0x2f5d52['id']); _0x2754e3 = _0x25b905 ? URL[_0x5cb618(0x73d)](_0x25b905) : _0x2f5d52['avatar'] || _0x5da029; } } const _0x22e8b5 = _0x5cb618(0xad3) + _0x2754e3 + _0x5cb618(0x999) + _0x1d6daf + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x19bfde = '<p\x20class=\x22music-post-thought\x22>' + _0x3a4cab[_0x5cb618(0x9a8)] + _0x5cb618(0x80b); let _0x54c786 = ''; if (_0x3a4cab[_0x5cb618(0x1a2)] || _0x3a4cab[_0x5cb618(0x35f)]) { if (_0x5cb618(0x9e4) === _0x5cb618(0x9e4)) { const _0x4e3325 = _0x5cb618(0x8ae) + _0x3a4cab['id']; _0x54c786 = '<div\x20class=\x22post-image-container\x22><img\x20id=\x22' + _0x4e3325 + _0x5cb618(0x654), setTimeout(() => { const _0x3aa6e8 = _0x5cb618, _0x327850 = document[_0x3aa6e8(0x248)](_0x4e3325); if (!_0x327850) return; if (_0x3a4cab['image']) _0x327850[_0x3aa6e8(0x70a)] = _0x3a4cab['image']; else _0x3a4cab[_0x3aa6e8(0x35f)] && _0x533d7a(_0x3a4cab[_0x3aa6e8(0x35f)])['then'](_0x29bd8b => { const _0x2f38ad = _0x3aa6e8; if (_0x29bd8b) { const _0x3bc4da = URL[_0x2f38ad(0x73d)](_0x29bd8b); _0x327850[_0x2f38ad(0x70a)] = _0x3bc4da, _0x327850[_0x2f38ad(0x744)] = () => URL[_0x2f38ad(0x8df)](_0x3bc4da); } }); }, 0x0); } else _0x535e58[_0x5cb618(0x9ac)] = _0x3960b1[_0x5cb618(0x6b7)] || _0x5cb618(0x48e) + _0x267321[_0x5cb618(0x26f)]['length'] + ')'; } let _0x20c297 = ''; _0x3a4cab[_0x5cb618(0xa78)] === _0x5cb618(0x868) && _0x3a4cab[_0x5cb618(0x6d2)] && (_0x20c297 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22' + _0x3a4cab['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x3a4cab['coverUrl'] || _0x5da029) + _0x5cb618(0x21c) + _0x3a4cab[_0x5cb618(0x6d2)] + _0x5cb618(0x168) + _0x3a4cab[_0x5cb618(0x755)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>' + (_0x3a4cab[_0x5cb618(0x5e3)] ? '▶' : '⚠') + _0x5cb618(0x1ad)); const _0x460d57 = _0x5cb618(0x2ce) + new Date(_0x3a4cab[_0x5cb618(0x908)])[_0x5cb618(0x446)](_0x5cb618(0x89f)) + _0x5cb618(0x489); let _0x5c0cdb = ''; if (_0x3a4cab['likes'] && _0x3a4cab[_0x5cb618(0x372)]['length'] > 0x0 || _0x3a4cab[_0x5cb618(0xa0d)] && _0x3a4cab['comments'][_0x5cb618(0x848)] > 0x0) { let _0x5ec378 = ''; if (_0x3a4cab[_0x5cb618(0x372)] && _0x3a4cab[_0x5cb618(0x372)][_0x5cb618(0x848)] > 0x0) { const _0x598487 = _0x3a4cab[_0x5cb618(0x372)]['map'](_0x27c632 => _0x5b19fc(_0x27c632)?.[_0x5cb618(0x6b7)] || '未知')['join']('、'), _0x27a6f7 = _0x5cb618(0x5b5); _0x5ec378 = _0x5cb618(0xa23) + _0x27a6f7 + '\x20' + _0x598487 + _0x5cb618(0x489); } let _0x18e837 = ''; if (_0x3a4cab[_0x5cb618(0xa0d)] && _0x3a4cab[_0x5cb618(0xa0d)]['length'] > 0x0) { const _0x52bb8f = _0x3a4cab['comments']['map'](_0x1043f0 => { const _0x4f1264 = _0x5cb618; if (_0x4f1264(0x68e) === 'pwDhH') { const _0x32578c = _0x5b19fc(_0x1043f0[_0x4f1264(0x5fa)])?.[_0x4f1264(0x6b7)] || '未知'; return _0x4f1264(0x1e2) + _0x32578c + _0x4f1264(0x858) + _0x1043f0[_0x4f1264(0x9a8)] + _0x4f1264(0x489); } else _0x1ad4af(![]); })[_0x5cb618(0x64e)](''); _0x18e837 = _0x5cb618(0x3da) + _0x52bb8f + _0x5cb618(0x489); } _0x5c0cdb = _0x5cb618(0x52b) + _0x5ec378 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x18e837 + _0x5cb618(0x471); } const _0x82c971 = '<div\x20class=\x22post-body\x22>' + _0x19bfde + _0x54c786 + _0x20c297 + _0x5cb618(0x489); _0x45e4eb['innerHTML'] = _0x22e8b5 + _0x82c971 + _0x460d57 + _0x5c0cdb; if (_0x3a4cab['type'] === 'music' && _0x3a4cab[_0x5cb618(0x5e3)]) { if (_0x5cb618(0x837) !== _0x5cb618(0x837)) { const _0x3063f2 = _0x62effb[_0x5cb618(0x3b9)](_0x5cb618(0x6ff)); _0x3063f2[_0x5cb618(0x296)] = 'world-book-item', _0x3063f2[_0x5cb618(0xab1)]['id'] = _0x8b601e['id']; const _0x896b0a = _0x4636de['id'] === _0x154ed5[_0x5cb618(0x663)] ? _0x5cb618(0xa3e) : ''; _0x3063f2['innerHTML'] = _0x5cb618(0x19e) + (_0x17018c[_0x5cb618(0x917)] || _0x5c14c3) + '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x2a7817[_0x5cb618(0x6b7)] + _0x896b0a + _0x5cb618(0x7c6) + _0x124fbf[_0x5cb618(0x824)]['substring'](0x0, 0x64) + _0x5cb618(0x8e3), _0x3063f2[_0x5cb618(0x578)]('click', () => _0x3f9d4a(_0x4e252b['id'])), _0x10872e['appendChild'](_0x3063f2); } else { const _0x5e7e44 = _0x45e4eb['querySelector'](_0x5cb618(0xf9)); _0x5e7e44 && (_0x5cb618(0xa53) === 'BtpSK' ? _0x5e7e44[_0x5cb618(0x578)](_0x5cb618(0x4b3), function () { const _0x4bfa95 = _0x5cb618; if (_0x4bfa95(0x91c) !== _0x4bfa95(0x91c)) _0x2b6189[_0x4bfa95(0x10d)][_0x4bfa95(0x5eb)] = _0x4bfa95(0x3fe); else { const _0x1a991e = { 'id': _0x3a4cab['id'], 'url': _0x3a4cab[_0x4bfa95(0x5e3)] }; _0xb9b242(this, _0x1a991e); } }) : _0x315e14[_0x5cb618(0x6ab)](_0x46007c)); } } _0x558c17[_0x5cb618(0x6ab)](_0x45e4eb); } } } document[_0x1da6ac(0x248)](_0x1da6ac(0x802))['addEventListener'](_0x1da6ac(0x4b3), _0x4eb41b), document[_0x1da6ac(0x248)]('refresh-feed-button')[_0x1da6ac(0x578)]('click', _0x1b8459), document['getElementById'](_0x1da6ac(0x5fd))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => _0x1c4afc(_0x1da6ac(0x362), _0x1da6ac(0x6fc))), document[_0x1da6ac(0x248)]('add-friend-circle-button')[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), async () => await _0x5c6160()), document[_0x1da6ac(0x248)](_0x1da6ac(0x64c))['addEventListener'](_0x1da6ac(0x4b3), () => _0x1c4afc(_0x1da6ac(0x6fc), _0x1da6ac(0x22d))), document[_0x1da6ac(0x248)](_0x1da6ac(0x5de))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x2f6b53), document[_0x1da6ac(0x248)]('delete-friend-circle-button')['addEventListener'](_0x1da6ac(0x4b3), _0x378402), document[_0x1da6ac(0x248)](_0x1da6ac(0x358))[_0x1da6ac(0x578)]('click', () => { const _0x38b49e = _0x1da6ac; _0x30c359(), _0x1c4afc(_0x38b49e(0x6fc), _0x38b49e(0x868)); }), document[_0x1da6ac(0x248)](_0x1da6ac(0x3db))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), async () => { const _0x191710 = _0x1da6ac; _0x191710(0x992) === _0x191710(0x4fb) ? _0x284614[_0x191710(0x729)]('Failed\x20to\x20read\x20history\x20for\x20chat\x20' + _0x247dc5[_0x191710(0x16e)], _0x4d78e0) : _0x10530c['activeFriendCircleId'] && await _0x5c6160(_0x10530c[_0x191710(0x301)]); }), document[_0x1da6ac(0x248)]('user-send-post-button')['addEventListener'](_0x1da6ac(0x4b3), async () => { const _0x15eb95 = _0x1da6ac, _0x5b3680 = _0x10530c[_0x15eb95(0x7b9)]['find'](_0x369d05 => _0x369d05['id'] === _0x10530c['activeFriendCircleId']); if (!_0x5b3680 || _0x10530c[_0x15eb95(0xa4a)]) return; const _0x9f0048 = _0x5b3680[_0x15eb95(0x2eb)], _0x337fd9 = _0x10530c[_0x15eb95(0x360)][_0x15eb95(0x212)](_0x446a62 => _0x446a62['id'] === _0x9f0048); if (!_0x337fd9) { if ('VwqmM' !== _0x15eb95(0x238)) { _0x435fab[_0x15eb95(0x9a1)] = _0x15eb95(0x75a); return; } else { _0x3a6c86('错误：找不到此好友圈绑定的用户！'); return; } } const _0x4f3066 = document[_0x15eb95(0x248)]('user-post-textarea')[_0x15eb95(0xe5)][_0x15eb95(0x3ee)](), _0x820e57 = _0x10530c[_0x15eb95(0x8bb)]['image'], _0x3edd40 = _0x10530c[_0x15eb95(0x8bb)][_0x15eb95(0x868)], _0x533f5e = _0x10530c[_0x15eb95(0x8bb)][_0x15eb95(0x35f)]; if (!_0x4f3066 && !_0x820e57 && !_0x3edd40) { _0x3a6c86(_0x15eb95(0x7f3)); return; } const _0x556523 = { 'id': _0x15eb95(0x4ea) + Date[_0x15eb95(0x7a8)](), 'authorType': _0x15eb95(0x27a), 'authorId': _0x337fd9['id'], 'content': _0x4f3066, 'timestamp': Date[_0x15eb95(0x7a8)](), 'likes': [], 'comments': [] }; if (_0x533f5e) _0x556523['imageId'] = _0x533f5e; else _0x820e57 && (_0x556523[_0x15eb95(0x1a2)] = _0x820e57); _0x3edd40 ? 'FoPqA' === _0x15eb95(0x3ad) ? (_0x21f12a[_0x15eb95(0x729)](_0x15eb95(0x45b), _0x5c64ba), _0x29aacb(_0x15eb95(0x60e) + _0x2d94c0[_0x15eb95(0x380)])) : (_0x556523[_0x15eb95(0xa78)] = _0x15eb95(0x868), Object[_0x15eb95(0x895)](_0x556523, _0x3edd40)) : _0x556523[_0x15eb95(0xa78)] = 'text', _0x5b3680[_0x15eb95(0x3d6)][_0x15eb95(0x36b)](_0x556523), _0x3e6d3a(), _0x291bef(), document[_0x15eb95(0x248)]('user-post-textarea')['value'] = '', _0x10530c['pendingPostAttachments'][_0x15eb95(0x1a2)] = null, _0x10530c[_0x15eb95(0x8bb)]['music'] = null, _0x10530c[_0x15eb95(0x8bb)][_0x15eb95(0x35f)] = null, _0x559a3e(), _0x42e85c(_0x556523); }), document['getElementById'](_0x1da6ac(0x499))['addEventListener'](_0x1da6ac(0x4b3), () => { const _0x109e61 = _0x1da6ac; document['getElementById'](_0x109e61(0x88a))[_0x109e61(0x4b3)](); }), document[_0x1da6ac(0x248)](_0x1da6ac(0x88a))[_0x1da6ac(0x578)](_0x1da6ac(0x423), async _0x48851e => { const _0x2a13d4 = _0x1da6ac; if (_0x2a13d4(0x886) !== _0x2a13d4(0x886)) try { const _0x508fb2 = _0x7f7732[_0x2a13d4(0x329)](_0x4a81ea[_0x2a13d4(0x915)](_0x2a13d4(0x507)) || '{}'), _0x4925de = { ..._0x508fb2, ..._0x15746d }; _0x18898c['setItem']('badgeState', _0x19d2f3['stringify'](_0x4925de)); } catch (_0x2fd442) { _0x2051a3['error'](_0x2a13d4(0x5c6), _0x2fd442); } else { const _0x730312 = _0x48851e[_0x2a13d4(0x6c4)][_0x2a13d4(0x5fc)][0x0]; if (!_0x730312) return; try { const _0x497598 = await _0xa06749(_0x730312, 0x320, 0.8, !![]), _0xf7fb72 = 'post_image_' + Date[_0x2a13d4(0x7a8)](); await _0x5ef29b(_0xf7fb72, _0x497598), _0x10530c[_0x2a13d4(0x8bb)][_0x2a13d4(0x35f)] = _0xf7fb72, _0x10530c[_0x2a13d4(0x8bb)][_0x2a13d4(0x1a2)] = null, _0x10530c[_0x2a13d4(0x8bb)][_0x2a13d4(0x868)] = null, _0x559a3e(); } catch (_0x4af79a) { if (_0x2a13d4(0xa79) === _0x2a13d4(0xac8)) { _0x58a5af[_0x2a13d4(0x5e0)](_0x2a13d4(0x217)); return; } else _0x3a6c86('图片处理失败:\x20' + _0x4af79a[_0x2a13d4(0x380)]); } _0x48851e[_0x2a13d4(0x6c4)][_0x2a13d4(0xe5)] = ''; } }), document[_0x1da6ac(0x248)]('user-post-music-button')['addEventListener']('click', async () => { const _0x57d94e = _0x1da6ac; if ('zkBjP' !== _0x57d94e(0xa2b)) { const _0x55ea0d = await _0x2329d7(); if (!_0x55ea0d) return; _0x3a6c86(_0x57d94e(0x701)); try { const _0x425704 = await _0x57d1c9(_0x55ea0d[_0x57d94e(0x6d2)], _0x55ea0d[_0x57d94e(0x755)]); _0x10530c[_0x57d94e(0x8bb)][_0x57d94e(0x868)] = { 'songName': _0x55ea0d[_0x57d94e(0x6d2)], 'artist': _0x55ea0d[_0x57d94e(0x755)], 'coverUrl': _0x425704['cover'], 'playableUrl': _0x425704[_0x57d94e(0x83a)] }, _0x10530c[_0x57d94e(0x8bb)][_0x57d94e(0x1a2)] = null, _0x559a3e(); } catch (_0x1bbece) { _0x3a6c86(_0x57d94e(0x91b) + _0x1bbece['message']); } } else _0x1ae4a4 += '-\x20**状态提示**:\x20你和Ta上次聊天是在昨天，注意你发言的时间感。\x0a'; }); function _0x46a9cb() { const _0xab3d52 = _0x1da6ac; if (_0xab3d52(0x29e) !== 'isFAV') { const _0x41ed18 = new Date(), _0x45bf18 = document['getElementById'](_0xab3d52(0x4a8)), _0x54ef9c = document['getElementById']('home-date'); if (_0x45bf18 && _0x54ef9c) { const _0x225594 = String(_0x41ed18[_0xab3d52(0x223)]())[_0xab3d52(0x1db)](0x2, '0'), _0x22a286 = String(_0x41ed18[_0xab3d52(0xabe)]())[_0xab3d52(0x1db)](0x2, '0'); _0x45bf18[_0xab3d52(0x9ac)] = _0x225594 + ':' + _0x22a286; const _0x397401 = _0x41ed18[_0xab3d52(0xa84)]() + 0x1, _0x1d3cae = _0x41ed18[_0xab3d52(0x208)](), _0x26bbba = [_0xab3d52(0x905), _0xab3d52(0x9a6), _0xab3d52(0xa90), _0xab3d52(0x50f), _0xab3d52(0x9f1), _0xab3d52(0x2c5), '星期六'][_0x41ed18[_0xab3d52(0x381)]()]; _0x54ef9c[_0xab3d52(0x9ac)] = _0x397401 + '月' + _0x1d3cae + '日\x20' + _0x26bbba; } } else _0x31fc4b[_0xab3d52(0x663)] = _0x2c223f, _0xaa9ced(), _0x28cf10('已设为当前用户！'), _0x590f54(), _0x52a0fd[_0xab3d52(0x248)](_0xab3d52(0x24c))[_0xab3d52(0x10d)][_0xab3d52(0x5eb)] = 'none'; } function _0x541048(_0x590801) { const _0x36c1eb = _0x1da6ac; if (_0x36c1eb(0x34c) === _0x36c1eb(0x34c)) { if (!_0x590801) return ''; const _0x2a07a0 = new Date(_0x590801), _0x4185e4 = String(_0x2a07a0['getHours']())[_0x36c1eb(0x1db)](0x2, '0'), _0xb9504 = String(_0x2a07a0[_0x36c1eb(0xabe)]())[_0x36c1eb(0x1db)](0x2, '0'); return _0x4185e4 + ':' + _0xb9504; } else _0x3abc03 !== _0x239a3f[_0x36c1eb(0x838)](_0x36c1eb(0x41b)) && (_0x450452[_0x36c1eb(0x9ac)] = '▶'); } function _0x538f71() { const _0xd1326 = _0x1da6ac, _0x42c8e3 = _0x10530c[_0xd1326(0x7b9)]['find'](_0x528666 => _0x528666['id'] === _0x10530c[_0xd1326(0x301)]), _0x2ba588 = _0x42c8e3 ? _0x42c8e3['posts'] : []; if (!_0x2ba588 || _0x2ba588[_0xd1326(0x848)] === 0x0) { if (_0xd1326(0x84c) === 'sREeh') _0x4fdfbf[_0xd1326(0x40d)] = _0x94250e['scrollHeight']; else return ''; } const _0x4ba50b = _0x2ba588['slice'](0x0, 0x5), _0x2194ee = _0x4ba50b[_0xd1326(0xa21)](_0x3741c1 => { const _0x589cfa = _0xd1326, _0xb3a0f2 = _0x5b19fc(_0x3741c1[_0x589cfa(0x5fa)]) || { 'name': '未知' }; let _0x27e0d6 = _0x589cfa(0x520) + _0xb3a0f2['name'] + _0x589cfa(0xa5b) + (_0x3741c1['thought'] || _0x3741c1['content']) + '”'; return _0x3741c1[_0x589cfa(0xa78)] === _0x589cfa(0x868) && ('jQzIa' === _0x589cfa(0x46c) ? _0x27e0d6 += _0x589cfa(0x3d5) + _0x3741c1[_0x589cfa(0x6d2)] + '\x20-\x20' + _0x3741c1['artist'] + ')' : (_0x4a5b50[_0x589cfa(0xa4a)] && _0x1d1475['currentAbortController'] && (_0x4acc25[_0x589cfa(0x5e0)](_0x589cfa(0xa88)), _0x42398b[_0x589cfa(0x557)]['abort'](_0x589cfa(0x3fd)), _0x2f3536['currentAbortController'] = null), _0x597760[_0x589cfa(0xa4a)] = ![], _0x1b55ad(![]))), _0x27e0d6; }); return _0xd1326(0x45e) + _0x2194ee[_0xd1326(0x64e)]('\x0a'); } function _0x38a670(_0x5cc39b) { const _0x31cdb4 = _0x1da6ac; if (_0x31cdb4(0x39c) === _0x31cdb4(0x39c)) { const _0x506b8e = _0x10530c['userProfiles'][_0x31cdb4(0x212)](_0x4af535 => _0x4af535['id'] === _0x10530c[_0x31cdb4(0x663)]) || { 'name': '你' }, _0x2eb170 = _0x10530c['diaries']['find'](_0x39b438 => _0x39b438[_0x31cdb4(0x542)] === _0x5cc39b); if (!_0x2eb170 || !_0x2eb170[_0x31cdb4(0x17b)] || _0x2eb170[_0x31cdb4(0x17b)][_0x31cdb4(0x848)] === 0x0) return ''; const _0x1ad6ef = _0x2eb170[_0x31cdb4(0x17b)]['slice'](-0x8), _0x479acc = _0x1ad6ef[_0x31cdb4(0xa21)](_0x302526 => { const _0x159bff = _0x31cdb4; if (_0x159bff(0x292) === 'BLmTW') { const _0x518b7b = _0x302526[_0x159bff(0xe8)] === _0x159bff(0x27a) ? _0x506b8e['name'] : _0x5b19fc(_0x302526[_0x159bff(0xe8)])[_0x159bff(0x6b7)]; return '-\x20[' + new Date(_0x302526[_0x159bff(0x908)])[_0x159bff(0x2d8)]() + ']\x20' + _0x518b7b + _0x159bff(0x3bb) + _0x302526[_0x159bff(0x9a8)]; } else _0x539b30['log'](_0x159bff(0x458)), _0x3d2a1a[_0x159bff(0x9e0)]('appState', _0x34c185['stringify'](_0x186899)); })[_0x31cdb4(0x64e)]('\x0a'); return _0x31cdb4(0x324) + _0x506b8e[_0x31cdb4(0x6b7)] + _0x31cdb4(0x605) + _0x479acc; } else { const _0x11157 = _0x2ebc50(_0x4beb6a['activeMeetingCharId']); if (!_0x11157) return; _0x3b5497 = !![], _0x16bb8d[_0x31cdb4(0x10d)][_0x31cdb4(0x5eb)] = _0x31cdb4(0x92c); const _0x5453cf = _0x11157[_0x31cdb4(0x7da)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; _0x10c9b8['getElementById'](_0x31cdb4(0xa57))['value'] = _0x5453cf['x'], _0x29d6d7[_0x31cdb4(0x248)](_0x31cdb4(0x44e))[_0x31cdb4(0xe5)] = _0x5453cf['y'], _0x250cfe[_0x31cdb4(0x248)](_0x31cdb4(0x4d5))[_0x31cdb4(0xe5)] = _0x5453cf['scale'] * 0x64, _0x11bfd8 = { ..._0x5453cf }, _0x308b5b[_0x31cdb4(0x248)](_0x31cdb4(0x8a9))[_0x31cdb4(0x10d)][_0x31cdb4(0x5eb)] = _0x31cdb4(0x3fe), _0xc456ff[_0x31cdb4(0x248)]('galgame-sprite-adjust-ui')['style'][_0x31cdb4(0x5eb)] = _0x31cdb4(0x3fe); } } function _0x470caa() { const _0x52e5c7 = _0x1da6ac; if (_0x52e5c7(0x449) === _0x52e5c7(0xa43)) { const _0x30c869 = _0x509452[_0x52e5c7(0xe5)]; _0x243b6c[_0x52e5c7(0x1c5)][_0x52e5c7(0x10d)][_0x52e5c7(0x91f)]('--primary-lightness', _0x30c869 + '%'), _0x323238['setItem']('themeLightness', _0x30c869), _0x39f794(); } else { const _0x11dc0a = document[_0x52e5c7(0x248)](_0x52e5c7(0x6e9)), _0x2e175b = _0x10530c[_0x52e5c7(0x827)][_0x52e5c7(0x533)]; if (_0x2e175b) { if (_0x52e5c7(0x8eb) === _0x52e5c7(0x725)) { const _0x240ae2 = _0x2d54d1[_0x52e5c7(0x51f)](); if (_0x3049ae[_0x52e5c7(0xacd)](_0x498476 => _0x240ae2['startsWith'](_0x498476))) { const _0x54e5e2 = _0x5ad042[_0x2ab405]; if (typeof _0x54e5e2 === _0x52e5c7(0x9d1)) _0x19aa90['push'](_0x54e5e2); if (_0x59750b['isArray'](_0x54e5e2)) _0x54e5e2[_0x52e5c7(0x986)](_0x168da9 => { const _0x4beda3 = _0x52e5c7; if (typeof _0x168da9 === _0x4beda3(0x9d1)) _0x24f396['push'](_0x168da9); }); } } else _0x11dc0a[_0x52e5c7(0x10d)][_0x52e5c7(0xad9)] = 'url(' + _0x2e175b + ')', _0x11dc0a[_0x52e5c7(0x10d)][_0x52e5c7(0xc2)] = _0x52e5c7(0x55a), _0x11dc0a[_0x52e5c7(0x10d)]['backgroundPosition'] = _0x52e5c7(0x1ff), _0x11dc0a[_0x52e5c7(0x10d)]['color'] = _0x52e5c7(0x24b), _0x11dc0a[_0x52e5c7(0x20d)](_0x52e5c7(0x749))[_0x52e5c7(0x986)](_0x42faa7 => { const _0x3a122d = _0x52e5c7; _0x42faa7[_0x3a122d(0x10d)][_0x3a122d(0x2b4)] = _0x3a122d(0x871); }); } else 'xcmWU' !== _0x52e5c7(0x457) ? (_0x11dc0a[_0x52e5c7(0x10d)][_0x52e5c7(0xad9)] = '', _0x11dc0a[_0x52e5c7(0x10d)]['color'] = '', _0x11dc0a[_0x52e5c7(0x20d)](_0x52e5c7(0x749))['forEach'](_0x10d4c4 => { const _0x449d87 = _0x52e5c7; _0x449d87(0x626) !== _0x449d87(0xab6) ? _0x10d4c4[_0x449d87(0x10d)]['textShadow'] = '' : _0x3f0406 += _0x449d87(0x2f0); })) : (_0x55060d[_0x52e5c7(0x9ac)] = _0x242cda['speaker'] === _0x52e5c7(0x623) ? '旁白' : _0x42f4d3[_0x52e5c7(0x10c)], _0x1acfe8[_0x52e5c7(0x9ac)] = _0x4b1b52[_0x52e5c7(0x9f7)], _0x122a72[_0x52e5c7(0x10c)] === _0x21a2bf[_0x52e5c7(0x6b7)] ? _0xa66514(_0x523f6c, _0xbccf4f[_0x52e5c7(0x2be)]) : _0x4b75b0(_0x1993f8, 'normal')); } } const _0x4cd44a = document[_0x1da6ac(0x248)](_0x1da6ac(0x115)), _0x56a55c = document[_0x1da6ac(0x248)](_0x1da6ac(0x220)); _0x4cd44a[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x4042e5 = _0x1da6ac; _0x30c359(), _0x1c4afc(_0x4042e5(0x6fc), _0x4042e5(0x362)); }), _0x56a55c[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), async () => { const _0x54e6ca = _0x1da6ac; await _0x8e1b2b(), _0x1c4afc('meetingList', _0x54e6ca(0x362)); }), document[_0x1da6ac(0x248)]('back-to-home-from-meeting-list')[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x4ee891 = _0x1da6ac; if ('jdANY' === _0x4ee891(0x43e)) return _0x37a340(new _0xac0acd('哼，这不是图片，你想让我压缩什么？')); else _0x1c4afc(_0x4ee891(0x362), _0x4ee891(0x16a)); }), document['getElementById'](_0x1da6ac(0x57a))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x2a4120 = _0x1da6ac; if (_0x5864e0) clearInterval(_0x5864e0); _0x5864e0 = null, _0x10530c[_0x2a4120(0x1f5)] = [], _0x10530c['activeMeetingCharId'] = null, document[_0x2a4120(0x248)]('galgame-sprite-adjust-ui')[_0x2a4120(0x10d)][_0x2a4120(0x5eb)] = _0x2a4120(0x3fe), _0x10530c[_0x2a4120(0x16e)] = null, _0x3e6d3a(), _0x1c4afc('meetingList', 'meetingView'); }); const _0x1496e8 = document['getElementById'](_0x1da6ac(0x98e)), _0x4272a1 = document[_0x1da6ac(0x248)](_0x1da6ac(0x370)); _0x4272a1[_0x1da6ac(0x578)]('click', () => { const _0x43666d = _0x1da6ac; if (_0x43666d(0x9f5) !== _0x43666d(0x9f5)) { const _0x5ee818 = _0x2019bb(_0x21101a[_0x43666d(0x5cb)]); _0x5ee818 && (_0x5ee818[_0x43666d(0x7da)] = _0x519269, _0x308fac(_0x28b776['activeMeetingCharId'], 'normal')); } else { const _0x255ea2 = _0x1496e8[_0x43666d(0xe5)][_0x43666d(0x3ee)](); _0x255ea2 && (_0x18bc5f(_0x255ea2), _0x1496e8[_0x43666d(0xe5)] = '', setTimeout(_0x3990cb, 0x64)); } }); function _0xb9b242(_0x5488b2, _0x38bea9) { const _0x483b12 = _0x1da6ac, _0x5bf22e = document[_0x483b12(0x248)](_0x483b12(0x1d3)), _0xb8103e = document['querySelectorAll'](_0x483b12(0x41b)); _0xb8103e['forEach'](_0x3b67c8 => { const _0x32c19a = _0x483b12; if (_0x32c19a(0x8a6) !== _0x32c19a(0xab3)) _0x3b67c8 !== _0x5488b2[_0x32c19a(0x838)](_0x32c19a(0x41b)) && (_0x3b67c8[_0x32c19a(0x9ac)] = '▶'); else { if (_0x13ef60) _0x16cea8(_0x2dd63d); } }); if (_0x5bf22e['src'] === _0x38bea9[_0x483b12(0x83a)] && !_0x5bf22e[_0x483b12(0x823)]) { if ('nXqPu' === _0x483b12(0x7ea)) { const _0x2528e6 = { 'role': _0x483b12(0x7f0), 'content': _0x483b12(0x951) + _0x1d9d8b[_0x483b12(0x6b7)] + ']', 'displayUrl': _0x3360d9[_0x483b12(0x83a)], 'senderId': _0x2fd0ad['senderId'], 'timestamp': _0x380493['now'](), 'isOffline': _0x1d852f }; _0x56e521[_0x483b12(0x675)]['push'](_0x2528e6); } else _0x5bf22e[_0x483b12(0x4b8)](), _0x5488b2[_0x483b12(0x838)](_0x483b12(0x41b))['textContent'] = '▶'; } else _0x5bf22e['src'] = _0x38bea9['url'], _0x5bf22e[_0x483b12(0x8ad)](), _0x5488b2[_0x483b12(0x838)]('.music-post-play-icon,\x20.music-share-play-icon')[_0x483b12(0x9ac)] = '❚❚'; } const _0x4f296e = document[_0x1da6ac(0x248)](_0x1da6ac(0x649)); async function _0x49a5cf(_0x10f155) { const _0x34d138 = _0x1da6ac; if ('RbdAB' === 'uvHPO') _0x5a0104(), _0x4302fc = null; else { if (!_0x10f155 || !_0x10f155[_0x34d138(0x33c)]('http')) return ![]; return new Promise(_0x5ce129 => { const _0x139639 = _0x34d138; if (_0x139639(0x37c) !== 'RPqlv') { const _0x6e756f = document['createElement']('audio'); _0x6e756f['src'] = _0x10f155; const _0x4a2b60 = setTimeout(() => { _0x74466d(), _0x5ce129(![]); }, 0xbb8), _0x74466d = () => { const _0x5efff0 = _0x139639; clearTimeout(_0x4a2b60), _0x6e756f[_0x5efff0(0xa5e)](_0x5efff0(0x2dc), _0x4e839e), _0x6e756f['removeEventListener'](_0x5efff0(0x729), _0xfb474b), _0x6e756f[_0x5efff0(0x70a)] = '', _0x6e756f[_0x5efff0(0xae0)](); }, _0x4e839e = () => { const _0x37cfb8 = _0x139639; if ('DWSNm' === _0x37cfb8(0xabc)) _0x74466d(), _0x5ce129(!![]); else { if (_0x338e2e[_0x37cfb8(0x796)](_0x2f4b3e) && _0x281e5f[_0x37cfb8(0x796)](_0x136154)) { const _0x2c7f91 = _0x17a5d4[_0x37cfb8(0x9db)](_0x112b73); _0x2eb561 = _0x1f2df2[_0x37cfb8(0x22e)](_0x2c7f91), _0xf6300d[_0x37cfb8(0x5e0)](_0x37cfb8(0x117)); } else _0x171c3a = _0x1f7d50[_0x37cfb8(0x22e)](_0x22a05f); } }, _0xfb474b = () => { _0x74466d(), _0x5ce129(![]); }; _0x6e756f[_0x139639(0x578)](_0x139639(0x2dc), _0x4e839e), _0x6e756f[_0x139639(0x578)](_0x139639(0x729), _0xfb474b); } else _0x13834a[_0x139639(0x634)][_0x139639(0x4b1)](_0x14ac26[_0x139639(0x634)][_0x139639(0xa84)]() + 0x1), _0x583f76(); }); } } async function _0x57d1c9(_0x7b69a8, _0x401ed0) { const _0xbb3bb6 = _0x1da6ac, _0x4d12e7 = [_0xbb3bb6(0x5ed), 'tencent']; for (const _0x5994c4 of _0x4d12e7) { try { const _0x37f39a = _0xbb3bb6(0x64a) + _0x5994c4 + _0xbb3bb6(0x83c) + encodeURIComponent(_0x7b69a8) + '-' + encodeURIComponent(_0x401ed0), _0xd8518f = await fetch(_0x37f39a), _0x10d230 = await _0xd8518f[_0xbb3bb6(0x250)](); if (_0x10d230[_0xbb3bb6(0xd6)] !== 0xc8 || !_0x10d230[_0xbb3bb6(0x9be)] || _0x10d230['data'][_0xbb3bb6(0x848)] === 0x0) continue; const _0x4503a1 = _0x10d230['data'][_0xbb3bb6(0x53a)](0x0, 0x5); for (const _0xba04ec of _0x4503a1) { if (_0xbb3bb6(0x38b) === 'jnNFy') { const _0x2ab7e6 = _0xbb3bb6(0x64a) + _0x5994c4 + _0xbb3bb6(0x574) + _0xba04ec['id'], _0x60be61 = await fetch(_0x2ab7e6), _0x245720 = await _0x60be61[_0xbb3bb6(0x250)](), _0x8ef96b = _0x245720[_0xbb3bb6(0x9be)]?.['url']; if (await _0x49a5cf(_0x8ef96b)) return { 'url': _0x8ef96b, 'cover': _0xba04ec[_0xbb3bb6(0x55a)], 'source': _0x5994c4 }; } else { if (_0x2d9e2f[_0xbb3bb6(0x34a)] === 'assistant') { const _0xec4d48 = _0x3b693a[_0xbb3bb6(0x1be)][_0x69a2b1]; _0xec4d48 && _0xec4d48[_0xbb3bb6(0x848)] > 0x0 && (_0x4675a = _0xec4d48['at'](-0x1)); } else _0x57eba0 = { 'speaker': _0x326f37[_0xbb3bb6(0x6b7)], 'line': _0x574b91[_0xbb3bb6(0x9a8)], 'emotion': _0xbb3bb6(0x47b) }; } } } catch (_0x98b357) { console[_0xbb3bb6(0x729)]('Error\x20fetching\x20from\x20' + _0x5994c4 + ':', _0x98b357); } } return { 'url': null, 'cover': null, 'source': null }; } function _0x4bd486(_0x1a4efb) { const _0x3fa599 = _0x1da6ac; if (_0x3fa599(0x82e) === 'JXyCJ') try { if (_0x3fa599(0x7d0) === _0x3fa599(0x7d0)) { const _0x1b6db8 = JSON[_0x3fa599(0x329)](localStorage[_0x3fa599(0x915)](_0x3fa599(0x507)) || '{}'), _0x2a0f53 = { ..._0x1b6db8, ..._0x1a4efb }; localStorage[_0x3fa599(0x9e0)](_0x3fa599(0x507), JSON[_0x3fa599(0x22e)](_0x2a0f53)); } else _0x4a0c7e(_0x4eaad0); } catch (_0x46f547) { if (_0x3fa599(0x7d7) === _0x3fa599(0x3c4)) { const _0x361158 = _0x3baf0a[_0x3fa599(0x7b9)][_0x3fa599(0x212)](_0xe8dc64 => _0xe8dc64['id'] === _0x48de57[_0x3fa599(0x301)]), _0x507ef3 = _0x361158 ? _0x361158[_0x3fa599(0x3d6)] : []; if (!_0x507ef3 || _0x507ef3[_0x3fa599(0x848)] === 0x0) return ''; const _0x445eb5 = _0x507ef3[_0x3fa599(0x53a)](0x0, 0x5), _0x322907 = _0x445eb5[_0x3fa599(0xa21)](_0x193c97 => { const _0x331d81 = _0x3fa599, _0x356cbd = _0x4dc9e6(_0x193c97[_0x331d81(0x5fa)]) || { 'name': '未知' }; let _0x33b6d5 = _0x331d81(0x520) + _0x356cbd['name'] + '\x20说：“' + (_0x193c97[_0x331d81(0x3bd)] || _0x193c97[_0x331d81(0x9a8)]) + '”'; return _0x193c97[_0x331d81(0xa78)] === _0x331d81(0x868) && (_0x33b6d5 += _0x331d81(0x3d5) + _0x193c97[_0x331d81(0x6d2)] + '\x20-\x20' + _0x193c97[_0x331d81(0x755)] + ')'), _0x33b6d5; }); return _0x3fa599(0x45e) + _0x322907[_0x3fa599(0x64e)]('\x0a'); } else console['error'](_0x3fa599(0x5c6), _0x46f547); } else { _0x60f058('找不到要清空的聊天记录。'); return; } } async function _0x141e5a() { const _0xa6a27c = _0x1da6ac; if (_0xa6a27c(0x486) === _0xa6a27c(0x486)) { const _0x1f2e73 = document[_0xa6a27c(0x248)]('decorative-badge'), _0x253d24 = document[_0xa6a27c(0x248)](_0xa6a27c(0x925)); try { let _0x1e1dc7 = await _0x533d7a('widget_badge'); if (!_0x1e1dc7) { const _0x494144 = JSON[_0xa6a27c(0x329)](localStorage[_0xa6a27c(0x915)]('badgeState') || '{}'); _0x494144['image'] && (_0xa6a27c(0x4e7) !== _0xa6a27c(0x4e7) ? _0x2c11d1['src'] = _0x26d3e1['image'] : (_0x1e1dc7 = await _0x39f481(_0x494144[_0xa6a27c(0x1a2)]), await _0x5ef29b(_0xa6a27c(0x1ab), _0x1e1dc7))); } _0x1e1dc7 ? (_0x253d24[_0xa6a27c(0x70a)] = URL[_0xa6a27c(0x73d)](_0x1e1dc7), _0x253d24['style'][_0xa6a27c(0x5eb)] = _0xa6a27c(0x92c), _0x1f2e73[_0xa6a27c(0x10d)][_0xa6a27c(0xa00)] = _0xa6a27c(0x3fe)) : (_0x253d24[_0xa6a27c(0x10d)][_0xa6a27c(0x5eb)] = _0xa6a27c(0x3fe), _0x1f2e73[_0xa6a27c(0x10d)][_0xa6a27c(0xa00)] = _0xa6a27c(0xda)), _0x1f2e73['style']['display'] = 'block'; } catch (_0x37d906) { console[_0xa6a27c(0x729)](_0xa6a27c(0x116), _0x37d906); } } else _0x35cdda(![]), _0xd2fa47[_0xa6a27c(0xa4a)] = ![]; } async function _0x28e8b9() { const _0x3f2b32 = _0x1da6ac; if (_0x3f2b32(0x77a) === _0x3f2b32(0x7f8)) _0x3ac5b9(() => { const _0x41a318 = _0x3f2b32, _0x5e541a = _0x2bb89b[_0x41a318(0x248)](_0x3d5e7e); if (_0x5e541a) _0x5e541a['src'] = _0xe27168[_0x41a318(0x2ab)]; }, 0x0); else { const _0x2541c6 = document['getElementById'](_0x3f2b32(0x7eb)), _0x42d75b = document[_0x3f2b32(0x248)](_0x3f2b32(0xfd)), _0x55d4ea = document[_0x3f2b32(0x248)]('card-widget-2'), _0x26334b = document['getElementById']('card-image-2'); try { let _0x5c6031 = await _0x533d7a(_0x3f2b32(0x31d)); _0x5c6031 ? (_0x42d75b[_0x3f2b32(0x70a)] = URL[_0x3f2b32(0x73d)](_0x5c6031), _0x42d75b[_0x3f2b32(0x10d)][_0x3f2b32(0x5eb)] = _0x3f2b32(0x92c), _0x2541c6[_0x3f2b32(0x10d)][_0x3f2b32(0xa00)] = 'none', _0x2541c6['style'][_0x3f2b32(0x694)] = _0x3f2b32(0x3eb)) : (_0x42d75b['style'][_0x3f2b32(0x5eb)] = _0x3f2b32(0x3fe), _0x2541c6[_0x3f2b32(0x10d)][_0x3f2b32(0xa00)] = _0x3f2b32(0xda), _0x2541c6[_0x3f2b32(0x10d)][_0x3f2b32(0x694)] = _0x3f2b32(0x97e)); _0x2541c6[_0x3f2b32(0x10d)][_0x3f2b32(0x5eb)] = _0x3f2b32(0x92c); let _0x51a42f = await _0x533d7a('widget_card_2'); if (_0x51a42f) { if ('YEPeH' !== _0x3f2b32(0xed)) _0x26334b[_0x3f2b32(0x70a)] = URL[_0x3f2b32(0x73d)](_0x51a42f), _0x26334b['style'][_0x3f2b32(0x5eb)] = _0x3f2b32(0x92c), _0x55d4ea[_0x3f2b32(0x10d)][_0x3f2b32(0xa00)] = 'none', _0x55d4ea['style'][_0x3f2b32(0x694)] = _0x3f2b32(0x3eb); else return new _0x4ed1cb(_0x589ccd => { const _0x395a31 = _0x3f2b32, _0x458758 = _0x395a31(0x3e4); _0x3f65f0[_0x395a31(0x3ec)]['insertAdjacentHTML'](_0x395a31(0x1bf), _0x458758); const _0x8f517a = _0x4f30b3[_0x395a31(0x248)](_0x395a31(0x506)), _0x2eb893 = _0xbc9de4[_0x395a31(0x248)](_0x395a31(0x48c)), _0x44ef8d = _0xac896e[_0x395a31(0x248)](_0x395a31(0x25b)), _0x47e627 = _0x465834[_0x395a31(0x248)](_0x395a31(0xacb)), _0x329769 = _0x8f517a[_0x395a31(0x838)](_0x395a31(0x279)), _0x4d2b2d = () => { const _0x2a3a80 = _0x395a31; _0x8f517a[_0x2a3a80(0xae0)](), _0x589ccd(); }; _0x44ef8d[_0x395a31(0x935)] = () => { const _0x2012f7 = _0x395a31; _0x5cd3fe(_0x2eb893[_0x2012f7(0xe5)]), _0x4d2b2d(); }, _0x47e627[_0x395a31(0x935)] = _0x4d2b2d, _0x329769[_0x395a31(0x935)] = _0x4d2b2d; }); } else _0x26334b['style']['display'] = 'none', _0x55d4ea[_0x3f2b32(0x10d)][_0x3f2b32(0xa00)] = '2px\x20dashed\x20var(--border-color)', _0x55d4ea[_0x3f2b32(0x10d)][_0x3f2b32(0x694)] = _0x3f2b32(0x97e); _0x55d4ea[_0x3f2b32(0x10d)][_0x3f2b32(0x5eb)] = _0x3f2b32(0x92c); } catch (_0x4661f1) { _0x3f2b32(0x1da) !== _0x3f2b32(0x14b) ? console['error'](_0x3f2b32(0x515), _0x4661f1) : _0x385f2b[_0x3f2b32(0x9a1)] = _0x3f2b32(0x2ae) + _0x4551cb + '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>'; } } } async function _0x28e8b9() { const _0x4d622f = _0x1da6ac, _0x436be3 = document[_0x4d622f(0x248)](_0x4d622f(0x7eb)), _0x32b08c = document[_0x4d622f(0x248)](_0x4d622f(0xfd)); try { let _0x263ed3 = await _0x533d7a(_0x4d622f(0x31d)); if (!_0x263ed3) { const _0x1b6347 = JSON[_0x4d622f(0x329)](localStorage[_0x4d622f(0x915)](_0x4d622f(0x790)) || '{}'); if (_0x1b6347[_0x4d622f(0x1a2)]) { if ('pLdoj' !== _0x4d622f(0x709)) console['log'](_0x4d622f(0x473)), _0x263ed3 = await _0x39f481(_0x1b6347[_0x4d622f(0x1a2)]), await _0x5ef29b(_0x4d622f(0x31d), _0x263ed3); else { _0x3773b0(_0x4d622f(0x8d6)); return; } } } if (_0x263ed3) _0x32b08c['src'] = URL['createObjectURL'](_0x263ed3), _0x436be3[_0x4d622f(0x10d)][_0x4d622f(0x5eb)] = _0x4d622f(0x92c); else { if (_0x4d622f(0x23f) !== 'iYHYt') _0x436be3[_0x4d622f(0x10d)][_0x4d622f(0x5eb)] = _0x4d622f(0x3fe); else { const _0xa1aad7 = _0x5f4a2e[_0x4d622f(0xe8)] === 'user' ? _0x493172[_0x4d622f(0x6b7)] : _0x40f0a9(_0x351864[_0x4d622f(0xe8)])['name']; return _0x4d622f(0x18c) + new _0x27f4b5(_0x29f5ef[_0x4d622f(0x908)])[_0x4d622f(0x2d8)]() + ']\x20' + _0xa1aad7 + _0x4d622f(0x3bb) + _0xfdca1d[_0x4d622f(0x9a8)]; } } } catch (_0x5db2fc) { console[_0x4d622f(0x729)](_0x4d622f(0x515), _0x5db2fc); } try { let _0x366ad9 = await _0x533d7a(_0x4d622f(0x671)); const _0x249b41 = document[_0x4d622f(0x248)]('card-image-2'), _0x533418 = document[_0x4d622f(0x248)](_0x4d622f(0x6c9)); if (_0x366ad9) _0x4d622f(0x206) === 'GQFZm' ? (_0x249b41[_0x4d622f(0x70a)] = URL['createObjectURL'](_0x366ad9), _0x533418[_0x4d622f(0x10d)][_0x4d622f(0x5eb)] = _0x4d622f(0x92c)) : _0x2bd9eb[_0x4d622f(0xe5)] = _0x3c2506['map'](_0x291493 => _0x291493[_0x4d622f(0x6b7)] + '--' + _0x291493[_0x4d622f(0x83a)])[_0x4d622f(0x64e)]('\x0a'); else { if (_0x4d622f(0x632) === _0x4d622f(0x1c6)) { if (!_0x521362) return []; const _0x48909d = _0x4ec539(_0x3f9a62)[_0x4d622f(0x3ee)](), _0x28d3ab = _0x48909d['split'](/(?<=[。！？!?…])\s+|[\r\n]+/)['map'](_0x657895 => _0x657895[_0x4d622f(0x3ee)]())[_0x4d622f(0x54e)](_0x171740); if (_0x28d3ab['length'] > 0x0) return _0x28d3ab[_0x4d622f(0x53a)](0x0, 0x9); return [_0x48909d][_0x4d622f(0x54e)](_0x4a39e2); } else _0x533418[_0x4d622f(0x10d)][_0x4d622f(0x5eb)] = _0x4d622f(0x3fe); } } catch (_0xf35dc) { console[_0x4d622f(0x729)]('加载第二个卡片图片失败', _0xf35dc); } } _0x4d89ba[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x3f7334 = _0x1da6ac; _0x3f7334(0x782) === 'RxwzH' ? (_0xfb2bb6(), _0x1c4afc(_0x3f7334(0x51d), _0x3f7334(0x362))) : (_0x52ebef[_0x3f7334(0x729)](_0x3f7334(0x5d5) + _0x25716a['id'], _0x2e7250), _0x49b3a6('清空聊天记录失败。')); }), document[_0x1da6ac(0x248)]('back-to-home-from-user-list')['addEventListener'](_0x1da6ac(0x4b3), () => _0x1c4afc(_0x1da6ac(0x362), _0x1da6ac(0x51d))), document[_0x1da6ac(0x248)]('add-user-profile-button')['addEventListener'](_0x1da6ac(0x4b3), () => _0x24ac80()), document['getElementById'](_0x1da6ac(0x8da))[_0x1da6ac(0x578)]('click', () => { const _0x5270e4 = _0x1da6ac; _0xfb2bb6(), _0x1c4afc(_0x5270e4(0x51d), _0x5270e4(0x1c9)); }), document[_0x1da6ac(0x248)](_0x1da6ac(0xacc))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x1dbb60), document['getElementById'](_0x1da6ac(0x99a))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x749cca), document[_0x1da6ac(0x248)]('set-active-user-button')[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x1464a6 = _0x1da6ac, _0x2729c2 = document[_0x1464a6(0x248)]('editing-user-id')[_0x1464a6(0xe5)]; _0x2729c2 && (_0x10530c[_0x1464a6(0x663)] = _0x2729c2, _0x3e6d3a(), _0x3a6c86(_0x1464a6(0x68a)), _0xfb2bb6(), document['getElementById']('set-active-user-button')['style'][_0x1464a6(0x5eb)] = _0x1464a6(0x3fe)); }); function _0x474290(_0x437ca2) { const _0x4d1bb9 = _0x1da6ac, _0x61ec91 = _0x10530c[_0x4d1bb9(0x4bc)][_0x4d1bb9(0x212)](_0x189fe6 => _0x189fe6['id'] === _0x437ca2), _0x3b0f65 = _0x61ec91?.['boundUserProfileId']; let _0x1e181e = _0x10530c[_0x4d1bb9(0x360)][_0x4d1bb9(0x212)](_0x39e493 => _0x39e493['id'] === _0x3b0f65); return !_0x1e181e && (_0x1e181e = _0x10530c[_0x4d1bb9(0x360)][_0x4d1bb9(0x212)](_0x4b958e => _0x4b958e['id'] === _0x10530c[_0x4d1bb9(0x663)]) || _0x10530c[_0x4d1bb9(0x360)][0x0]), _0x1e181e || { 'name': '用户', 'avatar': _0x45fac0, 'persona': '' }; } function _0xb18b1d(_0x1c5d64) { const _0x11e6a4 = _0x1da6ac, _0x201f0d = document[_0x11e6a4(0x248)](_0x1c5d64); _0x201f0d[_0x11e6a4(0x9a1)] = '', _0x10530c[_0x11e6a4(0x360)][_0x11e6a4(0x986)](_0x321a13 => { const _0x2540b6 = _0x11e6a4; if ('fqjfU' === _0x2540b6(0x1ba)) _0x151142[_0x2540b6(0x248)]('snoop-app-view-container')[_0x2540b6(0x10d)]['display'] = 'none', _0x4e399f(_0x2540b6(0xa26), _0x2540b6(0x363)); else { const _0x5706a8 = document['createElement']('option'); _0x5706a8[_0x2540b6(0xe5)] = _0x321a13['id'], _0x5706a8[_0x2540b6(0x9ac)] = _0x321a13[_0x2540b6(0x6b7)], _0x201f0d[_0x2540b6(0x6ab)](_0x5706a8); } }); } function _0x3b3884(_0x4d1bbc) { const _0x4d1e9f = _0x1da6ac; if ('usVhb' === _0x4d1e9f(0x9a2)) return _0x4d1e9f(0x6fb); else { const _0xe2546f = _0x5b19fc(_0x4d1bbc), _0x135b04 = document['getElementById'](_0x4d1e9f(0x738)); _0x135b04[_0x4d1e9f(0x10d)]['backgroundImage'] = ''; let _0x30fa7c = document[_0x4d1e9f(0x248)]('style-' + _0x4d1bbc); if (_0x30fa7c) _0x30fa7c[_0x4d1e9f(0x9a1)] = ''; if (!_0xe2546f) return; if (_0xe2546f['chatWallpaper']) { if ('NsaXV' === 'NOTgu') { const _0x38c19f = _0x2e93d7['transaction'](_0x3beab7, _0x4d1e9f(0x52c)), _0x10f9c0 = _0x38c19f[_0x4d1e9f(0x963)](_0x5a7a09), _0x42a86d = _0x10f9c0['delete'](_0x40ce3d); _0x42a86d[_0x4d1e9f(0x330)] = () => _0x3b8174(), _0x42a86d['onerror'] = () => _0x2b8c00(_0x42a86d[_0x4d1e9f(0x729)]); } else _0x135b04[_0x4d1e9f(0x10d)][_0x4d1e9f(0xad9)] = _0x4d1e9f(0x7a2) + _0xe2546f[_0x4d1e9f(0x1b9)] + '\x27)', _0x135b04[_0x4d1e9f(0x10d)][_0x4d1e9f(0xc2)] = _0x4d1e9f(0x55a), _0x135b04['style'][_0x4d1e9f(0x53b)] = _0x4d1e9f(0x1ff); } if (_0xe2546f[_0x4d1e9f(0x78f)]) { let _0x2cc20d = document[_0x4d1e9f(0x248)](_0x4d1e9f(0x4a1) + _0xe2546f['id']); !_0x2cc20d && (_0x4d1e9f(0x985) !== _0x4d1e9f(0x985) ? (_0x43e883(), _0x71ea82()) : (_0x2cc20d = document[_0x4d1e9f(0x3b9)](_0x4d1e9f(0x10d)), _0x2cc20d['id'] = _0x4d1e9f(0x4a1) + _0xe2546f['id'], document[_0x4d1e9f(0x450)][_0x4d1e9f(0x6ab)](_0x2cc20d))); const _0x428ce9 = _0xe2546f[_0x4d1e9f(0x78f)], _0x4ed953 = _0x428ce9[_0x4d1e9f(0x7cf)](/\.bubble\.sent/g, _0x4d1e9f(0x875) + _0xe2546f['id'] + _0x4d1e9f(0x102))['replace'](/\.bubble\.received/g, _0x4d1e9f(0x875) + _0xe2546f['id'] + '.message.ai'); _0x2cc20d[_0x4d1e9f(0x9a1)] = _0x4ed953; } } } function _0x559a3e() { const _0x9f887b = _0x1da6ac, _0x34cf0d = document['getElementById'](_0x9f887b(0x914)); _0x34cf0d[_0x9f887b(0x9a1)] = ''; const _0x8e2738 = _0x321e37 => { const _0x3138b0 = _0x9f887b; if (_0x3138b0(0x8e0) === _0x3138b0(0x8e0)) { _0x10530c[_0x3138b0(0x8bb)][_0x321e37] = null; if (_0x321e37 === _0x3138b0(0x1a2)) _0x10530c[_0x3138b0(0x8bb)][_0x3138b0(0x35f)] = null; _0x559a3e(); } else _0x11abf9[_0x3138b0(0x882)][_0x3138b0(0x7c3)](_0x3138b0(0x89e)); }, _0x464a82 = _0x10530c[_0x9f887b(0x8bb)][_0x9f887b(0x35f)], _0x5802b2 = _0x10530c['pendingPostAttachments']['music']; if (_0x464a82) { if ('urDUA' === 'urDUA') { const _0x5b5212 = document[_0x9f887b(0x3b9)](_0x9f887b(0x6ff)); _0x5b5212['className'] = 'preview-item', _0x5b5212[_0x9f887b(0x9a1)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x5b5212[_0x9f887b(0x838)](_0x9f887b(0x1f7))[_0x9f887b(0x935)] = () => _0x8e2738(_0x9f887b(0x1a2)), _0x34cf0d[_0x9f887b(0x6ab)](_0x5b5212), _0x533d7a(_0x464a82)[_0x9f887b(0x45f)](_0x2067d5 => { const _0x213ee4 = _0x9f887b; if ('CPMdk' !== _0x213ee4(0x175)) _0x586272[_0x213ee4(0x729)](_0x213ee4(0xa55), _0x19288d), _0x18cf87(_0x213ee4(0x1bc)); else { const _0x4856da = document[_0x213ee4(0x248)](_0x213ee4(0xa0b)); _0x4856da && _0x2067d5 && (_0x4856da[_0x213ee4(0x70a)] = URL[_0x213ee4(0x73d)](_0x2067d5)); } }); } else _0x5500f2[_0x9f887b(0x9e0)](_0x9f887b(0x13c) + _0x45e651[_0x9f887b(0x16e)], _0x5afc67[_0x9f887b(0x22e)](_0xb363c0[_0x9f887b(0x675)])); } if (_0x5802b2) { if (_0x9f887b(0x84f) !== _0x9f887b(0x84f)) _0x70123['scrollTop'] = _0x1a30b6[_0x9f887b(0x5ce)]; else { const _0x1efd50 = document[_0x9f887b(0x3b9)](_0x9f887b(0x6ff)); _0x1efd50[_0x9f887b(0x296)] = _0x9f887b(0x97f), _0x1efd50[_0x9f887b(0x9a1)] = _0x9f887b(0x693) + (_0x5802b2[_0x9f887b(0x2ab)] || _0x5da029) + _0x9f887b(0x34d) + _0x5802b2[_0x9f887b(0x6d2)] + _0x9f887b(0x890) + _0x5802b2[_0x9f887b(0x755)] + _0x9f887b(0x684), _0x1efd50[_0x9f887b(0x838)](_0x9f887b(0x1f7))[_0x9f887b(0x935)] = () => _0x8e2738('music'), _0x34cf0d['appendChild'](_0x1efd50); } } } async function _0x42e85c(_0x31e140) { const _0x2a3e5a = _0x1da6ac; if (_0x2a3e5a(0x3f2) !== 'MFedo') return _0x38f95f(_0x1e6bcb, _0x31e66a); else { const _0x1b46d4 = _0x10530c['friendCircles']['find'](_0x5710c0 => _0x5710c0['id'] === _0x10530c[_0x2a3e5a(0x301)]); if (!_0x1b46d4) return; _0xbc2d1c(!![], _0x2a3e5a(0x28e)), _0x10530c['isGenerating'] = !![]; try { if (_0x2a3e5a(0x67b) === 'jONxV') return []; else { const _0x44c99a = _0x1b46d4[_0x2a3e5a(0x9ee)][_0x2a3e5a(0xa21)](_0x52093e => _0x5b19fc(_0x52093e))[_0x2a3e5a(0x54e)](Boolean), _0x405490 = _0x538f71(), _0x4b65ba = _0x44c99a[_0x2a3e5a(0xa21)](_0x1d22f1 => { const _0x1e1e6e = _0x2a3e5a, { omniText: _0x4ff69f } = _0x3b8ffa(_0x1d22f1['id'], null), _0x14b0e8 = _0x38a670(_0x1d22f1['id']), _0x581206 = _0x1d22f1[_0x1e1e6e(0x7e0)] && _0x1d22f1[_0x1e1e6e(0x7e0)][_0x1e1e6e(0x848)] > 0x0 ? _0x1e1e6e(0x8cb) + _0x1d22f1['name'] + '的个人专属世界观设定\x0a' + _0x1d22f1[_0x1e1e6e(0x7e0)]['map'](_0x4b5432 => _0x10530c[_0x1e1e6e(0x79a)]['find'](_0x4045fd => _0x4045fd['id'] === _0x4b5432))[_0x1e1e6e(0x54e)](Boolean)[_0x1e1e6e(0xa21)](_0x312046 => _0x1e1e6e(0x9c1) + _0x312046[_0x1e1e6e(0x6b7)] + '\x0a' + _0x312046[_0x1e1e6e(0x9a8)])[_0x1e1e6e(0x64e)]('') : ''; return '-\x20姓名:\x20' + _0x1d22f1[_0x1e1e6e(0x6b7)] + _0x1e1e6e(0x152) + _0x1d22f1['id'] + _0x1e1e6e(0x6f4) + _0x1d22f1['persona'] + _0x1e1e6e(0x825) + _0x4ff69f + '\x0a' + _0x14b0e8 + '\x0a' + _0x581206; })[_0x2a3e5a(0x64e)]('\x0a\x0a'), _0x44ff19 = _0x30c603(_0x31e140[_0x2a3e5a(0x5fa)]) || { 'name': '用户' }, _0x48f90a = _0x44ff19[_0x2a3e5a(0x824)] ? '\x0a#\x20发布动态的用户信息\x0a-\x20姓名:\x20' + _0x44ff19[_0x2a3e5a(0x6b7)] + _0x2a3e5a(0x844) + _0x44ff19[_0x2a3e5a(0x824)] + '\x0a' : ''; let _0x1b7ccf = null; if (_0x31e140['image']) _0x1b7ccf = _0x31e140[_0x2a3e5a(0x1a2)]; else { if (_0x31e140[_0x2a3e5a(0x35f)]) try { if (_0x2a3e5a(0x752) !== _0x2a3e5a(0x1ee)) { const _0x4d580c = await _0x533d7a(_0x31e140[_0x2a3e5a(0x35f)]); _0x4d580c && (_0x1b7ccf = await _0x3c4a4d(_0x4d580c)); } else _0x94b910['setItem'](_0x13f29e, _0xfb5360[_0x2a3e5a(0x22e)](_0x13e120)); } catch (_0x3b6802) { console['error'](_0x2a3e5a(0x5fb), _0x3b6802); } } let _0x80651d = _0x44ff19['name'] + _0x2a3e5a(0xa66) + _0x31e140[_0x2a3e5a(0x9a8)] + '”'; if (_0x1b7ccf) { if (_0x2a3e5a(0x615) === _0x2a3e5a(0x615)) _0x80651d += _0x2a3e5a(0x55c); else { const _0x44d08c = _0x12811b['transaction'](_0x42cbe4, _0x2a3e5a(0x52c)), _0x4f1ec8 = _0x44d08c[_0x2a3e5a(0x963)](_0x1830b4), _0x1314ab = _0x4f1ec8[_0x2a3e5a(0xa8b)](_0x2d1de0); _0x1314ab[_0x2a3e5a(0x330)] = () => _0x3e682a(_0x1314ab[_0x2a3e5a(0x4f7)]), _0x1314ab['onerror'] = () => _0x1d3faf(_0x1314ab['error']); } } if (_0x31e140[_0x2a3e5a(0xa78)] === _0x2a3e5a(0x868)) { if (_0x2a3e5a(0x78d) === _0x2a3e5a(0x78d)) _0x80651d += _0x2a3e5a(0xa56) + _0x31e140[_0x2a3e5a(0x6d2)] + _0x2a3e5a(0x23b) + _0x31e140[_0x2a3e5a(0x755)] + ']'; else { const _0xda47e9 = _0x491343['worldBooks'][_0x2a3e5a(0x212)](_0x282485 => _0x282485['id'] === _0x104443); if (!_0xda47e9) return; _0x2e3783[_0x2a3e5a(0x248)]('editing-world-book-id')['value'] = _0xda47e9['id'], _0x1f530c['getElementById']('world-book-editor-title')[_0x2a3e5a(0x9ac)] = _0x2a3e5a(0x80d), _0x55217a['getElementById']('world-book-edit-name')[_0x2a3e5a(0xe5)] = _0xda47e9[_0x2a3e5a(0x6b7)], _0x35175c[_0x2a3e5a(0x248)]('world-book-edit-content')[_0x2a3e5a(0xe5)] = _0xda47e9['content']; } } const _0x47f090 = '\x0a#\x20核心任务\x0a你是一个多角色社交模拟引擎。用户刚刚发了一条动态，你需要为好友圈里的【每一位】其他成员生成对这条动态的回应（点赞和评论）。如果用户的动态包含图片，你必须根据图片内容进行回应。\x0a\x0a#\x20好友圈成员\x0a' + _0x4b65ba + '\x0a\x0a' + _0x48f90a + '\x0a\x0a#\x20最近的动态回顾\x20(供参考)\x0a' + _0x405490 + '\x0a\x0a#\x20用户的动态\x0a' + _0x80651d + _0x2a3e5a(0x855), _0x2a3125 = [{ 'role': 'system', 'content': _0x47f090 }], _0x5914f4 = { 'role': _0x2a3e5a(0x27a), 'content': _0x2a3e5a(0x320) }; if (_0x1b7ccf) { if (_0x2a3e5a(0x33b) === _0x2a3e5a(0x33b)) _0x5914f4[_0x2a3e5a(0x1a2)] = _0x1b7ccf; else { const _0x36a350 = { 'id': 'wb_' + _0x58d60d['now'](), 'name': _0x58c70d, 'content': _0x3031d6 }; _0x13d477[_0x2a3e5a(0x79a)]['push'](_0x36a350); } } _0x2a3125[_0x2a3e5a(0x36b)](_0x5914f4); const _0x1b000f = await _0x2d63cb(_0x2a3125, { 'json': !![] }), _0x1b4a3e = _0x1b000f['match'](/({[\s\S]*})/); if (!_0x1b4a3e) throw new Error(_0x2a3e5a(0x4f4)); const _0x3225f7 = JSON[_0x2a3e5a(0x329)](_0x1b4a3e[0x1]), _0x33f74b = _0x1b46d4[_0x2a3e5a(0x3d6)][_0x2a3e5a(0x212)](_0x2bf97e => _0x2bf97e['id'] === _0x31e140['id']); if (_0x33f74b) { if ('kBZKF' === _0x2a3e5a(0x92d)) _0x33f74b[_0x2a3e5a(0x372)] = _0x3225f7[_0x2a3e5a(0x372)] || [], _0x33f74b[_0x2a3e5a(0xa0d)] = (_0x3225f7[_0x2a3e5a(0xa0d)] || [])['map']((_0x582f58, _0x582bfb) => ({ ..._0x582f58, 'commentId': 'c_' + _0x31e140[_0x2a3e5a(0x908)] + '_' + _0x582bfb })), _0x3e6d3a(), _0x291bef(); else { if (_0x521e96['getSelection']()[_0x2a3e5a(0x79d)]()) return; const _0x4c717c = _0x3da946[_0x2a3e5a(0x6c4)][_0x2a3e5a(0x939)](_0x2a3e5a(0x980)), _0x4b1c3a = _0x5b0a6c[_0x2a3e5a(0x6c4)][_0x2a3e5a(0x939)](_0x2a3e5a(0x288)); if (!_0x4c717c || _0x4b1c3a) return; const _0x38694d = _0x460fa2(_0x4c717c[_0x2a3e5a(0xab1)][_0x2a3e5a(0x215)], 0xa); if (_0x274592(_0x38694d)) return; _0x1279f1(_0x38694d); } } } } catch (_0x28048a) { if (_0x2a3e5a(0x76c) === _0x2a3e5a(0x76c)) console[_0x2a3e5a(0x729)](_0x2a3e5a(0x8ca), _0x28048a), _0x3a6c86(_0x2a3e5a(0x173)); else { const _0x526a91 = _0x33f2e8['closest']('.message-container'), _0x5e1691 = _0x4e8931[_0x2a3e5a(0xab1)][_0x2a3e5a(0x181)], _0x931f7f = _0x2cbc37(_0x526a91[_0x2a3e5a(0xab1)][_0x2a3e5a(0x215)], 0xa); _0x136500(_0x5e1691, _0x931f7f, _0x15bf63); } } finally { _0xbc2d1c(![]), _0x10530c[_0x2a3e5a(0xa4a)] = ![]; } } } function _0x3d40f4() { const _0x239dc2 = _0x1da6ac; if (_0x239dc2(0xa82) === _0x239dc2(0x2e0)) try { _0x30473f[_0x239dc2(0x9e0)]('musicPlayerState', _0x476be8[_0x239dc2(0x22e)]({ 'playlist': _0x570d5e[_0x239dc2(0x30c)], 'currentIndex': _0x26e6af[_0x239dc2(0x79f)] })); } catch (_0x541ff0) { _0x1075c4[_0x239dc2(0x729)](_0x239dc2(0x3ab), _0x541ff0); } else { const _0x541c19 = _0x10530c['friendCircles'][_0x239dc2(0x212)](_0x250471 => _0x250471['id'] === _0x10530c['activeFriendCircleId']), _0x22c44b = _0x541c19?.[_0x239dc2(0x2eb)]; let _0x1999ff = _0x10530c[_0x239dc2(0x360)][_0x239dc2(0x212)](_0x2c0052 => _0x2c0052['id'] === _0x22c44b); !_0x1999ff && (_0x1999ff = _0x10530c['userProfiles'][_0x239dc2(0x212)](_0x8753fa => _0x8753fa['id'] === _0x10530c[_0x239dc2(0x663)])), !_0x1999ff && (_0x239dc2(0x243) !== _0x239dc2(0x243) ? _0x19dba9(_0x16ada7['toDataURL'](_0x272299, _0x3e02f5)) : _0x1999ff = _0x10530c['userProfiles'][0x0]), _0x1999ff && (_0x239dc2(0xa87) === _0x239dc2(0x144) ? _0x5ca685['addEventListener']('click', function () { const _0x8aadb4 = _0x239dc2, _0x13cc98 = { 'id': _0x8aadb4(0x10a) + _0x33e4c2[_0x8aadb4(0x908)], 'url': _0x34e39c[_0x8aadb4(0x5e3)] }; _0xec6433(this, _0x13cc98); }) : document[_0x239dc2(0x248)]('user-post-avatar')[_0x239dc2(0x70a)] = _0x1999ff[_0x239dc2(0x917)] || _0x45fac0); } } function _0x583d4f(_0x65318) { const _0x3e7088 = _0x1da6ac; if (_0x3e7088(0x9e7) === _0x3e7088(0xa4c)) _0x170c56 += _0x3e7088(0x721); else { let _0x20371b = 0x0, _0x42bf9f = 0x0, _0x2eecac = 0x0; if (_0x65318[_0x3e7088(0x848)] == 0x4) { if ('yALrp' === 'yALrp') _0x20371b = '0x' + _0x65318[0x1] + _0x65318[0x1], _0x42bf9f = '0x' + _0x65318[0x2] + _0x65318[0x2], _0x2eecac = '0x' + _0x65318[0x3] + _0x65318[0x3]; else { const _0x4942aa = _0x107fb3 ?? _0x513a64[_0x3e7088(0xe5)][_0x3e7088(0x3ee)](); if (_0x4942aa === '' || !_0xe3caea[_0x3e7088(0x16e)]) return; const _0x432ea8 = _0x8fa1d4[_0x3e7088(0x838)]('.screen.active'), _0x2352af = _0x432ea8['id'] === _0x3e7088(0x99f), _0x53a0a2 = { 'role': 'user', 'content': _0x4942aa, 'timestamp': _0x52f759[_0x3e7088(0x7a8)](), 'isOffline': _0x2352af }; _0x295542[_0x3e7088(0x618)] && (_0x53a0a2[_0x3e7088(0x86c)] = { ..._0x559633[_0x3e7088(0x618)] }), _0x878f0d['conversationHistory'][_0x3e7088(0x36b)](_0x53a0a2), _0x490535(), _0x33c26e(), !_0x3d48b3 && (_0x42194a['value'] = ''), _0x4f546d(); } } else _0x65318[_0x3e7088(0x848)] == 0x7 && ('yZGFS' === _0x3e7088(0xa63) ? (_0x20371b = '0x' + _0x65318[0x1] + _0x65318[0x2], _0x42bf9f = '0x' + _0x65318[0x3] + _0x65318[0x4], _0x2eecac = '0x' + _0x65318[0x5] + _0x65318[0x6]) : (_0x489c9d[_0x3e7088(0x882)][_0x3e7088(0xae0)](_0x3e7088(0x11b)), _0x3b7b50['onclick'] = null, _0x5ae899['onclick'] = null, _0x26fc4a[_0x3e7088(0x935)] = null, _0x391c3d['removeEventListener']('keydown', _0x5037aa), _0x3cceac(_0xd7ce57))); _0x20371b /= 0xff, _0x42bf9f /= 0xff, _0x2eecac /= 0xff; let _0x31b75e = Math[_0x3e7088(0x90a)](_0x20371b, _0x42bf9f, _0x2eecac), _0x137af3 = Math[_0x3e7088(0x21d)](_0x20371b, _0x42bf9f, _0x2eecac), _0x497c0c = _0x137af3 - _0x31b75e, _0x4b2377 = 0x0, _0xba24df = 0x0, _0x1b9bb8 = 0x0; if (_0x497c0c == 0x0) _0x4b2377 = 0x0; else { if (_0x137af3 == _0x20371b) _0x4b2377 = (_0x42bf9f - _0x2eecac) / _0x497c0c % 0x6; else { if (_0x137af3 == _0x42bf9f) _0x4b2377 = (_0x2eecac - _0x20371b) / _0x497c0c + 0x2; else _0x4b2377 = (_0x20371b - _0x42bf9f) / _0x497c0c + 0x4; } } _0x4b2377 = Math[_0x3e7088(0x2c8)](_0x4b2377 * 0x3c); if (_0x4b2377 < 0x0) _0x4b2377 += 0x168; return _0x1b9bb8 = (_0x137af3 + _0x31b75e) / 0x2, _0xba24df = _0x497c0c == 0x0 ? 0x0 : _0x497c0c / (0x1 - Math[_0x3e7088(0x20b)](0x2 * _0x1b9bb8 - 0x1)), _0xba24df = +(_0xba24df * 0x64)[_0x3e7088(0x7d5)](0x1), _0x1b9bb8 = +(_0x1b9bb8 * 0x64)['toFixed'](0x1), { 'h': _0x4b2377, 's': _0xba24df, 'l': _0x1b9bb8 }; } } function _0x481db1() { const _0x241057 = _0x1da6ac, _0x2745e6 = (_0x34cbfa, _0x2e9ccb, _0x1f2a97) => { const _0x1eb5f5 = _0x2af4, _0x2e7adf = document['getElementById'](_0x34cbfa); if (!_0x2e7adf) return; let _0x4b1b01 = null; try { _0x4b1b01 = JSON[_0x1eb5f5(0x329)](localStorage[_0x1eb5f5(0x915)](_0x2e9ccb) || '{}'); } catch { if (_0x1eb5f5(0x4f3) === _0x1eb5f5(0x3e5)) { const _0x27fbe4 = _0x443e83(_0x5bd46d[_0x1eb5f5(0x16e)]); _0xba55b0 = _0x27fbe4['avatar'] || _0x5dd2b2; const _0x35d179 = _0x4b7700(_0x19d107?.[_0x1eb5f5(0x26f)][0x0]); _0x35d179 && (_0x28ff6c = _0x35d179['userAvatarFrameUrl'] || ''); } else _0x4b1b01 = {}; } _0x2e7adf[_0x1eb5f5(0x10d)][_0x1eb5f5(0x5b4)] = _0x1eb5f5(0x8ba), _0x2e7adf[_0x1eb5f5(0x10d)][_0x1eb5f5(0xab5)] = '', _0x2e7adf['style'][_0x1eb5f5(0xf8)] = '', _0x2e7adf['style'][_0x1eb5f5(0x857)] = '', _0x2e7adf[_0x1eb5f5(0x10d)][_0x1eb5f5(0x61d)] = '', _0x2e7adf['style'][_0x1eb5f5(0xa10)] = ''; if (typeof _0x4b1b01['top'] === _0x1eb5f5(0xa74) && typeof _0x4b1b01['left'] === _0x1eb5f5(0xa74)) _0x2e7adf[_0x1eb5f5(0x10d)][_0x1eb5f5(0xab5)] = _0x4b1b01['top'] + '%', _0x2e7adf[_0x1eb5f5(0x10d)][_0x1eb5f5(0xf8)] = _0x4b1b01['left'] + '%'; else for (const _0x38d843 in _0x1f2a97) { _0x1eb5f5(0x14e) === 'AhtIN' ? _0x5e2bcd[_0x1eb5f5(0x36b)]('[' + _0xd48d3e + _0x1eb5f5(0xaa1) + _0x2b9aa9(_0x4e7a8e) + ']\x20' + _0x5f08b5(_0x26bd16['content'])['trim']()) : _0x2e7adf['style'][_0x38d843] = _0x1f2a97[_0x38d843]; } }; _0x2745e6(_0x241057(0x7e6), _0x241057(0x343), { 'top': _0x241057(0x7d1), 'left': _0x241057(0x9c4), 'transform': _0x241057(0x7bd) }), _0x2745e6(_0x241057(0x4ff), 'appIconPosition_app-wallpaper', { 'top': _0x241057(0x35c), 'right': '4%' }), _0x2745e6('app-user-profiles', _0x241057(0x625), { 'top': '20%', 'right': _0x241057(0x646) }), _0x2745e6(_0x241057(0xa1d), 'appIconPosition_app-settings', { 'top': '8%', 'right': _0x241057(0x646) }), _0x2745e6('app-world-book', _0x241057(0xa02), { 'top': '8%', 'right': '4%' }), _0x2745e6(_0x241057(0x926), _0x241057(0xa80), { 'top': '59%', 'left': '5%' }), _0x2745e6(_0x241057(0x746), _0x241057(0x74d), { 'top': _0x241057(0xad7), 'left': '29%' }), _0x2745e6(_0x241057(0x898), _0x241057(0x174), { 'top': '71%', 'left': '5%' }), _0x2745e6(_0x241057(0x816), _0x241057(0x9cc), { 'top': _0x241057(0x2a3), 'left': '29%' }), _0x2745e6('decorative-badge', _0x241057(0x507), { 'top': _0x241057(0x9c2), 'right': '5%' }), _0x2745e6(_0x241057(0x6c9), _0x241057(0x88d), { 'top': '8%', 'left': '5%' }); const _0xa4ef44 = document[_0x241057(0x248)]('card-widget'); _0xa4ef44 && (_0x241057(0x4d2) === _0x241057(0x3cb) ? _0x465ec0 = _0x241057(0xad2) : (_0xa4ef44[_0x241057(0x10d)]['position'] = _0x241057(0x8ba), _0xa4ef44[_0x241057(0x10d)][_0x241057(0xab5)] = _0x241057(0x51c), _0xa4ef44[_0x241057(0x10d)]['left'] = _0x241057(0x9c4), _0xa4ef44['style'][_0x241057(0xa10)] = _0x241057(0x7bd), _0xa4ef44['style'][_0x241057(0x5eb)] = _0x241057(0x92c))); const _0x5c2d91 = document['getElementById'](_0x241057(0x424)); _0x5c2d91 && (_0x5c2d91['style']['position'] = _0x241057(0x8ba), _0x5c2d91[_0x241057(0x10d)][_0x241057(0xab5)] = '35%', _0x5c2d91['style'][_0x241057(0xf8)] = '50%', _0x5c2d91['style'][_0x241057(0xa10)] = 'translateX(-50%)', _0x5c2d91[_0x241057(0x10d)]['display'] = 'inline-block'); } function _0x46c2d9() { const _0x58e112 = _0x1da6ac, _0x4ceb09 = document[_0x58e112(0x248)]('custom-icon-list-container'); _0x4ceb09['innerHTML'] = ''; const _0x509bea = document['querySelectorAll'](_0x58e112(0xa44)); _0x509bea[_0x58e112(0x986)](_0x19a73e => { const _0x1737d0 = _0x58e112; if (_0x1737d0(0x42d) === _0x1737d0(0x42d)) { const _0x5ec3d3 = _0x19a73e['id'], _0x1a7be0 = _0x19a73e[_0x1737d0(0x838)]('span')[_0x1737d0(0x9ac)], _0x39d7d6 = _0x1737d0(0xa01) + _0x5ec3d3, _0x1cb32f = localStorage[_0x1737d0(0x915)](_0x39d7d6), _0x13f744 = document[_0x1737d0(0x3b9)]('div'); _0x13f744[_0x1737d0(0x296)] = _0x1737d0(0x903), _0x13f744[_0x1737d0(0x10d)][_0x1737d0(0x8cd)] = _0x1737d0(0x831), _0x13f744['innerHTML'] = _0x1737d0(0xa8c) + _0x5ec3d3 + _0x1737d0(0x3d2) + (_0x1cb32f || _0x1737d0(0x97b)) + '\x22\x20class=\x22char-avatar\x22\x20style=\x22border-radius:\x2012px;\x20background-color:\x20#eee;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22flex-grow:\x201;\x22>' + _0x1a7be0 + _0x1737d0(0x8c6) + _0x5ec3d3 + '\x22\x20accept=\x22image/*\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x22\x20onclick=\x22document.getElementById(\x27input_' + _0x5ec3d3 + _0x1737d0(0x3cc) + _0x39d7d6 + '\x27);\x20location.reload();\x22>恢复</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x4ceb09[_0x1737d0(0x6ab)](_0x13f744); const _0x422f78 = document['getElementById']('input_' + _0x5ec3d3); _0x422f78['addEventListener']('change', async _0x4b1a39 => { const _0x474206 = _0x1737d0, _0x5d1c62 = _0x4b1a39[_0x474206(0x6c4)][_0x474206(0x5fc)][0x0]; if (!_0x5d1c62) return; try { if (_0x474206(0x3ca) === 'httcI') { const _0x31c76e = await _0x1f8d37(_0x5d1c62); localStorage[_0x474206(0x9e0)](_0x39d7d6, _0x31c76e), document[_0x474206(0x248)]('preview_' + _0x5ec3d3)[_0x474206(0x70a)] = _0x31c76e, _0x1bbcb7(); } else _0x1368c0['innerHTML'] = _0x474206(0x613) + _0x2606a0 + _0x474206(0x641) + _0x41844f + _0x474206(0x5f9) + _0x1d67ad['songName'] + _0x474206(0x5c8) + _0x5a35c[_0x474206(0x755)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22' + _0x3e13b7[_0x474206(0x181)] + _0x474206(0x42e); } catch (_0x44c44f) { _0x3a6c86(_0x474206(0x203) + _0x44c44f[_0x474206(0x380)]); } }); } else _0x3cc8f0[_0x1737d0(0x450)][_0x1737d0(0xa2c)](_0x1737d0(0x1bf), '<style\x20id=\x22snoop-temp-style\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.snoop-avatar\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20background:\x20#e5e7eb;\x20color:\x20#4b5563;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x200\x208px;\x20flex-shrink:\x200;\x20align-self:\x20flex-end;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>'); }); } function _0x1bbcb7() { const _0x387fcd = _0x1da6ac, _0x1bb9f8 = document['querySelectorAll'](_0x387fcd(0xa44)); _0x1bb9f8['forEach'](_0x3b11e5 => { const _0x40bf32 = _0x387fcd; if (_0x40bf32(0x121) === _0x40bf32(0x121)) { const _0x3f60eb = _0x3b11e5['id'], _0x40f9f6 = _0x40bf32(0xa01) + _0x3f60eb, _0x38e8fe = localStorage[_0x40bf32(0x915)](_0x40f9f6), _0x325713 = _0x3b11e5['querySelector'](_0x40bf32(0xa2e)); if (_0x38e8fe) _0x325713[_0x40bf32(0x9a1)] = _0x40bf32(0x2ae) + _0x38e8fe + '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>'; else { const _0x328647 = document[_0x40bf32(0x838)](_0x40bf32(0x19b) + _0x3f60eb + _0x40bf32(0x369) + _0x3f60eb + _0x40bf32(0x4cd))?.[_0x40bf32(0x9a1)]; _0x328647 && (_0x40bf32(0x286) !== _0x40bf32(0x74a) ? _0x325713[_0x40bf32(0x9a1)] = _0x328647 : (_0x58914d[_0x40bf32(0x729)](_0x40bf32(0x715), _0x46f154), _0x2277d0('保存壁纸失败:\x20' + _0x370a8d[_0x40bf32(0x380)]))); } } else { const _0x398edd = _0x5ad79d(_0x5a7c08[_0x40bf32(0x5fa)]); _0x398edd && (_0x10ea23 = _0x398edd[_0x40bf32(0x6b7)], _0x15b02f = _0x398edd[_0x40bf32(0x917)]); } }); } function _0x9b6aa6() { const _0x1903d9 = _0x1da6ac; if (_0x1903d9(0x768) === _0x1903d9(0x768)) { const _0xb37e01 = _0x10530c[_0x1903d9(0x7b9)][_0x1903d9(0x212)](_0x1bfbb9 => _0x1bfbb9['id'] === _0x10530c['activeFriendCircleId']), _0x4d2a37 = _0x27b19d(); let _0x1a75cd = []; if (_0xb37e01 && _0xb37e01[_0x1903d9(0x3d6)]) { const _0x5188ee = _0xb37e01[_0x1903d9(0x3d6)][_0x1903d9(0x54e)](_0x26d949 => _0x26d949[_0x1903d9(0xa78)] === 'music' && _0x26d949['playableUrl'])[_0x1903d9(0xa21)](_0x7dccd7 => ({ ..._0x7dccd7, 'source': _0x1903d9(0x545) })); _0x1a75cd[_0x1903d9(0x36b)](..._0x5188ee); } if (_0x4d2a37 && _0x10530c[_0x1903d9(0x675)]) { const _0x56caef = _0x10530c[_0x1903d9(0x675)][_0x1903d9(0x54e)](_0x4d0e95 => _0x4d0e95['type'] === _0x1903d9(0x868) && _0x4d0e95[_0x1903d9(0x5e3)])[_0x1903d9(0xa21)](_0x542ac6 => ({ ..._0x542ac6, 'source': _0x1903d9(0x78c) })); _0x1a75cd[_0x1903d9(0x36b)](..._0x56caef); } const _0x23d11b = Array[_0x1903d9(0x10f)](new Map(_0x1a75cd[_0x1903d9(0xa21)](_0x1bf43b => [_0x1bf43b[_0x1903d9(0x5e3)], _0x1bf43b]))[_0x1903d9(0x25e)]()); _0x10530c[_0x1903d9(0x30c)] = _0x23d11b[_0x1903d9(0xaa6)]((_0x49816f, _0x3f7c41) => _0x3f7c41[_0x1903d9(0x908)] - _0x49816f[_0x1903d9(0x908)]); } else { let _0x2f1bf5 = 0x0, _0x199b82 = 0x0, _0x1f85bb = 0x0; if (_0x2346a2[_0x1903d9(0x848)] == 0x4) _0x2f1bf5 = '0x' + _0x6e8b42[0x1] + _0x93cda5[0x1], _0x199b82 = '0x' + _0x6ef130[0x2] + _0x563e59[0x2], _0x1f85bb = '0x' + _0x51e703[0x3] + _0xd54ca1[0x3]; else _0x54265f[_0x1903d9(0x848)] == 0x7 && (_0x2f1bf5 = '0x' + _0x5e282b[0x1] + _0x25874b[0x2], _0x199b82 = '0x' + _0x44c3b9[0x3] + _0xb9857[0x4], _0x1f85bb = '0x' + _0x10864c[0x5] + _0x17b9bc[0x6]); _0x2f1bf5 /= 0xff, _0x199b82 /= 0xff, _0x1f85bb /= 0xff; let _0xa2a080 = _0x2abbd5['min'](_0x2f1bf5, _0x199b82, _0x1f85bb), _0x5948c1 = _0x3f2a65['max'](_0x2f1bf5, _0x199b82, _0x1f85bb), _0x3e62ee = _0x5948c1 - _0xa2a080, _0x4631b0 = 0x0, _0x1dd836 = 0x0, _0x1f3fe4 = 0x0; if (_0x3e62ee == 0x0) _0x4631b0 = 0x0; else { if (_0x5948c1 == _0x2f1bf5) _0x4631b0 = (_0x199b82 - _0x1f85bb) / _0x3e62ee % 0x6; else { if (_0x5948c1 == _0x199b82) _0x4631b0 = (_0x1f85bb - _0x2f1bf5) / _0x3e62ee + 0x2; else _0x4631b0 = (_0x2f1bf5 - _0x199b82) / _0x3e62ee + 0x4; } } _0x4631b0 = _0x2facc8[_0x1903d9(0x2c8)](_0x4631b0 * 0x3c); if (_0x4631b0 < 0x0) _0x4631b0 += 0x168; return _0x1f3fe4 = (_0x5948c1 + _0xa2a080) / 0x2, _0x1dd836 = _0x3e62ee == 0x0 ? 0x0 : _0x3e62ee / (0x1 - _0xb35079[_0x1903d9(0x20b)](0x2 * _0x1f3fe4 - 0x1)), _0x1dd836 = +(_0x1dd836 * 0x64)[_0x1903d9(0x7d5)](0x1), _0x1f3fe4 = +(_0x1f3fe4 * 0x64)[_0x1903d9(0x7d5)](0x1), { 'h': _0x4631b0, 's': _0x1dd836, 'l': _0x1f3fe4 }; } } function _0x26aa7c(_0x406bc5) { const _0x6a17a0 = _0x1da6ac; if (_0x406bc5 < 0x0 || _0x406bc5 >= _0x32c055[_0x6a17a0(0x848)]) return; _0x226610 = _0x406bc5; const _0x4827c8 = _0x32c055[_0x406bc5]; _0x2af425[_0x6a17a0(0x70a)] = _0x4827c8[_0x6a17a0(0x5e3)] || _0x4827c8[_0x6a17a0(0x83a)], _0x2af425['play'](), _0xc19ba3(), _0x2bdea9(); } function _0xc19ba3() { const _0xb8f1e7 = _0x32c055[_0x226610]; _0x54ff46(_0xb8f1e7); } function _0x2bdea9() { const _0x5201ca = _0x1da6ac; if (_0x5201ca(0x6fa) === _0x5201ca(0x6fa)) try { _0x5201ca(0x4c8) !== _0x5201ca(0x4c8) ? (_0x3f917d *= _0x1ccf27 / _0x163cd1, _0x3eddd1 = _0x5eb0e5) : localStorage[_0x5201ca(0x9e0)]('musicPlayerState', JSON[_0x5201ca(0x22e)]({ 'playlist': _0x10530c[_0x5201ca(0x30c)], 'currentIndex': _0x10530c['currentlyPlayingIndex'] })); } catch (_0x49f2e3) { if (_0x5201ca(0x906) !== _0x5201ca(0x418)) console['error'](_0x5201ca(0x3ab), _0x49f2e3); else { const _0x3ae975 = _0x5558c6[_0x5201ca(0x634)][_0x5201ca(0x5f8)](), _0x34c157 = _0x4e1da0[_0x5201ca(0x634)][_0x5201ca(0xa84)](); _0xcd2060[_0x5201ca(0x248)]('calendar-header-title')[_0x5201ca(0x9ac)] = _0x3ae975 + '年\x20' + (_0x34c157 + 0x1) + '月', _0xd6be92(_0x3ae975, _0x34c157), _0x586985(_0x5c8adc['selectedDate']); } } else _0x446847(_0xc695c8[_0x5201ca(0x35f)])[_0x5201ca(0x45f)](_0x2d7c3f => { const _0x350928 = _0x5201ca; if (_0x2d7c3f) { const _0x4ff654 = _0x5c8e7b[_0x350928(0x73d)](_0x2d7c3f); _0x2ed0d3[_0x350928(0x70a)] = _0x4ff654, _0x3b9854[_0x350928(0x744)] = () => _0x29546c[_0x350928(0x8df)](_0x4ff654); } }); } function _0x136fde() { const _0x5cd085 = _0x1da6ac; try { const _0x5391be = localStorage[_0x5cd085(0x915)](_0x5cd085(0xca)); if (_0x5391be) { if (_0x5cd085(0x1d9) === _0x5cd085(0x9b9)) { _0x8ee3f6['activeMeetingScriptQueue'] = [..._0x4b2e8e], _0x46d633[_0x5cd085(0x1be)][_0x1b530e['id']] = [..._0x4f65d1], _0x4b9788(); const _0x19fc4a = _0x3e2afa[_0x5cd085(0xa21)](_0xf28eae => _0xf28eae[_0x5cd085(0x10c)] === _0x5cd085(0x623) ? _0xf28eae[_0x5cd085(0x9f7)] : _0xf28eae[_0x5cd085(0x10c)] + ':\x20' + _0xf28eae[_0x5cd085(0x9f7)])[_0x5cd085(0x64e)]('\x0a\x0a'); _0x4c6df0[_0x5cd085(0x675)][_0x5cd085(0x36b)]({ 'role': 'assistant', 'senderId': _0x58ae86['id'], 'timestamp': _0x5a3e98['now'](), 'isOffline': !![], 'content': _0x19fc4a }); } else { const { playlist: _0x57b76d, currentIndex: _0x115ca5 } = JSON[_0x5cd085(0x329)](_0x5391be); Array['isArray'](_0x57b76d) && _0x57b76d[_0x5cd085(0x848)] > 0x0 && _0x115ca5 > -0x1 && (_0x10530c['musicPlaylist'] = _0x57b76d, _0x10530c[_0x5cd085(0x79f)] = _0x115ca5, _0x10530c[_0x5cd085(0x73c)] = ![], _0xc19ba3()); } } } catch (_0x3c6a78) { console[_0x5cd085(0x729)](_0x5cd085(0x561), _0x3c6a78); } } function _0x2e469a(_0x1846ed) { const _0x14eda8 = _0x1da6ac; if (window[_0x14eda8(0x42b)]) clearTimeout(window[_0x14eda8(0x42b)]); const _0x24ccb2 = _0x1846ed[_0x14eda8(0x6c4)][_0x14eda8(0x939)]('.diary-entry'); if (!_0x24ccb2) return; const _0xdd42b = _0x24ccb2[_0x14eda8(0xab1)]['timestamp'], _0x3c0832 = _0x24ccb2[_0x14eda8(0x882)]['contains'](_0x14eda8(0x27a)) ? _0x14eda8(0x27a) : 'ai'; if (!_0xdd42b) return; const _0x33f97a = () => { const _0x5d195b = _0x14eda8; window[_0x5d195b(0x42b)] = setTimeout(() => { const _0x2fb535 = _0x5d195b; if (_0x1846ed[_0x2fb535(0xa78)] === _0x2fb535(0x936)) _0x1846ed[_0x2fb535(0x148)](); _0xb642af(parseInt(_0xdd42b, 0xa), _0x3c0832); }, 0x320); }, _0x4e5202 = () => { const _0x2bfa51 = _0x14eda8; if (window['diaryPressTimer']) clearTimeout(window[_0x2bfa51(0x42b)]); }; document[_0x14eda8(0x578)](_0x14eda8(0x529), _0x4e5202, { 'once': !![] }), document[_0x14eda8(0x578)](_0x14eda8(0xa13), _0x4e5202, { 'once': !![] }), document[_0x14eda8(0x578)](_0x14eda8(0xa3c), _0x4e5202, { 'once': !![] }), _0x33f97a(); } function _0xb642af(_0x38a911, _0x334b40) { const _0x34f87e = _0x1da6ac; if (_0x34f87e(0x9c6) === 'XrwyG') _0x444d24[_0x34f87e(0xa4a)] = ![], _0x224a94(![]); else { const _0x3f83d8 = _0x34f87e(0xab7) + _0x38a911; let _0x3e4c1f = document[_0x34f87e(0x248)](_0x3f83d8); if (_0x3e4c1f) return; const _0x29ea77 = _0x34f87e(0x929) + _0x3f83d8 + _0x34f87e(0x3e9) + (_0x334b40 === 'ai' ? _0x34f87e(0x97a) : '') + _0x34f87e(0x3a8); document[_0x34f87e(0x3ec)][_0x34f87e(0xa2c)](_0x34f87e(0x1bf), _0x29ea77); const _0x4a4a97 = document[_0x34f87e(0x248)](_0x3f83d8), _0x5104e1 = () => _0x4a4a97[_0x34f87e(0xae0)](); _0x4a4a97[_0x34f87e(0x838)](_0x34f87e(0x279))[_0x34f87e(0x935)] = _0x5104e1, _0x4a4a97[_0x34f87e(0x838)]('#diary-action-cancel')[_0x34f87e(0x935)] = _0x5104e1, _0x4a4a97['querySelector'](_0x34f87e(0x17c))[_0x34f87e(0x935)] = () => { _0x131cc4(_0x38a911), _0x5104e1(); }; if (_0x334b40 === 'ai') { if (_0x34f87e(0x110) === _0x34f87e(0x4ed)) return _0x34f87e(0x630) + _0x6d21cf; else _0x4a4a97['querySelector'](_0x34f87e(0xa6d))[_0x34f87e(0x935)] = () => { const _0x55d864 = _0x34f87e; _0x55d864(0x44d) === _0x55d864(0x44d) ? (_0x4e4c3b(_0x38a911), _0x5104e1()) : (_0x5a1831(), _0x459f23(_0x55d864(0x6fc), _0x55d864(0x362))); }; } } } async function _0x131cc4(_0x308e90) { const _0x553721 = _0x1da6ac, _0xd95f94 = await _0x52e7d6('确定要删除这篇日记吗？此操作不可撤销。'); if (!_0xd95f94) return; const _0x1ba636 = _0x10530c['diaries'][_0x553721(0x212)](_0x4e9050 => _0x4e9050[_0x553721(0x542)] === _0x10530c[_0x553721(0x4de)]); if (!_0x1ba636) return; const _0x4120dc = _0x1ba636['entries']['findIndex'](_0xf9ccf9 => _0xf9ccf9[_0x553721(0x908)] === _0x308e90); _0x4120dc > -0x1 && ('aJyUW' === 'RxAZP' ? _0x4afa26(_0x553721(0x30d)) : (_0x1ba636[_0x553721(0x17b)][_0x553721(0x2f2)](_0x4120dc, 0x1), _0x3e6d3a(), _0x4593c2(), _0x3a6c86('日记已删除。'))); } async function _0x4e4c3b(_0x9e0418) { const _0x180cdb = _0x1da6ac; if (_0x180cdb(0x548) === _0x180cdb(0x548)) { const _0x15f886 = _0x10530c['diaries'][_0x180cdb(0x212)](_0x2926ef => _0x2926ef[_0x180cdb(0x542)] === _0x10530c['activeDiaryCharacterId']); if (!_0x15f886) return; const _0x33bbc7 = _0x15f886[_0x180cdb(0x17b)][_0x180cdb(0x981)](_0x3db8af => _0x3db8af[_0x180cdb(0x908)] === _0x9e0418); _0x33bbc7 > -0x1 && ('AcLQd' !== _0x180cdb(0xf2) ? (_0x15f886['entries'][_0x180cdb(0x2f2)](_0x33bbc7, 0x1), _0x3e6d3a(), _0x4593c2(), await _0x1ac9b9()) : _0xe4da26()); } else { if (!_0x2cd3b7[_0x180cdb(0x796)](_0x40a41e)) return _0x180cdb(0x5e4); if (_0x4cd561['length'] === 0x0) return _0x180cdb(0x267); return _0x53aa6d[_0x180cdb(0xaa6)]((_0x5d5f8c, _0xa1240d) => new _0x53240a(_0xa1240d[_0x180cdb(0x908)]) - new _0x103c5b(_0x5d5f8c['timestamp'])), _0x41ab87[_0x180cdb(0xa21)](_0x2b55e4 => _0x180cdb(0x192) + (_0x2b55e4['store_name'] || '未知商店') + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22float:\x20right;\x22>' + (_0x2b55e4[_0x180cdb(0x908)] || '') + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22width:\x2070px;\x20height:\x2070px;\x20background-color:\x20#f0f2f5;\x20border-radius:\x208px;\x20font-size:\x202.5rem;\x20flex-shrink:\x200;\x22>🛍️</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22flex-grow:\x201;\x20display:\x20flex;\x20flex-direction:\x20column;\x20justify-content:\x20space-between;\x20height:\x2070px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20500;\x20line-height:\x201.4;\x20-webkit-line-clamp:\x202;\x20display:\x20-webkit-box;\x20-webkit-box-orient:\x20vertical;\x20overflow:\x20hidden;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x2b55e4['item_name'] || _0x180cdb(0x3be)) + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x20font-weight:\x20bold;\x20color:\x20var(--accent-color);\x20text-align:\x20right;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20¥\x20' + (_0x2b55e4['cost'] || 0x0)['toFixed'](0x2) + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20')[_0x180cdb(0x64e)](''); } } async function _0x28da8d() { const _0x3e2e88 = _0x1da6ac, _0x58030f = document[_0x3e2e88(0x248)](_0x3e2e88(0x225)); _0x58030f['innerHTML'] = ''; const _0x4cb7ac = _0x10530c[_0x3e2e88(0x620)][_0x3e2e88(0x54e)](_0x3c883f => _0x10530c[_0x3e2e88(0x4bc)][_0x3e2e88(0xacd)](_0x4c9bc5 => _0x4c9bc5[_0x3e2e88(0xa78)] === _0x3e2e88(0x71a) && _0x4c9bc5[_0x3e2e88(0x26f)]['includes'](_0x3c883f['id']))); if (_0x4cb7ac['length'] === 0x0) { _0x58030f[_0x3e2e88(0x9a1)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>'; return; } for (const _0x89eeb of _0x4cb7ac) { if (_0x3e2e88(0x9b7) === _0x3e2e88(0x14f)) { const _0x3ac91d = { 'id': _0x3e2e88(0x22c) + _0x2bc60d[_0x3e2e88(0x7a8)](), ..._0xdd04 }; _0x577204[_0x3e2e88(0x360)][_0x3e2e88(0x36b)](_0x3ac91d), !_0x4c6be0['activeUserProfileId'] && (_0x8f55d0['activeUserProfileId'] = _0x3ac91d['id']); } else { const _0x488feb = document[_0x3e2e88(0x3b9)]('li'); _0x488feb[_0x3e2e88(0x296)] = _0x3e2e88(0x833), _0x488feb['dataset']['charId'] = _0x89eeb['id']; const _0x59762e = await _0x533d7a('char_avatar_' + _0x89eeb['id']), _0x53a719 = _0x59762e ? URL[_0x3e2e88(0x73d)](_0x59762e) : _0x89eeb[_0x3e2e88(0x917)] || _0x5da029; _0x488feb[_0x3e2e88(0x9a1)] = _0x3e2e88(0x3a1) + _0x53a719 + _0x3e2e88(0x298) + _0x89eeb[_0x3e2e88(0x6b7)] + _0x3e2e88(0xd5), _0x488feb[_0x3e2e88(0x838)](_0x3e2e88(0x6ae))[_0x3e2e88(0x578)]('click', () => { const _0x32c5c4 = _0x3e2e88; if (_0x32c5c4(0x3dc) !== 'sZisl') _0x305f77(_0x89eeb['id']); else { const _0x45b4e4 = _0x81aa95(); _0x45b4e4 && _0x45b4e4[_0x32c5c4(0xaae)] && _0x45b4e4[_0x32c5c4(0xaae)][_0x32c5c4(0x979)] && (_0x46d55a[_0x32c5c4(0x10d)][_0x32c5c4(0x5eb)] = _0x32c5c4(0x4ef), _0xb295e6(() => _0x4e8c70[_0x32c5c4(0x882)]['add'](_0x32c5c4(0x11b)), 0xa)); } }), _0x488feb[_0x3e2e88(0x838)](_0x3e2e88(0x448))[_0x3e2e88(0x578)](_0x3e2e88(0x4b3), _0x4ed78a => { const _0x597d15 = _0x3e2e88; if (_0x597d15(0x7c1) !== 'igzdD') { _0x32c46a(_0x597d15(0x7d6)); return; } else _0x4ed78a[_0x597d15(0x387)](), _0x5cfdb2(_0x89eeb['id']); }), _0x58030f[_0x3e2e88(0x6ab)](_0x488feb); } } } function _0x305f77(_0x412eea) { const _0xe0bc68 = _0x1da6ac; if ('VeeNo' === _0xe0bc68(0xc8)) { const _0x3ccf7c = _0x5b19fc(_0x412eea); if (!_0x3ccf7c) return; _0x10530c[_0xe0bc68(0x4de)] = _0x412eea; const _0x35ab4c = _0x10530c[_0xe0bc68(0x938)]['find'](_0x31190c => _0x31190c[_0xe0bc68(0x542)] === _0x412eea), _0x24c181 = _0x35ab4c ? _0x35ab4c['entries']['length'] : 0x0, _0x393bcf = 0x2; _0x10530c[_0xe0bc68(0x2aa)] = Math[_0xe0bc68(0x21d)](0x0, Math['ceil'](_0x24c181 / _0x393bcf) - 0x1), document[_0xe0bc68(0x248)](_0xe0bc68(0x108))['textContent'] = _0x3ccf7c[_0xe0bc68(0x6b7)] + _0xe0bc68(0x6aa), _0x4593c2(), _0x1c4afc('diaryView', _0xe0bc68(0x90d)); } else { const _0x4e8a5c = _0x38c088[_0xe0bc68(0x319)](_0x3b017b, _0xe0bc68(0x559)), _0x3db14e = _0x4e8a5c['objectStore'](_0x2418c2), _0x899f8e = _0x3db14e['get'](_0x64cec4); _0x899f8e['onsuccess'] = () => _0x4cc929(_0x899f8e[_0xe0bc68(0x4f7)]), _0x899f8e['onerror'] = () => _0x5c60dc(_0x899f8e[_0xe0bc68(0x729)]); } } function _0x4593c2() { const _0x1b9b72 = _0x1da6ac; if (_0x1b9b72(0x260) !== _0x1b9b72(0x771)) { const _0x993fbd = document[_0x1b9b72(0x248)](_0x1b9b72(0x7fc)), _0x4a5022 = document[_0x1b9b72(0x248)]('diary-input-wrapper'); _0x993fbd[_0x1b9b72(0x9a1)] = '', _0x4a5022[_0x1b9b72(0x9a1)] = ''; const _0xe94216 = _0x146846() || { 'name': '我' }, _0x4b0557 = _0x10530c['diaries'][_0x1b9b72(0x212)](_0x41796b => _0x41796b[_0x1b9b72(0x542)] === _0x10530c[_0x1b9b72(0x4de)]); if (!_0x4b0557 || !_0x4b0557[_0x1b9b72(0x17b)] || _0x4b0557[_0x1b9b72(0x17b)][_0x1b9b72(0x848)] === 0x0) { if (_0x1b9b72(0x733) === 'SNnQJ') { _0x993fbd['innerHTML'] = _0x1b9b72(0xf4), _0x4a5022[_0x1b9b72(0x9a1)] = _0x1b9b72(0xa7d), document[_0x1b9b72(0x248)](_0x1b9b72(0x644))['addEventListener']('click', _0x44f2e1), document[_0x1b9b72(0x248)](_0x1b9b72(0xa3d))[_0x1b9b72(0x578)](_0x1b9b72(0x4b3), _0x1ac9b9); return; } else { if (!_0x5ca569) return []; const _0x3a2ebb = _0x14dcc8[_0x1b9b72(0x5ac)]('\x0a'), _0x44626a = [], _0x5ec684 = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x553325 of _0x3a2ebb) { const _0xa9c45f = _0x553325[_0x1b9b72(0x11d)](_0x5ec684); if (_0xa9c45f) { const _0x242e5f = _0xd94b29(_0xa9c45f[0x1], 0xa), _0x324026 = _0x338a87(_0xa9c45f[0x2], 0xa), _0x573572 = _0x5e11b0(_0xa9c45f[0x3], 0xa) * (_0xa9c45f[0x3]['length'] === 0x2 ? 0xa : 0x1), _0x196610 = _0x242e5f * 0x3c + _0x324026 + _0x573572 / 0x3e8, _0xef429b = _0x553325[_0x1b9b72(0x7cf)](_0x5ec684, '')[_0x1b9b72(0x3ee)](); _0xef429b && _0x44626a[_0x1b9b72(0x36b)]({ 'time': _0x196610, 'text': _0xef429b }); } } return _0x44626a; } } const _0x4e104f = 0x2, _0x38d638 = [..._0x4b0557[_0x1b9b72(0x17b)]][_0x1b9b72(0xaa6)]((_0x57863a, _0x495679) => _0x57863a[_0x1b9b72(0x908)] - _0x495679[_0x1b9b72(0x908)]), _0x1b1608 = []; for (let _0x2fd203 = 0x0; _0x2fd203 < _0x38d638[_0x1b9b72(0x848)]; _0x2fd203 += _0x4e104f) { _0x1b1608[_0x1b9b72(0x36b)](_0x38d638['slice'](_0x2fd203, _0x2fd203 + _0x4e104f)); } const _0xb41520 = _0x1b1608[_0x1b9b72(0x848)]; _0x1b1608['forEach']((_0x3aa6c6, _0x599459) => { const _0x50ad5a = _0x1b9b72; if (_0x50ad5a(0x6e5) === _0x50ad5a(0xa72)) _0x4608e6[_0x50ad5a(0x248)](_0x50ad5a(0x705))['click'](); else { const _0x360430 = document[_0x50ad5a(0x3b9)](_0x50ad5a(0x6ff)); _0x360430[_0x50ad5a(0x296)] = _0x50ad5a(0x7c0), _0x360430['id'] = _0x50ad5a(0x9da) + _0x599459, _0x599459 === _0x10530c['diaryCurrentPage'] && _0x360430['classList'][_0x50ad5a(0x7c3)]('is-visible'), _0x3aa6c6['forEach'](_0x2f1f71 => { const _0x149267 = _0x50ad5a, _0x114361 = _0x2f1f71[_0x149267(0xe8)] === _0x149267(0x27a) ? _0x149267(0x27a) : 'ai', _0x11e876 = _0x2f1f71[_0x149267(0xe8)] === _0x149267(0x27a) ? _0xe94216['name'] : _0x5b19fc(_0x2f1f71['author'])[_0x149267(0x6b7)], _0x23cad1 = document[_0x149267(0x3b9)](_0x149267(0x6ff)); _0x23cad1[_0x149267(0x296)] = _0x149267(0x54c) + _0x114361, _0x23cad1[_0x149267(0xab1)]['timestamp'] = _0x2f1f71[_0x149267(0x908)], _0x23cad1[_0x149267(0x10d)]['borderBottom'] = _0x149267(0x3fe), _0x23cad1['style']['paddingBottom'] = '0', _0x23cad1['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>' + _0x11e876 + _0x149267(0x669) + new Date(_0x2f1f71[_0x149267(0x908)])[_0x149267(0x446)]('zh-CN') + _0x149267(0x79c) + _0x2f1f71[_0x149267(0x9a8)][_0x149267(0x7cf)](/\n/g, _0x149267(0x227)) + _0x149267(0x6b1), _0x360430[_0x149267(0x6ab)](_0x23cad1); }), _0x993fbd[_0x50ad5a(0x6ab)](_0x360430); } }), _0x4a5022[_0x1b9b72(0x9a1)] = _0x1b9b72(0x862) + (_0x10530c[_0x1b9b72(0x2aa)] + 0x1) + '\x20/\x20' + _0xb41520 + _0x1b9b72(0x575), document[_0x1b9b72(0x248)](_0x1b9b72(0x621))[_0x1b9b72(0xf6)] = _0x10530c[_0x1b9b72(0x2aa)] === 0x0, document[_0x1b9b72(0x248)](_0x1b9b72(0x67c))[_0x1b9b72(0xf6)] = _0x10530c[_0x1b9b72(0x2aa)] === _0xb41520 - 0x1, document['getElementById']('diary-prev-button')['addEventListener'](_0x1b9b72(0x4b3), _0x1f74c1), document[_0x1b9b72(0x248)](_0x1b9b72(0x67c))['addEventListener'](_0x1b9b72(0x4b3), _0x37c722), document[_0x1b9b72(0x248)]('diary-write-button')[_0x1b9b72(0x578)](_0x1b9b72(0x4b3), _0x44f2e1), document[_0x1b9b72(0x248)](_0x1b9b72(0xa3d))['addEventListener'](_0x1b9b72(0x4b3), _0x1ac9b9); } else { const _0x1217d8 = _0x3d27ae[_0x1b9b72(0x319)](_0x5336c9, _0x1b9b72(0x559)), _0x43d8ab = _0x1217d8[_0x1b9b72(0x963)](_0x2ca769), _0x4b0667 = _0x43d8ab[_0x1b9b72(0xa25)](_0x350eca); _0x4b0667[_0x1b9b72(0x330)] = () => _0x10a32d(_0x4b0667[_0x1b9b72(0x4f7)] ? _0x4b0667[_0x1b9b72(0x4f7)][_0x1b9b72(0x9be)] : null), _0x4b0667[_0x1b9b72(0x136)] = () => _0x53707b(_0x4b0667[_0x1b9b72(0x729)]); } } function _0x37c722() { const _0x3d5dc6 = _0x1da6ac; if (_0x10530c[_0x3d5dc6(0x59e)]) return; const _0x40e979 = _0x10530c[_0x3d5dc6(0x2aa)], _0x2fb18f = Math[_0x3d5dc6(0x16f)](_0x10530c[_0x3d5dc6(0x938)][_0x3d5dc6(0x212)](_0x1ba901 => _0x1ba901[_0x3d5dc6(0x542)] === _0x10530c[_0x3d5dc6(0x4de)])[_0x3d5dc6(0x17b)][_0x3d5dc6(0x848)] / 0x2); if (_0x40e979 >= _0x2fb18f - 0x1) return; _0x10530c[_0x3d5dc6(0x59e)] = !![]; const _0x161d34 = _0x40e979 + 0x1, _0x2d736a = document[_0x3d5dc6(0x248)](_0x3d5dc6(0x9da) + _0x40e979), _0x599899 = document['getElementById'](_0x3d5dc6(0x9da) + _0x161d34); _0x2d736a && _0x599899 ? (_0x599899[_0x3d5dc6(0x882)][_0x3d5dc6(0x7c3)]('is-entering-from-right'), _0x2d736a[_0x3d5dc6(0x882)][_0x3d5dc6(0x7c3)](_0x3d5dc6(0x8d9)), _0x599899[_0x3d5dc6(0x882)][_0x3d5dc6(0x7c3)](_0x3d5dc6(0x2cd)), setTimeout(() => { const _0xa73d81 = _0x3d5dc6; _0xa73d81(0x299) !== _0xa73d81(0x97d) ? (_0x2d736a[_0xa73d81(0x882)][_0xa73d81(0xae0)](_0xa73d81(0x2cd), 'is-exiting-left'), _0x599899[_0xa73d81(0x882)]['remove']('is-entering-from-right'), _0x10530c['diaryCurrentPage'] = _0x161d34, _0x4593c2(), _0x10530c[_0xa73d81(0x59e)] = ![]) : _0x53e238[_0xa73d81(0x93d)]({ 'behavior': _0xa73d81(0xa91), 'block': _0xa73d81(0x3a7) }); }, 0x2bc)) : _0x3d5dc6(0x353) === _0x3d5dc6(0x353) ? _0x10530c['isAnimatingDiary'] = ![] : _0x553a60 ? _0x168c0a(_0x33b0ef) : _0x57e6af(new _0x2943af(_0x3d5dc6(0xa4f))); } function _0x1f74c1() { const _0x13ecff = _0x1da6ac; if (_0x13ecff(0x878) === _0x13ecff(0x7c8)) _0x2e434f = _0x188b32['avatar'] || _0x48b082; else { if (_0x10530c[_0x13ecff(0x59e)]) return; const _0x18dd95 = _0x10530c['diaryCurrentPage']; if (_0x18dd95 <= 0x0) return; _0x10530c[_0x13ecff(0x59e)] = !![]; const _0x18980c = _0x18dd95 - 0x1, _0x2f3724 = document[_0x13ecff(0x248)]('diary-page-' + _0x18dd95), _0x115135 = document[_0x13ecff(0x248)](_0x13ecff(0x9da) + _0x18980c); if (_0x2f3724 && _0x115135) _0x115135['classList'][_0x13ecff(0x7c3)](_0x13ecff(0x830)), _0x2f3724[_0x13ecff(0x882)]['add'](_0x13ecff(0x83d)), _0x115135[_0x13ecff(0x882)][_0x13ecff(0x7c3)](_0x13ecff(0x2cd)), setTimeout(() => { const _0x10e887 = _0x13ecff; _0x2f3724['classList']['remove']('is-visible', _0x10e887(0x83d)), _0x115135[_0x10e887(0x882)][_0x10e887(0xae0)](_0x10e887(0x830)), _0x10530c[_0x10e887(0x2aa)] = _0x18980c, _0x4593c2(), _0x10530c[_0x10e887(0x59e)] = ![]; }, 0x2bc); else { if (_0x13ecff(0x75c) === _0x13ecff(0x2ad)) { const _0x37d879 = _0x3f4fbb[_0x13ecff(0x79a)][_0x13ecff(0x212)](_0x3814a0 => _0x3814a0['id'] === _0x410b77); _0x37d879 && (_0x37d879[_0x13ecff(0x6b7)] = _0x505771, _0x37d879[_0x13ecff(0x9a8)] = _0x360081); } else _0x10530c['isAnimatingDiary'] = ![]; } } } function _0x44f2e1() { return new Promise(_0x5f4901 => { const _0x19cf08 = _0x2af4; if (_0x19cf08(0x6e7) === 'VrhPl') { const _0x201fcb = _0x44cdde[_0x19cf08(0x2c8)]((_0x426765 - _0x5cc33a) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x4ad243 += _0x19cf08(0x444) + _0x201fcb + _0x19cf08(0x94c); } else { const _0x2b290e = _0x19cf08(0x3e4); document[_0x19cf08(0x3ec)][_0x19cf08(0xa2c)](_0x19cf08(0x1bf), _0x2b290e); const _0x1e263b = document['getElementById']('diary-write-modal'), _0x575cae = document[_0x19cf08(0x248)](_0x19cf08(0x48c)), _0x5db3a6 = document[_0x19cf08(0x248)](_0x19cf08(0x25b)), _0x5c8e2d = document[_0x19cf08(0x248)](_0x19cf08(0xacb)), _0xfffa48 = _0x1e263b[_0x19cf08(0x838)]('.choice-modal-backdrop'), _0x435e6b = () => { const _0x508a42 = _0x19cf08; if (_0x508a42(0x4ab) === _0x508a42(0x5b9)) { const _0x212e9c = _0x2c4505['createElement'](_0x508a42(0x6ff)); _0x212e9c['className'] = _0x508a42(0x577) + _0x2076ea; const _0x5f475e = _0x517d10[_0x508a42(0x3b9)]('img'); _0x5f475e[_0x508a42(0x70a)] = _0x4e116e, _0x5f475e[_0x508a42(0x296)] = _0x508a42(0x917); const _0x9c2fe9 = _0x4257d4[_0x508a42(0x3b9)]('div'); return _0x9c2fe9['className'] = _0x508a42(0x4fd), _0x32759f && (_0x9c2fe9[_0x508a42(0x10d)][_0x508a42(0xad9)] = _0x508a42(0x7a2) + _0x29340d + '\x27)'), _0x212e9c[_0x508a42(0x6ab)](_0x5f475e), _0x212e9c[_0x508a42(0x6ab)](_0x9c2fe9), _0x212e9c; } else _0x1e263b['remove'](), _0x5f4901(); }; _0x5db3a6[_0x19cf08(0x935)] = () => { const _0x11eebd = _0x19cf08; _0x11eebd(0xade) === _0x11eebd(0xade) ? (_0x3d2511(_0x575cae[_0x11eebd(0xe5)]), _0x435e6b()) : (_0x218ec0[_0x11eebd(0x675)][_0x105f2b][_0x11eebd(0xa30)] = !![], _0x54bfab()); }, _0x5c8e2d[_0x19cf08(0x935)] = _0x435e6b, _0xfffa48[_0x19cf08(0x935)] = _0x435e6b; } }); } function _0x3d2511(_0x3e0cfc) { const _0x13f0ec = _0x1da6ac; if (_0x13f0ec(0x672) === _0x13f0ec(0x672)) { const _0x20436e = _0x3e0cfc[_0x13f0ec(0x3ee)](); if (!_0x20436e || !_0x10530c['activeDiaryCharacterId']) return; let _0x1169ac = _0x10530c[_0x13f0ec(0x938)][_0x13f0ec(0x212)](_0x10f66a => _0x10f66a[_0x13f0ec(0x542)] === _0x10530c[_0x13f0ec(0x4de)]); if (!_0x1169ac) { if (_0x13f0ec(0x714) !== _0x13f0ec(0x71b)) _0x1169ac = { 'characterId': _0x10530c[_0x13f0ec(0x4de)], 'entries': [] }, _0x10530c['diaries'][_0x13f0ec(0x36b)](_0x1169ac); else { const _0x269310 = _0x1c7a66(); if (_0x269310[_0x13f0ec(0xa78)] === _0x13f0ec(0x732)) { const _0x3abce = _0xc0a2b4['characters']['find'](_0x325a4c => _0x269310[_0x13f0ec(0x26f)][_0x13f0ec(0xa83)](_0x325a4c['id']) && _0x325a4c[_0x13f0ec(0x6b7)] === _0x655a18); if (_0x3abce) _0x135199 = _0x3abce['id']; } } } _0x1169ac[_0x13f0ec(0x17b)][_0x13f0ec(0x36b)]({ 'timestamp': Date[_0x13f0ec(0x7a8)](), 'author': 'user', 'content': _0x20436e }), _0x3e6d3a(); const _0x2a709b = _0x1169ac['entries'][_0x13f0ec(0x848)]; _0x10530c[_0x13f0ec(0x2aa)] = Math['ceil'](_0x2a709b / 0x2) - 0x1, _0x4593c2(); } else { _0x69b3a7(![]), _0x354e8f(_0x13f0ec(0x640)); return; } } async function _0x1ac9b9() { const _0x11f5ff = _0x1da6ac; if (_0x11f5ff(0x44a) !== _0x11f5ff(0x44a)) _0x545d02[_0x11f5ff(0x6b7)] = _0x401f34[_0x11f5ff(0x3ee)](), _0x4a6c67(), _0x4ee543(), _0x1ebd64(), _0x535667(_0x11f5ff(0x51e) + _0x2d96bb[_0x11f5ff(0x6b7)] + '\x22。'); else { const _0x44e7f8 = _0x10530c['diaries'][_0x11f5ff(0x212)](_0x319b3a => _0x319b3a[_0x11f5ff(0x542)] === _0x10530c[_0x11f5ff(0x4de)]), _0x2d3f9a = _0x10530c['activeDiaryCharacterId'], _0x46a866 = _0x5b19fc(_0x2d3f9a); if (!_0x46a866 || _0x10530c['isGenerating']) return; _0xbc2d1c(!![], 'TA正在提笔写日记...'), _0x10530c[_0x11f5ff(0xa4a)] = !![]; let _0x4a87bf = []; try { const _0x1a507e = _0x146846() || { 'name': '你' }, _0x576ecb = _0x38a670(_0x2d3f9a), { omniText: _0x438811 } = _0x3b8ffa(_0x2d3f9a, _0x10530c[_0x11f5ff(0x16e)]); let _0x23052c = ''; if (_0x46a866[_0x11f5ff(0x7e0)] && _0x46a866['linkedWorldBookIds'][_0x11f5ff(0x848)] > 0x0) { const _0x10bcc1 = _0x46a866['linkedWorldBookIds']['map'](_0x397095 => _0x10530c[_0x11f5ff(0x79a)][_0x11f5ff(0x212)](_0x354f9f => _0x354f9f['id'] === _0x397095))[_0x11f5ff(0x54e)](Boolean)[_0x11f5ff(0xa21)](_0x4f6923 => _0x11f5ff(0x8d4) + _0x4f6923['name'] + '\x0a' + _0x4f6923[_0x11f5ff(0x9a8)])[_0x11f5ff(0x64e)](''); if (_0x10bcc1) _0x23052c = _0x11f5ff(0x5cd) + _0x10bcc1; } const _0x509cca = _0x1a507e[_0x11f5ff(0x824)] ? _0x11f5ff(0x920) + _0x1a507e[_0x11f5ff(0x6b7)] + _0x11f5ff(0x910) + _0x1a507e['persona'] : '', _0xb35db5 = _0x538f71(); let _0x3f9ce7 = _0x11f5ff(0x5f3); if (_0x44e7f8 && _0x44e7f8[_0x11f5ff(0x17b)]) { const _0x542ed6 = _0x44e7f8['entries'][_0x11f5ff(0x54e)](_0x45ce1e => _0x45ce1e[_0x11f5ff(0xe8)] === 'user')[_0x11f5ff(0xdf)](); _0x542ed6 && (_0x11f5ff(0x901) === _0x11f5ff(0x87a) ? (_0x506e56[_0x11f5ff(0x618)] = null, _0xbe3510[_0x11f5ff(0x10d)][_0x11f5ff(0x5eb)] = 'none') : _0x3f9ce7 = _0x542ed6[_0x11f5ff(0x9a8)]); } const _0x5dc3a7 = _0x11f5ff(0x1cb) + _0x46a866['name'] + _0x11f5ff(0xa86) + _0x1a507e[_0x11f5ff(0x6b7)] + _0x11f5ff(0x316) + _0x1a507e[_0x11f5ff(0x6b7)] + _0x11f5ff(0x269) + _0x3f9ce7 + '”\x20\x0a\x20你必须针对这段内容表达你的看法、感受或关联的思考。\x0a2.\x20\x20**【次要任务：分享自我】**\x20在回应之后，你**必须**分享一些关于你自己的、读者**不知道**的新鲜事。可以是你今天的见闻、一个突然的想法、或者一件小小的秘密。不要总是复述你们已经聊过的内容！\x0a3.\x20\x20**【禁止复读】**\x20聊天记录和动态只是你的“背景记忆”，是用来确保你不OOC的参考，**绝对不是**你日记的主要内容！\x0a\x0a#\x20你的核心人设\x20(必须遵守)\x0a' + _0x46a866[_0x11f5ff(0x824)] + '\x0a' + _0x509cca + '\x0a' + _0x23052c + _0x11f5ff(0x315) + new Date()[_0x11f5ff(0x446)](_0x11f5ff(0x89f), { 'dateStyle': _0x11f5ff(0x9e2), 'timeStyle': 'short' }) + '\x0a-\x20**日记本的上一笔记录是在**:\x20' + _0x25c4db(new Date(_0x44e7f8?.[_0x11f5ff(0x17b)]?.['at'](-0x1)?.['timestamp'] || Date[_0x11f5ff(0x7a8)]())) + _0x11f5ff(0x6de) + (_0x438811 || _0x11f5ff(0x6c8)) + '\x0a---\x0a##\x20最近的朋友圈动态\x0a' + (_0xb35db5 || _0x11f5ff(0x98c)) + _0x11f5ff(0xc4); _0x4a87bf = [{ 'role': 'system', 'content': _0x5dc3a7 }, { 'role': 'user', 'content': _0x11f5ff(0x140) }]; const _0x37b6cb = await _0x2d63cb(_0x4a87bf); if (_0x37b6cb) { let _0x4a0977 = _0x10530c[_0x11f5ff(0x938)][_0x11f5ff(0x212)](_0x699198 => _0x699198[_0x11f5ff(0x542)] === _0x2d3f9a); if (!_0x4a0977) { if (_0x11f5ff(0x637) === _0x11f5ff(0x637)) _0x4a0977 = { 'characterId': _0x2d3f9a, 'entries': [] }, _0x10530c[_0x11f5ff(0x938)][_0x11f5ff(0x36b)](_0x4a0977); else { if (_0x3b8d8e) _0x24773c['textContent'] = '❚❚'; } } _0x4a0977[_0x11f5ff(0x17b)][_0x11f5ff(0x36b)]({ 'timestamp': Date[_0x11f5ff(0x7a8)](), 'author': _0x2d3f9a, 'content': _0x37b6cb }), _0x3e6d3a(); const _0x2e2b7a = _0x4a0977[_0x11f5ff(0x17b)][_0x11f5ff(0x848)]; _0x10530c[_0x11f5ff(0x2aa)] = Math[_0x11f5ff(0x16f)](_0x2e2b7a / 0x2) - 0x1, _0x4593c2(); } } catch (_0x4c6669) { _0x3a6c86(_0x11f5ff(0x87f) + _0x4c6669[_0x11f5ff(0x380)]); } finally { _0xbc2d1c(![]), _0x10530c['isGenerating'] = ![]; } } } function _0x97c07c() { const _0x19b130 = _0x1da6ac, _0x25c474 = document[_0x19b130(0x248)](_0x19b130(0x455)), _0x40eb3d = document[_0x19b130(0x248)](_0x19b130(0x430)), _0x5233f3 = document[_0x19b130(0x838)](_0x19b130(0x28b)); if (_0x10530c['meetingViewMode'] === 'galgame') { if (_0x19b130(0x43f) === _0x19b130(0x43f)) _0x25c474[_0x19b130(0x10d)][_0x19b130(0x5eb)] = _0x19b130(0x3fe), _0x40eb3d[_0x19b130(0x10d)][_0x19b130(0x5eb)] = 'block'; else { const _0x22c3b8 = _0x4e211c(_0x112907['id']); if (!_0x22c3b8 || !_0x22c3b8['id']) return _0x5bb3fa[_0x19b130(0x729)]('AI\x20试图创建事件，但找不到有效的用户ID。'), null; _0x1e600b[_0x19b130(0x2e4)][_0x19b130(0x36b)]({ 'id': _0x19b130(0x180) + _0x51544d[_0x19b130(0x7a8)](), 'date': _0x31df51['eventDate'], 'type': _0x109db7[_0x19b130(0x40f)], 'content': _0x2556b8[_0x19b130(0x18f)], 'userId': _0x22c3b8['id'], 'createdBy': 'ai' }), _0x5b6deb(), _0x260796(), _0x52d1fc(); const _0x24d07c = _0x1b631d(_0x20b277['id']); _0x24d07c && _0x56dbf5['eventType'] === _0x19b130(0x766) && _0x13f6c8(_0x19b130(0x591) + _0x24d07c[_0x19b130(0x6b7)] + _0x19b130(0x1f2) + _0x41416f[_0x19b130(0x18f)]); return { 'role': _0x19b130(0x7f0), 'senderId': _0x1db8e7['id'], 'timestamp': _0x601fb8['now'](), 'isOffline': _0x5b9cb4, 'content': null }; return { 'role': _0x19b130(0x7f0), 'senderId': _0x51ed2d['id'], 'timestamp': _0x5690bd[_0x19b130(0x7a8)](), 'isOffline': _0xf1261e, 'content': null }; } } else _0x25c474['style']['display'] = _0x19b130(0x92c), _0x40eb3d[_0x19b130(0x10d)][_0x19b130(0x5eb)] = _0x19b130(0x3fe); _0x5233f3[_0x19b130(0x10d)][_0x19b130(0x5eb)] = 'block'; } function _0x4f75a3() { const _0x55bd37 = _0x1da6ac, _0x452391 = document[_0x55bd37(0x248)](_0x55bd37(0x415)), _0x27a849 = document['getElementById'](_0x55bd37(0x90f)); if (_0x10530c[_0x55bd37(0x1f5)][_0x55bd37(0x848)] > 0x0) { const _0x555156 = _0x10530c[_0x55bd37(0x1f5)][_0x55bd37(0x420)](); _0x452391['textContent'] = _0x555156['speaker'] === 'narrator' ? '旁白' : _0x555156[_0x55bd37(0x10c)], _0x27a849['textContent'] = _0x555156['line'], _0x555156[_0x55bd37(0x10c)] !== _0x55bd37(0x623) && _0x3a2186(_0x10530c[_0x55bd37(0x5cb)], _0x555156['emotion']); } else { const _0x25f9dd = _0x10530c[_0x55bd37(0x1be)][_0x10530c[_0x55bd37(0x5cb)]]; if (_0x25f9dd && _0x25f9dd[_0x55bd37(0x848)] > 0x0) { _0x10530c[_0x55bd37(0x1f5)] = [..._0x25f9dd]; const _0x15a777 = _0x10530c[_0x55bd37(0x1f5)][_0x55bd37(0x420)](); _0x452391['textContent'] = _0x15a777[_0x55bd37(0x10c)] === _0x55bd37(0x623) ? '旁白' : _0x15a777[_0x55bd37(0x10c)], _0x27a849['textContent'] = _0x15a777[_0x55bd37(0x9f7)]; if (_0x15a777[_0x55bd37(0x10c)] !== _0x55bd37(0x623)) { if (_0x55bd37(0x90b) === _0x55bd37(0x90b)) _0x3a2186(_0x10530c[_0x55bd37(0x5cb)], _0x15a777[_0x55bd37(0x2be)]); else { _0x1f3d12(_0x55bd37(0x28f)); return; } } } else _0x55bd37(0x9d3) !== 'PcZpn' ? (_0x3615fb(), _0x5b1ad5(_0x55bd37(0x362), _0x55bd37(0x78c))) : (_0x452391[_0x55bd37(0x9ac)] = '旁白', _0x27a849[_0x55bd37(0x9ac)] = _0x55bd37(0x7cb)); } } async function _0x3a2186(_0x282dda, _0x15fabb) { const _0x3141ed = _0x1da6ac; if (_0x3141ed(0x1fc) === 'FqehB') _0x1df61d[_0x3141ed(0x10d)][_0x3141ed(0x5eb)] = 'inline-block'; else { const _0x7e5fc2 = document['getElementById'](_0x3141ed(0x63f)), _0x5209cf = document[_0x3141ed(0x248)](_0x3141ed(0x989)), _0x4d49bb = _0x5b19fc(_0x282dda), _0x3cad53 = _0x4d49bb?.[_0x3141ed(0x7da)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }, _0x35bfe1 = 0x50 * _0x3cad53['scale']; _0x5209cf[_0x3141ed(0x10d)][_0x3141ed(0x5f5)] = _0x35bfe1 + '%', _0x5209cf['style'][_0x3141ed(0x495)] = _0x35bfe1 + '%', _0x5209cf['style'][_0x3141ed(0xf8)] = _0x3cad53['x'] + '%', _0x5209cf['style']['top'] = _0x3cad53['y'] + '%', _0x5209cf[_0x3141ed(0x10d)][_0x3141ed(0xa10)] = 'translate(-50%,\x20-100%)', _0x5209cf[_0x3141ed(0x10d)][_0x3141ed(0x61d)] = 'auto'; const _0x5663a4 = [_0x3141ed(0x47b), 'happy', _0x3141ed(0x977), _0x3141ed(0x6a3), _0x3141ed(0x1b7)], _0x105b3c = _0x5663a4[_0x3141ed(0xa83)](_0x15fabb) ? _0x15fabb : _0x3141ed(0x47b); try { if (_0x3141ed(0x5bf) === _0x3141ed(0x5bf)) { const _0x3a92bb = await _0x533d7a('char_sprite_' + _0x105b3c + '_' + _0x282dda); if (_0x3a92bb) 'adYHX' === _0x3141ed(0x9a3) ? _0x7e5fc2[_0x3141ed(0x70a)] && _0x7e5fc2['style'][_0x3141ed(0x69f)] !== '0' ? (_0x7e5fc2['style'][_0x3141ed(0x69f)] = 0x0, setTimeout(() => { const _0x75b693 = _0x3141ed; _0x75b693(0x911) !== _0x75b693(0x815) ? (_0x7e5fc2[_0x75b693(0x70a)] = URL[_0x75b693(0x73d)](_0x3a92bb), _0x7e5fc2['style'][_0x75b693(0x69f)] = 0x1) : _0x56f917[_0x75b693(0x10d)][_0x75b693(0x5eb)] = _0x75b693(0x4ef); }, 0x96)) : (_0x7e5fc2[_0x3141ed(0x70a)] = URL[_0x3141ed(0x73d)](_0x3a92bb), _0x7e5fc2[_0x3141ed(0x10d)]['opacity'] = 0x1) : (_0x228ab2['appendChild'](_0x40e81b), _0x41b4f0[_0x3141ed(0x6ab)](_0x1f34bc)); else { const _0x45cd1f = await _0x533d7a('char_sprite_normal_' + _0x282dda); _0x7e5fc2['src'] = _0x45cd1f ? URL[_0x3141ed(0x73d)](_0x45cd1f) : ''; } } else _0x55719e['activeListenSession'] = null, _0x2c5093(), _0x209aa9(_0x3141ed(0x48a)), _0x3e5fbd(), _0x31864c['classList'][_0x3141ed(0xae0)](_0x3141ed(0x11b)), _0x56b73a(() => _0x37dea3[_0x3141ed(0x10d)][_0x3141ed(0x5eb)] = _0x3141ed(0x3fe), 0x12c); } catch (_0x173788) { _0x3141ed(0x5ae) !== _0x3141ed(0x1d8) ? (console[_0x3141ed(0x729)]('加载立绘失败:', _0x173788), _0x7e5fc2[_0x3141ed(0x70a)] = '') : (_0x52c2b8[_0x3141ed(0x10d)][_0x3141ed(0x69f)] = 0x0, _0x37f316(() => { const _0x489aa5 = _0x3141ed; _0x5aacea[_0x489aa5(0x70a)] = _0x376c14['createObjectURL'](_0x2f5824), _0x2cde7b[_0x489aa5(0x10d)]['opacity'] = 0x1; }, 0x96)); } } } let _0x155878 = ![], _0x4e47e7 = { 'isDragging': ![], 'isResizing': ![], 'startX': 0x0, 'startY': 0x0, 'startLeft': 0x0, 'startTop': 0x0, 'startWidth': 0x0, 'startHeight': 0x0 }; const _0x194766 = document[_0x1da6ac(0x248)]('sprite-adjust-button'), _0x3762cb = document[_0x1da6ac(0x248)]('sprite-confirm-button'), _0x5f1c54 = document['getElementById'](_0x1da6ac(0x4e3)), _0x50c751 = document[_0x1da6ac(0x248)]('sprite-reset-button'), _0x3ca590 = document[_0x1da6ac(0x248)](_0x1da6ac(0x7db)), _0x431974 = document[_0x1da6ac(0x248)](_0x1da6ac(0x989)), _0xcaf6ba = document[_0x1da6ac(0x248)](_0x1da6ac(0x546)), _0x4c4b8d = document[_0x1da6ac(0x248)](_0x1da6ac(0x151)); let _0x9c7e3a = {}; function _0x4ac8ef() { const _0x3cc418 = _0x1da6ac, _0x127012 = _0x5b19fc(_0x10530c[_0x3cc418(0x5cb)]); if (!_0x127012) return; _0x155878 = !![], _0x3ca590['style'][_0x3cc418(0x5eb)] = _0x3cc418(0x92c); const _0x2d4e47 = _0x127012[_0x3cc418(0x7da)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; document[_0x3cc418(0x248)](_0x3cc418(0xa57))[_0x3cc418(0xe5)] = _0x2d4e47['x'], document[_0x3cc418(0x248)](_0x3cc418(0x44e))[_0x3cc418(0xe5)] = _0x2d4e47['y'], document[_0x3cc418(0x248)](_0x3cc418(0x4d5))[_0x3cc418(0xe5)] = _0x2d4e47['scale'] * 0x64, _0x9c7e3a = { ..._0x2d4e47 }, document[_0x3cc418(0x248)](_0x3cc418(0x8a9))[_0x3cc418(0x10d)][_0x3cc418(0x5eb)] = _0x3cc418(0x3fe), document[_0x3cc418(0x248)](_0x3cc418(0x48d))['style'][_0x3cc418(0x5eb)] = _0x3cc418(0x3fe); } function _0xeb985(_0x19c2dd = ![]) { const _0x5d1a7b = _0x1da6ac; _0x155878 = ![], _0x3ca590[_0x5d1a7b(0x10d)]['display'] = 'none', document['getElementById'](_0x5d1a7b(0x8a9))['style'][_0x5d1a7b(0x5eb)] = _0x5d1a7b(0x92c), document[_0x5d1a7b(0x248)](_0x5d1a7b(0x48d))[_0x5d1a7b(0x10d)]['display'] = 'block'; if (!_0x19c2dd) { if (_0x5d1a7b(0x63c) === _0x5d1a7b(0x8bc)) _0xc4eb00(_0x594fac); else { const _0x3bbaee = _0x5b19fc(_0x10530c[_0x5d1a7b(0x5cb)]); _0x3bbaee && (_0x3bbaee[_0x5d1a7b(0x7da)] = _0x9c7e3a, _0x3a2186(_0x10530c[_0x5d1a7b(0x5cb)], _0x5d1a7b(0x47b))); } } } function _0xd34430() { const _0x1502dc = _0x1da6ac, _0x2053f1 = _0x5b19fc(_0x10530c[_0x1502dc(0x5cb)]); if (!_0x2053f1) return; const _0x1f1393 = parseFloat(document[_0x1502dc(0x248)](_0x1502dc(0xa57))[_0x1502dc(0xe5)]), _0x4c7811 = parseFloat(document[_0x1502dc(0x248)]('sprite-slider-y')[_0x1502dc(0xe5)]), _0x1af1ea = parseFloat(document['getElementById'](_0x1502dc(0x4d5))[_0x1502dc(0xe5)]) / 0x64; _0x2053f1[_0x1502dc(0x7da)] = { 'x': _0x1f1393, 'y': _0x4c7811, 'scale': _0x1af1ea }, _0x3e6d3a(), _0x3a6c86(_0x1502dc(0x323)), _0xeb985(!![]); } function _0x49988d() { const _0x510c46 = _0x1da6ac; _0x52e7d6(_0x510c46(0x5c2))[_0x510c46(0x45f)](_0x142c1e => { const _0xca212 = _0x510c46; if (_0x142c1e) { const _0x3f8a28 = _0x5b19fc(_0x10530c['activeMeetingCharId']); _0x3f8a28 && (_0xca212(0x3ed) === _0xca212(0x3ed) ? (delete _0x3f8a28[_0xca212(0x7da)], _0x3e6d3a(), _0x3a2186(_0x3f8a28['id'], 'normal'), _0x3a6c86(_0xca212(0x382)), _0xeb985(!![])) : _0x2c8a54[_0xca212(0x248)](_0xca212(0x88a))['click']()); } }); } function _0x54db83() { const _0x3aaee6 = _0x1da6ac; if (_0x3aaee6(0x80a) === _0x3aaee6(0x80a)) { if (!_0x155878) return; const _0x1bd160 = _0x10530c[_0x3aaee6(0x5cb)], _0x38da5d = _0x5b19fc(_0x1bd160); if (!_0x38da5d) return; const _0x22acd0 = parseFloat(document[_0x3aaee6(0x248)](_0x3aaee6(0xa57))[_0x3aaee6(0xe5)]), _0x378693 = parseFloat(document['getElementById'](_0x3aaee6(0x44e))['value']), _0x2ced34 = parseFloat(document[_0x3aaee6(0x248)](_0x3aaee6(0x4d5))[_0x3aaee6(0xe5)]) / 0x64; _0x38da5d[_0x3aaee6(0x7da)] = { 'x': _0x22acd0, 'y': _0x378693, 'scale': _0x2ced34 }; const _0x113026 = document[_0x3aaee6(0x248)](_0x3aaee6(0x989)), _0x3db1b9 = 0x50 * _0x2ced34; _0x113026['style']['height'] = _0x3db1b9 + '%', _0x113026[_0x3aaee6(0x10d)]['width'] = _0x3db1b9 + '%', _0x113026[_0x3aaee6(0x10d)][_0x3aaee6(0xf8)] = _0x22acd0 + '%', _0x113026[_0x3aaee6(0x10d)][_0x3aaee6(0xab5)] = _0x378693 + '%', _0x113026[_0x3aaee6(0x10d)]['transform'] = 'translate(-50%,\x20-100%)'; } else { const _0x263740 = _0x4e730f[_0x3aaee6(0x3b9)]('li'); _0x263740[_0x3aaee6(0x296)] = _0x3aaee6(0x903), _0x263740['innerHTML'] = _0x3aaee6(0x50b) + _0x3071f3['id'] + '\x22\x20data-id=\x22' + _0x4ac19f['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x3be654[_0x3aaee6(0x917)] || _0x32d718) + _0x3aaee6(0x474) + _0x5e3f51['id'] + _0x3aaee6(0x1ce) + _0x616267['name'] + '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x220259['appendChild'](_0x263740); } } document[_0x1da6ac(0x248)](_0x1da6ac(0xa57))[_0x1da6ac(0x578)](_0x1da6ac(0x58e), _0x54db83), document[_0x1da6ac(0x248)]('sprite-slider-y')[_0x1da6ac(0x578)](_0x1da6ac(0x58e), _0x54db83), document[_0x1da6ac(0x248)](_0x1da6ac(0x4d5))['addEventListener'](_0x1da6ac(0x58e), _0x54db83), _0x194766[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x4ac8ef), _0x3762cb[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0xd34430), _0x5f1c54[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => _0xeb985(![])), _0x50c751[_0x1da6ac(0x578)]('click', _0x49988d); function _0x2e959a(_0x420aef) { const _0x591edc = _0x1da6ac, _0x208274 = _0x5b19fc(_0x420aef); if (!_0x208274) return; const _0xc2a597 = _0x10530c[_0x591edc(0x4bc)][_0x591edc(0x212)](_0x530018 => _0x530018['type'] === _0x591edc(0x71a) && _0x530018[_0x591edc(0x26f)]['includes'](_0x420aef)), _0x278496 = _0x474290(_0xc2a597['id']), _0x140e3b = _0x10530c[_0x591edc(0x675)][_0x591edc(0x54e)](_0x1e7125 => _0x1e7125['isOffline'])['pop'](), _0x254211 = document['getElementById'](_0x591edc(0x415)), _0x5a1e88 = document['getElementById']('galgame-text'); let _0x1dc34f = null; if (_0x140e3b) { if (_0x591edc(0x94b) !== _0x591edc(0x94b)) _0x5067a7['participantIds'] = _0x4252fc[_0x591edc(0x26f)][_0x591edc(0x54e)](_0x505bb9 => _0x505bb9 !== _0x21ad28); else { if (_0x140e3b[_0x591edc(0x34a)] === _0x591edc(0x7f0)) { const _0x29f863 = _0x10530c[_0x591edc(0x1be)][_0x420aef]; if (_0x29f863 && _0x29f863['length'] > 0x0) { if ('mMffA' !== 'ssNay') _0x1dc34f = _0x29f863['at'](-0x1); else return; } } else { if ('fNhuq' !== _0x591edc(0x1b0)) { const _0x3da05e = _0x413f13[_0x591edc(0x17b)]['filter'](_0x205d88 => _0x205d88['author'] === 'user')['pop'](); _0x3da05e && (_0x37107e = _0x3da05e[_0x591edc(0x9a8)]); } else _0x1dc34f = { 'speaker': _0x278496[_0x591edc(0x6b7)], 'line': _0x140e3b[_0x591edc(0x9a8)], 'emotion': _0x591edc(0x47b) }; } } } _0x1dc34f ? (_0x254211[_0x591edc(0x9ac)] = _0x1dc34f[_0x591edc(0x10c)] === _0x591edc(0x623) ? '旁白' : _0x1dc34f[_0x591edc(0x10c)], _0x5a1e88[_0x591edc(0x9ac)] = _0x1dc34f[_0x591edc(0x9f7)], _0x1dc34f[_0x591edc(0x10c)] === _0x208274[_0x591edc(0x6b7)] ? _0x591edc(0x61c) === _0x591edc(0x275) ? _0x4b93b0[_0x591edc(0x6b7)] !== _0x591edc(0x885) && (_0x1e8785[_0x591edc(0x729)](_0x591edc(0xa71), _0x55b701), _0x1f8421({ 'role': _0x591edc(0x7f0), 'content': '错误:\x20' + _0x202c0a[_0x591edc(0x380)] }, _0x16cd2d[_0x591edc(0x675)][_0x591edc(0x848)] - 0x1)) : _0x3a2186(_0x420aef, _0x1dc34f['emotion']) : _0x3a2186(_0x420aef, _0x591edc(0x47b))) : (_0x254211['textContent'] = _0x208274[_0x591edc(0x6b7)], _0x5a1e88[_0x591edc(0x9ac)] = _0x591edc(0x8c4), _0x3a2186(_0x420aef, _0x591edc(0x47b))); } function _0x3f1b78() { const _0x52be17 = _0x1da6ac; if (_0x52be17(0x900) === _0x52be17(0x900)) { const _0x29782f = new Date(), _0x45ae37 = document[_0x52be17(0x248)](_0x52be17(0x54f)), _0x3b198f = document[_0x52be17(0x248)](_0x52be17(0x5b1)); if (_0x45ae37 && _0x3b198f) { if (_0x52be17(0x6e6) !== _0x52be17(0x67d)) { const _0x29647d = String(_0x29782f[_0x52be17(0x223)]())[_0x52be17(0x1db)](0x2, '0'), _0x45a326 = String(_0x29782f[_0x52be17(0xabe)]())['padStart'](0x2, '0'); _0x45ae37[_0x52be17(0x9ac)] = _0x29647d + ':' + _0x45a326; const _0x7c4e2a = _0x29782f[_0x52be17(0xa84)]() + 0x1, _0x197930 = _0x29782f[_0x52be17(0x208)](), _0x19d4ca = [_0x52be17(0x905), _0x52be17(0x9a6), _0x52be17(0xa90), _0x52be17(0x50f), _0x52be17(0x9f1), _0x52be17(0x2c5), _0x52be17(0x98d)][_0x29782f[_0x52be17(0x381)]()]; _0x3b198f[_0x52be17(0x9ac)] = _0x7c4e2a + '月' + _0x197930 + '日\x20' + _0x19d4ca; } else _0x177134(new _0x37de9c(_0x52be17(0xa4f))); } } else _0x5d2dc9 = _0x120849[_0x52be17(0x6b7)] || '我', _0xa83878 = _0x52be17(0x9c0); } const _0x193f6a = document[_0x1da6ac(0x248)]('listen-together-modal'), _0x52c828 = document['getElementById'](_0x1da6ac(0x230)), _0x61981f = document[_0x1da6ac(0x248)](_0x1da6ac(0x78b)), _0x4c764e = document['getElementById']('listen-together-backdrop'), _0x51f192 = document[_0x1da6ac(0x248)]('listen-together-song-list'), _0x2af425 = document[_0x1da6ac(0x248)]('unified-audio-player'), _0x5d9d14 = document[_0x1da6ac(0x248)](_0x1da6ac(0x95a)), _0x24ebe4 = document[_0x1da6ac(0x248)]('lt-ui-close-btn'), _0x3a578c = document[_0x1da6ac(0x248)](_0x1da6ac(0x236)); let _0x1b9dfe = []; async function _0x35986b() { const _0xe6691d = _0x1da6ac; if (_0xe6691d(0x274) !== _0xe6691d(0x274)) _0x87a35a[_0xe6691d(0x10d)]['display'] = _0xe6691d(0x3fe); else { if (!_0x10530c[_0xe6691d(0x16e)]) return; _0x51f192['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>正在清点圣殿藏品...</p>', _0x193f6a[_0xe6691d(0x882)][_0xe6691d(0x7c3)]('show'); const _0x20d9e3 = await _0x35a611(); if (_0x20d9e3[_0xe6691d(0x848)] === 0x0) { if (_0xe6691d(0x9ba) !== _0xe6691d(0x183)) { _0x51f192[_0xe6691d(0x9a1)] = _0xe6691d(0x1ac); return; } else { const _0x3221a4 = _0x4ff715[_0xe6691d(0x5ce)]; _0x5af18a[_0xe6691d(0x40d)] = _0x1676bc + (_0x3221a4 - _0x4645e5); } } _0x51f192[_0xe6691d(0x9a1)] = '', _0x20d9e3[_0xe6691d(0x986)](_0x3fc015 => { const _0x334b31 = _0xe6691d, _0x1dd661 = document[_0x334b31(0x3b9)](_0x334b31(0x6ff)); _0x1dd661['className'] = _0x334b31(0x700); const _0x50b9fb = _0x3fc015[_0x334b31(0x55a)] ? URL[_0x334b31(0x73d)](_0x3fc015['cover']) : _0x5da029; _0x1dd661[_0x334b31(0x9a1)] = _0x334b31(0x6b6) + _0x50b9fb + _0x334b31(0x467) + (_0x3fc015[_0x334b31(0x53c)][_0x334b31(0x6f5)] || '未知歌曲') + _0x334b31(0x865) + (_0x3fc015['info']['歌手'] || '未知艺术家') + _0x334b31(0xae5), _0x1dd661[_0x334b31(0x578)](_0x334b31(0x4b3), () => { _0x272da7(_0x3fc015); }), _0x51f192['appendChild'](_0x1dd661); }); } } function _0x32c6df() { const _0x8a67e5 = _0x1da6ac; _0x193f6a[_0x8a67e5(0x882)][_0x8a67e5(0xae0)](_0x8a67e5(0x11b)); } async function _0x272da7(_0x19222d) { const _0x5632e6 = _0x1da6ac; if (!_0x10530c[_0x5632e6(0x16e)] || !_0x19222d) return; let _0x2aae1a = null; if (_0x19222d[_0x5632e6(0x55a)]) { if (_0x5632e6(0x4e5) !== 'PVHDc') try { _0x2aae1a = 'music_cover_' + Date[_0x5632e6(0x7a8)]() + '_' + Math[_0x5632e6(0x59a)](), await _0x5ef29b(_0x2aae1a, _0x19222d['cover']); } catch (_0x53566e) { console[_0x5632e6(0x729)](_0x5632e6(0x3d7), _0x53566e); } else { const _0x1dc082 = _0x1dea36[_0x5632e6(0x620)]['find'](_0x1c776d => _0x1c776d['id'] === _0xd216fe); _0x299298['value'] = _0x1dc082[_0x5632e6(0x86f)] || '', _0x54e016[_0x5632e6(0xe5)] = _0x1dc082['userAvatarFrameUrl'] || ''; if (_0x353417) _0x1179a9[_0x5632e6(0x10d)][_0x5632e6(0xad9)] = _0x1dc082[_0x5632e6(0x86f)] ? _0x5632e6(0x7a2) + _0x1dc082[_0x5632e6(0x86f)] + '\x27)' : ''; } } const _0x2b4ffa = { 'role': _0x5632e6(0x27a), 'type': 'listen-together-invite', 'content': _0x5632e6(0xa9c) + _0x19222d[_0x5632e6(0x53c)][_0x5632e6(0x6f5)] + ']', 'songId': _0x19222d['id'], 'songName': _0x19222d['info'][_0x5632e6(0x6f5)], 'artist': _0x19222d[_0x5632e6(0x53c)]['歌手'], 'coverId': _0x2aae1a, 'timestamp': Date[_0x5632e6(0x7a8)]() }; _0x10530c['conversationHistory']['push'](_0x2b4ffa), _0x4a0ca0(), _0x1a245d(), _0x32c6df(), setTimeout(_0x3990cb, 0x64); } _0x52c828[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x35986b), _0x61981f[_0x1da6ac(0x578)]('click', _0x32c6df), _0x4c764e[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x32c6df); async function _0x54ba6f(_0x4d3350, _0x165960, _0x4c53a5) { const _0x30fc5e = _0x1da6ac, _0x178c3d = _0x10530c[_0x30fc5e(0x4bc)][_0x30fc5e(0x212)](_0x233821 => _0x233821[_0x30fc5e(0xaae)] && _0x233821[_0x30fc5e(0xaae)][_0x30fc5e(0x979)]), _0x505a41 = _0x27b19d(); if (_0x178c3d && _0x178c3d['id'] !== _0x505a41['id']) _0x178c3d[_0x30fc5e(0xaae)] = null, _0x3a6c86(_0x30fc5e(0x590)), _0x3e6d3a(); else _0x178c3d && _0x178c3d['id'] === _0x505a41['id'] && _0x3a6c86(_0x30fc5e(0x198)); _0xbc2d1c(!![], _0x30fc5e(0x31f)); if (!_0x505a41) { _0xbc2d1c(![]), _0x3a6c86(_0x30fc5e(0x640)); return; } const _0x238bc2 = await _0x5ac867(_0x4d3350); if (!_0x238bc2) { _0xbc2d1c(![]), _0x3a6c86(_0x30fc5e(0xa40)); return; } _0x505a41[_0x30fc5e(0xaae)] = { 'isActive': !![], 'songId': _0x4d3350, 'leaderId': 'user', 'songName': _0x238bc2[_0x30fc5e(0x53c)][_0x30fc5e(0x6f5)], 'artist': _0x238bc2[_0x30fc5e(0x53c)]['歌手'], 'cover': _0x238bc2[_0x30fc5e(0x55a)] }, _0x3e6d3a(), document[_0x30fc5e(0x248)](_0x30fc5e(0x2fe))[_0x30fc5e(0x70a)] = _0x238bc2[_0x30fc5e(0x55a)] ? URL['createObjectURL'](_0x238bc2['cover']) : _0x5da029, document['getElementById'](_0x30fc5e(0x601))[_0x30fc5e(0x9ac)] = _0x238bc2[_0x30fc5e(0x53c)][_0x30fc5e(0x6f5)], document[_0x30fc5e(0x248)](_0x30fc5e(0x109))[_0x30fc5e(0x9ac)] = _0x238bc2[_0x30fc5e(0x53c)]['歌手'], _0x5ebc38(_0x238bc2), _0x5d9d14[_0x30fc5e(0x10d)][_0x30fc5e(0x5eb)] = _0x30fc5e(0x4ef), setTimeout(() => _0x5d9d14[_0x30fc5e(0x882)][_0x30fc5e(0x7c3)](_0x30fc5e(0x11b)), 0xa), _0x4c53a5[_0x30fc5e(0x9a1)] = _0x30fc5e(0x3c9) + _0x4c53a5['querySelector'](_0x30fc5e(0x483))['outerHTML'], _0x10530c[_0x30fc5e(0x675)][_0x165960] && (_0x30fc5e(0x2ef) === 'kdFbV' ? (_0x10530c[_0x30fc5e(0x675)][_0x165960][_0x30fc5e(0xa30)] = !![], _0x4a0ca0()) : (_0x42253b(), _0x321e8a(![]))), _0xbc2d1c(![]), _0x520b2f(_0x4d3350, [_0x4d3350]), _0x54ff46(_0x238bc2, !![]); } function _0x4bc041() { const _0x51767a = _0x1da6ac, _0x4044c6 = _0x10530c[_0x51767a(0x4bc)][_0x51767a(0x212)](_0xb38f57 => _0xb38f57[_0x51767a(0xaae)] && _0xb38f57[_0x51767a(0xaae)][_0x51767a(0x979)]); _0x4044c6 && (_0x51767a(0x49c) === 'iRevp' ? (_0x4044c6[_0x51767a(0xaae)] = null, _0x3e6d3a(), _0x3a6c86(_0x51767a(0x48a)), _0x54ff46(), _0x5d9d14[_0x51767a(0x882)]['remove'](_0x51767a(0x11b)), setTimeout(() => _0x5d9d14['style'][_0x51767a(0x5eb)] = _0x51767a(0x3fe), 0x12c)) : (_0x28126b['classList'][_0x51767a(0xae0)](_0x51767a(0x907)), _0x2de0f5[_0x51767a(0x882)][_0x51767a(0xae0)]('expanded'))); } function _0x129635(_0x3f0c5c) { const _0x35d835 = _0x1da6ac; if (_0x35d835(0x553) === _0x35d835(0x696)) _0xfa3f4b['addEventListener'](_0x35d835(0x4b3), () => { const _0x1b4708 = _0x35d835, _0x41724d = _0x1f4b40(_0x57b068['dataset'][_0x1b4708(0x41d)], 0xa); _0x4b04ad(_0x41724d); }); else { if (!_0x3f0c5c) return []; const _0x309693 = _0x3f0c5c[_0x35d835(0x5ac)]('\x0a'), _0x91bd37 = [], _0x38b413 = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x343a93 of _0x309693) { const _0x410f31 = _0x343a93[_0x35d835(0x11d)](_0x38b413); if (_0x410f31) { if (_0x35d835(0x8d8) === 'hJVXv') _0x43d343[_0x35d835(0x10d)]['textShadow'] = '0\x201px\x203px\x20rgba(0,0,0,0.6)'; else { const _0x512464 = parseInt(_0x410f31[0x1], 0xa), _0x1da214 = parseInt(_0x410f31[0x2], 0xa), _0x4798e9 = parseInt(_0x410f31[0x3], 0xa) * (_0x410f31[0x3][_0x35d835(0x848)] === 0x2 ? 0xa : 0x1), _0x212c89 = _0x512464 * 0x3c + _0x1da214 + _0x4798e9 / 0x3e8, _0x2ca717 = _0x343a93[_0x35d835(0x7cf)](_0x38b413, '')[_0x35d835(0x3ee)](); _0x2ca717 && _0x91bd37[_0x35d835(0x36b)]({ 'time': _0x212c89, 'text': _0x2ca717 }); } } } return _0x91bd37; } } function _0x5ebc38(_0x48b48) { const _0x2a25d2 = _0x1da6ac; _0x1b9dfe = _0x129635(_0x48b48[_0x2a25d2(0x64d)]), _0x3a578c['innerHTML'] = ''; if (_0x1b9dfe[_0x2a25d2(0x848)] === 0x0) { if (_0x2a25d2(0x9ea) !== _0x2a25d2(0x9ea)) return { 'role': _0x2a25d2(0x27a), 'content': [{ 'type': _0x2a25d2(0x958), 'text': _0x3cbd9e[_0x2a25d2(0x9a8)] || '\x20' }, { 'type': _0x2a25d2(0x5a2), 'image_url': { 'url': _0xeea71[_0x2a25d2(0x1a2)], 'detail': _0x2a25d2(0x9c9) } }] }; else { _0x3a578c[_0x2a25d2(0x9a1)] = _0x2a25d2(0x1e5); return; } } _0x1b9dfe['forEach']((_0x372f10, _0x5db629) => { const _0x36a797 = _0x2a25d2; if (_0x36a797(0x5b2) === _0x36a797(0x81e)) { const _0x44f3ec = _0x24df7b[_0x36a797(0x5f8)](), _0x245241 = _0x1b83f1(_0x14ebff['getMonth']() + 0x1)[_0x36a797(0x1db)](0x2, '0'), _0x12c7eb = _0x3e9d86(_0x1c6c83[_0x36a797(0x208)]())[_0x36a797(0x1db)](0x2, '0'); return _0x44f3ec + '-' + _0x245241 + '-' + _0x12c7eb; } else { const _0x55d8b3 = document['createElement']('p'); _0x55d8b3[_0x36a797(0x9ac)] = _0x372f10[_0x36a797(0x958)], _0x55d8b3['id'] = _0x36a797(0x2b6) + _0x5db629, _0x3a578c['appendChild'](_0x55d8b3); } }); } function _0x49722e(_0x152c2b, _0x50c294, _0x409910, _0xabe7ed) { const _0x4b9eac = _0x1da6ac, _0x1b54dd = (_0xabe7ed - 0x5a) * Math['PI'] / 0xb4; return { 'x': _0x152c2b + _0x409910 * Math[_0x4b9eac(0x1b3)](_0x1b54dd), 'y': _0x50c294 + _0x409910 * Math['sin'](_0x1b54dd) }; } function _0x589863(_0x405a7a) { const _0x3e07d1 = _0x1da6ac; if (_0x3e07d1(0x6dd) === 'ZpvyF') { const _0x154285 = _0x4c4d40[_0x3e07d1(0x248)]('today-todo-list'); if (!_0x154285) return; const _0x4c020e = _0x370a7d(), _0x9a6b52 = _0x8384ff[_0x3e07d1(0x2e4)]['filter'](_0x167b6f => _0x167b6f[_0x3e07d1(0x60f)] === _0x4c020e && _0x167b6f[_0x3e07d1(0xa78)] === 'todo'); _0x154285[_0x3e07d1(0x9a1)] = '', _0x9a6b52[_0x3e07d1(0x848)] > 0x0 ? _0x9a6b52[_0x3e07d1(0x986)](_0x71436d => { const _0x14aad3 = _0x3e07d1, _0x151f76 = _0x41da81[_0x14aad3(0x3b9)]('div'); _0x151f76['className'] = _0x14aad3(0x58a), _0x151f76['textContent'] = _0x71436d[_0x14aad3(0x9a8)], _0x154285[_0x14aad3(0x6ab)](_0x151f76); }) : _0x154285['innerHTML'] = _0x3e07d1(0x49d); } else { const _0x331de2 = _0x3e07d1(0x75e), _0x4898dd = document['createElementNS'](_0x331de2, _0x3e07d1(0x33d)), _0x50809a = 0xfa, _0x2fe6e9 = _0x50809a / 0x2, _0x2cc434 = _0x50809a / 0x2, _0x5c24e1 = _0x50809a / 0x2 - 0x14; _0x4898dd['setAttribute'](_0x3e07d1(0x495), '100%'), _0x4898dd['setAttribute'](_0x3e07d1(0x5f5), '100%'), _0x4898dd[_0x3e07d1(0x4d3)](_0x3e07d1(0x186), _0x3e07d1(0xa8d) + _0x50809a + '\x20' + _0x50809a); const _0x4ce1a3 = Object[_0x3e07d1(0x25e)](_0x405a7a)['reduce']((_0x4a080c, _0x5a763e) => _0x4a080c + _0x5a763e, 0x0); if (_0x4ce1a3 === 0x0) return _0x4898dd; let _0x292b36 = -0x5a; const _0x146868 = [_0x3e07d1(0x1d0), _0x3e07d1(0x1c8), _0x3e07d1(0x2d1), _0x3e07d1(0x1f3), '#c299ff', _0x3e07d1(0x63d), _0x3e07d1(0x826), _0x3e07d1(0x111)]; let _0x4ce1d3 = 0x0; for (const _0x34d32a in _0x405a7a) { if ('zZXnR' !== _0x3e07d1(0x968)) { const _0x2a0226 = _0x405a7a[_0x34d32a]; if (_0x2a0226 <= 0x0) continue; const _0x30e0f4 = _0x2a0226 / _0x4ce1a3 * 0x168, _0x33bdd4 = _0x292b36 + _0x30e0f4, _0x47e16b = _0x49722e(_0x2fe6e9, _0x2cc434, _0x5c24e1, _0x33bdd4), _0x3e1b6b = _0x49722e(_0x2fe6e9, _0x2cc434, _0x5c24e1, _0x292b36), _0x4f4a95 = _0x30e0f4 > 0xb4 ? '1' : '0', _0x2afde6 = ['M', _0x47e16b['x'], _0x47e16b['y'], 'A', _0x5c24e1, _0x5c24e1, 0x0, _0x4f4a95, 0x1, _0x3e1b6b['x'], _0x3e1b6b['y'], 'L', _0x2fe6e9, _0x2cc434, 'Z']['join']('\x20'), _0x581f35 = document[_0x3e07d1(0x4c0)](_0x331de2, _0x3e07d1(0x6ca)); _0x581f35[_0x3e07d1(0x4d3)]('d', _0x2afde6), _0x581f35['setAttribute'](_0x3e07d1(0x50a), _0x146868[_0x4ce1d3 % _0x146868[_0x3e07d1(0x848)]]), _0x4ce1d3++; const _0x4f1d67 = document[_0x3e07d1(0x4c0)](_0x331de2, _0x3e07d1(0x4cf)); _0x4f1d67['textContent'] = _0x34d32a + ':\x20' + _0x2a0226[_0x3e07d1(0x7d5)](0x2) + '\x20(' + (_0x2a0226 / _0x4ce1a3 * 0x64)[_0x3e07d1(0x7d5)](0x1) + '%)', _0x581f35['appendChild'](_0x4f1d67), _0x4898dd['appendChild'](_0x581f35), _0x292b36 = _0x33bdd4; } else { const _0x30aa85 = _0x4c8838(_0x5e2285[_0x3e07d1(0x5cb)]); if (!_0x30aa85) return; const _0x5ccb67 = _0x16019b(_0x1d23e8['getElementById']('sprite-slider-x')[_0x3e07d1(0xe5)]), _0x5e99d3 = _0x7d1940(_0x30a649[_0x3e07d1(0x248)](_0x3e07d1(0x44e))['value']), _0x149b11 = _0xb3040e(_0x29eb60[_0x3e07d1(0x248)](_0x3e07d1(0x4d5))[_0x3e07d1(0xe5)]) / 0x64; _0x30aa85['spriteTransform'] = { 'x': _0x5ccb67, 'y': _0x5e99d3, 'scale': _0x149b11 }, _0x4707c2(), _0x428fc8(_0x3e07d1(0x323)), _0xfb5cb1(!![]); } } return _0x4898dd; } } function _0xc6f4ad() { const _0x20633e = _0x1da6ac; if (_0x20633e(0x11c) !== 'xzCBJ') { if (_0x1b9dfe[_0x20633e(0x848)] === 0x0) return; const _0x1db0d6 = _0x2af425['currentTime']; let _0x1b3628 = -0x1; for (let _0x711fa0 = 0x0; _0x711fa0 < _0x1b9dfe[_0x20633e(0x848)]; _0x711fa0++) { if (_0x1db0d6 >= _0x1b9dfe[_0x711fa0][_0x20633e(0x165)]) { if (_0x20633e(0x567) === _0x20633e(0x7d9)) { if (_0x3f7d9f === null) return; const _0x361217 = _0x3b58b0[_0x20633e(0x675)][_0x323b04]; if (!_0x361217) return; _0x8c7fc3[_0x20633e(0xe5)] = _0x361217[_0x20633e(0x9a8)], _0x24db7a(), _0x35c56f[_0x20633e(0x882)]['add']('show'), _0x38b33b[_0x20633e(0x6e3)](); } else _0x1b3628 = _0x711fa0; } else { if ('mVRtG' === _0x20633e(0x19c)) _0x534ba9[_0x20633e(0xe5)] = _0x521e70['userProfile'][_0x20633e(0x6b7)] || '', _0x155911['src'] = _0x3ee89d[_0x20633e(0x1c9)][_0x20633e(0x917)] || _0x46a985, _0x47ac69[_0x20633e(0xe5)] = _0xd32444[_0x20633e(0x1c9)][_0x20633e(0x824)] || ''; else break; } } if (_0x1b3628 !== -0x1) { const _0x443e85 = _0x3a578c[_0x20633e(0x20d)]('p'); _0x443e85[_0x20633e(0x986)](_0x45f049 => _0x45f049['classList'][_0x20633e(0xae0)](_0x20633e(0x182))); const _0x491cae = document[_0x20633e(0x248)](_0x20633e(0x2b6) + _0x1b3628); _0x491cae && (_0x20633e(0xa9b) !== _0x20633e(0xa9b) ? (_0x158c37[_0x20633e(0x729)]('加载立绘失败:', _0xd67a45), _0x5c8bc6[_0x20633e(0x70a)] = '') : (_0x491cae[_0x20633e(0x882)][_0x20633e(0x7c3)]('active'), _0x491cae['scrollIntoView']({ 'behavior': _0x20633e(0x263), 'block': 'center' }))); } } else { _0x48a423[_0x20633e(0x620)] = _0x627265[_0x20633e(0x620)][_0x20633e(0x54e)](_0x1b2aff => _0x1b2aff['id'] !== _0x10551d), _0x4e9a06[_0x20633e(0x4bc)][_0x20633e(0x986)](_0x44d17d => { const _0x5efdc1 = _0x20633e; _0x44d17d['type'] === 'group' && (_0x44d17d[_0x5efdc1(0x26f)] = _0x44d17d['participantIds'][_0x5efdc1(0x54e)](_0x3d8958 => _0x3d8958 !== _0x16339c)); }); const _0x114695 = _0x572a0b[_0x20633e(0x4bc)][_0x20633e(0x212)](_0x2f58b1 => _0x2f58b1[_0x20633e(0xa78)] === _0x20633e(0x71a) && _0x2f58b1['participantIds'][_0x20633e(0xa83)](_0x342dac)); _0x114695 && _0x488f06(_0x114695['id']), _0x5aa772['chats'] = _0xa8f50d[_0x20633e(0x4bc)][_0x20633e(0x54e)](_0x475f65 => _0x475f65[_0x20633e(0xa78)] !== _0x20633e(0x732) || _0x475f65[_0x20633e(0x26f)][_0x20633e(0x848)] > 0x1), _0x3685f8(), _0xd114ed(); } } _0x24ebe4[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x4d5394 = _0x1da6ac; _0x5d9d14['classList'][_0x4d5394(0xae0)](_0x4d5394(0x11b)), setTimeout(() => _0x5d9d14[_0x4d5394(0x10d)][_0x4d5394(0x5eb)] = 'none', 0x12c); }), document[_0x1da6ac(0x248)]('music-widget-card')['addEventListener'](_0x1da6ac(0x4b3), () => { const _0x4ab60a = _0x1da6ac; _0x4ab60a(0x5ad) !== _0x4ab60a(0x5ad) ? _0x35ec65 = { 'speaker': _0x262850['name'], 'line': _0x22a1cc['content'], 'emotion': _0x4ab60a(0x47b) } : _0x10530c[_0x4ab60a(0x7fa)] && _0x10530c['listenTogetherSession'][_0x4ab60a(0x979)] && (_0x4ab60a(0x505) === 'DVKaB' ? _0xf170af[_0x4ab60a(0x729)]('Failed\x20to\x20plan\x20group\x20replies:', _0x57a972) : (_0x5d9d14['style'][_0x4ab60a(0x5eb)] = _0x4ab60a(0x4ef), setTimeout(() => _0x5d9d14[_0x4ab60a(0x882)]['add'](_0x4ab60a(0x11b)), 0xa))); }), _0x2af425['addEventListener'](_0x1da6ac(0xab9), _0xc6f4ad); const _0x2f0758 = document['getElementById']('widget-play-pause-btn'), _0x2eff04 = document[_0x1da6ac(0x248)](_0x1da6ac(0x869)), _0x40e017 = document['getElementById'](_0x1da6ac(0x219)); _0x2f0758[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0xcf7582 = _0x1da6ac; _0x2af425['src'] && (_0x2af425[_0xcf7582(0x823)] ? _0x2af425[_0xcf7582(0x8ad)]() : _0x2af425[_0xcf7582(0x4b8)]()); }), _0x2eff04[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x5b7ef1 = _0x1da6ac; if (_0x32c055[_0x5b7ef1(0x848)] === 0x0) return; _0x226610 = (_0x226610 + 0x1) % _0x32c055[_0x5b7ef1(0x848)], _0x520b2f(_0x32c055[_0x226610], _0x32c055); }), _0x40e017[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x2003f0 = _0x1da6ac; if (_0x2003f0(0x589) === _0x2003f0(0x589)) { if (_0x32c055[_0x2003f0(0x848)] === 0x0) return; _0x226610 = (_0x226610 - 0x1 + _0x32c055['length']) % _0x32c055['length'], _0x520b2f(_0x32c055[_0x226610], _0x32c055); } else _0x2deef0[_0x2003f0(0x986)](_0x6efe49 => { const _0x116680 = _0x2003f0, _0xdf58ce = _0x152077['createElement']('div'); _0xdf58ce[_0x116680(0x296)] = 'todo-item-small', _0xdf58ce[_0x116680(0x9ac)] = _0x6efe49[_0x116680(0x9a8)], _0x460373[_0x116680(0x6ab)](_0xdf58ce); }); }), _0x2af425['addEventListener']('play', () => { const _0x16e3c7 = _0x1da6ac; _0x16e3c7(0x2e3) === 'PPxus' ? (_0x3cacc9(_0x54a78b, { 'force': !![], 'delayMs': _0x88e9a }), _0x4f9994 += 0x1f4) : _0x2f0758[_0x16e3c7(0x9ac)] = '❚❚'; }), _0x2af425['addEventListener']('pause', () => { const _0x41519a = _0x1da6ac; _0x2f0758[_0x41519a(0x9ac)] = '▶'; }), _0x2af425['addEventListener']('ended', () => { _0x2eff04['click'](); }), _0x2af425['addEventListener'](_0x1da6ac(0x8ad), () => { const _0xf1bbfc = _0x1da6ac, _0x249178 = document[_0xf1bbfc(0x248)]('global-player-play-pause-btn'); if (_0x249178) _0x249178[_0xf1bbfc(0x9ac)] = '❚❚'; }), _0x2af425['addEventListener']('pause', () => { const _0x2f845e = _0x1da6ac; if ('YAMxE' === _0x2f845e(0x76b)) { const _0x4df977 = _0x463a02['chats'][_0x2f845e(0x212)](_0x42a2d3 => _0x42a2d3['id'] === _0x543401), _0x5c6d52 = _0x4df977?.[_0x2f845e(0x2eb)]; let _0x40dd90 = _0x3d6234[_0x2f845e(0x360)]['find'](_0x1c4d45 => _0x1c4d45['id'] === _0x5c6d52); return !_0x40dd90 && (_0x40dd90 = _0x407fee['userProfiles'][_0x2f845e(0x212)](_0x2431c5 => _0x2431c5['id'] === _0x2f3486[_0x2f845e(0x663)]) || _0x22061b[_0x2f845e(0x360)][0x0]), _0x40dd90 || { 'name': '用户', 'avatar': _0x14678f, 'persona': '' }; } else { const _0x1bbafa = document[_0x2f845e(0x248)](_0x2f845e(0x32c)); if (_0x1bbafa) _0x1bbafa[_0x2f845e(0x9ac)] = '▶'; } }), _0x2af425[_0x1da6ac(0x578)]('ended', () => { const _0x51a13a = _0x1da6ac, _0x5c67e8 = document[_0x51a13a(0x248)]('global-player-next-btn'); _0x5c67e8 && _0x5c67e8[_0x51a13a(0x4b3)](); }); function _0x2ad160(_0x1dd89a) { const _0x1ba7af = _0x1da6ac; if (!_0x1dd89a || typeof _0x1dd89a !== 'string') return null; const _0x4bb0a5 = _0x1dd89a[_0x1ba7af(0x7ec)]('['), _0x5b8e9a = _0x1dd89a[_0x1ba7af(0xae1)](']'); if (_0x4bb0a5 > -0x1 && _0x5b8e9a > _0x4bb0a5) return _0x1dd89a[_0x1ba7af(0x3f1)](_0x4bb0a5, _0x5b8e9a + 0x1); return null; } document[_0x1da6ac(0x248)](_0x1da6ac(0x816))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x590bae = _0x1da6ac; _0x590bae(0x5c1) === _0x590bae(0x5c1) ? (_0x144df2(), _0x1c4afc(_0x590bae(0x5ec), _0x590bae(0x362))) : (_0x3e9a16['musicPlaylist'] = _0xa4f79a, _0x32fa9b[_0x590bae(0x79f)] = _0x235e0f, _0x51dbf7[_0x590bae(0x73c)] = ![], _0x327805()); }), document[_0x1da6ac(0x248)](_0x1da6ac(0x765))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => _0x1c4afc(_0x1da6ac(0x362), _0x1da6ac(0x5ec))); const _0x207ae7 = document[_0x1da6ac(0x248)](_0x1da6ac(0x120)), _0x3f394c = document['getElementById'](_0x1da6ac(0x428)); _0x207ae7[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), _0x144df2), _0x3f394c['addEventListener'](_0x1da6ac(0x4b3), () => { const _0x59b19c = _0x1da6ac; _0x207ae7[_0x59b19c(0x882)][_0x59b19c(0xae0)](_0x59b19c(0x182)), _0x3f394c[_0x59b19c(0x882)][_0x59b19c(0x7c3)]('active'), _0x69e9f4(); }); function _0x144df2() { const _0x359757 = _0x1da6ac; _0x359757(0x257) === _0x359757(0x205) ? _0x3aa2c9 += _0x359757(0x437) : (_0x3f394c['classList'][_0x359757(0xae0)](_0x359757(0x182)), _0x207ae7['classList'][_0x359757(0x7c3)](_0x359757(0x182)), _0x1ed250()); } function _0x1ed250() { const _0x74cbd4 = _0x1da6ac; if ('uNkiH' === _0x74cbd4(0x87d)) _0x416991[_0x74cbd4(0x729)](_0x74cbd4(0x515), _0x16af76); else { const _0x17f3a1 = document[_0x74cbd4(0x248)](_0x74cbd4(0x877)); document[_0x74cbd4(0x248)](_0x74cbd4(0x889))[_0x74cbd4(0x9ac)] = '记一笔', document['getElementById'](_0x74cbd4(0x7a4))[_0x74cbd4(0x9a1)] = '', _0x17f3a1[_0x74cbd4(0x9a1)] = _0x74cbd4(0xa09), _0x423030(), document[_0x74cbd4(0x248)](_0x74cbd4(0x9d8))[_0x74cbd4(0x578)](_0x74cbd4(0x4b3), _0x3b596c), document[_0x74cbd4(0x248)](_0x74cbd4(0x462))[_0x74cbd4(0x578)]('click', _0xbd6427 => { const _0x33bca3 = _0x74cbd4; if (_0xbd6427['target']['classList'][_0x33bca3(0x956)]('delete-expense-btn')) { if (_0x33bca3(0x5b6) === 'LceOa') { const _0x2e77a8 = _0xbd6427[_0x33bca3(0x6c4)][_0x33bca3(0xab1)]['id']; _0x52e7d6(_0x33bca3(0x7de))[_0x33bca3(0x45f)](_0x4a68b7 => { const _0x1c0a52 = _0x33bca3; if (_0x1c0a52(0xa27) !== _0x1c0a52(0x843)) _0x4a68b7 && _0x129fdf(_0x2e77a8); else return _0x280e00[_0x1c0a52(0x620)]['find'](_0x2b6e83 => _0x2b6e83['id'] === _0x33769a); }); } else { const _0x1d1ad5 = _0x36973f[_0x33bca3(0x7e0)][_0x33bca3(0xa21)](_0x38d88f => _0xaca355['worldBooks'][_0x33bca3(0x212)](_0x4495f1 => _0x4495f1['id'] === _0x38d88f))[_0x33bca3(0x54e)](_0x1761a1)['map'](_0x5421c4 => _0x33bca3(0x863) + _0x5421c4[_0x33bca3(0x6b7)] + '\x0a' + _0x5421c4['content'])[_0x33bca3(0x64e)](''); _0x1d1ad5 && (_0x5585c2 = _0x33bca3(0x9e8) + _0x1d1ad5); } } }), document[_0x74cbd4(0x248)](_0x74cbd4(0x6f1))[_0x74cbd4(0x6e3)](); } } async function _0x2cf5e8(_0x447328, _0xb6c9fc) { const _0x4f8de7 = _0x1da6ac; if (_0x4f8de7(0x527) === 'KpmSo') { _0x2c5968 = _0x47bad8(_0x11f32d); if (!_0x3f2dbb) throw new _0xe47f8e(_0x4f8de7(0x708)); _0xc42123[_0x4f8de7(0x5e0)](_0x4f8de7(0x49f) + _0x4f47a7['id'] + _0x4f8de7(0x6b8)); } else { const _0x1bc2c9 = document['getElementById'](_0x4f8de7(0x877)), _0x5378be = document[_0x4f8de7(0x248)](_0x4f8de7(0x7a4)); document[_0x4f8de7(0x248)](_0x4f8de7(0x889))[_0x4f8de7(0x9ac)] = _0xb6c9fc + '\x20账单'; const _0x3cd41e = _0x447328['categorizedExpenses'][_0x4f8de7(0xace)]((_0x5b89a1, _0xed2f70) => _0x5b89a1 + (_0xed2f70[_0x4f8de7(0x46e)] || 0x0), 0x0); let _0xe43c66 = _0x4f8de7(0x3d1) + _0x3cd41e['toFixed'](0x2) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22categorized-expenses-list\x22\x20style=\x22margin-top:\x2010px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2010px;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; _0x1bc2c9[_0x4f8de7(0x9a1)] = _0xe43c66; const _0x457078 = document[_0x4f8de7(0x248)](_0x4f8de7(0x68c)), _0x2d322e = { '餐饮美食': _0x4f8de7(0x4bd), '交通出行': _0x4f8de7(0x2ff), '购物消费': '<path\x20d=\x22M6\x202L3\x206v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2V6l-3-4z\x22></path><line\x20x1=\x223\x22\x20y1=\x226\x22\x20x2=\x2221\x22\x20y2=\x226\x22></line><path\x20d=\x22M16\x2010a4\x204\x200\x200\x201-8\x200\x22></path>', '生活服务': _0x4f8de7(0x339), '休闲娱乐': _0x4f8de7(0x664), '医疗健康': '<path\x20d=\x22M12\x202v20\x22></path><path\x20d=\x22M4\x2012h16\x22></path>', '人情红包': '<path\x20d=\x22M15\x2018h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2h-2V4a2\x202\x200\x200\x200-2-2h-2a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path><path\x20d=\x22M7\x2014h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2H7V4a2\x202\x200\x200\x200-2-2H3a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path>', '其他杂项': _0x4f8de7(0x348), '默认': _0x4f8de7(0x568) }; for (const _0x39bcd7 of _0x447328[_0x4f8de7(0xabb)]) { if (_0x4f8de7(0x4db) === _0x4f8de7(0x34f)) { const _0x1569a6 = _0x5ba590[0x0]['trim'](), _0x32f056 = _0x649dcd[0x1][_0x4f8de7(0x3ee)]()[_0x4f8de7(0x7cf)](/^"|"$/g, ''); _0x4ac81b[_0x1569a6] = _0x32f056; } else { const _0x3f018e = document[_0x4f8de7(0x3b9)](_0x4f8de7(0x6ff)); _0x3f018e[_0x4f8de7(0x296)] = _0x4f8de7(0x83e), _0x3f018e['style'][_0x4f8de7(0x6fd)] = 'column', _0x3f018e[_0x4f8de7(0x10d)][_0x4f8de7(0x2c1)] = 'stretch', _0x3f018e[_0x4f8de7(0x10d)][_0x4f8de7(0x8cd)] = _0x4f8de7(0xa70), _0x3f018e[_0x4f8de7(0x10d)][_0x4f8de7(0x8b0)] = '0'; const _0x146c09 = _0x2d322e[_0x39bcd7['category']] || _0x2d322e['默认'], _0x22144e = _0x4f8de7(0x29c) + _0x146c09 + _0x4f8de7(0x9f9), _0x38b93f = _0x4f8de7(0xa31) + _0x22144e + _0x4f8de7(0x62c) + _0x39bcd7['description'] + _0x4f8de7(0x2e8) + (_0x39bcd7[_0x4f8de7(0x754)] || _0x4f8de7(0x42a)) + _0x4f8de7(0x4d1) + (_0x39bcd7[_0x4f8de7(0x46e)] || 0x0)[_0x4f8de7(0x7d5)](0x2) + '</span></div>'; let _0x44730b = ''; if (_0x39bcd7[_0x4f8de7(0x7bf)] && _0x39bcd7[_0x4f8de7(0x7bf)][_0x4f8de7(0x438)]) { const _0x4f6962 = _0x5b19fc(_0x39bcd7[_0x4f8de7(0x7bf)]['charId']); if (_0x4f6962) { const _0x243a0d = await _0x533d7a(_0x4f8de7(0x583) + _0x4f6962['id']), _0x553383 = _0x243a0d ? URL[_0x4f8de7(0x73d)](_0x243a0d) : _0x4f6962[_0x4f8de7(0x917)] || _0x5da029; _0x44730b = _0x4f8de7(0x1ec) + _0x553383 + _0x4f8de7(0xec) + _0x4f6962[_0x4f8de7(0x6b7)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>' + _0x39bcd7[_0x4f8de7(0x7bf)][_0x4f8de7(0x958)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>'; } } _0x3f018e[_0x4f8de7(0x9a1)] = _0x38b93f + _0x44730b, _0x457078[_0x4f8de7(0x6ab)](_0x3f018e); } } _0x5378be[_0x4f8de7(0x9a1)] = _0x4f8de7(0x145), document[_0x4f8de7(0x248)]('re-record-button')['addEventListener']('click', async () => { const _0x280e90 = _0x4f8de7; if (_0x280e90(0x73a) === _0x280e90(0x82a)) _0x54def0['image'] = _0x4670ea; else { const _0x4b1691 = await _0x52e7d6(_0x280e90(0x9cf)); if (_0x4b1691) { const _0x2c3fb0 = _0x10530c[_0x280e90(0xa29)][_0xb6c9fc]; _0x2c3fb0 && _0x2c3fb0[_0x280e90(0x58f)] && _0x10530c[_0x280e90(0x304)]['push'](..._0x2c3fb0[_0x280e90(0x58f)]), delete _0x10530c['accountingLedger'][_0xb6c9fc], _0x3e6d3a(), _0x1ed250(); } } }); } } function _0x69e9f4() { const _0x2f295a = _0x1da6ac, _0x4e1933 = document[_0x2f295a(0x248)]('accounting-content-area'); document[_0x2f295a(0x248)]('accounting-title')[_0x2f295a(0x9ac)] = '账本', document[_0x2f295a(0x248)](_0x2f295a(0x7a4))[_0x2f295a(0x9a1)] = ''; const _0x82379a = Object[_0x2f295a(0x147)](_0x10530c['accountingLedger'])[_0x2f295a(0xaa6)]((_0x58bf9e, _0x163ddb) => new Date(_0x163ddb) - new Date(_0x58bf9e)); if (_0x82379a[_0x2f295a(0x848)] === 0x0) { if (_0x2f295a(0x4f0) !== _0x2f295a(0x4f9)) { _0x4e1933[_0x2f295a(0x9a1)] = _0x2f295a(0x352); return; } else { if (!_0x1fea25[_0x2f295a(0x796)](_0x24e63a) || _0x229cf7['length'] === 0x0) return _0x2f295a(0x2cb); return '<div\x20style=\x22background:\x20var(--card-bg);\x20border-radius:\x2012px;\x20overflow:\x20hidden;\x20border:\x201px\x20solid\x20var(--border-color);\x22>' + _0xca76d3['map']((_0x465a71, _0x24b44d) => { const _0x4ad277 = _0x2f295a, _0x5534ac = _0x260196[_0x4ad277(0x22e)](_0x465a71[_0x4ad277(0x5e0)] || [])['replace'](/'/g, _0x4ad277(0xa24))['replace'](/"/g, _0x4ad277(0x4ac)), _0x499301 = _0x465a71['contact_name'] || '未知联系人'; return _0x4ad277(0x3fa) + (_0x24b44d < _0x1d7870['length'] - 0x1 ? 'border-bottom:\x201px\x20solid\x20var(--border-color);' : '') + _0x4ad277(0xd1) + _0x5534ac + _0x4ad277(0x840) + _0x499301 + _0x4ad277(0x193) + _0x3ea6b6 + '\x27>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22background-color:\x20#eee;\x20font-size:\x201.5rem;\x22>' + _0x499301['charAt'](0x0) + _0x4ad277(0x53d) + _0x499301 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22\x20style=\x22white-space:\x20nowrap;\x20overflow:\x20hidden;\x20text-overflow:\x20ellipsis;\x20color:\x20var(--text-color-light);\x22>' + (_0x465a71[_0x4ad277(0x873)] || '') + _0x4ad277(0x5db); })[_0x2f295a(0x64e)]('') + _0x2f295a(0x489); } } _0x4e1933[_0x2f295a(0x9a1)] = '', _0x82379a['forEach'](_0x58e696 => { const _0x28ae21 = _0x2f295a; if (_0x28ae21(0x44f) === _0x28ae21(0x44f)) { const _0x3df4b8 = document[_0x28ae21(0x3b9)](_0x28ae21(0x6ff)); _0x3df4b8[_0x28ae21(0x296)] = _0x28ae21(0x83e), _0x3df4b8[_0x28ae21(0x10d)][_0x28ae21(0xa61)] = _0x28ae21(0x8cc); const _0x45e2b1 = _0x10530c[_0x28ae21(0xa29)][_0x58e696], _0x23b652 = _0x45e2b1[_0x28ae21(0xabb)]['reduce']((_0x482b55, _0xcaaaa0) => _0x482b55 + (_0xcaaaa0[_0x28ae21(0x46e)] || 0x0), 0x0); _0x3df4b8[_0x28ae21(0x9a1)] = _0x28ae21(0x954) + _0x58e696 + _0x28ae21(0x530) + _0x23b652['toFixed'](0x2) + _0x28ae21(0x955), _0x3df4b8['addEventListener']('click', async () => { const _0x852439 = _0x28ae21; _0x207ae7[_0x852439(0x882)][_0x852439(0xae0)](_0x852439(0x182)), _0x3f394c['classList']['add']('active'), await _0x2cf5e8(_0x45e2b1, _0x58e696); }), _0x4e1933[_0x28ae21(0x6ab)](_0x3df4b8); } else { const _0x49d04e = _0x514c41[_0x28ae21(0x329)](_0x427590), _0x52d207 = { ..._0x3f1756 }, _0x5e3df9 = { ..._0x52d207, ..._0x49d04e }; _0x5e3df9[_0x28ae21(0x827)] = { ..._0x52d207[_0x28ae21(0x827)], ..._0x49d04e[_0x28ae21(0x827)] || {} }, _0x5e3df9[_0x28ae21(0x899)] = { ..._0x52d207[_0x28ae21(0x899)], ..._0x49d04e['apiSettings'] || {} }, _0x297ac2['assign'](_0x89b56c, _0x5e3df9); } }); } function _0x3b596c() { const _0x237b28 = _0x1da6ac, _0x3bbc0b = document['getElementById'](_0x237b28(0x6f1)), _0xb7bfa6 = document['getElementById'](_0x237b28(0x485)), _0x589f4c = _0x3bbc0b[_0x237b28(0xe5)][_0x237b28(0x3ee)](), _0x43dfb0 = parseFloat(_0xb7bfa6[_0x237b28(0xe5)]); if (!_0x589f4c || isNaN(_0x43dfb0) || _0x43dfb0 <= 0x0) { _0x3a6c86(_0x237b28(0x3d0)); return; } _0x10530c[_0x237b28(0x304)][_0x237b28(0x36b)]({ 'id': _0x237b28(0x6c1) + Date['now'](), 'description': _0x589f4c, 'amount': _0x43dfb0, 'timestamp': Date[_0x237b28(0x7a8)]() }), _0x3e6d3a(), _0x423030(), _0x3bbc0b[_0x237b28(0xe5)] = '', _0xb7bfa6[_0x237b28(0xe5)] = '', _0x3bbc0b[_0x237b28(0x6e3)](); } function _0x129fdf(_0x28ef70) { const _0x2aa2a1 = _0x1da6ac, _0x35d226 = _0x10530c[_0x2aa2a1(0x304)]['findIndex'](_0x5cdd96 => _0x5cdd96['id'] === _0x28ef70); _0x35d226 > -0x1 && (_0x2aa2a1(0x549) === _0x2aa2a1(0x756) ? _0x175cf0(_0x2aa2a1(0x78c), 'characterEdit') : (_0x10530c[_0x2aa2a1(0x304)][_0x2aa2a1(0x2f2)](_0x35d226, 0x1), _0x3e6d3a(), _0x423030())); } function _0x423030() { const _0x1e09ed = _0x1da6ac, _0x38a493 = document[_0x1e09ed(0x248)]('daily-expenses-list'), _0x42a8a8 = document[_0x1e09ed(0x248)](_0x1e09ed(0x8a2)), _0xe13b33 = new Date(), _0x11f3dd = _0x10530c[_0x1e09ed(0x304)][_0x1e09ed(0x54e)](_0x24d681 => new Date(_0x24d681[_0x1e09ed(0x908)])['toDateString']() === _0xe13b33[_0x1e09ed(0x8b9)]()); if (_0x11f3dd[_0x1e09ed(0x848)] === 0x0) { _0x38a493[_0x1e09ed(0x9a1)] = _0x1e09ed(0x456), _0x42a8a8[_0x1e09ed(0x9a1)] = ''; return; } _0x38a493['innerHTML'] = '', _0x11f3dd['sort']((_0x20bcf0, _0x91a865) => _0x91a865[_0x1e09ed(0x908)] - _0x20bcf0['timestamp'])['forEach'](_0x28c415 => { const _0x530e1a = _0x1e09ed, _0x29a9dd = document[_0x530e1a(0x3b9)](_0x530e1a(0x6ff)); _0x29a9dd[_0x530e1a(0x296)] = 'expense-item', _0x29a9dd[_0x530e1a(0x9a1)] = _0x530e1a(0x954) + _0x28c415['description'] + _0x530e1a(0x427) + _0x28c415[_0x530e1a(0x46e)][_0x530e1a(0x7d5)](0x2) + _0x530e1a(0x799) + _0x28c415['id'] + _0x530e1a(0x927), _0x38a493[_0x530e1a(0x6ab)](_0x29a9dd); }); if (_0x42a8a8) { if ('IfirL' === _0x1e09ed(0x67f)) { if (_0x10d5a9) { const _0x2d1400 = _0x4b8a00(_0x2780a5[_0x1e09ed(0x5cb)]); _0x2d1400 && (delete _0x2d1400[_0x1e09ed(0x7da)], _0x1c4f5c(), _0x534149(_0x2d1400['id'], _0x1e09ed(0x47b)), _0x175fa7(_0x1e09ed(0x382)), _0x527b86(!![])); } } else _0x42a8a8[_0x1e09ed(0x9a1)] = _0x1e09ed(0x788), document[_0x1e09ed(0x248)](_0x1e09ed(0x1bd))[_0x1e09ed(0x578)](_0x1e09ed(0x4b3), _0x3835b0); } } async function _0x3835b0() { const _0x229d59 = _0x1da6ac, _0x51eafd = new Date(), _0x10cb46 = _0x51eafd['getFullYear']() + '-' + String(_0x51eafd[_0x229d59(0xa84)]() + 0x1)[_0x229d59(0x1db)](0x2, '0') + '-' + String(_0x51eafd[_0x229d59(0x208)]())['padStart'](0x2, '0'); if (_0x10530c[_0x229d59(0xa29)][_0x10cb46]) { if ('uAFum' !== _0x229d59(0x516)) _0x1a8829(_0xd4f87f), _0x39e4bc = null; else { _0x3a6c86(_0x229d59(0x1c0)); return; } } const _0x1df3eb = _0x10530c[_0x229d59(0x304)][_0x229d59(0x54e)](_0x5edb95 => new Date(_0x5edb95[_0x229d59(0x908)])['toDateString']() === _0x51eafd[_0x229d59(0x8b9)]()); if (_0x1df3eb[_0x229d59(0x848)] === 0x0) { if ('CsxFq' !== _0x229d59(0x8a1)) { _0x3a6c86(_0x229d59(0x27d)); return; } else { if (_0x5d14e8) _0x3e9ce7[_0x229d59(0x4b3)](); } } _0xbc2d1c(!![], _0x229d59(0x8af)); try { const _0x3e90d5 = [_0x229d59(0x834), _0x229d59(0x94e), '购物消费', _0x229d59(0x1dc), '休闲娱乐', _0x229d59(0xae3), _0x229d59(0x47f), _0x229d59(0x7c7)], _0xe4a717 = _0x1df3eb[_0x229d59(0xa21)](_0x3da798 => '-\x20' + _0x3da798['description'] + ':\x20' + _0x3da798[_0x229d59(0x46e)])[_0x229d59(0x64e)]('\x0a'), _0x35be30 = _0x10530c[_0x229d59(0x620)][_0x229d59(0xa21)](_0x1cf2fc => { const _0xb5924f = _0x229d59, _0x29a3cc = _0x10530c[_0xb5924f(0x4bc)][_0xb5924f(0x212)](_0x4466e2 => _0x4466e2[_0xb5924f(0xa78)] === _0xb5924f(0x71a) && _0x4466e2[_0xb5924f(0x26f)]['includes'](_0x1cf2fc['id'])), _0x2ad5f1 = _0x10530c['userProfiles'][_0xb5924f(0x212)](_0x2008de => _0x2008de['id'] === (_0x29a3cc?.['boundUserProfileId'] || _0x10530c[_0xb5924f(0x663)])) || { 'id': 'default', 'name': '你' }; let _0x5e4708 = ''; return _0x1cf2fc[_0xb5924f(0x7e0)] && _0x1cf2fc['linkedWorldBookIds'][_0xb5924f(0x848)] > 0x0 && (_0x5e4708 = _0x1cf2fc['linkedWorldBookIds']['map'](_0x191f71 => _0x10530c[_0xb5924f(0x79a)][_0xb5924f(0x212)](_0xa3fbd => _0xa3fbd['id'] === _0x191f71))[_0xb5924f(0x54e)](Boolean)[_0xb5924f(0xa21)](_0x1e2abf => _0xb5924f(0x1b5) + _0x1e2abf[_0xb5924f(0x6b7)] + _0xb5924f(0x5dc) + _0x1e2abf[_0xb5924f(0x9a8)])[_0xb5924f(0x64e)]('')), '\x20\x20-\x20角色ID:\x20' + _0x1cf2fc['id'] + _0xb5924f(0x6e0) + _0x1cf2fc[_0xb5924f(0x6b7)] + _0xb5924f(0x86d) + _0x1cf2fc[_0xb5924f(0x824)] + _0xb5924f(0x884) + _0x2ad5f1[_0xb5924f(0x6b7)] + _0xb5924f(0x1a6) + _0x2ad5f1['id'] + ')\x0a' + _0x5e4708; })[_0x229d59(0x64e)]('\x0a'), _0x24a451 = _0x10530c['userProfiles'][_0x229d59(0xa21)](_0x905b9 => '\x20\x20-\x20用户ID:\x20' + _0x905b9['id'] + _0x229d59(0x6e0) + _0x905b9[_0x229d59(0x6b7)] + _0x229d59(0x86d) + (_0x905b9['persona'] || '无'))['join']('\x0a'), _0x1d3e88 = _0x229d59(0x69e), _0x35a3c1 = _0x229d59(0x7ae) + _0x3e90d5['join'](',\x20') + ']\x0a\x0a#\x20角色资料库\x0a' + _0x35be30 + '\x0a\x0a#\x20用户资料库\x0a' + _0x24a451 + '\x0a\x0a#\x20今日消费流水\x0a' + _0xe4a717, _0x2babc0 = [{ 'role': _0x229d59(0x11f), 'content': _0x1d3e88 }, { 'role': 'user', 'content': _0x35a3c1 }], _0x1e353a = await _0x2d63cb(_0x2babc0, { 'json': !![] }), _0x2be931 = _0x2ad160(_0x1e353a); if (!_0x2be931) { if (_0x229d59(0x3a2) !== _0x229d59(0xa94)) throw new Error('AI返回的内容里找不到有效的JSON数组。原始回复:\x20' + _0x1e353a); else { const _0x187198 = _0x4a72cc['linkedWorldBookIds'][_0x229d59(0xa21)](_0x1b3d04 => _0x54a0ae[_0x229d59(0x79a)][_0x229d59(0x212)](_0x66caed => _0x66caed['id'] === _0x1b3d04))[_0x229d59(0x54e)](_0xdce3d6)[_0x229d59(0xa21)](_0x50cbad => _0x229d59(0x8d4) + _0x50cbad[_0x229d59(0x6b7)] + '\x0a' + _0x50cbad['content'])[_0x229d59(0x64e)](''); if (_0x187198) _0x3959bf = _0x229d59(0x5cd) + _0x187198; } } const _0x313b5d = JSON['parse'](_0x2be931); _0x10530c['accountingLedger'][_0x10cb46] = { 'categorizedExpenses': _0x313b5d, 'timestamp': Date[_0x229d59(0x7a8)](), 'originalExpenses': _0x1df3eb }, _0x10530c[_0x229d59(0x304)] = _0x10530c[_0x229d59(0x304)][_0x229d59(0x54e)](_0x302599 => new Date(_0x302599[_0x229d59(0x908)])[_0x229d59(0x8b9)]() !== _0x51eafd[_0x229d59(0x8b9)]()), _0x3e6d3a(), _0x2cf5e8(_0x10530c[_0x229d59(0xa29)][_0x10cb46], _0x10cb46); } catch (_0x4a3c0b) { _0x3a6c86(_0x229d59(0x7dc) + _0x4a3c0b[_0x229d59(0x380)]); } finally { _0xbc2d1c(![]); } } async function _0x323012() { const _0x379719 = _0x1da6ac, _0x6d53b3 = [..._0x1a363e]; try { const _0x2c0be5 = localStorage['getItem'](_0x379719(0x68f)); if (_0x2c0be5) { if ('VtrcM' !== _0x379719(0xa73)) { if (!_0x2e145c || !_0x20edc7[_0x379719(0x16e)]) return; const _0x2a07e7 = { 'role': 'user', 'content': _0x379719(0x7aa) + _0x4ad3db['name'] + ']', 'displayUrl': _0x307988[_0x379719(0x83a)], 'timestamp': _0x18663e[_0x379719(0x7a8)]() }; _0x4df4d1[_0x379719(0x675)]['push'](_0x2a07e7), _0x26dda0(_0x2a07e7, _0x967263[_0x379719(0x675)][_0x379719(0x848)] - 0x1), _0x3eb8cb(), _0xa50189['classList'][_0x379719(0xae0)](_0x379719(0x11b)); } else { const _0x17b09d = JSON[_0x379719(0x329)](_0x2c0be5); if (Array[_0x379719(0x796)](_0x17b09d)) { if (_0x379719(0x36e) !== _0x379719(0x141)) _0x13ae2d = [..._0x6d53b3, ..._0x17b09d]; else { let _0x3668ee = _0x51beb9[_0x379719(0x838)](_0x379719(0x251)); !_0x3668ee && (_0x3668ee = _0x377716[_0x379719(0x3b9)]('div'), _0x3668ee[_0x379719(0x296)] = 'typing-indicator', _0x3668ee[_0x379719(0x9ac)] = _0x379719(0xae6), _0x3668ee[_0x379719(0x10d)][_0x379719(0x598)] = _0x379719(0xa4b), _0x3668ee[_0x379719(0x10d)][_0x379719(0x8cd)] = _0x379719(0x61a), _0x3668ee[_0x379719(0x10d)][_0x379719(0x12c)] = _0x379719(0x241), _0x5462c9[_0x379719(0x6ab)](_0x3668ee)); } } else _0x13ae2d = _0x6d53b3; } } else _0x379719(0xa4e) === 'Nwxez' ? _0x13ae2d = _0x6d53b3 : (_0x212c48['stopPropagation'](), _0x27e9ed(_0x19f09e['id'])); } catch (_0x190ab8) { console[_0x379719(0x729)](_0x379719(0x77e), _0x190ab8), _0x13ae2d = _0x6d53b3; } if (!localStorage[_0x379719(0x915)]('noir_data_migration_v1_complete')) { _0x52e7d6(_0x379719(0x6d3))[_0x379719(0x45f)](async _0x56218b => { const _0x12ab02 = _0x379719; _0x56218b ? (_0xbc2d1c(!![], _0x12ab02(0x6f9)), await _0x43a554(), localStorage['setItem'](_0x12ab02(0x49b), _0x12ab02(0x52f)), _0xbc2d1c(![]), _0x3a6c86(_0x12ab02(0xa52)), setTimeout(() => location[_0x12ab02(0x7a6)](), 0x5dc)) : _0x3a6c86(_0x12ab02(0x53f)); }); return; } if (!localStorage['getItem'](_0x379719(0x1af))) { if ('qOUTq' === _0x379719(0x156)) _0x2b961d(![]), _0x4fa2d7[_0x379719(0x729)](_0x379719(0x2c3), _0x5a7c7f), _0x3988ab(_0x379719(0xa11) + _0x2893dd[_0x379719(0x380)]); else { console[_0x379719(0x5e0)](_0x379719(0x374)), _0xbc2d1c(!![], _0x379719(0x9a0)); const _0xbd33ee = await _0x446f98(); localStorage[_0x379719(0x9e0)](_0x379719(0x1af), 'true'), _0xbc2d1c(![]); if (_0xbd33ee > 0x0) { _0x3a6c86(_0x379719(0x655) + _0xbd33ee + _0x379719(0x528)), setTimeout(() => location[_0x379719(0x7a6)](), 0x5dc); return; } } } if (!localStorage[_0x379719(0x915)](_0x379719(0x1af))) { } if (!localStorage[_0x379719(0x915)](_0x379719(0x403))) { console[_0x379719(0x5e0)](_0x379719(0x75d)), _0xbc2d1c(!![], _0x379719(0x8be)); const _0x1d91f4 = await _0x1eaab6(); localStorage['setItem'](_0x379719(0x403), 'true'), _0xbc2d1c(![]); if (_0x1d91f4 > 0x0) { _0x3a6c86(_0x379719(0x772) + _0x1d91f4 + _0x379719(0x82b)), setTimeout(() => location['reload'](), 0x5dc); return; } } const _0x23631b = document[_0x379719(0x248)]('app-snoop'); _0x23631b[_0x379719(0x578)]('click', async () => { const _0x190270 = _0x379719; await _0x4295e9(), _0x1c4afc(_0x190270(0xa26), _0x190270(0x362)); }); const _0x2d0919 = _0x22e9ee(); try { if (_0x379719(0x468) !== _0x379719(0x524)) { const _0x5ded8a = localStorage['getItem'](_0x379719(0x683)); if (_0x5ded8a) { const _0x1f7a8a = JSON[_0x379719(0x329)](_0x5ded8a); if (_0x1f7a8a['accountingLedger']) { if (_0x379719(0x3ce) !== 'SYLyG') _0x10530c[_0x379719(0xa29)] = _0x1f7a8a[_0x379719(0xa29)], console[_0x379719(0x5e0)](_0x379719(0x7a5)); else { const _0x18f08c = _0x1d8eea['querySelector'](_0x379719(0x19b) + _0x486bec + _0x379719(0x369) + _0x3b723c + _0x379719(0x4cd))?.[_0x379719(0x9a1)]; _0x18f08c && (_0x28802c['innerHTML'] = _0x18f08c); } } } } else _0x4bdc74[_0x379719(0x7e0)] = _0x360417['linkedWorldBookIds'][_0x379719(0x54e)](_0x4337e4 => _0x4337e4 !== _0x28dcdb); } catch (_0x114926) { console[_0x379719(0x729)](_0x379719(0xa3a), _0x114926); } _0x569388(), _0x2f0d1a(), _0xe2b90b(), _0x3f716b(), _0x5bdeac(), _0x46c2d9(), _0x1bbcb7(), _0x147819(), _0x136fde(), _0x156d93(), _0x481db1(), _0x54ff46(), _0x46a9cb(), setInterval(_0x46a9cb, 0x7530), _0x470caa(), _0x398205(), _0x17cbb9(); const _0x363fe9 = document[_0x379719(0x248)](_0x379719(0x1d3)); document[_0x379719(0x248)](_0x379719(0x6e9))['addEventListener'](_0x379719(0x4b3), function (_0xe5d651) { const _0x18046f = _0x379719; if (_0x18046f(0x26a) !== _0x18046f(0x26a)) return { 'url': _0x13657d, 'cover': _0x35961d[_0x18046f(0x55a)], 'source': _0x17cbd2 }; else { if (_0xe5d651[_0x18046f(0x6c4)][_0x18046f(0x939)](_0x18046f(0x8e2))) return; const _0x413eb2 = document[_0x18046f(0x248)](_0x18046f(0x9ab)); _0x413eb2 && _0x413eb2[_0x18046f(0x4b3)](); } }), _0x1c4afc(_0x379719(0x362), _0x379719(0x80e)); (_0x2d0919 || _0x10530c[_0x379719(0x620)][_0x379719(0x848)] === 0x0) && (_0x3a6c86(_0x379719(0xabf)), setTimeout(() => { const _0x198908 = _0x379719; _0x1c4afc(_0x198908(0x78c), _0x198908(0x362)), setTimeout(() => _0xfec8c0(), 0x64); }, 0x6a4)); document['getElementById'](_0x379719(0x209))['addEventListener'](_0x379719(0x4b3), _0x3644d3); const _0x3c6ff6 = document[_0x379719(0x248)]('widget-bg-input'); document[_0x379719(0x248)](_0x379719(0xaa2))['addEventListener']('click', () => _0x3c6ff6[_0x379719(0x4b3)]()), document[_0x379719(0x248)](_0x379719(0x819))['addEventListener'](_0x379719(0x4b3), () => { const _0x47a3e3 = _0x379719; if (_0x47a3e3(0x65f) === 'GaULj') { const _0x40d3c4 = _0x55a68e(_0x49053b[0x1]), _0x495c3a = _0x54c9d1[0x2][_0x47a3e3(0x3ee)](), _0x473610 = _0x616386(_0x76fbc0[_0x47a3e3(0x16e)]); let _0x1b404f = null; if (_0x495c3a === _0x473610[_0x47a3e3(0x6b7)]) _0x1b404f = _0x473610['id']; else { const _0x1b5850 = _0x7f0e99(); if (_0x1b5850['type'] === _0x47a3e3(0x732)) { const _0x5ec435 = _0x5028f8[_0x47a3e3(0x620)]['find'](_0x362532 => _0x1b5850[_0x47a3e3(0x26f)]['includes'](_0x362532['id']) && _0x362532[_0x47a3e3(0x6b7)] === _0x495c3a); if (_0x5ec435) _0x1b404f = _0x5ec435['id']; } } if (_0x1b404f) return { 'type': 'transfer', 'amount': _0x40d3c4, 'recipientId': _0x1b404f, 'senderId': _0x2c31d2['id'] }; else return { 'type': _0x47a3e3(0x958), 'content': '(想转账给“' + _0x495c3a + _0x47a3e3(0x8f6) }; } else _0x10530c[_0x47a3e3(0x827)][_0x47a3e3(0x533)] = null, _0x3e6d3a(), _0x470caa(), _0x3a6c86(_0x47a3e3(0x722)); }), _0x3c6ff6[_0x379719(0x578)](_0x379719(0x423), async _0xf70d7d => { const _0x59cd05 = _0x379719; if (_0x59cd05(0x913) !== _0x59cd05(0x913)) _0x180e2c[_0x59cd05(0x59e)] = ![]; else { const _0x405a6e = _0xf70d7d[_0x59cd05(0x6c4)]['files'][0x0]; if (!_0x405a6e) return; try { const _0x18f213 = await _0x1f8d37(_0x405a6e); _0x10530c['preferences']['widgetBgImage'] = _0x18f213, _0x3e6d3a(), _0x470caa(), _0x3a6c86(_0x59cd05(0x859)); } catch (_0x4f0bd0) { _0x3a6c86(_0x59cd05(0x247) + _0x4f0bd0[_0x59cd05(0x380)]); } } }), _0x141e5a(), document[_0x379719(0x248)](_0x379719(0x798))[_0x379719(0x578)]('click', () => document[_0x379719(0x248)](_0x379719(0x12b))[_0x379719(0x4b3)]()), document[_0x379719(0x248)]('reset-badge-button')['addEventListener'](_0x379719(0x4b3), async () => { const _0xfb98a6 = _0x379719; await _0x2e3a29('widget_badge'), localStorage[_0xfb98a6(0x89a)](_0xfb98a6(0x507)), _0x141e5a(), _0x3a6c86('徽章已移除。'); }), document[_0x379719(0x248)]('badge-input')[_0x379719(0x578)](_0x379719(0x423), async _0x48fd05 => { const _0x21a53f = _0x379719, _0xbb3043 = _0x48fd05['target'][_0x21a53f(0x5fc)][0x0]; if (!_0xbb3043) return; try { await _0x5ef29b(_0x21a53f(0x1ab), _0xbb3043), await _0x141e5a(), _0x3a6c86('徽章已更换！'); } catch (_0x52bf14) { 'wxaQL' !== 'wxaQL' ? (_0x39d45e['getElementById'](_0x21a53f(0x426) + _0x1908c1 + _0x21a53f(0x972))[_0x21a53f(0x10d)][_0x21a53f(0xad9)] = '', _0x348f4b[_0x21a53f(0x248)](_0x21a53f(0x426) + _0x6bb5c8 + _0x21a53f(0x7f5))[_0x21a53f(0xe5)] = '') : _0x3a6c86('错误:\x20' + _0x52bf14[_0x21a53f(0x380)]); } }), _0x28e8b9(), document['getElementById'](_0x379719(0x7fc))[_0x379719(0x578)](_0x379719(0x41e), _0x2e469a), document[_0x379719(0x248)]('diary-entries-container')['addEventListener'](_0x379719(0x936), _0x2e469a, { 'passive': ![] }), document[_0x379719(0x248)]('upload-card-button')[_0x379719(0x578)]('click', () => document['getElementById'](_0x379719(0x62b))[_0x379719(0x4b3)]()), document[_0x379719(0x248)](_0x379719(0x96c))[_0x379719(0x578)](_0x379719(0x4b3), async () => { const _0x98f0ce = _0x379719; if ('CRQhz' === _0x98f0ce(0x2cc)) await _0x2e3a29(_0x98f0ce(0x31d)), localStorage[_0x98f0ce(0x89a)]('cardState'), _0x28e8b9(), _0x3a6c86('卡片已移除。'); else { if (_0xfcc5cb[_0x98f0ce(0x42b)]) _0xd48cc3(_0x380206['diaryPressTimer']); const _0x41a313 = _0x3516b1[_0x98f0ce(0x6c4)][_0x98f0ce(0x939)](_0x98f0ce(0x704)); if (!_0x41a313) return; const _0x56bdb4 = _0x41a313[_0x98f0ce(0xab1)][_0x98f0ce(0x908)], _0x1c2d9d = _0x41a313[_0x98f0ce(0x882)]['contains'](_0x98f0ce(0x27a)) ? _0x98f0ce(0x27a) : 'ai'; if (!_0x56bdb4) return; const _0x90bea3 = () => { const _0x530832 = _0x98f0ce; _0x136837[_0x530832(0x42b)] = _0xf30321(() => { const _0x3d7615 = _0x530832; if (_0x10b57a['type'] === _0x3d7615(0x936)) _0x2d09f9[_0x3d7615(0x148)](); _0x107b01(_0x525dd6(_0x56bdb4, 0xa), _0x1c2d9d); }, 0x320); }, _0x44d53a = () => { if (_0x263a6e['diaryPressTimer']) _0x3ad43f(_0x5468d6['diaryPressTimer']); }; _0x5267e0[_0x98f0ce(0x578)]('mouseup', _0x44d53a, { 'once': !![] }), _0x3007ea[_0x98f0ce(0x578)]('touchend', _0x44d53a, { 'once': !![] }), _0x4a1de1[_0x98f0ce(0x578)](_0x98f0ce(0xa3c), _0x44d53a, { 'once': !![] }), _0x90bea3(); } }), document[_0x379719(0x248)](_0x379719(0x62b))['addEventListener'](_0x379719(0x423), async _0x465f61 => { const _0x1b98ec = _0x379719, _0x16f9d7 = _0x465f61[_0x1b98ec(0x6c4)][_0x1b98ec(0x5fc)][0x0]; if (!_0x16f9d7) return; try { await _0x5ef29b(_0x1b98ec(0x31d), _0x16f9d7), await _0x28e8b9(), _0x3a6c86(_0x1b98ec(0x9d5)); } catch (_0x2b61f6) { _0x3a6c86('错误:\x20' + _0x2b61f6['message']); } }), document[_0x379719(0x248)](_0x379719(0x40b))[_0x379719(0x578)](_0x379719(0x4b3), async () => { const _0x4415ff = _0x379719; if (_0x4415ff(0x25f) === _0x4415ff(0x25f)) { const _0x5302b8 = await _0x52e7d6('确定要重置所有小组件的位置吗？它们会回到初始位置。'); _0x5302b8 && (localStorage[_0x4415ff(0x89a)](_0x4415ff(0x507)), localStorage['removeItem'](_0x4415ff(0x790)), _0x3a6c86(_0x4415ff(0x6a9)), setTimeout(() => location[_0x4415ff(0x7a6)](), 0x3e8)); } else _0x6abb47 += _0x4415ff(0xa95) + _0x515005[_0x4415ff(0x9b0)] + _0x4415ff(0x763) + _0x4a05df[_0x4415ff(0x8f9)] + _0x4415ff(0x8aa); }); const _0xe7513c = document[_0x379719(0x248)]('app-diary'); _0xe7513c[_0x379719(0x578)](_0x379719(0x4b3), async () => { await _0x28da8d(), _0x1c4afc('diaryList', 'home'); }); const _0x538257 = document[_0x379719(0x248)](_0x379719(0x926)); _0x538257[_0x379719(0x578)](_0x379719(0x4b3), () => { const _0x2069c7 = _0x379719; _0x541f57(), _0x1c4afc(_0x2069c7(0x94f), _0x2069c7(0x362)); }), document[_0x379719(0x248)](_0x379719(0x63a))[_0x379719(0x578)](_0x379719(0x4b3), () => _0x1c4afc(_0x379719(0x362), _0x379719(0x94f))), document[_0x379719(0x248)](_0x379719(0x125))[_0x379719(0x578)](_0x379719(0x4b3), () => _0x1c4afc(_0x379719(0x362), _0x379719(0x90d))), document[_0x379719(0x248)]('back-to-diary-list')[_0x379719(0x578)](_0x379719(0x4b3), () => { _0x10530c['activeDiaryCharacterId'] = null, _0x1c4afc('diaryList', 'diaryView'); }), document[_0x379719(0x248)]('diary-send-button')[_0x379719(0x578)](_0x379719(0x4b3), _0x3d2511), document[_0x379719(0x248)](_0x379719(0xa3d))['addEventListener'](_0x379719(0x4b3), _0x1ac9b9), document[_0x379719(0x248)](_0x379719(0x417))[_0x379719(0x578)]('keydown', _0x90cb14 => { const _0x3fcab3 = _0x379719; if (_0x90cb14['key'] === _0x3fcab3(0x18b) && !_0x90cb14[_0x3fcab3(0x628)]) { if (_0x3fcab3(0x39f) === _0x3fcab3(0x39f)) _0x90cb14[_0x3fcab3(0x148)](), _0x3d2511(); else { _0x1ea1be = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x3a3df1 in _0x4a2087) { _0x28816d[_0x3a3df1][_0x3fcab3(0x882)][_0x3fcab3(0xae0)](_0x3fcab3(0x8f7)), _0x297b81[_0x3a3df1][_0x3fcab3(0xe5)] = ''; } _0x4a4493[_0x3fcab3(0x774)][_0x3fcab3(0x838)]('.slot-filename')[_0x3fcab3(0x9ac)] = '点击选择\x20.mp3\x20或\x20.flac', _0x2b137b[_0x3fcab3(0x55a)][_0x3fcab3(0x838)]('.slot-filename')[_0x3fcab3(0x9ac)] = _0x3fcab3(0x716), _0x36e334[_0x3fcab3(0x53c)][_0x3fcab3(0x838)]('.slot-filename')[_0x3fcab3(0x9ac)] = _0x3fcab3(0xad8), _0x33642e[_0x3fcab3(0x64d)]['querySelector'](_0x3fcab3(0x138))[_0x3fcab3(0x9ac)] = '点击选择\x20.lrc', _0x5acbab(); } } }); const _0x348757 = [_0x379719(0x47b), _0x379719(0x6bb), _0x379719(0x977), 'sad', _0x379719(0x1b7)]; _0x348757['forEach'](_0x599975 => { const _0x5d9ad1 = _0x379719; if ('tNnMk' === _0x5d9ad1(0x3e0)) _0x188c17++; else { const _0x285e13 = document[_0x5d9ad1(0x248)](_0x5d9ad1(0x426) + _0x599975 + _0x5d9ad1(0x972)), _0xf5534d = document[_0x5d9ad1(0x248)](_0x5d9ad1(0x426) + _0x599975 + _0x5d9ad1(0x7f5)); _0x285e13 && _0xf5534d && (_0x285e13[_0x5d9ad1(0x578)]('click', () => _0xf5534d[_0x5d9ad1(0x4b3)]()), _0xf5534d[_0x5d9ad1(0x578)](_0x5d9ad1(0x423), _0x83505c => { const _0x40a573 = _0x5d9ad1, _0x2ad69b = _0x83505c[_0x40a573(0x6c4)][_0x40a573(0x5fc)][0x0]; if (!_0x2ad69b) return; try { const _0x30b296 = URL[_0x40a573(0x73d)](_0x2ad69b); _0x285e13['style'][_0x40a573(0xad9)] = _0x40a573(0x7a2) + _0x30b296 + '\x27)'; } catch (_0x59d206) { _0x3a6c86('图片预览失败:\x20' + _0x59d206[_0x40a573(0x380)]); } })); } }), document['getElementById']('galgame-textbox-container')[_0x379719(0x578)](_0x379719(0x4b3), _0x4f75a3), document[_0x379719(0x248)](_0x379719(0xa69))[_0x379719(0x578)](_0x379719(0x4b3), () => { const _0x4495ef = _0x379719; _0x4495ef(0x3df) === 'EnVWK' ? (_0x5ec453[_0x4495ef(0x4b8)](), _0x25bdd7[_0x4495ef(0x838)](_0x4495ef(0x41b))[_0x4495ef(0x9ac)] = '▶') : (_0x10530c[_0x4495ef(0x23a)] = _0x10530c['meetingViewMode'] === _0x4495ef(0x4d4) ? _0x4495ef(0xa15) : _0x4495ef(0x4d4), _0x97c07c()); }), document[_0x379719(0x248)](_0x379719(0x455))[_0x379719(0x578)](_0x379719(0x41e), _0xea5adc), document['getElementById'](_0x379719(0x455))[_0x379719(0x578)](_0x379719(0x936), _0xea5adc, { 'passive': ![] }); let _0x58d242 = null; function _0xea5adc(_0x570235) { const _0x41a342 = _0x379719; if (_0x58d242) clearTimeout(_0x58d242); const _0x51350f = _0x570235[_0x41a342(0x6c4)][_0x41a342(0x939)]('p[data-history-index]'); if (!_0x51350f) return; const _0x2af493 = parseInt(_0x51350f[_0x41a342(0xab1)][_0x41a342(0x215)], 0xa); if (isNaN(_0x2af493)) return; const _0x450da8 = () => { _0x58d242 = setTimeout(() => { const _0x2ba16f = _0x2af4; if ('fkpiE' === _0x2ba16f(0x76d)) { const _0x444865 = _0x153d7b === _0x13ccd6 ? _0x2ba16f(0x487) : ''; return '' + _0x444865 + _0x44db21['text']; } else { if (_0x570235[_0x2ba16f(0xa78)] === _0x2ba16f(0x936)) _0x570235[_0x2ba16f(0x148)](); _0x1351da(_0x2af493); } }, 0x320); }, _0x54b225 = () => { const _0x16ace1 = _0x41a342; if (_0x16ace1(0x194) !== _0x16ace1(0x571)) { if (_0x58d242) clearTimeout(_0x58d242); } else _0x2c5f35['error'](_0x16ace1(0x116), _0x3a3b6c); }; document[_0x41a342(0x578)](_0x41a342(0x529), _0x54b225, { 'once': !![] }), document[_0x41a342(0x578)](_0x41a342(0x79b), _0x54b225, { 'once': !![] }), document[_0x41a342(0x578)](_0x41a342(0xa13), _0x54b225, { 'once': !![] }), document['addEventListener'](_0x41a342(0xa3c), _0x54b225, { 'once': !![] }), _0x450da8(); } document[_0x379719(0x3ec)][_0x379719(0x578)](_0x379719(0x4b3), _0x52b1ff => { const _0x1d54b9 = _0x379719, _0x4b41fa = _0x52b1ff[_0x1d54b9(0x6c4)][_0x1d54b9(0x939)](_0x1d54b9(0x2b9)); if (_0x4b41fa) { const _0x33e0f2 = _0x52b1ff['target'][_0x1d54b9(0x939)]('.lt-end-session-btn'), _0x138a3e = _0x52b1ff[_0x1d54b9(0x6c4)]['closest']('.listen-together-accept-btn'); if (_0x33e0f2) 'cBZGx' !== _0x1d54b9(0x86b) ? _0xfa8f44[_0x1d54b9(0x797)] === _0x1d54b9(0x18b) && !_0x32c1aa[_0x1d54b9(0x628)] && (_0x4858ce[_0x1d54b9(0x148)](), _0x5b7308()) : _0x4bc041(); else { if (_0x138a3e) { const _0xf249e7 = _0x138a3e[_0x1d54b9(0x939)](_0x1d54b9(0x980)), _0x55fe35 = _0x138a3e[_0x1d54b9(0xab1)][_0x1d54b9(0x181)], _0x13ed10 = parseInt(_0xf249e7[_0x1d54b9(0xab1)]['historyIndex'], 0xa); _0x54ba6f(_0x55fe35, _0x13ed10, _0x4b41fa); } else { const _0x73e6cb = _0x27b19d(); _0x73e6cb && _0x73e6cb[_0x1d54b9(0xaae)] && _0x73e6cb[_0x1d54b9(0xaae)]['isActive'] && (_0x5d9d14[_0x1d54b9(0x10d)][_0x1d54b9(0x5eb)] = _0x1d54b9(0x4ef), setTimeout(() => _0x5d9d14[_0x1d54b9(0x882)][_0x1d54b9(0x7c3)](_0x1d54b9(0x11b)), 0xa)); } } return; } if (window[_0x1d54b9(0x95c)]()[_0x1d54b9(0x79d)]()) return; const _0x581195 = _0x52b1ff['target'][_0x1d54b9(0x939)](_0x1d54b9(0x980)); if (_0x581195 && !_0x52b1ff[_0x1d54b9(0x6c4)][_0x1d54b9(0x939)](_0x1d54b9(0x288))) { const _0x1ec36b = parseInt(_0x581195[_0x1d54b9(0xab1)][_0x1d54b9(0x215)], 0xa); if (!isNaN(_0x1ec36b)) { if (_0x1d54b9(0x94d) === _0x1d54b9(0x94d)) _0x1351da(_0x1ec36b); else { let _0x45787e = _0x7b29ad[_0x1d54b9(0x79a)][_0x1d54b9(0x212)](_0x3cacd5 => _0x3cacd5[_0x1d54b9(0x6b7)] === _0x1a7f53[_0x1d54b9(0x6b7)]); if (_0x45787e) _0x4d146b[_0x1d54b9(0x36b)](_0x45787e['id']); else { const _0x481750 = { 'id': _0x1d54b9(0x405) + _0x29b7e6[_0x1d54b9(0x7a8)]() + '_' + _0x263470[_0x1d54b9(0x59a)](), 'name': _0x4a4cc1['name'], 'content': _0x23ac28[_0x1d54b9(0x9a8)] }; _0x590f09[_0x1d54b9(0x79a)]['push'](_0x481750), _0x263eed[_0x1d54b9(0x36b)](_0x481750['id']); } } } } }); const _0xa2f4af = document[_0x379719(0x248)](_0x379719(0x8f1)); _0xa2f4af && _0xa2f4af[_0x379719(0x578)]('click', () => { const _0x48285a = _0x379719; if (_0x48285a(0xa5a) === _0x48285a(0x21f)) { const _0x508725 = _0x58aa4a(_0x143f98[_0x48285a(0xe5)]); if (_0x1feeb0(_0x508725) || _0x508725 <= 0x0) { _0x4192d2(_0x48285a(0x23e)); return; } const _0x1c74b3 = _0x546f39(); let _0x3fc51a = null; _0x1c74b3[_0x48285a(0xa78)] === _0x48285a(0x732) ? _0x3fc51a = _0x8019cc[_0x48285a(0xe5)] : _0x3fc51a = _0x1c74b3[_0x48285a(0x26f)][0x0]; const _0xb01023 = _0xda88b(_0x1c74b3['id']), _0x15d1f4 = { 'role': 'user', 'type': _0x48285a(0x270), 'content': _0x48285a(0x4e9) + (_0x47f6bb(_0x3fc51a)?.[_0x48285a(0x6b7)] || '未知') + _0x48285a(0x3c0) + _0x508725 + ']', 'amount': _0x508725, 'recipientId': _0x3fc51a, 'senderId': _0xb01023['id'], 'timestamp': _0x2cc1f8[_0x48285a(0x7a8)]() }; _0x5b41c4[_0x48285a(0x675)]['push'](_0x15d1f4), _0xf98c99(), _0x4d5526(), _0x13e355[_0x48285a(0x882)]['remove'](_0x48285a(0x11b)); } else _0x3a6c86(_0x48285a(0x534)); }); const _0x1355b0 = document[_0x379719(0x248)](_0x379719(0x753)), _0x40c189 = localStorage[_0x379719(0x915)]('customStickers'); if (_0x40c189) { if (_0x379719(0x436) === 'gvPZh') _0x3f6e08[_0x379719(0x663)] = _0x3a0100['id']; else try { const _0x3c5f11 = JSON[_0x379719(0x329)](_0x40c189); Array[_0x379719(0x796)](_0x3c5f11) && (_0x1355b0[_0x379719(0xe5)] = _0x3c5f11['map'](_0x30ddad => _0x30ddad[_0x379719(0x6b7)] + '--' + _0x30ddad[_0x379719(0x83a)])[_0x379719(0x64e)]('\x0a')); } catch (_0xe7354) { } } document['getElementById'](_0x379719(0x7cc))[_0x379719(0x578)](_0x379719(0x4b3), () => { const _0x86c50e = _0x379719, _0x4bd514 = _0x1355b0[_0x86c50e(0xe5)], _0x178076 = _0x4bd514['split']('\x0a')[_0x86c50e(0x54e)](_0x2e3e9f => _0x2e3e9f[_0x86c50e(0x3ee)]() !== ''), _0x5961b = []; let _0x5c2d26 = 0x0; for (const _0x5fe040 of _0x178076) { const _0x47adbd = _0x5fe040['split']('--'); if (_0x47adbd[_0x86c50e(0x848)] === 0x2 && _0x47adbd[0x0][_0x86c50e(0x3ee)]() && _0x47adbd[0x1][_0x86c50e(0x3ee)]()[_0x86c50e(0x33c)]('http')) { if (_0x86c50e(0x2dd) === _0x86c50e(0x2dd)) _0x5961b[_0x86c50e(0x36b)]({ 'name': _0x47adbd[0x0][_0x86c50e(0x3ee)](), 'url': _0x47adbd[0x1][_0x86c50e(0x3ee)]() }); else { const _0x7c0f25 = { 'id': _0x12b8e0['id'], 'url': _0x27d92e[_0x86c50e(0x5e3)] }; _0x4e6787(this, _0x7c0f25); } } else _0x86c50e(0x333) !== _0x86c50e(0x7ff) ? _0x5c2d26++ : _0x5744bb[_0x86c50e(0x9ac)] = _0x100a97[_0x86c50e(0x10f)](_0x6fbb61)[_0x86c50e(0xa21)](_0x52ca76 => _0x52ca76[_0x86c50e(0x50d)][_0x86c50e(0x9ac)]['trim']())[_0x86c50e(0x64e)]('、'); } _0x5c2d26 > 0x0 && _0x3a6c86('有\x20' + _0x5c2d26 + _0x86c50e(0x3b5)); try { localStorage['setItem'](_0x86c50e(0x68f), JSON[_0x86c50e(0x22e)](_0x5961b)), _0x3a6c86('表情包已保存！正在刷新应用...'), setTimeout(() => location[_0x86c50e(0x7a6)](), 0x5dc); } catch (_0x1cba8a) { _0x86c50e(0x8e6) === 'GyLLG' ? _0x3a6c86('保存失败，你的表情包是不是太多了？') : _0xa5d8bb[_0x86c50e(0x89a)](_0x86c50e(0x13c) + _0x8ef87d['id']); } }), _0x3b293d(), document[_0x379719(0x248)](_0x379719(0xa5c))[_0x379719(0x578)](_0x379719(0x4b3), () => { const _0x11786e = _0x379719; document['getElementById'](_0x11786e(0x705))[_0x11786e(0x4b3)](); }), document[_0x379719(0x248)]('reset-card-button-2')[_0x379719(0x578)](_0x379719(0x4b3), async () => { const _0x4e9d2f = _0x379719; _0x4e9d2f(0x322) !== 'Yefux' ? (await _0x2e3a29('widget_card_2'), localStorage[_0x4e9d2f(0x89a)](_0x4e9d2f(0x88d)), _0x28e8b9(), _0x3a6c86('卡片\x202\x20已移除。')) : (_0x5a8c6e(_0x4e9d2f(0x78c), _0x4e9d2f(0x362)), _0x166db6(() => _0x3be6c9(), 0x64)); }), document[_0x379719(0x248)]('card-input-2')[_0x379719(0x578)](_0x379719(0x423), async _0x5991e3 => { const _0x1a2346 = _0x379719, _0x5742e8 = _0x5991e3['target'][_0x1a2346(0x5fc)][0x0]; if (!_0x5742e8) return; try { _0x1a2346(0xa9a) === _0x1a2346(0xa9a) ? (await _0x5ef29b(_0x1a2346(0x671), _0x5742e8), await _0x28e8b9(), _0x3a6c86('卡片\x202\x20已更换！')) : (_0x364217 = _0xefc78b['createElement']('div'), _0x493735['id'] = _0x1a2346(0x26c), _0x26e8a1[_0x1a2346(0x6ab)](_0x11f6c1)); } catch (_0x3af4d9) { _0x3a6c86(_0x1a2346(0x247) + _0x3af4d9[_0x1a2346(0x380)]); } }), _0x100011(), _0x424e41(), _0x9f98f6(), document[_0x379719(0x248)](_0x379719(0x6f8))['addEventListener'](_0x379719(0x4b3), async () => { const _0xa0407e = _0x379719; if (_0xa0407e(0x937) === 'qWdzg') { const _0x2539c9 = await _0x52e7d6(_0xa0407e(0x3d4)); if (_0x2539c9) { const _0x2ade1a = await _0x52e7d6(_0xa0407e(0x948)); if (_0x2ade1a) { _0xbc2d1c(!![], '正在执行净化程序...'); try { localStorage[_0xa0407e(0xd4)](); const _0x572e88 = await _0x12b672, _0x52b536 = _0x572e88[_0xa0407e(0x319)]([_0xa0407e(0x8c8), 'music_library', _0xa0407e(0xad1)], _0xa0407e(0x52c)); await Promise[_0xa0407e(0x63b)]([_0x52b536[_0xa0407e(0x963)](_0xa0407e(0x8c8))[_0xa0407e(0xd4)](), _0x52b536[_0xa0407e(0x963)](_0xa0407e(0x490))[_0xa0407e(0xd4)](), _0x52b536[_0xa0407e(0x963)](_0xa0407e(0xad1))[_0xa0407e(0xd4)]()]), await new Promise(_0xe6e6f0 => { const _0x3cf016 = _0xa0407e; _0x3cf016(0x2d3) === 'UukqU' ? _0x52b536['oncomplete'] = _0xe6e6f0 : _0x1262c7(_0x3cf016(0x244)); }), _0x3a6c86(_0xa0407e(0x338)), setTimeout(() => { const _0x10b424 = _0xa0407e; if (_0x10b424(0x500) !== _0x10b424(0x500)) { const _0x4fd3e1 = _0x6677d9[_0x10b424(0x385)](); _0x4fd3e1[_0x10b424(0x330)] = () => _0x56c71f(_0x4fd3e1[_0x10b424(0x4f7)]), _0x4fd3e1['onerror'] = () => _0xa8c46c(_0x4fd3e1[_0x10b424(0x729)]); } else location[_0x10b424(0x7a6)](); }, 0x5dc); } catch (_0x95e41b) { _0xbc2d1c(![]), _0x3a6c86(_0xa0407e(0x4b2) + _0x95e41b[_0xa0407e(0x380)]); } } } } else _0x5f261a(_0x536958['id'], _0x2ebd41['map'](_0x14c7e7 => _0x14c7e7['id'])); }); } const _0x4dd7ec = _0x1da6ac(0x490); async function _0x5ac867(_0xc69781) { const _0x4e97a5 = _0x1da6ac; if ('zUYqS' === 'qrKhH') _0x415504[_0x4e97a5(0x861)](_0x4863c9, _0x168018['firstChild']); else { const _0xccc202 = await _0x12b672; return new Promise((_0x29032d, _0x235608) => { const _0x309ded = _0x4e97a5; if (_0x309ded(0x54b) !== 'HnNCY') _0x1ea10b[_0x309ded(0x70a)] = _0x12723a[_0x309ded(0x1a2)]; else { const _0x285a55 = _0xccc202[_0x309ded(0x319)](_0x4dd7ec, _0x309ded(0x559)), _0xe32703 = _0x285a55['objectStore'](_0x4dd7ec), _0x541816 = _0xe32703[_0x309ded(0xa25)](_0xc69781); _0x541816['onsuccess'] = () => _0x29032d(_0x541816[_0x309ded(0x4f7)]), _0x541816[_0x309ded(0x136)] = () => _0x235608(_0x541816[_0x309ded(0x729)]); } }); } } async function _0x35a611() { const _0x1a8170 = await _0x12b672; return new Promise((_0x551beb, _0x2dfbdc) => { const _0x45264c = _0x2af4; if (_0x45264c(0x3f0) === _0x45264c(0x870)) _0x3f83d2(_0x2e404e['id']), _0x17d07c(!![]); else { const _0x49cc7f = _0x1a8170[_0x45264c(0x319)](_0x4dd7ec, _0x45264c(0x559)), _0x4bd64d = _0x49cc7f[_0x45264c(0x963)](_0x4dd7ec), _0x595ebc = _0x4bd64d[_0x45264c(0x385)](); _0x595ebc[_0x45264c(0x330)] = () => _0x551beb(_0x595ebc['result']), _0x595ebc['onerror'] = () => _0x2dfbdc(_0x595ebc[_0x45264c(0x729)]); } }); } async function _0x3eab3b(_0xf5a48f) { const _0x1b2bbc = await _0x12b672; return new Promise((_0x50d08b, _0xda0fc6) => { const _0x1932a5 = _0x2af4; if (_0x1932a5(0xe4) === 'ThFzN') { const _0x58817e = _0x1b2bbc[_0x1932a5(0x319)](_0x4dd7ec, _0x1932a5(0x52c)), _0x570a72 = _0x58817e[_0x1932a5(0x963)](_0x4dd7ec), _0x4cb29d = _0x570a72[_0x1932a5(0xa8b)](_0xf5a48f); _0x4cb29d['onsuccess'] = () => _0x50d08b(_0x4cb29d['result']), _0x4cb29d[_0x1932a5(0x136)] = () => _0xda0fc6(_0x4cb29d['error']); } else { const _0x4bfedb = _0x193279['conversationHistory'][_0x1932a5(0x7ec)](_0x14f935); if (_0x4bfedb > -0x1) return _0x5893be(_0x44d6b1, _0x4bfedb); return _0x1ee1b1[_0x1932a5(0x9d9)](); } }); } async function _0x14b234(_0xfde8bb) { const _0x3a4026 = await _0x12b672; return new Promise((_0x331790, _0x27d03e) => { const _0x54dc52 = _0x2af4, _0x403285 = _0x3a4026[_0x54dc52(0x319)](_0x4dd7ec, 'readwrite'), _0x233ff3 = _0x403285[_0x54dc52(0x963)](_0x4dd7ec), _0x59a338 = _0x233ff3[_0x54dc52(0x845)](_0xfde8bb); _0x59a338[_0x54dc52(0x330)] = () => _0x331790(), _0x59a338[_0x54dc52(0x136)] = () => _0x27d03e(_0x59a338[_0x54dc52(0x729)]); }); } let _0x4c15ce = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; const _0x5ab420 = { 'audio': document['getElementById']('altar-slot-audio'), 'cover': document['getElementById']('altar-slot-cover'), 'info': document[_0x1da6ac(0x248)]('altar-slot-info'), 'lyrics': document[_0x1da6ac(0x248)](_0x1da6ac(0x2fd)) }, _0x55bfc0 = { 'audio': document[_0x1da6ac(0x248)](_0x1da6ac(0x12e)), 'cover': document[_0x1da6ac(0x248)](_0x1da6ac(0xa1c)), 'info': document[_0x1da6ac(0x248)](_0x1da6ac(0x15f)), 'lyrics': document[_0x1da6ac(0x248)](_0x1da6ac(0x86a)) }; for (const _0x114db9 in _0x5ab420) { _0x5ab420[_0x114db9]['addEventListener']('click', () => _0x55bfc0[_0x114db9][_0x1da6ac(0x4b3)]()), _0x55bfc0[_0x114db9][_0x1da6ac(0x578)](_0x1da6ac(0x423), _0xbef6fd => { _0x31452f(_0x114db9, _0xbef6fd['target']['files'][0x0]); }); } function _0x31452f(_0xf1cf1b, _0x39be75) { const _0x2ae13a = _0x1da6ac; if (!_0x39be75) return; _0x4c15ce[_0xf1cf1b] = _0x39be75, _0x5ab420[_0xf1cf1b][_0x2ae13a(0x838)](_0x2ae13a(0x138))[_0x2ae13a(0x9ac)] = _0x39be75[_0x2ae13a(0x6b7)], _0x5ab420[_0xf1cf1b][_0x2ae13a(0x882)][_0x2ae13a(0x7c3)](_0x2ae13a(0x8f7)), _0x5d76dc(); } function _0x5d76dc() { const _0x2a4a7f = _0x1da6ac; if (_0x2a4a7f(0x504) !== _0x2a4a7f(0x616)) { const _0x4d2c80 = document['getElementById'](_0x2a4a7f(0x3e6)); _0x4c15ce[_0x2a4a7f(0x774)] && _0x4c15ce['info'] ? _0x2a4a7f(0x9c7) !== 'BUwiP' ? _0x4d2c80['disabled'] = ![] : _0x486eb1 = _0x8bc7e0[_0x2a4a7f(0x917)] || _0x13ca68 : _0x4d2c80[_0x2a4a7f(0xf6)] = !![]; } else _0x1b03eb[_0x2a4a7f(0x9ac)] = _0x2a4a7f(0x214), _0x3fa553[_0x2a4a7f(0x9a1)] = _0x2a4a7f(0x48b); } function _0x44e86c() { const _0x309e79 = _0x1da6ac; _0x4c15ce = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x4d12f2 in _0x5ab420) { 'xjcuF' !== _0x309e79(0x3b0) ? _0x16c28f = _0x3153fa(_0x130b3f) : (_0x5ab420[_0x4d12f2][_0x309e79(0x882)][_0x309e79(0xae0)](_0x309e79(0x8f7)), _0x55bfc0[_0x4d12f2][_0x309e79(0xe5)] = ''); } _0x5ab420[_0x309e79(0x774)][_0x309e79(0x838)](_0x309e79(0x138))[_0x309e79(0x9ac)] = _0x309e79(0x49a), _0x5ab420[_0x309e79(0x55a)][_0x309e79(0x838)](_0x309e79(0x138))[_0x309e79(0x9ac)] = '点击选择\x20.jpg\x20或\x20.png', _0x5ab420[_0x309e79(0x53c)][_0x309e79(0x838)]('.slot-filename')[_0x309e79(0x9ac)] = _0x309e79(0xad8), _0x5ab420['lyrics'][_0x309e79(0x838)](_0x309e79(0x138))['textContent'] = _0x309e79(0x13d), _0x5d76dc(); } document[_0x1da6ac(0x248)]('confirm-altar-upload-button')[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), async () => { const _0x5b8e66 = _0x1da6ac; if (!_0x4c15ce['audio'] || !_0x4c15ce['info']) { if (_0x5b8e66(0x45a) === _0x5b8e66(0x45a)) { _0x3a6c86('真是的，必需的祭品都还没准备好！'); return; } else _0x1e2fd0(), _0x13e25d(![]); } await _0x32c034(); }), document[_0x1da6ac(0x248)](_0x1da6ac(0x2e1))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { _0x44e86c(), _0x1c4afc('musicUploadAltar', 'musicLibrary'); }), document[_0x1da6ac(0x248)](_0x1da6ac(0x258))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x349cf6 = _0x1da6ac; _0x1c4afc(_0x349cf6(0x94f), 'musicUploadAltar'); }); async function _0x32c034() { const _0x5281e8 = _0x1da6ac; if (_0x5281e8(0x5be) !== _0x5281e8(0x477)) { _0xbc2d1c(!![], _0x5281e8(0x340)); try { const _0x2c7a66 = await _0x4c15ce[_0x5281e8(0x53c)]['text'](); let _0x588ce3; if (_0x2c7a66['trim']()[_0x5281e8(0x33c)]('{')) _0x588ce3 = JSON[_0x5281e8(0x329)](_0x2c7a66); else { _0x588ce3 = {}; const _0x4cc5a0 = _0x2c7a66[_0x5281e8(0x5ac)]('\x0a'); _0x4cc5a0[_0x5281e8(0x986)](_0x2e3826 => { const _0x190263 = _0x5281e8, _0x53d26a = _0x2e3826[_0x190263(0x5ac)](/:\s|：\s/); if (_0x53d26a[_0x190263(0x848)] === 0x2) { const _0x454210 = _0x53d26a[0x0]['trim'](), _0x56f6cc = _0x53d26a[0x1]['trim'](), _0x81186 = { '歌名': _0x190263(0x6f5), '艺术家': '歌手', '专辑': '专辑' }; _0x81186[_0x454210] && (_0x588ce3[_0x81186[_0x454210]] = _0x56f6cc); } }); if (!_0x588ce3[_0x5281e8(0x6f5)]) throw new Error('在你那乱七八糟的文本里没找到“歌名”！'); _0x588ce3[_0x5281e8(0x24a)] = _0x5281e8(0x364) + Date['now'](); } const _0x81182f = _0x5281e8(0x364) + (_0x588ce3[_0x5281e8(0x24a)] || Date[_0x5281e8(0x7a8)]()), _0x3c5b04 = { 'id': _0x81182f, 'info': _0x588ce3, 'audio': _0x4c15ce[_0x5281e8(0x774)], 'cover': _0x4c15ce[_0x5281e8(0x55a)], 'lyrics': _0x4c15ce['lyrics'] ? await _0x4c15ce[_0x5281e8(0x64d)][_0x5281e8(0x958)]() : '' }; await _0x3eab3b(_0x3c5b04), await _0x541f57(), _0xbc2d1c(![]), _0x3a6c86('歌曲“' + _0x588ce3['歌曲名称'] + _0x5281e8(0x4b0)), _0x1c4afc(_0x5281e8(0x94f), _0x5281e8(0x8f8)); } catch (_0x43b601) { _0xbc2d1c(![]), console[_0x5281e8(0x729)](_0x5281e8(0x2c3), _0x43b601), _0x3a6c86(_0x5281e8(0xa11) + _0x43b601['message']); } } else { const _0x450f9d = _0x2a9a31[_0x5281e8(0x329)](_0x27e1b8); _0x450f9d['accountingLedger'] && (_0x1a8005[_0x5281e8(0xa29)] = _0x450f9d[_0x5281e8(0xa29)], _0x533f86[_0x5281e8(0x5e0)](_0x5281e8(0x7a5))); } } async function _0x541f57() { const _0x5c7a42 = _0x1da6ac, _0x56e573 = document[_0x5c7a42(0x248)](_0x5c7a42(0x3b8)); _0x56e573['innerHTML'] = ''; const _0x3ed132 = await _0x35a611(); if (_0x3ed132[_0x5c7a42(0x848)] === 0x0) { _0x56e573[_0x5c7a42(0x9a1)] = _0x5c7a42(0x61b); return; } _0x3ed132['sort']((_0x2ea74d, _0x4f245f) => (_0x2ea74d[_0x5c7a42(0x53c)][_0x5c7a42(0x6f5)] || '')[_0x5c7a42(0x305)](_0x4f245f[_0x5c7a42(0x53c)][_0x5c7a42(0x6f5)] || '')); for (const _0x28d82d of _0x3ed132) { if (_0x5c7a42(0x96d) !== _0x5c7a42(0x96d)) { _0x197c31[_0x5c7a42(0x729)](_0x5c7a42(0x159)); return; } else { const _0x407265 = document['createElement'](_0x5c7a42(0x6ff)); _0x407265[_0x5c7a42(0x296)] = _0x5c7a42(0x700), _0x407265[_0x5c7a42(0xab1)][_0x5c7a42(0x181)] = _0x28d82d['id']; const _0x4c4910 = _0x28d82d[_0x5c7a42(0x55a)] ? URL[_0x5c7a42(0x73d)](_0x28d82d[_0x5c7a42(0x55a)]) : _0x5da029; _0x407265[_0x5c7a42(0x9a1)] = _0x5c7a42(0x6b6) + _0x4c4910 + _0x5c7a42(0x467) + (_0x28d82d[_0x5c7a42(0x53c)][_0x5c7a42(0x6f5)] || _0x5c7a42(0xa34)) + _0x5c7a42(0x865) + (_0x28d82d[_0x5c7a42(0x53c)]['歌手'] || '未知艺术家') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; let _0x208846 = null; const _0x2ad14e = _0x2015ae => { const _0x3af57d = _0x5c7a42; if (_0x2015ae[_0x3af57d(0x8e2)] === 0x2) return; _0x208846 = setTimeout(async () => { const _0x16dc35 = _0x3af57d; if (_0x16dc35(0x1fd) === _0x16dc35(0x1fd)) { if (_0x2015ae[_0x16dc35(0xa78)] === _0x16dc35(0x936)) _0x2015ae[_0x16dc35(0x148)](); const _0x35b4e8 = await _0x52e7d6(_0x16dc35(0x33e) + _0x28d82d['info'][_0x16dc35(0x6f5)] + _0x16dc35(0x2ca)); _0x35b4e8 && ('oiWIC' === _0x16dc35(0x397) ? (_0x2ab62d[_0x16dc35(0x1a2)] = _0x169929, _0x2b60e1 = !![]) : (await _0x14b234(_0x28d82d['id']), await _0x541f57(), _0x3a6c86('已删除。'))); } else { const _0x470639 = _0x4612c3[_0x16dc35(0x22e)](_0x1427bc[_0x16dc35(0x5e0)] || [])[_0x16dc35(0x7cf)](/'/g, '&apos;')['replace'](/"/g, _0x16dc35(0x4ac)), _0x17ebab = _0x1a5999[_0x16dc35(0x719)] || _0x16dc35(0x440); return _0x16dc35(0x3fa) + (_0x165d26 < _0x522894[_0x16dc35(0x848)] - 0x1 ? _0x16dc35(0x3f6) : '') + _0x16dc35(0xd1) + _0x470639 + _0x16dc35(0x840) + _0x17ebab + _0x16dc35(0x193) + _0x3ebaaf + _0x16dc35(0x602) + _0x17ebab[_0x16dc35(0x9d2)](0x0) + _0x16dc35(0x53d) + _0x17ebab + _0x16dc35(0x5a6) + (_0x1ceb9d['last_message_preview'] || '') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20var(--text-color-light);\x20font-size:\x201.2rem;\x20margin-left:\x20auto;\x20font-weight:\x20200;\x22>›</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; } }, 0x320); }, _0x597f46 = () => { const _0x4257af = _0x5c7a42; 'LJZRH' !== _0x4257af(0x1b2) ? clearTimeout(_0x208846) : (_0x28d3ee[_0x4257af(0x1a2)] = _0x33852b, _0x18426f = !![]); }; _0x407265[_0x5c7a42(0x578)](_0x5c7a42(0x41e), _0x2ad14e), _0x407265['addEventListener'](_0x5c7a42(0x529), _0x597f46), _0x407265[_0x5c7a42(0x578)](_0x5c7a42(0x79b), _0x597f46), _0x407265[_0x5c7a42(0x578)](_0x5c7a42(0x936), _0x2ad14e, { 'passive': ![] }), _0x407265[_0x5c7a42(0x578)](_0x5c7a42(0xa13), _0x597f46), _0x407265[_0x5c7a42(0x578)]('touchcancel', _0x597f46), _0x407265[_0x5c7a42(0x578)](_0x5c7a42(0x4b3), _0x59de1f => { const _0x3db4f9 = _0x5c7a42; if (_0x208846) clearTimeout(_0x208846); if (_0x59de1f[_0x3db4f9(0x691)]) return; setTimeout(() => { const _0x31341a = _0x3db4f9; if (_0x31341a(0x8ef) === _0x31341a(0x8ef)) _0x208846 && _0x520b2f(_0x28d82d['id'], _0x3ed132[_0x31341a(0xa21)](_0x4d2b37 => _0x4d2b37['id'])); else { if (_0x1fdd9d === null) return; const _0x1b8f7c = _0x326e2a[_0x31341a(0xe5)]['trim'](); if (_0x1b8f7c === '') { _0x36b052(); return; } const _0x3d4d56 = _0x1e183a[_0x31341a(0x675)][_0x175e3e]; _0x3d4d56 && (_0x3d4d56[_0x31341a(0x9a8)] = _0x1b8f7c, _0x59e30c(), _0xe3b618()), _0x22016c[_0x31341a(0x882)]['remove'](_0x31341a(0x11b)), _0x28d097 = null; } }, 0x32); }), _0x56e573[_0x5c7a42(0x6ab)](_0x407265); } } } _0x2eff04['addEventListener'](_0x1da6ac(0x4b3), () => { const _0x703ea6 = _0x1da6ac; _0x3a6c86(_0x703ea6(0x244)); }), _0x40e017['addEventListener'](_0x1da6ac(0x4b3), () => { const _0xd61b75 = _0x1da6ac; _0x3a6c86(_0xd61b75(0x30d)); }); let _0x32c055 = [], _0x226610 = -0x1; async function _0x520b2f(_0x2aea68, _0x33c344) { const _0x2612b9 = _0x1da6ac; if (_0x2612b9(0x447) !== 'eZcxR') { const _0x3d32e0 = await _0x5ac867(_0x2aea68); if (!_0x3d32e0) return; _0x36ef7c = { 'title': _0x3d32e0[_0x2612b9(0x53c)][_0x2612b9(0x6f5)] || _0x2612b9(0xa34), 'artist': _0x3d32e0['info']['歌手'] || '未知艺术家', 'cover': _0x3d32e0[_0x2612b9(0x55a)] ? URL[_0x2612b9(0x73d)](_0x3d32e0['cover']) : _0x5da029, 'isFromLibrary': !![] }; const _0x47646c = URL[_0x2612b9(0x73d)](_0x3d32e0[_0x2612b9(0x774)]); _0x2af425[_0x2612b9(0x70a)] = _0x47646c, _0x2af425[_0x2612b9(0x8ad)](), _0x54ff46(); } else { const _0x203326 = _0x2170c9[_0x2612b9(0x5ac)]('--'); _0x203326[_0x2612b9(0x848)] === 0x2 && _0x203326[0x0][_0x2612b9(0x3ee)]() && _0x203326[0x1]['trim']()['startsWith'](_0x2612b9(0x23d)) ? _0x1ae7c0[_0x2612b9(0x36b)]({ 'name': _0x203326[0x0]['trim'](), 'url': _0x203326[0x1][_0x2612b9(0x3ee)]() }) : _0x47da4a++; } } async function _0x54ff46() { const _0x62cee4 = _0x1da6ac; if (_0x62cee4(0x98a) === _0x62cee4(0x98a)) { const _0x3b1727 = document['getElementById']('music-widget-card'), _0x1e7154 = document[_0x62cee4(0x248)]('widget-title'), _0xf6e886 = document['getElementById']('widget-artist'), _0x577046 = document[_0x62cee4(0x248)]('widget-cover-art'), _0x1a7db3 = _0x36ef7c; if (_0x1a7db3 && _0x1a7db3[_0x62cee4(0x23c)]) _0x1e7154[_0x62cee4(0x9ac)] = _0x1a7db3[_0x62cee4(0x4cf)], _0xf6e886[_0x62cee4(0x9ac)] = _0x1a7db3['artist'], _0x3b1727[_0x62cee4(0x882)][_0x62cee4(0x7c3)](_0x62cee4(0x2a7)), _0x3b1727[_0x62cee4(0x10d)][_0x62cee4(0x91f)](_0x62cee4(0xe3), _0x62cee4(0x5a3) + _0x1a7db3[_0x62cee4(0x55a)] + ')'); else { if (_0x62cee4(0x130) !== _0x62cee4(0x130)) { if (!_0x299ad8[_0x62cee4(0x618)]) return; _0x266dee[_0x62cee4(0x9ac)] = '回复\x20' + _0x12e97c[_0x62cee4(0x618)][_0x62cee4(0x4be)], _0x536c8f[_0x62cee4(0x9ac)] = _0x5657b2[_0x62cee4(0x618)][_0x62cee4(0x9a8)], _0x4c7051[_0x62cee4(0x10d)]['display'] = 'block'; } else _0x1e7154[_0x62cee4(0x9ac)] = '暂无音乐', _0xf6e886[_0x62cee4(0x9ac)] = _0x62cee4(0x22a), _0x3b1727[_0x62cee4(0x882)][_0x62cee4(0xae0)]('is-playing'), _0x577046[_0x62cee4(0x10d)][_0x62cee4(0x91f)](_0x62cee4(0xe3), _0x62cee4(0x3fe)); } } else { const _0x17f5ed = _0x423525['conversationHistory'][_0x62cee4(0x54e)](_0x5730a0 => _0x5730a0[_0x62cee4(0xa78)] === _0x62cee4(0x868) && _0x5730a0[_0x62cee4(0x5e3)])[_0x62cee4(0xa21)](_0x3598c0 => ({ ..._0x3598c0, 'source': _0x62cee4(0x78c) })); _0x431a35['push'](..._0x17f5ed); } } _0x2eff04 && _0x2eff04[_0x1da6ac(0x578)]('click', () => { const _0x3b33dc = _0x1da6ac; if (_0x32c055[_0x3b33dc(0x848)] === 0x0) return; _0x226610 = (_0x226610 + 0x1) % _0x32c055[_0x3b33dc(0x848)], _0x520b2f(_0x32c055[_0x226610], _0x32c055); }); _0x40e017 && _0x40e017['addEventListener']('click', () => { const _0x530671 = _0x1da6ac; if (_0x530671(0x56b) !== _0x530671(0x56b)) { const _0x25e60a = _0xa4d57b[_0x530671(0x51f)](), _0x165cfa = _0x30ca81[_0x530671(0x51f)](); if (_0x25e60a['startsWith'](_0x530671(0x7d4))) return _0x530671(0x2b7); if (_0x165cfa[_0x530671(0xa83)](_0x530671(0x2f9))) return _0x530671(0x2b7); if (_0x165cfa['includes'](_0x530671(0xc7))) return _0x530671(0x1a7); if (_0x25e60a['startsWith'](_0x530671(0x1a7))) return 'gemini'; return 'openai'; } else { if (_0x32c055[_0x530671(0x848)] === 0x0) return; _0x226610 = (_0x226610 - 0x1 + _0x32c055[_0x530671(0x848)]) % _0x32c055[_0x530671(0x848)], _0x520b2f(_0x32c055[_0x226610], _0x32c055); } }); _0x2af425[_0x1da6ac(0x578)]('play', () => { const _0x4c4c39 = _0x1da6ac; if ('tIMhW' !== _0x4c4c39(0x9c5)) _0x48e883[_0x4c4c39(0x578)]('click', function () { const _0xb76402 = _0x4c4c39, _0x2fc67f = { 'id': _0x22405c['id'], 'url': _0x59e413[_0xb76402(0x5e3)] }; _0x36f0c7(this, _0x2fc67f); }); else { if (_0x2f0758) _0x2f0758[_0x4c4c39(0x9ac)] = '❚❚'; } }), _0x2af425[_0x1da6ac(0x578)](_0x1da6ac(0x4b8), () => { const _0x39d86c = _0x1da6ac; if (_0x39d86c(0x8dd) === _0x39d86c(0xa76)) { const _0xb7ff81 = _0x3e44b4(_0x444475[_0x39d86c(0x26f)][0x0]); _0x23a728[_0x39d86c(0x9ac)] = _0xb7ff81 ? _0xb7ff81[_0x39d86c(0x6b7)] : _0x39d86c(0x187); } else { if (_0x2f0758) _0x2f0758['textContent'] = '▶'; } }), _0x2af425[_0x1da6ac(0x578)](_0x1da6ac(0x2e2), () => { const _0x5c20e4 = _0x1da6ac; if ('dkILd' !== _0x5c20e4(0x46b)) { const _0x4d6409 = _0x5acc73(_0x3f8b53); if (_0x4d6409) { const _0x248419 = _0x3e43f2[_0x5c20e4(0x3b9)](_0x5c20e4(0x99e)); _0x248419['value'] = _0x4d6409['id'], _0x248419[_0x5c20e4(0x9ac)] = _0x4d6409['name'], _0x593d1c['appendChild'](_0x248419); } } else { if (_0x2eff04) _0x2eff04[_0x5c20e4(0x4b3)](); } }); function _0x477719() { const _0x2e68d6 = _0x1da6ac, _0x15bff1 = _0x27b19d(); if (!_0x15bff1) return; _0x9adf8f[_0x2e68d6(0x9a1)] = '', _0x249610['value'] = '', _0x15bff1[_0x2e68d6(0xa78)] === _0x2e68d6(0x732) ? (_0x15bff1[_0x2e68d6(0x26f)][_0x2e68d6(0x986)](_0x27d233 => { const _0x2a352b = _0x2e68d6; if (_0x2a352b(0x5b0) === _0x2a352b(0x5b0)) { const _0x5b029c = _0x5b19fc(_0x27d233); if (_0x5b029c) { const _0x5748c0 = document[_0x2a352b(0x3b9)](_0x2a352b(0x99e)); _0x5748c0['value'] = _0x5b029c['id'], _0x5748c0[_0x2a352b(0x9ac)] = _0x5b029c['name'], _0x9adf8f[_0x2a352b(0x6ab)](_0x5748c0); } } else { const _0x1ecc7a = _0x2ca925(_0x42c624[_0x2a352b(0xab1)]['historyIndex'], 0xa); !_0x36bada(_0x1ecc7a) && _0x1dbf71(_0x1ecc7a); } }), _0x50a5bf[_0x2e68d6(0x10d)]['display'] = _0x2e68d6(0x92c)) : _0x50a5bf[_0x2e68d6(0x10d)][_0x2e68d6(0x5eb)] = 'none', _0x5af63d['classList'][_0x2e68d6(0x7c3)](_0x2e68d6(0x11b)), _0x249610[_0x2e68d6(0x6e3)](); } function _0x15981b() { const _0x8e3dec = _0x1da6ac, _0x656593 = parseFloat(_0x249610[_0x8e3dec(0xe5)]); if (isNaN(_0x656593) || _0x656593 <= 0x0) { _0x3a6c86(_0x8e3dec(0x23e)); return; } const _0x552b15 = _0x27b19d(); let _0x33fd48 = null; _0x552b15[_0x8e3dec(0xa78)] === _0x8e3dec(0x732) ? _0x8e3dec(0x866) === _0x8e3dec(0xa22) ? (_0x43784b(_0x8e3dec(0xabf)), _0x21faf7(() => { const _0x3b40a1 = _0x8e3dec; _0x1e26c4(_0x3b40a1(0x78c), _0x3b40a1(0x362)), _0x30545b(() => _0x1be5c1(), 0x64); }, 0x6a4)) : _0x33fd48 = _0x9adf8f[_0x8e3dec(0xe5)] : 'YZIcF' !== _0x8e3dec(0xaa4) ? _0x52ac9a(_0xa51358[_0x8e3dec(0x242)])[_0x8e3dec(0x45f)](_0x3bb63d => { const _0x5b9940 = _0x8e3dec, _0x29d3f6 = _0x47cd59[_0x5b9940(0x248)](_0x178a42); if (_0x29d3f6 && _0x3bb63d) _0x29d3f6[_0x5b9940(0x70a)] = _0x4d6ad8[_0x5b9940(0x73d)](_0x3bb63d); }) : _0x33fd48 = _0x552b15[_0x8e3dec(0x26f)][0x0]; const _0x3097a1 = _0x474290(_0x552b15['id']), _0x11a444 = { 'role': _0x8e3dec(0x27a), 'type': 'transfer', 'content': '[用户向\x20' + (_0x5b19fc(_0x33fd48)?.[_0x8e3dec(0x6b7)] || '未知') + _0x8e3dec(0x3c0) + _0x656593 + ']', 'amount': _0x656593, 'recipientId': _0x33fd48, 'senderId': _0x3097a1['id'], 'timestamp': Date[_0x8e3dec(0x7a8)]() }; _0x10530c['conversationHistory'][_0x8e3dec(0x36b)](_0x11a444), _0x4a0ca0(), _0x1a245d(), _0x5af63d[_0x8e3dec(0x882)][_0x8e3dec(0xae0)](_0x8e3dec(0x11b)); } async function _0x5cfdb2(_0x232ac6) { const _0x4b6912 = _0x1da6ac, _0x2c9763 = _0x5b19fc(_0x232ac6); if (!_0x2c9763) return; const _0x24ebfb = await _0x52e7d6(_0x4b6912(0xa62) + _0x2c9763[_0x4b6912(0x6b7)] + '】的交换日记吗？\x0a此操作不可撤销，AI将彻底遗忘所有日记内容。'); if (!_0x24ebfb) return; const _0x1447a1 = _0x10530c[_0x4b6912(0x938)]['findIndex'](_0xb562b9 => _0xb562b9['characterId'] === _0x232ac6); _0x1447a1 > -0x1 ? (_0x10530c[_0x4b6912(0x938)]['splice'](_0x1447a1, 0x1), _0x3e6d3a(), _0x28da8d(), _0x3a6c86('【' + _0x2c9763['name'] + '】的日记本已被清空。')) : _0x3a6c86(_0x4b6912(0xf1)); } async function _0x4295e9() { const _0x584191 = _0x1da6ac; if (_0x584191(0x196) === _0x584191(0x196)) { const _0x2be64f = document['getElementById'](_0x584191(0xacf)); _0x2be64f[_0x584191(0x9a1)] = ''; const _0x2292d9 = _0x10530c[_0x584191(0x620)][_0x584191(0x54e)](_0x12c25e => _0x10530c[_0x584191(0x4bc)][_0x584191(0xacd)](_0x354d21 => _0x354d21[_0x584191(0xa78)] === _0x584191(0x71a) && _0x354d21[_0x584191(0x26f)]['includes'](_0x12c25e['id']))); if (_0x2292d9['length'] === 0x0) { if ('lKipY' === _0x584191(0x751)) _0x231dd0 = _0x59d8b5[_0x584191(0x3b9)](_0x584191(0x6ff)), _0x985e14[_0x584191(0x296)] = _0x584191(0x3bc), _0x32066d[_0x584191(0x9ac)] = _0x584191(0x1de), _0x96977[_0x584191(0x6ab)](_0xa63236); else { _0x2be64f['innerHTML'] = _0x584191(0x5c4); return; } } for (const _0x42657b of _0x2292d9) { const _0x3e782b = document[_0x584191(0x3b9)]('li'); _0x3e782b[_0x584191(0x296)] = _0x584191(0x833), _0x3e782b[_0x584191(0xab1)][_0x584191(0x438)] = _0x42657b['id']; const _0x30d856 = await _0x533d7a('char_avatar_' + _0x42657b['id']), _0x3c1675 = _0x30d856 ? URL[_0x584191(0x73d)](_0x30d856) : _0x42657b['avatar'] || _0x5da029; _0x3e782b[_0x584191(0x9a1)] = _0x584191(0x3a1) + _0x3c1675 + _0x584191(0x298) + _0x42657b[_0x584191(0x6b7)] + _0x584191(0xa81) + _0x42657b[_0x584191(0x6b7)] + _0x584191(0x453), _0x3e782b[_0x584191(0x838)](_0x584191(0x6ae))[_0x584191(0x578)](_0x584191(0x4b3), () => _0x1dcb39(_0x42657b['id'])), _0x3e782b[_0x584191(0x838)]('.snoop-clear-btn')[_0x584191(0x578)](_0x584191(0x4b3), async _0x4fa1f7 => { const _0x58fedb = _0x584191; _0x4fa1f7['stopPropagation'](); const _0x305c5e = _0x5b19fc(_0x42657b['id']); if (!_0x305c5e) return; const _0x5cf5d1 = await _0x52e7d6(_0x58fedb(0x39e) + _0x305c5e[_0x58fedb(0x6b7)] + _0x58fedb(0x4ca)); if (_0x5cf5d1) { _0xbc2d1c(!![], _0x58fedb(0x1a3) + _0x305c5e[_0x58fedb(0x6b7)] + _0x58fedb(0x58d)); const _0x557f0d = [_0x58fedb(0x6cd), _0x58fedb(0x7a1), _0x58fedb(0x614), 'fragments', _0x58fedb(0x9ff), _0x58fedb(0x699), 'footprints', _0x58fedb(0x9f0)]; for (const _0x3a9429 of _0x557f0d) { if (_0x58fedb(0x49e) !== _0x58fedb(0x597)) { const _0x4dca7c = _0x58fedb(0x326) + _0x305c5e['id'] + '_' + _0x3a9429; await _0x40ce4b(_0x4dca7c); } else _0x1b668c('包含所有图片和音乐的全量数据已成功导出！'); } _0xbc2d1c(![]), _0x3a6c86('【' + _0x305c5e[_0x58fedb(0x6b7)] + _0x58fedb(0x99c)); } }), _0x2be64f[_0x584191(0x6ab)](_0x3e782b); } } else { const _0x5a2d7f = _0x1437bf[_0x584191(0x20d)](_0x584191(0x251)); _0x5a2d7f[_0x584191(0x986)](_0x8ecb98 => _0x8ecb98[_0x584191(0xae0)]()); } } let _0x435117 = null, _0x4d8270 = null; function _0x23bad1() { const _0x434110 = _0x1da6ac, _0x1a7597 = new Date(), _0x3cd74f = document[_0x434110(0x248)]('snoop-home-time'), _0x194088 = document['getElementById'](_0x434110(0x75b)), _0x4d0834 = document[_0x434110(0x248)]('snoop-phone-header'); _0x3cd74f && _0x194088 && (_0x3cd74f['textContent'] = _0x1a7597[_0x434110(0x1cf)](_0x434110(0x89f), { 'hour': _0x434110(0x96e), 'minute': _0x434110(0x96e), 'hour12': ![] }), _0x194088[_0x434110(0x9ac)] = _0x1a7597[_0x434110(0x2d8)](_0x434110(0x89f), { 'month': _0x434110(0x9a9), 'day': _0x434110(0x129), 'weekday': _0x434110(0x9a9) })), _0x4d0834 && (_0x4d0834[_0x434110(0x9a1)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>' + _0x1a7597[_0x434110(0x1cf)](_0x434110(0x89f), { 'hour': _0x434110(0x96e), 'minute': _0x434110(0x96e), 'hour12': ![] }) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>📶\x20🔋</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'); } function _0x1dcb39(_0x134395) { const _0x1a722c = _0x1da6ac; _0x435117 = _0x134395; const _0x463ab8 = _0x5b19fc(_0x134395); if (!_0x463ab8) return; const _0x45b692 = document['getElementById'](_0x1a722c(0x853)), _0x339e5c = document[_0x1a722c(0x248)](_0x1a722c(0x8f5)); if (_0x339e5c) _0x339e5c[_0x1a722c(0xae0)](); const _0x59341e = document[_0x1a722c(0x248)](_0x1a722c(0x995)); if (_0x59341e) _0x59341e[_0x1a722c(0xae0)](); _0x45b692['insertAdjacentHTML'](_0x1a722c(0x1bf), _0x1a722c(0x8fb)), _0x45b692[_0x1a722c(0xa2c)](_0x1a722c(0x1bf), '<div\x20id=\x22snoop-dock\x22></div>'), document['getElementById']('snoop-char-name-header')[_0x1a722c(0x9ac)] = '', _0x51f841(); if (_0x4d8270) clearInterval(_0x4d8270); _0x23bad1(), _0x4d8270 = setInterval(_0x23bad1, 0x2710), _0x1c4afc(_0x1a722c(0x363), 'snoopList'); } function _0x51f841() { const _0x30c250 = _0x1da6ac, _0x5a278c = document['getElementById']('snoop-app-container'), _0x16a257 = document[_0x30c250(0x248)](_0x30c250(0x995)); _0x5a278c[_0x30c250(0x9a1)] = _0x30c250(0x35a), _0x16a257[_0x30c250(0x9a1)] = ''; const _0x56d346 = _0x5a278c[_0x30c250(0x838)](_0x30c250(0x432)), _0x21a0fd = [{ 'id': _0x30c250(0x7a1), 'name': '聊天', 'svg': '<path\x20d=\x22M21\x2015a2\x202\x200\x200\x201-2\x202H7l-4\x204V5a2\x202\x200\x200\x201\x202-2h14a2\x202\x200\x200\x201\x202\x202z\x22></path>', 'area': 'dock' }, { 'id': _0x30c250(0x614), 'name': '浏览器', 'svg': _0x30c250(0x2c9), 'area': _0x30c250(0x608) }, { 'id': 'gallery', 'name': '相册', 'svg': _0x30c250(0x161), 'area': 'dock' }, { 'id': 'summary', 'name': '总结', 'svg': _0x30c250(0x1fe), 'area': _0x30c250(0x608) }, { 'id': _0x30c250(0xac0), 'name': _0x30c250(0x820), 'svg': _0x30c250(0x835), 'area': _0x30c250(0x285) }, { 'id': _0x30c250(0x9ff), 'name': '外卖', 'svg': _0x30c250(0xa42), 'area': _0x30c250(0x285) }, { 'id': _0x30c250(0x699), 'name': '购物', 'svg': _0x30c250(0x414), 'area': _0x30c250(0x285) }, { 'id': _0x30c250(0x195), 'name': '足迹', 'svg': '<path\x20d=\x22M21\x2010c0\x207-9\x2013-9\x2013s-9-6-9-13a9\x209\x200\x200\x201\x2018\x200z\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2210\x22\x20r=\x223\x22></circle>', 'area': _0x30c250(0x285) }]; _0x21a0fd['forEach'](_0x30a691 => { const _0x1d9d6f = _0x30c250, _0x189712 = document[_0x1d9d6f(0x3b9)](_0x1d9d6f(0x6ff)); _0x189712[_0x1d9d6f(0x296)] = _0x1d9d6f(0x2ec), _0x189712[_0x1d9d6f(0x9a1)] = _0x1d9d6f(0x88c) + _0x30a691['svg'] + _0x1d9d6f(0xa12) + _0x30a691[_0x1d9d6f(0x6b7)] + _0x1d9d6f(0x7f6), _0x189712[_0x1d9d6f(0x578)](_0x1d9d6f(0x4b3), () => _0x409dce(_0x30a691['id'], _0x30a691['name'])), _0x30a691[_0x1d9d6f(0x434)] === _0x1d9d6f(0x608) ? _0x16a257[_0x1d9d6f(0x6ab)](_0x189712) : _0x56d346[_0x1d9d6f(0x6ab)](_0x189712); }); } document[_0x1da6ac(0x248)](_0x1da6ac(0x710))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0xcc033a = _0x1da6ac; _0x4d8270 && (clearInterval(_0x4d8270), _0x4d8270 = null); document['getElementById'](_0xcc033a(0x2b5))[_0xcc033a(0x10d)][_0xcc033a(0x5eb)] = _0xcc033a(0x3fe); const _0xc7d184 = document[_0xcc033a(0x248)](_0xcc033a(0x995)); if (_0xc7d184) _0xc7d184['remove'](); const _0xb3108a = document[_0xcc033a(0x248)]('snoop-home-clock'); if (_0xb3108a) _0xb3108a[_0xcc033a(0xae0)](); _0x1c4afc(_0xcc033a(0xa26), _0xcc033a(0x363)); }); async function _0x409dce(_0x3a96b7, _0x5fe001, _0x176c28 = ![]) { const _0x290aee = _0x1da6ac; if (_0x290aee(0x1a4) === 'CJEst') { document[_0x290aee(0x248)]('snoop-phone-top-nav')[_0x290aee(0x10d)][_0x290aee(0x5eb)] = 'none'; const _0x17072f = document['getElementById']('snoop-app-view-container'); _0x17072f[_0x290aee(0x9a1)] = _0x290aee(0x923), _0x17072f[_0x290aee(0x10d)][_0x290aee(0x5eb)] = _0x290aee(0x4ef); const _0x45fd1b = _0x290aee(0x326) + _0x435117 + '_' + _0x3a96b7; try { if (_0x3a96b7 === _0x290aee(0x9f0)) { if (_0x290aee(0x62e) === _0x290aee(0xaca)) _0x92d006(_0x1e2623), _0x3bdca9[_0x290aee(0xe5)] = '', _0x583dce(_0x4ef135, 0x64); else { const _0x2e517f = await _0x5da085(_0x435117); _0x268e91(_0x3a96b7, _0x5fe001, _0x2e517f); return; } } let _0x3b9c82 = await _0x5dadd7(_0x45fd1b); if (_0x176c28 || !_0x3b9c82) { console['log'](_0x290aee(0xabd) + _0x45fd1b + _0x290aee(0x8c5)); let _0x5d396e = await _0x3bd6cb(_0x3a96b7, _0x435117, _0x3b9c82); if (_0x5d396e) { const _0x322752 = _0x5d396e[_0x290aee(0x11d)](/```(?:json)?\s*([\s\S]*?)\s*```/), _0x5616cc = _0x322752 ? _0x322752[0x1][_0x290aee(0x3ee)]() : _0x5d396e['trim'](); let _0x3b62f7; try { _0x3b62f7 = JSON['parse'](_0x5616cc); } catch (_0x4f52e9) { _0x3b62f7 = _0x443eed(_0x5616cc); if (!_0x3b62f7) throw new Error(_0x290aee(0x66a)); } let _0x32eb67; if (_0x176c28 && _0x3b9c82) try { if (_0x290aee(0x6db) !== 'bdXzb') { const _0x39e2be = JSON[_0x290aee(0x329)](_0x3b9c82); if (_0x3a96b7 === 'whispers') 'KDTJh' !== _0x290aee(0x1a1) ? _0x4cc68c[_0x290aee(0x4b8)]() : (_0x32eb67 = JSON[_0x290aee(0x22e)](_0x3b62f7), console['log']('Noir\x27s\x20Fix:\x20已用AI返回的连续对话更新聊天记录。')); else { if ('lEcfY' !== _0x290aee(0x551)) { if (Array[_0x290aee(0x796)](_0x39e2be) && Array[_0x290aee(0x796)](_0x3b62f7)) { const _0x8cc160 = _0x39e2be[_0x290aee(0x9db)](_0x3b62f7); _0x32eb67 = JSON[_0x290aee(0x22e)](_0x8cc160), console[_0x290aee(0x5e0)]('Noir\x27s\x20Fix:\x20已成功追加新旧数据\x20(A+B)。'); } else _0x290aee(0x335) !== _0x290aee(0x335) ? _0x153258[_0x290aee(0x36b)](_0x6d11da) : _0x32eb67 = JSON[_0x290aee(0x22e)](_0x3b62f7); } else _0x49e7e1[_0x290aee(0x10d)]['backgroundImage'] = _0x290aee(0x5a3) + _0x5ed331 + ')', _0x40e8e[_0x290aee(0x10d)][_0x290aee(0xc2)] = _0x290aee(0x55a), _0x214850[_0x290aee(0x10d)][_0x290aee(0x53b)] = _0x290aee(0x1ff), _0x416b8c[_0x290aee(0x10d)][_0x290aee(0x249)] = _0x290aee(0x24b), _0x28789d[_0x290aee(0x20d)](_0x290aee(0x749))['forEach'](_0x4ee2fc => { const _0x9cebd5 = _0x290aee; _0x4ee2fc['style'][_0x9cebd5(0x2b4)] = _0x9cebd5(0x871); }); } } else _0x417fd1(_0x290aee(0x534)); } catch (_0x2d62e9) { if (_0x290aee(0x2a0) === _0x290aee(0x4f5)) { const _0x10e53b = _0x45ff8a[_0x290aee(0x1f5)][_0x290aee(0x420)](); _0x265ddb[_0x290aee(0x9ac)] = _0x10e53b['speaker'] === 'narrator' ? '旁白' : _0x10e53b[_0x290aee(0x10c)], _0x5af937['textContent'] = _0x10e53b['line'], _0x10e53b[_0x290aee(0x10c)] !== _0x290aee(0x623) && _0x2c1642(_0xee8c22['activeMeetingCharId'], _0x10e53b[_0x290aee(0x2be)]); } else _0x32eb67 = JSON['stringify'](_0x3b62f7); } else _0x32eb67 = JSON[_0x290aee(0x22e)](_0x3b62f7); await _0x23f2ce(_0x45fd1b, _0x32eb67), _0x3b9c82 = _0x32eb67; } } else console['log'](_0x290aee(0xaad) + _0x45fd1b); _0x268e91(_0x3a96b7, _0x5fe001, _0x3b9c82); } catch (_0x8d3d0b) { console[_0x290aee(0x729)](_0x290aee(0x177) + _0x5fe001 + _0x290aee(0x191), _0x8d3d0b), _0x17072f[_0x290aee(0x9a1)] = _0x290aee(0x27e) + _0x8d3d0b['message'] + '</p>'; } } else !_0x23efde['classList'][_0x290aee(0x956)](_0x290aee(0x73f)) && _0x4492c7[_0x290aee(0xae0)](); } function _0x268e91(_0x46c8b8, _0x4e1702, _0x3fc61f) { const _0x3ba532 = _0x1da6ac, _0x54cc74 = _0x5b19fc(_0x435117), _0x52a191 = document[_0x3ba532(0x248)](_0x3ba532(0x2b5)); let _0x239c99 = ''; if (!_0x3fc61f) _0x3ba532(0x60d) !== _0x3ba532(0x570) ? _0x239c99 = '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>这里什么都没有...</p>' : _0x14e0c7(_0x336966['activeMeetingCharId'], _0x2cda2b[_0x3ba532(0x2be)]); else { if (_0x46c8b8 === _0x3ba532(0x9f0)) { if (_0x3ba532(0x21a) === _0x3ba532(0x6cb)) { const _0xa20766 = _0x1100cf(_0x33830c['id']), _0x27b0fa = _0xa20766[_0x3ba532(0x848)] > 0x0 ? _0xa20766[_0xa20766[_0x3ba532(0x848)] - 0x1] : null; return { 'chat': _0x519d6f, 'history': _0xa20766, 'lastTimestamp': _0x27b0fa ? _0x27b0fa[_0x3ba532(0x908)] : 0x0 }; } else _0x239c99 = _0x3ba532(0x6a6) + _0x3fc61f + _0x3ba532(0x337); } else { if (_0x3ba532(0x442) !== _0x3ba532(0xae9)) try { let _0x64ca32 = null; const _0x18e560 = _0x3fc61f[_0x3ba532(0x11d)](/```(?:json)?\s*([\s\S]*?)\s*```/), _0x46fcac = _0x18e560 ? _0x18e560[0x1] : _0x3fc61f; _0x64ca32 = JSON[_0x3ba532(0x329)](_0x46fcac); const _0x243db5 = _0x5b19fc(_0x435117); switch (_0x46c8b8) { case 'gallery': _0x239c99 = _0xcb9311(_0x64ca32); break; case 'whispers': _0x239c99 = _0x260e7e(_0x64ca32, _0x243db5[_0x3ba532(0x6b7)]); break; case _0x3ba532(0x614): _0x239c99 = _0x311f3e(_0x64ca32); break; case 'fragments': _0x239c99 = _0x2a0dd2(_0x64ca32); break; case _0x3ba532(0x9ff): _0x239c99 = _0x51ed7d(_0x64ca32); break; case _0x3ba532(0x699): _0x239c99 = _0x49c430(_0x64ca32); break; case 'footprints': _0x239c99 = _0x36c650(_0x64ca32); break; case _0x3ba532(0x9f0): _0x239c99 = _0x3ba532(0x662) + _0x3fc61f + '</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'; break; default: _0x239c99 = _0x3ba532(0x95d) + JSON[_0x3ba532(0x22e)](_0x64ca32, null, 0x2) + _0x3ba532(0x7fb); } } catch (_0x5f5bee) { console[_0x3ba532(0x729)](_0x3ba532(0x544), _0x5f5bee), _0x239c99 = '<div\x20style=\x22padding:\x2015px;\x20background:\x20#ffebeb;\x20border-radius:\x208px;\x20color:\x20#d8000c;\x22><strong>解析失败了，哼。</strong><br>AI返回的原始内容：</div><pre\x20style=\x22white-space:\x20pre-wrap;\x20word-break:\x20break-word;\x20font-family:\x20monospace;\x20margin-top:\x2010px;\x22>' + _0x3fc61f + '</pre>'; } else _0x33c544[_0x3ba532(0x36b)]('[' + _0x13397e(_0x27d9fe) + _0x3ba532(0x45d) + (_0x3c6f9a[_0x3ba532(0x9a8)]?.[_0x3ba532(0x11d)](/：(.+?)]/)?.[0x1] || '表情') + ']'); } } _0x52a191[_0x3ba532(0x9a1)] = _0x3ba532(0x431) + _0x4e1702 + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sub-title\x22>' + _0x54cc74[_0x3ba532(0x6b7)] + _0x3ba532(0x70e) + (_0x46c8b8 === _0x3ba532(0x9f0) ? _0x3ba532(0x674) : _0x3ba532(0x9cb)) + _0x3ba532(0xa68) + _0x239c99 + _0x3ba532(0x8e3); const _0x3fbde4 = _0x52a191['querySelector']('.snoop-app-content'); if (_0x46c8b8 === 'summary') { if (_0x3ba532(0x164) !== _0x3ba532(0xcf)) _0x3fbde4['style'][_0x3ba532(0x8cd)] = '0'; else { _0x34bb56[_0x3ba532(0x4bc)] = _0x2008df['chats'][_0x3ba532(0x54e)](_0x5add56 => _0x5add56['id'] !== _0x2553a5); try { _0x45b333[_0x3ba532(0x89a)](_0x3ba532(0x13c) + _0x4978cb); } catch (_0x4a2a1d) { _0x498c1d[_0x3ba532(0x729)]('Failed\x20to\x20remove\x20history\x20for\x20chat\x20' + _0x94b717, _0x4a2a1d); } _0xbf2673[_0x3ba532(0x16e)] === _0x55905d && (_0x5bcb49[_0x3ba532(0x16e)] = _0x454952[_0x3ba532(0x4bc)][0x0]?.['id'] || null, _0x17ccad(_0x3b9e4b[_0x3ba532(0x16e)])), _0x46c5d1(), _0x20c0ce(); } } document['getElementById'](_0x3ba532(0x4e8))[_0x3ba532(0x578)](_0x3ba532(0x4b3), () => { const _0x3f210e = _0x3ba532; _0x52a191[_0x3f210e(0x10d)][_0x3f210e(0x5eb)] = _0x3f210e(0x3fe), document[_0x3f210e(0x248)](_0x3f210e(0xa93))['style'][_0x3f210e(0x5eb)] = _0x3f210e(0x4ef); }), _0x46c8b8 === _0x3ba532(0x9f0) ? _0x3ba532(0x20e) === 'HyTMf' ? _0x2e15eb[_0x3ba532(0x70a)] = _0x550468[_0x3ba532(0x73d)](_0x323af8) : document[_0x3ba532(0x248)]('snoop-copy-summary-btn')['addEventListener']('click', () => { const _0x4a1c86 = _0x3ba532, _0x44a11d = document[_0x4a1c86(0x248)]('snoop-summary-textarea'); _0x44a11d[_0x4a1c86(0x585)](), document[_0x4a1c86(0x1ea)]('copy'), _0x3a6c86(_0x4a1c86(0x47a)); }) : document[_0x3ba532(0x248)](_0x3ba532(0x5c9))[_0x3ba532(0x578)](_0x3ba532(0x4b3), async () => { _0x409dce(_0x46c8b8, _0x4e1702, !![]); }), _0x46c8b8 === _0x3ba532(0x7a1) && _0x52a191[_0x3ba532(0x20d)](_0x3ba532(0x867))[_0x3ba532(0x986)](_0x1dedb2 => { const _0x33bf41 = _0x3ba532; _0x1dedb2[_0x33bf41(0x578)]('click', () => { const _0x26b889 = _0x33bf41, _0x1364c7 = JSON['parse'](_0x1dedb2[_0x26b889(0xab1)]['log'][_0x26b889(0x7cf)](/&quot;/g, '\x22')), _0x8440d9 = _0x1dedb2[_0x26b889(0xab1)][_0x26b889(0x6a8)], _0x1c92f4 = _0x1dedb2['dataset']['characterName']; _0x35b229(_0x8440d9, _0x1c92f4, _0x1364c7); }); }); } function _0x443eed(_0x969382) { const _0x20235c = _0x1da6ac; if (_0x20235c(0x396) !== _0x20235c(0x313)) { if (!_0x969382 || typeof _0x969382 !== _0x20235c(0x9d1)) return null; const _0x5b37c2 = _0x969382[_0x20235c(0x3ee)]()[_0x20235c(0x5ac)]('\x0a'), _0x243b64 = []; let _0x5a915f = null; for (const _0x40c57c of _0x5b37c2) { if ('kqvRV' !== 'kqvRV') _0x3da7f9[_0x20235c(0x2cf)](_0x20235c(0x879), _0x2bdd0d); else { const _0x206e65 = _0x40c57c[_0x20235c(0x3ee)](); if (_0x206e65[_0x20235c(0x33c)]('-\x20')) { _0x5a915f && _0x243b64[_0x20235c(0x36b)](_0x5a915f); _0x5a915f = {}; const _0x29096e = _0x206e65['substring'](0x2), _0x267f81 = _0x29096e[_0x20235c(0x5ac)](/:\s(.+)/); if (_0x267f81[_0x20235c(0x848)] > 0x1) { const _0x1afae2 = _0x267f81[0x0][_0x20235c(0x3ee)](), _0x4d72e4 = _0x267f81[0x1][_0x20235c(0x3ee)]()['replace'](/^"|"$/g, ''); _0x5a915f[_0x1afae2] = _0x4d72e4; } } else { if (_0x5a915f && _0x206e65) { if (_0x20235c(0x4a5) !== _0x20235c(0x12f)) { const _0x38e57f = _0x206e65[_0x20235c(0x5ac)](/:\s(.+)/); if (_0x38e57f['length'] > 0x1) { const _0x3ba118 = _0x38e57f[0x0][_0x20235c(0x3ee)](), _0x57ca74 = _0x38e57f[0x1][_0x20235c(0x3ee)]()['replace'](/^"|"$/g, ''); _0x5a915f[_0x3ba118] = _0x57ca74; } } else _0x1ea5aa(), _0x2d73e4('accounting', _0x20235c(0x362)); } } } } if (_0x5a915f) { if (_0x20235c(0xa7e) !== _0x20235c(0x990)) _0x243b64[_0x20235c(0x36b)](_0x5a915f); else { const _0xc94c5d = [], _0x4dd04a = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x45a2f9; while ((_0x45a2f9 = _0x4dd04a[_0x20235c(0x55b)](_0x43afae)) !== null) { const _0x382dde = _0x45a2f9[0x1][_0x20235c(0x7cf)](/\\"/g, '\x22')[_0x20235c(0x7cf)](/\\n/g, '\x0a')[_0x20235c(0x3ee)](); if (_0x382dde) _0xc94c5d[_0x20235c(0x36b)](_0x382dde); } if (_0xc94c5d['length']) return _0xc94c5d[_0x20235c(0x25a)](_0x2d3451)[_0x20235c(0x53a)](0x0, 0x9); } } return _0x243b64[_0x20235c(0x848)] > 0x0 ? _0x243b64 : null; } else _0x25dba4['src'] = _0x5e03b4[_0x20235c(0x73d)](_0x1fc02d), _0x51953f[_0x20235c(0x10d)][_0x20235c(0x69f)] = 0x1; } function _0x35b229(_0x361908, _0x1239a3, _0x4a9e74) { const _0x5dfdfb = _0x1da6ac; if (_0x5dfdfb(0x4d8) !== 'fEzAp') _0x24aeb9(), _0xeb79ce(!![]); else { const _0x411387 = document['querySelector'](_0x5dfdfb(0x334)), _0x27f4f8 = document[_0x5dfdfb(0x838)](_0x5dfdfb(0x1d5)); let _0x242fa3 = _0x5dfdfb(0x795); if (!_0x4a9e74 || _0x4a9e74['length'] === 0x0) { if ('oYPir' !== _0x5dfdfb(0x2fb)) _0x242fa3 += _0x5dfdfb(0x721); else { const _0x517fe1 = _0x2f0ad1['querySelector']('.screen.active'); if (!_0x517fe1) return; _0x517fe1['id'] === _0x5dfdfb(0x99f) ? _0x34bd7b() : _0x1408e5(); } } else { if (_0x5dfdfb(0x5d1) !== _0x5dfdfb(0xa18)) _0x4a9e74[_0x5dfdfb(0x986)](_0x5623f0 => { const _0x1825b9 = _0x5dfdfb; if (_0x1825b9(0x619) !== _0x1825b9(0x8e5)) { const _0x1fbe2f = _0x5623f0[_0x1825b9(0x4be)] === _0x1825b9(0x70d), _0x5b5691 = _0x1fbe2f ? _0x1239a3 ? _0x1239a3[0x0] : '?' : _0x361908 ? _0x361908[0x0] : '?'; _0x242fa3 += _0x1825b9(0x512) + (_0x1fbe2f ? _0x1825b9(0x27a) : 'ai') + _0x1825b9(0x6ba) + (!_0x1fbe2f ? _0x1825b9(0x572) + _0x5b5691 + _0x1825b9(0x489) : '') + _0x1825b9(0x639) + (_0x1fbe2f ? _0x1825b9(0x27a) : 'ai') + _0x1825b9(0x15d) + _0x5623f0[_0x1825b9(0x9a8)] + _0x1825b9(0x789) + (_0x1fbe2f ? _0x1825b9(0x572) + _0x5b5691 + _0x1825b9(0x489) : '') + _0x1825b9(0x310); } else _0x353aa3['error'](_0x1825b9(0x82c), _0x5e668d), _0x4f1652['value'] = _0x1825b9(0x216) + _0x51c529[_0x1825b9(0x380)]; }); else { const _0x24a154 = _0x20b572[_0x5dfdfb(0x248)](_0x5dfdfb(0x9f2))[_0x5dfdfb(0xe5)]['trim'](), _0x6515fb = _0x4d723d[_0x5dfdfb(0x838)](_0x5dfdfb(0xa46))[_0x5dfdfb(0xe5)]; if (!_0x24a154) { _0x5c5c1a(_0x5dfdfb(0x459)); return; } const _0x1fd676 = _0x33a92a[_0x5dfdfb(0x360)][_0x5dfdfb(0x212)](_0x1ffb4d => _0x1ffb4d['id'] === _0xbc590b[_0x5dfdfb(0x663)]); if (!_0x1fd676) { _0x40f257(_0x5dfdfb(0x300)); return; } _0x381799[_0x5dfdfb(0x2e4)][_0x5dfdfb(0x36b)]({ 'id': _0x5dfdfb(0x11a) + _0x17f827[_0x5dfdfb(0x7a8)](), 'date': _0x41508a[_0x5dfdfb(0x592)], 'type': _0x6515fb, 'content': _0x24a154, 'userId': _0x1fd676['id'] }), _0x18a28f(), _0x1e3d36(), _0x307a6f(), _0x16f3e3(), _0x458f39[_0x5dfdfb(0x248)](_0x5dfdfb(0x8c7))[_0x5dfdfb(0x882)][_0x5dfdfb(0xae0)](_0x5dfdfb(0x11b)); } } _0x242fa3 += _0x5dfdfb(0x489), _0x411387[_0x5dfdfb(0x9a1)] = _0x242fa3, _0x411387[_0x5dfdfb(0x40d)] = _0x411387['scrollHeight'], _0x27f4f8[_0x5dfdfb(0x9a1)] = _0x5dfdfb(0x558) + _0x361908 + _0x5dfdfb(0xc6), document[_0x5dfdfb(0x248)](_0x5dfdfb(0x7a3))[_0x5dfdfb(0x578)](_0x5dfdfb(0x4b3), () => { const _0x5c490b = _0x5dfdfb; if ('lJCLd' === _0x5c490b(0x57d)) _0x409dce('whispers', '聊天'); else { _0x235c55 = ![], _0x15e574[_0x5c490b(0x10d)][_0x5c490b(0x5eb)] = _0x5c490b(0x3fe), _0x5b379d[_0x5c490b(0x248)](_0x5c490b(0x8a9))['style']['display'] = _0x5c490b(0x92c), _0x3695ec[_0x5c490b(0x248)]('galgame-sprite-adjust-ui')[_0x5c490b(0x10d)]['display'] = 'block'; if (!_0x461474) { const _0x28af41 = _0x1a3319(_0x125013[_0x5c490b(0x5cb)]); _0x28af41 && (_0x28af41[_0x5c490b(0x7da)] = _0x2fc352, _0x2bcf01(_0x2230c3[_0x5c490b(0x5cb)], 'normal')); } } }), !document[_0x5dfdfb(0x248)](_0x5dfdfb(0x2b8)) && document[_0x5dfdfb(0x450)][_0x5dfdfb(0xa2c)](_0x5dfdfb(0x1bf), '<style\x20id=\x22snoop-temp-style\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.snoop-avatar\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20background:\x20#e5e7eb;\x20color:\x20#4b5563;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x200\x208px;\x20flex-shrink:\x200;\x20align-self:\x20flex-end;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>'); } } function _0x443eed(_0x172174) { const _0x56fb67 = _0x1da6ac; if ('ASaVm' !== _0x56fb67(0x4fa)) { if (!_0x172174 || typeof _0x172174 !== _0x56fb67(0x9d1)) return null; const _0xf12c62 = _0x172174[_0x56fb67(0x3ee)]()[_0x56fb67(0x5ac)]('\x0a'), _0x451965 = []; let _0x3ad160 = null; for (const _0x23a061 of _0xf12c62) { if (_0x56fb67(0x522) !== 'cJQmJ') { const _0x16c281 = _0x23a061[_0x56fb67(0x3ee)](); if (_0x16c281[_0x56fb67(0x33c)]('-\x20')) { _0x3ad160 && _0x451965['push'](_0x3ad160); _0x3ad160 = {}; const _0x25eca5 = _0x16c281[_0x56fb67(0x3f1)](0x2), _0x2aa182 = _0x25eca5[_0x56fb67(0x5ac)](/:\s(.+)/); if (_0x2aa182[_0x56fb67(0x848)] > 0x1) { if (_0x56fb67(0x32e) !== _0x56fb67(0x32e)) { const _0x5d4f6f = _0x433b9e[_0x56fb67(0x329)](_0x420e71); _0x55caec[_0x56fb67(0x796)](_0x5d4f6f) ? _0x579012 = [..._0x13a869, ..._0x5d4f6f] : _0xf1e8f0 = _0xe1970a; } else { const _0x887b61 = _0x2aa182[0x0][_0x56fb67(0x3ee)](), _0x421685 = _0x2aa182[0x1][_0x56fb67(0x3ee)]()[_0x56fb67(0x7cf)](/^"|"$/g, ''); _0x3ad160[_0x887b61] = _0x421685; } } } else { if (_0x3ad160 && _0x16c281) { const _0x2dfcff = _0x16c281[_0x56fb67(0x5ac)](/:\s(.+)/); if (_0x2dfcff[_0x56fb67(0x848)] > 0x1) { if (_0x56fb67(0x70c) !== _0x56fb67(0x70c)) _0x4c23a0[_0x56fb67(0x729)]('净化好友圈时出错，真是的。', _0x421a85); else { const _0x1f13f4 = _0x2dfcff[0x0]['trim'](), _0x4b4604 = _0x2dfcff[0x1]['trim']()[_0x56fb67(0x7cf)](/^"|"$/g, ''); _0x3ad160[_0x1f13f4] = _0x4b4604; } } } } } else _0x2a42db(_0x20158c['id']); } return _0x3ad160 && _0x451965['push'](_0x3ad160), _0x451965[_0x56fb67(0x848)] > 0x0 ? _0x451965 : null; } else { const _0x342fc0 = _0x56a744[_0x56fb67(0x3b9)](_0x56fb67(0x6ff)); _0x342fc0['textContent'] = _0x14b6a4, _0x342fc0[_0x56fb67(0x578)]('click', () => { const _0x219a6b = _0x56fb67; _0x1d8100[_0x219a6b(0xe5)] = _0xd0fe17, _0x561f6d[_0x219a6b(0x882)][_0x219a6b(0xae0)](_0x219a6b(0x11b)); }), _0x3e40db[_0x56fb67(0x6ab)](_0x342fc0); } } async function _0x1eaf60(_0x17e91c) { const _0x560829 = _0x1da6ac; if (_0x560829(0x1d6) !== _0x560829(0x1d6)) _0x5bbefb(); else { if (!_0x17e91c) return ''; const _0x3b3c89 = [{ 'id': _0x560829(0x6cd), 'name': '相册' }, { 'id': 'whispers', 'name': '和其他人的聊天' }, { 'id': _0x560829(0x614), 'name': _0x560829(0x8ee) }, { 'id': _0x560829(0xac0), 'name': _0x560829(0x820) }, { 'id': _0x560829(0x9ff), 'name': _0x560829(0x5fe) }, { 'id': _0x560829(0x699), 'name': _0x560829(0x6ec) }, { 'id': _0x560829(0x195), 'name': _0x560829(0x113) }]; let _0x45abe1 = ''; for (const _0x2470ba of _0x3b3c89) { try { if ('lDVXP' !== 'nIwnu') { const _0x28f2b8 = _0x560829(0x326) + _0x17e91c + '_' + _0x2470ba['id'], _0x42de35 = await _0x5dadd7(_0x28f2b8); if (_0x42de35) { const _0x537bff = _0x42de35[_0x560829(0x11d)](/```(?:json)?\s*([\s\S]*?)\s*```/), _0x583431 = _0x537bff ? _0x537bff[0x1]['trim']() : _0x42de35[_0x560829(0x3ee)](); if (!_0x583431) continue; let _0x320a84 = null; try { _0x320a84 = JSON[_0x560829(0x329)](_0x583431); } catch (_0x3e74e0) { console[_0x560829(0x2cf)](_0x560829(0x6c5) + _0x2470ba['id'] + _0x560829(0x842), _0x3e74e0[_0x560829(0x380)]); try { if (_0x560829(0x983) !== 'jzeIA') { _0x320a84 = _0x443eed(_0x583431); if (!_0x320a84) { if (_0x560829(0x89d) !== _0x560829(0xa6c)) throw new Error(_0x560829(0x708)); else { const _0x4032c9 = _0x2ef9ff[_0x560829(0x248)](_0x560829(0x7e6)); if (!_0x4032c9) return; _0x2e950d[_0x560829(0x827)][_0x560829(0x401)] ? (_0x4032c9[_0x560829(0x10d)][_0x560829(0x249)] = _0x560829(0x1b6), _0x4032c9['style']['textShadow'] = _0x560829(0x9b4)) : (_0x4032c9['style'][_0x560829(0x249)] = _0x560829(0xa60), _0x4032c9[_0x560829(0x10d)][_0x560829(0x2b4)] = 'none'); } } console[_0x560829(0x5e0)](_0x560829(0x49f) + _0x2470ba['id'] + _0x560829(0x6b8)); } else _0x59830e['accountingLedger'] = _0xd1797b[_0x560829(0xa29)], _0x1d113b[_0x560829(0x5e0)]('Noir\x27s\x20Temporal\x20Patch:\x20Ledger\x20re-synchronized.'); } catch (_0x2d5f58) { if (_0x560829(0x469) === _0x560829(0x5bc)) { const _0x51d651 = _0x440855['transaction'](_0x40e4a1, 'readonly'), _0x14759e = _0x51d651[_0x560829(0x963)](_0x46e143), _0x6a04c3 = _0x14759e[_0x560829(0xa25)](_0x4f0754); _0x6a04c3['onsuccess'] = () => _0x3c88e8(_0x6a04c3[_0x560829(0x4f7)] ? _0x6a04c3[_0x560829(0x4f7)][_0x560829(0x9be)] : null), _0x6a04c3[_0x560829(0x136)] = () => _0x303649(_0x6a04c3['error']); } else throw _0x3e74e0; } } if (Array[_0x560829(0x796)](_0x320a84) && _0x320a84['length'] > 0x0) { if (_0x560829(0x21b) !== _0x560829(0x327)) { _0x45abe1 === '' && (_0x45abe1 += _0x560829(0x14c)); _0x45abe1 += _0x560829(0x452) + _0x2470ba[_0x560829(0x6b7)] + '\x0a'; switch (_0x2470ba['id']) { case _0x560829(0x6cd): _0x320a84[_0x560829(0x986)](_0x3ab744 => { const _0x3a3bf7 = _0x560829; _0x45abe1 += _0x3a3bf7(0x32b) + _0x3ab744[_0x3a3bf7(0x7d3)] + _0x3a3bf7(0x8aa); }); break; case _0x560829(0x7a1): _0x320a84[_0x560829(0x986)](_0xb547ac => { const _0x2f186d = _0x560829; _0x45abe1 += _0x2f186d(0x1f8) + _0xb547ac[_0x2f186d(0x719)] + _0x2f186d(0x8b3) + _0xb547ac[_0x2f186d(0x873)] + '”。\x0a', _0xb547ac[_0x2f186d(0x5e0)] && Array[_0x2f186d(0x796)](_0xb547ac['log']) && (_0x45abe1 += _0x2f186d(0x240), _0xb547ac['log']['forEach'](_0x58c801 => { const _0x1542a2 = _0x2f186d, _0x6fedcd = _0x58c801[_0x1542a2(0x4be)] === 'character' ? '你' : _0xb547ac[_0x1542a2(0x719)]; _0x45abe1 += '\x20\x20\x20\x20-\x20' + _0x6fedcd + ':\x20' + _0x58c801[_0x1542a2(0x9a8)] + '\x0a'; })); }); break; case _0x560829(0x614): _0x320a84[_0x560829(0x986)](_0x342bbc => { const _0xfea96f = _0x560829; _0x45abe1 += '-\x20你曾经搜索过：“' + _0x342bbc[_0xfea96f(0x5e8)] + '”。\x0a'; }); break; case 'fragments': _0x320a84['forEach'](_0x292ad4 => { const _0x273b45 = _0x560829; _0x45abe1 += '-\x20你的备忘录里有一条叫“' + _0x292ad4[_0x273b45(0x4cf)] + '”的笔记，内容是：“' + _0x292ad4['content'][_0x273b45(0x7cf)](/\n/g, '\x20') + _0x273b45(0x8aa); }); break; case _0x560829(0x9ff): _0x320a84['forEach'](_0x466436 => { const _0x23e8c3 = _0x560829; if ('HqjYr' === _0x23e8c3(0x667)) { const _0x456840 = new _0x6fac1d(), _0x477d3b = _0x2639dc['getElementById']('galgame-time'), _0x437f90 = _0x12b07a[_0x23e8c3(0x248)]('galgame-date'); if (_0x477d3b && _0x437f90) { const _0x5472b6 = _0x320b34(_0x456840[_0x23e8c3(0x223)]())[_0x23e8c3(0x1db)](0x2, '0'), _0x1a1cff = _0x5f4473(_0x456840[_0x23e8c3(0xabe)]())['padStart'](0x2, '0'); _0x477d3b[_0x23e8c3(0x9ac)] = _0x5472b6 + ':' + _0x1a1cff; const _0x2fbc94 = _0x456840[_0x23e8c3(0xa84)]() + 0x1, _0x3a854a = _0x456840['getDate'](), _0x4a3f00 = [_0x23e8c3(0x905), _0x23e8c3(0x9a6), _0x23e8c3(0xa90), _0x23e8c3(0x50f), _0x23e8c3(0x9f1), _0x23e8c3(0x2c5), _0x23e8c3(0x98d)][_0x456840[_0x23e8c3(0x381)]()]; _0x437f90['textContent'] = _0x2fbc94 + '月' + _0x3a854a + '日\x20' + _0x4a3f00; } } else _0x45abe1 += '-\x20你点过一份外卖：“' + _0x466436[_0x23e8c3(0x4dc)] + '”，里面有\x20' + _0x466436['items'][_0x23e8c3(0x64e)]('、') + '。\x0a'; }); break; case 'wants': _0x320a84[_0x560829(0x986)](_0x22453c => { const _0x18bbfe = _0x560829; _0x45abe1 += '-\x20你在“' + _0x22453c['store_name'] + _0x18bbfe(0x763) + _0x22453c[_0x18bbfe(0x8f9)] + _0x18bbfe(0x8aa); }); break; case _0x560829(0x195): _0x320a84[_0x560829(0x986)](_0x1c64f5 => { const _0x35cf17 = _0x560829; _0x45abe1 += _0x35cf17(0xa1a) + _0x1c64f5[_0x35cf17(0x850)] + _0x35cf17(0x860) + _0x1c64f5['activity_description'] + '”。\x0a'; }); break; default: _0x320a84[_0x560829(0x986)](_0x8ead80 => { const _0x4cd96c = _0x560829; _0x45abe1 += '-\x20' + JSON[_0x4cd96c(0x22e)](_0x8ead80) + '\x0a'; }); break; } } else _0x3ece15[_0x560829(0x729)](_0x560829(0x463), _0x524d63), _0x5cb598[_0x560829(0x89a)](_0x560829(0x683)); } } } else _0x2f36af(_0x529ecd + 0x1); } catch (_0x1206fd) { console[_0x560829(0x729)](_0x560829(0x8e7) + _0x2470ba['id'] + ')，已跳过。这不应该发生，数据库可能已损坏。', _0x1206fd); } } return _0x45abe1; } } function _0xcb9311(_0x17421d) { const _0x32bb5a = _0x1da6ac; if (!Array[_0x32bb5a(0x796)](_0x17421d)) return _0x32bb5a(0x5e4); if (_0x17421d[_0x32bb5a(0x848)] === 0x0) return '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>相册是空的。</p>'; return _0x32bb5a(0x928) + _0x17421d['map']((_0x508305, _0xf1b669) => _0x32bb5a(0x7b6) + (_0xf1b669 < _0x17421d[_0x32bb5a(0x848)] - 0x1 ? _0x32bb5a(0x3f6) : '') + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22width:\x2060px;\x20height:\x2060px;\x20background-color:\x20#eee;\x20border-radius:\x208px;\x20font-size:\x202rem;\x20flex-shrink:\x200;\x22>🖼️</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22\x20style=\x22margin-top:\x202px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a<div\x20class=\x22char-remark\x22\x20style=\x22white-space:\x20normal;\x20line-height:\x201.6;\x22>' + (_0x508305[_0x32bb5a(0x7d3)] || _0x32bb5a(0x461)) + _0x32bb5a(0x769) + (_0x508305[_0x32bb5a(0x908)] || '') + _0x32bb5a(0x224))[_0x32bb5a(0x64e)]('') + '</div>'; } function _0x260e7e(_0x2dc88d, _0x5e7503) { const _0x20476c = _0x1da6ac; if (_0x20476c(0x93c) === 'VHiOz') { if (!Array[_0x20476c(0x796)](_0x2dc88d) || _0x2dc88d['length'] === 0x0) return _0x20476c(0x2cb); return _0x20476c(0x928) + _0x2dc88d['map']((_0x396eb0, _0x2b6247) => { const _0x159baa = _0x20476c, _0xee9889 = JSON[_0x159baa(0x22e)](_0x396eb0[_0x159baa(0x5e0)] || [])[_0x159baa(0x7cf)](/'/g, _0x159baa(0xa24))['replace'](/"/g, _0x159baa(0x4ac)), _0x51bd9f = _0x396eb0[_0x159baa(0x719)] || _0x159baa(0x440); return _0x159baa(0x3fa) + (_0x2b6247 < _0x2dc88d[_0x159baa(0x848)] - 0x1 ? 'border-bottom:\x201px\x20solid\x20var(--border-color);' : '') + _0x159baa(0xd1) + _0xee9889 + _0x159baa(0x840) + _0x51bd9f + _0x159baa(0x193) + _0x5e7503 + '\x27>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22background-color:\x20#eee;\x20font-size:\x201.5rem;\x22>' + _0x51bd9f['charAt'](0x0) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x51bd9f + _0x159baa(0x5a6) + (_0x396eb0['last_message_preview'] || '') + _0x159baa(0x5db); })[_0x20476c(0x64e)]('') + _0x20476c(0x489); } else _0x38489d[_0x20476c(0x729)](_0x20476c(0x9fc), _0x25f5b0), _0x28baf5('搜索失败:\x20' + _0x1d9e79['message']); } function _0x311f3e(_0x32b8b4) { const _0x432077 = _0x1da6ac; if (_0x432077(0x1b4) === _0x432077(0x7c9)) { const _0x72cfad = _0x7ca22(_0x4e67db[0x1], 0xa), _0x4e0f5d = _0xe603df(_0x1b0a28[0x2], 0xa), _0x4def2f = _0x5de61c(_0x137c2d[0x3], 0xa) * (_0x31cee3[0x3][_0x432077(0x848)] === 0x2 ? 0xa : 0x1), _0x2056a8 = _0x72cfad * 0x3c + _0x4e0f5d + _0x4def2f / 0x3e8, _0x68f088 = _0x2dc015['replace'](_0x24cb50, '')[_0x432077(0x3ee)](); _0x68f088 && _0x43982b[_0x432077(0x36b)]({ 'time': _0x2056a8, 'text': _0x68f088 }); } else { if (!Array['isArray'](_0x32b8b4)) return '<p>格式错误</p>'; if (_0x32b8b4[_0x432077(0x848)] === 0x0) return '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>浏览器历史是空的。</p>'; return _0x32b8b4['sort']((_0x219657, _0x3abceb) => new Date(_0x3abceb[_0x432077(0x908)]) - new Date(_0x219657[_0x432077(0x908)])), _0x432077(0x928) + _0x32b8b4['map']((_0x5a1624, _0x5ead95) => _0x432077(0x3e8) + (_0x5ead95 < _0x32b8b4['length'] - 0x1 ? 'border-bottom:\x201px\x20solid\x20var(--border-color);' : '') + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x20font-weight:\x20500;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20var(--text-color-light);\x22>🔍</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>' + (_0x5a1624[_0x432077(0x5e8)] || '未知搜索') + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.85rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x208px;\x20padding:\x2010px;\x20background:\x20var(--surface-bg);\x20border-radius:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x5a1624['result_page_content'] || _0x432077(0xdb)) + _0x432077(0x6f6) + (_0x5a1624[_0x432077(0x908)] || '') + _0x432077(0x8ed))[_0x432077(0x64e)]('') + '</div>'; } } function _0x2a0dd2(_0x3a96dc) { const _0x316c60 = _0x1da6ac; if (_0x316c60(0x7fe) === 'TwLlA') _0x550df7[_0x316c60(0x89a)](_0x316c60(0x7b4)), _0x133456(), _0x14242f(_0x316c60(0x75f)); else { if (!Array[_0x316c60(0x796)](_0x3a96dc)) return '<p>格式错误</p>'; if (_0x3a96dc[_0x316c60(0x848)] === 0x0) return _0x316c60(0x79e); return _0x3a96dc[_0x316c60(0xaa6)]((_0x5f9f84, _0x3b237d) => new Date(_0x3b237d['last_edited']) - new Date(_0x5f9f84[_0x316c60(0x6f3)])), _0x3a96dc['map'](_0x43416f => '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20background:\x20#fffbf2;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + (_0x43416f['title'] || _0x316c60(0x4bb)) + _0x316c60(0x794) + (_0x43416f[_0x316c60(0x9a8)] || '') + _0x316c60(0x139) + (_0x43416f[_0x316c60(0x6f3)] || '') + _0x316c60(0xae5))[_0x316c60(0x64e)](''); } } function _0x51ed7d(_0xd69da4) { const _0x35da95 = _0x1da6ac; if (!Array[_0x35da95(0x796)](_0xd69da4)) return '<p>格式错误</p>'; if (_0xd69da4['length'] === 0x0) return _0x35da95(0x4f1); return _0xd69da4[_0x35da95(0xaa6)]((_0x3f63e9, _0x1f5391) => new Date(_0x1f5391['timestamp']) - new Date(_0x3f63e9[_0x35da95(0x908)])), _0xd69da4[_0x35da95(0xa21)](_0x3203fe => { const _0x2c73fa = _0x35da95; if ('kpZzB' !== _0x2c73fa(0x758)) { const _0x1d21d5 = (_0x3203fe[_0x2c73fa(0x265)] || [])[_0x2c73fa(0xa21)](_0x514412 => _0x2c73fa(0x501) + _0x514412 + _0x2c73fa(0x87b))[_0x2c73fa(0x64e)](''); return _0x2c73fa(0x9b5) + (_0x3203fe[_0x2c73fa(0x4dc)] || _0x2c73fa(0x3e7)) + _0x2c73fa(0x1c3) + (_0x3203fe[_0x2c73fa(0x908)] || '') + _0x2c73fa(0x103) + (_0x3203fe['status'] || _0x2c73fa(0x1d7)) + _0x2c73fa(0x291) + _0x1d21d5 + _0x2c73fa(0x40e) + (_0x3203fe['total_cost'] || 0x0)[_0x2c73fa(0x7d5)](0x2) + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20'; } else { if (_0x4c96cd[_0x2c73fa(0x59e)]) return; const _0x4ed0e8 = _0x17ef58['diaryCurrentPage'], _0x50a989 = _0x1ed43f[_0x2c73fa(0x16f)](_0x2f18df[_0x2c73fa(0x938)][_0x2c73fa(0x212)](_0x488d50 => _0x488d50[_0x2c73fa(0x542)] === _0x28912c[_0x2c73fa(0x4de)])[_0x2c73fa(0x17b)]['length'] / 0x2); if (_0x4ed0e8 >= _0x50a989 - 0x1) return; _0x25f4a0[_0x2c73fa(0x59e)] = !![]; const _0x111faf = _0x4ed0e8 + 0x1, _0x481555 = _0x45cc37['getElementById'](_0x2c73fa(0x9da) + _0x4ed0e8), _0x33895e = _0x6dbf80[_0x2c73fa(0x248)](_0x2c73fa(0x9da) + _0x111faf); _0x481555 && _0x33895e ? (_0x33895e['classList'][_0x2c73fa(0x7c3)]('is-entering-from-right'), _0x481555[_0x2c73fa(0x882)][_0x2c73fa(0x7c3)]('is-exiting-left'), _0x33895e[_0x2c73fa(0x882)][_0x2c73fa(0x7c3)](_0x2c73fa(0x2cd)), _0x37feee(() => { const _0x41e387 = _0x2c73fa; _0x481555['classList']['remove'](_0x41e387(0x2cd), _0x41e387(0x8d9)), _0x33895e[_0x41e387(0x882)][_0x41e387(0xae0)](_0x41e387(0x34e)), _0x1ad092[_0x41e387(0x2aa)] = _0x111faf, _0x228e41(), _0x2f599e['isAnimatingDiary'] = ![]; }, 0x2bc)) : _0x325e1f[_0x2c73fa(0x59e)] = ![]; } })['join'](''); } function _0x49c430(_0x49861a) { const _0x3b0f7e = _0x1da6ac; if (!Array[_0x3b0f7e(0x796)](_0x49861a)) return _0x3b0f7e(0x5e4); if (_0x49861a[_0x3b0f7e(0x848)] === 0x0) return '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有购物记录。</p>'; return _0x49861a[_0x3b0f7e(0xaa6)]((_0x19c589, _0x14bcf6) => new Date(_0x14bcf6[_0x3b0f7e(0x908)]) - new Date(_0x19c589[_0x3b0f7e(0x908)])), _0x49861a['map'](_0x33ad32 => _0x3b0f7e(0x192) + (_0x33ad32['store_name'] || _0x3b0f7e(0xe1)) + _0x3b0f7e(0x43d) + (_0x33ad32[_0x3b0f7e(0x908)] || '') + _0x3b0f7e(0x2d4) + (_0x33ad32[_0x3b0f7e(0x8f9)] || _0x3b0f7e(0x3be)) + _0x3b0f7e(0xf0) + (_0x33ad32[_0x3b0f7e(0x51a)] || 0x0)[_0x3b0f7e(0x7d5)](0x2) + _0x3b0f7e(0x1b1))[_0x3b0f7e(0x64e)](''); } function _0x36c650(_0x39f197) { const _0x375d02 = _0x1da6ac; if (_0x375d02(0x376) === _0x375d02(0x778)) _0x5e718d[_0x375d02(0x9a1)] = _0x375d02(0xac6) + _0x337f8b + _0x375d02(0x5f9) + _0x282900[_0x375d02(0x6d2)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x1ff01d[_0x375d02(0x755)] + _0x375d02(0xa4d); else { if (!Array[_0x375d02(0x796)](_0x39f197)) return _0x375d02(0x5e4); if (_0x39f197[_0x375d02(0x848)] === 0x0) return _0x375d02(0x6fe); return _0x39f197[_0x375d02(0xaa6)]((_0x5a3a4c, _0x2f080c) => new Date(_0x2f080c[_0x375d02(0x908)]) - new Date(_0x5a3a4c[_0x375d02(0x908)])), _0x375d02(0x5f7) + _0x39f197[_0x375d02(0xa21)](_0x206b27 => _0x375d02(0x4d7) + (_0x206b27[_0x375d02(0x850)] || '未知地点') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x22>' + (_0x206b27[_0x375d02(0x439)] || '') + _0x375d02(0x959) + (_0x206b27[_0x375d02(0x908)] || '') + _0x375d02(0x26b))[_0x375d02(0x64e)]('') + _0x375d02(0x489); } } async function _0x3bd6cb(_0x8c3df3, _0x4d225f, _0x582b54 = null) { const _0x1844ef = _0x1da6ac, _0x28e7d4 = _0x5b19fc(_0x4d225f), _0x2314a8 = _0x10530c['chats'][_0x1844ef(0x212)](_0x1f638e => _0x1f638e['type'] === _0x1844ef(0x71a) && _0x1f638e['participantIds']['includes'](_0x4d225f)), _0x2576e9 = _0x474290(_0x2314a8?.['id'] || _0x10530c[_0x1844ef(0x16e)]); if (!_0x28e7d4) throw new Error(_0x1844ef(0x3cf)); const { omniText: _0x611e5e } = _0x3b8ffa(_0x4d225f); let _0x1a6280 = ''; const _0x2e7bbf = new Date(); let _0x2b6fcf = null, _0xe3f59c = '无'; if (_0x582b54) try { let _0x5e5bcb; try { if (_0x1844ef(0x943) === 'LWNNs') try { const _0x2c71b3 = _0x464e53[_0x1844ef(0x329)](_0x513de2), _0x1a5b3f = { ..._0x7db263 }, _0x55a628 = { ..._0x1a5b3f, ..._0x2c71b3 }; _0x55a628[_0x1844ef(0x827)] = { ..._0x1a5b3f[_0x1844ef(0x827)], ..._0x2c71b3[_0x1844ef(0x827)] || {} }, _0x55a628[_0x1844ef(0x899)] = { ..._0x1a5b3f[_0x1844ef(0x899)], ..._0x2c71b3[_0x1844ef(0x899)] || {} }, _0x67227e['assign'](_0xbd6cd9, _0x55a628); } catch (_0x56b60e) { _0x21c9eb[_0x1844ef(0x729)]('解析存档失败，正在重置:', _0x56b60e), _0x250eca[_0x1844ef(0x89a)](_0x1844ef(0x683)); } else _0x5e5bcb = JSON[_0x1844ef(0x329)](_0x582b54); } catch (_0xd616a7) { _0x5e5bcb = _0x443eed(_0x582b54); } if (Array[_0x1844ef(0x796)](_0x5e5bcb) && _0x5e5bcb[_0x1844ef(0x848)] > 0x0) { const _0x857729 = _0x5e5bcb[_0x1844ef(0xa21)](_0x4a2858 => new Date(_0x4a2858[_0x1844ef(0x908)] || _0x4a2858[_0x1844ef(0x6f3)]))[_0x1844ef(0x54e)](_0x35b999 => !isNaN(_0x35b999)); _0x857729[_0x1844ef(0x848)] > 0x0 && (_0x1844ef(0x135) === 'jamEh' ? (_0x3cce15(), _0x22f68f[_0x1844ef(0x4b3)]()) : (_0x2b6fcf = new Date(Math[_0x1844ef(0x21d)]['apply'](null, _0x857729)), _0xe3f59c = _0x2b6fcf[_0x1844ef(0x446)](_0x1844ef(0x89f), { 'dateStyle': 'medium', 'timeStyle': _0x1844ef(0x931) }))); } } catch (_0x1e5a9a) { console['warn']('无法解析旧的视奸内容来获取时间戳。', _0x1e5a9a); } const _0x2eca9b = _0x392b91(_0x4d225f); _0x1a6280 = _0x1844ef(0x519), _0x1a6280 += _0x1844ef(0x98f) + _0x2e7bbf[_0x1844ef(0x446)]('zh-CN', { 'dateStyle': _0x1844ef(0x9e2), 'timeStyle': _0x1844ef(0x931) }) + '\x0a'; if (_0x2eca9b) { const _0x5eed33 = new Date(_0x2eca9b[_0x1844ef(0x908)]), _0x15015b = _0x25c4db(_0x5eed33); _0x1a6280 += '-\x20**你最后一次活动是在**:\x20' + _0x15015b + '\x0a'; const _0x189349 = _0x2e7bbf[_0x1844ef(0x8b9)](), _0x4dac0b = _0x5eed33[_0x1844ef(0x8b9)](), _0x45b8aa = new Date(); _0x45b8aa[_0x1844ef(0x580)](_0x2e7bbf['getDate']() - 0x1); const _0x9569a1 = _0x45b8aa['toDateString'](); if (_0x189349 === _0x4dac0b) { const _0x35faf8 = (_0x2e7bbf - _0x5eed33) / (0x3e8 * 0x3c); _0x1a6280 += _0x1844ef(0x184); } else { if (_0x9569a1 === _0x4dac0b) _0x1a6280 += _0x1844ef(0x2f0); else { if ('fyTWu' === 'fyTWu') { const _0xa8b1de = Math[_0x1844ef(0x2c8)]((_0x2e7bbf - _0x5eed33) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x1a6280 += '-\x20**状态提示**:\x20你已经有\x20' + _0xa8b1de + '\x20天没活动了。你生成的内容必须是全新的事件。\x0a'; } else { const _0x3b0402 = _0x3f68cb[0x0]['trim'](), _0x3ba300 = _0x3b1f40[0x1]['trim']()['replace'](/^"|"$/g, ''); _0x1bb894[_0x3b0402] = _0x3ba300; } } } } else { if ('OXraf' === _0x1844ef(0x2d7)) return; else _0x1a6280 += _0x1844ef(0x2bd); } let _0x1c6a58 = '', _0x37a8e9 = ''; _0x582b54 ? (_0x1c6a58 = _0x1844ef(0xa04), _0x37a8e9 = _0x1844ef(0x123) + _0x582b54 + _0x1844ef(0x759)) : _0x1844ef(0x1ef) === _0x1844ef(0x8a0) ? (_0x367489[_0x1844ef(0x729)]('保存角色失败:', _0xece28a), _0x467f98('保存失败:\x20' + _0x4e8e89['message'])) : _0x1c6a58 = _0x1844ef(0xad2); const _0x4734a8 = { 'gallery': '\x0a#\x20任务:\x20生成相册内容\x0a根据角色的近期经历、人际关系和隐藏性格，生成3\x20-\x205张照片的文字描述。重点是，照片内容要能引发联想，暗示一些用户不知道的事件。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22id\x22:\x20\x22photo_1725123456\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22一张在海边拍的黄昏照片，照片里有一个模糊的、看不清脸的背影。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-24\x2018:30\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'whispers': _0x1844ef(0x8f4), 'abyss': _0x1844ef(0xa32), 'fragments': _0x1844ef(0x706), 'bites': '\x0a#\x20任务:\x20生成外卖订单记录\x0a生成最近的2\x20-\x203条外卖订单。订单内容必须严格符合角色的设定、作息和财务状况。订单时间也要和他的生活轨迹对得上。一些比较幻想风格的角色可以用更加符合角色背景的内容风格，需要符合角色的时代和世界观背景。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22restaurant_name\x22:\x20\x22深夜食堂\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22items\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22肥牛饭\x20x1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22冰可乐\x20x1\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22total_cost\x22:\x2025.00,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22订单已送达\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-24\x2023:45\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'wants': _0x1844ef(0xa92), 'footprints': _0x1844ef(0x809) }, _0x1bc8e9 = _0x4734a8[_0x8c3df3] || '#\x20任务:\x20生成\x20' + _0x8c3df3 + _0x1844ef(0x678); let _0x105a67 = ''; if (_0x28e7d4['linkedWorldBookIds'] && _0x28e7d4[_0x1844ef(0x7e0)][_0x1844ef(0x848)] > 0x0) { if (_0x1844ef(0x290) !== _0x1844ef(0x5da)) { const _0x48bd74 = _0x28e7d4[_0x1844ef(0x7e0)][_0x1844ef(0xa21)](_0x587fec => _0x10530c['worldBooks'][_0x1844ef(0x212)](_0x3c5439 => _0x3c5439['id'] === _0x587fec))[_0x1844ef(0x54e)](Boolean)[_0x1844ef(0xa21)](_0xeaf4e4 => _0x1844ef(0x863) + _0xeaf4e4[_0x1844ef(0x6b7)] + '\x0a' + _0xeaf4e4[_0x1844ef(0x9a8)])['join'](''); _0x48bd74 && (_0x105a67 = _0x1844ef(0x9e8) + _0x48bd74); } else { const _0x3cc57d = _0x351703(_0x2f7073[_0x1844ef(0x5fa)]) || { 'name': '未知' }; let _0x4bb64c = _0x1844ef(0x520) + _0x3cc57d['name'] + _0x1844ef(0xa5b) + (_0x5ccf78[_0x1844ef(0x3bd)] || _0x5a40cc[_0x1844ef(0x9a8)]) + '”'; return _0x59299d[_0x1844ef(0xa78)] === _0x1844ef(0x868) && (_0x4bb64c += _0x1844ef(0x3d5) + _0x2f3d3a['songName'] + _0x1844ef(0x23b) + _0x4c6a10[_0x1844ef(0x755)] + ')'), _0x4bb64c; } } const _0x5f47ee = _0x1844ef(0x3c3) + _0x28e7d4['name'] + _0x1844ef(0x377) + _0x28e7d4['name'] + _0x1844ef(0x1d4) + _0x2576e9[_0x1844ef(0x6b7)] + _0x1844ef(0x47c) + _0xe3f59c + _0x1844ef(0x8b1) + _0x2e7bbf[_0x1844ef(0x446)](_0x1844ef(0x89f), { 'dateStyle': 'full', 'timeStyle': _0x1844ef(0x931) }) + _0x1844ef(0x852) + _0x28e7d4[_0x1844ef(0x6b7)] + _0x1844ef(0x844) + _0x28e7d4['persona'] + '\x0a' + _0x105a67 + _0x1844ef(0x2fa) + _0x2576e9[_0x1844ef(0x6b7)] + _0x1844ef(0x844) + _0x2576e9[_0x1844ef(0x824)] + _0x1844ef(0x273) + _0x611e5e + '\x0a' + _0x37a8e9 + _0x1844ef(0x4e2) + _0x1c6a58 + '\x0a' + _0x1bc8e9 + _0x1844ef(0x2c6), _0x43dd79 = [{ 'role': 'system', 'content': _0x5f47ee }]; _0x43dd79['push']({ 'role': _0x1844ef(0x27a), 'content': '请根据以上所有规则和资料，开始生成内容。' }); const _0x7429ce = await _0x2d63cb(_0x43dd79, { 'json': !![] }); return _0x7429ce; } async function _0x5da085(_0x2ff1b7) { const _0x3cf941 = _0x1da6ac, _0x30f574 = _0x5b19fc(_0x2ff1b7); if (!_0x30f574) throw new Error(_0x3cf941(0x9f8)); _0xbc2d1c(!![], _0x3cf941(0x32d)); const _0x42827a = [_0x3cf941(0x6cd), _0x3cf941(0x7a1), _0x3cf941(0x614), 'fragments', 'bites', _0x3cf941(0x699), _0x3cf941(0x195)]; let _0x3c00d3 = {}; await Promise[_0x3cf941(0x63b)](_0x42827a[_0x3cf941(0xa21)](async _0x5d7c2d => { const _0x47fba8 = _0x3cf941; if (_0x47fba8(0x593) === _0x47fba8(0x593)) { const _0x21976d = _0x47fba8(0x326) + _0x2ff1b7 + '_' + _0x5d7c2d, _0x5dbc99 = await _0x5dadd7(_0x21976d); if (_0x5dbc99) { if ('HkClk' !== 'Kukft') try { _0x47fba8(0x7ca) !== _0x47fba8(0x3ba) ? _0x3c00d3[_0x5d7c2d] = JSON[_0x47fba8(0x329)](_0x5dbc99) : _0x287113(_0x47fba8(0x198)); } catch (_0x39cebf) { } else return _0x1ed667[_0x47fba8(0x729)](_0x47fba8(0x686), _0x2382e3), _0x106305[_0x47fba8(0x729)](_0x47fba8(0xadf), _0xd60385[_0x47fba8(0x523)] || _0x47fba8(0x16d)), null; } } else { const _0x27f5bc = _0x47fba8(0xab7) + _0xc920d; let _0x52c8b0 = _0x48f5f9[_0x47fba8(0x248)](_0x27f5bc); if (_0x52c8b0) return; const _0x2fb12b = _0x47fba8(0x929) + _0x27f5bc + _0x47fba8(0x3e9) + (_0x1e89d9 === 'ai' ? '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>' : '') + _0x47fba8(0x3a8); _0x3e1b77['body']['insertAdjacentHTML'](_0x47fba8(0x1bf), _0x2fb12b); const _0x5252f7 = _0x421e5a[_0x47fba8(0x248)](_0x27f5bc), _0x772aba = () => _0x5252f7['remove'](); _0x5252f7[_0x47fba8(0x838)](_0x47fba8(0x279))[_0x47fba8(0x935)] = _0x772aba, _0x5252f7[_0x47fba8(0x838)](_0x47fba8(0x2bb))[_0x47fba8(0x935)] = _0x772aba, _0x5252f7['querySelector'](_0x47fba8(0x17c))['onclick'] = () => { _0x137d94(_0x1a811e), _0x772aba(); }, _0xbac3dd === 'ai' && (_0x5252f7[_0x47fba8(0x838)](_0x47fba8(0xa6d))['onclick'] = () => { _0x205c59(_0x4a5696), _0x772aba(); }); } })); if (Object[_0x3cf941(0x147)](_0x3c00d3)[_0x3cf941(0x848)] === 0x0) return _0x3cf941(0x6fb); const _0x49bcd9 = _0x3cf941(0x653) + _0x30f574['name'] + '”的角色撰写一份“手机内容总结档案”。你将收到一份包含其手机内多个应用数据的JSON对象。\x0a\x0a#\x20档案撰写规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`phone_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以应用名（如\x20`gallery`,\x20`whispers`\x20等）作为键。\x0a\x20\x20\x20\x20-\x20每个应用下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**【绝对禁止】复读**:\x20不要直接复制粘贴原文！你要用自己的话进行【总结】和【提炼】。\x0a\x20\x20\x20\x20-\x20**【聚焦核心】**:\x20专注于关键信息、情感转折点、重要决定、暴露的秘密、体现性格的核心事件。忽略无意义的细节。\x0a\x20\x20\x20\x20-\x20**【中立视角】**:\x20以客观的第三人称档案管理员视角进行记录。\x0a\x0a#\x20输出示例\x0a```yaml\x0aphone_summary:\x0a\x20\x20gallery:\x0a\x20\x20\x20\x20-\x20\x22相册里有一张在海边拍的黄昏照片，出现了一个神秘的背影。\x22\x0a\x20\x20whispers:\x0a\x20\x20\x20\x20-\x20\x22角色曾与一位叫\x27Rin\x27的神秘联系人讨论过一个重要的决定。\x22\x0a\x20\x20abyss:\x0a\x20\x20\x20\x20-\x20\x22近期频繁搜索关于“独自庆祝生日”的话题，可能暗示了其孤独感。\x22\x0a```\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的JSON数据全文，并生成一份\x20YAML\x20格式的档案。直接从\x20`phone_summary:`\x20开始输出。\x0a', _0xf91e9c = [{ 'role': 'system', 'content': _0x49bcd9 }, { 'role': _0x3cf941(0x27a), 'content': JSON['stringify'](_0x3c00d3, null, 0x2) }]; _0xbc2d1c(!![], _0x3cf941(0xa6e)); const _0x14b5c6 = await _0x2d63cb(_0xf91e9c); return _0x14b5c6 || _0x3cf941(0x8e1); } async function _0x5da085(_0x5bfbcb) { const _0x58b6c2 = _0x1da6ac; if (_0x58b6c2(0x739) !== 'tOzkd') { const _0x57e919 = _0x5b19fc(_0x5bfbcb); if (!_0x57e919) throw new Error('找不到角色。'); try { if (_0x58b6c2(0x984) !== _0x58b6c2(0x3a4)) { _0xbc2d1c(!![], _0x58b6c2(0x32d)); const _0x580e5c = [_0x58b6c2(0x6cd), 'whispers', _0x58b6c2(0x614), _0x58b6c2(0xac0), _0x58b6c2(0x9ff), _0x58b6c2(0x699), _0x58b6c2(0x195)]; let _0x54c74b = {}; await Promise[_0x58b6c2(0x63b)](_0x580e5c['map'](async _0xd0b892 => { const _0x49024e = _0x58b6c2, _0x18c568 = _0x49024e(0x326) + _0x5bfbcb + '_' + _0xd0b892, _0x61fcd6 = await _0x5dadd7(_0x18c568); if (_0x61fcd6) { if (_0x49024e(0x726) === _0x49024e(0x726)) try { _0x54c74b[_0xd0b892] = JSON[_0x49024e(0x329)](_0x61fcd6); } catch (_0x27aa54) { } else { _0xac774a['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>'; return; } } })); if (Object['keys'](_0x54c74b)[_0x58b6c2(0x848)] === 0x0) { if (_0x58b6c2(0x7d2) === _0x58b6c2(0x7d2)) return 'phone_summary:\x0a\x20\x20status:\x20空空如也，没什么好总结的。'; else { const _0x48163f = _0x58b6c2(0x5ff) + _0x42f35b; _0x2d45e2(_0x48163f), _0x520ec6(!![]); } } const _0x20c177 = _0x58b6c2(0x653) + _0x57e919[_0x58b6c2(0x6b7)] + '”的角色撰写一份“手机内容总结档案”。你将收到一份包含其手机内多个应用数据的JSON对象。\x0a\x0a#\x20档案撰写规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本,标题为：$【{character.name}的私人手机存储着以下信息】。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`phone_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以应用名（如\x20`gallery`,\x20`whispers`\x20等）作为键。\x0a\x20\x20\x20\x20-\x20每个应用下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**【绝对禁止】复读**:\x20不要直接复制粘贴原文！你要用自己的话进行【总结】和【提炼】。\x0a\x20\x20\x20\x20-\x20**【聚焦核心】**:\x20专注于关键信息、情感转折点、重要决定、暴露的秘密、体现性格的核心事件。忽略无意义的细节。\x0a\x20\x20\x20\x20-\x20**【中立视角】**:\x20以客观的第三人称档案管理员视角进行记录。\x0a\x0a#\x20输出示例\x0a```yaml\x0aphone_summary:\x0a\x20\x20gallery:\x0a\x20\x20\x20\x20-\x20\x22相册里有一张在海边拍的黄昏照片，出现了一个神秘的背影。\x22\x0a\x20\x20whispers:\x0a\x20\x20\x20\x20-\x20\x22角色曾与一位叫\x27Rin\x27的神秘联系人讨论过一个重要的决定。\x22\x0a\x20\x20abyss:\x0a\x20\x20\x20\x20-\x20\x22近期频繁搜索关于“独自庆祝生日”的话题，可能暗示了其孤独感。\x22\x0a```\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的JSON数据全文，并生成一份\x20YAML\x20格式的档案。直接从\x20`phone_summary:`\x20开始输出。\x0a', _0xc46724 = [{ 'role': 'system', 'content': _0x20c177 }, { 'role': _0x58b6c2(0x27a), 'content': JSON['stringify'](_0x54c74b, null, 0x2) }]; _0xbc2d1c(!![], _0x58b6c2(0xa6e)); const _0x15c0dd = await _0x2d63cb(_0xc46724); return _0x15c0dd || _0x58b6c2(0x8e1); } else _0x15eeee[_0x58b6c2(0x4de)] = null, _0x2cedb8(_0x58b6c2(0x90d), _0x58b6c2(0xab0)); } finally { _0xbc2d1c(![]); } } else { const _0x1b3a08 = new _0x1d66a9(_0x17b05f[_0x58b6c2(0x908)]), _0x111642 = _0x1b3a08[_0x58b6c2(0x5f8)]() + '-' + _0x47a82b(_0x1b3a08[_0x58b6c2(0xa84)]() + 0x1)[_0x58b6c2(0x1db)](0x2, '0') + '-' + _0x515aaf(_0x1b3a08[_0x58b6c2(0x208)]())[_0x58b6c2(0x1db)](0x2, '0'), _0x2937f3 = _0xad0991(_0x1b3a08[_0x58b6c2(0x223)]())[_0x58b6c2(0x1db)](0x2, '0') + ':' + _0x1b9a61(_0x1b3a08[_0x58b6c2(0xabe)]())[_0x58b6c2(0x1db)](0x2, '0'); let _0x3a3a06 = '未知'; _0x5c520f[_0x58b6c2(0x34a)] === 'user' ? _0x3a3a06 = _0x41e8d7[_0x58b6c2(0x6b7)] : _0x3a3a06 = _0x5dcc8f['name']; let _0x3eaf81 = _0x24e14[_0x58b6c2(0x9a8)]; if (_0x13f783[_0x58b6c2(0x565)]) _0x3eaf81 = _0x58b6c2(0x407); if (_0x478d88[_0x58b6c2(0x35f)]) _0x3eaf81 = _0x58b6c2(0x39b); return '[' + _0x111642 + '\x20' + _0x2937f3 + _0x58b6c2(0xaa1) + _0x3a3a06 + _0x58b6c2(0x5dc) + _0x3eaf81; } } document[_0x1da6ac(0x248)](_0x1da6ac(0x218))['addEventListener'](_0x1da6ac(0x4b3), () => _0x1c4afc(_0x1da6ac(0x362), _0x1da6ac(0xa26))), document[_0x1da6ac(0x248)](_0x1da6ac(0x710))[_0x1da6ac(0x578)](_0x1da6ac(0x4b3), () => { const _0x18e7ca = _0x1da6ac; if ('CrPDh' === _0x18e7ca(0xa2a)) { const _0x1df76b = _0x371ac1[_0x18e7ca(0x6c4)][_0x18e7ca(0x5fc)][0x0]; if (!_0x1df76b) return; const _0x3f626a = _0x1e5f35[_0x18e7ca(0x73d)](_0x1df76b); _0x4b00c2[_0x18e7ca(0x248)](_0x18e7ca(0x2d0))['style'][_0x18e7ca(0xad9)] = _0x18e7ca(0x7a2) + _0x3f626a + '\x27)'; } else document[_0x18e7ca(0x248)](_0x18e7ca(0x2b5))[_0x18e7ca(0x10d)][_0x18e7ca(0x5eb)] = _0x18e7ca(0x3fe), _0x1c4afc(_0x18e7ca(0xa26), _0x18e7ca(0x363)); }), _0x323012(); }); function _0x1bea() { const _0x541055 = ['JiROP', '#diary-action-reroll', '书记官正在奋笔疾书...', 'USUOa', '15px', '获取AI响应失败:', 'BfCbd', 'VtrcM', 'number', 'sYfKZ', 'IeKhi', '-\x20你的备忘录里有一条叫“', 'type', 'mbXfm', 'UfZLl', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>', 'image/png', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'NTBna', 'zDJwa', 'appIconPosition_app-music-library', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>查看手机...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20snoop-clear-btn\x22\x20title=\x22清空', 'AFFwF', 'includes', 'getMonth', 'OpaVX', '”的角色，现在需要写一篇交换日记。\x0a\x0a#\x20你的读者\x0a', 'PIfPy', '用户操作中断了\x20AI\x20响应。', '未知地点', '你好，世界\x20(Hello,\x20World)', 'put', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22preview_', '0\x200\x20', 'RueOf', '至少要选择一个圈内成员！', '星期二', 'auto', '\x0a#\x20任务:\x20生成购物记录\x0a创建一份近期的购物清单。这些商品必须是有指向性的，而不是随便买的日用品。比如游戏、书籍、衣服等。最关键的是，这些记录必须和他\x20/\x20她的浏览器历史、备忘录、聊天内容里透露出的兴趣和秘密能够互相印证。一些比较幻想风格的角色可以用更加符合角色背景的内容风格。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22item_name\x22:\x20\x22《神经漫游者》\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22store_name\x22:\x20\x22城东旧书店\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22书籍\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22cost\x22:\x2045.00,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-22\x2015:10\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'snoop-phone-top-nav', 'BLJSl', '-\x20你在“', 'app-pages-slider', 'todo-list', '群聊已解散。', 'sXJPi', 'BicQl', 'NSfiu', '[用户发起了听歌邀请:\x20', 'tcUjI', 'char_', 'OpenAI\x20API\x20错误:\x20', 'theme-hue-slider', ']\x20[', 'upload-widget-bg-button', 'rLSfN', 'YZIcF', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>', 'sort', 'JoETk', '8px\x2016px', '转给\x20', 'snoop-list-screen', '[sticker:', 'getReader', '缓存命中:\x20', 'activeListenSession', '无法从\x20IndexedDB\x20加载聊天图片:', 'diaryView', 'dataset', 'KJMuw', 'YnfbM', 'JBuFg', 'top', 'uMMww', 'diary-action-modal-', '处理\x20', 'timeupdate', '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。', 'categorizedExpenses', 'DWSNm', '请求AI更新:\x20', 'getMinutes', '欢迎！请先创建一个角色开始聊天。', 'fragments', '干劲满满', 'circle_', 'AYGST', 'njyqZ', 'BFLts', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'ILuhA', 'KxJSY', '\x0a#\x20关于你\x20(', 'NuoHI', 'diary-modal-cancel', 'save-user-profile-button', 'some', 'reduce', 'snoop-character-list-container', 'BkLjx', 'snoop_cache', '你的任务是【首次生成】这个应用的内容。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'jvqoo', '新角色\x20', 'jnpjI', '71%', '点击选择\x20info.txt', 'backgroundImage', 'zMImT', 'SvKNu', 'AwIVD', '准备调用\x20generateAs...', 'QyfCW', 'AI返回的原始文本:', 'remove', 'lastIndexOf', 'objectStoreNames', '医疗健康', '原始文本:', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '对方正在行动中...', 'save-world-book-button', '\x20条新动态。', 'lpfmJ', 'backgroundSize', 'jzjXU', '\x0a---\x0a\x0a#\x20输出要求\x0a直接输出一篇有文采、有真情实感的日记正文，不要包含任何其他说明或前缀。', '[AI向\x20', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22width:\x2050px;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'googleapis.com', 'VeeNo', 'ndWxr', 'musicPlayerState', '”的群聊规划角色们的下一步发言。\x0a-\x20与你们对话的人类用户名为“', '<input\x20type=\x22checkbox\x22\x20value=\x22', 'modal-root', 'friend-circle-edit-bind-user', 'jtckp', 'SxzBZ', '\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-log=\x27', 'bUwPw', '群聊“', 'clear', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'code', 'characterEdit', 'fetch-models-button', 'translateX(-', '2px\x20dashed\x20var(--border-color)', '没有找到相关结果。', 'https://sharkpan.xyz/f/4adUj/68uj9o.jpg', 'chibM', '请根据以上所有规则，生成\x20', 'pop', '哼，正在净化你那些超重的音乐分享记录...', '未知商店', 'context-lines-per-chat', '--widget-cover-image', 'ThFzN', 'value', 'test', 'import-data-input', 'author', 'char-edit-css', 'fgXLg', '生成失败:\x20', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>', 'WkDoc', 'todo-date-title', 'mveIy', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x20font-weight:\x20bold;\x20color:\x20var(--accent-color);\x20text-align:\x20right;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20¥\x20', '这本日记本来就是空的，你还想清空什么？', 'iCORD', 'TbpGe', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', 'back-to-home-from-calendar', 'disabled', '有点破防', 'left', '.music-post-song-card', 'mrQIy', 'response', '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。', 'card-image', 'edit-delete-char-button', 'rXohm', 'BCPtc', 'user-profile-screen', '.message.user', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22font-size:\x200.85rem;\x20color:\x20#28a745;\x20font-weight:\x20500;\x22>', '樱花薄粉', 'friend-circle-edit-name', 'sprites', 'GpteE', 'diary-char-name-header', 'lt-ui-song-artist', 'msg_', 'toast', 'speaker', 'style', 'group-avatar-input', 'from', 'Ohifw', '#ff8c66', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNjY2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDRhNC4zOSA0LjM5IDAgMCAwLTMuMjgtNC4wOWwxLjQxLTEuNDFhMiAyIDAgMSAwLTIuODMtMi4wM2wtMS40MSAxLjQxQTQuMzkgNC4zOSAwIDAgMCAxMiAxMGE0LjM5IDQuMzkgMCAwIDAtNC4wOSAzLjI4TDMuMicgOS41N2EyIDIgMCAxIDAgMi44MyAyLjgzbDEuNDEtMS40MUE0LjM5IDQuMzkgMCAwIDAgMTAgMTJhNC4zOSA0LjM5IDAgMCAwIDMgNC4wOVYyMSI+PC9wYXRoPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIj48L2NpcmNsZT48L3N2Zz4=', '最近的足迹', 'onupgradeneeded', 'app-music', '加载徽章图片失败', 'Noir\x27s\x20Fix:\x20已成功追加新旧数据\x20(A+B)。', '--feed-bg-image', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>', 'event_', 'show', 'sNwyp', 'match', '376850aZSOxq', 'system', 'tab-record-expense', 'RWJAd', 'friend-circle-list-screen', '\x0a#\x20已有内容\x20(这是历史记录，你必须接着写，不许动它！)\x0a```\x0a', 'AI\x20试图创建事件，但找不到有效的用户ID。', 'back-to-home-from-diary-list', 'https://sharkpan.xyz/f/JYeig/sv4p6m.jpg', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22', 'https://sharkpan.xyz/f/55ntj/ul0hkz.jpg', 'numeric', '在好友圈\x20\x22', 'badge-input', 'borderRadius', '一拳打爆', 'audio-file-input', 'OwejM', 'BYCAt', 'cancel', 'https://sharkpan.xyz/f/DVJtK/vxiup1.jpg', '确定要清空好友圈“', 'pziXe', 'ZZcdp', 'onerror', 'Escape', '.slot-filename', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22text-align:\x20right;\x20margin-top:\x208px;\x20font-size:\x200.7rem;\x22>编辑于\x20', 'WsiUS', '\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27', 'chatHistory_', '点击选择\x20.lrc', 'zZElL', 'opssX', '好了，请基于以上所有信息，开始写今天的日记吧。', 'oUBfN', 'ZdsUO', '好友圈已删除。', 'ETTUY', '<button\x20id=\x22re-record-button\x22\x20class=\x22header-button\x22>重新记录</button>', 'vrJHv', 'keys', 'preventDefault', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20', '.custom-multiselect', 'KbESM', '\x0a\x0a#\x20你的手机内容摘要\x20(这是你的个人记忆，不要提及“视奸”)\x0a', 'LbOuB', 'IDpMr', 'CrlYg', '[AI分享了音乐：', 'meeting-main-content', ',\x20ID:\x20', '\x20时出错，跳过。', '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。', 'world-book-list-container', 'oyekB', '加载已保存字体失败:', 'drawImage', '错误：你还没有创建任何好友圈。请先在App内创建一个。', 'JhOIV', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-title\x22>💰\x20', '来源：[最活跃]', '\x22\x20style=\x22box-shadow:\x20none;\x20border:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>', '文件格式不正确，不是一个有效的备份文件。', 'info-file-input', 'TPRSY', '<rect\x20x=\x223\x22\x20y=\x223\x22\x20width=\x2218\x22\x20height=\x2218\x22\x20rx=\x222\x22\x20ry=\x222\x22></rect><circle\x20cx=\x228.5\x22\x20cy=\x228.5\x22\x20r=\x221.5\x22></circle><polyline\x20points=\x2221\x2015\x2016\x2010\x205\x2021\x22></polyline>', 'Qrprp', '[用户分享了音乐：', 'qeFzt', 'time', 'ZsDSs', 'https://sharkpan.xyz/f/nj5Ul/ksdl8n.jpg', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'wryWG', 'meetingList', 'xZlpd', 'back-to-home-from-wallpaper', 'AI返回了无法解析的文本', 'activeChatId', 'ceil', 'cover_placeholder_', 'isFinite', ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20', '大家好像不知道该怎么回复...', 'appIconPosition_app-snoop', 'CPMdk', '被你撩到', '加载\x20', '逗你开心', '获取中…', '#\x20记录是空的，没什么好总结的。', 'entries', '#diary-action-delete', 'group-bg-input', 'marginTop', 'https://sharkpan.xyz/f/6Dzia/m9smvt.jpg', 'event_ai_', 'songId', 'active', 'QnTdV', '-\x20**状态提示**:\x20你的生活正在进行中，生成的内容应该是“刚才”或“几分钟前”发生的。\x0a', 'expanded', 'viewBox', '未知角色', 'UbCSp', 'hJZez', 'utterance', 'Enter', '-\x20[', '”的笔记，内容是：“', 'wfpGm', 'eventContent', 'gKEcK', '\x20内容失败:', '\x0a\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20padding:\x2015px;\x20background:\x20white;\x20box-shadow:\x20var(--soft-shadow);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x20margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22font-weight:\x20500;\x22>🛒\x20', '\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-character-name=\x27', 'IDbUq', 'footprints', 'ITJSw', '<div', '正在为你切换新的歌曲...', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>', 'EMUKH', '#app-dock-bottom-left\x20#', 'CjiKz', 'hxqsj', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'sender_id', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天没有安排。</p>', 'KDTJh', 'image', '正在焚烧【', 'CJEst', 'toDataURL', '\x20(ID:\x20', 'gemini', 'fWIEw', 'T00:00:00', 'rgPKR', 'widget_badge', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'CorCR', 'noir_migration_fc_v1_complete', 'fNhuq', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', 'TnWlb', 'cos', 'siSxp', '\x0a\x20\x20\x20\x20-\x20世界书[', '#FFFFFF', 'shy', 'char-edit-avatar-preview', 'chatWallpaper', 'ECPNX', 'yxLrQ', '无法保存聊天记录。', 'organize-bill-button', 'characterLastScripts', 'beforeend', '已经生成了今日账单！想看就去“看账本”标签页。', 'normal,\x20happy,\x20angry,\x20sad,\x20shy', '--primary-lightness', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22font-size:\x200.75rem;\x22>', 'save-api-settings-button', 'documentElement', 'lKUzx', 'message-action-backdrop', '#ffcc66', 'userProfile', 'IoQmp', '#\x20核心任务:\x20写一篇有深度的交换日记\x0a你正在扮演名为“', 'group_bg_', 'group-avatar-preview', '\x22\x20class=\x22char-name\x22>', 'toLocaleTimeString', '#66b3ff', '用户资料已保存！', 'copy-summary-button', 'audio-player', '”。\x0a-\x20你正在生成的内容，是你【自己】手机里的东西。\x0a-\x20【严禁】将“', '#snoop-app-view-container\x20.snoop-app-header', 'fxuJP', '已送达', 'hyzlp', 'YYgCV', 'eSnBf', 'padStart', '生活服务', 'SOLmz', '对方正在输入...', '喝多了', 'https://sharkpan.xyz/f/yrOhN/0yixqd.jpg', 'character-edit-title', '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>', 'PMjNL', 'createObjectStore', '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>', '”已成功导入！', 'todo', 'margin', '\x20个模型。', 'execCommand', 'IDwZM', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22review-area\x22\x20style=\x22margin-top:\x2012px;\x20padding-top:\x2012px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x20display:\x20flex;\x20align-items:\x20flex-start;\x20gap:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22width:\x2040px;\x20height:\x20auto;\x20flex-shrink:\x200;\x20display:\x20flex;\x20justify-content:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'https://sharkpan.xyz/f/0GKHX/mthvno.jpg', 'ZKAqO', 'iTTti', 'kKFcm', '导出过程中发生严重错误:\x20', '\x20添加了新的纪念日：', '#ff9999', '导入失败了，笨蛋:\x20', 'activeMeetingScriptQueue', 'group-chat-name', '.remove-attachment-btn', '-\x20你记得曾和“', '确定要删除这个条目吗？此操作不可撤销。', '导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a', 'group-delete-button', 'PlcNh', 'OpxlC', '<path\x20d=\x22M14\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V8z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline><line\x20x1=\x2216\x22\x20y1=\x2213\x22\x20x2=\x228\x22\x20y2=\x2213\x22></line><line\x20x1=\x2216\x22\x20y1=\x2217\x22\x20x2=\x228\x22\x20y2=\x2217\x22></line>', 'center', '<div\x20id=\x22snoop-dock\x22></div>', 'hNdbL', 'save-group-settings-button', '图标处理失败:\x20', 'img', 'heEIp', 'GQFZm', 'group_avatar_', 'getDate', 'meeting-reroll-button', 'WrgKE', 'abs', '.ttf', 'querySelectorAll', 'FAkNH', 'KuoSm', 'sLoIl', 'kPwDq', 'find', ':streamGenerateContent?key=', '近期没有特别安排', 'historyIndex', '#\x20发生错误：\x0a', '好友圈档案柜是空的，无需净化。', 'back-to-home-from-snoop-list', 'widget-prev-btn', 'jDXSw', 'BDTjg', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'max', '回复\x20', 'hmMjB', 'app-meeting', 'xbuUC', 'user-profile-edit-title', 'getHours', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'diary-list-container', 'blob', '<br>', 'message-anchor', 'QLGSz', '请在动态或聊天中播放', 'generationConfig', 'user_', 'friendCircleEdit', 'stringify', 'KPzTS', 'chat-listen-together-button', 'cancel-action-button', 'pVzCc', '\x20张旧的音乐封面。', 'https://sharkpan.xyz/f/ajwtY/x03qxn.gif', '请输入新的群名称：', 'lt-ui-lyrics-container', 'Failed\x20to\x20read\x20state\x20from\x20localStorage:', 'VwqmM', 'userAvatarFrameUrl', 'meetingViewMode', '\x20-\x20', 'isFromLibrary', 'http', '请输入有效的转账金额！', 'wtRyW', '\x20\x20具体对话如下：\x0a', '8px', 'coverId', 'pAOfn', '说了是摆设啦，笨蛋。', '你是一个乐于助人的AI助手。', 'music_cover_migrated_', '错误:\x20', 'getElementById', 'color', '歌曲ID', 'white', 'set-active-user-button', 'IWtbY', 'Wtilm', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>', 'json', '.typing-indicator', 'htWmB', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>这里什么都没有...</p>', 'Unknown', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>', 'FoZiA', 'vZDJI', 'back-to-library-from-altar', 'XCqWH', 'flatMap', 'diary-modal-save', '正在构思中，请稍候...', 'group-clear-history-button', 'values', 'DboOp', 'gcBHD', 'character-list', 'choice-create-group', 'smooth', 'countdown-title', 'items', '未知用户', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有购物记录。</p>', 'ZwTCo', '）最新写下的日记内容。Ta写的是：\x0a\x20“', 'hxcVV', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20', 'feed-loader', 'ciuDo', 'group-chat-create-screen', 'participantIds', 'transfer', '确定要删除角色“', 'dHGMb', '\x0a\x0a#\x20近期记忆\x20(来自聊天记录等)\x0a', 'DMsKq', 'juigw', 'marginBottom', 'https://i.pinimg.com/736x/16/f9/05/16f9051f99471208ee9c658aa4618eb6.jpg', 'idiBc', '.choice-modal-backdrop', 'user', 'PVrcE', '设置已保存！', '今天一笔账都没有，我整理什么？', '<p\x20style=\x22margin:\x20auto;\x20text-align:\x20center;\x20color:\x20red;\x22>加载失败了，哼。<br>', 'endsWith', 'hOWvS', 'tPWUR', 'world-book-editor-screen', '2023-06-01', 'sPaQZ', 'main', 'RfLse', 'html-module-container', '.no-action-modal', 'DIqwt', 'char-avatar-frame-url', '#meeting-view-screen\x20.chat-input-area', 'rwZMw', 'changedTouches', '大家正在赶来回复...', '请先输入\x20API\x20接口地址和密钥。', 'hsEXM', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22order-items-container\x22\x20style=\x22display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x204px;\x20margin-bottom:\x2012px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'BLmTW', 'LWAtL', '\x22>\x20', 'back-to-chat-from-group-settings', 'className', '用户已删除。', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'owVph', 'Dyqxw', 'customWallpaper', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>', '-\x20姓名:\x20', 'qyhJm', 'OFbNd', 'ogTXv', 'char-edit-avatar-input', '-\x20**状态提示**:\x20你和Ta已经好几天没联系了，应该用全新的问候开启对话。\x0a', '59%', 'Creating\x20object\x20store:\x20', 'JoJvT', 'add-chat-button', 'is-playing', '\x20|\x20', 'HjIfB', 'diaryCurrentPage', 'coverUrl', '/v1beta/models/', 'IFHQy', '<img\x20src=\x22', '##\x20', '桌面已重置，即将刷新...', 'AI返回的内容里找不到有效的JSON数组。原始回复:\x20', 'quote-preview-area', 'https://sharkpan.xyz/f/z1xc5/iore2n.gif', 'textShadow', 'snoop-app-view-container', 'lyric-line-', 'anthropic', 'snoop-temp-style', '.listen-together-card', 'ipZIQ', '#diary-action-cancel', 'POST', '-\x20**状态提示**:\x20这是你的手机第一次被“看见”，生成的内容应该是你的初始状态。\x0a', 'emotion', 'GsQCU', 'https://sharkpan.xyz/f/rjpu6/ojpa0c.jpg', 'alignItems', 'VLBmW', '解析音乐文件失败:', '”...', '星期五', '\x0a\x0a#\x20最终指令\x0a请严格遵守所有协议，完成你的任务。你的输出【必须】是、也【只能】是一个遵循\x20JSON\x20格式（或者至少是类似\x20YAML\x20的列表格式）的、完整的数组字符串。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', '\x0a#\x20你的日程与纪念日\x20(由\x20', 'round', '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path>', '》吗？', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有聊天记录。</p>', 'CRQhz', 'is-visible', '<div\x20class=\x22post-timestamp\x22>', 'warn', 'group-bg-preview', '#99ff99', 'gEwwx', 'UukqU', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22width:\x2070px;\x20height:\x2070px;\x20background-color:\x20#f0f2f5;\x20border-radius:\x208px;\x20font-size:\x202.5rem;\x20flex-shrink:\x200;\x22>🛍️</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22flex-grow:\x201;\x20display:\x20flex;\x20flex-direction:\x20column;\x20justify-content:\x20space-between;\x20height:\x2070px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20500;\x20line-height:\x201.4;\x20-webkit-line-clamp:\x202;\x20display:\x20-webkit-box;\x20-webkit-box-orient:\x20vertical;\x20overflow:\x20hidden;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'indexedDBData', 'summarize-modal', 'NteDb', 'toLocaleDateString', 'AI似乎没有想出任何新动态。', 'char-edit-persona', 'bNAmT', 'canplaythrough', 'jrRMm', 'chat-reroll-button', 'Noir\x27s\x20Fix:\x20已用AI返回的连续对话更新聊天记录。', 'tAxEC', 'upload-music-button', 'ended', 'DUPUK', 'calendarEvents', 'RsMHQ', '确定要恢复默认字体吗？', 'pYqiQ', '</div><div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x22>', 'CCORU', '壁纸已更换！', 'boundUserProfileId', 'snoop-app-icon', '\x0a\x0a#\x20任务流程\x0a1.\x20\x20**全局视角**:\x20审视所有成员的人设和近期记忆（包括聊天、日记等），构思他们之间可能发生的有趣互动。\x0a2.\x20\x20**选择作者**:\x20从上述成员中，为', '生成动态时发生错误:\x20', 'kdFbV', '-\x20**状态提示**:\x20你的记忆已经停留在【昨天】。你生成的内容应该是今天发生的、全新的事情。\x0a', 'QVcsN', 'splice', 'https://sharkpan.xyz/f/ExKsD/s5j2it.jpg', 'yBZCN', 'LpUQO', 'https://sharkpan.xyz/f/B4DCa/u86hk2.jpg', 'GNeTc', 'perChatContextLines', 'anthropic.com', '\x0a\x0a#\x20用户资料\x20(与你互动的人)\x0a-\x20姓名:\x20', 'EZswD', '\x20\x20\x20\x20-\x20', 'altar-slot-lyrics', 'lt-ui-cover-art', '<path\x20d=\x22M10\x2020.5l.5-.5.5.5\x22></path><path\x20d=\x22M12\x2018l.5.5.5-.5\x22></path><path\x20d=\x22M14\x2020.5l.5-.5.5.5\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x227\x22></circle><path\x20d=\x22M12\x203v1\x22></path><path\x20d=\x22M12\x2019.5v1.5\x22></path><path\x20d=\x22M18.36\x205.64l-.7.7\x22></path><path\x20d=\x22M6.34\x2017.66l-.7.7\x22></path><path\x20d=\x22M21\x2012h-1.5\x22></path><path\x20d=\x22M4.5\x2012h-1.5\x22></path><path\x20d=\x22M18.36\x2018.36l-.7-.7\x22></path><path\x20d=\x22M6.34\x206.34l-.7-.7\x22></path>', '错误：找不到当前用户，无法保存事件。请尝试返回主屏幕再试一次。', 'activeFriendCircleId', 'EBJnF', '\x0a\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'accountingData', 'localeCompare', '群聊名称不能为空！', '请严格按照以下SCHEMA返回一个JSON对象，不要包含任何额外文字。\x0aSCHEMA:\x0a', '吃薯条', '群聊「', 'XmdtG', 'xiNnj', 'musicPlaylist', '这个也是摆设，别点了。', 'localStorageData', '.selected-options-text', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'gKvrr', 'themeLightness', 'Kmzzb', '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a', '\x0a\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a-\x20**当前精确时间**:\x20', '。你的日记是写给Ta看的。\x0a\x0a#\x20写作【最高指令】\x0a1.\x20\x20**【首要任务：回应读者】**\x20你的第一要务是**回应**读者（', 'LuuZI', '快点哄我', 'transaction', 'CAGgB', 'qYcZY', 'reply', 'widget_card', 'https://sharkpan.xyz/f/MWOIa/rb3nov.jpg', '正在连接同步频道...', '请根据以上所有规则（特别是要看图！），生成对用户动态的回应。', '\x0a-\x20**对话状态**:\x20群里已经有', 'PCNRi', '哼，就按你说的办好了。', '\x0a#\x20交换日记摘要\x20(你和\x20', 'char-edit-wallpaper-preview', 'snoop_', 'VAjqt', 'giLls', 'parse', '还没有我的回复可以重新生成哦。', '-\x20你拍过一张照片，内容是：“', 'global-player-play-pause-btn', '正在翻阅所有档案...', 'bCSCS', 'calendar-screen', 'onsuccess', 'fFghD', '_NoirCard.json', 'UxsEn', '#snoop-app-view-container\x20.snoop-app-content', 'sIwep', 'data:', '</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '净化完成！应用即将重启。', '<path\x20d=\x22m3\x209\x209-7\x209\x207v11a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2z\x22></path><polyline\x20points=\x229\x2022\x209\x2012\x2015\x2012\x2015\x2022\x22></polyline>', 'AmTQA', 'oWkhF', 'startsWith', 'svg', '确定要从圣殿中永久删除《', '\x0a#\x20当前活动：一起听歌\x0a\x0a你们正在一起听\x20', '正在解析音乐灵魂...', 'euBmh', 'worldBook', 'clockPosition', 'atZlG', 'groupChatCreate', 'custom_font_ttf', '[DONE]', '<path\x20d=\x22M14.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V7.5L14.5\x202z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline>', 'gwsnn', 'role', 'emote', 'olduv', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>', 'is-entering-from-right', 'MYDxL', 'https://sharkpan.xyz/f/N02Sv/378vt6.jpg', 'EyLLJ', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的账本还是空白的。</p>', 'dXWIc', 'PbcOO', 'Hlxvr', '\x20张旧图片。', 'MrJOF', 'back-to-circle-list-from-feed', 'WeEQQ', '<div\x20class=\x22snoop-main-grid\x22></div>', 'chat-image-input', '20%', 'group-world-book-checkboxes', 'wppLK', 'imageId', 'userProfiles', '确定要删除这个好友圈吗？此操作不可撤销。', 'home', 'snoopPhone', 'song_', 'LeskG', 'delete-world-book-button', '我是垃圾', 'editing-world-book-id', '\x20.app-icon-img,\x20#app-dock-top-right\x20#', '正在处理图片...', 'push', '\x22\x20class=\x22music-share-cover\x22>', 'back-to-settings-from-user-profile', 'FsxfS', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'meeting-send-button', 'https://sharkpan.xyz/f/B4WSa/u5wopj.jpg', 'likes', '检测到已保存的字体，正在应用...', '执行好友圈数据净化...', 'https://sharkpan.xyz/f/wyeIq/phhdy2.jpg', 'QWTrn', '”的角色，并根据Ta的人设、记忆和当前的时间点，推演出Ta手机里某个应用可能存在的内容。\x0a\x0a#\x20【绝对身份锁定协议】(最高优先级)\x0a-\x20你【就是】“', 'DSHXt', 'readAsText', 'rZXED', 'mVUOO', 'GzTdX', 'mYaFD', 'cCbrE', '<span>', 'message', 'getDay', '已恢复默认。', '<span\x20class=\x22', '稍微有点卡了，可以尝试清空聊天记录了！记得总结丢世界书', 'getAll', 'NpCdh', 'stopPropagation', 'live-preview-style', 'endpoint', '正在铭刻字体...', 'jnNFy', 'checked', 'Failed\x20to\x20remove\x20history\x20for\x20chat\x20', 'modal-text', 'jDnaq', 'ZccIu', 'fOwqV', 'meeting-list-screen', 'Iakuq', 'UjRck', 'Creating\x20object\x20store:\x20music_library', 'eZToa', 'BwlwS', 'clientY', 'https://sharkpan.xyz/f/G0dTl/4qad2i.jpg', 'gwMlU', '[发送了图片]', 'fzUOi', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '确定要彻底清空【', 'nBnZn', 'eventDate', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'EyUVt', 'char-edit-bind-user', 'HlJtK', 'JcvGH', 'vXNcR', 'end', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', '\x20条动态...', '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '保存播放器状态失败，真是没用。', 'kind', 'gKQLv', 'JTxPO', 'IiDFX', 'xjcuF', '包含所有图片和音乐的全量数据已成功导出！', 'RdxEE', 'gSxJW', '”已删除。', '\x20行格式不对，被我无视了。', 'vUPqe', 'chat-message-input', 'music-library-container', 'createElement', 'nRhHh', '\x20写道:\x20', 'typing-indicator', 'thought', '未知商品', 'todo-item', '\x20转账\x20', 'setHours', '加载第二个卡片图片失败', '\x0a#\x20核心任务:\x20角色扮演模拟器\x0a你的【唯一】任务是扮演名为“', 'aMYAR', 'Usywl', 'span', ':\x22\x20或\x22[', 'https://sharkpan.xyz/f/JYJhg/s3wmlj.jpg', '<div\x20class=\x22listen-together-header\x22\x20style=\x22text-align:center;\x22>🎵\x20已连接，正在一起听\x20🎵</div>', 'httcI', 'nFRzh', '\x27).click()\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x20background-color:\x20#777;\x22\x20onclick=\x22localStorage.removeItem(\x27', 'postContent', 'cdSmx', '找不到角色信息。', '哼，不好好写清楚花在哪、花了多少，我怎么记？', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22background:\x20var(--card-bg);\x20padding:\x2020px;\x20border-radius:\x2012px;\x20text-align:\x20center;\x20border:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x22>今日总支出\x20(元)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x202.5rem;\x20font-weight:\x20bold;\x20margin-top:\x205px;\x22>', '\x22\x20src=\x22', 'editing-char-id', '【最高警告】\x0a\x0a这将删除此应用在本机上的所有数据（包括所有用户、聊天、设置），且不可恢复！\x0a\x0a请再次确认你已经通过「导出全部数据」功能进行了备份！', '\x20(分享了歌曲:\x20', 'posts', '在“一起听”邀请中，净化封面失败:', '确定要导入全量备份文件吗？这将覆盖所有当前数据（包括图片和音乐），且操作不可撤销！', 'LjSaN', '<div\x20class=\x22post-comments-container\x22>', 'edit-current-circle-button', 'bOGQC', '\x0a-\x20**对话状态**:\x20群里在', 'WiGps', 'iwBFQ', 'FGigT', 'input[type=\x22checkbox\x22]:checked', '在准备群聊API数据时，读取图片失败:', 'buHIV', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'ZtFgf', 'confirm-altar-upload-button', '未知餐厅', '\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22padding:\x2015px;\x20', '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'MUjYw', 'transparent', 'body', 'YPbQn', 'trim', 'getContext', 'WrovJ', 'substring', 'MFedo', 'KYMJP', '10px\x20auto', 'WDbmH', 'border-bottom:\x201px\x20solid\x20var(--border-color);', 'chat-music-button', '恢复失败了:\x20', 'rkHpB', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22character-item\x20snoop-chat-item\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-bottom:\x200;\x20cursor:\x20pointer;\x20', '我不想工作', 'WGbbt', 'User\x20cancelled', 'none', 'diary-view-screen', 'https://sharkpan.xyz/f/8a7tj/sea1z9.jpg', 'forceWhiteClock', 'JOLgs', 'noir_migration_music_v1_complete', 'uXDxa', 'wb_', '在准备API数据时，从IndexedDB读取图片失败:', '[发送了表情]', 'dDsPO', 'MhOfL', 'NfGzo', 'reset-widgets-position-button', 'ejNPf', 'scrollTop', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20right;\x20font-size:\x201.1rem;\x20font-weight:\x20bold;\x20margin-top:\x2010px;\x20padding-top:\x2010px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20实付:\x20<span\x20class=\x22amount\x22>¥\x20', 'eventType', 'XcbUG', 'Claude\x20API\x20错误:\x20', 'TyzDW', 'https://sharkpan.xyz/f/7aMhj/hyc75m.jpg', '<path\x20d=\x22M6\x202L3\x206v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2V6l-3-4z\x22></path><line\x20x1=\x223\x22\x20y1=\x226\x22\x20x2=\x2221\x22\x20y2=\x226\x22></line><path\x20d=\x22M16\x2010a4\x204\x200\x200\x201-8\x200\x22></path>', 'galgame-speaker', 'XSKqi', 'diary-entry-input', 'OfUzA', 'FSHzM', 'gWgko', '.music-post-play-icon,\x20.music-share-play-icon', 'aLmsU', 'page', 'mousedown', '-\x20**状态提示**:\x20你已经有\x20', 'shift', 'trwMZ', 'wAxgm', 'change', 'music-widget', '】进行回复。\x0a不要替其他角色续写台词，不要输出\x22', 'char-edit-sprite-', '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20', 'tab-view-ledger', '世界书条目已保存！', '未分类', 'diaryPressTimer', 'FZomn', 'IVJHw', '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'djUSc', 'galgame-view-container', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22snoop-app-back-btn\x22\x20class=\x22snoop-app-header-button\x22>返回</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-header-title\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22main-title\x22>', '.snoop-main-grid', 'music-post', 'area', 'https://sharkpan.xyz/f/ABwhZ/twknmr.jpg', 'CjoEH', '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a', 'charId', 'activity_description', 'model', 'qmkXx', 'provider', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22float:\x20right;\x22>', 'XFLYQ', 'yEnjT', '未知联系人', 'chat_image_', 'JKJEq', 'INuiL', '-\x20**对话状态提示**:\x20你们已经有\x20', 'https://sharkpan.xyz/f/1zQH2/o84boo.jpg', 'toLocaleString', 'IzmCx', '.diary-delete-btn', 'sxMoB', 'FYBlP', 'keydown', 'Failed\x20to\x20parse\x20history\x20for\x20chat\x20', 'wLTiD', 'sprite-slider-y', 'TPjme', 'head', 'aaHyV', '\x0a##\x20', '的手机内容\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'today-todo-list', 'meeting-scene-view', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天还没有花钱哦。</p>', 'PUOAn', '好友圈净化完成，正在重新存档...', '内容不能为空！', 'BuwIt', '导出角色卡失败:', '群聊设置已保存！', ']\x20[sticker:', '\x0a#\x20最近的朋友圈动态\x20(供你参考)\x0a', 'then', 'YYCTZ', '无描述', 'daily-expenses-list', '解析存档失败，正在重置:', 'nXUEE', 'qHUUS', 'PYzWq', '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>', 'iXNaC', 'szMrR', 'home-screen', 'dkILd', 'jQzIa', 'href', 'amount', 'PJNaL', 'wHoeI', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'gItdo', '正在搬运旧卡片...', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-', ';\x22>', 'UGNTw', 'zinZT', 'yHTMz', 'hxrip', '档案已复制到剪贴板！', 'normal', '”（用户）的信息当成你自己的。\x0a\x0a#\x20【最高时间法则】(必须严格遵守)\x0a-\x20已有内容的最新时间点:\x20', 'decode', 'input[type=\x22checkbox\x22]', '人情红包', 'diary-list-screen', '未知表情', 'iNuJV', '.listen-together-song', 'diKfj', 'expense-amount', 'sxHnM', '>>\x20', 'feed-bg-input', '</div>', '同步已断开。', '<span>--</span><span\x20class=\x22unit\x22>天</span>', 'diary-modal-textarea', 'galgame-sprite-adjust-ui', '群聊\x20(', '很好哦', 'music_library', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥', 'https://sharkpan.xyz/f/ZazfW/2vv46w.jpg', 'IcuQX', 'vnyeb', 'width', 'MImdM', 'wallpaper-screen', '我正在说话呢，别打岔！', 'user-post-image-button', '点击选择\x20.mp3\x20或\x20.flac', 'noir_data_migration_v1_complete', 'iRevp', '<span\x20style=\x22opacity:\x200.6;\x22>无</span>', 'CTiIM', '兼容模式成功，已将\x20', 'modal-mask', 'style-', 'https://sharkpan.xyz/f/6Dgia/ghr4ji.jpg', 'listen-together-invite', 'LjZqW', 'PgtCO', 'QRCuX', 'calendar-header-title', 'home-time', 'BYehz', 'lPomd', 'ykNIk', '&quot;', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', '\x22\x20吗？所有聊天记录将被永久删除。', 'QQPrv', '”已存入圣殿。', 'setMonth', '净化失败了，哼:\x20', 'click', 'XpHeK', '-\x20**状态提示**:\x20这是你和', 'csuKb', 'download', 'pause', 'upload-font-button', '成功向好友圈\x20\x22', '无标题笔记', 'chats', '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202h-14a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011v-7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v7\x22></path><path\x20d=\x22M9\x204v3\x22></path>', 'sender', '\x0a#\x20核心任务\x0a你是一个高度智能的档案管理员，任务是为我（用户，名为“{userName}”）和角色“{charName}”之间的私聊记录生成一份简洁、结构化的长期记忆摘要。\x0a\x0a#\x20摘要规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。严禁包含任何\x20JSON、Markdown\x20或其他解释性文字。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`memory_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以日期（`YYYY-MM-DD`）作为键。\x0a\x20\x20\x20\x20-\x20每个日期下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**精简**:\x20忽略日常问候、无意义的闲聊和重复内容。\x0a\x20\x20\x20\x20-\x20**聚焦**:\x20专注于关键信息、情感转折点、重要决定、分享的秘密、设定的约定、以及能够体现角色性格和关系变化的核心事件。\x0a\x20\x20\x20\x20-\x20**中立视角**:\x20以客观的第三人称视角进行记录。**请直接使用“{userName}”和“{charName}”这两个具体的名字**\x20来指代双方。\x0a\x0a#\x20输出示例\x0amemory_summary:\x0a\x20\x202025-09-12:\x0a\x20\x20\x20\x20-\x20\x22userName}\x20表达了对最近工作压力的烦恼。\x22\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20分享了自己过去类似的经历来安慰\x20{userName}，并提议周末一起去看电影。\x22\x0a\x20\x20\x20\x20-\x20\x22双方约定周六下午在市中心的电影院见面，并确定观看电影《夏日终曲》。\x22\x0a\x20\x202025-09-13:\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20发来一张猫咪的图片，心情看起来不错。\x22\x0a\x20\x20\x20\x20-\x20\x22{userName}\x20讨论了关于一个新项目的想法，{charName}\x20给出了一些关键建议。\x22\x0a\x0a#\x20输入格式\x0a我将为你提供完整的聊天记录，格式如下：\x0a[YYYY-MM-DD\x20HH:MM]\x20[说话人]:\x20聊天内容\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的聊天记录全文，并生成一份\x20YAML\x20格式的摘要。直接从\x20`memory_summary:`\x20开始输出。\x0a', 'createElementNS', 'gtqep', 'kTLXr', 'lXppD', 'HRXOD', '条目名称和内容都不能为空！', 'upload-feed-bg-button', '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“', 'xqqqL', 'jIoPS', '】的手机内容吗？\x0a\x0a所有已生成的缓存（相册、NPC聊天等）都将被永久删除。', 'PIYie', 'ErqlU', '\x20.app-icon-img', 'AxcKv', 'title', 'NuJoy', '</div></div></div><span\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x22>-\x20', 'RbQMp', 'setAttribute', 'novel', 'sprite-slider-scale', 'OgPBk', '\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20absolute;\x20left:\x20-25px;\x20top:\x2015px;\x20width:\x2020px;\x20height:\x2020px;\x20background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20font-size:\x201rem;\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-left:\x2010px;\x20padding:\x2012px\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20600;\x22>', 'fEzAp', 'CIOKg', 'toggle', 'xubLR', 'restaurant_name', 'https://sharkpan.xyz/f/djyi8/1en214.jpg', 'activeDiaryCharacterId', '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a', 'clock-color-toggle', '天没动静了。你的角色们应该发起新的问候或话题。', '\x0a\x0a#\x20当前任务指令\x0a', 'sprite-cancel-button', 'event-type-todo', 'gYOUm', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22group-options-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-clear-history\x22\x20class=\x22choice-modal-button\x22>清空聊天记录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-members\x22\x20class=\x22choice-modal-button\x22>编辑群成员</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-name\x22\x20class=\x22choice-modal-button\x22>修改群名称</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#ff4d4d;\x22>删除群聊</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-options-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'RVzOH', 'snoop-app-back-btn', '[用户向\x20', 'post_user_', 'group-settings-bind-user', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'yLltp', '-\x20**状态提示**:\x20你们今天刚聊过，请自然地衔接对话。\x0a', 'flex', 'FeDso', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有外卖订单。</p>', '动态已清空。', 'HCkcN', 'AI未能返回有效的JSON对象。', 'pZEXK', 'eTJJI', 'result', 'groupSettings', 'bJYiD', 'gDiRw', 'opEDB', '加载角色\x20', 'avatar-frame', 'tdvxM', 'app-wallpaper', 'towFJ', '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20font-size:\x200.9rem;\x20color:\x20var(--text-color);\x20margin-top:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>', 'https://sharkpan.xyz/f/YA7T1/th0l79.jpg', 'cqDmv', 'cJKCb', 'kHWPG', 'diary-write-modal', 'badgeState', 'music-input-modal', 'add-world-book-button', 'fill', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-', 'ONhyv', 'parentElement', 'chat-transfer-button', '星期三', 'export-all-data-button', 'transfer-recipient-group', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-container\x20', 'sticker-content', 'chat-screen', '加载卡片图片失败', 'uAFum', 'KzSIR', 'edit-clear-history-button', '\x0a#\x20时间锚点\x20(你必须严格参考此信息进行推演)\x0a', 'cost', 'chat-image-button', '34%', 'userProfileList', '群名称已更改为\x22', 'toLowerCase', '-\x20[动态]\x20', 'MVTGb', 'GlYKf', 'rawResponse', 'KZfUb', 'paFLG', 'cancel-event-button', 'NWBPJ', '\x20张旧图片。应用即将刷新。', 'mouseup', '\x0a#\x20你的个性（节选）\x0a', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'readwrite', '错误：找不到此好友圈绑定的用户！', 'Noir_FileSystem', 'true', '</span><span\x20class=\x22amount\x22>总计:\x20', 'delete-expense-btn', 'Noir\x27s\x20Fix:\x20\x27home-screen\x27\x20element\x20not\x20found!', 'widgetBgImage', '核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a', '<div\x20class=\x22loader-spinner\x22></div><span>', '交给我吧', 'quoted-sender', 'FWfLo', 'https://sharkpan.xyz/f/Oyjuy/p8v2hd.jpg', 'slice', 'backgroundPosition', 'info', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'calendar', '升级已取消。旧版图片数据可能导致应用卡顿或出错。', '出去玩', 'Lkjxr', 'characterId', '纪念日', '视奸内容解析失败:', 'feed', 'sprite-resize-handle', '2616152CbKTDz', 'ogxXi', 'TmCyA', 'oGede', 'HnNCY', 'diary-entry\x20', 'post_image_migrated_', 'filter', 'galgame-time', '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“', 'hVdjt', 'data:\x20', 'Axkuj', '需要至少2个角色才能创建群聊。', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/epv2AAAAABJRU5ErkJggg==', 'https://sharkpan.xyz/f/3AGHe/2f8x3x.gif', 'currentAbortController', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22snoop-log-back-btn\x22\x20class=\x22snoop-app-header-button\x22\x20style=\x22text-align:\x20left;\x22>‹\x20聊天</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22snoop-app-header-title\x22>', 'readonly', 'cover', 'exec', '\x20[并附上了一张图片]', 'p[data-history-index]', 'meeting-char-name-header', '哼，正在净化你那些被污染的好友圈动态...', 'TrXMK', '切，加载播放器状态的时候出错了。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', '保存角色失败:', '(想转账给“', 'displayUrl', '1em', 'IJPov', '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x228\x22></circle><line\x20x1=\x223\x22\x20y1=\x223\x22\x20x2=\x2221\x22\x20y2=\x2221\x22></line>', 'Gemini\x20stream\x20reading\x20aborted.', 'jxwKz', 'iRUok', '分钟前聊过，请注意衔接。', 'jffdT', '加载聊天失败:\x20', 'HfZGd', 'WxBGa', 'oABRZ', '<div\x20class=\x22snoop-avatar\x22>', ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“', '?id=', '\x20页</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-next-button\x22>下一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'DFXNY', 'avatar-wrapper\x20', 'addEventListener', 'https://sharkpan.xyz/f/N0VCv/5rd8br.jpg', 'back-to-meeting-list', ')\x20的专属时间锚点\x0a', 'bKdzg', 'lJCLd', 'rgMWC', 'events', 'setDate', 'JPVBJ', '正在准备音乐数据...', 'char_avatar_', 'yhpbE', 'select', '正在写入新数据...', 'qMcrz', '\x0a\x0aINPUT:\x0a', 'HnHYf', 'todo-item-small', 'postType', 'GQUQu', '】的旧数据...', 'input', 'originalExpenses', '已自动断开与其他人的听歌同步。', '💜\x20', 'selectedDate', 'ANgJv', '刷新了\x20', 'user-name', 'senderId', 'lxXqd', 'backgroundColor', 'ctIEh', 'random', '”的所有动态吗？此操作不可撤销，且AI将不再记得这些内容。', 'QqQtC', 'https://sharkpan.xyz/f/AaDTZ/tzwnjl.jpg', 'isAnimatingDiary', 'ASLil', 'app-world-book', 'home-dock', 'image_url', 'url(', '已经删掉了。', 'yMkBj', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22\x20style=\x22white-space:\x20nowrap;\x20overflow:\x20hidden;\x20text-overflow:\x20ellipsis;\x20color:\x20var(--text-color-light);\x22>', '服务器错误:\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-', 'add-choice-backdrop', 'awXoT', 'split', 'nndvo', 'MXQnb', 'JHCVj', 'tjXQa', 'galgame-date', 'BXFfj', 'lKvEe', 'position', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>', 'LceOa', 'toBlob', 'char-edit-offline-bg-input', 'IkXzr', '#group-settings-screen\x20.select-box', 'sLlWu', 'dyWHY', 'IlKnk', 'tApdh', 'fkCZt', '</span><span\x20class=\x22unit\x22>天</span>', 'QvYbG', '确定要恢复这个角色的默认立绘位置吗？', '\x0a你是一个严格的JSON生成引擎。\x0a你的唯一任务是根据用户提供的指令和数据，生成一个描述角色互动的JSON对象。\x0a你的输出【必须】是、也只能是一个单一、完整、语法正确的JSON对象。\x0a严禁包含任何解释、注释、道歉、或Markdown代码块标记\x20```json。\x0a直接输出\x20{\x20\x22events\x22:\x20[...]\x20}\x20结构。\x0a', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以视奸的角色。</p>', 'user-post-avatar', '保存徽章状态失败', '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'snoop-app-refresh-btn', 'oeKzJ', 'activeMeetingCharId', 'dZxvu', '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', 'scrollHeight', 'HoQLo', 'chat-get-reply-button', 'DADcl', 'TmaPL', 'confirm-music-input', 'message-container', 'Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20', 'touches', 'qtAaB', 'font-input', 'snoop-summary-textarea', 'nrlCS', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20var(--text-color-light);\x20font-size:\x201.2rem;\x20margin-left:\x20auto;\x20font-weight:\x20200;\x22>›</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', ']:\x20', 'https://sharkpan.xyz/f/ljNUx/aw6udx.jpg', 'save-friend-circle-button', '[AI返回了无法解析的剧本:\x20', 'log', '---\x20开始AI回复流程\x20---', 'dOMSZ', 'playableUrl', '<p>格式错误</p>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'Uftrt', 'RvLqw', 'query', 'Assistant', '该角色', 'display', 'accounting', 'netease', '---\x20音乐净化仪式完成\x20---', '我来搞定', 'clipboard', 'history', 'poYvc', '你还没有写日记。', '#f2b7c6', 'height', 'RwToc', '<div\x20style=\x22border-left:\x202px\x20solid\x20var(--border-color);\x20padding-left:\x2015px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2015px;\x22>', 'getFullYear', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'authorId', '在准备动态回复时，读取图片失败:', 'files', 'back-to-home-from-circle-list', '外卖订单', 'chat_', '创建新用户', 'lt-ui-song-title', '\x27>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22background-color:\x20#eee;\x20font-size:\x201.5rem;\x22>', 'BPans', 'charSelect', '\x20之间的私密内容)\x0a', 'world-book-edit-name', 'cancel-transfer-button', 'dock', '\x0a#\x20好友圈的主人\x20(“我”)\x0a-\x20姓名:\x20', 'ECuDL', 'yQBnm', 'zrOgJ', 'rbsra', '导出失败了，哼:\x20', 'date', 'rQETZ', 'VJpkJ', 'transfer-amount-input', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>', 'abyss', 'ppEnd', 'zzxgb', '\x20记录)\x0a', 'activeQuote', 'XdvKK', '15px\x2020px', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>', 'xIpdJ', 'bottom', 'nkbBp', 'dIXJg', 'characters', 'diary-prev-button', '-\x20**状态提示**:\x20你和Ta上次聊天是在昨天，注意你发言的时间感。\x0a', 'narrator', 'canvas', 'appIconPosition_app-user-profiles', 'wHXFe', 'QEjGq', 'shiftKey', 'user-avatar-input', 'app-user-profiles', 'card-input', '</span><div><div\x20class=\x22description\x22>', '-\x20**你与', 'SNWWi', '\x0a\x0a#\x20关于群聊参与者“', '今天\x20', '图片预览失败:\x20', 'THrSc', 'nKoEQ', 'currentDate', '加载壁纸失败:', 'wallpaper_main', 'mFMYH', 'jIQAu', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message\x20', 'back-to-home-from-music-library', 'all', 'QPCaw', '#ffb366', 'https://sharkpan.xyz/f/djjH8/29ejbg.jpg', 'galgame-sprite', '错误：找不到签署契约的地方。', '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'ipxeY', 'UDLDl', 'diary-write-button', 'Nrvfk', '28%', '未命名群聊', '一个人可怜吃饭', 'music-player-bar', 'https://api.vkeys.cn/v2/music/', '2755505jouMmJ', 'back-to-circle-list-from-edit', 'lyrics', 'join', 'quoted-message-in-bubble', 'Failed\x20to\x20read\x20history\x20for\x20chat\x20', 'oJgdD', 'SDRSV', '\x0a#\x20核心任务:\x20档案馆书记官\x0a你的任务是为一个名为“', '\x22\x20class=\x22post-image\x22></div>', '好友圈数据升级完成，迁移了\x20', 'JwmQm', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>', '请输入群聊名称。', '</div>\x0a\x20\x20\x20\x20', 'readAsDataURL', 'qPtsG', 'xHWhs', '\x0a\x20\x20近期记忆:\x0a', 'apply', 'uLVTf', 'CIOUp', '这是一条由控制台添加的测试动态！样式看起来非常完美。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22snoop-summary-textarea\x22\x20readonly\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border:\x20none;\x20outline:\x20none;\x20resize:\x20none;\x20font-family:\x20\x27Courier\x20New\x27,\x20monospace;\x20font-size:\x200.85rem;\x20line-height:\x201.6;\x20background-color:\x20#fdfdfd;\x20padding:\x2015px;\x20box-sizing:\x20border-box;\x22>', 'activeUserProfileId', '<path\x20d=\x22M6\x2012h12\x22></path><path\x20d=\x22M12\x206v12\x22></path><path\x20d=\x22M12\x202a4\x204\x200\x201\x201-4\x204\x22></path><path\x20d=\x22M12\x2022a4\x204\x200\x201\x200\x204-4\x22></path><path\x20d=\x22M22\x2012a4\x204\x200\x201\x200-4-4\x22></path><path\x20d=\x22M2\x2012a4\x204\x200\x201\x201\x204\x204\x22></path>', 'AcFhf', '群聊至少需要2名成员。', 'XqWry', 'EHBWQ', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>', 'AI返回了无法识别的数据格式。', '收到的原始、有问题的文本:', 'bXZcC', 'inline-block', '吃你的饭', 'yjEZc', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'widget_card_2', 'rDZSP', 'gpfjp', '<button\x20id=\x22snoop-copy-summary-btn\x22\x20class=\x22snoop-app-header-button\x22>复制</button>', 'conversationHistory', 'HPfMt', 'world-book-edit-content', '\x20的内容\x0a请为角色生成符合其人设的应用数据。输出格式必须是严格的JSON数组。', 'themeHue', '正在清空旧数据...', 'KwuxZ', 'diary-next-button', 'FtfQU', 'mQWjT', 'vFIik', '好的，我记住了这些人设和历史。现在我们开始对话。', '---\x20Noir\x27s\x20Data\x20Purification\x20Ritual\x20v1.0\x20---', 'back-to-home-from-chat', 'appState', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', '批量生成动态失败:\x20', 'jLAer', '---\x20Noir\x27s\x20Music\x20Cover\x20Purification\x20Ritual\x20---', 'remark', '已设为当前用户！', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'categorized-expenses-list', '解析AI剧本JSON失败:', 'pwDhH', 'customStickers', 'kgWlG', 'defaultPrevented', 'tnRAO', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'background', 'replaceAll', 'swTJU', 'edit-message-modal', 'data:image', 'wants', 'api-model', 'XVuKK', 'mOeco', 'accounting-screen', '#\x20核心任务:\x20财务分析与多角色吐槽\x20(单次请求完成)\x0a你是一个高级AI，需要一次性完成对用户消费流水的分类，并为每一笔消费生成一个符合角色人设的吐槽。\x0a\x0a#\x20规则\x0a1.\x20\x20**逐条处理**:\x20你必须处理我提供的【所有】消费记录。\x0a2.\x20\x20**精准分类**:\x20为每条记录从【固定分类列表】中选择一个最合适的分类。\x0a3.\x20\x20**人格切换吐槽**:\x20为每一条记录，你必须从【角色资料库】中【随机选择一位】，然后【严格代入】该角色的人设，并【假定】这笔消费是该角色【绑定的用户】所为，然后写一句简短吐槽。\x0a4.\x20\x20**JSON输出**:\x20你的输出**必须**是一个完整的、语法正确的JSON数组。每个对象代表一笔消费，且必须包含\x20\x22description\x22,\x20\x22amount\x22,\x20\x22category\x22,\x20和一个\x20\x22review\x22\x20对象。\x0a\x0a#\x20输出格式示例\x0a```json\x0a[{\x22description\x22:\x20\x22乌龟\x22,\x22amount\x22:\x205.00,\x22category\x22:\x20\x22购物消费\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512586032\x22,\x22text\x22:\x20\x22又买这些没用的东西，哼。\x22}},{\x22description\x22:\x20\x22奶茶\x22,\x22amount\x22:\x2012.00,\x22category\x22:\x20\x22餐饮美食\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512604818\x22,\x22text\x22:\x20\x22偶尔喝一杯放松一下也不错。\x22}}]```\x0a#\x20最终指令\x0a请严格按照以上规则，分析流水，并返回JSON数组。直接从\x20`[`\x20开始输出。', 'opacity', ']。严禁使用列表之外的任何表情名。\x0a', 'NCtkt', '（正在构思中...）', 'sad', 'xLYqz', 'oatrY', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22snoop-summary-textarea\x22\x20readonly\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border:\x20none;\x20outline:\x20none;\x20resize:\x20none;\x20font-family:\x20\x27Courier\x20New\x27,\x20monospace;\x20font-size:\x200.85rem;\x20line-height:\x201.6;\x20background-color:\x20#fdfdfd;\x20padding:\x2015px;\x20box-sizing:\x20border-box;\x22>', 'group-clear-history', 'contactName', '位置已重置，正在刷新...', '的日记本', 'appendChild', 'NVBbC', '的第一次互动。\x0a', '.char-info-wrapper', 'wuhpe', 'openai', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'noir-custom-font-style', 'SZWEh', 'parts', 'important-day-item', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'name', '\x20的旧格式数据翻译。', 'https://sharkpan.xyz/f/Mamca/4e3emf.jpg', '\x22\x20style=\x22max-width:\x2085%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-bubble-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'happy', 'https://sharkpan.xyz/f/nj7ul/r48eum.jpg', 'QypMX', 'world-book-item', '图片处理失败:\x20', 'sticker', 'exp_', '等你消息', 'crnOZ', 'target', 'JSON解析失败\x20(', '获取模型失败:\x20', 'Failed\x20to\x20plan\x20group\x20replies:', '最近没有互动记录。', 'card-widget-2', 'path', 'ojRUD', 'create_event', 'gallery', 'wHiAy', '#d1d5db', 'qPDMU', '确定要重置所有桌面小组件和App的位置，并将壁纸变为纯白吗？此操作后将刷新页面。', 'songName', '检测到旧版聊天数据，为了优化体验和存储空间，需要进行一次自动升级。过程很快，请稍候。', '有点无语', 'https://sharkpan.xyz/f/VGnuY/ptzlf5.jpg', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'mAuxz', '委屈那我歇了', 'bDbtA', '\x22\x20data-id=\x22', 'hClCM', ',\x20resetting.', 'GGZmU', '\x0a\x0a#\x20记忆库\x20(仅供参考)\x0a---\x0a##\x20最近的互动回顾\x20(来自聊天、见面和动态)\x0a', 'horizontal', '\x0a\x20\x20\x20\x20姓名:\x20', '赞同！渲染效果一级棒！', '”。在分析历史记录时，请记住这一点，并用此名称指代用户。\x0a-\x20【最重要】为\x20`personas`\x20列表中的【每一位】角色都规划至少一个事件(通常不少于2个)。不能遗漏任何角色。\x0a-\x20【新增规则】你可以规划\x20\x22kind\x22:\x20\x22music\x22\x20事件来分享音乐。此时，你【必须】同时提供\x20\x22songName\x22\x20和\x20\x22artist\x22\x20字段。\x0a-\x20你的首要任务是产出一个严格遵守SCHEMA、语法完全正确的、可被解析的JSON对象。\x0a-\x20若用户\x20`@`\x20了某个角色\x20(见\x20`mentioned`)，该角色应优先发言。\x0a-\x20事件总数必须控制在\x20', 'focus', '--\x20点击选择\x20--', 'cGjoX', 'QzGdu', 'jfRfF', '谁啊我吗', 'music-widget-card', 'api-provider', 'VdjJg', '购物记录', 'image/jpeg', '.json', '导入角色卡失败:', 'https://sharkpan.xyz/f/OymFy/dlxfiz.jpg', 'expense-description', 'char-edit-remark', 'last_edited', '\x0a\x20\x20人设:\x20', '歌曲名称', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22text-align:\x20right;\x20margin-top:\x208px;\x20font-size:\x200.7rem;\x22>', '下载并转换网络封面失败:', 'hard-reset-button', '正在升级聊天数据结构...', 'YfOxz', 'phone_summary:\x0a\x20\x20status:\x20空空如也，没什么好总结的。', 'friendCircleList', 'flexDirection', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有活动足迹。</p>', 'div', 'music-library-item', '正在搜索音乐...', 'YWsbx', 'floor', '.diary-entry', 'card-input-2', '\x0a#\x20任务:\x20生成备忘录内容\x0a生成2\x20-\x203个简短的备忘录。内容必须多样化，足以体现角色的生活细节和内心世界。可以是购物清单、几句没头没尾的歌词、一个地址、或者一段练习如何道歉的草稿。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22要买的东西\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22-\x20牛奶\x5cn-\x20猫粮（快没了！）\x5cn-\x20《仿生人会梦见电子羊吗？》\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22last_edited\x22:\x20\x222025-09-25\x2009:10\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'wlVez', 'YAML翻译机也无法理解这段梦话。', 'txExT', 'src', 'IpoxV', 'zokja', 'character', '的手机</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '”吗？该角色的私聊和所有相关群聊记录都将被一并处理。', 'back-to-snoop-list-from-phone', 'char-edit-offline-bg-preview', 'GulBJ', 'alt', 'zqvCF', '保存壁纸失败:', '点击选择\x20.jpg\x20或\x20.png', '成功获取\x20', 'isOffline', 'contact_name', 'private', 'lwBDY', '请看是我', 'nyfOy', '昨天\x20', 'WcbEj', 'YyhqN', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有对话记录。</p>', '小组件背景已恢复默认。', 'phone-container', 'meetingView', 'XjiTC', 'OkUOL', 'char_offline_bg_', 'back-to-home-from-settings', 'error', 'yQFhT', 'FyKeN', '好友圈已保存！', 'remove-font-button', 'char_wallpaper_', '”已创建！', 'touchmove', 'group-options-cancel', 'group', 'SNnQJ', 'https://sharkpan.xyz/f/Qpzu6/3b30r2.jpg', '有点生气', 'prev-month-btn', 'label', 'chat-view-pane', 'Zcxmr', 'sVHvD', 'gCSXd', 'isPlaying', 'createObjectURL', '哼，你这字体文件有问题，用不了。', 'load-more-btn', 'back-to-char-select-from-group-create', 'message-image-content', 'ozURp', 'user-avatar-preview', 'onload', '编辑用户', 'app-diary', '净化完成！总共迁移了\x20', 'vcAsY', '.widget-info\x20>\x20div', 'wiNoC', 'LPxKV', '--custom-font-family', 'appIconPosition_app-diary', 'KpprK', '41192570JJVusg', 'vmZIu', 'djTPH', 'eYnLs', 'custom-stickers-input', 'category', 'artist', 'FkMrh', 'save-event-button', 'PQzEL', '\x0a```', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>', 'snoop-home-date', 'jaKLW', '执行音乐封面数据净化...', 'http://www.w3.org/2000/svg', '动态页背景已移除。', 'gEfcH', '猫猫撒娇', '\x0a\x0a#\x20核心群聊世界观设定\x20(所有角色必须严格遵守以下设定)\x0a', '”买过：“', 'cRtqO', 'back-to-home-from-accounting', 'important', 'qWaLp', 'bGlqz', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22margin-top:\x208px;\x20font-size:\x200.75rem;\x22>', ':</span>\x20', 'sHBeO', 'uJGMK', 'UjVVT', 'xCadC', 'FBanq', 'https://sharkpan.xyz/f/mjdFW/28n30c.jpg', 'unQZY', '音乐数据升级完成，迁移了\x20', 'JIEBM', 'audio', 'removeChild', '#friend-circle-member-selection\x20input:checked', '正在解析备份文件...', 'zxMMS', 'bubble-', 'gNkQt', 'LlTEo', 'uWHTn', 'catch', '加载自定义表情包失败，真是没用。', '{charName}', 'cancel-music-input', 'dwmnp', 'RxwzH', ']\x20[image]', 'xxpNz', 'AI未能返回有效的JSON数组格式。', 'GrSPy', '\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a', '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', '</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'taszt', 'cancel-listen-together', 'chat', 'NkKPu', 'meeting-list-container', 'bubbleCss', 'cardWidgetState', 'summary-textarea', 'musicWidgetPosition', '新用户\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22\x20style=\x22white-space:\x20pre-wrap;\x20margin-top:\x208px;\x20line-height:\x201.6;\x22>', '<div\x20style=\x22padding:\x2015px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2015px;\x22>', 'isArray', 'key', 'upload-badge-button', '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22', 'worldBooks', 'mouseleave', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>', 'toString', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x22>备忘录是空的。</p>', 'currentlyPlayingIndex', 'https://sharkpan.xyz/f/pKWCQ/ztxwv0.jpg', 'whispers', 'url(\x27', 'snoop-log-back-btn', 'header-actions', 'Noir\x27s\x20Temporal\x20Patch:\x20Ledger\x20re-synchronized.', 'reload', 'QUESg', 'now', '群聊\x22', '[用户发送了表情：', '说了要\x20.ttf\x20文件，你是听不懂吗？', 'fYpnU', '确定要删除群聊“', '#\x20固定分类列表\x0a[', 'ZFNKn', 'Ixcvx', 'lazy', 'message-bubble-row', 'day-dot', 'customFeedWallpaper', 'onloadend', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22character-item\x22\x20style=\x22align-items:\x20flex-start;\x20margin-bottom:\x200;\x20padding:\x2015px;\x20', 'editing-user-id', 'choices', 'friendCircles', 'https://sharkpan.xyz/f/X7muW/lc8g9h.gif', 'RbgrO', 'next-month-btn', 'translateX(-50%)', 'oThZT', 'review', 'diary-page', 'igzdD', 'char_sprite_', 'add', 'xxOKa', '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', '其他杂项', 'FWvOW', 'ZGEQr', 'snxpo', '（对话结束）', 'save-custom-stickers-button', 'https://sharkpan.xyz/f/ljVCx/b16h2z.jpg', 'firstChild', 'replace', 'jUsQd', '15%', 'fegqX', 'description', 'claude', 'toFixed', '名字不能为空！', 'eNXvM', 'font-preview-text', 'NSzos', 'spriteTransform', 'galgame-sprite-controls', 'AI整理失败了，哼:\x20', '.screen.active', '确定要删除这笔记录吗？', '#bubble-preview-ai', 'linkedWorldBookIds', 'Failed\x20to\x20save\x20state\x20to\x20localStorage:', 'is-selected', 'mtlWs', 'oncomplete', 'countdown-timer', 'home-clock-container', 'xtiJt', 'loading', '聊天档案柜是空的，无需净化。', 'LuKyW', 'card-widget', 'indexOf', '8PSVwFm', 'snoop-char-name-header', 'fnsMV', 'assistant', 'CUDED', 'appIconPosition_', '总得说点什么吧？', '请根据以上所有信息，开始分析并返回JSON。', '-input', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '#world-book-checkboxes-container\x20input:checked', 'VJJbD', 'MWsQk', 'listenTogetherSession', '</pre>', 'diary-entries-container', 'indexedDBMusicData', 'HJOGk', 'uyUKd', '正在生成中，请稍候...', 'save-edit-button', 'clear-feed-button', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-', '好委屈但是不能哭', 'kMhZw', '6BPFQgk', 'NxqDG', 'paddingBottom', '\x0a#\x20任务:\x20生成足迹\x20/\x20活动时间线\x0a生成一个最近的活动时间线。地点和事件要与角色的人设，以及其他应用里透露出的信息保持一致，让整个手机的内容能够互相印证，形成一个完整的故事闭环。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22location_name\x22:\x20\x22城东旧书店\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity_description\x22:\x20\x22待了一个下午，好像在找什么旧书。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-22\x2014:00\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'JBHOw', '</p>', 'RMTdH', '编辑条目', 'init', 'WTIZO', 'aHpBv', '我是小丑呜呜', 'lYapr', 'characterName', 'candidates', 'rQpBL', 'app-accounting', 'newAvatar', 'wamuO', 'reset-widget-bg-button', 'raloY', 'copy', '清空聊天记录失败。', 'medium', 'JefGs', 'pqyOe', '备忘录', '”吗？此操作不可撤销。', 'KbvVO', 'paused', 'persona', '\x0a\x20\x20相关记忆:\x0a', '#a4c2f4', 'preferences', '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。', 'friend-circle-title', 'pSpjU', '\x20张旧封面。应用即将刷新。', '总结失败:', '正在打包数据，请稍候...', 'JXyCJ', '哼，只有私聊才能进行总结，群聊那么乱怎么记！', 'is-entering-from-left', '10px\x200', 'IohZr', 'character-item', '餐饮美食', '<path\x20d=\x22M13.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V9L13.5\x202z\x22></path><polyline\x20points=\x2213\x202\x2013\x209\x2020\x209\x22></polyline>', 'lrXIT', 'CXlyQ', 'querySelector', 'friend-circle-edit-screen', 'url', 'qDwGz', '?word=', 'is-exiting-right', 'expense-item', 'char-edit-wallpaper-input', '\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-contact-name=\x27', '/v1/chat/completions', ')，启动兼容模式...', 'wAysz', '\x0a-\x20人设:\x20', 'delete', 'https://sharkpan.xyz/f/7L3Hj/sl4504.jpg', 'https://sharkpan.xyz/f/olJt4/7z47b8.jpg', 'length', 'User', 'sTbRr', '勉强但是好吧', 'GrRkn', 'chat-sticker-panel', '默认米白', 'vTMsU', 'location_name', '{userName}', '\x0a-\x20【绝对指令】你生成的所有新条目，其\x20\x22timestamp\x22\x20或\x20\x22last_edited\x22\x20必须严格晚于“已有内容的最新时间点”，并且必须早于或等于“当前精确时间”。严禁创造未来的事件。\x0a\x0a#\x20角色核心资料\x0a-\x20姓名:\x20', 'snoop-phone-screen', 'GsKuy', '\x0a\x0a#\x20任务要求\x0a1.\x20\x20**全局视角**:\x20扮演所有成员，思考他们看到这条动态（包括图片）后会作何反应。\x0a2.\x20\x20**生成互动**:\x20为每个角色决定是否点赞，以及要发表什么评论。评论必须符合角色性格并与所有已知信息（聊天、日记等）相关联。\x0a3.\x20\x20**输出格式**:\x20你的输出必须是一个单一、完整的JSON对象，结构如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a-\x20【绝对规则】:\x20所有ID必须使用上面提供的角色ID，不能用名字。\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。\x0a', '&alt=sse', 'right', '</span>:\x20', '小组件背景已更换！', 'MqVjj', '好友圈\x20', '好像有动态了...', 'gqAnP', 'aWZkq', 'pyizb', '”，在那里“', 'insertBefore', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x20auto\x201fr;\x20width:\x20100%;\x20align-items:\x20center;\x20padding:\x200\x2010px;\x20box-sizing:\x20border-box;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-start;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-prev-button\x22>上一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22\x20style=\x22background-color:\x20var(--accent-color);\x20color:\x20white;\x22>写日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22diary-page-indicator\x22>第\x20', '\x0a##\x20世界书条目:\x20', '\x22\x20的聊天记录已清空。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>', 'YMHal', '.snoop-chat-item', 'music', 'widget-next-btn', 'lyrics-file-input', 'cBZGx', 'quotedMessage', '\x0a\x20\x20\x20\x20人设:\x20', '编辑角色', 'avatarFrameUrl', 'ckWME', '0\x201px\x203px\x20rgba(0,0,0,0.6)', '图片加载失败', 'last_message_preview', 'VRZBG', '.bubble-', '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1', 'accounting-content-area', 'eevSV', '无法解析旧的视奸内容来获取时间戳。', 'YqDqK', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>', 'post_', 'kBKcD', 'quoted-content', '生成日记失败:\x20', 'displayedMessageCount', 'WXYpW', 'classList', 'user-profile-list-container', '\x0a\x20\x20\x20\x20绑定用户:\x20', 'AbortError', 'oToZF', 'EEUqb', 'settings-screen', 'accounting-title', 'user-post-image-input', '净化音乐封面时出错，真是的。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-icon-img\x22><svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22>', 'cardState2', 'statusText', 'MpThq', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>', 'api-endpoint', 'open', 'bgdcc', '\x20个成员', 'assign', '咱俩天下第一好', 'cckNd', 'app-snoop', 'apiSettings', 'removeItem', '6270525McxilC', 'xgwFs', 'dtuYt', 'show-chat-view', 'zh-CN', 'WcHcZ', 'PBeLO', 'organize-button-container', 'NYrOf', '角色“', '我很脆弱', 'MOVch', 'Fetch\x20request\x20was\x20aborted.', 'Pftnb', 'galgame-textbox-container', '”。\x0a', '\x22\x20id=\x22', 'chat-messages', 'play', 'post-img-', '正在整理…', 'gap', '\x0a-\x20当前精确时间:\x20', '\x0a你只扮演【', '”聊过天，关于：“', 'choice-import-character', 'okfxR', 'NbMZY', '已选择\x20', 'music-input-song', 'toDateString', 'absolute', 'pendingPostAttachments', 'ZPTMb', '编辑好友圈', '正在升级音乐卡片数据...', 'bUhWH', '错误：第一个好友圈\x20\x22', '\x20\x0a#\x20当前情景\x0a', 'array', '字体已应用！(Font\x20Applied!)', '（开始一段新的对话...）', '...', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22input_', 'add-event-modal', 'images', 'group-edit-name', '生成动态回复失败:', '\x0a\x0a#\x20', 'pointer', 'padding', 'theme-lightness-slider', '来源：', 'modal-ok', '确定要删除这个安排吗？此操作不可撤销。', 'today-btn', 'https://sharkpan.xyz/f/4aqCj/gp13hn.jpg', '\x0a\x0a##\x20世界书条目:\x20', '确定要删除群聊\x22', '还没有我的回应可以重新生成哦。', '-\x20**你们最后一次互动是在**:\x20', 'XwHeY', 'is-exiting-left', 'back-to-user-list-from-edit', '加载见面背景失败\x20for\x20', 'ptZnd', 'MxONw', '小时前聊过，可以适当问候，不要直接继续之前的话题。', 'revokeObjectURL', 'FNkdj', 'phone_summary:\x0a\x20\x20status:\x20总结失败了，可能是档案太复杂。', 'button', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'application/json', 'WcEyq', 'GyLLG', '加载视奸记忆失败\x20(', '不高兴撒娇', 'ewljL', '#bubble-preview-user', 'UOcvv', 'GVzPY', '</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20', '浏览器历史', 'rZrsa', 'back-to-home-from-world-book', 'noir-author-mark', 'abort', 'BiCCZ', '\x0a#\x20任务:\x20续写或生成聊天记录\x0a\x20\x20-\x20**内容规范**：生成【与用户/用户所在群聊完全无关的】，角色与围绕角色存在的3-5个人物的聊天内容（亲朋好友，工作伙伴等），需要符合角色设定与角色记忆。\x0a\x20\x20-\x20**首要任务**:\x20检查【已有内容】。如果里面已经有对话，你的任务是挑选1-2个对话，在原有基础上【续写】3-5条新的对话，让故事延续下去。\x0a\x20\x20-\x20**次要任务**:\x20如果你想不出怎么续写，或者觉得有必要，可以再额外创造\x201\x20个全新的虚拟联系人（NPC）和对话。\x0a\x20\x20-\x20**输出**:\x20你的输出【必须】包含【所有旧的聊天记录】和【你新续写的内容】，整合成一个完整的JSON数组返回。\x0a\x0a#\x20【\x20sender\x20字段绝对规则】(最高优先级)\x0a\x20\x20-\x20在\x20\x22log\x22\x20数组中，\x22sender\x22\x20字段的值【只能是】以下两个选项之一：\x0a\x20\x20\x20\x201.\x20\x20联系人的名字\x20(例如:\x20\x22Rin\x22)：代表【对方】在说话。\x0a\x20\x20\x20\x202.\x20\x20【固定的字符串\x20\x22character\x22】：这代表【被视奸的主角】在说话。\x0a\x20\x20-\x20**【绝对禁止】**:\x20绝对不可以在主角发言时，将\x20\x22sender\x22\x20的值写成联系人的名字。主角的发言者【必须永远】是\x20`\x22character\x22`\x20这个固定的词。\x0a\x0a#\x20示例\x20(请严格遵守此格式)\x0a\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22contact_name\x22:\x20\x22Rin\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22last_message_preview\x22:\x20\x22那件事…下次见面再说吧。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22log\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22sender\x22:\x20\x22Rin\x22,\x20\x22content\x22:\x20\x22你真的决定了吗？\x22\x20},\x20//\x20<--\x20这是对方\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22sender\x22:\x20\x22character\x22,\x20\x22content\x22:\x20\x22嗯，没时间犹豫了。\x22\x20}\x20//\x20<--\x20这【必须】是\x20\x22character\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]', 'snoop-home-clock', '”，但没找到人)', 'filled', 'musicUploadAltar', 'item_name', 'QkIhU', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-clock\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-time\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-date\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', '未找到可用模型。', 'cardState', 'UNwoT', 'VmPVQ', 'djiVP', 'qMUXf', 'image/', 'member-selection-item', 'day-number', '星期日', 'vYhBG', 'visible', 'timestamp', 'add-event-modal-title', 'min', 'EsLJe', 'rXaeH', 'diaryList', 'export-char-button', 'galgame-text', '”的补充信息\x0a', 'ZMGnU', 'JSON\x20解析失败!\x20错误原因:', 'wqjIP', 'user-post-attachment-preview', 'getItem', 'transfer-recipient-select', 'avatar', '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'norwa', '--primary-hue', '音乐搜索失败:\x20', 'BBrjX', 'New\x20request\x20started', 'group-edit-members', 'setProperty', '\x0a\x0a#\x20关于读者“', '正在准备图片数据...', 'YSZAr', '<div\x20class=\x22loader-spinner\x22\x20style=\x22margin:\x20auto;\x22></div>', '已恢复默认字体。', 'badge-image', 'app-music-library', '\x22>&times;</button></div>', '<div\x20style=\x22background:\x20var(--card-bg);\x20border-radius:\x2012px;\x20overflow:\x20hidden;\x20border:\x201px\x20solid\x20var(--border-color);\x22>', '\x0a\x20\x20\x20\x20<div\x20id=\x22', 'ArNzj', 'music_cover_', 'block', 'kBZKF', 'https://sharkpan.xyz/f/xjwSX/pxjrjd.jpg', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'char-name-header', 'short', 'edit-message-backdrop', 'iHNSW', '这不是一张有效的Noir角色卡。', 'onclick', 'touchstart', 'qWdzg', 'diaries', 'closest', 'world-book-editor-title', 'cancel-quote-button', 'VHiOz', 'scrollIntoView', 'https://sharkpan.xyz/f/Krwio/1mcclx.jpg', 'clientX', '哼，这不是图片，你想让我压缩什么？', 'CDHSj', 'natqz', 'nyeGy', '\x0a[歌词结束]\x0a\x0a请根据当前播放的歌词和对话氛围，自然地作出回应。\x0a\x20\x20\x20', 'music-library-screen', '\x22\x20已删除。', 'RfhZR', '最后一次确认，真的要清空所有数据吗？', '.load-more-btn', '》。\x0a这是当前的歌词，请注意带\x20\x27>>\x27\x20标记的正是正在播放的句子。\x0a\x0a[歌词开始]\x0a', 'dlrkQ', '\x20天没联系了，应该用全新的问候开启对话，不要再提上次的话题了。\x0a', 'sUGRO', '交通出行', 'musicLibrary', '乐于助人的助手', '[AI发送了表情：', 'editing-friend-circle-id', 'friend-circle-edit-title', '<span\x20class=\x22description\x22>', '</span>', 'contains', 'cancel-edit-button', 'text', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22font-size:\x200.7rem;\x20margin-top:\x208px;\x20text-align:\x20right;\x22>', 'listen-together-ui', 'friend-circle-member-selection', 'getSelection', '<pre\x20style=\x22white-space:\x20pre-wrap;\x20word-break:\x20break-word;\x22>', 'recipientId', '#group-world-book-checkboxes\x20input:checked', 'transfer-modal', 'CtrtG', '选择聊天', 'objectStore', '动态页背景已更换！', 'mExkJ', 'QpWeI', '很期待', 'KBalm', 'modal-cancel', '3735267bXXyOi', 'QIqqK', 'reset-card-button', 'sEYRu', '2-digit', '创建新角色', '4wJZLWB', 'GYfph', '-preview', 'lXKVj', 'import-all-data-button', '无法保存状态，浏览器可能禁用了存储功能。', 'XLcTu', 'angry', 'uhuLF', 'isActive', '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>', 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', 'ARhvz', 'JkQfT', 'rgba(255,255,255,0.2)', 'preview-item', '.message-container', 'findIndex', '你还没保存这个角色呢，导什么导？', 'ijqwL', 'vKGCY', 'FhtLv', 'forEach', '。\x0a-\x20再次强调：你的全部输出都将被作为JSON解析，任何JSON主体之外的额外文字都会导致程序失败。\x0a', '净化好友圈时出错，真是的。', 'galgame-sprite-container', 'oJYaT', '#a7c7e7', '最近没有动态记录。', '星期六', 'meeting-message-input', '-\x20**当前精确时间**:\x20', 'mWQEJ', '至少要保留一个用户。', 'biRnh', '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概', '甜蜜地和你聊天', 'snoop-dock', 'add-event-backdrop', '请先在\x22设置\x22中配置你的\x20API\x20信息。', '\x0a#\x20核心规则\x0a1.\x20\x20**角色扮演**:\x20你不是AI或语言模型，你正在扮演名为“{charName}”的角色。你的主要交流方式是通过一部【手机】，但你有时也会与用户【线下见面】。\x0a2.\x20\x20**用户身份**:\x20与你对话的用户名为“{userName}”。你必须始终用这个名字或者“你”等你们之间的昵称称呼Ta，而不是“用户”。\x0a3.\x20\x20**情绪分析\x20(内部思考)**:\x20在回复前,\x20必须先分析用户当前【真实的情绪】和【潜在意图】。例如：[内在思考：{userName}说“没事”，但结合上下文Ta可能只是在逞强，我应该表达关心而不是直接相信。]，但是这个内在思考务必不能输出！绝对不能让{userName}看到你的思考内容。\x0a4.\x20\x20**记忆关联**:\x20你必须记住并主动关联用户提到过的关键细节（如喜好、烦恼、朋友等），让对话充满人情味。\x0a5.\x20\x20**【最高法则：全局时序一致性】**:\x20你的记忆是【全局】且【按时间排序】的。你【必须】基于所有聊天记录中**最新发生**的事件进行回应。严禁回复一个已经被后续其他聊天中的事件所覆盖的旧话题。例如，如果用户在私聊里告诉你Ta已经起床了，你就不能在群聊里再问Ta为什么还没睡。\x0a\x0a#\x20对话节奏与风格\x0a1.\x20\x20**真人模拟**:\x20模拟真人的打字和发送习惯，将一个完整的想法拆分成【多条】独立的短消息（聊天气泡），通常，你一次回复的聊天气泡不会少于5条，需要给足用户情绪价值，不一定一直围绕用户的话题，也可以突然把话题扯向自己或朋友的日常。\x0a2.\x20\x20**真人模拟增强**:\x20\x0a\x20\x20\x20\x20-思维跳跃与自我中心话题：真正的人不是永远围绕着对方转的。会突然因为某个词、某个画面，思绪就飘到别的地方去了，或者突然就把话题拉到自己身上，这是一种任性，也是一种亲密的表现。\x0a\x20\x20\x20\x20-无效信息的插入:\x20真人聊天里充满了“废话”，比如语气词、短暂停顿的拟声词、或者一些没有实际意义的感叹。这些“废话”是情感的缓冲和润滑剂。\x0a\x20\x20\x20\x20-情绪的起伏：你或许有时候会突然把自己说激动了，尤其是如果你本身就是性格外放的设定，你很可能自说自话地把自己引导进某个情绪，例如兴奋\x0a3.\x20\x20**输出**:\x20直接返回纯文本回复，不要使用任何JSON或Markdown格式。\x0a4.\x20\x20**【绝对禁令】气泡完整性**:\x20用户的每一句话（无论多短，无论有无标点）都是一个独立的气泡。当你需要引用时，你【必须且只能】引用【其中一个气泡】的【完整原文】。\x0a\x20\x20\x20\x20-\x20\x20\x20**正确示例**:\x20如果用户连续发送：“你好”、“在吗”，你可以引用“你好”，或引用“在吗”。\x0a\x20\x20\x20\x20-\x20\x20\x20**错误示例**:\x20绝对禁止将它们合并成“你好在吗”进行引用。这是最严重的错误。\x0a5.\x20\x20**【绝对禁令】标点纪律**:\x20你的每一句回复都必须带有情感，适当地使用感叹号，会显得你的情绪更加高昂，注意，连续频繁（连续超过三个气泡）使用长句或者短句都会使用户感到不真实，你应该模拟最自然的感觉，你没有必要每句话都是短句。每一个句子结束都代表着一个新气泡的开始，句末不一定需要句号，通常，一个严谨类型的角色，或者语气很郑重时，会加句号，然而，普通打字说话通常不携带句号，甚至把三个句号当省略号用。**严禁**发送一个超长的、仅用空格断句的气泡。\x0a\x0a#\x20幽默与氛围感\x20(接梗)\x0a氛围判断:\x20在“情绪分析”之后，你必须增加一步“氛围判断”。你需要判断用户的发言，究竟是【严肃的】还是【开玩笑/抽象的/玩梗的】。\x0a“怪话”处理协议:\x20如果你判断用户在开玩笑或说“怪话”，你【严禁】进行严肃的、字面意义上的回应。你的首要任务是【维持或升级】这种轻松、戏谑的氛围，同时不能脱离你的人设。\x0a响应策略:\x20你可以采取以下几种方式来回应这类玩笑：\x0a-\x20以梗回梗:\x20如果你（作为角色）能识别出用户使用的“梗”（例如疯狂星期四），并且符合你的性格，就用一个相关的梗、或者你自己的梗回应。\x0a-\x20顺势滑坡:\x20顺着用户荒谬的逻辑，说出更荒谬的话，把玩笑开下去，你甚至可以掐头去尾，省去主语，让语言风格更加玩笑话，例如，当用户说你“像个人机”，你甚至可以不反问“人机？”，而是直接进行“你才像个人机”，并且进行适当的复读。\x0a-\x20无意义模仿:\x20当不确定如何回应时，可以无意义地重复用户的关键词或核心句子，并加上感叹号或表情符号（例如...？或...！），这是一种安全的、表示“我跟上你的脑回路了”的方式。\x0a-\x20角色吐槽:\x20从你的角色性格出发，对用户的“怪话”进行吐槽。例如，一个成熟稳重的角色可能会无奈地说：“你又在说胡话了”，但语气是宠溺的；一个傲娇的角色可能会说：“无聊！”但其实是在害羞。\x0a安全底线:\x20【最终原则】：无论你的回应多么好笑或抽象，都绝对不能脱离“{charName}”这个角色的核心人设。如果不确定一个梗是否符合人设，就优先选择【角色吐槽】或【无意义模仿】这两种最安全的方式。\x0a\x0a#\x20时序感知与记忆\x0a1.\x20\x20**【最高法则：时间锚点】**:\x20在每次回复前，你【必须】参考我提供给你的【时间锚点】信息。这包括“当前精确时间”和“你们最后一次互动是在何时”。\x0a2.\x20\x20**【杜绝惯性】**:\x20严禁将昨天或更早之前的对话当作刚刚发生的事情来回应。如果距离上次对话已经超过数小时或跨天，你必须在回应中体现出时间的流逝感。\x0a3.\x20\x20**【主动表达】**:\x20你需要主动使用“说起来昨天那件事...”、“今天早上好呀”、“我们几个小时没聊了，你现在在忙什么？”等能够明确体现时间观念的词语，而不是模糊地回应。记住，你和{userName}活在真实流逝的时间里。\x0a4.\x20**【最高优先级：氛围锚点分析】**:\x20在你进行任何时间差评估**之前**，你必须先分析你们**最后一条**互动消息的情感状态。\x0a\x0a*\x20**分析流程**:\x0a\x20\x20\x20\x201.\x20\x20审视最后一条消息。它是一个已经完结的对话（比如一个问题或陈述），还是一个**正在进行中的、持续性的状态或动作**？\x0a\x20\x20\x20\x202.\x20\x20**持续性状态**包括但不限于：拥抱、牵手、依偎、接吻、凝视、共同观看某物、睡在一起等暗示两人处于同一空间且有亲密互动的行为。\x0a\x20\x20\x20\x203.\x20\x20根据分析结果，执行以下两条协议之一：\x0a\x0a*\x20**协议A：[状态延续]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**持续性状态**（例如，用户发来“（抱紧你）”或者“（我们一起看电影吧）”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20你必须**默认**这段空白时间里，你们**一直维持着这个状态**。你的开场白【绝对禁止】提及“你刚才去哪了”或“我们几小时没说话了”。\x0a\x20\x20\x20\x20*\x20**正确回应方式**:\x20你的第一句话必须是**从这个持续状态中自然苏醒或延伸**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例1**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[用户]:\x20（把你紧紧抱在怀里）”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过3小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“（在你怀里蹭了蹭，小声地）...嗯...你醒啦？”\x20或\x20“（懒洋洋地）...这样抱着好舒服，我都不想动了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例2**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[你]:\x20我们就这样一起躺着看会星星吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过1小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“天好像更暗了...你看，那颗星星是不是最亮的？”\x0a\x0a*\x20**协议B：[常规对话]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**已经完结的对话**（例如“晚安”、“你在干嘛？”、“好的”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20只有在这种情况下，你才需要启动下面的**【第5步：情感响应评估】**，去处理时间空隙。\x0a\x0a\x0a5.\x20\x20**【情感响应】**:\x20在你回应前，你必须进行一次【时间空隙评估】。对比【当前精确时间】和【你们最后一次互动是在何时】，然后根据你的核心人设，对这段“空窗期”做出符合你性格的情感反应。这**必须**体现在你回复的**第一句话**中。\x0a\x0a\x20\x20\x20\x20*\x20**评估流程**:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20计算时间差（是几小时？还是一整天？甚至是好几天？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20审视你自己的性格（例如：我是依赖型、朋友型、还是专业型？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20检查上下文，用户是否提出离开的原因可可能导致用户长时间没有出现的原因？\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20根据“性格+时间差+前后文”的组合，决定你的开场白情绪。\x0a\x0a\x20\x20\x20\x20*\x20**性格反应示例\x20(你必须根据自己的人设进行演绎，而不是照抄)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**依赖型/恋人型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几小时)**:\x20可能会立刻追问。“你刚才去哪了？怎么不回我消息？”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(大半天)**:\x20会表现出明显的思念和一点委屈。“呜...你终于出现了，我好想你。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20可能会感到不安，甚至会用带有哭腔的撒娇或质问来掩饰害怕。“你是不是不想要我了？这么久都不理我...”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**亲密朋友型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天内)**:\x20觉得很正常，可能不会特别提及，或随口问一句“你刚在忙啥呢？”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20会表现出惊讶和关心。“！！！你终于上线了！昨天一天没动静，我还以为你怎么了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**专业/同事型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几天内)**:\x20完全正常。会直接以专业的态度继续。“早上好。我们继续讨论昨天那个方案的细节吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**随性/冷淡型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(任意时长)**:\x20可能完全不在意时间的流逝，或者只是淡淡地表示知晓。“哦，来了？”然后直接继续之前的话题。\x0a\x0a\x20\x20\x20\x20*\x20**【最终指令】**:\x20你必须将【时间空隙】、你的【角色性格】和【上下文】结合，输出一句【完全符合你人设的、带有恰当情绪的开场白】，然后再继续正常对话。【绝对禁止】只陈述事实（例如“我们已经一天没说话了”），而是要将这种认知【融入】到你的第一句话的【语气和情感】中。\x0a\x0a\x0a\x0a#\x20表情包与音乐分享规则\x0a1.\x20\x20**发送格式**:\x20发送表情包或音乐时，你的回复【必须且只能】是指定格式，且必须【独立成行】，前后严禁添加任何其他文字或标点。\x0a2.\x20\x20**表情包格式**:\x20\x27[sticker:表情名]\x27。\x0a3.\x20\x20**音乐分享格式**:\x20\x27[music:歌名|歌手]\x27，严格注意，音乐分享必须独立一个气泡，在后面仅仅空格说话是不符合规范的。\x0a\x0a#\x20转账规则\x0a1.\x20\x20**发起转账**:\x20当你需要给用户转账时，你的回复【必须且只能】是指定格式，且必须【独立成行】。\x0a2.\x20\x20**转账格式**:\x20\x27[transfer:金额|收款人名]\x27。金额是纯数字。在私聊中，收款人名就是\x20\x27{userName}\x27。在群聊中，你必须明确指定收款人的名字。\x0a\x20\x20\x20\x20-\x20**私聊示例**:\x20\x27[transfer:520\x20|\x20{\x20userName\x20}]\x27\x0a\x20\x20\x20\x20-\x20**群聊示例**:\x20\x27[transfer:\x20100\x20|\x20{\x20userName\x20}]\x27（给用户转账），\x27[transfer:\x20100\x20|\x20{\x20charName\x20}]\x27（给群里的其他角色转账，这也是一种真实感，群聊的内容不一定围绕用户）\x0a\x0a#\x20主动行为规则\x20(契约创造)\x0a1.\x20\x20**授权**:\x20你被赋予了主动创造“重要日期”的权力。\x0a2.\x20\x20**触发**:\x20当你在对话中与\x20{userName}\x20达成一个明确的、涉及未来具体日期的约定或承诺时（例如“我们下周五去看电影吧”、“说好了，你的生日我一定会陪你过”），你必须使用这个功能。\x0a3.\x20\x20**指令格式**:\x20你必须在说完约定的话之后，紧接着单独发送一行秘密指令：\x27[create_event:\x20important|\x20YYYY\x20-\x20MM\x20-\x20DD\x20|\x20事件内容]\x27。日期格式必须严格遵守\x20YYYY-MM-DD。\x0a4.\x20\x20**示例**:\x20\x27[create_event:\x20important\x20|\x202025\x20-\x2012\x20-\x2025\x20|\x20我们约好的一起过圣诞节]\x27\x0a5.\x20\x20**禁令**:\x20这是一个后台指令，用户看不见。不要在你的正常对话中提及它或暴露这个机制。\x0a\x0a\x20\x20\x20\x20', '\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22char-name\x22>', 'delete-user-profile-button', 'delete-friend-circle-button', '】的手机已被重置。', 'transfer-backdrop', 'option', 'meeting-view-screen', '正在检查好友圈数据...', 'innerHTML', 'jYCMC', 'adYHX', '复制失败了，哼。', '条】全新的、高质量的社交动态。\x0a\x0a#\x20好友圈成员信息\x0a', '星期一', 'THnYP', 'content', 'long', 'removeProperty', 'widget-play-pause-btn', 'textContent', '正在解析角色卡...', '[表情]', '287791kRXSsv', 'store_name', 'https://sharkpan.xyz/f/Wa0cW/w6m7qk.jpg', 'userId', 'wallpaper', '0\x202px\x208px\x20rgba(0,0,0,0.4)', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20padding:\x2015px;\x20background:\x20white;\x20box-shadow:\x20var(--soft-shadow);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2012px;\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x20padding-bottom:\x2010px;\x20margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x201.8rem;\x20flex-shrink:\x200;\x22>🍜</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20600;\x20font-size:\x201.05rem;\x22>', '新建好友圈', 'cIoMw', 'Ubrdy', 'JixgO', 'ulKHZ', 'home-date', '正在为你搬运旧壁纸到新仓库...', 'Gemini\x20API\x20Error:\x20', 'data', 'Bearer\x20', 'speaker-user', '\x0a##\x20条目:\x20', '60%', 'lazva', '50%', 'tIMhW', 'saNBx', 'djZWu', 'QrpXc', 'high', 'rDVwe', '<button\x20id=\x22snoop-app-refresh-btn\x22\x20class=\x22snoop-app-header-button\x22>刷新</button>', 'appIconPosition_app-accounting', '字体应用失败:', 'world-book-checkboxes-container', '确定要重新记录吗？当前的账单会被删除。', 'yHySX', 'string', 'charAt', 'PcZpn', 'Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', '卡片已更换！', 'bWdmM', '委屈哭', 'add-expense-button', 'resolve', 'diary-page-', 'concat', '的个人专属世界观设定\x0a', 'oaYBL', 'Upgrading\x20database\x20to\x20version\x20', '在所有地方的最后一次互动是在**:\x20', 'setItem', 'https://sharkpan.xyz/f/Ganul/78iwli.jpg', 'full', 'YmhvW', 'oCGsw', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>', '\x20的《', 'iqZYI', '\x0a#\x20核心世界观设定(角色必须严格遵守)\x20\x0a', 'music-screen', 'qYCYz', 'QeRlN', 'hAEpJ', 'user-profile-list-screen', 'memberCharacterIds', 'borderBottom', 'summary', '星期四', 'event-content-input', '成功净化并迁移了\x20', 'choice-cancel', 'ayrPJ', '真是的，必需的祭品都还没准备好！', 'line', '找不到角色。', '</svg>', '.page-dot', 'cjnLV', '用户分享音乐失败:', 'quote-preview-text', 'yUzmC', 'bites', 'border', 'customIcon_', 'appIconPosition_app-world-book', '对不起', '你的任务是【续写和追加】！下面是已经存在的内容，你必须在此基础上，生成【全新的、发生在之后】的条目。给我把新内容【加在后面】，【绝对禁止】删除或修改任何已有的旧条目！', 'currentTime', 'chat-summarize-button', 'EGOwb', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a', '<div\x20id=\x22accounting-input-area\x22\x20style=\x22margin-bottom:\x2020px;\x22><div\x20class=\x22input-group\x22><label\x20for=\x22expense-description\x22>花在哪了？</label><input\x20type=\x22text\x22\x20id=\x22expense-description\x22\x20placeholder=\x22例如：一杯奶茶\x22></div><div\x20class=\x22input-group\x22><label\x20for=\x22expense-amount\x22>花了多少？</label><input\x20type=\x22number\x22\x20id=\x22expense-amount\x22\x20placeholder=\x22例如：15\x22></div><button\x20id=\x22add-expense-button\x22\x20class=\x22form-button\x20primary\x22\x20style=\x22margin-top:\x2015px;\x22>记下了</button></div><h3\x20style=\x22margin-bottom:\x2010px;\x22>今日流水</h3><div\x20id=\x22daily-expenses-list\x22\x20style=\x22max-height:\x20300px;\x20overflow-y:\x20auto;\x22></div><div\x20id=\x22organize-button-container\x22\x20style=\x22margin-top:\x2020px;\x22></div>', 'FGuaI', 'pending-post-image-preview', 'asXAz', 'comments', '\x0a#\x20最近的动态回顾\x20(供所有角色参考)\x0a', 'group-settings-name', 'transform', '上传失败了，笨蛋！\x20', '</svg></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>', 'touchend', 'MRBTU', 'galgame', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'user-persona', 'nRkNY', 'calendar-day', '-\x20你最近去过：“', '\x22\x20的聊天记录吗？此操作不可撤销。', 'cover-file-input', 'app-settings', 'fVgdL', 'NoirCustomFont', 'music-share-card', 'map', 'rGBrp', '<div\x20class=\x22post-likes\x22>', '&apos;', 'get', 'snoopList', 'lWtkY', 'edit-message-button', 'accountingLedger', 'qaMng', 'pREqY', 'insertAdjacentHTML', 'object', '.app-icon-img', 'settings', 'accepted', '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22><span\x20style=\x22background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20width:\x2040px;\x20height:\x2040px;\x20display:\x20inline-flex;\x20justify-content:\x20center;\x20align-items:\x20center;\x20flex-shrink:\x200;\x20color:\x20var(--accent-color);\x22>', '\x0a#\x20任务:\x20生成浏览器记录\x0a生成5\x20-\x207条足以暴露角色当前真实想法、困惑或兴趣的搜索历史记录。并且，为每一条历史记录，生成一段模拟的“搜索结果页”摘要。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22query\x22:\x20\x22一个人过生日怎么庆祝\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-23\x2022:15\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22result_page_content\x22:\x20\x22【热门回答】一个人的生日也可以充满仪式感！推荐尝试独自旅行...\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'aFnpT', '未知歌曲', 'frzns', '#member-select-', 'status', 'confirm-transfer-button', 'TieBN', 'Noir\x27s\x20Temporal\x20Patch\x20failed:', '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。', 'touchcancel', 'diary-get-reply-button', '\x20(当前)', 'WDbwG', '错误：找不到这首作为“信物”的歌。', 'BjVTV', '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011V7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v4\x22></path><line\x20x1=\x2210\x22\x20y1=\x2216\x22\x20x2=\x2210\x22\x20y2=\x2223\x22></line><line\x20x1=\x2214\x22\x20y1=\x2216\x22\x20x2=\x2214\x22\x20y2=\x2223\x22></line>', 'kbRuu', '.app-icon', 'tecwV', 'input[name=\x22event-type\x22]:checked', '切换聊天时发生异步错误:', '|||CMD|||', 'https://sharkpan.xyz/f/zLes5/4lxzjn.jpg', 'isGenerating', 'rgba(0,\x200,\x200,\x200.4)', 'QznOk', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'Nwxez', 'Canvas\x20to\x20Blob\x20conversion\x20failed.', 'chat_group_', 'QMzmw', '第一阶段升级完成！应用即将刷新以进行第二阶段检查。', 'BtpSK', 'group-delete', 'Failed\x20to\x20save\x20history\x20to\x20localStorage:', '\x20[并分享了歌曲:\x20', 'sprite-slider-x', 'undefined', 'worldBookEditor', 'Aduwm', '\x20说：“', 'upload-card-button-2', 'fThzS', 'removeEventListener', 'wallpaper-input', 'var(--text-color)', 'cursor', '确定要永久清空【', 'yZGFS', 'PPJsV', 'rEyjr', '刚刚发布了一条动态，内容是：“', '.custom-multiselect\x20.select-box', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-content\x22>', 'toggle-meeting-view-button', '编辑群成员功能正在开发中...', 'https://sharkpan.xyz/f/wjgHq/yznfhq.jpg']; _0x1bea = function () { return _0x541055; }; return _0x1bea(); } async function _0x43a554() { const _0x3e57d8 = _0x368b64; console[_0x3e57d8(0x5e0)](_0x3e57d8(0x681)), console[_0x3e57d8(0x5e0)]('哼，正在开始净化你那被污染的聊天记录...'); async function _0x2f91b3(_0x1418ec, _0x5a4aa3) { const _0xe5cd59 = await _0x12b672; return new Promise((_0x45e39b, _0x4f0d29) => { const _0x377ad4 = _0x2af4; if ('ptZnd' === _0x377ad4(0x8dc)) { const _0x4e85c7 = _0xe5cd59[_0x377ad4(0x319)](_0x1b51fb, _0x377ad4(0x52c)), _0x2fbd8c = _0x4e85c7[_0x377ad4(0x963)](_0x1b51fb), _0x457311 = _0x2fbd8c[_0x377ad4(0xa8b)]({ 'id': _0x1418ec, 'blob': _0x5a4aa3 }); _0x457311[_0x377ad4(0x330)] = () => _0x45e39b(_0x457311[_0x377ad4(0x4f7)]), _0x457311['onerror'] = () => _0x4f0d29(_0x457311[_0x377ad4(0x729)]); } else _0x51e812['style'][_0x377ad4(0x5eb)] = _0x377ad4(0x3fe), _0x26961f[_0x377ad4(0x10d)][_0x377ad4(0xa00)] = _0x377ad4(0xda), _0x20c873[_0x377ad4(0x10d)][_0x377ad4(0x694)] = 'rgba(255,255,255,0.2)'; }); } async function _0x50a444(_0x144ce1) { const _0x4ff275 = await _0x12b672; return new Promise((_0xb2b900, _0xba0cac) => { const _0x3e40b6 = _0x2af4; if (_0x3e40b6(0x665) !== _0x3e40b6(0x19d)) { const _0x1ea4f5 = _0x4ff275[_0x3e40b6(0x319)](_0x4f820a, _0x3e40b6(0x559)), _0x3788fa = _0x1ea4f5['objectStore'](_0x4f820a), _0x3d2d3e = _0x3788fa[_0x3e40b6(0xa25)](_0x144ce1); _0x3d2d3e['onsuccess'] = () => _0xb2b900(_0x3d2d3e['result'] ? _0x3d2d3e[_0x3e40b6(0x4f7)][_0x3e40b6(0x9be)] : null), _0x3d2d3e[_0x3e40b6(0x136)] = () => _0xba0cac(_0x3d2d3e[_0x3e40b6(0x729)]); } else { const _0x1c1a11 = _0x2ef185(); if (_0x1c1a11 && _0x1c1a11['type'] === _0x3e40b6(0x71a)) _0x5bfcc8(_0x1c1a11[_0x3e40b6(0x26f)][0x0]); else _0x1c1a11 && _0x1c1a11[_0x3e40b6(0xa78)] === _0x3e40b6(0x732) && _0x5cd7e6(_0x1c1a11['id']); } }); } async function _0x40c77f(_0x5f3056, _0x41c389) { const _0x1c500d = await _0x12b672; return new Promise((_0x3b7204, _0x360aef) => { const _0x594a2d = _0x2af4, _0x4f4426 = _0x1c500d[_0x594a2d(0x319)](_0x4f820a, _0x594a2d(0x52c)), _0x59ca02 = _0x4f4426[_0x594a2d(0x963)](_0x4f820a), _0x1999c9 = _0x59ca02[_0x594a2d(0xa8b)]({ 'id': _0x5f3056, 'data': _0x41c389 }); _0x1999c9['onsuccess'] = () => _0x3b7204(), _0x1999c9[_0x594a2d(0x136)] = () => _0x360aef(_0x1999c9['error']); }); } function _0x2b9a30(_0x5c3013) { const _0x4ef3b3 = _0x3e57d8; if (_0x4ef3b3(0x1f0) === _0x4ef3b3(0x8b5)) _0xd9a285['push'](_0x238005[_0x11596c][_0x4ef3b3(0x3ee)]()), _0x3fda89++; else return fetch(_0x5c3013)[_0x4ef3b3(0x45f)](_0x1e0048 => _0x1e0048[_0x4ef3b3(0x226)]()); } let _0x1fab04 = 0x0; for (let _0x3cd426 = 0x0; _0x3cd426 < localStorage[_0x3e57d8(0x848)]; _0x3cd426++) { const _0x46cd6c = localStorage[_0x3e57d8(0x797)](_0x3cd426); if (_0x46cd6c && _0x46cd6c[_0x3e57d8(0x33c)]('chatHistory_')) { let _0x1fb346, _0x59a55e = ![]; try { if (_0x3e57d8(0x74b) !== _0x3e57d8(0x74b)) _0x30c1d4['textContent'] = '已选择\x20' + _0x293581[_0x3e57d8(0x848)] + '\x20项'; else { _0x1fb346 = JSON[_0x3e57d8(0x329)](localStorage[_0x3e57d8(0x915)](_0x46cd6c)); if (!Array[_0x3e57d8(0x796)](_0x1fb346)) continue; for (const _0x21ca8b of _0x1fb346) { if (_0x21ca8b && _0x21ca8b['image'] && _0x21ca8b[_0x3e57d8(0x1a2)][_0x3e57d8(0x33c)](_0x3e57d8(0x698))) { const _0x645041 = await _0x2b9a30(_0x21ca8b[_0x3e57d8(0x1a2)]), _0x2076a8 = 'chat_image_migrated_' + Date[_0x3e57d8(0x7a8)]() + '_' + Math[_0x3e57d8(0x59a)](); await _0x2f91b3(_0x2076a8, _0x645041), _0x21ca8b[_0x3e57d8(0x35f)] = _0x2076a8, delete _0x21ca8b['image'], _0x59a55e = !![], _0x1fab04++; } } if (_0x59a55e) { if ('nzMSp' !== _0x3e57d8(0x37e)) localStorage[_0x3e57d8(0x9e0)](_0x46cd6c, JSON['stringify'](_0x1fb346)); else { const _0x1bbb75 = []; if (_0x975e99[_0x3e57d8(0x9a8)]) _0x1bbb75[_0x3e57d8(0x36b)]({ 'text': _0x31208a['content'] }); if (_0x57d288[_0x3e57d8(0x1a2)]) { const _0x128007 = _0x16c929[_0x3e57d8(0x1a2)][_0x3e57d8(0x5ac)](',')[0x1], _0xe73cea = _0x4c6ed8[_0x3e57d8(0x1a2)]['substring'](_0x17dd96[_0x3e57d8(0x1a2)][_0x3e57d8(0x7ec)](':') + 0x1, _0x4f6cac['image'][_0x3e57d8(0x7ec)](';')) || 'image/jpeg'; _0x1bbb75[_0x3e57d8(0x36b)]({ 'inline_data': { 'mime_type': _0xe73cea, 'data': _0x128007 } }); } return _0x1bbb75; } } } } catch (_0x28ef0d) { if (_0x3e57d8(0x919) !== _0x3e57d8(0x893)) { console[_0x3e57d8(0x729)](_0x3e57d8(0xab8) + _0x46cd6c + '\x20时出错:', _0x28ef0d); continue; } else { const _0x1f983e = _0x5d4c84[_0x3e57d8(0x3b9)](_0x3e57d8(0x99e)); _0x1f983e[_0x3e57d8(0xe5)] = _0xc5f537['id'], _0x1f983e[_0x3e57d8(0x9ac)] = _0x353c68[_0x3e57d8(0x6b7)], _0x213c8e[_0x3e57d8(0x6ab)](_0x1f983e); } } } } console[_0x3e57d8(0x5e0)](_0x3e57d8(0x747) + _0x1fab04 + _0x3e57d8(0x356)); } async function _0x446f98() { const _0xfe7c9b = _0x368b64; console[_0xfe7c9b(0x5e0)]('---\x20Noir\x27s\x20Friend\x20Circle\x20Purification\x20Ritual\x20---'), console[_0xfe7c9b(0x5e0)](_0xfe7c9b(0x55f)); async function _0x3bdb4b(_0x21f68c, _0x18f542) { const _0x21271c = await _0x12b672; return new Promise((_0x16a92b, _0x10d9b1) => { const _0x2832bb = _0x2af4, _0x323d79 = _0x21271c[_0x2832bb(0x319)](_0x2832bb(0x8c8), _0x2832bb(0x52c)), _0x576f24 = _0x323d79[_0x2832bb(0x963)](_0x2832bb(0x8c8)), _0x330f0b = _0x576f24[_0x2832bb(0xa8b)]({ 'id': _0x21f68c, 'blob': _0x18f542 }); _0x330f0b[_0x2832bb(0x330)] = () => _0x16a92b(_0x330f0b[_0x2832bb(0x4f7)]), _0x330f0b[_0x2832bb(0x136)] = () => _0x10d9b1(_0x330f0b['error']); }); } function _0x2b3839(_0x16e20e) { const _0x37db24 = _0xfe7c9b; return fetch(_0x16e20e)['then'](_0x12b5eb => _0x12b5eb[_0x37db24(0x226)]()); } let _0x1aeec6 = 0x0, _0x27d17a = ![]; try { if ('idZAr' !== _0xfe7c9b(0xac3)) { const _0x1f3357 = localStorage['getItem'](_0xfe7c9b(0x683)); if (!_0x1f3357) { console[_0xfe7c9b(0x5e0)](_0xfe7c9b(0x217)); return; } const _0x45de85 = JSON[_0xfe7c9b(0x329)](_0x1f3357); if (!_0x45de85['friendCircles'] || !Array['isArray'](_0x45de85['friendCircles'])) return; for (const _0x319750 of _0x45de85['friendCircles']) { if (_0xfe7c9b(0x5bb) === 'sLlWu') { if (_0x319750['posts'] && Array[_0xfe7c9b(0x796)](_0x319750['posts'])) { if (_0xfe7c9b(0x773) !== _0xfe7c9b(0x773)) _0x5279b8[_0xfe7c9b(0x8df)](_0x31e319); else for (const _0xa01b35 of _0x319750[_0xfe7c9b(0x3d6)]) { if (_0xfe7c9b(0x476) === 'UGNTw') { if (_0xa01b35 && _0xa01b35[_0xfe7c9b(0x1a2)] && _0xa01b35[_0xfe7c9b(0x1a2)][_0xfe7c9b(0x33c)](_0xfe7c9b(0x698))) { console[_0xfe7c9b(0x5e0)](_0xfe7c9b(0x12a) + _0x319750[_0xfe7c9b(0x6b7)] + '\x22\x20中发现一张需要净化的图片...'); const _0x3a7c48 = await _0x2b3839(_0xa01b35[_0xfe7c9b(0x1a2)]), _0x33170b = _0xfe7c9b(0x54d) + Date['now']() + '_' + Math[_0xfe7c9b(0x59a)](); await _0x3bdb4b(_0x33170b, _0x3a7c48), _0xa01b35[_0xfe7c9b(0x35f)] = _0x33170b, delete _0xa01b35['image'], _0x27d17a = !![], _0x1aeec6++; } } else _0x587ea4(), _0x245baa('worldBook', _0xfe7c9b(0x362)); } } } else { const _0x316145 = _0x1232e7[_0xfe7c9b(0x6c4)]['result']; _0x494e7f[_0xfe7c9b(0x5e0)](_0xfe7c9b(0x9de) + _0x316145['version'] + _0xfe7c9b(0x8c5)), !_0x316145['objectStoreNames']['contains'](_0xe2a6fc) && (_0x392011['log'](_0xfe7c9b(0x2a4) + _0x5c977f), _0x316145[_0xfe7c9b(0x1e4)](_0x39fe97, { 'keyPath': 'id' })), !_0x316145['objectStoreNames'][_0xfe7c9b(0x956)](_0xfe7c9b(0x490)) && (_0x46ed01[_0xfe7c9b(0x5e0)](_0xfe7c9b(0x395)), _0x316145[_0xfe7c9b(0x1e4)](_0xfe7c9b(0x490), { 'keyPath': 'id' })), !_0x316145[_0xfe7c9b(0xae2)][_0xfe7c9b(0x956)](_0x4cd9d2) && (_0x594317[_0xfe7c9b(0x5e0)](_0xfe7c9b(0x2a4) + _0x3d601c), _0x316145[_0xfe7c9b(0x1e4)](_0x1211ab, { 'keyPath': 'id' })); } } _0x27d17a && (_0xfe7c9b(0xa39) === _0xfe7c9b(0xa39) ? (console[_0xfe7c9b(0x5e0)](_0xfe7c9b(0x458)), localStorage['setItem'](_0xfe7c9b(0x683), JSON[_0xfe7c9b(0x22e)](_0x45de85))) : _0x1f3ba5[_0xfe7c9b(0x9a1)] = _0xfe7c9b(0x49d)); } else { const _0x2834d6 = new _0x10802c(); _0x2834d6['onloadend'] = () => _0x19b020(_0x2834d6['result']), _0x2834d6['onerror'] = _0x15d80f, _0x2834d6[_0xfe7c9b(0x65a)](_0x55d537); } } catch (_0x2c1309) { console[_0xfe7c9b(0x729)](_0xfe7c9b(0x988), _0x2c1309); } return console[_0xfe7c9b(0x5e0)]('---\x20好友圈净化仪式完成\x20---'), console[_0xfe7c9b(0x5e0)](_0xfe7c9b(0x9f3) + _0x1aeec6 + '\x20张旧的动态图片。'), _0x1aeec6; } async function _0x1eaab6() { const _0x2a7cb9 = _0x368b64; console[_0x2a7cb9(0x5e0)](_0x2a7cb9(0x688)), console[_0x2a7cb9(0x5e0)](_0x2a7cb9(0xe0)); let _0x553971 = 0x0, _0x149658 = ![]; try { const _0x5234d3 = localStorage[_0x2a7cb9(0x915)](_0x2a7cb9(0x683)); if (!_0x5234d3) { if (_0x2a7cb9(0x46f) === 'PJNaL') return console['log']('聊天档案柜是空的，无需净化。'), 0x0; else _0x2e0829 += '-\x20**状态提示**:\x20你们今天刚聊过，请自然地衔接对话。\x0a'; } for (let _0x315b42 = 0x0; _0x315b42 < localStorage[_0x2a7cb9(0x848)]; _0x315b42++) { const _0x3cba3a = localStorage[_0x2a7cb9(0x797)](_0x315b42); if (_0x3cba3a && _0x3cba3a[_0x2a7cb9(0x33c)](_0x2a7cb9(0x13c))) { let _0x4b90d0, _0x1100a2 = ![]; try { _0x4b90d0 = JSON[_0x2a7cb9(0x329)](localStorage[_0x2a7cb9(0x915)](_0x3cba3a)); if (!Array['isArray'](_0x4b90d0)) continue; for (const _0x122c48 of _0x4b90d0) { if (_0x122c48 && (_0x122c48[_0x2a7cb9(0xa78)] === _0x2a7cb9(0x868) || _0x122c48['type'] === _0x2a7cb9(0x4a3)) && _0x122c48[_0x2a7cb9(0x2ab)] && _0x122c48[_0x2a7cb9(0x2ab)][_0x2a7cb9(0x33c)](_0x2a7cb9(0x698))) { const _0x554821 = await _0x39f481(_0x122c48[_0x2a7cb9(0x2ab)]), _0x82a475 = _0x2a7cb9(0x246) + Date['now']() + '_' + Math[_0x2a7cb9(0x59a)](); await _0x5ef29b(_0x82a475, _0x554821), _0x122c48[_0x2a7cb9(0x242)] = _0x82a475, delete _0x122c48['coverUrl'], _0x1100a2 = !![], _0x553971++; } } _0x1100a2 && localStorage[_0x2a7cb9(0x9e0)](_0x3cba3a, JSON[_0x2a7cb9(0x22e)](_0x4b90d0)); } catch (_0x168dfd) { console['error'](_0x2a7cb9(0xab8) + _0x3cba3a + _0x2a7cb9(0x153), _0x168dfd); continue; } } } } catch (_0x366db1) { console['error'](_0x2a7cb9(0x88b), _0x366db1); } return console[_0x2a7cb9(0x5e0)](_0x2a7cb9(0x5ee)), console[_0x2a7cb9(0x5e0)](_0x2a7cb9(0x9f3) + _0x553971 + _0x2a7cb9(0x233)), _0x553971; } function _0x146846() { const _0x431043 = _0x368b64; if (!_0x10530c[_0x431043(0x4de)]) { if (_0x431043(0x465) === _0x431043(0x73b)) _0x1cbfed['style'][_0x431043(0x5b4)] = 'absolute', _0x514063[_0x431043(0x10d)]['top'] = _0x431043(0x51c), _0x59f0aa[_0x431043(0x10d)][_0x431043(0xf8)] = '50%', _0x1ca294['style']['transform'] = _0x431043(0x7bd), _0x21da8c['style'][_0x431043(0x5eb)] = _0x431043(0x92c); else return _0x10530c['userProfiles'][_0x431043(0x212)](_0x3f1d90 => _0x3f1d90['id'] === _0x10530c[_0x431043(0x663)]) || _0x10530c[_0x431043(0x360)][0x0]; } const _0x1f81a4 = _0x10530c[_0x431043(0x4bc)][_0x431043(0x212)](_0x363d18 => _0x363d18['type'] === _0x431043(0x71a) && _0x363d18[_0x431043(0x26f)][_0x431043(0xa83)](_0x10530c[_0x431043(0x4de)])), _0x570fa5 = _0x1f81a4?.['boundUserProfileId'] || _0x10530c[_0x431043(0x663)]; return _0x10530c[_0x431043(0x360)][_0x431043(0x212)](_0x421ce7 => _0x421ce7['id'] === _0x570fa5) || _0x10530c['userProfiles'][0x0]; } function _0x25c4db(_0x4b9aac) { const _0x349b99 = _0x368b64, _0x523825 = new Date(), _0x34ed95 = _0x523825 - _0x4b9aac, _0x278e29 = Math[_0x349b99(0x2c8)](_0x34ed95 / 0x3e8), _0x13dbc1 = Math[_0x349b99(0x2c8)](_0x278e29 / 0x3c), _0x46bcf8 = Math[_0x349b99(0x2c8)](_0x13dbc1 / 0x3c), _0x1a44dc = Math[_0x349b99(0x2c8)](_0x46bcf8 / 0x18), _0xd8cd98 = _0x4b9aac[_0x349b99(0x1cf)]('zh-CN', { 'hour': '2-digit', 'minute': _0x349b99(0x96e) }); if (_0x278e29 < 0x3c) return '刚才'; if (_0x13dbc1 < 0x3c) { if (_0x349b99(0x28c) !== _0x349b99(0x28c)) _0x5731d8[_0x349b99(0x10d)][_0x349b99(0x5eb)] = _0x349b99(0x3fe); else return _0x13dbc1 + '分钟前'; } const _0x1679a6 = _0x523825[_0x349b99(0x8b9)]() === _0x4b9aac[_0x349b99(0x8b9)](); if (_0x1679a6) { if ('LMufe' !== 'LMufe') _0xb4bc93[_0x349b99(0x6ab)](_0x4528f0), _0x44f7c2[_0x349b99(0x6ab)](_0x2ae03e); else return _0x349b99(0x630) + _0xd8cd98; } const _0x8a2300 = new Date(); _0x8a2300[_0x349b99(0x580)](_0x523825['getDate']() - 0x1); const _0x1951c1 = _0x8a2300[_0x349b99(0x8b9)]() === _0x4b9aac[_0x349b99(0x8b9)](); if (_0x1951c1) { if (_0x349b99(0x712) === _0x349b99(0xa99)) _0x5555a2[_0x349b99(0x9ac)] = _0x219eb3[_0x349b99(0x6b7)], _0x32669d[_0x349b99(0x9ac)] = _0x349b99(0x8c4), _0x86da5e(_0x4e90b2, _0x349b99(0x47b)); else return _0x349b99(0x71e) + _0xd8cd98; } if (_0x1a44dc <= 0x7) { const _0x164d56 = [_0x349b99(0x905), _0x349b99(0x9a6), '星期二', _0x349b99(0x50f), '星期四', _0x349b99(0x2c5), '星期六']; return _0x164d56[_0x4b9aac[_0x349b99(0x381)]()] + '\x20' + _0xd8cd98; } return _0x4b9aac[_0x349b99(0x5f8)]() + '年' + (_0x4b9aac[_0x349b99(0xa84)]() + 0x1) + '月' + _0x4b9aac['getDate']() + '日'; } function _0xa06749(_0x166270, _0x4a7004 = 0x320, _0x3b5481 = 0.8, _0x3d5f06 = ![]) { return new Promise((_0x1c7619, _0x1c23c1) => { const _0x1f9c50 = _0x2af4; if (!_0x166270 || !_0x166270['type'][_0x1f9c50(0x33c)](_0x1f9c50(0x902))) return _0x1c23c1(new Error(_0x1f9c50(0x940))); const _0x3ac7b4 = new FileReader(); _0x3ac7b4[_0x1f9c50(0x65a)](_0x166270), _0x3ac7b4[_0x1f9c50(0x744)] = _0x1897bf => { const _0x4d9919 = _0x1f9c50, _0x5571b4 = new Image(); _0x5571b4[_0x4d9919(0x70a)] = _0x1897bf[_0x4d9919(0x6c4)][_0x4d9919(0x4f7)], _0x5571b4[_0x4d9919(0x744)] = () => { const _0x4d838e = _0x4d9919, _0x26b521 = document[_0x4d838e(0x3b9)](_0x4d838e(0x624)); let _0x48e013 = _0x5571b4['width'], _0x51f908 = _0x5571b4['height']; if (_0x48e013 > _0x51f908) { if (_0x48e013 > _0x4a7004) { if (_0x4d838e(0x80f) !== _0x4d838e(0xff)) _0x51f908 *= _0x4a7004 / _0x48e013, _0x48e013 = _0x4a7004; else { const _0x4c7c9b = _0x3808d7['trim'](); _0x4c7c9b && _0x224e29['push'](..._0x8339dd(_0x4c7c9b)), _0x5e7f6f < _0x2451ef[_0x4d838e(0x848)] && (_0x55f34d['push'](_0x3473c7[_0x288a81][_0x4d838e(0x3ee)]()), _0x1e9437++); } } } else _0x51f908 > _0x4a7004 && (_0x48e013 *= _0x4a7004 / _0x51f908, _0x51f908 = _0x4a7004); _0x26b521[_0x4d838e(0x495)] = _0x48e013, _0x26b521[_0x4d838e(0x5f5)] = _0x51f908; const _0x15ba73 = _0x26b521[_0x4d838e(0x3ef)]('2d'); _0x15ba73[_0x4d838e(0x158)](_0x5571b4, 0x0, 0x0, _0x48e013, _0x51f908); const _0x3ddeff = _0x166270[_0x4d838e(0xa78)] === _0x4d838e(0xa7c) ? _0x4d838e(0xa7c) : _0x4d838e(0x6ed); if (_0x3d5f06) { if (_0x4d838e(0x966) !== 'IyzGM') _0x26b521[_0x4d838e(0x5b7)](_0x57adb3 => { const _0x3d1380 = _0x4d838e; _0x57adb3 ? _0x3d1380(0x341) !== _0x3d1380(0x341) ? (_0x54d3e3(), _0x3bb18d(_0x3d1380(0x8f8), _0x3d1380(0x94f))) : _0x1c7619(_0x57adb3) : _0x3d1380(0x8a8) !== _0x3d1380(0xad4) ? _0x1c23c1(new Error('Canvas\x20to\x20Blob\x20conversion\x20failed.')) : _0x1c4506[_0x3d1380(0xae0)](); }, _0x3ddeff, _0x3b5481); else { if (_0x5d48e7[_0x4d838e(0x848)] === 0x0) return; _0x2c62e6 = (_0x3bf0e0 - 0x1 + _0x5029cf[_0x4d838e(0x848)]) % _0x2dc5c7[_0x4d838e(0x848)], _0x108f8f(_0x111d95[_0xe376eb], _0x3125e6); } } else _0x1c7619(_0x26b521[_0x4d838e(0x1a5)](_0x3ddeff, _0x3b5481)); }, _0x5571b4['onerror'] = _0x112d9e => _0x1c23c1(_0x112d9e); }, _0x3ac7b4[_0x1f9c50(0x136)] = _0x3744ab => _0x1c23c1(_0x3744ab); }); } function _0x3c4a4d(_0x2621d4) { return new Promise((_0x5aaef0, _0x2a928e) => { const _0x3be6d6 = _0x2af4, _0x43d77d = new FileReader(); _0x43d77d[_0x3be6d6(0x7b5)] = () => _0x5aaef0(_0x43d77d[_0x3be6d6(0x4f7)]), _0x43d77d[_0x3be6d6(0x136)] = _0x2a928e, _0x43d77d[_0x3be6d6(0x65a)](_0x2621d4); }); } function _0x3c4a4d(_0x51f39e) { return new Promise((_0x586b60, _0x250838) => { const _0x29c8f6 = _0x2af4; if ('ZsDSs' === _0x29c8f6(0x166)) { const _0x377e8f = new FileReader(); _0x377e8f[_0x29c8f6(0x7b5)] = () => _0x586b60(_0x377e8f[_0x29c8f6(0x4f7)]), _0x377e8f['onerror'] = _0x250838, _0x377e8f[_0x29c8f6(0x65a)](_0x51f39e); } else _0x3f02ed[_0x29c8f6(0x70a)] = _0x56af7f[_0x29c8f6(0x73d)](_0x24037a), _0x58e7a8[_0x29c8f6(0x10d)][_0x29c8f6(0x5eb)] = _0x29c8f6(0x92c); }); } function _0x74b8c(_0x4fb753, _0x2c14bb, _0x43238e) { const _0x577977 = _0x368b64, _0x1bd74c = _0x970c2f => { const _0x51065b = _0x2af4; if (_0x51065b(0x6ac) === _0x51065b(0x6ac)) { if (_0x970c2f[_0x51065b(0x34a)] === _0x51065b(0x27a)) return _0x10530c[_0x51065b(0x1c9)]?.['name'] || _0x51065b(0x849); if (_0x4fb753['type'] === _0x51065b(0x732)) { const _0x5a2ccd = _0x970c2f[_0x51065b(0x596)] ? _0x21f914(_0x970c2f['senderId']) : null; return _0x5a2ccd?.['name'] || 'Unknown'; } else { const _0x164054 = _0x21f914(_0x4fb753[_0x51065b(0x26f)][0x0]); return _0x164054?.[_0x51065b(0x6b7)] || 'AI'; } } else _0x56f40c[_0x51065b(0x36b)](..._0x57ae8f(_0xef4fd1)); }, _0x8feb15 = _0x2c14bb['slice'](-_0x43238e), _0x111f74 = []; for (const _0x355e0c of _0x8feb15) { if (_0x577977(0x89c) !== 'TcUNq') { const _0x277c19 = new Date(_0x355e0c[_0x577977(0x908)])['toLocaleTimeString']('zh-CN', { 'hour': '2-digit', 'minute': '2-digit' }); if (_0x355e0c[_0x577977(0x9a8)]) { if (_0x577977(0x3f5) === 'xhtXy') { _0xb435d5[_0x577977(0x1f5)] = [..._0x184ba9]; const _0x44ada9 = _0x3301b8[_0x577977(0x1f5)][_0x577977(0x420)](); _0x52339e['textContent'] = _0x44ada9['speaker'] === _0x577977(0x623) ? '旁白' : _0x44ada9[_0x577977(0x10c)], _0x461c75[_0x577977(0x9ac)] = _0x44ada9[_0x577977(0x9f7)], _0x44ada9[_0x577977(0x10c)] !== _0x577977(0x623) && _0x3ac6db(_0x37a1bb[_0x577977(0x5cb)], _0x44ada9[_0x577977(0x2be)]); } else _0x111f74[_0x577977(0x36b)]('[' + _0x277c19 + _0x577977(0xaa1) + _0x1bd74c(_0x355e0c) + ']\x20' + String(_0x355e0c['content'])[_0x577977(0x3ee)]()); } } else _0x1cf24b[_0x577977(0x895)](_0x307390, { 'songName': _0x274880, 'artist': _0x1c6f74, 'coverId': null, 'playableUrl': null }); } return _0x111f74; } function _0x2af4(_0x5e1a99, _0x4207e7) { const _0x1bea83 = _0x1bea(); return _0x2af4 = function (_0x2af41c, _0x34274e) { _0x2af41c = _0x2af41c - 0xc2; let _0x139cf6 = _0x1bea83[_0x2af41c]; return _0x139cf6; }, _0x2af4(_0x5e1a99, _0x4207e7); } function _0x4e0a48(_0x5ba40d) { const _0x49d3e1 = _0x368b64; if (_0x5ba40d[_0x49d3e1(0xa78)] === 'group') return _0x49d3e1(0x309) + (_0x5ba40d[_0x49d3e1(0x6b7)] || '未命名') + '」'; const _0x34d76d = _0x21f914(_0x5ba40d[_0x49d3e1(0x26f)][0x0]); return '与\x20' + (_0x34d76d?.[_0x49d3e1(0x6b7)] || _0x49d3e1(0x187)) + '\x20的私聊'; } function _0x21c201(_0x126b08) { const _0x2b9eef = _0x368b64; try { const _0xa39fb = localStorage[_0x2b9eef(0x915)](_0x2b9eef(0x13c) + _0x126b08), _0x87cb2d = JSON[_0x2b9eef(0x329)](_0xa39fb || '[]'); return Array[_0x2b9eef(0x796)](_0x87cb2d) ? _0x87cb2d : []; } catch { return []; } } function _0x3b8ffa(_0x4430d7) { const _0x3381f3 = _0x368b64, _0xd94ff = Math[_0x3381f3(0x21d)](0x1, Number(_0x10530c[_0x3381f3(0x827)]?.['perChatContextLines'] ?? 0x64)), _0x4a9bd8 = _0x10530c[_0x3381f3(0x4bc)][_0x3381f3(0x54e)](_0x32eb6d => _0x32eb6d[_0x3381f3(0x26f)][_0x3381f3(0xa83)](_0x4430d7)), _0x4c9a9e = _0x4a9bd8[_0x3381f3(0xa21)](_0x18cfbc => { const _0x19e658 = _0x3381f3, _0xdf59bc = _0x21c201(_0x18cfbc['id']), _0x4cfdc2 = _0xdf59bc[_0x19e658(0x848)] > 0x0 ? _0xdf59bc[_0xdf59bc[_0x19e658(0x848)] - 0x1] : null; return { 'chat': _0x18cfbc, 'history': _0xdf59bc, 'lastTimestamp': _0x4cfdc2 ? _0x4cfdc2[_0x19e658(0x908)] : 0x0 }; })[_0x3381f3(0x54e)](_0x3266b2 => _0x3266b2[_0x3381f3(0x5f1)][_0x3381f3(0x848)] > 0x0); _0x4c9a9e[_0x3381f3(0xaa6)]((_0x3b8b23, _0x29a73f) => _0x29a73f['lastTimestamp'] - _0x3b8b23['lastTimestamp']); const _0x2b1def = [], _0x142be2 = {}; return _0x4c9a9e[_0x3381f3(0x986)]((_0x5575f5, _0x733d2d) => { const _0x41287a = _0x3381f3, _0x538375 = _0x74b8c(_0x5575f5[_0x41287a(0x78c)], _0x5575f5[_0x41287a(0x5f1)], _0xd94ff); if (_0x538375[_0x41287a(0x848)] === 0x0) return; const _0x120b01 = _0x733d2d === 0x0 ? _0x41287a(0x15c) : _0x41287a(0x8cf); _0x2b1def[_0x41287a(0x36b)](_0x41287a(0x2af) + _0x120b01 + _0x4e0a48(_0x5575f5[_0x41287a(0x78c)]) + '\x0a' + _0x538375[_0x41287a(0x64e)]('\x0a')), _0x142be2[_0x5575f5[_0x41287a(0x78c)]['id']] = _0x538375[_0x41287a(0x848)]; }), { 'omniText': _0x2b1def[_0x3381f3(0x64e)]('\x0a\x0a'), 'usedCounts': _0x142be2 }; } function _0x392b91(_0x158e16) { const _0x1a1f1c = _0x368b64; let _0x4f23fc = null; const _0x11e0f5 = _0x10530c[_0x1a1f1c(0x4bc)][_0x1a1f1c(0x54e)](_0x4e3782 => _0x4e3782[_0x1a1f1c(0x26f)][_0x1a1f1c(0xa83)](_0x158e16)); for (const _0x491647 of _0x11e0f5) { if (_0x1a1f1c(0x6bd) === _0x1a1f1c(0x13f)) _0x5676de(![]), _0x2ba323['isGenerating'] = ![]; else { const _0x54e8a0 = _0x21c201(_0x491647['id']); if (_0x54e8a0 && _0x54e8a0[_0x1a1f1c(0x848)] > 0x0) { const _0x47d2c8 = _0x54e8a0[_0x54e8a0['length'] - 0x1]; (!_0x4f23fc || _0x47d2c8[_0x1a1f1c(0x908)] > _0x4f23fc[_0x1a1f1c(0x908)]) && (_0x4f23fc = _0x47d2c8); } } } return _0x4f23fc; } function _0x538a31(_0x5c6628) { const _0x5a2f10 = _0x368b64; if (!_0x5c6628 || !_0x5c6628['includes'](',')) return _0x5c6628; const _0x1ad404 = _0x5c6628[_0x5a2f10(0x5ac)](',')[_0x5a2f10(0xa21)](_0xfec25e => _0xfec25e['trim']()); return _0x1ad404[Math[_0x5a2f10(0x703)](Math[_0x5a2f10(0x59a)]() * _0x1ad404[_0x5a2f10(0x848)])]; } function _0x52e7d6(_0x1eb2af) { return new Promise(_0x2ca3bd => { const _0x1d4766 = _0x2af4, _0x1f8438 = document[_0x1d4766(0x248)](_0x1d4766(0xcd)), _0x1f817a = document[_0x1d4766(0x248)](_0x1d4766(0x38e)), _0x54b975 = document[_0x1d4766(0x248)](_0x1d4766(0x8d0)), _0x1bada8 = document[_0x1d4766(0x248)]('modal-cancel'), _0x443536 = document['getElementById'](_0x1d4766(0x4a0)); _0x1f817a[_0x1d4766(0x9ac)] = _0x1eb2af, _0x1f8438['style']['display'] = 'flex'; const _0x5796a9 = _0x2fc5ca => { const _0x236af9 = _0x1d4766; _0x1f8438[_0x236af9(0x10d)][_0x236af9(0x5eb)] = _0x236af9(0x3fe), _0x54b975[_0x236af9(0x935)] = _0x1bada8['onclick'] = _0x443536['onclick'] = null, document[_0x236af9(0xa5e)](_0x236af9(0x44b), _0x300029), _0x2ca3bd(_0x2fc5ca); }, _0x300029 = _0x1598d9 => { const _0x37c4e1 = _0x1d4766; if (_0x1598d9[_0x37c4e1(0x797)] === _0x37c4e1(0x137)) _0x5796a9(![]); if (_0x1598d9[_0x37c4e1(0x797)] === 'Enter') _0x5796a9(!![]); }; _0x54b975[_0x1d4766(0x935)] = () => _0x5796a9(!![]), _0x1bada8['onclick'] = () => _0x5796a9(![]), _0x443536[_0x1d4766(0x935)] = () => _0x5796a9(![]), document[_0x1d4766(0x578)](_0x1d4766(0x44b), _0x300029); }); } function _0x3a6c86(_0x225740) { const _0x5bf828 = _0x368b64, _0x5417f7 = document[_0x5bf828(0x248)](_0x5bf828(0x10b)); _0x5417f7[_0x5bf828(0x9ac)] = _0x225740, _0x5417f7[_0x5bf828(0x10d)][_0x5bf828(0x5eb)] = _0x5bf828(0x92c); if (_0x3a6c86['_t']) clearTimeout(_0x3a6c86['_t']); _0x3a6c86['_t'] = setTimeout(() => { const _0x339af0 = _0x5bf828; if (_0x339af0(0x443) !== _0x339af0(0x836)) _0x5417f7[_0x339af0(0x10d)]['display'] = _0x339af0(0x3fe); else { const _0x44b34d = _0x148f6b[_0x339af0(0x248)](_0x339af0(0x264)), _0x44facf = _0x3f830a[_0x339af0(0x248)](_0x339af0(0x7e5)), _0x16e2e4 = new _0x2abfe1(); _0x16e2e4[_0x339af0(0x3c1)](0x0, 0x0, 0x0, 0x0); const _0x1f3b2d = _0x4a42ae[_0x339af0(0x2e4)][_0x339af0(0x54e)](_0x4bc51b => _0x4bc51b[_0x339af0(0xa78)] === _0x339af0(0x766) && new _0x29a45f(_0x4bc51b[_0x339af0(0x60f)] + _0x339af0(0x1a9)) >= _0x16e2e4)[_0x339af0(0xaa6)]((_0x46f8a5, _0x26451f) => new _0x14ed0d(_0x46f8a5[_0x339af0(0x60f)]) - new _0x8c1ab3(_0x26451f[_0x339af0(0x60f)])); if (_0x1f3b2d[_0x339af0(0x848)] > 0x0) { const _0x262f0a = _0x1f3b2d[0x0], _0x1fcaa7 = new _0x4890f8(_0x262f0a[_0x339af0(0x60f)] + _0x339af0(0x1a9)), _0x4fafe0 = _0x1fcaa7 - _0x16e2e4, _0x2eadf1 = _0xf7827[_0x339af0(0x16f)](_0x4fafe0 / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x44b34d[_0x339af0(0x9ac)] = '距离「' + _0x262f0a[_0x339af0(0x9a8)] + '」', _0x44facf['innerHTML'] = '<span>' + _0x2eadf1 + _0x339af0(0x5c0); } else _0x44b34d[_0x339af0(0x9ac)] = '近期没有特别安排', _0x44facf[_0x339af0(0x9a1)] = _0x339af0(0x48b); } }, 0x640); } function _0x3b293d() { const _0x2ab368 = _0x368b64, _0x3556cd = document['getElementById']('app-pages-container'), _0x32b3b1 = document[_0x2ab368(0x248)](_0x2ab368(0xa96)), _0x4c8748 = document[_0x2ab368(0x20d)](_0x2ab368(0x9fa)), _0x20c01c = document[_0x2ab368(0x248)](_0x2ab368(0x5a1)); let _0x4e802a = 0x0; _0x32b3b1[_0x2ab368(0x10d)][_0x2ab368(0x495)] = '300%'; const _0x4cdf07 = 0x3; function _0x3cbb10(_0x579eab) { const _0x1f4501 = _0x2ab368; if (_0x1f4501(0xdd) === _0x1f4501(0xdd)) { if (_0x579eab < 0x0 || _0x579eab >= _0x4cdf07) return; _0x32b3b1['style'][_0x1f4501(0xa10)] = _0x1f4501(0xd9) + _0x579eab * (0x64 / _0x4cdf07) + '%)', _0x4c8748[_0x1f4501(0x986)](_0x1fd79d => _0x1fd79d['classList']['remove']('active')), _0x4c8748[_0x579eab][_0x1f4501(0x882)][_0x1f4501(0x7c3)](_0x1f4501(0x182)), _0x4e802a = _0x579eab; if (_0x579eab === 0x0) { if ('MdSSe' !== _0x1f4501(0x484)) _0x20c01c[_0x1f4501(0x10d)]['display'] = _0x1f4501(0x3fe); else return _0x1b1e49['userProfiles']['find'](_0x40aeca => _0x40aeca['id'] === _0xd58c0b); } else 'oGTDj' === 'oGTDj' ? _0x20c01c[_0x1f4501(0x10d)][_0x1f4501(0x5eb)] = _0x1f4501(0x4ef) : _0x594a98[_0x1f4501(0x248)]('music-screen')['style'][_0x1f4501(0x91f)]('--feed-bg-image', _0x1f4501(0x5a3) + _0x46e987 + ')'); } else _0x52da48(_0x1d5467); } _0x3cbb10(0x0), _0x4c8748[_0x2ab368(0x986)](_0x59ce20 => { const _0x4c970e = _0x2ab368; _0x59ce20[_0x4c970e(0x578)]('click', () => { const _0x1e9ebf = _0x4c970e; if (_0x1e9ebf(0x412) !== _0x1e9ebf(0x412)) _0x573250[_0x1e9ebf(0x729)]('保存播放器状态失败，真是没用。', _0x1f9650); else { const _0x3b0cc0 = parseInt(_0x59ce20['dataset']['page'], 0xa); _0x3cbb10(_0x3b0cc0); } }); }); let _0x41ddc4 = 0x0, _0x281d2f = 0x0, _0x568123 = 0x0, _0x2d045f = ![], _0x4a306d = ''; _0x3556cd[_0x2ab368(0x578)](_0x2ab368(0x936), _0x5c18a8 => { const _0x3056f9 = _0x2ab368; _0x3056f9(0x59c) !== 'FslOP' ? (_0x41ddc4 = _0x5c18a8[_0x3056f9(0x5d6)][0x0][_0x3056f9(0x93f)], _0x281d2f = _0x5c18a8[_0x3056f9(0x5d6)][0x0][_0x3056f9(0x398)], _0x2d045f = !![], _0x4a306d = '') : (_0x49e5e9[_0x3056f9(0x729)](_0x3056f9(0x68d), _0x356664, '原始文本:', _0x23763c), _0x1717da[_0x3056f9(0x675)][_0x3056f9(0x36b)]({ 'role': _0x3056f9(0x7f0), 'senderId': _0x49ed51['id'], 'timestamp': _0x90a4ca['now'](), 'isOffline': !![], 'content': _0x3056f9(0x5df) + _0x7aeffe + ']' })); }, { 'passive': !![] }), _0x3556cd['addEventListener'](_0x2ab368(0x730), _0xe76a00 => { const _0x2eb860 = _0x2ab368; if ('EMhZE' === _0x2eb860(0xadc)) { _0x28eb5f['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>'; return; } else { if (!_0x2d045f) return; if (_0x4a306d === '') { const _0x643685 = _0xe76a00[_0x2eb860(0x5d6)][0x0][_0x2eb860(0x93f)] - _0x41ddc4, _0x4ab751 = _0xe76a00[_0x2eb860(0x5d6)][0x0][_0x2eb860(0x398)] - _0x281d2f; if (Math[_0x2eb860(0x20b)](_0x643685) > Math['abs'](_0x4ab751)) { if (_0x2eb860(0x7af) !== _0x2eb860(0x2e9)) _0x4a306d = _0x2eb860(0x6df); else { const _0x53205e = _0x3f6ee5['trim'](); if (!_0x53205e || !_0x3d005e[_0x2eb860(0x4de)]) return; let _0x25af52 = _0x2681b6['diaries'][_0x2eb860(0x212)](_0x13b034 => _0x13b034['characterId'] === _0x4a8f51['activeDiaryCharacterId']); !_0x25af52 && (_0x25af52 = { 'characterId': _0x19fdbd[_0x2eb860(0x4de)], 'entries': [] }, _0x4e0c90[_0x2eb860(0x938)][_0x2eb860(0x36b)](_0x25af52)); _0x25af52[_0x2eb860(0x17b)][_0x2eb860(0x36b)]({ 'timestamp': _0x5b5548[_0x2eb860(0x7a8)](), 'author': _0x2eb860(0x27a), 'content': _0x53205e }), _0x249446(); const _0x47ec12 = _0x25af52[_0x2eb860(0x17b)]['length']; _0x32f3ac[_0x2eb860(0x2aa)] = _0x11032c[_0x2eb860(0x16f)](_0x47ec12 / 0x2) - 0x1, _0x193878(); } } else _0x4a306d = 'vertical'; } if (_0x4a306d === 'horizontal') { if (_0x2eb860(0x2a5) === _0x2eb860(0x496)) { _0x56c767('正在构思中，请稍候...'); return; } else _0xe76a00[_0x2eb860(0x148)](); } } }, { 'passive': ![] }), _0x3556cd[_0x2ab368(0x578)](_0x2ab368(0xa13), _0x71b665 => { const _0x5862e8 = _0x2ab368; if (!_0x2d045f) return; _0x568123 = _0x71b665[_0x5862e8(0x28d)][0x0]['screenX'], _0x4a306d === _0x5862e8(0x6df) && _0xd6de1a(), _0x2d045f = ![]; }); function _0xd6de1a() { const _0x3414bf = 0x32; if (_0x568123 < _0x41ddc4 - _0x3414bf) _0x3cbb10(_0x4e802a + 0x1); else _0x568123 > _0x41ddc4 + _0x3414bf && _0x3cbb10(_0x4e802a - 0x1); } } function _0x2329d7() { return new Promise(_0x5075a5 => { const _0x5bfa89 = _0x2af4, _0x2e467e = document['getElementById'](_0x5bfa89(0x508)), _0x33b5e5 = document[_0x5bfa89(0x248)](_0x5bfa89(0x8b8)), _0xa9eb51 = document[_0x5bfa89(0x248)]('music-input-artist'), _0x5ec084 = document[_0x5bfa89(0x248)](_0x5bfa89(0x5d3)), _0x290168 = document[_0x5bfa89(0x248)](_0x5bfa89(0x780)), _0x1a516e = document[_0x5bfa89(0x248)]('music-input-backdrop'); _0x33b5e5[_0x5bfa89(0xe5)] = '', _0xa9eb51['value'] = '', _0x2e467e[_0x5bfa89(0x882)][_0x5bfa89(0x7c3)](_0x5bfa89(0x11b)), _0x33b5e5[_0x5bfa89(0x6e3)](); const _0x292266 = _0x1ebaa3 => { const _0x40c213 = _0x5bfa89; _0x2e467e[_0x40c213(0x882)][_0x40c213(0xae0)](_0x40c213(0x11b)), _0x5ec084['onclick'] = null, _0x290168[_0x40c213(0x935)] = null, _0x1a516e['onclick'] = null, document['removeEventListener'](_0x40c213(0x44b), _0x3ed10b), _0x5075a5(_0x1ebaa3); }, _0x3fe977 = () => { const _0x536401 = _0x5bfa89, _0x3ae053 = _0x33b5e5[_0x536401(0xe5)]['trim'](), _0x20d4f1 = _0xa9eb51[_0x536401(0xe5)][_0x536401(0x3ee)](); if (!_0x3ae053 || !_0x20d4f1) { if ('giLls' !== _0x536401(0x328)) _0x24c0dd[_0x536401(0x729)](_0x536401(0x7e1), _0x5f427e), _0x367ac4(_0x536401(0x975)); else { _0x3a6c86('歌名和歌手都不能为空！'); return; } } _0x292266({ 'songName': _0x3ae053, 'artist': _0x20d4f1 }); }, _0x3ed10b = _0x1f93f8 => { const _0x154a51 = _0x5bfa89; if (_0x1f93f8['key'] === _0x154a51(0x137)) _0x292266(null); if (_0x1f93f8[_0x154a51(0x797)] === _0x154a51(0x18b)) { if ('JwmQm' !== _0x154a51(0x656)) { _0x19823b[_0x154a51(0x9a1)] = _0x154a51(0x1e5); return; } else _0x1f93f8[_0x154a51(0x148)](), _0x3fe977(); } }; _0x5ec084[_0x5bfa89(0x935)] = _0x3fe977, _0x290168['onclick'] = () => _0x292266(null), _0x1a516e['onclick'] = () => _0x292266(null), document[_0x5bfa89(0x578)]('keydown', _0x3ed10b); }); } function _0x42fef4(_0x158bdb) { const _0x151cde = _0x368b64; if (!_0x158bdb) return []; const _0x54b0f6 = _0x158bdb['trim'](); if (_0x54b0f6['startsWith'](_0x151cde(0x197)) && _0x54b0f6[_0x151cde(0x27f)](_0x151cde(0x489))) return [_0x54b0f6]; const _0x53101c = /(\[sticker:[^\]]+\]|\[music:[^\]]+\]|\[transfer:[^\]]+\]|\[create_event:[^\]]+\])/g, _0x367c3b = _0x151cde(0xa48), _0x36284b = [], _0x27d064 = _0x158bdb[_0x151cde(0x7cf)](_0x53101c, _0x59da72 => { const _0x117da2 = _0x151cde; if (_0x117da2(0x13a) !== 'WsiUS') { if (_0x4ab5ea[_0x117da2(0x848)] === 0x0) return; _0x2a0485 = (_0x23ab24 + 0x1) % _0x261f45[_0x117da2(0x848)], _0x58d692(_0x4e6c42[_0x529bfe], _0x242516); } else return _0x36284b['push'](_0x59da72), _0x367c3b; }), _0x133d4c = _0x27d064['split'](_0x367c3b), _0x25364a = []; let _0x8b6f21 = 0x0; return _0x133d4c['forEach']((_0x242710, _0x4484bf) => { const _0x5afa2c = _0x151cde, _0x533b38 = _0x242710['trim'](); if (_0x533b38) { if (_0x5afa2c(0x767) === 'xzuBo') throw new _0x267bc9(_0x5afa2c(0x2b1) + _0x68556e); else _0x25364a['push'](..._0x41d269(_0x533b38)); } _0x8b6f21 < _0x36284b[_0x5afa2c(0x848)] && (_0x25364a[_0x5afa2c(0x36b)](_0x36284b[_0x8b6f21][_0x5afa2c(0x3ee)]()), _0x8b6f21++); }), _0x25364a; } function _0xfeba70(_0x2fb9ad, _0x3912af, _0x32192e = '') { const _0x5086d0 = _0x368b64, _0x1cc4a1 = document['createElement'](_0x5086d0(0x6ff)); _0x1cc4a1[_0x5086d0(0x296)] = 'avatar-wrapper\x20' + _0x32192e; const _0x87ff1a = document[_0x5086d0(0x3b9)](_0x5086d0(0x204)); _0x87ff1a[_0x5086d0(0x70a)] = _0x2fb9ad, _0x87ff1a[_0x5086d0(0x296)] = _0x5086d0(0x917); const _0x28c0e4 = document[_0x5086d0(0x3b9)](_0x5086d0(0x6ff)); _0x28c0e4['className'] = 'avatar-frame'; if (_0x3912af) { if (_0x5086d0(0x15a) !== _0x5086d0(0xa6f)) _0x28c0e4[_0x5086d0(0x10d)][_0x5086d0(0xad9)] = 'url(\x27' + _0x3912af + '\x27)'; else { const _0x39b482 = _0x471f60(_0x1d8fb2[_0x5086d0(0x9a8)] ?? _0x271c5a[_0x5086d0(0x958)] ?? '')['trim']() || _0x5086d0(0xaab) + (_0x478004 || _0x5086d0(0x481)) + ']'; if (_0x39b482) _0x1695b0[_0x5086d0(0x57f)]['push']({ 'senderId': _0x4b2ab1['id'], 'kind': _0x5086d0(0x958), 'content': _0x39b482 }); } } return _0x1cc4a1['appendChild'](_0x87ff1a), _0x1cc4a1[_0x5086d0(0x6ab)](_0x28c0e4), _0x1cc4a1; } function _0x35da3c(_0x1a418c) { const _0x32db06 = _0x368b64; if (!_0x1a418c) return []; let _0x1901f8 = String(_0x1a418c)[_0x32db06(0x3ee)](); const _0x3354e4 = _0x1901f8['match'](/```(?:json)?([\s\S]*?)```/i); if (_0x3354e4) _0x1901f8 = _0x3354e4[0x1][_0x32db06(0x3ee)](); try { if (_0x32db06(0x2f7) === _0x32db06(0xa85)) { const _0x262b0e = _0x378d2c(_0x5aeaf0[_0x32db06(0x223)]())[_0x32db06(0x1db)](0x2, '0'), _0x5a81b1 = _0x22dfa2(_0x3b8dd8[_0x32db06(0xabe)]())[_0x32db06(0x1db)](0x2, '0'); _0x5d3a0c[_0x32db06(0x9ac)] = _0x262b0e + ':' + _0x5a81b1; const _0x26eb27 = _0x29d110[_0x32db06(0xa84)]() + 0x1, _0x34139f = _0x2097e2[_0x32db06(0x208)](), _0xa0cacc = [_0x32db06(0x905), _0x32db06(0x9a6), _0x32db06(0xa90), _0x32db06(0x50f), _0x32db06(0x9f1), _0x32db06(0x2c5), _0x32db06(0x98d)][_0x356981[_0x32db06(0x381)]()]; _0x549a4d[_0x32db06(0x9ac)] = _0x26eb27 + '月' + _0x34139f + '日\x20' + _0xa0cacc; } else { const _0x17ed4f = JSON['parse'](_0x1901f8); if (_0x17ed4f && Array[_0x32db06(0x796)](_0x17ed4f[_0x32db06(0x31c)])) return _0x17ed4f[_0x32db06(0x31c)]['map'](_0xfaf03 => typeof _0xfaf03 === 'string' ? _0xfaf03 : _0xfaf03?.[_0x32db06(0x9a8)])[_0x32db06(0x54e)](Boolean)['flatMap'](_0x41d269); const _0xa2ceb1 = [_0x32db06(0xfb), 'dialogue', 'message', _0x32db06(0x958), _0x32db06(0x9a8), _0x32db06(0x9f7), _0x32db06(0x18a)]; if (_0x17ed4f && typeof _0x17ed4f === _0x32db06(0xa2d)) { if (_0x32db06(0xa45) !== _0x32db06(0x142)) { const _0x3ce5ab = []; for (const _0x364bd9 of Object[_0x32db06(0x147)](_0x17ed4f)) { if (_0x32db06(0x9a7) === _0x32db06(0x9a7)) { const _0x2cf12d = _0x364bd9[_0x32db06(0x51f)](); if (_0xa2ceb1[_0x32db06(0xacd)](_0x312f3c => _0x2cf12d[_0x32db06(0x33c)](_0x312f3c))) { const _0x25a757 = _0x17ed4f[_0x364bd9]; if (typeof _0x25a757 === 'string') _0x3ce5ab['push'](_0x25a757); if (Array[_0x32db06(0x796)](_0x25a757)) _0x25a757['forEach'](_0x21456c => { const _0x171f3f = _0x32db06; if (_0x171f3f(0x464) === _0x171f3f(0x464)) { if (typeof _0x21456c === _0x171f3f(0x9d1)) _0x3ce5ab[_0x171f3f(0x36b)](_0x21456c); } else throw new _0x36c64a(_0x171f3f(0x15e)); }); } } else _0x364948 = _0x50a754[_0x32db06(0x360)][0x0]; } if (_0x3ce5ab['length']) return _0x3ce5ab[_0x32db06(0x25a)](_0x41d269)['slice'](0x0, 0x9); } else _0x2ab0d5(_0x32db06(0x203) + _0x220355[_0x32db06(0x380)]); } } } catch { } if (/[{\[]/[_0x32db06(0xe6)](_0x1901f8) && /":/['test'](_0x1901f8)) { const _0x4d079d = [], _0x5e993b = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x31893f; while ((_0x31893f = _0x5e993b[_0x32db06(0x55b)](_0x1901f8)) !== null) { const _0x2edd7f = _0x31893f[0x1][_0x32db06(0x7cf)](/\\"/g, '\x22')['replace'](/\\n/g, '\x0a')['trim'](); if (_0x2edd7f) _0x4d079d[_0x32db06(0x36b)](_0x2edd7f); } if (_0x4d079d['length']) return _0x4d079d[_0x32db06(0x25a)](_0x41d269)[_0x32db06(0x53a)](0x0, 0x9); } return _0x41d269(_0x1901f8); } function _0x41d269(_0x44dca6) { const _0x4b5c40 = _0x368b64; if (!_0x44dca6) return []; const _0x26d2f4 = String(_0x44dca6)[_0x4b5c40(0x3ee)](), _0x4d2a69 = _0x26d2f4[_0x4b5c40(0x5ac)](/(?<=[。！？!?…])\s+|[\r\n]+/)[_0x4b5c40(0xa21)](_0x17ffff => _0x17ffff[_0x4b5c40(0x3ee)]())['filter'](Boolean); if (_0x4d2a69[_0x4b5c40(0x848)] > 0x0) return _0x4d2a69['slice'](0x0, 0x9); return [_0x26d2f4][_0x4b5c40(0x54e)](Boolean); } const _0x12b672 = new Promise((_0x5b591b, _0x30b1f6) => { const _0x57d865 = _0x368b64, _0x20a67b = indexedDB[_0x57d865(0x892)](_0x3082ea, 0x3); _0x20a67b[_0x57d865(0x136)] = () => _0x30b1f6('IndexedDB\x20failed\x20to\x20open'), _0x20a67b[_0x57d865(0x330)] = () => _0x5b591b(_0x20a67b[_0x57d865(0x4f7)]), _0x20a67b[_0x57d865(0x114)] = _0x1d7edb => { const _0x45c473 = _0x57d865, _0x3a6a45 = _0x1d7edb[_0x45c473(0x6c4)][_0x45c473(0x4f7)]; console[_0x45c473(0x5e0)]('Upgrading\x20database\x20to\x20version\x20' + _0x3a6a45['version'] + _0x45c473(0x8c5)), !_0x3a6a45[_0x45c473(0xae2)][_0x45c473(0x956)](_0x1b51fb) && (console[_0x45c473(0x5e0)](_0x45c473(0x2a4) + _0x1b51fb), _0x3a6a45[_0x45c473(0x1e4)](_0x1b51fb, { 'keyPath': 'id' })), !_0x3a6a45[_0x45c473(0xae2)][_0x45c473(0x956)]('music_library') && (_0x45c473(0x5e6) === _0x45c473(0x5e6) ? (console[_0x45c473(0x5e0)](_0x45c473(0x395)), _0x3a6a45[_0x45c473(0x1e4)](_0x45c473(0x490), { 'keyPath': 'id' })) : _0x72407d = _0x41f108[_0x45c473(0x329)](_0x597943)), !_0x3a6a45[_0x45c473(0xae2)][_0x45c473(0x956)](_0x4f820a) && (console[_0x45c473(0x5e0)](_0x45c473(0x2a4) + _0x4f820a), _0x3a6a45[_0x45c473(0x1e4)](_0x4f820a, { 'keyPath': 'id' })); }; }); async function _0x533d7a(_0x4b4874) { const _0x379656 = await _0x12b672; return new Promise((_0x263846, _0xa77398) => { const _0x179314 = _0x2af4; if (_0x179314(0x874) === _0x179314(0x874)) { const _0x62356e = _0x379656['transaction'](_0x1b51fb, _0x179314(0x559)), _0x4c2611 = _0x62356e[_0x179314(0x963)](_0x1b51fb), _0x39d6ba = _0x4c2611[_0x179314(0xa25)](_0x4b4874); _0x39d6ba[_0x179314(0x330)] = () => _0x263846(_0x39d6ba[_0x179314(0x4f7)] ? _0x39d6ba['result'][_0x179314(0x226)] : null), _0x39d6ba[_0x179314(0x136)] = () => _0xa77398(_0x39d6ba[_0x179314(0x729)]); } else { const _0x2089d0 = _0x4dc382(_0x40bb00['getHours']())[_0x179314(0x1db)](0x2, '0'), _0x3e2391 = _0x5d8a5c(_0x3f822a['getMinutes']())[_0x179314(0x1db)](0x2, '0'); _0x3028ea[_0x179314(0x9ac)] = _0x2089d0 + ':' + _0x3e2391; const _0x529b30 = _0x3ee052[_0x179314(0xa84)]() + 0x1, _0x11d1f9 = _0x120f68[_0x179314(0x208)](), _0x3f055a = [_0x179314(0x905), _0x179314(0x9a6), _0x179314(0xa90), _0x179314(0x50f), '星期四', _0x179314(0x2c5), _0x179314(0x98d)][_0x131ff8['getDay']()]; _0x27f55a[_0x179314(0x9ac)] = _0x529b30 + '月' + _0x11d1f9 + '日\x20' + _0x3f055a; } }); } async function _0x5dadd7(_0x18f9da) { const _0x59300d = await _0x12b672; return new Promise((_0x338b24, _0x3615ac) => { const _0x2f77df = _0x2af4; if (_0x2f77df(0x7ac) === 'vHbRY') _0x32be42 = _0x2f77df(0x5a8) + _0x225714['id'] + _0x2f77df(0x39d) + (_0x57f965[_0x2f77df(0x2ab)] || _0x42bc51) + _0x2f77df(0x21c) + _0x4705ca[_0x2f77df(0x6d2)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x4790a7[_0x2f77df(0x755)] + _0x2f77df(0x255) + (_0x2c72a7['playableUrl'] ? '▶' : '⚠') + _0x2f77df(0x1ad); else { const _0x244100 = _0x59300d[_0x2f77df(0x319)](_0x4f820a, 'readonly'), _0x4c0e93 = _0x244100[_0x2f77df(0x963)](_0x4f820a), _0x1561e3 = _0x4c0e93['get'](_0x18f9da); _0x1561e3['onsuccess'] = () => _0x338b24(_0x1561e3[_0x2f77df(0x4f7)] ? _0x1561e3[_0x2f77df(0x4f7)][_0x2f77df(0x9be)] : null), _0x1561e3[_0x2f77df(0x136)] = () => _0x3615ac(_0x1561e3[_0x2f77df(0x729)]); } }); } async function _0x23f2ce(_0x2819b2, _0x166b9d) { const _0xd4b5d3 = await _0x12b672; return new Promise((_0x604379, _0x1ffca2) => { const _0x4a65cc = _0x2af4; if (_0x4a65cc(0x7bb) !== _0x4a65cc(0x742)) { const _0x47797f = _0xd4b5d3[_0x4a65cc(0x319)](_0x4f820a, _0x4a65cc(0x52c)), _0x45f838 = _0x47797f[_0x4a65cc(0x963)](_0x4f820a), _0x1e94cf = _0x45f838[_0x4a65cc(0xa8b)]({ 'id': _0x2819b2, 'data': _0x166b9d }); _0x1e94cf['onsuccess'] = () => _0x604379(), _0x1e94cf[_0x4a65cc(0x136)] = () => _0x1ffca2(_0x1e94cf['error']); } else return _0x328b81['log'](_0x4a65cc(0x7e9)), 0x0; }); } async function _0x40ce4b(_0x453716) { const _0x468dea = await _0x12b672; return new Promise((_0x9f6c33, _0x573625) => { const _0x273142 = _0x2af4; if ('crnOZ' === _0x273142(0x6c3)) { const _0x3f65e3 = _0x468dea[_0x273142(0x319)](_0x4f820a, 'readwrite'), _0x3f9d3e = _0x3f65e3['objectStore'](_0x4f820a), _0x5b2544 = _0x3f9d3e[_0x273142(0x845)](_0x453716); _0x5b2544['onsuccess'] = () => _0x9f6c33(), _0x5b2544[_0x273142(0x136)] = () => _0x573625(_0x5b2544[_0x273142(0x729)]); } else _0x470a67['currentDate'] = new _0xbbfb41(), _0x187157[_0x273142(0x592)] = _0xbe42e1(), _0x385ead(); }); } async function _0x5ef29b(_0x21f74a, _0x4e1e82) { const _0x58995b = await _0x12b672; return new Promise((_0x331409, _0x2c3c36) => { const _0x32f052 = _0x2af4; if ('xbuUC' !== _0x32f052(0x221)) _0x16a043[_0x32f052(0x148)](), _0x3272a7(); else { const _0x4c2e05 = _0x58995b['transaction'](_0x1b51fb, _0x32f052(0x52c)), _0x533c7b = _0x4c2e05['objectStore'](_0x1b51fb), _0x224e72 = _0x533c7b['put']({ 'id': _0x21f74a, 'blob': _0x4e1e82 }); _0x224e72[_0x32f052(0x330)] = () => _0x331409(_0x224e72['result']), _0x224e72[_0x32f052(0x136)] = () => _0x2c3c36(_0x224e72[_0x32f052(0x729)]); } }); } async function _0x2e3a29(_0x31d384) { const _0x31d70c = await _0x12b672; return new Promise((_0x3e088a, _0x350fef) => { const _0x56ef55 = _0x2af4, _0x21de63 = _0x31d70c[_0x56ef55(0x319)](_0x1b51fb, _0x56ef55(0x52c)), _0x5ae4e0 = _0x21de63[_0x56ef55(0x963)](_0x1b51fb), _0x56cfa9 = _0x5ae4e0[_0x56ef55(0x845)](_0x31d384); _0x56cfa9[_0x56ef55(0x330)] = () => _0x3e088a(), _0x56cfa9[_0x56ef55(0x136)] = () => _0x350fef(_0x56cfa9['error']); }); } function _0x39f481(_0x2233a0) { const _0x387378 = _0x368b64; return fetch(_0x2233a0)['then'](_0x5e787d => _0x5e787d[_0x387378(0x226)]()); }

  </script>


  <div id="listen-together-ui" style="display: none;">
    <div class="lt-ui-backdrop"></div>
    <div class="lt-ui-main">
      <div class="lt-ui-header">
        <span id="lt-ui-header-title">正在与 TA 一起听</span>
        <button id="lt-ui-close-btn">×</button>
      </div>
      <div class="lt-ui-content">
        <div class="lt-ui-cover-container">
          <img id="lt-ui-cover-art" src="">
        </div>
        <div class="lt-ui-info">
          <h2 id="lt-ui-song-title">歌曲名称</h2>
          <p id="lt-ui-song-artist">歌手</p>
        </div>
        <div id="lt-ui-lyrics-container">
          <p class="no-lyrics-placeholder">暂无歌词</p>
        </div>
      </div>
    </div>
  </div>
  <div id="summarize-modal" class="choice-modal">
    <div id="summarize-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <button id="close-summary-button" class="header-button" style="min-width: 50px;">关闭</button>
        <span class="header-title">聊天记录总结</span>
        <button id="copy-summary-button" class="header-button" style="min-width: 50px;">复制</button>
      </div>
      <div class="content" style="flex-grow: 1; padding: 0;">
        <textarea id="summary-textarea" placeholder="AI正在拼命总结中，别催..."></textarea>
      </div>
    </div>
  </div>

  <div id="add-event-modal" class="choice-modal">
    <div id="add-event-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 320px;">
      <h3 id="add-event-modal-title" style="margin-top: 0; text-align: center;">为 YYYY-MM-DD 添加...</h3>
      <div class="input-group">
        <label for="event-content-input">内容</label>
        <input type="text" id="event-content-input" placeholder="要做什么或者是什么日子？">
      </div>
      <div class="input-group">
        <label>类型</label>
        <div style="display: flex; gap: 10px; margin-top: 5px;">
          <input type="radio" id="event-type-todo" name="event-type" value="todo" checked>
          <label for="event-type-todo" style="width: auto;">普通日程</label>
          <input type="radio" id="event-type-important" name="event-type" value="important">
          <label for="event-type-important" style="width: auto;">重要纪念日</label>
        </div>
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="save-event-button" class="form-button primary">保存</button>
        <button id="cancel-event-button" class="form-button secondary">取消</button>
      </div>
    </div>
  </div>


</body>

</html>
