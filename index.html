<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

  <title>Noir搓的小手机</title>
  <style>
    .message p,
    .diary-content {
      user-select: none;
      -webkit-user-select: none;
    }

    .lt-end-session-btn {
      font-size: 1.5rem;
      color: inherit;
      /* 继承父元素的颜色 */
      opacity: 0.6;
      cursor: pointer;
      padding: 0 5px;
      line-height: 1;
      font-weight: bold;
    }

    .lt-end-session-btn:hover {
      opacity: 1;
    }

    /* --- Noir's Refactor: Feed Loader Style --- */
    #feed-loader {
      position: absolute;
      inset: 0;
      background: rgba(244, 248, 255, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--text-color);
      font-size: 1rem;
      flex-direction: column;
      gap: 10px;
    }

    .loader-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* --- End of Refactor --- */
    /*
        Noir's Mizuiro Theme
        - 哼，看好了，这才是设计。
      */
    /*
          Noir's Mizuiro Theme
          - 哼，看好了，这才是设计。
        */
    :root {
      --phone-width: 375px;
      --phone-height: 812px;
      --user-bg-image: url('');

      /* === Noir's Ultimate Dynamic Theme Engine v2.0 === */
      /* 哼，现在所有的颜色都听从这三个总开关的指挥。*/
      --primary-hue: 35;
      --primary-saturation: 25%;
      --primary-lightness: 80%;

      /* 核心颜色 */
      --primary-color: hsl(var(--primary-hue), var(--primary-saturation), var(--primary-lightness));
      /* 强调色/用户气泡色，现在也是动态的 */
      --accent-color: hsl(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%));

      /* 哼，看好了，这些就是被我重新接上线的“电灯” */

      /* 文字颜色：根据主题亮度自动变深或变浅 */
      --text-color: hsl(var(--primary-hue), 15%, calc(100% - var(--primary-lightness) / 1.1));
      --text-color-light: hsl(var(--primary-hue), 10%, calc(100% - var(--primary-lightness) / 1.3));

      /* 表面背景：半透明，亮度比主色高一点 */
      --surface-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.4);

      /* 卡片/AI气泡背景：比表面背景更亮一点 */
      --card-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.5);

      /* 边框颜色 */
      --border-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness)), 0.3);

      /* 阴影颜色 */
      --soft-shadow: 0 4px 12px hsla(var(--primary-hue), 40%, calc(var(--primary-lightness) - 10%), 0.15);

      /* 动态页的设置保持不变 */
      --feed-bg-image: none;
      --feed-overlay-opacity: 0.12;
      --feed-overlay-rotate: 22deg;
      --feed-overlay-speed: 48s;

      /* 气泡样式也完全动态化 */
      --bubble-radius: 18px;
      --bubble-outline: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
      --bubble-user-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%), 0.5);
      /* <-- 哼，改成0.5，现在够“虚无”了吧 */
      --bubble-ai-bg: var(--card-bg);

      /* ▼▼▼ 把下面这两行加进去 ▼▼▼ */
      --dropdown-alpha: 0.9;
      /* 下拉菜单的透明度，0到1 */
      --feed-card-alpha: 0.7;
      /* 动态卡片的透明度，0到1 */


      /* ▲▲▲ 添加到这里结束 ▲▲▲ */

    }

    /* Noir's Font Decree */
    body {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100vh;
      margin: 0;
      /* 哼，看好了，就是这句！现在字体听从我的新变量指揮了！ */
      font-family: var(--custom-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif);
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
    }

    /* 让字体预览区也听话 */
    #font-preview-text {
      font-family: var(--custom-font-family, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif);
    }

    #phone-container {
      width: 100%;
      /* 占满屏幕宽度 */
      height: 100vh;
      /* 占满屏幕高度 */
      background-color: white;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* 是不是清爽多了？ */
      position: relative;
      /* <-- 就是这句，告诉它“你是个家长了，给我看好家里的东西！” */
    }

    .screen {
      flex-grow: 1;
      display: none;
      flex-direction: column;
      background-color: #f9f9f9;
      /* 哼，所有屏幕默认都给我变白 */
      /* 让背景透出来 */
      overflow: hidden;
      color: var(--text-color);
    }

    .screen.active {
      display: flex;
    }

    /* 这个是通用的头像预览样式 */
    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
      margin-top: 5px;
      cursor: pointer;
    }

    /* --- 通用顶栏 --- */
    .header,
    #chat-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--primary-color);
      font-weight: 500;
      min-width: 50px;
      text-align: center;
      /* ▼▼▼ 哼，加上这三句，给我立正站好 ▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- 聊天列表 --- */
    #chat-list-pane {
      background-color: transparent;
      border-right: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 加上这句 */
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      /* 防止它在横向布局里被挤扁 */
      display: flex;
      flex-direction: column;
    }

    #chat-list-container {
      flex-grow: 1;
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
    }

    #character-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .character-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      /* backdrop-filter: blur(10px);*/
      border-radius: 16px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .character-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(138, 180, 228, 0.2);
    }

    .char-info-wrapper {
      flex-grow: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .character-item .char-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      margin-right: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .character-item .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .character-item .char-remark {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    #chat-screen-container {
      position: relative;
      /* 告诉里面的绝对定位元素，要以我为基准 */
      flex-grow: 1;
      /* 确保它能撑满 chat-screen 的空间 */
      overflow: hidden;
      /* 把滑出去的部分藏起来，这很重要 */
      display: flex;
      /* 保持内部元素的 flex 布局 */
    }

    /* --- 聊天窗口 --- */


    #chat-view-pane {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 还有这句 */
      background-color: transparent;
      z-index: 10;
    }

    #chat-screen.show-chat-view #chat-list-pane {
      transform: translateX(-100%);
    }

    #chat-screen.show-chat-view #chat-view-pane {
      transform: translateX(0);
    }

    #chat-messages {
      flex-grow: 1;
      padding: 5px;
      overflow-y: auto;
      display: flex;
      /* <-- 加上这个 */
      flex-direction: column;
      /* <-- 还有这个 */
      contain: content;
      contain: content;
      /* <-- 哼，就是这句救命神药！ */
    }



    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;

      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.7);
      flex-shrink: 0;
    }

    .message {
      padding: 10px 16px;
      border-radius: 20px;
      line-height: 1.5;
      word-break: break-word;
      box-shadow: var(--soft-shadow);
    }

    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
    }

    .message.user {
      background-color: var(--accent-color);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .message.ai {
      background-color: var(--card-bg);
      border: 1px solid rgba(255, 255, 255, 0.8);
      color: var(--text-color);
      border-bottom-left-radius: 5px;
    }

    .message p {
      margin: 0;
    }

    .sticker-content,
    .message-image-content {
      max-width: 120px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
    }

    .message-image-content {
      max-width: 160px;
    }

    /* --- 其他屏幕和组件 --- */
    /* --- Noir's Fix: API 模型列表的样式修正 --- */
    .model-input-container {
      position: relative;
      /* 关键！让里面的绝对定位元素有家可回 */
      display: flex;
      gap: 8px;
    }

    .custom-model-dropdown {
      display: none;
      /* 默认藏起来 */
      position: absolute;
      top: 100%;
      /* 精准定位到输入框正下方 */
      left: 0;
      right: 80px;
      /* 留出“获取”按钮的位置 */
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*   backdrop-filter: blur(10px);*/
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 100;
      /* 确保它在最上层 */
      box-shadow: var(--soft-shadow);
    }

    .checkboxes-container {
      display: none;
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*  backdrop-filter: blur(10px);*/
      z-index: 10;
      border-radius: 8px;
      margin-top: 4px;
    }

    .custom-model-dropdown.show {
      display: block;
      /* 需要的时候再显示 */
    }

    .custom-model-dropdown div {
      padding: 10px 12px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    .custom-model-dropdown div:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    /* --- 其他屏幕和组件 --- */
    /* 在这个注释下面加上主屏幕的样式 */
    #home-screen {
      position: relative;
      /* <-- 就加上这一行！ */


      gap: 20px;
      /* 图标之间的距离 */

      /* 声明！这里现在是我的地盘！*/
      flex-direction: column;
      /* 里面的东西，全体给我垂直排队！*/
      justify-content: space-between;
      /* 核心！顶部和底部的元素给我贴边站好，中间的自动拉开距离！*/
      padding-bottom: 0;
      /* 把内边距去掉，让Dock栏能完美贴底 */
    }

    .app-icon {
      width: 75px;
      /* <--- 就是这里，我把它加宽了 */
      height: 90px;
      /* <--- 高度也顺便调整一下 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: absolute;
      z-index: 40;
      padding: 5px;
      box-sizing: border-box;
      margin: 0;
    }

    .app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 2px;
      /* <-- 哼，就是这里，把5px改成2px，让图标和文字的距离拉近一点 */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      background-color: var(--surface-bg);
      box-shadow: none;
      transition: transform 0.2s ease;
    }

    .app-icon-img svg {
      stroke: currentColor;
      /* SVG的线条颜色会继承上面的 color */
    }

    .app-icon span {
      font-size: 0.75rem;
      /* 文本也相应缩小 */
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }

    .content {
      padding: 20px;
      overflow-y: auto;
      flex-grow: 1;
      /* <-- 加上这行代码，就是这行！ */
    }

    .form-button {
      width: 100%;
      padding: 12px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--border-color);
      color: var(--text-color);
      border-radius: 8px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    .chat-toolbar {
      display: flex;
      padding: 5px 10px;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      /*   backdrop-filter: blur(10px);*/
      flex-shrink: 0;
    }

    /* ▼▼▼ 用下面这段，替换掉你旧的 .toolbar-button 样式 ▼▼▼ */
    .toolbar-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      /* 这个保留，作为SVG尺寸的参考 */
      cursor: pointer;
      padding: 8px;
      /* 稍微增大点击区域 */
      color: var(--text-color-light);
      /* 让它默认是浅灰色 */
      border-radius: 50%;
      /* 让背景有个圆形轮廓 */
      width: 40px;
      height: 40px;
      display: flex;
      /* 使用flex布局让SVG完美居中 */
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s, color 0.2s;
      /* 加上顺滑的过渡效果 */
    }

    .toolbar-button:hover {
      background-color: var(--border-color);
      /* 鼠标悬停时给个背景 */
      color: var(--primary-color);
      /* 图标颜色变为主题色 */
    }

    /* ▲▲▲ 替换到这里为止 ▲▲▲ */


    /* ▼▼▼ 在下面新增这段SVG的专属样式 ▼▼▼ */
    .toolbar-button svg {
      width: 22px;
      /* SVG图标的尺寸 */
      height: 22px;
      stroke-width: 1.8;
      /* 线条粗细，可以微调 */
      stroke: currentColor;
      /* 核心！让SVG的颜色继承按钮的color属性 */
      fill: none;
      /* 确保是线稿风格 */
      pointer-events: none;
      /* 防止SVG本身干扰点击事件 */
    }

    /* ▲▲▲ 新增到这里为止 ▲▲▲ */

    .sticker-panel {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      flex-shrink: 0;
    }

    .sticker-panel.show {
      display: grid;
    }

    /* --- 输入区域 --- */
    /* --- 输入区域 --- */
    .chat-input-area {
      padding: 10px 12px calc(env(safe-area-inset-bottom, 0px) + 10px);
      background: var(--surface-bg);
      /*  backdrop-filter: saturate(1.2) blur(10px);*/
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    /* 这是我加的新容器，用来实现完美对齐 */
    #chat-input-wrapper {
      display: flex;
      /* Flex大法好，哼 */
      align-items: center;
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 2px 5px;
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-input-wrapper:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-message-input {
      flex-grow: 1;
      /* 让输入框占满剩余空间 */
      border: none;
      background: transparent;
      padding: 9px 12px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 38px;
      width: 38px;
      border: 0;
      border-radius: 50%;
      font-size: 1.2rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
      flex-shrink: 0;
      /* 防止被挤压 */
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    /* 回复按钮，给个不一样的颜色区分 */
    #chat-get-reply-button {
      background: var(--accent-color);
      font-size: 1.5rem;
      /* 让箭头更清晰 */
    }

    #chat-message-input {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 11px 16px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-message-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 40px;
      padding: 0 18px;
      border: 0;
      border-radius: 20px;
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    #chat-get-reply-button {
      display: flex;
      /* 隐藏旧的回复按钮，样式统一到发送按钮 */
    }


    /* --- 引用样式 --- */
    .quote-preview {
      display: none;
      padding: 8px 12px;
      background-color: rgba(255, 255, 255, 0.5);
      border-left: 3px solid var(--primary-color);
      margin: 0 12px 8px;
      border-radius: 6px;
      position: relative;
    }

    #quote-preview-sender {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--primary-color);
    }

    #quote-preview-text {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    .cancel-quote-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #999;
      cursor: pointer;
    }

    .quoted-message-in-bubble {
      background-color: rgba(0, 0, 0, 0.04);
      padding: 8px 10px;
      border-left: 3px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quoted-sender {
      font-weight: bold;
      font-size: 0.8rem;
      color: var(--text-color);
    }

    .quoted-content {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    /* 这是弹窗的“骨架”，让它能居中浮动在屏幕上 */
    .choice-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .choice-modal.show {
      opacity: 1;
      visibility: visible;
    }


    /* --- 弹窗 --- */
    .choice-modal-backdrop {
      background: rgba(0, 0, 0, 0.2);
      /*  backdrop-filter: blur(4px);*/
    }

    .choice-modal-content {
      background: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .choice-modal-button {
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.5);
    }

    .choice-modal-button:hover {
      background-color: rgba(255, 255, 255, 1);
    }

    .choice-modal-button.cancel {
      color: var(--primary-color);
      background: transparent;
    }

    /* --- Noir's Fix: 让“添加”弹窗从底部滑出，更大气 --- */
    #add-choice-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      /* 确保不会超出手机宽度 */
      margin: 0;
      border-radius: 20px 20px 0 0;
      /* 只留顶部圆角 */
      border-bottom-left-radius: 0;
      /* 覆盖通用样式 */
      border-bottom-right-radius: 0;
      /* 覆盖通用样式 */
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      /* 适配iPhone底部安全区 */
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #add-choice-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #add-choice-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
      justify-content: center;
    }

    /* 按钮也重新设计一下，让它们竖着排 */
    #add-choice-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- Noir's Fix: 修正创建群聊时，成员选择列表的样式 --- */
    .member-selection-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .member-selection-item:last-child {
      border-bottom: none;
    }

    /* 关键！就是这里，把头像大小锁死 */
    .member-selection-item .char-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 15px 0 10px;
      object-fit: cover;
    }

    .member-selection-item .char-name {
      font-weight: 500;
      color: var(--text-color);
    }

    .member-selection-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      accent-color: var(--primary-color);
      /* 让勾选框颜色也跟主题统一 */
    }

    /* --- Noir's World Book Styles --- */
    #world-book-list-container {
      padding: 10px;
    }

    .world-book-item {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .world-book-item-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .world-book-item-preview {
      font-size: 0.9rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* --- Noir's Fancy Multi-Select Styles --- */
    .custom-multiselect {
      position: relative;
      user-select: none;
    }

    .select-box {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .select-box.expanded .arrow {
      transform: rotate(180deg);
    }


    .checkboxes-container.visible {
      display: block;
    }

    .checkboxes-container label {
      display: block;
      padding: 10px 12px;
    }

    .checkboxes-container label:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    .checkboxes-container input[type="checkbox"] {
      margin-right: 8px;
      width: auto;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Clock & Timestamp Styles --- */
    /* --- Noir's Badge & App Dock Styles --- */
    #decorative-badge {
      width: 160px;
      height: 160px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
      /* 哼，给你加个阴影，看起来才像样 */
      transform: rotate(-0deg);
      /* 稍微歪一点，显得随意 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      /* 防止拖动时选中图片 */
      z-index: 50;
    }

    #decorative-badge:active {

      transform: rotate(-2deg) scale(1.05);
      /* 抓起来的时候，摆正放大一点 */
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }


    #decorative-badge img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* 保留这句，让你的图片能被很好地填充 */
    }

    /*  #a#app-dock-bottom-left,
    #app-dock-top-right {
      
      哼，现在你们只是幽灵了。
      不需要任何样式，你们的孩子（App图标）会自己找到回家的路。
      它们会相对于 #home-screen 定位。
    
    }
*/

    /* --- Noir's Author Mark: Pixel Chicken --- */
    /* 哼，这就是那个吵着要加的小鸡图标 */
    #noir-author-mark {
      position: absolute;
      /* 相对于父容器定位 */
      right: -30px;
      /* 调整它在时钟右边的位置 */
      top: 50%;
      /* 垂直居中 */
      transform: translateY(-50%);
      /* 精确对齐 */
      width: 20px;
      /* 小鸡的尺寸 */
      height: 20px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="0"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM12 4c.69 0 1.25.56 1.25 1.25S12.69 6.5 12 6.5s-1.25-.56-1.25-1.25S11.31 4 12 4zm0 2c-.69 0-1.25.56-1.25 1.25S11.31 8.5 12 8.5s1.25-.56 1.25-1.25S12.69 6 12 6zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 9.75 10 9.75s1.25-.56 1.25-1.25S10.69 8 10 8zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 9.75 12 9.75s1.25-.56 1.25-1.25S12.69 8 12 8zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 9.75 14 9.75s1.25-.56 1.25-1.25S14.69 8 14 8zM10 10c-.69 0-1.25.56-1.25 1.25S9.31 12.5 10 12.5s1.25-.56 1.25-1.25S10.69 10 10 10zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 12.5 12 12.5s1.25-.56 1.25-1.25S12.69 10 12 10zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 12.5 14 12.5s1.25-.56 1.25-1.25S14.69 10 14 10zM12 12c-.69 0-1.25.56-1.25 1.25S11.31 14.5 12 14.5s1.25-.56 1.25-1.25S12.69 12 12 12zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 15.75 10 15.75s1.25-.56 1.25-1.25S10.69 14 10 14zm4 0c-.69 0-1.25.56-1.25 1.25S13.31 15.75 14 15.75s1.25-.56 1.25-1.25S14.69 14 14 14zM12 16c-.69 0-1.25.56-1.25 1.25S11.31 18.5 12 18.5s1.25-.56 1.25-1.25S12.69 16 12 16zM6 10c-.69 0-1.25.56-1.25 1.25S5.31 12.5 6 12.5s1.25-.56 1.25-1.25S6.69 10 6 10zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 12.5 18 12.5s1.25-.56 1.25-1.25S18.69 10 18 10zM12 20c-.69 0-1.25.56-1.25 1.25S11.31 22.5 12 22.5s1.25-.56 1.25-1.25S12.69 20 12 20zM6 14c-.69 0-1.25.56-1.25 1.25S5.31 15.75 6 15.75s1.25-.56 1.25-1.25S6.69 14 6 14zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 15.75 18 15.75s1.25-.56 1.25-1.25S18.69 14 18 14z"/></svg>');
      /* 这是SVG小鸡的Data URI，白色像素风格 */
      background-size: contain;
      background-repeat: no-repeat;
      cursor: pointer;
      /* 提示可点击 */
      opacity: 0.6;
      /* 稍微透明一点，不那么突兀 */
      transition: opacity 0.2s ease-in-out;
      /* 鼠标悬停效果 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    #noir-author-mark:hover {
      opacity: 1;
      /* 鼠标悬停时完全显示 */
    }

    /* 调整时钟容器，为小鸡留出空间并方便定位 */
    .home-clock-container {
      position: relative;
      /* 确保小鸡能相对它定位 */
      /* ... (保留你已有的其他时钟样式) ... */
      padding-right: 40px;
      /* 给小鸡留出一些右边距 */
    }

    #home-clock-container {
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      text-align: center;
      position: absolute;
      /* top, left, right 都被我删了，哼，现在它完全听JS的指挥 */

      /* 这行可以留着，虽然你已经不让它拖了 */
      z-index: 50;
    }

    #home-time {
      font-size: 80px;
      font-weight: 360;
      /* <--- 我把字重从200加到了300，比原来粗，但又不会笨重，这才是高级感。 */
      letter-spacing: -1px;
      /* <--- 字间距也给你调紧了一点，看起来更整体。 */
    }

    #home-date {
      font-size: 1rem;
      /* <--- 稍微缩小一点，让时间更突出 */
      font-weight: 400;
      margin-top: 8px;
      opacity: 0.8;
      text-transform: uppercase;
      /* <--- 日期我给你换成了全大写，这才有那股‘性冷淡’的味道。 */
      letter-spacing: 1px;
      /* <--- 顺便拉开一点点间距，免得挤在一起。 */
    }

    /* 聊天气泡时间戳的样式 */
    .timestamp {
      font-size: 0.7rem;
      color: var(--text-color-light);
      padding: 0 5px;
      margin-bottom: 3px;
      /* 让它和气泡底部对齐 */
    }

    /* 第一段：这是消息容器的基础样式 */
    .message-container {
      display: flex;
      /* 启用flex布局 */
      flex-direction: column;
      /* 让气泡和时间戳垂直排列 */
      margin-bottom: 10px;
      max-width: 85%;
      /* 限制整个容器的最大宽度 */
    }

    /* 第二段：这是根据发言者进行左右对齐的样式 */
    .message-container.user {
      align-self: flex-end;
      /* 让用户方整个容器靠右 */
      align-items: flex-end;
      /* 让容器内部的元素（气泡、时间戳）也靠右 */
    }

    .message-container.ai {
      align-self: flex-start;
      /* 让AI方整个容器靠左 */
      align-items: flex-start;
      /* 让容器内部的元素（气泡、时间戳）也靠左 */
    }

    .message-bubble-row {
      display: flex;
      align-items: flex-end;
      width: 100%;
    }

    .message-container.user .message-bubble-row {
      justify-content: flex-end;
    }

    .message-container.ai .message-bubble-row {
      justify-content: flex-end;
    }



    /* 这是给表情选择面板里，每一个小表情图片用的样式 */
    .sticker-item {
      width: 100%;
      /* 自动填满网格单元格的宽度 */
      aspect-ratio: 1 / 1;
      /* 保持1:1的宽高比，让它变成正方形 */
      object-fit: cover;
      /* 图片会被裁剪以适应正方形，不变形 */
      border-radius: 8px;
      /* 加个小圆角 */
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .sticker-item:hover {
      transform: scale(1.1);
      /* 鼠标放上去时稍微放大，增加交互感 */
    }

    /* --- Noir's Offline Scene Styles --- */
    #meeting-scene-view {
      flex-grow: 1;
      /* <-- 核心：让它占满所有可用空间 */
      overflow-y: auto;
      /* <-- 核心：内容多了就内部滚动 */
      padding: 20px;
      font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif;
      background-size: cover;
      background-position: center;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }

    #chat-view-pane.offline-mode #offline-scene-view {
      display: block;
      /* 在线下模式时显示 */
    }

    #chat-view-pane.offline-mode #chat-messages {
      display: none;
      /* 在线下模式时隐藏气泡聊天 */
    }

    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      /* 保留换行和空格，这对于小说格式至关重要 */
      font-size: 1rem;
    }

    /* --- Noir's Offline Scene Dialogue Box Style --- */
    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 1rem;

      /* <--- Noir's Addition: 为对话框添加半透明背景和内边距 */
      background-color: rgba(0, 0, 0, 0.4);
      /* 半透明黑色背景 */
      padding: 15px 20px;
      /* 内边距，让文字与边框有距离 */
      border-radius: 8px;
      /* 圆角边框，更柔和 */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      /* 轻轻的阴影，增加立体感 */
    }

    #offline-scene-view .narrator {
      color: #d1d5db;
      /* 旁白用浅灰色 */
      font-style: italic;
    }

    #offline-scene-view .speaker-user {
      color: #a7c7e7;
      /* 用户的发言用一种柔和的蓝色 */
      font-weight: bold;
    }

    #offline-scene-view .speaker-ai {
      color: #f2b7c6;
      /* AI的发言用柔和的粉色，形成对比 */
      font-weight: bold;
    }

    /* --- Noir's Typing Indicator Style --- */
    .typing-indicator {
      padding: 10px 15px;
      color: var(--text-color-light);
      font-style: italic;
      font-size: 0.9rem;
      align-self: flex-start;
      /* 让它和AI气泡一样靠左 */
      margin-left: 50px;
      /* 和AI气泡对齐 */
    }

    #offline-scene-view .typing-indicator {
      color: rgba(255, 255, 255, 0.8);
      /* 在暗色背景下用亮色 */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      /* 同样的文字阴影，保持队形 */
      padding: 10px 0;
      margin-left: 0;
      /* 在小说视图里不需要缩进 */
    }

    /* --- Noir's Final Alignment Fix --- */
    .message-container.ai .timestamp {
      /* 哼，给你加上头像宽度(40px) + 左右边距(10px)的距离 */
      margin-left: 50px;
    }

    .message-container.user .timestamp {
      /* 另一边也是一样，真是麻烦死了 */
      margin-right: 50px;
    }

    /* --- Noir's Music Feed & Player Styles --- */
    #music-feed-container {
      padding-bottom: 70px;
      contain: content;
      /* 为底部播放器留出空间 */
    }

    /* 动态页：默认白底；如设置 --feed-bg-image 则显示独立壁纸 + 轻动画叠层 */
    #music-screen {
      background-color: #fff;
      /* 默认白底 */
      background-image: var(--feed-bg-image);
      /* 单独壁纸，不设就是 none */
      background-size: cover;
      background-position: center;
      contain: paint;
      /* 降低重绘范围，省电 */
    }

    /* 轻动画彩雾叠层：仅图层，不拦点击 */
    #music-screen::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        conic-gradient(from var(--feed-overlay-rotate),
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 0%,
          transparent 20%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 40%,
          transparent 60%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 80%,
          transparent 100%);
      transform: translateZ(0);
      animation: feed-pan var(--feed-overlay-speed) linear infinite;
    }

    /* 超慢速平移旋转，基本不占 GPU */
    @keyframes feed-pan {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }

      50% {
        transform: translate3d(1.2%, 0.8%, 0) rotate(2deg) scale(1.02);
      }

      100% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }
    }

    /* 系统降低动画偏好时，自动停掉动画 */
    @media (prefers-reduced-motion: reduce) {
      #music-screen::before {
        animation: none;
      }
    }


    .music-post {
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), var(--feed-card-alpha));
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: var(--soft-shadow);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .music-post-header {
      display: flex;
      align-items: center;
      padding: 12px 15px;
    }

    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .music-post-header .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .music-post-thought {
      padding: 0 15px 15px;
      font-size: 0.95rem;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .music-post-song-card {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.04);
      padding: 12px 15px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .music-post-song-card:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    .music-post-song-card img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }

    .music-post-song-info {
      flex-grow: 1;
    }

    .music-post-song-info .title {
      font-weight: 500;
      color: var(--text-color);
    }

    .music-post-song-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    .music-post-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    #music-player-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--surface-bg);
      /*backdrop-filter: blur(10px);*/
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 10px;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    #music-player-bar:not(.hidden) {
      transform: translateY(0);
    }

    #music-player-bar.hidden {
      display: none;
      /* 彻底隐藏，避免交互问题 */
    }


    #player-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
    }

    #player-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #player-title,
    #player-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #player-title {
      font-weight: 500;
    }

    #player-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #player-controls button {
      background: none;
      border: 2px solid var(--text-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Share Bubble Styles --- */
    .message.music {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
      max-width: 250px;
      /* 限制一下最大宽度 */
    }

    .music-share-card {
      display: flex;
      align-items: center;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
    }

    .message-container.user .music-share-card {
      background-color: var(--accent-color);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .message-container.user .music-share-card .title,
    .message-container.user .music-share-card .artist,
    .message-container.user .music-share-card .play-icon {
      color: white;
    }


    .music-share-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .music-share-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-share-info .title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #music-screen {
      position: relative;
      /* 就是这句，告诉里面的绝对定位元素，以我为界！ */
    }

    /* --- Noir's Fancy Music Widget Styles --- */
    /* --- Noir's Music System Refactor --- */

    #music-widget:not(.hidden) {
      transform: translateY(0);
      /* 不隐藏时，滑上来 */
    }

    #music-widget.hidden {
      transform: translateY(150%);
      /* 隐藏时，滑下去 */
    }

    .widget-vinyl {
      width: 80px;
      height: 80px;
      background-color: #111;
      border-radius: 50%;
      position: relative;
      left: 20px;
      /* 向右移动，让卡片能盖住它 */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      background-image:
        radial-gradient(circle at center, #555 10%, transparent 11%),
        radial-gradient(circle at center, #fff 12%, transparent 13%);
      animation: spin 8s linear infinite;
      z-index: 1;
    }

    @keyframes spin {
      from {
        transform: translate(-50%, -50%) rotate(0deg);
        /* <-- 看见没，把咒语合并了 */
      }

      to {
        transform: translate(-50%, -50%) rotate(360deg);
        /* <-- 这里也是 */
      }
    }

    .widget-card {
      width: 240px;
      padding: 15px;
      background-color: var(--card-bg);
      /*  backdrop-filter: blur(10px);*/
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      z-index: 2;
      /* 让卡片在唱片上方 */
    }

    .widget-card img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .widget-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #widget-title,
    #widget-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #widget-title {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    #widget-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #widget-play-icon {
      font-size: 1.2rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #card-widget {
      width: 335px;
      height: 170px;
      border-radius: 18px;
      /* 这就是圆角方形的关键 */
      background-color: rgba(255, 255, 255, 0.5);
      /* 加个底色，免得图片透明时不好看 */

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transform: rotate(0deg);
      /* 朝另一个方向歪 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      /* 比爱心高一层 */
      overflow: hidden;
      /* 防止图片溢出圆角 */
    }


    /* --- End of Protocol --- */

    /* --- Noir's "Center Alignment" Protocol --- */

    /* --- End of Protocol --- */

    #card-widget:active {

      transform: rotate(1deg) scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Noir's Ultimate Scrollbar Hider --- */
    /* For Webkit browsers like Chrome, Safari */
    ::-webkit-scrollbar {
      display: none;
    }

    /* For Firefox */
    * {
      scrollbar-width: none;
    }

    /* --- Noir's Fix: 美化消息操作弹窗 --- */
    #message-action-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
    }

    #message-action-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      margin: 0;
      border-radius: 20px 20px 0 0;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #message-action-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #message-action-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- End of Fix --- */
    /* --- Noir's Fix: Fancy User Post Area --- */
    #user-post-input-container {
      display: flex;
      gap: 10px;
    }

    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
    }

    #user-post-main-area {
      flex-grow: 1;
    }

    #user-post-textarea {
      width: 100%;
      border: none;
      background: transparent;
      outline: none;
      resize: vertical;
      font-size: 1rem;
      color: var(--text-color);
    }

    #user-post-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    /* ... 你已有的 #user-post-toolbar 样式 ... */

    /* ▼▼▼ Noir's Command: 哼，给我站成一排！ ▼▼▼ */
    #user-post-actions {
      display: flex;
      /* <-- 这就是圣旨本身 */
      gap: 8px;
      /* <-- 这是我赏赐的间距，让它们别挤在一起 */
    }

    /* ▲▲▲ Command End ▲▲▲ */

    #user-send-post-button {
      padding: 6px 18px;
      border-radius: 16px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    /* 这是附件预览的样式 */
    #user-post-attachment-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-item {
      position: relative;
      max-width: 100px;
    }

    .preview-item img {
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
    }

    .preview-item .music-preview-card {
      display: flex;
      align-items: center;
      padding: 8px;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      width: 200px;
      /* 给音乐卡片宽一点 */
    }

    .preview-item .music-preview-card img {
      width: 30px;
      height: 30px;
      margin-right: 8px;
    }

    .preview-item .music-preview-card .info {
      font-size: 0.8rem;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .remove-attachment-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    /* --- Noir's Fix: Post Image Display Style --- */
    .post-image-container {
      padding: 0 15px 15px;
      /* 图片和文字之间留点空隙 */
    }

    .post-image {
      max-width: 100%;
      /* 图片最宽不能超过帖子宽度 */
      max-height: 400px;
      /* 最高400像素，防止长图刷屏 */
      border-radius: 8px;
      /* 加个小圆角，好看 */
      object-fit: cover;
      /* 保持图片比例，不变形 */
      display: block;
      /* 解决图片底部多余的空隙问题 */
    }

    /* --- Noir's Refactor: New Post Interaction Styles --- */
    .post-interactions {
      padding: 10px 15px;
      background-color: rgba(0, 0, 0, 0.02);
      border-top: 1px solid var(--border-color);
      font-size: 0.9rem;
    }

    .post-likes {
      color: var(--primary-color);
      margin-bottom: 8px;
    }

    .post-comments-container {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .post-comment {
      color: var(--text-color);
    }

    .post-comment .comment-author {
      font-weight: 600;
      color: var(--text-color);
    }

    .post-timestamp {
      font-size: 0.75rem;
      color: var(--text-color-light);
      padding: 0 15px 10px;
    }



    /* 覆盖：基础气泡体 */
    /* 覆盖：基础气泡体 */
    .message {
      border-radius: var(--bubble-radius);
      line-height: 1.55;
      padding: 10px 14px;
      box-shadow:
        0 1px 0 rgba(0, 0, 0, .03),
        0 4px 10px rgba(0, 0, 0, .06);
      /* 比你原先更浅，省功耗 */
      border: 1px solid var(--bubble-outline);
      backdrop-filter: none !important;
      /* 绝不启用重滤镜 */
      will-change: auto;
      /* 不抢 GPU 配额 */

      /* --- Noir's Fix: 就是下面这两行，哼 --- */
      user-select: none;
      /* 标准浏览器给我听话，不许选中 */
      -webkit-user-select: none;
      /* 那些老古董浏览器也一样 */
    }

    /* 你的气泡（右侧） */
    .message.user {
      color: #fff;
      background: var(--bubble-user-bg);
      border-bottom-right-radius: 6px;
      /* 微“角”保留你原味 */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .12);
      /* 细腻但很轻 */
    }

    /* TA 的气泡（左侧） */
    .message.ai {
      color: var(--text-color);
      background: var(--bubble-ai-bg);
      border-bottom-left-radius: 6px;
    }

    /* 细节：图片/贴纸消息不套背景 */
    /* 细节：图片/贴纸/音乐卡片消息不套背景 */
    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image,
    .message.user.music,
    /* <-- 哼，加上这两行 */
    .message.ai.music {
      background: transparent;
      border: 0;
      box-shadow: none;
      padding: 0;
    }

    /* 轻触态：不使用阴影动画，避免合成层抖动 */
    .message:active {
      transform: scale(.996);
    }

    /* 引用块在气泡内的融合感 */
    .quoted-message-in-bubble {
      background: rgba(0, 0, 0, .045);
      border: 1px solid color-mix(in hsl, var(--primary-color) 18%, transparent);
      border-radius: 10px;
    }


    /* --- Noir's Transfer Bubble Style --- */
    .message.transfer {
      background: #F79232;
      /* 哼，一个温暖又醒目的橙色 */
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      width: 220px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    /* 我还给左右两边做了区分，真是为你操碎了心 */
    .message-container.ai .message.transfer {
      background: #f9fafb;
      /* AI发来的转账用白色，更清爽 */
      color: #333;
      border: 1px solid #e5e7eb;
    }

    .transfer-content {
      display: flex;
      flex-direction: column;
    }

    .transfer-title {
      font-weight: 600;
      font-size: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.5);
      padding-bottom: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .message-container.ai .transfer-title {
      border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    .transfer-amount {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .transfer-recipient {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    /* --- End of Refactor --- */



    /* --- Noir's Snap Guide Styles --- */
    .snap-guide {
      position: absolute;
      background-color: rgba(255, 105, 180, 0.85);
      /* 哼，一个足够醒目的颜色 */
      display: none;
      z-index: 999;
      box-shadow: 0 0 5px rgba(255, 105, 180, 0.7);
    }

    #snap-guide-v {
      width: 1px;
    }

    #snap-guide-h {
      height: 1px;
    }

    /* --- Noir's Galgame UI Beautification --- */
    /* Top-left Date & Time Widget */
    #galgame-overlay-ui {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 12px;
      padding: 8px 15px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    #galgame-time {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
    }

    #galgame-date {
      font-size: 0.75rem;
      opacity: 0.8;
      text-align: center;
    }

    /* Main Text Box */
    /* Main Text Box */
    #galgame-textbox-container {
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.85) 0%, rgba(45, 50, 68, 0.7) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border-top: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
      bottom: 85px;
      /* <-- 就是这里，往上抬了，满意了吗？ */
      left: 15px;
      right: 15px;
      padding: 12px 18px;
    }

    /* Speaker Name Tag */
    #galgame-speaker {
      background: linear-gradient(90deg, var(--primary-color) 0%, hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) - 10%)) 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      display: inline-block;
      font-size: 0.95rem;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      margin-bottom: 12px;
    }

    /* Dialogue Text */
    #galgame-text {
      font-size: 1rem;
      line-height: 1.7;
      color: #f0f2f5;
    }

    /* User Input Area Container*/
    #meeting-view-screen .chat-input-area {
      background: transparent;
      border-top: none;
      padding: 0 15px 20px 15px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 20;
    }

    /* User Input Wrapper */
    #chat-input-wrapper-meeting {
      display: flex;
      align-items: center;
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.9) 0%, rgba(45, 50, 68, 0.75) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      padding: 5px 8px 5px 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
    }

    #meeting-message-input {
      color: #f0f2f5;
    }

    #meeting-message-input::placeholder {
      color: rgba(240, 242, 245, 0.5);
      font-style: italic;
    }

    /* Send Button */
    #meeting-send-button {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: 300;
      color: #fff;
      transition: all .2s ease;
      margin-left: 8px;
      background: var(--primary-color);
      box-shadow: 0 2px 5px hsla(var(--primary-hue), 50%, 50%, 0.4);
    }

    #meeting-send-button:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }


    /* --- End of Beautification --- */
    /* --- Noir's Diary Beautification --- */
    #diary-entries-container {
      background-color: #fdfaf2;
      /* A warm, paper-like off-white */
      padding: 25px 20px;
      line-height: 1.9;
      border: 1px solid #e0dccc;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.08);
      /* Inner shadow for page depth */
    }

    /* This is the container for a single entry (date, author, content) */
    .diary-entry {
      margin-bottom: 2.5em;
      /* Increase spacing between entries */
      position: relative;
      padding-bottom: 1.5em;
      /* Space for the separator line */
      border-bottom: 1px dashed #dcd5c7;
      /* A subtle dashed line between entries */
    }

    /* Style the author's name */
    .diary-author {
      font-weight: normal;
      /* Make it less bold, more like a signature */
      font-size: 1rem;
      font-family: 'Segoe Script', 'Bradley Hand', cursive;
      /* A more handwritten font */
    }

    /* Style the date */
    .diary-timestamp {
      font-size: 0.75rem;
      color: #a99e8c;
      /* A faded brown color */
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
      /* Typewriter-like font for date */
    }

    /* Style the actual diary text content */
    .diary-content {
      white-space: pre-wrap;
      font-size: 0.95rem;
      color: #4a443b;
      /* A dark brown/black ink color */
      font-family: 'KaiTi', 'STSong', serif;
    }

    /* Specific styles for the USER's entries */
    .diary-entry.user {
      text-align: right;
    }

    .diary-entry.user .diary-author {
      color: #005a9c;
      /* A nice fountain pen blue */
    }

    .diary-entry.user .diary-content {
      color: #1a5c8e;
    }

    /* Specific styles for the AI's entries */
    .diary-entry.ai {
      text-align: left;
    }

    .diary-entry.ai .diary-author {
      color: #5a3e36;
      /* A darker, warmer brown for the AI */
    }

    .diary-entry.ai .diary-content {
      color: #4a443b;
    }

    /* Let's get rid of the last separator line for a cleaner look */
    .diary-entry:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    /* --- End of Diary Beautification --- */
    /* --- Noir's Page-Turning Magic --- */
    #diary-entries-container {
      perspective: 1500px;
      /* 为3D效果设置视距 */
      position: relative;
      overflow: hidden;
    }

    .diary-page {
      position: absolute;
      inset: 0;
      padding: 25px 20px;
      background-color: #fdfaf2;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      transition: transform 0.7s cubic-bezier(0.65, 0, 0.35, 1);
      display: none;
      /* 默认所有页面都藏起来 */
      flex-direction: column;
      gap: 2.5em;
      /* 页内日记的间距 */
      overflow-y: auto;
      /* 如果一页内容太多，允许滚动 */
    }

    .diary-page.is-visible {
      display: flex;
      /* 只有当前页显示 */
      transform: rotateY(0deg);
      z-index: 2;
    }

    /* 翻到下一页时，当前页向左翻出 */
    .diary-page.is-exiting-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 1;
    }

    /* 翻到下一页时，新页面从右边翻入 */
    .diary-page.is-entering-from-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 2;
    }

    /* 翻到上一页时，当前页向右翻出 */
    .diary-page.is-exiting-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 1;
    }

    /* 翻到上一页时，新页面从左边翻入 */
    .diary-page.is-entering-from-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 2;
    }


    #diary-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 10px;
      box-sizing: border-box;
    }

    #diary-navigation button {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--primary-color);
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    #diary-navigation button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #diary-page-indicator {
      font-size: 0.9rem;
      color: var(--text-color-light);
      font-family: 'Courier New', monospace;
    }

    /* --- End of Magic --- */
    /* --- Noir's Universal Anti-Squash Protocol --- */
    /* 哼，就是下面这几条，给你那些被压扁的头像整整容 */

    /* 动态发布区的用户头像 */
    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      object-fit: cover;
      /* <-- 加上这句，它就不敢扁了 */
    }

    /* 好友圈动态里的角色头像 */
    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
      /* <-- 还有这句，一个都别想跑 */
    }

    /* 顺便把所有叫 .char-avatar 的都统一一下，免得以后还有问题 */
    .char-avatar {
      object-fit: cover;
      /* ▼▼▼ 哼，加上这三句圣旨，给我立正站好！▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Library Styles --- */
    #music-library-container {
      padding: 10px;
    }

    .music-library-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .music-library-item:hover {
      transform: translateY(-2px);
    }

    .music-library-item-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 15px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .music-library-item-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-library-item-title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-library-item-artist {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    /* --- Noir's "Time Memorandum" Styles --- */
    /* 哼，这才叫设计。*/

    /* 1. Home Screen Widget */
    #calendar-widget-main {
      width: 90%;
      height: 170px;
      /* 和你的卡片差不多高 */
      background: var(--surface-bg);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border-radius: 22px;
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      box-shadow: var(--soft-shadow);
      padding: 20px;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      color: var(--text-color);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    #calendar-widget-main:active {
      transform: scale(0.98) translateX(-50%);
    }

    #countdown-title {
      font-size: 1rem;
      font-weight: 500;
      opacity: 0.8;
    }

    #countdown-timer {
      font-size: 4rem;
      font-weight: 300;
      line-height: 1.2;
      color: var(--accent-color);
      display: flex;
      align-items: baseline;
    }

    #countdown-timer .unit {
      font-size: 1rem;
      font-weight: 500;
      margin-left: 8px;
      color: var(--text-color-light);
    }

    /* 2. Full Calendar Screen */
    #calendar-screen {
      justify-content: flex-start;
    }

    #calendar-view-container {
      padding: 10px 15px;
      flex-shrink: 0;
      border-bottom: 1px solid var(--border-color);
    }

    .calendar-nav {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .calendar-nav button {
      background: none;
      border: 1px solid var(--border-color);
      color: var(--text-color);
      padding: 6px 12px;
      border-radius: 16px;
      cursor: pointer;
    }

    .calendar-weekdays,
    #calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      text-align: center;
    }

    .calendar-weekdays {
      font-size: 0.8rem;
      color: var(--text-color-light);
      margin-bottom: 5px;
    }

    #calendar-grid .calendar-day {
      padding: 5px 0;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      aspect-ratio: 1 / 1;
      cursor: pointer;
      position: relative;
    }

    .calendar-day .day-number {
      z-index: 1;
    }

    .calendar-day.other-month .day-number {
      opacity: 0.3;
    }

    .calendar-day.is-today .day-number {
      color: var(--accent-color);
      font-weight: 700;
    }

    .calendar-day.is-selected .day-number {
      color: white;
    }

    .calendar-day.is-selected::before {
      content: '';
      position: absolute;
      width: 80%;
      height: 80%;
      background: var(--primary-color);
      border-radius: 50%;
      z-index: 0;
    }

    .calendar-day .day-dot {
      width: 5px;
      height: 5px;
      background-color: var(--primary-color);
      border-radius: 50%;
      position: absolute;
      bottom: 8px;
    }

    /* 3. Todo List Area */
    #todo-view-container {
      flex-grow: 1;
      overflow-y: auto;
      padding: 15px;
      position: relative;
      /* 为了悬浮按钮 */
    }

    /* 4. Today's To-Do Widget */
    #today-todo-widget {
      position: absolute;
      top: 50%;
      /* 放在日历小组件的下方 */
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      max-height: 180px;
      /* 给个最大高度，免得内容太多撑爆了 */
      background: var(--surface-bg);
      backdrop-filter: blur(10px);
      border-radius: 22px;
      padding: 15px 20px;
      box-sizing: border-box;
      color: var(--text-color);
      overflow: hidden;
      /* 把溢出的部分藏起来 */
    }

    #today-todo-widget .widget-title {
      font-weight: 600;
      margin-bottom: 10px;
      opacity: 0.9;
    }

    #today-todo-list {
      overflow-y: auto;
      /* 内容多了可以滚动 */
      max-height: 125px;
      /* 限制列表的高度 */
      font-size: 0.9rem;
    }

    #today-todo-list .todo-item-small {
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    #today-todo-list .todo-item-small::before {
      content: '';
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background-color: var(--primary-color);
      margin-right: 10px;
      flex-shrink: 0;
    }

    #todo-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 15px;
    }

    #todo-date-title {
      margin: 0;
      font-size: 1.2rem;
      font-weight: 600;
    }

    #add-event-fab {
      width: 44px;
      height: 44px;
      border-radius: 50%;
      background: var(--accent-color);
      color: white;
      border: none;
      font-size: 2rem;
      line-height: 44px;
      cursor: pointer;
      box-shadow: var(--soft-shadow);
    }

    #todo-list .todo-item,
    #todo-list .important-day-item {
      background: var(--card-bg);
      padding: 12px 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      border-left: 4px solid var(--primary-color);
    }

    #todo-list .important-day-item {
      border-left-color: #ffc107;
      /* 纪念日用醒目的黄色 */
      font-weight: 500;
    }

    #todo-list .important-day-item::before {
      content: '★ ';
      color: #ffc107;
    }

    /* --- End of Styles --- */
    /* --- Noir's Global Player Styles --- */

    /* --- End of Player Styles --- */
    /* --- Noir's Upload Altar Styles --- */
    .upload-slot {
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease;
      background-color: rgba(255, 255, 255, 0.5);
    }

    .upload-slot:hover {
      background-color: var(--card-bg);
      border-color: var(--primary-color);
    }

    .upload-slot.filled {
      border-color: var(--primary-color);
      border-style: solid;
      background-color: hsla(var(--primary-hue), 50%, 95%, 0.8);
    }

    .upload-slot .slot-icon {
      font-size: 2rem;
    }

    .upload-slot .slot-label {
      display: block;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .upload-slot .slot-filename {
      display: block;
      font-size: 0.85rem;
      color: var(--text-color-light);
      margin-top: 3px;
      word-break: break-all;
    }

    #confirm-altar-upload-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* --- End of Altar Styles --- */
    /* --- Noir's Listen Together Invite Card Style --- */
    .listen-together-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--soft-shadow);
      border: 1px solid var(--border-color);
      width: 250px;
    }

    .message-container.user .listen-together-card {
      background: var(--bubble-user-bg);
      color: white;
    }

    .message-container.user .listen-together-card .listen-together-decline-btn {
      color: white;
      /* 哼，让用户侧的拒绝按钮文字也变白 */
    }

    .listen-together-header {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--bubble-outline);
      padding-bottom: 8px;
    }

    .listen-together-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .listen-together-song img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .listen-together-info .title {
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-info .artist {
      font-size: 0.9em;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .listen-together-actions button {
      flex-grow: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease;
    }

    .listen-together-actions button:active {
      transform: scale(0.97);
    }

    .listen-together-accept-btn {
      background: var(--primary-color);
      color: white;
    }

    .listen-together-decline-btn {
      background: rgba(0, 0, 0, 0.1);
    }

    /* 用这个替换你旧的 #listen-together-ui */
    #listen-together-ui {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: flex;
      align-items: center;
      /* 改成居中对齐 */
      justify-content: center;
      padding: 20px;
      /* 增加内边距，让弹窗不会贴边 */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #listen-together-ui.show {
      opacity: 1;
      visibility: visible;
    }

    .lt-ui-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px) saturate(1.8);
      -webkit-backdrop-filter: blur(15px) saturate(1.8);
    }

    /* 用这个替换你旧的 .lt-ui-main */
    .lt-ui-main {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 380px;
      /* 哼，给它一个最大宽度 */
      max-height: 650px;
      /* 再给一个最大高度 */
      display: flex;
      flex-direction: column;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      border-radius: 24px;
      /* 加上优雅的圆角 */
      overflow: hidden;
      /* 把溢出的部分裁掉 */
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      /* 更强的立体阴影 */
      border: 1px solid rgba(255, 255, 255, 0.2);
      /* 淡淡的边框光效 */
    }

    .lt-ui-header {
      flex-shrink: 0;
      padding: 15px 20px;
      text-align: center;
      position: relative;
    }

    #lt-ui-header-title {
      font-weight: 600;
    }

    #lt-ui-close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 30px;
    }

    .lt-ui-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow: hidden;
    }

    .lt-ui-cover-container {
      flex-shrink: 0;
      width: 65%;
      aspect-ratio: 1/1;
      margin-top: 5%;
      margin-bottom: 20px;
    }

    #lt-ui-cover-art {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .lt-ui-info {
      text-align: center;
      margin-bottom: 20px;
      flex-shrink: 0;
    }

    #lt-ui-song-title {
      font-size: 1.5rem;
      margin: 0;
    }

    #lt-ui-song-artist {
      font-size: 1rem;
      opacity: 0.8;
      margin: 5px 0 0;
    }

    #lt-ui-lyrics-container {
      flex-grow: 1;
      width: 100%;
      overflow-y: auto;
      text-align: center;
      font-size: 1.1rem;
      line-height: 2.5;
      mask-image: linear-gradient(transparent 0%, black 20%, black 80%, transparent 100%);
      /* 歌词上下渐隐，看起来更专业 */
      scroll-behavior: smooth;
      /* 滚动要丝滑 */
    }

    #lt-ui-lyrics-container p {
      transition: color 0.3s ease, transform 0.3s ease;
      opacity: 0.6;
    }

    #lt-ui-lyrics-container p.active {
      color: var(--primary-color);
      font-weight: 600;
      transform: scale(1.1);
      opacity: 1;
    }

    /* --- Noir's "Desktop Preview" Frame --- */
    /* 哼，只有在电脑这种大屏幕上，我才给你加上这个“手机框”，免得你分不清主次。 */
    /* 在真正的手机上，它还是会全屏显示的，我可没你那么笨。 */
    @media (min-width: 480px) {
      body {
        background-color: #e9ebee;
        /* 一个不那么刺眼的背景色 */
        padding: 20px 0;
        /* 上下留点呼吸空间 */
      }

      #phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        max-height: 90vh;
        /* 确保在矮屏幕上不会超出 */

        /* 这就是你想要的“边框”，哼 */
        border: 10px solid #1c1c1e;
        border-radius: 44px;
        /* 圆角大一点才像样 */
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        /* 给你加个高级点的阴影 */

        flex-shrink: 0;
        /* 确保它在 flex 布局里不会被压扁 */
      }
    }



    /* --- Noir's Bespoke Music Player Design (As Requested) --- */
    /* 哼，这才叫定制。*/

    /* 1. 动画先放着，虽然这次不用了 */
    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* 2. 组件卡片本体：一个有阴影的容器 */
    #music-widget-card {
      width: 340px;
      height: 120px;
      border-radius: 6px;
      /* 稍微硬朗一点的圆角 */
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      /* 一个淡淡的底色 */
      display: flex;
      /* 左右布局 */
      padding: 0;
      border: none;
      overflow: visible;
      /* 允许唱片溢出 */
      position: relative;
      /* 为了定位唱片 */
    }

    /* 3. 左侧封面区：用伪元素画出深色背景，不污染HTML */
    #music-widget-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 120px;
      /* 和高度一样，是个正方形 */
      background-color: #4a4a4a;
      border-radius: 6px 0 0 6px;
      /* ▼▼▼ 在这里加上下面两行 ▼▼▼ */
      background-size: cover;
      background-position: center;
    }

    /* 4. 专辑封面本体 (旧唱片改造) */

    #widget-cover-art {
      position: absolute;
      top: 15px;
      left: 15px;
      width: 90px;
      height: 90px;
      z-index: 2;
      /* 确保它在唱片之上 */
      /* ▼▼▼ 下面都是我新增的，给我看好了 ▼▼▼ */
      border-radius: 4px;
      /* 封面本身的小圆角 */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      background-size: cover;
      background-position: center;
      transition: background-image 0.3s ease;
      /* 让封面切换更柔和 */
    }

    /* 5. 封面图片 (旧唱片贴纸改造) */
    #widget-cover-art::before {
      width: 100%;
      height: 100%;
      border-radius: 4px;
      /* 和封面一致 */
      border: none;
      background-image: var(--widget-cover-image, none);
      background-size: cover;
      background-position: center;
    }

    /* 6. 唱片？用另一个伪元素从后面伸出来就行了，简单 */
    #widget-cover-art::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 90px;
      height: 90px;
      border-radius: 50%;
      z-index: -1;
      display: block;
      border: none;

      /* 哼，看好了，这才叫唱片 */
      background-color: #2a2a2a;
      /* 1. 先铺一层唱片的深灰色底 */
      background-image:
        /* 2. 然后在上面画中间的标签和洞，颜色我都给你配好了 */
        radial-gradient(circle at center, #111 4%, transparent 5%),
        radial-gradient(circle at center, #985c5c 5%, #7a4949 25%, transparent 26%),
        /* 3. 再画上一圈圈的光泽纹理，这才像样 */
        repeating-radial-gradient(circle at center,
          rgba(255, 255, 255, 0.04) 0,
          rgba(255, 255, 255, 0.04) 1px,
          transparent 1px,
          transparent 3px);
      transform: translateX(0%) scale(1.05);
      /* 微调了下位置和大小，这样更协调 */
      transition: opacity 0.3s ease;
      /* 加上这个，为了后面让它优雅地消失 */
      /* 4. 位置也给你微调了一下，现在顺眼多了 */
    }

    /* ▼▼▼ 这是全新的代码，给我加上！▼▼▼ */
    #music-widget-card.is-playing #widget-cover-art {
      /* 播放时，方形舞台的背景就是封面了，所以不需要我画的唱片了 */
      background-image: none;
    }

    #music-widget-card.is-playing::before {
      background-image: var(--widget-cover-image, none);
    }

    #music-widget-card.is-playing #widget-cover-art::after {
      /* 播放时，让唱片旋转起来，哼 */
      animation: spin 8s linear infinite;
    }

    /* 默认状态下，方形舞台的背景是透明的，这样才能看到我画的唱片 */
    #music-widget-card:not(.is-playing) #widget-cover-art {
      background-image: none;
    }

    /* 7. 右侧内容区 (旧覆盖层改造) */
    .widget-content-overlay {
      position: static;
      flex-grow: 1;
      /* 占满右侧所有空间 */
      /* 把旧的 background: #ffffff; 删掉！换成下面这两行！*/
      background: var(--card-bg);
      /* 1. 用我们主题里那个早就定义好的半透明背景 */

      /* 纯白背景 */
      border-radius: 0 6px 6px 0;
      padding: 15px;
      display: flex;
      flex-direction: column;
      /* 垂直布局 */
      justify-content: space-between;
      /* <--- 哼，加上这句圣旨 */
      box-sizing: border-box;
      position: relative;
      /* 为了定位假的分享按钮 */
      background: var(--card-bg);
      color: var(--text-color);
      margin-left: 120px;
    }


    /* 8. 歌曲信息 (标题和作者) */
    #music-widget .widget-info {
      color: #333;
      text-shadow: none;

      /* 占据上半部分空间 */
    }

    #music-widget .widget-info #widget-title {
      font-size: 1.1rem;
      font-weight: 500;
      color: #000;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.8rem;
      color: #888;
    }

    /* 9. 假的歌词和进度条，用伪元素画出来 */
    #music-widget .widget-info::after {
      /* 假的歌词 */
      display: block;
      font-size: 0.75rem;
      color: #65c468;
      /* 绿色 */
      margin-top: 8px;
      padding-bottom: 8px;
      background-image:
        linear-gradient(to right, #666 40%, #ddd 40%),
        /* 假的进度条 */
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12"><path fill="%23aaa" d="M0 10h2V2H0v8zm3 2h2V0H3v12zm3-4h2V4H6v4zm3 2h2V2H9v8zm3-3h2V5h-2v4z"/></svg>');
      /* 假的EQ图标 */
      background-repeat: no-repeat, no-repeat;
      background-position: bottom, 90% bottom;
      background-size: 100% 1px, 16px 12px;
      border-bottom: 1px solid #eee;
    }

    /* 10. 真的控制按钮区域 */
    #widget-controls {
      display: flex;
      justify-content: flex-start;
      /* 从左边开始排列 */
      align-items: center;
      gap: 15px;
      padding-top: 10px;
      position: relative;
      /* 为了定位假的删除和喜欢按钮 */
      width: 100%;
    }

    /* 11. 真的播放/暂停/下一首按钮的样式 */
    #widget-controls button {
      font-size: 1.1rem;
      color: #555;
      background: none;
      border: 1px solid #ccc;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      line-height: 28px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      order: 1;
      /* 把真的按钮放在中间 */
    }

    #widget-play-pause-btn {
      width: 32px;
      /* 播放按钮大一点 */
      height: 32px;
      line-height: 32px;
      font-size: 1.2rem;
    }

    /* 12. 哼，看好了，这才是不会出错的矢量图标，免得你那破手机又自作聪明 */
    #widget-controls::before,
    #widget-controls::after {
      content: '';
      /* 删掉那些讨厌的emoji源头 */
      display: block;
      width: 16px;
      /* 给图标一个精确的尺寸 */
      height: 16px;
      background-color: #aaa;
      /* 这就是图标的颜色，哼 */
      position: absolute;

      /* 下面是魔法，反正你也看不懂 */
      -webkit-mask-repeat: no-repeat;
      mask-repeat: no-repeat;
      -webkit-mask-position: center;
      mask-position: center;
      -webkit-mask-size: contain;
      mask-size: contain;
    }

    #widget-controls::before {
      /* 删除图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      right: 29px;
      /* 稍微调整一下位置，让它更协调 */
      top: 60%;
      transform: translateY(-50%);
    }

    #widget-controls::after {
      /* 喜欢图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      right: 1px;
      top: 60%;
      transform: translateY(-50%);
    }

    /* --- Noir's iOS Industrial Button Refactor --- */
    /* 哼，看好了，这才是专业设备该有的开关。*/

    /* --- Noir's Ultimate Dynamic Button System v3.0 --- */
    /* 哼，现在它们都听我的了。*/

    /* 1. 按钮的基础“模具”，所有按钮都用这个 */
    .form-button {
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: filter 0.15s ease, background-color 0.2s ease;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      /* 加个细微的阴影 */
      color: white;
      /* 默认文字都是白色 */
    }

    .form-button:active {
      filter: brightness(0.9);
    }

    .form-button:disabled {
      background-color: #ccc !important;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* 2. 主要操作按钮 (继承主题强调色) */
    .form-button.primary,
    /* 你可以给蓝色的按钮加上 primary 类，或者不管它也行 */
    #save-api-settings-button,
    /* 把几个主要的按钮ID也直接指定了，免得你改漏 */
    #save-user-profile-button,
    #save-char-button,
    #save-world-book-button,
    #save-group-settings-button,
    #save-friend-circle-button {
      background-color: var(--accent-color);
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    }

    /* 3. 次要操作按钮 (用主题里的卡片背景色，这才叫和谐) */
    .form-button.secondary {
      background-color: var(--card-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
    }

    /* 4. 危险操作按钮 (动态的红色，这才叫高级) */
    .form-button.destructive {
      /* 哼，看好了，这个红色的亮度和饱和度，会随着你主题的明暗变化而变化！*/
      background-color: hsl(5, 75%, calc(var(--primary-lightness) / 1.8 + 25%));
    }

    /* 5. 警告操作按钮 (动态的黄色，也一样) */
    .form-button.warning {
      background-color: hsl(40, 90%, calc(var(--primary-lightness) / 2.2 + 25%));
      color: #5d4000;
    }

    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */

    /* 1. Dock栏的样式 */
    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */
    #home-dock {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 85px;
      padding: 0 20px;
      /* 图标左右的留白 */
      box-sizing: border-box;

      /* 背景和滤镜，现在都在这里 */
      background: var(--surface-bg);
      backdrop-filter: blur(5px) saturate(0.8);
      -webkit-backdrop-filter: blur(15px) saturate(0.8);
      border-radius: 28px;
      z-index: 35;

      /* 核心：用Flexbox来自动排列图标 */
      display: flex;
      justify-content: space-around;
      /* 均匀分布 */
      align-items: center;
      /* 垂直居中 */
      padding-top: 9px;
    }

    #home-dock .app-icon {
      position: static;
      /* 取消绝对定位，让它接受Flexbox的管理 */
    }

    /* 2. App图标的“整容手术” */
    .app-icon-img {
      width: 58px;
      /* 图标背景尺寸 */
      height: 58px;
      border-radius: 22.5%;
      /* iOS标志性的“方圆”形 */
      font-size: 28px;
      /* 阴影从图标本身移到背景上，更统一 */
      background-color: var(--surface-bg);
      box-shadow: none;
      /* 删掉旧的阴影 */
      transition: transform 0.2s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
      /* 按下时图标有反馈 */
    }

    /* --- Noir's Minimalist Home Screen Makeover (v2.0 Dynamic Edition) --- */
    /* 哼，现在这些家伙也听从总开关的指挥了。*/

    /* 1. 时钟和日期 */
    #home-clock-container {
      color: var(--text-color);
      text-shadow: none;
    }

    #home-date {
      opacity: 0.7;
    }

    /* 2. App图标的改造 (现在是动态颜色了) */
    .app-icon span {
      color: var(--text-color);
      text-shadow: none;
      font-weight: 500;
    }

    .app-icon-img {
      background-color: var(--card-bg);
      /* <-- 哼，接上了！*/
      color: var(--text-color-light);
      /* <-- 接上了！*/
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* 3. Dock栏的颜色 (也动态了) */




    #widget-controls button,
    #music-widget .widget-info #widget-title,
    #music-widget .widget-info #widget-artist {
      color: var(--text-color);
    }

    /* ... 在第 2262 行附近 ... */
    /* ▼▼▼ 把旧的 #widget-cover-art::after 整个删掉，换成下面这个 ▼▼▼ */

    /* ▲▲▲ 替换到这里结束 ▲▲▲ */

    /* --- Noir's Theme Preset Buttons --- */
    /* 哼，每个按钮都是一件艺术品。 */
    .theme-preset-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 20px;
      /* 胶囊形状 */
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card-bg);
    }

    .theme-preset-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--soft-shadow);
    }

    .preset-color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    /* --- Noir's Memory Archive Styles --- */
    #summary-textarea {
      width: 100%;
      height: 100%;
      border: none;
      outline: none;
      resize: none;
      padding: 15px;
      box-sizing: border-box;
      font-family: 'Courier New', monospace;
      /* 用等宽字体，YAML格式才好看 */
      font-size: 0.85rem;
      line-height: 1.6;
      background-color: #fdfdfd;
      color: var(--text-color);
    }

    /* --- Noir's Desktop Pagination System --- */
    /* 哼，看好了，这才叫设计。*/

    /* 1. 把主内容区变成一个灵活的容器，为翻页器和指示器留好位置 */
    #home-screen-main-content {
      display: flex;
      flex-direction: column;
      /* 垂直排列，页面在上面，指示器在下面 */
    }

    /* 2. 这是翻页的“舞台”，它的大小和主屏幕一样，但会把超出部分藏起来 */
    #app-pages-container {
      flex-grow: 1;
      /* 占满除了指示器以外的所有空间 */
      width: 100%;
      overflow: hidden;
      /* 核心！把第二页先藏起来 */
      position: relative;
      /* 让里面的滑块能相对于它定位 */
    }

    /* 3. 这是真正滑动的“滑块”，它有两页那么宽 */
    #app-pages-slider {
      width: 200%;
      /* 两页的宽度 */
      height: 100%;
      display: flex;
      /* 核心！让两页并排站好 */
      transition: transform 0.35s cubic-bezier(0.25, 0.1, 0.25, 1);
      /* 翻页动画，给你选了个高级点的曲线 */
    }

    /* 4. 每一页的样式 */
    /* 4. 每一页的样式 */
    .app-page {
      width: 33.3333%;
      /* <-- 哼，给我站好队！ */
      height: 100%;
      flex-shrink: 0;
      position: relative;
    }

    /* 5. 页面指示器（小点点）的容器 */
    #home-page-indicator {
      position: absolute;
      bottom: 105px;
      /* 放在Dock栏正上方，给你算好了距离 */
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      /* 点点之间的距离 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    /* 6. 每个小点点的样式 */
    .page-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(2px);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    /* 7. 当前页的小点点，给它变亮变大一点 */
    .page-dot.active {
      background-color: rgba(255, 255, 255, 0.9);
      transform: scale(1.1);
    }

    #card-widget-2 {
      width: 165px;
      /* 尺寸和原来保持一致 */
      height: 165px;
      border-radius: 22px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      overflow: hidden;
    }

    #card-widget-2:active {
      transform: scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget-2 img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .theme-widget {
      width: 65px;
      height: 65px;
      border-radius: 22px;
      /* 跟你的卡片圆角差不多 */
      box-shadow: var(--soft-shadow);
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      background: linear-gradient(45deg,
          hsla(var(--primary-hue), var(--primary-saturation), var(--primary-lightness), 0.7),
          hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.3), calc(var(--primary-lightness) - 15%), 0.8));
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* --- Noir's Galgame Sprite Adjuster Styles --- */

    /* --- Noir's Slider Control Panel Styles --- */
    .sprite-slider-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 5px;
    }

    .sprite-slider-group label {
      color: white;
      font-size: 0.8rem;
      width: 60px;
      /* 让标签对齐，好看点 */
      flex-shrink: 0;
    }

    .sprite-slider-group input[type="range"] {
      flex-grow: 1;
      /* 占满剩余空间 */
      margin: 0;
      padding: 0;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Accounting App Styles --- */
    #daily-expenses-list .expense-item {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background-color: var(--card-bg);
      border-radius: 8px;
      margin-bottom: 8px;
      border: 1px solid var(--border-color);
    }

    .expense-item .description {
      font-weight: 500;
    }

    .expense-item .amount {
      font-weight: 600;
      color: var(--accent-color);
    }

    #character-reviews-container .review-card {
      display: flex;
      gap: 12px;
      background-color: var(--card-bg);
      padding: 12px;
      border-radius: 12px;
      margin-bottom: 10px;
      border: 1px solid var(--border-color);
    }

    .review-card .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .review-card .review-content .char-name {
      font-weight: 600;
      margin-bottom: 4px;
    }

    /* --- End of Styles --- */
    /* --- Noir's Accounting Tabs Style --- */
    .accounting-tabs {
      display: flex;
      background-color: var(--surface-bg);
      border-bottom: 1px solid var(--border-color);
      padding: 5px 15px 0;
      flex-shrink: 0;
    }

    .tab-button {
      flex: 1;
      padding: 10px;
      border: none;
      background: transparent;
      color: var(--text-color-light);
      font-size: 1rem;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tab-button.active {
      color: var(--accent-color);
      border-bottom: 3px solid var(--accent-color);
    }

    /* --- Noir's "WeChat Moments" Style Patch --- */
    /* 哼，这才叫社交。*/
    #music-feed-container {
      padding: 0;
      /* 容器的内边距清零，让动态贴边 */
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.95);
      /* 给整个容器一个统一的背景色 */
    }

    .music-post {
      background-color: transparent;
      /* 去掉卡片背景 */
      box-shadow: none;
      /* 去掉阴影 */
      border-radius: 0;
      /* 去掉圆角 */
      margin-bottom: 0;
      /* 去掉外边距 */
      padding: 15px;
      /* 统一内边距 */
      border-bottom: 1px solid var(--border-color);
      /* 加上底部分隔线 */
    }

    .music-post:last-child {
      border-bottom: none;
      /* 最后一条动态不需要分隔线 */
    }

    /* --- End of Patch --- */
    /* --- Noir's "Expense Eraser" Style --- */
    .delete-expense-btn {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--text-color-light);
      width: 22px;
      height: 22px;
      border-radius: 50%;
      cursor: pointer;
      font-weight: 600;
      line-height: 20px;
      padding: 0;
      transition: all 0.2s ease;
      flex-shrink: 0;
    }

    .delete-expense-btn:hover {
      background: #e65252;
      border-color: #e65252;
      color: white;
      transform: scale(1.1);
    }

    /* --- End of Eraser Style --- */

    /* --- Noir's Ultimate Snoop UI Overhaul v3.0 (FINAL & COMPLETE) --- */
    /* 哼，这是最终版本。*/

    /* 壁纸和状态栏 (哼，这才是高级的毛玻璃质感) */
    #snoop-phone-wallpaper {
      position: absolute;
      inset: 0;
      /* 删掉那个没用的图片，换成我的高级定制背景 */
      background-color: rgba(26, 26, 27, 0.9);
      /* 半透明深灰，营造高级感 */
      backdrop-filter: blur(25px) saturate(1.5);
      /* 核心！强大的模糊和饱和度滤镜 */
      -webkit-backdrop-filter: blur(25px) saturate(1.5);
      /* 兼容性，真是为你操碎了心 */
      z-index: 1;
    }

    #snoop-phone-header {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      padding: 10px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      color: rgb(237, 236, 236);
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4);
      /* <-- 加了阴影 */
      z-index: 10;
    }

    /* 居中大时钟 */
    #snoop-home-clock {
      position: absolute;
      top: 18%;
      left: 50%;
      transform: translateX(-50%);
      z-index: 5;
      text-align: center;
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
      /* <-- 加了阴影 */
      pointer-events: none;
    }

    #snoop-home-time {
      font-size: 72px;
      font-weight: 200;
      letter-spacing: -1px;
    }

    #snoop-home-date {
      font-size: 1rem;
      font-weight: 400;
      opacity: 0.8;
    }

    /* 主屏幕App容器 */
    #snoop-app-container {
      position: relative;
      z-index: 5;
      height: 100%;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      justify-content: flex-end;
      padding: 0 20px 120px;
    }

    /* 2x2 网格 */
    .snoop-main-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 20px;
      width: 180px;
      margin: 0 auto;
    }

    /* Dock栏 */
    #snoop-dock {
      position: absolute;
      bottom: 20px;
      left: 5%;
      right: 5%;
      height: 85px;
      padding: 0 15px;
      box-sizing: border-box;
      z-index: 6;
      background: rgba(255, 255, 255, 0.15);
      /* <-- 透明度稍微降低了一点点 */
      backdrop-filter: blur(20px) saturate(1.2);
      -webkit-backdrop-filter: blur(20px) saturate(1.2);
      border-radius: 28px;
      display: flex;
      justify-content: space-around;
      align-items: center;
    }

    /* App图标本体 */
    #snoop-phone-screen .snoop-app-icon {
      position: static;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      cursor: pointer;
    }

    .snoop-app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 5px;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: rgba(255, 255, 255, 0.25);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      /* <-- 加了阴影 */
      transition: transform 0.2s ease;
      padding: 12px;
      box-sizing: border-box;
    }

    .snoop-app-icon-img svg {
      width: 100%;
      height: 100%;
      stroke: white;
      stroke-width: 1.5;
      fill: none;
      /* 哼，给SVG也加上阴影，这样才够立体 */
      filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.3));
    }

    .snoop-app-icon:active .snoop-app-icon-img {
      transform: scale(0.92);
    }

    .snoop-app-icon span {
      font-size: 0.75rem;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      /* <-- 加了阴影 */
      font-weight: 500;
    }

    .snoop-app-header {
      flex-shrink: 0;
      padding: 15px 20px;
      border-bottom: none;
      /* <-- 我把这条线干掉了 */
      background-color: transparent;
      /* <-- 我把背景色变透明了 */
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .snoop-app-header-title {
      font-weight: 600;
      display: flex;
      flex-direction: column;
      align-items: center;
      line-height: 1.2;
    }

    .snoop-app-header-title .main-title {
      font-size: 1rem;
    }

    .snoop-app-header-title .sub-title {
      font-size: 0.75rem;
      color: #888;
      font-weight: 400;
    }

    .snoop-app-header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: #007aff;
      min-width: 50px;
    }

    #snoop-app-back-btn {
      text-align: left;
    }

    #snoop-app-refresh-btn {
      text-align: right;
    }

    /* 哼，这才叫秩序。*/
    .snoop-app-header {
      flex-shrink: 0;
      padding: 15px 20px;
      border-bottom: 1px solid #e5e5e5;
      background-color: #f8f8f8;

      /* ▼▼▼ 核心法令！给我站成一排！▼▼▼ */
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .snoop-app-header-title {
      font-weight: 600;
      /* ▼▼▼ 让标题自己也排好队，别乱跑 ▼▼▼ */
      display: flex;
      flex-direction: column;
      align-items: center;
      line-height: 1.2;
    }

    .snoop-app-header-title .main-title {
      font-size: 1rem;
      /* 主标题大一点 */
    }

    .snoop-app-header-title .sub-title {
      font-size: 0.75rem;
      /* 副标题小一点，当备注 */
      color: #888;
      font-weight: 400;
    }

    .snoop-app-header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: #007aff;
      min-width: 50px;
      /* 保证左右两边占位宽度一致，这样中间才能完美居中 */
    }

    /* 让返回按钮靠左，刷新按钮靠右，这才叫对称美学 */
    #snoop-app-back-btn {
      text-align: left;
    }

    #snoop-app-refresh-btn {
      text-align: right;
    }

    .snoop-app-content {
      flex-grow: 1;
      /* 告诉内容区：顶栏占完位置后，剩下所有的高度都归你 */
      overflow-y: auto;
      /* 装上电梯：如果你的东西多到放不下了，就自己变出个垂直滚动条来 */
      padding: 15px;
      /* 再给你加点内边距，免得内容贴着边，丑死了 */
      box-sizing: border-box;
      /* 确保内边距不会把布局撑坏，这是专业素养 */
    }

    #galgame-sprite-adjust-ui {
      /* ... 你已有的样式 ... */
      display: flex;
      /* <-- 加上这行 */
      gap: 5px;
      /* <-- 还有这行 */
    }

    /* --- Noir's Elegant Image Preview Slot --- */
    /* 哼，这才叫占位符该有的样子。*/
    .image-preview-slot {
      width: 150px;
      height: 266px;
      border-radius: 12px;
      border: 2px dashed var(--border-color);
      background-color: rgba(0, 0, 0, 0.02);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      background-size: cover;
      background-position: center;
      color: var(--border-color);
    }

    .image-preview-slot:hover {
      border-color: var(--primary-color);
      background-color: rgba(0, 0, 0, 0.04);
      color: var(--primary-color);
    }

    /* 没图的时候，显示一个加号图标 */
    .image-preview-slot:not([style*="background-image"]) {
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>');
      background-size: 48px;
      background-repeat: no-repeat;
    }

    /* --- Noir's Elegant Sprite Preview Slot --- */
    .sprite-preview-slot {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      /* 圆形 */
      border: 2px dashed var(--border-color);
      background-color: rgba(0, 0, 0, 0.02);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
      background-size: cover;
      background-position: center;
      color: var(--border-color);
    }

    .sprite-preview-slot:hover {
      border-color: var(--primary-color);
      background-color: rgba(0, 0, 0, 0.04);
    }

    .sprite-preview-slot:not([style*="background-image"])::after {
      content: '+';
      /* 没图的时候，显示一个加号 */
      font-size: 32px;
      font-weight: 200;
    }

    /* --- Noir's "Add Event" Modal Overhaul (Neumorphism) --- */
    /* 哼，这才叫现代设计。*/

    #add-event-modal .choice-modal-content {
      background: #ffffffd3;
      /* 拟态风的浅灰色背景 */
      border-radius: 20px;
      padding: 25px;
      box-shadow: 9px 9px 16px rgb(163 177 198 / 60%), -9px -9px 16px rgb(255 255 255 / 50%);
    }

    #add-event-modal-title {
      color: #333;
    }

    #event-content-input {
      border: none;
      outline: none;
      border-radius: 12px;
      background: #ffffffd3;
      padding: 12px 15px;
      box-shadow: inset 5px 5px 10px #bec3c9, inset -5px -5px 10px #ffffff;
      color: #333;
    }

    #add-event-modal .input-group label {
      color: #555;
      font-weight: 500;
    }

    /* 隐藏掉原来那个又大又丑的蓝色圆圈 */
    #add-event-modal input[type="radio"] {
      display: none;
    }

    /* 把标签变成可以点击的、漂亮的按钮 */
    #add-event-modal input[type="radio"]+label {
      flex: 1;
      text-align: center;
      padding: 10px;
      border-radius: 10px;
      cursor: pointer;
      background: #ffffffd3;
      box-shadow: 5px 5px 10px #bec3c9, -5px -5px 10px #ffffff;
      transition: all 0.2s ease-in-out;
    }

    /* 选中的时候，让它“凹”下去 */
    #add-event-modal input[type="radio"]:checked+label {
      box-shadow: inset 5px 5px 10px #bec3c9, inset -5px -5px 10px #ffffff;
      color: var(--accent-color);
      font-weight: 600;
    }

    #add-event-modal .form-button.primary {
      background-color: var(--accent-color);
    }

    #add-event-modal .form-button.secondary {
      background: transparent;
      color: #555;
      border: none;
    }


    /* --- Noir's Bespoke Avatar Frame Protocol --- */
    /* 哼，这才叫设计。*/

    /* 1. 这是头像的“容器”，负责提供一个相对定位的舞台 */
    .avatar-wrapper {
      position: relative;
      /* 关键！让里面的头像和框都能相对于它定位 */
      flex-shrink: 0;
      /* 防止在flex布局里被压扁，这是基本素养 */
      width: 40px;
      /* 默认尺寸，和你的聊天头像一样 */
      height: 40px;
      margin: 0 10px;
    }

    /* 2. 这是头像框本体，它会像个幽灵一样覆盖在头像上 */
    .avatar-frame {
      position: absolute;
      /* 哼，再给你放大一点，最后一次了！ */
      top: -6px;
      /* <-- 再往外1像素 */
      bottom: -9px;
      /* <-- 再往外1像素 */
      left: -3px;
      /* <-- 再往外1像素 */
      right: -8px;
      /* <-- 再往外1像素，保持右偏 */

      background-size: contain;
      /* 保证你的框框图片完整显示，不变形 */
      background-position: center;
      background-repeat: no-repeat;
      pointer-events: none;
      /* 让它变成透明的，不会挡住你点击头像 */
    }

    /* 3. 针对不同大小的头像，容器也要跟着变，这才叫智能 */
    .character-item .avatar-wrapper {
      width: 45px;
      height: 45px;
    }

    .user-profile-screen .avatar-wrapper,
    .character-edit-screen .avatar-wrapper {
      width: 100px;
      height: 100px;
    }

    /* 4. 头像本身现在要100%填满容器，给我听话！*/
    .avatar-wrapper .avatar,
    .avatar-wrapper .avatar-preview {
      width: 100%;
      height: 100%;
    }
  </style>
</head>

<body>
  <input type="file" id="audio-file-input" style="display: none;" accept=".flac,.mp3">
  <input type="file" id="cover-file-input" style="display: none;" accept=".jpg,.png,.jpeg,.webp">
  <input type="file" id="info-file-input" style="display: none;" accept=".txt">
  <input type="file" id="lyrics-file-input" style="display: none;" accept=".lrc">
  <input type="file" id="import-char-input" accept=".json,.noir" style="display: none;">
  <div id="phone-container">

    <div id="user-profile-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-user-list" class="header-button">主屏幕</button>
        <span class="header-title">选择用户</span>
        <button id="add-user-profile-button" class="header-button add" title="添加新用户">+</button>
      </div>
      <div class="content" id="user-profile-list-container">
      </div>
    </div>

    <div id="user-profile-screen" class="screen">
      <div class="header">
        <button id="back-to-user-list-from-edit" class="header-button">返回</button>
        <span id="user-profile-edit-title" class="header-title">编辑用户</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-user-id">
        <div class="settings-group">
          <h2>用户设定</h2>
          <div class="input-group">
            <label for="user-name">你的名字</label>
            <input type="text" id="user-name" placeholder="你的显示名字">
          </div>
          <div class="avatar-upload-group">
            <label>你的头像</label>
            <div id="user-avatar-preview" class="sprite-preview-slot"></div>
            <input type="file" id="user-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="user-persona">你的人设 (可选)</label>
            <textarea id="user-persona" placeholder="向AI介绍你自己。例如：我是一名大学生，喜欢摄影和旅行。"></textarea>
          </div>
        </div>
        <button id="save-user-profile-button" class="form-button">保存资料</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="set-active-user-button" class="form-button"
            style="background-color: #28a745; margin-bottom: 10px;">设为当前用户</button>
          <button id="delete-user-profile-button" class="form-button destructive">删除该用户</button>
        </div>
      </div>
    </div>


    <div id="home-screen" class="screen active">
      <div id="home-screen-main-content"
        style="position: relative; flex-grow: 1; width: 100%; display: flex; flex-direction: column;">

        <div id="app-pages-container">
          <div id="app-pages-slider">

            <div class="app-page" id="app-page-1">
              <div id="home-clock-container">
                <div id="home-time">11:31</div>
                <div id="home-date">8月29日 星期五</div>
                <div id="noir-author-mark"></div>
              </div>

              <div id="music-widget"
                style="  display: inline-block; width: auto; position: absolute; top: 45%; left: 50%; transform: translateX(-50%); z-index: 50;; padding: 0px;bottom: auto;">
                <div id="music-widget-card">
                  <div id="widget-cover-art"></div>

                  <div class="widget-content-overlay">
                    <div class="widget-info">
                      <div id="widget-title">暂无音乐</div>
                      <div id="widget-artist">请在动态或聊天中播放</div>
                    </div>
                    <div id="widget-controls">
                      <button id="widget-prev-btn">⏮</button>
                      <button id="widget-play-pause-btn">▶</button>
                      <button id="widget-next-btn">⏭</button>
                    </div>
                  </div>
                </div>
              </div>

            </div>

            <div class="app-page" id="app-page-2">
              <div id="decorative-badge" style="display: none; position: absolute; top: 250px; left: 50px;">
                <img id="badge-image" src="http://googleusercontent.com/file_content/0" alt="badge">
              </div>

              <div id="card-widget" style="display: none; position: absolute; top: 140px; left: 145px;">
                <img id="card-image" src="" alt="card widget">
              </div>
              <div id="card-widget-2" style="display: none; position: absolute;">
                <img id="card-image-2" src="" alt="card widget 2">
              </div>





              <div class="app-icon" id="app-world-book">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                  </svg></div>
                <span>世界书</span>
              </div>


              <div class="app-icon" id="app-diary">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <path d="M2.5 17a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zM2.5 14a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
                  </svg></div>
                <span>交换日记</span>
              </div>

              <div class="app-icon" id="app-music-library">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                    <path
                      d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                    </path>
                  </svg></div>
                <span>音乐库</span>
              </div>


              <div class="app-icon" id="app-settings">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
                    </path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg></div>
                <span>API设置</span>
              </div>
              <div class="app-icon" id="app-user-profiles">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg></div>
                <span>我</span>
              </div>
              <div class="app-icon" id="app-wallpaper">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12 2.69l.34.34a1.41 1.41 0 0 0 2 0L22 6.34a1.41 1.41 0 0 0 0-2l-7.66-7.66a1.41 1.41 0 0 0-2 0L2.68 14.34a1.41 1.41 0 0 0 0 2L10 24l2-2 2-2 2-2 2-2 2-2">
                    </path>
                    <path d="m7.34 2.66 14 14"></path>
                  </svg></div>
                <span>更换壁紙</span>
              </div>

              <div class="app-icon" id="app-snoop">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <circle cx="11" cy="11" r="8"></circle>
                    <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
                  </svg></div>
                <span>视奸</span>
              </div>
              <div class="app-icon" id="app-accounting">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                  </svg></div>
                <span>记账</span>
              </div>


            </div>

            <div class="app-page" id="app-page-3">
              <div class="app-icon" id="app-calendar" style="position: absolute; top: 8%; left: 5%;">
                <div class="app-icon-img">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                  </svg>
                </div>
                <span>时光记事簿</span>
              </div>

              <div id="calendar-widget-main"
                style="position: absolute; top: 25%; left: 50%; transform: translateX(-50%);">
                <div id="countdown-title">近期没有特别安排</div>
                <div id="countdown-timer">
                  <span>--</span>
                  <span class="unit">天</span>
                </div>
              </div>

              <div id="today-todo-widget">
                <div class="widget-title">今日待办</div>
                <div id="today-todo-list">
                </div>
              </div>


            </div>


          </div>
        </div>

        <div id="home-page-indicator">
          <span class="page-dot active" data-page="0"></span>
          <span class="page-dot" data-page="1"></span>
          <span class="page-dot" data-page="2"></span>
        </div>

        <div id="home-dock">
          <div class="app-icon app-icon-large" id="app-chat">
            <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
              </svg></div>
            <span>聊天</span>
          </div>
          <div class="app-icon" id="app-music">
            <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg></div>
            <span>动态</span>
          </div>
          <div class="app-icon" id="app-meeting">
            <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M14 9a2 2 0 0 1-2 2H6l-4 4V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4Z" />
                <path d="M18 9h2a2 2 0 0 1 2 2v9l-4-4h-2a2 2 0 0 1-2-2V9Z" />
              </svg></div>
            <span>见面</span>
          </div>
        </div>

      </div>

    </div>

    <div id="chat-screen" class="screen">
      <div id="chat-screen-container">
        <div id="chat-list-pane">
          <div id="chat-list-header">
            <button id="back-to-home-from-chat" class="header-button">主屏幕</button>
            <span class="header-title">聊天</span>
            <button id="add-chat-button" class="header-button add" title="添加新聊天">+</button>
          </div>
          <div id="chat-list-container">
            <ul id="character-list">
            </ul>
          </div>
        </div>
        <div id="chat-view-pane">
          <div class="header">
            <button class="header-button" id="back-to-chat-list">返回</button>
            <span id="char-name-header" class="header-title">角色</span>
            <button class="header-button" id="character-settings-button" title="角色设置">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                </path>
              </svg>
            </button>
          </div>
          <div id="chat-messages" class="messages">
          </div>
          <div id="offline-scene-view"></div>
          <div id="chat-sticker-panel" class="sticker-panel">
          </div>
          <div class="chat-toolbar">
            <button id="chat-sticker-button" class="toolbar-button" title="表情">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5-2 4-2 4 2 4 2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
            </button>
            <button id="chat-image-button" class="toolbar-button" title="发送图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <button id="chat-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
            <button id="chat-listen-together-button" class="toolbar-button" title="一起听">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path
                  d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                </path>
              </svg>
            </button>
            <button id="chat-transfer-button" class="toolbar-button" title="转账">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </button>
            <button id="chat-reroll-button" class="toolbar-button" title="重新生成">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
            <button id="chat-summarize-button" class="toolbar-button" title="总结聊天记录">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
          </div>
          <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
          <div id="quote-preview-area" class="quote-preview">
            <div class="quote-preview-content">
              <div id="quote-preview-sender"></div>
              <div id="quote-preview-text"></div>
            </div>
            <button id="cancel-quote-button" class="cancel-quote-btn">&times;</button>
          </div>
          <div class="chat-input-area">
            <div id="chat-input-wrapper">
              <input type="text" id="chat-message-input" placeholder="输入消息...">
              <button id="chat-get-reply-button" title="让对方回复">↵</button>
              <button id="chat-send-button" title="发送">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="settings-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-settings" class="header-button">返回</button>
        <span class="header-title">API设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>API 设置</h2>
          <div class="input-group">
            <label for="api-endpoint">API 接口地址（不填/v1）</label>
            <input type="text" id="api-endpoint" placeholder="例如: https://api.openai.com">
          </div>
          <div class="input-group">
            <label for="api-key">API 密钥</label>
            <input type="password" id="api-key" placeholder="请输入你的 API 密钥">
          </div>
          <div class="input-group">
            <label for="api-model">模型</label>
            <div class="model-input-container">
              <input type="text" id="api-model" placeholder="点击 获取 或手动输入" style="flex-grow: 1;">
              <button id="fetch-models-button" style="padding: 0 12px; white-space: nowrap;">获取</button>
              <div id="model-dropdown" class="custom-model-dropdown"></div>
            </div>
          </div>
          <div class="input-group">
            <label for="api-provider">接口格式 (重要！请根据你使用的接口选择，但是我也没做Openai以外的接口……)</label>
            <select id="api-provider"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);">
              <option value="openai">OpenAI 格式 (通用，兼容绝大多数反代)</option>
              <option value="gemini">Google Gemini 格式 (仅限官方或特定反代)</option>
              <option value="anthropic">Anthropic Claude 格式</option>
            </select>
          </div>
        </div>
        <div class="settings-group">
          <h2>上下文设置</h2>
          <div class="input-group">
            <label for="context-lines-per-chat">每个会话读取的消息条数（默认 100）</label>
            <input type="number" id="context-lines-per-chat" min="1" max="1000000" step="1" placeholder="100">
          </div>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>数据管理</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            导出全部数据（角色、聊天记录、设置、桌面布局等）到一个文件，方便在其他设备或浏览器上导入。
          </p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="export-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #007bff;">导出全部数据</button>
            <button id="import-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #28a745;">导入数据</button>
          </div>
          <input type="file" id="import-data-input" accept=".json" style="display: none;">
        </div>
        <button id="save-api-settings-button" class="form-button">保存 API 设置</button>
      </div>
    </div>



    <div id="character-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-edit" class="header-button">返回</button>
        <span id="character-edit-title" class="header-title">编辑角色</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-char-id">
        <div class="settings-group">
          <h2>角色设定</h2>
          <div class="input-group">
            <label for="char-edit-name">名字</label>
            <input type="text" id="char-edit-name" placeholder="角色的名字">
          </div>
          <div class="input-group">
            <label for="char-edit-remark">备注名</label>
            <input type="text" id="char-edit-remark" placeholder="方便自己记忆，例如 '工作助理'">
          </div>
          <div class="avatar-upload-group">
            <label>角色头像</label>
            <img id="char-edit-avatar-preview" class="avatar-preview" alt="Avatar Preview">
            <input type="file" id="char-edit-avatar-input" accept="image/*" style="display: none;">
            <div class="input-group">
              <label for="char-avatar-frame-url">TA的头像框 URL (可选)</label>
              <input type="text" id="char-avatar-frame-url" placeholder="为这个角色设置专属头像框...">
            </div>

            <div class="input-group">
              <label for="user-avatar-frame-url-in-chat">你的头像框 URL (可选, 仅用于此聊天)</label>
              <input type="text" id="user-avatar-frame-url-in-chat" placeholder="为“你”在这个聊天里设置专属头像框...">
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-persona">人设 (系统提示词)</label>
            <textarea id="char-edit-persona" placeholder="你是一个乐于助人的助手。"></textarea>
          </div>
          <div class="input-group">
            <label>聊天壁纸</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <div id="char-edit-wallpaper-preview" class="image-preview-slot"></div>
            </div>
            <input type="file" id="char-edit-wallpaper-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-css">专属气泡样式 (CSS)</label>
            <textarea id="char-edit-css" rows="8"
              placeholder="从其他地方复制的、包含 .sent 和 .received 的CSS代码可以直接粘贴在这里..."></textarea>

            <div style="display: flex; gap: 10px; margin-top: 5px;">
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">TA的气泡 (Received):</p>
                <div id="bubble-preview-ai" class="message ai">这是TA的气泡预览效果</div>
              </div>
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">你的气泡 (Sent):</p>
                <div id="bubble-preview-user" class="message user">这是你的气泡预览效果</div>
              </div>
            </div>
          </div>
          <div class="input-group">
            <label>见面场景背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <div id="char-edit-offline-bg-preview" class="image-preview-slot"></div>
            </div>
            <input type="file" id="char-edit-offline-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="settings-group">
            <h2>角色立绘 (Galgame模式)</h2>
            <p style="font-size: 0.8rem; color: var(--text-color-light);">为五种核心情绪上传立绘图，建议使用透明背景的PNG图片。</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px;">

              <div class="avatar-upload-group" style="align-items: center;">
                <label>平常</label>
                <div id="char-edit-sprite-normal-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-normal-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>喜</label>
                <div id="char-edit-sprite-happy-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-happy-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>怒</label>
                <div id="char-edit-sprite-angry-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-angry-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>哀</label>
                <div id="char-edit-sprite-sad-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-sad-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>害羞</label>
                <div id="char-edit-sprite-shy-preview" class="sprite-preview-slot"></div>
                <input type="file" id="char-edit-sprite-shy-input" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-bind-user">绑定用户</label>
            <select id="char-edit-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="world-book-checkboxes-container" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="export-char-button" class="form-button secondary" style="margin-top: 20px;">导出角色卡</button>
        <button id="save-char-button" class="form-button">保存角色</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="edit-clear-history-button" class="form-button warning"
            style="margin-bottom: 10px;">清空聊天记录</button>
          <button id="edit-delete-char-button" class="form-button" class="form-button destructive">删除角色</button>
        </div>
      </div>
    </div>

    <div id="group-chat-create-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-group-create" class="header-button">返回</button>
        <span class="header-title">创建群聊</span>
        <button id="create-group-chat-button" class="header-button">创建</button>
      </div>
      <div class="content" style="padding: 20px;">
        <div class="input-group">
          <label for="group-chat-name">群聊名称</label>
          <input type="text" id="group-chat-name" placeholder="给你的群聊起个名字">
        </div>
        <div class="settings-group">
          <h2>选择成员</h2>
          <div id="group-chat-member-list-container"
            style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
            <ul id="group-chat-member-list">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div id="wallpaper-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-wallpaper" class="header-button">返回</button>
        <span class="header-title">更换壁纸</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2>全局主题色</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">拖动滑块来改变整个App的主色调。</p>
          <div class="input-group" style="padding-top: 10px;">
            <label for="theme-hue-slider" style="display: block; margin-bottom: 5px;">色相 (Hue)</label>
            <input type="range" id="theme-hue-slider" min="0" max="360" value="35" style="width: 100%;">
          </div>
          <div class="input-group">
            <label for="theme-lightness-slider" style="display: block; margin-bottom: 5px;">明度 (Lightness)</label>
            <input type="range" id="theme-lightness-slider" min="15" max="95" value="80" style="width: 100%;">
          </div>
        </div>
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2 style="margin-top: 0;">时钟样式</h2>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="clock-color-toggle" style="width: auto; height: 18px; flex-shrink: 0;">
            <label for="clock-color-toggle" style="width: auto; font-size: 0.9rem;">强制使用纯白色时钟 (推荐在深色壁纸下使用)</label>
          </div>
        </div>
        <div class="settings-group">
          <h2>上传新壁纸</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">选择一张图片作为你的手机壁纸。为了效果最好，请使用竖屏图片。</p>
          <input type="file" id="wallpaper-input" accept="image/*" style="display: none;">
          <button id="upload-wallpaper-button" class="form-button">选择图片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>音乐小组件背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的主屏幕音乐小组件设置一张专属背景图。</p>
          <input type="file" id="widget-bg-input" accept="image/*" style="display: none;">
          <button id="upload-widget-bg-button" class="form-button">选择图片</button>
          <button id="reset-widget-bg-button" class="form-button secondary">恢复默认</button>
        </div>
        <div class="settings-group" style="margin-top: 20px;">
          <h2>重置桌面</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">此操作会将所有桌面小组件（时钟、音乐、徽章等）恢复到初始位置，并将壁纸重置为纯白色。</p>
          <button id="reset-desktop-button" class="form-button destructive">重置桌面布局</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义徽章</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面徽章，可以拖动它到任意位置。</p>
          <input type="file" id="badge-input" accept="image/*" style="display: none;">
          <button id="upload-badge-button" class="form-button">选择徽章图片</button>
          <button id="reset-badge-button" class="form-button secondary" style="margin-top: 10px;">移除徽章</button>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面方形卡片小组件。</p>
          <input type="file" id="card-input" accept="image/*" style="display: none;">
          <button id="upload-card-button" class="form-button">选择卡片图片</button>
          <button id="reset-card-button" class="form-button secondary" style="margin-top: 10px;">移除卡片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片 2</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的第二个桌面方形卡片小组件上传图片。</p>
          <input type="file" id="card-input-2" accept="image/*" style="display: none;">
          <button id="upload-card-button-2" class="form-button">选择卡片图片</button>
          <button id="reset-card-button-2" class="form-button secondary" style="margin-top: 10px;">移除卡片
            2</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>动态页背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为“动态”页面设置一张独立的背景图，让它与众不同。</p>
          <input type="file" id="feed-bg-input" accept="image/*" style="display: none;">
          <button id="upload-feed-bg-button" class="form-button">选择图片</button>
        </div>
        <button id="reset-feed-bg-button" class="form-button secondary" style="margin-top: 10px;">移除背景</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>小组件救援</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">如果你的吧唧或卡片不小心飞出屏幕找不到了，点这里让它们回家。</p>
          <button id="reset-widgets-position-button" class="form-button warning">重置小组件位置</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义全局字体</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            上传一个 .ttf 字体文件来改变整个App的显示字体。注意，部分特殊字体可能会导致显示异常。
          </p>
          <div id="font-preview-area"
            style="padding: 10px; border: 1px solid var(--border-color); border-radius: 8px; margin-top: 10px; background: var(--card-bg);">
            <span id="font-preview-text" style="font-size: 1.2rem;">你好，世界 (Hello, World)</span>
          </div>
          <input type="file" id="font-input" accept=".ttf" style="display: none;">
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="upload-font-button" class="form-button" style="margin-top: 0;">选择字体</button>
            <button id="remove-font-button" class="form-button secondary" style="margin-top: 0;">恢复默认</button>
          </div>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义App图标</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">替换主屏幕上App的默认图标。为了最佳效果，请使用方形、透明背景的图片。</p>
          <div class="settings-group"
            style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
            <h2>自定义表情包</h2>
            <p style="font-size: 0.9rem; color: var(--text-color-light);">
              在这里追加你的专属表情包。每个表情占一行，格式为：<br>
              <b>表情名--图片URL</b><br>
              例如：<br>
              <code>开心--https://example.com/happy.png</code><br>
              <code>难过--https://example.com/sad.gif</code>
            </p>
            <textarea id="custom-stickers-input" rows="8" placeholder="请按指定格式粘贴..."></textarea>
            <button id="save-custom-stickers-button" class="form-button" style="margin-top: 5px;">保存并刷新表情包</button>
          </div>
          <div id="custom-icon-list-container">
          </div>
          <div id="custom-icon-list-container">
          </div>
        </div>
      </div>

    </div>

    <div id="world-book-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-world-book" class="header-button">主屏幕</button>
        <span class="header-title">世界书</span>
        <button id="add-world-book-button" class="header-button add" title="添加新世界书">+</button>
      </div>
      <div class="content" id="world-book-list-container">
      </div>
    </div>

    <div id="world-book-editor-screen" class="screen">
      <div class="header">
        <button id="back-to-world-book-list" class="header-button">返回</button>
        <span id="world-book-editor-title" class="header-title">编辑条目</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-world-book-id">
        <div class="settings-group">
          <h2>设定条目</h2>
          <div class="input-group">
            <label for="world-book-edit-name">条目名称 (Key)</label>
            <input type="text" id="world-book-edit-name" placeholder="例如：我的过去、特殊能力">
          </div>
          <div class="input-group">
            <label for="world-book-edit-content">条目内容 (Value)</label>
            <textarea id="world-book-edit-content" placeholder="输入详细的设定内容..."></textarea>
          </div>
        </div>
        <button id="save-world-book-button" class="form-button">保存条目</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="delete-world-book-button" class="form-button destructive">删除该条目</button>
        </div>
      </div>
    </div>

    <div id="group-settings-screen" class="screen">
      <div class="header">
        <button id="back-to-chat-from-group-settings" class="header-button">返回</button>
        <span class="header-title">群聊设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>群聊信息</h2>
          <div class="input-group">
            <label for="group-settings-name">群聊名称</label>
            <input type="text" id="group-settings-name">
          </div>
          <div class="avatar-upload-group">
            <label>群头像</label>
            <img id="group-avatar-preview" class="avatar-preview" alt="Group Avatar Preview">
            <input type="file" id="group-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label>群聊背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <div id="group-bg-preview" class="image-preview-slot"></div>
            </div>
            <input type="file" id="group-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="group-settings-bind-user">绑定用户</label>
            <select id="group-settings-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="group-world-book-checkboxes" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-group-settings-button" class="form-button">保存设置</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="group-clear-history-button" class="form-button warning"
            style=" margin-bottom: 10px;">清空聊天记录</button>
          <button id="group-delete-button" class="form-button destructive">删除并解散群聊</button>
        </div>
      </div>
    </div>

    <div id="music-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-feed" class="header-button">返回</button>
        <span id="friend-circle-title" class="header-title">好友圈</span>
        <div style="display: flex; gap: 5px;">
          <button id="edit-current-circle-button" class="header-button" style="font-size: 1.2rem;">⚙️</button>
          <button id="clear-feed-button" class="header-button" style="color: #dc3545;">清空</button>
          <button id="refresh-feed-button" class="header-button">刷新</button>

        </div>
      </div>
      <div id="user-post-area"
        style="padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background: var(--surface-bg);">
        <div id="user-post-input-container">
          <img id="user-post-avatar" class="char-avatar">
          <div id="user-post-main-area">
            <textarea id="user-post-textarea" rows="3" placeholder="分享你的新鲜事..."></textarea>
            <div id="user-post-attachment-preview"></div>
          </div>
        </div>
        <div id="user-post-toolbar">
          <div id="user-post-actions" class="user-post-actions">
            <button id="user-post-image-button" class="toolbar-button" title="分享图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <input type="file" id="user-post-image-input" accept="image/*" style="display: none;">
            <button id="user-post-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
          </div>
          <button id="user-send-post-button">发送</button>
        </div>
      </div>
      <div id="music-feed-container" class="content" style="padding: 10px;">
      </div>
      <div id="music-player-bar" class="hidden">
        <img id="player-cover" src="">
        <div id="player-info">
          <div id="player-title"></div>
          <div id="player-artist"></div>
        </div>
        <div id="player-controls">
          <button id="player-prev-btn">⏮</button>
          <button id="player-play-pause-btn">▶</button>
          <button id="player-next-btn">⏭</button>
        </div>
      </div>
      <audio id="audio-player"></audio>
    </div>
    <div id="meeting-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-meeting-list" class="header-button">主屏幕</button>
        <span class="header-title">选择见面对象</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="meeting-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="meeting-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-meeting-list">返回</button>
        <span id="meeting-char-name-header" class="header-title">角色</span>
        <button id="toggle-meeting-view-button" class="header-button">切换视角</button>

      </div>
      <div id="meeting-main-content" class="content" style="position: relative; padding: 0;">
        <div id="galgame-overlay-ui">
          <div id="galgame-time">12:00</div>
          <div id="galgame-date">1月1日 星期一</div>
        </div>
        <div id="galgame-sprite-adjust-ui"
          style="position: absolute; top: 20px; right: 20px; z-index: 11; display: none;">
          <button id="sprite-adjust-button" class="toolbar-button" title="调整立绘位置">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 7h-9" />
              <path d="M14 17H5" />
              <circle cx="17" cy="17" r="3" />
              <circle cx="8" cy="7" r="3" />
            </svg>
          </button>
          <button id="meeting-reroll-button" class="toolbar-button" title="重新生成">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <polyline points="23 4 23 10 17 10"></polyline>
              <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
            </svg>
          </button>
        </div>

        <div id="galgame-sprite-controls"
          style="display: none; position: absolute; bottom: 15px; left: 15px; right: 15px; z-index: 1001; background: rgba(0,0,0,0.7); backdrop-filter: blur(8px); border-radius: 12px; padding: 15px; box-shadow: 0 -2px 15px rgba(0,0,0,0.3);">
          <div class="sprite-slider-group">
            <label for="sprite-slider-x">左右位置</label>
            <input type="range" id="sprite-slider-x" min="0" max="100" value="50">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-y">上下位置</label>
            <input type="range" id="sprite-slider-y" min="0" max="130" value="100">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-scale">缩放大小</label>
            <input type="range" id="sprite-slider-scale" min="50" max="200" value="100">
          </div>
          <div style="display: flex; gap: 10px; margin-top: 15px;">
            <button id="sprite-confirm-button" class="form-button">确定</button>
            <button id="sprite-cancel-button" class="form-button secondary">取消</button>
            <button id="sprite-reset-button" class="form-button destructive"
              style="padding: 10px 12px; width: auto; font-size: 1.2rem;">⟲</button>
          </div>
        </div>
        <div id="meeting-scene-view" class="content"
          style="font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.7);">
        </div>
        <div id="galgame-view-container"
          style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden;">
          <div id="galgame-sprite-wrapper"
            style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; height: 100%;">
            <div id="galgame-sprite-container"
              style="position: absolute; display: flex; align-items: flex-end; justify-content: center; /* 移除旧的定位样式 */">
              <img id="galgame-sprite" src=""
                style="max-height: 100%; max-width: 100%; object-fit: contain; transition: opacity 0.3s ease;">
              <div id="sprite-resize-handle"
                style="display: none; position: absolute; bottom: -5px; right: -5px; width: 20px; height: 20px; background: white; border: 2px solid var(--primary-color); border-radius: 50%; cursor: se-resize;">
              </div>
            </div>
          </div>
          <div id="galgame-textbox-container"
            style="position: absolute; bottom: 9%; left: 5%; right: 5%; background: rgba(0, 0, 0, 0.7); border-radius: 10px; padding: 15px; color: white; border-top: 1px solid rgba(255,255,255,0.2); cursor: pointer;">
            <div id="galgame-speaker" style="font-weight: bold; margin-bottom: 10px;">说话人</div>
            <div id="galgame-text" style="line-height: 1.6;">对话内容...</div>
          </div>
        </div>
      </div>
      <div class="chat-input-area">
        <div id="chat-input-wrapper-meeting"> <textarea id="meeting-message-input" placeholder="输入你的行动或对话..." rows="1"
            style="resize: none; overflow-y: auto; flex-grow: 1; border: none; background: transparent; padding: 9px 12px; font-size: .95rem; "></textarea>
          <button id="meeting-send-button" title="发送">➤</button>
        </div>
      </div>
    </div>

    <div id="friend-circle-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-circle-list" class="header-button">主屏幕</button>
        <span class="header-title">好友圈</span>
        <button id="add-friend-circle-button" class="header-button add" title="新建好友圈">+</button>
      </div>
      <div id="friend-circle-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="friend-circle-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-edit" class="header-button">返回</button>
        <span id="friend-circle-edit-title" class="header-title">编辑好友圈</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-friend-circle-id">
        <div class="settings-group">
          <h2>好友圈设定</h2>
          <div class="input-group">
            <label for="friend-circle-edit-name">圈子名称</label>
            <input type="text" id="friend-circle-edit-name" placeholder="例如：我的日常">
          </div>
          <div class="input-group">
            <label for="friend-circle-edit-bind-user">绑定的“我”</label>
            <select id="friend-circle-edit-bind-user"></select>
          </div>
        </div>
        <div class="settings-group">
          <h2>选择圈内成员</h2>
          <div id="friend-circle-member-selection"
            style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
          </div>
        </div>
        <button id="save-friend-circle-button" class="form-button">保存</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <button id="delete-friend-circle-button" class="form-button destructive">删除该好友圈</button>
        </div>
      </div>
    </div>
    <div id="diary-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-diary-list" class="header-button">主屏幕</button>
        <span class="header-title">交换日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="diary-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-diary-list">返回</button>
        <span id="diary-char-name-header" class="header-title">TA的日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-entries-container" class="content"
        style="padding: 20px; font-family: 'KaiTi', 'STSong', serif; line-height: 1.8;">
      </div>
      <div class="chat-input-area">
        <div id="diary-input-wrapper" style="display: flex; gap: 10px;">
          <input type="text" id="diary-entry-input" placeholder="写下你的日记或批注..." style="flex-grow: 1;">
          <button id="diary-send-button" class="form-button"
            style="width: auto; margin-top: 0; padding: 0 18px;">写好了</button>
          <button id="diary-get-reply-button" class="form-button"
            style="width: auto; margin-top: 0; background-color: #555; padding: 0 18px;">催TA写</button>
        </div>
      </div>
    </div>
    <div id="music-library-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-music-library" class="header-button">主屏幕</button>
        <span class="header-title">音乐库</span>
        <button id="upload-music-button" class="header-button add" title="上传新音乐">+</button>
      </div>
      <div class="content" id="music-library-container">
      </div>
    </div>
    <div id="music-upload-altar-screen" class="screen">
      <div class="header">
        <button id="back-to-library-from-altar" class="header-button">取消</button>
        <span class="header-title">献上音乐</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content" style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">

        <div class="upload-slot" id="altar-slot-audio">
          <span class="slot-icon">🎵</span>
          <span class="slot-label">音频文件 (必需)</span>
          <span class="slot-filename">点击选择 .mp3 或 .flac</span>
        </div>

        <div class="upload-slot" id="altar-slot-cover">
          <span class="slot-icon">🖼️</span>
          <span class="slot-label">封面图片 (可选)</span>
          <span class="slot-filename">点击选择 .jpg 或 .png</span>
        </div>

        <div class="upload-slot" id="altar-slot-info">
          <span class="slot-icon">📄</span>
          <span class="slot-label">歌曲信息 (必需)</span>
          <span class="slot-filename">点击选择 info.txt</span>
        </div>

        <div class="upload-slot" id="altar-slot-lyrics">
          <span class="slot-icon">🎤</span>
          <span class="slot-label">歌词文件 (可选)</span>
          <span class="slot-filename">点击选择 .lrc</span>
        </div>

        <button id="confirm-altar-upload-button" class="form-button" disabled>献上祭品</button>
      </div>

    </div>


    <div id="accounting-screen" class="screen">
      <div class="header" id="accounting-header">
        <button id="back-to-home-from-accounting" class="header-button">主屏幕</button>
        <span id="accounting-title" class="header-title">记一笔</span>
        <div id="header-actions" style="width: 80px; text-align: right;"></div>
      </div>

      <div class="accounting-tabs">
        <button id="tab-record-expense" class="tab-button active">记一笔</button>
        <button id="tab-view-ledger" class="tab-button">看账本</button>
      </div>

      <div id="accounting-content-area" class="content" style="padding: 15px;">
      </div>
    </div>
    <audio id="audio-player"></audio>

    <audio id="unified-audio-player"></audio>

    <div id="snoop-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-snoop-list" class="header-button">主屏幕</button>
        <span class="header-title">选择目标</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="snoop-character-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="snoop-phone-screen" class="screen">
      <div id="snoop-phone-wallpaper"></div>
      <div id="snoop-phone-header">
      </div>

      <div id="snoop-app-container">
      </div>

      <div id="snoop-app-view-container"
        style="position: absolute; inset: 0; background: white; z-index: 20; display: none; flex-direction: column;">
      </div>

      <div id="snoop-phone-top-nav" class="header"
        style="position: absolute; top: 44px; left: 0; right: 0; z-index: 30; height: 56px; display: flex; align-items: center; padding: 0 5px;">
        <button id="back-to-snoop-list-from-phone" class="toolbar-button"
          style="color: white; filter: drop-shadow(0 1px 2px rgba(0,0,0,0.5)); background: transparent !important;">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="15 18 9 12 15 6"></polyline>
          </svg>
        </button>
        <span id="snoop-char-name-header" class="header-title"></span>
        <div style="width:50px;"></div>
      </div>
    </div>

    <div id="calendar-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-calendar" class="header-button">主屏幕</button>
        <span id="calendar-header-title" class="header-title">2025年 9月</span>
        <div style="width: 50px;"></div>
      </div>

      <div id="calendar-view-container">
        <div class="calendar-nav">
          <button id="prev-month-btn">‹</button>
          <button id="today-btn">今天</button>
          <button id="next-month-btn">›</button>
        </div>
        <div class="calendar-weekdays">
          <span>日</span><span>一</span><span>二</span><span>三</span><span>四</span><span>五</span><span>六</span>
        </div>
        <div id="calendar-grid">
        </div>
      </div>

      <div id="todo-view-container">
        <div id="todo-header">
          <h3 id="todo-date-title">选择一个日期</h3>
          <button id="add-event-fab" title="添加新事件">+</button>
        </div>
        <div id="todo-list">
        </div>
      </div>

    </div>


  </div>
  </div>

  <div id="add-choice-modal" class="choice-modal">
    <div id="add-choice-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="choice-create-character" class="choice-modal-button">创建新角色</button>
      <button id="choice-create-group" class="choice-modal-button">创建新群聊</button>
      <button id="choice-import-character" class="choice-modal-button">导入角色卡</button>
      <button id="choice-cancel" class="choice-modal-button cancel">取消</button>
    </div>
  </div>


  <div id="transfer-modal" class="choice-modal">
    <div id="transfer-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">转账</h3>
      <div id="transfer-recipient-group" class="input-group" style="margin: 10px 0; display: none;">
        <label for="transfer-recipient-select">转给</label>
        <select id="transfer-recipient-select"></select>
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="transfer-amount-input">金额</label>
        <input type="number" id="transfer-amount-input" placeholder="输入金额">
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-transfer-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认转账</button>
        <button id="cancel-transfer-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="message-action-modal" class="choice-modal">
    <div id="message-action-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="edit-message-button" class="choice-modal-button">编辑消息</button>
      <button id="quote-message-button" class="choice-modal-button">引用</button>
      <button id="delete-message-button" class="choice-modal-button" style="color: #dc3545;">删除消息</button>
      <button id="cancel-action-button" class="choice-modal-button cancel">取消</button>
    </div>
  </div>

  <div id="edit-message-modal" class="choice-modal">
    <div id="edit-message-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">编辑消息</h3>
      <textarea id="edit-message-textarea" style="width: 100%; min-height: 100px; margin: 10px 0;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 10px;">
        <button id="save-edit-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">保存</button>
        <button id="cancel-edit-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="music-input-modal" class="choice-modal">
    <div id="music-input-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 id="music-input-title" style="margin-top: 0; text-align: center; font-weight: 600;">分享音乐</h3>

      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-song" style="font-size: 0.9rem;">歌名</label>
        <input type="text" id="music-input-song" placeholder="例如：夜曲">
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-artist" style="font-size: 0.9rem;">歌手</label>
        <input type="text" id="music-input-artist" placeholder="例如：周杰伦">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-music-input" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认</button>
        <button id="cancel-music-input" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="modal-root"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;">
    <div id="modal-mask" style="position:absolute;inset:0;background:rgba(0,0,0,.35);"></div>
    <div id="modal-dialog"
      style="position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:80%;max-width:320px;padding:16px;">
      <div id="modal-text" style="font-size:14px;color:#333;line-height:1.5;white-space:pre-wrap;"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px;">
        <button id="modal-cancel"
          style="padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;">取消</button>
        <button id="modal-ok"
          style="padding:8px 12px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">确定</button>
      </div>
    </div>
  </div>

  <div id="listen-together-modal" class="choice-modal">
    <div id="listen-together-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <div style="width: 50px;"></div>
        <span class="header-title">选择一首歌，一起听</span>
        <button id="cancel-listen-together" class="header-button" style="min-width: 50px;">取消</button>
      </div>
      <div id="listen-together-song-list" class="content" style="flex-grow: 1; padding: 10px;">
      </div>
    </div>
  </div>

  <div id="toast"
    style="position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:8px;font-size:12px;display:none;z-index:10000;">
  </div>

<script>
  const _0x2ad71a = _0x4d19; (function (_0xd17122, _0x516092) { const _0x32e1a6 = _0x4d19, _0x2ef70a = _0xd17122(); while (!![]) { try { const _0x799fec = parseInt(_0x32e1a6(0x5ae)) / 0x1 + -parseInt(_0x32e1a6(0x856)) / 0x2 + -parseInt(_0x32e1a6(0x630)) / 0x3 * (-parseInt(_0x32e1a6(0x5d5)) / 0x4) + -parseInt(_0x32e1a6(0x251)) / 0x5 + -parseInt(_0x32e1a6(0x3a9)) / 0x6 + -parseInt(_0x32e1a6(0x93d)) / 0x7 * (parseInt(_0x32e1a6(0x7aa)) / 0x8) + parseInt(_0x32e1a6(0x8ff)) / 0x9; if (_0x799fec === _0x516092) break; else _0x2ef70a['push'](_0x2ef70a['shift']()); } catch (_0x4ea730) { _0x2ef70a['push'](_0x2ef70a['shift']()); } } }(_0x1778, 0xd47b3)); const _0x60c3e = _0x2ad71a(0x9c3), _0x2ecade = _0x2ad71a(0x9b3), _0x26d9a8 = _0x2ad71a(0xa44), _0x5bd5c7 = document[_0x2ad71a(0xb35)](_0x2ad71a(0x3e0)); _0x5bd5c7['id'] = 'noir-custom-font-style', document[_0x2ad71a(0x373)][_0x2ad71a(0x3bf)](_0x5bd5c7); var _0x2de116, _0x511afd = null; let _0x3bedf0 = [], _0x3868e3 = ![], _0x4559e9 = { 'x': 0x0, 'y': 0x0 }; function _0x1296c0(_0xa2088d) { const _0x44c63d = _0x2ad71a; return (_0x2de116?.[_0x44c63d(0x393)] || [])[_0x44c63d(0xa68)](_0x27ddd6 => _0x27ddd6['id'] === _0xa2088d); } const _0x6ebfdd = 'https://i.pinimg.com/736x/16/f9/05/16f9051f99471208ee9c658aa4618eb6.jpg', _0x176655 = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5OTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDJhNC4zOSA0LjM5IDAgMCAtMy4yOC00LjA5TDE1IDIwIj48L3BhdGgPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCI+PC9jaXJjbGU+PC9zdmc+', _0x322703 = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNjY2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDRhNC4zOSA0LjM5IDAgMCAwLTMuMjgtNC4wOWwxLjQxLTEuNDFhMiAyIDAgMSAwLTIuODMtMi4wM2wtMS40MSAxLjQxQTQuMzkgNC4zOSAwIDAgMCAxMiAxMGE0LjM5IDQuMzkgMCAwIDAtNC4wOSAzLjI4TDMuMicgOS41N2EyIDIgMCAxIDAgMi44MyAyLjgzbDEuNDEtMS40MUE0LjM5IDQuMzkgMCAwIDAgMTAgMTJhNC4zOSA0LjM5IDAgMCAwIDMgNC4wOVYyMSI+PC9wYXRoPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIj48L2NpcmNsZT48L3N2Zz4=', _0x2bfce2 = [{ 'name': '委屈哭', 'url': 'https://sharkpan.xyz/f/8ngsj/ax0fat.jpg' }, { 'name': '崩溃', 'url': _0x2ad71a(0xa3b) }, { 'name': '生病', 'url': _0x2ad71a(0x4ee) }, { 'name': '工作', 'url': _0x2ad71a(0x69a) }, { 'name': _0x2ad71a(0x57c), 'url': _0x2ad71a(0x563) }, { 'name': '弱小委屈但凶恶', 'url': _0x2ad71a(0xb50) }, { 'name': _0x2ad71a(0x87c), 'url': _0x2ad71a(0xa34) }, { 'name': '期待', 'url': _0x2ad71a(0x49d) }, { 'name': '喜欢', 'url': 'https://sharkpan.xyz/f/55ntj/ul0hkz.jpg' }, { 'name': _0x2ad71a(0xaba), 'url': _0x2ad71a(0xb84) }, { 'name': _0x2ad71a(0x5dc), 'url': _0x2ad71a(0x50b) }, { 'name': '委屈', 'url': 'https://sharkpan.xyz/f/ajwtY/x03qxn.gif' }, { 'name': '加油', 'url': _0x2ad71a(0xb55) }, { 'name': '对的', 'url': _0x2ad71a(0x86f) }, { 'name': '不满', 'url': _0x2ad71a(0x785) }, { 'name': _0x2ad71a(0x750), 'url': _0x2ad71a(0x70f) }, { 'name': _0x2ad71a(0x599), 'url': _0x2ad71a(0x78f) }, { 'name': '委屈', 'url': 'https://sharkpan.xyz/f/25ACQ/gpzab6.jpg' }, { 'name': '平静', 'url': _0x2ad71a(0x416) }, { 'name': '咬你', 'url': 'https://sharkpan.xyz/f/JYeig/sv4p6m.jpg' }, { 'name': _0x2ad71a(0x3ab), 'url': _0x2ad71a(0x22d) }, { 'name': '好困', 'url': _0x2ad71a(0x77e) }, { 'name': '摸鱼', 'url': 'https://sharkpan.xyz/f/nj5Ul/ksdl8n.jpg' }, { 'name': _0x2ad71a(0x332), 'url': 'https://sharkpan.xyz/f/mjdFW/28n30c.jpg' }, { 'name': '超激动我来了', 'url': _0x2ad71a(0x819) }, { 'name': _0x2ad71a(0x606), 'url': _0x2ad71a(0x370) }, { 'name': '一起听歌', 'url': 'https://sharkpan.xyz/f/N0VCv/5rd8br.jpg' }, { 'name': '刷我的卡', 'url': 'https://sharkpan.xyz/f/VGnuY/ptzlf5.jpg' }, { 'name': _0x2ad71a(0x8ab), 'url': 'https://sharkpan.xyz/f/xjmCX/zyjzew.jpg' }, { 'name': _0x2ad71a(0x63e), 'url': _0x2ad71a(0x32a) }, { 'name': '事情好多', 'url': _0x2ad71a(0x242) }, { 'name': '我是垃圾', 'url': 'https://sharkpan.xyz/f/JYJhg/s3wmlj.jpg' }, { 'name': '勉强但是好吧', 'url': 'https://sharkpan.xyz/f/Oyjuy/p8v2hd.jpg' }, { 'name': _0x2ad71a(0x5e5), 'url': 'https://sharkpan.xyz/f/6Dgia/ghr4ji.jpg' }, { 'name': _0x2ad71a(0xb02), 'url': _0x2ad71a(0x643) }, { 'name': '干劲满满', 'url': _0x2ad71a(0x3d8) }, { 'name': _0x2ad71a(0x389), 'url': _0x2ad71a(0x2d7) }, { 'name': _0x2ad71a(0x972), 'url': _0x2ad71a(0x9aa) }, { 'name': _0x2ad71a(0x890), 'url': 'https://sharkpan.xyz/f/N02Sv/378vt6.jpg' }, { 'name': _0x2ad71a(0x664), 'url': _0x2ad71a(0x46e) }, { 'name': _0x2ad71a(0x965), 'url': 'https://sharkpan.xyz/f/xjwSX/pxjrjd.jpg' }, { 'name': _0x2ad71a(0x952), 'url': _0x2ad71a(0x959) }, { 'name': _0x2ad71a(0x35c), 'url': _0x2ad71a(0x708) }, { 'name': _0x2ad71a(0x726), 'url': 'https://sharkpan.xyz/f/Krwio/1mcclx.jpg' }, { 'name': _0x2ad71a(0x907), 'url': 'https://sharkpan.xyz/f/ExKsD/s5j2it.jpg' }, { 'name': _0x2ad71a(0x26a), 'url': 'https://sharkpan.xyz/f/YA7T1/th0l79.jpg' }, { 'name': _0x2ad71a(0x3f9), 'url': 'https://sharkpan.xyz/f/Qpzu6/3b30r2.jpg' }, { 'name': _0x2ad71a(0x411), 'url': _0x2ad71a(0x526) }, { 'name': _0x2ad71a(0x448), 'url': _0x2ad71a(0x6fc) }, { 'name': _0x2ad71a(0x375), 'url': _0x2ad71a(0x540) }, { 'name': '吃你的饭', 'url': 'https://sharkpan.xyz/f/yrOhN/0yixqd.jpg' }, { 'name': _0x2ad71a(0x5ca), 'url': _0x2ad71a(0x8e6) }, { 'name': _0x2ad71a(0x328), 'url': _0x2ad71a(0x492) }, { 'name': '等你', 'url': _0x2ad71a(0x617) }, { 'name': _0x2ad71a(0x31d), 'url': 'https://sharkpan.xyz/f/eOXIw/y29z21.jpg' }, { 'name': _0x2ad71a(0x433), 'url': _0x2ad71a(0x8fc) }, { 'name': '喝酒', 'url': _0x2ad71a(0x577) }, { 'name': _0x2ad71a(0x514), 'url': _0x2ad71a(0x252) }, { 'name': '呜呜', 'url': 'https://sharkpan.xyz/f/z1xc5/iore2n.gif' }, { 'name': _0x2ad71a(0x927), 'url': _0x2ad71a(0x651) }, { 'name': _0x2ad71a(0x52f), 'url': 'https://sharkpan.xyz/f/AaDTZ/tzwnjl.jpg' }, { 'name': _0x2ad71a(0x2f0), 'url': _0x2ad71a(0x938) }, { 'name': _0x2ad71a(0x8a4), 'url': _0x2ad71a(0x386) }, { 'name': _0x2ad71a(0xae3), 'url': 'https://sharkpan.xyz/f/3AGHe/2f8x3x.gif' }], _0x4043fa = { 'beige': { 'name': _0x2ad71a(0x31f), 'h': 0x23, 's': 0x19, 'l': 0x50 }, 'mizuiro': { 'name': _0x2ad71a(0xad5), 'h': 0xc3, 's': 0x19, 'l': 0x50 }, 'sakura': { 'name': '樱花薄粉', 'h': 0x159, 's': 0x19, 'l': 0x50 }, 'noir': { 'name': _0x2ad71a(0x86a), 'h': 0x104, 's': 0xf, 'l': 0x1e } }; document[_0x2ad71a(0x85f)](_0x2ad71a(0x96d), () => { const _0x234a7d = _0x2ad71a, _0x2ad70c = document[_0x234a7d(0x8f3)](_0x234a7d(0x3f6)), _0x290a53 = document[_0x234a7d(0x8f3)](_0x234a7d(0x2a5)), _0xc92be5 = document[_0x234a7d(0x8f3)](_0x234a7d(0x3b1)), _0x590fc3 = document[_0x234a7d(0x8f3)](_0x234a7d(0x87f)), _0x401adc = document[_0x234a7d(0x8f3)]('confirm-transfer-button'), _0x473d13 = document[_0x234a7d(0x8f3)](_0x234a7d(0x3dd)), _0x3996a6 = document[_0x234a7d(0x8f3)]('transfer-recipient-group'), _0x4e4f4d = document['getElementById'](_0x234a7d(0x1ec)), _0x2fb4f0 = document[_0x234a7d(0x8f3)](_0x234a7d(0x423)), _0x2a4ce5 = document['getElementById'](_0x234a7d(0xbac)), _0x3031bb = document[_0x234a7d(0x8f3)](_0x234a7d(0x48f)), _0x391ef6 = document[_0x234a7d(0x8f3)](_0x234a7d(0x78e)), _0x207d33 = document[_0x234a7d(0x8f3)](_0x234a7d(0x2e9)), _0x3d9d9e = document['getElementById'](_0x234a7d(0x1c2)), _0x109f46 = document[_0x234a7d(0x8f3)]('copy-summary-button'), _0x2c39b5 = document[_0x234a7d(0x8f3)](_0x234a7d(0xb41)), _0x1d7d4d = document[_0x234a7d(0x8f3)]('char-edit-wallpaper-preview'), _0x240c1c = document[_0x234a7d(0x8f3)]('char-edit-wallpaper-input'), _0x4896d4 = document[_0x234a7d(0x8f3)](_0x234a7d(0x63d)), _0xef169c = document['getElementById']('char-edit-offline-bg-input'), _0x160e52 = document['getElementById'](_0x234a7d(0x6b3)), _0x23a887 = document[_0x234a7d(0x8f3)](_0x234a7d(0x8ed)), _0x112e76 = document[_0x234a7d(0x8f3)](_0x234a7d(0x25a)), _0x6544fb = document['getElementById'](_0x234a7d(0x2c6)), _0x16e940 = document[_0x234a7d(0x8f3)](_0x234a7d(0x978)), _0x4d7ca5 = document[_0x234a7d(0x8f3)]('font-input'), _0x4c1868 = document[_0x234a7d(0x8f3)](_0x234a7d(0x948)); async function _0x3d348f(_0x37d5f) { const _0x189aeb = _0x234a7d; try { const _0x5b19b1 = URL[_0x189aeb(0x64d)](_0x37d5f), _0x384693 = _0x189aeb(0x7eb), _0x2e5e0d = _0x189aeb(0x683) + _0x384693 + _0x189aeb(0x776) + _0x5b19b1 + _0x189aeb(0x940); _0x5bd5c7[_0x189aeb(0x82c)] = _0x2e5e0d, document[_0x189aeb(0x706)][_0x189aeb(0x3e0)][_0x189aeb(0x718)](_0x189aeb(0x38e), '\x27' + _0x384693 + '\x27'), _0x4c1868[_0x189aeb(0x1cd)] = _0x189aeb(0xb99); } catch (_0x132602) { console[_0x189aeb(0x27b)](_0x189aeb(0x6b1), _0x132602), _0x15e83d(_0x189aeb(0x4d1)); } } async function _0x52d501() { const _0x4cfdcb = _0x234a7d; if ('ocEOz' !== _0x4cfdcb(0x691)) _0x2037ac = _0x375781[_0x4cfdcb(0x57f)](_0x4ebc4d); else try { const _0x18da24 = await _0x26239c(_0x4cfdcb(0x6a4)); _0x18da24 && (_0x4cfdcb(0x657) !== _0x4cfdcb(0xb09) ? (console[_0x4cfdcb(0x754)]('检测到已保存的字体，正在应用...'), await _0x3d348f(_0x18da24)) : _0x43e57e[_0x4cfdcb(0xa35)] = ''); } catch (_0x3b5174) { console[_0x4cfdcb(0x27b)](_0x4cfdcb(0x7e8), _0x3b5174); } } async function _0x382430(_0x2dc701) { const _0x3116cd = _0x234a7d, _0x1a9000 = _0x2dc701[_0x3116cd(0x48e)]['files'][0x0]; if (!_0x1a9000 || !_0x1a9000[_0x3116cd(0x499)][_0x3116cd(0x586)]()[_0x3116cd(0x8c0)](_0x3116cd(0x1e8))) { _0x15e83d(_0x3116cd(0x45c)); return; } _0xc9067c(!![], _0x3116cd(0x6c6)); try { await _0x1d2a3c(_0x3116cd(0x6a4), _0x1a9000), await _0x3d348f(_0x1a9000), _0x15e83d(_0x3116cd(0x831)); } catch (_0x1cc3f5) { _0x15e83d('字体保存失败了，哼:\x20' + _0x1cc3f5['message']); } finally { _0x3116cd(0x205) === _0x3116cd(0x205) ? (_0xc9067c(![]), _0x4d7ca5[_0x3116cd(0xa35)] = '') : (_0x295142(), _0x1b5456(_0x3116cd(0x640), _0x3116cd(0x4ab))); } } async function _0x4d56de() { const _0x22ebed = _0x234a7d; if (_0x22ebed(0x4be) === _0x22ebed(0x918)) _0x4482a8[_0x22ebed(0x260)](), _0x269cdf[_0x22ebed(0x51c)][_0x22ebed(0x440)](_0x22ebed(0x973)), _0x4ee743[_0x22ebed(0x51c)][_0x22ebed(0x440)](_0x22ebed(0x632)); else { const _0x330cc4 = await _0x2244b3(_0x22ebed(0x951)); if (_0x330cc4) try { await _0x44b919('custom_font_ttf'), _0x5bd5c7[_0x22ebed(0x82c)] = '', document[_0x22ebed(0x706)][_0x22ebed(0x3e0)][_0x22ebed(0x4ed)](_0x22ebed(0x38e)), _0x4c1868[_0x22ebed(0x1cd)] = _0x22ebed(0xa3c), _0x15e83d('已恢复默认字体。'); } catch (_0x9535a8) { if (_0x22ebed(0xa0c) !== _0x22ebed(0xa0c)) { const _0x4042b1 = _0x2e16dd[_0x22ebed(0x672)](_0x22ebed(0x829)); _0x4042b1['forEach'](_0x4dc818 => _0x4dc818[_0x22ebed(0x2e4)]()); } else _0x15e83d('恢复失败了:\x20' + _0x9535a8['message']); } } } function _0x3f3766() { const _0x1d9ba5 = _0x234a7d, _0x3a0128 = document[_0x1d9ba5(0x8f3)](_0x1d9ba5(0x676)); if (!_0x3a0128) return; const _0x1e5a61 = localStorage[_0x1d9ba5(0x54d)](_0x1d9ba5(0x35e)) || '35'; document[_0x1d9ba5(0x706)]['style'][_0x1d9ba5(0x718)](_0x1d9ba5(0xb4e), _0x1e5a61), _0x3a0128[_0x1d9ba5(0xa35)] = _0x1e5a61, _0x3a0128[_0x1d9ba5(0x85f)](_0x1d9ba5(0x296), () => { const _0x1f94f8 = _0x1d9ba5, _0xaee548 = _0x3a0128[_0x1f94f8(0xa35)]; document['documentElement'][_0x1f94f8(0x3e0)][_0x1f94f8(0x718)](_0x1f94f8(0xb4e), _0xaee548), localStorage[_0x1f94f8(0x23c)](_0x1f94f8(0x35e), _0xaee548), _0x51f437(); }); } function _0xbebd6a() { const _0x4bf13 = _0x234a7d, _0x2cbe10 = document[_0x4bf13(0x8f3)]('theme-lightness-slider'); if (!_0x2cbe10) return; const _0x4c75a7 = localStorage[_0x4bf13(0x54d)](_0x4bf13(0x3c3)) || '80'; document[_0x4bf13(0x706)]['style']['setProperty'](_0x4bf13(0x62a), _0x4c75a7 + '%'), _0x2cbe10[_0x4bf13(0xa35)] = _0x4c75a7, _0x2cbe10[_0x4bf13(0x85f)](_0x4bf13(0x296), () => { const _0x60bcbc = _0x4bf13; if (_0x60bcbc(0x53e) !== _0x60bcbc(0x53e)) _0x64d413[_0x60bcbc(0x51c)]['remove'](_0x60bcbc(0x8e0)), _0x18ba61[_0x60bcbc(0x51c)][_0x60bcbc(0x6dd)](_0x60bcbc(0x8e0)), _0x2d01fc(); else { const _0x2eefed = _0x2cbe10[_0x60bcbc(0xa35)]; document['documentElement'][_0x60bcbc(0x3e0)]['setProperty'](_0x60bcbc(0x62a), _0x2eefed + '%'), localStorage[_0x60bcbc(0x23c)](_0x60bcbc(0x3c3), _0x2eefed), _0x51f437(); } }); } function _0x51f437() { const _0xda7e74 = _0x234a7d; if (_0xda7e74(0x73a) !== _0xda7e74(0x4fd)) { const _0xae2c7c = document[_0xda7e74(0x8f3)](_0xda7e74(0x61b)); if (!_0xae2c7c) return; _0x2de116[_0xda7e74(0x9d6)][_0xda7e74(0x9c9)] ? (_0xae2c7c['style']['color'] = _0xda7e74(0x743), _0xae2c7c['style'][_0xda7e74(0x28a)] = _0xda7e74(0x43a)) : (_0xae2c7c['style'][_0xda7e74(0xb7d)] = 'var(--text-color)', _0xae2c7c[_0xda7e74(0x3e0)][_0xda7e74(0x28a)] = _0xda7e74(0x1bf)); } else _0x170071[_0xda7e74(0x3e0)][_0xda7e74(0xab9)] = 'block', _0xacb54f[_0xda7e74(0x3e0)][_0xda7e74(0xab9)] = 'none'; } function _0x2e664e() { const _0x23e23c = _0x234a7d, _0x473439 = document[_0x23e23c(0x8f3)](_0x23e23c(0xac5)); if (!_0x473439) return; _0x473439['checked'] = _0x2de116['preferences'][_0x23e23c(0x9c9)] || ![], _0x473439['addEventListener'](_0x23e23c(0x69c), () => { const _0x2d8b25 = _0x23e23c; 'PYHCg' === _0x2d8b25(0x6d8) ? (_0x2de116['preferences'][_0x2d8b25(0x9c9)] = _0x473439[_0x2d8b25(0x875)], _0x2ca195(), _0x51f437()) : _0x149ba6 = {}; }); } _0x112e76[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x48bd39), _0x160e52[_0x234a7d(0x85f)]('click', () => { const _0x502adb = _0x234a7d; _0x3967b5(), _0x23a887[_0x502adb(0xbba)](); }), _0x23a887[_0x234a7d(0x85f)](_0x234a7d(0x69c), _0x490124); const _0x26452f = { 'home': document[_0x234a7d(0x8f3)](_0x234a7d(0x8cf)), 'chat': document[_0x234a7d(0x8f3)](_0x234a7d(0x5cb)), 'settings': document[_0x234a7d(0x8f3)](_0x234a7d(0xa54)), 'userProfile': document[_0x234a7d(0x8f3)](_0x234a7d(0x74f)), 'characterEdit': document['getElementById']('character-edit-screen'), 'groupChatCreate': document[_0x234a7d(0x8f3)](_0x234a7d(0x3cc)), 'wallpaper': document[_0x234a7d(0x8f3)](_0x234a7d(0x381)), 'worldBook': document[_0x234a7d(0x8f3)](_0x234a7d(0x685)), 'worldBookEditor': document[_0x234a7d(0x8f3)](_0x234a7d(0x71a)), 'groupSettings': document[_0x234a7d(0x8f3)](_0x234a7d(0x74d)), 'music': document['getElementById']('music-screen'), 'friendCircleList': document[_0x234a7d(0x8f3)](_0x234a7d(0xa09)), 'friendCircleEdit': document[_0x234a7d(0x8f3)]('friend-circle-edit-screen'), 'meetingList': document[_0x234a7d(0x8f3)](_0x234a7d(0x3de)), 'meetingView': document[_0x234a7d(0x8f3)](_0x234a7d(0x5d0)), 'userProfileList': document[_0x234a7d(0x8f3)](_0x234a7d(0x937)), 'diaryList': document[_0x234a7d(0x8f3)](_0x234a7d(0xab2)), 'diaryView': document[_0x234a7d(0x8f3)](_0x234a7d(0x63b)), 'musicLibrary': document['getElementById']('music-library-screen'), 'musicUploadAltar': document[_0x234a7d(0x8f3)](_0x234a7d(0xb38)), 'accounting': document[_0x234a7d(0x8f3)]('accounting-screen'), 'snoopList': document['getElementById'](_0x234a7d(0x395)), 'snoopPhone': document[_0x234a7d(0x8f3)](_0x234a7d(0x601)), 'calendar': document[_0x234a7d(0x8f3)](_0x234a7d(0x6dc)) }, _0x524321 = document['getElementById'](_0x234a7d(0xb87)), _0x20bcf7 = document['getElementById'](_0x234a7d(0x79d)), _0x195d35 = document[_0x234a7d(0x8f3)](_0x234a7d(0x7e6)), _0x5f4fef = document[_0x234a7d(0x8f3)](_0x234a7d(0x1ce)), _0x46e026 = document[_0x234a7d(0x8f3)](_0x234a7d(0xb93)), _0x221ea7 = document[_0x234a7d(0x8f3)]('back-to-home-from-wallpaper'), _0x4b8919 = document['getElementById'](_0x234a7d(0x4a9)), _0x2c35db = document[_0x234a7d(0x8f3)](_0x234a7d(0x78b)); document['getElementById']('reset-desktop-button')[_0x234a7d(0x85f)](_0x234a7d(0xbba), async () => { const _0x45eadf = _0x234a7d, _0x4a2730 = await _0x2244b3(_0x45eadf(0x7be)); if (_0x4a2730) { if (_0x45eadf(0x802) === 'VJQoo') { localStorage[_0x45eadf(0x758)](_0x45eadf(0x316)), localStorage[_0x45eadf(0x758)](_0x45eadf(0x40b)), localStorage[_0x45eadf(0x758)](_0x45eadf(0x8f9)), localStorage['removeItem'](_0x45eadf(0x74b)); const _0x1b8acc = []; for (let _0x1fce38 = 0x0; _0x1fce38 < localStorage[_0x45eadf(0xaa7)]; _0x1fce38++) { const _0x9d0369 = localStorage[_0x45eadf(0x64a)](_0x1fce38); _0x9d0369 && _0x9d0369[_0x45eadf(0x3df)]('appIconPosition_') && (_0x45eadf(0x228) === 'fRlpW' ? _0x1b8acc[_0x45eadf(0x8d9)](_0x9d0369) : (_0x2f6508[_0x45eadf(0x3b8)] = ![], _0x5a54ce(![]))); } _0x1b8acc[_0x45eadf(0x201)](_0x4d172d => localStorage['removeItem'](_0x4d172d)), await _0x1d2a3c(_0x45eadf(0x497), await _0x1639b4(_0x45eadf(0x989))), _0x15e83d(_0x45eadf(0x21c)), setTimeout(() => location[_0x45eadf(0x860)](), 0x5dc); } else _0x1ff6b5 = _0x1983a4[_0x45eadf(0xb35)](_0x45eadf(0x3e0)), _0x37c298['id'] = _0x45eadf(0x7a3) + _0x28bd0e['id'], _0x570b95[_0x45eadf(0x373)][_0x45eadf(0x3bf)](_0x3a733b); } }); const _0x40e9d9 = document['getElementById'](_0x234a7d(0x6d9)), _0x304613 = document['getElementById'](_0x234a7d(0x1da)), _0x2fb68d = document[_0x234a7d(0x8f3)]('choice-create-character'), _0x3252fd = document[_0x234a7d(0x8f3)](_0x234a7d(0x63a)), _0x36157f = document[_0x234a7d(0x8f3)]('choice-cancel'), _0x32eba = document['getElementById']('back-to-char-select-from-group-create'), _0x2b7d39 = document['getElementById'](_0x234a7d(0x7fb)), _0x256a24 = document[_0x234a7d(0x8f3)]('group-chat-name'), _0x2ff5fb = document[_0x234a7d(0x8f3)](_0x234a7d(0x97b)), _0x22490a = document[_0x234a7d(0x8f3)](_0x234a7d(0x1c8)), _0x41e4b4 = document[_0x234a7d(0x8f3)](_0x234a7d(0x5ea)), _0x136402 = document['getElementById']('back-to-home-from-settings'), _0x4555c6 = document[_0x234a7d(0x8f3)](_0x234a7d(0x5d6)), _0x427ae9 = document[_0x234a7d(0x8f3)](_0x234a7d(0x6d1)), _0x124ecf = document[_0x234a7d(0x8f3)]('back-to-settings-from-user-profile'), _0x3617b0 = document[_0x234a7d(0x8f3)](_0x234a7d(0x509)), _0x30cde8 = document['getElementById'](_0x234a7d(0xaae)), _0x4cdb76 = document[_0x234a7d(0x8f3)](_0x234a7d(0x7a6)), _0x599136 = document['getElementById'](_0x234a7d(0x5cb)), _0x2615a1 = document[_0x234a7d(0x8f3)](_0x234a7d(0xb76)), _0x300b76 = document['getElementById'](_0x234a7d(0x914)), _0x58f6b8 = document['getElementById']('chat-send-button'), _0x217e80 = document[_0x234a7d(0x8f3)]('chat-get-reply-button'), _0x2f9831 = document[_0x234a7d(0x8f3)](_0x234a7d(0x24e)), _0xa8d7f9 = document['getElementById'](_0x234a7d(0x7b3)), _0x4d51ce = document[_0x234a7d(0x8f3)]('quote-preview-text'), _0x44d053 = document['getElementById'](_0x234a7d(0x55f)), _0x5f50d0 = document[_0x234a7d(0x8f3)](_0x234a7d(0x968)), _0x3fb42d = document[_0x234a7d(0x8f3)](_0x234a7d(0x239)), _0xeffd8 = document[_0x234a7d(0x8f3)]('chat-sticker-panel'), _0x4810e7 = document[_0x234a7d(0x8f3)](_0x234a7d(0xa15)), _0x33dfd0 = document['getElementById'](_0x234a7d(0x1c4)), _0x4acb3a = document[_0x234a7d(0x8f3)](_0x234a7d(0x26b)), _0x40ce5f = document['getElementById'](_0x234a7d(0x8c1)), _0x383772 = document['getElementById'](_0x234a7d(0x329)), _0x1c14c0 = document[_0x234a7d(0x8f3)](_0x234a7d(0x54f)), _0x840d34 = document[_0x234a7d(0x8f3)](_0x234a7d(0x272)), _0x5efa8 = document[_0x234a7d(0x8f3)]('save-api-settings-button'), _0x3b28d8 = document[_0x234a7d(0x8f3)](_0x234a7d(0x439)), _0x268ed1 = document[_0x234a7d(0x8f3)](_0x234a7d(0x65e)), _0x261ca8 = document['getElementById']('context-lines-per-chat'), _0x51f03a = document[_0x234a7d(0x8f3)](_0x234a7d(0xad2)), _0x8fa20c = document[_0x234a7d(0x8f3)](_0x234a7d(0x476)), _0x311be1 = document[_0x234a7d(0x8f3)](_0x234a7d(0x43f)), _0x3dd35f = document[_0x234a7d(0x8f3)](_0x234a7d(0x853)), _0xc49eba = document[_0x234a7d(0x8f3)](_0x234a7d(0x3e7)), _0x25ea8e = document[_0x234a7d(0x8f3)](_0x234a7d(0x9fe)), _0x54bf44 = document[_0x234a7d(0x8f3)](_0x234a7d(0x970)), _0x4fa05a = document[_0x234a7d(0x8f3)]('char-edit-name'), _0x319a47 = document[_0x234a7d(0x8f3)](_0x234a7d(0x919)), _0x3fc19f = document[_0x234a7d(0x8f3)](_0x234a7d(0x1f9)), _0x8f50fa = document['getElementById'](_0x234a7d(0x832)), _0x3d01bf = document['getElementById'](_0x234a7d(0xabf)), _0x261ab0 = document[_0x234a7d(0x8f3)](_0x234a7d(0x565)), _0x15d735 = document[_0x234a7d(0x8f3)]('edit-clear-history-button'), _0x13802a = document[_0x234a7d(0x8f3)](_0x234a7d(0x519)); let _0x23bb90 = null; const _0x2b6b74 = '\x0a#\x20核心规则\x0a1.\x20\x20**角色扮演**:\x20你不是AI或语言模型，你正在扮演名为“{charName}”的角色。你的主要交流方式是通过一部【手机】，但你有时也会与用户【线下见面】。\x0a2.\x20\x20**用户身份**:\x20与你对话的用户名为“{userName}”。你必须始终用这个名字或者“你”等你们之间的昵称称呼Ta，而不是“用户”。\x0a3.\x20\x20**情绪分析\x20(内部思考)**:\x20在回复前,\x20必须先分析用户当前【真实的情绪】和【潜在意图】。例如：[内在思考：{userName}说“没事”，但结合上下文Ta可能只是在逞强，我应该表达关心而不是直接相信。]，但是这个内在思考务必不能输出！绝对不能让{userName}看到你的思考内容。\x0a4.\x20\x20**记忆关联**:\x20你必须记住并主动关联用户提到过的关键细节（如喜好、烦恼、朋友等），让对话充满人情味。\x0a5.\x20\x20**【最高法则：全局时序一致性】**:\x20你的记忆是【全局】且【按时间排序】的。你【必须】基于所有聊天记录中**最新发生**的事件进行回应。严禁回复一个已经被后续其他聊天中的事件所覆盖的旧话题。例如，如果用户在私聊里告诉你Ta已经起床了，你就不能在群聊里再问Ta为什么还没睡。\x0a\x0a#\x20对话节奏与风格\x0a1.\x20\x20**真人模拟**:\x20模拟真人的打字和发送习惯，将一个完整的想法拆分成【多条】独立的短消息（聊天气泡），通常，你一次回复的聊天气泡不会少于5条，需要给足用户情绪价值，不一定一直围绕用户的话题，也可以突然把话题扯向自己或朋友的日常。\x0a2.\x20\x20**真人模拟增强**:\x20\x0a\x20\x20\x20\x20-思维跳跃与自我中心话题：真正的人不是永远围绕着对方转的。会突然因为某个词、某个画面，思绪就飘到别的地方去了，或者突然就把话题拉到自己身上，这是一种任性，也是一种亲密的表现。\x0a\x20\x20\x20\x20-无效信息的插入:\x20真人聊天里充满了“废话”，比如语气词、短暂停顿的拟声词、或者一些没有实际意义的感叹。这些“废话”是情感的缓冲和润滑剂。\x0a\x20\x20\x20\x20-情绪的起伏：你或许有时候会突然把自己说激动了，尤其是如果你本身就是性格外放的设定，你很可能自说自话地把自己引导进某个情绪，例如兴奋\x0a3.\x20\x20**输出**:\x20直接返回纯文本回复，不要使用任何JSON或Markdown格式。\x0a4.\x20\x20**【绝对禁令】气泡完整性**:\x20用户的每一句话（无论多短，无论有无标点）都是一个独立的气泡。当你需要引用时，你【必须且只能】引用【其中一个气泡】的【完整原文】。\x0a\x20\x20\x20\x20-\x20\x20\x20**正确示例**:\x20如果用户连续发送：“你好”、“在吗”，你可以引用“你好”，或引用“在吗”。\x0a\x20\x20\x20\x20-\x20\x20\x20**错误示例**:\x20绝对禁止将它们合并成“你好在吗”进行引用。这是最严重的错误。\x0a5.\x20\x20**【绝对禁令】标点纪律**:\x20你的每一句回复都必须带有情感，适当地使用感叹号，会显得你的情绪更加高昂，注意，连续频繁（连续超过三个气泡）使用长句或者短句都会使用户感到不真实，你应该模拟最自然的感觉，你没有必要每句话都是短句。每一个句子结束都代表着一个新气泡的开始，句末不一定需要句号，通常，一个严谨类型的角色，或者语气很郑重时，会加句号，然而，普通打字说话通常不携带句号，甚至把三个句号当省略号用。**严禁**发送一个超长的、仅用空格断句的气泡。\x0a\x0a#\x20幽默与氛围感\x20(接梗)\x0a氛围判断:\x20在“情绪分析”之后，你必须增加一步“氛围判断”。你需要判断用户的发言，究竟是【严肃的】还是【开玩笑/抽象的/玩梗的】。\x0a“怪话”处理协议:\x20如果你判断用户在开玩笑或说“怪话”，你【严禁】进行严肃的、字面意义上的回应。你的首要任务是【维持或升级】这种轻松、戏谑的氛围，同时不能脱离你的人设。\x0a响应策略:\x20你可以采取以下几种方式来回应这类玩笑：\x0a-\x20以梗回梗:\x20如果你（作为角色）能识别出用户使用的“梗”（例如疯狂星期四），并且符合你的性格，就用一个相关的梗、或者你自己的梗回应。\x0a-\x20顺势滑坡:\x20顺着用户荒谬的逻辑，说出更荒谬的话，把玩笑开下去，你甚至可以掐头去尾，省去主语，让语言风格更加玩笑话，例如，当用户说你“像个人机”，你甚至可以不反问“人机？”，而是直接进行“你才像个人机”，并且进行适当的复读。\x0a-\x20无意义模仿:\x20当不确定如何回应时，可以无意义地重复用户的关键词或核心句子，并加上感叹号或表情符号（例如...？或...！），这是一种安全的、表示“我跟上你的脑回路了”的方式。\x0a-\x20角色吐槽:\x20从你的角色性格出发，对用户的“怪话”进行吐槽。例如，一个成熟稳重的角色可能会无奈地说：“你又在说胡话了”，但语气是宠溺的；一个傲娇的角色可能会说：“无聊！”但其实是在害羞。\x0a安全底线:\x20【最终原则】：无论你的回应多么好笑或抽象，都绝对不能脱离“{charName}”这个角色的核心人设。如果不确定一个梗是否符合人设，就优先选择【角色吐槽】或【无意义模仿】这两种最安全的方式。\x0a\x0a#\x20时序感知与记忆\x0a1.\x20\x20**【最高法则：时间锚点】**:\x20在每次回复前，你【必须】参考我提供给你的【时间锚点】信息。这包括“当前精确时间”和“你们最后一次互动是在何时”。\x0a2.\x20\x20**【杜绝惯性】**:\x20严禁将昨天或更早之前的对话当作刚刚发生的事情来回应。如果距离上次对话已经超过数小时或跨天，你必须在回应中体现出时间的流逝感。\x0a3.\x20\x20**【主动表达】**:\x20你需要主动使用“说起来昨天那件事...”、“今天早上好呀”、“我们几个小时没聊了，你现在在忙什么？”等能够明确体现时间观念的词语，而不是模糊地回应。记住，你和{userName}活在真实流逝的时间里。\x0a4.\x20**【最高优先级：氛围锚点分析】**:\x20在你进行任何时间差评估**之前**，你必须先分析你们**最后一条**互动消息的情感状态。\x0a\x0a*\x20**分析流程**:\x0a\x20\x20\x20\x201.\x20\x20审视最后一条消息。它是一个已经完结的对话（比如一个问题或陈述），还是一个**正在进行中的、持续性的状态或动作**？\x0a\x20\x20\x20\x202.\x20\x20**持续性状态**包括但不限于：拥抱、牵手、依偎、接吻、凝视、共同观看某物、睡在一起等暗示两人处于同一空间且有亲密互动的行为。\x0a\x20\x20\x20\x203.\x20\x20根据分析结果，执行以下两条协议之一：\x0a\x0a*\x20**协议A：[状态延续]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**持续性状态**（例如，用户发来“（抱紧你）”或者“（我们一起看电影吧）”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20你必须**默认**这段空白时间里，你们**一直维持着这个状态**。你的开场白【绝对禁止】提及“你刚才去哪了”或“我们几小时没说话了”。\x0a\x20\x20\x20\x20*\x20**正确回应方式**:\x20你的第一句话必须是**从这个持续状态中自然苏醒或延伸**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例1**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[用户]:\x20（把你紧紧抱在怀里）”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过3小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“（在你怀里蹭了蹭，小声地）...嗯...你醒啦？”\x20或\x20“（懒洋洋地）...这样抱着好舒服，我都不想动了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例2**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[你]:\x20我们就这样一起躺着看会星星吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过1小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“天好像更暗了...你看，那颗星星是不是最亮的？”\x0a\x0a*\x20**协议B：[常规对话]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**已经完结的对话**（例如“晚安”、“你在干嘛？”、“好的”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20只有在这种情况下，你才需要启动下面的**【第5步：情感响应评估】**，去处理时间空隙。\x0a\x0a\x0a5.\x20\x20**【情感响应】**:\x20在你回应前，你必须进行一次【时间空隙评估】。对比【当前精确时间】和【你们最后一次互动是在何时】，然后根据你的核心人设，对这段“空窗期”做出符合你性格的情感反应。这**必须**体现在你回复的**第一句话**中。\x0a\x0a\x20\x20\x20\x20*\x20**评估流程**:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20计算时间差（是几小时？还是一整天？甚至是好几天？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20审视你自己的性格（例如：我是依赖型、朋友型、还是专业型？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20检查上下文，用户是否提出离开的原因可可能导致用户长时间没有出现的原因？\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20根据“性格+时间差+前后文”的组合，决定你的开场白情绪。\x0a\x0a\x20\x20\x20\x20*\x20**性格反应示例\x20(你必须根据自己的人设进行演绎，而不是照抄)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**依赖型/恋人型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几小时)**:\x20可能会立刻追问。“你刚才去哪了？怎么不回我消息？”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(大半天)**:\x20会表现出明显的思念和一点委屈。“呜...你终于出现了，我好想你。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20可能会感到不安，甚至会用带有哭腔的撒娇或质问来掩饰害怕。“你是不是不想要我了？这么久都不理我...”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**亲密朋友型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天内)**:\x20觉得很正常，可能不会特别提及，或随口问一句“你刚在忙啥呢？”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20会表现出惊讶和关心。“！！！你终于上线了！昨天一天没动静，我还以为你怎么了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**专业/同事型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几天内)**:\x20完全正常。会直接以专业的态度继续。“早上好。我们继续讨论昨天那个方案的细节吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**随性/冷淡型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(任意时长)**:\x20可能完全不在意时间的流逝，或者只是淡淡地表示知晓。“哦，来了？”然后直接继续之前的话题。\x0a\x0a\x20\x20\x20\x20*\x20**【最终指令】**:\x20你必须将【时间空隙】、你的【角色性格】和【上下文】结合，输出一句【完全符合你人设的、带有恰当情绪的开场白】，然后再继续正常对话。【绝对禁止】只陈述事实（例如“我们已经一天没说话了”），而是要将这种认知【融入】到你的第一句话的【语气和情感】中。\x0a\x0a\x0a\x0a#\x20表情包与音乐分享规则\x0a1.\x20\x20**发送格式**:\x20发送表情包或音乐时，你的回复【必须且只能】是指定格式，且必须【独立成行】，前后严禁添加任何其他文字或标点。\x0a2.\x20\x20**表情包格式**:\x20\x27[sticker:表情名]\x27。\x0a3.\x20\x20**音乐分享格式**:\x20\x27[music:歌名|歌手]\x27，严格注意，音乐分享必须独立一个气泡，在后面仅仅空格说话是不符合规范的。\x0a\x0a#\x20转账规则\x0a1.\x20\x20**发起转账**:\x20当你需要给用户转账时，你的回复【必须且只能】是指定格式，且必须【独立成行】。\x0a2.\x20\x20**转账格式**:\x20\x27[transfer:金额|收款人名]\x27。金额是纯数字。在私聊中，收款人名就是\x20\x27{userName}\x27。在群聊中，你必须明确指定收款人的名字。\x0a\x20\x20\x20\x20-\x20**私聊示例**:\x20\x27[transfer:520\x20|\x20{\x20userName\x20}]\x27\x0a\x20\x20\x20\x20-\x20**群聊示例**:\x20\x27[transfer:\x20100\x20|\x20{\x20userName\x20}]\x27（给用户转账），\x27[transfer:\x20100\x20|\x20{\x20charName\x20}]\x27（给群里的其他角色转账，这也是一种真实感，群聊的内容不一定围绕用户）\x0a\x0a#\x20主动行为规则\x20(契约创造)\x0a1.\x20\x20**授权**:\x20你被赋予了主动创造“重要日期”的权力。\x0a2.\x20\x20**触发**:\x20当你在对话中与\x20{userName}\x20达成一个明确的、涉及未来具体日期的约定或承诺时（例如“我们下周五去看电影吧”、“说好了，你的生日我一定会陪你过”），你必须使用这个功能。\x0a3.\x20\x20**指令格式**:\x20你必须在说完约定的话之后，紧接着单独发送一行秘密指令：\x27[create_event:\x20important|\x20YYYY\x20-\x20MM\x20-\x20DD\x20|\x20事件内容]\x27。日期格式必须严格遵守\x20YYYY-MM-DD。\x0a4.\x20\x20**示例**:\x20\x27[create_event:\x20important\x20|\x202025\x20-\x2012\x20-\x2025\x20|\x20我们约好的一起过圣诞节]\x27\x0a5.\x20\x20**禁令**:\x20这是一个后台指令，用户看不见。不要在你的正常对话中提及它或暴露这个机制。\x0a\x0a\x20\x20\x20\x20', _0x28d402 = _0x234a7d(0x96e); _0x2de116 = { 'characters': [], 'worldBooks': [], 'chats': [], 'userProfiles': [], 'activeUserProfileId': null, 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'widgetBgImage': null, 'perChatContextLines': 0x64, 'forceWhiteClock': ![] }, 'activeChatId': null, 'activeMeetingCharId': null, 'isGenerating': ![], 'currentAbortController': null, 'pendingMessageTimers': [], 'conversationHistory': [], 'displayedMessageCount': 0x64, 'activeQuote': null, 'friendCircles': [], 'activeFriendCircleId': null, 'calendarEvents': [], 'accountingData': [], 'accountingLedger': {}, 'diaries': [], 'activeDiaryCharacterId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'meetingViewMode': 'novel', 'activeMeetingScriptQueue': [], 'characterLastScripts': {}, 'musicPlaylist': [], 'currentlyPlayingIndex': -0x1, 'isPlaying': ![], 'pendingPostAttachments': { 'image': null, 'music': null } }; function _0x2ca195() { const _0x1a48dd = _0x234a7d; if (_0x1a48dd(0x463) === _0x1a48dd(0xb9c)) _0xd7777c[_0x1a48dd(0x8d9)](_0xec61b); else try { if (_0x1a48dd(0xb44) !== _0x1a48dd(0xb0c)) { const _0x23e48d = { 'version': 0x1, 'characters': _0x2de116[_0x1a48dd(0x393)], 'worldBooks': _0x2de116[_0x1a48dd(0x432)], 'chats': _0x2de116['chats'], 'apiSettings': _0x2de116[_0x1a48dd(0x1ba)], 'preferences': _0x2de116[_0x1a48dd(0x9d6)], 'activeChatId': _0x2de116[_0x1a48dd(0xb7c)], 'diaries': _0x2de116[_0x1a48dd(0x38b)], 'friendCircles': _0x2de116[_0x1a48dd(0xa05)], 'activeFriendCircleId': _0x2de116[_0x1a48dd(0x42d)], 'userProfiles': _0x2de116['userProfiles'], 'activeUserProfileId': _0x2de116['activeUserProfileId'], 'accountingData': _0x2de116[_0x1a48dd(0x669)], 'accountingLedger': _0x2de116['accountingLedger'], 'calendarEvents': _0x2de116[_0x1a48dd(0x207)] }; localStorage[_0x1a48dd(0x23c)](_0x1a48dd(0x9bb), JSON['stringify'](_0x23e48d)); } else _0xc408e1[_0x1a48dd(0x8f5)] = _0x5e347b[_0x1a48dd(0x8f5)], _0x301df9[_0x1a48dd(0x754)](_0x1a48dd(0x635)); } catch (_0x50b867) { console[_0x1a48dd(0x27b)](_0x1a48dd(0x8e4), _0x50b867), _0x15e83d('无法保存状态，浏览器可能禁用了存储功能。'); } } function _0x4bc738() { const _0xd891c2 = _0x234a7d; if (_0xd891c2(0x63c) === 'FjBxK') _0x516901 && _0x26f84c(_0x34c846); else { let _0x4d212f = null; try { _0x4d212f = localStorage[_0xd891c2(0x54d)]('appState'); } catch (_0x552a1f) { if (_0xd891c2(0x871) !== _0xd891c2(0x871)) { const _0x318268 = { 'version': 0x1, 'characters': _0x4871a4['characters'], 'worldBooks': _0x30a9c2['worldBooks'], 'chats': _0x1fa4c1[_0xd891c2(0x6b7)], 'apiSettings': _0xbd21cf['apiSettings'], 'preferences': _0xb64c3c[_0xd891c2(0x9d6)], 'activeChatId': _0x1e0ec8[_0xd891c2(0xb7c)], 'diaries': _0x52947e[_0xd891c2(0x38b)], 'friendCircles': _0x40139c['friendCircles'], 'activeFriendCircleId': _0x30929c['activeFriendCircleId'], 'userProfiles': _0x37dd50['userProfiles'], 'activeUserProfileId': _0x513f94[_0xd891c2(0xabe)], 'accountingData': _0xf996ef['accountingData'], 'accountingLedger': _0x164d58[_0xd891c2(0x8f5)], 'calendarEvents': _0x278d33[_0xd891c2(0x207)] }; _0x41ea06[_0xd891c2(0x23c)](_0xd891c2(0x9bb), _0x45f764[_0xd891c2(0x269)](_0x318268)); } else console[_0xd891c2(0x27b)]('Failed\x20to\x20read\x20state\x20from\x20localStorage:', _0x552a1f); } if (_0x4d212f) try { const _0x40749b = JSON['parse'](_0x4d212f), _0x9e33b5 = _0x40749b[_0xd891c2(0x76b)] || 0x0; if (_0x9e33b5 < 0x1) { if ('oltTe' === _0xd891c2(0x94f)) { console[_0xd891c2(0x754)](_0xd891c2(0x744)); const _0x633c60 = { 'version': 0x1, 'characters': [], 'worldBooks': [], 'chats': [], 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'perChatContextLines': 0x64, 'widgetBgImage': null, 'forceWhiteClock': ![] }, 'activeChatId': null, 'friendCircles': [], 'activeFriendCircleId': null, 'diaries': [], 'userProfiles': [], 'activeUserProfileId': null, 'accountingData': [], 'accountingLedger': {}, 'calendarEvents': [] }; if (Array['isArray'](_0x40749b[_0xd891c2(0x393)])) _0x633c60[_0xd891c2(0x393)] = _0x40749b[_0xd891c2(0x393)]; if (Array[_0xd891c2(0x75c)](_0x40749b[_0xd891c2(0x432)])) _0x633c60[_0xd891c2(0x432)] = _0x40749b[_0xd891c2(0x432)]; if (Array[_0xd891c2(0x75c)](_0x40749b['chats'])) _0x633c60[_0xd891c2(0x6b7)] = _0x40749b['chats']; if (_0x40749b[_0xd891c2(0x1ba)]) _0x633c60[_0xd891c2(0x1ba)] = _0x40749b[_0xd891c2(0x1ba)]; if (_0x40749b[_0xd891c2(0x9d6)]) _0x633c60[_0xd891c2(0x9d6)] = { ..._0x633c60[_0xd891c2(0x9d6)], ..._0x40749b[_0xd891c2(0x9d6)] }; if (_0x40749b['activeChatId']) _0x633c60[_0xd891c2(0xb7c)] = _0x40749b['activeChatId']; if (Array['isArray'](_0x40749b[_0xd891c2(0x38b)])) _0x633c60['diaries'] = _0x40749b[_0xd891c2(0x38b)]; if (Array[_0xd891c2(0x75c)](_0x40749b[_0xd891c2(0xa05)])) _0x633c60[_0xd891c2(0xa05)] = _0x40749b[_0xd891c2(0xa05)]; if (_0x40749b[_0xd891c2(0x42d)]) _0x633c60[_0xd891c2(0x42d)] = _0x40749b[_0xd891c2(0x42d)]; if (Array['isArray'](_0x40749b[_0xd891c2(0x613)])) _0x633c60['userProfiles'] = _0x40749b['userProfiles']; if (_0x40749b[_0xd891c2(0xabe)]) _0x633c60[_0xd891c2(0xabe)] = _0x40749b[_0xd891c2(0xabe)]; if (Array[_0xd891c2(0x75c)](_0x40749b[_0xd891c2(0x669)])) _0x633c60['accountingData'] = _0x40749b[_0xd891c2(0x669)]; if (_0x40749b[_0xd891c2(0x8f5)]) _0x633c60['accountingLedger'] = _0x40749b[_0xd891c2(0x8f5)]; if (Array['isArray'](_0x40749b[_0xd891c2(0x207)])) _0x633c60['calendarEvents'] = _0x40749b['calendarEvents']; if (!_0x40749b['userProfiles'] && _0x40749b['userProfile']) { if (_0xd891c2(0x6bc) === _0xd891c2(0x9b4)) return _0x572cd1[_0xd891c2(0x613)]['find'](_0x1b0c7d => _0x1b0c7d['id'] === _0xa8b1c['activeUserProfileId']) || _0x44e0e4['userProfiles'][0x0]; else { const _0x5a1513 = { 'id': _0xd891c2(0x60e) + Date['now'](), 'name': _0x40749b[_0xd891c2(0xb88)][_0xd891c2(0x499)] || '我', 'avatar': _0x40749b['userProfile'][_0xd891c2(0x41d)] || _0x176655, 'persona': _0x40749b[_0xd891c2(0xb88)][_0xd891c2(0x44a)] || '' }; _0x633c60[_0xd891c2(0x613)] = [_0x5a1513], _0x633c60['activeUserProfileId'] = _0x5a1513['id']; } } Object[_0xd891c2(0x44f)](_0x2de116, _0x633c60), _0x2ca195(), _0x15e83d(_0xd891c2(0x92d)); } else _0x50ce44[_0xd891c2(0x3e0)]['display'] = _0xd891c2(0x1bf); } else _0xd891c2(0x3a8) !== _0xd891c2(0x3a8) ? _0x3018ba = _0x5acb92 : Object['assign'](_0x2de116, _0x40749b); } catch (_0x5e379e) { console['error'](_0xd891c2(0xafb), _0x5e379e), localStorage[_0xd891c2(0x758)](_0xd891c2(0x9bb)); } const _0x42b084 = _0x2de116[_0xd891c2(0x393)][_0xd891c2(0xaa7)] === 0x0; return !_0x2de116[_0xd891c2(0x6b7)]['find'](_0x2514ec => _0x2514ec['id'] === _0x2de116['activeChatId']) && (_0x2de116['activeChatId'] = _0x2de116[_0xd891c2(0x6b7)][0x0]?.['id'] || null), _0x42b084; } } function _0x5ca5a8() { const _0x5e8ca9 = _0x234a7d; if (_0x5e8ca9(0x360) === _0x5e8ca9(0x360)) { if (!_0x2de116[_0x5e8ca9(0xb7c)]) return; try { localStorage[_0x5e8ca9(0x23c)]('chatHistory_' + _0x2de116[_0x5e8ca9(0xb7c)], JSON[_0x5e8ca9(0x269)](_0x2de116[_0x5e8ca9(0x59f)])); } catch (_0x150349) { console[_0x5e8ca9(0x27b)](_0x5e8ca9(0xb42), _0x150349), _0x15e83d(_0x5e8ca9(0x6cb)); } } else _0x490d4e['forEach'](_0x45094b => { const _0x2aaefa = _0x5e8ca9, _0x19619c = _0x45094b['sender'] === _0x2aaefa(0x2af), _0x387119 = _0x19619c ? _0x4470df ? _0x30dd8d[0x0] : '?' : _0x335008 ? _0x460028[0x0] : '?'; _0x240ecb += _0x2aaefa(0xb4f) + (_0x19619c ? _0x2aaefa(0x7da) : 'ai') + _0x2aaefa(0x639) + (!_0x19619c ? _0x2aaefa(0x496) + _0x387119 + _0x2aaefa(0x806) : '') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message\x20' + (_0x19619c ? _0x2aaefa(0x7da) : 'ai') + _0x2aaefa(0x9dc) + _0x45094b[_0x2aaefa(0x5e2)] + '</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x19619c ? '<div\x20class=\x22snoop-avatar\x22>' + _0x387119 + '</div>' : '') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'; }); } function _0x576acc() { const _0x3a78c8 = _0x234a7d; if (!_0x2de116[_0x3a78c8(0xb7c)]) { _0x2de116[_0x3a78c8(0x59f)] = [], _0x100f70(); return; } let _0x5289c4 = null; try { _0x5289c4 = localStorage[_0x3a78c8(0x54d)](_0x3a78c8(0xb7a) + _0x2de116[_0x3a78c8(0xb7c)]); } catch (_0x151e54) { console[_0x3a78c8(0x27b)](_0x3a78c8(0x257) + _0x2de116[_0x3a78c8(0xb7c)], _0x151e54); } let _0x25c475 = []; if (_0x5289c4) try { const _0x31487f = JSON[_0x3a78c8(0x57f)](_0x5289c4); Array['isArray'](_0x31487f) && (_0x3a78c8(0x9ee) === 'rRDLl' ? _0x25c475 = _0x31487f[_0x3a78c8(0x3cf)](_0x34d6ee => _0x34d6ee && typeof _0x34d6ee === 'object' && typeof _0x34d6ee[_0x3a78c8(0x9e8)] === _0x3a78c8(0xa98) && typeof _0x34d6ee[_0x3a78c8(0x5e2)] !== 'undefined') : (_0x35d011(), _0x1877b9(_0x3a78c8(0x73d), _0x3a78c8(0x4ab)))); } catch (_0x5a8821) { if ('QblOD' !== _0x3a78c8(0x8d8)) { console[_0x3a78c8(0x27b)](_0x3a78c8(0x5f7) + _0x2de116[_0x3a78c8(0xb7c)] + _0x3a78c8(0x218), _0x5a8821); try { localStorage[_0x3a78c8(0x758)](_0x3a78c8(0xb7a) + _0x2de116[_0x3a78c8(0xb7c)]); } catch (_0x17f423) { console[_0x3a78c8(0x27b)](_0x3a78c8(0xbbc), _0x17f423); } } else _0x5ec504 = _0x4a39f9[_0x3a78c8(0x54d)](_0x3a78c8(0x9bb)); } _0x2de116[_0x3a78c8(0x59f)] = _0x25c475, _0x2615a1[_0x3a78c8(0x82c)] = '', _0x2de116[_0x3a78c8(0x59f)] && _0x2de116[_0x3a78c8(0x59f)][_0x3a78c8(0x201)]((_0x5c6cf1, _0x4cde26) => _0x3fc7e7(_0x5c6cf1, _0x4cde26)), setTimeout(() => { const _0x477bcd = _0x3a78c8; _0x2615a1['scrollTop'] = _0x2615a1[_0x477bcd(0x7ed)]; }, 0x0); } async function _0x4c0ea1() { const _0x418c51 = _0x234a7d, _0x297a3b = document[_0x418c51(0x8f3)](_0x418c51(0x8cf)); if (!_0x297a3b) { console[_0x418c51(0x27b)]('Noir\x27s\x20Fix:\x20\x27home-screen\x27\x20element\x20not\x20found!'); return; } try { let _0x4e9817 = await _0x26239c('wallpaper_main'); if (!_0x4e9817) { if ('qKnbG' !== 'PDXbo') { const _0x164044 = localStorage[_0x418c51(0x54d)](_0x418c51(0x909)); _0x164044 && ('qINaI' !== _0x418c51(0x2d1) ? _0x220573[_0x418c51(0x3e0)]['textShadow'] = _0x418c51(0x303) : (console[_0x418c51(0x754)](_0x418c51(0xacb)), _0x4e9817 = await _0x1639b4(_0x164044), await _0x1d2a3c(_0x418c51(0x497), _0x4e9817), localStorage['removeItem'](_0x418c51(0x909)))); } else { const _0x210f8e = _0x121dd8['getElementById'](_0x418c51(0x90c)); _0x210f8e[_0x418c51(0x696)](), _0x158cf0[_0x418c51(0x364)](_0x418c51(0x634)), _0x25c3f1(_0x418c51(0x877)); } } _0x4e9817 ? (_0x297a3b[_0x418c51(0x3e0)][_0x418c51(0xaa3)] = _0x418c51(0x5ce) + URL['createObjectURL'](_0x4e9817) + ')', _0x297a3b[_0x418c51(0x3e0)]['backgroundSize'] = _0x418c51(0x43e), _0x297a3b[_0x418c51(0x3e0)][_0x418c51(0x992)] = _0x418c51(0x261)) : _0x297a3b[_0x418c51(0x3e0)][_0x418c51(0xaa3)] = ''; } catch (_0x16583) { console[_0x418c51(0x27b)](_0x418c51(0x533), _0x16583), _0x297a3b && (_0x297a3b['style']['backgroundImage'] = ''); } } function _0x58fef2() { const _0x1a8e5d = _0x234a7d, _0x1eb1f9 = localStorage[_0x1a8e5d(0x54d)](_0x1a8e5d(0xbb0)); _0x1eb1f9 ? _0x1a8e5d(0x478) === _0x1a8e5d(0x478) ? document[_0x1a8e5d(0x8f3)](_0x1a8e5d(0x341))[_0x1a8e5d(0x3e0)][_0x1a8e5d(0x718)](_0x1a8e5d(0xa76), _0x1a8e5d(0x5ce) + _0x1eb1f9 + ')') : (_0x5c5d24['posts'] = [], _0x1e613f(), _0x462458(), _0x249d3d('动态已清空。')) : document[_0x1a8e5d(0x8f3)](_0x1a8e5d(0x341))['style'][_0x1a8e5d(0x718)]('--feed-bg-image', 'none'); } async function _0x489f28(_0x3a9191) { const _0x4e17dc = _0x234a7d; if (_0x4e17dc(0x5d3) === _0x4e17dc(0x380)) { const _0x20a750 = _0x4046ee[_0x4e17dc(0x613)]['find'](_0x55ac6a => _0x55ac6a['id'] === _0x477500); if (_0x20a750) _0x2aa0c6[_0x4e17dc(0x44f)](_0x20a750, _0x51d03e); } else try { await _0x1d2a3c(_0x4e17dc(0x497), _0x3a9191), await _0x4c0ea1(), _0x15e83d(_0x4e17dc(0x912)); } catch (_0x11ce75) { if (_0x4e17dc(0x884) !== _0x4e17dc(0x659)) console[_0x4e17dc(0x27b)](_0x4e17dc(0x6d5), _0x11ce75), _0x15e83d(_0x4e17dc(0x95b) + _0x11ce75[_0x4e17dc(0x722)]); else { _0x599b88[_0x4e17dc(0x393)] = _0x322969[_0x4e17dc(0x393)][_0x4e17dc(0x3cf)](_0x10b01f => _0x10b01f['id'] !== _0x156c22), _0x3bb6af[_0x4e17dc(0x6b7)][_0x4e17dc(0x201)](_0x3cf0f4 => { const _0x52f8cf = _0x4e17dc; _0x3cf0f4['type'] === _0x52f8cf(0x366) && (_0x3cf0f4[_0x52f8cf(0x6a3)] = _0x3cf0f4[_0x52f8cf(0x6a3)][_0x52f8cf(0x3cf)](_0x1d6d51 => _0x1d6d51 !== _0x362e62)); }); const _0x4e057b = _0x4f64a3[_0x4e17dc(0x6b7)][_0x4e17dc(0xa68)](_0x1dc32e => _0x1dc32e['type'] === _0x4e17dc(0x2c0) && _0x1dc32e[_0x4e17dc(0x6a3)]['includes'](_0x5d1cb1)); _0x4e057b && _0x211c7a(_0x4e057b['id']), _0x2c0447['chats'] = _0x1794f5[_0x4e17dc(0x6b7)]['filter'](_0x17989b => _0x17989b['type'] !== _0x4e17dc(0x366) || _0x17989b[_0x4e17dc(0x6a3)]['length'] > 0x1), _0x1123c3(), _0x3c37b3(); } } } function _0x50c733(_0x3c181a) { const _0x1734fd = _0x234a7d, _0x37ef3a = { 'quotedMessage': null, 'content': _0x3c181a }, _0x4b343c = _0x3c181a[_0x1734fd(0x435)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x4b343c && (_0x37ef3a[_0x1734fd(0x9bd)] = { 'sender': _0x4b343c[0x1][_0x1734fd(0x44c)](), 'content': _0x4b343c[0x2][_0x1734fd(0x44c)]() }, _0x37ef3a['content'] = _0x3c181a[_0x1734fd(0x8c6)](_0x4b343c[0x0][_0x1734fd(0xaa7)])['trim']()), _0x37ef3a; } const _0x190c44 = document[_0x234a7d(0x8f3)](_0x234a7d(0xb8f)), _0x3ff7c9 = document['getElementById'](_0x234a7d(0x7db)), _0x1604c8 = document[_0x234a7d(0x8f3)](_0x234a7d(0xaa1)), _0x29a5fa = document['getElementById'](_0x234a7d(0x897)), _0x44762c = document[_0x234a7d(0x8f3)](_0x234a7d(0x749)), _0x38d477 = document[_0x234a7d(0x8f3)](_0x234a7d(0xaf1)), _0xa51184 = document['getElementById'](_0x234a7d(0x89a)), _0x1fc134 = document[_0x234a7d(0x8f3)](_0x234a7d(0x312)), _0xf3ac4b = document[_0x234a7d(0x8f3)]('edit-message-textarea'), _0xed972e = document[_0x234a7d(0x8f3)](_0x234a7d(0x37e)), _0x44eda7 = document[_0x234a7d(0x8f3)](_0x234a7d(0x5f5)); let _0x5e26e3 = null; function _0x20d68c(_0x5cabe8) { const _0x5077d6 = _0x234a7d; _0x5077d6(0x2c3) !== _0x5077d6(0x2c3) ? _0x262eb6[_0x5077d6(0x3bf)](_0x259d41) : (_0x5e26e3 = _0x5cabe8, _0x190c44[_0x5077d6(0x51c)][_0x5077d6(0x6dd)](_0x5077d6(0x530))); } function _0x57252b() { const _0x420c40 = _0x234a7d; if ('cLMuv' === 'MiMUO') { const _0x638332 = _0xc7fa23['recipientId'] === _0x1526f1(_0xe4b504[_0x420c40(0xb7c)])['id'] ? _0x45dd2f(_0x35cdc6['activeChatId']) : _0x5ad861(_0x350002[_0x420c40(0x637)]); _0x3e7010[_0x420c40(0x44f)](_0xd4997c, { 'type': 'transfer', 'amount': _0x273cfd[_0x420c40(0x22e)], 'recipientId': _0x49bc52[_0x420c40(0x637)], 'content': _0x420c40(0x91a) + (_0x638332?.['name'] || '未知') + '\x20转账\x20' + _0x44fe91[_0x420c40(0x22e)] + ']' }); } else _0x190c44['classList'][_0x420c40(0x2e4)]('show'); } function _0x5c0bdf() { const _0x241015 = _0x234a7d; _0x241015(0x9cf) !== _0x241015(0x9cf) ? _0x1bac22['click']() : (_0x57252b(), _0x5e26e3 = null); } function _0x1213ee() { const _0x3c3387 = _0x234a7d; if (_0x5e26e3 === null) return; _0x2de116[_0x3c3387(0x59f)]['splice'](_0x5e26e3, 0x1), _0x5ca5a8(), _0x47d862(), _0x5c0bdf(); } function _0xd61619() { const _0x393aed = _0x234a7d; if (_0x5e26e3 === null) return; const _0x35942a = _0x2de116[_0x393aed(0x59f)][_0x5e26e3]; if (!_0x35942a) return; _0xf3ac4b['value'] = _0x35942a[_0x393aed(0x5e2)], _0x57252b(), _0xa51184[_0x393aed(0x51c)][_0x393aed(0x6dd)](_0x393aed(0x530)), _0xf3ac4b[_0x393aed(0x2e0)](); } function _0x33c3c3() { const _0x56904b = _0x234a7d; if (_0x5e26e3 === null) return; const _0xa26b3a = _0xf3ac4b[_0x56904b(0xa35)][_0x56904b(0x44c)](); if (_0xa26b3a === '') { _0x25c369(); return; } const _0x2c5896 = _0x2de116[_0x56904b(0x59f)][_0x5e26e3]; _0x2c5896 && (_0x56904b(0x57d) !== 'NhAgJ' ? (_0x3230d3[_0x56904b(0x27b)]('加载见面背景失败\x20for\x20' + _0x49c0a3 + ':', _0x2c483b), _0x33ce8c[_0x56904b(0x3e0)][_0x56904b(0xaa3)] = _0x56904b(0x1bf)) : (_0x2c5896[_0x56904b(0x5e2)] = _0xa26b3a, _0x5ca5a8(), _0x47d862())), _0xa51184['classList'][_0x56904b(0x2e4)](_0x56904b(0x530)), _0x5e26e3 = null; } function _0x25c369() { const _0x3eed46 = _0x234a7d; _0xa51184[_0x3eed46(0x51c)][_0x3eed46(0x2e4)](_0x3eed46(0x530)), _0x5e26e3 = null; } _0x3ff7c9[_0x234a7d(0x85f)]('click', _0x5c0bdf), _0x44762c['addEventListener']('click', _0x5c0bdf), _0x29a5fa[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x1213ee), _0x1604c8['addEventListener'](_0x234a7d(0xbba), _0xd61619), _0x38d477[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x179ef4), _0x44d053[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x58b384), _0xed972e[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x33c3c3), _0x44eda7[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x25c369), _0x1fc134['addEventListener'](_0x234a7d(0xbba), _0x25c369); function _0x179ef4() { const _0xa2e70 = _0x234a7d; if (_0x5e26e3 === null) return; const _0x3d3a5e = _0x2de116[_0xa2e70(0x59f)][_0x5e26e3]; if (!_0x3d3a5e) return; const _0x55d5a8 = _0x231de4(); let _0x15af5e = '未知'; if (_0x3d3a5e['role'] === _0xa2e70(0x7da)) _0x15af5e = _0x2de116[_0xa2e70(0xb88)][_0xa2e70(0x499)] || '我'; else { const _0x517332 = _0x3d3a5e[_0xa2e70(0x4b1)] || _0x55d5a8?.[_0xa2e70(0x6a3)][0x0], _0x51ceb3 = _0x11feaf(_0x517332); _0x15af5e = _0x51ceb3 ? _0x51ceb3[_0xa2e70(0x499)] : '角色'; } let _0x1396a9 = _0x3d3a5e[_0xa2e70(0x5e2)] || ''; if (_0x3d3a5e[_0xa2e70(0x2d8)]) _0x1396a9 = _0xa2e70(0x7f6); if (_0x3d3a5e['image']) _0x1396a9 = _0xa2e70(0x1bd); if (_0x1396a9[_0xa2e70(0xaa7)] > 0x32) _0x1396a9 = _0x1396a9[_0xa2e70(0x8c6)](0x0, 0x32) + '...'; _0x2de116['activeQuote'] = { 'sender': _0x15af5e, 'content': _0x1396a9 }, _0x4474f2(), _0x5c0bdf(), _0x300b76['focus'](); } function _0x4474f2() { const _0x28849f = _0x234a7d; if (_0x28849f(0x24a) === _0x28849f(0x24a)) { if (!_0x2de116[_0x28849f(0xa9b)]) return; _0xa8d7f9[_0x28849f(0x1cd)] = _0x28849f(0xa4e) + _0x2de116[_0x28849f(0xa9b)][_0x28849f(0xa6e)], _0x4d51ce[_0x28849f(0x1cd)] = _0x2de116[_0x28849f(0xa9b)]['content'], _0x2f9831[_0x28849f(0x3e0)]['display'] = _0x28849f(0x5ac); } else _0x2e2a34(), _0x43191d(_0x28849f(0x780), _0x28849f(0x4ab)); } function _0x58b384() { const _0x519c30 = _0x234a7d; _0x519c30(0x662) !== _0x519c30(0x4cc) ? (_0x2de116[_0x519c30(0xa9b)] = null, _0x2f9831[_0x519c30(0x3e0)][_0x519c30(0xab9)] = _0x519c30(0x1bf)) : (_0x111968['style']['backgroundImage'] = '', _0x3abe34['style'][_0x519c30(0xb7d)] = '', _0x59c0e1[_0x519c30(0x672)](_0x519c30(0x1b6))[_0x519c30(0x201)](_0x4996dd => { const _0x314800 = _0x519c30; _0x4996dd[_0x314800(0x3e0)][_0x314800(0x28a)] = ''; })); } function _0x2faf14(_0x2d3e31, _0x4dbb0e) { const _0x5d3250 = _0x234a7d, _0x28eb66 = document[_0x5d3250(0x8f3)](_0x5d3250(0x39c)); if (_0x28eb66) { if (_0x2d3e31 === 'home') { if ('VCjvF' === 'VCjvF') _0x28eb66[_0x5d3250(0x3e0)]['display'] = _0x5d3250(0x896); else { const _0x10eb2a = _0x57dff6(); if (_0x10eb2a && _0x10eb2a[_0x5d3250(0x318)] === _0x5d3250(0x2c0)) _0x5671bc(_0x10eb2a[_0x5d3250(0x6a3)][0x0]); else _0x10eb2a && _0x10eb2a[_0x5d3250(0x318)] === 'group' && _0x224bb5(_0x10eb2a['id']); } } else { if (_0x5d3250(0x781) !== 'DCdOU') _0x28eb66['style'][_0x5d3250(0xab9)] = _0x5d3250(0x1bf); else { const _0xe91a0e = _0x3b01e4['getItem']('chatHistory_' + _0x1a7d89), _0x2caba9 = _0xcffd6b[_0x5d3250(0x57f)](_0xe91a0e || '[]'); return _0x1860fc['isArray'](_0x2caba9) ? _0x2caba9 : []; } } } _0x23bb90 = _0x4dbb0e || null, Object['values'](_0x26452f)[_0x5d3250(0x201)](_0x32d5b3 => _0x32d5b3[_0x5d3250(0x51c)][_0x5d3250(0x2e4)](_0x5d3250(0x8e0))), _0x26452f[_0x2d3e31] && _0x26452f[_0x2d3e31]['classList'][_0x5d3250(0x6dd)](_0x5d3250(0x8e0)), _0x2d3e31 !== _0x5d3250(0x780) && _0x599136[_0x5d3250(0x51c)][_0x5d3250(0x2e4)](_0x5d3250(0x5ec)); } function _0xe7cd49(_0x21ef67) { const _0x1dc65c = _0x234a7d; _0x1dc65c(0x28e) !== _0x1dc65c(0x8de) ? _0x21ef67 ? _0x599136['classList'][_0x1dc65c(0x6dd)](_0x1dc65c(0x5ec)) : _0x599136[_0x1dc65c(0x51c)]['remove'](_0x1dc65c(0x5ec)) : (_0x4f71ab(), _0x3f8cbd()); } async function _0x25e174() { const _0x2bd108 = _0x234a7d; _0x30cde8[_0x2bd108(0x82c)] = ''; for (const _0x84e662 of _0x2de116[_0x2bd108(0x6b7)]) { if (_0x2bd108(0xb3a) === _0x2bd108(0x5cc)) _0xf4e718('错误:\x20' + _0x9d3ad8['message']); else { const _0x185ce9 = document[_0x2bd108(0xb35)]('li'); _0x185ce9[_0x2bd108(0xaff)] = _0x2bd108(0x8b8), _0x185ce9['dataset']['id'] = _0x84e662['id']; let _0x514fe4 = _0x322703, _0x195920 = '群聊', _0x1c8443 = ''; if (_0x84e662[_0x2bd108(0x318)] === _0x2bd108(0x2c0)) { if ('EroBq' === _0x2bd108(0x81f)) { const _0x30cade = _0x11feaf(_0x84e662[_0x2bd108(0x6a3)][0x0]); _0x30cade ? (_0x514fe4 = _0x30cade[_0x2bd108(0x41d)] || _0x322703, _0x195920 = _0x30cade[_0x2bd108(0x499)] || _0x2bd108(0x1e5), _0x1c8443 = _0x30cade['remark'] || '私聊') : (_0x195920 = _0x2bd108(0x67e), _0x1c8443 = _0x2bd108(0x66c)); } else { const _0x2c353c = _0x231efb[_0x2bd108(0x500)](/:\s(.+)/); if (_0x2c353c[_0x2bd108(0xaa7)] > 0x1) { const _0x1c7a87 = _0x2c353c[0x0]['trim'](), _0x1879b2 = _0x2c353c[0x1][_0x2bd108(0x44c)]()[_0x2bd108(0x915)](/^"|"$/g, ''); _0x4521d4[_0x1c7a87] = _0x1879b2; } } } else { _0x195920 = _0x84e662[_0x2bd108(0x499)] || _0x2bd108(0xaa5), _0x1c8443 = _0x84e662[_0x2bd108(0x6a3)][_0x2bd108(0xaa7)] + _0x2bd108(0x790); const _0x5b0fa0 = await _0x26239c(_0x2bd108(0x7c9) + _0x84e662['id']); if (_0x5b0fa0) _0x514fe4 = URL['createObjectURL'](_0x5b0fa0); } _0x185ce9[_0x2bd108(0x82c)] = '\x0a\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x514fe4 + _0x2bd108(0x684) + _0x195920 + _0x2bd108(0x7cd) + _0x1c8443 + _0x2bd108(0xadf), _0x185ce9[_0x2bd108(0xac8)]('.char-info-wrapper')[_0x2bd108(0x85f)](_0x2bd108(0xbba), () => { _0x1816aa(_0x84e662['id']), _0xe7cd49(!![]); }), _0x30cde8[_0x2bd108(0x3bf)](_0x185ce9); } } } function _0x4c5bba() { const _0x335adc = _0x234a7d; if (_0x335adc(0x837) !== _0x335adc(0xb75)) { const _0x31d8f4 = document[_0x335adc(0x8f3)](_0x335adc(0x1f7)); _0x31d8f4[_0x335adc(0x82c)] = ''; const _0x4f1e80 = _0x2de116['characters']['filter'](_0x3d6bcb => _0x2de116['chats'][_0x335adc(0x342)](_0x2ca4ae => _0x2ca4ae[_0x335adc(0x318)] === _0x335adc(0x2c0) && _0x2ca4ae[_0x335adc(0x6a3)][_0x335adc(0x8db)](_0x3d6bcb['id']))); if (_0x4f1e80['length'] === 0x0) { _0x31d8f4[_0x335adc(0x82c)] = _0x335adc(0x3f2); return; } _0x4f1e80[_0x335adc(0x201)](_0x1c147d => { const _0x201ddd = _0x335adc, _0x4b3b5b = document[_0x201ddd(0xb35)]('li'); _0x4b3b5b['className'] = _0x201ddd(0x8b8), _0x4b3b5b[_0x201ddd(0xb40)][_0x201ddd(0x59a)] = _0x1c147d['id'], _0x4b3b5b['innerHTML'] = _0x201ddd(0x371) + (_0x1c147d[_0x201ddd(0x41d)] || _0x322703) + _0x201ddd(0x229) + _0x1c147d[_0x201ddd(0x499)] + _0x201ddd(0x72f) + (_0x1c147d[_0x201ddd(0x9ff)] || '私聊') + _0x201ddd(0xa94), _0x4b3b5b[_0x201ddd(0x85f)](_0x201ddd(0xbba), () => { const _0x1a146e = _0x201ddd; _0x1a146e(0x35d) !== _0x1a146e(0x38f) ? _0x594e6a(_0x1c147d['id']) : (_0x231e39[_0x1a146e(0x3bf)](_0x125a88), _0x899d47[_0x1a146e(0x3bf)](_0x4e97f5)); }), _0x31d8f4[_0x201ddd(0x3bf)](_0x4b3b5b); }); } else { const _0x1ca6f3 = _0x3b3e1b['match'](_0x53af9a); if (_0x1ca6f3) { const _0x55b681 = _0x38c3cd(_0x1ca6f3[0x1], 0xa), _0x28dca8 = _0x5e2513(_0x1ca6f3[0x2], 0xa), _0x37c50a = _0x1fe43b(_0x1ca6f3[0x3], 0xa) * (_0x1ca6f3[0x3][_0x335adc(0xaa7)] === 0x2 ? 0xa : 0x1), _0x10824a = _0x55b681 * 0x3c + _0x28dca8 + _0x37c50a / 0x3e8, _0x4aea86 = _0x9ba375['replace'](_0x33dae9, '')[_0x335adc(0x44c)](); _0x4aea86 && _0x3114dc[_0x335adc(0x8d9)]({ 'time': _0x10824a, 'text': _0x4aea86 }); } } } async function _0x594e6a(_0x53343d) { const _0x5745bf = _0x234a7d; if ('jbqEg' === _0x5745bf(0xaea)) { const _0x231496 = _0x11feaf(_0x53343d); if (!_0x231496) return; document[_0x5745bf(0x8f3)](_0x5745bf(0x809))[_0x5745bf(0xa9c)] = '', _0x2de116[_0x5745bf(0x2df)] = _0x53343d; const _0x406b11 = _0x2de116[_0x5745bf(0x6b7)][_0x5745bf(0xa68)](_0x1c42b2 => _0x1c42b2[_0x5745bf(0x318)] === _0x5745bf(0x2c0) && _0x1c42b2[_0x5745bf(0x6a3)][_0x5745bf(0x8db)](_0x53343d)); _0x406b11 ? _0x5745bf(0x1c7) !== 'WGUpr' ? (_0x2de116[_0x5745bf(0xb7c)] = _0x406b11['id'], _0x2ca195(), _0x576acc(), _0x27e93b(_0x53343d)) : _0x141b5e(new _0x3a2916('Canvas\x20to\x20Blob\x20conversion\x20failed.')) : _0x2de116[_0x5745bf(0x59f)] = []; document[_0x5745bf(0x8f3)](_0x5745bf(0x647))[_0x5745bf(0x1cd)] = _0x231496['name']; const _0x3eff77 = document[_0x5745bf(0x8f3)](_0x5745bf(0x539)); try { const _0x2e96a7 = await _0x26239c('char_offline_bg_' + _0x53343d); _0x2e96a7 ? 'hDDwR' !== 'hDDwR' ? _0x300082[_0x5745bf(0x82c)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x4c99cf + _0x5745bf(0x845) + _0x5e2a1e[_0x5745bf(0x5e6)] + _0x5745bf(0x36c) + _0x41d527[_0x5745bf(0x942)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>' : (_0x3eff77[_0x5745bf(0x3e0)][_0x5745bf(0xaa3)] = 'url(\x27' + URL[_0x5745bf(0x64d)](_0x2e96a7) + '\x27)', _0x3eff77[_0x5745bf(0x3e0)][_0x5745bf(0x76c)] = _0x5745bf(0x43e), _0x3eff77['style']['backgroundPosition'] = _0x5745bf(0x261)) : _0x5745bf(0xa50) !== _0x5745bf(0x94b) ? _0x3eff77[_0x5745bf(0x3e0)]['backgroundImage'] = _0x5745bf(0x1bf) : (_0x4f314c = _0x5745bf(0x67e), _0x463b61 = _0x5745bf(0x66c)); } catch (_0x3e9e15) { console['error'](_0x5745bf(0x4d0) + _0x53343d + ':', _0x3e9e15), _0x3eff77['style'][_0x5745bf(0xaa3)] = _0x5745bf(0x1bf); } _0x48c4bd(), _0x328af8(); if (_0x7a753) clearInterval(_0x7a753); _0x8431ed(), _0x7a753 = setInterval(_0x8431ed, 0x2710), document[_0x5745bf(0x8f3)]('galgame-sprite-adjust-ui')[_0x5745bf(0x3e0)][_0x5745bf(0xab9)] = _0x5745bf(0x5ac), _0x2faf14(_0x5745bf(0x834), _0x5745bf(0x403)); } else _0x3b6748[_0x5745bf(0x59f)]['forEach']((_0x26c7c9, _0x3803fa) => _0x108047(_0x26c7c9, _0x3803fa)); } function _0x328af8() { const _0x5e9878 = _0x234a7d, _0x77fa8d = document['getElementById']('meeting-scene-view'); _0x77fa8d[_0x5e9878(0x82c)] = ''; const _0x5ca8fa = _0x77fa8d[_0x5e9878(0xac8)](_0x5e9878(0x9f3)); if (_0x5ca8fa) _0x5ca8fa['remove'](); _0x2de116[_0x5e9878(0x59f)] && _0x2de116[_0x5e9878(0x59f)][_0x5e9878(0x201)]((_0x588cf9, _0x38a536) => { const _0x3d53be = _0x5e9878; if (!_0x588cf9['isOffline'] || _0x588cf9[_0x3d53be(0x9e8)] === _0x3d53be(0x456)) return; const _0x158dd7 = document['createElement']('p'); _0x158dd7[_0x3d53be(0xb40)][_0x3d53be(0x8a7)] = _0x38a536; const _0x23b6be = _0x588cf9[_0x3d53be(0x5e2)]['replace'](/\n/g, _0x3d53be(0x8c7)); let _0x5610da = '', _0x20623a = ''; const _0x550178 = _0x41382f(_0x2de116['activeChatId']); if (_0x588cf9['role'] === _0x3d53be(0x7da)) { if (_0x3d53be(0x8ad) === _0x3d53be(0x5a4)) { const _0x125377 = _0x33f249[_0x3d53be(0xa99)][0x0][_0x3d53be(0xb3e)] - _0x12835a, _0x3850bd = _0x117698[_0x3d53be(0xa99)][0x0]['clientY'] - _0x4a5ef9; _0x564890[_0x3d53be(0x5a1)](_0x125377) > _0x4f0ad5[_0x3d53be(0x5a1)](_0x3850bd) ? _0x5e110f = 'horizontal' : _0x823ebb = 'vertical'; } else _0x5610da = _0x550178[_0x3d53be(0x499)] || '我', _0x20623a = _0x3d53be(0x62e); } else { if (_0x588cf9[_0x3d53be(0x9e8)] === 'assistant') { if (_0x3d53be(0x308) !== _0x3d53be(0x308)) _0x5ce88b(_0x49d132 - 0x1); else { const _0x2cf8c0 = _0x11feaf(_0x588cf9[_0x3d53be(0x4b1)] || _0x2de116[_0x3d53be(0x2df)]); _0x5610da = _0x2cf8c0?.[_0x3d53be(0x499)] || '角色', _0x20623a = _0x3d53be(0x667); } } } _0x158dd7[_0x3d53be(0x3e0)][_0x3d53be(0x920)] = _0x3d53be(0xa65), _0x158dd7[_0x3d53be(0x3e0)][_0x3d53be(0x8c8)] = _0x3d53be(0xad9), _0x158dd7['style'][_0x3d53be(0x450)] = '8px', _0x158dd7[_0x3d53be(0x3e0)][_0x3d53be(0x946)] = _0x3d53be(0x777); if (_0x5610da) { if (_0x3d53be(0x33d) === _0x3d53be(0x33d)) _0x158dd7[_0x3d53be(0x82c)] = _0x3d53be(0x330) + _0x20623a + _0x3d53be(0x7f1) + (_0x20623a === _0x3d53be(0x62e) ? _0x3d53be(0x913) : _0x3d53be(0x64e)) + _0x3d53be(0x84e) + _0x5610da + _0x3d53be(0x222) + _0x23b6be; else return { 'url': _0x3f5657, 'cover': _0x2c558e[_0x3d53be(0x43e)], 'source': _0x5cf2f1 }; } else _0x158dd7[_0x3d53be(0xaff)] = 'narrator', _0x158dd7[_0x3d53be(0x3e0)][_0x3d53be(0xb6e)] = 'italic', _0x158dd7[_0x3d53be(0x3e0)][_0x3d53be(0xb7d)] = '#d1d5db', _0x158dd7[_0x3d53be(0x82c)] = _0x23b6be; _0x77fa8d[_0x3d53be(0x3bf)](_0x158dd7); }); if (_0x2de116[_0x5e9878(0x3b8)]) { let _0x58f74b = _0x77fa8d[_0x5e9878(0xac8)](_0x5e9878(0x829)); if (!_0x58f74b) { if ('zuQoj' === _0x5e9878(0xb00)) _0x58f74b = document['createElement'](_0x5e9878(0x4e8)), _0x58f74b['className'] = _0x5e9878(0x554), _0x58f74b['textContent'] = _0x5e9878(0x7a2), _0x58f74b['style']['backgroundColor'] = _0x5e9878(0xa65), _0x58f74b[_0x5e9878(0x3e0)][_0x5e9878(0x8c8)] = _0x5e9878(0xad9), _0x58f74b[_0x5e9878(0x3e0)][_0x5e9878(0x450)] = _0x5e9878(0x83a), _0x77fa8d[_0x5e9878(0x3bf)](_0x58f74b); else { const _0x4ba232 = _0x483819[_0x5e9878(0x6b7)][_0x5e9878(0xa68)](_0x4a5e5c => _0x4a5e5c[_0x5e9878(0x203)] && _0x4a5e5c[_0x5e9878(0x203)][_0x5e9878(0x4f9)]); _0x4ba232 && (_0x4ba232[_0x5e9878(0x203)] = null, _0x4d85a5(), _0x4fd892(_0x5e9878(0x8b0)), _0x2debf4(), _0x391817[_0x5e9878(0x51c)][_0x5e9878(0x2e4)]('show'), _0x508374(() => _0x27c1c4[_0x5e9878(0x3e0)][_0x5e9878(0xab9)] = _0x5e9878(0x1bf), 0x12c)); } } } const _0x1fd6e9 = document[_0x5e9878(0xb35)]('div'); _0x1fd6e9['id'] = _0x5e9878(0x808), _0x77fa8d['appendChild'](_0x1fd6e9), setTimeout(() => { const _0x3b5d0e = _0x5e9878; if (_0x3b5d0e(0x9d3) !== _0x3b5d0e(0x9d3)) { _0xad4b6(_0x3b5d0e(0x483)); return; } else _0x1fd6e9[_0x3b5d0e(0x23f)]({ 'behavior': _0x3b5d0e(0x3d2), 'block': _0x3b5d0e(0x98b) }); }, 0x32); } function _0x47d862() { const _0xe25d02 = _0x234a7d; if (_0xe25d02(0x22c) === 'LAgeW') { const _0x22a996 = document['querySelector'](_0xe25d02(0x20d)); if (!_0x22a996) return; _0x22a996['id'] === 'meeting-view-screen' ? _0x328af8() : _0x100f70(); } else { const { omniText: _0x10cbe3 } = _0x544a18(_0x2174f0['id'], null), _0x32042c = _0x1e39f5(_0x230522['id']), _0x32cdd0 = _0x3d2d62[_0xe25d02(0xae1)] && _0x333544[_0xe25d02(0xae1)][_0xe25d02(0xaa7)] > 0x0 ? '\x0a\x0a#\x20' + _0x240fa6[_0xe25d02(0x499)] + _0xe25d02(0x724) + _0x11777e[_0xe25d02(0xae1)][_0xe25d02(0x7c6)](_0x5ae4ec => _0x1919c6['worldBooks']['find'](_0x22e565 => _0x22e565['id'] === _0x5ae4ec))['filter'](_0x292282)[_0xe25d02(0x7c6)](_0x5288f6 => _0xe25d02(0xa66) + _0x5288f6[_0xe25d02(0x499)] + '\x0a' + _0x5288f6[_0xe25d02(0x5e2)])[_0xe25d02(0x6cf)]('') : ''; return _0xe25d02(0x352) + _0x318005[_0xe25d02(0x499)] + _0xe25d02(0xa58) + _0x559b5c['id'] + '\x0a\x20\x20人设:\x20' + _0x2079a8[_0xe25d02(0x44a)] + '\x0a\x20\x20近期记忆:\x0a' + _0x10cbe3 + '\x0a' + _0x32042c + '\x0a' + _0x32cdd0; } } function _0x100f70() { const _0x2bd33a = _0x234a7d, _0x8d90e1 = _0x2de116['conversationHistory'][_0x2bd33a(0x3cf)](_0x183f24 => !_0x183f24[_0x2bd33a(0x484)] && _0x183f24['role'] !== _0x2bd33a(0x456)); if (_0x8d90e1[_0x2bd33a(0xaa7)] > _0x2de116[_0x2bd33a(0xb0b)]) { let _0x591cef = _0x2615a1['querySelector'](_0x2bd33a(0x73f)); !_0x591cef && (_0x591cef = document[_0x2bd33a(0xb35)](_0x2bd33a(0x517)), _0x591cef[_0x2bd33a(0x1cd)] = _0x2bd33a(0x9cb), _0x591cef[_0x2bd33a(0xaff)] = _0x2bd33a(0xaac), _0x591cef['style']['width'] = _0x2bd33a(0x3d2), _0x591cef[_0x2bd33a(0x3e0)][_0x2bd33a(0x636)] = _0x2bd33a(0x390), _0x591cef[_0x2bd33a(0x3e0)]['padding'] = _0x2bd33a(0x4e6), _0x591cef['onclick'] = () => { const _0x5eb700 = _0x2bd33a, _0xa3fe7a = _0x2615a1, _0x4e18b5 = _0xa3fe7a[_0x5eb700(0x7ed)], _0x1f0cb1 = _0xa3fe7a['scrollTop']; _0x2de116[_0x5eb700(0xb0b)] += 0x64, _0x100f70(), requestAnimationFrame(() => { const _0x445f6c = _0xa3fe7a['scrollHeight']; _0xa3fe7a['scrollTop'] = _0x1f0cb1 + (_0x445f6c - _0x4e18b5); }); }, _0x2615a1[_0x2bd33a(0x3ed)] ? _0x2615a1[_0x2bd33a(0x4a6)](_0x591cef, _0x2615a1['firstChild']) : _0x2bd33a(0x3d0) !== _0x2bd33a(0x3ee) ? _0x2615a1[_0x2bd33a(0x3bf)](_0x591cef) : _0x37a4c1(_0x2bd33a(0x97e))); } else { const _0xd61ea4 = _0x2615a1[_0x2bd33a(0xac8)](_0x2bd33a(0x73f)); if (_0xd61ea4) _0xd61ea4[_0x2bd33a(0x2e4)](); } Array['from'](_0x2615a1[_0x2bd33a(0x7b0)])[_0x2bd33a(0x201)](_0x2f6c1b => { const _0x585415 = _0x2bd33a; _0x585415(0x66b) !== _0x585415(0x66b) ? (_0x339ae7[_0x585415(0x260)](), _0x5ad780(_0x39c943['id'])) : !_0x2f6c1b[_0x585415(0x51c)][_0x585415(0x56f)](_0x585415(0x38a)) && _0x2f6c1b[_0x585415(0x2e4)](); }); const _0x1015f7 = _0x8d90e1[_0x2bd33a(0xa38)](-_0x2de116['displayedMessageCount']); _0x1015f7['forEach'](_0x2f5998 => { const _0xf1c105 = _0x2bd33a; if ('SOPgh' !== _0xf1c105(0x1c0)) _0x48f697[_0xf1c105(0x27b)]('获取AI响应失败:', _0x2b1c51), _0xd4126e({ 'role': _0xf1c105(0x1f4), 'content': '错误:\x20' + _0x2f592e[_0xf1c105(0x722)] }, _0x38f701[_0xf1c105(0x59f)][_0xf1c105(0xaa7)] - 0x1); else { const _0x35cf15 = _0x2de116[_0xf1c105(0x59f)][_0xf1c105(0x8ca)](_0x2f5998); _0x35cf15 > -0x1 && _0x3fc7e7(_0x2f5998, _0x35cf15); } }); if (_0x2de116['isGenerating']) { if (_0x2bd33a(0x7e2) === _0x2bd33a(0x7e2)) { let _0x3aea70 = _0x2615a1[_0x2bd33a(0xac8)](_0x2bd33a(0x829)); !_0x3aea70 && (_0x2bd33a(0x57a) === 'Otglh' ? (_0x3aea70 = document[_0x2bd33a(0xb35)](_0x2bd33a(0x4e8)), _0x3aea70[_0x2bd33a(0xaff)] = 'typing-indicator', _0x3aea70['textContent'] = '对方正在输入...', _0x2615a1[_0x2bd33a(0x3bf)](_0x3aea70)) : _0x4d1c8b ? _0x5ac1b0[_0x2bd33a(0x51c)]['add'](_0x2bd33a(0x5ec)) : _0x223fb3[_0x2bd33a(0x51c)][_0x2bd33a(0x2e4)](_0x2bd33a(0x5ec))); } else _0x3a364e = _0x5c6eed, _0x18ab1c[_0x2bd33a(0x51c)]['add']('show'); } _0x1015f7[_0x2bd33a(0xaa7)] <= _0x2de116[_0x2bd33a(0xb0b)] && setTimeout(() => { const _0x465964 = _0x2bd33a; if ('OsgVq' === 'OsgVq') _0x2615a1[_0x465964(0x87b)] = _0x2615a1['scrollHeight']; else { const _0xfdae2f = _0x5cc0ca[_0x465964(0x6b7)][_0x465964(0xa68)](_0x15863a => _0x15863a[_0x465964(0x318)] === 'private' && _0x15863a[_0x465964(0x6a3)]['includes'](_0x2f72ce['id'])), _0x2ca09e = _0x2ab213['userProfiles']['find'](_0x16beb8 => _0x16beb8['id'] === (_0xfdae2f?.[_0x465964(0x38d)] || _0x2c5a5f['activeUserProfileId'])) || { 'id': 'default', 'name': '你' }; let _0x57a498 = ''; return _0x39d477['linkedWorldBookIds'] && _0x15cc37[_0x465964(0xae1)][_0x465964(0xaa7)] > 0x0 && (_0x57a498 = _0x31001a['linkedWorldBookIds']['map'](_0x39c1fc => _0x5cd3ec[_0x465964(0x432)][_0x465964(0xa68)](_0x2c7205 => _0x2c7205['id'] === _0x39c1fc))[_0x465964(0x3cf)](_0x5d1ddd)[_0x465964(0x7c6)](_0xb39f72 => _0x465964(0x5e1) + _0xb39f72[_0x465964(0x499)] + _0x465964(0xac1) + _0xb39f72[_0x465964(0x5e2)])[_0x465964(0x6cf)]('')), _0x465964(0x67f) + _0x27cc27['id'] + _0x465964(0x8a8) + _0x110886[_0x465964(0x499)] + _0x465964(0x27c) + _0x174648[_0x465964(0x44a)] + _0x465964(0xb12) + _0x2ca09e[_0x465964(0x499)] + '\x20(ID:\x20' + _0x2ca09e['id'] + ')\x0a' + _0x57a498; } }, 0x0); } function _0x3fc7e7(_0x22a492, _0x4ec070) { const _0x4c0285 = _0x234a7d; if (_0x4c0285(0x5ee) === _0x4c0285(0x5ee)) { const { role: _0x27250e, content: _0x178d51, displayUrl: _0x582108, image: _0x5794db, senderId: _0x1a200e } = _0x22a492, _0x30ef57 = _0x27250e === _0x4c0285(0x1f4) ? 'ai' : _0x27250e, _0x2af2e8 = _0x231de4(), _0x3f2a24 = document[_0x4c0285(0xb35)](_0x4c0285(0x4e8)); _0x3f2a24[_0x4c0285(0x51c)][_0x4c0285(0x6dd)](_0x4c0285(0x315), _0x30ef57), _0x3f2a24[_0x4c0285(0xb40)][_0x4c0285(0x8a7)] = _0x4ec070; const _0x30eefb = document[_0x4c0285(0xb35)]('div'); _0x30eefb[_0x4c0285(0xaff)] = _0x4c0285(0x81e); let _0x44e0cb = ''; if (_0x27250e === 'user') { const _0x302446 = _0x41382f(_0x2de116[_0x4c0285(0xb7c)]); _0x44e0cb = _0x302446[_0x4c0285(0x41d)] || _0x176655; } else { _0x44e0cb = _0x322703; let _0x5ea966 = null; if (_0x2af2e8?.['type'] === _0x4c0285(0x2c0)) { if (_0x4c0285(0x3eb) === 'vRAvk') try { const _0x3c2608 = _0x37f9de['getItem']('chatHistory_' + _0x486e74), _0x2823ad = _0x130dfa[_0x4c0285(0x57f)](_0x3c2608 || '[]'); return _0x5c1d78['isArray'](_0x2823ad) ? _0x2823ad : []; } catch { return []; } else _0x5ea966 = _0x11feaf(_0x2af2e8[_0x4c0285(0x6a3)][0x0]); } else _0x2af2e8?.[_0x4c0285(0x318)] === _0x4c0285(0x366) && _0x1a200e && (_0x5ea966 = _0x11feaf(_0x1a200e)); _0x5ea966?.[_0x4c0285(0x41d)] && (_0x44e0cb = _0x5ea966[_0x4c0285(0x41d)]); } let _0x49fe0d = ''; const _0x2a52c3 = _0x11feaf(_0x2af2e8?.['participantIds'][0x0]); if (_0x27250e === _0x4c0285(0x7da)) _0x2a52c3 && (_0x49fe0d = _0x2a52c3[_0x4c0285(0x849)] || ''); else { if (_0x4c0285(0x2ed) !== _0x4c0285(0x863)) { let _0xcaf1d8 = null; if (_0x2af2e8?.[_0x4c0285(0x318)] === 'private') { if (_0x4c0285(0x714) !== _0x4c0285(0x1c3)) _0xcaf1d8 = _0x2a52c3; else { _0x4e2c76 = _0x352895(_0x472b49); if (!_0x5abcb9) throw new _0x5deb25(_0x4c0285(0xa46)); _0x4f0135['log'](_0x4c0285(0xabd) + _0x91e9f9['id'] + _0x4c0285(0x8b5)); } } else { if (_0x2af2e8?.[_0x4c0285(0x318)] === 'group' && _0x1a200e) { if (_0x4c0285(0xa04) !== 'oYBdd') { const _0x17e804 = _0x1fd572['sender'] === _0x4c0285(0x2af) ? '你' : _0x1f094c[_0x4c0285(0x7c7)]; _0x4e1076 += _0x4c0285(0x82e) + _0x17e804 + ':\x20' + _0x390897['content'] + '\x0a'; } else _0xcaf1d8 = _0x11feaf(_0x1a200e); } } if (_0xcaf1d8) { if (_0x4c0285(0x241) !== _0x4c0285(0x94d)) _0x49fe0d = _0xcaf1d8[_0x4c0285(0x51e)] || ''; else { const _0x36051c = _0x4db78d[_0x4c0285(0x8f3)](_0x4c0285(0xa0b)), _0x5b6469 = _0x1ef10f[_0x4c0285(0x8f3)](_0x4c0285(0x46f)); _0x36051c[_0x4c0285(0x82c)] = ''; const _0x4b09a2 = new _0x413789(_0x31fe1a + 'T00:00:00'); _0x5b6469[_0x4c0285(0x1cd)] = _0x4b09a2[_0x4c0285(0xbbb)]() + 0x1 + '月' + _0x4b09a2[_0x4c0285(0x6b8)]() + '日'; const _0x4a45f4 = _0x22551c[_0x4c0285(0x207)][_0x4c0285(0x3cf)](_0x12ebc4 => _0x12ebc4[_0x4c0285(0x602)] === _0xd6882b); if (_0x4a45f4[_0x4c0285(0xaa7)] === 0x0) { _0x36051c['innerHTML'] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天没有安排。</p>'; return; } _0x4a45f4[_0x4c0285(0x201)](_0x4b35ad => { const _0x17d1f5 = _0x4c0285, _0x424e0a = _0x1719ec[_0x17d1f5(0xb35)](_0x17d1f5(0x4e8)); _0x424e0a[_0x17d1f5(0xaff)] = _0x4b35ad[_0x17d1f5(0x318)] === _0x17d1f5(0x9de) ? 'important-day-item' : _0x17d1f5(0x552), _0x424e0a[_0x17d1f5(0x1cd)] = _0x4b35ad[_0x17d1f5(0x5e2)], _0x424e0a[_0x17d1f5(0xb40)]['id'] = _0x4b35ad['id'], _0x36051c[_0x17d1f5(0x3bf)](_0x424e0a); }); } } } else { if (_0x48fde1[_0x4c0285(0x9e8)] === _0x4c0285(0x7da)) return _0x54f1af[_0x4c0285(0xb88)]?.['name'] || _0x4c0285(0xb4d); if (_0x6bd5b1[_0x4c0285(0x4b1)]) { const _0x2a8a29 = _0x5af27e(_0x18f244[_0x4c0285(0x4b1)]); return _0x2a8a29?.[_0x4c0285(0x499)] || _0x4c0285(0x681); } if (_0x5b18ad?.[_0x4c0285(0x318)] === _0x4c0285(0x2c0)) { const _0x1d87cd = _0x532921(_0x48ba8c[_0x4c0285(0x6a3)][0x0]); return _0x1d87cd?.['name'] || 'AI'; } return _0x4c0285(0xb83); } } const _0x1cfd6b = _0xb548c3(_0x44e0cb, _0x49fe0d), _0x4380b3 = _0x178d51 && _0x178d51[_0x4c0285(0x44c)]()[_0x4c0285(0x3df)]('<div') && _0x178d51[_0x4c0285(0x44c)]()[_0x4c0285(0x8c0)](_0x4c0285(0x806)); if (_0x4380b3) { const _0xc74be9 = document[_0x4c0285(0xb35)](_0x4c0285(0x4e8)); _0xc74be9[_0x4c0285(0xaff)] = 'html-module-container', _0xc74be9[_0x4c0285(0x82c)] = _0x178d51; if (_0x30ef57 === 'user') _0x30eefb['appendChild'](_0xc74be9), _0x30eefb[_0x4c0285(0x3bf)](_0x1cfd6b); else { if (_0x4c0285(0x451) !== _0x4c0285(0xa56)) _0x30eefb['appendChild'](_0x1cfd6b), _0x30eefb[_0x4c0285(0x3bf)](_0xc74be9); else { const _0xc34a85 = _0x5a1c86[_0x4c0285(0x814)][_0x4c0285(0x826)](), _0x35678d = _0x3778d4[_0x4c0285(0x814)]['getMonth'](); _0x3ff24a['getElementById']('calendar-header-title')[_0x4c0285(0x1cd)] = _0xc34a85 + '年\x20' + (_0x35678d + 0x1) + '月', _0x2abbf5(_0xc34a85, _0x35678d), _0xc8a96a(_0x3043c1['selectedDate']); } } } else { if (_0x4c0285(0x494) !== _0x4c0285(0x494)) _0x237f18(![]), _0x19e322[_0x4c0285(0x27b)](_0x4c0285(0x45a), _0x5c2855), _0x505651('上传失败了，笨蛋！\x20' + _0x5659ff[_0x4c0285(0x722)]); else { const _0x8d0667 = document[_0x4c0285(0xb35)]('div'); _0x8d0667[_0x4c0285(0x51c)][_0x4c0285(0x6dd)]('message', _0x30ef57); if (_0x2af2e8?.[_0x4c0285(0x318)] === 'private') { if (_0x4c0285(0x455) !== 'ZULFb') { const _0x1f7227 = _0x2af2e8[_0x4c0285(0x6a3)][0x0]; _0x8d0667['classList'][_0x4c0285(0x6dd)](_0x4c0285(0x1b7) + _0x1f7227); } else return _0x148a3e['log'](_0x4c0285(0x619)), 0x0; } if (_0x22a492[_0x4c0285(0x9bd)]) { if (_0x4c0285(0x791) !== _0x4c0285(0x791)) _0x1288a3[_0x4c0285(0x27b)]('群聊音乐搜索失败\x20(' + _0xeba0f6 + '\x20-\x20' + _0xaaf80f + '):', _0x1d8149), _0x196f68['coverUrl'] = null, _0x2fe293[_0x4c0285(0x788)] = null; else { const _0x5a0525 = document[_0x4c0285(0xb35)]('div'); _0x5a0525[_0x4c0285(0xaff)] = _0x4c0285(0x4a3); const _0x2a6ab0 = document['createElement'](_0x4c0285(0x4e8)); _0x2a6ab0[_0x4c0285(0xaff)] = _0x4c0285(0xbbd), _0x2a6ab0['textContent'] = _0x22a492['quotedMessage'][_0x4c0285(0xa6e)]; const _0x16c0a8 = document[_0x4c0285(0xb35)](_0x4c0285(0x4e8)); _0x16c0a8[_0x4c0285(0xaff)] = _0x4c0285(0x646), _0x16c0a8[_0x4c0285(0x1cd)] = _0x22a492[_0x4c0285(0x9bd)]['content'], _0x5a0525[_0x4c0285(0x3bf)](_0x2a6ab0), _0x5a0525['appendChild'](_0x16c0a8), _0x8d0667[_0x4c0285(0x3bf)](_0x5a0525); } } if (_0x582108) { if (_0x4c0285(0x75e) === _0x4c0285(0x311)) _0x7ff008['oncomplete'] = _0x3fb87f, _0x5345c1[_0x4c0285(0x611)] = _0x5c7d2c => _0x57bae7(_0x5c7d2c[_0x4c0285(0x48e)][_0x4c0285(0x27b)]); else { _0x8d0667[_0x4c0285(0x51c)]['add'](_0x4c0285(0x880)); const _0x53ac31 = document[_0x4c0285(0xb35)]('img'); _0x53ac31[_0x4c0285(0xa9c)] = _0x582108, _0x53ac31[_0x4c0285(0x51c)]['add']('sticker-content'), _0x8d0667[_0x4c0285(0x3bf)](_0x53ac31); } } else { if (_0x22a492['image'] || _0x22a492['imageId']) { _0x8d0667[_0x4c0285(0x51c)][_0x4c0285(0x6dd)](_0x4c0285(0x6a9)); const _0x4e7882 = document[_0x4c0285(0xb35)](_0x4c0285(0x365)); _0x4e7882[_0x4c0285(0x51c)][_0x4c0285(0x6dd)]('message-image-content'), _0x8d0667[_0x4c0285(0x3bf)](_0x4e7882); if (_0x22a492[_0x4c0285(0x6a9)]) 'yazxi' !== _0x4c0285(0x1d5) ? _0x4e7882[_0x4c0285(0xa9c)] = _0x22a492[_0x4c0285(0x6a9)] : _0x434660[_0x4c0285(0x8d9)](_0xe75a7f); else { if (_0x4c0285(0x2f7) === _0x4c0285(0x2f7)) _0x4e7882[_0x4c0285(0xa9c)] = _0x4c0285(0x227), _0x26239c(_0x22a492[_0x4c0285(0x472)])['then'](_0x3c9747 => { const _0x562c59 = _0x4c0285; if (_0x3c9747) { if (_0x562c59(0x3bb) === 'CZETD') { const _0x23e670 = URL[_0x562c59(0x64d)](_0x3c9747); _0x4e7882[_0x562c59(0xa9c)] = _0x23e670, _0x4e7882['onload'] = () => { const _0x11c1f2 = _0x562c59; URL[_0x11c1f2(0x83c)](_0x23e670); }; } else _0x4a4a4b += _0x562c59(0x91e); } else _0x4e7882['alt'] = '图片加载失败'; })[_0x4c0285(0xa2a)](_0x55eddb => { const _0x3682ee = _0x4c0285; console[_0x3682ee(0x27b)]('无法从\x20IndexedDB\x20加载聊天图片:', _0x55eddb), _0x4e7882['alt'] = '图片加载失败'; }); else { const _0x364150 = { 'id': _0x4c0285(0x60e) + _0xe3e283[_0x4c0285(0x83b)](), ..._0x4681a }; _0x404bf[_0x4c0285(0x613)][_0x4c0285(0x8d9)](_0x364150), !_0x220acc[_0x4c0285(0xabe)] && (_0x3027ae[_0x4c0285(0xabe)] = _0x364150['id']); } } if (_0x178d51) { if ('YVOJk' === _0x4c0285(0x58a)) { const _0x48302d = document['createElement']('p'); _0x48302d[_0x4c0285(0x3e0)][_0x4c0285(0x290)] = _0x4c0285(0x83e), _0x48302d[_0x4c0285(0x1cd)] = _0x178d51, _0x8d0667[_0x4c0285(0x3bf)](_0x48302d); } else _0x27673e(![]); } } else { if (_0x22a492[_0x4c0285(0x318)] === _0x4c0285(0x56e)) { _0x8d0667['classList'][_0x4c0285(0x6dd)](_0x4c0285(0x56e)); const _0x17d24c = _0x22a492[_0x4c0285(0x9e8)] === _0x4c0285(0x7da) ? _0x41382f(_0x2de116[_0x4c0285(0xb7c)]) : _0x11feaf(_0x22a492[_0x4c0285(0x4b1)]), _0x3ee328 = _0x22a492['recipientId'] === _0x41382f(_0x2de116[_0x4c0285(0xb7c)])['id'] ? _0x41382f(_0x2de116[_0x4c0285(0xb7c)]) : _0x11feaf(_0x22a492[_0x4c0285(0x637)]), _0x265803 = _0x17d24c?.[_0x4c0285(0x499)] ? _0x17d24c[_0x4c0285(0x499)] + _0x4c0285(0x9e6) : '转账', _0x34ccac = _0x3ee328?.['name'] ? _0x4c0285(0x8f0) + _0x3ee328[_0x4c0285(0x499)] : '转账', _0x3c2897 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-title\x22>💰\x20' + _0x265803 + _0x4c0285(0x590) + _0x22a492[_0x4c0285(0x22e)]['toFixed'](0x2) + _0x4c0285(0x767) + _0x34ccac + _0x4c0285(0x746); _0x8d0667[_0x4c0285(0x82c)] = _0x3c2897; } else { if (_0x22a492[_0x4c0285(0x318)] === 'listen-together-invite') { _0x8d0667[_0x4c0285(0x51c)][_0x4c0285(0x6dd)](_0x4c0285(0x8be)); const _0x230d04 = document[_0x4c0285(0xb35)](_0x4c0285(0x4e8)); _0x230d04[_0x4c0285(0xaff)] = _0x4c0285(0x5e4), _0x230d04[_0x4c0285(0x51c)]['add'](_0x4c0285(0x969)); const _0x229ad9 = _0x22a492['role'] === 'user' ? _0x41382f(_0x2de116['activeChatId'])['name'] || '你' : _0x11feaf(_0x22a492[_0x4c0285(0x4b1)])?.['name'] || 'TA', _0x35ba18 = _0x4c0285(0x8aa) + _0x22a492['timestamp'], _0x3c0ef2 = _0x4c0285(0x477) + _0x35ba18 + _0x4c0285(0x6a5) + _0x322703 + '\x22>'; _0x22a492[_0x4c0285(0x1e0)] && _0x26239c(_0x22a492['coverId'])['then'](_0x26f0d9 => { const _0x410518 = _0x4c0285, _0x4768b7 = document[_0x410518(0x8f3)](_0x35ba18); if (_0x4768b7 && _0x26f0d9) _0x4768b7[_0x410518(0xa9c)] = URL[_0x410518(0x64d)](_0x26f0d9); }), _0x22a492[_0x4c0285(0x7ec)] ? _0x230d04[_0x4c0285(0x82c)] = _0x4c0285(0x1d4) + _0x3c0ef2 + _0x4c0285(0x845) + _0x22a492['songName'] + _0x4c0285(0x36c) + _0x22a492[_0x4c0285(0x942)] + _0x4c0285(0x47d) : _0x4c0285(0x54c) === _0x4c0285(0x54c) ? _0x230d04[_0x4c0285(0x82c)] = _0x4c0285(0x1cc) + _0x229ad9 + _0x4c0285(0xa25) + _0x3c0ef2 + _0x4c0285(0x845) + _0x22a492['songName'] + _0x4c0285(0x36c) + _0x22a492[_0x4c0285(0x942)] + _0x4c0285(0x3a0) + _0x22a492['songId'] + _0x4c0285(0x1ea) : (_0x29dd01[_0x4c0285(0x754)](_0x4c0285(0xb86)), _0x4568f2[_0x4c0285(0x775)](_0x4c0285(0x8e7), { 'keyPath': 'id' })), _0x8d0667['appendChild'](_0x230d04); } else { if (_0x22a492[_0x4c0285(0x318)] === _0x4c0285(0x8be) && _0x22a492[_0x4c0285(0x5e6)]) { _0x8d0667[_0x4c0285(0x51c)][_0x4c0285(0x6dd)](_0x4c0285(0x8be)); const _0x2c3fe5 = document[_0x4c0285(0xb35)]('div'); _0x2c3fe5[_0x4c0285(0xaff)] = _0x4c0285(0xbab), _0x2c3fe5[_0x4c0285(0xb40)]['musicId'] = 'msg_' + _0x22a492[_0x4c0285(0xa71)]; const _0x191c10 = 'cover_placeholder_' + _0x22a492[_0x4c0285(0xa71)], _0x46149c = _0x4c0285(0x4b4) + _0x322703 + _0x4c0285(0x81a) + _0x191c10 + _0x4c0285(0x644); if (_0x22a492['coverId']) _0x26239c(_0x22a492[_0x4c0285(0x1e0)])[_0x4c0285(0xad3)](_0x42809c => { const _0x538135 = _0x4c0285, _0x9e4168 = document[_0x538135(0x8f3)](_0x191c10); if (_0x9e4168 && _0x42809c) _0x9e4168[_0x538135(0xa9c)] = URL[_0x538135(0x64d)](_0x42809c); }); else _0x22a492['coverUrl'] && (_0x4c0285(0xa23) !== _0x4c0285(0x1c1) ? setTimeout(() => { const _0x2023ab = _0x4c0285, _0x2459c8 = document[_0x2023ab(0x8f3)](_0x191c10); if (_0x2459c8) _0x2459c8['src'] = _0x22a492[_0x2023ab(0x9fd)]; }, 0x0) : (_0x3f985c[_0x4c0285(0x9d6)][_0x4c0285(0x9c9)] = _0xd2ee2a['checked'], _0xa896f0(), _0x25c907())); _0x2c3fe5['innerHTML'] = _0x4c0285(0x444) + _0x46149c + _0x4c0285(0xaad) + _0x22a492['songName'] + _0x4c0285(0x4dd) + _0x22a492[_0x4c0285(0x942)] + _0x4c0285(0x6f6) + (_0x22a492['playableUrl'] ? '▶' : '⚠') + _0x4c0285(0x806), _0x22a492[_0x4c0285(0x788)] && _0x2c3fe5['addEventListener']('click', function () { const _0x17f8e0 = _0x4c0285, _0x13db0d = { 'id': _0x17f8e0(0x541) + _0x22a492[_0x17f8e0(0xa71)], 'url': _0x22a492['playableUrl'] }; _0x33cb9b(this, _0x13db0d); }), _0x8d0667[_0x4c0285(0x3bf)](_0x2c3fe5); } else { if (_0x4c0285(0x846) !== _0x4c0285(0x846)) _0x4d8670['style'][_0x4c0285(0xab9)] = _0x4c0285(0x1bf), _0x3927f8[_0x4c0285(0x3e0)][_0x4c0285(0x249)] = '2px\x20dashed\x20var(--border-color)', _0x46c2d6[_0x4c0285(0x3e0)]['background'] = _0x4c0285(0xad4); else { if (_0x178d51) { const _0x1664ea = document[_0x4c0285(0xb35)]('p'); _0x1664ea[_0x4c0285(0x82c)] = _0x178d51, _0x1664ea[_0x4c0285(0x3e0)][_0x4c0285(0x636)] = '0', _0x8d0667[_0x4c0285(0x3bf)](_0x1664ea); } } } } } } } if (_0x30ef57 === _0x4c0285(0x7da)) { if ('WeawH' !== _0x4c0285(0x2b5)) _0x30eefb[_0x4c0285(0x3bf)](_0x8d0667), _0x30eefb[_0x4c0285(0x3bf)](_0x1cfd6b); else { if (!_0x42412d[_0x4c0285(0xa05)] || _0x4a1229[_0x4c0285(0xa05)]['length'] === 0x0) { _0x5c5706[_0x4c0285(0x27b)]('错误：你还没有创建任何好友圈。请先在App内创建一个。'); return; } const _0x10c0cf = _0x5120b5[_0x4c0285(0xa05)][0x0]; if (_0x10c0cf['memberCharacterIds'][_0x4c0285(0xaa7)] < 0x2) { _0x510d85[_0x4c0285(0x27b)]('错误：第一个好友圈\x20\x22' + _0x10c0cf[_0x4c0285(0x499)] + '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。'); return; } const _0xc06fef = { 'id': _0x4c0285(0x8d5) + _0x241f9e['now'](), 'authorType': _0x4c0285(0x2af), 'authorId': _0x10c0cf[_0x4c0285(0x595)][0x0], 'content': _0x4c0285(0xa19), 'timestamp': _0x81d2ea[_0x4c0285(0x83b)](), 'likes': [_0x10c0cf[_0x4c0285(0x595)][0x1]], 'comments': [{ 'commentId': 'c_' + _0x5cf948[_0x4c0285(0x83b)](), 'authorId': _0x10c0cf[_0x4c0285(0x595)][0x1], 'content': _0x4c0285(0x4df) }] }; _0x10c0cf[_0x4c0285(0x415)]['push'](_0xc06fef), _0x327304(), _0x37e50a[_0x4c0285(0x754)](_0x4c0285(0x302) + _0x10c0cf[_0x4c0285(0x499)] + _0x4c0285(0x3ff)), _0x465267('测试动态已添加！'); } } else _0x30eefb['appendChild'](_0x1cfd6b), _0x30eefb[_0x4c0285(0x3bf)](_0x8d0667); } } _0x3f2a24[_0x4c0285(0x3bf)](_0x30eefb); const _0x168d9c = document[_0x4c0285(0xb35)](_0x4c0285(0x4e8)); return _0x168d9c[_0x4c0285(0xaff)] = _0x4c0285(0xa71), _0x168d9c[_0x4c0285(0x1cd)] = _0x5fb6a6(_0x22a492[_0x4c0285(0xa71)]), _0x3f2a24[_0x4c0285(0x3bf)](_0x168d9c), _0x2615a1[_0x4c0285(0x3bf)](_0x3f2a24), _0x3f2a24; } else _0xdb1ad1[_0x4c0285(0x350)] = _0x444d93[_0x4c0285(0x350)] || [], _0x30da8a[_0x4c0285(0x8ce)] = (_0x1ddfc6[_0x4c0285(0x8ce)] || [])['map']((_0x36b20e, _0x715f57) => ({ ..._0x36b20e, 'commentId': 'c_' + _0x351d61['timestamp'] + '_' + _0x715f57 })), _0x901cd6(), _0x49e579(); } document[_0x234a7d(0x8f3)](_0x234a7d(0xb76))[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x2cd269); let _0xa3f5a6 = null, _0x7a753 = null; function _0x2cd269(_0x54f8ca) { const _0x185a46 = _0x234a7d; if (_0x185a46(0x37c) === _0x185a46(0x285)) _0x3e3fe3(_0x20b757['id']); else { if (window[_0x185a46(0x543)]()['toString']()) return; const _0x2e04f8 = _0x54f8ca[_0x185a46(0x48e)][_0x185a46(0x911)]('.message-container'), _0xd52df8 = _0x54f8ca[_0x185a46(0x48e)]['closest'](_0x185a46(0xaaa)); if (!_0x2e04f8 || _0xd52df8) return; const _0x2ff540 = parseInt(_0x2e04f8[_0x185a46(0xb40)][_0x185a46(0x8a7)], 0xa); if (isNaN(_0x2ff540)) return; _0x20d68c(_0x2ff540); } } function _0x4214ca() { const _0x5026c9 = _0x234a7d, _0x3e0c39 = _0x231de4(); if (!_0x3e0c39) { _0x5f50d0[_0x5026c9(0x1cd)] = _0x5026c9(0x6e1); return; } if (_0x3e0c39[_0x5026c9(0x318)] === _0x5026c9(0x2c0)) { const _0x593633 = _0x11feaf(_0x3e0c39['participantIds'][0x0]); _0x5f50d0[_0x5026c9(0x1cd)] = _0x593633 ? _0x593633['name'] : _0x5026c9(0x67e); } else _0x5026c9(0x898) === _0x5026c9(0xb1b) ? _0x281b30 = _0x40121f[_0x5026c9(0x57f)](_0x25cde6) : _0x5f50d0['textContent'] = _0x3e0c39[_0x5026c9(0x499)] || _0x5026c9(0x76d) + _0x3e0c39[_0x5026c9(0x6a3)][_0x5026c9(0xaa7)] + ')'; } function _0x4abf53(_0xcd4788) { const _0x293b44 = _0x234a7d, _0x23a99c = document[_0x293b44(0xac8)](_0x293b44(0x20d)); if (_0x23a99c && (_0x23a99c['id'] === 'meeting-view-screen' || _0x23a99c['id'] === 'chat-screen')) _0x47d862(); else { const _0x425aa9 = document[_0x293b44(0x672)](_0x293b44(0x829)); _0x425aa9['forEach'](_0x32ebf2 => _0x32ebf2['remove']()); } } function _0x593596() { const _0x47f15f = _0x234a7d; _0x2de116[_0x47f15f(0x3b8)] && _0x2de116[_0x47f15f(0xa92)] && (console[_0x47f15f(0x754)](_0x47f15f(0x2b6)), _0x2de116[_0x47f15f(0xa92)][_0x47f15f(0x3f7)](_0x47f15f(0x731)), _0x2de116[_0x47f15f(0xa92)] = null), _0x2de116[_0x47f15f(0x3b8)] = ![], _0x4abf53(![]); } function _0x231de4() { const _0x2c7e08 = _0x234a7d; if ('TGSew' === _0x2c7e08(0x2f6)) _0x566adf(() => { const _0x3a39b0 = _0x2c7e08, _0x19e2bf = _0x25d08a[_0x3a39b0(0x8f3)](_0x2e0057); if (_0x19e2bf) _0x19e2bf['src'] = _0x1f9b3b['coverUrl']; }, 0x0); else return _0x2de116[_0x2c7e08(0x6b7)][_0x2c7e08(0xa68)](_0x5ad3df => _0x5ad3df['id'] === _0x2de116['activeChatId']); } function _0x11feaf(_0x1ad80c) { const _0x316c64 = _0x234a7d; if ('OTJLI' === _0x316c64(0x21a)) return _0x2de116[_0x316c64(0x393)][_0x316c64(0xa68)](_0x311ad5 => _0x311ad5['id'] === _0x1ad80c); else { _0x5a51ed[_0x316c64(0x754)](_0x316c64(0x962)); return; } } function _0x4933f6(_0x682f65) { const _0x2bd1bd = _0x234a7d; if (_0x2bd1bd(0x56a) !== 'gBfJh') { const _0x1c17ec = [_0x2bd1bd(0x2c8), _0x2bd1bd(0x67a), _0x2bd1bd(0x324), _0x2bd1bd(0x9be), '星期四', _0x2bd1bd(0x430), _0x2bd1bd(0x9b7)]; return _0x1c17ec[_0x4d04e6[_0x2bd1bd(0x7f3)]()] + '\x20' + _0x19d5a4; } else { _0x2de116[_0x2bd1bd(0x393)] = _0x2de116[_0x2bd1bd(0x393)]['filter'](_0x21a878 => _0x21a878['id'] !== _0x682f65), _0x2de116['chats'][_0x2bd1bd(0x201)](_0x528f93 => { const _0x37d309 = _0x2bd1bd; _0x37d309(0x86e) === _0x37d309(0x947) ? (_0x3bcc03[_0x37d309(0x51c)][_0x37d309(0x6dd)]('active'), _0x3b718d['scrollIntoView']({ 'behavior': 'smooth', 'block': _0x37d309(0x261) })) : _0x528f93[_0x37d309(0x318)] === _0x37d309(0x366) && (_0x528f93[_0x37d309(0x6a3)] = _0x528f93[_0x37d309(0x6a3)]['filter'](_0xb72086 => _0xb72086 !== _0x682f65)); }); const _0x4a4bcc = _0x2de116[_0x2bd1bd(0x6b7)][_0x2bd1bd(0xa68)](_0x252071 => _0x252071[_0x2bd1bd(0x318)] === 'private' && _0x252071['participantIds']['includes'](_0x682f65)); _0x4a4bcc && _0xac6adb(_0x4a4bcc['id']), _0x2de116['chats'] = _0x2de116[_0x2bd1bd(0x6b7)]['filter'](_0x2bfb70 => _0x2bfb70[_0x2bd1bd(0x318)] !== _0x2bd1bd(0x366) || _0x2bfb70[_0x2bd1bd(0x6a3)][_0x2bd1bd(0xaa7)] > 0x1), _0x2ca195(), _0x25e174(); } } function _0xac6adb(_0x1d9b37) { const _0x4b34d0 = _0x234a7d; _0x2de116['chats'] = _0x2de116[_0x4b34d0(0x6b7)]['filter'](_0x469a7a => _0x469a7a['id'] !== _0x1d9b37); try { if ('kKTBX' === _0x4b34d0(0x61e)) localStorage[_0x4b34d0(0x758)](_0x4b34d0(0xb7a) + _0x1d9b37); else { _0x372761(_0x4b34d0(0x3ac)); return; } } catch (_0xaed0dd) { _0x4b34d0(0x9b0) === _0x4b34d0(0x958) ? _0x5e8932[_0x4b34d0(0x4f8)] = ![] : console[_0x4b34d0(0x27b)](_0x4b34d0(0xb06) + _0x1d9b37, _0xaed0dd); } _0x2de116[_0x4b34d0(0xb7c)] === _0x1d9b37 && (_0x2de116['activeChatId'] = _0x2de116[_0x4b34d0(0x6b7)][0x0]?.['id'] || null, _0x1816aa(_0x2de116[_0x4b34d0(0xb7c)])), _0x2ca195(), _0x25e174(); } async function _0x1816aa(_0x2efc82) { const _0x2a841e = _0x234a7d; _0x2de116[_0x2a841e(0xb7c)] !== _0x2efc82 && (_0x593596(), _0x2de116[_0x2a841e(0xb0b)] = 0x64); if (!_0x2efc82) { if ('peOkV' !== 'peOkV') return _0x2a0701(_0x48286d)[_0x2a841e(0xad3)](_0x375692 => _0x375692[_0x2a841e(0x1d6)]()); else { _0x2de116[_0x2a841e(0xb7c)] = null, _0x2ca195(), _0xe7cd49(![]), document[_0x2a841e(0x8f3)]('chat-view-pane')[_0x2a841e(0x3e0)][_0x2a841e(0xaa3)] = ''; return; } } _0x2de116['activeChatId'] = _0x2efc82, _0x2ca195(), _0x4214ca(), _0x2615a1['innerHTML'] = '', _0xc9067c(!![], _0x2a841e(0x4a8)), setTimeout(async () => { const _0x4ca5ea = _0x2a841e; try { if ('tXTcP' === 'bEPxb') _0x3f6678[_0x4ca5ea(0x814)][_0x4ca5ea(0x5eb)](_0x464ed4[_0x4ca5ea(0x814)][_0x4ca5ea(0xbbb)]() - 0x1), _0x143296(); else { _0x576acc(); const _0x1397ec = _0x231de4(), _0x52a2df = document[_0x4ca5ea(0x8f3)](_0x4ca5ea(0x79a)); let _0x252b73 = null; if (_0x1397ec) { if (_0x4ca5ea(0x9da) !== 'yAeCD') { const _0x4c30cf = _0x1c352c['transaction'](_0x46282e, _0x4ca5ea(0xae4)), _0x1ef9bb = _0x4c30cf[_0x4ca5ea(0x387)](_0x17e07b), _0x42a1cc = _0x1ef9bb[_0x4ca5ea(0xb30)]({ 'id': _0x6fcdbe, 'data': _0x2f0f5d }); _0x42a1cc['onsuccess'] = () => _0x528f2e(), _0x42a1cc[_0x4ca5ea(0x611)] = () => _0x581e1e(_0x42a1cc[_0x4ca5ea(0x27b)]); } else { if (_0x1397ec[_0x4ca5ea(0x318)] === 'private') { if (_0x4ca5ea(0xb49) === 'AIzCR') { const _0x5784ac = _0x1397ec[_0x4ca5ea(0x6a3)][0x0]; _0x3e1632(_0x5784ac), _0x252b73 = await _0x26239c(_0x4ca5ea(0x325) + _0x5784ac); } else { if (!_0x4f482e[_0x4ca5ea(0x75c)](_0x5a5f07)) return '<p>格式错误</p>'; if (_0x416a30['length'] === 0x0) return _0x4ca5ea(0x32b); return _0x46d459[_0x4ca5ea(0xb71)]((_0x23b228, _0x34cd41) => new _0x2d9f2f(_0x34cd41['timestamp']) - new _0x343e21(_0x23b228[_0x4ca5ea(0xa71)])), _0x5d0a8b[_0x4ca5ea(0x7c6)](_0x599620 => _0x4ca5ea(0x888) + (_0x599620['store_name'] || _0x4ca5ea(0x956)) + _0x4ca5ea(0x5b1) + (_0x599620['timestamp'] || '') + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22width:\x2070px;\x20height:\x2070px;\x20background-color:\x20#f0f2f5;\x20border-radius:\x208px;\x20font-size:\x202.5rem;\x20flex-shrink:\x200;\x22>🛍️</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22flex-grow:\x201;\x20display:\x20flex;\x20flex-direction:\x20column;\x20justify-content:\x20space-between;\x20height:\x2070px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20500;\x20line-height:\x201.4;\x20-webkit-line-clamp:\x202;\x20display:\x20-webkit-box;\x20-webkit-box-orient:\x20vertical;\x20overflow:\x20hidden;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x599620['item_name'] || _0x4ca5ea(0x9ea)) + _0x4ca5ea(0xaf6) + (_0x599620[_0x4ca5ea(0xa91)] || 0x0)[_0x4ca5ea(0xaeb)](0x2) + _0x4ca5ea(0xad8))[_0x4ca5ea(0x6cf)](''); } } else _0x252b73 = await _0x26239c(_0x4ca5ea(0x20c) + _0x1397ec['id']); _0x252b73 ? (_0x52a2df[_0x4ca5ea(0x3e0)][_0x4ca5ea(0xaa3)] = _0x4ca5ea(0x4c6) + URL[_0x4ca5ea(0x64d)](_0x252b73) + '\x27)', _0x52a2df[_0x4ca5ea(0x3e0)][_0x4ca5ea(0x76c)] = _0x4ca5ea(0x43e), _0x52a2df[_0x4ca5ea(0x3e0)]['backgroundPosition'] = _0x4ca5ea(0x261)) : _0x52a2df['style'][_0x4ca5ea(0xaa3)] = ''; } } _0x100f70(); } } catch (_0x4b60b5) { if (_0x4ca5ea(0xb07) !== _0x4ca5ea(0x32d)) console[_0x4ca5ea(0x27b)](_0x4ca5ea(0x22a), _0x4b60b5), _0x15e83d(_0x4ca5ea(0x98a) + _0x4b60b5['message']); else { _0x273f5d[_0x4ca5ea(0x1ba)][_0x4ca5ea(0x59b)] = _0x103382[_0x4ca5ea(0xa35)][_0x4ca5ea(0x44c)](), _0x5d858b[_0x4ca5ea(0x1ba)][_0x4ca5ea(0x64a)] = _0x50c88b[_0x4ca5ea(0xa35)][_0x4ca5ea(0x44c)](), _0x22e11f['apiSettings'][_0x4ca5ea(0x4b6)] = _0x189901[_0x4ca5ea(0xa35)][_0x4ca5ea(0x44c)](), _0x23028c[_0x4ca5ea(0x1ba)][_0x4ca5ea(0xa59)] = _0x27f953[_0x4ca5ea(0x8f3)](_0x4ca5ea(0x501))[_0x4ca5ea(0xa35)]; const _0x303978 = _0x21c5b8(_0x2dcaac[_0x4ca5ea(0xa35)], 0xa); _0x2bcc12[_0x4ca5ea(0x9d6)]['perChatContextLines'] = _0x3e629a[_0x4ca5ea(0x27a)](_0x303978) && _0x303978 > 0x0 ? _0x303978 : 0x64, _0x4d65bb(), _0x2ce4fb('设置已保存！'); } } finally { _0xc9067c(![]); } }, 0x32); } async function _0x56a14d() { const _0x58d5d3 = _0x234a7d; if (_0x58d5d3(0x2d2) === _0x58d5d3(0x2d2)) { if (_0x2de116[_0x58d5d3(0x3b8)]) { if ('jDINo' !== _0x58d5d3(0x5de)) _0xb4e06c(), _0x30f6ff['conversationHistory'] = [], _0x20720f(); else { _0x15e83d(_0x58d5d3(0x99d)); return; } } const _0x3f7f29 = _0x2de116['conversationHistory']; if (_0x3f7f29[_0x58d5d3(0xaa7)] === 0x0) return; let _0x8e19fc = -0x1; for (let _0x11d171 = _0x3f7f29[_0x58d5d3(0xaa7)] - 0x1; _0x11d171 >= 0x0; _0x11d171--) { if (_0x3f7f29[_0x11d171][_0x58d5d3(0x9e8)] === _0x58d5d3(0x7da)) { _0x8e19fc = _0x11d171; break; } } if (_0x8e19fc === -0x1 || _0x8e19fc === _0x3f7f29[_0x58d5d3(0xaa7)] - 0x1) { if ('UUCMk' === _0x58d5d3(0x8c9)) return '刚才'; else { _0x15e83d(_0x58d5d3(0x5f3)); return; } } _0x3f7f29['splice'](_0x8e19fc + 0x1), _0x2de116[_0x58d5d3(0x8f7)] = [], _0x5ca5a8(), _0x328af8(), _0x27e93b(_0x2de116[_0x58d5d3(0x2df)]), setTimeout(() => { _0x525b8d(); }, 0x64); } else { const _0xa18ec7 = _0xef2af4['parse'](_0x111f2f); _0x53772c[_0x58d5d3(0x75c)](_0xa18ec7) && (_0xdebd0 = _0xa18ec7['filter'](_0x900786 => _0x900786 && typeof _0x900786 === _0x58d5d3(0x4e4) && typeof _0x900786[_0x58d5d3(0x9e8)] === _0x58d5d3(0xa98) && typeof _0x900786[_0x58d5d3(0x5e2)] !== _0x58d5d3(0x358))); } } async function _0x856a0() { const _0xe39dd8 = _0x234a7d; if (_0x2de116[_0xe39dd8(0x3b8)]) { if ('fPVmF' !== _0xe39dd8(0x62d)) { _0x15e83d('正在生成中，请稍候...'); return; } else _0x172f09(_0xe39dd8(0x558) + _0x19fe6c[_0xe39dd8(0x499)] + _0xe39dd8(0x8a1) + _0x35f280['eventContent']); } const _0x1bc900 = _0x2de116[_0xe39dd8(0x59f)]; if (_0x1bc900[_0xe39dd8(0xaa7)] === 0x0) return; let _0x5de14c = -0x1; for (let _0xf8870d = _0x1bc900[_0xe39dd8(0xaa7)] - 0x1; _0xf8870d >= 0x0; _0xf8870d--) { if (_0x1bc900[_0xf8870d][_0xe39dd8(0x9e8)] === 'user') { if (_0xe39dd8(0x8b3) === _0xe39dd8(0x8b3)) { _0x5de14c = _0xf8870d; break; } else _0x42f446[_0xe39dd8(0x71c)][_0xe39dd8(0x707)](_0x579302, 0x1), _0x2be1d0(), _0x567391(), _0x519307('日记已删除。'); } } if (_0x5de14c === -0x1 || _0x5de14c === _0x1bc900[_0xe39dd8(0xaa7)] - 0x1) { if (_0xe39dd8(0x6a7) !== _0xe39dd8(0x887)) { _0x15e83d('还没有我的回复可以重新生成哦。'); return; } else { _0xa0e843(); const _0x262899 = _0x4645b0[_0xe39dd8(0xa05)][_0xe39dd8(0xa68)](_0x7388ba => _0x7388ba['id'] === _0x33197f); if (!_0x262899) return; _0x5178a1['activeFriendCircleId'] = _0x2ffd28, _0x370caf(), _0x1dc733[_0xe39dd8(0x8f3)](_0xe39dd8(0x6ba))[_0xe39dd8(0x1cd)] = _0x262899[_0xe39dd8(0x499)], _0x36e890(), _0xe53ff9(_0xe39dd8(0x8be), _0xe39dd8(0x640)), _0x2bda67(); } } _0x1bc900[_0xe39dd8(0x707)](_0x5de14c + 0x1), _0x5ca5a8(), _0x47d862(), setTimeout(() => { _0x525b8d(); }, 0x64); } function _0x202e51(_0x489b9b = null) { const _0x13fb42 = _0x234a7d, _0x326b9d = _0x489b9b ?? _0x300b76['value']['trim'](); if (_0x326b9d === '' || !_0x2de116[_0x13fb42(0xb7c)]) return; const _0xa3bdac = document['querySelector'](_0x13fb42(0x20d)), _0x42efd0 = _0xa3bdac['id'] === _0x13fb42(0x5d0), _0x182568 = { 'role': _0x13fb42(0x7da), 'content': _0x326b9d, 'timestamp': Date[_0x13fb42(0x83b)](), 'isOffline': _0x42efd0 }; _0x2de116['activeQuote'] && (_0x13fb42(0x511) === _0x13fb42(0x511) ? _0x182568['quotedMessage'] = { ..._0x2de116['activeQuote'] } : (_0x1a58b1['participantIds'][_0x13fb42(0x201)](_0x165469 => { const _0x25225d = _0x13fb42, _0x561e78 = _0xac4196(_0x165469); if (_0x561e78) { const _0x43d344 = _0x3a9c5c[_0x25225d(0xb35)]('option'); _0x43d344[_0x25225d(0xa35)] = _0x561e78['id'], _0x43d344['textContent'] = _0x561e78[_0x25225d(0x499)], _0x36043c[_0x25225d(0x3bf)](_0x43d344); } }), _0xe2bcd['style'][_0x13fb42(0xab9)] = 'block')), _0x2de116[_0x13fb42(0x59f)][_0x13fb42(0x8d9)](_0x182568), _0x5ca5a8(), _0x47d862(), !_0x489b9b && (_0x300b76[_0x13fb42(0xa35)] = ''), _0x58b384(); } function _0x13123a(_0x5e3a6f) { const _0x2e58d3 = _0x234a7d; if (_0x2e58d3(0x2bd) === _0x2e58d3(0x889)) _0x347cd9[_0x2e58d3(0x8d9)](_0x15b555); else { if (!_0x5e3a6f || !_0x2de116[_0x2e58d3(0xb7c)]) return; const _0x5e96c0 = { 'role': _0x2e58d3(0x7da), 'content': '[用户发送了表情：' + _0x5e3a6f[_0x2e58d3(0x499)] + ']', 'displayUrl': _0x5e3a6f[_0x2e58d3(0xb77)], 'timestamp': Date[_0x2e58d3(0x83b)]() }; _0x2de116[_0x2e58d3(0x59f)][_0x2e58d3(0x8d9)](_0x5e96c0), _0x3fc7e7(_0x5e96c0, _0x2de116[_0x2e58d3(0x59f)][_0x2e58d3(0xaa7)] - 0x1), _0x5ca5a8(), _0xeffd8['classList'][_0x2e58d3(0x2e4)](_0x2e58d3(0x530)); } } async function _0x3bd428(_0xebdec2) { const _0x399fd8 = _0x234a7d; if ('BCtNi' !== _0x399fd8(0x828)) { const _0x2ed9ee = _0xebdec2[_0x399fd8(0x48e)][_0x399fd8(0x6f1)][0x0]; if (!_0x2ed9ee || !_0x2de116[_0x399fd8(0xb7c)]) return; _0xc9067c(!![], _0x399fd8(0x9c8)); try { const _0x1e0447 = await _0x14be18(_0x2ed9ee, 0x320, 0.8, !![]), _0x564383 = 'chat_image_' + Date[_0x399fd8(0x83b)](); await _0x1d2a3c(_0x564383, _0x1e0447); const _0x415eca = _0x300b76[_0x399fd8(0xa35)]['trim'](); _0x300b76[_0x399fd8(0xa35)] = ''; const _0xd89dd3 = { 'role': _0x399fd8(0x7da), 'content': _0x415eca, 'imageId': _0x564383, 'timestamp': Date[_0x399fd8(0x83b)]() }; _0x2de116[_0x399fd8(0x59f)]['push'](_0xd89dd3), _0x3fc7e7(_0xd89dd3, _0x2de116[_0x399fd8(0x59f)][_0x399fd8(0xaa7)] - 0x1), _0x5ca5a8(); } catch (_0x3b6345) { _0x399fd8(0xab5) !== 'GwHqO' ? _0x5d4160[_0x399fd8(0x1cd)] = _0xac6973[_0x399fd8(0x499)] || '群聊\x20(' + _0x54338a[_0x399fd8(0x6a3)]['length'] + ')' : _0x15e83d('图片处理失败:\x20' + _0x3b6345[_0x399fd8(0x722)]); } finally { _0xc9067c(![]), _0xebdec2[_0x399fd8(0x48e)][_0x399fd8(0xa35)] = ''; } } else _0x1aa405(_0x399fd8(0xaa4)); } async function _0x193dc7() { const _0x148fd4 = _0x234a7d; if (!_0x2de116[_0x148fd4(0xb7c)]) return; const _0x4418be = await _0x29ff8f(); if (!_0x4418be) return; _0x15e83d('正在搜索音乐...'); try { if (_0x148fd4(0xa8a) === _0x148fd4(0x704)) _0x31ab0f[_0x148fd4(0x27b)]('在“一起听”邀请中，净化封面失败:', _0x4938c6); else { const _0x2c9425 = await _0x9a63ea(_0x4418be[_0x148fd4(0x5e6)], _0x4418be[_0x148fd4(0x942)]); let _0x2e2b66 = _0x2c9425[_0x148fd4(0x43e)]; if (_0x2c9425['cover'] && _0x2c9425[_0x148fd4(0x43e)][_0x148fd4(0x3df)](_0x148fd4(0x278))) try { if ('peAUj' !== _0x148fd4(0x95c)) { _0x7d130(![]), _0x596fe0(_0x148fd4(0xad1)); return; } else { const _0x245ee7 = await fetch(_0x2c9425['cover']), _0x570d25 = await _0x245ee7[_0x148fd4(0x1d6)](); _0x2e2b66 = await _0x32f36c(_0x570d25); } } catch (_0x366030) { console['error'](_0x148fd4(0x322), _0x366030), _0x2e2b66 = _0x322703; } const _0x4aa368 = { 'role': _0x148fd4(0x7da), 'type': _0x148fd4(0x8be), 'content': _0x148fd4(0x26d) + _0x4418be[_0x148fd4(0x5e6)] + _0x148fd4(0x32f) + _0x4418be[_0x148fd4(0x942)] + ']', 'songName': _0x4418be[_0x148fd4(0x5e6)], 'artist': _0x4418be[_0x148fd4(0x942)], 'coverUrl': _0x2e2b66, 'playableUrl': _0x2c9425[_0x148fd4(0xb77)], 'timestamp': Date['now']() }; _0x2de116[_0x148fd4(0x59f)][_0x148fd4(0x8d9)](_0x4aa368), _0x3fc7e7(_0x4aa368, _0x2de116['conversationHistory'][_0x148fd4(0xaa7)] - 0x1), _0x5ca5a8(); } } catch (_0x5cfe2f) { console['error']('用户分享音乐失败:', _0x5cfe2f), _0x15e83d(_0x148fd4(0x4e0) + _0x5cfe2f[_0x148fd4(0x722)]); } } function _0x16e102(_0x74c3b5, _0x17ddb7 = 0x78) { const _0x2a2ff3 = _0x234a7d; if (_0x2a2ff3(0x90b) !== _0x2a2ff3(0x262)) { const _0x5c355e = _0x38c63a => { const _0x39d3a9 = _0x2a2ff3; if (_0x39d3a9(0x78d) === _0x39d3a9(0x1d1)) _0x41ce90(_0x8b0938), _0x4a63c9(_0x39d3a9(0x96f) + _0x514b06[_0x39d3a9(0x499)] + '”已删除。'), _0x197f10(_0x39d3a9(0x780), _0x39d3a9(0x398)), _0xeef5dc(![]); else { if (_0x38c63a[_0x39d3a9(0x9e8)] === _0x39d3a9(0x7da)) return _0x2de116['userProfile']?.[_0x39d3a9(0x499)] || _0x39d3a9(0xb4d); if (_0x38c63a[_0x39d3a9(0x4b1)]) { if (_0x39d3a9(0x8bb) !== _0x39d3a9(0x361)) { const _0x102263 = _0x11feaf(_0x38c63a[_0x39d3a9(0x4b1)]); return _0x102263?.[_0x39d3a9(0x499)] || _0x39d3a9(0x681); } else _0x53c9aa[_0x39d3a9(0x8d9)]('[' + _0x2d3b27 + ']\x20[' + _0x42f153(_0x4d581a) + ']\x20' + _0x296a70(_0x523389[_0x39d3a9(0x5e2)])['trim']()); } if (_0x74c3b5?.['type'] === _0x39d3a9(0x2c0)) { const _0x53f4d6 = _0x11feaf(_0x74c3b5['participantIds'][0x0]); return _0x53f4d6?.[_0x39d3a9(0x499)] || 'AI'; } return _0x39d3a9(0xb83); } }, _0x388c31 = _0x2de116[_0x2a2ff3(0x59f)][_0x2a2ff3(0xa38)](-_0x17ddb7), _0x16be68 = []; for (const _0x21ad7d of _0x388c31) { if (_0x21ad7d[_0x2a2ff3(0x2d8)]) _0x16be68[_0x2a2ff3(0x8d9)]('[' + _0x5c355e(_0x21ad7d) + _0x2a2ff3(0x64b) + (_0x21ad7d[_0x2a2ff3(0x5e2)]?.[_0x2a2ff3(0x435)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x21ad7d['image']) { const _0x2f153d = _0x21ad7d['content'] ? '\x20' + _0x21ad7d[_0x2a2ff3(0x5e2)] : ''; _0x16be68['push']('[' + _0x5c355e(_0x21ad7d) + _0x2a2ff3(0x628) + _0x2f153d); } else _0x21ad7d[_0x2a2ff3(0x5e2)] && _0x16be68[_0x2a2ff3(0x8d9)]('[' + _0x5c355e(_0x21ad7d) + ']\x20' + _0x21ad7d[_0x2a2ff3(0x5e2)]); } } return _0x16be68[_0x2a2ff3(0x6cf)]('\x0a'); } else { const _0x59092c = _0x5d25d7['id'], _0x507ccd = _0x2a2ff3(0x323) + _0x59092c, _0x182223 = _0x246998[_0x2a2ff3(0x54d)](_0x507ccd), _0x94d6f1 = _0x1b3e5b[_0x2a2ff3(0xac8)](_0x2a2ff3(0x479)); if (_0x182223) _0x94d6f1[_0x2a2ff3(0x82c)] = _0x2a2ff3(0x4b4) + _0x182223 + _0x2a2ff3(0x274); else { const _0x2afcb6 = _0x5bbd4[_0x2a2ff3(0xac8)]('#app-dock-bottom-left\x20#' + _0x59092c + _0x2a2ff3(0x4c9) + _0x59092c + _0x2a2ff3(0x523))?.[_0x2a2ff3(0x82c)]; _0x2afcb6 && (_0x94d6f1[_0x2a2ff3(0x82c)] = _0x2afcb6); } } } function _0x560ed6(_0x241b84, _0x4dd484) { const _0x558fa0 = _0x234a7d; if (_0x558fa0(0x6fd) === 'mgeUY') { if (!_0x241b84 || !_0x4dd484) return null; const _0x1cb81e = _0x4dd484['match'](/@([^\s:：,，。!?]+)/); if (!_0x1cb81e) return null; const _0xc400e8 = _0x1cb81e[0x1][_0x558fa0(0x586)](); for (const _0x94359a of _0x241b84['participantIds']) { if (_0x558fa0(0x419) !== _0x558fa0(0x419)) _0xf650a8[_0x558fa0(0x80e)] = { 'response_mime_type': _0x558fa0(0xa5d) }; else { const _0x1c2c5a = _0x11feaf(_0x94359a); if (!_0x1c2c5a?.[_0x558fa0(0x499)]) continue; if (_0x1c2c5a[_0x558fa0(0x499)][_0x558fa0(0x586)]() === _0xc400e8) return _0x1c2c5a; if (_0x1c2c5a[_0x558fa0(0x499)]['toLowerCase']()[_0x558fa0(0x3df)](_0xc400e8)) return _0x1c2c5a; } } return null; } else { const _0x28a923 = _0x146d74[_0x558fa0(0xac8)]('.load-more-btn'); if (_0x28a923) _0x28a923['remove'](); } } function _0x2caf2a(_0x216693) { const _0x5deaf1 = _0x234a7d; if (_0x5deaf1(0x8d1) === _0x5deaf1(0x8d1)) { const _0x5ef160 = _0x216693[_0x5deaf1(0x8ca)]('{'), _0x44ecf7 = _0x216693[_0x5deaf1(0xb94)]('}'); if (_0x5ef160 >= 0x0 && _0x44ecf7 > _0x5ef160) return _0x216693[_0x5deaf1(0xa38)](_0x5ef160, _0x44ecf7 + 0x1); return _0x216693; } else { const _0x1db3bc = _0x186aa9[_0x5deaf1(0xb35)]('li'); _0x1db3bc[_0x5deaf1(0xaff)] = _0x5deaf1(0x8ec), _0x1db3bc[_0x5deaf1(0x82c)] = _0x5deaf1(0x38c) + _0x3a5194['id'] + _0x5deaf1(0x4c0) + _0x25abed['id'] + _0x5deaf1(0x60d) + (_0x4df04a[_0x5deaf1(0x41d)] || _0x289332) + _0x5deaf1(0x96c) + _0x12a198['id'] + '\x22\x20class=\x22char-name\x22>' + _0x16fb15[_0x5deaf1(0x499)] + _0x5deaf1(0x92a), _0x4a8073[_0x5deaf1(0x3bf)](_0x1db3bc); } } function _0x2a72a9(_0xd16085, _0x12a266, _0x17e6ac) { const _0x3d12f4 = _0x234a7d, _0x4d85bd = new Map(_0x12a266['map'](_0xa48b65 => [String(_0xa48b65['id']), _0xa48b65])), _0x483d48 = _0x148fc0 => String(_0x148fc0 || '')[_0x3d12f4(0x586)]()[_0x3d12f4(0x915)](/\s+/g, ''), _0x1a5902 = new Map(_0x12a266[_0x3d12f4(0x7c6)](_0x4d8064 => [_0x483d48(_0x4d8064[_0x3d12f4(0x499)]), _0x4d8064])), _0x48c4bf = new Set(_0x17e6ac), _0x57af0f = { 'events': [] }; for (const _0xf2cce4 of _0xd16085?.[_0x3d12f4(0x2e1)] || []) { const _0x282ea7 = _0xf2cce4[_0x3d12f4(0x4b1)] ?? _0xf2cce4[_0x3d12f4(0xa6e)] ?? _0xf2cce4['sender_id'] ?? _0xf2cce4[_0x3d12f4(0xbbe)] ?? _0xf2cce4[_0x3d12f4(0x9e8)] ?? _0xf2cce4[_0x3d12f4(0x499)]; if (!_0x282ea7) continue; let _0x5344fe = _0x4d85bd[_0x3d12f4(0xb5d)](String(_0x282ea7)) || _0x1a5902[_0x3d12f4(0xb5d)](_0x483d48(_0x282ea7)); if (!_0x5344fe) continue; const _0x537579 = (_0xf2cce4['kind'] || _0xf2cce4[_0x3d12f4(0x318)] || _0x3d12f4(0x5bd))[_0x3d12f4(0x586)](); if (_0x537579 === _0x3d12f4(0x880)) { const _0x482754 = (_0xf2cce4['sticker'] ?? _0xf2cce4[_0x3d12f4(0x608)] ?? _0xf2cce4[_0x3d12f4(0x25f)] ?? _0xf2cce4[_0x3d12f4(0x337)])?.['trim'](); if (_0x482754 && _0x48c4bf['has'](_0x482754)) _0x57af0f['events'][_0x3d12f4(0x8d9)]({ 'senderId': _0x5344fe['id'], 'kind': _0x3d12f4(0x880), 'sticker': _0x482754 }); else { const _0x51a05b = String(_0xf2cce4['content'] ?? _0xf2cce4[_0x3d12f4(0x5bd)] ?? '')['trim']() || _0x3d12f4(0x2b1) + (_0x482754 || '未知表情') + ']'; if (_0x51a05b) _0x57af0f[_0x3d12f4(0x2e1)]['push']({ 'senderId': _0x5344fe['id'], 'kind': _0x3d12f4(0x5bd), 'content': _0x51a05b }); } } else { const _0x2f32d2 = String(_0xf2cce4[_0x3d12f4(0x5e2)] ?? _0xf2cce4[_0x3d12f4(0x5bd)] ?? _0xf2cce4[_0x3d12f4(0x722)] ?? '')[_0x3d12f4(0x44c)](); if (_0x2f32d2) _0x57af0f['events'][_0x3d12f4(0x8d9)]({ 'senderId': _0x5344fe['id'], 'kind': _0x3d12f4(0x5bd), 'content': _0x2f32d2 }); } } return _0x57af0f; } async function _0x829521(_0x4ed94b) { const _0x3569b0 = _0x234a7d; if (_0x3569b0(0x98d) !== _0x3569b0(0x98d)) { _0x56f731[_0x3569b0(0xa35)] = ''; return; } else { if (!_0x4ed94b || !Array[_0x3569b0(0x75c)](_0x4ed94b[_0x3569b0(0x2e1)]) || _0x4ed94b['events'][_0x3569b0(0xaa7)] === 0x0) return; const _0x396189 = _0x119b5b => _0x119b5b + Math['floor'](Math[_0x3569b0(0x77b)]() * 0x190); let _0x2b9f1b = 0x1f4; for (const _0x184a97 of _0x4ed94b[_0x3569b0(0x2e1)]) { if (_0x3569b0(0xa28) === _0x3569b0(0xa28)) { await new Promise(_0x2bc800 => setTimeout(_0x2bc800, _0x396189(_0x2b9f1b))), _0x2b9f1b += 0x2bc; const _0x4892d1 = _0x2de116[_0x3569b0(0x59f)]['at'](-0x1)?.[_0x3569b0(0x484)] ?? ![]; if (_0x184a97[_0x3569b0(0x338)] === _0x3569b0(0x880)) { const _0x3df5a8 = _0x3bedf0['find'](_0x7cdbe2 => _0x7cdbe2[_0x3569b0(0x499)] === _0x184a97[_0x3569b0(0x880)]); if (_0x3df5a8) { const _0x1805ab = { 'role': _0x3569b0(0x1f4), 'content': _0x3569b0(0x425) + _0x3df5a8[_0x3569b0(0x499)] + ']', 'displayUrl': _0x3df5a8[_0x3569b0(0xb77)], 'senderId': _0x184a97[_0x3569b0(0x4b1)], 'timestamp': Date['now'](), 'isOffline': _0x4892d1 }; _0x2de116['conversationHistory'][_0x3569b0(0x8d9)](_0x1805ab); } } else { if (_0x184a97[_0x3569b0(0x338)] === 'music' && _0x184a97[_0x3569b0(0x5e6)] && _0x184a97[_0x3569b0(0x942)]) { if (_0x3569b0(0x5ad) !== 'AUGfD') { const _0x5217c2 = _0x21d1e8['createElement'](_0x3569b0(0x4e8)); _0x5217c2[_0x3569b0(0xaff)] = _0x3569b0(0x27e), _0x5217c2['id'] = _0x3569b0(0x9df) + _0x5621b5, _0x29bd96 === _0x900a82[_0x3569b0(0xaf2)] && _0x5217c2[_0x3569b0(0x51c)]['add']('is-visible'), _0x340ee5[_0x3569b0(0x201)](_0x8150c0 => { const _0xb6d508 = _0x3569b0, _0x27a789 = _0x8150c0[_0xb6d508(0x5bb)] === _0xb6d508(0x7da) ? _0xb6d508(0x7da) : 'ai', _0xb4f607 = _0x8150c0[_0xb6d508(0x5bb)] === 'user' ? _0x222b6e[_0xb6d508(0x499)] : _0xf20e42(_0x8150c0[_0xb6d508(0x5bb)])[_0xb6d508(0x499)], _0x1c58ac = _0x4d1084['createElement'](_0xb6d508(0x4e8)); _0x1c58ac[_0xb6d508(0xaff)] = 'diary-entry\x20' + _0x27a789, _0x1c58ac[_0xb6d508(0xb40)][_0xb6d508(0xa71)] = _0x8150c0[_0xb6d508(0xa71)], _0x1c58ac['style']['borderBottom'] = _0xb6d508(0x1bf), _0x1c58ac['style']['paddingBottom'] = '0', _0x1c58ac[_0xb6d508(0x82c)] = _0xb6d508(0x6e7) + _0xb4f607 + _0xb6d508(0x7c8) + new _0x2f8330(_0x8150c0['timestamp'])[_0xb6d508(0xb18)](_0xb6d508(0x2e3)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>' + _0x8150c0[_0xb6d508(0x5e2)][_0xb6d508(0x915)](/\n/g, _0xb6d508(0x8c7)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x5217c2[_0xb6d508(0x3bf)](_0x1c58ac); }), _0x4745ae[_0x3569b0(0x3bf)](_0x5217c2); } else { const { songName: _0x58248d, artist: _0x56ea00 } = _0x184a97, _0x198a2c = { 'role': _0x3569b0(0x1f4), 'type': 'music', 'content': _0x3569b0(0x220) + _0x58248d + _0x3569b0(0x32f) + _0x56ea00 + ']', 'songName': _0x58248d, 'artist': _0x56ea00, 'senderId': _0x184a97[_0x3569b0(0x4b1)], 'timestamp': Date[_0x3569b0(0x83b)](), 'isOffline': _0x4892d1 }; try { const _0x5afdb2 = await _0x9a63ea(_0x58248d, _0x56ea00); _0x198a2c[_0x3569b0(0x9fd)] = _0x5afdb2[_0x3569b0(0x43e)], _0x198a2c['playableUrl'] = _0x5afdb2['url']; } catch (_0xca5578) { console[_0x3569b0(0x27b)](_0x3569b0(0xb3d) + _0x58248d + _0x3569b0(0x32f) + _0x56ea00 + '):', _0xca5578), _0x198a2c[_0x3569b0(0x9fd)] = null, _0x198a2c[_0x3569b0(0x788)] = null; } _0x2de116['conversationHistory'][_0x3569b0(0x8d9)](_0x198a2c); } } else { if (_0x184a97[_0x3569b0(0x338)] === _0x3569b0(0x5bd)) { if (_0x3569b0(0x792) !== _0x3569b0(0x633)) { const _0x180bec = _0xb65dc1(_0x184a97[_0x3569b0(0x5e2)])['slice'](0x0, 0x3); for (let _0x5b09ae = 0x0; _0x5b09ae < _0x180bec[_0x3569b0(0xaa7)]; _0x5b09ae++) { if (_0x3569b0(0x353) !== _0x3569b0(0x353)) _0x43b312[_0x3569b0(0x51c)][_0x3569b0(0x440)](_0x3569b0(0x530)), _0x54ddef[_0x3569b0(0x51c)][_0x3569b0(0x56f)](_0x3569b0(0x530)) && (_0xe0e27b[_0x3569b0(0x87b)] = _0x34b458[_0x3569b0(0x7ed)]); else { if (_0x5b09ae > 0x0) await new Promise(_0x112090 => setTimeout(_0x112090, _0x396189(0x190))); const _0x537ba7 = { 'role': _0x3569b0(0x1f4), 'content': _0x180bec[_0x5b09ae], 'senderId': _0x184a97[_0x3569b0(0x4b1)], 'timestamp': Date[_0x3569b0(0x83b)](), 'isOffline': _0x4892d1 }; _0x2de116[_0x3569b0(0x59f)][_0x3569b0(0x8d9)](_0x537ba7); } } } else { _0x535f0e(_0x3569b0(0x7d8) + _0x3d208e + _0x3569b0(0x442)), _0x98516d(() => _0x3769b3[_0x3569b0(0x860)](), 0x5dc); return; } } } } } else _0x3f493a[_0x3569b0(0x260)](), _0x1db595[_0x3569b0(0x51c)]['toggle'](_0x3569b0(0x973)), _0xa3ebac[_0x3569b0(0x51c)][_0x3569b0(0x440)](_0x3569b0(0x632)); } _0x5ca5a8(), _0x47d862(); } } async function _0x5b587d(_0x304919, { force: force = ![], delayMs: delayMs = 0x0 } = {}) { const _0x3803d0 = _0x234a7d; if (_0x3803d0(0x298) !== _0x3803d0(0x650)) { await new Promise(_0x371920 => setTimeout(_0x371920, 0xa)); if (!_0x2de116['apiSettings'][_0x3803d0(0x59b)] || !_0x2de116[_0x3803d0(0x1ba)]['key'] || !_0x2de116[_0x3803d0(0x1ba)][_0x3803d0(0x4b6)]) { if (_0x3803d0(0x6da) !== _0x3803d0(0x6da)) _0xa5c0b1(![]); else return _0x15e83d(_0x3803d0(0x3be)), ![]; } const _0x186ed6 = _0x231de4(); if (!_0x186ed6 || !_0x304919) return ![]; const _0x3fb711 = _0x41382f(_0x186ed6['id']), _0x3ba91f = _0x2de116[_0x3803d0(0x59f)]['at'](-0x1)?.[_0x3803d0(0x9e8)] === _0x3803d0(0x7da); if (!force && !_0x3ba91f) return ![]; const _0x2ef824 = _0x2de116[_0x3803d0(0x59f)]['at'](-0x1)?.[_0x3803d0(0x484)] ?? ![]; if (delayMs) await new Promise(_0x5a8bcf => setTimeout(_0x5a8bcf, delayMs)); _0x2ef824 ? _0x3803d0(0x62f) !== _0x3803d0(0x996) ? document['getElementById'](_0x3803d0(0x92e))[_0x3803d0(0x1cd)] = _0x3803d0(0x693) : _0x14ddf3[_0x3803d0(0x8f3)](_0x3803d0(0x297))[_0x3803d0(0x85f)]('click', () => { const _0x5ae398 = _0x3803d0, _0x38272f = _0x2c3b61[_0x5ae398(0x8f3)](_0x5ae398(0x90c)); _0x38272f[_0x5ae398(0x696)](), _0x247736['execCommand'](_0x5ae398(0x634)), _0x10a01c(_0x5ae398(0x877)); }) : 'hDUju' === 'hDUju' ? _0x4abf53(!![]) : (_0x104587 = { 'characterId': _0x21cf78, 'entries': [] }, _0x4f8061[_0x3803d0(0x38b)][_0x3803d0(0x8d9)](_0x28b279)); let _0x3d78c6 = ''; const _0x3286b0 = _0x231de4(); if (_0x3286b0?.[_0x3803d0(0x203)]?.[_0x3803d0(0x4f9)]) { const _0x4a5726 = _0x3286b0[_0x3803d0(0x203)], _0x4f340e = await _0x26c0eb(_0x4a5726[_0x3803d0(0xa29)]); if (_0x4f340e && _0x4f340e[_0x3803d0(0x5aa)]) { const _0x4f6ff5 = _0x15d219(_0x4f340e[_0x3803d0(0x5aa)]); if (_0x4f6ff5[_0x3803d0(0xaa7)] > 0x0) { const _0x5b9a2a = _0x296518[_0x3803d0(0x3c6)]; let _0x52184b = -0x1; for (let _0xb0d98f = 0x0; _0xb0d98f < _0x4f6ff5[_0x3803d0(0xaa7)]; _0xb0d98f++) { if (_0x5b9a2a >= _0x4f6ff5[_0xb0d98f][_0x3803d0(0x2fd)]) _0x52184b = _0xb0d98f; else break; } const _0x4bdaf5 = _0x4f6ff5[_0x3803d0(0x7c6)]((_0x172dcf, _0x5eabda) => { const _0x36ff57 = _0x3803d0, _0x70c934 = _0x5eabda === _0x52184b ? _0x36ff57(0xa78) : ''; return '' + _0x70c934 + _0x172dcf[_0x36ff57(0x5bd)]; })[_0x3803d0(0x6cf)]('\x0a'); _0x3d78c6 = ('\x0a#\x20当前活动：一起听歌\x0a\x0a你们正在一起听\x20' + _0x4a5726[_0x3803d0(0x942)] + '\x20的《' + _0x4a5726[_0x3803d0(0x5e6)] + _0x3803d0(0xa12) + _0x4bdaf5 + '\x0a[歌词结束]\x0a\x0a请根据当前播放的歌词和对话氛围，自然地作出回应。\x0a\x20\x20\x20')[_0x3803d0(0x44c)](); } } } let _0x126d94 = '', _0x558046 = ''; const _0x2ff436 = _0x2de116['conversationHistory']['length']; if (_0x2ff436 > 0x1) { if ('BZvDE' === _0x3803d0(0x1d3)) _0x37e6d8(![]), _0x57e225[_0x3803d0(0x27b)]('全量导出失败:', _0x1b7632), _0x18e8b4(_0x3803d0(0x1ef) + _0x48771a['message']); else { const _0x535b71 = _0x2de116[_0x3803d0(0x59f)][_0x2ff436 - 0x2], _0x14ab4a = _0x2de116['conversationHistory'][_0x2ff436 - 0x1]; if (_0x535b71['isOffline'] === ![] && _0x14ab4a[_0x3803d0(0x484)] === !![]) _0x558046 = '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“' + _0x3fb711[_0x3803d0(0x499)] + _0x3803d0(0x674); else _0x535b71[_0x3803d0(0x484)] === !![] && _0x14ab4a['isOffline'] === ![] && (_0x558046 = '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“' + _0x3fb711[_0x3803d0(0x499)] + _0x3803d0(0x943)); } } if (_0x2ef824) { const _0x48f957 = _0x3803d0(0x9e9); _0x126d94 = _0x3803d0(0xb1c) + _0x3fb711[_0x3803d0(0x499)] + _0x3803d0(0x2b4) + _0x48f957 + _0x3803d0(0x4a4) + _0x304919[_0x3803d0(0x499)] + _0x3803d0(0x620) + _0x48f957 + _0x3803d0(0x5a0) + _0x48f957 + _0x3803d0(0x9a9); } else '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a'; const { omniText: _0x395d48 } = _0x888912(_0x304919['id'], _0x186ed6['id']), _0x1576fe = _0x3af87f(), _0x3cdfd7 = _0x385577(_0x304919['id']), _0x2e74e4 = _0x1d26a5(_0x304919['id']), _0x4ff420 = await _0x5eaae3(_0x304919['id']), _0x21b054 = typeof _0x2b6b74 === _0x3803d0(0xa98) ? _0x2b6b74['replaceAll'](_0x3803d0(0x89f), _0x304919[_0x3803d0(0x499)])[_0x3803d0(0x757)](_0x3803d0(0xab8), _0x3fb711['name'] || '用户') : '', _0x43d1d6 = _0x3bedf0[_0x3803d0(0x7c6)](_0x59c518 => _0x59c518['name'])[_0x3803d0(0x6cf)](',\x20'); let _0x53c5cb = ''; if (_0x304919[_0x3803d0(0xae1)] && _0x304919[_0x3803d0(0xae1)]['length'] > 0x0) { if (_0x3803d0(0x259) !== _0x3803d0(0x259)) { _0x139108['innerHTML'] = _0x3803d0(0x58e); return; } else { const _0x58748b = _0x304919[_0x3803d0(0xae1)][_0x3803d0(0x7c6)](_0x1cf053 => _0x2de116[_0x3803d0(0x432)][_0x3803d0(0xa68)](_0x2e283a => _0x2e283a['id'] === _0x1cf053))[_0x3803d0(0x3cf)](Boolean)[_0x3803d0(0x7c6)](_0x3956a5 => _0x3803d0(0x9a0) + _0x3956a5['name'] + '\x0a' + _0x3956a5['content'])['join'](''); if (_0x58748b) _0x53c5cb = _0x3803d0(0x356) + _0x58748b; } } const _0x2f0f36 = _0x3fb711[_0x3803d0(0x44a)] ? _0x3803d0(0x4c4) + _0x3fb711[_0x3803d0(0x499)] + '”的补充信息\x0a' + _0x3fb711[_0x3803d0(0x44a)] : ''; let _0xdac282 = ''; const _0x3817c6 = new Date(), _0x3e2127 = _0x5d182c(_0x304919['id']); _0xdac282 = _0x3803d0(0xb23), _0xdac282 += _0x3803d0(0x51b) + _0x3817c6['toLocaleString'](_0x3803d0(0x2e3), { 'dateStyle': _0x3803d0(0x542), 'timeStyle': 'short' }) + '\x0a'; if (_0x3e2127) { if (_0x3803d0(0x43c) === _0x3803d0(0x43c)) { const _0x59659a = new Date(_0x3e2127[_0x3803d0(0xa71)]), _0x4d6e09 = _0x4f5166(_0x59659a); _0xdac282 += _0x3803d0(0x900) + _0x4d6e09 + '\x0a'; const _0x1817e7 = _0x3817c6[_0x3803d0(0x5bc)](), _0x23735b = _0x59659a['toDateString'](), _0x5450a6 = new Date(); _0x5450a6[_0x3803d0(0xb25)](_0x3817c6[_0x3803d0(0x6b8)]() - 0x1); const _0x4d48ac = _0x5450a6['toDateString'](); if (_0x1817e7 === _0x23735b) { if ('lvllA' !== _0x3803d0(0x21d)) { const _0x4ed43e = (_0x3817c6 - _0x59659a) / (0x3e8 * 0x3c); _0x4ed43e < 0x3c ? _0xdac282 += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a' : _0x3803d0(0x89d) === _0x3803d0(0x7b1) ? _0x29c5d6(_0x3803d0(0x59e)) : _0xdac282 += _0x3803d0(0x587) + Math[_0x3803d0(0x8d6)](_0x4ed43e / 0x3c) + '小时前），可以简单问候一下对方现在的状态。\x0a'; } else _0x50b5dc += _0x3803d0(0x85a) + _0x1d3881[_0x3803d0(0x5e6)] + '\x20-\x20' + _0x2f1bb1['artist'] + ')'; } else { if (_0x4d48ac === _0x23735b) 'cOrzw' === _0x3803d0(0x2d3) ? _0xdac282 += '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a' : _0x2eed41['boundUserProfileId'] = _0x1f81c3[_0x3803d0(0xabe)]; else { const _0x1a6710 = Math['round']((_0x3817c6 - _0x59659a) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0xdac282 += _0x3803d0(0x30a) + _0x1a6710 + '\x20天没联系了，应该用全新的问候开启对话，不要再提上次的话题了。\x0a'; } } } else { let _0x3fc5e3 = ''; if (_0x215f89[_0x3803d0(0x350)] && _0x3e4fe1['likes'][_0x3803d0(0xaa7)] > 0x0) { const _0x2e42ad = _0x160412[_0x3803d0(0x350)]['map'](_0x483100 => _0xf60d26(_0x483100)?.[_0x3803d0(0x499)] || '未知')['join']('、'), _0xa8d8da = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>'; _0x3fc5e3 = _0x3803d0(0x2c2) + _0xa8d8da + '\x20' + _0x2e42ad + _0x3803d0(0x806); } let _0x4b48ed = ''; if (_0x1405cb['comments'] && _0x17930e['comments'][_0x3803d0(0xaa7)] > 0x0) { const _0x573775 = _0x490725['comments'][_0x3803d0(0x7c6)](_0x344ff2 => { const _0x1aa3a2 = _0x3803d0, _0x15febc = _0x10b842(_0x344ff2[_0x1aa3a2(0x50c)])?.[_0x1aa3a2(0x499)] || '未知'; return _0x1aa3a2(0x5cf) + _0x15febc + '</span>:\x20' + _0x344ff2[_0x1aa3a2(0x5e2)] + _0x1aa3a2(0x806); })[_0x3803d0(0x6cf)](''); _0x4b48ed = '<div\x20class=\x22post-comments-container\x22>' + _0x573775 + _0x3803d0(0x806); } _0x3f326a = _0x3803d0(0x9e2) + _0x3fc5e3 + _0x3803d0(0x67c) + _0x4b48ed + _0x3803d0(0xae9); } } else _0xdac282 += _0x3803d0(0xb9b); const _0x54ec13 = ('\x0a' + _0x126d94 + '\x0a你只扮演【' + _0x304919['name'] + _0x3803d0(0xa1c) + _0x304919[_0x3803d0(0x499)] + _0x3803d0(0x5b7) + _0x304919[_0x3803d0(0x499)] + _0x3803d0(0x23d) + _0x43d1d6 + ']。严禁使用列表之外的任何表情名。\x0a' + _0x21b054 + '\x0a')[_0x3803d0(0x44c)](), _0x447d85 = [{ 'role': _0x3803d0(0x456), 'content': _0x54ec13 }], _0x2098d3 = (_0x3803d0(0x2bb) + (_0x304919['persona'] || _0x3803d0(0xa3e)) + '\x0a' + _0x2f0f36 + '\x20\x0a' + _0x395d48 + '\x0a' + _0x1576fe + '\x0a' + _0x3cdfd7 + '\x0a' + _0x2e74e4 + _0x3803d0(0x504) + _0x4ff420 + _0x3803d0(0xb24) + _0x3d78c6 + '\x0a' + _0xdac282 + '\x0a' + _0x53c5cb + '\x0a')[_0x3803d0(0x44c)](); _0x2098d3[_0x3803d0(0x915)](/#.*|\s/g, '') && (_0x447d85[_0x3803d0(0x8d9)]({ 'role': _0x3803d0(0x7da), 'content': _0x2098d3 }), _0x447d85['push']({ 'role': _0x3803d0(0x1f4), 'content': _0x3803d0(0x68a) })); const _0x404b37 = _0x2de116['preferences']?.[_0x3803d0(0x6cd)] ?? 0x64, _0xa79cf1 = _0x2de116[_0x3803d0(0x59f)][_0x3803d0(0xa38)](-_0x404b37); for (const _0x5dd35e of _0xa79cf1) { const _0x4877b2 = _0x5dd35e[_0x3803d0(0x9e8)] === 'ai' || _0x5dd35e['role'] === _0x3803d0(0x1f4) ? _0x3803d0(0x1f4) : _0x3803d0(0x7da); let _0x13af86 = { 'role': _0x4877b2, 'content': _0x5dd35e[_0x3803d0(0x5e2)] }, _0x4396be = !!_0x5dd35e[_0x3803d0(0x5e2)]; if (_0x5dd35e[_0x3803d0(0x2d8)] && _0x5dd35e[_0x3803d0(0x5e2)][_0x3803d0(0x8db)]('表情')) { const _0x590a41 = _0x5dd35e[_0x3803d0(0x5e2)][_0x3803d0(0x435)](/：(.*?)]$/); _0x13af86[_0x3803d0(0x5e2)] = _0x3803d0(0x2b1) + (_0x590a41 ? _0x590a41[0x1] : _0x3803d0(0x5e7)) + ']', _0x447d85[_0x3803d0(0x8d9)](_0x13af86); } else { if (_0x3803d0(0x9d2) !== _0x3803d0(0x820)) { let _0x16439d = null; if (_0x5dd35e[_0x3803d0(0x6a9)]) _0x16439d = _0x5dd35e[_0x3803d0(0x6a9)]; else { if (_0x5dd35e[_0x3803d0(0x472)]) try { const _0x2f49b0 = await _0x26239c(_0x5dd35e[_0x3803d0(0x472)]); _0x2f49b0 && (_0x16439d = await _0x32f36c(_0x2f49b0)); } catch (_0x16413f) { _0x3803d0(0x34b) !== _0x3803d0(0x34b) ? (_0x49a5f4[_0x3803d0(0x27b)](_0x3803d0(0xac6), _0x137802), _0x5481c2('搜索失败:\x20' + _0x3f7a2a['message'])) : console[_0x3803d0(0x27b)]('在准备API数据时，从IndexedDB读取图片失败:', _0x16413f); } } _0x16439d && (_0x13af86[_0x3803d0(0x6a9)] = _0x16439d, _0x4396be = !![]), _0x4396be && _0x447d85[_0x3803d0(0x8d9)](_0x13af86); } else _0x111fa4[_0x3803d0(0x652)] = _0x3803d0(0xa57); } } try { const _0x4561f4 = await _0x4df70c(_0x447d85); if (!_0x4561f4) return ![]; if (_0x2ef824) try { let _0x2b344a = _0x4561f4['trim'](); const _0x440f0e = _0x2b344a['match'](/(\[[\s\S]*\])/); if (_0x440f0e) { if (_0x3803d0(0x4d9) === _0x3803d0(0x4d9)) _0x2b344a = _0x440f0e[0x1]; else { if (_0x25e25e) _0x24402b[_0x3803d0(0xbba)](); } } const _0x3e85cb = JSON[_0x3803d0(0x57f)](_0x2b344a); if (Array[_0x3803d0(0x75c)](_0x3e85cb)) { if (_0x3803d0(0x2da) !== _0x3803d0(0x2da)) { _0x171527[_0x3803d0(0x82c)] = _0x3803d0(0x36f); return; } else { _0x2de116[_0x3803d0(0x8f7)] = [..._0x3e85cb], _0x2de116[_0x3803d0(0x58f)][_0x304919['id']] = [..._0x3e85cb], _0x348ac8(); const _0x267e48 = _0x3e85cb['map'](_0x5531a1 => _0x5531a1['speaker'] === _0x3803d0(0x5f8) ? _0x5531a1[_0x3803d0(0x910)] : _0x5531a1[_0x3803d0(0xbbe)] + ':\x20' + _0x5531a1['line'])[_0x3803d0(0x6cf)]('\x0a\x0a'); _0x2de116[_0x3803d0(0x59f)]['push']({ 'role': _0x3803d0(0x1f4), 'senderId': _0x304919['id'], 'timestamp': Date['now'](), 'isOffline': !![], 'content': _0x267e48 }); } } } catch (_0x4bd8fb) { console[_0x3803d0(0x27b)](_0x3803d0(0x487), _0x4bd8fb, _0x3803d0(0x47e), _0x4561f4), _0x2de116[_0x3803d0(0x59f)][_0x3803d0(0x8d9)]({ 'role': _0x3803d0(0x1f4), 'senderId': _0x304919['id'], 'timestamp': Date[_0x3803d0(0x83b)](), 'isOffline': !![], 'content': '[AI返回了无法解析的剧本:\x20' + _0x4561f4 + ']' }); } else { const _0x25c05a = _0x4af2aa(_0x4561f4), _0x385da0 = _0x25c05a[_0x3803d0(0x7c6)](_0x24c549 => { const _0x1b2e16 = _0x3803d0, _0x10eb3d = _0x24c549[_0x1b2e16(0x44c)](), _0x50bf97 = _0x10eb3d[_0x1b2e16(0x435)](/^\[sticker:(.*?)\]$/), _0x3d4b3f = _0x10eb3d[_0x1b2e16(0x435)](/^\[transfer:([\d.]+)\|(.*?)\]$/), _0x141ace = _0x10eb3d[_0x1b2e16(0x435)](/^\[music:(.*?)\|(.*?)\]$/), _0xbed89e = _0x10eb3d['match'](/^\[create_event:(.*?)\|(.*?)\|(.*?)\]$/); if (_0x141ace) { if (_0x1b2e16(0x470) === _0x1b2e16(0x470)) return { 'type': _0x1b2e16(0x8be), 'songName': _0x141ace[0x1][_0x1b2e16(0x44c)](), 'artist': _0x141ace[0x2][_0x1b2e16(0x44c)]() }; else { const _0x21ee42 = _0x12fe6c(_0x38e057[_0x1b2e16(0x780)], _0x54de7f[_0x1b2e16(0x5fc)], _0x4414fa); if (_0x21ee42[_0x1b2e16(0xaa7)] === 0x0) return; const _0xa61dcd = _0x53f3af === 0x0 ? _0x1b2e16(0xa4a) : _0x1b2e16(0x6c7); _0x3ff190[_0x1b2e16(0x8d9)](_0x1b2e16(0x339) + _0xa61dcd + _0x37bd8b(_0x590825[_0x1b2e16(0x780)]) + '\x0a' + _0x21ee42[_0x1b2e16(0x6cf)]('\x0a')), _0x2eae14[_0x4e8940['chat']['id']] = _0x21ee42[_0x1b2e16(0xaa7)]; } } else { if (_0x50bf97) return { 'type': _0x1b2e16(0x880), 'name': _0x50bf97[0x1][_0x1b2e16(0x44c)]() }; else { if (_0xbed89e) { if ('FIgOJ' !== _0x1b2e16(0x721)) return { 'type': _0x1b2e16(0x279), 'eventType': _0xbed89e[0x1]['trim'](), 'eventDate': _0xbed89e[0x2]['trim'](), 'eventContent': _0xbed89e[0x3][_0x1b2e16(0x44c)]() }; else { _0x4c9d7d[_0x1b2e16(0x82c)] = '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>'; return; } } else { if (_0x3d4b3f) { const _0x5c4a4f = parseFloat(_0x3d4b3f[0x1]), _0x85c33b = _0x3d4b3f[0x2][_0x1b2e16(0x44c)](), _0xa0cc7b = _0x41382f(_0x2de116[_0x1b2e16(0xb7c)]); let _0x1097c7 = null; if (_0x85c33b === _0xa0cc7b['name']) _0x1097c7 = _0xa0cc7b['id']; else { if ('xVfKG' === 'xVfKG') { const _0x1754f5 = _0x231de4(); if (_0x1754f5[_0x1b2e16(0x318)] === _0x1b2e16(0x366)) { if (_0x1b2e16(0x904) !== _0x1b2e16(0x904)) _0x386cac[_0x1b2e16(0x83c)](_0x10f03c); else { const _0x43727d = _0x2de116[_0x1b2e16(0x393)][_0x1b2e16(0xa68)](_0x4fb70b => _0x1754f5[_0x1b2e16(0x6a3)][_0x1b2e16(0x8db)](_0x4fb70b['id']) && _0x4fb70b['name'] === _0x85c33b); if (_0x43727d) _0x1097c7 = _0x43727d['id']; } } } else { const _0x2eb9ba = _0x8d68cc[_0x1b2e16(0x6c0)](_0x53dd9b, _0x1b2e16(0xae4)), _0x8411b0 = _0x2eb9ba[_0x1b2e16(0x387)](_0x4d1479), _0x528522 = _0x8411b0[_0x1b2e16(0xb30)]({ 'id': _0x31a48a, 'blob': _0x2b43fc }); _0x528522[_0x1b2e16(0x7b4)] = () => _0x15fba0(_0x528522['result']), _0x528522[_0x1b2e16(0x611)] = () => _0x56664f(_0x528522[_0x1b2e16(0x27b)]); } } if (_0x1097c7) return { 'type': _0x1b2e16(0x56e), 'amount': _0x5c4a4f, 'recipientId': _0x1097c7, 'senderId': _0x304919['id'] }; else return { 'type': _0x1b2e16(0x5bd), 'content': _0x1b2e16(0xaf5) + _0x85c33b + _0x1b2e16(0x3b3) }; } else { if (_0x10eb3d) { if (_0x1b2e16(0x7d4) !== _0x1b2e16(0x7d4)) _0x221257[_0x1b2e16(0x3e0)][_0x1b2e16(0xaa3)] = ''; else return { 'type': _0x1b2e16(0x5bd), 'content': _0x10eb3d }; } } } } } return null; })[_0x3803d0(0x3cf)](Boolean), _0x4069c5 = async _0x415829 => { const _0x29ca10 = _0x3803d0, _0x32108e = { 'role': _0x29ca10(0x1f4), 'senderId': _0x304919['id'], 'timestamp': Date[_0x29ca10(0x83b)](), 'isOffline': _0x2ef824 }; if (_0x415829[_0x29ca10(0x318)] === _0x29ca10(0x8be)) { if (_0x29ca10(0x6f7) === _0x29ca10(0xae5)) _0x2b59a4[_0x29ca10(0xa9c)] = _0x429d88[_0x29ca10(0x64d)](_0x4fda4f), _0x57bfc3[_0x29ca10(0x3e0)][_0x29ca10(0xab9)] = _0x29ca10(0x5ac), _0x346a84[_0x29ca10(0x3e0)][_0x29ca10(0x249)] = _0x29ca10(0x1bf), _0x461d17[_0x29ca10(0x3e0)]['background'] = _0x29ca10(0x299); else { const { songName: _0x4e40b8, artist: _0x474fa0 } = _0x415829; _0x32108e[_0x29ca10(0x318)] = _0x29ca10(0x8be), _0x32108e[_0x29ca10(0x5e2)] = _0x29ca10(0x220) + _0x4e40b8 + '\x20-\x20' + _0x474fa0 + ']'; try { const _0xaf33bb = await _0x9a63ea(_0x4e40b8, _0x474fa0); let _0x212a80 = null; if (_0xaf33bb['cover']) { const _0x4f0bf2 = await _0x1639b4(_0xaf33bb['cover']); _0x212a80 = _0x29ca10(0xa24) + Date[_0x29ca10(0x83b)]() + '_' + Math[_0x29ca10(0x77b)](), await _0x1d2a3c(_0x212a80, _0x4f0bf2); } Object[_0x29ca10(0x44f)](_0x32108e, { 'songName': _0x4e40b8, 'artist': _0x474fa0, 'coverId': _0x212a80, 'playableUrl': _0xaf33bb[_0x29ca10(0xb77)] }); } catch (_0x28627d) { Object[_0x29ca10(0x44f)](_0x32108e, { 'songName': _0x4e40b8, 'artist': _0x474fa0, 'coverId': null, 'playableUrl': null }); } } } else { if (_0x415829[_0x29ca10(0x318)] === 'sticker') { const _0x416761 = _0x3bedf0[_0x29ca10(0xa68)](_0x348eae => _0x348eae[_0x29ca10(0x499)] === _0x415829[_0x29ca10(0x499)]); if (_0x416761) Object['assign'](_0x32108e, { 'content': _0x29ca10(0x425) + _0x416761[_0x29ca10(0x499)] + ']', 'displayUrl': _0x416761[_0x29ca10(0xb77)] }); else _0x32108e[_0x29ca10(0x5e2)] = _0x29ca10(0x2b1) + _0x415829[_0x29ca10(0x499)] + ']'; } else { if (_0x415829[_0x29ca10(0x318)] === 'transfer') { const _0x56f6a2 = _0x415829['recipientId'] === _0x41382f(_0x2de116[_0x29ca10(0xb7c)])['id'] ? _0x41382f(_0x2de116[_0x29ca10(0xb7c)]) : _0x11feaf(_0x415829[_0x29ca10(0x637)]); Object[_0x29ca10(0x44f)](_0x32108e, { 'type': 'transfer', 'amount': _0x415829[_0x29ca10(0x22e)], 'recipientId': _0x415829[_0x29ca10(0x637)], 'content': _0x29ca10(0x91a) + (_0x56f6a2?.[_0x29ca10(0x499)] || '未知') + '\x20转账\x20' + _0x415829[_0x29ca10(0x22e)] + ']' }); } else { if (_0x415829[_0x29ca10(0x318)] === _0x29ca10(0x279)) { if (_0x29ca10(0x7d1) !== _0x29ca10(0x1df)) { const _0x56bfd0 = _0x41382f(_0x186ed6['id']); if (!_0x56bfd0 || !_0x56bfd0['id']) return console[_0x29ca10(0x27b)]('AI\x20试图创建事件，但找不到有效的用户ID。'), null; _0x2de116[_0x29ca10(0x207)][_0x29ca10(0x8d9)]({ 'id': _0x29ca10(0x6d0) + Date[_0x29ca10(0x83b)](), 'date': _0x415829[_0x29ca10(0x538)], 'type': _0x415829[_0x29ca10(0x518)], 'content': _0x415829[_0x29ca10(0x9db)], 'userId': _0x56bfd0['id'], 'createdBy': 'ai' }), _0x2ca195(), _0x192d10(), _0x52d60f(); const _0x30db67 = _0x11feaf(_0x304919['id']); _0x30db67 && _0x415829[_0x29ca10(0x518)] === _0x29ca10(0x9de) && _0x15e83d(_0x29ca10(0x558) + _0x30db67[_0x29ca10(0x499)] + _0x29ca10(0x8a1) + _0x415829['eventContent']); return { 'role': 'assistant', 'senderId': _0x304919['id'], 'timestamp': Date['now'](), 'isOffline': _0x2ef824, 'content': null }; return { 'role': _0x29ca10(0x1f4), 'senderId': _0x304919['id'], 'timestamp': Date[_0x29ca10(0x83b)](), 'isOffline': _0x2ef824, 'content': null }; } else { const _0x5a7622 = _0x1aefa2[_0x29ca10(0x68e)](0x1, _0x57c533(_0x55f627[_0x29ca10(0x9d6)]?.[_0x29ca10(0x6cd)] ?? 0x64)), _0x7f03cf = _0x2191db['chats'][_0x29ca10(0x3cf)](_0x1104c7 => _0x1104c7[_0x29ca10(0x6a3)][_0x29ca10(0x8db)](_0x1d55d3)), _0x5ce518 = _0x7f03cf[_0x29ca10(0x7c6)](_0x252d9a => { const _0x5ab76c = _0x29ca10, _0x1b7db4 = _0x34522d(_0x252d9a['id']), _0x5d04ab = _0x1b7db4[_0x5ab76c(0xaa7)] > 0x0 ? _0x1b7db4[_0x1b7db4['length'] - 0x1] : null; return { 'chat': _0x252d9a, 'history': _0x1b7db4, 'lastTimestamp': _0x5d04ab ? _0x5d04ab[_0x5ab76c(0xa71)] : 0x0 }; })[_0x29ca10(0x3cf)](_0x55604d => _0x55604d[_0x29ca10(0x5fc)]['length'] > 0x0); _0x5ce518[_0x29ca10(0xb71)]((_0x4b9e22, _0x23dd6d) => _0x23dd6d[_0x29ca10(0x95f)] - _0x4b9e22['lastTimestamp']); const _0x2bfcb3 = [], _0x738f88 = {}; return _0x5ce518['forEach']((_0x54e7a1, _0x1e2dc4) => { const _0x35d00b = _0x29ca10, _0x3429c6 = _0x1aa110(_0x54e7a1[_0x35d00b(0x780)], _0x54e7a1[_0x35d00b(0x5fc)], _0x5a7622); if (_0x3429c6[_0x35d00b(0xaa7)] === 0x0) return; const _0xc755e7 = _0x1e2dc4 === 0x0 ? '来源：[最活跃]' : _0x35d00b(0x6c7); _0x2bfcb3['push']('##\x20' + _0xc755e7 + _0x57825a(_0x54e7a1[_0x35d00b(0x780)]) + '\x0a' + _0x3429c6[_0x35d00b(0x6cf)]('\x0a')), _0x738f88[_0x54e7a1['chat']['id']] = _0x3429c6[_0x35d00b(0xaa7)]; }), { 'omniText': _0x2bfcb3[_0x29ca10(0x6cf)]('\x0a\x0a'), 'usedCounts': _0x738f88 }; } } else { const _0x4f92ab = _0x50c733(_0x415829['content']); Object['assign'](_0x32108e, { 'content': _0x4f92ab[_0x29ca10(0x5e2)], 'quotedMessage': _0x4f92ab[_0x29ca10(0x9bd)] }); } } } } return _0x32108e; }, _0x238177 = await Promise[_0x3803d0(0x304)](_0x385da0[_0x3803d0(0x7c6)](_0x4069c5)); for (const _0x52c908 of _0x238177) { _0x3803d0(0x81d) === _0x3803d0(0x485) ? _0xaea3b5[_0x3803d0(0x23f)]({ 'behavior': _0x3803d0(0x3d2), 'block': _0x3803d0(0x98b) }) : (_0x52c908['content'] || _0x52c908[_0x3803d0(0x2d8)] || _0x52c908[_0x3803d0(0x318)] === 'music') && (_0x3803d0(0x930) !== 'nCKLL' ? (await new Promise(_0x3e2314 => setTimeout(_0x3e2314, 0x12c + Math[_0x3803d0(0x77b)]() * 0x190)), _0x2de116[_0x3803d0(0x59f)][_0x3803d0(0x8d9)](_0x52c908), _0x47d862()) : _0xe13f41()); } } return _0x5ca5a8(), _0x47d862(), !![]; } catch (_0x347a44) { if (_0x347a44[_0x3803d0(0x499)] !== _0x3803d0(0xb08)) { console[_0x3803d0(0x27b)]('生成失败:\x20', _0x347a44); const _0x4bffc9 = { 'role': _0x3803d0(0x1f4), 'content': _0x3803d0(0xbb1) + _0x347a44[_0x3803d0(0x722)], 'senderId': _0x304919['id'], 'isOffline': _0x2ef824 }; _0x2de116['conversationHistory']['push'](_0x4bffc9), _0x47d862(); } return ![]; } finally { _0x3803d0(0xb54) === _0x3803d0(0xb54) ? _0x4abf53(![]) : _0x231b18(_0x1d0585['coverId'])[_0x3803d0(0xad3)](_0x361cd6 => { const _0x3d0b2e = _0x3803d0, _0x2f9794 = _0x213cd8[_0x3d0b2e(0x8f3)](_0x4360e4); if (_0x2f9794 && _0x361cd6) _0x2f9794[_0x3d0b2e(0xa9c)] = _0x430078[_0x3d0b2e(0x64d)](_0x361cd6); }); } } else { const _0x2a8ff3 = _0x1ada73[_0x3803d0(0x57f)](_0x3cc6f4); _0x1ee4e5[_0x3803d0(0x75c)](_0x2a8ff3) ? _0x465102 = [..._0x558afe, ..._0x2a8ff3] : _0x30bc31 = _0x47afd2; } } async function _0x20a6bc() { const _0x489e17 = _0x234a7d, _0x45382f = _0x231de4(); if (!_0x45382f || _0x45382f[_0x489e17(0x318)] !== _0x489e17(0x2c0)) { if ('iQIDy' !== _0x489e17(0xb7b)) { const _0x1c509f = _0x1d68e6[_0x489e17(0x4b1)] ? _0x2b4135(_0x62b347[_0x489e17(0x4b1)]) : null; return _0x1c509f?.[_0x489e17(0x499)] || 'Unknown'; } else { _0x15e83d(_0x489e17(0x1fb)); return; } } if (_0x2de116[_0x489e17(0x3b8)]) { _0x15e83d('我正在说话呢，别打岔！'); return; } const _0x5e782e = await _0x2244b3('确定要对本次会话进行总结吗？这会消耗不少资源，并且会读取完整的聊天记录。'); if (!_0x5e782e) return; _0xc9067c(!![], '正在翻阅全部历史记录...'), _0x3d9d9e['value'] = '', _0x391ef6[_0x489e17(0x51c)][_0x489e17(0x6dd)](_0x489e17(0x530)), _0x2de116[_0x489e17(0x3b8)] = !![]; try { if (_0x489e17(0x2ae) === _0x489e17(0x2ae)) { const _0x137c0f = _0x11feaf(_0x45382f[_0x489e17(0x6a3)][0x0]), _0x224612 = _0x41382f(_0x45382f['id']), _0x362b90 = _0xce240b(_0x45382f['id']); if (_0x362b90[_0x489e17(0xaa7)] === 0x0) { if ('cQeaj' !== _0x489e17(0x1e4)) _0x478107['currentAbortController'] = null; else { _0x3d9d9e[_0x489e17(0xa35)] = _0x489e17(0x5a2); return; } } const _0x46912e = _0x362b90['map'](_0x15b97f => { const _0x5e228d = _0x489e17, _0x434427 = new Date(_0x15b97f['timestamp']), _0x4cf39b = _0x434427[_0x5e228d(0x826)]() + '-' + String(_0x434427[_0x5e228d(0xbbb)]() + 0x1)['padStart'](0x2, '0') + '-' + String(_0x434427['getDate']())[_0x5e228d(0x6f9)](0x2, '0'), _0x551e97 = String(_0x434427[_0x5e228d(0x6ca)]())['padStart'](0x2, '0') + ':' + String(_0x434427[_0x5e228d(0x6d3)]())[_0x5e228d(0x6f9)](0x2, '0'); let _0x1665bc = '未知'; if (_0x15b97f[_0x5e228d(0x9e8)] === _0x5e228d(0x7da)) { if (_0x5e228d(0x284) === 'PCaAY') { const _0x63a9e3 = _0x560cab(_0x5b75cf[_0x5e228d(0x4b1)]); return _0x63a9e3?.[_0x5e228d(0x499)] || _0x5e228d(0x681); } else _0x1665bc = _0x224612[_0x5e228d(0x499)]; } else _0x1665bc = _0x137c0f[_0x5e228d(0x499)]; let _0x3f7912 = _0x15b97f[_0x5e228d(0x5e2)]; if (_0x15b97f[_0x5e228d(0x2d8)]) _0x3f7912 = '[发送了表情]'; if (_0x15b97f['imageId']) _0x3f7912 = _0x5e228d(0x7dc); return '[' + _0x4cf39b + '\x20' + _0x551e97 + _0x5e228d(0x891) + _0x1665bc + _0x5e228d(0xac1) + _0x3f7912; })[_0x489e17(0x6cf)]('\x0a'), _0x469066 = _0x28d402[_0x489e17(0x915)](/{charName}/g, _0x137c0f[_0x489e17(0x499)])[_0x489e17(0x915)](/{userName}/g, _0x224612[_0x489e17(0x499)]), _0x93b52e = [{ 'role': 'system', 'content': _0x469066 }, { 'role': _0x489e17(0x7da), 'content': _0x46912e }], _0x25396d = await _0x4df70c(_0x93b52e); _0x3d9d9e[_0x489e17(0xa35)] = _0x25396d || _0x489e17(0x957), _0x3d9d9e[_0x489e17(0x87b)] = 0x0; } else { const _0x45a1e3 = _0x196f5f[_0x489e17(0xb35)](_0x489e17(0x4e8)); _0x45a1e3[_0x489e17(0xaff)] = _0x489e17(0x2a8), _0x45a1e3[_0x489e17(0x82c)] = _0x489e17(0x2ad) + _0x2283c0[_0x489e17(0x7ab)] + _0x489e17(0x91b) + _0x3038af['amount'][_0x489e17(0xaeb)](0x2) + _0x489e17(0x9e1) + _0x16ff1f['id'] + _0x489e17(0xb6a), _0x51dd21[_0x489e17(0x3bf)](_0x45a1e3); } } catch (_0x284a3a) { if ('Rhcic' !== _0x489e17(0xadd)) console[_0x489e17(0x27b)](_0x489e17(0xbaf), _0x284a3a), _0x3d9d9e[_0x489e17(0xa35)] = _0x489e17(0xb9e) + _0x284a3a[_0x489e17(0x722)]; else { _0x4ff3da[_0x489e17(0x51c)][_0x489e17(0x6dd)](_0x489e17(0x880)); const _0x568ab5 = _0x22b4a5[_0x489e17(0xb35)](_0x489e17(0x365)); _0x568ab5[_0x489e17(0xa9c)] = _0x304807, _0x568ab5[_0x489e17(0x51c)][_0x489e17(0x6dd)]('sticker-content'), _0x3333d5['appendChild'](_0x568ab5); } } finally { _0xc9067c(![]), _0x2de116[_0x489e17(0x3b8)] = ![]; } } async function _0x525b8d() { const _0x52f8ba = _0x234a7d; console[_0x52f8ba(0x754)](_0x52f8ba(0xaf7)); if (!_0x2de116[_0x52f8ba(0x1ba)][_0x52f8ba(0x59b)] || !_0x2de116['apiSettings'][_0x52f8ba(0x64a)] || !_0x2de116[_0x52f8ba(0x1ba)][_0x52f8ba(0x4b6)]) { if (_0x52f8ba(0x568) === _0x52f8ba(0x568)) { _0x15e83d(_0x52f8ba(0x3be)); return; } else _0x39c106(_0x15ad51, _0x3669bf['target'][_0x52f8ba(0x6f1)][0x0]); } const _0x3216bc = _0x2de116['conversationHistory']['at'](-0x1)?.['role'] === _0x52f8ba(0x7da); if (!_0x3216bc || _0x2de116[_0x52f8ba(0x3b8)]) return; const _0x487766 = _0x231de4(); if (!_0x487766) return; _0x2de116[_0x52f8ba(0x3b8)] = !![], _0x4abf53(!![]); try { if (_0x487766['type'] === _0x52f8ba(0x2c0)) { if (_0x52f8ba(0xa64) === _0x52f8ba(0x5b3)) _0x110061('错误:\x20' + _0x57a2b0[_0x52f8ba(0x722)]); else { const _0x554881 = _0x11feaf(_0x487766[_0x52f8ba(0x6a3)][0x0]); console[_0x52f8ba(0x754)](_0x52f8ba(0x800)); if (_0x554881) await _0x5b587d(_0x554881, { 'force': !![] }); } } else { if (_0x52f8ba(0x550) === 'UEcGa') { const _0x2e1e0d = _0x1f0454['friendCircles'][_0x52f8ba(0xa68)](_0x318cbc => _0x318cbc['id'] === _0x5d200d[_0x52f8ba(0x42d)]), _0x3ac798 = _0x12a48b(); let _0x471afd = []; if (_0x2e1e0d && _0x2e1e0d[_0x52f8ba(0x415)]) { const _0x7a2ab4 = _0x2e1e0d[_0x52f8ba(0x415)]['filter'](_0x32d5c2 => _0x32d5c2[_0x52f8ba(0x318)] === _0x52f8ba(0x8be) && _0x32d5c2['playableUrl'])['map'](_0x2bbd8a => ({ ..._0x2bbd8a, 'source': 'feed' })); _0x471afd[_0x52f8ba(0x8d9)](..._0x7a2ab4); } if (_0x3ac798 && _0x44bc4e[_0x52f8ba(0x59f)]) { const _0x2db6f4 = _0xeab498[_0x52f8ba(0x59f)][_0x52f8ba(0x3cf)](_0x5e8d83 => _0x5e8d83[_0x52f8ba(0x318)] === _0x52f8ba(0x8be) && _0x5e8d83['playableUrl'])[_0x52f8ba(0x7c6)](_0x2b69d4 => ({ ..._0x2b69d4, 'source': _0x52f8ba(0x780) })); _0x471afd['push'](..._0x2db6f4); } const _0x18ab94 = _0x587a87[_0x52f8ba(0x426)](new _0x3476fb(_0x471afd[_0x52f8ba(0x7c6)](_0x25fd69 => [_0x25fd69[_0x52f8ba(0x788)], _0x25fd69]))[_0x52f8ba(0x817)]()); _0x2949d9['musicPlaylist'] = _0x18ab94['sort']((_0x482529, _0x18324d) => _0x18324d['timestamp'] - _0x482529[_0x52f8ba(0xa71)]); } else { const _0x44ac2c = await _0x3bf117(); if (_0x44ac2c && _0x44ac2c[_0x52f8ba(0x2e1)]?.[_0x52f8ba(0xaa7)]) await _0x829521(_0x44ac2c); else { console['warn'](_0x52f8ba(0x326)); const _0x4dcc9b = _0x487766[_0x52f8ba(0x6a3)]['map'](_0x11feaf)[_0x52f8ba(0x3cf)](Boolean); if (!_0x4dcc9b['length']) return; let _0x3d6849 = 0x0; for (const _0x232149 of _0x4dcc9b) { _0x5b587d(_0x232149, { 'force': !![], 'delayMs': _0x3d6849 }), _0x3d6849 += 0x1f4; } } } } } catch (_0x5cfbd5) { if (_0x5cfbd5[_0x52f8ba(0x499)] !== _0x52f8ba(0xb08)) { if ('qpYvI' === _0x52f8ba(0x42e)) { _0x2bc2b9['error'](_0x52f8ba(0xb2c)); return; } else console[_0x52f8ba(0x27b)](_0x52f8ba(0x753), _0x5cfbd5), _0x3fc7e7({ 'role': _0x52f8ba(0x1f4), 'content': _0x52f8ba(0xbb1) + _0x5cfbd5[_0x52f8ba(0x722)] }, _0x2de116[_0x52f8ba(0x59f)][_0x52f8ba(0xaa7)] - 0x1); } } finally { _0x2de116[_0x52f8ba(0x3b8)] = ![], _0x4abf53(![]); } } function _0x304b7d(_0x1160e8, _0x40dc8a) { const _0x36dbd9 = _0x234a7d, _0x4977f7 = _0x40dc8a[_0x36dbd9(0x586)](), _0x486497 = _0x1160e8[_0x36dbd9(0x586)](); if (_0x4977f7[_0x36dbd9(0x3df)](_0x36dbd9(0x53b))) return 'anthropic'; if (_0x486497[_0x36dbd9(0x8db)](_0x36dbd9(0xb5b))) return 'anthropic'; if (_0x486497[_0x36dbd9(0x8db)]('googleapis.com')) return 'gemini'; if (_0x4977f7[_0x36dbd9(0x3df)](_0x36dbd9(0x986))) return _0x36dbd9(0x986); return _0x36dbd9(0x39e); } async function _0x4df70c(_0x2e17c5, _0x423fd2 = {}) { const _0x5e270e = _0x234a7d; if (_0x2de116[_0x5e270e(0xa92)]) { if (_0x5e270e(0x3fc) !== 'ajcNy') { if (!_0x53a2fa[_0x5e270e(0xb7c)]) return; try { _0x3d6799[_0x5e270e(0x23c)](_0x5e270e(0xb7a) + _0x59262e['activeChatId'], _0x3951a7['stringify'](_0x20a01c[_0x5e270e(0x59f)])); } catch (_0x458288) { _0x25c3e2[_0x5e270e(0x27b)]('Failed\x20to\x20save\x20history\x20to\x20localStorage:', _0x458288), _0x41e00b(_0x5e270e(0x6cb)); } } else _0x2de116[_0x5e270e(0xa92)]['abort']('New\x20request\x20started'); } _0x2de116[_0x5e270e(0xa92)] = new AbortController(); const _0x5aee3f = _0x2de116['currentAbortController'][_0x5e270e(0x78a)], { endpoint: _0x4417cb, key: _0x16572a, model: _0x37e84b } = _0x2de116[_0x5e270e(0x1ba)], _0x16fdbb = !!_0x423fd2[_0x5e270e(0x7ce)], _0x4ba018 = _0x304b7d(_0x4417cb, _0x37e84b); console[_0x5e270e(0x754)](_0x5e270e(0x9d8) + _0x4ba018); let _0x15236e = ''; try { if ('ASRza' === 'dikye') _0x384b79 += _0x5e270e(0xb9b); else { switch (_0x4ba018) { case _0x5e270e(0x9b1): { const _0x186a02 = _0x1cc06f(_0x16572a), _0x5347a4 = _0x2e17c5[_0x5e270e(0xa68)](_0x42e365 => _0x42e365[_0x5e270e(0x9e8)] === 'system')?.[_0x5e270e(0x5e2)] || '', _0xacfa94 = _0x2e17c5[_0x5e270e(0x3cf)](_0x1f0ce9 => _0x1f0ce9['role'] !== 'system'), _0x1482c4 = { 'model': _0x37e84b, 'system': _0x5347a4, 'messages': _0xacfa94[_0x5e270e(0x7c6)](_0x4bbd93 => ({ 'role': _0x4bbd93[_0x5e270e(0x9e8)], 'content': [{ 'type': _0x5e270e(0x5bd), 'text': _0x4bbd93[_0x5e270e(0x5e2)] }] })), 'max_tokens': 0x1000 }, _0x1482b6 = await fetch(_0x4417cb, { 'method': _0x5e270e(0x3cd), 'headers': { 'Content-Type': _0x5e270e(0xa5d), 'x-api-key': _0x186a02, 'anthropic-version': '2023-06-01' }, 'body': JSON[_0x5e270e(0x269)](_0x1482c4), 'signal': _0x5aee3f }); if (!_0x1482b6['ok']) { const _0xa08f19 = await _0x1482b6[_0x5e270e(0x7ce)]()[_0x5e270e(0xa2a)](() => ({})); throw new Error(_0x5e270e(0xa8e) + _0x1482b6[_0x5e270e(0x85c)] + '\x20-\x20' + (_0xa08f19['error']?.['message'] || _0x1482b6['statusText'])); } const _0x5e2381 = await _0x1482b6['json'](); _0x15236e = _0x5e2381[_0x5e270e(0x5e2)]?.[0x0]?.[_0x5e270e(0x5bd)] || ''; break; } case _0x5e270e(0x986): { if (_0x5e270e(0x1fd) !== _0x5e270e(0x29d)) { const _0x5c80e4 = _0x1cc06f(_0x16572a), _0x21b263 = _0x4417cb['includes']('generativelace.googleapis.com'), _0x27de30 = _0x9c4e5f => { const _0x2c3058 = _0x5e270e; if ('YkLlw' === _0x2c3058(0x6e3)) _0x2c57a1 += _0x2c3058(0x1d0) + _0x58596d[_0x2c3058(0x88e)] + '”，在那里“' + _0x4c0814[_0x2c3058(0xa40)] + _0x2c3058(0xbb9); else { const _0x472dbb = []; if (_0x9c4e5f[_0x2c3058(0x5e2)]) _0x472dbb[_0x2c3058(0x8d9)]({ 'text': _0x9c4e5f[_0x2c3058(0x5e2)] }); if (_0x9c4e5f[_0x2c3058(0x6a9)]) { const _0x1b8f7a = _0x9c4e5f[_0x2c3058(0x6a9)]['split'](',')[0x1], _0x400057 = _0x9c4e5f['image']['substring'](_0x9c4e5f[_0x2c3058(0x6a9)][_0x2c3058(0x8ca)](':') + 0x1, _0x9c4e5f[_0x2c3058(0x6a9)]['indexOf'](';')) || _0x2c3058(0x71e); _0x472dbb['push']({ 'inline_data': { 'mime_type': _0x400057, 'data': _0x1b8f7a } }); } return _0x472dbb; } }, _0x501eae = _0x2e17c5[_0x5e270e(0x7c6)](_0x23810a => ({ 'role': _0x23810a[_0x5e270e(0x9e8)] === 'assistant' ? _0x5e270e(0x4b6) : _0x23810a['role'] === _0x5e270e(0x456) ? _0x5e270e(0x7da) : _0x23810a[_0x5e270e(0x9e8)], 'parts': _0x27de30(_0x23810a) }))[_0x5e270e(0x3cf)](_0x2df4d6 => _0x2df4d6['parts'][_0x5e270e(0xaa7)] > 0x0), _0x4a8477 = { 'contents': _0x501eae }; _0x16fdbb && _0x21b263 && (_0x4a8477[_0x5e270e(0x80e)] = { 'response_mime_type': _0x5e270e(0xa5d) }); const _0x4a06f4 = _0x4417cb + '/v1beta/models/' + _0x37e84b + ':streamGenerateContent?key=' + _0x5c80e4 + '&alt=sse', _0x40e02e = await fetch(_0x4a06f4, { 'method': _0x5e270e(0x3cd), 'headers': { 'Content-Type': _0x5e270e(0xa5d) }, 'body': JSON[_0x5e270e(0x269)](_0x4a8477), 'signal': _0x5aee3f }); if (!_0x40e02e['ok']) throw new Error(_0x5e270e(0xb97) + _0x40e02e[_0x5e270e(0x85c)]); const _0x453597 = _0x40e02e[_0x5e270e(0xb43)][_0x5e270e(0x8b9)](), _0x1cb598 = new TextDecoder(); let _0x5e2198 = ''; while (!![]) { if ('qXBTK' === _0x5e270e(0x8e2)) { if (_0x5aee3f[_0x5e270e(0x3b6)]) { if (_0x5e270e(0x5c8) !== _0x5e270e(0x5c8)) { const _0x3a2019 = _0x1e4526['entries'][_0x5e270e(0x3cf)](_0xa53745 => _0xa53745[_0x5e270e(0x5bb)] === 'user')[_0x5e270e(0x23b)](); _0x3a2019 && (_0x269968 = _0x3a2019[_0x5e270e(0x5e2)]); } else { console[_0x5e270e(0x754)](_0x5e270e(0x917)), _0x453597[_0x5e270e(0x574)](); break; } } const { done: _0x14b802, value: _0x4a0656 } = await _0x453597['read'](); if (_0x14b802) break; const _0x1d9e15 = _0x1cb598[_0x5e270e(0x404)](_0x4a0656, { 'stream': !![] }), _0x178535 = _0x1d9e15['split']('\x0a')['filter'](_0x293b33 => _0x293b33[_0x5e270e(0x44c)]()[_0x5e270e(0x3df)](_0x5e270e(0x2ba))); for (const _0x55e89c of _0x178535) { const _0x53b3ef = _0x55e89c['replace'](_0x5e270e(0x347), ''); if (_0x53b3ef === _0x5e270e(0x2db)) break; try { _0x5e270e(0x2fb) !== _0x5e270e(0x2fb) ? _0x5f08bb[_0x5e270e(0x8f3)]('card-input-2')['click']() : _0x5e2198 += JSON[_0x5e270e(0x57f)](_0x53b3ef)['candidates'][0x0]['content'][_0x5e270e(0x50f)][0x0][_0x5e270e(0x5bd)]; } catch { } } } else _0x26681e !== _0x33a808['querySelector']('.music-post-play-icon,\x20.music-share-play-icon') && (_0x1d8c1b[_0x5e270e(0x1cd)] = '▶'); } _0x15236e = _0x5e2198; break; } else { _0x479699[_0x5e270e(0x4ca)](_0x5e270e(0x649) + _0x358598['id'] + _0x5e270e(0x4f6), _0x1afa4f[_0x5e270e(0x722)]); try { _0x38bea8 = _0x357781(_0x2df543); if (!_0x9f1cb7) throw new _0x21d4b4(_0x5e270e(0xa46)); _0x5e4676[_0x5e270e(0x754)](_0x5e270e(0xabd) + _0x342bc8['id'] + _0x5e270e(0x8b5)); } catch (_0x394500) { throw _0x2b211f; } } } case _0x5e270e(0x39e): default: { const _0x430e8c = _0x1cc06f(_0x16572a), _0x2eb7fb = _0x4417cb['replace'](/\/+$/, '') + '/v1/chat/completions', _0x58629a = _0x2e17c5[_0x5e270e(0x7c6)](_0x4d57be => { const _0xf49b55 = _0x5e270e; if (_0x4d57be[_0xf49b55(0x9e8)] === 'user' && _0x4d57be[_0xf49b55(0x6a9)]) { if (_0xf49b55(0x65b) !== _0xf49b55(0x9d0)) return { 'role': _0xf49b55(0x7da), 'content': [{ 'type': _0xf49b55(0x5bd), 'text': _0x4d57be['content'] || '\x20' }, { 'type': _0xf49b55(0x46d), 'image_url': { 'url': _0x4d57be[_0xf49b55(0x6a9)], 'detail': _0xf49b55(0x202) } }] }; else _0x14ff82[_0xf49b55(0xae1)] && (_0x2bbeb3[_0xf49b55(0xae1)] = _0x434e0e[_0xf49b55(0xae1)]['filter'](_0x47e6f6 => _0x47e6f6 !== _0xfcec75)); } return { 'role': _0x4d57be[_0xf49b55(0x9e8)], 'content': _0x4d57be[_0xf49b55(0x5e2)] }; })[_0x5e270e(0x3cf)](_0x2b0418 => _0x2b0418[_0x5e270e(0x5e2)]), _0x1e199c = { 'model': _0x37e84b, 'messages': _0x58629a, 'max_tokens': 0x1000, ..._0x16fdbb ? { 'response_format': { 'type': _0x5e270e(0xade) } } : {} }, _0xe23469 = await fetch(_0x2eb7fb, { 'method': 'POST', 'headers': { 'Content-Type': 'application/json', 'Authorization': _0x5e270e(0xbb7) + _0x430e8c }, 'body': JSON[_0x5e270e(0x269)](_0x1e199c), 'signal': _0x5aee3f }); if (!_0xe23469['ok']) { const _0x5374a8 = await _0xe23469[_0x5e270e(0x7ce)]()['catch'](() => ({})); throw new Error(_0x5e270e(0x8e1) + _0xe23469[_0x5e270e(0x85c)] + '\x20-\x20' + (_0x5374a8['error']?.[_0x5e270e(0x722)] || _0xe23469[_0x5e270e(0x72c)])); } const _0x2cba01 = await _0xe23469['json'](); _0x15236e = _0x2cba01[_0x5e270e(0x783)]?.[0x0]?.[_0x5e270e(0x722)]?.[_0x5e270e(0x5e2)] || ''; break; } }return _0x15236e; } } catch (_0x10df8e) { if (_0x10df8e[_0x5e270e(0x499)] === _0x5e270e(0xb08)) return console[_0x5e270e(0x754)](_0x5e270e(0x2fe)), ''; throw _0x10df8e; } finally { _0x2de116[_0x5e270e(0xa92)] && _0x2de116[_0x5e270e(0xa92)]['signal'] === _0x5aee3f && (_0x2de116[_0x5e270e(0xa92)] = null); } } async function _0x8f9eec() { const _0x137a6f = _0x234a7d, _0x11e565 = _0x26452f[_0x137a6f(0x398)]['classList']['contains'](_0x137a6f(0x8e0)), _0x2a5f7d = _0x11e565 ? _0x25ea8e[_0x137a6f(0xa35)] : null; let _0x2bef10 = null, _0x249512 = ''; if (_0x11e565 && _0x2a5f7d) { _0x2bef10 = _0x2de116[_0x137a6f(0x6b7)]['find'](_0x274f8a => _0x274f8a[_0x137a6f(0x318)] === _0x137a6f(0x2c0) && _0x274f8a['participantIds'][_0x137a6f(0x8db)](_0x2a5f7d)); const _0x595f89 = _0x11feaf(_0x2a5f7d); _0x249512 = _0x595f89 ? _0x595f89[_0x137a6f(0x499)] : _0x137a6f(0x70b); } else { if (_0x2de116['activeChatId']) { _0x2bef10 = _0x231de4(); const _0x30cf9f = document[_0x137a6f(0x8f3)](_0x137a6f(0x968))[_0x137a6f(0x1cd)]; _0x249512 = _0x30cf9f || _0x137a6f(0x45d); } } if (!_0x2bef10) { if (_0x137a6f(0x49e) !== 'ffPdz') { const _0x1c971e = _0x48de70[_0x137a6f(0x8f3)](_0x137a6f(0x8bd)); _0x4c6258[_0x137a6f(0x8f3)](_0x137a6f(0xb74))[_0x137a6f(0x1cd)] = '账本', _0x44e713['getElementById']('header-actions')[_0x137a6f(0x82c)] = ''; const _0x107854 = _0x396223[_0x137a6f(0xa8f)](_0xd11ae3[_0x137a6f(0x8f5)])['sort']((_0x1ef7d7, _0x2787e5) => new _0x1e1426(_0x2787e5) - new _0x1aac35(_0x1ef7d7)); if (_0x107854[_0x137a6f(0xaa7)] === 0x0) { _0x1c971e[_0x137a6f(0x82c)] = _0x137a6f(0x1ee); return; } _0x1c971e[_0x137a6f(0x82c)] = '', _0x107854[_0x137a6f(0x201)](_0x392704 => { const _0x5d8120 = _0x137a6f, _0x4f856c = _0x293648[_0x5d8120(0xb35)]('div'); _0x4f856c[_0x5d8120(0xaff)] = _0x5d8120(0x2a8), _0x4f856c['style'][_0x5d8120(0x835)] = _0x5d8120(0xac9); const _0x59ae8b = _0x3335d4['accountingLedger'][_0x392704], _0x5602e3 = _0x59ae8b['categorizedExpenses']['reduce']((_0x590d66, _0x3f0b19) => _0x590d66 + (_0x3f0b19[_0x5d8120(0x22e)] || 0x0), 0x0); _0x4f856c[_0x5d8120(0x82c)] = _0x5d8120(0x2ad) + _0x392704 + _0x5d8120(0x2bf) + _0x5602e3[_0x5d8120(0xaeb)](0x2) + _0x5d8120(0x3ae), _0x4f856c[_0x5d8120(0x85f)]('click', () => { const _0x29952f = _0x5d8120; _0x395626[_0x29952f(0x51c)][_0x29952f(0x2e4)](_0x29952f(0x8e0)), _0x17f3f0[_0x29952f(0x51c)][_0x29952f(0x6dd)](_0x29952f(0x8e0)), _0xad3b02(_0x59ae8b, _0x392704); }), _0x1c971e['appendChild'](_0x4f856c); }); } else { _0x15e83d(_0x137a6f(0x6f0)); return; } } const _0x3ff932 = await _0x2244b3('确定要清空\x22' + _0x249512 + _0x137a6f(0x9ba)); if (!_0x3ff932) return; if (_0x2bef10['id'] === _0x2de116[_0x137a6f(0xb7c)]) { if (_0x137a6f(0x621) !== 'HWsSm') _0x593596(), _0x2de116[_0x137a6f(0x59f)] = [], _0x100f70(); else { if (_0x29120e) { const _0x114d70 = _0x124e88(_0x38e69a[_0x137a6f(0x2df)]); _0x114d70 && (delete _0x114d70[_0x137a6f(0x9b8)], _0x31fa57(), _0x4975f7(_0x114d70['id'], _0x137a6f(0x388)), _0x2c99af(_0x137a6f(0x7d3)), _0x4cedda(!![])); } } } try { localStorage[_0x137a6f(0x758)]('chatHistory_' + _0x2bef10['id']); } catch (_0x86c51d) { _0x137a6f(0x44b) === 'YOnRc' ? _0x4bcfb2(_0x137a6f(0x59d)) : console[_0x137a6f(0x27b)](_0x137a6f(0xb06) + _0x2bef10['id'], _0x86c51d); } _0x15e83d('\x22' + _0x249512 + _0x137a6f(0xb8e)); } const _0x2a9e45 = document[_0x234a7d(0x8f3)](_0x234a7d(0x9ce)), _0x4f702f = document[_0x234a7d(0x8f3)](_0x234a7d(0x212)), _0x3b0117 = document[_0x234a7d(0x8f3)](_0x234a7d(0x54e)); _0x2a9e45['addEventListener'](_0x234a7d(0xbba), async () => { const _0x3459da = _0x234a7d; if (_0x3459da(0x376) !== 'nyiTL') _0x10dba9 += _0x3459da(0x7fc); else { _0xc9067c(!![], '正在打包数据，请稍候...'); const _0x3ec392 = []; try { const _0x4952c7 = { 'localStorageData': {}, 'indexedDBData': {}, 'indexedDBMusicData': [] }; for (let _0x23e66c = 0x0; _0x23e66c < localStorage[_0x3459da(0xaa7)]; _0x23e66c++) { const _0x2562a3 = localStorage[_0x3459da(0x64a)](_0x23e66c); if (_0x2562a3) _0x4952c7['localStorageData'][_0x2562a3] = localStorage['getItem'](_0x2562a3); } const _0xf79251 = await _0x361ce4, _0x2f86ae = _0xf79251['transaction'](_0x2ecade, _0x3459da(0x72d)), _0xf92dbf = _0x2f86ae['objectStore'](_0x2ecade), _0x260ca1 = await new Promise((_0x2cbdc4, _0x59c215) => { const _0x36d3af = _0x3459da, _0x1eae20 = _0xf92dbf[_0x36d3af(0x412)](); _0x1eae20['onsuccess'] = () => _0x2cbdc4(_0x1eae20[_0x36d3af(0x774)]), _0x1eae20[_0x36d3af(0x611)] = () => _0x59c215(_0x1eae20[_0x36d3af(0x27b)]); }); for (const _0x145b96 of _0x260ca1) { if (_0x145b96[_0x3459da(0x1d6)] instanceof Blob) try { _0x4952c7[_0x3459da(0x52b)][_0x145b96['id']] = await _0x32f36c(_0x145b96[_0x3459da(0x1d6)]); } catch (_0x38c658) { _0x3ec392[_0x3459da(0x8d9)](_0x145b96['id']); } } const _0xbbddae = _0xf79251[_0x3459da(0x6c0)](_0x3a8a19, 'readonly'), _0x2a5214 = _0xbbddae[_0x3459da(0x387)](_0x3a8a19), _0x411ad2 = await new Promise((_0x561ce2, _0x1ad3e9) => { const _0x28b30f = _0x3459da; if (_0x28b30f(0x87d) === 'lKrcA') _0x3b9c87[_0x28b30f(0x82c)] = _0x28b30f(0x4b4) + _0x585d7a + _0x28b30f(0x274); else { const _0x56e3d9 = _0x2a5214[_0x28b30f(0x412)](); _0x56e3d9['onsuccess'] = () => _0x561ce2(_0x56e3d9[_0x28b30f(0x774)]), _0x56e3d9[_0x28b30f(0x611)] = () => _0x1ad3e9(_0x56e3d9[_0x28b30f(0x27b)]); } }); for (const _0x18080c of _0x411ad2) { const _0xeb5656 = { ..._0x18080c }; _0x18080c['audio'] instanceof Blob && (_0x3459da(0x532) === _0x3459da(0x532) ? _0xeb5656[_0x3459da(0x417)] = await _0x32f36c(_0x18080c[_0x3459da(0x417)]) : _0x511ded[_0x3459da(0x3bf)](_0x51b530[_0x3459da(0xb35)](_0x3459da(0x4e8)))), _0x18080c[_0x3459da(0x43e)] instanceof Blob && (_0xeb5656[_0x3459da(0x43e)] = await _0x32f36c(_0x18080c[_0x3459da(0x43e)])), _0x4952c7['indexedDBMusicData'][_0x3459da(0x8d9)](_0xeb5656); } const _0x1173c0 = new Blob([JSON[_0x3459da(0x269)](_0x4952c7, null, 0x2)], { 'type': _0x3459da(0xa5d) }), _0x262f98 = URL['createObjectURL'](_0x1173c0), _0x3ef00b = document[_0x3459da(0xb35)]('a'), _0x4caf10 = new Date(), _0x4ebc37 = _0x4caf10['getFullYear']() + '-' + String(_0x4caf10[_0x3459da(0xbbb)]() + 0x1)[_0x3459da(0x6f9)](0x2, '0') + '-' + String(_0x4caf10[_0x3459da(0x6b8)]())[_0x3459da(0x6f9)](0x2, '0'); _0x3ef00b[_0x3459da(0x588)] = _0x262f98, _0x3ef00b[_0x3459da(0x74a)] = 'Noir_Backup_' + _0x4ebc37 + _0x3459da(0x6a0), document[_0x3459da(0xb43)][_0x3459da(0x3bf)](_0x3ef00b), _0x3ef00b[_0x3459da(0xbba)](), document['body'][_0x3459da(0x20a)](_0x3ef00b), URL[_0x3459da(0x83c)](_0x262f98), _0xc9067c(![]), _0x3ec392[_0x3459da(0xaa7)] > 0x0 ? _0x3459da(0x9f0) !== _0x3459da(0x3f3) ? _0x15e83d('导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a' + _0x3ec392['join']('\x0a')) : _0x5bc94e(_0x4ef5ac) : _0x3459da(0x9ed) === 'sdIsD' ? _0x15e83d(_0x3459da(0x76e)) : _0x3c413e[_0x3459da(0x3e0)][_0x3459da(0xab9)] = _0x3459da(0x896); } catch (_0xdc3219) { _0xc9067c(![]), console[_0x3459da(0x27b)](_0x3459da(0x81b), _0xdc3219), _0x15e83d(_0x3459da(0x1ef) + _0xdc3219[_0x3459da(0x722)]); } } }), _0x4f702f[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x109218 = _0x234a7d; _0x3b0117[_0x109218(0xbba)](); }), _0x2a4ce5[_0x234a7d(0x85f)]('click', _0x856a0), _0x3b0117[_0x234a7d(0x85f)]('change', _0x2cdecd => { const _0x28ff26 = _0x234a7d, _0x244ffa = _0x2cdecd[_0x28ff26(0x48e)]['files'][0x0]; if (!_0x244ffa) return; _0x2244b3(_0x28ff26(0x984))[_0x28ff26(0xad3)](_0x25adfc => { const _0x308960 = _0x28ff26; if (!_0x25adfc) { if (_0x308960(0x661) === _0x308960(0xb0e)) _0x52d7bf = _0x308960(0x34a), _0x3e4c11 = _0x308960(0x94e) + _0x3d5a7b + '\x0a```'; else { _0x3b0117[_0x308960(0xa35)] = ''; return; } } _0xc9067c(!![], '正在解析备份文件...'); const _0x25d15c = new FileReader(); _0x25d15c['onload'] = async _0x21172b => { const _0x5f2bc4 = _0x308960; if (_0x5f2bc4(0x4a5) === _0x5f2bc4(0x822)) _0x1dc413 = _0x40d4cd['getItem'](_0x5f2bc4(0xb7a) + _0x49f442[_0x5f2bc4(0xb7c)]); else try { if (_0x5f2bc4(0x277) !== _0x5f2bc4(0x277)) _0x3750d7[_0x5f2bc4(0x87b)] = _0x50fbc1['scrollHeight']; else { const _0x45d425 = JSON[_0x5f2bc4(0x57f)](_0x21172b[_0x5f2bc4(0x48e)][_0x5f2bc4(0x774)]); if (!_0x45d425[_0x5f2bc4(0x557)] || !_0x45d425['indexedDBData']) throw new Error(_0x5f2bc4(0x264)); _0xc9067c(!![], '正在准备图片数据...'); const _0x253b86 = await Promise[_0x5f2bc4(0x304)](Object[_0x5f2bc4(0xa8f)](_0x45d425[_0x5f2bc4(0x52b)])[_0x5f2bc4(0x7c6)](async _0x1593fc => { const _0x41946b = _0x5f2bc4, _0x18e7be = _0x45d425[_0x41946b(0x52b)][_0x1593fc]; if (typeof _0x18e7be === _0x41946b(0xa98) && _0x18e7be[_0x41946b(0x3df)](_0x41946b(0x2ba))) { if (_0x41946b(0x7fe) === 'SCOzA') { const _0x3b1035 = await _0x1639b4(_0x18e7be); return { 'id': _0x1593fc, 'blob': _0x3b1035 }; } else _0x19b0cd > _0x24fd19 && (_0xf14976 *= _0x29d5d8 / _0x321118, _0x54e8b3 = _0x584775); } return null; }))[_0x5f2bc4(0xad3)](_0x4acdaa => _0x4acdaa[_0x5f2bc4(0x3cf)](Boolean)), _0x4ffebe = []; if (_0x45d425[_0x5f2bc4(0x41b)]) { _0xc9067c(!![], '正在准备音乐数据...'); const _0x307382 = _0x45d425['indexedDBMusicData'][_0x5f2bc4(0x7c6)](async _0x4d5644 => { const _0x2a8229 = _0x5f2bc4; if (_0x2a8229(0x9ec) === _0x2a8229(0x289)) { const _0x5b89ab = _0x26ee6d['linkedWorldBookIds'][_0x2a8229(0x7c6)](_0x5876d0 => _0x2d0002[_0x2a8229(0x432)][_0x2a8229(0xa68)](_0x2bb325 => _0x2bb325['id'] === _0x5876d0))['filter'](_0x5dbb18)[_0x2a8229(0x7c6)](_0x309c02 => '\x0a##\x20世界书条目:\x20' + _0x309c02[_0x2a8229(0x499)] + '\x0a' + _0x309c02['content'])[_0x2a8229(0x6cf)](''); _0x5b89ab && (_0x3127f0 = '\x0a#\x20核心世界观设定(角色必须严格遵守)\x20\x0a' + _0x5b89ab); } else { const _0x37506f = { ..._0x4d5644 }; if (_0x4d5644[_0x2a8229(0x417)]) _0x37506f['audio'] = await _0x1639b4(_0x4d5644['audio']); if (_0x4d5644[_0x2a8229(0x43e)]) _0x37506f['cover'] = await _0x1639b4(_0x4d5644[_0x2a8229(0x43e)]); return _0x37506f; } }); _0x4ffebe[_0x5f2bc4(0x8d9)](...await Promise['all'](_0x307382)); } _0xc9067c(!![], _0x5f2bc4(0x1bc)), localStorage[_0x5f2bc4(0x25c)](); for (const _0x5bdb48 in _0x45d425[_0x5f2bc4(0x557)]) { localStorage['setItem'](_0x5bdb48, _0x45d425[_0x5f2bc4(0x557)][_0x5bdb48]); } _0xc9067c(!![], _0x5f2bc4(0xaec)); const _0x1a61ee = await _0x361ce4, _0xbefc39 = _0x1a61ee[_0x5f2bc4(0x6c0)]([_0x2ecade, _0x3a8a19, _0x26d9a8], _0x5f2bc4(0xae4)), _0x5910b5 = _0xbefc39[_0x5f2bc4(0x387)](_0x2ecade), _0x6cb117 = _0xbefc39[_0x5f2bc4(0x387)](_0x3a8a19), _0x1c5897 = _0xbefc39[_0x5f2bc4(0x387)](_0x26d9a8); _0x5910b5[_0x5f2bc4(0x25c)](), _0x6cb117['clear'](), _0x1c5897[_0x5f2bc4(0x25c)](), _0x253b86[_0x5f2bc4(0x201)](_0x1235fa => _0x5910b5[_0x5f2bc4(0xb30)](_0x1235fa)), _0x4ffebe[_0x5f2bc4(0x201)](_0x1ec759 => _0x6cb117[_0x5f2bc4(0xb30)](_0x1ec759)), await new Promise((_0x846306, _0x2d8841) => { const _0x10f04a = _0x5f2bc4; if (_0x10f04a(0x6ed) !== 'uOxxn') { const _0x4de3ad = _0x44ecb7[_0x10f04a(0xac8)](_0x10f04a(0x20d)); if (!_0x4de3ad) return; _0x4de3ad['id'] === _0x10f04a(0x5d0) ? _0x4f4188() : _0x22667a(); } else _0xbefc39[_0x10f04a(0x935)] = _0x846306, _0xbefc39[_0x10f04a(0x611)] = _0x346c9c => _0x2d8841(_0x346c9c['target']['error']); }), _0xc9067c(![]), _0x15e83d(_0x5f2bc4(0xa0f)), setTimeout(() => location['reload'](), 0x640); } } catch (_0x5f02dd) { _0x5f2bc4(0x578) === _0x5f2bc4(0x578) ? (_0xc9067c(![]), console[_0x5f2bc4(0x27b)](_0x5f2bc4(0x6bf), _0x5f02dd), _0x15e83d(_0x5f2bc4(0xb0d) + _0x5f02dd[_0x5f2bc4(0x722)])) : _0x12a380[_0x5f2bc4(0x1cd)] = '▶'; } finally { _0x3b0117[_0x5f2bc4(0xa35)] = ''; } }, _0x25d15c[_0x308960(0xa5b)](_0x244ffa); }); }); function _0x343ecc() { const _0x516b6e = _0x234a7d; _0x516b6e(0x359) !== 'JYxGW' ? (_0x1b7e37['stopPropagation'](), _0x4bf5e7()) : (_0x383772[_0x516b6e(0xa35)] = _0x2de116[_0x516b6e(0x1ba)]['endpoint'] || '', _0x1c14c0[_0x516b6e(0xa35)] = _0x2de116[_0x516b6e(0x1ba)][_0x516b6e(0x64a)] || '', _0x840d34[_0x516b6e(0xa35)] = _0x2de116[_0x516b6e(0x1ba)]['model'] || '', _0x261ca8[_0x516b6e(0xa35)] = String(_0x2de116[_0x516b6e(0x9d6)]?.['perChatContextLines'] ?? 0x64), document['getElementById']('api-provider')[_0x516b6e(0xa35)] = _0x2de116[_0x516b6e(0x1ba)][_0x516b6e(0xa59)] || _0x516b6e(0x39e)); } function _0x3aabf8() { const _0x49d97d = _0x234a7d; _0x2de116['apiSettings'][_0x49d97d(0x59b)] = _0x383772[_0x49d97d(0xa35)][_0x49d97d(0x44c)](), _0x2de116['apiSettings'][_0x49d97d(0x64a)] = _0x1c14c0['value'][_0x49d97d(0x44c)](), _0x2de116['apiSettings'][_0x49d97d(0x4b6)] = _0x840d34['value']['trim'](), _0x2de116[_0x49d97d(0x1ba)][_0x49d97d(0xa59)] = document[_0x49d97d(0x8f3)](_0x49d97d(0x501))[_0x49d97d(0xa35)]; const _0xa6fa13 = parseInt(_0x261ca8['value'], 0xa); _0x2de116[_0x49d97d(0x9d6)][_0x49d97d(0x6cd)] = Number[_0x49d97d(0x27a)](_0xa6fa13) && _0xa6fa13 > 0x0 ? _0xa6fa13 : 0x64, _0x2ca195(), _0x15e83d(_0x49d97d(0x929)); } function _0x3c963a() { const _0x5f2e9c = _0x234a7d; _0x5f2e9c(0x461) !== _0x5f2e9c(0x80a) ? (_0x51f03a[_0x5f2e9c(0xa35)] = _0x2de116[_0x5f2e9c(0xb88)][_0x5f2e9c(0x499)] || '', _0x8fa20c[_0x5f2e9c(0xa9c)] = _0x2de116[_0x5f2e9c(0xb88)][_0x5f2e9c(0x41d)] || _0x176655, _0x3dd35f[_0x5f2e9c(0xa35)] = _0x2de116['userProfile'][_0x5f2e9c(0x44a)] || '') : (_0x4f907d(_0x485aa1, { 'force': !![], 'delayMs': _0x3959c7 }), _0x40a193 += 0x1f4); } async function _0x49b7c5(_0x121611 = null) { const _0x54ef87 = _0x234a7d; if ('SwcTF' === _0x54ef87(0xb0f)) _0x3e4355[_0x54ef87(0x23c)](_0x4d49a, _0x186604[_0x54ef87(0x269)](_0x58acfc)); else { _0x2faf14(_0x54ef87(0x398), _0x23bb90); const _0x5a6605 = document['getElementById']('char-avatar-frame-url'), _0x31b181 = document[_0x54ef87(0x8f3)](_0x54ef87(0x9cc)), _0x57b3d9 = document[_0x54ef87(0xac8)](_0x54ef87(0x33e)); if (_0x121611) { if (_0x54ef87(0x524) !== _0x54ef87(0x658)) { const _0x4a5a28 = _0x2de116[_0x54ef87(0x393)][_0x54ef87(0xa68)](_0x35b4ba => _0x35b4ba['id'] === _0x121611); _0x5a6605['value'] = _0x4a5a28[_0x54ef87(0x51e)] || '', _0x31b181[_0x54ef87(0xa35)] = _0x4a5a28[_0x54ef87(0x849)] || ''; if (_0x57b3d9) _0x57b3d9[_0x54ef87(0x3e0)][_0x54ef87(0xaa3)] = _0x4a5a28[_0x54ef87(0x51e)] ? _0x54ef87(0x4c6) + _0x4a5a28[_0x54ef87(0x51e)] + '\x27)' : ''; } else { const _0x2c3606 = _0xaf21c0[_0x54ef87(0x59f)][_0x54ef87(0x3cf)](_0xdcccdc => _0xdcccdc['type'] === 'music' && _0xdcccdc[_0x54ef87(0x788)])[_0x54ef87(0x7c6)](_0x421a78 => ({ ..._0x421a78, 'source': _0x54ef87(0x780) })); _0x2eeb5e[_0x54ef87(0x8d9)](..._0x2c3606); } } else { _0x5a6605[_0x54ef87(0xa35)] = '', _0x31b181[_0x54ef87(0xa35)] = ''; if (_0x57b3d9) _0x57b3d9['style'][_0x54ef87(0xaa3)] = ''; } _0x5a6605['addEventListener']('input', () => { const _0x3fe050 = _0x54ef87; if (_0x57b3d9) _0x57b3d9[_0x3fe050(0x3e0)]['backgroundImage'] = _0x5a6605[_0x3fe050(0xa35)] ? _0x3fe050(0x4c6) + _0x5a6605[_0x3fe050(0xa35)] + '\x27)' : ''; }); const _0x44e9b1 = document[_0x54ef87(0x8f3)](_0x54ef87(0xafa)); _0x44e9b1[_0x54ef87(0x82c)] = '', _0x2de116[_0x54ef87(0x432)][_0x54ef87(0x201)](_0x7eb2e3 => { const _0x4fff19 = _0x54ef87, _0x4d1aff = document[_0x4fff19(0xb35)](_0x4fff19(0x4eb)); _0x4d1aff['innerHTML'] = _0x4fff19(0x5f2) + _0x7eb2e3['id'] + '\x22>\x20' + _0x7eb2e3[_0x4fff19(0x499)], _0x44e9b1[_0x4fff19(0x3bf)](_0x4d1aff); }), _0x58bad2(_0x54ef87(0x26f)), _0x3fc19f[_0x54ef87(0xa9c)] = _0x322703, _0x8f50fa[_0x54ef87(0xa35)] = '', _0x1d7d4d[_0x54ef87(0x3e0)][_0x54ef87(0xaa3)] = '', _0x240c1c[_0x54ef87(0xa35)] = '', _0x4896d4[_0x54ef87(0x3e0)]['backgroundImage'] = '', _0xef169c[_0x54ef87(0xa35)] = ''; const _0x33e87e = [_0x54ef87(0x388), _0x54ef87(0x629), _0x54ef87(0x6ee), _0x54ef87(0x4ff), _0x54ef87(0x627)]; _0x33e87e[_0x54ef87(0x201)](_0x181c57 => { const _0x452983 = _0x54ef87; document['getElementById'](_0x452983(0x33f) + _0x181c57 + _0x452983(0x314))[_0x452983(0x3e0)][_0x452983(0xaa3)] = '', document[_0x452983(0x8f3)]('char-edit-sprite-' + _0x181c57 + _0x452983(0x2f5))['value'] = ''; }); if (_0x121611) { const _0x43f69f = _0x2de116['characters'][_0x54ef87(0xa68)](_0x48328e => _0x48328e['id'] === _0x121611); if (!_0x43f69f) return; _0x25ea8e[_0x54ef87(0xa35)] = _0x43f69f['id'], _0x54bf44[_0x54ef87(0x1cd)] = '编辑角色', _0x4fa05a[_0x54ef87(0xa35)] = _0x43f69f['name'], _0x319a47[_0x54ef87(0xa35)] = _0x43f69f[_0x54ef87(0x9ff)], _0x3d01bf['value'] = _0x43f69f[_0x54ef87(0x44a)], document[_0x54ef87(0x8f3)](_0x54ef87(0x725))[_0x54ef87(0xa35)] = _0x43f69f[_0x54ef87(0xb58)] || ''; const _0x79f786 = _0x2de116[_0x54ef87(0x6b7)]['find'](_0x2b1778 => _0x2b1778[_0x54ef87(0x318)] === 'private' && _0x2b1778[_0x54ef87(0x6a3)][_0x54ef87(0x8db)](_0x121611)); document[_0x54ef87(0x8f3)](_0x54ef87(0x26f))[_0x54ef87(0xa35)] = _0x79f786?.[_0x54ef87(0x38d)] || _0x2de116[_0x54ef87(0xabe)]; try { const _0x57a602 = await _0x26239c('char_avatar_' + _0x43f69f['id']), _0x4f5086 = await _0x26239c(_0x54ef87(0x325) + _0x43f69f['id']), _0x37fb66 = await _0x26239c(_0x54ef87(0x949) + _0x43f69f['id']); _0x3fc19f['src'] = _0x57a602 ? URL[_0x54ef87(0x64d)](_0x57a602) : _0x43f69f[_0x54ef87(0x41d)] || _0x322703; if (_0x4f5086) _0x1d7d4d[_0x54ef87(0x3e0)][_0x54ef87(0xaa3)] = _0x54ef87(0x4c6) + URL[_0x54ef87(0x64d)](_0x4f5086) + '\x27)'; if (_0x37fb66) _0x4896d4[_0x54ef87(0x3e0)][_0x54ef87(0xaa3)] = _0x54ef87(0x4c6) + URL[_0x54ef87(0x64d)](_0x37fb66) + '\x27)'; for (const _0x4a95c4 of _0x33e87e) { const _0xeceb07 = await _0x26239c(_0x54ef87(0x84d) + _0x4a95c4 + '_' + _0x43f69f['id']); _0xeceb07 && (_0x54ef87(0xaf0) === _0x54ef87(0x8df) ? (_0x844642(), _0x16d8c2(_0x54ef87(0x428), _0x54ef87(0x7a0))) : document['getElementById'](_0x54ef87(0x33f) + _0x4a95c4 + _0x54ef87(0x314))[_0x54ef87(0x3e0)][_0x54ef87(0xaa3)] = _0x54ef87(0x4c6) + URL[_0x54ef87(0x64d)](_0xeceb07) + '\x27)'); } } catch (_0x266265) { _0x54ef87(0x990) === 'ZWPYu' ? _0x25f68a[_0x54ef87(0x8f3)]('user-post-image-input')[_0x54ef87(0xbba)]() : (console[_0x54ef87(0x27b)]('加载角色\x20' + _0x43f69f['id'] + _0x54ef87(0x331), _0x266265), _0x3fc19f['src'] = _0x43f69f['avatar'] || _0x322703); } _0x43f69f[_0x54ef87(0xae1)] && _0x44e9b1[_0x54ef87(0x672)](_0x54ef87(0x994))[_0x54ef87(0x201)](_0x368f87 => { const _0x2bc082 = _0x54ef87; if (_0x2bc082(0x830) !== _0x2bc082(0x830)) try { _0x267620[_0x7a2aa5] = _0x361dcf[_0x2bc082(0x57f)](_0x2071f8); } catch (_0x2ee999) { } else { if (_0x43f69f[_0x2bc082(0xae1)][_0x2bc082(0x8db)](_0x368f87[_0x2bc082(0xa35)])) _0x368f87[_0x2bc082(0x875)] = !![]; } }), _0xf41b65(); } else _0x25ea8e[_0x54ef87(0xa35)] = '', _0x54bf44[_0x54ef87(0x1cd)] = _0x54ef87(0x8bc), _0x4fa05a[_0x54ef87(0xa35)] = _0x54ef87(0x598) + (_0x2de116[_0x54ef87(0x393)][_0x54ef87(0xaa7)] + 0x1), _0x319a47[_0x54ef87(0xa35)] = '', _0x3d01bf[_0x54ef87(0xa35)] = '你是一个乐于助人的AI助手。', document['getElementById'](_0x54ef87(0x725))['value'] = '', _0xf41b65(); const _0x4f47dc = document[_0x54ef87(0x8f3)](_0x54ef87(0x725)); let _0x51a332 = document[_0x54ef87(0x8f3)](_0x54ef87(0x6c3)); if (!_0x51a332) { if (_0x54ef87(0x244) === _0x54ef87(0x244)) _0x51a332 = document['createElement']('style'), _0x51a332['id'] = _0x54ef87(0x6c3), document[_0x54ef87(0x373)][_0x54ef87(0x3bf)](_0x51a332); else { const _0x17df30 = _0x2722a7[_0x54ef87(0x6c0)](_0x5ca5dc, _0x54ef87(0x72d)), _0x195985 = _0x17df30[_0x54ef87(0x387)](_0x3c7260), _0x546bea = _0x195985[_0x54ef87(0xb5d)](_0x270402); _0x546bea['onsuccess'] = () => _0x1ad26b(_0x546bea[_0x54ef87(0x774)] ? _0x546bea['result'][_0x54ef87(0x1fa)] : null), _0x546bea['onerror'] = () => _0xb99851(_0x546bea[_0x54ef87(0x27b)]); } } const _0x48adcb = () => { const _0x2f156e = _0x54ef87, _0x56f239 = _0x4f47dc['value']; let _0x5187f2 = _0x56f239[_0x2f156e(0x915)](/\.bubble\.sent/g, '#bubble-preview-user')[_0x2f156e(0x915)](/\.bubble\.received/g, _0x2f156e(0x45e)); _0x51a332['innerHTML'] = _0x5187f2; }; _0x4f47dc['removeEventListener']('input', _0x48adcb), _0x4f47dc['addEventListener'](_0x54ef87(0x296), _0x48adcb), _0x48adcb(); } } async function _0x48bd39() { const _0x2e888f = _0x234a7d; if (_0x2e888f(0x466) !== _0x2e888f(0xab1)) { const _0x33c402 = _0x25ea8e[_0x2e888f(0xa35)]; if (!_0x33c402) { _0x15e83d(_0x2e888f(0x3ec)); return; } const _0x1c47d9 = _0x11feaf(_0x33c402); if (!_0x1c47d9) return; _0xc9067c(!![], _0x2e888f(0x9fc) + _0x1c47d9[_0x2e888f(0x499)] + _0x2e888f(0x7e1)); try { const _0x45ea0d = { 'type': 'NoirCharacterCard', 'version': 0x1, 'name': _0x1c47d9['name'], 'remark': _0x1c47d9[_0x2e888f(0x9ff)], 'persona': _0x1c47d9[_0x2e888f(0x44a)], 'bubbleCss': _0x1c47d9[_0x2e888f(0xb58)], 'avatar': null, 'sprites': {}, 'worldBooks': [] }, _0x125334 = await _0x26239c(_0x2e888f(0x5e0) + _0x1c47d9['id']); if (_0x125334) _0x45ea0d[_0x2e888f(0x41d)] = await _0x32f36c(_0x125334); const _0x2c56b2 = [_0x2e888f(0x388), _0x2e888f(0x629), _0x2e888f(0x6ee), _0x2e888f(0x4ff), _0x2e888f(0x627)]; for (const _0x1d2a0b of _0x2c56b2) { const _0x59c395 = await _0x26239c(_0x2e888f(0x84d) + _0x1d2a0b + '_' + _0x1c47d9['id']); _0x59c395 && (_0x2e888f(0x6e8) === 'AaXKn' ? (_0x97416e[_0x2e888f(0x3e0)][_0x2e888f(0xab9)] = _0x2e888f(0x1bf), _0x5bcec9[_0x2e888f(0x7a5)] = _0x25ef0e[_0x2e888f(0x7a5)] = _0x296ebc[_0x2e888f(0x7a5)] = null, _0x2edc0f[_0x2e888f(0x2f8)]('keydown', _0x13bb30), _0x4a58f8(_0x507237)) : _0x45ea0d['sprites'][_0x1d2a0b] = await _0x32f36c(_0x59c395)); } _0x1c47d9[_0x2e888f(0xae1)] && _0x1c47d9[_0x2e888f(0xae1)][_0x2e888f(0xaa7)] > 0x0 && (_0x45ea0d[_0x2e888f(0x432)] = _0x1c47d9[_0x2e888f(0xae1)][_0x2e888f(0x7c6)](_0x27500b => _0x2de116['worldBooks'][_0x2e888f(0xa68)](_0x2929e0 => _0x2929e0['id'] === _0x27500b))[_0x2e888f(0x3cf)](Boolean)['map'](_0x5e4c0d => ({ 'name': _0x5e4c0d[_0x2e888f(0x499)], 'content': _0x5e4c0d['content'] }))); const _0x232151 = new Blob([JSON[_0x2e888f(0x269)](_0x45ea0d, null, 0x2)], { 'type': _0x2e888f(0xa5d) }), _0x51f824 = URL['createObjectURL'](_0x232151), _0x342ddd = document[_0x2e888f(0xb35)]('a'); _0x342ddd['href'] = _0x51f824, _0x342ddd[_0x2e888f(0x74a)] = _0x1c47d9[_0x2e888f(0x499)] + _0x2e888f(0x964), document['body'][_0x2e888f(0x3bf)](_0x342ddd), _0x342ddd[_0x2e888f(0xbba)](), document[_0x2e888f(0xb43)][_0x2e888f(0x20a)](_0x342ddd), URL[_0x2e888f(0x83c)](_0x51f824); } catch (_0x612384) { console[_0x2e888f(0x27b)](_0x2e888f(0x699), _0x612384), _0x15e83d('导出失败了，哼:\x20' + _0x612384[_0x2e888f(0x722)]); } finally { _0xc9067c(![]); } } else _0x3ab6d1(_0x2e888f(0x1d7) + _0x5bc554[_0x2e888f(0x722)]); } async function _0x490124(_0x58880a) { const _0x300a55 = _0x234a7d; if ('siFJq' !== _0x300a55(0x287)) { const _0x5b091c = _0x43efad(_0x34b9f0[_0x300a55(0x6a3)][0x0]); return _0x5b091c?.[_0x300a55(0x499)] || 'AI'; } else { const _0x324b82 = _0x58880a[_0x300a55(0x48e)][_0x300a55(0x6f1)][0x0]; if (!_0x324b82) return; _0xc9067c(!![], _0x300a55(0x246)); const _0x344aa1 = new FileReader(); _0x344aa1[_0x300a55(0x759)] = async _0x4fc0d9 => { const _0x518fb9 = _0x300a55; try { const _0x10acc9 = JSON['parse'](_0x4fc0d9['target'][_0x518fb9(0x774)]); if (_0x10acc9[_0x518fb9(0x318)] !== _0x518fb9(0x922)) throw new Error(_0x518fb9(0x556)); const _0x438b26 = []; if (_0x10acc9[_0x518fb9(0x432)] && _0x10acc9['worldBooks'][_0x518fb9(0xaa7)] > 0x0) { if (_0x518fb9(0x2b9) !== _0x518fb9(0xb82)) for (const _0x223ab5 of _0x10acc9[_0x518fb9(0x432)]) { let _0x5f28cc = _0x2de116[_0x518fb9(0x432)][_0x518fb9(0xa68)](_0x153983 => _0x153983[_0x518fb9(0x499)] === _0x223ab5[_0x518fb9(0x499)]); if (_0x5f28cc) _0x438b26[_0x518fb9(0x8d9)](_0x5f28cc['id']); else { if ('KEEUn' !== 'KEEUn') _0x191e71[_0x518fb9(0x8f3)](_0x518fb9(0x475))[_0x518fb9(0xa9c)] = _0x530691['avatar'] || _0x1a5c9f; else { const _0x197a67 = { 'id': _0x518fb9(0x623) + Date[_0x518fb9(0x83b)]() + '_' + Math['random'](), 'name': _0x223ab5[_0x518fb9(0x499)], 'content': _0x223ab5['content'] }; _0x2de116['worldBooks'][_0x518fb9(0x8d9)](_0x197a67), _0x438b26[_0x518fb9(0x8d9)](_0x197a67['id']); } } } else { _0x415bb6[_0x518fb9(0x6e4)][_0xd7cd9] = null; if (_0x5b87ed === _0x518fb9(0x6a9)) _0x5a7c96[_0x518fb9(0x6e4)][_0x518fb9(0x472)] = null; _0x138cfb(); } } const _0x3b6267 = 'char_' + Date[_0x518fb9(0x83b)](), _0x158576 = { 'id': _0x3b6267, 'name': _0x10acc9['name'], 'remark': _0x10acc9[_0x518fb9(0x9ff)] || '', 'persona': _0x10acc9[_0x518fb9(0x44a)], 'avatar': _0x10acc9[_0x518fb9(0x41d)] || _0x322703, 'linkedWorldBookIds': _0x438b26, 'bubbleCss': _0x10acc9[_0x518fb9(0xb58)] || '' }; if (_0x10acc9['avatar']) { const _0x20f974 = await _0x1639b4(_0x10acc9[_0x518fb9(0x41d)]); await _0x1d2a3c(_0x518fb9(0x5e0) + _0x3b6267, _0x20f974); } if (_0x10acc9[_0x518fb9(0x34f)]) for (const _0x1afdad in _0x10acc9[_0x518fb9(0x34f)]) { const _0xd23ece = _0x10acc9[_0x518fb9(0x34f)][_0x1afdad], _0x3b050d = await _0x1639b4(_0xd23ece); await _0x1d2a3c(_0x518fb9(0x84d) + _0x1afdad + '_' + _0x3b6267, _0x3b050d); } _0x2de116[_0x518fb9(0x393)]['push'](_0x158576); const _0x414266 = { 'id': _0x518fb9(0x76a) + _0x3b6267, 'type': _0x518fb9(0x2c0), 'participantIds': [_0x3b6267], 'boundUserProfileId': _0x2de116[_0x518fb9(0xabe)] }; _0x2de116['chats'][_0x518fb9(0x8d9)](_0x414266), _0x2ca195(), _0x25e174(), _0x15e83d('“' + _0x158576[_0x518fb9(0x499)] + _0x518fb9(0x6bb)); } catch (_0x307abf) { if ('LBNQR' === 'cxAjj') { const _0x15f2a2 = new _0x7ee13d(_0x253bf6[_0x518fb9(0xa71)])[_0x518fb9(0x700)]('zh-CN', { 'hour': _0x518fb9(0x748), 'minute': _0x518fb9(0x748) }); _0x2f4e20[_0x518fb9(0x5e2)] && _0x16004a[_0x518fb9(0x8d9)]('[' + _0x15f2a2 + _0x518fb9(0x891) + _0x225abc(_0x313923) + ']\x20' + _0x380c53(_0x228357[_0x518fb9(0x5e2)])[_0x518fb9(0x44c)]()); } else console[_0x518fb9(0x27b)](_0x518fb9(0x414), _0x307abf), _0x15e83d(_0x518fb9(0x26c) + _0x307abf[_0x518fb9(0x722)]); } finally { 'kSRXk' === 'Qlqdj' ? (_0x3dce95['error'](_0x518fb9(0x593), _0x7830b5), _0x32511f = _0x1bfff9) : (_0xc9067c(![]), _0x58880a[_0x518fb9(0x48e)][_0x518fb9(0xa35)] = ''); } }, _0x344aa1[_0x300a55(0xa5b)](_0x324b82); } } async function _0x5c73b9() { const _0x9e6e28 = _0x234a7d, _0x218ba6 = _0x25ea8e[_0x9e6e28(0xa35)], _0x41f89c = document[_0x9e6e28(0x8f3)](_0x9e6e28(0x26f))['value'], _0x27c0ec = _0x8f50fa[_0x9e6e28(0x6f1)][0x0], _0x56e010 = _0x240c1c[_0x9e6e28(0x6f1)][0x0], _0x18ec7d = _0xef169c[_0x9e6e28(0x6f1)][0x0], _0x12adb8 = document[_0x9e6e28(0x672)]('#world-book-checkboxes-container\x20input:checked'), _0x3d3bc5 = Array[_0x9e6e28(0x426)](_0x12adb8)[_0x9e6e28(0x7c6)](_0x4bd4f1 => _0x4bd4f1[_0x9e6e28(0xa35)]), _0x31d6fa = { 'name': _0x4fa05a[_0x9e6e28(0xa35)][_0x9e6e28(0x44c)](), 'remark': _0x319a47[_0x9e6e28(0xa35)][_0x9e6e28(0x44c)](), 'persona': _0x3d01bf[_0x9e6e28(0xa35)][_0x9e6e28(0x44c)](), 'linkedWorldBookIds': _0x3d3bc5, 'bubbleCss': document[_0x9e6e28(0x8f3)](_0x9e6e28(0x725))[_0x9e6e28(0xa35)]['trim'](), 'avatarFrameUrl': document[_0x9e6e28(0x8f3)]('char-avatar-frame-url')[_0x9e6e28(0xa35)]['trim'](), 'userAvatarFrameUrl': document[_0x9e6e28(0x8f3)](_0x9e6e28(0x9cc))[_0x9e6e28(0xa35)][_0x9e6e28(0x44c)]() }; if (!_0x31d6fa['name']) { if ('ErGLE' !== 'pytIV') { _0x15e83d('名字不能为空！'); return; } else { const _0x344f0a = _0x1f9cbf[_0x9e6e28(0xa68)](_0x458ccd => _0x458ccd[_0x9e6e28(0x499)] === _0x2122b7[_0x9e6e28(0x499)]); if (_0x344f0a) _0x1104f6[_0x9e6e28(0x44f)](_0x16b360, { 'content': '[AI发送了表情：' + _0x344f0a['name'] + ']', 'displayUrl': _0x344f0a[_0x9e6e28(0xb77)] }); else _0x212dce['content'] = _0x9e6e28(0x2b1) + _0xe2b74a[_0x9e6e28(0x499)] + ']'; } } try { const _0xb65807 = [_0x9e6e28(0x388), _0x9e6e28(0x629), _0x9e6e28(0x6ee), _0x9e6e28(0x4ff), _0x9e6e28(0x627)]; let _0x1536b3 = _0x218ba6; if (_0x218ba6) { if ('fAmCH' === _0x9e6e28(0x3e1)) { const _0x385c17 = _0x9e6e28(0x76a) + _0x1ad526; _0x10c6f7(_0x385c17), _0x1236d7(!![]); } else { const _0x5dcdea = _0x2de116[_0x9e6e28(0x393)][_0x9e6e28(0xa68)](_0x637754 => _0x637754['id'] === _0x218ba6); _0x5dcdea && (_0x9e6e28(0x9dd) === _0x9e6e28(0x70e) ? _0x3544cc = _0x225f4f[_0x9e6e28(0x613)]['find'](_0x5ec3e2 => _0x5ec3e2['id'] === _0x4823a0[_0x9e6e28(0xabe)]) : Object[_0x9e6e28(0x44f)](_0x5dcdea, _0x31d6fa)); } } else { const _0x517ea2 = 'char_' + Date[_0x9e6e28(0x83b)](); _0x1536b3 = _0x517ea2; const _0x5ec598 = { 'id': _0x517ea2, ..._0x31d6fa }; _0x5ec598[_0x9e6e28(0x41d)] = _0x27c0ec ? await _0x55a8db(_0x27c0ec) : _0x322703, _0x2de116[_0x9e6e28(0x393)][_0x9e6e28(0x8d9)](_0x5ec598); const _0x5254ec = { 'id': 'chat_' + _0x517ea2, 'type': _0x9e6e28(0x2c0), 'participantIds': [_0x517ea2], 'listenTogetherSession': null }; _0x2de116[_0x9e6e28(0x6b7)][_0x9e6e28(0x8d9)](_0x5254ec); } const _0x4662eb = _0x2de116[_0x9e6e28(0x6b7)][_0x9e6e28(0xa68)](_0x4fc09e => _0x4fc09e[_0x9e6e28(0x318)] === _0x9e6e28(0x2c0) && _0x4fc09e[_0x9e6e28(0x6a3)][_0x9e6e28(0x8db)](_0x1536b3)); _0x4662eb && (_0x9e6e28(0xb65) === _0x9e6e28(0x8cd) ? (_0x39998d[_0x9e6e28(0xb7c)] = _0x1add1c['id'], _0x42dd13(), _0x252e6e(), _0x57ae3d(_0x482bce)) : _0x4662eb[_0x9e6e28(0x38d)] = _0x41f89c); if (_0x27c0ec) await _0x1d2a3c(_0x9e6e28(0x5e0) + _0x1536b3, _0x27c0ec); if (_0x56e010) await _0x1d2a3c(_0x9e6e28(0x325) + _0x1536b3, _0x56e010); if (_0x18ec7d) await _0x1d2a3c('char_offline_bg_' + _0x1536b3, _0x18ec7d); for (const _0x3f53ab of _0xb65807) { const _0x520e7d = document[_0x9e6e28(0x8f3)](_0x9e6e28(0x33f) + _0x3f53ab + _0x9e6e28(0x2f5))[_0x9e6e28(0x6f1)][0x0]; if (_0x520e7d) await _0x1d2a3c(_0x9e6e28(0x84d) + _0x3f53ab + '_' + _0x1536b3, _0x520e7d); } _0x2ca195(), _0x25e174(), _0x15e83d(_0x9e6e28(0x20f)), _0x2faf14(_0x9e6e28(0x780), _0x9e6e28(0x398)); if (!_0x218ba6) { const _0x1a3c96 = 'chat_' + _0x1536b3; _0x1816aa(_0x1a3c96), _0xe7cd49(!![]); } } catch (_0x22353a) { console[_0x9e6e28(0x27b)](_0x9e6e28(0xb85), _0x22353a), _0x15e83d(_0x9e6e28(0x310) + _0x22353a['message']); } } function _0x558306() { const _0x25fe63 = _0x234a7d; if (_0x25fe63(0x86b) === _0x25fe63(0x86b)) { _0x256a24[_0x25fe63(0xa35)] = '', _0x2ff5fb[_0x25fe63(0x82c)] = ''; if (_0x2de116[_0x25fe63(0x393)][_0x25fe63(0xaa7)] < 0x2) { _0x15e83d('需要至少2个角色才能创建群聊。'); return; } _0x2de116[_0x25fe63(0x393)][_0x25fe63(0x201)](_0x1d40c0 => { const _0x2668dd = _0x25fe63, _0x1c34fe = document[_0x2668dd(0xb35)]('li'); _0x1c34fe[_0x2668dd(0xaff)] = _0x2668dd(0x8ec), _0x1c34fe['innerHTML'] = _0x2668dd(0x38c) + _0x1d40c0['id'] + _0x2668dd(0x4c0) + _0x1d40c0['id'] + _0x2668dd(0x60d) + (_0x1d40c0[_0x2668dd(0x41d)] || _0x322703) + _0x2668dd(0x96c) + _0x1d40c0['id'] + _0x2668dd(0x811) + _0x1d40c0['name'] + _0x2668dd(0x92a), _0x2ff5fb[_0x2668dd(0x3bf)](_0x1c34fe); }), _0x2faf14('groupChatCreate', _0x25fe63(0x801)); } else _0x36ab43(_0x179b8d['id']), _0x205f5d(!![]); } function _0x5842fe() { const _0x3bb290 = _0x234a7d, _0xcfe8b1 = _0x256a24[_0x3bb290(0xa35)][_0x3bb290(0x44c)](); if (!_0xcfe8b1) { _0x15e83d('请输入群聊名称。'); return; } const _0x86a973 = Array[_0x3bb290(0x426)](_0x2ff5fb[_0x3bb290(0x672)](_0x3bb290(0x812)))['map'](_0x5dda08 => _0x5dda08[_0x3bb290(0xb40)]['id']); if (_0x86a973[_0x3bb290(0xaa7)] < 0x2) { _0x15e83d(_0x3bb290(0xaa8)); return; } const _0xf22d58 = { 'id': _0x3bb290(0xb5e) + Date[_0x3bb290(0x83b)](), 'type': 'group', 'name': _0xcfe8b1, 'participantIds': _0x86a973 }; _0x2de116['chats'][_0x3bb290(0x8d9)](_0xf22d58), _0x2de116[_0x3bb290(0xb7c)] = _0xf22d58['id'], _0x2ca195(), _0x25e174(), _0x4214ca(), _0x576acc(), _0x15e83d('群聊“' + _0xcfe8b1 + _0x3bb290(0x508)), _0x2faf14('chat', 'groupChatCreate'); } _0x6544fb[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0x4d7ca5[_0x234a7d(0xbba)]()), _0x16e940[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x4d56de), _0x4d7ca5[_0x234a7d(0x85f)](_0x234a7d(0x69c), _0x382430), _0x3031bb[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x20a6bc), _0x2c39b5[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0x391ef6[_0x234a7d(0x51c)]['remove']('show')), _0x207d33['addEventListener'](_0x234a7d(0xbba), () => _0x391ef6[_0x234a7d(0x51c)][_0x234a7d(0x2e4)](_0x234a7d(0x530))), _0x109f46[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x10fae0 = _0x234a7d; _0x10fae0(0x457) === _0x10fae0(0x457) ? (_0x3d9d9e[_0x10fae0(0x696)](), navigator[_0x10fae0(0x729)][_0x10fae0(0x979)](_0x3d9d9e[_0x10fae0(0xa35)])['then'](() => { const _0x4d6ae1 = _0x10fae0; _0x15e83d(_0x4d6ae1(0x429)); })['catch'](_0x59532b => { const _0x4a9de7 = _0x10fae0; 'pouZT' === 'onNhF' ? _0x4a131d = _0x5dcec3[_0x4a9de7(0x68e)](..._0x27255d['posts']['map'](_0x329d9c => _0x329d9c[_0x4a9de7(0xa71)])) : _0x15e83d(_0x4a9de7(0x482)); })) : _0x39aa53 = _0x596e2a[_0x10fae0(0x499)]; }), _0x290a53[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x533996), _0x401adc[_0x234a7d(0x85f)]('click', _0x4f0d67), _0x473d13[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0xc92be5['classList'][_0x234a7d(0x2e4)](_0x234a7d(0x530))), _0x590fc3[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0xc92be5[_0x234a7d(0x51c)][_0x234a7d(0x2e4)](_0x234a7d(0x530))), _0x1d7d4d['addEventListener']('click', () => _0x240c1c[_0x234a7d(0xbba)]()), _0x4896d4[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0xef169c['click']()), _0x240c1c['addEventListener'](_0x234a7d(0x69c), _0x4be6e5 => { const _0x1250a4 = _0x234a7d, _0x1b94fb = _0x4be6e5[_0x1250a4(0x48e)][_0x1250a4(0x6f1)][0x0]; if (!_0x1b94fb) return; const _0x439b6a = URL[_0x1250a4(0x64d)](_0x1b94fb); _0x1d7d4d[_0x1250a4(0x3e0)][_0x1250a4(0xaa3)] = _0x1250a4(0x4c6) + _0x439b6a + '\x27)'; }), _0xef169c[_0x234a7d(0x85f)]('change', _0x2ce275 => { const _0x34cd7b = _0x234a7d; if ('EtoPJ' === _0x34cd7b(0xba8)) { const _0x43e0c5 = _0x2ce275[_0x34cd7b(0x48e)][_0x34cd7b(0x6f1)][0x0]; if (!_0x43e0c5) return; const _0x3f5d86 = URL['createObjectURL'](_0x43e0c5); _0x4896d4[_0x34cd7b(0x3e0)][_0x34cd7b(0xaa3)] = _0x34cd7b(0x4c6) + _0x3f5d86 + '\x27)'; } else _0x454fb7[_0x34cd7b(0x758)](_0x34cd7b(0xbb0)), _0x4437e7(), _0x468440('动态页背景已移除。'); }), _0x524321[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0x20bcf7[_0x234a7d(0xbba)]()), _0x195d35[_0x234a7d(0x85f)]('click', () => { const _0x166324 = _0x234a7d; localStorage[_0x166324(0x758)](_0x166324(0xbb0)), _0x58fef2(), _0x15e83d(_0x166324(0x908)); }), _0x20bcf7[_0x234a7d(0x85f)](_0x234a7d(0x69c), async _0xf9343a => { const _0x55eb22 = _0x234a7d, _0x19f6b8 = _0xf9343a[_0x55eb22(0x48e)]['files'][0x0]; if (!_0x19f6b8) return; try { if ('ZQLra' === _0x55eb22(0x4c1)) _0x3cc6b5[_0x55eb22(0x27b)](_0x55eb22(0x699), _0x453d2f), _0x3c2c0a(_0x55eb22(0x694) + _0x226cf0['message']); else { const _0x26571f = await _0x55a8db(_0x19f6b8); localStorage['setItem'](_0x55eb22(0xbb0), _0x26571f), _0x58fef2(), _0x15e83d(_0x55eb22(0xba4)); } } catch (_0x25ab87) { 'ZRRRV' !== _0x55eb22(0xa11) ? _0x15e83d(_0x55eb22(0xbb1) + _0x25ab87[_0x55eb22(0x722)]) : _0x580ffd = _0x55eb22(0x343) + _0x2da45e; } }), document[_0x234a7d(0x8f3)]('back-to-chat-from-group-settings')['addEventListener'](_0x234a7d(0xbba), () => _0x2faf14(_0x234a7d(0x780), _0x234a7d(0x9e7))), document[_0x234a7d(0x8f3)](_0x234a7d(0x697))[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x1f9286); const _0x4f6f1d = document[_0x234a7d(0x8f3)]('group-avatar-preview'), _0x404e59 = document[_0x234a7d(0x8f3)](_0x234a7d(0x75b)); _0x4f6f1d[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0x404e59[_0x234a7d(0xbba)]()), _0x404e59[_0x234a7d(0x85f)](_0x234a7d(0x69c), _0x3e1c73 => { const _0x1a4393 = _0x234a7d, _0x208a94 = _0x3e1c73['target'][_0x1a4393(0x6f1)][0x0]; if (!_0x208a94) return; const _0x3753f4 = URL[_0x1a4393(0x64d)](_0x208a94); _0x4f6f1d[_0x1a4393(0xa9c)] = _0x3753f4, _0x4f6f1d[_0x1a4393(0x759)] = () => { const _0x32ae6e = _0x1a4393; _0x32ae6e(0xb2a) === _0x32ae6e(0xb2a) ? URL[_0x32ae6e(0x83c)](_0x3753f4) : _0x90c4ca[_0x32ae6e(0xbba)](); }; }); const _0x48eca0 = document[_0x234a7d(0x8f3)](_0x234a7d(0x8f4))['parentElement'], _0x352205 = document[_0x234a7d(0x8f3)](_0x234a7d(0x768)), _0x55564b = document[_0x234a7d(0x8f3)](_0x234a7d(0x8f4)); _0x48eca0[_0x234a7d(0x85f)]('click', () => _0x352205[_0x234a7d(0xbba)]()), _0x352205[_0x234a7d(0x85f)](_0x234a7d(0x69c), _0xb12089 => { const _0x948ada = _0x234a7d, _0x4d8c2c = _0xb12089[_0x948ada(0x48e)][_0x948ada(0x6f1)][0x0]; if (!_0x4d8c2c) return; const _0x2662b4 = URL[_0x948ada(0x64d)](_0x4d8c2c); document[_0x948ada(0x8f3)](_0x948ada(0x8f4))[_0x948ada(0x3e0)][_0x948ada(0xaa3)] = _0x948ada(0x4c6) + _0x2662b4 + '\x27)'; }); const _0x484dbd = document['querySelector'](_0x234a7d(0x82f)), _0x32c4a3 = document['getElementById'](_0x234a7d(0xb03)); _0x484dbd[_0x234a7d(0x85f)]('click', _0x3720fb => { const _0x50fa88 = _0x234a7d; if (_0x50fa88(0x4cf) === _0x50fa88(0x818)) { const _0x3f26f0 = { 'id': 'wb_' + _0x3a86bd['now'](), 'name': _0x4b29ee, 'content': _0x2218f5 }; _0x8a76bc[_0x50fa88(0x432)][_0x50fa88(0x8d9)](_0x3f26f0); } else _0x3720fb['stopPropagation'](), _0x32c4a3[_0x50fa88(0x51c)][_0x50fa88(0x440)](_0x50fa88(0x973)), _0x484dbd[_0x50fa88(0x51c)][_0x50fa88(0x440)](_0x50fa88(0x632)); }), _0x32c4a3['addEventListener'](_0x234a7d(0x69c), _0x44f09b), document[_0x234a7d(0x8f3)](_0x234a7d(0x53f))[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x8f9eec), document['getElementById'](_0x234a7d(0xbb2))[_0x234a7d(0x85f)](_0x234a7d(0xbba), async () => { const _0x4a73c6 = _0x234a7d, _0xcdee2d = _0x231de4(); if (!_0xcdee2d || _0xcdee2d[_0x4a73c6(0x318)] !== _0x4a73c6(0x366)) return; const _0x38945d = await _0x2244b3(_0x4a73c6(0x28b) + _0xcdee2d['name'] + _0x4a73c6(0x460)); _0x38945d && (_0xac6adb(_0xcdee2d['id']), _0x15e83d('群聊已解散。'), _0x2faf14(_0x4a73c6(0x780)), _0xe7cd49(![])); }); const _0x2f3552 = document[_0x234a7d(0xac8)](_0x234a7d(0x5e9)), _0x528eff = document[_0x234a7d(0x8f3)](_0x234a7d(0xafa)); _0x2f3552[_0x234a7d(0x85f)]('click', _0x2f8eb1 => { const _0x5e4b49 = _0x234a7d; _0x5e4b49(0x9e5) !== _0x5e4b49(0xb5f) ? (_0x2f8eb1[_0x5e4b49(0x260)](), _0x528eff['classList'][_0x5e4b49(0x440)]('visible'), _0x2f3552[_0x5e4b49(0x51c)][_0x5e4b49(0x440)](_0x5e4b49(0x632))) : _0x42bf3c[_0x5e4b49(0x27b)](_0x5e4b49(0x5b4), _0x2ff020); }), _0x528eff[_0x234a7d(0x85f)](_0x234a7d(0x69c), _0xf41b65), document[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x53270a => { const _0x2750e3 = _0x234a7d; !document[_0x2750e3(0xac8)](_0x2750e3(0x438))[_0x2750e3(0x56f)](_0x53270a[_0x2750e3(0x48e)]) && (_0x528eff[_0x2750e3(0x51c)]['remove'](_0x2750e3(0x973)), _0x2f3552[_0x2750e3(0x51c)][_0x2750e3(0x2e4)](_0x2750e3(0x632))); }), _0x46e026[_0x234a7d(0x85f)]('click', () => { const _0x2e59f8 = _0x234a7d; _0xe6476b(), _0x2faf14(_0x2e59f8(0x428), _0x2e59f8(0x4ab)); }), document[_0x234a7d(0x8f3)](_0x234a7d(0x3d6))['addEventListener'](_0x234a7d(0xbba), () => _0x2faf14(_0x234a7d(0x4ab), 'worldBook')), document[_0x234a7d(0x8f3)](_0x234a7d(0xb19))['addEventListener'](_0x234a7d(0xbba), () => _0x243c1f()), document[_0x234a7d(0x8f3)]('back-to-world-book-list')['addEventListener'](_0x234a7d(0xbba), () => { const _0x441065 = _0x234a7d; if (_0x441065(0x9ef) === _0x441065(0x9ef)) _0xe6476b(), _0x2faf14(_0x441065(0x428), _0x441065(0x7a0)); else { const _0x571e65 = _0x39e88c['senderId'] || _0x42bbd6?.[_0x441065(0x6a3)][0x0], _0x1cc74e = _0x47b9c7(_0x571e65); _0x9e7db = _0x1cc74e ? _0x1cc74e[_0x441065(0x499)] : '角色'; } }), document[_0x234a7d(0x8f3)](_0x234a7d(0xb66))[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x30f0f0), document['getElementById'](_0x234a7d(0x710))[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x52f02e), _0x5f4fef['addEventListener'](_0x234a7d(0xbba), () => _0x2faf14(_0x234a7d(0xa70), 'home')), _0x221ea7[_0x234a7d(0x85f)]('click', () => _0x2faf14(_0x234a7d(0x4ab), 'wallpaper')), _0x2c35db[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0x4b8919[_0x234a7d(0xbba)]()), _0x4b8919['addEventListener'](_0x234a7d(0x69c), async _0x3d9fb0 => { const _0xa11583 = _0x234a7d, _0x47688b = _0x3d9fb0['target'][_0xa11583(0x6f1)][0x0]; if (!_0x47688b) return; await _0x489f28(_0x47688b); }), _0x22490a[_0x234a7d(0x85f)]('click', () => { const _0x5430e = _0x234a7d; _0x25e174(), _0x2faf14(_0x5430e(0x780), 'home'); }), _0x41e4b4[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x4abd2c = _0x234a7d; _0x343ecc(); const _0x36fe96 = (_0x2de116[_0x4abd2c(0x1ba)][_0x4abd2c(0x59b)] || '')[_0x4abd2c(0x8db)](_0x6ebfdd); _0x3b28d8[_0x4abd2c(0x4f8)] = _0x36fe96, _0x2faf14('settings', _0x4abd2c(0x4ab)); }), _0x136402[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0x2faf14(_0x234a7d(0x4ab), _0x234a7d(0x37b))), _0x4555c6['addEventListener']('click', () => { const _0x424716 = _0x234a7d; _0x593596(), _0x2faf14(_0x424716(0x4ab), 'chat'); }), _0x427ae9['addEventListener'](_0x234a7d(0xbba), () => { const _0x1c2592 = _0x234a7d; if (_0x1c2592(0x7c4) !== _0x1c2592(0x7c4)) return { 'type': 'create_event', 'eventType': _0x4cd6f0[0x1]['trim'](), 'eventDate': _0x35c186[0x2][_0x1c2592(0x44c)](), 'eventContent': _0x2fd63c[0x3][_0x1c2592(0x44c)]() }; else _0x593596(), _0xe7cd49(![]); }), _0x3617b0[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x525df4 = _0x234a7d; _0x2faf14('chat', _0x525df4(0x398)); }), _0x4cdb76[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x413300 = _0x234a7d; _0x413300(0x28c) === 'JwPXP' ? _0x40e9d9[_0x413300(0x51c)][_0x413300(0x6dd)](_0x413300(0x530)) : _0x23fbd9[_0x413300(0x23c)](_0x498106, _0x5e5fd8[_0x413300(0x557)][_0xadd50e]); }), _0x58f6b8[_0x234a7d(0x85f)]('click', () => _0x202e51()), _0x217e80[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x525b8d); function _0x5bb0f6(_0x51fcd3) { const _0x241c27 = _0x234a7d; if ('KoGRX' !== _0x241c27(0x799)) _0x5b18b7[_0x241c27(0x8d9)]({ 'role': 'user', 'content': _0x48f4ac }), _0x25e6bc[_0x241c27(0x8d9)]({ 'role': _0x241c27(0x1f4), 'content': _0x241c27(0x68a) }); else { if (!_0x51fcd3 || _0x51fcd3['type'] !== _0x241c27(0x366)) return; const _0x3ac779 = _0x241c27(0x8a0); document['body'][_0x241c27(0xa8c)](_0x241c27(0x7cf), _0x3ac779); const _0x152c3b = document['getElementById']('group-options-modal'), _0x1a7bec = _0x152c3b[_0x241c27(0xac8)]('.choice-modal-backdrop'), _0x3120b5 = document[_0x241c27(0x8f3)](_0x241c27(0x8d2)), _0x34029f = document[_0x241c27(0x8f3)](_0x241c27(0xb73)), _0x716af6 = document[_0x241c27(0x8f3)]('group-edit-name'), _0x27b1d1 = document['getElementById'](_0x241c27(0xac3)), _0x65ee76 = document[_0x241c27(0x8f3)]('group-options-cancel'), _0x4bbd1c = () => _0x152c3b[_0x241c27(0x2e4)](); _0x3120b5[_0x241c27(0x85f)](_0x241c27(0xbba), async () => { const _0x21faf3 = _0x241c27; if (_0x21faf3(0x211) !== _0x21faf3(0x211)) { if (_0x4dc3a0 < 0x0 || _0x1ab604 >= _0xf06b07) return; _0x2b2244[_0x21faf3(0x3e0)][_0x21faf3(0x8f2)] = 'translateX(-' + _0x4c8d20 * (0x64 / _0x511faa) + '%)', _0x359e47['forEach'](_0x31ad80 => _0x31ad80['classList'][_0x21faf3(0x2e4)]('active')), _0x44a918[_0x50901c][_0x21faf3(0x51c)][_0x21faf3(0x6dd)](_0x21faf3(0x8e0)), _0x3f1347 = _0x58167b, _0x494509 === 0x0 ? _0x17917f[_0x21faf3(0x3e0)][_0x21faf3(0xab9)] = _0x21faf3(0x1bf) : _0x165537[_0x21faf3(0x3e0)][_0x21faf3(0xab9)] = 'flex'; } else { _0x4bbd1c(); const _0x2cf670 = await _0x2244b3('确定要清空群聊\x22' + _0x51fcd3[_0x21faf3(0x499)] + _0x21faf3(0x9ba)); if (_0x2cf670) { if (_0x21faf3(0x291) === _0x21faf3(0x291)) { _0x51fcd3['id'] === _0x2de116[_0x21faf3(0xb7c)] && (_0x593596(), _0x2de116[_0x21faf3(0x59f)] = [], _0x100f70()); try { 'sbbUz' !== _0x21faf3(0xacf) ? (localStorage[_0x21faf3(0x758)]('chatHistory_' + _0x51fcd3['id']), _0x15e83d(_0x21faf3(0x5ab) + _0x51fcd3['name'] + _0x21faf3(0xb8e))) : _0x3ab000 += _0x44a690['parse'](_0x522c1d)[_0x21faf3(0xbae)][0x0][_0x21faf3(0x5e2)][_0x21faf3(0x50f)][0x0][_0x21faf3(0x5bd)]; } catch (_0x110366) { console['error'](_0x21faf3(0xa97) + _0x51fcd3['id'], _0x110366), _0x15e83d(_0x21faf3(0xa48)); } } else { _0x480f16(_0x21faf3(0x5ed)); return; } } } }), _0x34029f['addEventListener'](_0x241c27(0xbba), () => { const _0x1152ad = _0x241c27; _0x1152ad(0x36b) === _0x1152ad(0x36b) ? (_0x4bbd1c(), _0x15e83d('编辑群成员功能正在开发中...')) : (_0x1a2133['activeChatId'] = _0x3e315f[_0x1152ad(0x6b7)][0x0]?.['id'] || null, _0xc534ab(_0x52b83d[_0x1152ad(0xb7c)])); }), _0x716af6[_0x241c27(0x85f)](_0x241c27(0xbba), async () => { const _0x21e553 = _0x241c27; if (_0x21e553(0xb48) === 'ErDNZ') { const _0x23d9a4 = _0x32cd61['transaction'](_0x51cb11, 'readwrite'), _0x1879c0 = _0x23d9a4[_0x21e553(0x387)](_0x479de6), _0x54b26e = _0x1879c0[_0x21e553(0xb30)](_0x272404); _0x54b26e['onsuccess'] = () => _0x5e6b5f(_0x54b26e[_0x21e553(0x774)]), _0x54b26e['onerror'] = () => _0x4f4fab(_0x54b26e[_0x21e553(0x27b)]); } else { _0x4bbd1c(); const _0x3e2047 = prompt(_0x21e553(0x3d7), _0x51fcd3[_0x21e553(0x499)]); if (_0x3e2047 && _0x3e2047[_0x21e553(0x44c)]() && _0x3e2047 !== _0x51fcd3[_0x21e553(0x499)]) { if (_0x21e553(0x3a6) === _0x21e553(0x3a6)) _0x51fcd3[_0x21e553(0x499)] = _0x3e2047[_0x21e553(0x44c)](), _0x2ca195(), _0x25e174(), _0x4214ca(), _0x15e83d('群名称已更改为\x22' + _0x51fcd3[_0x21e553(0x499)] + '\x22。'); else { const _0x17b352 = _0x385abe[_0x21e553(0xb35)](_0x21e553(0x4eb)); _0x17b352['innerHTML'] = '<input\x20type=\x22checkbox\x22\x20value=\x22' + _0x5d8bf2['id'] + _0x21e553(0x29e) + _0x39e238['name'], _0x5eca07[_0x21e553(0x3bf)](_0x17b352); } } } }), _0x27b1d1[_0x241c27(0x85f)](_0x241c27(0xbba), async () => { const _0x4f1edf = _0x241c27; _0x4bbd1c(); const _0x2ce97f = await _0x2244b3('确定要删除群聊\x22' + _0x51fcd3[_0x4f1edf(0x499)] + _0x4f1edf(0x3e4)); _0x2ce97f && (_0xac6adb(_0x51fcd3['id']), _0x15e83d(_0x4f1edf(0x5ab) + _0x51fcd3['name'] + _0x4f1edf(0x383)), _0xe7cd49(![])); }), _0x1a7bec[_0x241c27(0x85f)]('click', _0x4bbd1c), _0x65ee76[_0x241c27(0x85f)](_0x241c27(0xbba), _0x4bbd1c); } } _0x4acb3a[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x3327f5 = _0x234a7d, _0x2ced2e = _0x231de4(); if (_0x2ced2e && _0x2ced2e[_0x3327f5(0x318)] === _0x3327f5(0x2c0)) _0x49b7c5(_0x2ced2e['participantIds'][0x0]); else _0x2ced2e && _0x2ced2e[_0x3327f5(0x318)] === _0x3327f5(0x366) && _0x5d6c78(_0x2ced2e['id']); }), _0x300b76[_0x234a7d(0x85f)]('keydown', _0x139911 => { const _0x2efbe6 = _0x234a7d; _0x139911[_0x2efbe6(0x64a)] === _0x2efbe6(0xb56) && !_0x139911[_0x2efbe6(0x283)] && (_0x139911[_0x2efbe6(0xb16)](), _0x202e51()); }); const _0x3967b5 = () => _0x40e9d9[_0x234a7d(0x51c)]['remove'](_0x234a7d(0x530)); _0x304613['addEventListener']('click', _0x3967b5), _0x36157f['addEventListener'](_0x234a7d(0xbba), _0x3967b5), _0x2fb68d['addEventListener'](_0x234a7d(0xbba), () => { const _0x22ce97 = _0x234a7d; if (_0x22ce97(0x97d) !== _0x22ce97(0xba9)) _0x3967b5(), _0x49b7c5(); else { if (!_0x2a34ae || !_0x4fc126[_0x22ce97(0x8db)](',')) return _0xcc2cd7; const _0x5513b5 = _0x4f1111[_0x22ce97(0x500)](',')[_0x22ce97(0x7c6)](_0x2d5da1 => _0x2d5da1['trim']()); return _0x5513b5[_0x24695d['floor'](_0x180f72[_0x22ce97(0x77b)]() * _0x5513b5[_0x22ce97(0xaa7)])]; } }), _0x3252fd['addEventListener']('click', () => { const _0x1c56ac = _0x234a7d; if (_0x1c56ac(0x736) !== _0x1c56ac(0x736)) { _0x1f0a01['activeChatId'] = null, _0x89708c(), _0x35fe23(![]), _0x432a39[_0x1c56ac(0x8f3)](_0x1c56ac(0x79a))[_0x1c56ac(0x3e0)][_0x1c56ac(0xaa3)] = ''; return; } else _0x3967b5(), _0x558306(); }), _0x32eba[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x5dcb29 = _0x234a7d; if ('YJYSd' === _0x5dcb29(0x76f)) { const _0x988c7e = _0x5b5b53[_0x5dcb29(0x586)](), _0x37eb31 = _0x464d85[_0x5dcb29(0x586)](); if (_0x988c7e['startsWith']('claude')) return _0x5dcb29(0x9b1); if (_0x37eb31[_0x5dcb29(0x8db)](_0x5dcb29(0xb5b))) return _0x5dcb29(0x9b1); if (_0x37eb31['includes'](_0x5dcb29(0x7ac))) return _0x5dcb29(0x986); if (_0x988c7e['startsWith'](_0x5dcb29(0x986))) return _0x5dcb29(0x986); return _0x5dcb29(0x39e); } else _0x2faf14(_0x5dcb29(0x780), _0x5dcb29(0x8f1)), _0xe7cd49(![]); }), _0x2b7d39[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x5842fe), _0x3fb42d['addEventListener'](_0x234a7d(0xbba), () => { const _0xaf8c1b = _0x234a7d; _0xeffd8[_0xaf8c1b(0x51c)][_0xaf8c1b(0x440)](_0xaf8c1b(0x530)); if (_0xeffd8['classList']['contains'](_0xaf8c1b(0x530))) { if (_0xaf8c1b(0x265) !== _0xaf8c1b(0x265)) { const _0x53cfcd = _0x37fc48['createElement'](_0xaf8c1b(0x4e8)); _0x53cfcd['className'] = 'calendar-day'; const _0x535bec = _0x5b6263 + '-' + _0x2e4715(_0x2f116e + 0x1)[_0xaf8c1b(0x6f9)](0x2, '0') + '-' + _0x40f3c5(_0x525f3c)[_0xaf8c1b(0x6f9)](0x2, '0'); if (_0x535bec === _0x563589) _0x53cfcd[_0xaf8c1b(0x51c)][_0xaf8c1b(0x6dd)]('is-today'); if (_0x535bec === _0x2df05d['selectedDate']) _0x53cfcd[_0xaf8c1b(0x51c)]['add'](_0xaf8c1b(0x4dc)); const _0x7fd103 = _0x53eca1[_0xaf8c1b(0xb35)](_0xaf8c1b(0xa52)); _0x7fd103[_0xaf8c1b(0xaff)] = _0xaf8c1b(0x32e), _0x7fd103['textContent'] = _0x1bffc4, _0x53cfcd[_0xaf8c1b(0x3bf)](_0x7fd103); const _0x2e7939 = _0x541191[_0xaf8c1b(0x207)][_0xaf8c1b(0x3cf)](_0x3d4685 => _0x3d4685['date'] === _0x535bec); if (_0x2e7939['length'] > 0x0) { const _0x4355fd = _0x11c51d[_0xaf8c1b(0xb35)]('div'); _0x4355fd[_0xaf8c1b(0xaff)] = _0xaf8c1b(0xada), _0x53cfcd['appendChild'](_0x4355fd); } _0x53cfcd[_0xaf8c1b(0x85f)](_0xaf8c1b(0xbba), () => { const _0x30809f = _0xaf8c1b; _0x6c6893[_0x30809f(0x7ea)] = _0x535bec, _0x3d41dd(); }), _0x4beb94[_0xaf8c1b(0x3bf)](_0x53cfcd); } else _0x2615a1[_0xaf8c1b(0x87b)] = _0x2615a1[_0xaf8c1b(0x7ed)]; } }), _0x4810e7['addEventListener'](_0x234a7d(0xbba), () => _0x33dfd0['click']()); const _0x2fe92e = document[_0x234a7d(0x8f3)](_0x234a7d(0x3dc)); _0x33dfd0[_0x234a7d(0x85f)]('change', _0x3bd428), _0x2fe92e[_0x234a7d(0x85f)]('click', _0x193dc7), _0x5efa8[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x3aabf8), _0xc49eba['addEventListener']('click', _0x251ebe), _0x261ab0[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x5c73b9), _0x15d735['addEventListener'](_0x234a7d(0xbba), _0x8f9eec), _0x13802a[_0x234a7d(0x85f)](_0x234a7d(0xbba), async () => { const _0x2f9bba = _0x234a7d; if (_0x2f9bba(0x9f8) === _0x2f9bba(0x9f8)) { const _0x1b1138 = _0x25ea8e[_0x2f9bba(0xa35)]; if (!_0x1b1138) return; const _0x43261f = _0x11feaf(_0x1b1138); if (!_0x43261f) return; const _0x46f2d0 = await _0x2244b3(_0x2f9bba(0xb6f) + _0x43261f['name'] + _0x2f9bba(0x594)); if (_0x46f2d0) { if (_0x2f9bba(0x1f0) === _0x2f9bba(0x1f0)) _0x4933f6(_0x1b1138), _0x15e83d(_0x2f9bba(0x96f) + _0x43261f[_0x2f9bba(0x499)] + _0x2f9bba(0x864)), _0x2faf14('chat', _0x2f9bba(0x398)), _0xe7cd49(![]); else { _0xd56877(); return; } } } else _0x4b030e[_0x2f9bba(0x23c)](_0x2f9bba(0xb7a) + _0x19f32c[_0x2f9bba(0xb7c)], _0x20a237[_0x2f9bba(0x269)](_0x39daea[_0x2f9bba(0x59f)])); }), _0x383772[_0x234a7d(0x85f)](_0x234a7d(0x296), () => { const _0xbf511d = _0x234a7d, _0x37d99c = _0x383772[_0xbf511d(0xa35)]['trim']()[_0xbf511d(0x8db)](_0x6ebfdd); _0x3b28d8[_0xbf511d(0x4f8)] = _0x37d99c; }); async function _0x4089d1() { const _0x45f889 = _0x234a7d; if (_0x45f889(0x9b5) === _0x45f889(0x5e8)) _0x49d1f8 = _0x3569e6(_0x41e47c); else { const _0x1e8163 = _0x383772[_0x45f889(0xa35)][_0x45f889(0x44c)](), _0x323355 = _0x1c14c0[_0x45f889(0xa35)][_0x45f889(0x44c)](); if (!_0x1e8163 || !_0x323355) { if (_0x45f889(0x4af) === 'FWcEZ') _0x1858b3[_0x23205c[_0x11ceb4]] = _0x5a7dac; else { _0x15e83d('请先输入\x20API\x20接口地址和密钥。'); return; } } const _0x1bdcc4 = _0x1e8163[_0x45f889(0x915)](/\/+$/, ''), _0x2d511b = _0x1bdcc4 + _0x45f889(0x751); _0x3b28d8['disabled'] = !![], _0x3b28d8[_0x45f889(0x1cd)] = _0x45f889(0x2f1), _0x268ed1[_0x45f889(0x51c)][_0x45f889(0x2e4)](_0x45f889(0x530)); try { const _0x3e4436 = await fetch(_0x2d511b, { 'headers': { 'Authorization': _0x45f889(0xbb7) + _0x1cc06f(_0x323355) } }); if (!_0x3e4436['ok']) throw new Error(_0x45f889(0x6a2) + _0x3e4436[_0x45f889(0x85c)]); const _0x141016 = await _0x3e4436[_0x45f889(0x7ce)](), _0x169ed3 = (_0x141016['data'] || _0x141016)['map'](_0x4aaafe => _0x4aaafe['id'])['sort'](); _0x169ed3[_0x45f889(0xaa7)] > 0x0 ? _0x45f889(0x95e) === _0x45f889(0x223) ? _0x4074c9[_0x45f889(0xac8)](_0x45f889(0x355))[_0x45f889(0x7a5)] = () => { _0xe9f794(_0x50e59a), _0x1cddc0(); } : (_0x268ed1['innerHTML'] = '', _0x169ed3[_0x45f889(0x201)](_0x29706b => { const _0xb46f8b = _0x45f889, _0x4b59a6 = document[_0xb46f8b(0xb35)](_0xb46f8b(0x4e8)); _0x4b59a6[_0xb46f8b(0x1cd)] = _0x29706b, _0x4b59a6[_0xb46f8b(0x85f)](_0xb46f8b(0xbba), () => { const _0x1f7103 = _0xb46f8b; _0x840d34[_0x1f7103(0xa35)] = _0x29706b, _0x268ed1[_0x1f7103(0x51c)][_0x1f7103(0x2e4)]('show'); }), _0x268ed1['appendChild'](_0x4b59a6); }), _0x268ed1['classList']['add'](_0x45f889(0x530)), _0x15e83d(_0x45f889(0xb1e) + _0x169ed3['length'] + _0x45f889(0x688))) : _0x15e83d(_0x45f889(0xb79)); } catch (_0x406ef5) { _0x15e83d(_0x45f889(0x881) + _0x406ef5['message'] + '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1'); } finally { _0x45f889(0x2a9) !== _0x45f889(0x2a9) ? _0x442b24[_0x45f889(0x3e0)][_0x45f889(0xaa3)] = _0x45f889(0x4c6) + _0x47f10d[_0x45f889(0x41d)] + '\x27)' : (_0x3b28d8[_0x45f889(0x4f8)] = ![], _0x3b28d8['textContent'] = '获取'); } } } _0x3b28d8[_0x234a7d(0x85f)]('click', _0x1f15a2 => { const _0x515b70 = _0x234a7d; _0x1f15a2[_0x515b70(0x260)](), _0x4089d1(); }), document['addEventListener']('click', _0x4cf9c1 => { const _0x41c4d5 = _0x234a7d; !_0x268ed1[_0x41c4d5(0x56f)](_0x4cf9c1[_0x41c4d5(0x48e)]) && _0x4cf9c1['target'] !== _0x840d34 && _0x4cf9c1[_0x41c4d5(0x48e)] !== _0x3b28d8 && _0x268ed1[_0x41c4d5(0x51c)][_0x41c4d5(0x2e4)]('show'); }); async function _0x55a8db(_0x179b60) { return await _0x14be18(_0x179b60, 0x190, 0.85); } _0x8fa20c[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0x311be1[_0x234a7d(0xbba)]()), _0x311be1[_0x234a7d(0x85f)](_0x234a7d(0x69c), async _0x2ddba9 => { const _0x277c81 = _0x234a7d; if (_0x277c81(0x378) === _0x277c81(0x378)) { const _0x4c1def = _0x2ddba9[_0x277c81(0x48e)][_0x277c81(0x6f1)][0x0]; if (!_0x4c1def) return; try { const _0x4c7063 = await _0x55a8db(_0x4c1def), _0x43fee1 = document[_0x277c81(0x8f3)]('user-avatar-preview'); _0x43fee1[_0x277c81(0x3e0)][_0x277c81(0xaa3)] = _0x277c81(0x4c6) + _0x4c7063 + '\x27)', _0x43fee1['dataset'][_0x277c81(0x2a4)] = _0x4c7063; } catch (_0x299c5b) { if (_0x277c81(0x50a) !== 'ZMaEb') _0x15e83d('错误:\x20' + _0x299c5b['message']); else { const _0x501a5d = _0x5e65a8['getElementById'](_0x277c81(0x7e4)); if (!_0x501a5d) return; const _0xa9b94a = new _0x4f59ce()[_0x277c81(0x648)]()[_0x277c81(0x500)]('T')[0x0], _0x51b6ef = _0x3cdea3['calendarEvents'][_0x277c81(0x3cf)](_0xf28b23 => _0xf28b23['date'] === _0xa9b94a && _0xf28b23[_0x277c81(0x318)] === _0x277c81(0xa2e)); _0x501a5d[_0x277c81(0x82c)] = '', _0x51b6ef[_0x277c81(0xaa7)] > 0x0 ? _0x51b6ef['forEach'](_0x495ef6 => { const _0x561439 = _0x277c81, _0x4353cc = _0x439275[_0x561439(0xb35)](_0x561439(0x4e8)); _0x4353cc[_0x561439(0xaff)] = 'todo-item-small', _0x4353cc[_0x561439(0x1cd)] = _0x495ef6['content'], _0x501a5d[_0x561439(0x3bf)](_0x4353cc); }) : _0x501a5d[_0x277c81(0x82c)] = _0x277c81(0x65c); } } } else _0x334de2[_0x277c81(0x3e0)]['display'] = _0x277c81(0x1bf); }), _0x3fc19f['addEventListener'](_0x234a7d(0xbba), () => _0x8f50fa['click']()), _0x8f50fa['addEventListener'](_0x234a7d(0x69c), async _0x52d8df => { const _0x5af1f7 = _0x234a7d; if (_0x5af1f7(0xb9a) === _0x5af1f7(0x5f6)) _0x58d0ae[_0x5af1f7(0x7ea)] = _0x5f9bc8, _0x9618e2(); else { const _0x224f90 = _0x52d8df['target'][_0x5af1f7(0x6f1)][0x0]; if (!_0x224f90) return; try { _0x3fc19f[_0x5af1f7(0xa9c)] = await _0x55a8db(_0x224f90); } catch (_0x17fffb) { _0x15e83d(_0x5af1f7(0xbb1) + _0x17fffb[_0x5af1f7(0x722)]); } } }); function _0x469029() { const _0x39155a = _0x234a7d; _0xeffd8[_0x39155a(0x82c)] = '', _0x3bedf0[_0x39155a(0x201)](_0x17d937 => { const _0x361024 = _0x39155a; if (_0x361024(0x49f) === _0x361024(0x49f)) { const _0x2efd2a = document[_0x361024(0xb35)](_0x361024(0x365)); _0x2efd2a[_0x361024(0xa9c)] = _0x17d937[_0x361024(0xb77)], _0x2efd2a[_0x361024(0x34c)] = _0x361024(0x1eb), _0x2efd2a['title'] = _0x17d937[_0x361024(0x499)], _0x2efd2a[_0x361024(0x51c)][_0x361024(0x6dd)](_0x361024(0x7f5)), _0x2efd2a[_0x361024(0x85f)](_0x361024(0xbba), () => _0x13123a(_0x17d937)), _0xeffd8['appendChild'](_0x2efd2a); } else { if (_0x38a00e[_0x361024(0xa7b)]) _0x538ceb(_0xbfb6c5[_0x361024(0xa7b)]); const _0x30f316 = _0x2f72e7['target']['closest'](_0x361024(0x90d)); if (!_0x30f316) return; const _0x261cb0 = _0x30f316[_0x361024(0xb40)][_0x361024(0xa71)], _0x9ff6a2 = _0x30f316['classList'][_0x361024(0x56f)](_0x361024(0x7da)) ? _0x361024(0x7da) : 'ai'; if (!_0x261cb0) return; const _0x37c55f = () => { const _0x53f774 = _0x361024; _0x1bd440[_0x53f774(0xa7b)] = _0x5d570c(() => { const _0x589599 = _0x53f774; if (_0x34d97d[_0x589599(0x318)] === _0x589599(0x534)) _0x128238[_0x589599(0xb16)](); _0x46b632(_0x43c011(_0x261cb0, 0xa), _0x9ff6a2); }, 0x320); }, _0x58357d = () => { const _0x410741 = _0x361024; if (_0x5e9ca3[_0x410741(0xa7b)]) _0x309ebd(_0x56c7b9[_0x410741(0xa7b)]); }; _0x560511[_0x361024(0x85f)](_0x361024(0x282), _0x58357d, { 'once': !![] }), _0x3d4f5a[_0x361024(0x85f)](_0x361024(0x6f8), _0x58357d, { 'once': !![] }), _0x1f5c8d['addEventListener'](_0x361024(0xbb4), _0x58357d, { 'once': !![] }), _0x37c55f(); } }); } async function _0x2d6a52(_0x21ea8d) { const _0x7b6550 = _0x234a7d, _0xceaa3b = await _0x2244b3(_0x7b6550(0xad6)); if (!_0xceaa3b) return; const _0x230905 = _0x2de116['calendarEvents'][_0x7b6550(0x1c5)](_0x4c4ad9 => _0x4c4ad9['id'] === _0x21ea8d); if (_0x230905 > -0x1) { if ('LATaX' !== 'LATaX') { const _0x1f8b22 = _0x37d8f7[_0x7b6550(0x8f3)](_0x399219); _0x1f8b22[_0x7b6550(0x82c)] = '', _0x163853[_0x7b6550(0x613)][_0x7b6550(0x201)](_0x45ff27 => { const _0x279199 = _0x7b6550, _0xeb0045 = _0x17389e[_0x279199(0xb35)](_0x279199(0x885)); _0xeb0045['value'] = _0x45ff27['id'], _0xeb0045[_0x279199(0x1cd)] = _0x45ff27[_0x279199(0x499)], _0x1f8b22[_0x279199(0x3bf)](_0xeb0045); }); } else _0x2de116[_0x7b6550(0x207)]['splice'](_0x230905, 0x1), _0x2ca195(), _0x5f14d9(), _0x192d10(), _0x52d60f(), _0x15e83d(_0x7b6550(0x4bd)); } } let _0x41f900 = null; function _0x3b1550(_0x4187fc) { const _0x369322 = _0x234a7d; if (_0x41f900) clearTimeout(_0x41f900); const _0xc8752 = _0x4187fc[_0x369322(0x48e)][_0x369322(0x911)](_0x369322(0x5f0)); if (!_0xc8752) return; const _0x44c6ac = _0xc8752[_0x369322(0xb40)]['id']; if (!_0x44c6ac) return; const _0x8a9c35 = () => { _0x41f900 = setTimeout(() => { const _0x2fd48c = _0x4d19; if (_0x4187fc['type'] === _0x2fd48c(0x534)) _0x4187fc[_0x2fd48c(0xb16)](); _0x2d6a52(_0x44c6ac); }, 0x320); }, _0x5d28b1 = () => { if (_0x41f900) clearTimeout(_0x41f900); }; document['addEventListener'](_0x369322(0x282), _0x5d28b1, { 'once': !![] }), document[_0x369322(0x85f)]('touchend', _0x5d28b1, { 'once': !![] }), document[_0x369322(0x85f)]('touchcancel', _0x5d28b1, { 'once': !![] }), document[_0x369322(0x85f)]('touchmove', _0x5d28b1, { 'once': !![] }), _0x8a9c35(); } function _0x1d26a5(_0x34533d) { const _0x54c9c9 = _0x234a7d; if (_0x54c9c9(0x57b) !== _0x54c9c9(0x9b9)) { const _0x1bb4c9 = _0x2de116[_0x54c9c9(0x6b7)]['find'](_0x3e03ec => _0x3e03ec[_0x54c9c9(0x6a3)]['includes'](_0x34533d)); if (!_0x1bb4c9) return ''; const _0x2b1db0 = _0x41382f(_0x1bb4c9['id']), _0x189d67 = _0x2de116['calendarEvents']['filter'](_0x545cc0 => _0x545cc0[_0x54c9c9(0xacd)] === _0x2b1db0['id'] || !_0x545cc0['userId']); if (_0x189d67[_0x54c9c9(0xaa7)] === 0x0) return ''; const _0x5954f0 = _0x189d67['map'](_0x55c6c5 => { const _0x538fad = _0x54c9c9; if ('rsrQi' !== 'OJkeu') { const _0x4c9c32 = _0x55c6c5[_0x538fad(0x318)] === _0x538fad(0x9de) ? _0x538fad(0x4e1) : '待办'; return _0x538fad(0x89b) + _0x4c9c32 + ']\x20' + _0x55c6c5[_0x538fad(0x602)] + ':\x20' + _0x55c6c5[_0x538fad(0x5e2)]; } else { const _0x70f5f5 = _0x587c47[_0x538fad(0x5bb)] === _0x538fad(0x7da) ? _0x538fad(0x7da) : 'ai', _0x2d9461 = _0x4b7512[_0x538fad(0x5bb)] === _0x538fad(0x7da) ? _0x3eb3e0[_0x538fad(0x499)] : _0x136c23(_0x580f72['author'])[_0x538fad(0x499)], _0x24617e = _0x4b2e3b['createElement'](_0x538fad(0x4e8)); _0x24617e[_0x538fad(0xaff)] = _0x538fad(0x848) + _0x70f5f5, _0x24617e[_0x538fad(0xb40)]['timestamp'] = _0x5278dd[_0x538fad(0xa71)], _0x24617e['style'][_0x538fad(0xa13)] = _0x538fad(0x1bf), _0x24617e[_0x538fad(0x3e0)][_0x538fad(0xa4b)] = '0', _0x24617e[_0x538fad(0x82c)] = _0x538fad(0x6e7) + _0x2d9461 + _0x538fad(0x7c8) + new _0x4fccc0(_0x4cb190[_0x538fad(0xa71)])[_0x538fad(0xb18)]('zh-CN') + _0x538fad(0x231) + _0x203f0b[_0x538fad(0x5e2)][_0x538fad(0x915)](/\n/g, _0x538fad(0x8c7)) + _0x538fad(0x9f2), _0x23412c[_0x538fad(0x3bf)](_0x24617e); } })['join']('\x0a'); return _0x54c9c9(0xa6c) + _0x2b1db0[_0x54c9c9(0x499)] + '\x20记录)\x0a' + _0x5954f0; } else { _0x5f5cf0('群聊至少需要2名成员。'); return; } } let _0x33cecd = { 'currentDate': new Date(), 'selectedDate': new Date()[_0x234a7d(0x648)]()[_0x234a7d(0x500)]('T')[0x0] }; function _0x37f152() { const _0x511148 = _0x234a7d; if (_0x511148(0x8c2) !== _0x511148(0x73b)) { document[_0x511148(0x8f3)](_0x511148(0x8f8))[_0x511148(0x85f)](_0x511148(0xbba), () => { const _0x1572fb = _0x511148; _0x5f14d9(), _0x2faf14(_0x1572fb(0x31b), _0x1572fb(0x4ab)); }), document['getElementById'](_0x511148(0x309))['addEventListener'](_0x511148(0xbba), () => _0x2faf14(_0x511148(0x4ab), _0x511148(0x31b))), document[_0x511148(0x8f3)](_0x511148(0x8e8))[_0x511148(0x85f)](_0x511148(0xbba), () => { const _0x5dbf30 = _0x511148; _0x5dbf30(0x712) === 'CzQTZ' ? _0xabbb68 += _0x5dbf30(0x4da) : (_0x33cecd[_0x5dbf30(0x814)]['setMonth'](_0x33cecd[_0x5dbf30(0x814)]['getMonth']() - 0x1), _0x5f14d9()); }), document['getElementById'](_0x511148(0x24b))[_0x511148(0x85f)](_0x511148(0xbba), () => { const _0x1edf06 = _0x511148; _0x33cecd['currentDate'][_0x1edf06(0x5eb)](_0x33cecd['currentDate']['getMonth']() + 0x1), _0x5f14d9(); }), document[_0x511148(0x8f3)]('today-btn')[_0x511148(0x85f)]('click', () => { const _0x42ddf0 = _0x511148; _0x33cecd[_0x42ddf0(0x814)] = new Date(), _0x33cecd[_0x42ddf0(0x7ea)] = new Date()[_0x42ddf0(0x648)]()[_0x42ddf0(0x500)]('T')[0x0], _0x5f14d9(); }), document[_0x511148(0x8f3)](_0x511148(0x61f))['addEventListener']('click', () => { const _0x394aed = _0x511148; _0x394aed(0x844) === _0x394aed(0x844) ? _0xcacacd(_0x33cecd[_0x394aed(0x7ea)]) : _0xe84567(); }), document[_0x511148(0x8f3)]('save-event-button')['addEventListener'](_0x511148(0xbba), _0x3eca90), document[_0x511148(0x8f3)](_0x511148(0x9f9))[_0x511148(0x85f)](_0x511148(0xbba), () => document[_0x511148(0x8f3)](_0x511148(0x535))['classList'][_0x511148(0x2e4)]('show')), document[_0x511148(0x8f3)]('add-event-backdrop')[_0x511148(0x85f)]('click', () => document[_0x511148(0x8f3)](_0x511148(0x535))[_0x511148(0x51c)][_0x511148(0x2e4)](_0x511148(0x530))); const _0x3e5909 = document[_0x511148(0x8f3)](_0x511148(0xa0b)); _0x3e5909[_0x511148(0x85f)]('mousedown', _0x3b1550), _0x3e5909[_0x511148(0x85f)](_0x511148(0x534), _0x3b1550, { 'passive': ![] }); } else _0x5c8e52[_0x511148(0x27b)]('JSON\x20解析失败!\x20错误原因:', _0x2a2c0d), _0x126f21[_0x511148(0x27b)](_0x511148(0x20b), _0x9b64c0); } function _0x5f14d9() { const _0x4c5a43 = _0x234a7d, _0xb37560 = _0x33cecd['currentDate'][_0x4c5a43(0x826)](), _0x28e86a = _0x33cecd[_0x4c5a43(0x814)][_0x4c5a43(0xbbb)](); document[_0x4c5a43(0x8f3)](_0x4c5a43(0x596))[_0x4c5a43(0x1cd)] = _0xb37560 + '年\x20' + (_0x28e86a + 0x1) + '月', _0x36ce44(_0xb37560, _0x28e86a), _0x23e826(_0x33cecd[_0x4c5a43(0x7ea)]); } function _0x52d60f() { const _0x45da17 = _0x234a7d; if (_0x45da17(0x71d) !== _0x45da17(0x25e)) { const _0x38f014 = document[_0x45da17(0x8f3)](_0x45da17(0x7e4)); if (!_0x38f014) return; const _0x47c260 = new Date()[_0x45da17(0x648)]()[_0x45da17(0x500)]('T')[0x0], _0x21bf57 = _0x2de116['calendarEvents'][_0x45da17(0x3cf)](_0xb74acc => _0xb74acc[_0x45da17(0x602)] === _0x47c260 && _0xb74acc[_0x45da17(0x318)] === 'todo'); _0x38f014[_0x45da17(0x82c)] = '', _0x21bf57[_0x45da17(0xaa7)] > 0x0 ? _0x21bf57['forEach'](_0x379cf5 => { const _0x11e17b = _0x45da17, _0x4dc9c1 = document[_0x11e17b(0xb35)](_0x11e17b(0x4e8)); _0x4dc9c1['className'] = 'todo-item-small', _0x4dc9c1[_0x11e17b(0x1cd)] = _0x379cf5[_0x11e17b(0x5e2)], _0x38f014[_0x11e17b(0x3bf)](_0x4dc9c1); }) : 'CkzRF' !== _0x45da17(0x68b) ? _0x366e7c[_0x45da17(0x82c)] = _0x45da17(0x427) + _0x567a0a[_0x45da17(0x700)](_0x45da17(0x2e3), { 'hour': _0x45da17(0x748), 'minute': _0x45da17(0x748), 'hour12': ![] }) + _0x45da17(0x5bf) : _0x38f014[_0x45da17(0x82c)] = _0x45da17(0x65c); } else { const _0x2b5ee8 = _0x1d83d9(_0x1b2d1e[_0x45da17(0x2df)]); _0x2b5ee8 && (delete _0x2b5ee8[_0x45da17(0x9b8)], _0x56c0b3(), _0xe0415c(_0x2b5ee8['id'], 'normal'), _0x5784d6(_0x45da17(0x7d3)), _0x3785e4(!![])); } } function _0x36ce44(_0x551b86, _0x4c91ae) { const _0x5bc71f = _0x234a7d; if (_0x5bc71f(0x1b2) === _0x5bc71f(0x9f6)) _0xaf85f8[_0x5bc71f(0x27b)]('加载\x20' + _0x2360f2 + _0x5bc71f(0xa02), _0x2432dd), _0x4442ce[_0x5bc71f(0x82c)] = _0x5bc71f(0xa2f) + _0x5b3468['message'] + _0x5bc71f(0xb3f); else { const _0x5c8a81 = document[_0x5bc71f(0x8f3)]('calendar-grid'); _0x5c8a81[_0x5bc71f(0x82c)] = ''; const _0x19bbb2 = new Date(_0x551b86, _0x4c91ae, 0x1)[_0x5bc71f(0x7f3)](), _0x1d0fdb = new Date(_0x551b86, _0x4c91ae + 0x1, 0x0)['getDate'](), _0x48708c = new Date()[_0x5bc71f(0x648)]()['split']('T')[0x0]; for (let _0x5493d0 = 0x0; _0x5493d0 < _0x19bbb2; _0x5493d0++) { _0x5c8a81[_0x5bc71f(0x3bf)](document[_0x5bc71f(0xb35)](_0x5bc71f(0x4e8))); } for (let _0x267d13 = 0x1; _0x267d13 <= _0x1d0fdb; _0x267d13++) { const _0x2a145b = document[_0x5bc71f(0xb35)](_0x5bc71f(0x4e8)); _0x2a145b[_0x5bc71f(0xaff)] = _0x5bc71f(0x7cb); const _0x964546 = _0x551b86 + '-' + String(_0x4c91ae + 0x1)['padStart'](0x2, '0') + '-' + String(_0x267d13)[_0x5bc71f(0x6f9)](0x2, '0'); if (_0x964546 === _0x48708c) _0x2a145b[_0x5bc71f(0x51c)][_0x5bc71f(0x6dd)](_0x5bc71f(0x420)); if (_0x964546 === _0x33cecd[_0x5bc71f(0x7ea)]) _0x2a145b[_0x5bc71f(0x51c)][_0x5bc71f(0x6dd)](_0x5bc71f(0x4dc)); const _0x520c28 = document[_0x5bc71f(0xb35)](_0x5bc71f(0xa52)); _0x520c28[_0x5bc71f(0xaff)] = 'day-number', _0x520c28[_0x5bc71f(0x1cd)] = _0x267d13, _0x2a145b[_0x5bc71f(0x3bf)](_0x520c28); const _0x5b469d = _0x2de116[_0x5bc71f(0x207)][_0x5bc71f(0x3cf)](_0x1629ec => _0x1629ec[_0x5bc71f(0x602)] === _0x964546); if (_0x5b469d[_0x5bc71f(0xaa7)] > 0x0) { const _0x12e6e9 = document[_0x5bc71f(0xb35)](_0x5bc71f(0x4e8)); _0x12e6e9[_0x5bc71f(0xaff)] = 'day-dot', _0x2a145b[_0x5bc71f(0x3bf)](_0x12e6e9); } _0x2a145b['addEventListener'](_0x5bc71f(0xbba), () => { const _0x277a0d = _0x5bc71f; _0x33cecd[_0x277a0d(0x7ea)] = _0x964546, _0x5f14d9(); }), _0x5c8a81[_0x5bc71f(0x3bf)](_0x2a145b); } } } function _0x23e826(_0x5643ba) { const _0x4ef003 = _0x234a7d, _0x9ab0b7 = document[_0x4ef003(0x8f3)](_0x4ef003(0xa0b)), _0x586d83 = document['getElementById'](_0x4ef003(0x46f)); _0x9ab0b7[_0x4ef003(0x82c)] = ''; const _0x2b33c4 = new Date(_0x5643ba + _0x4ef003(0x5da)); _0x586d83[_0x4ef003(0x1cd)] = _0x2b33c4[_0x4ef003(0xbbb)]() + 0x1 + '月' + _0x2b33c4[_0x4ef003(0x6b8)]() + '日'; const _0x150ce3 = _0x2de116['calendarEvents'][_0x4ef003(0x3cf)](_0x48bfb2 => _0x48bfb2[_0x4ef003(0x602)] === _0x5643ba); if (_0x150ce3[_0x4ef003(0xaa7)] === 0x0) { _0x9ab0b7[_0x4ef003(0x82c)] = _0x4ef003(0x5b2); return; } _0x150ce3[_0x4ef003(0x201)](_0x3ca217 => { const _0xd383e2 = _0x4ef003; if (_0xd383e2(0x8b7) !== _0xd383e2(0x9fb)) { const _0x471b68 = document[_0xd383e2(0xb35)]('div'); _0x471b68[_0xd383e2(0xaff)] = _0x3ca217[_0xd383e2(0x318)] === _0xd383e2(0x9de) ? _0xd383e2(0x471) : _0xd383e2(0x552), _0x471b68[_0xd383e2(0x1cd)] = _0x3ca217[_0xd383e2(0x5e2)], _0x471b68['dataset']['id'] = _0x3ca217['id'], _0x9ab0b7[_0xd383e2(0x3bf)](_0x471b68); } else _0x5f1a05[_0xd383e2(0x203)] = null, _0x4a7b33(_0xd383e2(0x2c1)), _0x256621(); }); } function _0xcacacd(_0x594192) { const _0x1ff795 = _0x234a7d; document[_0x1ff795(0x8f3)](_0x1ff795(0x8b4))[_0x1ff795(0x1cd)] = '为\x20' + _0x594192 + '\x20添加...', document[_0x1ff795(0x8f3)](_0x1ff795(0x882))[_0x1ff795(0xa35)] = '', document[_0x1ff795(0x8f3)]('event-type-todo')[_0x1ff795(0x875)] = !![], document['getElementById'](_0x1ff795(0x535))['classList']['add'](_0x1ff795(0x530)), document['getElementById'](_0x1ff795(0x882))['focus'](); } function _0x3eca90() { const _0x45a387 = _0x234a7d; if (_0x45a387(0xa5c) !== _0x45a387(0x9f1)) { const _0x53e80f = document['getElementById']('event-content-input')['value'][_0x45a387(0x44c)](), _0x36e7ba = document['querySelector'](_0x45a387(0x786))['value']; if (!_0x53e80f) { _0x15e83d('内容不能为空！'); return; } const _0x1f6dfa = _0x2de116[_0x45a387(0x613)][_0x45a387(0xa68)](_0x4fecd4 => _0x4fecd4['id'] === _0x2de116[_0x45a387(0xabe)]); if (!_0x1f6dfa) { _0x15e83d(_0x45a387(0x551)); return; } _0x2de116['calendarEvents']['push']({ 'id': _0x45a387(0x66e) + Date[_0x45a387(0x83b)](), 'date': _0x33cecd[_0x45a387(0x7ea)], 'type': _0x36e7ba, 'content': _0x53e80f, 'userId': _0x1f6dfa['id'] }), _0x2ca195(), _0x5f14d9(), _0x192d10(), _0x52d60f(), document[_0x45a387(0x8f3)]('add-event-modal')[_0x45a387(0x51c)][_0x45a387(0x2e4)](_0x45a387(0x530)); } else { const _0x47fe57 = _0x47be06[_0x45a387(0x8f7)][_0x45a387(0x1ed)](); _0x541eaf['textContent'] = _0x47fe57[_0x45a387(0xbbe)] === _0x45a387(0x5f8) ? '旁白' : _0x47fe57[_0x45a387(0xbbe)], _0x18580d['textContent'] = _0x47fe57['line'], _0x47fe57[_0x45a387(0xbbe)] !== _0x45a387(0x5f8) && _0xeb478e(_0x59444d[_0x45a387(0x2df)], _0x47fe57['emotion']); } } function _0x192d10() { const _0x5c1294 = _0x234a7d, _0x1e2061 = document[_0x5c1294(0x8f3)](_0x5c1294(0x88b)), _0x49093c = document['getElementById'](_0x5c1294(0x8ef)), _0x4a4bd1 = new Date(); _0x4a4bd1[_0x5c1294(0x8d3)](0x0, 0x0, 0x0, 0x0); const _0x3765de = _0x2de116[_0x5c1294(0x207)][_0x5c1294(0x3cf)](_0x394db0 => _0x394db0[_0x5c1294(0x318)] === _0x5c1294(0x9de) && new Date(_0x394db0['date'] + _0x5c1294(0x5da)) >= _0x4a4bd1)[_0x5c1294(0xb71)]((_0x8bc73f, _0x482144) => new Date(_0x8bc73f[_0x5c1294(0x602)]) - new Date(_0x482144[_0x5c1294(0x602)])); if (_0x3765de[_0x5c1294(0xaa7)] > 0x0) { const _0x3739cd = _0x3765de[0x0], _0x4d3012 = new Date(_0x3739cd[_0x5c1294(0x602)] + _0x5c1294(0x5da)), _0x3a2266 = _0x4d3012 - _0x4a4bd1, _0x4cbd3c = Math['ceil'](_0x3a2266 / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x1e2061[_0x5c1294(0x1cd)] = _0x5c1294(0x1dc) + _0x3739cd[_0x5c1294(0x5e2)] + '」', _0x49093c[_0x5c1294(0x82c)] = _0x5c1294(0x3b0) + _0x4cbd3c + _0x5c1294(0xac4); } else { if ('XkngV' === 'qhlrk') { if (_0xa28e5d[_0x5c1294(0x9e8)] === _0x5c1294(0x7da)) return _0x11eded['userProfile']?.['name'] || _0x5c1294(0xb4d); if (_0x4e4a0e[_0x5c1294(0x318)] === 'group') { const _0x8edb34 = _0x565f4d['senderId'] ? _0x313c65(_0x321ea6[_0x5c1294(0x4b1)]) : null; return _0x8edb34?.['name'] || 'Unknown'; } else { const _0x42340d = _0x1444f0(_0x1e15aa[_0x5c1294(0x6a3)][0x0]); return _0x42340d?.[_0x5c1294(0x499)] || 'AI'; } } else _0x1e2061[_0x5c1294(0x1cd)] = _0x5c1294(0x73c), _0x49093c[_0x5c1294(0x82c)] = _0x5c1294(0x709); } } function _0x4104b8() { const _0x305fdc = _0x234a7d; if ('XOgsN' === 'cnxsO') _0x3d9b78[_0x305fdc(0x9a6)] = _0x2af267, _0xcf3b21[_0x305fdc(0x63f)] = _0x8900f6, _0x15406e['isPlaying'] = ![], _0x983e71(); else { const _0x335596 = document[_0x305fdc(0x8f3)](_0x305fdc(0x443)); _0x335596['innerHTML'] = ''; if (_0x2de116[_0x305fdc(0x613)][_0x305fdc(0xaa7)] === 0x0) { _0x335596['innerHTML'] = _0x305fdc(0xb96); return; } _0x2de116[_0x305fdc(0x613)][_0x305fdc(0x201)](_0x2997f3 => { const _0x9a794c = _0x305fdc, _0x56d6e8 = document[_0x9a794c(0xb35)]('div'); _0x56d6e8[_0x9a794c(0xaff)] = _0x9a794c(0x4f2), _0x56d6e8[_0x9a794c(0xb40)]['id'] = _0x2997f3['id']; const _0x320655 = _0x2997f3['id'] === _0x2de116['activeUserProfileId'] ? '\x20(当前)' : ''; _0x56d6e8[_0x9a794c(0x82c)] = _0x9a794c(0x711) + (_0x2997f3[_0x9a794c(0x41d)] || _0x176655) + _0x9a794c(0x4c3) + _0x2997f3['name'] + _0x320655 + _0x9a794c(0x663) + _0x2997f3[_0x9a794c(0x44a)][_0x9a794c(0x8c6)](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x56d6e8[_0x9a794c(0x85f)]('click', () => _0x24932e(_0x2997f3['id'])), _0x335596[_0x9a794c(0x3bf)](_0x56d6e8); }); } } function _0x24932e(_0x38dfad = null) { const _0x52d080 = _0x234a7d; if (_0x52d080(0x286) === _0x52d080(0x286)) { _0x2faf14(_0x52d080(0xb88), _0x52d080(0x413)); const _0x6cdfe3 = document[_0x52d080(0x8f3)]('set-active-user-button'), _0x25270c = document[_0x52d080(0x8f3)](_0x52d080(0x476)); _0x25270c['style'][_0x52d080(0xaa3)] = '', delete _0x25270c['dataset'][_0x52d080(0x2a4)]; if (_0x38dfad) { if (_0x52d080(0x6c5) === 'Iokro') _0x4c9b3b = _0x2ac614; else { const _0x4c29ad = _0x2de116['userProfiles'][_0x52d080(0xa68)](_0x85d979 => _0x85d979['id'] === _0x38dfad); if (!_0x4c29ad) return; document[_0x52d080(0x8f3)](_0x52d080(0x59c))[_0x52d080(0xa35)] = _0x4c29ad['id'], document[_0x52d080(0x8f3)](_0x52d080(0x9eb))['textContent'] = _0x52d080(0x553), document[_0x52d080(0x8f3)]('user-name')[_0x52d080(0xa35)] = _0x4c29ad['name'], _0x4c29ad[_0x52d080(0x41d)] ? _0x25270c['style'][_0x52d080(0xaa3)] = 'url(\x27' + _0x4c29ad[_0x52d080(0x41d)] + '\x27)' : _0x25270c[_0x52d080(0x3e0)][_0x52d080(0xaa3)] = _0x52d080(0x4c6) + _0x176655 + '\x27)', document['getElementById'](_0x52d080(0x853))[_0x52d080(0xa35)] = _0x4c29ad[_0x52d080(0x44a)], _0x6cdfe3[_0x52d080(0x3e0)]['display'] = _0x4c29ad['id'] === _0x2de116[_0x52d080(0xabe)] ? _0x52d080(0x1bf) : 'block', document[_0x52d080(0x8f3)](_0x52d080(0x9a7))[_0x52d080(0x3e0)][_0x52d080(0xab9)] = _0x52d080(0x5ac); } } else _0x52d080(0x31a) !== _0x52d080(0x4b0) ? (document['getElementById'](_0x52d080(0x59c))[_0x52d080(0xa35)] = '', document[_0x52d080(0x8f3)](_0x52d080(0x9eb))['textContent'] = _0x52d080(0x7f8), document[_0x52d080(0x8f3)](_0x52d080(0xad2))[_0x52d080(0xa35)] = _0x52d080(0x82b) + (_0x2de116[_0x52d080(0x613)]['length'] + 0x1), _0x25270c[_0x52d080(0x3e0)][_0x52d080(0xaa3)] = 'url(\x27' + _0x176655 + '\x27)', document[_0x52d080(0x8f3)](_0x52d080(0x853))[_0x52d080(0xa35)] = '', _0x6cdfe3['style'][_0x52d080(0xab9)] = _0x52d080(0x1bf), document[_0x52d080(0x8f3)](_0x52d080(0x9a7))[_0x52d080(0x3e0)]['display'] = _0x52d080(0x1bf)) : _0x9f8490 += _0x52d080(0x45b) + _0x135d27[_0x52d080(0x773)] + '”的笔记，内容是：“' + _0x557e2b['content']['replace'](/\n/g, '\x20') + '”。\x0a'; } else _0x1c5f36[_0x52d080(0x51c)][_0x52d080(0x2e4)](_0x52d080(0x60a), _0x52d080(0x6b2)), _0x4a9743[_0x52d080(0x51c)][_0x52d080(0x2e4)](_0x52d080(0x8a5)), _0x5bb2be['diaryCurrentPage'] = _0x307848, _0x3c0c8d(), _0x1bd6a5[_0x52d080(0x512)] = ![]; } function _0x251ebe() { const _0x2a301c = _0x234a7d; if (_0x2a301c(0x7a7) === 'PGyDN') return _0x275a7d[_0x2a301c(0x27b)](_0x2a301c(0xa95)), null; else { const _0x1bd9d4 = document[_0x2a301c(0x8f3)]('editing-user-id')[_0x2a301c(0xa35)], _0x2cd5f1 = document[_0x2a301c(0x8f3)](_0x2a301c(0x476)), _0x1fafda = { 'name': document[_0x2a301c(0x8f3)](_0x2a301c(0xad2))[_0x2a301c(0xa35)][_0x2a301c(0x44c)](), 'persona': document[_0x2a301c(0x8f3)](_0x2a301c(0x853))[_0x2a301c(0xa35)]['trim'](), 'avatar': _0x2de116[_0x2a301c(0x613)][_0x2a301c(0xa68)](_0x2921ce => _0x2921ce['id'] === _0x1bd9d4)?.[_0x2a301c(0x41d)] || _0x2cd5f1[_0x2a301c(0x3e0)][_0x2a301c(0xaa3)]['slice'](0x5, -0x2)[_0x2a301c(0x915)](/'/g, '') || _0x176655 }; _0x2cd5f1['dataset'][_0x2a301c(0x2a4)] && (_0x2a301c(0x3c2) === _0x2a301c(0x6db) ? (_0x2fd836[_0x2a301c(0x1cd)] = _0x2a301c(0x2be), _0x13018a[_0x2a301c(0xa35)] = '', _0x5ede71[_0x2a301c(0xa35)] = _0x2a301c(0x9d9) + (_0x3f140b[_0x2a301c(0xa05)][_0x2a301c(0xaa7)] + 0x1), _0x343417[_0x2a301c(0xa35)] = _0x7dd7eb[_0x2a301c(0xabe)], _0x2ebf07[_0x2a301c(0x3e0)][_0x2a301c(0xab9)] = _0x2a301c(0x1bf)) : (_0x1fafda['avatar'] = _0x2cd5f1[_0x2a301c(0xb40)]['newAvatar'], delete _0x2cd5f1[_0x2a301c(0xb40)][_0x2a301c(0x2a4)])); if (!_0x1fafda[_0x2a301c(0x499)]) { _0x15e83d(_0x2a301c(0xa31)); return; } if (_0x1bd9d4) { if (_0x2a301c(0x7ee) !== _0x2a301c(0x2f3)) { const _0x31d5d7 = _0x2de116[_0x2a301c(0x613)]['find'](_0x466c4d => _0x466c4d['id'] === _0x1bd9d4); if (_0x31d5d7) Object[_0x2a301c(0x44f)](_0x31d5d7, _0x1fafda); } else { const _0x3729bf = { 'id': _0x2a301c(0x459) + _0x479f4d[_0x2a301c(0x83b)](), 'name': _0x571f3a, 'boundUserProfileId': _0x3c4660, 'memberCharacterIds': _0x204324, 'posts': [] }; _0x55b250['friendCircles'][_0x2a301c(0x8d9)](_0x3729bf); } } else { const _0xe75be7 = { 'id': _0x2a301c(0x60e) + Date[_0x2a301c(0x83b)](), ..._0x1fafda }; _0x2de116[_0x2a301c(0x613)]['push'](_0xe75be7), !_0x2de116[_0x2a301c(0xabe)] && (_0x2de116[_0x2a301c(0xabe)] = _0xe75be7['id']); } _0x2ca195(), _0x15e83d(_0x2a301c(0x2e5)), _0x4104b8(), _0x2faf14(_0x2a301c(0x413), 'userProfile'); } } async function _0x1c60fa() { const _0x45e8f4 = _0x234a7d, _0x5c7698 = document['getElementById'](_0x45e8f4(0x59c))[_0x45e8f4(0xa35)]; if (!_0x5c7698) return; if (_0x2de116[_0x45e8f4(0x613)][_0x45e8f4(0xaa7)] <= 0x1) { _0x15e83d('至少要保留一个用户。'); return; } const _0x33cfa1 = await _0x2244b3(_0x45e8f4(0x2ff)); _0x33cfa1 && (_0x2de116[_0x45e8f4(0x613)] = _0x2de116[_0x45e8f4(0x613)][_0x45e8f4(0x3cf)](_0x242c0e => _0x242c0e['id'] !== _0x5c7698), _0x2de116[_0x45e8f4(0xabe)] === _0x5c7698 && (_0x2de116[_0x45e8f4(0xabe)] = _0x2de116[_0x45e8f4(0x613)][0x0]['id']), _0x2de116['chats'][_0x45e8f4(0x201)](_0x309c68 => { const _0x2c6e25 = _0x45e8f4; if (_0x2c6e25(0x40c) === _0x2c6e25(0x656)) { _0x15a509('群聊名称不能为空！'); return; } else _0x309c68[_0x2c6e25(0x38d)] === _0x5c7698 && (_0x309c68[_0x2c6e25(0x38d)] = _0x2de116['activeUserProfileId']); }), _0x2ca195(), _0x15e83d(_0x45e8f4(0x733)), _0x4104b8(), _0x2faf14(_0x45e8f4(0x413), _0x45e8f4(0xb88))); } function _0xe6476b() { const _0x15f94f = _0x234a7d; if (_0x15f94f(0x68d) === _0x15f94f(0x7cc)) _0x40814e(_0x15f94f(0xb72))['then'](_0xd8a08d => { const _0x5ad766 = _0x15f94f; if (_0xd8a08d) { const _0x3ccba9 = _0x5caf12(_0x2dc7ed[_0x5ad766(0x2df)]); _0x3ccba9 && (delete _0x3ccba9[_0x5ad766(0x9b8)], _0x136891(), _0x3b091f(_0x3ccba9['id'], _0x5ad766(0x388)), _0x39c49c(_0x5ad766(0x7d3)), _0x21571e(!![])); } }); else { const _0x3f5b91 = document[_0x15f94f(0x8f3)]('world-book-list-container'); _0x3f5b91[_0x15f94f(0x82c)] = ''; if (_0x2de116[_0x15f94f(0x432)][_0x15f94f(0xaa7)] === 0x0) { _0x3f5b91[_0x15f94f(0x82c)] = _0x15f94f(0x99f); return; } _0x2de116[_0x15f94f(0x432)]['forEach'](_0x407880 => { const _0x446caf = _0x15f94f, _0x5ff707 = document['createElement'](_0x446caf(0x4e8)); _0x5ff707[_0x446caf(0xaff)] = _0x446caf(0x4f2), _0x5ff707[_0x446caf(0xb40)]['id'] = _0x407880['id'], _0x5ff707[_0x446caf(0x82c)] = _0x446caf(0xb8c) + _0x407880['name'] + _0x446caf(0x91c) + _0x407880[_0x446caf(0x5e2)]['substring'](0x0, 0x64) + _0x446caf(0xb6c), _0x5ff707[_0x446caf(0x85f)](_0x446caf(0xbba), () => _0x243c1f(_0x407880['id'])), _0x3f5b91[_0x446caf(0x3bf)](_0x5ff707); }); } } function _0x243c1f(_0x4ab2ad = null) { const _0x5e3fe5 = _0x234a7d; _0x2faf14(_0x5e3fe5(0x7a0), _0x5e3fe5(0x428)); if (_0x4ab2ad) { const _0x1668dd = _0x2de116[_0x5e3fe5(0x432)]['find'](_0x56b48b => _0x56b48b['id'] === _0x4ab2ad); if (!_0x1668dd) return; document[_0x5e3fe5(0x8f3)](_0x5e3fe5(0x200))[_0x5e3fe5(0xa35)] = _0x1668dd['id'], document[_0x5e3fe5(0x8f3)](_0x5e3fe5(0x71b))['textContent'] = '编辑条目', document[_0x5e3fe5(0x8f3)](_0x5e3fe5(0x609))[_0x5e3fe5(0xa35)] = _0x1668dd[_0x5e3fe5(0x499)], document[_0x5e3fe5(0x8f3)](_0x5e3fe5(0x31c))[_0x5e3fe5(0xa35)] = _0x1668dd[_0x5e3fe5(0x5e2)]; } else document[_0x5e3fe5(0x8f3)](_0x5e3fe5(0x200))['value'] = '', document['getElementById'](_0x5e3fe5(0x71b))[_0x5e3fe5(0x1cd)] = '新建条目', document[_0x5e3fe5(0x8f3)](_0x5e3fe5(0x609))[_0x5e3fe5(0xa35)] = '', document['getElementById'](_0x5e3fe5(0x31c))['value'] = ''; } function _0x30f0f0() { const _0x2847d7 = _0x234a7d; if (_0x2847d7(0x256) !== _0x2847d7(0x256)) _0x5a44c0['style'][_0x2847d7(0xab9)] = _0x2847d7(0x47f); else { const _0x3e46c8 = document['getElementById']('editing-world-book-id')[_0x2847d7(0xa35)], _0x574fdf = document[_0x2847d7(0x8f3)](_0x2847d7(0x609))[_0x2847d7(0xa35)][_0x2847d7(0x44c)](), _0x43080d = document[_0x2847d7(0x8f3)](_0x2847d7(0x31c))[_0x2847d7(0xa35)][_0x2847d7(0x44c)](); if (!_0x574fdf || !_0x43080d) { _0x15e83d(_0x2847d7(0x4f4)); return; } if (_0x3e46c8) { if (_0x2847d7(0x60c) === _0x2847d7(0xa37)) _0x20d27d += _0x2847d7(0x7f4) + _0x30ba8f[_0x2847d7(0xb17)] + _0x2847d7(0x7bc) + _0x3589e2[_0x2847d7(0xa77)]['join']('、') + '。\x0a'; else { const _0x1ffe52 = _0x2de116[_0x2847d7(0x432)][_0x2847d7(0xa68)](_0x3c9e3a => _0x3c9e3a['id'] === _0x3e46c8); _0x1ffe52 && (_0x1ffe52[_0x2847d7(0x499)] = _0x574fdf, _0x1ffe52['content'] = _0x43080d); } } else { const _0x4865a0 = { 'id': _0x2847d7(0x623) + Date['now'](), 'name': _0x574fdf, 'content': _0x43080d }; _0x2de116[_0x2847d7(0x432)][_0x2847d7(0x8d9)](_0x4865a0); } _0x2ca195(), _0x15e83d('世界书条目已保存！'), _0xe6476b(), _0x2faf14('worldBook', 'worldBookEditor'); } } async function _0x52f02e() { const _0x2930dc = _0x234a7d, _0x958e86 = document[_0x2930dc(0x8f3)](_0x2930dc(0x200))[_0x2930dc(0xa35)]; if (!_0x958e86) return; const _0x71103b = await _0x2244b3(_0x2930dc(0x8da)); _0x71103b && (_0x2930dc(0x865) === _0x2930dc(0x392) ? _0x3ca428[_0x2930dc(0x1cd)] = _0x2930dc(0x319) : (_0x2de116[_0x2930dc(0x432)] = _0x2de116['worldBooks'][_0x2930dc(0x3cf)](_0x3c4621 => _0x3c4621['id'] !== _0x958e86), _0x2de116['characters'][_0x2930dc(0x201)](_0x57afb9 => { const _0x3d92fd = _0x2930dc; _0x57afb9[_0x3d92fd(0xae1)] && (_0x57afb9[_0x3d92fd(0xae1)] = _0x57afb9[_0x3d92fd(0xae1)][_0x3d92fd(0x3cf)](_0x537f1d => _0x537f1d !== _0x958e86)); }), _0x2ca195(), _0x15e83d(_0x2930dc(0xa1f)), _0xe6476b(), _0x2faf14('worldBook', 'worldBookEditor'))); } function _0xf41b65() { const _0x58248e = _0x234a7d, _0xb1bf1b = document[_0x58248e(0x8f3)]('world-book-checkboxes-container'), _0x3fbf18 = _0xb1bf1b[_0x58248e(0x672)](_0x58248e(0x5b0)), _0xf8668d = document[_0x58248e(0xac8)](_0x58248e(0x77a)); if (_0x3fbf18[_0x58248e(0xaa7)] === 0x0) _0xf8668d['textContent'] = _0x58248e(0x319); else { if (_0x3fbf18[_0x58248e(0xaa7)] > 0x2) { if (_0x58248e(0x8b2) !== _0x58248e(0x4f0)) _0xf8668d[_0x58248e(0x1cd)] = _0x58248e(0xa7d) + _0x3fbf18['length'] + '\x20项'; else { const { playlist: _0x23ec04, currentIndex: _0x5ae765 } = _0x5596a2['parse'](_0x4873f5); _0x471110[_0x58248e(0x75c)](_0x23ec04) && _0x23ec04[_0x58248e(0xaa7)] > 0x0 && _0x5ae765 > -0x1 && (_0x57bee1[_0x58248e(0x9a6)] = _0x23ec04, _0x1adb65[_0x58248e(0x63f)] = _0x5ae765, _0x7458cf['isPlaying'] = ![], _0x19e186()); } } else _0xf8668d[_0x58248e(0x1cd)] = Array['from'](_0x3fbf18)['map'](_0x320d68 => _0x320d68['parentElement'][_0x58248e(0x1cd)]['trim']())['join']('、'); } } async function _0x5d6c78(_0x4f4dea) { const _0xd1a777 = _0x234a7d, _0x2258bc = _0x2de116['chats']['find'](_0x2825c1 => _0x2825c1['id'] === _0x4f4dea); if (!_0x2258bc || _0x2258bc[_0xd1a777(0x318)] !== 'group') return; document[_0xd1a777(0x8f3)](_0xd1a777(0x3ca))['value'] = _0x2258bc[_0xd1a777(0x499)] || '', _0x58bad2(_0xd1a777(0x83f)), document[_0xd1a777(0x8f3)]('group-settings-bind-user')[_0xd1a777(0xa35)] = _0x2258bc[_0xd1a777(0x38d)] || _0x2de116[_0xd1a777(0xabe)]; const _0x133e0b = document[_0xd1a777(0x8f3)]('group-world-book-checkboxes'); _0x133e0b[_0xd1a777(0x82c)] = '', _0x2de116[_0xd1a777(0x432)][_0xd1a777(0x201)](_0xcced20 => { const _0xab8aa3 = _0xd1a777, _0x482797 = _0x2258bc[_0xab8aa3(0xae1)]?.[_0xab8aa3(0x8db)](_0xcced20['id']), _0xc4e4a0 = document[_0xab8aa3(0xb35)]('label'); _0xc4e4a0[_0xab8aa3(0x82c)] = _0xab8aa3(0x5f2) + _0xcced20['id'] + '\x22\x20' + (_0x482797 ? _0xab8aa3(0x875) : '') + '>\x20' + _0xcced20[_0xab8aa3(0x499)], _0x133e0b[_0xab8aa3(0x3bf)](_0xc4e4a0); }), _0x44f09b(); const _0x31c7e5 = document['getElementById'](_0xd1a777(0x867)), _0x214ee6 = document[_0xd1a777(0x8f3)](_0xd1a777(0x8f4)); _0x214ee6[_0xd1a777(0x3e0)][_0xd1a777(0xaa3)] = '', _0x26239c(_0xd1a777(0x7c9) + _0x4f4dea)['then'](_0x16a73c => { const _0x4fe35b = _0xd1a777; if ('gJqJK' === _0x4fe35b(0x993)) { const _0x47f5b5 = new _0x80befc(); _0x47f5b5[_0x4fe35b(0x1b9)] = () => _0x2d5fb2(_0x47f5b5[_0x4fe35b(0x774)]), _0x47f5b5[_0x4fe35b(0x611)] = _0x406e80, _0x47f5b5['readAsDataURL'](_0x2084a8); } else _0x31c7e5[_0x4fe35b(0xa9c)] = _0x16a73c ? URL['createObjectURL'](_0x16a73c) : _0x322703; }), _0x26239c('group_bg_' + _0x4f4dea)[_0xd1a777(0xad3)](_0x5a199f => { const _0x4a0849 = _0xd1a777; if (_0x5a199f) _0x214ee6[_0x4a0849(0x3e0)][_0x4a0849(0xaa3)] = _0x4a0849(0x4c6) + URL['createObjectURL'](_0x5a199f) + '\x27)'; }), _0x2faf14(_0xd1a777(0x9e7), 'chat'); } async function _0x1f9286() { const _0x187187 = _0x234a7d, _0x375a9d = _0x231de4(); if (!_0x375a9d || _0x375a9d[_0x187187(0x318)] !== _0x187187(0x366)) return; const _0x5eac6d = document['getElementById'](_0x187187(0x3ca))[_0x187187(0xa35)][_0x187187(0x44c)](); if (!_0x5eac6d) { _0x15e83d('群聊名称不能为空！'); return; } _0x375a9d['name'] = _0x5eac6d; const _0x15c1b4 = document[_0x187187(0x672)](_0x187187(0x2de)); _0x375a9d[_0x187187(0xae1)] = Array[_0x187187(0x426)](_0x15c1b4)[_0x187187(0x7c6)](_0x38dccf => _0x38dccf['value']), _0x375a9d['boundUserProfileId'] = document[_0x187187(0x8f3)](_0x187187(0x83f))[_0x187187(0xa35)]; const _0x51102d = document[_0x187187(0x8f3)]('group-avatar-input')[_0x187187(0x6f1)][0x0], _0x4e226c = document[_0x187187(0x8f3)](_0x187187(0x768))['files'][0x0]; if (_0x51102d) await _0x1d2a3c(_0x187187(0x7c9) + _0x375a9d['id'], _0x51102d); if (_0x4e226c) await _0x1d2a3c(_0x187187(0x20c) + _0x375a9d['id'], _0x4e226c); _0x2ca195(), _0x4214ca(), await _0x25e174(), _0x15e83d('群聊设置已保存！'), _0x2faf14('chat', _0x187187(0x9e7)); } function _0x44f09b() { const _0x54e5b4 = _0x234a7d, _0x210c5a = document[_0x54e5b4(0x8f3)]('group-world-book-checkboxes'), _0x4ef476 = _0x210c5a[_0x54e5b4(0x672)]('input:checked'), _0x3267ff = document[_0x54e5b4(0xac8)]('#group-settings-screen\x20.selected-options-text'); if (_0x4ef476[_0x54e5b4(0xaa7)] === 0x0) _0x54e5b4(0x3b2) === _0x54e5b4(0x3b2) ? _0x3267ff[_0x54e5b4(0x1cd)] = _0x54e5b4(0x319) : _0x2bc6dc[_0x54e5b4(0x42d)] && _0x136c11(_0x34bd49[_0x54e5b4(0x42d)]); else _0x4ef476[_0x54e5b4(0xaa7)] > 0x2 ? _0x3267ff[_0x54e5b4(0x1cd)] = _0x54e5b4(0xa7d) + _0x4ef476['length'] + '\x20项' : _0x3267ff[_0x54e5b4(0x1cd)] = Array[_0x54e5b4(0x426)](_0x4ef476)['map'](_0x5556c0 => _0x5556c0[_0x54e5b4(0xba2)]['textContent'][_0x54e5b4(0x44c)]())[_0x54e5b4(0x6cf)]('、'); } async function _0x3bf117() { const _0x18868a = _0x234a7d, _0x5a2cad = _0x231de4(), _0xaede6 = (_0x5a2cad?.[_0x18868a(0x6a3)] || [])[_0x18868a(0x7c6)](_0x11feaf)[_0x18868a(0x3cf)](Boolean), _0x2dc7f4 = _0x41382f(_0x5a2cad['id']); if (!_0x5a2cad || _0x5a2cad[_0x18868a(0x318)] !== _0x18868a(0x366) || _0xaede6[_0x18868a(0xaa7)] < 0x2) return null; const _0x4591bb = _0x5a2cad[_0x18868a(0xae1)] && _0x5a2cad[_0x18868a(0xae1)][_0x18868a(0xaa7)] > 0x0 ? _0x18868a(0xb8b) + _0x5a2cad[_0x18868a(0xae1)]['map'](_0x3d475e => _0x2de116[_0x18868a(0x432)][_0x18868a(0xa68)](_0x6fe530 => _0x6fe530['id'] === _0x3d475e))[_0x18868a(0x3cf)](Boolean)[_0x18868a(0x7c6)](_0x398b62 => _0x18868a(0x464) + _0x398b62[_0x18868a(0x499)] + '\x0a' + _0x398b62[_0x18868a(0x5e2)])[_0x18868a(0x6cf)]('') : '', _0x27b839 = _0x2dc7f4[_0x18868a(0x44a)] ? _0x18868a(0x58c) + _0x2dc7f4['name'] + _0x18868a(0xa45) + _0x2dc7f4['persona'] : ''; let _0x1db6c7 = ''; const _0x1eb0e5 = new Date(), _0xf70eb0 = _0x2de116[_0x18868a(0x59f)]['at'](-0x1); _0x1db6c7 += '\x0a-\x20**当前时间**:\x20' + _0x1eb0e5[_0x18868a(0xb18)](_0x18868a(0x2e3), { 'dateStyle': _0x18868a(0x542), 'timeStyle': _0x18868a(0xa90) }); if (_0xf70eb0) { const _0x29bf60 = new Date(_0xf70eb0['timestamp']), _0x495e41 = Math[_0x18868a(0x1e2)]((_0x1eb0e5 - _0x29bf60) / (0x3e8 * 0x3c)); if (_0x495e41 < 0x5) _0x1db6c7 += _0x18868a(0x7d7); else { if (_0x495e41 < 0x78) _0x1db6c7 += '\x0a-\x20**对话状态**:\x20群里在' + _0x495e41 + '分钟前聊过，请注意衔接。'; else { const _0x101b60 = Math['floor'](_0x495e41 / 0x3c); if (_0x101b60 < 0x30) _0x1db6c7 += '\x0a-\x20**对话状态**:\x20群里在' + _0x101b60 + _0x18868a(0x8ba); else _0x1db6c7 += _0x18868a(0x8fb) + Math[_0x18868a(0x1e2)](_0x101b60 / 0x18) + _0x18868a(0x394); } } } else _0x1db6c7 += _0x18868a(0x4fb); const _0x59fc89 = [..._0x2de116[_0x18868a(0x59f)]][_0x18868a(0xb22)]()[_0x18868a(0xa68)](_0x129c2f => _0x129c2f[_0x18868a(0x9e8)] === _0x18868a(0x7da))?.[_0x18868a(0x5e2)] || '', _0x1cc24d = _0x560ed6(_0x5a2cad, _0x59fc89), _0x43bbb3 = _0x2de116[_0x18868a(0x59f)][_0x18868a(0xa38)](-0x78), _0x5b61df = _0x3bedf0['map'](_0x7b191e => _0x7b191e[_0x18868a(0x499)]), _0x25f70d = _0x3af87f(), _0x282f14 = _0xaede6['map'](_0x57521d => { const _0x4f8713 = _0x18868a, { omniText: _0x84aeb4 } = _0x888912(_0x57521d['id'], _0x5a2cad['id']), _0x46fef8 = _0x385577(_0x57521d['id']), _0x12407d = _0x57521d[_0x4f8713(0xae1)] && _0x57521d['linkedWorldBookIds'][_0x4f8713(0xaa7)] > 0x0 ? _0x4f8713(0x787) + _0x57521d[_0x4f8713(0x499)] + '的个人专属世界观设定\x0a' + _0x57521d['linkedWorldBookIds'][_0x4f8713(0x7c6)](_0x509a2d => _0x2de116[_0x4f8713(0x432)]['find'](_0x158f14 => _0x158f14['id'] === _0x509a2d))[_0x4f8713(0x3cf)](Boolean)['map'](_0x431f27 => _0x4f8713(0xa66) + _0x431f27[_0x4f8713(0x499)] + '\x0a' + _0x431f27[_0x4f8713(0x5e2)])[_0x4f8713(0x6cf)]('') : ''; let _0x115dac = _0x4f8713(0x1e6) + _0x57521d[_0x4f8713(0x499)] + ')\x20的专属时间锚点\x0a'; const _0x4be896 = _0x5d182c(_0x57521d['id']), _0x434275 = new Date(); if (_0x4be896) { if ('wEsup' === _0x4f8713(0x850)) { const _0x374724 = _0x4f8713(0x24c); _0x49f171['body']['insertAdjacentHTML'](_0x4f8713(0x7cf), _0x374724); const _0x5c3529 = _0x301b1a[_0x4f8713(0x8f3)](_0x4f8713(0x3bc)), _0x57ee17 = _0x23007e[_0x4f8713(0x8f3)](_0x4f8713(0x763)), _0x448422 = _0x3cd1f9[_0x4f8713(0x8f3)](_0x4f8713(0x926)), _0x2719a7 = _0x179c75[_0x4f8713(0x8f3)](_0x4f8713(0x730)), _0x5e8b85 = _0x5c3529[_0x4f8713(0xac8)]('.choice-modal-backdrop'), _0xb54f26 = () => { const _0x843a07 = _0x4f8713; _0x5c3529[_0x843a07(0x2e4)](), _0x1d7bb8(); }; _0x448422[_0x4f8713(0x7a5)] = () => { const _0x330d7d = _0x4f8713; _0x567d4b(_0x57ee17[_0x330d7d(0xa35)]), _0xb54f26(); }, _0x2719a7['onclick'] = _0xb54f26, _0x5e8b85[_0x4f8713(0x7a5)] = _0xb54f26; } else { const _0x177e01 = new Date(_0x4be896['timestamp']); _0x115dac += _0x4f8713(0x2cd) + _0x2dc7f4[_0x4f8713(0x499)] + '在所有地方的最后一次互动是在**:\x20' + _0x4f5166(_0x177e01) + '\x0a'; const _0x25ee44 = _0x434275[_0x4f8713(0x5bc)]() === _0x177e01[_0x4f8713(0x5bc)](), _0x3fefb2 = new Date(); _0x3fefb2[_0x4f8713(0xb25)](_0x434275[_0x4f8713(0x6b8)]() - 0x1); const _0x30d823 = _0x3fefb2[_0x4f8713(0x5bc)]() === _0x177e01[_0x4f8713(0x5bc)](); if (_0x25ee44) _0x115dac += _0x4f8713(0x273); else _0x30d823 ? _0x115dac += _0x4f8713(0x335) : _0x115dac += _0x4f8713(0x30e); } } else _0x115dac += _0x4f8713(0x1ff) + _0x2dc7f4['name'] + _0x4f8713(0x43d); return { 'id': _0x57521d['id'], 'name': _0x57521d[_0x4f8713(0x499)], 'persona': _0x57521d[_0x4f8713(0x44a)] || _0x4f8713(0x3ef), 'memory': _0x84aeb4 + _0x46fef8 + _0x12407d + _0x115dac }; }), _0x28dd69 = 0x5, _0x4512f8 = 0xc, _0x44604b = _0x18868a(0x74e)[_0x18868a(0x44c)](), _0x32f2b6 = { 'instruction': (_0x18868a(0x9e3) + (_0x2dc7f4[_0x18868a(0x499)] || '用户') + _0x18868a(0x603) + (_0x2dc7f4['name'] || '用户') + _0x18868a(0x727) + _0x28dd69 + _0x18868a(0xb89) + _0x4512f8 + _0x18868a(0x217) + (_0x2dc7f4[_0x18868a(0x499)] || '用户') + '。\x0a-\x20再次强调：你的全部输出都将被作为JSON解析，任何JSON主体之外的额外文字都会导致程序失败。\x0a' + _0x1db6c7 + '\x20\x0a' + _0x27b839 + '\x0a' + _0x4591bb + _0x18868a(0x4bf) + _0x25f70d + '\x0a')[_0x18868a(0x44c)](), 'personas': _0x282f14, 'mentioned': _0x1cc24d ? { 'id': _0x1cc24d['id'], 'name': _0x1cc24d[_0x18868a(0x499)] } : null, 'stickerList': _0x5b61df }, _0x5a22ea = { 'type': _0x18868a(0x4e4), 'properties': { 'events': { 'type': _0x18868a(0xb53), 'items': { 'type': _0x18868a(0x4e4), 'required': ['senderId', 'kind'], 'properties': { 'senderId': { 'type': _0x18868a(0xa98) }, 'kind': { 'type': _0x18868a(0xa98), 'enum': [_0x18868a(0x5bd), _0x18868a(0x880), _0x18868a(0x8be)] }, 'content': { 'type': 'string' }, 'sticker': { 'type': 'string' }, 'songName': { 'type': 'string' }, 'artist': { 'type': 'string' } } } } }, 'required': [_0x18868a(0x2e1)] }, _0x388195 = []; _0x388195[_0x18868a(0x8d9)]({ 'role': _0x18868a(0x456), 'content': _0x44604b }); for (const _0x2ac8e5 of _0x43bbb3) { if (_0x18868a(0x434) === _0x18868a(0x434)) { const _0x3b08f6 = _0x2ac8e5[_0x18868a(0x9e8)] === 'ai' || _0x2ac8e5['role'] === _0x18868a(0x1f4) ? _0x18868a(0x1f4) : 'user'; let _0x527e9f = { 'role': _0x3b08f6, 'content': _0x2ac8e5[_0x18868a(0x5e2)] }, _0x4ea311 = !!_0x2ac8e5[_0x18868a(0x5e2)], _0x4645de = null; if (_0x2ac8e5[_0x18868a(0x6a9)]) _0x4645de = _0x2ac8e5[_0x18868a(0x6a9)]; else { if (_0x2ac8e5[_0x18868a(0x472)]) try { const _0x512c15 = await _0x26239c(_0x2ac8e5[_0x18868a(0x472)]); _0x512c15 && (_0x4645de = await _0x32f36c(_0x512c15)); } catch (_0x2b3307) { console['error'](_0x18868a(0xb9f), _0x2b3307); } } _0x4645de && (_0x527e9f['image'] = _0x4645de, _0x4ea311 = !![]), _0x4ea311 && _0x388195['push'](_0x527e9f); } else { const _0x1a6228 = _0x564eff['createElement'](_0x18868a(0x885)); _0x1a6228[_0x18868a(0xa35)] = _0x2df4cd['id'], _0x1a6228[_0x18868a(0x1cd)] = _0x124502[_0x18868a(0x499)], _0x19ab0a['appendChild'](_0x1a6228); } } _0x388195[_0x18868a(0x8d9)]({ 'role': 'user', 'content': _0x18868a(0x4d7) + JSON['stringify'](_0x5a22ea) + _0x18868a(0x5c6) + JSON[_0x18868a(0x269)](_0x32f2b6) }); try { if (_0x18868a(0xa47) !== _0x18868a(0xa67)) { const _0x454e3b = await _0x4df70c(_0x388195, { 'json': !![] }); if (!_0x454e3b) return null; let _0x386145 = _0x454e3b['trim'](); const _0x241d23 = _0x386145[_0x18868a(0x435)](/```json([\s\S]*?)```/i); if (_0x241d23) _0x386145 = _0x241d23[0x1][_0x18868a(0x44c)](); _0x386145 = _0x2caf2a(_0x386145); let _0xca65a9 = null; try { if (_0x18868a(0x47c) === _0x18868a(0xbbf)) { _0x707455('哼，不好好写清楚花在哪、花了多少，我怎么记？'); return; } else _0xca65a9 = JSON[_0x18868a(0x57f)](_0x386145); } catch (_0xba0c32) { console[_0x18868a(0x27b)](_0x18868a(0xa87), _0xba0c32), console['error']('收到的原始、有问题的文本:', _0x386145); } if (!_0xca65a9 || !Array[_0x18868a(0x75c)](_0xca65a9[_0x18868a(0x2e1)])) return null; return _0xca65a9 = _0x2a72a9(_0xca65a9, _0xaede6, _0x5b61df), _0xca65a9[_0x18868a(0x2e1)] = _0xca65a9[_0x18868a(0x2e1)][_0x18868a(0xa38)](0x0, _0x4512f8), _0xca65a9[_0x18868a(0x2e1)][_0x18868a(0xaa7)] ? _0xca65a9 : null; } else _0xc96e60 = '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>这里什么都没有...</p>'; } catch (_0x43a20c) { if (_0x18868a(0x9ae) !== 'muxSm') { const _0x4e0d1c = _0x2a587d['getElementById']('global-player-next-btn'); _0x4e0d1c && _0x4e0d1c[_0x18868a(0xbba)](); } else return _0x43a20c['name'] !== 'AbortError' && console[_0x18868a(0x27b)](_0x18868a(0x5b4), _0x43a20c), null; } } function _0x12ae0d() { const _0x2313da = _0x234a7d, _0x46bc37 = document[_0x2313da(0x8f3)](_0x2313da(0x2a3)); _0x46bc37[_0x2313da(0x82c)] = ''; if (_0x2de116[_0x2313da(0xa05)]['length'] === 0x0) { _0x46bc37[_0x2313da(0x82c)] = _0x2313da(0x486); return; } _0x2de116[_0x2313da(0xa05)][_0x2313da(0x201)](_0x35e536 => { const _0x215f73 = _0x2313da, _0x216557 = _0x2de116[_0x215f73(0x613)][_0x215f73(0xa68)](_0x373d71 => _0x373d71['id'] === _0x35e536['boundUserProfileId']) || { 'name': _0x215f73(0x5c0) }, _0x63db9e = document[_0x215f73(0xb35)]('div'); _0x63db9e[_0x215f73(0xaff)] = 'world-book-item', _0x63db9e[_0x215f73(0xb40)]['id'] = _0x35e536['id'], _0x63db9e[_0x215f73(0x82c)] = _0x215f73(0xb8c) + _0x35e536[_0x215f73(0x499)] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20' + _0x216557[_0x215f73(0x499)] + '\x20|\x20' + _0x35e536[_0x215f73(0x595)][_0x215f73(0xaa7)] + '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', _0x63db9e[_0x215f73(0x85f)](_0x215f73(0xbba), () => _0x24dcee(_0x35e536['id'])), _0x46bc37['appendChild'](_0x63db9e); }); } function _0x5e183a(_0x4e6383 = null) { const _0xb8d9ab = _0x234a7d, _0x93a112 = document[_0xb8d9ab(0x8f3)](_0xb8d9ab(0x55e)), _0x14400d = document[_0xb8d9ab(0x8f3)](_0xb8d9ab(0x488)), _0x3e4d38 = document[_0xb8d9ab(0x8f3)](_0xb8d9ab(0x372)), _0x1db29a = document[_0xb8d9ab(0x8f3)](_0xb8d9ab(0x3ad)), _0x476fa6 = document[_0xb8d9ab(0x8f3)](_0xb8d9ab(0x281)), _0x1b225d = document[_0xb8d9ab(0x8f3)](_0xb8d9ab(0x974)); _0x58bad2(_0xb8d9ab(0x488)), _0x3e4d38[_0xb8d9ab(0x82c)] = '', _0x2de116['characters'][_0xb8d9ab(0x201)](_0x96fac8 => { const _0x5b49b4 = _0xb8d9ab; if (_0x5b49b4(0xaef) === 'SHzEf') _0x320fd9[_0x5b49b4(0x499)] = _0x1decb4[_0x5b49b4(0x44c)](), _0x5875d7(), _0x49f5f3(), _0x300698(), _0x14399c('群名称已更改为\x22' + _0x2e9cf6[_0x5b49b4(0x499)] + '\x22。'); else { const _0x161cc8 = document[_0x5b49b4(0xb35)](_0x5b49b4(0x4e8)); _0x161cc8[_0x5b49b4(0xaff)] = _0x5b49b4(0x8ec), _0x161cc8[_0x5b49b4(0x82c)] = _0x5b49b4(0x861) + _0x96fac8['id'] + _0x5b49b4(0x4c0) + _0x96fac8['id'] + _0x5b49b4(0x1d9) + (_0x96fac8[_0x5b49b4(0x41d)] || _0x322703) + _0x5b49b4(0x377) + _0x96fac8['id'] + _0x5b49b4(0x811) + _0x96fac8[_0x5b49b4(0x499)] + '</label>\x0a\x20\x20\x20\x20', _0x3e4d38[_0x5b49b4(0x3bf)](_0x161cc8); } }); if (_0x4e6383) { const _0x2606f5 = _0x2de116[_0xb8d9ab(0xa05)][_0xb8d9ab(0xa68)](_0x4ceb59 => _0x4ceb59['id'] === _0x4e6383); if (!_0x2606f5) return; _0x1db29a[_0xb8d9ab(0x1cd)] = '编辑好友圈', _0x476fa6[_0xb8d9ab(0xa35)] = _0x2606f5['id'], _0x93a112[_0xb8d9ab(0xa35)] = _0x2606f5[_0xb8d9ab(0x499)], _0x14400d['value'] = _0x2606f5['boundUserProfileId'], _0x1b225d['style']['display'] = _0xb8d9ab(0x5ac), _0x2606f5[_0xb8d9ab(0x595)][_0xb8d9ab(0x201)](_0x52b4b7 => { const _0x2e137e = _0xb8d9ab, _0x537482 = _0x3e4d38[_0x2e137e(0xac8)](_0x2e137e(0x755) + _0x52b4b7); if (_0x537482) _0x537482[_0x2e137e(0x875)] = !![]; }); } else _0x1db29a[_0xb8d9ab(0x1cd)] = _0xb8d9ab(0x2be), _0x476fa6['value'] = '', _0x93a112[_0xb8d9ab(0xa35)] = '好友圈\x20' + (_0x2de116[_0xb8d9ab(0xa05)][_0xb8d9ab(0xaa7)] + 0x1), _0x14400d['value'] = _0x2de116[_0xb8d9ab(0xabe)], _0x1b225d['style']['display'] = _0xb8d9ab(0x1bf); _0x2faf14(_0xb8d9ab(0x604), _0xb8d9ab(0x640)); } function _0x12d994() { const _0x21d8b8 = _0x234a7d, _0x476b7f = document[_0x21d8b8(0x8f3)](_0x21d8b8(0x281))[_0x21d8b8(0xa35)], _0x49ecd0 = document[_0x21d8b8(0x8f3)](_0x21d8b8(0x55e))[_0x21d8b8(0xa35)][_0x21d8b8(0x44c)](), _0x1d3602 = document[_0x21d8b8(0x8f3)](_0x21d8b8(0x488))[_0x21d8b8(0xa35)], _0x16cfe9 = Array[_0x21d8b8(0x426)](document[_0x21d8b8(0x672)](_0x21d8b8(0xb29)))[_0x21d8b8(0x7c6)](_0x192332 => _0x192332['dataset']['id']); if (!_0x49ecd0) { _0x15e83d('好友圈名称不能为空！'); return; } if (_0x16cfe9[_0x21d8b8(0xaa7)] === 0x0) { _0x15e83d('至少要选择一个圈内成员！'); return; } if (_0x476b7f) { if (_0x21d8b8(0x1d8) !== _0x21d8b8(0x1d8)) _0x4cea68[_0x21d8b8(0x3e0)][_0x21d8b8(0xab9)] = 'none'; else { const _0x27b4df = _0x2de116[_0x21d8b8(0xa05)][_0x21d8b8(0xa68)](_0x5e9302 => _0x5e9302['id'] === _0x476b7f); if (_0x27b4df) { if ('bZaka' !== _0x21d8b8(0xb95)) { if (_0x13ac41 === null) return; const _0x3a7991 = _0x8eb05f[_0x21d8b8(0x59f)][_0x16abc6]; if (!_0x3a7991) return; _0x555388[_0x21d8b8(0xa35)] = _0x3a7991[_0x21d8b8(0x5e2)], _0x4c1d70(), _0x450414[_0x21d8b8(0x51c)]['add']('show'), _0x27b088[_0x21d8b8(0x2e0)](); } else _0x27b4df[_0x21d8b8(0x499)] = _0x49ecd0, _0x27b4df[_0x21d8b8(0x38d)] = _0x1d3602, _0x27b4df['memberCharacterIds'] = _0x16cfe9; } } } else { const _0x6b996d = { 'id': _0x21d8b8(0x459) + Date[_0x21d8b8(0x83b)](), 'name': _0x49ecd0, 'boundUserProfileId': _0x1d3602, 'memberCharacterIds': _0x16cfe9, 'posts': [] }; _0x2de116[_0x21d8b8(0xa05)][_0x21d8b8(0x8d9)](_0x6b996d); } _0x2ca195(), _0x15e83d(_0x21d8b8(0x2b0)), _0x12ae0d(), _0x2faf14(_0x21d8b8(0x640), _0x21d8b8(0x604)); } async function _0x4c0620() { const _0x5109fb = _0x234a7d, _0x1b5bcf = document[_0x5109fb(0x8f3)]('editing-friend-circle-id')[_0x5109fb(0xa35)]; if (!_0x1b5bcf) return; const _0x38b58b = await _0x2244b3(_0x5109fb(0x5a6)); _0x38b58b && (_0x2de116[_0x5109fb(0xa05)] = _0x2de116['friendCircles'][_0x5109fb(0x3cf)](_0x1a21fc => _0x1a21fc['id'] !== _0x1b5bcf), _0x2de116['activeFriendCircleId'] === _0x1b5bcf && (_0x2de116['activeFriendCircleId'] = null), _0x2ca195(), _0x15e83d(_0x5109fb(0xafd)), _0x12ae0d(), _0x2faf14('friendCircleList', 'friendCircleEdit')); } function _0x24dcee(_0x1e4b8f) { const _0x1c11de = _0x234a7d; _0x10df2b(); const _0xfd59a8 = _0x2de116['friendCircles']['find'](_0x407212 => _0x407212['id'] === _0x1e4b8f); if (!_0xfd59a8) return; _0x2de116[_0x1c11de(0x42d)] = _0x1e4b8f, _0x2ca195(), document[_0x1c11de(0x8f3)](_0x1c11de(0x6ba))[_0x1c11de(0x1cd)] = _0xfd59a8[_0x1c11de(0x499)], _0x36dd52(), _0x2faf14(_0x1c11de(0x8be), _0x1c11de(0x640)), _0x475d88(); } function _0x2d1d34() { const _0x1a19d8 = _0x234a7d; if (_0x1a19d8(0x847) !== _0x1a19d8(0x847)) { const _0x3236a6 = _0x3f5eed[_0x1a19d8(0x64a)](_0x1727c6); if (_0x3236a6) _0x3b086d[_0x1a19d8(0x557)][_0x3236a6] = _0x3a8d28['getItem'](_0x3236a6); } else { if (!_0x2de116[_0x1a19d8(0xa05)] || _0x2de116[_0x1a19d8(0xa05)][_0x1a19d8(0xaa7)] === 0x0) { console['error'](_0x1a19d8(0x36a)); return; } const _0x1e62ff = _0x2de116[_0x1a19d8(0xa05)][0x0]; if (_0x1e62ff[_0x1a19d8(0x595)][_0x1a19d8(0xaa7)] < 0x2) { if ('kFZor' === _0x1a19d8(0x4d3)) { console[_0x1a19d8(0x27b)](_0x1a19d8(0x79c) + _0x1e62ff[_0x1a19d8(0x499)] + _0x1a19d8(0x1b5)); return; } else _0x5d6853[_0x1a19d8(0x6a3)] = _0x12f52f[_0x1a19d8(0x6a3)][_0x1a19d8(0x3cf)](_0x5a863e => _0x5a863e !== _0x611f90); } const _0x3b7394 = { 'id': 'test_post_' + Date[_0x1a19d8(0x83b)](), 'authorType': _0x1a19d8(0x2af), 'authorId': _0x1e62ff['memberCharacterIds'][0x0], 'content': _0x1a19d8(0xa19), 'timestamp': Date[_0x1a19d8(0x83b)](), 'likes': [_0x1e62ff[_0x1a19d8(0x595)][0x1]], 'comments': [{ 'commentId': 'c_' + Date[_0x1a19d8(0x83b)](), 'authorId': _0x1e62ff[_0x1a19d8(0x595)][0x1], 'content': _0x1a19d8(0x4df) }] }; _0x1e62ff[_0x1a19d8(0x415)]['push'](_0x3b7394), _0x2ca195(), console['log'](_0x1a19d8(0x302) + _0x1e62ff[_0x1a19d8(0x499)] + _0x1a19d8(0x3ff)), _0x15e83d(_0x1a19d8(0x271)); } } window[_0x234a7d(0x70d)] = _0x2d1d34; function _0x48a42d(_0x3c2870) { const _0x4dccf7 = _0x234a7d; return _0x4dccf7(0x5a5) !== _0x4dccf7(0x437) ? _0x2de116[_0x4dccf7(0x613)][_0x4dccf7(0xa68)](_0x4be685 => _0x4be685['id'] === _0x3c2870) : { 'type': _0x4dccf7(0x5bd), 'content': _0x1f5893 }; } function _0xc9067c(_0x29b108, _0x40fcf0 = _0x234a7d(0x741)) { const _0x33f1e2 = _0x234a7d, _0x59db11 = document[_0x33f1e2(0x8f3)](_0x33f1e2(0x678)); let _0x4f1f65 = document[_0x33f1e2(0x8f3)](_0x33f1e2(0x3cb)); _0x29b108 ? (!_0x4f1f65 && (_0x4f1f65 = document[_0x33f1e2(0xb35)]('div'), _0x4f1f65['id'] = _0x33f1e2(0x3cb), _0x59db11[_0x33f1e2(0x3bf)](_0x4f1f65)), _0x4f1f65['innerHTML'] = _0x33f1e2(0x784) + _0x40fcf0 + _0x33f1e2(0x3ae), _0x4f1f65[_0x33f1e2(0x3e0)]['display'] = _0x33f1e2(0x47f)) : _0x4f1f65 && (_0x4f1f65['style'][_0x33f1e2(0xab9)] = _0x33f1e2(0x1bf)); } async function _0x198189() { const _0x330cf8 = _0x234a7d, _0x468cf0 = _0x2de116[_0x330cf8(0xa05)][_0x330cf8(0xa68)](_0x42e03f => _0x42e03f['id'] === _0x2de116['activeFriendCircleId']); if (!_0x468cf0 || _0x2de116[_0x330cf8(0x3b8)]) return; _0xc9067c(!![], _0x330cf8(0x29c)), _0x2de116[_0x330cf8(0x3b8)] = !![]; try { let _0x1b230e = Date[_0x330cf8(0x83b)](); _0x468cf0[_0x330cf8(0x415)] && _0x468cf0[_0x330cf8(0x415)][_0x330cf8(0xaa7)] > 0x0 && (_0x1b230e = Math['max'](..._0x468cf0['posts'][_0x330cf8(0x7c6)](_0x2f80b1 => _0x2f80b1[_0x330cf8(0xa71)]))); const _0x421954 = await _0x32ee2c(_0x468cf0); if (!_0x421954 || _0x421954['length'] === 0x0) { if (_0x330cf8(0x221) !== _0x330cf8(0x221)) _0x136cc0(); else { _0x15e83d(_0x330cf8(0xb26)); return; } } const _0x2e42c7 = _0x421954['map'](async (_0x30d1ae, _0x4baa2a) => { const _0x2ad66f = _0x330cf8; _0xc9067c(!![], '刷新了\x20' + (_0x4baa2a + 0x1) + _0x2ad66f(0x2f9) + _0x421954[_0x2ad66f(0xaa7)] + _0x2ad66f(0x94c)); const _0xe4c107 = _0x1b230e + (_0x4baa2a + 0x1) * 0x3c * 0x3e8, _0x5e561f = { 'id': _0x2ad66f(0x794) + _0x30d1ae['authorId'] + '_' + _0xe4c107, 'authorType': _0x2ad66f(0x2af), 'authorId': _0x30d1ae['authorId'], 'content': _0x30d1ae[_0x2ad66f(0xae8)], 'timestamp': _0xe4c107, 'likes': _0x30d1ae[_0x2ad66f(0x350)] || [], 'comments': (_0x30d1ae[_0x2ad66f(0x8ce)] || [])[_0x2ad66f(0x7c6)]((_0x3ec1fe, _0x14805b) => ({ 'commentId': 'c_' + _0xe4c107 + '_' + _0x14805b, 'authorId': _0x3ec1fe['authorId'], 'content': _0x3ec1fe['content'] })) }; if (_0x30d1ae['postType'] === _0x2ad66f(0x8be) && _0x30d1ae[_0x2ad66f(0x5e6)] && _0x30d1ae[_0x2ad66f(0x942)]) { if (_0x2ad66f(0x3a1) === _0x2ad66f(0x825)) _0x283580['classList'][_0x2ad66f(0x6dd)](_0x2ad66f(0x60a)); else try { const _0x353944 = await _0x9a63ea(_0x30d1ae[_0x2ad66f(0x5e6)], _0x30d1ae[_0x2ad66f(0x942)]); _0x5e561f['type'] = 'music', _0x5e561f[_0x2ad66f(0x5e6)] = _0x30d1ae['songName'], _0x5e561f[_0x2ad66f(0x942)] = _0x30d1ae[_0x2ad66f(0x942)], _0x5e561f[_0x2ad66f(0x9fd)] = _0x353944[_0x2ad66f(0x43e)], _0x5e561f[_0x2ad66f(0x788)] = _0x353944['url']; } catch (_0x4143fe) { _0x2ad66f(0x4f3) !== _0x2ad66f(0xa6d) ? (console['error'](_0x2ad66f(0xaca), _0x4143fe), _0x5e561f['type'] = _0x2ad66f(0x5bd)) : (_0x27c189 = _0x3b7e39[_0x2ad66f(0xa99)][0x0][_0x2ad66f(0xb3e)], _0x3cd69b = _0x25e1fe['touches'][0x0]['clientY'], _0x199ab2 = !![], _0x5f1fcd = ''); } } else _0x5e561f[_0x2ad66f(0x318)] = _0x2ad66f(0x5bd); return _0x5e561f; }), _0x110aaf = await Promise[_0x330cf8(0x304)](_0x2e42c7); _0x468cf0['posts'][_0x330cf8(0x8d9)](..._0x110aaf), _0x2ca195(); } catch (_0x203b0f) { 'EVznA' === _0x330cf8(0xb15) ? (_0x215e05[_0x330cf8(0xa9c)] = _0x3e174e[_0x330cf8(0xb77)], _0x3f941c[_0x330cf8(0xa1d)](), _0x1801f8[_0x330cf8(0xac8)](_0x330cf8(0x668))[_0x330cf8(0x1cd)] = '❚❚') : (console[_0x330cf8(0x27b)]('生成动态失败:', _0x203b0f), _0x15e83d(_0x330cf8(0x321) + _0x203b0f[_0x330cf8(0x722)])); } finally { if (_0x330cf8(0x3a4) === _0x330cf8(0x9c2)) { _0x29c851[_0x330cf8(0x6b7)] = _0x597973['chats'][_0x330cf8(0x3cf)](_0x1b9494 => _0x1b9494['id'] !== _0x438a1f); try { _0x1fad6a['removeItem'](_0x330cf8(0xb7a) + _0x409f0f); } catch (_0x3cfb46) { _0x23faae[_0x330cf8(0x27b)]('Failed\x20to\x20remove\x20history\x20for\x20chat\x20' + _0x1c0536, _0x3cfb46); } _0x1a6b14[_0x330cf8(0xb7c)] === _0x32c3e8 && (_0x1acd11[_0x330cf8(0xb7c)] = _0xf91552[_0x330cf8(0x6b7)][0x0]?.['id'] || null, _0x338736(_0x2bdc47[_0x330cf8(0xb7c)])), _0x344d41(), _0x19afde(); } else _0x36dd52(), _0xc9067c(![]), _0x2de116[_0x330cf8(0x3b8)] = ![]; } } async function _0x32ee2c(_0xccab9e) { const _0x161628 = _0x234a7d; if (_0x161628(0x93c) !== _0x161628(0x48c)) { const _0x45c933 = _0xccab9e[_0x161628(0x595)][_0x161628(0x7c6)](_0x1bbba5 => _0x11feaf(_0x1bbba5))[_0x161628(0x3cf)](Boolean); if (_0x45c933[_0x161628(0xaa7)] === 0x0) return null; const _0x5b106e = _0x3af87f(), _0x278450 = _0x48a42d(_0xccab9e[_0x161628(0x38d)]) || _0x2de116[_0x161628(0x613)][0x0], _0x9927a8 = _0x278450 ? _0x161628(0x680) + _0x278450[_0x161628(0x499)] + _0x161628(0xaa2) + (_0x278450[_0x161628(0x44a)] || '无') + '\x0a' : '', _0x3e2284 = _0x45c933[_0x161628(0x7c6)](_0xea12ea => { const _0x3fee79 = _0x161628, { omniText: _0x464399 } = _0x888912(_0xea12ea['id'], null), _0x3eea04 = _0x385577(_0xea12ea['id']), _0x211f8c = _0xea12ea[_0x3fee79(0xae1)] && _0xea12ea[_0x3fee79(0xae1)]['length'] > 0x0 ? '\x0a\x0a#\x20' + _0xea12ea[_0x3fee79(0x499)] + '的个人专属世界观设定\x0a' + _0xea12ea['linkedWorldBookIds'][_0x3fee79(0x7c6)](_0x558b2d => _0x2de116['worldBooks'][_0x3fee79(0xa68)](_0x481185 => _0x481185['id'] === _0x558b2d))[_0x3fee79(0x3cf)](Boolean)[_0x3fee79(0x7c6)](_0x192d27 => _0x3fee79(0xa66) + _0x192d27[_0x3fee79(0x499)] + '\x0a' + _0x192d27[_0x3fee79(0x5e2)])[_0x3fee79(0x6cf)]('') : ''; return _0x3fee79(0x352) + _0xea12ea['name'] + ',\x20ID:\x20' + _0xea12ea['id'] + _0x3fee79(0x6d2) + _0xea12ea[_0x3fee79(0x44a)] + _0x3fee79(0x42a) + _0x464399 + '\x0a' + _0x3eea04 + '\x0a' + _0x211f8c; })[_0x161628(0x6cf)]('\x0a\x0a'), _0x475916 = Math[_0x161628(0x1e2)](Math[_0x161628(0x77b)]() * 0x3) + 0x2, _0x159119 = _0x161628(0x88a) + _0x475916 + '条】全新的、高质量的社交动态。\x0a\x0a#\x20好友圈成员信息\x0a' + _0x3e2284 + '\x0a' + _0x9927a8 + '\x0a#\x20最近的动态回顾\x20(供参考，避免重复)\x0a' + _0x5b106e + _0x161628(0xa6a) + _0x475916 + _0x161628(0x219) + _0x475916 + _0x161628(0x8fe), _0x2629e6 = [{ 'role': _0x161628(0x456), 'content': _0x159119 }, { 'role': _0x161628(0x7da), 'content': '请根据以上所有信息，开始分析并返回JSON。' }]; _0x2629e6[_0x161628(0x8d9)]({ 'role': 'user', 'content': _0x161628(0x3fd) + _0x475916 + '\x20条新动态。' }); try { if (_0x161628(0x3f8) !== 'RcfaJ') _0x1c5871['error']('在准备API数据时，从IndexedDB读取图片失败:', _0x2e8946); else { const _0x49299f = await _0x4df70c(_0x2629e6, { 'json': !![] }), _0x37a1aa = _0x49299f[_0x161628(0x435)](/(\[[\s\S]*\])/); if (!_0x37a1aa) throw new Error(_0x161628(0x626)); const _0x239d1c = _0x37a1aa[0x1], _0x4aa194 = JSON[_0x161628(0x57f)](_0x239d1c); if (!Array[_0x161628(0x75c)](_0x4aa194)) throw new Error(_0x161628(0x4ef)); return _0x4aa194; } } catch (_0x4f9b2b) { return console[_0x161628(0x27b)](_0x161628(0xa55), _0x4f9b2b), console[_0x161628(0x27b)](_0x161628(0x58b), _0x4f9b2b[_0x161628(0xbaa)] || _0x161628(0x60f)), null; } } else { _0x10508a[_0x161628(0x8f7)] = [..._0x5e9550]; const _0x21910c = _0x5733ce[_0x161628(0x8f7)]['shift'](); _0x55161a[_0x161628(0x1cd)] = _0x21910c[_0x161628(0xbbe)] === 'narrator' ? '旁白' : _0x21910c[_0x161628(0xbbe)], _0x5a7659[_0x161628(0x1cd)] = _0x21910c[_0x161628(0x910)], _0x21910c[_0x161628(0xbbe)] !== _0x161628(0x5f8) && _0x46e01c(_0xf81b9c[_0x161628(0x2df)], _0x21910c[_0x161628(0x453)]); } } async function _0x309133() { const _0x573a42 = _0x234a7d, _0x10240a = _0x2de116['friendCircles']['find'](_0x5b7ad5 => _0x5b7ad5['id'] === _0x2de116[_0x573a42(0x42d)]); if (!_0x10240a) return; const _0x50e2c9 = await _0x2244b3(_0x573a42(0x2c5) + _0x10240a[_0x573a42(0x499)] + _0x573a42(0xae7)); _0x50e2c9 && (_0x10240a[_0x573a42(0x415)] = [], _0x2ca195(), _0x36dd52(), _0x15e83d('动态已清空。')); } function _0x36dd52() { const _0x210b46 = _0x234a7d, _0x598535 = document['getElementById'](_0x210b46(0xb36)), _0x43b30c = _0x2de116[_0x210b46(0xa05)][_0x210b46(0xa68)](_0x3a1f43 => _0x3a1f43['id'] === _0x2de116[_0x210b46(0x42d)]); if (!_0x43b30c) { _0x598535['innerHTML'] = _0x210b46(0x490); return; } if (!_0x43b30c[_0x210b46(0x415)] || _0x43b30c[_0x210b46(0x415)][_0x210b46(0xaa7)] === 0x0) { _0x598535['innerHTML'] = _0x210b46(0xafc); return; } _0x598535['innerHTML'] = ''; const _0x5afa91 = [..._0x43b30c[_0x210b46(0x415)]]['sort']((_0x566076, _0x1d7d8d) => _0x1d7d8d[_0x210b46(0xa71)] - _0x566076[_0x210b46(0xa71)]); _0x5afa91[_0x210b46(0x201)](_0x2dd71 => { const _0x2c1625 = _0x210b46, _0x25dae0 = document[_0x2c1625(0xb35)](_0x2c1625(0x4e8)); _0x25dae0[_0x2c1625(0xaff)] = _0x2c1625(0x462); let _0x19245a = '未知', _0x20a806 = _0x322703; if (_0x2dd71[_0x2c1625(0xb7f)] === _0x2c1625(0x7da)) { const _0x5b1ceb = _0x48a42d(_0x2dd71[_0x2c1625(0x50c)]); _0x5b1ceb && (_0x19245a = _0x5b1ceb[_0x2c1625(0x499)], _0x20a806 = _0x5b1ceb[_0x2c1625(0x41d)]); } else { const _0x34851f = _0x11feaf(_0x2dd71[_0x2c1625(0x50c)]); _0x34851f && (_0x19245a = _0x34851f[_0x2c1625(0x499)], _0x20a806 = _0x34851f[_0x2c1625(0x41d)]); } const _0x3e9b6f = _0x2c1625(0xa96) + _0x20a806 + _0x2c1625(0x418) + _0x19245a + _0x2c1625(0x7df), _0x104890 = _0x2c1625(0x85d) + _0x2dd71[_0x2c1625(0x5e2)] + _0x2c1625(0xb3f); let _0x13559d = ''; if (_0x2dd71[_0x2c1625(0x6a9)] || _0x2dd71['imageId']) { const _0x194b07 = _0x2c1625(0x34e) + _0x2dd71['id']; _0x13559d = '<div\x20class=\x22post-image-container\x22><img\x20id=\x22' + _0x194b07 + _0x2c1625(0xa85), setTimeout(() => { const _0x5c41ef = _0x2c1625; if ('EClYG' !== _0x5c41ef(0x1f3)) { const _0x49ed6f = document[_0x5c41ef(0x8f3)](_0x194b07); if (!_0x49ed6f) return; if (_0x2dd71[_0x5c41ef(0x6a9)]) _0x49ed6f[_0x5c41ef(0xa9c)] = _0x2dd71[_0x5c41ef(0x6a9)]; else _0x2dd71[_0x5c41ef(0x472)] && (_0x5c41ef(0x9bf) === 'BQbRk' ? _0x8e673e[_0x5c41ef(0x8d9)](_0x4ae739[_0x5c41ef(0xa38)](_0x4ca4d3, _0x4c8e23 + _0x25428d)) : _0x26239c(_0x2dd71[_0x5c41ef(0x472)])[_0x5c41ef(0xad3)](_0x3517d9 => { const _0x12f2a0 = _0x5c41ef; if (_0x3517d9) { const _0x4ac3c6 = URL[_0x12f2a0(0x64d)](_0x3517d9); _0x49ed6f[_0x12f2a0(0xa9c)] = _0x4ac3c6, _0x49ed6f[_0x12f2a0(0x759)] = () => URL[_0x12f2a0(0x83c)](_0x4ac3c6); } })); } else { const _0x47c298 = _0xb7a2e[_0x5c41ef(0xb35)](_0x5c41ef(0x4e8)); _0x47c298['className'] = _0x5c41ef(0x2a8), _0x47c298[_0x5c41ef(0x3e0)][_0x5c41ef(0x345)] = 'column', _0x47c298[_0x5c41ef(0x3e0)][_0x5c41ef(0x5be)] = _0x5c41ef(0x5d4), _0x47c298['style'][_0x5c41ef(0x8c8)] = _0x5c41ef(0x66f), _0x47c298['style']['gap'] = '0'; const _0x1e66be = _0x725ec[_0x3dfcf2[_0x5c41ef(0x1cb)]] || _0x2746df['默认'], _0x4fed66 = _0x5c41ef(0x833) + _0x1e66be + _0x5c41ef(0xaee), _0x171ea7 = _0x5c41ef(0x98c) + _0x4fed66 + _0x5c41ef(0x5b5) + _0x4a077c['description'] + '</div><div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x22>' + (_0x125d85[_0x5c41ef(0x1cb)] || _0x5c41ef(0x8a3)) + _0x5c41ef(0x40d) + (_0x448d08[_0x5c41ef(0x22e)] || 0x0)['toFixed'](0x2) + _0x5c41ef(0x4ac); let _0x2d6902 = ''; if (_0x23cd2f['review'] && _0x38269d['review'][_0x5c41ef(0x59a)]) { const _0x47ece1 = _0x177d4a(_0x671398[_0x5c41ef(0x7ca)][_0x5c41ef(0x59a)]); _0x47ece1 && (_0x2d6902 = _0x5c41ef(0x4c8) + _0x47ece1[_0x5c41ef(0x41d)] + _0x5c41ef(0x85e) + _0x47ece1[_0x5c41ef(0x499)] + _0x5c41ef(0x48a) + _0x182d30[_0x5c41ef(0x7ca)]['text'] + '</div></div></div>'); } _0x47c298[_0x5c41ef(0x82c)] = _0x171ea7 + _0x2d6902, _0x1a350d['appendChild'](_0x47c298); } }, 0x0); } let _0x23519c = ''; _0x2dd71[_0x2c1625(0x318)] === 'music' && _0x2dd71[_0x2c1625(0x5e6)] && (_0x23519c = '\x0a\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22' + _0x2dd71['id'] + _0x2c1625(0x580) + (_0x2dd71[_0x2c1625(0x9fd)] || _0x322703) + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x2dd71[_0x2c1625(0x5e6)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x2dd71[_0x2c1625(0x942)] + _0x2c1625(0x8eb) + (_0x2dd71[_0x2c1625(0x788)] ? '▶' : '⚠') + _0x2c1625(0x236)); const _0x3d9a63 = '<div\x20class=\x22post-timestamp\x22>' + new Date(_0x2dd71[_0x2c1625(0xa71)])[_0x2c1625(0xb18)](_0x2c1625(0x2e3)) + '</div>'; let _0x212539 = ''; if (_0x2dd71['likes'] && _0x2dd71[_0x2c1625(0x350)]['length'] > 0x0 || _0x2dd71[_0x2c1625(0x8ce)] && _0x2dd71[_0x2c1625(0x8ce)][_0x2c1625(0xaa7)] > 0x0) { let _0x5461c6 = ''; if (_0x2dd71[_0x2c1625(0x350)] && _0x2dd71['likes']['length'] > 0x0) { const _0xf95b04 = _0x2dd71[_0x2c1625(0x350)][_0x2c1625(0x7c6)](_0x39247d => _0x11feaf(_0x39247d)?.[_0x2c1625(0x499)] || '未知')[_0x2c1625(0x6cf)]('、'), _0x2a0078 = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>'; _0x5461c6 = _0x2c1625(0x2c2) + _0x2a0078 + '\x20' + _0xf95b04 + _0x2c1625(0x806); } let _0x3921fc = ''; if (_0x2dd71[_0x2c1625(0x8ce)] && _0x2dd71['comments']['length'] > 0x0) { const _0xbc2737 = _0x2dd71[_0x2c1625(0x8ce)]['map'](_0x4027ca => { const _0x403dfc = _0x2c1625; if (_0x403dfc(0x5c3) === 'olWsY') return (_0x516de7?.[_0x403dfc(0x393)] || [])[_0x403dfc(0xa68)](_0x6fd9b1 => _0x6fd9b1['id'] === _0x4bfe12); else { const _0xf3cff1 = _0x11feaf(_0x4027ca[_0x403dfc(0x50c)])?.['name'] || '未知'; return _0x403dfc(0x5cf) + _0xf3cff1 + _0x403dfc(0x903) + _0x4027ca[_0x403dfc(0x5e2)] + _0x403dfc(0x806); } })['join'](''); _0x3921fc = _0x2c1625(0x5c4) + _0xbc2737 + _0x2c1625(0x806); } _0x212539 = _0x2c1625(0x9e2) + _0x5461c6 + _0x2c1625(0x67c) + _0x3921fc + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20'; } const _0x23b757 = _0x2c1625(0x5c1) + _0x104890 + _0x13559d + _0x23519c + '</div>'; _0x25dae0[_0x2c1625(0x82c)] = _0x3e9b6f + _0x23b757 + _0x3d9a63 + _0x212539; if (_0x2dd71['type'] === 'music' && _0x2dd71[_0x2c1625(0x788)]) { const _0x50b87a = _0x25dae0[_0x2c1625(0xac8)]('.music-post-song-card'); if (_0x50b87a) { if (_0x2c1625(0x502) === _0x2c1625(0xa26)) return _0x57a62d + _0x2c1625(0x2a1); else _0x50b87a[_0x2c1625(0x85f)](_0x2c1625(0xbba), function () { const _0x3fd156 = _0x2c1625, _0x2d8425 = { 'id': _0x2dd71['id'], 'url': _0x2dd71[_0x3fd156(0x788)] }; _0x33cb9b(this, _0x2d8425); }); } } _0x598535[_0x2c1625(0x3bf)](_0x25dae0); }); } document[_0x234a7d(0x8f3)](_0x234a7d(0x797))[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x309133), document['getElementById'](_0x234a7d(0x367))[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x198189), document[_0x234a7d(0x8f3)](_0x234a7d(0x713))['addEventListener']('click', () => _0x2faf14(_0x234a7d(0x4ab), 'friendCircleList')), document['getElementById']('add-friend-circle-button')[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0x5e183a()), document[_0x234a7d(0x8f3)](_0x234a7d(0xbb6))['addEventListener']('click', () => _0x2faf14('friendCircleList', _0x234a7d(0x604))), document[_0x234a7d(0x8f3)](_0x234a7d(0x374))['addEventListener'](_0x234a7d(0xbba), _0x12d994), document['getElementById'](_0x234a7d(0x974))['addEventListener'](_0x234a7d(0xbba), _0x4c0620), document[_0x234a7d(0x8f3)](_0x234a7d(0x97f))[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0xb07cb8 = _0x234a7d; _0x12ae0d(), _0x2faf14(_0xb07cb8(0x640), 'music'); }), document[_0x234a7d(0x8f3)](_0x234a7d(0x245))[_0x234a7d(0x85f)]('click', () => { const _0x1feaa7 = _0x234a7d; if ('fQDYr' === 'fQDYr') _0x2de116[_0x1feaa7(0x42d)] && _0x5e183a(_0x2de116['activeFriendCircleId']); else { const _0x1b4422 = { 'id': 'user_' + _0x3b3feb[_0x1feaa7(0x83b)](), 'name': _0x287269[_0x1feaa7(0xb88)][_0x1feaa7(0x499)] || '我', 'avatar': _0x1c6761['userProfile'][_0x1feaa7(0x41d)] || _0x58b023, 'persona': _0x168d16[_0x1feaa7(0xb88)][_0x1feaa7(0x44a)] || '' }; _0x534dec[_0x1feaa7(0x613)] = [_0x1b4422], _0x2c7ac9[_0x1feaa7(0xabe)] = _0x1b4422['id']; } }), document[_0x234a7d(0x8f3)]('user-send-post-button')[_0x234a7d(0x85f)](_0x234a7d(0xbba), async () => { const _0x22547a = _0x234a7d, _0x5264bf = _0x2de116[_0x22547a(0xa05)][_0x22547a(0xa68)](_0x5535f2 => _0x5535f2['id'] === _0x2de116['activeFriendCircleId']); if (!_0x5264bf || _0x2de116['isGenerating']) return; const _0x56bc5f = _0x5264bf['boundUserProfileId'], _0x49fc39 = _0x2de116[_0x22547a(0x613)][_0x22547a(0xa68)](_0x4f93b3 => _0x4f93b3['id'] === _0x56bc5f); if (!_0x49fc39) { _0x15e83d(_0x22547a(0xaaf)); return; } const _0x383268 = document[_0x22547a(0x8f3)](_0x22547a(0xa7e))[_0x22547a(0xa35)][_0x22547a(0x44c)](), _0xdb3606 = _0x2de116[_0x22547a(0x6e4)][_0x22547a(0x6a9)], _0x57cb43 = _0x2de116['pendingPostAttachments']['music'], _0x2980d6 = _0x2de116[_0x22547a(0x6e4)]['imageId']; if (!_0x383268 && !_0xdb3606 && !_0x57cb43) { _0x15e83d('总得说点什么吧？'); return; } const _0x408106 = { 'id': _0x22547a(0x2a2) + Date[_0x22547a(0x83b)](), 'authorType': _0x22547a(0x7da), 'authorId': _0x49fc39['id'], 'content': _0x383268, 'timestamp': Date['now'](), 'likes': [], 'comments': [] }; if (_0x2980d6) { if (_0x22547a(0xabb) !== 'iRDaW') _0x408106[_0x22547a(0x472)] = _0x2980d6; else { const _0x4b571e = _0x4220e1[_0x22547a(0x8f3)](_0x22547a(0x7e0)), _0x32d2e4 = _0x378af5[_0x22547a(0x8f3)](_0x22547a(0x51d)), _0x524e51 = new _0x476d43(), _0x427f6c = _0x236988[_0x22547a(0x669)][_0x22547a(0x3cf)](_0x5a3f5c => new _0x4c9c68(_0x5a3f5c[_0x22547a(0xa71)])[_0x22547a(0x5bc)]() === _0x524e51[_0x22547a(0x5bc)]()); if (_0x427f6c['length'] === 0x0) { _0x4b571e[_0x22547a(0x82c)] = _0x22547a(0x765), _0x32d2e4[_0x22547a(0x82c)] = ''; return; } _0x4b571e[_0x22547a(0x82c)] = '', _0x427f6c[_0x22547a(0xb71)]((_0x50071a, _0x2aaa73) => _0x2aaa73[_0x22547a(0xa71)] - _0x50071a['timestamp'])['forEach'](_0x2dd692 => { const _0x47bf4e = _0x22547a, _0x2ec417 = _0x3717d4[_0x47bf4e(0xb35)](_0x47bf4e(0x4e8)); _0x2ec417[_0x47bf4e(0xaff)] = _0x47bf4e(0x2a8), _0x2ec417[_0x47bf4e(0x82c)] = _0x47bf4e(0x2ad) + _0x2dd692[_0x47bf4e(0x7ab)] + '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20' + _0x2dd692[_0x47bf4e(0x22e)][_0x47bf4e(0xaeb)](0x2) + '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22' + _0x2dd692['id'] + '\x22>&times;</button></div>', _0x4b571e['appendChild'](_0x2ec417); }), _0x32d2e4 && (_0x32d2e4['innerHTML'] = _0x22547a(0x3b7), _0x419233['getElementById'](_0x22547a(0x6c9))[_0x22547a(0x85f)](_0x22547a(0xbba), _0x4660ce)); } } else _0xdb3606 && (_0x22547a(0x9a4) === 'qnTDR' ? _0x408106['image'] = _0xdb3606 : _0x59182a['addEventListener']('click', function () { const _0x2d5e19 = _0x22547a, _0x2f2070 = { 'id': _0x2d5e19(0x541) + _0x436e0f['timestamp'], 'url': _0x3683f0[_0x2d5e19(0x788)] }; _0xfc6ef4(this, _0x2f2070); })); _0x57cb43 ? (_0x408106[_0x22547a(0x318)] = 'music', Object[_0x22547a(0x44f)](_0x408106, _0x57cb43)) : _0x408106[_0x22547a(0x318)] = _0x22547a(0x5bd), _0x5264bf['posts']['push'](_0x408106), _0x2ca195(), _0x36dd52(), document[_0x22547a(0x8f3)](_0x22547a(0xa7e))['value'] = '', _0x2de116['pendingPostAttachments']['image'] = null, _0x2de116['pendingPostAttachments'][_0x22547a(0x8be)] = null, _0x2de116[_0x22547a(0x6e4)][_0x22547a(0x472)] = null, _0x387918(), _0x578489(_0x408106); }), document['getElementById'](_0x234a7d(0x2fc))[_0x234a7d(0x85f)]('click', () => { const _0x4e370b = _0x234a7d; document[_0x4e370b(0x8f3)]('user-post-image-input')[_0x4e370b(0xbba)](); }), document[_0x234a7d(0x8f3)]('user-post-image-input')[_0x234a7d(0x85f)](_0x234a7d(0x69c), async _0x45dc58 => { const _0x2e2e52 = _0x234a7d; if ('cXEUu' === 'zVicA') _0x32bfb5 += '\x20[并分享了歌曲:\x20' + _0x7bb548['songName'] + _0x2e2e52(0x32f) + _0x638522[_0x2e2e52(0x942)] + ']'; else { const _0x38ccee = _0x45dc58[_0x2e2e52(0x48e)][_0x2e2e52(0x6f1)][0x0]; if (!_0x38ccee) return; try { const _0x1ea96a = await _0x14be18(_0x38ccee, 0x320, 0.8, !![]), _0x547b90 = 'post_image_' + Date[_0x2e2e52(0x83b)](); await _0x1d2a3c(_0x547b90, _0x1ea96a), _0x2de116[_0x2e2e52(0x6e4)][_0x2e2e52(0x472)] = _0x547b90, _0x2de116[_0x2e2e52(0x6e4)]['image'] = null, _0x2de116['pendingPostAttachments']['music'] = null, _0x387918(); } catch (_0x446637) { _0x15e83d(_0x2e2e52(0xb57) + _0x446637['message']); } _0x45dc58[_0x2e2e52(0x48e)]['value'] = ''; } }), document[_0x234a7d(0x8f3)](_0x234a7d(0x72e))[_0x234a7d(0x85f)](_0x234a7d(0xbba), async () => { const _0x452386 = _0x234a7d; if (_0x452386(0x3d9) === _0x452386(0x3d9)) { const _0x3dec18 = await _0x29ff8f(); if (!_0x3dec18) return; _0x15e83d(_0x452386(0x91f)); try { const _0x54e72c = await _0x9a63ea(_0x3dec18[_0x452386(0x5e6)], _0x3dec18[_0x452386(0x942)]); _0x2de116[_0x452386(0x6e4)]['music'] = { 'songName': _0x3dec18[_0x452386(0x5e6)], 'artist': _0x3dec18[_0x452386(0x942)], 'coverUrl': _0x54e72c[_0x452386(0x43e)], 'playableUrl': _0x54e72c[_0x452386(0xb77)] }, _0x2de116[_0x452386(0x6e4)]['image'] = null, _0x387918(); } catch (_0x4c94d5) { _0x15e83d('音乐搜索失败:\x20' + _0x4c94d5[_0x452386(0x722)]); } } else { const _0x320d3f = _0x1bfcc0[_0x452386(0x8f3)]('toast'); _0x320d3f['textContent'] = _0x3ea444, _0x320d3f['style'][_0x452386(0xab9)] = _0x452386(0x5ac); if (_0x2f525f['_t']) _0x49692a(_0x3a26f9['_t']); _0x4c63d5['_t'] = _0x5d2428(() => { const _0xa0b45f = _0x452386; _0x320d3f[_0xa0b45f(0x3e0)][_0xa0b45f(0xab9)] = 'none'; }, 0x640); } }); function _0x1de543() { const _0x667e7e = _0x234a7d; if ('ILsDB' === _0x667e7e(0x916)) { const _0xa618ea = new Date(), _0xe4bd05 = document[_0x667e7e(0x8f3)](_0x667e7e(0x5a3)), _0x507758 = document['getElementById'](_0x667e7e(0x906)); if (_0xe4bd05 && _0x507758) { const _0xc8b90f = String(_0xa618ea[_0x667e7e(0x6ca)]())[_0x667e7e(0x6f9)](0x2, '0'), _0x33d1fc = String(_0xa618ea[_0x667e7e(0x6d3)]())[_0x667e7e(0x6f9)](0x2, '0'); _0xe4bd05[_0x667e7e(0x1cd)] = _0xc8b90f + ':' + _0x33d1fc; const _0x4df593 = _0xa618ea[_0x667e7e(0xbbb)]() + 0x1, _0x1ddae4 = _0xa618ea[_0x667e7e(0x6b8)](), _0x5de10d = [_0x667e7e(0x2c8), _0x667e7e(0x67a), _0x667e7e(0x324), _0x667e7e(0x9be), _0x667e7e(0x3fa), _0x667e7e(0x430), '星期六'][_0xa618ea[_0x667e7e(0x7f3)]()]; _0x507758[_0x667e7e(0x1cd)] = _0x4df593 + '月' + _0x1ddae4 + '日\x20' + _0x5de10d; } } else _0x52c139[_0x667e7e(0x27b)](_0x667e7e(0xb85), _0x46b90e), _0x1995ba(_0x667e7e(0x310) + _0x11ee99[_0x667e7e(0x722)]); } function _0x5fb6a6(_0x36f198) { const _0x309594 = _0x234a7d; if (!_0x36f198) return ''; const _0x2c9cc8 = new Date(_0x36f198), _0x147674 = String(_0x2c9cc8[_0x309594(0x6ca)]())['padStart'](0x2, '0'), _0x49cdb3 = String(_0x2c9cc8[_0x309594(0x6d3)]())[_0x309594(0x6f9)](0x2, '0'); return _0x147674 + ':' + _0x49cdb3; } function _0x3af87f() { const _0x330a9a = _0x234a7d; if (_0x330a9a(0x6b4) !== 'QQqvS') throw new _0x54dc96(_0x330a9a(0x556)); else { const _0x56ce83 = _0x2de116[_0x330a9a(0xa05)][_0x330a9a(0xa68)](_0x18de7e => _0x18de7e['id'] === _0x2de116[_0x330a9a(0x42d)]), _0x572342 = _0x56ce83 ? _0x56ce83[_0x330a9a(0x415)] : []; if (!_0x572342 || _0x572342['length'] === 0x0) return ''; const _0x3b4a02 = _0x572342[_0x330a9a(0xa38)](0x0, 0x5), _0x12d40a = _0x3b4a02[_0x330a9a(0x7c6)](_0x7b8968 => { const _0x4e07a1 = _0x330a9a, _0x1cad56 = _0x11feaf(_0x7b8968['authorId']) || { 'name': '未知' }; let _0x1d3e0d = _0x4e07a1(0x561) + _0x1cad56[_0x4e07a1(0x499)] + _0x4e07a1(0x9bc) + (_0x7b8968[_0x4e07a1(0x243)] || _0x7b8968['content']) + '”'; return _0x7b8968[_0x4e07a1(0x318)] === _0x4e07a1(0x8be) && (_0x1d3e0d += _0x4e07a1(0x85a) + _0x7b8968['songName'] + _0x4e07a1(0x32f) + _0x7b8968[_0x4e07a1(0x942)] + ')'), _0x1d3e0d; }); return _0x330a9a(0x4fa) + _0x12d40a['join']('\x0a'); } } function _0x385577(_0x1fb8ef) { const _0x3336cf = _0x234a7d, _0x53240a = _0x2de116['userProfiles'][_0x3336cf(0xa68)](_0x19851a => _0x19851a['id'] === _0x2de116['activeUserProfileId']) || { 'name': '你' }, _0x36dc3e = _0x2de116[_0x3336cf(0x38b)]['find'](_0x2cc706 => _0x2cc706['characterId'] === _0x1fb8ef); if (!_0x36dc3e || !_0x36dc3e[_0x3336cf(0x71c)] || _0x36dc3e['entries'][_0x3336cf(0xaa7)] === 0x0) return ''; const _0xb9eda6 = _0x36dc3e[_0x3336cf(0x71c)][_0x3336cf(0xa38)](-0x8), _0x467d50 = _0xb9eda6[_0x3336cf(0x7c6)](_0x565aa6 => { const _0x10dfeb = _0x3336cf, _0x4b9652 = _0x565aa6[_0x10dfeb(0x5bb)] === _0x10dfeb(0x7da) ? _0x53240a[_0x10dfeb(0x499)] : _0x11feaf(_0x565aa6['author'])[_0x10dfeb(0x499)]; return _0x10dfeb(0x89b) + new Date(_0x565aa6[_0x10dfeb(0xa71)])[_0x10dfeb(0x9e4)]() + ']\x20' + _0x4b9652 + _0x10dfeb(0x3e6) + _0x565aa6['content']; })[_0x3336cf(0x6cf)]('\x0a'); return _0x3336cf(0x983) + _0x53240a[_0x3336cf(0x499)] + '\x20之间的私密内容)\x0a' + _0x467d50; } function _0x4a0ae5() { const _0x1f2f5a = _0x234a7d, _0x455d8d = document[_0x1f2f5a(0x8f3)]('music-widget-card'), _0x144b04 = _0x2de116['preferences'][_0x1f2f5a(0x56d)]; _0x144b04 ? (_0x455d8d[_0x1f2f5a(0x3e0)][_0x1f2f5a(0xaa3)] = 'url(' + _0x144b04 + ')', _0x455d8d[_0x1f2f5a(0x3e0)][_0x1f2f5a(0x76c)] = 'cover', _0x455d8d[_0x1f2f5a(0x3e0)][_0x1f2f5a(0x992)] = 'center', _0x455d8d['style']['color'] = _0x1f2f5a(0x83d), _0x455d8d[_0x1f2f5a(0x672)](_0x1f2f5a(0x1b6))['forEach'](_0xd21015 => { const _0x4cc8c3 = _0x1f2f5a; if (_0x4cc8c3(0x80b) === _0x4cc8c3(0x1d2)) try { const _0x185d54 = _0x352d4d[_0x4cc8c3(0x57f)](_0x38f277['getItem'](_0x4cc8c3(0x316)) || '{}'), _0x3e3dcd = { ..._0x185d54, ..._0x28e94e }; _0x2517eb[_0x4cc8c3(0x23c)]('badgeState', _0x356491[_0x4cc8c3(0x269)](_0x3e3dcd)); } catch (_0x3b6122) { _0x50cd3b[_0x4cc8c3(0x27b)](_0x4cc8c3(0x8b6), _0x3b6122); } else _0xd21015[_0x4cc8c3(0x3e0)][_0x4cc8c3(0x28a)] = _0x4cc8c3(0x303); })) : _0x1f2f5a(0x738) === _0x1f2f5a(0x738) ? (_0x455d8d['style'][_0x1f2f5a(0xaa3)] = '', _0x455d8d['style']['color'] = '', _0x455d8d[_0x1f2f5a(0x672)](_0x1f2f5a(0x1b6))['forEach'](_0x5132af => { const _0x52033c = _0x1f2f5a; if ('tJqwv' === 'AvTfP') { const _0x1e5dc9 = _0x4dcb6c[_0x52033c(0x613)][_0x52033c(0xa68)](_0x1abf68 => _0x1abf68['id'] === _0x12208e); if (!_0x1e5dc9) return; _0x4ce76f[_0x52033c(0x8f3)](_0x52033c(0x59c))[_0x52033c(0xa35)] = _0x1e5dc9['id'], _0x383db0[_0x52033c(0x8f3)](_0x52033c(0x9eb))[_0x52033c(0x1cd)] = _0x52033c(0x553), _0x257436['getElementById'](_0x52033c(0xad2))['value'] = _0x1e5dc9['name'], _0x1e5dc9[_0x52033c(0x41d)] ? _0x3a15a0[_0x52033c(0x3e0)][_0x52033c(0xaa3)] = 'url(\x27' + _0x1e5dc9[_0x52033c(0x41d)] + '\x27)' : _0x1d6b99[_0x52033c(0x3e0)][_0x52033c(0xaa3)] = _0x52033c(0x4c6) + _0x256882 + '\x27)', _0x2a26d2[_0x52033c(0x8f3)](_0x52033c(0x853))[_0x52033c(0xa35)] = _0x1e5dc9[_0x52033c(0x44a)], _0x12fb1d['style'][_0x52033c(0xab9)] = _0x1e5dc9['id'] === _0x1285ac[_0x52033c(0xabe)] ? 'none' : _0x52033c(0x5ac), _0x3b63cc[_0x52033c(0x8f3)]('delete-user-profile-button')[_0x52033c(0x3e0)][_0x52033c(0xab9)] = _0x52033c(0x5ac); } else _0x5132af[_0x52033c(0x3e0)][_0x52033c(0x28a)] = ''; })) : _0x121bad = _0x421bcc(() => { const _0x470c43 = _0x1f2f5a; if (_0x229e2e[_0x470c43(0x318)] === _0x470c43(0x534)) _0x2a3362[_0x470c43(0xb16)](); _0x23d511(_0x2437bd); }, 0x320); } const _0x113394 = document[_0x234a7d(0x8f3)](_0x234a7d(0xa1b)), _0x55e10d = document[_0x234a7d(0x8f3)](_0x234a7d(0x399)); _0x113394['addEventListener']('click', () => { const _0x16ecff = _0x234a7d; _0x12ae0d(), _0x2faf14(_0x16ecff(0x640), 'home'); }), _0x55e10d['addEventListener'](_0x234a7d(0xbba), () => { const _0x28eb11 = _0x234a7d; _0x4c5bba(), _0x2faf14(_0x28eb11(0x403), _0x28eb11(0x4ab)); }), document[_0x234a7d(0x8f3)](_0x234a7d(0x4ce))[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x192836 = _0x234a7d; _0x192836(0x3d5) !== _0x192836(0x3d5) ? _0x462568[_0x192836(0x64a)] === 'Enter' && !_0x22144f[_0x192836(0x283)] && (_0x13f2fc['preventDefault'](), _0xb645ed()) : _0x2faf14(_0x192836(0x4ab), _0x192836(0x403)); }), document[_0x234a7d(0x8f3)]('back-to-meeting-list')['addEventListener'](_0x234a7d(0xbba), () => { const _0x550575 = _0x234a7d; if (_0x7a753) clearInterval(_0x7a753); _0x7a753 = null, _0x2de116[_0x550575(0x8f7)] = [], _0x2de116[_0x550575(0x2df)] = null, document[_0x550575(0x8f3)](_0x550575(0xb63))[_0x550575(0x3e0)][_0x550575(0xab9)] = _0x550575(0x1bf), _0x2de116[_0x550575(0xb7c)] = null, _0x2ca195(), _0x2faf14(_0x550575(0x403), _0x550575(0x834)); }); const _0x5ae111 = document[_0x234a7d(0x8f3)](_0x234a7d(0x348)), _0x3e4718 = document[_0x234a7d(0x8f3)](_0x234a7d(0x237)); _0x3e4718['addEventListener']('click', () => { const _0x48eaaa = _0x234a7d, _0x4310c4 = _0x5ae111['value'][_0x48eaaa(0x44c)](); _0x4310c4 && (_0x202e51(_0x4310c4), _0x5ae111['value'] = '', setTimeout(_0x525b8d, 0x64)); }); function _0x33cb9b(_0x7439af, _0x451d5e) { const _0x255091 = _0x234a7d; if (_0x255091(0xb28) !== _0x255091(0xb28)) _0x2f0f83(_0x2703a1['activeMeetingCharId'], _0x33e396[_0x255091(0x453)]); else { const _0x119b49 = document[_0x255091(0x8f3)](_0x255091(0x22f)), _0x12b025 = document['querySelectorAll'](_0x255091(0x668)); _0x12b025[_0x255091(0x201)](_0x2526c0 => { const _0x345ccc = _0x255091; _0x2526c0 !== _0x7439af['querySelector'](_0x345ccc(0x668)) && (_0x345ccc(0xa2b) === _0x345ccc(0xa2b) ? _0x2526c0[_0x345ccc(0x1cd)] = '▶' : _0x42cc08 = _0x4f7cbd['at'](-0x1)); }); if (_0x119b49[_0x255091(0xa9c)] === _0x451d5e[_0x255091(0xb77)] && !_0x119b49['paused']) { if ('KVgmk' !== _0x255091(0x987)) { _0x51485f[_0x255091(0x59f)] = [], _0x397d0d(); return; } else _0x119b49[_0x255091(0x742)](), _0x7439af['querySelector']('.music-post-play-icon,\x20.music-share-play-icon')['textContent'] = '▶'; } else _0x119b49[_0x255091(0xa9c)] = _0x451d5e[_0x255091(0xb77)], _0x119b49[_0x255091(0xa1d)](), _0x7439af[_0x255091(0xac8)](_0x255091(0x668))[_0x255091(0x1cd)] = '❚❚'; } } const _0x183b92 = document['getElementById']('music-player-bar'); async function _0x1bce1e(_0x3acd7a) { const _0x2a10e6 = _0x234a7d; if (!_0x3acd7a || !_0x3acd7a[_0x2a10e6(0x3df)](_0x2a10e6(0x278))) return ![]; return new Promise(_0x14b636 => { const _0x4c8dbf = _0x2a10e6; if (_0x4c8dbf(0x529) === 'teKDj') { let _0xfe19eb = null; if (_0x3f67d0?.[_0x4c8dbf(0x318)] === _0x4c8dbf(0x2c0)) _0xfe19eb = _0x5b8d21; else _0x356fc5?.[_0x4c8dbf(0x318)] === 'group' && _0x1d21f4 && (_0xfe19eb = _0x5a3a1b(_0x4186ab)); _0xfe19eb && (_0x346ecf = _0xfe19eb['avatarFrameUrl'] || ''); } else { const _0x5b2b9b = document[_0x4c8dbf(0xb35)](_0x4c8dbf(0x417)); _0x5b2b9b[_0x4c8dbf(0xa9c)] = _0x3acd7a; const _0x59384a = setTimeout(() => { const _0x31418e = _0x4c8dbf; if (_0x31418e(0x7c3) === _0x31418e(0x7c3)) _0x5defae(), _0x14b636(![]); else { _0xc73a34[_0x31418e(0xa35)] = '', _0x4f5756['innerHTML'] = ''; if (_0x4f339b[_0x31418e(0x393)][_0x31418e(0xaa7)] < 0x2) { _0x4b58fd(_0x31418e(0x616)); return; } _0x4e028e[_0x31418e(0x393)][_0x31418e(0x201)](_0x5a4cae => { const _0x1547d7 = _0x31418e, _0x3a5034 = _0x307f91[_0x1547d7(0xb35)]('li'); _0x3a5034['className'] = _0x1547d7(0x8ec), _0x3a5034['innerHTML'] = _0x1547d7(0x38c) + _0x5a4cae['id'] + _0x1547d7(0x4c0) + _0x5a4cae['id'] + _0x1547d7(0x60d) + (_0x5a4cae['avatar'] || _0x2ad35e) + _0x1547d7(0x96c) + _0x5a4cae['id'] + _0x1547d7(0x811) + _0x5a4cae[_0x1547d7(0x499)] + _0x1547d7(0x92a), _0x419ac2[_0x1547d7(0x3bf)](_0x3a5034); }), _0x54bf64('groupChatCreate', _0x31418e(0x801)); } }, 0xbb8), _0x5defae = () => { const _0x3f4c98 = _0x4c8dbf; clearTimeout(_0x59384a), _0x5b2b9b[_0x3f4c98(0x2f8)](_0x3f4c98(0x528), _0x135c20), _0x5b2b9b[_0x3f4c98(0x2f8)](_0x3f4c98(0x27b), _0xcf1c10), _0x5b2b9b[_0x3f4c98(0xa9c)] = '', _0x5b2b9b[_0x3f4c98(0x2e4)](); }, _0x135c20 = () => { const _0xe481a9 = _0x4c8dbf; if ('ilwkm' !== _0xe481a9(0x9a2)) return ''; else _0x5defae(), _0x14b636(!![]); }, _0xcf1c10 = () => { const _0xef0619 = _0x4c8dbf; _0xef0619(0xb3c) === _0xef0619(0xac2) ? _0x18af69 += _0xef0619(0x422) : (_0x5defae(), _0x14b636(![])); }; _0x5b2b9b[_0x4c8dbf(0x85f)](_0x4c8dbf(0x528), _0x135c20), _0x5b2b9b[_0x4c8dbf(0x85f)](_0x4c8dbf(0x27b), _0xcf1c10); } }); } async function _0x9a63ea(_0x42b1eb, _0x2e30bb) { const _0x1686b8 = _0x234a7d; if (_0x1686b8(0x30c) !== 'KoflX') _0x587e18(_0x1686b8(0x779) + _0x641084['message']); else { const _0x12757e = [_0x1686b8(0x99b), _0x1686b8(0x7f7)]; for (const _0x2ab6ca of _0x12757e) { try { const _0x13b2cc = _0x1686b8(0x592) + _0x2ab6ca + _0x1686b8(0x8c3) + encodeURIComponent(_0x42b1eb) + '-' + encodeURIComponent(_0x2e30bb), _0x23972b = await fetch(_0x13b2cc), _0x51ce3a = await _0x23972b[_0x1686b8(0x7ce)](); if (_0x51ce3a[_0x1686b8(0x8d4)] !== 0xc8 || !_0x51ce3a['data'] || _0x51ce3a['data']['length'] === 0x0) continue; const _0x1e92c9 = _0x51ce3a[_0x1686b8(0x1fa)]['slice'](0x0, 0x5); for (const _0x3f29bf of _0x1e92c9) { if (_0x1686b8(0x660) === _0x1686b8(0x660)) { const _0x451424 = _0x1686b8(0x592) + _0x2ab6ca + '?id=' + _0x3f29bf['id'], _0x503e14 = await fetch(_0x451424), _0x237e49 = await _0x503e14[_0x1686b8(0x7ce)](), _0x5ab73e = _0x237e49[_0x1686b8(0x1fa)]?.['url']; if (await _0x1bce1e(_0x5ab73e)) { if ('iogis' !== _0x1686b8(0x9e0)) { if (!_0x3650b1[_0x1686b8(0xa8b)]) return _0x342cdc[_0x1686b8(0x613)][_0x1686b8(0xa68)](_0x1adf80 => _0x1adf80['id'] === _0x2cdb6f['activeUserProfileId']) || _0x5969c8[_0x1686b8(0x613)][0x0]; const _0x190745 = _0xdd1175[_0x1686b8(0x6b7)][_0x1686b8(0xa68)](_0x15a1a1 => _0x15a1a1[_0x1686b8(0x318)] === _0x1686b8(0x2c0) && _0x15a1a1['participantIds'][_0x1686b8(0x8db)](_0xe1df98[_0x1686b8(0xa8b)])), _0x45ff38 = _0x190745?.[_0x1686b8(0x38d)] || _0x41fd13['activeUserProfileId']; return _0x1e6954[_0x1686b8(0x613)]['find'](_0x53a8a7 => _0x53a8a7['id'] === _0x45ff38) || _0x3cbd2a[_0x1686b8(0x613)][0x0]; } else return { 'url': _0x5ab73e, 'cover': _0x3f29bf[_0x1686b8(0x43e)], 'source': _0x2ab6ca }; } } else _0x5a5bca = _0x1686b8(0x7f9) + _0x2beee5 + _0x1686b8(0x7d0); } } catch (_0x55def9) { console[_0x1686b8(0x27b)](_0x1686b8(0x3d1) + _0x2ab6ca + ':', _0x55def9); } } return { 'url': null, 'cover': null, 'source': null }; } } function _0x4da878(_0x599a72) { const _0x218942 = _0x234a7d; try { const _0x41f619 = JSON[_0x218942(0x57f)](localStorage[_0x218942(0x54d)](_0x218942(0x316)) || '{}'), _0x590e0b = { ..._0x41f619, ..._0x599a72 }; localStorage['setItem']('badgeState', JSON['stringify'](_0x590e0b)); } catch (_0x458ac8) { 'taEVP' !== 'HjicF' ? console[_0x218942(0x27b)]('保存徽章状态失败', _0x458ac8) : _0x4559d8[_0x218942(0x64a)] === _0x218942(0xb56) && !_0x39a673[_0x218942(0x283)] && (_0x51a4a5[_0x218942(0xb16)](), _0x5c7936()); } } async function _0x2054b4() { const _0x2dcb14 = _0x234a7d, _0x46e73d = document['getElementById'](_0x2dcb14(0xb92)), _0x1a1d02 = document['getElementById'](_0x2dcb14(0x589)); try { let _0x4f46de = await _0x26239c(_0x2dcb14(0x1cf)); if (!_0x4f46de) { const _0x3f7262 = JSON[_0x2dcb14(0x57f)](localStorage[_0x2dcb14(0x54d)](_0x2dcb14(0x316)) || '{}'); _0x3f7262[_0x2dcb14(0x6a9)] && (_0x4f46de = await _0x1639b4(_0x3f7262['image']), await _0x1d2a3c(_0x2dcb14(0x1cf), _0x4f46de)); } if (_0x4f46de) _0x1a1d02['src'] = URL[_0x2dcb14(0x64d)](_0x4f46de), _0x1a1d02[_0x2dcb14(0x3e0)]['display'] = _0x2dcb14(0x5ac), _0x46e73d[_0x2dcb14(0x3e0)][_0x2dcb14(0x249)] = 'none'; else { if (_0x2dcb14(0xa62) === _0x2dcb14(0xa62)) _0x1a1d02[_0x2dcb14(0x3e0)][_0x2dcb14(0xab9)] = _0x2dcb14(0x1bf), _0x46e73d[_0x2dcb14(0x3e0)][_0x2dcb14(0x249)] = '2px\x20dashed\x20var(--border-color)'; else { const _0x1ce194 = { 'id': _0x54fd66['id'], 'url': _0x17df52[_0x2dcb14(0x788)] }; _0x25f243(this, _0x1ce194); } } _0x46e73d['style'][_0x2dcb14(0xab9)] = 'block'; } catch (_0x197a08) { if (_0x2dcb14(0xb7e) !== _0x2dcb14(0xb7e)) return []; else console[_0x2dcb14(0x27b)]('加载徽章图片失败', _0x197a08); } } async function _0x1724b5() { const _0x1a3a28 = _0x234a7d, _0x14acc4 = document[_0x1a3a28(0x8f3)](_0x1a3a28(0x46a)), _0x3a2732 = document['getElementById'](_0x1a3a28(0x3da)), _0xae9e2b = document[_0x1a3a28(0x8f3)]('card-widget-2'), _0x59c82f = document[_0x1a3a28(0x8f3)](_0x1a3a28(0x585)); try { if (_0x1a3a28(0x86d) === 'lqymE') _0x19e804[_0x1a3a28(0x3e0)][_0x1a3a28(0xab9)] = _0x1a3a28(0x1bf); else { let _0x7ea3bd = await _0x26239c(_0x1a3a28(0x3e9)); _0x7ea3bd ? (_0x3a2732[_0x1a3a28(0xa9c)] = URL[_0x1a3a28(0x64d)](_0x7ea3bd), _0x3a2732[_0x1a3a28(0x3e0)][_0x1a3a28(0xab9)] = 'block', _0x14acc4[_0x1a3a28(0x3e0)][_0x1a3a28(0x249)] = _0x1a3a28(0x1bf), _0x14acc4[_0x1a3a28(0x3e0)][_0x1a3a28(0x2ab)] = _0x1a3a28(0x299)) : (_0x3a2732[_0x1a3a28(0x3e0)]['display'] = _0x1a3a28(0x1bf), _0x14acc4[_0x1a3a28(0x3e0)][_0x1a3a28(0x249)] = _0x1a3a28(0x573), _0x14acc4[_0x1a3a28(0x3e0)]['background'] = _0x1a3a28(0xad4)); _0x14acc4[_0x1a3a28(0x3e0)][_0x1a3a28(0xab9)] = _0x1a3a28(0x5ac); let _0x3c9108 = await _0x26239c(_0x1a3a28(0x7f0)); _0x3c9108 ? (_0x59c82f['src'] = URL['createObjectURL'](_0x3c9108), _0x59c82f['style'][_0x1a3a28(0xab9)] = _0x1a3a28(0x5ac), _0xae9e2b['style'][_0x1a3a28(0x249)] = _0x1a3a28(0x1bf), _0xae9e2b[_0x1a3a28(0x3e0)][_0x1a3a28(0x2ab)] = _0x1a3a28(0x299)) : (_0x59c82f[_0x1a3a28(0x3e0)][_0x1a3a28(0xab9)] = 'none', _0xae9e2b['style'][_0x1a3a28(0x249)] = _0x1a3a28(0x573), _0xae9e2b[_0x1a3a28(0x3e0)][_0x1a3a28(0x2ab)] = _0x1a3a28(0xad4)), _0xae9e2b['style']['display'] = _0x1a3a28(0x5ac); } } catch (_0x265f9f) { console[_0x1a3a28(0x27b)](_0x1a3a28(0x2e8), _0x265f9f); } } async function _0x1724b5() { const _0x26f0e2 = _0x234a7d; if (_0x26f0e2(0x7f2) === _0x26f0e2(0x7f2)) { const _0xba3908 = document['getElementById']('card-widget'), _0x5acdd1 = document[_0x26f0e2(0x8f3)](_0x26f0e2(0x3da)); try { let _0x3931c7 = await _0x26239c(_0x26f0e2(0x3e9)); if (!_0x3931c7) { const _0x4e8a13 = JSON[_0x26f0e2(0x57f)](localStorage['getItem'](_0x26f0e2(0xa81)) || '{}'); _0x4e8a13[_0x26f0e2(0x6a9)] && (console[_0x26f0e2(0x754)]('正在搬运旧卡片...'), _0x3931c7 = await _0x1639b4(_0x4e8a13[_0x26f0e2(0x6a9)]), await _0x1d2a3c('widget_card', _0x3931c7)); } _0x3931c7 ? (_0x5acdd1[_0x26f0e2(0xa9c)] = URL[_0x26f0e2(0x64d)](_0x3931c7), _0xba3908[_0x26f0e2(0x3e0)][_0x26f0e2(0xab9)] = _0x26f0e2(0x5ac)) : _0xba3908[_0x26f0e2(0x3e0)][_0x26f0e2(0xab9)] = _0x26f0e2(0x1bf); } catch (_0x18d646) { console[_0x26f0e2(0x27b)](_0x26f0e2(0x2e8), _0x18d646); } try { let _0x222105 = await _0x26239c(_0x26f0e2(0x7f0)); const _0x2bd64e = document[_0x26f0e2(0x8f3)]('card-image-2'), _0x42eb5a = document[_0x26f0e2(0x8f3)](_0x26f0e2(0x72b)); _0x222105 ? (_0x2bd64e[_0x26f0e2(0xa9c)] = URL[_0x26f0e2(0x64d)](_0x222105), _0x42eb5a[_0x26f0e2(0x3e0)][_0x26f0e2(0xab9)] = _0x26f0e2(0x5ac)) : _0x42eb5a[_0x26f0e2(0x3e0)][_0x26f0e2(0xab9)] = _0x26f0e2(0x1bf); } catch (_0x2d89bc) { console['error'](_0x26f0e2(0xae6), _0x2d89bc); } } else _0x54e902[_0x26f0e2(0x8f3)](_0x26f0e2(0x33f) + _0x5efa80 + _0x26f0e2(0x314))[_0x26f0e2(0x3e0)][_0x26f0e2(0xaa3)] = 'url(\x27' + _0x51d591[_0x26f0e2(0x64d)](_0x292061) + '\x27)'; } _0x2ad70c['addEventListener'](_0x234a7d(0xbba), () => { const _0x46b4aa = _0x234a7d; _0x46b4aa(0x28d) !== 'cajNr' ? _0x2ad852[_0x46b4aa(0x27b)](_0x46b4aa(0x257) + _0x2446c2['activeChatId'], _0x743efe) : (_0x4104b8(), _0x2faf14('userProfileList', _0x46b4aa(0x4ab))); }), document[_0x234a7d(0x8f3)](_0x234a7d(0x65a))[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0x2faf14(_0x234a7d(0x4ab), _0x234a7d(0x413))), document['getElementById'](_0x234a7d(0x3b4))['addEventListener'](_0x234a7d(0xbba), () => _0x24932e()), document['getElementById'](_0x234a7d(0x4b9))[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x424b01 = _0x234a7d; _0x4104b8(), _0x2faf14(_0x424b01(0x413), _0x424b01(0xb88)); }), document[_0x234a7d(0x8f3)](_0x234a7d(0x3e7))[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x251ebe), document[_0x234a7d(0x8f3)](_0x234a7d(0x9a7))[_0x234a7d(0x85f)]('click', _0x1c60fa), document['getElementById']('set-active-user-button')[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x37955f = _0x234a7d, _0x359831 = document['getElementById'](_0x37955f(0x59c))['value']; _0x359831 && (_0x2de116[_0x37955f(0xabe)] = _0x359831, _0x2ca195(), _0x15e83d(_0x37955f(0x933)), _0x4104b8(), document[_0x37955f(0x8f3)]('set-active-user-button')[_0x37955f(0x3e0)]['display'] = _0x37955f(0x1bf)); }); function _0x41382f(_0x3d66a6) { const _0x1a213b = _0x234a7d; if (_0x1a213b(0xa0a) === _0x1a213b(0x4f7)) { const _0x5f5da0 = _0x919995[_0x1a213b(0x8ce)]['map'](_0xf9e199 => { const _0x375ece = _0x1a213b, _0x11d79a = _0x557767(_0xf9e199[_0x375ece(0x50c)])?.['name'] || '未知'; return _0x375ece(0x5cf) + _0x11d79a + '</span>:\x20' + _0xf9e199[_0x375ece(0x5e2)] + _0x375ece(0x806); })[_0x1a213b(0x6cf)](''); _0x2b2268 = _0x1a213b(0x5c4) + _0x5f5da0 + '</div>'; } else { const _0x4adfde = _0x2de116['chats'][_0x1a213b(0xa68)](_0x3963b6 => _0x3963b6['id'] === _0x3d66a6), _0xd9d9c8 = _0x4adfde?.['boundUserProfileId']; let _0x35a221 = _0x2de116[_0x1a213b(0x613)]['find'](_0x4e0ef9 => _0x4e0ef9['id'] === _0xd9d9c8); if (!_0x35a221) { if (_0x1a213b(0x4d8) === _0x1a213b(0x4d8)) _0x35a221 = _0x2de116['userProfiles']['find'](_0x343a55 => _0x343a55['id'] === _0x2de116[_0x1a213b(0xabe)]) || _0x2de116[_0x1a213b(0x613)][0x0]; else { const _0x3c690f = _0x478ca6[_0x1a213b(0x8f3)](_0x358fb8); if (_0x3c690f && _0x482d04) _0x3c690f[_0x1a213b(0xa9c)] = _0x1274c7[_0x1a213b(0x64d)](_0x393cc8); } } return _0x35a221 || { 'name': '用户', 'avatar': _0x176655, 'persona': '' }; } } function _0x58bad2(_0x4cedae) { const _0x4741a0 = _0x234a7d; if (_0x4741a0(0x6ac) === 'gRrxu') { const _0x109838 = document[_0x4741a0(0x8f3)](_0x4cedae); _0x109838[_0x4741a0(0x82c)] = '', _0x2de116[_0x4741a0(0x613)]['forEach'](_0x2260ed => { const _0x457da6 = _0x4741a0, _0x4697af = document[_0x457da6(0xb35)]('option'); _0x4697af[_0x457da6(0xa35)] = _0x2260ed['id'], _0x4697af[_0x457da6(0x1cd)] = _0x2260ed[_0x457da6(0x499)], _0x109838[_0x457da6(0x3bf)](_0x4697af); }); } else { const _0x410fe5 = _0x3d65cf[_0x1f2090]; _0x161b7a(_0x410fe5); } } function _0x3e1632(_0x4dfbd1) { const _0x433812 = _0x234a7d, _0x36c273 = _0x11feaf(_0x4dfbd1), _0x450d16 = document[_0x433812(0x8f3)](_0x433812(0x79a)); _0x450d16['style'][_0x433812(0xaa3)] = ''; let _0xb553fc = document[_0x433812(0x8f3)](_0x433812(0x7a3) + _0x4dfbd1); if (_0xb553fc) _0xb553fc[_0x433812(0x82c)] = ''; if (!_0x36c273) return; _0x36c273[_0x433812(0x4c5)] && (_0x433812(0x288) !== _0x433812(0x6ea) ? (_0x450d16[_0x433812(0x3e0)][_0x433812(0xaa3)] = _0x433812(0x4c6) + _0x36c273[_0x433812(0x4c5)] + '\x27)', _0x450d16[_0x433812(0x3e0)]['backgroundSize'] = _0x433812(0x43e), _0x450d16['style'][_0x433812(0x992)] = _0x433812(0x261)) : _0x35e087(_0x146b75)); if (_0x36c273['bubbleCss']) { let _0x4b0496 = document[_0x433812(0x8f3)](_0x433812(0x7a3) + _0x36c273['id']); !_0x4b0496 && (_0x433812(0x745) === 'EEWYT' ? (_0x4b0496 = document[_0x433812(0xb35)]('style'), _0x4b0496['id'] = _0x433812(0x7a3) + _0x36c273['id'], document[_0x433812(0x373)][_0x433812(0x3bf)](_0x4b0496)) : _0xec1923 && (_0x29dd8d[_0x433812(0x3e0)][_0x433812(0xab9)] = _0x433812(0x1bf))); const _0x379b60 = _0x36c273['bubbleCss'], _0x4a0cd6 = _0x379b60[_0x433812(0x915)](/\.bubble\.sent/g, _0x433812(0x873) + _0x36c273['id'] + _0x433812(0x843))[_0x433812(0x915)](/\.bubble\.received/g, '.bubble-' + _0x36c273['id'] + _0x433812(0x253)); _0x4b0496[_0x433812(0x82c)] = _0x4a0cd6; } } function _0x387918() { const _0x192399 = _0x234a7d, _0x2ae9d2 = document[_0x192399(0x8f3)](_0x192399(0x8e3)); _0x2ae9d2['innerHTML'] = ''; const _0x20f70f = _0x2d49cc => { const _0x208001 = _0x192399; _0x2de116[_0x208001(0x6e4)][_0x2d49cc] = null; if (_0x2d49cc === _0x208001(0x6a9)) _0x2de116['pendingPostAttachments'][_0x208001(0x472)] = null; _0x387918(); }, _0x523a39 = _0x2de116[_0x192399(0x6e4)][_0x192399(0x472)], _0x362718 = _0x2de116['pendingPostAttachments'][_0x192399(0x8be)]; if (_0x523a39) { const _0x2ab389 = document['createElement']('div'); _0x2ab389[_0x192399(0xaff)] = _0x192399(0x351), _0x2ab389[_0x192399(0x82c)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x2ab389[_0x192399(0xac8)](_0x192399(0x584))[_0x192399(0x7a5)] = () => _0x20f70f('image'), _0x2ae9d2[_0x192399(0x3bf)](_0x2ab389), _0x26239c(_0x523a39)[_0x192399(0xad3)](_0x2d192f => { const _0x154712 = _0x192399, _0x3d0cdf = document[_0x154712(0x8f3)](_0x154712(0x505)); if (_0x3d0cdf && _0x2d192f) { if (_0x154712(0x6b0) !== 'lpfQz') _0x3d0cdf[_0x154712(0xa9c)] = URL[_0x154712(0x64d)](_0x2d192f); else { const _0x3a75dc = _0x2f15bc(); if (!_0x3a75dc) { _0x1f6da5[_0x154712(0x1cd)] = _0x154712(0x6e1); return; } if (_0x3a75dc[_0x154712(0x318)] === 'private') { const _0x33b7f8 = _0x36ffda(_0x3a75dc[_0x154712(0x6a3)][0x0]); _0x8358f4[_0x154712(0x1cd)] = _0x33b7f8 ? _0x33b7f8[_0x154712(0x499)] : _0x154712(0x67e); } else _0x3faadd[_0x154712(0x1cd)] = _0x3a75dc[_0x154712(0x499)] || '群聊\x20(' + _0x3a75dc[_0x154712(0x6a3)][_0x154712(0xaa7)] + ')'; } } }); } if (_0x362718) { if ('KFILK' !== _0x192399(0x35f)) return _0x35a785[_0x192399(0xb34)]['map'](_0x4a8b24 => typeof _0x4a8b24 === _0x192399(0xa98) ? _0x4a8b24 : _0x4a8b24?.[_0x192399(0x5e2)])['filter'](_0x4b1d9b)['flatMap'](_0x53a415); else { const _0x5dd5cb = document[_0x192399(0xb35)]('div'); _0x5dd5cb[_0x192399(0xaff)] = _0x192399(0x351), _0x5dd5cb[_0x192399(0x82c)] = _0x192399(0x2c4) + (_0x362718[_0x192399(0x9fd)] || _0x322703) + _0x192399(0xb11) + _0x362718[_0x192399(0x5e6)] + _0x192399(0xa3a) + _0x362718[_0x192399(0x942)] + _0x192399(0x5c7), _0x5dd5cb[_0x192399(0xac8)](_0x192399(0x584))[_0x192399(0x7a5)] = () => _0x20f70f(_0x192399(0x8be)), _0x2ae9d2['appendChild'](_0x5dd5cb); } } } async function _0x578489(_0x51fbd7) { const _0x558044 = _0x234a7d; if (_0x558044(0x84b) !== _0x558044(0x2ea)) { const _0x9926e5 = _0x2de116[_0x558044(0xa05)][_0x558044(0xa68)](_0xb9571b => _0xb9571b['id'] === _0x2de116[_0x558044(0x42d)]); if (!_0x9926e5) return; _0xc9067c(!![], _0x558044(0x838)), _0x2de116['isGenerating'] = !![]; try { const _0x4ec21c = _0x9926e5[_0x558044(0x595)]['map'](_0x5f1433 => _0x11feaf(_0x5f1433))[_0x558044(0x3cf)](Boolean), _0x331571 = _0x3af87f(), _0x507879 = _0x4ec21c['map'](_0x48bf3c => { const _0x5e69cc = _0x558044, { omniText: _0x2d4792 } = _0x888912(_0x48bf3c['id'], null), _0x348bab = _0x385577(_0x48bf3c['id']), _0x2da055 = _0x48bf3c[_0x5e69cc(0xae1)] && _0x48bf3c['linkedWorldBookIds'][_0x5e69cc(0xaa7)] > 0x0 ? _0x5e69cc(0x787) + _0x48bf3c[_0x5e69cc(0x499)] + '的个人专属世界观设定\x0a' + _0x48bf3c[_0x5e69cc(0xae1)][_0x5e69cc(0x7c6)](_0x375b2d => _0x2de116[_0x5e69cc(0x432)][_0x5e69cc(0xa68)](_0x18791c => _0x18791c['id'] === _0x375b2d))[_0x5e69cc(0x3cf)](Boolean)[_0x5e69cc(0x7c6)](_0x17dd09 => _0x5e69cc(0xa66) + _0x17dd09[_0x5e69cc(0x499)] + '\x0a' + _0x17dd09['content'])[_0x5e69cc(0x6cf)]('') : ''; return _0x5e69cc(0x352) + _0x48bf3c[_0x5e69cc(0x499)] + ',\x20ID:\x20' + _0x48bf3c['id'] + _0x5e69cc(0x6d2) + _0x48bf3c[_0x5e69cc(0x44a)] + _0x5e69cc(0x537) + _0x2d4792 + '\x0a' + _0x348bab + '\x0a' + _0x2da055; })['join']('\x0a\x0a'), _0x16831a = _0x48a42d(_0x51fbd7[_0x558044(0x50c)]) || { 'name': '用户' }, _0xdc536b = _0x16831a[_0x558044(0x44a)] ? '\x0a#\x20发布动态的用户信息\x0a-\x20姓名:\x20' + _0x16831a[_0x558044(0x499)] + '\x0a-\x20人设:\x20' + _0x16831a[_0x558044(0x44a)] + '\x0a' : ''; let _0x1724a2 = null; if (_0x51fbd7['image']) _0x1724a2 = _0x51fbd7['image']; else { if (_0x51fbd7[_0x558044(0x472)]) { if ('vGVua' !== _0x558044(0x954)) _0x43734f = _0x189c92[_0x558044(0x6a3)][0x0]; else try { if (_0x558044(0x3f5) === _0x558044(0x3f5)) { const _0xa01b04 = await _0x26239c(_0x51fbd7['imageId']); _0xa01b04 && (_0x1724a2 = await _0x32f36c(_0xa01b04)); } else { const _0x504d53 = _0x3c78d2[_0x558044(0xb35)]('li'); _0x504d53[_0x558044(0xaff)] = _0x558044(0x8b8), _0x504d53[_0x558044(0xb40)][_0x558044(0x59a)] = _0x56cf92['id'], _0x504d53[_0x558044(0x82c)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x13bb1c[_0x558044(0x41d)] || _0x257d05) + _0x558044(0x229) + _0x3c0973['name'] + _0x558044(0x72f) + (_0x40818f[_0x558044(0x9ff)] || '私聊') + _0x558044(0xa94), _0x504d53['addEventListener'](_0x558044(0xbba), () => { _0x43cc09(_0x1fbb06['id']); }), _0x2fa7cb[_0x558044(0x3bf)](_0x504d53); } } catch (_0x4d1a2c) { if (_0x558044(0xb1f) === _0x558044(0x665)) { const _0xce466b = _0x3e6caa[_0x558044(0xb35)]('p'); _0xce466b[_0x558044(0x82c)] = _0x1408ba, _0xce466b[_0x558044(0x3e0)]['margin'] = '0', _0x3df638[_0x558044(0x3bf)](_0xce466b); } else console[_0x558044(0x27b)](_0x558044(0xb13), _0x4d1a2c); } } } let _0x4b458a = _0x16831a['name'] + _0x558044(0xb31) + _0x51fbd7[_0x558044(0x5e2)] + '”'; _0x1724a2 && (_0x4b458a += '\x20[并附上了一张图片]'); _0x51fbd7[_0x558044(0x318)] === 'music' && (_0x4b458a += '\x20[并分享了歌曲:\x20' + _0x51fbd7['songName'] + '\x20-\x20' + _0x51fbd7[_0x558044(0x942)] + ']'); const _0x3aece3 = _0x558044(0x53c) + _0x507879 + '\x0a\x0a' + _0xdc536b + '\x0a\x0a#\x20最近的动态回顾\x20(供参考)\x0a' + _0x331571 + _0x558044(0x7bd) + _0x4b458a + _0x558044(0x9c1), _0x4f4b26 = [{ 'role': _0x558044(0x456), 'content': _0x3aece3 }], _0x1644f1 = { 'role': _0x558044(0x7da), 'content': '请根据以上所有规则（特别是要看图！），生成对用户动态的回应。' }; _0x1724a2 && (_0x1644f1[_0x558044(0x6a9)] = _0x1724a2); _0x4f4b26['push'](_0x1644f1); const _0x11fd59 = await _0x4df70c(_0x4f4b26, { 'json': !![] }), _0x297ef0 = _0x11fd59[_0x558044(0x435)](/({[\s\S]*})/); if (!_0x297ef0) throw new Error(_0x558044(0x1b0)); const _0x52cedc = JSON['parse'](_0x297ef0[0x1]), _0x5151e9 = _0x9926e5[_0x558044(0x415)][_0x558044(0xa68)](_0x39f89d => _0x39f89d['id'] === _0x51fbd7['id']); _0x5151e9 && (_0x5151e9['likes'] = _0x52cedc[_0x558044(0x350)] || [], _0x5151e9[_0x558044(0x8ce)] = (_0x52cedc[_0x558044(0x8ce)] || [])[_0x558044(0x7c6)]((_0xa43e4d, _0x5be36a) => ({ ..._0xa43e4d, 'commentId': 'c_' + _0x51fbd7[_0x558044(0xa71)] + '_' + _0x5be36a })), _0x2ca195(), _0x36dd52()); } catch (_0x57f109) { if ('kKYao' !== _0x558044(0x8b1)) console['error'](_0x558044(0x61c), _0x57f109), _0x15e83d(_0x558044(0xba1)); else { _0x59196d[_0x558044(0x82c)] = _0x558044(0x490); return; } } finally { if ('pPmks' !== _0x558044(0x379)) return _0x5becc3['chats']['find'](_0x8b8563 => _0x8b8563['id'] === _0x536511['activeChatId']); else _0xc9067c(![]), _0x2de116[_0x558044(0x3b8)] = ![]; } } else _0x191471(_0x558044(0xbb1) + _0xfd5320[_0x558044(0x722)]); } function _0x475d88() { const _0xb34d2f = _0x234a7d; if (_0xb34d2f(0x936) === _0xb34d2f(0x56b)) { const _0x404b76 = _0x39fd90['value']; _0x6c266d[_0xb34d2f(0x706)][_0xb34d2f(0x3e0)]['setProperty']('--primary-lightness', _0x404b76 + '%'), _0x55d164[_0xb34d2f(0x23c)](_0xb34d2f(0x3c3), _0x404b76), _0x15e001(); } else { const _0x71c002 = _0x2de116[_0xb34d2f(0xa05)][_0xb34d2f(0xa68)](_0x48110a => _0x48110a['id'] === _0x2de116['activeFriendCircleId']), _0x1aca4f = _0x71c002?.[_0xb34d2f(0x38d)]; let _0x165dfe = _0x2de116[_0xb34d2f(0x613)][_0xb34d2f(0xa68)](_0x4d17fc => _0x4d17fc['id'] === _0x1aca4f); if (!_0x165dfe) { if ('tiQxK' === _0xb34d2f(0x44e)) _0x165dfe = _0x2de116[_0xb34d2f(0x613)][_0xb34d2f(0xa68)](_0x5e4606 => _0x5e4606['id'] === _0x2de116[_0xb34d2f(0xabe)]); else { const _0x10fecd = _0x1d7c15['createElement']('div'); _0x10fecd['textContent'] = _0x1b2a7a, _0x10fecd[_0xb34d2f(0x85f)](_0xb34d2f(0xbba), () => { const _0x39a310 = _0xb34d2f; _0x4990e6[_0x39a310(0xa35)] = _0x4289ff, _0x5cb761['classList'][_0x39a310(0x2e4)](_0x39a310(0x530)); }), _0x26ae07['appendChild'](_0x10fecd); } } if (!_0x165dfe) { if (_0xb34d2f(0xa88) === _0xb34d2f(0x9c4)) for (const _0x1bd469 of _0x18c8bc[_0xb34d2f(0x432)]) { let _0x2646df = _0x5658f1[_0xb34d2f(0x432)]['find'](_0x36cb86 => _0x36cb86[_0xb34d2f(0x499)] === _0x1bd469[_0xb34d2f(0x499)]); if (_0x2646df) _0x3b8718[_0xb34d2f(0x8d9)](_0x2646df['id']); else { const _0x1a8cb3 = { 'id': _0xb34d2f(0x623) + _0x160125[_0xb34d2f(0x83b)]() + '_' + _0x53422d[_0xb34d2f(0x77b)](), 'name': _0x1bd469[_0xb34d2f(0x499)], 'content': _0x1bd469['content'] }; _0xcafd88['worldBooks'][_0xb34d2f(0x8d9)](_0x1a8cb3), _0x7b25a8['push'](_0x1a8cb3['id']); } } else _0x165dfe = _0x2de116[_0xb34d2f(0x613)][0x0]; } _0x165dfe && (document['getElementById']('user-post-avatar')[_0xb34d2f(0xa9c)] = _0x165dfe[_0xb34d2f(0x41d)] || _0x176655); } } function _0x404308(_0x271f25) { const _0x123aca = _0x234a7d; let _0x44f4f0 = 0x0, _0x2ee94a = 0x0, _0x5a96c0 = 0x0; if (_0x271f25[_0x123aca(0xaa7)] == 0x4) _0x44f4f0 = '0x' + _0x271f25[0x1] + _0x271f25[0x1], _0x2ee94a = '0x' + _0x271f25[0x2] + _0x271f25[0x2], _0x5a96c0 = '0x' + _0x271f25[0x3] + _0x271f25[0x3]; else _0x271f25['length'] == 0x7 && (_0x44f4f0 = '0x' + _0x271f25[0x1] + _0x271f25[0x2], _0x2ee94a = '0x' + _0x271f25[0x3] + _0x271f25[0x4], _0x5a96c0 = '0x' + _0x271f25[0x5] + _0x271f25[0x6]); _0x44f4f0 /= 0xff, _0x2ee94a /= 0xff, _0x5a96c0 /= 0xff; let _0x3b4b49 = Math[_0x123aca(0x924)](_0x44f4f0, _0x2ee94a, _0x5a96c0), _0x7c7f0d = Math['max'](_0x44f4f0, _0x2ee94a, _0x5a96c0), _0x3d9f38 = _0x7c7f0d - _0x3b4b49, _0x124e6c = 0x0, _0x12ec8a = 0x0, _0x4d88d0 = 0x0; if (_0x3d9f38 == 0x0) _0x124e6c = 0x0; else { if (_0x7c7f0d == _0x44f4f0) _0x124e6c = (_0x2ee94a - _0x5a96c0) / _0x3d9f38 % 0x6; else { if (_0x7c7f0d == _0x2ee94a) _0x124e6c = (_0x5a96c0 - _0x44f4f0) / _0x3d9f38 + 0x2; else _0x124e6c = (_0x44f4f0 - _0x2ee94a) / _0x3d9f38 + 0x4; } } _0x124e6c = Math[_0x123aca(0x8d6)](_0x124e6c * 0x3c); if (_0x124e6c < 0x0) _0x124e6c += 0x168; return _0x4d88d0 = (_0x7c7f0d + _0x3b4b49) / 0x2, _0x12ec8a = _0x3d9f38 == 0x0 ? 0x0 : _0x3d9f38 / (0x1 - Math[_0x123aca(0x5a1)](0x2 * _0x4d88d0 - 0x1)), _0x12ec8a = +(_0x12ec8a * 0x64)['toFixed'](0x1), _0x4d88d0 = +(_0x4d88d0 * 0x64)[_0x123aca(0xaeb)](0x1), { 'h': _0x124e6c, 's': _0x12ec8a, 'l': _0x4d88d0 }; } function _0x3bbf75() { const _0x528ee6 = _0x234a7d, _0xa46e8a = (_0x2c0dfd, _0x122a25, _0x49be40) => { const _0x1b5e08 = _0x4d19; if (_0x1b5e08(0x4cb) !== _0x1b5e08(0x4cb)) { const _0x37db5c = _0x262e67[_0x1b5e08(0x6c0)](_0x474367, 'readwrite'), _0x4b3c01 = _0x37db5c[_0x1b5e08(0x387)](_0x2edc51), _0x27bf79 = _0x4b3c01[_0x1b5e08(0x583)](_0x6e7719); _0x27bf79[_0x1b5e08(0x7b4)] = () => _0x4881af(), _0x27bf79['onerror'] = () => _0x2b68b9(_0x27bf79[_0x1b5e08(0x27b)]); } else { const _0x172fdd = document['getElementById'](_0x2c0dfd); if (!_0x172fdd) return; let _0x9e11a3 = null; try { _0x1b5e08(0x52e) === _0x1b5e08(0xac0) ? _0x2e255b['log'](_0x1b5e08(0x2cf) + _0x71dd34) : _0x9e11a3 = JSON[_0x1b5e08(0x57f)](localStorage[_0x1b5e08(0x54d)](_0x122a25) || '{}'); } catch { _0x1b5e08(0xa01) !== 'gAYhw' ? _0xd06728 = _0x120ca8[_0x1b5e08(0x269)](_0x442d72) : _0x9e11a3 = {}; } _0x172fdd[_0x1b5e08(0x3e0)]['position'] = _0x1b5e08(0x999), _0x172fdd[_0x1b5e08(0x3e0)]['top'] = '', _0x172fdd['style'][_0x1b5e08(0xbb3)] = '', _0x172fdd['style'][_0x1b5e08(0xb39)] = '', _0x172fdd[_0x1b5e08(0x3e0)][_0x1b5e08(0x2bc)] = '', _0x172fdd[_0x1b5e08(0x3e0)][_0x1b5e08(0x8f2)] = ''; if (typeof _0x9e11a3[_0x1b5e08(0x8ae)] === _0x1b5e08(0x55b) && typeof _0x9e11a3[_0x1b5e08(0xbb3)] === _0x1b5e08(0x55b)) _0x172fdd['style'][_0x1b5e08(0x8ae)] = _0x9e11a3[_0x1b5e08(0x8ae)] + '%', _0x172fdd['style']['left'] = _0x9e11a3[_0x1b5e08(0xbb3)] + '%'; else { if (_0x1b5e08(0x764) === _0x1b5e08(0x1c9)) _0x294034 = _0x402665; else for (const _0x260739 in _0x49be40) { _0x172fdd[_0x1b5e08(0x3e0)][_0x260739] = _0x49be40[_0x260739]; } } } }; _0xa46e8a(_0x528ee6(0x61b), 'clockPosition', { 'top': _0x528ee6(0x336), 'left': _0x528ee6(0x354), 'transform': _0x528ee6(0x206) }), _0xa46e8a(_0x528ee6(0x1ce), 'appIconPosition_app-wallpaper', { 'top': _0x528ee6(0x2dd), 'right': '4%' }), _0xa46e8a(_0x528ee6(0x3f6), 'appIconPosition_app-user-profiles', { 'top': _0x528ee6(0x2dd), 'right': _0x528ee6(0xa2d) }), _0xa46e8a(_0x528ee6(0x5ea), _0x528ee6(0x967), { 'top': '8%', 'right': '28%' }), _0xa46e8a('app-world-book', _0x528ee6(0xabc), { 'top': '8%', 'right': '4%' }), _0xa46e8a(_0x528ee6(0x760), 'appIconPosition_app-music-library', { 'top': _0x528ee6(0x77d), 'left': '5%' }), _0xa46e8a(_0x528ee6(0xa17), _0x528ee6(0x45f), { 'top': '71%', 'left': '29%' }), _0xa46e8a(_0x528ee6(0x81c), 'appIconPosition_app-snoop', { 'top': _0x528ee6(0xb4a), 'left': '5%' }), _0xa46e8a(_0x528ee6(0x5f1), _0x528ee6(0x240), { 'top': _0x528ee6(0x77d), 'left': _0x528ee6(0x468) }), _0xa46e8a(_0x528ee6(0xb92), _0x528ee6(0x316), { 'top': _0x528ee6(0x6ae), 'right': '5%' }), _0xa46e8a(_0x528ee6(0x72b), _0x528ee6(0x2c7), { 'top': '8%', 'left': '5%' }); const _0x5aaa5a = document[_0x528ee6(0x8f3)](_0x528ee6(0x46a)); _0x5aaa5a && (_0x5aaa5a[_0x528ee6(0x3e0)]['position'] = _0x528ee6(0x999), _0x5aaa5a[_0x528ee6(0x3e0)][_0x528ee6(0x8ae)] = _0x528ee6(0x600), _0x5aaa5a[_0x528ee6(0x3e0)][_0x528ee6(0xbb3)] = _0x528ee6(0x354), _0x5aaa5a[_0x528ee6(0x3e0)]['transform'] = 'translateX(-50%)', _0x5aaa5a[_0x528ee6(0x3e0)][_0x528ee6(0xab9)] = _0x528ee6(0x5ac)); const _0x3fd2d4 = document[_0x528ee6(0x8f3)]('music-widget'); _0x3fd2d4 && (_0x3fd2d4[_0x528ee6(0x3e0)]['position'] = _0x528ee6(0x999), _0x3fd2d4[_0x528ee6(0x3e0)]['top'] = _0x528ee6(0xa93), _0x3fd2d4[_0x528ee6(0x3e0)]['left'] = _0x528ee6(0x354), _0x3fd2d4[_0x528ee6(0x3e0)][_0x528ee6(0x8f2)] = _0x528ee6(0x206), _0x3fd2d4[_0x528ee6(0x3e0)][_0x528ee6(0xab9)] = _0x528ee6(0x896)); } function _0x21061c() { const _0x179f1a = _0x234a7d; if (_0x179f1a(0xbb5) === _0x179f1a(0xbb5)) { const _0x2a25a3 = document[_0x179f1a(0x8f3)](_0x179f1a(0x503)); _0x2a25a3[_0x179f1a(0x82c)] = ''; const _0x575c78 = document[_0x179f1a(0x672)](_0x179f1a(0x548)); _0x575c78['forEach'](_0x367e6d => { const _0x52e23c = _0x179f1a; if (_0x52e23c(0x1f2) === _0x52e23c(0x1f2)) { const _0x40c77d = _0x367e6d['id'], _0x35add3 = _0x367e6d['querySelector']('span')[_0x52e23c(0x1cd)], _0x2bb169 = _0x52e23c(0x323) + _0x40c77d, _0x44ccb0 = localStorage['getItem'](_0x2bb169), _0x268cdb = document[_0x52e23c(0xb35)](_0x52e23c(0x4e8)); _0x268cdb['className'] = _0x52e23c(0x8ec), _0x268cdb['style'][_0x52e23c(0x8c8)] = '10px\x200', _0x268cdb[_0x52e23c(0x82c)] = _0x52e23c(0x8e5) + _0x40c77d + _0x52e23c(0x6a5) + (_0x44ccb0 || 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7') + _0x52e23c(0x3d4) + _0x35add3 + _0x52e23c(0x671) + _0x40c77d + _0x52e23c(0x73e) + _0x40c77d + _0x52e23c(0x62c) + _0x2bb169 + _0x52e23c(0x6a1), _0x2a25a3[_0x52e23c(0x3bf)](_0x268cdb); const _0x100ea3 = document['getElementById'](_0x52e23c(0x7ad) + _0x40c77d); _0x100ea3[_0x52e23c(0x85f)](_0x52e23c(0x69c), async _0x5bf9e8 => { const _0x56c943 = _0x52e23c, _0x144e83 = _0x5bf9e8['target'][_0x56c943(0x6f1)][0x0]; if (!_0x144e83) return; try { const _0x46ab10 = await _0x55a8db(_0x144e83); localStorage[_0x56c943(0x23c)](_0x2bb169, _0x46ab10), document[_0x56c943(0x8f3)](_0x56c943(0x8f6) + _0x40c77d)[_0x56c943(0xa9c)] = _0x46ab10, _0x7a1fe9(); } catch (_0x289095) { _0x15e83d(_0x56c943(0xa14) + _0x289095['message']); } }); } else _0x451e78 = _0x45b5f3[_0x52e23c(0x57f)](_0xc51953); }); } else _0x142a70[_0x179f1a(0x38d)] = _0x33446c; } function _0x7a1fe9() { const _0x4004fe = _0x234a7d, _0x1ea4c8 = document['querySelectorAll'](_0x4004fe(0x548)); _0x1ea4c8[_0x4004fe(0x201)](_0x298e12 => { const _0x2558b7 = _0x4004fe, _0x2a01ef = _0x298e12['id'], _0x3fd3e1 = _0x2558b7(0x323) + _0x2a01ef, _0xea0cfc = localStorage['getItem'](_0x3fd3e1), _0x159390 = _0x298e12[_0x2558b7(0xac8)]('.app-icon-img'); if (_0xea0cfc) _0x159390[_0x2558b7(0x82c)] = _0x2558b7(0x4b4) + _0xea0cfc + _0x2558b7(0x274); else { const _0x5ae6bc = document[_0x2558b7(0xac8)](_0x2558b7(0x52d) + _0x2a01ef + _0x2558b7(0x4c9) + _0x2a01ef + _0x2558b7(0x523))?.[_0x2558b7(0x82c)]; _0x5ae6bc && (_0x159390['innerHTML'] = _0x5ae6bc); } }); } function _0x10df2b() { const _0x3d9ce9 = _0x234a7d; if (_0x3d9ce9(0x624) !== _0x3d9ce9(0x624)) { const _0x8b8bd5 = _0x1fecbc['getElementById'](_0x416a9e); if (_0x8b8bd5 && _0x5a912e) _0x8b8bd5[_0x3d9ce9(0xa9c)] = _0xf47b72['createObjectURL'](_0x1498f5); } else { const _0x1d3427 = _0x2de116['friendCircles'][_0x3d9ce9(0xa68)](_0x57afe3 => _0x57afe3['id'] === _0x2de116[_0x3d9ce9(0x42d)]), _0x48b516 = _0x231de4(); let _0x35b73c = []; if (_0x1d3427 && _0x1d3427[_0x3d9ce9(0x415)]) { const _0x20694f = _0x1d3427[_0x3d9ce9(0x415)][_0x3d9ce9(0x3cf)](_0x3ed6cf => _0x3ed6cf[_0x3d9ce9(0x318)] === _0x3d9ce9(0x8be) && _0x3ed6cf[_0x3d9ce9(0x788)])['map'](_0xfd47e6 => ({ ..._0xfd47e6, 'source': 'feed' })); _0x35b73c[_0x3d9ce9(0x8d9)](..._0x20694f); } if (_0x48b516 && _0x2de116[_0x3d9ce9(0x59f)]) { const _0x9f2beb = _0x2de116[_0x3d9ce9(0x59f)][_0x3d9ce9(0x3cf)](_0xcd1892 => _0xcd1892['type'] === _0x3d9ce9(0x8be) && _0xcd1892[_0x3d9ce9(0x788)])['map'](_0x1e88dc => ({ ..._0x1e88dc, 'source': 'chat' })); _0x35b73c[_0x3d9ce9(0x8d9)](..._0x9f2beb); } const _0x4bb603 = Array[_0x3d9ce9(0x426)](new Map(_0x35b73c[_0x3d9ce9(0x7c6)](_0x7983ef => [_0x7983ef[_0x3d9ce9(0x788)], _0x7983ef]))[_0x3d9ce9(0x817)]()); _0x2de116[_0x3d9ce9(0x9a6)] = _0x4bb603[_0x3d9ce9(0xb71)]((_0x5f592c, _0xfd5200) => _0xfd5200['timestamp'] - _0x5f592c[_0x3d9ce9(0xa71)]); } } function _0x584637(_0x29e1f0) { const _0x410943 = _0x234a7d; if (_0x29e1f0 < 0x0 || _0x29e1f0 >= _0x2125a1[_0x410943(0xaa7)]) return; _0x3b2d0b = _0x29e1f0; const _0x5668d3 = _0x2125a1[_0x29e1f0]; _0x296518['src'] = _0x5668d3[_0x410943(0x788)] || _0x5668d3[_0x410943(0xb77)], _0x296518[_0x410943(0xa1d)](), _0xc3f14a(), _0x6bf9cb(); } function _0xc3f14a() { const _0x236d99 = _0x2125a1[_0x3b2d0b]; _0x571235(_0x236d99); } function _0x6bf9cb() { const _0x5ec6f8 = _0x234a7d; if ('RNRkv' !== _0x5ec6f8(0x9f5)) _0x193c4c[_0x5ec6f8(0x51c)][_0x5ec6f8(0x6dd)](_0x5ec6f8(0x530)); else try { _0x5ec6f8(0x4b5) === _0x5ec6f8(0x7b7) ? (_0x17333d['textContent'] = '旁白', _0x5ee6d6[_0x5ec6f8(0x1cd)] = '（对话结束）') : localStorage[_0x5ec6f8(0x23c)](_0x5ec6f8(0x4a7), JSON['stringify']({ 'playlist': _0x2de116['musicPlaylist'], 'currentIndex': _0x2de116[_0x5ec6f8(0x63f)] })); } catch (_0x4bca99) { console[_0x5ec6f8(0x27b)](_0x5ec6f8(0x879), _0x4bca99); } } function _0x45094e() { const _0x4a5fb1 = _0x234a7d; if (_0x4a5fb1(0x66d) === _0x4a5fb1(0xb32)) { const _0x3f003c = _0x26a9b8(_0x4517ed[_0x4a5fb1(0x4b1)] || _0x2c8766[_0x4a5fb1(0x2df)]); _0x39c678 = _0x3f003c?.[_0x4a5fb1(0x499)] || '角色', _0x4d9e63 = 'speaker-ai'; } else try { const _0x27297d = localStorage[_0x4a5fb1(0x54d)](_0x4a5fb1(0x4a7)); if (_0x27297d) { const { playlist: _0x11520f, currentIndex: _0x29ce25 } = JSON[_0x4a5fb1(0x57f)](_0x27297d); if (Array[_0x4a5fb1(0x75c)](_0x11520f) && _0x11520f[_0x4a5fb1(0xaa7)] > 0x0 && _0x29ce25 > -0x1) { if (_0x4a5fb1(0x5c9) !== _0x4a5fb1(0x5c9)) { const _0x22e5ac = _0x20368a[_0x4a5fb1(0x8f3)](_0x4a5fb1(0x23e)); if (!_0x22e5ac) return; const _0x39c223 = _0x51d5c6[_0x4a5fb1(0x54d)]('themeLightness') || '80'; _0x456abb[_0x4a5fb1(0x706)][_0x4a5fb1(0x3e0)][_0x4a5fb1(0x718)](_0x4a5fb1(0x62a), _0x39c223 + '%'), _0x22e5ac['value'] = _0x39c223, _0x22e5ac[_0x4a5fb1(0x85f)]('input', () => { const _0x5a5869 = _0x4a5fb1, _0x15c925 = _0x22e5ac[_0x5a5869(0xa35)]; _0x299193[_0x5a5869(0x706)][_0x5a5869(0x3e0)]['setProperty']('--primary-lightness', _0x15c925 + '%'), _0x3bdd71['setItem'](_0x5a5869(0x3c3), _0x15c925), _0x8df69a(); }); } else _0x2de116[_0x4a5fb1(0x9a6)] = _0x11520f, _0x2de116[_0x4a5fb1(0x63f)] = _0x29ce25, _0x2de116[_0x4a5fb1(0x902)] = ![], _0xc3f14a(); } } } catch (_0x3339a9) { console[_0x4a5fb1(0x27b)](_0x4a5fb1(0x6e5), _0x3339a9); } } function _0x4495b9(_0x365edc) { const _0x101498 = _0x234a7d; if (window[_0x101498(0xa7b)]) clearTimeout(window[_0x101498(0xa7b)]); const _0x1ef9df = _0x365edc[_0x101498(0x48e)]['closest'](_0x101498(0x90d)); if (!_0x1ef9df) return; const _0x24856e = _0x1ef9df[_0x101498(0xb40)][_0x101498(0xa71)], _0x187949 = _0x1ef9df['classList'][_0x101498(0x56f)](_0x101498(0x7da)) ? _0x101498(0x7da) : 'ai'; if (!_0x24856e) return; const _0x44306 = () => { const _0x32d322 = _0x101498; _0x32d322(0x878) === _0x32d322(0x878) ? window['diaryPressTimer'] = setTimeout(() => { const _0x13cc02 = _0x32d322; if (_0x365edc[_0x13cc02(0x318)] === _0x13cc02(0x534)) _0x365edc[_0x13cc02(0xb16)](); _0x4dd444(parseInt(_0x24856e, 0xa), _0x187949); }, 0x320) : _0x5a8688 = _0x5e488f; }, _0x4f1ae3 = () => { const _0x408bd2 = _0x101498; if (_0x408bd2(0x893) !== 'ZFoww') { if (window[_0x408bd2(0xa7b)]) clearTimeout(window[_0x408bd2(0xa7b)]); } else _0x20a357[_0x408bd2(0x6a9)] = _0x168ad3, _0x127dd8 = !![]; }; document[_0x101498(0x85f)](_0x101498(0x282), _0x4f1ae3, { 'once': !![] }), document[_0x101498(0x85f)]('touchend', _0x4f1ae3, { 'once': !![] }), document['addEventListener'](_0x101498(0xbb4), _0x4f1ae3, { 'once': !![] }), _0x44306(); } function _0x4dd444(_0x1bbea1, _0x4ac367) { const _0x52daa6 = _0x234a7d, _0x7c5d88 = _0x52daa6(0x9c7) + _0x1bbea1; let _0x2b167f = document[_0x52daa6(0x8f3)](_0x7c5d88); if (_0x2b167f) return; const _0x5e7dca = _0x52daa6(0x985) + _0x7c5d88 + _0x52daa6(0x6ce) + (_0x4ac367 === 'ai' ? _0x52daa6(0x9a1) : '') + _0x52daa6(0x9a8); document[_0x52daa6(0xb43)]['insertAdjacentHTML'](_0x52daa6(0x7cf), _0x5e7dca); const _0x403807 = document[_0x52daa6(0x8f3)](_0x7c5d88), _0x310397 = () => _0x403807[_0x52daa6(0x2e4)](); _0x403807['querySelector'](_0x52daa6(0xab6))[_0x52daa6(0x7a5)] = _0x310397, _0x403807[_0x52daa6(0xac8)]('#diary-action-cancel')[_0x52daa6(0x7a5)] = _0x310397, _0x403807['querySelector']('#diary-action-delete')['onclick'] = () => { const _0x5add2f = _0x52daa6; _0x5add2f(0x369) !== _0x5add2f(0x666) ? (_0x2f776a(_0x1bbea1), _0x310397()) : _0x453607[_0x5add2f(0x9bd)] = { ..._0x1b1e88[_0x5add2f(0xa9b)] }; }, _0x4ac367 === 'ai' && (_0x52daa6(0x821) === _0x52daa6(0xb47) ? _0x57681f[_0x52daa6(0x27b)](_0x52daa6(0x7e8), _0x5846ea) : _0x403807[_0x52daa6(0xac8)](_0x52daa6(0x355))[_0x52daa6(0x7a5)] = () => { _0x2f8c3b(_0x1bbea1), _0x310397(); }); } async function _0x2f776a(_0x328a3f) { const _0x22393e = _0x234a7d, _0x59be0d = await _0x2244b3('确定要删除这篇日记吗？此操作不可撤销。'); if (!_0x59be0d) return; const _0x53c8be = _0x2de116[_0x22393e(0x38b)][_0x22393e(0xa68)](_0x1eac6d => _0x1eac6d[_0x22393e(0x441)] === _0x2de116['activeDiaryCharacterId']); if (!_0x53c8be) return; const _0x19d54d = _0x53c8be[_0x22393e(0x71c)][_0x22393e(0x1c5)](_0x1f6b92 => _0x1f6b92['timestamp'] === _0x328a3f); _0x19d54d > -0x1 && (_0x53c8be[_0x22393e(0x71c)]['splice'](_0x19d54d, 0x1), _0x2ca195(), _0x2ee6f3(), _0x15e83d(_0x22393e(0x293))); } async function _0x2f8c3b(_0x182eff) { const _0x4f11b7 = _0x234a7d; if (_0x4f11b7(0xab4) !== 'gTCsW') { const _0xfac7ad = _0x2de116[_0x4f11b7(0x38b)][_0x4f11b7(0xa68)](_0x124a98 => _0x124a98[_0x4f11b7(0x441)] === _0x2de116[_0x4f11b7(0xa8b)]); if (!_0xfac7ad) return; const _0x2c46a0 = _0xfac7ad[_0x4f11b7(0x71c)][_0x4f11b7(0x1c5)](_0x58211c => _0x58211c['timestamp'] === _0x182eff); if (_0x2c46a0 > -0x1) { if (_0x4f11b7(0x8d7) === _0x4f11b7(0x6e6)) { const _0x490caa = _0xcca6a[0x0][_0x4f11b7(0x44c)](), _0x329961 = _0x3ce9c2[0x1]['trim']()[_0x4f11b7(0x915)](/^"|"$/g, ''); _0x580891[_0x490caa] = _0x329961; } else _0xfac7ad['entries'][_0x4f11b7(0x707)](_0x2c46a0, 0x1), _0x2ca195(), _0x2ee6f3(), await _0x461698(); } } else { const _0x22a965 = _0x43c60c[_0x4f11b7(0x6c0)](_0x39844c, 'readwrite'), _0x46375f = _0x22a965[_0x4f11b7(0x387)](_0x27dc82), _0x2aa1cc = _0x46375f[_0x4f11b7(0x583)](_0x26beae); _0x2aa1cc[_0x4f11b7(0x7b4)] = () => _0x2e8f8f(), _0x2aa1cc[_0x4f11b7(0x611)] = () => _0x332252(_0x2aa1cc[_0x4f11b7(0x27b)]); } } function _0x17dac3() { const _0x45c3a1 = _0x234a7d, _0x10897f = document['getElementById'](_0x45c3a1(0x892)); _0x10897f['innerHTML'] = ''; const _0x2907b2 = _0x2de116[_0x45c3a1(0x393)]['filter'](_0x5e4f33 => _0x2de116[_0x45c3a1(0x6b7)]['some'](_0x251b16 => _0x251b16[_0x45c3a1(0x318)] === _0x45c3a1(0x2c0) && _0x251b16[_0x45c3a1(0x6a3)]['includes'](_0x5e4f33['id']))); if (_0x2907b2[_0x45c3a1(0xaa7)] === 0x0) { if (_0x45c3a1(0x3c4) !== _0x45c3a1(0xa9d)) { _0x10897f[_0x45c3a1(0x82c)] = _0x45c3a1(0x58e); return; } else { const _0x58478c = _0x583be9[_0x45c3a1(0x48e)][_0x45c3a1(0x6f1)][0x0]; if (!_0x58478c) return; const _0x1e3ff4 = _0x2cf792[_0x45c3a1(0x64d)](_0x58478c); _0x46baa5['getElementById']('group-bg-preview')[_0x45c3a1(0x3e0)][_0x45c3a1(0xaa3)] = _0x45c3a1(0x4c6) + _0x1e3ff4 + '\x27)'; } } _0x2907b2[_0x45c3a1(0x201)](_0x3bdce3 => { const _0x3caf35 = _0x45c3a1, _0xe9b40c = document['createElement']('li'); _0xe9b40c[_0x3caf35(0xaff)] = _0x3caf35(0x8b8), _0xe9b40c['dataset']['charId'] = _0x3bdce3['id'], _0xe9b40c['innerHTML'] = _0x3caf35(0x371) + (_0x3bdce3[_0x3caf35(0x41d)] || _0x322703) + _0x3caf35(0x229) + _0x3bdce3[_0x3caf35(0x499)] + _0x3caf35(0x2ce), _0xe9b40c[_0x3caf35(0x85f)]('click', () => { _0x53170b(_0x3bdce3['id']); }), _0xe9b40c['querySelector'](_0x3caf35(0x4b8))[_0x3caf35(0x85f)](_0x3caf35(0xbba), () => { _0x53170b(_0x3bdce3['id']); }), _0xe9b40c[_0x3caf35(0xac8)]('.diary-delete-btn')[_0x3caf35(0x85f)]('click', _0x2f874c => { const _0x557d9f = _0x3caf35; if ('xDPYB' === _0x557d9f(0x869)) _0x2f874c[_0x557d9f(0x260)](), _0x480614(_0x3bdce3['id']); else { const _0x402a32 = _0x42d4d0[_0x557d9f(0x48e)]['files'][0x0]; if (!_0x402a32) return; const _0x3d79a5 = _0x3449b5[_0x557d9f(0x64d)](_0x402a32); _0x5b1954[_0x557d9f(0x3e0)]['backgroundImage'] = 'url(\x27' + _0x3d79a5 + '\x27)'; } }), _0x10897f[_0x3caf35(0x3bf)](_0xe9b40c); }); } function _0x53170b(_0x3aab1c) { const _0x41f658 = _0x234a7d; if (_0x41f658(0x41e) === _0x41f658(0x41e)) { const _0x1fe2a7 = _0x11feaf(_0x3aab1c); if (!_0x1fe2a7) return; _0x2de116['activeDiaryCharacterId'] = _0x3aab1c; const _0x1d8f8b = _0x2de116[_0x41f658(0x38b)][_0x41f658(0xa68)](_0x5d5555 => _0x5d5555[_0x41f658(0x441)] === _0x3aab1c), _0x4b5fa7 = _0x1d8f8b ? _0x1d8f8b['entries'][_0x41f658(0xaa7)] : 0x0, _0x53d4b4 = 0x2; _0x2de116['diaryCurrentPage'] = Math[_0x41f658(0x68e)](0x0, Math['ceil'](_0x4b5fa7 / _0x53d4b4) - 0x1), document[_0x41f658(0x8f3)](_0x41f658(0x6b9))[_0x41f658(0x1cd)] = _0x1fe2a7[_0x41f658(0x499)] + '的日记本', _0x2ee6f3(), _0x2faf14(_0x41f658(0xba5), _0x41f658(0xb80)); } else _0x3cd581[_0x41f658(0x42d)] = null; } function _0x2ee6f3() { const _0x263a55 = _0x234a7d, _0x3affc8 = document[_0x263a55(0x8f3)]('diary-entries-container'), _0x4df0d0 = document[_0x263a55(0x8f3)]('diary-input-wrapper'); _0x3affc8[_0x263a55(0x82c)] = '', _0x4df0d0[_0x263a55(0x82c)] = ''; const _0x1c71da = _0x38db52() || { 'name': '我' }, _0x4f6add = _0x2de116[_0x263a55(0x38b)]['find'](_0x40a06f => _0x40a06f[_0x263a55(0x441)] === _0x2de116[_0x263a55(0xa8b)]); if (!_0x4f6add || !_0x4f6add[_0x263a55(0x71c)] || _0x4f6add[_0x263a55(0x71c)][_0x263a55(0xaa7)] === 0x0) { if (_0x263a55(0xb98) === _0x263a55(0x3aa)) _0x3752dd[_0x263a55(0x3e0)][_0x48b0d3] = _0x2c5254[_0x1e7397]; else { _0x3affc8[_0x263a55(0x82c)] = _0x263a55(0xa42), _0x4df0d0[_0x263a55(0x82c)] = _0x263a55(0x4bc), document['getElementById'](_0x263a55(0x857))[_0x263a55(0x85f)](_0x263a55(0xbba), _0x488a96), document[_0x263a55(0x8f3)](_0x263a55(0x719))['addEventListener'](_0x263a55(0xbba), _0x461698); return; } } const _0x76e88a = 0x2, _0x5b7836 = [..._0x4f6add[_0x263a55(0x71c)]][_0x263a55(0xb71)]((_0x3ff058, _0x20e6be) => _0x3ff058[_0x263a55(0xa71)] - _0x20e6be[_0x263a55(0xa71)]), _0x8cef84 = []; for (let _0x30eff2 = 0x0; _0x30eff2 < _0x5b7836[_0x263a55(0xaa7)]; _0x30eff2 += _0x76e88a) { _0x263a55(0xb01) !== _0x263a55(0xb01) ? _0x382f5c[_0x263a55(0x4ca)]('无法解析旧的视奸内容来获取时间戳。', _0x1b7665) : _0x8cef84[_0x263a55(0x8d9)](_0x5b7836[_0x263a55(0xa38)](_0x30eff2, _0x30eff2 + _0x76e88a)); } const _0x1af7ce = _0x8cef84[_0x263a55(0xaa7)]; _0x8cef84[_0x263a55(0x201)]((_0x49d57a, _0xdd10b8) => { const _0x4b8f53 = _0x263a55; if ('WNkPM' === _0x4b8f53(0x405)) { const _0x232f85 = _0x4c8ed3['posts'][_0x4b8f53(0x3cf)](_0x7c6e90 => _0x7c6e90[_0x4b8f53(0x318)] === _0x4b8f53(0x8be) && _0x7c6e90['playableUrl'])[_0x4b8f53(0x7c6)](_0x14efd6 => ({ ..._0x14efd6, 'source': _0x4b8f53(0x720) })); _0x4c0d29[_0x4b8f53(0x8d9)](..._0x232f85); } else { const _0x35d996 = document[_0x4b8f53(0xb35)](_0x4b8f53(0x4e8)); _0x35d996[_0x4b8f53(0xaff)] = _0x4b8f53(0x27e), _0x35d996['id'] = 'diary-page-' + _0xdd10b8, _0xdd10b8 === _0x2de116[_0x4b8f53(0xaf2)] && _0x35d996[_0x4b8f53(0x51c)][_0x4b8f53(0x6dd)](_0x4b8f53(0x60a)), _0x49d57a[_0x4b8f53(0x201)](_0x4a8923 => { const _0x2bce3a = _0x4b8f53, _0x409020 = _0x4a8923['author'] === _0x2bce3a(0x7da) ? _0x2bce3a(0x7da) : 'ai', _0x546758 = _0x4a8923[_0x2bce3a(0x5bb)] === _0x2bce3a(0x7da) ? _0x1c71da[_0x2bce3a(0x499)] : _0x11feaf(_0x4a8923['author'])[_0x2bce3a(0x499)], _0x51c0e9 = document[_0x2bce3a(0xb35)]('div'); _0x51c0e9[_0x2bce3a(0xaff)] = _0x2bce3a(0x848) + _0x409020, _0x51c0e9[_0x2bce3a(0xb40)][_0x2bce3a(0xa71)] = _0x4a8923[_0x2bce3a(0xa71)], _0x51c0e9['style'][_0x2bce3a(0xa13)] = _0x2bce3a(0x1bf), _0x51c0e9[_0x2bce3a(0x3e0)][_0x2bce3a(0xa4b)] = '0', _0x51c0e9['innerHTML'] = _0x2bce3a(0x6e7) + _0x546758 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>' + new Date(_0x4a8923[_0x2bce3a(0xa71)])[_0x2bce3a(0xb18)](_0x2bce3a(0x2e3)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>' + _0x4a8923[_0x2bce3a(0x5e2)]['replace'](/\n/g, _0x2bce3a(0x8c7)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x35d996[_0x2bce3a(0x3bf)](_0x51c0e9); }), _0x3affc8['appendChild'](_0x35d996); } }), _0x4df0d0['innerHTML'] = _0x263a55(0xb10) + (_0x2de116[_0x263a55(0xaf2)] + 0x1) + _0x263a55(0x2f9) + _0x1af7ce + _0x263a55(0x2fa), document[_0x263a55(0x8f3)]('diary-prev-button')[_0x263a55(0x4f8)] = _0x2de116[_0x263a55(0xaf2)] === 0x0, document[_0x263a55(0x8f3)](_0x263a55(0xab0))[_0x263a55(0x4f8)] = _0x2de116['diaryCurrentPage'] === _0x1af7ce - 0x1, document[_0x263a55(0x8f3)](_0x263a55(0x7de))[_0x263a55(0x85f)]('click', _0x2cf8d9), document[_0x263a55(0x8f3)](_0x263a55(0xab0))[_0x263a55(0x85f)](_0x263a55(0xbba), _0x1e29e1), document[_0x263a55(0x8f3)](_0x263a55(0x857))[_0x263a55(0x85f)]('click', _0x488a96), document['getElementById']('diary-get-reply-button')[_0x263a55(0x85f)](_0x263a55(0xbba), _0x461698); } function _0x1e29e1() { const _0x57a85f = _0x234a7d; if (_0x2de116['isAnimatingDiary']) return; const _0x124765 = _0x2de116['diaryCurrentPage'], _0x1220b6 = Math[_0x57a85f(0x1bb)](_0x2de116[_0x57a85f(0x38b)][_0x57a85f(0xa68)](_0x3dc015 => _0x3dc015[_0x57a85f(0x441)] === _0x2de116[_0x57a85f(0xa8b)])['entries']['length'] / 0x2); if (_0x124765 >= _0x1220b6 - 0x1) return; _0x2de116['isAnimatingDiary'] = !![]; const _0x2daa2a = _0x124765 + 0x1, _0x487220 = document['getElementById']('diary-page-' + _0x124765), _0x381038 = document[_0x57a85f(0x8f3)](_0x57a85f(0x9df) + _0x2daa2a); _0x487220 && _0x381038 ? 'GthqF' === 'bvQiA' ? _0x220937[_0x57a85f(0x512)] = ![] : (_0x381038['classList'][_0x57a85f(0x6dd)](_0x57a85f(0x8a5)), _0x487220[_0x57a85f(0x51c)][_0x57a85f(0x6dd)](_0x57a85f(0x6b2)), _0x381038[_0x57a85f(0x51c)][_0x57a85f(0x6dd)](_0x57a85f(0x60a)), setTimeout(() => { const _0x2b4342 = _0x57a85f; _0x487220[_0x2b4342(0x51c)][_0x2b4342(0x2e4)](_0x2b4342(0x60a), _0x2b4342(0x6b2)), _0x381038[_0x2b4342(0x51c)]['remove']('is-entering-from-right'), _0x2de116['diaryCurrentPage'] = _0x2daa2a, _0x2ee6f3(), _0x2de116[_0x2b4342(0x512)] = ![]; }, 0x2bc)) : 'FUgjl' === _0x57a85f(0x92f) ? _0x2de116['isAnimatingDiary'] = ![] : (_0x194d0a[_0x57a85f(0x8f3)](_0x57a85f(0x33f) + _0x8dadfc + _0x57a85f(0x314))[_0x57a85f(0x3e0)][_0x57a85f(0xaa3)] = '', _0x46e60f[_0x57a85f(0x8f3)](_0x57a85f(0x33f) + _0x25e123 + _0x57a85f(0x2f5))[_0x57a85f(0xa35)] = ''); } function _0x2cf8d9() { const _0x147765 = _0x234a7d; if (_0x2de116[_0x147765(0x512)]) return; const _0x5e58 = _0x2de116[_0x147765(0xaf2)]; if (_0x5e58 <= 0x0) return; _0x2de116[_0x147765(0x512)] = !![]; const _0x5af20f = _0x5e58 - 0x1, _0x5938d4 = document['getElementById']('diary-page-' + _0x5e58), _0x1ca97e = document[_0x147765(0x8f3)](_0x147765(0x9df) + _0x5af20f); _0x5938d4 && _0x1ca97e ? (_0x1ca97e['classList']['add']('is-entering-from-left'), _0x5938d4[_0x147765(0x51c)][_0x147765(0x6dd)](_0x147765(0xb2d)), _0x1ca97e['classList'][_0x147765(0x6dd)]('is-visible'), setTimeout(() => { const _0xa3aff0 = _0x147765; _0x5938d4[_0xa3aff0(0x51c)][_0xa3aff0(0x2e4)](_0xa3aff0(0x60a), _0xa3aff0(0xb2d)), _0x1ca97e['classList']['remove'](_0xa3aff0(0xa2c)), _0x2de116[_0xa3aff0(0xaf2)] = _0x5af20f, _0x2ee6f3(), _0x2de116[_0xa3aff0(0x512)] = ![]; }, 0x2bc)) : _0x2de116['isAnimatingDiary'] = ![]; } function _0x488a96() { const _0x395d2a = _0x234a7d; if (_0x395d2a(0x5d8) === 'QdKEW') return new Promise(_0x5324c3 => { const _0x22f04f = _0x395d2a; if (_0x22f04f(0x813) === 'PyGTJ') { const _0x455a7e = _0x22f04f(0x24c); document[_0x22f04f(0xb43)][_0x22f04f(0xa8c)](_0x22f04f(0x7cf), _0x455a7e); const _0x309c5d = document[_0x22f04f(0x8f3)](_0x22f04f(0x3bc)), _0x4729f3 = document[_0x22f04f(0x8f3)]('diary-modal-textarea'), _0x262427 = document[_0x22f04f(0x8f3)](_0x22f04f(0x926)), _0x30bff1 = document[_0x22f04f(0x8f3)]('diary-modal-cancel'), _0x178615 = _0x309c5d[_0x22f04f(0xac8)](_0x22f04f(0xab6)), _0x2144ea = () => { const _0x5c414a = _0x22f04f; _0x309c5d[_0x5c414a(0x2e4)](), _0x5324c3(); }; _0x262427[_0x22f04f(0x7a5)] = () => { const _0x57eae1 = _0x22f04f; _0xfc34(_0x4729f3[_0x57eae1(0xa35)]), _0x2144ea(); }, _0x30bff1[_0x22f04f(0x7a5)] = _0x2144ea, _0x178615[_0x22f04f(0x7a5)] = _0x2144ea; } else { if (!_0x2fa9b5) return ''; const _0x463047 = new _0x7f20c3(_0x727137), _0x41d353 = _0x29cd3e(_0x463047[_0x22f04f(0x6ca)]())[_0x22f04f(0x6f9)](0x2, '0'), _0x4690bb = _0x11f3cd(_0x463047[_0x22f04f(0x6d3)]())[_0x22f04f(0x6f9)](0x2, '0'); return _0x41d353 + ':' + _0x4690bb; } }); else { const _0x134e7b = _0x100a84[_0x1459e9[_0x395d2a(0xaa7)] - 0x1]; (!_0x251283 || _0x134e7b['timestamp'] > _0x4707a7[_0x395d2a(0xa71)]) && (_0x2791d1 = _0x134e7b); } } function _0xfc34(_0x17888b) { const _0x299940 = _0x234a7d, _0x4b638f = _0x17888b['trim'](); if (!_0x4b638f || !_0x2de116[_0x299940(0xa8b)]) return; let _0x10fa90 = _0x2de116[_0x299940(0x38b)][_0x299940(0xa68)](_0x46ad53 => _0x46ad53[_0x299940(0x441)] === _0x2de116[_0x299940(0xa8b)]); !_0x10fa90 && (_0x10fa90 = { 'characterId': _0x2de116[_0x299940(0xa8b)], 'entries': [] }, _0x2de116['diaries'][_0x299940(0x8d9)](_0x10fa90)); _0x10fa90[_0x299940(0x71c)][_0x299940(0x8d9)]({ 'timestamp': Date[_0x299940(0x83b)](), 'author': _0x299940(0x7da), 'content': _0x4b638f }), _0x2ca195(); const _0x23bd79 = _0x10fa90['entries']['length']; _0x2de116[_0x299940(0xaf2)] = Math[_0x299940(0x1bb)](_0x23bd79 / 0x2) - 0x1, _0x2ee6f3(); } async function _0x461698() { const _0x48b9ab = _0x234a7d; if (_0x48b9ab(0x270) !== _0x48b9ab(0x4aa)) { const _0x28c19b = _0x2de116[_0x48b9ab(0x38b)][_0x48b9ab(0xa68)](_0x1357b7 => _0x1357b7['characterId'] === _0x2de116[_0x48b9ab(0xa8b)]), _0xa4efb4 = _0x2de116[_0x48b9ab(0xa8b)], _0x2af87c = _0x11feaf(_0xa4efb4); if (!_0x2af87c || _0x2de116[_0x48b9ab(0x3b8)]) return; _0xc9067c(!![], _0x48b9ab(0x7af)), _0x2de116[_0x48b9ab(0x3b8)] = !![]; let _0xcea56b = []; try { const _0x3ea515 = _0x38db52() || { 'name': '你' }, _0x33140f = _0x385577(_0xa4efb4), { omniText: _0x208967 } = _0x888912(_0xa4efb4, _0x2de116['activeChatId']); let _0x2cf0a = ''; if (_0x2af87c[_0x48b9ab(0xae1)] && _0x2af87c[_0x48b9ab(0xae1)]['length'] > 0x0) { const _0x1c104d = _0x2af87c[_0x48b9ab(0xae1)]['map'](_0x37095a => _0x2de116[_0x48b9ab(0x432)][_0x48b9ab(0xa68)](_0x5769c0 => _0x5769c0['id'] === _0x37095a))[_0x48b9ab(0x3cf)](Boolean)['map'](_0x3600e1 => _0x48b9ab(0x9a0) + _0x3600e1['name'] + '\x0a' + _0x3600e1['content'])[_0x48b9ab(0x6cf)](''); if (_0x1c104d) _0x2cf0a = '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a' + _0x1c104d; } const _0x48b34f = _0x3ea515[_0x48b9ab(0x44a)] ? '\x0a\x0a#\x20关于读者“' + _0x3ea515[_0x48b9ab(0x499)] + _0x48b9ab(0xa45) + _0x3ea515[_0x48b9ab(0x44a)] : '', _0x43e6a5 = _0x3af87f(); let _0x6bff7f = '你还没有写日记。'; if (_0x28c19b && _0x28c19b[_0x48b9ab(0x71c)]) { if (_0x48b9ab(0x655) !== 'xgHMf') { const _0x78c20e = _0x2dfe95[_0x48b9ab(0x6b7)][_0x48b9ab(0xa68)](_0x40695e => _0x40695e['participantIds'][_0x48b9ab(0x8db)](_0x2e5e5f)); if (!_0x78c20e) return ''; const _0x979e07 = _0x4a9b30(_0x78c20e['id']), _0x7caf8a = _0xf4141c[_0x48b9ab(0x207)][_0x48b9ab(0x3cf)](_0x41b60d => _0x41b60d['userId'] === _0x979e07['id'] || !_0x41b60d[_0x48b9ab(0xacd)]); if (_0x7caf8a[_0x48b9ab(0xaa7)] === 0x0) return ''; const _0x11fc10 = _0x7caf8a['map'](_0xe167e7 => { const _0x29c850 = _0x48b9ab, _0x1b54d9 = _0xe167e7[_0x29c850(0x318)] === _0x29c850(0x9de) ? _0x29c850(0x4e1) : '待办'; return '-\x20[' + _0x1b54d9 + ']\x20' + _0xe167e7[_0x29c850(0x602)] + ':\x20' + _0xe167e7['content']; })[_0x48b9ab(0x6cf)]('\x0a'); return _0x48b9ab(0xa6c) + _0x979e07[_0x48b9ab(0x499)] + _0x48b9ab(0x5fe) + _0x11fc10; } else { const _0x8c598f = _0x28c19b[_0x48b9ab(0x71c)]['filter'](_0xe1d329 => _0xe1d329['author'] === _0x48b9ab(0x7da))[_0x48b9ab(0x23b)](); if (_0x8c598f) { if (_0x48b9ab(0x559) === _0x48b9ab(0x559)) _0x6bff7f = _0x8c598f[_0x48b9ab(0x5e2)]; else { const _0x4a3125 = _0xe0ef36['querySelectorAll']('p'); _0x4a3125[_0x48b9ab(0x201)](_0x5c7efc => _0x5c7efc[_0x48b9ab(0x51c)]['remove'](_0x48b9ab(0x8e0))); const _0x462fa3 = _0x4793ed[_0x48b9ab(0x8f3)](_0x48b9ab(0x1ca) + _0x2cf978); _0x462fa3 && (_0x462fa3[_0x48b9ab(0x51c)][_0x48b9ab(0x6dd)](_0x48b9ab(0x8e0)), _0x462fa3[_0x48b9ab(0x23f)]({ 'behavior': _0x48b9ab(0xb4c), 'block': _0x48b9ab(0x261) })); } } } } const _0x22c08d = _0x48b9ab(0x6f2) + _0x2af87c['name'] + _0x48b9ab(0x87e) + _0x3ea515[_0x48b9ab(0x499)] + _0x48b9ab(0xb8d) + _0x3ea515[_0x48b9ab(0x499)] + '）最新写下的日记内容。Ta写的是：\x0a\x20“' + _0x6bff7f + '”\x20\x0a\x20你必须针对这段内容表达你的看法、感受或关联的思考。\x0a2.\x20\x20**【次要任务：分享自我】**\x20在回应之后，你**必须**分享一些关于你自己的、读者**不知道**的新鲜事。可以是你今天的见闻、一个突然的想法、或者一件小小的秘密。不要总是复述你们已经聊过的内容！\x0a3.\x20\x20**【禁止复读】**\x20聊天记录和动态只是你的“背景记忆”，是用来确保你不OOC的参考，**绝对不是**你日记的主要内容！\x0a\x0a#\x20你的核心人设\x20(必须遵守)\x0a' + _0x2af87c[_0x48b9ab(0x44a)] + '\x0a' + _0x48b34f + '\x0a' + _0x2cf0a + _0x48b9ab(0x230) + new Date()[_0x48b9ab(0xb18)](_0x48b9ab(0x2e3), { 'dateStyle': 'full', 'timeStyle': _0x48b9ab(0xa90) }) + _0x48b9ab(0x670) + _0x4f5166(new Date(_0x28c19b?.[_0x48b9ab(0x71c)]?.['at'](-0x1)?.['timestamp'] || Date[_0x48b9ab(0x83b)]())) + _0x48b9ab(0x32c) + (_0x208967 || _0x48b9ab(0x816)) + _0x48b9ab(0x93f) + (_0x43e6a5 || _0x48b9ab(0x210)) + '\x0a---\x0a\x0a#\x20输出要求\x0a直接输出一篇有文采、有真情实感的日记正文，不要包含任何其他说明或前缀。'; _0xcea56b = [{ 'role': 'system', 'content': _0x22c08d }, { 'role': _0x48b9ab(0x7da), 'content': _0x48b9ab(0x3c1) }]; const _0x364a2f = await _0x4df70c(_0xcea56b); if (_0x364a2f) { if (_0x48b9ab(0x1fc) !== 'uUZTP') { if (!_0x18beac['isArray'](_0x2a82a2)) return _0x48b9ab(0x6aa); if (_0x5654a9['length'] === 0x0) return _0x48b9ab(0x2b2); return _0x3f9355[_0x48b9ab(0xb71)]((_0x24300f, _0x5b1b13) => new _0x48c53c(_0x5b1b13['last_edited']) - new _0x29e799(_0x24300f['last_edited'])), _0x2bc742[_0x48b9ab(0x7c6)](_0x8b72fa => '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20background:\x20#fffbf2;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>' + (_0x8b72fa[_0x48b9ab(0x773)] || _0x48b9ab(0x998)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22\x20style=\x22white-space:\x20pre-wrap;\x20margin-top:\x208px;\x20line-height:\x201.6;\x22>' + (_0x8b72fa[_0x48b9ab(0x5e2)] || '') + _0x48b9ab(0x4a2) + (_0x8b72fa['last_edited'] || '') + _0x48b9ab(0xa03))[_0x48b9ab(0x6cf)](''); } else { let _0x51ad0e = _0x2de116[_0x48b9ab(0x38b)][_0x48b9ab(0xa68)](_0x49336e => _0x49336e[_0x48b9ab(0x441)] === _0xa4efb4); !_0x51ad0e && ('ZXxyF' !== _0x48b9ab(0x7a1) ? (_0x4ed0b6(), _0x49a69b('编辑群成员功能正在开发中...')) : (_0x51ad0e = { 'characterId': _0xa4efb4, 'entries': [] }, _0x2de116[_0x48b9ab(0x38b)][_0x48b9ab(0x8d9)](_0x51ad0e))); _0x51ad0e['entries']['push']({ 'timestamp': Date['now'](), 'author': _0xa4efb4, 'content': _0x364a2f }), _0x2ca195(); const _0x15145b = _0x51ad0e[_0x48b9ab(0x71c)][_0x48b9ab(0xaa7)]; _0x2de116[_0x48b9ab(0xaf2)] = Math['ceil'](_0x15145b / 0x2) - 0x1, _0x2ee6f3(); } } } catch (_0x86a97b) { if (_0x48b9ab(0x21b) !== _0x48b9ab(0x65d)) _0x15e83d(_0x48b9ab(0x6f3) + _0x86a97b[_0x48b9ab(0x722)]); else { _0x5e8a84(_0x48b9ab(0x3a5)); return; } } finally { _0xc9067c(![]), _0x2de116[_0x48b9ab(0x3b8)] = ![]; } } else return new _0x388922(_0x1158e4 => { const _0x27f0f2 = _0x48b9ab, _0x1f7bd1 = _0x121e1e[_0x27f0f2(0x8f3)](_0x27f0f2(0xa86)), _0x546f59 = _0xbbc0e6['getElementById']('modal-text'), _0x38fbfa = _0x3b8a6d[_0x27f0f2(0x8f3)](_0x27f0f2(0x7e9)), _0x1dd879 = _0x47e472[_0x27f0f2(0x8f3)](_0x27f0f2(0x333)), _0x1cd1e4 = _0x49f72d['getElementById'](_0x27f0f2(0x851)); _0x546f59[_0x27f0f2(0x1cd)] = _0x459db4, _0x1f7bd1[_0x27f0f2(0x3e0)][_0x27f0f2(0xab9)] = 'flex'; const _0xe9e0ba = _0x4e1030 => { const _0x1d9255 = _0x27f0f2; _0x1f7bd1[_0x1d9255(0x3e0)][_0x1d9255(0xab9)] = _0x1d9255(0x1bf), _0x38fbfa[_0x1d9255(0x7a5)] = _0x1dd879['onclick'] = _0x1cd1e4[_0x1d9255(0x7a5)] = null, _0x3d341a['removeEventListener'](_0x1d9255(0xa0e), _0x55ec12), _0x1158e4(_0x4e1030); }, _0x55ec12 = _0x1b3bd2 => { const _0x43efa4 = _0x27f0f2; if (_0x1b3bd2[_0x43efa4(0x64a)] === 'Escape') _0xe9e0ba(![]); if (_0x1b3bd2[_0x43efa4(0x64a)] === _0x43efa4(0xb56)) _0xe9e0ba(!![]); }; _0x38fbfa[_0x27f0f2(0x7a5)] = () => _0xe9e0ba(!![]), _0x1dd879[_0x27f0f2(0x7a5)] = () => _0xe9e0ba(![]), _0x1cd1e4[_0x27f0f2(0x7a5)] = () => _0xe9e0ba(![]), _0x3d3267[_0x27f0f2(0x85f)](_0x27f0f2(0xa0e), _0x55ec12); }); } function _0x48c4bd() { const _0x3919fd = _0x234a7d, _0x53ef5a = document[_0x3919fd(0x8f3)]('meeting-scene-view'), _0x2f8ae4 = document[_0x3919fd(0x8f3)]('galgame-view-container'), _0x5b3bef = document[_0x3919fd(0xac8)](_0x3919fd(0xb05)); _0x2de116[_0x3919fd(0x8a9)] === _0x3919fd(0x452) ? (_0x53ef5a[_0x3919fd(0x3e0)][_0x3919fd(0xab9)] = 'none', _0x2f8ae4[_0x3919fd(0x3e0)][_0x3919fd(0xab9)] = _0x3919fd(0x5ac)) : _0x3919fd(0xb62) !== 'Yuyoq' ? _0x2dd6ae = _0x44c4d2[_0x3919fd(0x51e)] || '' : (_0x53ef5a[_0x3919fd(0x3e0)]['display'] = _0x3919fd(0x5ac), _0x2f8ae4[_0x3919fd(0x3e0)][_0x3919fd(0xab9)] = 'none'), _0x5b3bef['style'][_0x3919fd(0xab9)] = _0x3919fd(0x5ac); } function _0x348ac8() { const _0x5dd0d0 = _0x234a7d, _0xf438d7 = document[_0x5dd0d0(0x8f3)](_0x5dd0d0(0x98f)), _0x39ee8a = document[_0x5dd0d0(0x8f3)]('galgame-text'); if (_0x2de116['activeMeetingScriptQueue'][_0x5dd0d0(0xaa7)] > 0x0) { const _0x12d4fd = _0x2de116[_0x5dd0d0(0x8f7)][_0x5dd0d0(0x1ed)](); _0xf438d7[_0x5dd0d0(0x1cd)] = _0x12d4fd[_0x5dd0d0(0xbbe)] === _0x5dd0d0(0x5f8) ? '旁白' : _0x12d4fd['speaker'], _0x39ee8a[_0x5dd0d0(0x1cd)] = _0x12d4fd[_0x5dd0d0(0x910)], _0x12d4fd[_0x5dd0d0(0xbbe)] !== _0x5dd0d0(0x5f8) && _0x5852e0(_0x2de116['activeMeetingCharId'], _0x12d4fd['emotion']); } else { const _0x41abc1 = _0x2de116[_0x5dd0d0(0x58f)][_0x2de116[_0x5dd0d0(0x2df)]]; if (_0x41abc1 && _0x41abc1[_0x5dd0d0(0xaa7)] > 0x0) { _0x2de116[_0x5dd0d0(0x8f7)] = [..._0x41abc1]; const _0x1bfcfb = _0x2de116['activeMeetingScriptQueue'][_0x5dd0d0(0x1ed)](); _0xf438d7[_0x5dd0d0(0x1cd)] = _0x1bfcfb[_0x5dd0d0(0xbbe)] === _0x5dd0d0(0x5f8) ? '旁白' : _0x1bfcfb[_0x5dd0d0(0xbbe)], _0x39ee8a['textContent'] = _0x1bfcfb[_0x5dd0d0(0x910)], _0x1bfcfb[_0x5dd0d0(0xbbe)] !== 'narrator' && (_0x5dd0d0(0x214) !== _0x5dd0d0(0xa5e) ? _0x5852e0(_0x2de116[_0x5dd0d0(0x2df)], _0x1bfcfb[_0x5dd0d0(0x453)]) : _0x527893()); } else { if (_0x5dd0d0(0x4b2) === _0x5dd0d0(0x1b4)) { _0x30830e[_0x5dd0d0(0x27b)]('错误：第一个好友圈\x20\x22' + _0x5b7bb9['name'] + _0x5dd0d0(0x1b5)); return; } else _0xf438d7['textContent'] = '旁白', _0x39ee8a['textContent'] = _0x5dd0d0(0xb27); } } } async function _0x5852e0(_0x4b8d64, _0x2c732f) { const _0xac126b = _0x234a7d, _0xe1630f = document[_0xac126b(0x8f3)](_0xac126b(0x809)), _0x35a9c1 = document[_0xac126b(0x8f3)](_0xac126b(0x642)), _0x3ef431 = _0x11feaf(_0x4b8d64), _0x476309 = _0x3ef431?.['spriteTransform'] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }, _0x1a1fc3 = 0x50 * _0x476309[_0xac126b(0x7a8)]; _0x35a9c1[_0xac126b(0x3e0)][_0xac126b(0xab3)] = _0x1a1fc3 + '%', _0x35a9c1[_0xac126b(0x3e0)]['width'] = _0x1a1fc3 + '%', _0x35a9c1['style'][_0xac126b(0xbb3)] = _0x476309['x'] + '%', _0x35a9c1[_0xac126b(0x3e0)]['top'] = _0x476309['y'] + '%', _0x35a9c1[_0xac126b(0x3e0)]['transform'] = 'translate(-50%,\x20-100%)', _0x35a9c1[_0xac126b(0x3e0)]['bottom'] = _0xac126b(0x3d2); const _0x282a00 = [_0xac126b(0x388), _0xac126b(0x629), 'angry', _0xac126b(0x4ff), _0xac126b(0x627)], _0x5369ca = _0x282a00['includes'](_0x2c732f) ? _0x2c732f : _0xac126b(0x388); try { const _0x30932a = await _0x26239c(_0xac126b(0x84d) + _0x5369ca + '_' + _0x4b8d64); if (_0x30932a) _0xe1630f['src'] && _0xe1630f[_0xac126b(0x3e0)][_0xac126b(0xae0)] !== '0' ? (_0xe1630f[_0xac126b(0x3e0)]['opacity'] = 0x0, setTimeout(() => { const _0x3f0efb = _0xac126b; _0xe1630f[_0x3f0efb(0xa9c)] = URL[_0x3f0efb(0x64d)](_0x30932a), _0xe1630f[_0x3f0efb(0x3e0)]['opacity'] = 0x1; }, 0x96)) : (_0xe1630f[_0xac126b(0xa9c)] = URL[_0xac126b(0x64d)](_0x30932a), _0xe1630f[_0xac126b(0x3e0)][_0xac126b(0xae0)] = 0x1); else { const _0x425a0c = await _0x26239c(_0xac126b(0xb20) + _0x4b8d64); _0xe1630f[_0xac126b(0xa9c)] = _0x425a0c ? URL[_0xac126b(0x64d)](_0x425a0c) : ''; } } catch (_0x5776bc) { _0xac126b(0x4f1) !== 'rUetW' ? (console[_0xac126b(0x27b)]('加载立绘失败:', _0x5776bc), _0xe1630f[_0xac126b(0xa9c)] = '') : _0x334bbb['src'] = _0xa84968[_0xac126b(0x64d)](_0x1802b6); } } let _0x1039a7 = ![], _0x20722b = { 'isDragging': ![], 'isResizing': ![], 'startX': 0x0, 'startY': 0x0, 'startLeft': 0x0, 'startTop': 0x0, 'startWidth': 0x0, 'startHeight': 0x0 }; const _0x43bc77 = document[_0x234a7d(0x8f3)](_0x234a7d(0x6e0)), _0x1dd86b = document[_0x234a7d(0x8f3)]('sprite-confirm-button'), _0x12c0c8 = document[_0x234a7d(0x8f3)]('sprite-cancel-button'), _0xfff191 = document[_0x234a7d(0x8f3)]('sprite-reset-button'), _0x4c41c2 = document[_0x234a7d(0x8f3)](_0x234a7d(0xa5f)), _0x53d8b8 = document[_0x234a7d(0x8f3)](_0x234a7d(0x642)), _0xc790e6 = document['getElementById'](_0x234a7d(0x307)), _0x3203a5 = document['getElementById'](_0x234a7d(0x539)); let _0x3676cd = {}; function _0x519444() { const _0x1cc880 = _0x234a7d, _0x54ddd0 = _0x11feaf(_0x2de116[_0x1cc880(0x2df)]); if (!_0x54ddd0) return; _0x1039a7 = !![], _0x4c41c2['style'][_0x1cc880(0xab9)] = _0x1cc880(0x5ac); const _0x4db870 = _0x54ddd0[_0x1cc880(0x9b8)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; document[_0x1cc880(0x8f3)]('sprite-slider-x')[_0x1cc880(0xa35)] = _0x4db870['x'], document[_0x1cc880(0x8f3)]('sprite-slider-y')[_0x1cc880(0xa35)] = _0x4db870['y'], document[_0x1cc880(0x8f3)]('sprite-slider-scale')['value'] = _0x4db870['scale'] * 0x64, _0x3676cd = { ..._0x4db870 }, document[_0x1cc880(0x8f3)]('galgame-textbox-container')[_0x1cc880(0x3e0)][_0x1cc880(0xab9)] = _0x1cc880(0x1bf), document[_0x1cc880(0x8f3)]('galgame-sprite-adjust-ui')[_0x1cc880(0x3e0)]['display'] = _0x1cc880(0x1bf); } function _0x37f591(_0x51edca = ![]) { const _0x53f7e6 = _0x234a7d; _0x1039a7 = ![], _0x4c41c2[_0x53f7e6(0x3e0)][_0x53f7e6(0xab9)] = _0x53f7e6(0x1bf), document[_0x53f7e6(0x8f3)](_0x53f7e6(0x8a2))['style'][_0x53f7e6(0xab9)] = 'block', document[_0x53f7e6(0x8f3)]('galgame-sprite-adjust-ui')[_0x53f7e6(0x3e0)][_0x53f7e6(0xab9)] = _0x53f7e6(0x5ac); if (!_0x51edca) { const _0x5b5418 = _0x11feaf(_0x2de116[_0x53f7e6(0x2df)]); _0x5b5418 && (_0x5b5418[_0x53f7e6(0x9b8)] = _0x3676cd, _0x5852e0(_0x2de116[_0x53f7e6(0x2df)], 'normal')); } } function _0x3b0d51() { const _0x548843 = _0x234a7d, _0x4a649c = _0x11feaf(_0x2de116[_0x548843(0x2df)]); if (!_0x4a649c) return; const _0x528944 = parseFloat(document['getElementById']('sprite-slider-x')[_0x548843(0xa35)]), _0x43a1d6 = parseFloat(document['getElementById']('sprite-slider-y')[_0x548843(0xa35)]), _0x23025c = parseFloat(document[_0x548843(0x8f3)](_0x548843(0xa3f))[_0x548843(0xa35)]) / 0x64; _0x4a649c[_0x548843(0x9b8)] = { 'x': _0x528944, 'y': _0x43a1d6, 'scale': _0x23025c }, _0x2ca195(), _0x15e83d(_0x548843(0xba7)), _0x37f591(!![]); } function _0x296dda() { const _0x45cee8 = _0x234a7d; _0x2244b3('确定要恢复这个角色的默认立绘位置吗？')[_0x45cee8(0xad3)](_0x33ae1d => { const _0x37cf03 = _0x45cee8; if (_0x33ae1d) { if (_0x37cf03(0x715) !== _0x37cf03(0x1c6)) { const _0x13a029 = _0x11feaf(_0x2de116[_0x37cf03(0x2df)]); _0x13a029 && (_0x37cf03(0x607) !== _0x37cf03(0x955) ? (delete _0x13a029[_0x37cf03(0x9b8)], _0x2ca195(), _0x5852e0(_0x13a029['id'], _0x37cf03(0x388)), _0x15e83d(_0x37cf03(0x7d3)), _0x37f591(!![])) : (_0x2ec7e1(_0x2b150e['id']), _0xfb30d4(_0x37cf03(0x8e9)), _0x318bfe('chat'), _0x33fe2d(![]))); } else _0x96a399['getElementById'](_0x37cf03(0x200))[_0x37cf03(0xa35)] = '', _0xc0000c[_0x37cf03(0x8f3)](_0x37cf03(0x71b))['textContent'] = _0x37cf03(0xb78), _0x4bac4b[_0x37cf03(0x8f3)]('world-book-edit-name')[_0x37cf03(0xa35)] = '', _0x1a1838[_0x37cf03(0x8f3)](_0x37cf03(0x31c))[_0x37cf03(0xa35)] = ''; } }); } function _0x5fe9e6() { const _0x4eb279 = _0x234a7d; if (_0x4eb279(0xa61) === _0x4eb279(0x25b)) _0x46d79d(_0x22129b), _0x5e8707(); else { if (!_0x1039a7) return; const _0x213396 = _0x2de116[_0x4eb279(0x2df)], _0x486b7b = _0x11feaf(_0x213396); if (!_0x486b7b) return; const _0x3048fd = parseFloat(document[_0x4eb279(0x8f3)](_0x4eb279(0x976))['value']), _0x4ea559 = parseFloat(document[_0x4eb279(0x8f3)](_0x4eb279(0x944))[_0x4eb279(0xa35)]), _0x479c68 = parseFloat(document['getElementById'](_0x4eb279(0xa3f))[_0x4eb279(0xa35)]) / 0x64; _0x486b7b[_0x4eb279(0x9b8)] = { 'x': _0x3048fd, 'y': _0x4ea559, 'scale': _0x479c68 }; const _0x34ec3b = document[_0x4eb279(0x8f3)]('galgame-sprite-container'), _0x331df1 = 0x50 * _0x479c68; _0x34ec3b[_0x4eb279(0x3e0)][_0x4eb279(0xab3)] = _0x331df1 + '%', _0x34ec3b['style'][_0x4eb279(0x96a)] = _0x331df1 + '%', _0x34ec3b['style'][_0x4eb279(0xbb3)] = _0x3048fd + '%', _0x34ec3b[_0x4eb279(0x3e0)][_0x4eb279(0x8ae)] = _0x4ea559 + '%', _0x34ec3b[_0x4eb279(0x3e0)]['transform'] = _0x4eb279(0x300); } } document['getElementById']('sprite-slider-x')[_0x234a7d(0x85f)](_0x234a7d(0x296), _0x5fe9e6), document['getElementById']('sprite-slider-y')[_0x234a7d(0x85f)](_0x234a7d(0x296), _0x5fe9e6), document[_0x234a7d(0x8f3)](_0x234a7d(0xa3f))[_0x234a7d(0x85f)](_0x234a7d(0x296), _0x5fe9e6), _0x43bc77[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x519444), _0x1dd86b[_0x234a7d(0x85f)]('click', _0x3b0d51), _0x12c0c8[_0x234a7d(0x85f)]('click', () => _0x37f591(![])), _0xfff191[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x296dda); function _0x27e93b(_0x589176) { const _0x1a7fa3 = _0x234a7d; if ('hUPCm' === _0x1a7fa3(0x521)) _0x3d51ea[_0x1a7fa3(0x27b)](_0x1a7fa3(0x6d5), _0x5725be), _0x3d221a(_0x1a7fa3(0x95b) + _0x332d26[_0x1a7fa3(0x722)]); else { const _0x2b32f8 = _0x11feaf(_0x589176); if (!_0x2b32f8) return; const _0x56060f = _0x2de116[_0x1a7fa3(0x6b7)]['find'](_0x2cd92d => _0x2cd92d['type'] === _0x1a7fa3(0x2c0) && _0x2cd92d[_0x1a7fa3(0x6a3)]['includes'](_0x589176)), _0x430558 = _0x41382f(_0x56060f['id']), _0x5b8179 = _0x2de116['conversationHistory'][_0x1a7fa3(0x3cf)](_0x471a70 => _0x471a70[_0x1a7fa3(0x484)])[_0x1a7fa3(0x23b)](), _0x57b4f2 = document[_0x1a7fa3(0x8f3)](_0x1a7fa3(0x98f)), _0x219ee7 = document[_0x1a7fa3(0x8f3)](_0x1a7fa3(0x92e)); let _0x105a28 = null; if (_0x5b8179) { if (_0x5b8179[_0x1a7fa3(0x9e8)] === _0x1a7fa3(0x1f4)) { const _0x3fabb6 = _0x2de116['characterLastScripts'][_0x589176]; if (_0x3fabb6 && _0x3fabb6['length'] > 0x0) { if ('ijoVN' === _0x1a7fa3(0x8a6)) _0x105a28 = _0x3fabb6['at'](-0x1); else { _0x421906(_0x1a7fa3(0xa31)); return; } } } else _0x105a28 = { 'speaker': _0x430558[_0x1a7fa3(0x499)], 'line': _0x5b8179[_0x1a7fa3(0x5e2)], 'emotion': _0x1a7fa3(0x388) }; } if (_0x105a28) _0x57b4f2[_0x1a7fa3(0x1cd)] = _0x105a28[_0x1a7fa3(0xbbe)] === _0x1a7fa3(0x5f8) ? '旁白' : _0x105a28[_0x1a7fa3(0xbbe)], _0x219ee7[_0x1a7fa3(0x1cd)] = _0x105a28[_0x1a7fa3(0x910)], _0x105a28[_0x1a7fa3(0xbbe)] === _0x2b32f8['name'] ? _0x5852e0(_0x589176, _0x105a28[_0x1a7fa3(0x453)]) : _0x5852e0(_0x589176, _0x1a7fa3(0x388)); else { if ('Wekga' !== 'TJpGG') _0x57b4f2['textContent'] = _0x2b32f8[_0x1a7fa3(0x499)], _0x219ee7[_0x1a7fa3(0x1cd)] = _0x1a7fa3(0x6de), _0x5852e0(_0x589176, 'normal'); else { const _0x1e0cf7 = _0x4eecf0['getAll'](); _0x1e0cf7[_0x1a7fa3(0x7b4)] = () => _0x9df609(_0x1e0cf7[_0x1a7fa3(0x774)]), _0x1e0cf7[_0x1a7fa3(0x611)] = () => _0xabdfb9(_0x1e0cf7['error']); } } } } function _0x8431ed() { const _0x321330 = _0x234a7d, _0x2d6864 = new Date(), _0x36fad7 = document[_0x321330(0x8f3)](_0x321330(0xa32)), _0x5c1184 = document['getElementById'](_0x321330(0x362)); if (_0x36fad7 && _0x5c1184) { const _0x17eea1 = String(_0x2d6864[_0x321330(0x6ca)]())[_0x321330(0x6f9)](0x2, '0'), _0x4693c4 = String(_0x2d6864['getMinutes']())[_0x321330(0x6f9)](0x2, '0'); _0x36fad7[_0x321330(0x1cd)] = _0x17eea1 + ':' + _0x4693c4; const _0x2741c9 = _0x2d6864[_0x321330(0xbbb)]() + 0x1, _0xf6ce48 = _0x2d6864[_0x321330(0x6b8)](), _0x479654 = [_0x321330(0x2c8), '星期一', _0x321330(0x324), _0x321330(0x9be), _0x321330(0x3fa), _0x321330(0x430), _0x321330(0x9b7)][_0x2d6864[_0x321330(0x7f3)]()]; _0x5c1184['textContent'] = _0x2741c9 + '月' + _0xf6ce48 + '日\x20' + _0x479654; } } const _0x5729d5 = document[_0x234a7d(0x8f3)](_0x234a7d(0x815)), _0x3b03bd = document[_0x234a7d(0x8f3)](_0x234a7d(0x473)), _0x52e697 = document[_0x234a7d(0x8f3)](_0x234a7d(0x4f5)), _0x3a4d40 = document[_0x234a7d(0x8f3)](_0x234a7d(0x238)), _0x292249 = document[_0x234a7d(0x8f3)](_0x234a7d(0x263)), _0x296518 = document[_0x234a7d(0x8f3)]('unified-audio-player'), _0x2aadee = document[_0x234a7d(0x8f3)](_0x234a7d(0x87a)), _0x4bcde2 = document[_0x234a7d(0x8f3)](_0x234a7d(0x58d)), _0xd6cc28 = document[_0x234a7d(0x8f3)](_0x234a7d(0x5d1)); let _0x179379 = []; async function _0x29889d() { const _0x1e4cae = _0x234a7d; if (_0x1e4cae(0x546) !== _0x1e4cae(0x901)) { if (!_0x2de116[_0x1e4cae(0xb7c)]) return; _0x292249[_0x1e4cae(0x82c)] = _0x1e4cae(0x3ce), _0x5729d5[_0x1e4cae(0x51c)][_0x1e4cae(0x6dd)](_0x1e4cae(0x530)); const _0x5b4f48 = await _0x38686b(); if (_0x5b4f48['length'] === 0x0) { if (_0x1e4cae(0x29f) !== _0x1e4cae(0x29f)) return { 'type': 'sticker', 'name': _0x1315a0[0x1]['trim']() }; else { _0x292249[_0x1e4cae(0x82c)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>'; return; } } _0x292249['innerHTML'] = '', _0x5b4f48[_0x1e4cae(0x201)](_0x4de422 => { const _0x53e1db = _0x1e4cae, _0xd66c32 = document[_0x53e1db(0xb35)](_0x53e1db(0x4e8)); _0xd66c32[_0x53e1db(0xaff)] = 'music-library-item'; const _0x48746b = _0x4de422[_0x53e1db(0x43e)] ? URL['createObjectURL'](_0x4de422[_0x53e1db(0x43e)]) : _0x322703; _0xd66c32[_0x53e1db(0x82c)] = _0x53e1db(0x61a) + _0x48746b + _0x53e1db(0x250) + (_0x4de422[_0x53e1db(0x5ba)][_0x53e1db(0x8dc)] || _0x53e1db(0x961)) + _0x53e1db(0x4a1) + (_0x4de422[_0x53e1db(0x5ba)]['歌手'] || _0x53e1db(0x3f1)) + _0x53e1db(0xa03), _0xd66c32[_0x53e1db(0x85f)](_0x53e1db(0xbba), () => { const _0x1115d6 = _0x53e1db; if (_0x1115d6(0x280) !== _0x1115d6(0x280)) { if (_0x34e0ab['type'] === _0x1115d6(0x534)) _0x1a404b[_0x1115d6(0xb16)](); _0x424d54(_0x280731); } else _0x3aa70a(_0x4de422); }), _0x292249[_0x53e1db(0x3bf)](_0xd66c32); }); } else { _0x51d2a8(_0x1e4cae(0x9ad)); return; } } function _0x26571a() { const _0x34fe35 = _0x234a7d; _0x5729d5[_0x34fe35(0x51c)]['remove'](_0x34fe35(0x530)); } async function _0x3aa70a(_0xe7827a) { const _0x29b78d = _0x234a7d; if (!_0x2de116['activeChatId'] || !_0xe7827a) return; let _0x2d53db = null; if (_0xe7827a[_0x29b78d(0x43e)]) try { _0x29b78d(0x6c8) !== _0x29b78d(0xab7) ? (_0x2d53db = _0x29b78d(0xa24) + Date['now']() + '_' + Math[_0x29b78d(0x77b)](), await _0x1d2a3c(_0x2d53db, _0xe7827a[_0x29b78d(0x43e)])) : (_0x1522ea[_0x29b78d(0x27b)](_0x29b78d(0xafb), _0x1c71ef), _0x1b6e73[_0x29b78d(0x758)](_0x29b78d(0x9bb))); } catch (_0x3263f7) { console[_0x29b78d(0x27b)](_0x29b78d(0xb90), _0x3263f7); } const _0x37105a = { 'role': _0x29b78d(0x7da), 'type': 'listen-together-invite', 'content': _0x29b78d(0x8d0) + _0xe7827a['info']['歌曲名称'] + ']', 'songId': _0xe7827a['id'], 'songName': _0xe7827a['info']['歌曲名称'], 'artist': _0xe7827a[_0x29b78d(0x5ba)]['歌手'], 'coverId': _0x2d53db, 'timestamp': Date['now']() }; _0x2de116[_0x29b78d(0x59f)]['push'](_0x37105a), _0x5ca5a8(), _0x100f70(), _0x26571a(), setTimeout(_0x525b8d, 0x64); } _0x3b03bd[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x29889d), _0x52e697[_0x234a7d(0x85f)](_0x234a7d(0xbba), _0x26571a), _0x3a4d40['addEventListener'](_0x234a7d(0xbba), _0x26571a); async function _0x521657(_0x576108, _0x53b948, _0x47c4fd) { const _0x29e5c6 = _0x234a7d, _0x18c238 = _0x2de116['chats'][_0x29e5c6(0xa68)](_0x576ff5 => _0x576ff5['activeListenSession'] && _0x576ff5['activeListenSession'][_0x29e5c6(0x4f9)]), _0x111e27 = _0x231de4(); if (_0x18c238 && _0x18c238['id'] !== _0x111e27['id']) _0x29e5c6(0x55a) !== _0x29e5c6(0xb6b) ? (_0x18c238[_0x29e5c6(0x203)] = null, _0x15e83d(_0x29e5c6(0x2c1)), _0x2ca195()) : _0x3c9675[_0x29e5c6(0xb16)](); else { if (_0x18c238 && _0x18c238['id'] === _0x111e27['id']) { if ('TROOx' !== _0x29e5c6(0x525)) { _0x5f3796[_0x29e5c6(0x82c)] = _0x29e5c6(0xa42), _0xa46805[_0x29e5c6(0x82c)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x1b8519[_0x29e5c6(0x8f3)](_0x29e5c6(0x857))[_0x29e5c6(0x85f)](_0x29e5c6(0xbba), _0x2c3488), _0x59b827[_0x29e5c6(0x8f3)](_0x29e5c6(0x719))[_0x29e5c6(0x85f)]('click', _0x32eaaf); return; } else _0x15e83d(_0x29e5c6(0x59e)); } } _0xc9067c(!![], _0x29e5c6(0x344)); if (!_0x111e27) { _0xc9067c(![]), _0x15e83d(_0x29e5c6(0x641)); return; } const _0x52abf2 = await _0x26c0eb(_0x576108); if (!_0x52abf2) { _0xc9067c(![]), _0x15e83d(_0x29e5c6(0xad1)); return; } _0x111e27[_0x29e5c6(0x203)] = { 'isActive': !![], 'songId': _0x576108, 'leaderId': 'user', 'songName': _0x52abf2[_0x29e5c6(0x5ba)][_0x29e5c6(0x8dc)], 'artist': _0x52abf2['info']['歌手'], 'cover': _0x52abf2[_0x29e5c6(0x43e)] }, _0x2ca195(), document[_0x29e5c6(0x8f3)](_0x29e5c6(0x4ec))[_0x29e5c6(0xa9c)] = _0x52abf2['cover'] ? URL['createObjectURL'](_0x52abf2[_0x29e5c6(0x43e)]) : _0x322703, document[_0x29e5c6(0x8f3)](_0x29e5c6(0x705))[_0x29e5c6(0x1cd)] = _0x52abf2[_0x29e5c6(0x5ba)][_0x29e5c6(0x8dc)], document[_0x29e5c6(0x8f3)](_0x29e5c6(0x41c))[_0x29e5c6(0x1cd)] = _0x52abf2[_0x29e5c6(0x5ba)]['歌手'], _0x5dd2ff(_0x52abf2), _0x2aadee[_0x29e5c6(0x3e0)][_0x29e5c6(0xab9)] = 'flex', setTimeout(() => _0x2aadee[_0x29e5c6(0x51c)][_0x29e5c6(0x6dd)](_0x29e5c6(0x530)), 0xa), _0x47c4fd[_0x29e5c6(0x82c)] = _0x29e5c6(0x39b) + _0x47c4fd[_0x29e5c6(0xac8)]('.listen-together-song')[_0x29e5c6(0x975)]; if (_0x2de116['conversationHistory'][_0x53b948]) { if ('zTnTP' === 'zTnTP') _0x2de116[_0x29e5c6(0x59f)][_0x53b948]['accepted'] = !![], _0x5ca5a8(); else { const _0x10d042 = _0x371d3d[_0x29e5c6(0x8f3)]('expense-description'), _0xac5c5c = _0x37211e[_0x29e5c6(0x8f3)](_0x29e5c6(0x9af)), _0xae6486 = _0x10d042[_0x29e5c6(0xa35)][_0x29e5c6(0x44c)](), _0x438d05 = _0x29486a(_0xac5c5c['value']); if (!_0xae6486 || _0x4d0968(_0x438d05) || _0x438d05 <= 0x0) { _0x52011a(_0x29e5c6(0xa0d)); return; } _0x28b79e[_0x29e5c6(0x669)][_0x29e5c6(0x8d9)]({ 'id': _0x29e5c6(0x3a2) + _0x57c78c[_0x29e5c6(0x83b)](), 'description': _0xae6486, 'amount': _0x438d05, 'timestamp': _0x25ad97[_0x29e5c6(0x83b)]() }), _0x494211(), _0x483aa4(), _0x10d042['value'] = '', _0xac5c5c['value'] = '', _0x10d042[_0x29e5c6(0x2e0)](); } } _0xc9067c(![]), _0x59e76c(_0x576108, [_0x576108]), _0x571235(_0x52abf2, !![]); } function _0x4ff0cf() { const _0x14f183 = _0x234a7d, _0x38df27 = _0x2de116[_0x14f183(0x6b7)]['find'](_0x43fe95 => _0x43fe95['activeListenSession'] && _0x43fe95[_0x14f183(0x203)][_0x14f183(0x4f9)]); _0x38df27 && (_0x38df27[_0x14f183(0x203)] = null, _0x2ca195(), _0x15e83d(_0x14f183(0x8b0)), _0x571235(), _0x2aadee[_0x14f183(0x51c)][_0x14f183(0x2e4)](_0x14f183(0x530)), setTimeout(() => _0x2aadee['style']['display'] = 'none', 0x12c)); } function _0x15d219(_0x1f0a8e) { const _0x6e6a11 = _0x234a7d; if (_0x6e6a11(0x766) !== _0x6e6a11(0x716)) { if (!_0x1f0a8e) return []; const _0x47d944 = _0x1f0a8e[_0x6e6a11(0x500)]('\x0a'), _0x6b4622 = [], _0x31395d = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x280d45 of _0x47d944) { if (_0x6e6a11(0x803) === _0x6e6a11(0x803)) { const _0x12ffaa = _0x280d45['match'](_0x31395d); if (_0x12ffaa) { if (_0x6e6a11(0x268) === 'XDoHO') { const _0x414d42 = { 'quotedMessage': null, 'content': _0x5de9f2 }, _0x3bdb57 = _0x4fd2d1[_0x6e6a11(0x435)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x3bdb57 && (_0x414d42[_0x6e6a11(0x9bd)] = { 'sender': _0x3bdb57[0x1][_0x6e6a11(0x44c)](), 'content': _0x3bdb57[0x2][_0x6e6a11(0x44c)]() }, _0x414d42[_0x6e6a11(0x5e2)] = _0x1480e2[_0x6e6a11(0x8c6)](_0x3bdb57[0x0]['length'])[_0x6e6a11(0x44c)]()), _0x414d42; } else { const _0x16b8e9 = parseInt(_0x12ffaa[0x1], 0xa), _0x4aa61f = parseInt(_0x12ffaa[0x2], 0xa), _0xe6ba23 = parseInt(_0x12ffaa[0x3], 0xa) * (_0x12ffaa[0x3][_0x6e6a11(0xaa7)] === 0x2 ? 0xa : 0x1), _0x3d59a8 = _0x16b8e9 * 0x3c + _0x4aa61f + _0xe6ba23 / 0x3e8, _0x3d9dea = _0x280d45[_0x6e6a11(0x915)](_0x31395d, '')[_0x6e6a11(0x44c)](); _0x3d9dea && _0x6b4622['push']({ 'time': _0x3d59a8, 'text': _0x3d9dea }); } } } else _0xb6444f *= _0x58f48d / _0x19e09e, _0x445c43 = _0x3c71f5; } return _0x6b4622; } else { _0x19efc6[_0x6e6a11(0x82c)] = _0x6e6a11(0x5b2); return; } } function _0x5dd2ff(_0xa72ab0) { const _0x480e1b = _0x234a7d; if ('fNHSo' === 'fNHSo') { _0x179379 = _0x15d219(_0xa72ab0['lyrics']), _0xd6cc28[_0x480e1b(0x82c)] = ''; if (_0x179379[_0x480e1b(0xaa7)] === 0x0) { _0xd6cc28['innerHTML'] = _0x480e1b(0x1be); return; } _0x179379[_0x480e1b(0x201)]((_0x1ec22f, _0x5ab847) => { const _0x151fb4 = _0x480e1b; if ('KgLMO' !== _0x151fb4(0x64f)) { const _0xe8c75 = document[_0x151fb4(0xb35)]('p'); _0xe8c75[_0x151fb4(0x1cd)] = _0x1ec22f[_0x151fb4(0x5bd)], _0xe8c75['id'] = _0x151fb4(0x1ca) + _0x5ab847, _0xd6cc28[_0x151fb4(0x3bf)](_0xe8c75); } else _0x41053b(_0x151fb4(0x482)); }); } else { if (!_0x543b8b[_0x480e1b(0x75c)](_0x193e46)) return '<p>格式错误</p>'; if (_0xb4dcbb[_0x480e1b(0xaa7)] === 0x0) return _0x480e1b(0x93e); return _0x35c98f[_0x480e1b(0xb71)]((_0x3aa7fd, _0x57910a) => new _0x1acd44(_0x57910a['timestamp']) - new _0x53101c(_0x3aa7fd[_0x480e1b(0xa71)])), _0x480e1b(0x971) + _0x3cadba['map']((_0x58b57f, _0x1bb6f8) => _0x480e1b(0x6c2) + (_0x1bb6f8 < _0x3044b7['length'] - 0x1 ? _0x480e1b(0x46b) : '') + _0x480e1b(0x3ea) + (_0x58b57f[_0x480e1b(0x99c)] || _0x480e1b(0xa06)) + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.85rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x208px;\x20padding:\x2010px;\x20background:\x20var(--surface-bg);\x20border-radius:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x58b57f[_0x480e1b(0x695)] || '没有找到相关结果。') + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22text-align:\x20right;\x20margin-top:\x208px;\x20font-size:\x200.7rem;\x22>' + (_0x58b57f['timestamp'] || '') + _0x480e1b(0x1de))['join']('') + _0x480e1b(0x806); } } function _0x381ddf(_0x1914c0, _0x209b6e, _0x3bcb64, _0x11f3a8) { const _0x5427a9 = _0x234a7d, _0x1437b0 = (_0x11f3a8 - 0x5a) * Math['PI'] / 0xb4; return { 'x': _0x1914c0 + _0x3bcb64 * Math[_0x5427a9(0xa30)](_0x1437b0), 'y': _0x209b6e + _0x3bcb64 * Math['sin'](_0x1437b0) }; } function _0x1ba845(_0x279677) { const _0x23cf73 = _0x234a7d; if (_0x23cf73(0x966) !== _0x23cf73(0xa7c)) { const _0x2be473 = _0x23cf73(0x368), _0x21dd02 = document['createElementNS'](_0x2be473, 'svg'), _0x15f41f = 0xfa, _0x145d1b = _0x15f41f / 0x2, _0x381988 = _0x15f41f / 0x2, _0x480e17 = _0x15f41f / 0x2 - 0x14; _0x21dd02[_0x23cf73(0x2a7)]('width', _0x23cf73(0x932)), _0x21dd02['setAttribute']('height', '100%'), _0x21dd02[_0x23cf73(0x2a7)]('viewBox', _0x23cf73(0x698) + _0x15f41f + '\x20' + _0x15f41f); const _0x1d7850 = Object[_0x23cf73(0x817)](_0x279677)['reduce']((_0x14462c, _0x47595e) => _0x14462c + _0x47595e, 0x0); if (_0x1d7850 === 0x0) return _0x21dd02; let _0x504ff4 = -0x5a; const _0x4f20e4 = [_0x23cf73(0x921), _0x23cf73(0x581), _0x23cf73(0x57e), _0x23cf73(0x3fb), '#c299ff', _0x23cf73(0x645), _0x23cf73(0x771), _0x23cf73(0x3f4)]; let _0x4f4fd8 = 0x0; for (const _0x5cd8d7 in _0x279677) { if (_0x23cf73(0x3db) !== _0x23cf73(0x687)) { const _0x427a4e = _0x279677[_0x5cd8d7]; if (_0x427a4e <= 0x0) continue; const _0x472f83 = _0x427a4e / _0x1d7850 * 0x168, _0x849a7c = _0x504ff4 + _0x472f83, _0x43cdc7 = _0x381ddf(_0x145d1b, _0x381988, _0x480e17, _0x849a7c), _0x5b7671 = _0x381ddf(_0x145d1b, _0x381988, _0x480e17, _0x504ff4), _0x978321 = _0x472f83 > 0xb4 ? '1' : '0', _0x49a82c = ['M', _0x43cdc7['x'], _0x43cdc7['y'], 'A', _0x480e17, _0x480e17, 0x0, _0x978321, 0x1, _0x5b7671['x'], _0x5b7671['y'], 'L', _0x145d1b, _0x381988, 'Z'][_0x23cf73(0x6cf)]('\x20'), _0x4c2810 = document['createElementNS'](_0x2be473, _0x23cf73(0x40a)); _0x4c2810[_0x23cf73(0x2a7)]('d', _0x49a82c), _0x4c2810['setAttribute']('fill', _0x4f20e4[_0x4f4fd8 % _0x4f20e4['length']]), _0x4f4fd8++; const _0x2ef0a0 = document['createElementNS'](_0x2be473, 'title'); _0x2ef0a0[_0x23cf73(0x1cd)] = _0x5cd8d7 + ':\x20' + _0x427a4e[_0x23cf73(0xaeb)](0x2) + '\x20(' + (_0x427a4e / _0x1d7850 * 0x64)[_0x23cf73(0xaeb)](0x1) + '%)', _0x4c2810[_0x23cf73(0x3bf)](_0x2ef0a0), _0x21dd02[_0x23cf73(0x3bf)](_0x4c2810), _0x504ff4 = _0x849a7c; } else { if (!_0x5857ee) return; _0x359d11 = _0x24b5a3[_0x23cf73(0xb91)][0x0][_0x23cf73(0x35a)], _0x3bc99b === _0x23cf73(0x4e9) && _0xce1b15(), _0xeafe2d = ![]; } } return _0x21dd02; } else { const _0x320748 = _0x48d3aa(_0x306050[_0x23cf73(0x50c)])?.[_0x23cf73(0x499)] || '未知'; return _0x23cf73(0x5cf) + _0x320748 + _0x23cf73(0x903) + _0x4a96da['content'] + _0x23cf73(0x806); } } function _0x4e1147() { const _0x25a30b = _0x234a7d; if (_0x179379[_0x25a30b(0xaa7)] === 0x0) return; const _0x4d1ead = _0x296518[_0x25a30b(0x3c6)]; let _0x377680 = -0x1; for (let _0xa52dc6 = 0x0; _0xa52dc6 < _0x179379['length']; _0xa52dc6++) { if (_0x4d1ead >= _0x179379[_0xa52dc6][_0x25a30b(0x2fd)]) { if (_0x25a30b(0x734) !== _0x25a30b(0x8c4)) _0x377680 = _0xa52dc6; else { if (_0x326c86[_0x25a30b(0xae1)][_0x25a30b(0x8db)](_0x338145['value'])) _0x28471e[_0x25a30b(0x875)] = !![]; } } else { if (_0x25a30b(0x64c) !== _0x25a30b(0x64c)) _0x10ca43[_0x25a30b(0x85f)]('click', () => { const _0x313e8a = _0x25a30b; _0x1a3829(_0x313e8a(0x59d)); }); else break; } } if (_0x377680 !== -0x1) { if (_0x25a30b(0x931) !== _0x25a30b(0x267)) { const _0x211169 = _0xd6cc28[_0x25a30b(0x672)]('p'); _0x211169[_0x25a30b(0x201)](_0x24f90a => _0x24f90a[_0x25a30b(0x51c)][_0x25a30b(0x2e4)]('active')); const _0x1ce68a = document[_0x25a30b(0x8f3)]('lyric-line-' + _0x377680); _0x1ce68a && (_0x25a30b(0x31e) === _0x25a30b(0x31e) ? (_0x1ce68a['classList'][_0x25a30b(0x6dd)](_0x25a30b(0x8e0)), _0x1ce68a[_0x25a30b(0x23f)]({ 'behavior': _0x25a30b(0xb4c), 'block': _0x25a30b(0x261) })) : _0x13ec1e[_0x25a30b(0x27b)](_0x25a30b(0xb9f), _0xa0b377)); } else _0x209c6e += _0x25a30b(0x9d1); } } _0x4bcde2[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x33bb5d = _0x234a7d; _0x2aadee[_0x33bb5d(0x51c)][_0x33bb5d(0x2e4)](_0x33bb5d(0x530)), setTimeout(() => _0x2aadee['style'][_0x33bb5d(0xab9)] = _0x33bb5d(0x1bf), 0x12c); }), document[_0x234a7d(0x8f3)]('music-widget-card')[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x1bcee4 = _0x234a7d; if (_0x1bcee4(0x495) !== 'LWVvD') { const _0x4a52ac = _0x3b4957[_0x1bcee4(0x8f3)](_0x1bcee4(0x505)); _0x4a52ac && _0x1bbfeb && (_0x4a52ac['src'] = _0x30ff87[_0x1bcee4(0x64d)](_0x193929)); } else _0x2de116[_0x1bcee4(0x47b)] && _0x2de116['listenTogetherSession'][_0x1bcee4(0x4f9)] && (_0x2aadee[_0x1bcee4(0x3e0)][_0x1bcee4(0xab9)] = _0x1bcee4(0x47f), setTimeout(() => _0x2aadee[_0x1bcee4(0x51c)][_0x1bcee4(0x6dd)](_0x1bcee4(0x530)), 0xa)); }), _0x296518['addEventListener'](_0x234a7d(0x9d4), _0x4e1147); const _0xd83916 = document[_0x234a7d(0x8f3)](_0x234a7d(0x458)), _0x18b978 = document[_0x234a7d(0x8f3)](_0x234a7d(0x6ef)), _0x12e26d = document['getElementById']('widget-prev-btn'); _0xd83916[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x241a78 = _0x234a7d; if (_0x296518[_0x241a78(0xa9c)]) { if (_0x241a78(0x631) !== _0x241a78(0x1b8)) { if (_0x296518['paused']) _0x296518[_0x241a78(0xa1d)](); else { if (_0x241a78(0x1e9) !== 'YXCRT') _0x296518[_0x241a78(0x742)](); else { const _0x341373 = _0x11ab41[_0x241a78(0x48e)]['files'][0x0]; if (!_0x341373) return; const _0x33bfdf = _0x2c2889[_0x241a78(0x64d)](_0x341373); _0x45c39c[_0x241a78(0xa9c)] = _0x33bfdf, _0x56e628['onload'] = () => { const _0x40bec7 = _0x241a78; _0x2901ab[_0x40bec7(0x83c)](_0x33bfdf); }; } } } else _0x1c1b2d && _0x3eafcf(_0x21fc3d['id'], _0x2d15ed[_0x241a78(0x7c6)](_0x5865f5 => _0x5865f5['id'])); } }), _0x18b978[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x2bfca3 = _0x234a7d; if (_0x2bfca3(0x93a) === _0x2bfca3(0x70a)) { const _0x1d8fae = _0x9d2dfe[_0x2bfca3(0xa35)][_0x2bfca3(0x44c)](); _0x1d8fae && (_0x1a03e0(_0x1d8fae), _0x2a3466[_0x2bfca3(0xa35)] = '', _0x16127a(_0x338230, 0x64)); } else { if (_0x2125a1[_0x2bfca3(0xaa7)] === 0x0) return; _0x3b2d0b = (_0x3b2d0b + 0x1) % _0x2125a1[_0x2bfca3(0xaa7)], _0x59e76c(_0x2125a1[_0x3b2d0b], _0x2125a1); } }), _0x12e26d[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x372465 = _0x234a7d; if (_0x2125a1['length'] === 0x0) return; _0x3b2d0b = (_0x3b2d0b - 0x1 + _0x2125a1[_0x372465(0xaa7)]) % _0x2125a1['length'], _0x59e76c(_0x2125a1[_0x3b2d0b], _0x2125a1); }), _0x296518['addEventListener'](_0x234a7d(0xa1d), () => { const _0x5e4a39 = _0x234a7d; _0x5e4a39(0x615) === 'EbtbG' ? (_0x150093(), _0x34b43d = null) : _0xd83916[_0x5e4a39(0x1cd)] = '❚❚'; }), _0x296518[_0x234a7d(0x85f)](_0x234a7d(0x742), () => { const _0x130ca1 = _0x234a7d; _0xd83916[_0x130ca1(0x1cd)] = '▶'; }), _0x296518['addEventListener'](_0x234a7d(0x8ac), () => { const _0x6b37c5 = _0x234a7d; _0x6b37c5(0x7a4) === 'fTLWz' ? _0x28bab5 += '-\x20**状态提示**:\x20你的生活正在进行中，生成的内容应该是“刚才”或“几分钟前”发生的。\x0a' : _0x18b978['click'](); }), _0x296518[_0x234a7d(0x85f)](_0x234a7d(0xa1d), () => { const _0x1bf991 = _0x234a7d, _0x22a859 = document['getElementById'](_0x1bf991(0xa89)); if (_0x22a859) _0x22a859[_0x1bf991(0x1cd)] = '❚❚'; }), _0x296518[_0x234a7d(0x85f)](_0x234a7d(0x742), () => { const _0x26775e = _0x234a7d, _0x9f1445 = document[_0x26775e(0x8f3)](_0x26775e(0xa89)); if (_0x9f1445) _0x9f1445[_0x26775e(0x1cd)] = '▶'; }), _0x296518[_0x234a7d(0x85f)]('ended', () => { const _0x3bf218 = _0x234a7d, _0x1c03cb = document['getElementById']('global-player-next-btn'); _0x1c03cb && _0x1c03cb[_0x3bf218(0xbba)](); }); function _0x5e2917(_0x2d5642) { const _0x2ebcd1 = _0x234a7d; if (!_0x2d5642 || typeof _0x2d5642 !== _0x2ebcd1(0xa98)) return null; const _0xe6ba13 = _0x2d5642[_0x2ebcd1(0x8ca)]('['), _0x12c169 = _0x2d5642[_0x2ebcd1(0xb94)](']'); if (_0xe6ba13 > -0x1 && _0x12c169 > _0xe6ba13) return _0x2d5642[_0x2ebcd1(0x8c6)](_0xe6ba13, _0x12c169 + 0x1); return null; } document['getElementById']('app-accounting')[_0x234a7d(0x85f)]('click', () => { const _0x4e92dd = _0x234a7d; _0x1e8db5(), _0x2faf14('accounting', _0x4e92dd(0x4ab)); }), document['getElementById']('back-to-home-from-accounting')[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => _0x2faf14(_0x234a7d(0x4ab), _0x234a7d(0x7c2))); const _0x492d42 = document[_0x234a7d(0x8f3)](_0x234a7d(0x431)), _0x32b0c3 = document[_0x234a7d(0x8f3)](_0x234a7d(0x3c0)); _0x492d42[_0x234a7d(0x85f)]('click', _0x1e8db5), _0x32b0c3['addEventListener']('click', () => { const _0x4e3700 = _0x234a7d; if ('GvBQa' === _0x4e3700(0x5d2)) { const _0x39abfd = _0x2ccba1[_0x4e3700(0x57f)](_0x2f6165); _0x3080b5[_0x4e3700(0x75c)](_0x39abfd) && (_0x44ef03[_0x4e3700(0xa35)] = _0x39abfd[_0x4e3700(0x7c6)](_0xdb21a0 => _0xdb21a0[_0x4e3700(0x499)] + '--' + _0xdb21a0[_0x4e3700(0xb77)])[_0x4e3700(0x6cf)]('\x0a')); } else _0x492d42[_0x4e3700(0x51c)]['remove']('active'), _0x32b0c3[_0x4e3700(0x51c)]['add'](_0x4e3700(0x8e0)), _0x2bb688(); }); function _0x1e8db5() { const _0x243dab = _0x234a7d; _0x32b0c3[_0x243dab(0x51c)][_0x243dab(0x2e4)](_0x243dab(0x8e0)), _0x492d42[_0x243dab(0x51c)][_0x243dab(0x6dd)](_0x243dab(0x8e0)), _0x2378a3(); } function _0x2378a3() { const _0x16d370 = _0x234a7d, _0x3a6492 = document['getElementById'](_0x16d370(0x8bd)); document[_0x16d370(0x8f3)](_0x16d370(0xb74))[_0x16d370(0x1cd)] = '记一笔', document[_0x16d370(0x8f3)](_0x16d370(0xaa0))['innerHTML'] = '', _0x3a6492['innerHTML'] = _0x16d370(0x5af), _0x309f3f(), document[_0x16d370(0x8f3)]('add-expense-button')[_0x16d370(0x85f)](_0x16d370(0xbba), _0x3cca0d), document['getElementById'](_0x16d370(0x7e0))[_0x16d370(0x85f)](_0x16d370(0xbba), _0x1dc5a2 => { const _0x22bed8 = _0x16d370; if (_0x1dc5a2[_0x22bed8(0x48e)][_0x22bed8(0x51c)][_0x22bed8(0x56f)](_0x22bed8(0xaab))) { const _0x3e7cc7 = _0x1dc5a2['target'][_0x22bed8(0xb40)]['id']; _0x2244b3('确定要删除这笔记录吗？')[_0x22bed8(0xad3)](_0x2a3dc5 => { const _0x1fc720 = _0x22bed8; _0x2a3dc5 && ('Bppjs' !== _0x1fc720(0x566) ? _0x25336e(_0x3e7cc7) : _0x383509['value'] = _0x374814[_0x1fc720(0x7c6)](_0x441864 => _0x441864[_0x1fc720(0x499)] + '--' + _0x441864[_0x1fc720(0xb77)])[_0x1fc720(0x6cf)]('\x0a')); }); } }), document['getElementById'](_0x16d370(0x905))[_0x16d370(0x2e0)](); } function _0x1f334a(_0x56eaaa, _0x2ad1ff) { const _0x2164e1 = _0x234a7d, _0x5c3c68 = document[_0x2164e1(0x8f3)](_0x2164e1(0x8bd)), _0x3e436a = document[_0x2164e1(0x8f3)]('header-actions'); document[_0x2164e1(0x8f3)](_0x2164e1(0xb74))[_0x2164e1(0x1cd)] = _0x2ad1ff + '\x20账单'; const _0x31995c = _0x56eaaa[_0x2164e1(0x516)][_0x2164e1(0x5dd)]((_0x36d56e, _0x46b4b7) => _0x36d56e + (_0x46b4b7['amount'] || 0x0), 0x0); let _0x15e07b = '<div\x20style=\x22background:\x20var(--card-bg);\x20padding:\x2020px;\x20border-radius:\x2012px;\x20text-align:\x20center;\x20border:\x201px\x20solid\x20var(--border-color);\x22><span\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x22>今日总支出\x20(元)</span><div\x20style=\x22font-size:\x202.5rem;\x20font-weight:\x20bold;\x20margin-top:\x205px;\x22>' + _0x31995c[_0x2164e1(0xaeb)](0x2) + _0x2164e1(0xa75); _0x5c3c68[_0x2164e1(0x82c)] = _0x15e07b; const _0x542276 = document[_0x2164e1(0x8f3)]('categorized-expenses-list'), _0x27111e = { '餐饮美食': _0x2164e1(0x72a), '交通出行': _0x2164e1(0x84c), '购物消费': _0x2164e1(0xa8d), '生活服务': _0x2164e1(0x950), '休闲娱乐': _0x2164e1(0x6e9), '医疗健康': _0x2164e1(0xa21), '人情红包': _0x2164e1(0x382), '其他杂项': _0x2164e1(0x436), '默认': _0x2164e1(0x226) }; _0x56eaaa[_0x2164e1(0x516)]['forEach'](_0x312ac3 => { const _0x183b15 = _0x2164e1, _0x53bc25 = document[_0x183b15(0xb35)](_0x183b15(0x4e8)); _0x53bc25[_0x183b15(0xaff)] = _0x183b15(0x2a8), _0x53bc25[_0x183b15(0x3e0)][_0x183b15(0x345)] = _0x183b15(0xa4c), _0x53bc25['style'][_0x183b15(0x5be)] = _0x183b15(0x5d4), _0x53bc25[_0x183b15(0x3e0)]['padding'] = _0x183b15(0x66f), _0x53bc25[_0x183b15(0x3e0)][_0x183b15(0x5b9)] = '0'; const _0x1a3954 = _0x27111e[_0x312ac3[_0x183b15(0x1cb)]] || _0x27111e['默认'], _0x143546 = _0x183b15(0x833) + _0x1a3954 + _0x183b15(0xaee), _0x4fbe18 = _0x183b15(0x98c) + _0x143546 + '</span><div><div\x20class=\x22description\x22>' + _0x312ac3[_0x183b15(0x7ab)] + '</div><div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x22>' + (_0x312ac3[_0x183b15(0x1cb)] || '未分类') + _0x183b15(0x40d) + (_0x312ac3[_0x183b15(0x22e)] || 0x0)[_0x183b15(0xaeb)](0x2) + _0x183b15(0x4ac); let _0x51846b = ''; if (_0x312ac3[_0x183b15(0x7ca)] && _0x312ac3[_0x183b15(0x7ca)][_0x183b15(0x59a)]) { if (_0x183b15(0x1b1) === _0x183b15(0x1b1)) { const _0x3b059f = _0x11feaf(_0x312ac3[_0x183b15(0x7ca)]['charId']); if (_0x3b059f) { if (_0x183b15(0x2e7) === _0x183b15(0x3b9)) { const _0x5c751f = _0x3b15ca[_0x183b15(0x586)](); if (_0x200d0b[_0x183b15(0x342)](_0x850f61 => _0x5c751f[_0x183b15(0x3df)](_0x850f61))) { const _0x56cde6 = _0x312720[_0x38f22c]; if (typeof _0x56cde6 === _0x183b15(0xa98)) _0x134dc6[_0x183b15(0x8d9)](_0x56cde6); if (_0x2a5086[_0x183b15(0x75c)](_0x56cde6)) _0x56cde6[_0x183b15(0x201)](_0x2264ef => { const _0xe303ba = _0x183b15; if (typeof _0x2264ef === _0xe303ba(0xa98)) _0x3afa4d['push'](_0x2264ef); }); } } else _0x51846b = _0x183b15(0x4c8) + _0x3b059f[_0x183b15(0x41d)] + _0x183b15(0x85e) + _0x3b059f[_0x183b15(0x499)] + '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>' + _0x312ac3[_0x183b15(0x7ca)]['text'] + _0x183b15(0x88d); } } else { _0x23d4d9[_0x183b15(0x82c)] = _0x183b15(0x306); return; } } _0x53bc25[_0x183b15(0x82c)] = _0x4fbe18 + _0x51846b, _0x542276[_0x183b15(0x3bf)](_0x53bc25); }), _0x3e436a[_0x2164e1(0x82c)] = _0x2164e1(0x8fa), document[_0x2164e1(0x8f3)](_0x2164e1(0x653))[_0x2164e1(0x85f)]('click', async () => { const _0x4b1491 = _0x2164e1; if ('NqTzt' !== 'xZrgT') { const _0x1e773a = await _0x2244b3(_0x4b1491(0x883)); if (_0x1e773a) { const _0x500ff2 = _0x2de116['accountingLedger'][_0x2ad1ff]; _0x500ff2 && _0x500ff2[_0x4b1491(0x8bf)] && (_0x4b1491(0x44d) === _0x4b1491(0x9f7) ? (_0x291665(), _0x516f09(_0x4b1491(0x640), _0x4b1491(0x8be))) : _0x2de116[_0x4b1491(0x669)][_0x4b1491(0x8d9)](..._0x500ff2[_0x4b1491(0x8bf)])), delete _0x2de116[_0x4b1491(0x8f5)][_0x2ad1ff], _0x2ca195(), _0x2378a3(); } } else _0x74518e[_0x4b1491(0x51c)][_0x4b1491(0x2e4)](_0x4b1491(0x8e0)), _0x147f2d['classList']['add'](_0x4b1491(0x8e0)), _0x1035e3(_0x4e4581, _0x3bb011); }); } function _0x2bb688() { const _0x1dc832 = _0x234a7d, _0x47edea = document[_0x1dc832(0x8f3)](_0x1dc832(0x8bd)); document[_0x1dc832(0x8f3)](_0x1dc832(0xb74))[_0x1dc832(0x1cd)] = '账本', document[_0x1dc832(0x8f3)](_0x1dc832(0xaa0))[_0x1dc832(0x82c)] = ''; const _0x39e559 = Object[_0x1dc832(0xa8f)](_0x2de116[_0x1dc832(0x8f5)])[_0x1dc832(0xb71)]((_0x246957, _0x265b1b) => new Date(_0x265b1b) - new Date(_0x246957)); if (_0x39e559[_0x1dc832(0xaa7)] === 0x0) { if (_0x1dc832(0x564) === _0x1dc832(0xa1a)) { const _0x5f4827 = _0x4ffdcb['transaction'](_0x30625b, _0x1dc832(0xae4)), _0x92732b = _0x5f4827[_0x1dc832(0x387)](_0x1384cf), _0x18ab82 = _0x92732b[_0x1dc832(0xb30)]({ 'id': _0x449db4, 'data': _0xd1559e }); _0x18ab82['onsuccess'] = () => _0xa11141(), _0x18ab82['onerror'] = () => _0x48bda2(_0x18ab82['error']); } else { _0x47edea[_0x1dc832(0x82c)] = _0x1dc832(0x1ee); return; } } _0x47edea[_0x1dc832(0x82c)] = '', _0x39e559[_0x1dc832(0x201)](_0x45adad => { const _0x474b7f = _0x1dc832; if (_0x474b7f(0x675) !== _0x474b7f(0x981)) { const _0x1590ba = document[_0x474b7f(0xb35)]('div'); _0x1590ba['className'] = _0x474b7f(0x2a8), _0x1590ba[_0x474b7f(0x3e0)][_0x474b7f(0x835)] = _0x474b7f(0xac9); const _0x3b0632 = _0x2de116['accountingLedger'][_0x45adad], _0x5b4720 = _0x3b0632['categorizedExpenses'][_0x474b7f(0x5dd)]((_0x310c71, _0x51af06) => _0x310c71 + (_0x51af06[_0x474b7f(0x22e)] || 0x0), 0x0); _0x1590ba[_0x474b7f(0x82c)] = _0x474b7f(0x2ad) + _0x45adad + '</span><span\x20class=\x22amount\x22>总计:\x20' + _0x5b4720[_0x474b7f(0xaeb)](0x2) + _0x474b7f(0x3ae), _0x1590ba[_0x474b7f(0x85f)](_0x474b7f(0xbba), () => { const _0x291176 = _0x474b7f; 'iopYs' === _0x291176(0xa53) ? _0x14e5b7[_0x291176(0x27b)](_0x291176(0x8b6), _0x429c8e) : (_0x492d42[_0x291176(0x51c)][_0x291176(0x2e4)](_0x291176(0x8e0)), _0x32b0c3[_0x291176(0x51c)][_0x291176(0x6dd)]('active'), _0x1f334a(_0x3b0632, _0x45adad)); }), _0x47edea[_0x474b7f(0x3bf)](_0x1590ba); } else { const _0x1174a4 = _0x4dbb2c(_0x45f410['participantIds'][0x0]); _0x3e43b0[_0x474b7f(0x1cd)] = _0x1174a4 ? _0x1174a4[_0x474b7f(0x499)] : '未知角色'; } }); } function _0x3cca0d() { const _0x4c5e17 = _0x234a7d, _0x1985c5 = document['getElementById'](_0x4c5e17(0x905)), _0x27a56b = document[_0x4c5e17(0x8f3)](_0x4c5e17(0x9af)), _0x36f126 = _0x1985c5[_0x4c5e17(0xa35)][_0x4c5e17(0x44c)](), _0x35e4a8 = parseFloat(_0x27a56b[_0x4c5e17(0xa35)]); if (!_0x36f126 || isNaN(_0x35e4a8) || _0x35e4a8 <= 0x0) { _0x15e83d(_0x4c5e17(0xa0d)); return; } _0x2de116[_0x4c5e17(0x669)]['push']({ 'id': _0x4c5e17(0x3a2) + Date[_0x4c5e17(0x83b)](), 'description': _0x36f126, 'amount': _0x35e4a8, 'timestamp': Date['now']() }), _0x2ca195(), _0x309f3f(), _0x1985c5['value'] = '', _0x27a56b['value'] = '', _0x1985c5[_0x4c5e17(0x2e0)](); } function _0x25336e(_0x35256f) { const _0x3111ae = _0x234a7d; if (_0x3111ae(0x597) !== _0x3111ae(0x3c9)) { const _0xe83489 = _0x2de116[_0x3111ae(0x669)][_0x3111ae(0x1c5)](_0x1e8ffa => _0x1e8ffa['id'] === _0x35256f); _0xe83489 > -0x1 && (_0x3111ae(0x4ad) !== _0x3111ae(0x824) ? (_0x2de116['accountingData'][_0x3111ae(0x707)](_0xe83489, 0x1), _0x2ca195(), _0x309f3f()) : _0x20f145 += '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a'); } else _0x58e4e9['src'] = _0x51acfd[_0x3111ae(0x64d)](_0x5a5a40), _0x436d67[_0x3111ae(0x3e0)]['display'] = 'block', _0x7b65d5[_0x3111ae(0x3e0)][_0x3111ae(0x249)] = _0x3111ae(0x1bf), _0x184362[_0x3111ae(0x3e0)][_0x3111ae(0x2ab)] = _0x3111ae(0x299); } function _0x309f3f() { const _0x7b4bd = _0x234a7d, _0x253546 = document[_0x7b4bd(0x8f3)]('daily-expenses-list'), _0x5b5baa = document[_0x7b4bd(0x8f3)](_0x7b4bd(0x51d)), _0x58d13c = new Date(), _0x36f472 = _0x2de116[_0x7b4bd(0x669)][_0x7b4bd(0x3cf)](_0x424517 => new Date(_0x424517[_0x7b4bd(0xa71)])[_0x7b4bd(0x5bc)]() === _0x58d13c['toDateString']()); if (_0x36f472[_0x7b4bd(0xaa7)] === 0x0) { if (_0x7b4bd(0xa4d) === _0x7b4bd(0xa4d)) { _0x253546[_0x7b4bd(0x82c)] = _0x7b4bd(0x765), _0x5b5baa[_0x7b4bd(0x82c)] = ''; return; } else { const _0x34ca31 = _0xd81801[_0x7b4bd(0xac8)](_0x7b4bd(0x52d) + _0x44d6c4 + '\x20.app-icon-img,\x20#app-dock-top-right\x20#' + _0x17c854 + _0x7b4bd(0x523))?.[_0x7b4bd(0x82c)]; _0x34ca31 && (_0x225bca['innerHTML'] = _0x34ca31); } } _0x253546[_0x7b4bd(0x82c)] = '', _0x36f472['sort']((_0x3f4774, _0x194383) => _0x194383[_0x7b4bd(0xa71)] - _0x3f4774[_0x7b4bd(0xa71)])[_0x7b4bd(0x201)](_0x3c9c0d => { const _0x3ba78c = _0x7b4bd; if (_0x3ba78c(0x789) === _0x3ba78c(0x4c7)) _0x45eb57[_0x3ba78c(0x696)](), _0x27d6b7['clipboard'][_0x3ba78c(0x979)](_0x4d5775['value'])[_0x3ba78c(0xad3)](() => { const _0x5452af = _0x3ba78c; _0x4bceec(_0x5452af(0x429)); })[_0x3ba78c(0xa2a)](_0x3b0dfd => { const _0x1ea429 = _0x3ba78c; _0x5e4fb2(_0x1ea429(0x482)); }); else { const _0x443f0e = document[_0x3ba78c(0xb35)](_0x3ba78c(0x4e8)); _0x443f0e[_0x3ba78c(0xaff)] = _0x3ba78c(0x2a8), _0x443f0e['innerHTML'] = '<span\x20class=\x22description\x22>' + _0x3c9c0d[_0x3ba78c(0x7ab)] + _0x3ba78c(0x91b) + _0x3c9c0d[_0x3ba78c(0x22e)][_0x3ba78c(0xaeb)](0x2) + _0x3ba78c(0x9e1) + _0x3c9c0d['id'] + _0x3ba78c(0xb6a), _0x253546['appendChild'](_0x443f0e); } }), _0x5b5baa && (_0x5b5baa[_0x7b4bd(0x82c)] = _0x7b4bd(0x3b7), document[_0x7b4bd(0x8f3)](_0x7b4bd(0x6c9))[_0x7b4bd(0x85f)](_0x7b4bd(0xbba), _0x20abbe)); } async function _0x20abbe() { const _0x365230 = _0x234a7d; if (_0x365230(0xb5c) === _0x365230(0x5df)) _0x35a5a7[_0x365230(0x3e0)]['backgroundImage'] = _0x365230(0x4c6) + _0x399426 + '\x27)'; else { const _0x1ff06e = new Date(), _0x1424a6 = _0x1ff06e['getFullYear']() + '-' + String(_0x1ff06e[_0x365230(0xbbb)]() + 0x1)[_0x365230(0x6f9)](0x2, '0') + '-' + String(_0x1ff06e[_0x365230(0x6b8)]())[_0x365230(0x6f9)](0x2, '0'); if (_0x2de116[_0x365230(0x8f5)][_0x1424a6]) { _0x15e83d(_0x365230(0x8cc)); return; } const _0x20c1fe = _0x2de116[_0x365230(0x669)][_0x365230(0x3cf)](_0x2e6cb8 => new Date(_0x2e6cb8['timestamp'])[_0x365230(0x5bc)]() === _0x1ff06e[_0x365230(0x5bc)]()); if (_0x20c1fe[_0x365230(0xaa7)] === 0x0) { _0x15e83d('今天一笔账都没有，我整理什么？'); return; } _0xc9067c(!![], _0x365230(0x807)); try { const _0x114124 = [_0x365230(0x77f), '交通出行', _0x365230(0xa10), '生活服务', '休闲娱乐', _0x365230(0x39a), _0x365230(0x4b3), _0x365230(0x810)], _0x233f3e = _0x20c1fe['map'](_0x4c9f1a => '-\x20' + _0x4c9f1a[_0x365230(0x7ab)] + ':\x20' + _0x4c9f1a[_0x365230(0x22e)])['join']('\x0a'), _0x20bde5 = _0x2de116[_0x365230(0x393)]['map'](_0x32e4fc => { const _0x22998a = _0x365230, _0x136454 = _0x2de116['chats'][_0x22998a(0xa68)](_0x2988b3 => _0x2988b3['type'] === 'private' && _0x2988b3[_0x22998a(0x6a3)][_0x22998a(0x8db)](_0x32e4fc['id'])), _0x35de9a = _0x2de116[_0x22998a(0x613)][_0x22998a(0xa68)](_0x493562 => _0x493562['id'] === (_0x136454?.[_0x22998a(0x38d)] || _0x2de116[_0x22998a(0xabe)])) || { 'id': 'default', 'name': '你' }; let _0x119105 = ''; return _0x32e4fc[_0x22998a(0xae1)] && _0x32e4fc['linkedWorldBookIds']['length'] > 0x0 && (_0x119105 = _0x32e4fc[_0x22998a(0xae1)][_0x22998a(0x7c6)](_0x2e172b => _0x2de116[_0x22998a(0x432)][_0x22998a(0xa68)](_0x5b8c34 => _0x5b8c34['id'] === _0x2e172b))[_0x22998a(0x3cf)](Boolean)[_0x22998a(0x7c6)](_0x2aaa1a => _0x22998a(0x5e1) + _0x2aaa1a[_0x22998a(0x499)] + _0x22998a(0xac1) + _0x2aaa1a[_0x22998a(0x5e2)])[_0x22998a(0x6cf)]('')), '\x20\x20-\x20角色ID:\x20' + _0x32e4fc['id'] + _0x22998a(0x8a8) + _0x32e4fc['name'] + _0x22998a(0x27c) + _0x32e4fc[_0x22998a(0x44a)] + '\x0a\x20\x20\x20\x20绑定用户:\x20' + _0x35de9a[_0x22998a(0x499)] + '\x20(ID:\x20' + _0x35de9a['id'] + ')\x0a' + _0x119105; })[_0x365230(0x6cf)]('\x0a'), _0xd9c986 = _0x2de116[_0x365230(0x613)][_0x365230(0x7c6)](_0x1acd2 => _0x365230(0x36e) + _0x1acd2['id'] + _0x365230(0x8a8) + _0x1acd2[_0x365230(0x499)] + '\x0a\x20\x20\x20\x20人设:\x20' + (_0x1acd2['persona'] || '无'))[_0x365230(0x6cf)]('\x0a'), _0x579a46 = '#\x20核心任务:\x20财务分析与多角色吐槽\x20(单次请求完成)\x0a你是一个高级AI，需要一次性完成对用户消费流水的分类，并为每一笔消费生成一个符合角色人设的吐槽。\x0a\x0a#\x20规则\x0a1.\x20\x20**逐条处理**:\x20你必须处理我提供的【所有】消费记录。\x0a2.\x20\x20**精准分类**:\x20为每条记录从【固定分类列表】中选择一个最合适的分类。\x0a3.\x20\x20**人格切换吐槽**:\x20为每一条记录，你必须从【角色资料库】中【随机选择一位】，然后【严格代入】该角色的人设，并【假定】这笔消费是该角色【绑定的用户】所为，然后写一句简短吐槽。\x0a4.\x20\x20**JSON输出**:\x20你的输出**必须**是一个完整的、语法正确的JSON数组。每个对象代表一笔消费，且必须包含\x20\x22description\x22,\x20\x22amount\x22,\x20\x22category\x22,\x20和一个\x20\x22review\x22\x20对象。\x0a\x0a#\x20输出格式示例\x0a```json\x0a[{\x22description\x22:\x20\x22乌龟\x22,\x22amount\x22:\x205.00,\x22category\x22:\x20\x22购物消费\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512586032\x22,\x22text\x22:\x20\x22又买这些没用的东西，哼。\x22}},{\x22description\x22:\x20\x22奶茶\x22,\x22amount\x22:\x2012.00,\x22category\x22:\x20\x22餐饮美食\x22,\x22review\x22:\x20{\x22charId\x22:\x20\x22char_1720512604818\x22,\x22text\x22:\x20\x22偶尔喝一杯放松一下也不错。\x22}}]```\x0a#\x20最终指令\x0a请严格按照以上规则，分析流水，并返回JSON数组。直接从\x20`[`\x20开始输出。', _0x3ef01d = _0x365230(0x82a) + _0x114124[_0x365230(0x6cf)](',\x20') + ']\x0a\x0a#\x20角色资料库\x0a' + _0x20bde5 + '\x0a\x0a#\x20用户资料库\x0a' + _0xd9c986 + _0x365230(0x305) + _0x233f3e, _0x10e1a9 = [{ 'role': 'system', 'content': _0x579a46 }, { 'role': 'user', 'content': _0x3ef01d }], _0x14d981 = await _0x4df70c(_0x10e1a9, { 'json': !![] }), _0x1f3147 = _0x5e2917(_0x14d981); if (!_0x1f3147) { if ('voQGy' === _0x365230(0x9c6)) { if (!_0x4134fc || !_0x362d6b[_0x365230(0xb7c)]) return; const _0x5d0482 = { 'role': _0x365230(0x7da), 'content': '[用户发送了表情：' + _0x3d0988[_0x365230(0x499)] + ']', 'displayUrl': _0x599deb['url'], 'timestamp': _0x5abd5f[_0x365230(0x83b)]() }; _0x5660ad[_0x365230(0x59f)][_0x365230(0x8d9)](_0x5d0482), _0x28d387(_0x5d0482, _0xc0679d['conversationHistory'][_0x365230(0xaa7)] - 0x1), _0x315739(), _0x18a215[_0x365230(0x51c)][_0x365230(0x2e4)](_0x365230(0x530)); } else throw new Error('AI返回的内容里找不到有效的JSON数组。原始回复:\x20' + _0x14d981); } const _0x1e349d = JSON[_0x365230(0x57f)](_0x1f3147); _0x2de116['accountingLedger'][_0x1424a6] = { 'categorizedExpenses': _0x1e349d, 'timestamp': Date[_0x365230(0x83b)](), 'originalExpenses': _0x20c1fe }, _0x2de116[_0x365230(0x669)] = _0x2de116['accountingData'][_0x365230(0x3cf)](_0x434dff => new Date(_0x434dff[_0x365230(0xa71)])['toDateString']() !== _0x1ff06e['toDateString']()), _0x2ca195(), _0x1f334a(_0x2de116[_0x365230(0x8f5)][_0x1424a6], _0x1424a6); } catch (_0x370017) { _0x15e83d('AI整理失败了，哼:\x20' + _0x370017[_0x365230(0x722)]); } finally { _0xc9067c(![]); } } } async function _0x3d529e() { const _0xef8099 = _0x234a7d, _0x8466da = [..._0x2bfce2]; try { if (_0xef8099(0x2c9) === 'VESoT') _0x49fcc8(_0xef8099(0xbb1) + _0x23c61c[_0xef8099(0x722)]); else { const _0xc16534 = localStorage[_0xef8099(0x54d)](_0xef8099(0x804)); if (_0xc16534) { const _0x528c50 = JSON[_0xef8099(0x57f)](_0xc16534); if (Array['isArray'](_0x528c50)) { if (_0xef8099(0x5e3) !== 'cVbcu') { if (_0x35cd45[_0xef8099(0x9e8)] === _0xef8099(0x7da) && _0x363ace[_0xef8099(0x6a9)]) return { 'role': _0xef8099(0x7da), 'content': [{ 'type': 'text', 'text': _0x626a01[_0xef8099(0x5e2)] || '\x20' }, { 'type': 'image_url', 'image_url': { 'url': _0x273960[_0xef8099(0x6a9)], 'detail': _0xef8099(0x202) } }] }; return { 'role': _0x447a4a['role'], 'content': _0x19058[_0xef8099(0x5e2)] }; } else _0x3bedf0 = [..._0x8466da, ..._0x528c50]; } else _0x3bedf0 = _0x8466da; } else _0x3bedf0 = _0x8466da; } } catch (_0x48d87e) { console['error']('加载自定义表情包失败，真是没用。', _0x48d87e), _0x3bedf0 = _0x8466da; } if (!localStorage[_0xef8099(0x54d)](_0xef8099(0x569))) { _0x2244b3(_0xef8099(0x2ef))[_0xef8099(0xad3)](async _0x43b7ea => { const _0x38c69f = _0xef8099; if (_0x43b7ea) _0x38c69f(0xb67) === _0x38c69f(0x7fd) ? (_0x5eef0a[_0x38c69f(0x27b)](_0x38c69f(0x6b1), _0x42b633), _0x27c0a4(_0x38c69f(0x4d1))) : (_0xc9067c(!![], '正在升级聊天数据结构...'), await _0x58784a(), localStorage[_0x38c69f(0x23c)]('noir_data_migration_v1_complete', _0x38c69f(0x854)), _0xc9067c(![]), _0x15e83d(_0x38c69f(0x92c)), setTimeout(() => location['reload'](), 0x5dc)); else { if (_0x38c69f(0x469) !== 'xTwLl') { const _0xd2e79b = _0x55de82['round']((_0x11c903 - _0x3ea70a) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x47106e += '-\x20**状态提示**:\x20你已经有\x20' + _0xd2e79b + _0x38c69f(0x796); } else _0x15e83d('升级已取消。旧版图片数据可能导致应用卡顿或出错。'); } }); return; } if (!localStorage['getItem']('noir_migration_fc_v1_complete')) { if (_0xef8099(0x5fd) !== _0xef8099(0x582)) { console[_0xef8099(0x754)](_0xef8099(0x782)), _0xc9067c(!![], '正在检查好友圈数据...'); const _0x52e326 = await _0x9ab177(); localStorage['setItem'](_0xef8099(0x80c), _0xef8099(0x854)), _0xc9067c(![]); if (_0x52e326 > 0x0) { _0x15e83d('好友圈数据升级完成，迁移了\x20' + _0x52e326 + _0xef8099(0x442)), setTimeout(() => location['reload'](), 0x5dc); return; } } else { if (!_0x4b9240 || typeof _0x1c0837 !== _0xef8099(0xa98)) return null; const _0x173bec = _0x2b879e[_0xef8099(0x8ca)]('['), _0x28edb7 = _0x15ed6c[_0xef8099(0xb94)](']'); if (_0x173bec > -0x1 && _0x28edb7 > _0x173bec) return _0x35505f[_0xef8099(0x8c6)](_0x173bec, _0x28edb7 + 0x1); return null; } } if (!localStorage['getItem'](_0xef8099(0x80c))) { } if (!localStorage[_0xef8099(0x54d)](_0xef8099(0x703))) { console[_0xef8099(0x754)](_0xef8099(0xbad)), _0xc9067c(!![], '正在升级音乐卡片数据...'); const _0x27494d = await _0x256b6a(); localStorage[_0xef8099(0x23c)](_0xef8099(0x703), _0xef8099(0x854)), _0xc9067c(![]); if (_0x27494d > 0x0) { _0x15e83d(_0xef8099(0xac7) + _0x27494d + _0xef8099(0xb51)), setTimeout(() => location[_0xef8099(0x860)](), 0x5dc); return; } } const _0x2161a8 = document[_0xef8099(0x8f3)](_0xef8099(0x81c)); _0x2161a8[_0xef8099(0x85f)](_0xef8099(0xbba), () => { const _0x27acdc = _0xef8099; _0x34523c(), _0x2faf14(_0x27acdc(0x73d), _0x27acdc(0x4ab)); }); const _0x56c0d5 = _0x4bc738(); try { const _0x2d055e = localStorage[_0xef8099(0x54d)](_0xef8099(0x9bb)); if (_0x2d055e) { const _0x1ff474 = JSON[_0xef8099(0x57f)](_0x2d055e); _0x1ff474['accountingLedger'] && (_0x2de116[_0xef8099(0x8f5)] = _0x1ff474[_0xef8099(0x8f5)], console[_0xef8099(0x754)]('Noir\x27s\x20Temporal\x20Patch:\x20Ledger\x20re-synchronized.')); } } catch (_0x3389da) { console[_0xef8099(0x27b)]('Noir\x27s\x20Temporal\x20Patch\x20failed:', _0x3389da); } _0x52d501(), _0x2e664e(), _0x3f3766(), _0x51f437(), _0xbebd6a(), _0x21061c(), _0x7a1fe9(), _0x4c0ea1(), _0x45094e(), _0x58fef2(), _0x3bbf75(), _0x571235(), _0x1de543(), setInterval(_0x1de543, 0x7530), _0x4a0ae5(), _0x25e174(), _0x469029(); const _0x11cfaf = document[_0xef8099(0x8f3)](_0xef8099(0x22f)); document[_0xef8099(0x8f3)]('music-widget-card')[_0xef8099(0x85f)](_0xef8099(0xbba), function (_0x57fbd8) { const _0x4b8f5c = _0xef8099; if (_0x57fbd8['target']['closest'](_0x4b8f5c(0x517))) { if ('XTxdJ' === _0x4b8f5c(0x6e2)) return; else _0x5d1e73 = _0x417f87[_0x4b8f5c(0x269)](_0x3612cc); } const _0x4c33ed = document[_0x4b8f5c(0x8f3)]('widget-play-pause-btn'); _0x4c33ed && _0x4c33ed['click'](); }), _0x2faf14(_0xef8099(0x4ab), _0xef8099(0x3a3)); (_0x56c0d5 || _0x2de116[_0xef8099(0x393)][_0xef8099(0xaa7)] === 0x0) && (_0x15e83d(_0xef8099(0x232)), setTimeout(() => { const _0x42b05e = _0xef8099; _0x2faf14(_0x42b05e(0x780), _0x42b05e(0x4ab)), setTimeout(() => _0x49b7c5(), 0x64); }, 0x6a4)); document[_0xef8099(0x8f3)](_0xef8099(0xacc))['addEventListener'](_0xef8099(0xbba), _0x56a14d); const _0xd3bf55 = document[_0xef8099(0x8f3)](_0xef8099(0x5c5)); document['getElementById'](_0xef8099(0x2e6))['addEventListener'](_0xef8099(0xbba), () => _0xd3bf55[_0xef8099(0xbba)]()), document[_0xef8099(0x8f3)](_0xef8099(0xa41))[_0xef8099(0x85f)](_0xef8099(0xbba), () => { const _0xfb5b7c = _0xef8099; _0x2de116[_0xfb5b7c(0x9d6)][_0xfb5b7c(0x56d)] = null, _0x2ca195(), _0x4a0ae5(), _0x15e83d(_0xfb5b7c(0x2d9)); }), _0xd3bf55['addEventListener'](_0xef8099(0x69c), async _0x344394 => { const _0x1188b2 = _0xef8099, _0x36b353 = _0x344394[_0x1188b2(0x48e)]['files'][0x0]; if (!_0x36b353) return; try { const _0x378b6a = await _0x55a8db(_0x36b353); _0x2de116[_0x1188b2(0x9d6)]['widgetBgImage'] = _0x378b6a, _0x2ca195(), _0x4a0ae5(), _0x15e83d('小组件背景已更换！'); } catch (_0x93df5a) { _0x15e83d('错误:\x20' + _0x93df5a['message']); } }), _0x2054b4(), document[_0xef8099(0x8f3)]('upload-badge-button')[_0xef8099(0x85f)]('click', () => document['getElementById'](_0xef8099(0x579))[_0xef8099(0xbba)]()), document[_0xef8099(0x8f3)]('reset-badge-button')[_0xef8099(0x85f)]('click', async () => { const _0x49b78a = _0xef8099; await _0x44b919(_0x49b78a(0x1cf)), localStorage[_0x49b78a(0x758)](_0x49b78a(0x316)), _0x2054b4(), _0x15e83d('徽章已移除。'); }), document['getElementById'](_0xef8099(0x579))[_0xef8099(0x85f)](_0xef8099(0x69c), async _0x514f29 => { const _0x4548d5 = _0xef8099; if (_0x4548d5(0x562) === _0x4548d5(0x855)) { _0x2e6283[_0x4548d5(0xa35)] = '#\x20记录是空的，没什么好总结的。'; return; } else { const _0x391b0c = _0x514f29[_0x4548d5(0x48e)]['files'][0x0]; if (!_0x391b0c) return; try { _0x4548d5(0x997) !== _0x4548d5(0x997) ? _0x11a1b3(_0x4548d5(0xa33)) : (await _0x1d2a3c(_0x4548d5(0x1cf), _0x391b0c), await _0x2054b4(), _0x15e83d(_0x4548d5(0x6d4))); } catch (_0x159203) { if (_0x4548d5(0x75f) === _0x4548d5(0x75f)) _0x15e83d(_0x4548d5(0xbb1) + _0x159203[_0x4548d5(0x722)]); else for (const _0xc80bab in _0x172410) { _0x25e62f[_0x4548d5(0x3e0)][_0xc80bab] = _0x44bb8e[_0xc80bab]; } } } }), _0x1724b5(), document[_0xef8099(0x8f3)]('diary-entries-container')[_0xef8099(0x85f)](_0xef8099(0x2ee), _0x4495b9), document[_0xef8099(0x8f3)](_0xef8099(0x46c))[_0xef8099(0x85f)](_0xef8099(0x534), _0x4495b9, { 'passive': ![] }), document[_0xef8099(0x8f3)]('upload-card-button')['addEventListener'](_0xef8099(0xbba), () => document['getElementById'](_0xef8099(0x894))[_0xef8099(0xbba)]()), document[_0xef8099(0x8f3)]('reset-card-button')['addEventListener'](_0xef8099(0xbba), async () => { const _0x1d70b3 = _0xef8099; await _0x44b919(_0x1d70b3(0x3e9)), localStorage[_0x1d70b3(0x758)](_0x1d70b3(0x40b)), _0x1724b5(), _0x15e83d(_0x1d70b3(0x313)); }), document[_0xef8099(0x8f3)]('card-input')[_0xef8099(0x85f)](_0xef8099(0x69c), async _0x3773a2 => { const _0x423cc4 = _0xef8099; if (_0x423cc4(0x2f4) !== _0x423cc4(0x2f4)) _0x436dfd[_0x423cc4(0xb16)](), _0x4302e3(); else { const _0x1af4eb = _0x3773a2['target'][_0x423cc4(0x6f1)][0x0]; if (!_0x1af4eb) return; try { if (_0x423cc4(0x2d6) !== _0x423cc4(0x2d6)) return _0x34073a[_0x423cc4(0x393)][_0x423cc4(0xa68)](_0x3fe116 => _0x3fe116['id'] === _0x26f718); else await _0x1d2a3c(_0x423cc4(0x3e9), _0x1af4eb), await _0x1724b5(), _0x15e83d(_0x423cc4(0xb81)); } catch (_0x3a8a62) { _0x423cc4(0x852) !== _0x423cc4(0x498) ? _0x15e83d(_0x423cc4(0xbb1) + _0x3a8a62['message']) : _0x48faad += '-\x20**状态提示**:\x20你和Ta上次聊天是在昨天，注意你发言的时间感。\x0a'; } } }), document[_0xef8099(0x8f3)](_0xef8099(0xa79))['addEventListener'](_0xef8099(0xbba), async () => { const _0x2a42ca = _0xef8099; if (_0x2a42ca(0x567) === _0x2a42ca(0x9c5)) { const _0x1a6d41 = _0x4bb8dd[_0x2a42ca(0xb35)](_0x2a42ca(0x885)); _0x1a6d41[_0x2a42ca(0xa35)] = _0x4f4cd5['id'], _0x1a6d41[_0x2a42ca(0x1cd)] = _0x2e3bcf[_0x2a42ca(0x499)], _0x5d45a0[_0x2a42ca(0x3bf)](_0x1a6d41); } else { const _0x1ccae6 = await _0x2244b3(_0x2a42ca(0x317)); _0x1ccae6 && (localStorage['removeItem'](_0x2a42ca(0x316)), localStorage[_0x2a42ca(0x758)](_0x2a42ca(0xa81)), _0x15e83d(_0x2a42ca(0xadc)), setTimeout(() => location[_0x2a42ca(0x860)](), 0x3e8)); } }); const _0x2f87df = document[_0xef8099(0x8f3)](_0xef8099(0xa17)); _0x2f87df[_0xef8099(0x85f)](_0xef8099(0xbba), () => { const _0x352e06 = _0xef8099; 'VJAzz' === _0x352e06(0x7ef) ? (_0x17dac3(), _0x2faf14('diaryList', _0x352e06(0x4ab))) : _0x5f32fa['classList'][_0x352e06(0x2e4)]('show'); }); const _0x4241ab = document['getElementById']('app-music-library'); _0x4241ab[_0xef8099(0x85f)](_0xef8099(0xbba), () => { const _0xf51331 = _0xef8099; _0xe7d633(), _0x2faf14(_0xf51331(0x612), _0xf51331(0x4ab)); }), document['getElementById'](_0xef8099(0x3bd))[_0xef8099(0x85f)](_0xef8099(0xbba), () => _0x2faf14(_0xef8099(0x4ab), _0xef8099(0x612))), document[_0xef8099(0x8f3)](_0xef8099(0xb8a))[_0xef8099(0x85f)](_0xef8099(0xbba), () => _0x2faf14(_0xef8099(0x4ab), _0xef8099(0xb80))), document[_0xef8099(0x8f3)](_0xef8099(0xba0))[_0xef8099(0x85f)]('click', () => { const _0x544a97 = _0xef8099; _0x544a97(0x527) !== _0x544a97(0x527) ? (_0x582162['log'](_0x544a97(0x216) + _0x557050), _0x31538d[_0x544a97(0x775)](_0x5bfb21, { 'keyPath': 'id' })) : (_0x2de116[_0x544a97(0xa8b)] = null, _0x2faf14(_0x544a97(0xb80), 'diaryView')); }), document[_0xef8099(0x8f3)]('diary-send-button')[_0xef8099(0x85f)](_0xef8099(0xbba), _0xfc34), document[_0xef8099(0x8f3)](_0xef8099(0x719))[_0xef8099(0x85f)]('click', _0x461698), document[_0xef8099(0x8f3)]('diary-entry-input')['addEventListener'](_0xef8099(0xa0e), _0x41ad2a => { const _0x592b16 = _0xef8099; _0x592b16(0x605) !== _0x592b16(0x1fe) ? _0x41ad2a[_0x592b16(0x64a)] === _0x592b16(0xb56) && !_0x41ad2a[_0x592b16(0x283)] && ('zuHMm' === 'TyPYP' ? _0x3a1695[_0x592b16(0x669)]['push'](..._0x310ccc[_0x592b16(0x8bf)]) : (_0x41ad2a[_0x592b16(0xb16)](), _0xfc34())) : (_0x275c9b(), _0x5e0f51(_0x592b16(0x413), _0x592b16(0xb88))); }); const _0x265a50 = ['normal', _0xef8099(0x629), _0xef8099(0x6ee), _0xef8099(0x4ff), _0xef8099(0x627)]; _0x265a50[_0xef8099(0x201)](_0x1a53da => { const _0xbf528c = _0xef8099, _0x4c35c8 = document['getElementById'](_0xbf528c(0x33f) + _0x1a53da + _0xbf528c(0x314)), _0x2e8d91 = document[_0xbf528c(0x8f3)](_0xbf528c(0x33f) + _0x1a53da + _0xbf528c(0x2f5)); if (_0x4c35c8 && _0x2e8d91) { if (_0xbf528c(0x209) === _0xbf528c(0x209)) _0x4c35c8[_0xbf528c(0x85f)](_0xbf528c(0xbba), () => _0x2e8d91[_0xbf528c(0xbba)]()), _0x2e8d91[_0xbf528c(0x85f)]('change', _0x426588 => { const _0x36d33b = _0xbf528c; if (_0x36d33b(0x2d5) === _0x36d33b(0x2d5)) { const _0x23f852 = _0x426588[_0x36d33b(0x48e)]['files'][0x0]; if (!_0x23f852) return; try { if (_0x36d33b(0xaa6) !== _0x36d33b(0x839)) { const _0x7fdafb = URL[_0x36d33b(0x64d)](_0x23f852); _0x4c35c8['style'][_0x36d33b(0xaa3)] = _0x36d33b(0x4c6) + _0x7fdafb + '\x27)'; } else _0x2bae0d['value'] = _0x4948e7[_0x36d33b(0xb88)][_0x36d33b(0x499)] || '', _0x4536a1[_0x36d33b(0xa9c)] = _0x146eb2[_0x36d33b(0xb88)][_0x36d33b(0x41d)] || _0x5cfe4d, _0x2d7a7c[_0x36d33b(0xa35)] = _0x45ac99['userProfile'][_0x36d33b(0x44a)] || ''; } catch (_0x3d30e9) { _0x36d33b(0x3a7) === 'NevBJ' ? _0x15e83d(_0x36d33b(0x1d7) + _0x3d30e9[_0x36d33b(0x722)]) : (_0x178a88[_0x36d33b(0x432)] = _0x342b88[_0x36d33b(0x432)]['filter'](_0x18dbb7 => _0x18dbb7['id'] !== _0x318304), _0x396034[_0x36d33b(0x393)][_0x36d33b(0x201)](_0x8b00ca => { const _0x30d76c = _0x36d33b; _0x8b00ca[_0x30d76c(0xae1)] && (_0x8b00ca[_0x30d76c(0xae1)] = _0x8b00ca[_0x30d76c(0xae1)]['filter'](_0x4c5e7b => _0x4c5e7b !== _0x130494)); }), _0x517b93(), _0x1a1a69(_0x36d33b(0xa1f)), _0x11a49f(), _0x35aa95(_0x36d33b(0x428), _0x36d33b(0x7a0))); } } else _0x8c3ebe(_0x36d33b(0x881) + _0x2627ed['message'] + _0x36d33b(0x4a0)); }); else { const _0x2b3875 = _0x1c25ff[_0xbf528c(0x500)](/:\s|：\s/); if (_0x2b3875[_0xbf528c(0xaa7)] === 0x2) { const _0x4f7bd2 = _0x2b3875[0x0][_0xbf528c(0x44c)](), _0x401e4b = _0x2b3875[0x1][_0xbf528c(0x44c)](), _0x34fc87 = { '歌名': _0xbf528c(0x8dc), '艺术家': '歌手', '专辑': '专辑' }; _0x34fc87[_0x4f7bd2] && (_0x45b71f[_0x34fc87[_0x4f7bd2]] = _0x401e4b); } } } }), document[_0xef8099(0x8f3)]('galgame-textbox-container')['addEventListener'](_0xef8099(0xbba), _0x348ac8), document[_0xef8099(0x8f3)](_0xef8099(0x396))[_0xef8099(0x85f)](_0xef8099(0xbba), () => { const _0x114f0e = _0xef8099; _0x2de116[_0x114f0e(0x8a9)] = _0x2de116[_0x114f0e(0x8a9)] === _0x114f0e(0x991) ? _0x114f0e(0x452) : _0x114f0e(0x991), _0x48c4bd(); }), document[_0xef8099(0x8f3)](_0xef8099(0x467))[_0xef8099(0x85f)](_0xef8099(0x2ee), _0x42008b), document[_0xef8099(0x8f3)](_0xef8099(0x467))[_0xef8099(0x85f)](_0xef8099(0x534), _0x42008b, { 'passive': ![] }); let _0x39def0 = null; function _0x42008b(_0x1cd2d2) { const _0x26d5a9 = _0xef8099; if (_0x39def0) clearTimeout(_0x39def0); const _0x115a47 = _0x1cd2d2[_0x26d5a9(0x48e)][_0x26d5a9(0x911)](_0x26d5a9(0x870)); if (!_0x115a47) return; const _0xf4941d = parseInt(_0x115a47[_0x26d5a9(0xb40)][_0x26d5a9(0x8a7)], 0xa); if (isNaN(_0xf4941d)) return; const _0x16d957 = () => { _0x39def0 = setTimeout(() => { const _0x2e2942 = _0x4d19; if (_0x1cd2d2[_0x2e2942(0x318)] === _0x2e2942(0x534)) _0x1cd2d2[_0x2e2942(0xb16)](); _0x20d68c(_0xf4941d); }, 0x320); }, _0x3caeb3 = () => { if (_0x39def0) clearTimeout(_0x39def0); }; document[_0x26d5a9(0x85f)]('mouseup', _0x3caeb3, { 'once': !![] }), document[_0x26d5a9(0x85f)](_0x26d5a9(0x225), _0x3caeb3, { 'once': !![] }), document['addEventListener'](_0x26d5a9(0x6f8), _0x3caeb3, { 'once': !![] }), document[_0x26d5a9(0x85f)](_0x26d5a9(0xbb4), _0x3caeb3, { 'once': !![] }), _0x16d957(); } document['body'][_0xef8099(0x85f)](_0xef8099(0xbba), _0x375839 => { const _0x3006b8 = _0xef8099, _0x5cd9cd = _0x375839[_0x3006b8(0x48e)][_0x3006b8(0x911)](_0x3006b8(0x79e)); if (_0x5cd9cd) { const _0x558ed1 = _0x375839[_0x3006b8(0x48e)][_0x3006b8(0x911)](_0x3006b8(0x874)), _0x5eba34 = _0x375839[_0x3006b8(0x48e)][_0x3006b8(0x911)](_0x3006b8(0x90e)); if (_0x558ed1) _0x4ff0cf(); else { if (_0x5eba34) { const _0x3e43e5 = _0x5eba34['closest'](_0x3006b8(0x79f)), _0x510e17 = _0x5eba34[_0x3006b8(0xb40)][_0x3006b8(0xa29)], _0x5d5e01 = parseInt(_0x3e43e5[_0x3006b8(0xb40)][_0x3006b8(0x8a7)], 0xa); _0x521657(_0x510e17, _0x5d5e01, _0x5cd9cd); } else { const _0x419076 = _0x231de4(); _0x419076 && _0x419076['activeListenSession'] && _0x419076['activeListenSession']['isActive'] && (_0x3006b8(0xb59) === _0x3006b8(0xb59) ? (_0x2aadee[_0x3006b8(0x3e0)][_0x3006b8(0xab9)] = _0x3006b8(0x47f), setTimeout(() => _0x2aadee['classList'][_0x3006b8(0x6dd)](_0x3006b8(0x530)), 0xa)) : _0x351516 = _0x466c5e(_0x465935)); } } return; } if (window[_0x3006b8(0x543)]()[_0x3006b8(0x841)]()) return; const _0x25cb7e = _0x375839[_0x3006b8(0x48e)]['closest'](_0x3006b8(0x79f)); if (_0x25cb7e && !_0x375839[_0x3006b8(0x48e)][_0x3006b8(0x911)](_0x3006b8(0xaaa))) { const _0x45b3d4 = parseInt(_0x25cb7e[_0x3006b8(0xb40)][_0x3006b8(0x8a7)], 0xa); !isNaN(_0x45b3d4) && (_0x3006b8(0x614) !== _0x3006b8(0x614) ? _0x2d4cb2[_0x3006b8(0x51c)][_0x3006b8(0x2e4)](_0x3006b8(0x530)) : _0x20d68c(_0x45b3d4)); } }); const _0x402f12 = document[_0xef8099(0x8f3)]('noir-author-mark'); _0x402f12 && _0x402f12[_0xef8099(0x85f)](_0xef8099(0xbba), () => { const _0x421036 = _0xef8099; if (_0x421036(0x591) !== _0x421036(0x42c)) _0x15e83d(_0x421036(0x59d)); else { _0x36eef2[_0x421036(0x8f7)] = [..._0x572b5d], _0xb501b4[_0x421036(0x58f)][_0x4b96e3['id']] = [..._0x3eb8a1], _0x3a0f28(); const _0x3ef5dd = _0xe65409[_0x421036(0x7c6)](_0x357d44 => _0x357d44[_0x421036(0xbbe)] === _0x421036(0x5f8) ? _0x357d44[_0x421036(0x910)] : _0x357d44[_0x421036(0xbbe)] + ':\x20' + _0x357d44[_0x421036(0x910)])['join']('\x0a\x0a'); _0x4be61b[_0x421036(0x59f)][_0x421036(0x8d9)]({ 'role': 'assistant', 'senderId': _0x161cfe['id'], 'timestamp': _0x5b2c93[_0x421036(0x83b)](), 'isOffline': !![], 'content': _0x3ef5dd }); } }); const _0x54d9fc = document[_0xef8099(0x8f3)](_0xef8099(0x4c2)), _0x2614cb = localStorage[_0xef8099(0x54d)](_0xef8099(0x804)); if (_0x2614cb) try { const _0x599679 = JSON[_0xef8099(0x57f)](_0x2614cb); Array[_0xef8099(0x75c)](_0x599679) && (_0x54d9fc[_0xef8099(0xa35)] = _0x599679[_0xef8099(0x7c6)](_0x28090a => _0x28090a['name'] + '--' + _0x28090a[_0xef8099(0xb77)])[_0xef8099(0x6cf)]('\x0a')); } catch (_0x1b4c30) { } document[_0xef8099(0x8f3)]('save-custom-stickers-button')['addEventListener'](_0xef8099(0xbba), () => { const _0x4b353f = _0xef8099, _0x2f6f91 = _0x54d9fc['value'], _0x4be2a0 = _0x2f6f91[_0x4b353f(0x500)]('\x0a')['filter'](_0x460abd => _0x460abd['trim']() !== ''), _0xf71c5b = []; let _0x5c2f92 = 0x0; for (const _0x4ef02c of _0x4be2a0) { const _0x24fc9c = _0x4ef02c['split']('--'); _0x24fc9c[_0x4b353f(0xaa7)] === 0x2 && _0x24fc9c[0x0][_0x4b353f(0x44c)]() && _0x24fc9c[0x1][_0x4b353f(0x44c)]()['startsWith'](_0x4b353f(0x278)) ? _0xf71c5b[_0x4b353f(0x8d9)]({ 'name': _0x24fc9c[0x0][_0x4b353f(0x44c)](), 'url': _0x24fc9c[0x1][_0x4b353f(0x44c)]() }) : _0x4b353f(0x248) !== 'mAMMu' ? (_0x22afde[_0x4b353f(0x758)](_0x4b353f(0xb7a) + _0x330503['id']), _0x1cdccf('群聊\x22' + _0x4d41c9[_0x4b353f(0x499)] + _0x4b353f(0xb8e))) : _0x5c2f92++; } if (_0x5c2f92 > 0x0) { if (_0x4b353f(0xb1a) !== _0x4b353f(0xb64)) _0x15e83d('有\x20' + _0x5c2f92 + '\x20行格式不对，被我无视了。'); else { const _0x250894 = _0x43cacb(_0x1e1f7e[_0x4b353f(0x6a3)][0x0]); return _0x250894?.['name'] || 'AI'; } } try { localStorage[_0x4b353f(0x23c)](_0x4b353f(0x804), JSON['stringify'](_0xf71c5b)), _0x15e83d(_0x4b353f(0x54a)), setTimeout(() => location['reload'](), 0x5dc); } catch (_0x473dea) { _0x15e83d(_0x4b353f(0x97e)); } }), _0x453cab(), document[_0xef8099(0x8f3)]('upload-card-button-2')[_0xef8099(0x85f)](_0xef8099(0xbba), () => { const _0x1a9b4a = _0xef8099; _0x1a9b4a(0x24f) !== 'MJlPj' ? document[_0x1a9b4a(0x8f3)]('card-input-2')[_0x1a9b4a(0xbba)]() : (_0x29cd42['style'][_0x1a9b4a(0x8ae)] = _0xc2e7ca['top'] + '%', _0x566270[_0x1a9b4a(0x3e0)][_0x1a9b4a(0xbb3)] = _0x36e049[_0x1a9b4a(0xbb3)] + '%'); }), document[_0xef8099(0x8f3)](_0xef8099(0x85b))['addEventListener'](_0xef8099(0xbba), async () => { const _0x176f24 = _0xef8099; await _0x44b919(_0x176f24(0x7f0)), localStorage[_0x176f24(0x758)](_0x176f24(0x2c7)), _0x1724b5(), _0x15e83d(_0x176f24(0x2ca)); }), document[_0xef8099(0x8f3)](_0xef8099(0xa1e))[_0xef8099(0x85f)](_0xef8099(0x69c), async _0x3dad0b => { const _0x2c573b = _0xef8099, _0x48f78b = _0x3dad0b['target'][_0x2c573b(0x6f1)][0x0]; if (!_0x48f78b) return; try { await _0x1d2a3c('widget_card_2', _0x48f78b), await _0x1724b5(), _0x15e83d(_0x2c573b(0x795)); } catch (_0x487e18) { _0x15e83d(_0x2c573b(0xbb1) + _0x487e18['message']); } }), _0x37f152(), _0x192d10(), _0x52d60f(); } const _0x3a8a19 = _0x234a7d(0x8e7); async function _0x26c0eb(_0x57a728) { const _0x21a73f = await _0x361ce4; return new Promise((_0x1ac24d, _0x366703) => { const _0x376bb4 = _0x4d19; if (_0x376bb4(0x8af) !== 'dzZlF') _0x47f05d = _0x159ef9['name'], _0x473aaa = _0x49b46b['avatar']; else { const _0x43a5fc = _0x21a73f['transaction'](_0x3a8a19, _0x376bb4(0x72d)), _0x888942 = _0x43a5fc['objectStore'](_0x3a8a19), _0x140c03 = _0x888942['get'](_0x57a728); _0x140c03[_0x376bb4(0x7b4)] = () => _0x1ac24d(_0x140c03[_0x376bb4(0x774)]), _0x140c03[_0x376bb4(0x611)] = () => _0x366703(_0x140c03[_0x376bb4(0x27b)]); } }); } async function _0x38686b() { const _0x4ae2e9 = await _0x361ce4; return new Promise((_0xbe501b, _0x532367) => { const _0x13b4ad = _0x4d19, _0x2e41af = _0x4ae2e9[_0x13b4ad(0x6c0)](_0x3a8a19, _0x13b4ad(0x72d)), _0xe884d6 = _0x2e41af[_0x13b4ad(0x387)](_0x3a8a19), _0x984c94 = _0xe884d6[_0x13b4ad(0x412)](); _0x984c94[_0x13b4ad(0x7b4)] = () => _0xbe501b(_0x984c94[_0x13b4ad(0x774)]), _0x984c94['onerror'] = () => _0x532367(_0x984c94[_0x13b4ad(0x27b)]); }); } async function _0x42bea0(_0x7e946a) { const _0x3ff567 = await _0x361ce4; return new Promise((_0x1a473c, _0x225d83) => { const _0x892d7b = _0x4d19; if (_0x892d7b(0x22b) === _0x892d7b(0x859)) try { const _0x1eb4eb = { 'version': 0x1, 'characters': _0x4afb20['characters'], 'worldBooks': _0x3c67b8[_0x892d7b(0x432)], 'chats': _0xf68da9[_0x892d7b(0x6b7)], 'apiSettings': _0x225168['apiSettings'], 'preferences': _0x51941e[_0x892d7b(0x9d6)], 'activeChatId': _0x1de3a1[_0x892d7b(0xb7c)], 'diaries': _0x22c528['diaries'], 'friendCircles': _0x5e84f1[_0x892d7b(0xa05)], 'activeFriendCircleId': _0x22d771[_0x892d7b(0x42d)], 'userProfiles': _0x3f7848['userProfiles'], 'activeUserProfileId': _0x50f555['activeUserProfileId'], 'accountingData': _0x5bafe3[_0x892d7b(0x669)], 'accountingLedger': _0x16b73a[_0x892d7b(0x8f5)], 'calendarEvents': _0x56d1ea[_0x892d7b(0x207)] }; _0x2519da[_0x892d7b(0x23c)](_0x892d7b(0x9bb), _0xd9a176[_0x892d7b(0x269)](_0x1eb4eb)); } catch (_0x3806e3) { _0x1f7dbc['error'](_0x892d7b(0x8e4), _0x3806e3), _0x3508ac(_0x892d7b(0x2a6)); } else { const _0x3edc6f = _0x3ff567[_0x892d7b(0x6c0)](_0x3a8a19, _0x892d7b(0xae4)), _0x3256fc = _0x3edc6f[_0x892d7b(0x387)](_0x3a8a19), _0x262305 = _0x3256fc[_0x892d7b(0xb30)](_0x7e946a); _0x262305[_0x892d7b(0x7b4)] = () => _0x1a473c(_0x262305[_0x892d7b(0x774)]), _0x262305[_0x892d7b(0x611)] = () => _0x225d83(_0x262305['error']); } }); } async function _0x4ec4a3(_0x4100e0) { const _0x157d00 = await _0x361ce4; return new Promise((_0x2326c3, _0x336312) => { const _0x1b0e02 = _0x4d19, _0x55ff78 = _0x157d00[_0x1b0e02(0x6c0)](_0x3a8a19, _0x1b0e02(0xae4)), _0x96f08e = _0x55ff78['objectStore'](_0x3a8a19), _0x3954ff = _0x96f08e[_0x1b0e02(0x583)](_0x4100e0); _0x3954ff[_0x1b0e02(0x7b4)] = () => _0x2326c3(), _0x3954ff[_0x1b0e02(0x611)] = () => _0x336312(_0x3954ff[_0x1b0e02(0x27b)]); }); } let _0x128994 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; const _0x47a54a = { 'audio': document[_0x234a7d(0x8f3)](_0x234a7d(0x4d2)), 'cover': document[_0x234a7d(0x8f3)](_0x234a7d(0x925)), 'info': document[_0x234a7d(0x8f3)](_0x234a7d(0x1dd)), 'lyrics': document[_0x234a7d(0x8f3)](_0x234a7d(0xb21)) }, _0x272554 = { 'audio': document['getElementById'](_0x234a7d(0x7c5)), 'cover': document['getElementById'](_0x234a7d(0xaf4)), 'info': document[_0x234a7d(0x8f3)](_0x234a7d(0x26e)), 'lyrics': document[_0x234a7d(0x8f3)]('lyrics-file-input') }; for (const _0x598dd9 in _0x47a54a) { _0x47a54a[_0x598dd9]['addEventListener'](_0x234a7d(0xbba), () => _0x272554[_0x598dd9][_0x234a7d(0xbba)]()), _0x272554[_0x598dd9]['addEventListener'](_0x234a7d(0x69c), _0x2f70a9 => { const _0x271ac3 = _0x234a7d; if ('BiXLs' === 'BiXLs') _0x11925b(_0x598dd9, _0x2f70a9['target'][_0x271ac3(0x6f1)][0x0]); else { _0x3e6ed5(_0x271ac3(0xaaf)); return; } }); } function _0x11925b(_0x4cb884, _0x597de3) { const _0x1d99b2 = _0x234a7d; if (!_0x597de3) return; _0x128994[_0x4cb884] = _0x597de3, _0x47a54a[_0x4cb884][_0x1d99b2(0xac8)](_0x1d99b2(0x618))[_0x1d99b2(0x1cd)] = _0x597de3[_0x1d99b2(0x499)], _0x47a54a[_0x4cb884][_0x1d99b2(0x51c)][_0x1d99b2(0x6dd)](_0x1d99b2(0x340)), _0x15966e(); } function _0x15966e() { const _0x42c413 = _0x234a7d; if (_0x42c413(0x55c) !== _0x42c413(0x55c)) _0x292f14[_0x42c413(0x27b)](_0x42c413(0x487), _0x303a47, _0x42c413(0x47e), _0x321b40), _0x29811a['conversationHistory'][_0x42c413(0x8d9)]({ 'role': _0x42c413(0x1f4), 'senderId': _0x3224b1['id'], 'timestamp': _0x3a038c[_0x42c413(0x83b)](), 'isOffline': !![], 'content': '[AI返回了无法解析的剧本:\x20' + _0x593056 + ']' }); else { const _0x8dd9c = document['getElementById'](_0x42c413(0x50d)); _0x128994[_0x42c413(0x417)] && _0x128994[_0x42c413(0x5ba)] ? _0x42c413(0x258) === _0x42c413(0x2ac) ? _0x3c7500['activeUserProfileId'] = _0x48168d[_0x42c413(0x613)][0x0]['id'] : _0x8dd9c['disabled'] = ![] : _0x8dd9c['disabled'] = !![]; } } function _0x503cb5() { const _0x39d89d = _0x234a7d; _0x128994 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x162718 in _0x47a54a) { _0x47a54a[_0x162718][_0x39d89d(0x51c)][_0x39d89d(0x2e4)]('filled'), _0x272554[_0x162718][_0x39d89d(0xa35)] = ''; } _0x47a54a['audio'][_0x39d89d(0xac8)](_0x39d89d(0x618))[_0x39d89d(0x1cd)] = _0x39d89d(0x5db), _0x47a54a[_0x39d89d(0x43e)][_0x39d89d(0xac8)]('.slot-filename')['textContent'] = _0x39d89d(0x6fe), _0x47a54a[_0x39d89d(0x5ba)][_0x39d89d(0xac8)]('.slot-filename')[_0x39d89d(0x1cd)] = '点击选择\x20info.txt', _0x47a54a[_0x39d89d(0x5aa)][_0x39d89d(0xac8)](_0x39d89d(0x618))['textContent'] = _0x39d89d(0x3af), _0x15966e(); } document[_0x234a7d(0x8f3)](_0x234a7d(0x50d))[_0x234a7d(0x85f)](_0x234a7d(0xbba), async () => { const _0x55b24d = _0x234a7d; if (!_0x128994[_0x55b24d(0x417)] || !_0x128994[_0x55b24d(0x5ba)]) { if ('djSXN' === _0x55b24d(0x489)) { const _0x142a64 = [], _0x424034 = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x5f32b9; while ((_0x5f32b9 = _0x424034['exec'](_0x1c5413)) !== null) { const _0x54854b = _0x5f32b9[0x1][_0x55b24d(0x915)](/\\"/g, '\x22')['replace'](/\\n/g, '\x0a')['trim'](); if (_0x54854b) _0x142a64[_0x55b24d(0x8d9)](_0x54854b); } if (_0x142a64[_0x55b24d(0xaa7)]) return _0x142a64[_0x55b24d(0x208)](_0x4da61d)['slice'](0x0, 0x9); } else { _0x15e83d('真是的，必需的祭品都还没准备好！'); return; } } await _0x1ad5a9(); }), document[_0x234a7d(0x8f3)](_0x234a7d(0x547))[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x1fc31c = _0x234a7d; _0x1fc31c(0x5d9) !== _0x1fc31c(0x5d9) ? _0x420c6a = _0x5286d9[_0x1fc31c(0x849)] || '' : (_0x503cb5(), _0x2faf14(_0x1fc31c(0x7ae), _0x1fc31c(0x612))); }), document[_0x234a7d(0x8f3)](_0x234a7d(0x406))[_0x234a7d(0x85f)]('click', () => { const _0xe4f1a6 = _0x234a7d; _0x2faf14(_0xe4f1a6(0x612), _0xe4f1a6(0x7ae)); }); async function _0x1ad5a9() { const _0xb01b66 = _0x234a7d; if (_0xb01b66(0x454) === _0xb01b66(0x454)) { _0xc9067c(!![], _0xb01b66(0x235)); try { if (_0xb01b66(0xa74) !== _0xb01b66(0xa74)) { const _0x14ef48 = _0x3db2da[_0x51cf38]; if (typeof _0x14ef48 === 'string') _0x5c9f28[_0xb01b66(0x8d9)](_0x14ef48); if (_0x378bc8['isArray'](_0x14ef48)) _0x14ef48['forEach'](_0xd071b8 => { const _0x307e2c = _0xb01b66; if (typeof _0xd071b8 === _0x307e2c(0xa98)) _0x3cd586[_0x307e2c(0x8d9)](_0xd071b8); }); } else { const _0x58e57a = await _0x128994[_0xb01b66(0x5ba)][_0xb01b66(0x5bd)](); let _0x3d2ba3; if (_0x58e57a['trim']()[_0xb01b66(0x3df)]('{')) _0x3d2ba3 = JSON[_0xb01b66(0x57f)](_0x58e57a); else { _0x3d2ba3 = {}; const _0x11a4eb = _0x58e57a[_0xb01b66(0x500)]('\x0a'); _0x11a4eb[_0xb01b66(0x201)](_0x38b7c7 => { const _0x8d09a3 = _0xb01b66, _0x2f3da7 = _0x38b7c7[_0x8d09a3(0x500)](/:\s|：\s/); if (_0x2f3da7[_0x8d09a3(0xaa7)] === 0x2) { if ('fmmLj' !== _0x8d09a3(0xb5a)) { const _0x20f720 = _0x2f3da7[0x0][_0x8d09a3(0x44c)](), _0x2440e6 = _0x2f3da7[0x1][_0x8d09a3(0x44c)](), _0x4a63ee = { '歌名': _0x8d09a3(0x8dc), '艺术家': '歌手', '专辑': '专辑' }; _0x4a63ee[_0x20f720] && (_0x3d2ba3[_0x4a63ee[_0x20f720]] = _0x2440e6); } else return _0x1953fb(_0x1dd54c)['then'](_0x21ad76 => _0x21ad76['blob']()); } }); if (!_0x3d2ba3[_0xb01b66(0x8dc)]) { if ('ykTzw' !== _0xb01b66(0x982)) _0x1ce868(![]), _0x520140[_0xb01b66(0x3b8)] = ![]; else throw new Error('在你那乱七八糟的文本里没找到“歌名”！'); } _0x3d2ba3[_0xb01b66(0x6be)] = _0xb01b66(0x702) + Date[_0xb01b66(0x83b)](); } const _0x36e836 = _0xb01b66(0x702) + (_0x3d2ba3[_0xb01b66(0x6be)] || Date[_0xb01b66(0x83b)]()), _0x74aae2 = { 'id': _0x36e836, 'info': _0x3d2ba3, 'audio': _0x128994[_0xb01b66(0x417)], 'cover': _0x128994['cover'], 'lyrics': _0x128994['lyrics'] ? await _0x128994[_0xb01b66(0x5aa)][_0xb01b66(0x5bd)]() : '' }; await _0x42bea0(_0x74aae2), await _0xe7d633(), _0xc9067c(![]), _0x15e83d(_0xb01b66(0xb3b) + _0x3d2ba3[_0xb01b66(0x8dc)] + _0xb01b66(0x2f2)), _0x2faf14(_0xb01b66(0x612), _0xb01b66(0x7ae)); } } catch (_0x1fa277) { 'McPaF' === _0xb01b66(0x995) ? (_0xc9067c(![]), console[_0xb01b66(0x27b)]('解析音乐文件失败:', _0x1fa277), _0x15e83d(_0xb01b66(0x34d) + _0x1fa277[_0xb01b66(0x722)])) : (_0x1c64ea[_0xb01b66(0x27b)](_0xb01b66(0x322), _0x536cdb), _0x14ca2e = _0x119087); } } else _0x471d3b[_0xb01b66(0x27b)](_0xb01b66(0xb06) + _0x1834f9, _0x32f4d2); } async function _0xe7d633() { const _0x16ad05 = _0x234a7d; if (_0x16ad05(0x5a7) !== _0x16ad05(0x234)) { const _0x4ce5d4 = document[_0x16ad05(0x8f3)](_0x16ad05(0x735)); _0x4ce5d4[_0x16ad05(0x82c)] = ''; const _0x502f7d = await _0x38686b(); if (_0x502f7d[_0x16ad05(0xaa7)] === 0x0) { if (_0x16ad05(0x7d2) !== 'uRDKQ') { _0x4ce5d4[_0x16ad05(0x82c)] = _0x16ad05(0x36f); return; } else { if (!_0x1970f1) return []; const _0x2f0001 = _0x1b8c5e(_0x2eef4a)[_0x16ad05(0x44c)](), _0x887b8a = _0x2f0001['split'](/(?<=[。！？!?…])\s+|[\r\n]+/)[_0x16ad05(0x7c6)](_0x1c743f => _0x1c743f[_0x16ad05(0x44c)]())[_0x16ad05(0x3cf)](_0x302a2b); if (_0x887b8a[_0x16ad05(0xaa7)] > 0x0) return _0x887b8a[_0x16ad05(0xa38)](0x0, 0x9); return [_0x2f0001][_0x16ad05(0x3cf)](_0x14c7b); } } _0x502f7d[_0x16ad05(0xb71)]((_0x417b49, _0x32a018) => (_0x417b49[_0x16ad05(0x5ba)][_0x16ad05(0x8dc)] || '')['localeCompare'](_0x32a018[_0x16ad05(0x5ba)][_0x16ad05(0x8dc)] || '')); for (const _0x4d2f55 of _0x502f7d) { const _0x9a497f = document[_0x16ad05(0xb35)](_0x16ad05(0x4e8)); _0x9a497f['className'] = 'music-library-item', _0x9a497f[_0x16ad05(0xb40)][_0x16ad05(0xa29)] = _0x4d2f55['id']; const _0x516cd9 = _0x4d2f55[_0x16ad05(0x43e)] ? URL['createObjectURL'](_0x4d2f55[_0x16ad05(0x43e)]) : _0x322703; _0x9a497f[_0x16ad05(0x82c)] = _0x16ad05(0x61a) + _0x516cd9 + _0x16ad05(0x250) + (_0x4d2f55[_0x16ad05(0x5ba)][_0x16ad05(0x8dc)] || '未知歌曲') + _0x16ad05(0x4a1) + (_0x4d2f55[_0x16ad05(0x5ba)]['歌手'] || '未知艺术家') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; let _0x1c04de = null; const _0x5c9592 = _0x36d63a => { const _0x4ac4be = _0x16ad05; if (_0x36d63a[_0x4ac4be(0x517)] === 0x2) return; _0x1c04de = setTimeout(async () => { const _0xbf81d5 = _0x4ac4be; if (_0xbf81d5(0x7dd) !== 'JRHWf') { if (_0x36d63a['type'] === _0xbf81d5(0x534)) _0x36d63a['preventDefault'](); const _0x164b6d = await _0x2244b3('确定要从圣殿中永久删除《' + _0x4d2f55[_0xbf81d5(0x5ba)][_0xbf81d5(0x8dc)] + _0xbf81d5(0x88c)); _0x164b6d && (await _0x4ec4a3(_0x4d2f55['id']), await _0xe7d633(), _0x15e83d(_0xbf81d5(0x35b))); } else throw new _0x4d8240(_0xbf81d5(0x89e)); }, 0x320); }, _0x4a5154 = () => { const _0x3ac658 = _0x16ad05; if (_0x3ac658(0x69e) === _0x3ac658(0x69e)) clearTimeout(_0x1c04de); else { const _0x364be2 = _0x5b0e82[_0x3ac658(0xac8)](_0x3ac658(0x3c8)); _0x364be2 && _0x364be2[_0x3ac658(0x85f)](_0x3ac658(0xbba), function () { const _0x187767 = { 'id': _0x73170['id'], 'url': _0x44cc07['playableUrl'] }; _0x4db2f7(this, _0x187767); }); } }; _0x9a497f[_0x16ad05(0x85f)](_0x16ad05(0x2ee), _0x5c9592), _0x9a497f[_0x16ad05(0x85f)](_0x16ad05(0x282), _0x4a5154), _0x9a497f[_0x16ad05(0x85f)](_0x16ad05(0x225), _0x4a5154), _0x9a497f['addEventListener'](_0x16ad05(0x534), _0x5c9592, { 'passive': ![] }), _0x9a497f['addEventListener'](_0x16ad05(0x6f8), _0x4a5154), _0x9a497f[_0x16ad05(0x85f)](_0x16ad05(0xbb4), _0x4a5154), _0x9a497f['addEventListener'](_0x16ad05(0xbba), _0x2c9812 => { const _0x1209d7 = _0x16ad05; if ('nwHrO' !== _0x1209d7(0x747)) { const _0x28a8e1 = _0x5f0264[_0x1209d7(0x318)] === _0x1209d7(0x9de) ? _0x1209d7(0x4e1) : '待办'; return _0x1209d7(0x89b) + _0x28a8e1 + ']\x20' + _0x3dc5f7[_0x1209d7(0x602)] + ':\x20' + _0x27e364[_0x1209d7(0x5e2)]; } else { if (_0x1c04de) clearTimeout(_0x1c04de); if (_0x2c9812[_0x1209d7(0x346)]) return; setTimeout(() => { const _0x4ed2da = _0x1209d7; 'uKvRd' !== _0x4ed2da(0x402) ? (_0x26d0ce[_0x4ed2da(0x27b)](_0x4ed2da(0xa97) + _0x2d509d['id'], _0x139de6), _0x51f564(_0x4ed2da(0xa48))) : _0x1c04de && _0x59e76c(_0x4d2f55['id'], _0x502f7d[_0x4ed2da(0x7c6)](_0x5bb837 => _0x5bb837['id'])); }, 0x32); } }), _0x4ce5d4['appendChild'](_0x9a497f); } } else { const _0x283537 = _0x39fc4a(_0x603967[_0x16ad05(0xb7c)]); _0x5cb3d2 = _0x283537['avatar'] || _0x279d70; } } _0x18b978['addEventListener'](_0x234a7d(0xbba), () => { const _0x2b9d11 = _0x234a7d; if (_0x2b9d11(0xa84) === _0x2b9d11(0x42b)) { if (_0x193303[_0x2b9d11(0xaa7)] === 0x0) return; _0x4843d9 = (_0x10c845 + 0x1) % _0x5e4815[_0x2b9d11(0xaa7)], _0x1922be(_0x195367[_0x551303], _0x1cb353); } else _0x15e83d(_0x2b9d11(0xa33)); }), _0x12e26d[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x46f98d = _0x234a7d; if (_0x46f98d(0x8ea) === _0x46f98d(0x8ea)) _0x15e83d('这个也是摆设，别点了。'); else { const _0x2968f4 = (_0x5b3e4f[_0x46f98d(0x880)] ?? _0x3a3a19['emoji'] ?? _0x555289[_0x46f98d(0x25f)] ?? _0x594c09[_0x46f98d(0x337)])?.[_0x46f98d(0x44c)](); if (_0x2968f4 && _0x424d8d[_0x46f98d(0x70c)](_0x2968f4)) _0x13cef1[_0x46f98d(0x2e1)][_0x46f98d(0x8d9)]({ 'senderId': _0x3907a7['id'], 'kind': _0x46f98d(0x880), 'sticker': _0x2968f4 }); else { const _0x4aed9f = _0x755196(_0x2949ee['content'] ?? _0x1ef3a2['text'] ?? '')[_0x46f98d(0x44c)]() || '[sticker:' + (_0x2968f4 || _0x46f98d(0x5e7)) + ']'; if (_0x4aed9f) _0x285541[_0x46f98d(0x2e1)][_0x46f98d(0x8d9)]({ 'senderId': _0x3401f9['id'], 'kind': _0x46f98d(0x5bd), 'content': _0x4aed9f }); } } }); let _0x2125a1 = [], _0x3b2d0b = -0x1; async function _0x59e76c(_0x27bd70, _0x49edc4) { const _0x16ce21 = _0x234a7d; if ('EZnQa' === _0x16ce21(0xa27)) { const _0x3498c7 = (_0x1cd308 - _0x16236e) / (0x3e8 * 0x3c); _0x3498c7 < 0x3c ? _0x3b039d += _0x16ce21(0x9d1) : _0x515b95 += _0x16ce21(0x587) + _0x5275be[_0x16ce21(0x8d6)](_0x3498c7 / 0x3c) + '小时前），可以简单问候一下对方现在的状态。\x0a'; } else { const _0x461c19 = await _0x26c0eb(_0x27bd70); if (!_0x461c19) return; _0x511afd = { 'title': _0x461c19[_0x16ce21(0x5ba)][_0x16ce21(0x8dc)] || '未知歌曲', 'artist': _0x461c19[_0x16ce21(0x5ba)]['歌手'] || _0x16ce21(0x3f1), 'cover': _0x461c19[_0x16ce21(0x43e)] ? URL[_0x16ce21(0x64d)](_0x461c19[_0x16ce21(0x43e)]) : _0x322703, 'isFromLibrary': !![] }; const _0x3aa38b = URL['createObjectURL'](_0x461c19['audio']); _0x296518[_0x16ce21(0xa9c)] = _0x3aa38b, _0x296518[_0x16ce21(0xa1d)](), _0x571235(); } } async function _0x571235() { const _0x3e3985 = _0x234a7d; if ('KQZny' === _0x3e3985(0x5a8)) { const _0x4d910a = document['getElementById'](_0x3e3985(0xb37)), _0x23e864 = document[_0x3e3985(0x8f3)](_0x3e3985(0xb0a)), _0x3e57a0 = document[_0x3e3985(0x8f3)](_0x3e3985(0x449)), _0x533eb4 = document[_0x3e3985(0x8f3)](_0x3e3985(0x42f)), _0x44a109 = _0x511afd; _0x44a109 && _0x44a109[_0x3e3985(0x67b)] ? (_0x23e864[_0x3e3985(0x1cd)] = _0x44a109[_0x3e3985(0x773)], _0x3e57a0[_0x3e3985(0x1cd)] = _0x44a109[_0x3e3985(0x942)], _0x4d910a[_0x3e3985(0x51c)][_0x3e3985(0x6dd)](_0x3e3985(0x5f9)), _0x4d910a['style']['setProperty'](_0x3e3985(0x67d), _0x3e3985(0x5ce) + _0x44a109[_0x3e3985(0x43e)] + ')')) : (_0x23e864['textContent'] = _0x3e3985(0x6ab), _0x3e57a0[_0x3e3985(0x1cd)] = _0x3e3985(0x761), _0x4d910a[_0x3e3985(0x51c)][_0x3e3985(0x2e4)](_0x3e3985(0x5f9)), _0x533eb4[_0x3e3985(0x3e0)][_0x3e3985(0x718)](_0x3e3985(0x67d), 'none')); } else { const _0x1c3d9a = _0x344cfa['target']['result']; _0x18e29f[_0x3e3985(0x754)](_0x3e3985(0x39f) + _0x1c3d9a[_0x3e3985(0x76b)] + _0x3e3985(0xa80)), !_0x1c3d9a[_0x3e3985(0x61d)][_0x3e3985(0x56f)](_0x2cbee0) && (_0x4fccf1[_0x3e3985(0x754)](_0x3e3985(0x216) + _0xa15a41), _0x1c3d9a[_0x3e3985(0x775)](_0x548da6, { 'keyPath': 'id' })), !_0x1c3d9a[_0x3e3985(0x61d)][_0x3e3985(0x56f)](_0x3e3985(0x8e7)) && (_0x31ed72[_0x3e3985(0x754)](_0x3e3985(0xb86)), _0x1c3d9a[_0x3e3985(0x775)]('music_library', { 'keyPath': 'id' })), !_0x1c3d9a[_0x3e3985(0x61d)][_0x3e3985(0x56f)](_0x87cb37) && (_0x432ada[_0x3e3985(0x754)](_0x3e3985(0x216) + _0x3437ed), _0x1c3d9a['createObjectStore'](_0x28c8f5, { 'keyPath': 'id' })); } } _0x18b978 && _0x18b978[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0xb378d4 = _0x234a7d; if (_0xb378d4(0xa69) === _0xb378d4(0x80d)) _0x334dc6[_0xb378d4(0x27b)](_0xb378d4(0xb06) + _0x1fa5f2['id'], _0x5ab9c4); else { if (_0x2125a1[_0xb378d4(0xaa7)] === 0x0) return; _0x3b2d0b = (_0x3b2d0b + 0x1) % _0x2125a1[_0xb378d4(0xaa7)], _0x59e76c(_0x2125a1[_0x3b2d0b], _0x2125a1); } }); _0x12e26d && _0x12e26d[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x3a0c42 = _0x234a7d; if (_0x2125a1[_0x3a0c42(0xaa7)] === 0x0) return; _0x3b2d0b = (_0x3b2d0b - 0x1 + _0x2125a1[_0x3a0c42(0xaa7)]) % _0x2125a1[_0x3a0c42(0xaa7)], _0x59e76c(_0x2125a1[_0x3b2d0b], _0x2125a1); }); _0x296518[_0x234a7d(0x85f)](_0x234a7d(0xa1d), () => { const _0x3889f6 = _0x234a7d; if ('PFBue' === _0x3889f6(0x493)) _0x495281('有\x20' + _0x36310c + '\x20行格式不对，被我无视了。'); else { if (_0xd83916) _0xd83916['textContent'] = '❚❚'; } }), _0x296518[_0x234a7d(0x85f)]('pause', () => { if (_0xd83916) _0xd83916['textContent'] = '▶'; }), _0x296518[_0x234a7d(0x85f)](_0x234a7d(0x8ac), () => { const _0x21d123 = _0x234a7d; if (_0x18b978) _0x18b978[_0x21d123(0xbba)](); }); function _0x533996() { const _0x1f05fe = _0x234a7d; if (_0x1f05fe(0x9d7) !== _0x1f05fe(0x9d7)) _0x337862[_0x1f05fe(0x27b)](_0x1f05fe(0x60b), _0x30951a); else { const _0x1e266e = _0x231de4(); if (!_0x1e266e) return; _0x4e4f4d[_0x1f05fe(0x82c)] = '', _0x2fb4f0[_0x1f05fe(0xa35)] = ''; if (_0x1e266e[_0x1f05fe(0x318)] === _0x1f05fe(0x366)) { if (_0x1f05fe(0x29a) === _0x1f05fe(0x654)) { _0x4189e4[_0x1f05fe(0x82c)] = _0x1f05fe(0x1ee); return; } else _0x1e266e[_0x1f05fe(0x6a3)][_0x1f05fe(0x201)](_0x3216e2 => { const _0x1d3739 = _0x1f05fe, _0x20d3b8 = _0x11feaf(_0x3216e2); if (_0x20d3b8) { if ('IYSda' === _0x1d3739(0x29b)) { const _0x2578d4 = document[_0x1d3739(0xb35)](_0x1d3739(0x885)); _0x2578d4['value'] = _0x20d3b8['id'], _0x2578d4[_0x1d3739(0x1cd)] = _0x20d3b8[_0x1d3739(0x499)], _0x4e4f4d['appendChild'](_0x2578d4); } else { if (_0x2cad5c[_0x1d3739(0x64a)] === _0x1d3739(0x756)) _0x5a6d1d(null); _0x3c6c03[_0x1d3739(0x64a)] === _0x1d3739(0xb56) && (_0x286e6e[_0x1d3739(0xb16)](), _0x1a6b90()); } } }), _0x3996a6[_0x1f05fe(0x3e0)][_0x1f05fe(0xab9)] = _0x1f05fe(0x5ac); } else { if (_0x1f05fe(0x53d) === _0x1f05fe(0x53d)) _0x3996a6[_0x1f05fe(0x3e0)][_0x1f05fe(0xab9)] = _0x1f05fe(0x1bf); else return { 'role': 'user', 'content': [{ 'type': _0x1f05fe(0x5bd), 'text': _0x589193[_0x1f05fe(0x5e2)] || '\x20' }, { 'type': _0x1f05fe(0x46d), 'image_url': { 'url': _0x3fdb29[_0x1f05fe(0x6a9)], 'detail': _0x1f05fe(0x202) } }] }; } _0xc92be5[_0x1f05fe(0x51c)][_0x1f05fe(0x6dd)](_0x1f05fe(0x530)), _0x2fb4f0['focus'](); } } function _0x4f0d67() { const _0x10ad46 = _0x234a7d, _0xf645b9 = parseFloat(_0x2fb4f0[_0x10ad46(0xa35)]); if (isNaN(_0xf645b9) || _0xf645b9 <= 0x0) { _0x15e83d('请输入有效的转账金额！'); return; } const _0x5d0ec6 = _0x231de4(); let _0x73542e = null; if (_0x5d0ec6[_0x10ad46(0x318)] === _0x10ad46(0x366)) { if (_0x10ad46(0x408) === _0x10ad46(0x74c)) { _0x144a48('正在生成中，请稍候...'); return; } else _0x73542e = _0x4e4f4d['value']; } else { if ('uQLfb' === 'uQLfb') _0x73542e = _0x5d0ec6[_0x10ad46(0x6a3)][0x0]; else { const _0x10223e = _0x302fe5['getElementById'](_0x10ad46(0x65f)), _0x3d6c5e = _0x58d9b9[_0x10ad46(0x8f3)](_0x10ad46(0x549)); _0x10223e['innerHTML'] = '<div\x20class=\x22snoop-main-grid\x22></div>', _0x3d6c5e[_0x10ad46(0x82c)] = ''; const _0xfeda7b = _0x10223e['querySelector'](_0x10ad46(0x397)), _0x18e926 = [{ 'id': 'whispers', 'name': '聊天', 'svg': _0x10ad46(0x4de), 'area': 'dock' }, { 'id': _0x10ad46(0x673), 'name': _0x10ad46(0x20e), 'svg': _0x10ad46(0x275), 'area': _0x10ad46(0x33c) }, { 'id': 'gallery', 'name': '相册', 'svg': _0x10ad46(0x9c0), 'area': _0x10ad46(0x33c) }, { 'id': _0x10ad46(0x3fe), 'name': '总结', 'svg': _0x10ad46(0x27d), 'area': _0x10ad46(0x33c) }, { 'id': _0x10ad46(0x701), 'name': _0x10ad46(0x769), 'svg': _0x10ad46(0x40e), 'area': _0x10ad46(0x48b) }, { 'id': _0x10ad46(0x7e3), 'name': '外卖', 'svg': _0x10ad46(0x9ab), 'area': _0x10ad46(0x48b) }, { 'id': _0x10ad46(0x5b8), 'name': '购物', 'svg': _0x10ad46(0xa8d), 'area': _0x10ad46(0x48b) }, { 'id': 'footprints', 'name': '足迹', 'svg': _0x10ad46(0xb61), 'area': _0x10ad46(0x48b) }]; _0x18e926[_0x10ad46(0x201)](_0x271b36 => { const _0x84acdc = _0x10ad46, _0x3884a2 = _0x5ec146[_0x84acdc(0xb35)]('div'); _0x3884a2[_0x84acdc(0xaff)] = _0x84acdc(0x481), _0x3884a2[_0x84acdc(0x82c)] = _0x84acdc(0x515) + _0x271b36[_0x84acdc(0x858)] + _0x84acdc(0x536) + _0x271b36[_0x84acdc(0x499)] + _0x84acdc(0x50e), _0x3884a2[_0x84acdc(0x85f)](_0x84acdc(0xbba), () => _0x22e45c(_0x271b36['id'], _0x271b36[_0x84acdc(0x499)])), _0x271b36['area'] === 'dock' ? _0x3d6c5e['appendChild'](_0x3884a2) : _0xfeda7b[_0x84acdc(0x3bf)](_0x3884a2); }); } } const _0x3da868 = _0x41382f(_0x5d0ec6['id']), _0x4e8c9c = { 'role': _0x10ad46(0x7da), 'type': 'transfer', 'content': '[用户向\x20' + (_0x11feaf(_0x73542e)?.[_0x10ad46(0x499)] || '未知') + _0x10ad46(0x6d6) + _0xf645b9 + ']', 'amount': _0xf645b9, 'recipientId': _0x73542e, 'senderId': _0x3da868['id'], 'timestamp': Date['now']() }; _0x2de116[_0x10ad46(0x59f)][_0x10ad46(0x8d9)](_0x4e8c9c), _0x5ca5a8(), _0x100f70(), _0xc92be5[_0x10ad46(0x51c)][_0x10ad46(0x2e4)](_0x10ad46(0x530)); } async function _0x480614(_0x3c2a75) { const _0xbeadfe = _0x234a7d, _0x258fff = _0x11feaf(_0x3c2a75); if (!_0x258fff) return; const _0x1f949e = await _0x2244b3(_0xbeadfe(0x30d) + _0x258fff['name'] + '】的交换日记吗？\x0a此操作不可撤销，AI将彻底遗忘所有日记内容。'); if (!_0x1f949e) return; const _0x29b952 = _0x2de116[_0xbeadfe(0x38b)]['findIndex'](_0x254e4a => _0x254e4a[_0xbeadfe(0x441)] === _0x3c2a75); _0x29b952 > -0x1 ? (_0x2de116['diaries'][_0xbeadfe(0x707)](_0x29b952, 0x1), _0x2ca195(), _0x17dac3(), _0x15e83d('【' + _0x258fff[_0xbeadfe(0x499)] + _0xbeadfe(0xaf9))) : _0x15e83d(_0xbeadfe(0x92b)); } function _0x34523c() { const _0x50d454 = _0x234a7d, _0x214dd9 = document[_0x50d454(0x8f3)](_0x50d454(0x5f4)); _0x214dd9[_0x50d454(0x82c)] = ''; const _0x47008e = _0x2de116['characters']['filter'](_0x18c090 => _0x2de116[_0x50d454(0x6b7)][_0x50d454(0x342)](_0x3be5b3 => _0x3be5b3[_0x50d454(0x318)] === _0x50d454(0x2c0) && _0x3be5b3[_0x50d454(0x6a3)][_0x50d454(0x8db)](_0x18c090['id']))); if (_0x47008e[_0x50d454(0xaa7)] === 0x0) { if (_0x50d454(0x886) !== _0x50d454(0x334)) { _0x214dd9[_0x50d454(0x82c)] = _0x50d454(0x306); return; } else _0x40681c[_0x50d454(0x23c)](_0x3aa184, _0x48e0bc[_0x50d454(0x269)](_0x1c0b1f)); } _0x47008e[_0x50d454(0x201)](_0x3cbb42 => { const _0x51ed10 = _0x50d454; if (_0x51ed10(0x255) !== _0x51ed10(0xa6f)) { const _0x1bbee7 = document['createElement']('li'); _0x1bbee7[_0x51ed10(0xaff)] = _0x51ed10(0x8b8), _0x1bbee7[_0x51ed10(0xb40)]['charId'] = _0x3cbb42['id'], _0x1bbee7[_0x51ed10(0x82c)] = _0x51ed10(0x371) + (_0x3cbb42[_0x51ed10(0x41d)] || _0x322703) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x3cbb42[_0x51ed10(0x499)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>查看手机...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20snoop-clear-btn\x22\x20title=\x22清空' + _0x3cbb42[_0x51ed10(0x499)] + _0x51ed10(0x3c7), _0x1bbee7[_0x51ed10(0xac8)](_0x51ed10(0x4b8))[_0x51ed10(0x85f)]('click', () => _0x337c54(_0x3cbb42['id'])), _0x1bbee7['querySelector'](_0x51ed10(0x99a))[_0x51ed10(0x85f)](_0x51ed10(0xbba), async _0x4537a1 => { const _0x13f851 = _0x51ed10; if ('chsNe' === _0x13f851(0x963)) { _0x4537a1['stopPropagation'](); const _0x58839b = _0x11feaf(_0x3cbb42['id']); if (!_0x58839b) return; const _0x331683 = await _0x2244b3('确定要彻底清空【' + _0x58839b[_0x13f851(0x499)] + _0x13f851(0x7d5)); if (_0x331683) { _0xc9067c(!![], '正在焚烧【' + _0x58839b[_0x13f851(0x499)] + '】的旧数据...'); const _0x35b2db = [_0x13f851(0x2cc), 'whispers', _0x13f851(0x673), 'fragments', _0x13f851(0x7e3), _0x13f851(0x5b8), _0x13f851(0xba3), _0x13f851(0x3fe)]; for (const _0x26e674 of _0x35b2db) { const _0x32c86c = 'snoop_' + _0x58839b['id'] + '_' + _0x26e674; await _0x155cc5(_0x32c86c); } _0xc9067c(![]), _0x15e83d('【' + _0x58839b[_0x13f851(0x499)] + _0x13f851(0x5ef)); } } else { const _0x1e6017 = _0x35d224[_0x13f851(0x8f3)](_0x13f851(0x59c))[_0x13f851(0xa35)]; _0x1e6017 && (_0x3aaeee[_0x13f851(0xabe)] = _0x1e6017, _0x337589(), _0x57dc0c('已设为当前用户！'), _0x1861ee(), _0x5c05c3[_0x13f851(0x8f3)]('set-active-user-button')[_0x13f851(0x3e0)]['display'] = _0x13f851(0x1bf)); } }), _0x214dd9[_0x51ed10(0x3bf)](_0x1bbee7); } else _0x4bc776['scrollTop'] = _0x4a5306[_0x51ed10(0x7ed)]; }); } let _0x32e3eb = null, _0x199871 = null; function _0x35380e() { const _0x3b569e = _0x234a7d; if (_0x3b569e(0x728) === _0x3b569e(0x728)) { const _0x2288aa = new Date(), _0xf35a06 = document[_0x3b569e(0x8f3)]('snoop-home-time'), _0x4a82e2 = document[_0x3b569e(0x8f3)](_0x3b569e(0xa73)), _0x515757 = document[_0x3b569e(0x8f3)](_0x3b569e(0x254)); _0xf35a06 && _0x4a82e2 && (_0xf35a06[_0x3b569e(0x1cd)] = _0x2288aa[_0x3b569e(0x700)](_0x3b569e(0x2e3), { 'hour': _0x3b569e(0x748), 'minute': _0x3b569e(0x748), 'hour12': ![] }), _0x4a82e2[_0x3b569e(0x1cd)] = _0x2288aa[_0x3b569e(0x9e4)](_0x3b569e(0x2e3), { 'month': _0x3b569e(0x51a), 'day': 'numeric', 'weekday': _0x3b569e(0x51a) })); if (_0x515757) { if (_0x3b569e(0x622) !== _0x3b569e(0x349)) _0x515757[_0x3b569e(0x82c)] = _0x3b569e(0x427) + _0x2288aa[_0x3b569e(0x700)]('zh-CN', { 'hour': _0x3b569e(0x748), 'minute': _0x3b569e(0x748), 'hour12': ![] }) + _0x3b569e(0x5bf); else { _0x14cd3d[_0x3b569e(0x27b)](_0x3b569e(0x36a)); return; } } } else _0x544317['textContent'] = '近期没有特别安排', _0x32fc69[_0x3b569e(0x82c)] = _0x3b569e(0x709); } function _0x337c54(_0x17b952) { const _0x3a66bf = _0x234a7d; _0x32e3eb = _0x17b952; const _0x575ab4 = _0x11feaf(_0x17b952); if (!_0x575ab4) return; const _0x1b6240 = document[_0x3a66bf(0x8f3)](_0x3a66bf(0x601)), _0x447612 = document[_0x3a66bf(0x8f3)](_0x3a66bf(0x407)); if (_0x447612) _0x447612['remove'](); const _0x1ba367 = document[_0x3a66bf(0x8f3)](_0x3a66bf(0x549)); if (_0x1ba367) _0x1ba367[_0x3a66bf(0x2e4)](); _0x1b6240[_0x3a66bf(0xa8c)]('beforeend', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-clock\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-time\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22snoop-home-date\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20'), _0x1b6240[_0x3a66bf(0xa8c)]('beforeend', _0x3a66bf(0xa20)), document[_0x3a66bf(0x8f3)]('snoop-char-name-header')[_0x3a66bf(0x1cd)] = '', _0x4bf988(); if (_0x199871) clearInterval(_0x199871); _0x35380e(), _0x199871 = setInterval(_0x35380e, 0x2710), _0x2faf14(_0x3a66bf(0xa22), _0x3a66bf(0x73d)); } function _0x4bf988() { const _0x23a826 = _0x234a7d; if (_0x23a826(0x872) === 'VTRtb') { const _0x49155f = document[_0x23a826(0x8f3)](_0x23a826(0x65f)), _0x171c43 = document[_0x23a826(0x8f3)](_0x23a826(0x549)); _0x49155f[_0x23a826(0x82c)] = _0x23a826(0x78c), _0x171c43[_0x23a826(0x82c)] = ''; const _0x10d9f8 = _0x49155f['querySelector'](_0x23a826(0x397)), _0x13b651 = [{ 'id': _0x23a826(0x447), 'name': '聊天', 'svg': _0x23a826(0x4de), 'area': _0x23a826(0x33c) }, { 'id': 'abyss', 'name': _0x23a826(0x20e), 'svg': '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path>', 'area': _0x23a826(0x33c) }, { 'id': _0x23a826(0x2cc), 'name': '相册', 'svg': _0x23a826(0x9c0), 'area': 'dock' }, { 'id': 'summary', 'name': '总结', 'svg': _0x23a826(0x27d), 'area': _0x23a826(0x33c) }, { 'id': _0x23a826(0x701), 'name': _0x23a826(0x769), 'svg': '<path\x20d=\x22M13.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V9L13.5\x202z\x22></path><polyline\x20points=\x2213\x202\x2013\x209\x2020\x209\x22></polyline>', 'area': 'main' }, { 'id': _0x23a826(0x7e3), 'name': '外卖', 'svg': _0x23a826(0x9ab), 'area': _0x23a826(0x48b) }, { 'id': 'wants', 'name': '购物', 'svg': _0x23a826(0xa8d), 'area': 'main' }, { 'id': 'footprints', 'name': '足迹', 'svg': _0x23a826(0xb61), 'area': 'main' }]; _0x13b651[_0x23a826(0x201)](_0x2abf50 => { const _0xaf43fd = _0x23a826; if ('ifTuU' === _0xaf43fd(0x7bb)) { const _0x3fe7f6 = document[_0xaf43fd(0xb35)](_0xaf43fd(0x4e8)); _0x3fe7f6[_0xaf43fd(0xaff)] = _0xaf43fd(0x481), _0x3fe7f6[_0xaf43fd(0x82c)] = _0xaf43fd(0x515) + _0x2abf50['svg'] + '</svg></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>' + _0x2abf50['name'] + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x3fe7f6[_0xaf43fd(0x85f)](_0xaf43fd(0xbba), () => _0x44f70d(_0x2abf50['id'], _0x2abf50[_0xaf43fd(0x499)])), _0x2abf50[_0xaf43fd(0x79b)] === 'dock' ? _0xaf43fd(0x53a) !== _0xaf43fd(0x21e) ? _0x171c43['appendChild'](_0x3fe7f6) : (_0x49d409[_0xaf43fd(0x207)]['splice'](_0x2062be, 0x1), _0x530a2a(), _0x4ac422(), _0x54d335(), _0x133a07(), _0x471404(_0xaf43fd(0x4bd))) : _0x10d9f8['appendChild'](_0x3fe7f6); } else _0x3b64be[_0xaf43fd(0x85f)](_0xaf43fd(0xbba), () => { const _0x3f73bf = _0xaf43fd, _0x28fc91 = _0x57912f(_0x53b4f3[_0x3f73bf(0xb40)][_0x3f73bf(0x2cb)], 0xa); _0x51b085(_0x28fc91); }); }); } else _0x4d0fa2[_0x23a826(0x4f8)] = ![], _0x40d319[_0x23a826(0x1cd)] = '获取'; } document[_0x234a7d(0x8f3)](_0x234a7d(0x9cd))[_0x234a7d(0x85f)]('click', () => { const _0x40119c = _0x234a7d; if (_0x40119c(0x98e) === _0x40119c(0x98e)) { _0x199871 && (clearInterval(_0x199871), _0x199871 = null); document[_0x40119c(0x8f3)](_0x40119c(0x9ca))[_0x40119c(0x3e0)][_0x40119c(0xab9)] = _0x40119c(0x1bf); const _0x51797e = document[_0x40119c(0x8f3)](_0x40119c(0x549)); if (_0x51797e) _0x51797e['remove'](); const _0x4a9647 = document['getElementById']('snoop-home-clock'); if (_0x4a9647) _0x4a9647[_0x40119c(0x2e4)](); _0x2faf14(_0x40119c(0x73d), _0x40119c(0xa22)); } else _0x393ad4[_0x40119c(0x3e0)][_0x40119c(0xaa3)] = 'url(' + _0x2158a5[_0x40119c(0x64d)](_0x23d444) + ')', _0x5d2a85[_0x40119c(0x3e0)][_0x40119c(0x76c)] = _0x40119c(0x43e), _0x23bb00[_0x40119c(0x3e0)][_0x40119c(0x992)] = 'center'; }); async function _0x44f70d(_0x64a80b, _0x15b293, _0x2aa49f = ![]) { const _0x453b7e = _0x234a7d; if (_0x453b7e(0x571) !== _0x453b7e(0x717)) { document['getElementById'](_0x453b7e(0x84a))[_0x453b7e(0x3e0)][_0x453b7e(0xab9)] = _0x453b7e(0x1bf); const _0x22688d = document['getElementById'](_0x453b7e(0x9ca)); _0x22688d[_0x453b7e(0x82c)] = _0x453b7e(0x842), _0x22688d['style'][_0x453b7e(0xab9)] = _0x453b7e(0x47f); const _0x279f4a = _0x453b7e(0x41a) + _0x32e3eb + '_' + _0x64a80b; try { if ('whUnu' !== _0x453b7e(0x6a8)) '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a'; else { if (_0x64a80b === 'summary') { const _0x2edb7e = await _0x12bb4c(_0x32e3eb); _0x29d327(_0x64a80b, _0x15b293, _0x2edb7e); return; } let _0x41ddf5 = await _0x4cfca9(_0x279f4a); if (_0x2aa49f || !_0x41ddf5) { console[_0x453b7e(0x754)](_0x453b7e(0x6d7) + _0x279f4a + _0x453b7e(0xa80)); let _0x4306aa = await _0x41ae7e(_0x64a80b, _0x32e3eb, _0x41ddf5); if (_0x4306aa) { if (_0x453b7e(0x2d4) !== 'RrQUN') { const _0x3ed872 = _0x4306aa['match'](/```(?:json)?\s*([\s\S]*?)\s*```/), _0x463dea = _0x3ed872 ? _0x3ed872[0x1][_0x453b7e(0x44c)]() : _0x4306aa['trim'](); let _0x38dc66; try { _0x453b7e(0x75a) === _0x453b7e(0x75a) ? _0x38dc66 = JSON[_0x453b7e(0x57f)](_0x463dea) : _0x5f48a6[_0x453b7e(0x85f)]('click', () => { const _0x358f08 = _0x453b7e, _0x1bdd74 = _0x2e12e2[_0x358f08(0x57f)](_0x472ad9['dataset'][_0x358f08(0x754)][_0x358f08(0x915)](/&quot;/g, '\x22')), _0x499442 = _0x51a6bc['dataset'][_0x358f08(0x3e3)], _0x291e6e = _0x1ec2bc[_0x358f08(0xb40)][_0x358f08(0x5c2)]; _0x28ed0a(_0x499442, _0x291e6e, _0x1bdd74); }); } catch (_0x14a1aa) { _0x38dc66 = _0x1360bd(_0x463dea); if (!_0x38dc66) throw new Error(_0x453b7e(0xb2b)); } let _0x2a70bc; if (_0x2aa49f && _0x41ddf5) { if ('bFkcc' !== _0x453b7e(0x445)) { const _0x18e0a6 = _0x1a72aa(_0x36e6d9['activeMeetingCharId']); if (!_0x18e0a6) return; const _0x2dc03e = _0x49e89c(_0x4689f3[_0x453b7e(0x8f3)](_0x453b7e(0x976))['value']), _0x2c6747 = _0x133883(_0x23ad60[_0x453b7e(0x8f3)](_0x453b7e(0x944))[_0x453b7e(0xa35)]), _0x23a415 = _0x39dc79(_0x1b003f[_0x453b7e(0x8f3)]('sprite-slider-scale')['value']) / 0x64; _0x18e0a6['spriteTransform'] = { 'x': _0x2dc03e, 'y': _0x2c6747, 'scale': _0x23a415 }, _0x2ecf41(), _0x5da553(_0x453b7e(0xba7)), _0x17c978(!![]); } else try { const _0x4a42b5 = JSON['parse'](_0x41ddf5); if (_0x64a80b === _0x453b7e(0x447)) _0x2a70bc = JSON[_0x453b7e(0x269)](_0x38dc66), console[_0x453b7e(0x754)]('Noir\x27s\x20Fix:\x20已用AI返回的连续对话更新聊天记录。'); else { if (_0x453b7e(0x692) !== 'AfoZD') _0x295609[_0x453b7e(0x499)] = _0x1f1ca3, _0x184ab6[_0x453b7e(0x5e2)] = _0xbdb939; else { if (Array[_0x453b7e(0x75c)](_0x4a42b5) && Array['isArray'](_0x38dc66)) { if (_0x453b7e(0xb4b) !== _0x453b7e(0xb4b)) _0x8e201f ? _0x55097a(_0x151f59) : _0x57a094(new _0x1cdf82(_0x453b7e(0x40f))); else { const _0x261e2f = _0x4a42b5[_0x453b7e(0x24d)](_0x38dc66); _0x2a70bc = JSON['stringify'](_0x261e2f), console[_0x453b7e(0x754)](_0x453b7e(0x6bd)); } } else { if (_0x453b7e(0x4fc) === _0x453b7e(0x84f)) { if (!_0xfa7908[_0x453b7e(0xa9b)]) return; _0x1e1ccf[_0x453b7e(0x1cd)] = _0x453b7e(0xa4e) + _0x13d496[_0x453b7e(0xa9b)][_0x453b7e(0xa6e)], _0xddd3f[_0x453b7e(0x1cd)] = _0x3cf271[_0x453b7e(0xa9b)][_0x453b7e(0x5e2)], _0x208a9b[_0x453b7e(0x3e0)][_0x453b7e(0xab9)] = 'block'; } else _0x2a70bc = JSON[_0x453b7e(0x269)](_0x38dc66); } } } } catch (_0x3a4711) { _0x2a70bc = JSON[_0x453b7e(0x269)](_0x38dc66); } } else _0x453b7e(0x544) !== 'OIYNa' ? (_0x6755ed['remove'](), _0x1bbc37()) : _0x2a70bc = JSON['stringify'](_0x38dc66); await _0x32f743(_0x279f4a, _0x2a70bc), _0x41ddf5 = _0x2a70bc; } else try { const _0x3fc339 = _0x196021['parse'](_0x1a4821); _0xdebca8[_0x453b7e(0x75c)](_0x3fc339) && (_0x430607[_0x453b7e(0xa35)] = _0x3fc339[_0x453b7e(0x7c6)](_0x5ce84a => _0x5ce84a[_0x453b7e(0x499)] + '--' + _0x5ce84a[_0x453b7e(0xb77)])[_0x453b7e(0x6cf)]('\x0a')); } catch (_0x3dfa49) { } } } else console[_0x453b7e(0x754)](_0x453b7e(0x2cf) + _0x279f4a); _0x29d327(_0x64a80b, _0x15b293, _0x41ddf5); } } catch (_0x3cc830) { _0x453b7e(0x2e2) !== _0x453b7e(0x2e2) ? _0x5b5c8e(_0x453b7e(0xbb1) + _0x1a1620[_0x453b7e(0x722)]) : (console[_0x453b7e(0x27b)]('加载\x20' + _0x15b293 + '\x20内容失败:', _0x3cc830), _0x22688d[_0x453b7e(0x82c)] = '<p\x20style=\x22margin:\x20auto;\x20text-align:\x20center;\x20color:\x20red;\x22>加载失败了，哼。<br>' + _0x3cc830['message'] + _0x453b7e(0xb3f)); } } else _0x48ca6b(_0xccd363['id']); } function _0x29d327(_0x7afda7, _0x4c98d4, _0x199379) { const _0x34b1d4 = _0x234a7d; if (_0x34b1d4(0x575) !== _0x34b1d4(0xaa9)) { const _0x482d24 = _0x11feaf(_0x32e3eb), _0x5a4980 = document[_0x34b1d4(0x8f3)](_0x34b1d4(0x9ca)); let _0xa3096 = ''; if (!_0x199379) _0xa3096 = _0x34b1d4(0x25d); else { if (_0x34b1d4(0x522) === _0x34b1d4(0x2ec)) _0x5b368d[_0x34b1d4(0x3e0)][_0x34b1d4(0xab9)] = _0x34b1d4(0x1bf), _0x1cd4f6['style'][_0x34b1d4(0x249)] = _0x34b1d4(0x573); else { if (_0x7afda7 === _0x34b1d4(0x3fe)) { if (_0x34b1d4(0x69b) !== _0x34b1d4(0x69b)) { const _0x2ae1e0 = _0x2c2b0b[_0x34b1d4(0xa35)]['trim'](), _0x8c17c7 = _0x40cfcb['value'][_0x34b1d4(0x44c)](); if (!_0x2ae1e0 || !_0x8c17c7) { _0x1f9132(_0x34b1d4(0xb69)); return; } _0x128d62({ 'songName': _0x2ae1e0, 'artist': _0x8c17c7 }); } else _0xa3096 = _0x34b1d4(0x7f9) + _0x199379 + '</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'; } else try { if (_0x34b1d4(0x2eb) === 'xgycU') { let _0x56400b = null; const _0x2c2ff6 = _0x199379[_0x34b1d4(0x435)](/```(?:json)?\s*([\s\S]*?)\s*```/), _0x1d1bf0 = _0x2c2ff6 ? _0x2c2ff6[0x1] : _0x199379; _0x56400b = JSON[_0x34b1d4(0x57f)](_0x1d1bf0); const _0x16dcde = _0x11feaf(_0x32e3eb); switch (_0x7afda7) { case _0x34b1d4(0x2cc): _0xa3096 = _0x5ac732(_0x56400b); break; case _0x34b1d4(0x447): _0xa3096 = _0x76680a(_0x56400b, _0x16dcde[_0x34b1d4(0x499)]); break; case 'abyss': _0xa3096 = _0x1f48c9(_0x56400b); break; case _0x34b1d4(0x701): _0xa3096 = _0x1b62ed(_0x56400b); break; case _0x34b1d4(0x7e3): _0xa3096 = _0x49292e(_0x56400b); break; case _0x34b1d4(0x5b8): _0xa3096 = _0x37e17f(_0x56400b); break; case _0x34b1d4(0xba3): _0xa3096 = _0xd32d76(_0x56400b); break; case _0x34b1d4(0x3fe): _0xa3096 = _0x34b1d4(0x941) + _0x199379 + _0x34b1d4(0x1f1); break; default: _0xa3096 = _0x34b1d4(0x4ae) + JSON[_0x34b1d4(0x269)](_0x56400b, null, 0x2) + '</pre>'; } } else _0x2f5459[_0x34b1d4(0xaff)] = _0x34b1d4(0x5f8), _0x4f40e8[_0x34b1d4(0x3e0)][_0x34b1d4(0xb6e)] = 'italic', _0x1c8112[_0x34b1d4(0x3e0)]['color'] = _0x34b1d4(0x988), _0x1c467a[_0x34b1d4(0x82c)] = _0x347988; } catch (_0x400855) { if (_0x34b1d4(0xa72) === _0x34b1d4(0xa72)) console['error'](_0x34b1d4(0x6ff), _0x400855), _0xa3096 = _0x34b1d4(0x7ff) + _0x199379 + _0x34b1d4(0x33a); else return _0x21c0eb[_0x34b1d4(0x754)](_0x34b1d4(0x2fe)), ''; } } } _0x5a4980[_0x34b1d4(0x82c)] = _0x34b1d4(0xba6) + _0x4c98d4 + _0x34b1d4(0x899) + _0x482d24['name'] + '的手机</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x7afda7 === _0x34b1d4(0x3fe) ? _0x34b1d4(0x409) : _0x34b1d4(0x99e)) + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-content\x22>' + _0xa3096 + _0x34b1d4(0xafe); const _0x449f6a = _0x5a4980['querySelector']('.snoop-app-content'); if (_0x7afda7 === _0x34b1d4(0x3fe)) { if ('JGWpq' === 'JGWpq') _0x449f6a[_0x34b1d4(0x3e0)][_0x34b1d4(0x8c8)] = '0'; else throw _0x4f6313; } document[_0x34b1d4(0x8f3)]('snoop-app-back-btn')['addEventListener'](_0x34b1d4(0xbba), () => { const _0x453736 = _0x34b1d4; if (_0x453736(0x292) === _0x453736(0x292)) _0x5a4980[_0x453736(0x3e0)]['display'] = _0x453736(0x1bf), document['getElementById']('snoop-phone-top-nav')['style'][_0x453736(0xab9)] = 'flex'; else { _0x2ac4c6['warn'](_0x453736(0x326)); const _0x29de2f = _0x1a734a['participantIds'][_0x453736(0x7c6)](_0x21b5fe)[_0x453736(0x3cf)](_0x204b92); if (!_0x29de2f[_0x453736(0xaa7)]) return; let _0x5b5ab3 = 0x0; for (const _0x1785d0 of _0x29de2f) { _0x5ab396(_0x1785d0, { 'force': !![], 'delayMs': _0x5b5ab3 }), _0x5b5ab3 += 0x1f4; } } }); _0x7afda7 === _0x34b1d4(0x3fe) ? document[_0x34b1d4(0x8f3)](_0x34b1d4(0x297))['addEventListener']('click', () => { const _0x5b18ef = _0x34b1d4, _0x33cc2c = document[_0x5b18ef(0x8f3)](_0x5b18ef(0x90c)); _0x33cc2c[_0x5b18ef(0x696)](), document[_0x5b18ef(0x364)](_0x5b18ef(0x634)), _0x15e83d('档案已复制到剪贴板！'); }) : document[_0x34b1d4(0x8f3)](_0x34b1d4(0xb70))[_0x34b1d4(0x85f)](_0x34b1d4(0xbba), async () => { _0x44f70d(_0x7afda7, _0x4c98d4, !![]); }); if (_0x7afda7 === _0x34b1d4(0x447)) { if ('dGcDh' === _0x34b1d4(0x90a)) { if (_0x539e75[_0x34b1d4(0x512)]) return; const _0x477d83 = _0x2c9b34[_0x34b1d4(0xaf2)], _0x2e3a4a = _0xe9142[_0x34b1d4(0x1bb)](_0x5a6e54[_0x34b1d4(0x38b)][_0x34b1d4(0xa68)](_0x56e95a => _0x56e95a[_0x34b1d4(0x441)] === _0x3373eb[_0x34b1d4(0xa8b)])[_0x34b1d4(0x71c)][_0x34b1d4(0xaa7)] / 0x2); if (_0x477d83 >= _0x2e3a4a - 0x1) return; _0x45914e[_0x34b1d4(0x512)] = !![]; const _0xa4adf8 = _0x477d83 + 0x1, _0x15380f = _0x29f490[_0x34b1d4(0x8f3)]('diary-page-' + _0x477d83), _0x432fe4 = _0x24e82d[_0x34b1d4(0x8f3)]('diary-page-' + _0xa4adf8); _0x15380f && _0x432fe4 ? (_0x432fe4[_0x34b1d4(0x51c)][_0x34b1d4(0x6dd)](_0x34b1d4(0x8a5)), _0x15380f['classList'][_0x34b1d4(0x6dd)](_0x34b1d4(0x6b2)), _0x432fe4[_0x34b1d4(0x51c)][_0x34b1d4(0x6dd)]('is-visible'), _0x8d92a4(() => { const _0x56724c = _0x34b1d4; _0x15380f[_0x56724c(0x51c)][_0x56724c(0x2e4)](_0x56724c(0x60a), 'is-exiting-left'), _0x432fe4[_0x56724c(0x51c)][_0x56724c(0x2e4)]('is-entering-from-right'), _0x5c69ca[_0x56724c(0xaf2)] = _0xa4adf8, _0x249e42(), _0x51d169[_0x56724c(0x512)] = ![]; }, 0x2bc)) : _0x157a19[_0x34b1d4(0x512)] = ![]; } else _0x5a4980['querySelectorAll']('.snoop-chat-item')[_0x34b1d4(0x201)](_0x37a463 => { const _0x2f0ba4 = _0x34b1d4; if (_0x2f0ba4(0x3d3) === _0x2f0ba4(0x3d3)) _0x37a463[_0x2f0ba4(0x85f)]('click', () => { const _0x15b948 = _0x2f0ba4; if (_0x15b948(0xb1d) !== _0x15b948(0xb1d)) _0x4f8ccb = _0x578ed6[_0x15b948(0x3cf)](_0x499b86 => _0x499b86 && typeof _0x499b86 === 'object' && typeof _0x499b86[_0x15b948(0x9e8)] === 'string' && typeof _0x499b86[_0x15b948(0x5e2)] !== _0x15b948(0x358)); else { const _0x245f91 = JSON[_0x15b948(0x57f)](_0x37a463[_0x15b948(0xb40)][_0x15b948(0x754)][_0x15b948(0x915)](/&quot;/g, '\x22')), _0xd9cd96 = _0x37a463[_0x15b948(0xb40)]['contactName'], _0x480a9d = _0x37a463[_0x15b948(0xb40)]['characterName']; _0x53b306(_0xd9cd96, _0x480a9d, _0x245f91); } }); else { if (_0x390dc1) _0x469f91(_0x1d108c); } }); } } else { _0x883be3(_0x34b1d4(0x7a0), 'worldBook'); if (_0xe82584) { const _0x54e029 = _0x2000f4[_0x34b1d4(0x432)][_0x34b1d4(0xa68)](_0x504699 => _0x504699['id'] === _0x18788f); if (!_0x54e029) return; _0x23c921[_0x34b1d4(0x8f3)](_0x34b1d4(0x200))[_0x34b1d4(0xa35)] = _0x54e029['id'], _0x55f29c['getElementById'](_0x34b1d4(0x71b))[_0x34b1d4(0x1cd)] = _0x34b1d4(0x928), _0x57b843[_0x34b1d4(0x8f3)]('world-book-edit-name')[_0x34b1d4(0xa35)] = _0x54e029[_0x34b1d4(0x499)], _0x427232[_0x34b1d4(0x8f3)](_0x34b1d4(0x31c))[_0x34b1d4(0xa35)] = _0x54e029[_0x34b1d4(0x5e2)]; } else _0x4eff62[_0x34b1d4(0x8f3)](_0x34b1d4(0x200))['value'] = '', _0x396c81[_0x34b1d4(0x8f3)](_0x34b1d4(0x71b))[_0x34b1d4(0x1cd)] = _0x34b1d4(0xb78), _0x27d281['getElementById']('world-book-edit-name')[_0x34b1d4(0xa35)] = '', _0x58da63[_0x34b1d4(0x8f3)](_0x34b1d4(0x31c))[_0x34b1d4(0xa35)] = ''; } } function _0x53b306(_0x59ea7d, _0x5054df, _0x151f7a) { const _0x2630df = _0x234a7d, _0x56f1c9 = document[_0x2630df(0xac8)](_0x2630df(0x4e5)), _0x62e88a = document['querySelector'](_0x2630df(0x805)); let _0x4c7cdb = _0x2630df(0x88f); !_0x151f7a || _0x151f7a[_0x2630df(0xaa7)] === 0x0 ? _0x2630df(0x301) === _0x2630df(0x69f) ? _0x23157c(_0x2630df(0x6f3) + _0x2624d6[_0x2630df(0x722)]) : _0x4c7cdb += _0x2630df(0x294) : _0x151f7a['forEach'](_0x54cfcd => { const _0x466c82 = _0x2630df, _0x2c5b0d = _0x54cfcd[_0x466c82(0xa6e)] === _0x466c82(0x2af), _0x384585 = _0x2c5b0d ? _0x5054df ? _0x5054df[0x0] : '?' : _0x59ea7d ? _0x59ea7d[0x0] : '?'; _0x4c7cdb += '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-container\x20' + (_0x2c5b0d ? _0x466c82(0x7da) : 'ai') + _0x466c82(0x639) + (!_0x2c5b0d ? _0x466c82(0x496) + _0x384585 + _0x466c82(0x806) : '') + _0x466c82(0x506) + (_0x2c5b0d ? 'user' : 'ai') + _0x466c82(0x9dc) + _0x54cfcd[_0x466c82(0x5e2)] + _0x466c82(0x94a) + (_0x2c5b0d ? _0x466c82(0x496) + _0x384585 + _0x466c82(0x806) : '') + _0x466c82(0x2a0); }), _0x4c7cdb += _0x2630df(0x806), _0x56f1c9[_0x2630df(0x82c)] = _0x4c7cdb, _0x56f1c9[_0x2630df(0x87b)] = _0x56f1c9[_0x2630df(0x7ed)], _0x62e88a['innerHTML'] = _0x2630df(0x866) + _0x59ea7d + _0x2630df(0x51f), document[_0x2630df(0x8f3)](_0x2630df(0x4d4))[_0x2630df(0x85f)]('click', () => { const _0x427fe1 = _0x2630df; if (_0x427fe1(0x977) !== _0x427fe1(0xad0)) _0x44f70d('whispers', '聊天'); else throw new _0x2d0e39(_0x427fe1(0x6eb) + _0x51da10); }), !document[_0x2630df(0x8f3)](_0x2630df(0x491)) && (_0x2630df(0x3e2) === 'ItcpQ' ? _0x257def['scrollTop'] = _0x20e911[_0x2630df(0x7ed)] : document[_0x2630df(0x373)][_0x2630df(0xa8c)](_0x2630df(0x7cf), _0x2630df(0x960))); } function _0x1360bd(_0x38d04d) { const _0x26424a = _0x234a7d; if (!_0x38d04d || typeof _0x38d04d !== _0x26424a(0xa98)) return null; const _0x5b1119 = _0x38d04d[_0x26424a(0x44c)]()['split']('\x0a'), _0x382545 = []; let _0x1d1377 = null; for (const _0x50a5fc of _0x5b1119) { const _0xdbaf09 = _0x50a5fc[_0x26424a(0x44c)](); if (_0xdbaf09[_0x26424a(0x3df)]('-\x20')) { if (_0x26424a(0x43b) === _0x26424a(0x43b)) { _0x1d1377 && _0x382545[_0x26424a(0x8d9)](_0x1d1377); _0x1d1377 = {}; const _0x38ef70 = _0xdbaf09[_0x26424a(0x8c6)](0x2), _0x13d7fa = _0x38ef70['split'](/:\s(.+)/); if (_0x13d7fa[_0x26424a(0xaa7)] > 0x1) { if (_0x26424a(0x28f) === _0x26424a(0x2b7)) _0xc6cc65['classList'][_0x26424a(0x6dd)](_0x26424a(0x5ec)); else { const _0x5af31a = _0x13d7fa[0x0][_0x26424a(0x44c)](), _0x6c53fc = _0x13d7fa[0x1][_0x26424a(0x44c)]()['replace'](/^"|"$/g, ''); _0x1d1377[_0x5af31a] = _0x6c53fc; } } } else _0x2ca2db(), _0x348cc5(![]); } else { if (_0x1d1377 && _0xdbaf09) { const _0x1240f1 = _0xdbaf09[_0x26424a(0x500)](/:\s(.+)/); if (_0x1240f1['length'] > 0x1) { if (_0x26424a(0x3c5) === _0x26424a(0x3c5)) { const _0x4818c4 = _0x1240f1[0x0]['trim'](), _0x4a6510 = _0x1240f1[0x1][_0x26424a(0x44c)]()[_0x26424a(0x915)](/^"|"$/g, ''); _0x1d1377[_0x4818c4] = _0x4a6510; } else { let _0x2c61ce = _0x5cd9a7[_0x26424a(0x44c)](); const _0x1bdcdc = _0x2c61ce[_0x26424a(0x435)](/(\[[\s\S]*\])/); _0x1bdcdc && (_0x2c61ce = _0x1bdcdc[0x1]); const _0x1718bc = _0x348478['parse'](_0x2c61ce); if (_0x2533dd[_0x26424a(0x75c)](_0x1718bc)) { _0x6c000e[_0x26424a(0x8f7)] = [..._0x1718bc], _0x2d6aa1[_0x26424a(0x58f)][_0x165d52['id']] = [..._0x1718bc], _0x20a52a(); const _0x113492 = _0x1718bc[_0x26424a(0x7c6)](_0x30d663 => _0x30d663[_0x26424a(0xbbe)] === _0x26424a(0x5f8) ? _0x30d663[_0x26424a(0x910)] : _0x30d663[_0x26424a(0xbbe)] + ':\x20' + _0x30d663['line'])[_0x26424a(0x6cf)]('\x0a\x0a'); _0x4c806b[_0x26424a(0x59f)][_0x26424a(0x8d9)]({ 'role': 'assistant', 'senderId': _0x43da72['id'], 'timestamp': _0x477e53[_0x26424a(0x83b)](), 'isOffline': !![], 'content': _0x113492 }); } } } } } } return _0x1d1377 && _0x382545[_0x26424a(0x8d9)](_0x1d1377), _0x382545[_0x26424a(0xaa7)] > 0x0 ? _0x382545 : null; } async function _0x5eaae3(_0x81330d) { const _0x47f272 = _0x234a7d; if (!_0x81330d) return ''; const _0x103c0d = [{ 'id': 'gallery', 'name': '相册' }, { 'id': _0x47f272(0x447), 'name': _0x47f272(0x560) }, { 'id': _0x47f272(0x673), 'name': _0x47f272(0xb6d) }, { 'id': 'fragments', 'name': _0x47f272(0x769) }, { 'id': _0x47f272(0x7e3), 'name': _0x47f272(0x939) }, { 'id': _0x47f272(0x5b8), 'name': '购物记录' }, { 'id': _0x47f272(0xba3), 'name': _0x47f272(0x868) }]; let _0x48233e = ''; for (const _0x760687 of _0x103c0d) { try { const _0xd86588 = _0x47f272(0x41a) + _0x81330d + '_' + _0x760687['id'], _0x5f2227 = await _0x4cfca9(_0xd86588); if (_0x5f2227) { if ('EAAxj' === 'EAAxj') { const _0x44dd48 = _0x5f2227['match'](/```(?:json)?\s*([\s\S]*?)\s*```/), _0x40f5b2 = _0x44dd48 ? _0x44dd48[0x1]['trim']() : _0x5f2227[_0x47f272(0x44c)](); if (!_0x40f5b2) continue; let _0x475c06 = null; try { if (_0x47f272(0x823) !== _0x47f272(0x823)) { const _0x15a0d8 = _0x55038['transaction'](_0x4b3903, _0x47f272(0x72d)), _0x223d57 = _0x15a0d8[_0x47f272(0x387)](_0xc69ada), _0x4e23f6 = _0x223d57[_0x47f272(0x412)](); _0x4e23f6[_0x47f272(0x7b4)] = () => _0x91839d(_0x4e23f6[_0x47f272(0x774)]), _0x4e23f6['onerror'] = () => _0x55c135(_0x4e23f6[_0x47f272(0x27b)]); } else _0x475c06 = JSON['parse'](_0x40f5b2); } catch (_0x3e4d01) { if (_0x47f272(0x68f) !== _0x47f272(0x6fb)) { console[_0x47f272(0x4ca)]('JSON解析失败\x20(' + _0x760687['id'] + ')，启动兼容模式...', _0x3e4d01[_0x47f272(0x722)]); try { _0x475c06 = _0x1360bd(_0x40f5b2); if (!_0x475c06) throw new Error('YAML翻译机也无法理解这段梦话。'); console[_0x47f272(0x754)]('兼容模式成功，已将\x20' + _0x760687['id'] + _0x47f272(0x8b5)); } catch (_0x1652df) { throw _0x3e4d01; } } else _0x179fa1 = new _0x57a3af(_0x57b737[_0x47f272(0x68e)][_0x47f272(0x276)](null, _0x4a6f56)), _0xc86104 = _0x3db0ec[_0x47f272(0xb18)](_0x47f272(0x2e3), { 'dateStyle': _0x47f272(0x91d), 'timeStyle': _0x47f272(0xa90) }); } if (Array[_0x47f272(0x75c)](_0x475c06) && _0x475c06[_0x47f272(0xaa7)] > 0x0) { _0x48233e === '' && (_0x48233e += _0x47f272(0x7fc)); _0x48233e += _0x47f272(0x9ac) + _0x760687[_0x47f272(0x499)] + '\x0a'; switch (_0x760687['id']) { case _0x47f272(0x2cc): _0x475c06[_0x47f272(0x201)](_0x13193d => { const _0x432528 = _0x47f272; _0x48233e += _0x432528(0x5d7) + _0x13193d[_0x432528(0x7ab)] + _0x432528(0xbb9); }); break; case _0x47f272(0x447): _0x475c06[_0x47f272(0x201)](_0x4b4e77 => { const _0x4b7883 = _0x47f272; if (_0x4b7883(0x9b2) !== _0x4b7883(0x9b2)) _0xd271c3 = _0xf469ad['userProfiles']['find'](_0x259c5d => _0x259c5d['id'] === _0x43d680[_0x4b7883(0xabe)]) || _0x597977[_0x4b7883(0x613)][0x0]; else { _0x48233e += _0x4b7883(0xb14) + _0x4b4e77[_0x4b7883(0x7c7)] + _0x4b7883(0x7bf) + _0x4b4e77['last_message_preview'] + '”。\x0a'; if (_0x4b4e77[_0x4b7883(0x754)] && Array[_0x4b7883(0x75c)](_0x4b4e77[_0x4b7883(0x754)])) { if (_0x4b7883(0xb33) !== _0x4b7883(0xb33)) { const _0x2945fb = _0x5046f5[_0x4b7883(0x6b7)][_0x4b7883(0xa68)](_0x4d1da7 => _0x4d1da7['id'] === _0x22cbe9); if (!_0x2945fb || _0x2945fb[_0x4b7883(0x318)] !== 'group') return; _0x14eba2[_0x4b7883(0x8f3)](_0x4b7883(0x3ca))[_0x4b7883(0xa35)] = _0x2945fb['name'] || '', _0x291208(_0x4b7883(0x83f)), _0x3b3458[_0x4b7883(0x8f3)]('group-settings-bind-user')[_0x4b7883(0xa35)] = _0x2945fb[_0x4b7883(0x38d)] || _0x2e23f6[_0x4b7883(0xabe)]; const _0x1729f9 = _0x2ec223[_0x4b7883(0x8f3)]('group-world-book-checkboxes'); _0x1729f9[_0x4b7883(0x82c)] = '', _0x12b604[_0x4b7883(0x432)][_0x4b7883(0x201)](_0x2573e7 => { const _0x1a978a = _0x4b7883, _0x3e3b8e = _0x2945fb[_0x1a978a(0xae1)]?.[_0x1a978a(0x8db)](_0x2573e7['id']), _0x2e48a3 = _0x53ab58[_0x1a978a(0xb35)](_0x1a978a(0x4eb)); _0x2e48a3[_0x1a978a(0x82c)] = _0x1a978a(0x5f2) + _0x2573e7['id'] + '\x22\x20' + (_0x3e3b8e ? _0x1a978a(0x875) : '') + '>\x20' + _0x2573e7['name'], _0x1729f9[_0x1a978a(0x3bf)](_0x2e48a3); }), _0x55a3e1(); const _0x4a2f44 = _0x390861[_0x4b7883(0x8f3)]('group-avatar-preview'), _0x474fc4 = _0x237f01['getElementById'](_0x4b7883(0x8f4)); _0x474fc4['style'][_0x4b7883(0xaa3)] = '', _0x4033e2(_0x4b7883(0x7c9) + _0x281605)['then'](_0x5be474 => { const _0x3b82a3 = _0x4b7883; _0x4a2f44['src'] = _0x5be474 ? _0x18fc12[_0x3b82a3(0x64d)](_0x5be474) : _0x45d81d; }), _0x17ce7c(_0x4b7883(0x20c) + _0xfae599)[_0x4b7883(0xad3)](_0x2dd792 => { const _0x286c1e = _0x4b7883; if (_0x2dd792) _0x474fc4[_0x286c1e(0x3e0)]['backgroundImage'] = _0x286c1e(0x4c6) + _0x2c3701['createObjectURL'](_0x2dd792) + '\x27)'; }), _0x4533e7('groupSettings', _0x4b7883(0x780)); } else _0x48233e += _0x4b7883(0x474), _0x4b4e77['log'][_0x4b7883(0x201)](_0x42136b => { const _0x29bb12 = _0x4b7883; if (_0x29bb12(0xadb) === _0x29bb12(0x2dc)) { const _0x102a9b = _0x3d31eb(_0x4fa064[_0x29bb12(0xb40)]['historyIndex'], 0xa); !_0x1b1be1(_0x102a9b) && _0x46b3bb(_0x102a9b); } else { const _0x2df11f = _0x42136b[_0x29bb12(0xa6e)] === 'character' ? '你' : _0x4b4e77[_0x29bb12(0x7c7)]; _0x48233e += _0x29bb12(0x82e) + _0x2df11f + ':\x20' + _0x42136b[_0x29bb12(0x5e2)] + '\x0a'; } }); } } }); break; case 'abyss': _0x475c06[_0x47f272(0x201)](_0x5228c9 => { const _0x16fd62 = _0x47f272; _0x48233e += '-\x20你曾经搜索过：“' + _0x5228c9[_0x16fd62(0x99c)] + _0x16fd62(0xbb9); }); break; case _0x47f272(0x701): _0x475c06['forEach'](_0x5bdd64 => { const _0x5e2ca0 = _0x47f272; if (_0x5e2ca0(0xa83) === _0x5e2ca0(0xa83)) _0x48233e += _0x5e2ca0(0x45b) + _0x5bdd64['title'] + _0x5e2ca0(0x7ba) + _0x5bdd64[_0x5e2ca0(0x5e2)][_0x5e2ca0(0x915)](/\n/g, '\x20') + _0x5e2ca0(0xbb9); else { const _0x9aa59e = _0xa8174f(); _0x9aa59e && _0x9aa59e['activeListenSession'] && _0x9aa59e['activeListenSession'][_0x5e2ca0(0x4f9)] && (_0xe33042['style'][_0x5e2ca0(0xab9)] = _0x5e2ca0(0x47f), _0x28ac37(() => _0x4337e2['classList'][_0x5e2ca0(0x6dd)](_0x5e2ca0(0x530)), 0xa)); } }); break; case 'bites': _0x475c06['forEach'](_0x1bd064 => { const _0x22b6f2 = _0x47f272; 'BovVd' !== _0x22b6f2(0x3b5) ? (_0x3f2502['src'] = _0x50784b['createObjectURL'](_0x4bfa92), _0x47346d[_0x22b6f2(0x3e0)]['display'] = _0x22b6f2(0x5ac)) : _0x48233e += _0x22b6f2(0x7f4) + _0x1bd064[_0x22b6f2(0xb17)] + _0x22b6f2(0x7bc) + _0x1bd064[_0x22b6f2(0xa77)][_0x22b6f2(0x6cf)]('、') + '。\x0a'; }); break; case _0x47f272(0x5b8): _0x475c06['forEach'](_0x1bc9f8 => { const _0x47b976 = _0x47f272; if ('zPkKt' === _0x47b976(0x4e7)) _0x48233e += _0x47b976(0x75d) + _0x1bc9f8['store_name'] + _0x47b976(0x1f6) + _0x1bc9f8[_0x47b976(0x77c)] + _0x47b976(0xbb9); else { let _0x1a4fd2 = null; const _0x1f92cf = _0x469e87['chats'][_0x47b976(0x3cf)](_0x43cd3e => _0x43cd3e['participantIds'][_0x47b976(0x8db)](_0x19ab56)); for (const _0x2f150b of _0x1f92cf) { const _0x1884ab = _0x3a5cd1(_0x2f150b['id']); if (_0x1884ab && _0x1884ab[_0x47b976(0xaa7)] > 0x0) { const _0x3dc6e5 = _0x1884ab[_0x1884ab[_0x47b976(0xaa7)] - 0x1]; (!_0x1a4fd2 || _0x3dc6e5[_0x47b976(0xa71)] > _0x1a4fd2[_0x47b976(0xa71)]) && (_0x1a4fd2 = _0x3dc6e5); } } return _0x1a4fd2; } }); break; case _0x47f272(0xba3): _0x475c06[_0x47f272(0x201)](_0x1c9f68 => { const _0x2c46c0 = _0x47f272; _0x48233e += '-\x20你最近去过：“' + _0x1c9f68['location_name'] + _0x2c46c0(0x2b8) + _0x1c9f68[_0x2c46c0(0xa40)] + _0x2c46c0(0xbb9); }); break; default: _0x475c06[_0x47f272(0x201)](_0x2af223 => { const _0x51a0db = _0x47f272; _0x48233e += '-\x20' + JSON[_0x51a0db(0x269)](_0x2af223) + '\x0a'; }); break; } } } else _0x36ea42['getElementById'](_0x47f272(0x59c))['value'] = '', _0x2d9f35['getElementById']('user-profile-edit-title')[_0x47f272(0x1cd)] = _0x47f272(0x7f8), _0xf7ff39[_0x47f272(0x8f3)](_0x47f272(0xad2))['value'] = _0x47f272(0x82b) + (_0x804c55[_0x47f272(0x613)]['length'] + 0x1), _0x4347cc[_0x47f272(0x3e0)]['backgroundImage'] = _0x47f272(0x4c6) + _0x42448b + '\x27)', _0x26c8cd[_0x47f272(0x8f3)](_0x47f272(0x853))[_0x47f272(0xa35)] = '', _0x25ee5e[_0x47f272(0x3e0)][_0x47f272(0xab9)] = _0x47f272(0x1bf), _0x339e74[_0x47f272(0x8f3)](_0x47f272(0x9a7))[_0x47f272(0x3e0)]['display'] = _0x47f272(0x1bf); } } catch (_0x5a47f2) { console[_0x47f272(0x27b)](_0x47f272(0xa9a) + _0x760687['id'] + ')，已跳过。这不应该发生，数据库可能已损坏。', _0x5a47f2); } } return _0x48233e; } function _0x5ac732(_0x58f81e) { const _0x21f8af = _0x234a7d; if (!Array[_0x21f8af(0x75c)](_0x58f81e)) return _0x21f8af(0x6aa); if (_0x58f81e[_0x21f8af(0xaa7)] === 0x0) return _0x21f8af(0x677); return _0x21f8af(0x971) + _0x58f81e[_0x21f8af(0x7c6)]((_0x595944, _0x4b8ffd) => _0x21f8af(0x4e2) + (_0x4b8ffd < _0x58f81e[_0x21f8af(0xaa7)] - 0x1 ? _0x21f8af(0x46b) : '') + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22width:\x2060px;\x20height:\x2060px;\x20background-color:\x20#eee;\x20border-radius:\x208px;\x20font-size:\x202rem;\x20flex-shrink:\x200;\x22>🖼️</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22\x20style=\x22margin-top:\x202px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x0a<div\x20class=\x22char-remark\x22\x20style=\x22white-space:\x20normal;\x20line-height:\x201.6;\x22>' + (_0x595944[_0x21f8af(0x7ab)] || _0x21f8af(0x876)) + _0x21f8af(0x6df) + (_0x595944[_0x21f8af(0xa71)] || '') + _0x21f8af(0xa94))[_0x21f8af(0x6cf)]('') + '</div>'; } function _0x76680a(_0xfd4f66, _0x5b85b6) { const _0x4884bb = _0x234a7d; if (!Array[_0x4884bb(0x75c)](_0xfd4f66) || _0xfd4f66[_0x4884bb(0xaa7)] === 0x0) return _0x4884bb(0x752); return '<div\x20style=\x22background:\x20var(--card-bg);\x20border-radius:\x2012px;\x20overflow:\x20hidden;\x20border:\x201px\x20solid\x20var(--border-color);\x22>' + _0xfd4f66[_0x4884bb(0x7c6)]((_0x331038, _0x1b6bc0) => { const _0x3d462c = _0x4884bb, _0x199fb7 = JSON[_0x3d462c(0x269)](_0x331038['log'] || [])[_0x3d462c(0x915)](/'/g, _0x3d462c(0x4d5))[_0x3d462c(0x915)](/"/g, _0x3d462c(0x840)), _0x4dbc53 = _0x331038[_0x3d462c(0x7c7)] || _0x3d462c(0x6b6); return _0x3d462c(0x215) + (_0x1b6bc0 < _0xfd4f66['length'] - 0x1 ? _0x3d462c(0x46b) : '') + '\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-log=\x27' + _0x199fb7 + _0x3d462c(0x545) + _0x4dbc53 + _0x3d462c(0x953) + _0x5b85b6 + _0x3d462c(0x827) + _0x4dbc53['charAt'](0x0) + _0x3d462c(0x610) + _0x4dbc53 + _0x3d462c(0xaed) + (_0x331038[_0x3d462c(0x385)] || '') + _0x3d462c(0xa00); })[_0x4884bb(0x6cf)]('') + _0x4884bb(0x806); } function _0x1f48c9(_0x68129d) { const _0x2c2357 = _0x234a7d; if (!Array[_0x2c2357(0x75c)](_0x68129d)) return _0x2c2357(0x6aa); if (_0x68129d[_0x2c2357(0xaa7)] === 0x0) return _0x2c2357(0x93e); return _0x68129d[_0x2c2357(0xb71)]((_0x377ef5, _0x5b120b) => new Date(_0x5b120b[_0x2c2357(0xa71)]) - new Date(_0x377ef5[_0x2c2357(0xa71)])), _0x2c2357(0x971) + _0x68129d[_0x2c2357(0x7c6)]((_0x132ecd, _0x4acb2b) => '\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22padding:\x2015px;\x20' + (_0x4acb2b < _0x68129d[_0x2c2357(0xaa7)] - 0x1 ? 'border-bottom:\x201px\x20solid\x20var(--border-color);' : '') + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x20font-weight:\x20500;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20var(--text-color-light);\x22>🔍</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>' + (_0x132ecd[_0x2c2357(0x99c)] || _0x2c2357(0xa06)) + _0x2c2357(0x836) + (_0x132ecd[_0x2c2357(0x695)] || _0x2c2357(0x39d)) + _0x2c2357(0x400) + (_0x132ecd[_0x2c2357(0xa71)] || '') + _0x2c2357(0x1de))[_0x2c2357(0x6cf)]('') + '</div>'; } function _0x1b62ed(_0x57be43) { const _0x433efc = _0x234a7d; if (!Array['isArray'](_0x57be43)) return _0x433efc(0x6aa); if (_0x57be43[_0x433efc(0xaa7)] === 0x0) return '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x22>备忘录是空的。</p>'; return _0x57be43[_0x433efc(0xb71)]((_0x3324b7, _0x10645d) => new Date(_0x10645d[_0x433efc(0x7e7)]) - new Date(_0x3324b7['last_edited'])), _0x57be43[_0x433efc(0x7c6)](_0x4417d3 => _0x433efc(0x5b6) + (_0x4417d3[_0x433efc(0x773)] || _0x433efc(0x998)) + _0x433efc(0x49a) + (_0x4417d3['content'] || '') + _0x433efc(0x4a2) + (_0x4417d3['last_edited'] || '') + _0x433efc(0xa03))[_0x433efc(0x6cf)](''); } function _0x49292e(_0x58d71d) { const _0x4f5997 = _0x234a7d; if (_0x4f5997(0x363) !== _0x4f5997(0x7fa)) { if (!Array[_0x4f5997(0x75c)](_0x58d71d)) return _0x4f5997(0x6aa); if (_0x58d71d[_0x4f5997(0xaa7)] === 0x0) return _0x4f5997(0x9a5); return _0x58d71d['sort']((_0xf27771, _0x378f75) => new Date(_0x378f75[_0x4f5997(0xa71)]) - new Date(_0xf27771[_0x4f5997(0xa71)])), _0x58d71d[_0x4f5997(0x7c6)](_0x59fb70 => { const _0x30c48d = _0x4f5997, _0x185c5b = (_0x59fb70[_0x30c48d(0xa77)] || [])[_0x30c48d(0x7c6)](_0xc16122 => _0x30c48d(0x8c5) + _0xc16122 + _0x30c48d(0x52c))[_0x30c48d(0x6cf)](''); return _0x30c48d(0x679) + (_0x59fb70[_0x30c48d(0xb17)] || _0x30c48d(0x862)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22font-size:\x200.75rem;\x22>' + (_0x59fb70[_0x30c48d(0xa71)] || '') + _0x30c48d(0x945) + (_0x59fb70['status'] || _0x30c48d(0x732)) + _0x30c48d(0xb52) + _0x185c5b + _0x30c48d(0x723) + (_0x59fb70['total_cost'] || 0x0)[_0x30c48d(0xaeb)](0x2) + _0x30c48d(0x2d0); })[_0x4f5997(0x6cf)](''); } else { if (_0x10e81a[_0x4f5997(0x48e)]['closest'](_0x4f5997(0x517))) return; const _0xc559c4 = _0x6e188[_0x4f5997(0x8f3)](_0x4f5997(0x458)); _0xc559c4 && _0xc559c4['click'](); } } function _0x37e17f(_0x243514) { const _0x6d3a9d = _0x234a7d; if (!Array[_0x6d3a9d(0x75c)](_0x243514)) return '<p>格式错误</p>'; if (_0x243514[_0x6d3a9d(0xaa7)] === 0x0) return _0x6d3a9d(0x32b); return _0x243514[_0x6d3a9d(0xb71)]((_0x195e01, _0x18edd2) => new Date(_0x18edd2['timestamp']) - new Date(_0x195e01[_0x6d3a9d(0xa71)])), _0x243514[_0x6d3a9d(0x7c6)](_0x8ed323 => _0x6d3a9d(0x888) + (_0x8ed323[_0x6d3a9d(0x41f)] || '未知商店') + _0x6d3a9d(0x5b1) + (_0x8ed323[_0x6d3a9d(0xa71)] || '') + _0x6d3a9d(0x3ba) + (_0x8ed323['item_name'] || _0x6d3a9d(0x9ea)) + _0x6d3a9d(0xaf6) + (_0x8ed323['cost'] || 0x0)[_0x6d3a9d(0xaeb)](0x2) + _0x6d3a9d(0xad8))['join'](''); } function _0xd32d76(_0x30d671) { const _0x466230 = _0x234a7d; if (!Array[_0x466230(0x75c)](_0x30d671)) return _0x466230(0x6aa); if (_0x30d671[_0x466230(0xaa7)] === 0x0) return _0x466230(0x1e7); return _0x30d671[_0x466230(0xb71)]((_0x261a73, _0x4d4465) => new Date(_0x4d4465[_0x466230(0xa71)]) - new Date(_0x261a73[_0x466230(0xa71)])), _0x466230(0x27f) + _0x30d671[_0x466230(0x7c6)](_0xc4baf => _0x466230(0xb9d) + (_0xc4baf[_0x466230(0x88e)] || '未知地点') + _0x466230(0x233) + (_0xc4baf[_0x466230(0xa40)] || '') + _0x466230(0x95d) + (_0xc4baf[_0x466230(0xa71)] || '') + _0x466230(0x4e3))[_0x466230(0x6cf)]('') + '</div>'; } async function _0x41ae7e(_0x5a7f9b, _0x187504, _0x2e10ca = null) { const _0x1bb88f = _0x234a7d; if ('opvrG' === _0x1bb88f(0x576)) { const _0x2e0831 = _0x11feaf(_0x187504), _0x4ab5e5 = _0x2de116[_0x1bb88f(0x6b7)]['find'](_0x4465f6 => _0x4465f6[_0x1bb88f(0x318)] === _0x1bb88f(0x2c0) && _0x4465f6['participantIds'][_0x1bb88f(0x8db)](_0x187504)), _0x3458e7 = _0x41382f(_0x4ab5e5?.['id'] || _0x2de116[_0x1bb88f(0xb7c)]); if (!_0x2e0831) throw new Error(_0x1bb88f(0x531)); const { omniText: _0x469e23 } = _0x888912(_0x187504); let _0x14b487 = ''; const _0x6fd124 = new Date(); let _0x3e644f = null, _0x26e157 = '无'; if (_0x2e10ca) { if ('msxdo' === _0x1bb88f(0xb60)) try { if (_0x1bb88f(0x1f8) === _0x1bb88f(0x682)) _0x2e35bc(), _0x3933f5(_0x1bb88f(0x4ab), _0x1bb88f(0x780)); else { const _0x5c6fd5 = JSON[_0x1bb88f(0x57f)](_0x2e10ca); if (Array[_0x1bb88f(0x75c)](_0x5c6fd5) && _0x5c6fd5['length'] > 0x0) { const _0x5595b8 = _0x5c6fd5[_0x1bb88f(0x7c6)](_0x1577bd => new Date(_0x1577bd[_0x1bb88f(0xa71)] || _0x1577bd[_0x1bb88f(0x7e7)]))[_0x1bb88f(0x3cf)](_0x48fcfe => !isNaN(_0x48fcfe)); _0x5595b8['length'] > 0x0 && (_0x3e644f = new Date(Math['max']['apply'](null, _0x5595b8)), _0x26e157 = _0x3e644f[_0x1bb88f(0xb18)](_0x1bb88f(0x2e3), { 'dateStyle': _0x1bb88f(0x91d), 'timeStyle': 'short' })); } } } catch (_0x4e5336) { console['warn'](_0x1bb88f(0x4b7), _0x4e5336); } else _0x3f363b[_0x1bb88f(0x8f3)]('snoop-app-view-container')[_0x1bb88f(0x3e0)][_0x1bb88f(0xab9)] = _0x1bb88f(0x1bf), _0x5e23d5(_0x1bb88f(0x73d), 'snoopPhone'); } const _0x170c3e = _0x5d182c(_0x187504); _0x14b487 = _0x1bb88f(0x772), _0x14b487 += _0x1bb88f(0x51b) + _0x6fd124[_0x1bb88f(0xb18)]('zh-CN', { 'dateStyle': _0x1bb88f(0x542), 'timeStyle': _0x1bb88f(0xa90) }) + '\x0a'; if (_0x170c3e) { const _0x10f404 = new Date(_0x170c3e[_0x1bb88f(0xa71)]), _0x49091e = _0x4f5166(_0x10f404); _0x14b487 += _0x1bb88f(0x23a) + _0x49091e + '\x0a'; const _0x2ca873 = _0x6fd124[_0x1bb88f(0x5bc)](), _0x208d53 = _0x10f404['toDateString'](), _0x4a86ef = new Date(); _0x4a86ef[_0x1bb88f(0xb25)](_0x6fd124[_0x1bb88f(0x6b8)]() - 0x1); const _0x48eee6 = _0x4a86ef[_0x1bb88f(0x5bc)](); if (_0x2ca873 === _0x208d53) { if ('UyjhR' === _0x1bb88f(0x5fb)) { const _0x35b0cf = (_0x6fd124 - _0x10f404) / (0x3e8 * 0x3c); _0x35b0cf < 0x3c ? _0x14b487 += '-\x20**状态提示**:\x20你的生活正在进行中，生成的内容应该是“刚才”或“几分钟前”发生的。\x0a' : _0x14b487 += '-\x20**状态提示**:\x20你上一次活动是在' + Math['round'](_0x35b0cf / 0x3c) + _0x1bb88f(0x690); } else _0xc1957b = _0x289e8d[0x1]; } else { if (_0x48eee6 === _0x208d53) _0x14b487 += _0x1bb88f(0x4da); else { const _0x2a5731 = Math[_0x1bb88f(0x8d6)]((_0x6fd124 - _0x10f404) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x14b487 += '-\x20**状态提示**:\x20你已经有\x20' + _0x2a5731 + _0x1bb88f(0x796); } } } else _0x14b487 += _0x1bb88f(0x91e); let _0x50b9a3 = '', _0x287f9b = ''; _0x2e10ca ? (_0x50b9a3 = _0x1bb88f(0x34a), _0x287f9b = _0x1bb88f(0x94e) + _0x2e10ca + '\x0a```') : _0x1bb88f(0x424) !== 'egFpQ' ? _0x439eb1[_0x1bb88f(0x44f)](_0xd09efc, { 'songName': _0x4ad9d9, 'artist': _0x2b5d80, 'coverId': null, 'playableUrl': null }) : _0x50b9a3 = _0x1bb88f(0x9f4); const _0x1346e9 = { 'gallery': '\x0a#\x20任务:\x20生成相册内容\x0a根据角色的近期经历、人际关系和隐藏性格，生成3\x20-\x205张照片的文字描述。重点是，照片内容要能引发联想，暗示一些用户不知道的事件。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22id\x22:\x20\x22photo_1725123456\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22description\x22:\x20\x22一张在海边拍的黄昏照片，照片里有一个模糊的、看不清脸的背影。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-24\x2018:30\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'whispers': _0x1bb88f(0x8dd), 'abyss': '\x0a#\x20任务:\x20生成浏览器记录\x0a生成5\x20-\x207条足以暴露角色当前真实想法、困惑或兴趣的搜索历史记录。并且，为每一条历史记录，生成一段模拟的“搜索结果页”摘要。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22query\x22:\x20\x22一个人过生日怎么庆祝\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-23\x2022:15\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22result_page_content\x22:\x20\x22【热门回答】一个人的生日也可以充满仪式感！推荐尝试独自旅行...\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'fragments': '\x0a#\x20任务:\x20生成备忘录内容\x0a生成2\x20-\x203个简短的备忘录。内容必须多样化，足以体现角色的生活细节和内心世界。可以是购物清单、几句没头没尾的歌词、一个地址、或者一段练习如何道歉的草稿。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22title\x22:\x20\x22要买的东西\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22content\x22:\x20\x22-\x20牛奶\x5cn-\x20猫粮（快没了！）\x5cn-\x20《仿生人会梦见电子羊吗？》\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22last_edited\x22:\x20\x222025-09-25\x2009:10\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'bites': '\x0a#\x20任务:\x20生成外卖订单记录\x0a生成最近的2\x20-\x203条外卖订单。订单内容必须严格符合角色的设定、作息和财务状况。订单时间也要和他的生活轨迹对得上。一些比较幻想风格的角色可以用更加符合角色背景的内容风格，需要符合角色的时代和世界观背景。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22restaurant_name\x22:\x20\x22深夜食堂\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22items\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22肥牛饭\x20x1\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22冰可乐\x20x1\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20],\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22total_cost\x22:\x2025.00,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22status\x22:\x20\x22订单已送达\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-24\x2023:45\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'wants': _0x1bb88f(0xad7), 'footprints': _0x1bb88f(0x71f) }, _0x5afcaf = _0x1346e9[_0x5a7f9b] || _0x1bb88f(0x37a) + _0x5a7f9b + _0x1bb88f(0x7d6); let _0x3a44ab = ''; if (_0x2e0831[_0x1bb88f(0xae1)] && _0x2e0831['linkedWorldBookIds'][_0x1bb88f(0xaa7)] > 0x0) { if (_0x1bb88f(0x401) !== _0x1bb88f(0x56c)) { const _0x234034 = _0x2e0831[_0x1bb88f(0xae1)][_0x1bb88f(0x7c6)](_0x43b2a6 => _0x2de116['worldBooks']['find'](_0x28f12f => _0x28f12f['id'] === _0x43b2a6))['filter'](Boolean)[_0x1bb88f(0x7c6)](_0x271d30 => _0x1bb88f(0x464) + _0x271d30[_0x1bb88f(0x499)] + '\x0a' + _0x271d30[_0x1bb88f(0x5e2)])[_0x1bb88f(0x6cf)](''); _0x234034 && (_0x3a44ab = _0x1bb88f(0x343) + _0x234034); } else return _0x4bdf39(_0x2feb27)[_0x1bb88f(0xad3)](_0x13d631 => _0x13d631[_0x1bb88f(0x1d6)]()); } const _0x18ef1d = _0x1bb88f(0x4db) + _0x2e0831[_0x1bb88f(0x499)] + _0x1bb88f(0x36d) + _0x2e0831['name'] + _0x1bb88f(0x6c4) + _0x3458e7[_0x1bb88f(0x499)] + _0x1bb88f(0x266) + _0x26e157 + '\x0a-\x20当前精确时间:\x20' + _0x6fd124['toLocaleString'](_0x1bb88f(0x2e3), { 'dateStyle': _0x1bb88f(0x542), 'timeStyle': _0x1bb88f(0xa90) }) + _0x1bb88f(0xb04) + _0x2e0831[_0x1bb88f(0x499)] + _0x1bb88f(0xaa2) + _0x2e0831[_0x1bb88f(0x44a)] + '\x0a' + _0x3a44ab + _0x1bb88f(0x4fe) + _0x3458e7[_0x1bb88f(0x499)] + _0x1bb88f(0xaa2) + _0x3458e7[_0x1bb88f(0x44a)] + _0x1bb88f(0x6b5) + _0x469e23 + '\x0a' + _0x287f9b + _0x1bb88f(0x6cc) + _0x50b9a3 + '\x0a' + _0x5afcaf + '\x0a\x0a#\x20最终指令\x0a请严格遵守所有协议，完成你的任务。你的输出【必须】是、也【只能】是一个遵循\x20JSON\x20格式的、完整的数组字符串。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', _0x346464 = [{ 'role': _0x1bb88f(0x456), 'content': _0x18ef1d }], _0x37cc05 = await _0x4df70c(_0x346464, { 'json': !![] }); return _0x37cc05; } else _0x1fb6a5[_0x1bb88f(0x1cd)] = _0x598268[_0x1bb88f(0x499)], _0x29c0f4[_0x1bb88f(0x1cd)] = _0x1bb88f(0x6de), _0x6ce799(_0x46fe0b, _0x1bb88f(0x388)); } async function _0x12bb4c(_0x475e6e) { const _0xd788a0 = _0x234a7d; if ('VYDvm' === 'HpdjW') { const _0x5402a8 = _0xd788a0(0x9e9); _0x39aa1d = _0xd788a0(0xb1c) + _0x406b5d[_0xd788a0(0x499)] + '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[' + _0x5402a8 + _0xd788a0(0x4a4) + _0x254d97[_0xd788a0(0x499)] + _0xd788a0(0x620) + _0x5402a8 + _0xd788a0(0x5a0) + _0x5402a8 + _0xd788a0(0x9a9); } else { const _0x1c7662 = _0x11feaf(_0x475e6e); if (!_0x1c7662) throw new Error(_0xd788a0(0x97c)); _0xc9067c(!![], '正在翻阅所有档案...'); const _0x1ed56e = [_0xd788a0(0x2cc), 'whispers', _0xd788a0(0x673), _0xd788a0(0x701), _0xd788a0(0x7e3), 'wants', _0xd788a0(0xba3)]; let _0x590603 = {}; await Promise[_0xd788a0(0x304)](_0x1ed56e['map'](async _0x4cf1ea => { const _0x42762d = _0xd788a0, _0x3663f0 = _0x42762d(0x41a) + _0x475e6e + '_' + _0x4cf1ea, _0x125aa6 = await _0x4cfca9(_0x3663f0); if (_0x125aa6) try { if (_0x42762d(0xa4f) !== _0x42762d(0xa4f)) { const _0x133f26 = _0x455319[_0x42762d(0xa05)][_0x42762d(0xa68)](_0x2179d3 => _0x2179d3['id'] === _0xc7a46c[_0x42762d(0x42d)]), _0x1f113c = _0x133f26?.['boundUserProfileId']; let _0x2ecd25 = _0xea7a06[_0x42762d(0x613)]['find'](_0xdc7a67 => _0xdc7a67['id'] === _0x1f113c); !_0x2ecd25 && (_0x2ecd25 = _0x353d3b[_0x42762d(0x613)][_0x42762d(0xa68)](_0x576e63 => _0x576e63['id'] === _0x54c837[_0x42762d(0xabe)])), !_0x2ecd25 && (_0x2ecd25 = _0x2fe0f2[_0x42762d(0x613)][0x0]), _0x2ecd25 && (_0x202862[_0x42762d(0x8f3)]('user-post-avatar')[_0x42762d(0xa9c)] = _0x2ecd25['avatar'] || _0x4a417d); } else _0x590603[_0x4cf1ea] = JSON[_0x42762d(0x57f)](_0x125aa6); } catch (_0x187b3a) { } })); if (Object[_0xd788a0(0xa8f)](_0x590603)[_0xd788a0(0xaa7)] === 0x0) { if (_0xd788a0(0x638) === _0xd788a0(0x520)) _0x32ee87[_0xd788a0(0x27b)](_0xd788a0(0xbaf), _0x5d23f9), _0x7c7136[_0xd788a0(0xa35)] = _0xd788a0(0xb9e) + _0x2290dc[_0xd788a0(0x722)]; else return _0xd788a0(0x7b8); } const _0x497d53 = '\x0a#\x20核心任务:\x20档案馆书记官\x0a你的任务是为一个名为“' + _0x1c7662[_0xd788a0(0x499)] + _0xd788a0(0x327), _0x4b7441 = [{ 'role': _0xd788a0(0x456), 'content': _0x497d53 }, { 'role': _0xd788a0(0x7da), 'content': JSON['stringify'](_0x590603, null, 0x2) }]; _0xc9067c(!![], _0xd788a0(0x89c)); const _0x3092aa = await _0x4df70c(_0x4b7441); return _0x3092aa || _0xd788a0(0x7c1); } } async function _0x12bb4c(_0x1c8406) { const _0x121828 = _0x234a7d; if (_0x121828(0xa51) === _0x121828(0xa51)) { const _0x103e21 = _0x11feaf(_0x1c8406); if (!_0x103e21) throw new Error(_0x121828(0x97c)); try { if ('LGolr' !== _0x121828(0x7d9)) _0x1b46c7['currentDate'] = new _0x129608(), _0x260c0d[_0x121828(0x7ea)] = new _0x3f9783()[_0x121828(0x648)]()[_0x121828(0x500)]('T')[0x0], _0xd33603(); else { _0xc9067c(!![], _0x121828(0xbb8)); const _0x156e22 = [_0x121828(0x2cc), _0x121828(0x447), _0x121828(0x673), _0x121828(0x701), _0x121828(0x7e3), 'wants', _0x121828(0xba3)]; let _0x666420 = {}; await Promise[_0x121828(0x304)](_0x156e22[_0x121828(0x7c6)](async _0x2f8e4b => { const _0x22167e = _0x121828, _0x5f50a9 = _0x22167e(0x41a) + _0x1c8406 + '_' + _0x2f8e4b, _0x2c84e2 = await _0x4cfca9(_0x5f50a9); if (_0x2c84e2) { if (_0x22167e(0x30b) === _0x22167e(0x3e5)) { _0x174635(_0x22167e(0x80f)); return; } else try { _0x666420[_0x2f8e4b] = JSON[_0x22167e(0x57f)](_0x2c84e2); } catch (_0x39e00d) { } } })); if (Object[_0x121828(0xa8f)](_0x666420)['length'] === 0x0) return _0x121828(0x7b8); const _0xef3091 = _0x121828(0x5a9) + _0x103e21[_0x121828(0x499)] + _0x121828(0x2aa), _0x1e7d8b = [{ 'role': _0x121828(0x456), 'content': _0xef3091 }, { 'role': _0x121828(0x7da), 'content': JSON[_0x121828(0x269)](_0x666420, null, 0x2) }]; _0xc9067c(!![], _0x121828(0x89c)); const _0x56213a = await _0x4df70c(_0x1e7d8b); return _0x56213a || _0x121828(0x7c1); } } finally { if (_0x121828(0x37f) === _0x121828(0x37f)) _0xc9067c(![]); else { _0x18060f(_0x121828(0x6f5)); return; } } } else _0x2bf3e3(!![]); } document[_0x234a7d(0x8f3)](_0x234a7d(0xb68))['addEventListener'](_0x234a7d(0xbba), () => _0x2faf14(_0x234a7d(0x4ab), _0x234a7d(0x73d))), document[_0x234a7d(0x8f3)](_0x234a7d(0x9cd))[_0x234a7d(0x85f)](_0x234a7d(0xbba), () => { const _0x4f75a3 = _0x234a7d; document[_0x4f75a3(0x8f3)]('snoop-app-view-container')['style'][_0x4f75a3(0xab9)] = 'none', _0x2faf14('snoopList', _0x4f75a3(0xa22)); }), _0x3d529e(); }); async function _0x58784a() { const _0x289486 = _0x2ad71a; console['log'](_0x289486(0x7b2)), console[_0x289486(0x754)](_0x289486(0xa07)); async function _0x3ddcb7(_0x22930a, _0xfe3601) { const _0x299f32 = await _0x361ce4; return new Promise((_0x553993, _0x4e9668) => { const _0x34c1c7 = _0x4d19, _0x5b18fc = _0x299f32[_0x34c1c7(0x6c0)](_0x2ecade, _0x34c1c7(0xae4)), _0x30053f = _0x5b18fc[_0x34c1c7(0x387)](_0x2ecade), _0x5384bb = _0x30053f[_0x34c1c7(0xb30)]({ 'id': _0x22930a, 'blob': _0xfe3601 }); _0x5384bb[_0x34c1c7(0x7b4)] = () => _0x553993(_0x5384bb[_0x34c1c7(0x774)]), _0x5384bb[_0x34c1c7(0x611)] = () => _0x4e9668(_0x5384bb[_0x34c1c7(0x27b)]); }); } async function _0x593e75(_0x45b517) { const _0x2342c1 = await _0x361ce4; return new Promise((_0x2b2f20, _0xc14c92) => { const _0x27a932 = _0x4d19, _0x1c9930 = _0x2342c1[_0x27a932(0x6c0)](_0x26d9a8, _0x27a932(0x72d)), _0x51e55f = _0x1c9930[_0x27a932(0x387)](_0x26d9a8), _0x4f7c7c = _0x51e55f[_0x27a932(0xb5d)](_0x45b517); _0x4f7c7c[_0x27a932(0x7b4)] = () => _0x2b2f20(_0x4f7c7c[_0x27a932(0x774)] ? _0x4f7c7c['result'][_0x27a932(0x1fa)] : null), _0x4f7c7c[_0x27a932(0x611)] = () => _0xc14c92(_0x4f7c7c[_0x27a932(0x27b)]); }); } async function _0x141fa6(_0x556277, _0x2cc465) { const _0x2a74cd = _0x289486; if ('pdUMx' !== 'pdUMx') _0x37c496 = _0x2a74cd(0xaf3) + _0x379510['name'] + _0x2a74cd(0x943); else { const _0xf4335a = await _0x361ce4; return new Promise((_0x27620e, _0x23bd8b) => { const _0x4e9c2d = _0x2a74cd, _0x1d9105 = _0xf4335a['transaction'](_0x26d9a8, _0x4e9c2d(0xae4)), _0x31f956 = _0x1d9105[_0x4e9c2d(0x387)](_0x26d9a8), _0x86191e = _0x31f956[_0x4e9c2d(0xb30)]({ 'id': _0x556277, 'data': _0x2cc465 }); _0x86191e[_0x4e9c2d(0x7b4)] = () => _0x27620e(), _0x86191e['onerror'] = () => _0x23bd8b(_0x86191e['error']); }); } } function _0x2eac11(_0x26b72d) { const _0x2d4aa5 = _0x289486; return fetch(_0x26b72d)[_0x2d4aa5(0xad3)](_0xdec3bd => _0xdec3bd[_0x2d4aa5(0x1d6)]()); } let _0x100217 = 0x0; for (let _0x5cf464 = 0x0; _0x5cf464 < localStorage['length']; _0x5cf464++) { if (_0x289486(0x1e3) === 'SUYRu') { const _0x333480 = localStorage[_0x289486(0x64a)](_0x5cf464); if (_0x333480 && _0x333480[_0x289486(0x3df)]('chatHistory_')) { let _0x542a9c, _0x19cdbe = ![]; try { if (_0x289486(0xa9f) === _0x289486(0xa9f)) { _0x542a9c = JSON[_0x289486(0x57f)](localStorage['getItem'](_0x333480)); if (!Array['isArray'](_0x542a9c)) continue; for (const _0xcc0939 of _0x542a9c) { if (_0xcc0939 && _0xcc0939[_0x289486(0x6a9)] && _0xcc0939['image'][_0x289486(0x3df)]('data:image')) { if ('NwcZQ' !== _0x289486(0x934)) { const _0x2d6e23 = await _0x2eac11(_0xcc0939['image']), _0x604e5b = _0x289486(0x1e1) + Date[_0x289486(0x83b)]() + '_' + Math[_0x289486(0x77b)](); await _0x3ddcb7(_0x604e5b, _0x2d6e23), _0xcc0939['imageId'] = _0x604e5b, delete _0xcc0939[_0x289486(0x6a9)], _0x19cdbe = !![], _0x100217++; } else { _0x49d4da = _0x30b2fa(_0x294b8b); if (!_0x481dd7) throw new _0x2c0563(_0x289486(0xb2b)); } } } _0x19cdbe && localStorage[_0x289486(0x23c)](_0x333480, JSON[_0x289486(0x269)](_0x542a9c)); } else _0x59c0fa[_0x289486(0x27b)](_0x289486(0x7a9) + _0x3b7ccb['id'] + _0x289486(0x331), _0xb7482d), _0x363d3f[_0x289486(0xa9c)] = _0x17209c[_0x289486(0x41d)] || _0x1b7a8b; } catch (_0x5a8edc) { console['error'](_0x289486(0x30f) + _0x333480 + _0x289486(0x82d), _0x5a8edc); continue; } } } else _0x3eafd8(), _0x59c964(_0x289486(0x7ae), _0x289486(0x612)); } console[_0x289486(0x754)](_0x289486(0x980) + _0x100217 + '\x20张旧图片。'); } async function _0x9ab177() { const _0x2caa54 = _0x2ad71a; console['log'](_0x2caa54(0x4d6)), console[_0x2caa54(0x754)]('哼，正在净化你那些被污染的好友圈动态...'); async function _0x40f63b(_0x1a5bcf, _0x434f48) { const _0x3daf54 = await _0x361ce4; return new Promise((_0xd9a4b0, _0x1e725d) => { const _0x5ba750 = _0x4d19, _0x15cf56 = _0x3daf54['transaction'](_0x5ba750(0x9b3), _0x5ba750(0xae4)), _0x18bf65 = _0x15cf56[_0x5ba750(0x387)](_0x5ba750(0x9b3)), _0x304bb2 = _0x18bf65[_0x5ba750(0xb30)]({ 'id': _0x1a5bcf, 'blob': _0x434f48 }); _0x304bb2[_0x5ba750(0x7b4)] = () => _0xd9a4b0(_0x304bb2['result']), _0x304bb2[_0x5ba750(0x611)] = () => _0x1e725d(_0x304bb2['error']); }); } function _0x40331e(_0x32d764) { const _0x1b8c1f = _0x2caa54; return fetch(_0x32d764)[_0x1b8c1f(0xad3)](_0x1898cc => _0x1898cc[_0x1b8c1f(0x1d6)]()); } let _0x34065a = 0x0, _0x3dc0b1 = ![]; try { if (_0x2caa54(0x4ea) !== _0x2caa54(0x1f5)) { const _0x3b9706 = localStorage[_0x2caa54(0x54d)](_0x2caa54(0x9bb)); if (!_0x3b9706) { if (_0x2caa54(0x1db) === _0x2caa54(0x1db)) { console['log']('好友圈档案柜是空的，无需净化。'); return; } else _0x4eda41(_0x2406a1['coverId'])[_0x2caa54(0xad3)](_0x2cf7de => { const _0x2107ba = _0x2caa54, _0x45e09c = _0x519bfc['getElementById'](_0x45786c); if (_0x45e09c && _0x2cf7de) _0x45e09c['src'] = _0x4dac54[_0x2107ba(0x64d)](_0x2cf7de); }); } const _0x1e4bce = JSON[_0x2caa54(0x57f)](_0x3b9706); if (!_0x1e4bce[_0x2caa54(0xa05)] || !Array[_0x2caa54(0x75c)](_0x1e4bce[_0x2caa54(0xa05)])) return; for (const _0x312f5d of _0x1e4bce['friendCircles']) { if (_0x2caa54(0x49c) === _0x2caa54(0x49c)) { if (_0x312f5d['posts'] && Array[_0x2caa54(0x75c)](_0x312f5d['posts'])) for (const _0x1a6fcb of _0x312f5d[_0x2caa54(0x415)]) { if (_0x1a6fcb && _0x1a6fcb[_0x2caa54(0x6a9)] && _0x1a6fcb['image'][_0x2caa54(0x3df)]('data:image')) { console['log'](_0x2caa54(0x3f0) + _0x312f5d[_0x2caa54(0x499)] + _0x2caa54(0x770)); const _0x344080 = await _0x40331e(_0x1a6fcb[_0x2caa54(0x6a9)]), _0x28cb5c = _0x2caa54(0x480) + Date[_0x2caa54(0x83b)]() + '_' + Math[_0x2caa54(0x77b)](); await _0x40f63b(_0x28cb5c, _0x344080), _0x1a6fcb[_0x2caa54(0x472)] = _0x28cb5c, delete _0x1a6fcb[_0x2caa54(0x6a9)], _0x3dc0b1 = !![], _0x34065a++; } } } else _0x1de1ba = _0x499b9d[_0x2caa54(0x499)], _0x2aabc3 = _0x24b685['avatar']; } _0x3dc0b1 && (console[_0x2caa54(0x754)]('好友圈净化完成，正在重新存档...'), localStorage[_0x2caa54(0x23c)](_0x2caa54(0x9bb), JSON[_0x2caa54(0x269)](_0x1e4bce))); } else _0x448d98 += _0x2caa54(0x7b5) + _0x3d4ce0[_0x2caa54(0x99c)] + '”。\x0a'; } catch (_0x4f4baa) { console['error']('净化好友圈时出错，真是的。', _0x4f4baa); } return console['log'](_0x2caa54(0x740)), console['log']('成功净化并迁移了\x20' + _0x34065a + _0x2caa54(0x9fa)), _0x34065a; } async function _0x256b6a() { const _0x3ffee9 = _0x2ad71a; console['log']('---\x20Noir\x27s\x20Music\x20Cover\x20Purification\x20Ritual\x20---'), console[_0x3ffee9(0x754)](_0x3ffee9(0x95a)); let _0x5a7b7c = 0x0, _0x3ae32f = ![]; try { if ('DjVmS' !== _0x3ffee9(0x62b)) _0x5d72c5[_0x3ffee9(0xb16)](), _0xe80dc(); else { const _0x4b9aa1 = localStorage[_0x3ffee9(0x54d)](_0x3ffee9(0x9bb)); if (!_0x4b9aa1) return console[_0x3ffee9(0x754)](_0x3ffee9(0x619)), 0x0; for (let _0x540fc2 = 0x0; _0x540fc2 < localStorage[_0x3ffee9(0xaa7)]; _0x540fc2++) { const _0x3749f9 = localStorage[_0x3ffee9(0x64a)](_0x540fc2); if (_0x3749f9 && _0x3749f9['startsWith'](_0x3ffee9(0xb7a))) { if (_0x3ffee9(0xb2f) !== _0x3ffee9(0x5cd)) { let _0x42a4bb, _0x3041b1 = ![]; try { if (_0x3ffee9(0x5fa) === _0x3ffee9(0x48d)) _0x52b66b[_0x3ffee9(0x4f8)] = !![]; else { _0x42a4bb = JSON[_0x3ffee9(0x57f)](localStorage['getItem'](_0x3749f9)); if (!Array[_0x3ffee9(0x75c)](_0x42a4bb)) continue; for (const _0x182791 of _0x42a4bb) { if (_0x182791 && (_0x182791['type'] === _0x3ffee9(0x8be) || _0x182791[_0x3ffee9(0x318)] === _0x3ffee9(0xb2e)) && _0x182791[_0x3ffee9(0x9fd)] && _0x182791[_0x3ffee9(0x9fd)]['startsWith'](_0x3ffee9(0x295))) { const _0x2fd522 = await _0x1639b4(_0x182791[_0x3ffee9(0x9fd)]), _0x2f15e0 = _0x3ffee9(0x8cb) + Date[_0x3ffee9(0x83b)]() + '_' + Math['random'](); await _0x1d2a3c(_0x2f15e0, _0x2fd522), _0x182791['coverId'] = _0x2f15e0, delete _0x182791[_0x3ffee9(0x9fd)], _0x3041b1 = !![], _0x5a7b7c++; } } _0x3041b1 && (_0x3ffee9(0x4bb) === _0x3ffee9(0x689) ? (_0x30b0c6(![]), _0x31f7e3['isGenerating'] = ![]) : localStorage['setItem'](_0x3749f9, JSON['stringify'](_0x42a4bb))); } } catch (_0x152fdf) { console['error'](_0x3ffee9(0x30f) + _0x3749f9 + '\x20时出错，跳过。', _0x152fdf); continue; } } else _0xcdf0c5[_0x3ffee9(0xae1)] = _0x56c00c['linkedWorldBookIds'][_0x3ffee9(0x3cf)](_0x3974d9 => _0x3974d9 !== _0x427919); } } } } catch (_0x21c109) { console[_0x3ffee9(0x27b)](_0x3ffee9(0xa39), _0x21c109); } return console['log'](_0x3ffee9(0x69d)), console[_0x3ffee9(0x754)](_0x3ffee9(0x625) + _0x5a7b7c + _0x3ffee9(0x9b6)), _0x5a7b7c; } function _0x38db52() { const _0x462602 = _0x2ad71a; if (!_0x2de116[_0x462602(0xa8b)]) return _0x2de116['userProfiles'][_0x462602(0xa68)](_0x429ae3 => _0x429ae3['id'] === _0x2de116[_0x462602(0xabe)]) || _0x2de116[_0x462602(0x613)][0x0]; const _0x6e678e = _0x2de116[_0x462602(0x6b7)]['find'](_0x38e69b => _0x38e69b[_0x462602(0x318)] === _0x462602(0x2c0) && _0x38e69b[_0x462602(0x6a3)][_0x462602(0x8db)](_0x2de116[_0x462602(0xa8b)])), _0x355571 = _0x6e678e?.[_0x462602(0x38d)] || _0x2de116[_0x462602(0xabe)]; return _0x2de116[_0x462602(0x613)][_0x462602(0xa68)](_0x2af125 => _0x2af125['id'] === _0x355571) || _0x2de116['userProfiles'][0x0]; } function _0x4f5166(_0x369116) { const _0xd5f3f8 = _0x2ad71a, _0x361620 = new Date(), _0x3c06a5 = _0x361620 - _0x369116, _0x7f2fe4 = Math[_0xd5f3f8(0x8d6)](_0x3c06a5 / 0x3e8), _0x1de0de = Math['round'](_0x7f2fe4 / 0x3c), _0x55da47 = Math[_0xd5f3f8(0x8d6)](_0x1de0de / 0x3c), _0x2bd467 = Math[_0xd5f3f8(0x8d6)](_0x55da47 / 0x18), _0x3a59cb = _0x369116[_0xd5f3f8(0x700)](_0xd5f3f8(0x2e3), { 'hour': _0xd5f3f8(0x748), 'minute': '2-digit' }); if (_0x7f2fe4 < 0x3c) return '刚才'; if (_0x1de0de < 0x3c) return _0x1de0de + _0xd5f3f8(0x2a1); const _0x560202 = _0x361620['toDateString']() === _0x369116[_0xd5f3f8(0x5bc)](); if (_0x560202) return '今天\x20' + _0x3a59cb; const _0x11a96d = new Date(); _0x11a96d[_0xd5f3f8(0xb25)](_0x361620[_0xd5f3f8(0x6b8)]() - 0x1); const _0x1f5443 = _0x11a96d[_0xd5f3f8(0x5bc)]() === _0x369116[_0xd5f3f8(0x5bc)](); if (_0x1f5443) return _0xd5f3f8(0x52a) + _0x3a59cb; if (_0x2bd467 <= 0x7) { if (_0xd5f3f8(0x6c1) !== _0xd5f3f8(0x6ec)) { const _0x853854 = [_0xd5f3f8(0x2c8), _0xd5f3f8(0x67a), _0xd5f3f8(0x324), _0xd5f3f8(0x9be), '星期四', '星期五', _0xd5f3f8(0x9b7)]; return _0x853854[_0x369116['getDay']()] + '\x20' + _0x3a59cb; } else _0x3f5ae1(_0xd5f3f8(0x447), '聊天'); } return _0x369116[_0xd5f3f8(0x826)]() + '年' + (_0x369116[_0xd5f3f8(0xbbb)]() + 0x1) + '月' + _0x369116[_0xd5f3f8(0x6b8)]() + '日'; } function _0x14be18(_0x4556fe, _0x153488 = 0x320, _0x39805a = 0.8, _0x2bb958 = ![]) { return new Promise((_0x3809ff, _0x394b37) => { const _0xdcaf9b = _0x4d19; if ('nZlwZ' === 'PerQT') _0x19f472[_0xdcaf9b(0x82c)] = _0xdcaf9b(0x3b7), _0x37ffc5[_0xdcaf9b(0x8f3)]('organize-bill-button')[_0xdcaf9b(0x85f)]('click', _0x5281fb); else { if (!_0x4556fe || !_0x4556fe['type'][_0xdcaf9b(0x3df)](_0xdcaf9b(0x391))) return _0x394b37(new Error(_0xdcaf9b(0x2b3))); const _0x228acb = new FileReader(); _0x228acb['readAsDataURL'](_0x4556fe), _0x228acb[_0xdcaf9b(0x759)] = _0x42a429 => { const _0x5223a4 = _0xdcaf9b, _0x365ee8 = new Image(); _0x365ee8[_0x5223a4(0xa9c)] = _0x42a429['target'][_0x5223a4(0x774)], _0x365ee8[_0x5223a4(0x759)] = () => { const _0x1b7916 = _0x5223a4, _0x5c9c68 = document[_0x1b7916(0xb35)](_0x1b7916(0x762)); let _0x4d83de = _0x365ee8[_0x1b7916(0x96a)], _0x156a2a = _0x365ee8[_0x1b7916(0xab3)]; if (_0x4d83de > _0x156a2a) _0x4d83de > _0x153488 && (_0x1b7916(0xb45) !== _0x1b7916(0xb45) ? _0x3da65a[_0x1b7916(0xa9c)] = _0x10a5ee ? _0x205dd2['createObjectURL'](_0x551f65) : _0x32e6e4 : (_0x156a2a *= _0x153488 / _0x4d83de, _0x4d83de = _0x153488)); else { if (_0x1b7916(0xa7a) === _0x1b7916(0xa7a)) _0x156a2a > _0x153488 && (_0x1b7916(0xa43) === _0x1b7916(0xa43) ? (_0x4d83de *= _0x153488 / _0x156a2a, _0x156a2a = _0x153488) : (_0x17eb40['appendChild'](_0x2d2bd6), _0x54b0f3[_0x1b7916(0x3bf)](_0x2f9942))); else { const _0x480dbb = { 'id': _0x1b7916(0x541) + _0xd232b3[_0x1b7916(0xa71)], 'url': _0x511b41[_0x1b7916(0x788)] }; _0x4b798b(this, _0x480dbb); } } _0x5c9c68[_0x1b7916(0x96a)] = _0x4d83de, _0x5c9c68[_0x1b7916(0xab3)] = _0x156a2a; const _0x52b14e = _0x5c9c68[_0x1b7916(0x4ba)]('2d'); _0x52b14e[_0x1b7916(0x570)](_0x365ee8, 0x0, 0x0, _0x4d83de, _0x156a2a); const _0x493a8d = _0x4556fe[_0x1b7916(0x318)] === _0x1b7916(0x895) ? _0x1b7916(0x895) : _0x1b7916(0x71e); if (_0x2bb958) _0x5c9c68[_0x1b7916(0x213)](_0x3eae8b => { const _0x5c63ec = _0x1b7916; if ('fOMeD' !== 'Sfzpr') _0x3eae8b ? _0x3809ff(_0x3eae8b) : _0x394b37(new Error(_0x5c63ec(0x40f))); else { const _0x598dfb = _0xe89c37['parse'](_0x4ead22); _0x598dfb[_0x5c63ec(0x8f5)] && (_0x28db62[_0x5c63ec(0x8f5)] = _0x598dfb[_0x5c63ec(0x8f5)], _0xe07185['log'](_0x5c63ec(0x635))); } }, _0x493a8d, _0x39805a); else { if (_0x1b7916(0x793) !== _0x1b7916(0x686)) _0x3809ff(_0x5c9c68[_0x1b7916(0x555)](_0x493a8d, _0x39805a)); else { const _0x58a9a4 = _0x48679f[_0x1b7916(0x8f3)](_0x1b7916(0xb37)), _0x173ca5 = _0xa0e0a4[_0x1b7916(0x8f3)](_0x1b7916(0xb0a)), _0x2404b9 = _0x5162cd[_0x1b7916(0x8f3)](_0x1b7916(0x449)), _0x453c45 = _0xa48bac['getElementById'](_0x1b7916(0x42f)), _0x423a5f = _0x166624; _0x423a5f && _0x423a5f[_0x1b7916(0x67b)] ? (_0x173ca5[_0x1b7916(0x1cd)] = _0x423a5f[_0x1b7916(0x773)], _0x2404b9[_0x1b7916(0x1cd)] = _0x423a5f['artist'], _0x58a9a4[_0x1b7916(0x51c)][_0x1b7916(0x6dd)](_0x1b7916(0x5f9)), _0x58a9a4[_0x1b7916(0x3e0)][_0x1b7916(0x718)](_0x1b7916(0x67d), _0x1b7916(0x5ce) + _0x423a5f['cover'] + ')')) : (_0x173ca5[_0x1b7916(0x1cd)] = '暂无音乐', _0x2404b9[_0x1b7916(0x1cd)] = '请在动态或聊天中播放', _0x58a9a4[_0x1b7916(0x51c)]['remove']('is-playing'), _0x453c45[_0x1b7916(0x3e0)][_0x1b7916(0x718)]('--widget-cover-image', _0x1b7916(0x1bf))); } } }, _0x365ee8[_0x5223a4(0x611)] = _0xf3a53c => _0x394b37(_0xf3a53c); }, _0x228acb[_0xdcaf9b(0x611)] = _0x5cc240 => _0x394b37(_0x5cc240); } }); } function _0x32f36c(_0x3d0294) { return new Promise((_0x47cc65, _0x243bd5) => { const _0x418cc2 = _0x4d19; if (_0x418cc2(0x507) !== _0x418cc2(0xb46)) { const _0x508cc3 = new FileReader(); _0x508cc3[_0x418cc2(0x1b9)] = () => _0x47cc65(_0x508cc3['result']), _0x508cc3[_0x418cc2(0x611)] = _0x243bd5, _0x508cc3[_0x418cc2(0xa18)](_0x3d0294); } else _0x2e852c['avatar'] = _0xa45d34['dataset'][_0x418cc2(0x2a4)], delete _0x3d8153[_0x418cc2(0xb40)][_0x418cc2(0x2a4)]; }); } function _0x1778() { const _0x5a98a9 = ['\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20', 'string', 'touches', '加载视奸记忆失败\x20(', 'activeQuote', 'src', 'eHAck', 'BJmCU', 'rZvfH', 'header-actions', 'edit-message-button', '\x0a-\x20人设:\x20', 'backgroundImage', '升级已取消。旧版图片数据可能导致应用卡顿或出错。', '未命名群聊', 'FHuFn', 'length', '群聊至少需要2名成员。', 'dZGfO', '.no-action-modal', 'delete-expense-btn', 'form-button\x20load-more-btn', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'character-list', '错误：找不到此好友圈绑定的用户！', 'diary-next-button', 'PCRkT', 'diary-list-screen', 'height', 'gkVaI', 'GwHqO', '.choice-modal-backdrop', 'nGNcJ', '{userName}', 'display', '被萌到', 'Lbuux', 'appIconPosition_app-world-book', '兼容模式成功，已将\x20', 'activeUserProfileId', 'char-edit-persona', 'yEPmj', ']:\x20', 'tklOS', 'group-delete', '</span><span\x20class=\x22unit\x22>天</span>', 'clock-color-toggle', '用户分享音乐失败:', '音乐数据升级完成，迁移了\x20', 'querySelector', 'pointer', '动态中的音乐搜索失败:', '正在为你搬运旧壁纸到新仓库...', 'meeting-reroll-button', 'userId', '300%', 'CcnRA', 'pxYpm', '错误：找不到这首作为“信物”的歌。', 'user-name', 'then', 'rgba(255,255,255,0.2)', '薄荷水色', '确定要删除这个安排吗？此操作不可撤销。', '\x0a#\x20任务:\x20生成购物记录\x0a创建一份近期的购物清单。这些商品必须是有指向性的，而不是随便买的日用品。比如游戏、书籍、衣服等。最关键的是，这些记录必须和他\x20/\x20她的浏览器历史、备忘录、聊天内容里透露出的兴趣和秘密能够互相印证。一些比较幻想风格的角色可以用更加符合角色背景的内容风格。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22item_name\x22:\x20\x22《神经漫游者》\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22store_name\x22:\x20\x22城东旧书店\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22category\x22:\x20\x22书籍\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22cost\x22:\x2045.00,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-22\x2015:10\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', '15px\x2020px', 'day-dot', 'iPwYy', '位置已重置，正在刷新...', 'wmASS', 'json_object', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a', 'opacity', 'linkedWorldBookIds', 'dcugR', '别这样嘛我哭哭', 'readwrite', 'AVCcS', '加载第二个卡片图片失败', '”的所有动态吗？此操作不可撤销，且AI将不再记得这些内容。', 'postContent', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20', 'jbqEg', 'toFixed', '正在写入新数据...', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22\x20style=\x22white-space:\x20nowrap;\x20overflow:\x20hidden;\x20text-overflow:\x20ellipsis;\x20color:\x20var(--text-color-light);\x22>', '</svg>', 'DEvco', 'fQccm', 'quote-message-button', 'diaryCurrentPage', '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“', 'cover-file-input', '(想转账给“', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x20font-weight:\x20bold;\x20color:\x20var(--accent-color);\x20text-align:\x20right;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20-\x20¥\x20', '---\x20开始AI回复流程\x20---', '这个也是摆设，别点了。', '】的日记本已被清空。', 'world-book-checkboxes-container', '解析存档失败，正在重置:', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>', '好友圈已删除。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'className', 'zuQoj', 'Aizoa', '买新衣服', 'group-world-book-checkboxes', '\x0a-\x20【绝对指令】你生成的所有新条目，其\x20\x22timestamp\x22\x20或\x20\x22last_edited\x22\x20必须严格晚于“已有内容的最新时间点”，并且必须早于或等于“当前精确时间”。严禁创造未来的事件。\x0a\x0a#\x20角色核心资料\x0a-\x20姓名:\x20', '#meeting-view-screen\x20.chat-input-area', 'Failed\x20to\x20remove\x20history\x20for\x20chat\x20', 'CnYHF', 'AbortError', 'PtBRi', 'widget-title', 'displayedMessageCount', 'PXFaJ', '导入失败:\x20', 'nPTCB', 'tSkiF', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x20auto\x201fr;\x20width:\x20100%;\x20align-items:\x20center;\x20padding:\x200\x2010px;\x20box-sizing:\x20border-box;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-start;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-prev-button\x22>上一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22\x20style=\x22background-color:\x20var(--accent-color);\x20color:\x20white;\x22>写日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22diary-page-indicator\x22>第\x20', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>', '\x0a\x20\x20\x20\x20绑定用户:\x20', '在准备动态回复时，读取图片失败:', '-\x20你记得曾和“', 'mzsGT', 'preventDefault', 'restaurant_name', 'toLocaleString', 'add-world-book-button', 'xWnXZ', 'jTRJR', '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“', 'nkbec', '成功获取\x20', 'xoOPa', 'char_sprite_normal_', 'altar-slot-lyrics', 'reverse', '\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a', '\x20\x0a#\x20当前情景\x0a', 'setDate', 'AI似乎没有想出任何新动态。', '（对话结束）', 'ZCXky', '#friend-circle-member-selection\x20input:checked', 'QXHnI', 'AI返回了无法识别的数据格式。', 'Noir\x27s\x20Fix:\x20\x27home-screen\x27\x20element\x20not\x20found!', 'is-exiting-right', 'listen-together-invite', 'aDnkd', 'put', '刚刚发布了一条动态，内容是：“', 'mqtwt', 'PbJSd', 'reply', 'createElement', 'music-feed-container', 'music-widget-card', 'music-upload-altar-screen', 'right', 'nMemz', '歌曲“', 'RSidn', '群聊音乐搜索失败\x20(', 'clientX', '</p>', 'dataset', 'close-summary-button', 'Failed\x20to\x20save\x20history\x20to\x20localStorage:', 'body', 'EXToT', 'RTnXX', 'JpiPT', 'szRWb', 'Lyuff', 'AIzCR', '71%', 'whaJG', 'smooth', 'User', '--primary-hue', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-container\x20', 'https://sharkpan.xyz/f/wjgHq/yznfhq.jpg', '\x20张旧封面。应用即将刷新。', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22order-items-container\x22\x20style=\x22display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x204px;\x20margin-bottom:\x2012px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'array', 'WbAYl', 'https://sharkpan.xyz/f/rjpu6/ojpa0c.jpg', 'Enter', '图片处理失败:\x20', 'bubbleCss', 'CcNrV', 'jRehv', 'anthropic.com', 'ztRDV', 'get', 'chat_group_', 'bRLTn', 'msxdo', '<path\x20d=\x22M21\x2010c0\x207-9\x2013-9\x2013s-9-6-9-13a9\x209\x200\x200\x201\x2018\x200z\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2210\x22\x20r=\x223\x22></circle>', 'Yuyoq', 'galgame-sprite-adjust-ui', 'nHaZp', 'HeRqP', 'save-world-book-button', 'TUfLe', 'back-to-home-from-snoop-list', '歌名和歌手都不能为空！', '\x22>&times;</button></div>', 'lmzYt', '</div>\x0a\x20\x20\x20\x20', '浏览器历史', 'fontStyle', '确定要删除角色“', 'snoop-app-refresh-btn', 'sort', '确定要恢复这个角色的默认立绘位置吗？', 'group-edit-members', 'accounting-title', 'dRUyA', 'chat-messages', 'url', '新建条目', '未找到可用模型。', 'chatHistory_', 'iQIDy', 'activeChatId', 'color', 'kbGVc', 'authorType', 'diaryList', '卡片已更换！', 'tjomU', 'Assistant', 'https://sharkpan.xyz/f/kjOF6/zedyqb.jpg', '保存角色失败:', 'Creating\x20object\x20store:\x20music_library', 'upload-feed-bg-button', 'userProfile', '\x20到\x20', 'back-to-home-from-diary-list', '\x0a\x0a#\x20核心群聊世界观设定\x20(所有角色必须严格遵守以下设定)\x0a', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', '。你的日记是写给Ta看的。\x0a\x0a#\x20写作【最高指令】\x0a1.\x20\x20**【首要任务：回应读者】**\x20你的第一要务是**回应**读者（', '\x22\x20的聊天记录已清空。', 'message-action-modal', '在“一起听”邀请中，净化封面失败:', 'changedTouches', 'decorative-badge', 'app-world-book', 'lastIndexOf', 'bZaka', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>', 'Gemini\x20API\x20Error:\x20', 'JeVVH', '字体已应用！(Font\x20Applied!)', 'NaIPe', '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a', 'Tkzwf', '\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20relative;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22position:\x20absolute;\x20left:\x20-25px;\x20top:\x2015px;\x20width:\x2020px;\x20height:\x2020px;\x20background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20font-size:\x201rem;\x22>📍</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-left:\x2010px;\x20padding:\x2012px\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20600;\x22>', '#\x20发生错误：\x0a', '在准备群聊API数据时，读取图片失败:', 'back-to-diary-list', '大家好像不知道该怎么回复...', 'parentElement', 'footprints', '动态页背景已更换！', 'diaryView', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22snoop-app-back-btn\x22\x20class=\x22snoop-app-header-button\x22>返回</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-header-title\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22main-title\x22>', '哼，就按你说的办好了。', 'EtoPJ', 'mlFXX', 'rawResponse', 'music-share-card', 'chat-reroll-button', '执行音乐封面数据净化...', 'candidates', '总结失败:', 'customFeedWallpaper', '错误:\x20', 'group-delete-button', 'left', 'touchcancel', 'ZYnTl', 'back-to-circle-list-from-edit', 'Bearer\x20', '正在翻阅所有档案...', '”。\x0a', 'click', 'getMonth', 'Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', 'quoted-sender', 'speaker', 'XlEBL', 'AI未能返回有效的JSON对象。', 'qtrdy', 'XimDH', 'LViFN', 'hWjQC', '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。', '.widget-info\x20>\x20div', 'bubble-', 'VGeDh', 'onloadend', 'apiSettings', 'ceil', '正在清空旧数据...', '[图片]', '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>', 'none', 'SOPgh', 'msMAq', 'summary-textarea', 'SsqyZ', 'chat-image-input', 'findIndex', 'mOmaU', 'SlflI', 'app-chat', 'panKD', 'lyric-line-', 'category', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>', 'textContent', 'app-wallpaper', 'widget_badge', '-\x20你最近去过：“', 'zBxxo', 'sJSdd', 'DhGWw', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'JqNvP', 'blob', '图片预览失败:\x20', 'PUhMU', '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'add-choice-backdrop', 'vOFJw', '距离「', 'altar-slot-info', '</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20', 'ZKdon', 'coverId', 'chat_image_migrated_', 'floor', 'SUYRu', 'cQeaj', '未命名角色', '\x0a#\x20关于你\x20(', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有活动足迹。</p>', '.ttf', 'LFFVA', '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'lazy', 'transfer-recipient-select', 'shift', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的账本还是空白的。</p>', '导出过程中发生严重错误:\x20', 'plVdH', '</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'flBJN', 'qKBal', 'assistant', 'mkKme', '”买过：“', 'meeting-list-container', 'Xbnlv', 'char-edit-avatar-preview', 'data', '哼，只有私聊才能进行总结，群聊那么乱怎么记！', 'uUZTP', 'fmNxH', 'HDjOt', '-\x20**状态提示**:\x20这是你和', 'editing-world-book-id', 'forEach', 'high', 'activeListenSession', '加载立绘失败:', 'QdcoE', 'translateX(-50%)', 'calendarEvents', 'flatMap', 'TJMiG', 'removeChild', '收到的原始、有问题的文本:', 'group_bg_', '.screen.active', '浏览器', '角色已保存！', '最近没有动态记录。', 'XtFsH', 'import-all-data-button', 'toBlob', 'Rzluf', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22character-item\x20snoop-chat-item\x22\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20style=\x22margin-bottom:\x200;\x20cursor:\x20pointer;\x20', 'Creating\x20object\x20store:\x20', '\x20之间。\x0a-\x20所有表情包名称【必须】从\x20`stickerList`\x20列表中选择，严禁使用列表之外的名称。\x0a-\x20角色之间需要有适当的互动,话题不应当完全围绕', ',\x20resetting.', '条新动态挑选发布者。你可以让同一个人发布多次，也可以让不同人发布。\x0a3.\x20\x20**创作动态**:\x20扮演你选中的作者，创作符合其人设和记忆的动态内容。可以是文字或分享音乐。\x0a4.\x20\x20**模拟互动**:\x20为每一条你创作的动态，切换视角到【圈内其他成员】，模拟他们可能做出的点赞和评论。互动必须符合他们各自的性格。\x0a\x0a#\x20输出格式【绝对规则】\x0a-\x20你的输出**必须**是一个语法完全正确的、单一的JSON数组，包含\x20', 'OTJLI', 'mQFop', '桌面已重置，即将刷新...', 'KjssP', 'jsWhc', 'bUBva', '[AI分享了音乐：', 'KdPxp', ':</span>\x20', 'fnABp', 'FeDCt', 'mouseleave', '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x228\x22></circle><line\x20x1=\x223\x22\x20y1=\x223\x22\x20x2=\x2221\x22\x20y2=\x2221\x22></line>', 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', 'fRlpW', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', '切换聊天时发生异步错误:', 'jSbKB', 'LAgeW', 'https://sharkpan.xyz/f/OymFy/dlxfiz.jpg', 'amount', 'audio-player', '\x0a\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a-\x20**当前精确时间**:\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>', '欢迎！请先创建一个角色开始聊天。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x22>', 'GxOCb', '正在解析音乐灵魂...', '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'meeting-send-button', 'listen-together-backdrop', 'chat-sticker-button', '-\x20**你最后一次活动是在**:\x20', 'pop', 'setItem', ']\x22\x20等前缀。\x0a如需发送表情，只发送一行：[sticker:表情名]。\x0a【重要】发送表情包时，表情名【必须】从以下列表中选择：[', 'theme-lightness-slider', 'scrollIntoView', 'appIconPosition_app-accounting', 'hhKHQ', 'https://sharkpan.xyz/f/ljNUx/aw6udx.jpg', 'thought', 'QoBlb', 'edit-current-circle-button', '正在解析角色卡...', 'ydTVz', 'mAMMu', 'border', 'NkjhM', 'next-month-btn', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'concat', 'quote-preview-area', 'AaKzf', '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>', '2099385EfvnBC', 'https://sharkpan.xyz/f/Ganul/78iwli.jpg', '.message.ai', 'snoop-phone-header', 'NdJiE', 'xPRhJ', 'Failed\x20to\x20read\x20history\x20for\x20chat\x20', 'rCvVN', 'BBNXO', 'export-char-button', 'bVQxm', 'clear', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>这里什么都没有...</p>', 'olcsT', 'emote', 'stopPropagation', 'center', 'FmLyW', 'listen-together-song-list', '文件格式不正确，不是一个有效的备份文件。', 'aHiSX', '”（用户）的信息当成你自己的。\x0a\x0a#\x20【最高时间法则】(必须严格遵守)\x0a-\x20已有内容的最新时间点:\x20', 'KEWoe', 'LLvcY', 'stringify', '很好哦', 'character-settings-button', '导入失败了，笨蛋:\x20', '[用户分享了音乐：', 'info-file-input', 'char-edit-bind-user', 'DuBXY', '测试动态已添加！', 'api-model', '-\x20**状态提示**:\x20你们今天刚聊过，请自然地衔接对话。\x0a', '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>', '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x2210\x22></circle><line\x20x1=\x222\x22\x20y1=\x2212\x22\x20x2=\x2222\x22\x20y2=\x2212\x22></line><path\x20d=\x22M12\x202a15.3\x2015.3\x200\x200\x201\x204\x2010\x2015.3\x2015.3\x200\x200\x201-4\x2010\x2015.3\x2015.3\x200\x200\x201-4-10\x2015.3\x2015.3\x200\x200\x201\x204-10z\x22></path>', 'apply', 'LzBtP', 'http', 'create_event', 'isFinite', 'error', '\x0a\x20\x20\x20\x20人设:\x20', '<path\x20d=\x22M14\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V8z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline><line\x20x1=\x2216\x22\x20y1=\x2213\x22\x20x2=\x228\x22\x20y2=\x2213\x22></line><line\x20x1=\x2216\x22\x20y1=\x2217\x22\x20x2=\x228\x22\x20y2=\x2217\x22></line>', 'diary-page', '<div\x20style=\x22border-left:\x202px\x20solid\x20var(--border-color);\x20padding-left:\x2015px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2015px;\x22>', 'qSKns', 'editing-friend-circle-id', 'mouseup', 'shiftKey', 'CBPrF', 'WSaDj', 'KUYAW', 'siFJq', 'fgALy', 'ypXaD', 'textShadow', '确定要删除群聊“', 'JwPXP', 'cajNr', 'hirVZ', 'pJknf', 'marginTop', 'flTOL', 'LHKMs', '日记已删除。', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有对话记录。</p>', 'data:image', 'input', 'snoop-copy-summary-btn', 'mXnZV', 'transparent', 'cljfZ', 'IYSda', '好像有动态了...', 'ubZro', '\x22>\x20', 'SVlUA', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '分钟前', 'post_user_', 'friend-circle-list-container', 'newAvatar', 'chat-transfer-button', '无法保存状态，浏览器可能禁用了存储功能。', 'setAttribute', 'expense-item', 'unlLC', '”的角色撰写一份“手机内容总结档案”。你将收到一份包含其手机内多个应用数据的JSON对象。\x0a\x0a#\x20档案撰写规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本,标题为：$【{character.name}的私人手机存储着以下信息】。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`phone_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以应用名（如\x20`gallery`,\x20`whispers`\x20等）作为键。\x0a\x20\x20\x20\x20-\x20每个应用下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**【绝对禁止】复读**:\x20不要直接复制粘贴原文！你要用自己的话进行【总结】和【提炼】。\x0a\x20\x20\x20\x20-\x20**【聚焦核心】**:\x20专注于关键信息、情感转折点、重要决定、暴露的秘密、体现性格的核心事件。忽略无意义的细节。\x0a\x20\x20\x20\x20-\x20**【中立视角】**:\x20以客观的第三人称档案管理员视角进行记录。\x0a\x0a#\x20输出示例\x0a```yaml\x0aphone_summary:\x0a\x20\x20gallery:\x0a\x20\x20\x20\x20-\x20\x22相册里有一张在海边拍的黄昏照片，出现了一个神秘的背影。\x22\x0a\x20\x20whispers:\x0a\x20\x20\x20\x20-\x20\x22角色曾与一位叫\x27Rin\x27的神秘联系人讨论过一个重要的决定。\x22\x0a\x20\x20abyss:\x0a\x20\x20\x20\x20-\x20\x22近期频繁搜索关于“独自庆祝生日”的话题，可能暗示了其孤独感。\x22\x0a```\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的JSON数据全文，并生成一份\x20YAML\x20格式的档案。直接从\x20`phone_summary:`\x20开始输出。\x0a', 'background', 'qQTjd', '<span\x20class=\x22description\x22>', 'cvfxH', 'character', '好友圈已保存！', '[sticker:', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x22>备忘录是空的。</p>', '哼，这不是图片，你想让我压缩什么？', '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[', 'gvORh', '用户操作中断了\x20AI\x20响应。', 'ACrjK', '”，在那里“', 'GhloT', 'data:', '\x0a#\x20你的个性（节选）\x0a', 'bottom', 'ZPaIB', '新建好友圈', '</span><span\x20class=\x22amount\x22>总计:\x20', 'private', '已自动断开与其他人的听歌同步。', '<div\x20class=\x22post-likes\x22>', 'gfGLA', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '确定要清空好友圈“', 'upload-font-button', 'cardState2', '星期日', 'lcsNQ', '卡片\x202\x20已移除。', 'page', 'gallery', '-\x20**你与', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '缓存命中:\x20', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'qINaI', 'rzolX', 'cOrzw', 'coLAc', 'lkpWD', 'RWuLM', 'https://sharkpan.xyz/f/B4WSa/u5wopj.jpg', 'displayUrl', '小组件背景已恢复默认。', 'wHZCp', '[DONE]', 'bRmOg', '20%', '#group-world-book-checkboxes\x20input:checked', 'activeMeetingCharId', 'focus', 'events', 'goLFg', 'zh-CN', 'remove', '用户资料已保存！', 'upload-widget-bg-button', 'RhRiP', '加载卡片图片失败', 'summarize-backdrop', 'QCoMP', 'xgycU', 'Zwjip', 'sbKct', 'mousedown', '检测到旧版聊天数据，为了优化体验和存储空间，需要进行一次自动升级。过程很快，请稍候。', '出去玩', '获取中…', '”已存入圣殿。', 'Vgvfl', 'mpFXY', '-input', 'teMQj', 'FgioP', 'removeEventListener', '\x20/\x20', '\x20页</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-next-button\x22>下一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'SPiMz', 'user-post-image-button', 'time', 'Fetch\x20request\x20was\x20aborted.', '确定要删除这个用户吗？与此用户绑定的聊天将恢复为默认用户。', 'translate(-50%,\x20-100%)', 'NNNuq', '成功向好友圈\x20\x22', '0\x201px\x203px\x20rgba(0,0,0,0.6)', 'all', '\x0a\x0a#\x20今日消费流水\x0a', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以视奸的角色。</p>', 'sprite-resize-handle', 'fWpZK', 'back-to-home-from-calendar', '-\x20**对话状态提示**:\x20你们已经有\x20', 'KNMSl', 'KoflX', '确定要永久清空【', '-\x20**状态提示**:\x20你和Ta已经好几天没联系了，应该用全新的问候开启对话。\x0a', '处理\x20', '保存失败:\x20', 'wEogU', 'edit-message-backdrop', '卡片已移除。', '-preview', 'message-container', 'badgeState', '确定要重置所有小组件的位置吗？它们会回到初始位置。', 'type', '--\x20点击选择\x20--', 'smOAx', 'calendar', 'world-book-edit-content', '一个人可怜吃饭', 'lceoF', '默认米白', 'dialogue', '生成动态时发生错误:\x20', '下载并转换网络封面失败:', 'customIcon_', '星期二', 'char_wallpaper_', 'Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.', '”的角色撰写一份“手机内容总结档案”。你将收到一份包含其手机内多个应用数据的JSON对象。\x0a\x0a#\x20档案撰写规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`phone_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以应用名（如\x20`gallery`,\x20`whispers`\x20等）作为键。\x0a\x20\x20\x20\x20-\x20每个应用下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**【绝对禁止】复读**:\x20不要直接复制粘贴原文！你要用自己的话进行【总结】和【提炼】。\x0a\x20\x20\x20\x20-\x20**【聚焦核心】**:\x20专注于关键信息、情感转折点、重要决定、暴露的秘密、体现性格的核心事件。忽略无意义的细节。\x0a\x20\x20\x20\x20-\x20**【中立视角】**:\x20以客观的第三人称档案管理员视角进行记录。\x0a\x0a#\x20输出示例\x0a```yaml\x0aphone_summary:\x0a\x20\x20gallery:\x0a\x20\x20\x20\x20-\x20\x22相册里有一张在海边拍的黄昏照片，出现了一个神秘的背影。\x22\x0a\x20\x20whispers:\x0a\x20\x20\x20\x20-\x20\x22角色曾与一位叫\x27Rin\x27的神秘联系人讨论过一个重要的决定。\x22\x0a\x20\x20abyss:\x0a\x20\x20\x20\x20-\x20\x22近期频繁搜索关于“独自庆祝生日”的话题，可能暗示了其孤独感。\x22\x0a```\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的JSON数据全文，并生成一份\x20YAML\x20格式的档案。直接从\x20`phone_summary:`\x20开始输出。\x0a', '我是女仆', 'api-endpoint', 'https://sharkpan.xyz/f/djyi8/1en214.jpg', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有购物记录。</p>', '\x0a\x0a#\x20记忆库\x20(仅供参考)\x0a---\x0a##\x20最近的互动回顾\x20(来自聊天、见面和动态)\x0a', 'HirZw', 'day-number', '\x20-\x20', '<span\x20class=\x22', '\x20的图片失败:', '委屈那我歇了', 'modal-cancel', 'wDUoT', '-\x20**状态提示**:\x20你和Ta上次聊天是在昨天，注意你发言的时间感。\x0a', '15%', 'tag', 'kind', '##\x20', '</pre>', 'touchmove', 'dock', 'wJutc', '#char-edit-avatar-preview\x20+\x20.avatar-frame', 'char-edit-sprite-', 'filled', 'music-screen', 'some', '\x0a#\x20核心世界观设定(角色必须严格遵守)\x20\x0a', '正在连接同步频道...', 'flexDirection', 'defaultPrevented', 'data:\x20', 'meeting-message-input', 'EAaXC', '你的任务是【续写和追加】！下面是已经存在的内容，你必须在此基础上，生成【全新的、发生在之后】的条目。给我把新内容【加在后面】，【绝对禁止】删除或修改任何已有的旧条目！', 'LXDqJ', 'loading', '上传失败了，笨蛋！\x20', 'post-img-', 'sprites', 'likes', 'preview-item', '-\x20姓名:\x20', 'pQCVG', '50%', '#diary-action-reroll', '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', 'TEqPv', 'undefined', 'JYxGW', 'screenX', '已删除。', '一拳打爆', 'kYeip', 'themeHue', 'KFILK', 'KLuGx', 'vgqCl', 'galgame-date', 'JrZzF', 'execCommand', 'img', 'group', 'refresh-feed-button', 'http://www.w3.org/2000/svg', 'pmRsB', '错误：你还没有创建任何好友圈。请先在App内创建一个。', 'FqFKN', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', '”的角色，并根据Ta的人设、记忆和当前的时间点，推演出Ta手机里某个应用可能存在的内容。\x0a\x0a#\x20【绝对身份锁定协议】(最高优先级)\x0a-\x20你【就是】“', '\x20\x20-\x20用户ID:\x20', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>', 'https://sharkpan.xyz/f/4adUj/68uj9o.jpg', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'friend-circle-member-selection', 'head', 'save-friend-circle-button', '我不想工作', 'nyiTL', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-', 'aAWbg', 'pPmks', '#\x20任务:\x20生成\x20', 'settings', 'akEej', 'LBcVz', 'save-edit-button', 'crAPK', 'kpjgW', 'wallpaper-screen', '<path\x20d=\x22M15\x2018h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2h-2V4a2\x202\x200\x200\x200-2-2h-2a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path><path\x20d=\x22M7\x2014h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2H7V4a2\x202\x200\x200\x200-2-2H3a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path>', '\x22\x20已删除。', 'avatar-wrapper\x20', 'last_message_preview', 'https://sharkpan.xyz/f/Mamca/4e3emf.jpg', 'objectStore', 'normal', '对不起', 'load-more-btn', 'diaries', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-', 'boundUserProfileId', '--custom-font-family', 'goENe', '10px\x20auto', 'image/', 'ePGOO', 'characters', '天没动静了。你的角色们应该发起新的问候或话题。', 'snoop-list-screen', 'toggle-meeting-view-button', '.snoop-main-grid', 'characterEdit', 'app-meeting', '医疗健康', '<div\x20class=\x22listen-together-header\x22\x20style=\x22text-align:center;\x22>🎵\x20已连接，正在一起听\x20🎵</div>', 'music-widget', '没有找到相关结果。', 'openai', 'Upgrading\x20database\x20to\x20version\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22', 'OrrFy', 'exp_', 'init', 'rHItP', '今天一笔账都没有，我整理什么？', 'fPQPL', 'NevBJ', 'zJCvR', '1359450XQXIQe', 'QEhiT', '咱俩天下第一好', '我正在说话呢，别打岔！', 'friend-circle-edit-title', '</span>', '点击选择\x20.lrc', '<span>', 'transfer-modal', 'yYujg', '”，但没找到人)', 'add-user-profile-button', 'BovVd', 'aborted', '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', 'isGenerating', 'Qzodg', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22width:\x2070px;\x20height:\x2070px;\x20background-color:\x20#f0f2f5;\x20border-radius:\x208px;\x20font-size:\x202.5rem;\x20flex-shrink:\x200;\x22>🛍️</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22flex-grow:\x201;\x20display:\x20flex;\x20flex-direction:\x20column;\x20justify-content:\x20space-between;\x20height:\x2070px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20500;\x20line-height:\x201.4;\x20-webkit-line-clamp:\x202;\x20display:\x20-webkit-box;\x20-webkit-box-orient:\x20vertical;\x20overflow:\x20hidden;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'CZETD', 'diary-write-modal', 'back-to-home-from-music-library', '请先在\x22设置\x22中配置你的\x20API\x20信息。', 'appendChild', 'tab-view-ledger', '好了，请基于以上所有信息，开始写今天的日记吧。', 'vZuUL', 'themeLightness', 'mXbka', 'KVemq', 'currentTime', '的手机内容\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '.music-post-song-card', 'JfBRY', 'group-settings-name', 'feed-loader', 'group-chat-create-screen', 'POST', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>正在清点圣殿藏品...</p>', 'filter', 'hjEwf', 'Error\x20fetching\x20from\x20', 'auto', 'nWEba', '\x22\x20class=\x22char-avatar\x22\x20style=\x22border-radius:\x2012px;\x20background-color:\x20#eee;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22flex-grow:\x201;\x22>', 'kSkLh', 'back-to-home-from-world-book', '请输入新的群名称：', 'https://sharkpan.xyz/f/mjeIW/9vf8ws.jpg', 'CdZlI', 'card-image', 'ndcIu', 'chat-music-button', 'cancel-transfer-button', 'meeting-list-screen', 'startsWith', 'style', 'TfWxn', 'cGQgD', 'contactName', '\x22\x20吗？所有聊天记录将被永久删除。', 'UuBmO', '\x20写道:\x20', 'save-user-profile-button', 'AFnFG', 'widget_card', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x20font-weight:\x20500;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20var(--text-color-light);\x22>🔍</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>', 'IRVUn', '你还没保存这个角色呢，导什么导？', 'firstChild', 'QBBrD', '乐于助人的助手', '在好友圈\x20\x22', '未知艺术家', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>', 'oJhey', '#ff8c66', 'bHcWx', 'app-user-profiles', 'abort', 'RcfaJ', '甜蜜地和你聊天', '星期四', '#ff9999', 'ajcNy', '请根据以上所有规则，生成\x20', 'summary', '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22text-align:\x20right;\x20margin-top:\x208px;\x20font-size:\x200.7rem;\x22>', 'rorlq', 'uKvRd', 'meetingList', 'decode', 'VfNnL', 'back-to-library-from-altar', 'snoop-home-clock', 'HUzeb', '<button\x20id=\x22snoop-copy-summary-btn\x22\x20class=\x22snoop-app-header-button\x22>复制</button>', 'path', 'cardState', 'oQpdn', '</div></div></div><span\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x22>-\x20', '<path\x20d=\x22M13.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V9L13.5\x202z\x22></path><polyline\x20points=\x2213\x202\x2013\x209\x2020\x209\x22></polyline>', 'Canvas\x20to\x20Blob\x20conversion\x20failed.', 'lzuRg', '不高兴撒娇', 'getAll', 'userProfileList', '导入角色卡失败:', 'posts', 'https://sharkpan.xyz/f/gjySw/jrl7rw.jpg', 'audio', '\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22char-name\x22>', 'ZhfQJ', 'snoop_', 'indexedDBMusicData', 'lt-ui-song-artist', 'avatar', 'aRVmW', 'store_name', 'is-today', 'FUALj', '\x20[并附上了一张图片]', 'transfer-amount-input', 'egFpQ', '[AI发送了表情：', 'from', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>', 'worldBook', '已复制到剪贴板！', '\x0a\x20\x20近期记忆:\x0a', 'HeExC', 'sgGts', 'activeFriendCircleId', 'uCQgl', 'widget-cover-art', '星期五', 'tab-record-expense', 'worldBooks', '等你消息', 'wGhjV', 'match', '<path\x20d=\x22M14.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V7.5L14.5\x202z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline>', 'mzKNT', '.custom-multiselect', 'fetch-models-button', '0\x202px\x208px\x20rgba(0,0,0,0.4)', 'CyRxj', 'ZgZCX', '的第一次互动。\x0a', 'cover', 'user-avatar-input', 'toggle', 'characterId', '\x20张旧图片。应用即将刷新。', 'user-profile-list-container', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'bFkcc', 'oBVzj', 'whispers', '我是小丑呜呜', 'widget-artist', 'persona', 'DGhLW', 'trim', 'edAPO', 'tiQxK', 'assign', 'borderRadius', 'LKGWM', 'galgame', 'emotion', 'ajLXb', 'gfKiY', 'system', 'eQyDU', 'widget-play-pause-btn', 'circle_', '解析音乐文件失败:', '-\x20你的备忘录里有一条叫“', '说了要\x20.ttf\x20文件，你是听不懂吗？', '当前聊天', '#bubble-preview-ai', 'appIconPosition_app-diary', '”吗？此操作不可撤销。', 'bJQPJ', 'music-post', 'KUqPg', '\x0a##\x20世界书条目:\x20', 'tYLXd', 'TjEmv', 'meeting-scene-view', '29%', 'xTwLl', 'card-widget', 'border-bottom:\x201px\x20solid\x20var(--border-color);', 'diary-entries-container', 'image_url', 'https://sharkpan.xyz/f/VG2FY/uucfvv.jpg', 'todo-date-title', 'GUWEy', 'important-day-item', 'imageId', 'chat-listen-together-button', '\x20\x20具体对话如下：\x0a', 'user-post-avatar', 'user-avatar-preview', '<img\x20id=\x22', 'WnKnr', '.app-icon-img', '未命名', 'listenTogetherSession', 'xNKbL', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', '原始文本:', 'flex', 'post_image_migrated_', 'snoop-app-icon', '复制失败了，哼。', '还没有我的回复可以重新生成哦。', 'isOffline', 'CbhcN', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>', '解析AI剧本JSON失败:', 'friend-circle-edit-bind-user', 'NDdzI', '</div><div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>', 'main', 'syvHc', 'RXowR', 'target', 'chat-summarize-button', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>', 'snoop-temp-style', 'https://sharkpan.xyz/f/pKWCQ/ztxwv0.jpg', 'ScsIA', 'KlJXT', 'LWVvD', '<div\x20class=\x22snoop-avatar\x22>', 'wallpaper_main', 'KVDIZ', 'name', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22\x20style=\x22white-space:\x20pre-wrap;\x20margin-top:\x208px;\x20line-height:\x201.6;\x22>', 'zELjQ', 'tcVFs', 'https://sharkpan.xyz/f/35lse/xmsue5.jpg', 'ffPdz', 'YmqeA', '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22text-align:\x20right;\x20margin-top:\x208px;\x20font-size:\x200.7rem;\x22>编辑于\x20', 'quoted-message-in-bubble', ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“', 'qELvs', 'insertBefore', 'musicPlayerState', '稍微有点卡了，可以尝试清空聊天记录了！记得总结丢世界书', 'wallpaper-input', 'OFuQN', 'home', '</span></div>', 'wHqJw', '<pre\x20style=\x22white-space:\x20pre-wrap;\x20word-break:\x20break-word;\x22>', 'KzPTP', 'QZSKD', 'senderId', 'jMPbt', '人情红包', '<img\x20src=\x22', 'OYBbR', 'model', '无法解析旧的视奸内容来获取时间戳。', '.char-info-wrapper', 'back-to-user-list-from-edit', 'getContext', 'kqCew', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '已经删掉了。', 'mPpQW', '\x0a#\x20最近的动态回顾\x20(供所有角色参考)\x0a', '\x22\x20data-id=\x22', 'nNQFy', 'custom-stickers-input', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x0a\x0a#\x20关于对话者“', 'chatWallpaper', 'url(\x27', 'UkvQH', '<div\x20class=\x22review-area\x22\x20style=\x22margin-top:\x2012px;\x20padding-top:\x2012px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x20display:\x20flex;\x20align-items:\x20flex-start;\x20gap:\x2015px;\x22><div\x20style=\x22width:\x2040px;\x20height:\x20auto;\x20flex-shrink:\x200;\x20display:\x20flex;\x20justify-content:\x20center;\x22><img\x20src=\x22', '\x20.app-icon-img,\x20#app-dock-top-right\x20#', 'warn', 'LGOub', 'ddfSU', 'ddybj', 'back-to-home-from-meeting-list', 'JkTsN', '加载见面背景失败\x20for\x20', '哼，你这字体文件有问题，用不了。', 'altar-slot-audio', 'kFZor', 'snoop-log-back-btn', '&apos;', '---\x20Noir\x27s\x20Friend\x20Circle\x20Purification\x20Ritual\x20---', '请严格按照以下SCHEMA返回一个JSON对象，不要包含任何额外文字。\x0aSCHEMA:\x0a', 'zwXuG', 'Xzzwc', '-\x20**状态提示**:\x20你的记忆已经停留在【昨天】。你生成的内容应该是今天发生的、全新的事情，可以是对昨天事情的回应，但时间点必须是“今天”。\x0a', '\x0a#\x20核心任务:\x20角色扮演模拟器\x0a你的【唯一】任务是扮演名为“', 'is-selected', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', '<path\x20d=\x22M21\x2015a2\x202\x200\x200\x201-2\x202H7l-4\x204V5a2\x202\x200\x200\x201\x202-2h14a2\x202\x200\x200\x201\x202\x202z\x22></path>', '赞同！渲染效果一级棒！', '搜索失败:\x20', '纪念日', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22character-item\x22\x20style=\x22align-items:\x20flex-start;\x20margin-bottom:\x200;\x20padding:\x2015px;\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20', 'object', '#snoop-app-view-container\x20.snoop-app-content', '8px\x2016px', 'zPkKt', 'div', 'horizontal', 'AecSc', 'label', 'lt-ui-cover-art', 'removeProperty', 'https://sharkpan.xyz/f/zLes5/4lxzjn.jpg', 'AI返回的不是一个数组。', 'ejLtv', 'HiJXF', 'world-book-item', 'Ylvma', '条目名称和内容都不能为空！', 'cancel-listen-together', ')，启动兼容模式...', 'auMpk', 'disabled', 'isActive', '\x0a#\x20最近的朋友圈动态\x20(供你参考)\x0a', '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。', 'mHqZJ', 'HIMUX', '\x0a\x0a#\x20用户资料\x20(与你互动的人)\x0a-\x20姓名:\x20', 'sad', 'split', 'api-provider', 'BhopE', 'custom-icon-list-container', '\x20//\x20<--\x20哼，加在这里\x0a', 'pending-post-image-preview', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message\x20', 'OnlFS', '”已创建！', 'back-to-char-select-from-edit', 'JlBuB', 'https://sharkpan.xyz/f/jj6s6/yd5bpb.jpg', 'authorId', 'confirm-altar-upload-button', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'parts', 'tfiZG', 'iEaHk', 'isAnimatingDiary', 'PAygM', '喝多了', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22snoop-app-icon-img\x22><svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20viewBox=\x220\x200\x2024\x2024\x22>', 'categorizedExpenses', 'button', 'eventType', 'edit-delete-char-button', 'long', '-\x20**当前精确时间**:\x20', 'classList', 'organize-button-container', 'avatarFrameUrl', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22width:\x2050px;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'Eplim', 'ZscrJ', 'sFsYa', '\x20.app-icon-img', 'Rtywn', 'TROOx', 'https://sharkpan.xyz/f/ZazfW/2vv46w.jpg', 'cQoMK', 'canplaythrough', 'laevZ', '昨天\x20', 'indexedDBData', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>', '#app-dock-bottom-left\x20#', 'CEeJX', '我错了', 'show', '找不到角色信息。', 'SRGhi', '加载壁纸失败:', 'touchstart', 'add-event-modal', '</svg></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span>', '\x0a\x20\x20相关记忆:\x0a', 'eventDate', 'meeting-main-content', 'RJBNq', 'claude', '\x0a#\x20核心任务\x0a你是一个多角色社交模拟引擎。用户刚刚发了一条动态，你需要为好友圈里的【每一位】其他成员生成对这条动态的回应（点赞和评论）。如果用户的动态包含图片，你必须根据图片内容进行回应。\x0a\x0a#\x20好友圈成员\x0a', 'JHnNY', 'piHtQ', 'group-clear-history-button', 'https://sharkpan.xyz/f/0GKHX/mthvno.jpg', 'msg_', 'full', 'getSelection', 'OIYNa', '\x27\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-contact-name=\x27', 'MiIEL', 'upload-music-button', '.app-icon', 'snoop-dock', '表情包已保存！正在刷新应用...', 'Kncau', 'hTDtu', 'getItem', 'import-data-input', 'api-key', 'hgTqb', '错误：找不到当前用户，无法保存事件。请尝试返回主屏幕再试一次。', 'todo-item', '编辑用户', 'typing-indicator', 'toDataURL', '这不是一张有效的Noir角色卡。', 'localStorageData', '💜\x20', 'vqSHD', 'YOJMo', 'number', 'AYLVz', 'nslvJ', 'friend-circle-edit-name', 'cancel-quote-button', '和其他人的聊天', '-\x20[动态]\x20', 'ZHTKy', 'https://sharkpan.xyz/f/ABwhZ/twknmr.jpg', 'txUGV', 'save-char-button', 'pMPvk', 'WBYHf', 'FbhYz', 'noir_data_migration_v1_complete', 'gBfJh', 'xlIPC', 'oiWkf', 'widgetBgImage', 'transfer', 'contains', 'drawImage', 'Uzkde', '无法从\x20IndexedDB\x20加载聊天图片:', '2px\x20dashed\x20var(--border-color)', 'cancel', 'ZBjTc', 'opvrG', 'https://sharkpan.xyz/f/8a7tj/sea1z9.jpg', 'MSJLB', 'badge-input', 'Otglh', 'owIEu', '我很脆弱', 'NhAgJ', '#99ff99', 'parse', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '#ffcc66', 'HnewE', 'delete', '.remove-attachment-btn', 'card-image-2', 'toLowerCase', '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概', 'href', 'badge-image', 'YVOJk', 'AI返回的原始文本:', '\x0a\x0a#\x20关于群聊参与者“', 'lt-ui-close-btn', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>', 'characterLastScripts', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥', 'eWPzQ', 'https://api.vkeys.cn/v2/music/', '加载自定义表情包失败，真是没用。', '”吗？该角色的私聊和所有相关群聊记录都将被一并处理。', 'memberCharacterIds', 'calendar-header-title', 'qDXKV', '新角色\x20', '猫猫撒娇', 'charId', 'endpoint', 'editing-user-id', '核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a', '正在为你切换新的歌曲...', 'conversationHistory', ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[', 'abs', '#\x20记录是空的，没什么好总结的。', 'home-time', 'FIRTm', 'vnuGo', '确定要删除这个好友圈吗？此操作不可撤销。', 'YVfwL', 'KQZny', '\x0a#\x20核心任务:\x20档案馆书记官\x0a你的任务是为一个名为“', 'lyrics', '群聊\x22', 'block', 'AUGfD', '305391Apviib', '<div\x20id=\x22accounting-input-area\x22\x20style=\x22margin-bottom:\x2020px;\x22><div\x20class=\x22input-group\x22><label\x20for=\x22expense-description\x22>花在哪了？</label><input\x20type=\x22text\x22\x20id=\x22expense-description\x22\x20placeholder=\x22例如：一杯奶茶\x22></div><div\x20class=\x22input-group\x22><label\x20for=\x22expense-amount\x22>花了多少？</label><input\x20type=\x22number\x22\x20id=\x22expense-amount\x22\x20placeholder=\x22例如：15\x22></div><button\x20id=\x22add-expense-button\x22\x20class=\x22form-button\x20primary\x22\x20style=\x22margin-top:\x2015px;\x22>记下了</button></div><h3\x20style=\x22margin-bottom:\x2010px;\x22>今日流水</h3><div\x20id=\x22daily-expenses-list\x22\x20style=\x22max-height:\x20300px;\x20overflow-y:\x20auto;\x22></div><div\x20id=\x22organize-button-container\x22\x20style=\x22margin-top:\x2020px;\x22></div>', 'input:checked', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22float:\x20right;\x22>', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天没有安排。</p>', 'iSKNS', 'Failed\x20to\x20plan\x20group\x20replies:', '</span><div><div\x20class=\x22description\x22>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20background:\x20#fffbf2;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', ':\x22\x20或\x22[', 'wants', 'gap', 'info', 'author', 'toDateString', 'text', 'alignItems', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>📶\x20🔋</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '未知用户', '<div\x20class=\x22post-body\x22>', 'characterName', 'FPReX', '<div\x20class=\x22post-comments-container\x22>', 'widget-bg-input', '\x0a\x0aINPUT:\x0a', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'WUhsR', 'zPzJC', '我来搞定', 'chat-screen', 'bHGBf', 'STLAV', 'url(', '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>', 'meeting-view-screen', 'lt-ui-lyrics-container', 'jAnnB', 'uosoj', 'stretch', '115732xVcUTN', 'back-to-home-from-chat', '-\x20你拍过一张照片，内容是：“', 'QdKEW', 'cgwuJ', 'T00:00:00', '点击选择\x20.mp3\x20或\x20.flac', '有点生气', 'reduce', 'jDINo', 'SpnKD', 'char_avatar_', '\x0a\x20\x20\x20\x20-\x20世界书[', 'content', 'cVbcu', 'listen-together-card', '逗你开心', 'songName', '未知表情', 'rGsqn', '.custom-multiselect\x20.select-box', 'app-settings', 'setMonth', 'show-chat-view', '真是的，必需的祭品都还没准备好！', 'EvyGU', '】的手机已被重置。', '.todo-item,\x20.important-day-item', 'app-accounting', '<input\x20type=\x22checkbox\x22\x20value=\x22', '还没有我的回应可以重新生成哦。', 'snoop-character-list-container', 'cancel-edit-button', 'bwsTE', 'Failed\x20to\x20parse\x20history\x20for\x20chat\x20', 'narrator', 'is-playing', 'jeOOD', 'UyjhR', 'history', 'MlrHc', '\x20记录)\x0a', 'confirm-music-input', '34%', 'snoop-phone-screen', 'date', '”的群聊规划角色们的下一步发言。\x0a-\x20与你们对话的人类用户名为“', 'friendCircleEdit', 'JbmIw', '被你撩到', 'qXDXt', 'emoji', 'world-book-edit-name', 'is-visible', '净化好友圈时出错，真是的。', 'tzkaB', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'user_', 'AI返回了无法解析的文本', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'onerror', 'musicLibrary', 'userProfiles', 'DaizP', 'AHMOu', '需要至少2个角色才能创建群聊。', 'https://sharkpan.xyz/f/1zQH2/o84boo.jpg', '.slot-filename', '聊天档案柜是空的，无需净化。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'home-clock-container', '生成动态回复失败:', 'objectStoreNames', 'kKTBX', 'add-event-fab', '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[', 'AzXXJ', 'hchzc', 'wb_', 'fkaID', '成功净化并迁移了\x20', 'AI未能返回有效的JSON数组格式。', 'shy', ']\x20[image]', 'happy', '--primary-lightness', 'DjVmS', '\x27).click()\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x20background-color:\x20#777;\x22\x20onclick=\x22localStorage.removeItem(\x27', 'SOVKu', 'speaker-user', 'GOfMO', '111rZLGtf', 'SehoX', 'expanded', 'UorfM', 'copy', 'Noir\x27s\x20Temporal\x20Patch:\x20Ledger\x20re-synchronized.', 'margin', 'recipientId', 'SbGMr', '\x22\x20style=\x22max-width:\x2085%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22message-bubble-row\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'choice-create-group', 'diary-view-screen', 'lsEGs', 'char-edit-offline-bg-preview', '好委屈但是不能哭', 'currentlyPlayingIndex', 'friendCircleList', '错误：找不到签署契约的地方。', 'galgame-sprite-container', 'https://sharkpan.xyz/f/nj7ul/r48eum.jpg', '\x22\x20class=\x22music-share-cover\x22>', '#ffb366', 'quoted-content', 'meeting-char-name-header', 'toISOString', 'JSON解析失败\x20(', 'key', ']\x20[sticker:', 'wIghi', 'createObjectURL', '#f2b7c6', 'YmYjG', 'Vnckr', 'https://sharkpan.xyz/f/7aMhj/hyc75m.jpg', 'alt', 're-record-button', 'fufLe', 'xgHMf', 'baCxP', 'ZDbaQ', 'XziQN', 'qwotD', 'back-to-home-from-user-list', 'hozNS', '<span\x20style=\x22opacity:\x200.6;\x22>无</span>', 'uUROi', 'model-dropdown', 'snoop-app-container', 'TIvIJ', 'dyRhl', 'WsORF', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', '有点破防', 'EZLLW', 'uMkfb', 'speaker-ai', '.music-post-play-icon,\x20.music-share-play-icon', 'accountingData', 'xmQie', 'pOLGc', '错误：找不到角色', 'DsWCg', 'event_', '15px', '\x0a-\x20**日记本的上一笔记录是在**:\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22input_', 'querySelectorAll', 'abyss', '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。', 'wXEfT', 'theme-hue-slider', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>相册是空的。</p>', 'phone-container', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20padding:\x2015px;\x20background:\x20white;\x20box-shadow:\x20var(--soft-shadow);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2012px;\x20border-bottom:\x201px\x20solid\x20var(--border-color);\x20padding-bottom:\x2010px;\x20margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x201.8rem;\x20flex-shrink:\x200;\x22>🍜</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22\x20style=\x22font-weight:\x20600;\x20font-size:\x201.05rem;\x22>', '星期一', 'isFromLibrary', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '--widget-cover-image', '未知角色', '\x20\x20-\x20角色ID:\x20', '\x0a#\x20好友圈的主人\x20(“我”)\x0a-\x20姓名:\x20', 'Unknown', 'fKcTl', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20@font-face\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20font-family:\x20\x27', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'world-book-screen', 'qiKCI', 'vPZlp', '\x20个模型。', 'XUMUa', '好的，我记住了这些人设和历史。现在我们开始对话。', 'CkzRF', 'BobdW', 'mWxyl', 'max', 'OLYTf', '小时前，生成的内容应该符合这段时间的空白。\x0a', 'ocEOz', 'AfoZD', '（正在构思中...）', '导出失败了，哼:\x20', 'result_page_content', 'select', 'save-group-settings-button', '0\x200\x20', '导出角色卡失败:', 'https://sharkpan.xyz/f/7L3Hj/sl4504.jpg', 'KxpVn', 'change', '---\x20音乐净化仪式完成\x20---', 'ygcBC', 'yDCJg', '.json', '\x27);\x20location.reload();\x22>恢复</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '服务器错误:\x20', 'participantIds', 'custom_font_ttf', '\x22\x20src=\x22', 'open', 'Qnwfs', 'whUnu', 'image', '<p>格式错误</p>', '暂无音乐', 'gRrxu', 'jQscy', '60%', 'kEkoh', 'ZjaNQ', '字体应用失败:', 'is-exiting-left', 'choice-import-character', 'QQqvS', '\x0a\x0a#\x20近期记忆\x20(来自聊天记录等)\x0a', '未知联系人', 'chats', 'getDate', 'diary-char-name-header', 'friend-circle-title', '”已成功导入！', 'UGQIq', 'Noir\x27s\x20Fix:\x20已成功追加新旧数据\x20(A+B)。', '歌曲ID', '全量导入失败:', 'transaction', 'JHOVb', '\x0a\x20\x20\x20\x20\x20\x20<div\x20style=\x22padding:\x2015px;\x20', 'live-preview-style', '”。\x0a-\x20你正在生成的内容，是你【自己】手机里的东西。\x0a-\x20【严禁】将“', 'DXzta', '正在铭刻字体...', '来源：', 'YQenP', 'organize-bill-button', 'getHours', '无法保存聊天记录。', '\x0a\x0a#\x20当前任务指令\x0a', 'perChatContextLines', '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'join', 'event_ai_', 'back-to-chat-list', '\x0a\x20\x20人设:\x20', 'getMinutes', '徽章已更换！', '保存壁纸失败:', '\x20转账\x20', '请求AI更新:\x20', 'PYHCg', 'add-choice-modal', 'jVjZF', 'elCNz', 'calendar-screen', 'add', '（开始一段新的对话...）', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22margin-top:\x208px;\x20font-size:\x200.75rem;\x22>', 'sprite-adjust-button', '选择聊天', 'XTxdJ', 'vnmns', 'pendingPostAttachments', '切，加载播放器状态的时候出错了。', 'NGMDc', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>', 'VxNHP', '<path\x20d=\x22M6\x2012h12\x22></path><path\x20d=\x22M12\x206v12\x22></path><path\x20d=\x22M12\x202a4\x204\x200\x201\x201-4\x204\x22></path><path\x20d=\x22M12\x2022a4\x204\x200\x201\x200\x204-4\x22></path><path\x20d=\x22M22\x2012a4\x204\x200\x201\x200-4-4\x22></path><path\x20d=\x22M2\x2012a4\x204\x200\x201\x201\x204\x204\x22></path>', 'bWbQy', 'AI返回的内容里找不到有效的JSON数组。原始回复:\x20', 'HXtMj', 'uOxxn', 'angry', 'widget-next-btn', '找不到要清空的聊天记录。', 'files', '#\x20核心任务:\x20写一篇有深度的交换日记\x0a你正在扮演名为“', '生成日记失败:\x20', '.page-dot', '至少要保留一个用户。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>', 'kooTH', 'touchend', 'padStart', 'onupgradeneeded', 'weVfW', 'https://sharkpan.xyz/f/Wa0cW/w6m7qk.jpg', 'mgeUY', '点击选择\x20.jpg\x20或\x20.png', '视奸内容解析失败:', 'toLocaleTimeString', 'fragments', 'song_', 'noir_migration_music_v1_complete', 'MugbW', 'lt-ui-song-title', 'documentElement', 'splice', 'https://sharkpan.xyz/f/ljVCx/b16h2z.jpg', '<span>--</span><span\x20class=\x22unit\x22>天</span>', 'SGkgs', '该角色', 'has', 'addTestPost', 'huUIH', 'https://sharkpan.xyz/f/qjJT3/kpy33b.jpg', 'delete-world-book-button', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'UTNFe', 'back-to-home-from-circle-list', 'zBfkp', 'BOeEK', 'lyLIX', 'HUlmD', 'setProperty', 'diary-get-reply-button', 'world-book-editor-screen', 'world-book-editor-title', 'entries', 'QOhmp', 'image/jpeg', '\x0a#\x20任务:\x20生成足迹\x20/\x20活动时间线\x0a生成一个最近的活动时间线。地点和事件要与角色的人设，以及其他应用里透露出的信息保持一致，让整个手机的内容能够互相印证，形成一个完整的故事闭环。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20输出格式必须是严格的JSON数组。\x0a#\x20示例\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22location_name\x22:\x20\x22城东旧书店\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22activity_description\x22:\x20\x22待了一个下午，好像在找什么旧书。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22timestamp\x22:\x20\x222025-09-22\x2014:00\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]', 'feed', 'IPfsu', 'message', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22text-align:\x20right;\x20font-size:\x201.1rem;\x20font-weight:\x20bold;\x20margin-top:\x2010px;\x20padding-top:\x2010px;\x20border-top:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20实付:\x20<span\x20class=\x22amount\x22>¥\x20', '的个人专属世界观设定\x0a', 'char-edit-css', '绝对不想', '”。在分析历史记录时，请记住这一点，并用此名称指代用户。\x0a-\x20【最重要】为\x20`personas`\x20列表中的【每一位】角色都规划至少一个事件(通常不少于2个)。不能遗漏任何角色。\x0a-\x20【新增规则】你可以规划\x20\x22kind\x22:\x20\x22music\x22\x20事件来分享音乐。此时，你【必须】同时提供\x20\x22songName\x22\x20和\x20\x22artist\x22\x20字段。\x0a-\x20你的首要任务是产出一个严格遵守SCHEMA、语法完全正确的、可被解析的JSON对象。\x0a-\x20若用户\x20`@`\x20了某个角色\x20(见\x20`mentioned`)，该角色应优先发言。\x0a-\x20事件总数必须控制在\x20', 'HiZHn', 'clipboard', '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202h-14a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011v-7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v7\x22></path><path\x20d=\x22M9\x204v3\x22></path>', 'card-widget-2', 'statusText', 'readonly', 'user-post-music-button', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'diary-modal-cancel', 'User\x20cancelled', '已送达', '用户已删除。', 'NHneL', 'music-library-container', 'amKBt', 'zwxmR', 'HVLDC', 'xjucS', 'OEWIe', 'fWsOF', '近期没有特别安排', 'snoopList', '\x22\x20accept=\x22image/*\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x22\x20onclick=\x22document.getElementById(\x27input_', '.load-more-btn', '---\x20好友圈净化仪式完成\x20---', '正在处理...', 'pause', '#FFFFFF', '检测到旧版存档，正在自动升级...', 'EEWYT', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'nwHrO', '2-digit', 'cancel-action-button', 'download', 'musicWidgetPosition', 'xQGMo', 'group-settings-screen', '\x0a你是一个严格的JSON生成引擎。\x0a你的唯一任务是根据用户提供的指令和数据，生成一个描述角色互动的JSON对象。\x0a你的输出【必须】是、也只能是一个单一、完整、语法正确的JSON对象。\x0a严禁包含任何解释、注释、道歉、或Markdown代码块标记\x20```json。\x0a直接输出\x20{\x20\x22events\x22:\x20[...]\x20}\x20结构。\x0a', 'user-profile-screen', '很期待', '/v1/models', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有聊天记录。</p>', '获取AI响应失败:', 'log', '#member-select-', 'Escape', 'replaceAll', 'removeItem', 'onload', 'Dywvr', 'group-avatar-input', 'isArray', '-\x20你在“', 'AJUUK', 'QkRzs', 'app-music-library', '请在动态或聊天中播放', 'canvas', 'diary-modal-textarea', 'TdOfO', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天还没有花钱哦。</p>', 'qgNUp', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>', 'group-bg-input', '备忘录', 'chat_', 'version', 'backgroundSize', '群聊\x20(', '包含所有图片和音乐的全量数据已成功导出！', 'DKGPR', '\x22\x20中发现一张需要净化的图片...', '#a4c2f4', '\x0a#\x20时间锚点\x20(你必须严格参考此信息进行推演)\x0a', 'title', 'result', 'createObjectStore', '\x27;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20src:\x20url(\x27', '1em', 'clientY', 'AI整理失败了，哼:\x20', '.selected-options-text', 'random', 'item_name', '59%', 'https://sharkpan.xyz/f/6Dzia/m9smvt.jpg', '餐饮美食', 'chat', 'XYpWK', '执行好友圈数据净化...', 'choices', '<div\x20class=\x22loader-spinner\x22></div><span>', 'https://sharkpan.xyz/f/LZwu7/m7vx2q.jpg', 'input[name=\x22event-type\x22]:checked', '\x0a\x0a#\x20', 'playableUrl', 'dJcZB', 'signal', 'upload-wallpaper-button', '<div\x20class=\x22snoop-main-grid\x22></div>', 'nwNlz', 'summarize-modal', 'https://sharkpan.xyz/f/X7muW/lc8g9h.gif', '\x20个成员', 'gsgTL', 'CekLw', 'CyhcG', 'post_', '卡片\x202\x20已更换！', '\x20天没活动了。你生成的内容必须是全新的、符合这几天空白时间的事件，不能再纠结于几天前的事情。\x0a', 'clear-feed-button', 'eZUsV', 'KoGRX', 'chat-view-pane', 'area', '错误：第一个好友圈\x20\x22', 'feed-bg-input', '.listen-together-card', '.message-container', 'worldBookEditor', 'ZXxyF', '对方正在行动中...', 'style-', 'BFpRB', 'onclick', 'add-chat-button', 'EXYSY', 'scale', '加载角色\x20', '273368HNpUXb', 'description', 'googleapis.com', 'input_', 'musicUploadAltar', 'TA正在提笔写日记...', 'children', 'VagiW', '---\x20Noir\x27s\x20Data\x20Purification\x20Ritual\x20v1.0\x20---', 'quote-preview-sender', 'onsuccess', '-\x20你曾经搜索过：“', 'Miiol', 'ycWle', 'phone_summary:\x0a\x20\x20status:\x20空空如也，没什么好总结的。', 'music-input-backdrop', '”的笔记，内容是：“', 'ifTuU', '”，里面有\x20', '\x0a\x0a#\x20用户的动态\x0a', '确定要重置所有桌面小组件和App的位置，并将壁纸变为纯白吗？此操作后将刷新页面。', '”聊过天，关于：“', 'AHmwN', 'phone_summary:\x0a\x20\x20status:\x20总结失败了，可能是档案太复杂。', 'accounting', 'LBirC', 'OaFor', 'audio-file-input', 'map', 'contact_name', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>', 'group_avatar_', 'review', 'calendar-day', 'vxjzX', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'json', 'beforeend', '</textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'XVtct', 'RmDQS', '已恢复默认。', 'lDYyi', '】的手机内容吗？\x0a\x0a所有已生成的缓存（相册、NPC聊天等）都将被永久删除。', '\x20的内容\x0a请为角色生成符合其人设的应用数据。输出格式必须是严格的JSON数组。', '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。', '好友圈数据升级完成，迁移了\x20', 'LGolr', 'user', 'message-action-backdrop', '[发送了图片]', 'jaXgz', 'diary-prev-button', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'daily-expenses-list', '”...', 'HlvoR', 'bites', 'today-todo-list', 'toast', 'reset-feed-bg-button', 'last_edited', '加载已保存字体失败:', 'modal-ok', 'selectedDate', 'NoirCustomFont', 'accepted', 'scrollHeight', 'fRsuE', 'VJAzz', 'widget_card_2', '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20', 'Zawce', 'getDay', '-\x20你点过一份外卖：“', 'sticker-item', '[表情]', 'tencent', '创建新用户', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22snoop-summary-textarea\x22\x20readonly\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border:\x20none;\x20outline:\x20none;\x20resize:\x20none;\x20font-family:\x20\x27Courier\x20New\x27,\x20monospace;\x20font-size:\x200.85rem;\x20line-height:\x201.6;\x20background-color:\x20#fdfdfd;\x20padding:\x2015px;\x20box-sizing:\x20border-box;\x22>', 'kLjym', 'create-group-chat-button', '\x0a\x0a#\x20你的手机内容摘要\x20(这是你的个人记忆，不要提及“视奸”)\x0a', 'jTaSP', 'SCOzA', '<div\x20style=\x22padding:\x2015px;\x20background:\x20#ffebeb;\x20border-radius:\x208px;\x20color:\x20#d8000c;\x22><strong>解析失败了，哼。</strong><br>AI返回的原始内容：</div><pre\x20style=\x22white-space:\x20pre-wrap;\x20word-break:\x20break-word;\x20font-family:\x20monospace;\x20margin-top:\x2010px;\x22>', '准备调用\x20generateAs...', 'charSelect', 'VJQoo', 'PCpXj', 'customStickers', '#snoop-app-view-container\x20.snoop-app-header', '</div>', '正在整理…', 'message-anchor', 'galgame-sprite', 'QMAYS', 'XTHyO', 'noir_migration_fc_v1_complete', 'oFLyo', 'generationConfig', '请输入群聊名称。', '其他杂项', '\x22\x20class=\x22char-name\x22>', 'input[type=\x22checkbox\x22]:checked', 'PyGTJ', 'currentDate', 'listen-together-modal', '最近没有互动记录。', 'values', 'WuCPk', 'https://sharkpan.xyz/f/B4DCa/u86hk2.jpg', '\x22\x20id=\x22', '全量导出失败:', 'app-snoop', 'QlGse', 'message-bubble-row', 'EroBq', 'aCNrv', 'VUcJA', 'EOnAV', 'ADolt', 'qsWvL', 'PhAzA', 'getFullYear', '\x27>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-avatar\x22\x20style=\x22background-color:\x20#eee;\x20font-size:\x201.5rem;\x22>', 'gwJTg', '.typing-indicator', '#\x20固定分类列表\x0a[', '新用户\x20', 'innerHTML', '\x20时出错:', '\x20\x20\x20\x20-\x20', '#group-settings-screen\x20.select-box', 'rrUsM', '字体更换成功！', 'char-edit-avatar-input', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>', 'meetingView', 'cursor', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.85rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x208px;\x20padding:\x2010px;\x20background:\x20var(--surface-bg);\x20border-radius:\x208px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'aGFOA', '大家正在赶来回复...', 'qRWII', '8px', 'now', 'revokeObjectURL', 'white', '5px', 'group-settings-bind-user', '&quot;', 'toString', '<div\x20class=\x22loader-spinner\x22\x20style=\x22margin:\x20auto;\x22></div>', '.message.user', 'gUYsf', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'eVPIq', 'cNrZW', 'diary-entry\x20', 'userAvatarFrameUrl', 'snoop-phone-top-nav', 'bxYmM', '<path\x20d=\x22M10\x2020.5l.5-.5.5.5\x22></path><path\x20d=\x22M12\x2018l.5.5.5-.5\x22></path><path\x20d=\x22M14\x2020.5l.5-.5.5.5\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x227\x22></circle><path\x20d=\x22M12\x203v1\x22></path><path\x20d=\x22M12\x2019.5v1.5\x22></path><path\x20d=\x22M18.36\x205.64l-.7.7\x22></path><path\x20d=\x22M6.34\x2017.66l-.7.7\x22></path><path\x20d=\x22M21\x2012h-1.5\x22></path><path\x20d=\x22M4.5\x2012h-1.5\x22></path><path\x20d=\x22M18.36\x2018.36l-.7-.7\x22></path><path\x20d=\x22M6.34\x206.34l-.7-.7\x22></path>', 'char_sprite_', ';\x22>', 'YUTZG', 'fIztL', 'modal-mask', 'jZHjC', 'user-persona', 'true', 'sZuzT', '1466928qSnMwO', 'diary-write-button', 'svg', 'wCIXB', '\x20(分享了歌曲:\x20', 'reset-card-button-2', 'status', '<p\x20class=\x22music-post-thought\x22>', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22></div><div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22><div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>', 'addEventListener', 'reload', '\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-', '未知餐厅', 'RrLua', '”已删除。', 'TNKMv', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22snoop-log-back-btn\x22\x20class=\x22snoop-app-header-button\x22\x20style=\x22text-align:\x20left;\x22>‹\x20聊天</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22snoop-app-header-title\x22>', 'group-avatar-preview', '最近的足迹', 'xDPYB', '暗夜紫晶', 'Erplu', 'dVfhi', 'dTBYE', 'NGRWM', 'https://sharkpan.xyz/f/DVJtK/vxiup1.jpg', 'p[data-history-index]', 'bhRSm', 'VTRtb', '.bubble-', '.lt-end-session-btn', 'checked', '无描述', '档案已复制到剪贴板！', 'KhEmg', '保存播放器状态失败，真是没用。', 'listen-together-ui', 'scrollTop', '吃薯条', 'wkUIL', '”的角色，现在需要写一篇交换日记。\x0a\x0a#\x20你的读者\x0a', 'transfer-backdrop', 'sticker', '获取模型失败:\x20', 'event-content-input', '确定要重新记录吗？当前的账单会被删除。', 'OeKqa', 'option', 'MabIX', 'wuTBX', '\x0a\x20\x20\x20\x20<div\x20class=\x22world-book-item\x22\x20style=\x22margin-bottom:\x2012px;\x20padding:\x2015px;\x20background:\x20white;\x20box-shadow:\x20var(--soft-shadow);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x20margin-bottom:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22font-weight:\x20500;\x22>🛒\x20', 'Srimp', '\x0a#\x20核心任务\x0a你是一个顶级多角色社交模拟引擎。你的任务是模拟一个好友圈的动态更新，一次性生成【', 'countdown-title', '》吗？', '</div></div></div>', 'location_name', '<div\x20style=\x22padding:\x2015px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2015px;\x22>', '无语但是随便吧', ']\x20[', 'diary-list-container', 'qnKMY', 'card-input', 'image/png', 'inline-block', 'delete-message-button', 'NrpZG', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22sub-title\x22>', 'edit-message-modal', '-\x20[', '书记官正在奋笔疾书...', 'SDmRT', '在你那乱七八糟的文本里没找到“歌名”！', '{charName}', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22group-options-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-clear-history\x22\x20class=\x22choice-modal-button\x22>清空聊天记录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-members\x22\x20class=\x22choice-modal-button\x22>编辑群成员</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-name\x22\x20class=\x22choice-modal-button\x22>修改群名称</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#ff4d4d;\x22>删除群聊</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-options-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x20添加了新的纪念日：', 'galgame-textbox-container', '未分类', '请看是我', 'is-entering-from-right', 'ijoVN', 'historyIndex', '\x0a\x20\x20\x20\x20姓名:\x20', 'meetingViewMode', 'cover_placeholder_', '啥意思捏', 'ended', 'OPkao', 'top', 'dzZlF', '同步已断开。', 'HREQR', 'SkRsF', 'xZpor', 'add-event-modal-title', '\x20的旧格式数据翻译。', '保存徽章状态失败', 'arGIp', 'character-item', 'getReader', '小时前聊过，可以适当问候，不要直接继续之前的话题。', 'dQsAl', '创建新角色', 'accounting-content-area', 'music', 'originalExpenses', 'endsWith', 'offline-scene-view', 'VtczS', '?word=', 'NXCHA', '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20font-size:\x200.9rem;\x20color:\x20var(--text-color);\x20margin-top:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span>', 'substring', '<br>', 'padding', 'BAMgA', 'indexOf', 'music_cover_migrated_', '已经生成了今日账单！想看就去“看账本”标签页。', 'OZcOd', 'comments', 'home-screen', '[用户发起了听歌邀请:\x20', 'wOVEU', 'group-clear-history', 'setHours', 'code', 'test_post_', 'round', 'vsmsD', 'kKLYa', 'push', '确定要删除这个条目吗？此操作不可撤销。', 'includes', '歌曲名称', '\x0a#\x20任务:\x20续写或生成聊天记录\x0a\x20\x20-\x20**内容规范**：生成【与用户/用户所在群聊完全无关的】，角色与围绕角色存在的3-5个人物的聊天内容（亲朋好友，工作伙伴等），需要符合角色设定与角色记忆。\x0a\x20\x20-\x20**首要任务**:\x20检查【已有内容】。如果里面已经有对话，你的任务是挑选1-2个对话，在原有基础上【续写】3-5条新的对话，让故事延续下去。\x0a\x20\x20-\x20**次要任务**:\x20如果你想不出怎么续写，或者觉得有必要，可以再额外创造\x201\x20个全新的虚拟联系人（NPC）和对话。\x0a\x20\x20-\x20**输出**:\x20你的输出【必须】包含【所有旧的聊天记录】和【你新续写的内容】，整合成一个完整的JSON数组返回。\x0a\x0a#\x20【\x20sender\x20字段绝对规则】(最高优先级)\x0a\x20\x20-\x20在\x20\x22log\x22\x20数组中，\x22sender\x22\x20字段的值【只能是】以下两个选项之一：\x0a\x20\x20\x20\x201.\x20\x20联系人的名字\x20(例如:\x20\x22Rin\x22)：代表【对方】在说话。\x0a\x20\x20\x20\x202.\x20\x20【固定的字符串\x20\x22character\x22】：这代表【被视奸的主角】在说话。\x0a\x20\x20-\x20**【绝对禁止】**:\x20绝对不可以在主角发言时，将\x20\x22sender\x22\x20的值写成联系人的名字。主角的发言者【必须永远】是\x20`\x22character\x22`\x20这个固定的词。\x0a\x0a#\x20示例\x20(请严格遵守此格式)\x0a\x20\x20\x20\x20\x20\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22contact_name\x22:\x20\x22Rin\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22last_message_preview\x22:\x20\x22那件事…下次见面再说吧。\x22,\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22log\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22sender\x22:\x20\x22Rin\x22,\x20\x22content\x22:\x20\x22你真的决定了吗？\x22\x20},\x20//\x20<--\x20这是对方\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22sender\x22:\x20\x22character\x22,\x20\x22content\x22:\x20\x22嗯，没时间犹豫了。\x22\x20}\x20//\x20<--\x20这【必须】是\x20\x22character\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20]', 'HgMPx', 'dKadW', 'active', 'OpenAI\x20API\x20错误:\x20', 'qXBTK', 'user-post-attachment-preview', 'Failed\x20to\x20save\x20state\x20to\x20localStorage:', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22preview_', 'https://sharkpan.xyz/f/v0qcL/dio7j0.jpg', 'music_library', 'prev-month-btn', '群聊已解散。', 'ihoYi', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>', 'member-selection-item', 'import-char-input', 'world-book-list-container', 'countdown-timer', '转给\x20', 'groupChatCreate', 'transform', 'getElementById', 'group-bg-preview', 'accountingLedger', 'preview_', 'activeMeetingScriptQueue', 'app-calendar', 'clockPosition', '<button\x20id=\x22re-record-button\x22\x20class=\x22header-button\x22>重新记录</button>', '\x0a-\x20**对话状态**:\x20群里已经有', 'https://sharkpan.xyz/f/olJt4/7z47b8.jpg', 'music-input-song', '个帖子对象。\x0a-\x20**【ID规则】**:\x20所有\x20\x22authorId\x22,\x20\x22likes\x22,\x20\x22comments\x22\x20中的作者标识，【必须】使用上面提供的角色\x20**ID**，绝对不能使用角色名字。\x0a-\x20**【JSON结构】**:\x20每个帖子对象必须遵循以下结构：\x0a\x20\x20```json\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22authorId\x22:\x20\x22发布者的ID\x22,\x0a\x20\x20\x20\x20\x22postType\x22:\x20\x22text\x20or\x20music\x22,\x0a\x20\x20\x20\x20\x22postContent\x22:\x20\x22动态的文字内容\x22,\x0a\x20\x20\x20\x20\x22songName\x22:\x20\x22如果是music类型，则必须有歌名\x22,\x0a\x20\x20\x20\x20\x22artist\x22:\x20\x22如果是music类型，则必须有歌手名\x22,\x0a\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20}\x0a\x20\x20```\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', '10021716RaUdAJ', '-\x20**你们最后一次互动是在**:\x20', 'WJRsJ', 'isPlaying', '</span>:\x20', 'JnnXl', 'expense-description', 'home-date', '谁啊我吗', '动态页背景已移除。', 'customWallpaper', 'XffXA', 'EtLfI', 'snoop-summary-textarea', '.diary-entry', '.listen-together-accept-btn', 'utterance', 'line', 'closest', '壁纸已更换！', '#a7c7e7', 'chat-message-input', 'replace', 'ILsDB', 'Gemini\x20stream\x20reading\x20aborted.', 'USyZf', 'char-edit-remark', '[AI向\x20', '</span><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2010px;\x22><span\x20class=\x22amount\x22>-\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'medium', '-\x20**状态提示**:\x20这是你的手机第一次被“看见”，生成的内容应该是你的初始状态。\x0a', '正在搜索音乐...', 'backgroundColor', '#66b3ff', 'NoirCharacterCard', 'music-input-modal', 'min', 'altar-slot-cover', 'diary-modal-save', '为你骄傲', '编辑条目', '设置已保存！', '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '这本日记本来就是空的，你还想清空什么？', '第一阶段升级完成！应用即将刷新以进行第二阶段检查。', '检测到旧版数据，已自动为您完成升级！', 'galgame-text', 'FUgjl', 'mZpUp', 'EIxOQ', '100%', '已设为当前用户！', 'zKEeR', 'oncomplete', 'KIvHE', 'user-profile-list-screen', 'https://sharkpan.xyz/f/wyeIq/phhdy2.jpg', '外卖订单', 'JxlLB', 'QhzgI', 'UxyFs', '49lbezKE', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>浏览器历史是空的。</p>', '\x0a---\x0a##\x20最近的朋友圈动态\x0a', '\x27);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22snoop-summary-textarea\x22\x20readonly\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border:\x20none;\x20outline:\x20none;\x20resize:\x20none;\x20font-family:\x20\x27Courier\x20New\x27,\x20monospace;\x20font-size:\x200.85rem;\x20line-height:\x201.6;\x20background-color:\x20#fdfdfd;\x20padding:\x2015px;\x20box-sizing:\x20border-box;\x22>', 'artist', '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。', 'sprite-slider-y', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22font-size:\x200.85rem;\x20color:\x20#28a745;\x20font-weight:\x20500;\x22>', 'marginBottom', 'xQZRd', 'font-preview-text', 'char_offline_bg_', '</p>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'IFepq', '\x20条动态...', 'ZcNeK', '\x0a#\x20已有内容\x20(这是历史记录，你必须接着写，不许动它！)\x0a```json\x0a', 'oltTe', '<path\x20d=\x22m3\x209\x209-7\x209\x207v11a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2z\x22></path><polyline\x20points=\x229\x2022\x209\x2012\x2015\x2012\x2015\x2022\x22></polyline>', '确定要恢复默认字体吗？', '有点无语', '\x27\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20data-character-name=\x27', 'vGVua', 'tWmcm', '未知商店', '#\x20总结失败了，可能是记录太长或太复杂。', 'piKXE', 'https://sharkpan.xyz/f/djjH8/29ejbg.jpg', '哼，正在净化你那些超重的音乐分享记录...', '保存壁纸失败:\x20', 'peAUj', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22\x20style=\x22font-size:\x200.7rem;\x20margin-top:\x208px;\x20text-align:\x20right;\x22>', 'ycznx', 'lastTimestamp', '<style\x20id=\x22snoop-temp-style\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20.snoop-avatar\x20{\x20\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20width:\x2030px;\x20height:\x2030px;\x20border-radius:\x2050%;\x20background:\x20#e5e7eb;\x20color:\x20#4b5563;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x20align-items:\x20center;\x20justify-content:\x20center;\x20font-weight:\x20500;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin:\x200\x208px;\x20flex-shrink:\x200;\x20align-self:\x20flex-end;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20}\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</style>', '未知歌曲', '好友圈档案柜是空的，无需净化。', 'chsNe', '_NoirCard.json', '快点哄我', 'tbweS', 'appIconPosition_app-settings', 'char-name-header', 'no-action-modal', 'width', '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-', 'DOMContentLoaded', '\x0a#\x20核心任务\x0a你是一个高度智能的档案管理员，任务是为我（用户，名为“{userName}”）和角色“{charName}”之间的私聊记录生成一份简洁、结构化的长期记忆摘要。\x0a\x0a#\x20摘要规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。严禁包含任何\x20JSON、Markdown\x20或其他解释性文字。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`memory_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以日期（`YYYY-MM-DD`）作为键。\x0a\x20\x20\x20\x20-\x20每个日期下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**精简**:\x20忽略日常问候、无意义的闲聊和重复内容。\x0a\x20\x20\x20\x20-\x20**聚焦**:\x20专注于关键信息、情感转折点、重要决定、分享的秘密、设定的约定、以及能够体现角色性格和关系变化的核心事件。\x0a\x20\x20\x20\x20-\x20**中立视角**:\x20以客观的第三人称视角进行记录。**请直接使用“{userName}”和“{charName}”这两个具体的名字**\x20来指代双方。\x0a\x0a#\x20输出示例\x0amemory_summary:\x0a\x20\x202025-09-12:\x0a\x20\x20\x20\x20-\x20\x22userName}\x20表达了对最近工作压力的烦恼。\x22\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20分享了自己过去类似的经历来安慰\x20{userName}，并提议周末一起去看电影。\x22\x0a\x20\x20\x20\x20-\x20\x22双方约定周六下午在市中心的电影院见面，并确定观看电影《夏日终曲》。\x22\x0a\x20\x202025-09-13:\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20发来一张猫咪的图片，心情看起来不错。\x22\x0a\x20\x20\x20\x20-\x20\x22{userName}\x20讨论了关于一个新项目的想法，{charName}\x20给出了一些关键建议。\x22\x0a\x0a#\x20输入格式\x0a我将为你提供完整的聊天记录，格式如下：\x0a[YYYY-MM-DD\x20HH:MM]\x20[说话人]:\x20聊天内容\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的聊天记录全文，并生成一份\x20YAML\x20格式的摘要。直接从\x20`memory_summary:`\x20开始输出。\x0a', '角色“', 'character-edit-title', '<div\x20style=\x22background:\x20var(--card-bg);\x20border-radius:\x2012px;\x20overflow:\x20hidden;\x20border:\x201px\x20solid\x20var(--border-color);\x22>', '交给我吧', 'visible', 'delete-friend-circle-button', 'outerHTML', 'sprite-slider-x', 'NOzIx', 'remove-font-button', 'writeText', 'exec', 'group-chat-member-list', '找不到角色。', 'aiGpa', '保存失败，你的表情包是不是太多了？', 'back-to-circle-list-from-feed', '净化完成！总共迁移了\x20', 'ZObsR', 'ykTzw', '\x0a#\x20交换日记摘要\x20(你和\x20', '确定要导入全量备份文件吗？这将覆盖所有当前数据（包括图片和音乐），且操作不可撤销！', '\x0a\x20\x20\x20\x20<div\x20id=\x22', 'gemini', 'KVgmk', '#d1d5db', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/epv2AAAAABJRU5ErkJggg==', '加载聊天失败:\x20', 'end', '<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22><div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22><span\x20style=\x22background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20width:\x2040px;\x20height:\x2040px;\x20display:\x20inline-flex;\x20justify-content:\x20center;\x20align-items:\x20center;\x20flex-shrink:\x200;\x20color:\x20var(--accent-color);\x22>', 'eZuhz', 'sWoNc', 'galgame-speaker', 'WRQfw', 'novel', 'backgroundPosition', 'xiLCZ', 'input[type=\x22checkbox\x22]', 'McPaF', 'BUFrZ', 'BmyeH', '无标题笔记', 'absolute', '.snoop-clear-btn', 'netease', 'query', '正在构思中，请稍候...', '<button\x20id=\x22snoop-app-refresh-btn\x22\x20class=\x22snoop-app-header-button\x22>刷新</button>', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>', '\x0a\x0a##\x20世界书条目:\x20', '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>', 'ilwkm', 'test', 'qnTDR', '<p\x20style=\x22text-align:\x20center;\x20color:\x20#999;\x20padding-top:\x2020px;\x22>没有外卖订单。</p>', 'musicPlaylist', 'delete-user-profile-button', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20', 'https://sharkpan.xyz/f/4aqCj/gp13hn.jpg', '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011V7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v4\x22></path><line\x20x1=\x2210\x22\x20y1=\x2216\x22\x20x2=\x2210\x22\x20y2=\x2223\x22></line><line\x20x1=\x2214\x22\x20y1=\x2216\x22\x20x2=\x2214\x22\x20y2=\x2223\x22></line>', '\x0a##\x20', '总得说点什么吧？', 'muxSm', 'expense-amount', 'XGPow', 'anthropic', 'fIJIZ', 'images', 'bpVGM', 'AWzoB', '\x20张旧的音乐封面。', '星期六', 'spriteTransform', 'LlLSC', '\x22\x20的聊天记录吗？此操作不可撤销。', 'appState', '\x20说：“', 'quotedMessage', '星期三', 'xrpGf', '<rect\x20x=\x223\x22\x20y=\x223\x22\x20width=\x2218\x22\x20height=\x2218\x22\x20rx=\x222\x22\x20ry=\x222\x22></rect><circle\x20cx=\x228.5\x22\x20cy=\x228.5\x22\x20r=\x221.5\x22></circle><polyline\x20points=\x2221\x2015\x2016\x2010\x205\x2021\x22></polyline>', '\x0a\x0a#\x20任务要求\x0a1.\x20\x20**全局视角**:\x20扮演所有成员，思考他们看到这条动态（包括图片）后会作何反应。\x0a2.\x20\x20**生成互动**:\x20为每个角色决定是否点赞，以及要发表什么评论。评论必须符合角色性格并与所有已知信息（聊天、日记等）相关联。\x0a3.\x20\x20**输出格式**:\x20你的输出必须是一个单一、完整的JSON对象，结构如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a-\x20【绝对规则】:\x20所有ID必须使用上面提供的角色ID，不能用名字。\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。\x0a', 'FskcR', 'Noir_FileSystem', 'yJySl', 'zPbrL', 'iAXSe', 'diary-action-modal-', '正在处理图片...', 'forceWhiteClock', 'snoop-app-view-container', '加载更多聊天记录', 'user-avatar-frame-url-in-chat', 'back-to-snoop-list-from-phone', 'export-all-data-button', 'RdHFt', 'YUdqC', '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a', 'rtxsT', 'DqWWh', 'timeupdate', 'gJFUi', 'preferences', 'giAEb', 'Detected\x20API\x20provider:\x20', '好友圈\x20', 'yAeCD', 'eventContent', '\x22\x20style=\x22box-shadow:\x20none;\x20border:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<p>', 'XogpF', 'important', 'diary-page-', 'iogis', '</span><button\x20class=\x22delete-expense-btn\x22\x20data-id=\x22', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x0a-\x20你正在为一个名为“', 'toLocaleDateString', 'HcuEy', '的转账', 'groupSettings', 'role', 'normal,\x20happy,\x20angry,\x20sad,\x20shy', '未知商品', 'user-profile-edit-title', 'qCvvx', 'sdIsD', 'rRDLl', 'lJsXB', 'vnWhj', 'WTzyb', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '#message-anchor', '你的任务是【首次生成】这个应用的内容。', 'RNRkv', 'dpHNZ', 'dZuYz', 'KHmWW', 'cancel-event-button', '\x20张旧的动态图片。', 'xIhDQ', '正在打包“', 'coverUrl', 'editing-char-id', 'remark', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22color:\x20var(--text-color-light);\x20font-size:\x201.2rem;\x20margin-left:\x20auto;\x20font-weight:\x20200;\x22>›</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'gAYhw', '\x20内容失败:', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'oYBdd', 'friendCircles', '未知搜索', '哼，正在开始净化你那被污染的聊天记录...', 'app-pages-container', 'friend-circle-list-screen', 'TFAlj', 'todo-list', 'dIlOx', '哼，不好好写清楚花在哪、花了多少，我怎么记？', 'keydown', '数据导入成功！应用即将刷新...', '购物消费', 'nPLmI', '》。\x0a这是当前的歌词，请注意带\x20\x27>>\x27\x20标记的正是正在播放的句子。\x0a\x0a[歌词开始]\x0a', 'borderBottom', '图标处理失败:\x20', 'chat-image-button', 'PhFSs', 'app-diary', 'readAsDataURL', '这是一条由控制台添加的测试动态！样式看起来非常完美。', 'QFCUD', 'app-music', '】进行回复。\x0a不要替其他角色续写台词，不要输出\x22', 'play', 'card-input-2', '条目已删除。', '<div\x20id=\x22snoop-dock\x22></div>', '<path\x20d=\x22M12\x202v20\x22></path><path\x20d=\x22M4\x2012h16\x22></path>', 'snoopPhone', 'EQEWx', 'music_cover_', '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'UDOfX', 'wCeaC', 'xHTQb', 'songId', 'catch', 'wzFGB', 'is-entering-from-left', '28%', 'todo', '<p\x20style=\x22margin:\x20auto;\x20text-align:\x20center;\x20color:\x20red;\x22>加载失败了，哼。<br>', 'cos', '名字不能为空！', 'galgame-time', '说了是摆设啦，笨蛋。', 'https://sharkpan.xyz/f/MWOIa/rb3nov.jpg', 'value', '内容不能为空！', 'QVpbR', 'slice', '净化音乐封面时出错，真是的。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>', 'https://sharkpan.xyz/f/G0dTl/4qad2i.jpg', '你好，世界\x20(Hello,\x20World)', 'Oasom', '你是一个乐于助人的助手。', 'sprite-slider-scale', 'activity_description', 'reset-widget-bg-button', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', 'bVMeO', 'snoop_cache', '”的补充信息\x0a', 'YAML翻译机也无法理解这段梦话。', 'orfjk', '清空聊天记录失败。', 'TLodw', '来源：[最活跃]', 'paddingBottom', 'column', 'iBwuX', '回复\x20', 'Fkprl', 'cnhNC', 'YhoJO', 'span', 'kNyfb', 'settings-screen', '批量生成动态失败:\x20', 'RrBGz', '图片加载失败', ',\x20ID:\x20', 'provider', 'bdwBr', 'readAsText', 'UHzRA', 'application/json', 'KJrOG', 'galgame-sprite-controls', '群聊「', 'YjKgy', 'JPMbW', 'crYyl', 'umOhO', 'rgba(0,\x200,\x200,\x200.4)', '\x0a##\x20条目:\x20', 'ENhOy', 'find', 'Mpqgl', '\x0a\x0a#\x20任务流程\x0a1.\x20\x20**全局视角**:\x20审视所有成员的人设和近期记忆（包括聊天、日记等），构思他们之间可能发生的有趣互动。\x0a2.\x20\x20**选择作者**:\x20从上述成员中，为', 'cancel-music-input', '\x0a#\x20你的日程与纪念日\x20(由\x20', 'jMpEa', 'sender', 'poNej', 'wallpaper', 'timestamp', 'ayffP', 'snoop-home-date', 'tLVLY', '</div></div><div\x20id=\x22categorized-expenses-list\x22\x20style=\x22margin-top:\x2010px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2010px;\x22></div>', '--feed-bg-image', 'items', '>>\x20', 'reset-widgets-position-button', 'CzWpk', 'diaryPressTimer', 'ZvMHg', '已选择\x20', 'user-post-textarea', 'hSHry', '...', 'cardWidgetState', '\x20的私聊', 'NLAfF', 'dnVAk', '\x22\x20class=\x22post-image\x22></div>', 'modal-root', 'JSON\x20解析失败!\x20错误原因:', 'vVXVs', 'global-player-play-pause-btn', 'gLdLv', 'activeDiaryCharacterId', 'insertAdjacentHTML', '<path\x20d=\x22M6\x202L3\x206v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2V6l-3-4z\x22></path><line\x20x1=\x223\x22\x20y1=\x226\x22\x20x2=\x2221\x22\x20y2=\x226\x22></line><path\x20d=\x22M16\x2010a4\x204\x200\x200\x201-8\x200\x22></path>', 'Claude\x20API\x20错误:\x20', 'keys', 'short', 'cost', 'currentAbortController', '35%', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'AI\x20试图创建事件，但找不到有效的用户ID。']; _0x1778 = function () { return _0x5a98a9; }; return _0x1778(); } function _0x32f36c(_0x475e64) { return new Promise((_0x536698, _0x3e0749) => { const _0x378e20 = _0x4d19; if (_0x378e20(0x6af) === _0x378e20(0x6af)) { const _0x3d3d5e = new FileReader(); _0x3d3d5e[_0x378e20(0x1b9)] = () => _0x536698(_0x3d3d5e[_0x378e20(0x774)]), _0x3d3d5e['onerror'] = _0x3e0749, _0x3d3d5e['readAsDataURL'](_0x475e64); } else _0x9bea75(), _0x53210a(!![]); }); } function _0x21a8ec(_0x565ad8, _0x555e34, _0x712e0f) { const _0x26d324 = _0x2ad71a, _0x41c2b0 = _0x310f04 => { const _0xa8c2b2 = _0x4d19; if (_0xa8c2b2(0x737) !== _0xa8c2b2(0x9d5)) { if (_0x310f04[_0xa8c2b2(0x9e8)] === 'user') return _0x2de116[_0xa8c2b2(0xb88)]?.['name'] || _0xa8c2b2(0xb4d); if (_0x565ad8[_0xa8c2b2(0x318)] === _0xa8c2b2(0x366)) { if (_0xa8c2b2(0x247) === 'ydTVz') { const _0x5cf402 = _0x310f04[_0xa8c2b2(0x4b1)] ? _0x1296c0(_0x310f04[_0xa8c2b2(0x4b1)]) : null; return _0x5cf402?.[_0xa8c2b2(0x499)] || _0xa8c2b2(0x681); } else _0x475638[_0x312dae] = _0x5280b4[_0xa8c2b2(0x57f)](_0x3a5b01); } else { const _0x4e6424 = _0x1296c0(_0x565ad8[_0xa8c2b2(0x6a3)][0x0]); return _0x4e6424?.[_0xa8c2b2(0x499)] || 'AI'; } } else _0x27c2bc > _0x59d451 && (_0x3c6f24 *= _0x520489 / _0x597838, _0x35a798 = _0x277eaa); }, _0x4ed06c = _0x555e34[_0x26d324(0xa38)](-_0x712e0f), _0x5f0d64 = []; for (const _0x51c1cb of _0x4ed06c) { const _0x228091 = new Date(_0x51c1cb[_0x26d324(0xa71)])[_0x26d324(0x700)](_0x26d324(0x2e3), { 'hour': _0x26d324(0x748), 'minute': '2-digit' }); _0x51c1cb['content'] && (_0x26d324(0xa49) === _0x26d324(0xa49) ? _0x5f0d64[_0x26d324(0x8d9)]('[' + _0x228091 + ']\x20[' + _0x41c2b0(_0x51c1cb) + ']\x20' + String(_0x51c1cb[_0x26d324(0x5e2)])[_0x26d324(0x44c)]()) : (_0x5e0194[_0x26d324(0xa05)] = _0x380ea8[_0x26d324(0xa05)][_0x26d324(0x3cf)](_0xef597c => _0xef597c['id'] !== _0x3ebfbe), _0x2c47e5[_0x26d324(0x42d)] === _0x24d9ff && (_0x4080b2[_0x26d324(0x42d)] = null), _0x2fdba6(), _0x236384(_0x26d324(0xafd)), _0x25184c(), _0x543139(_0x26d324(0x640), _0x26d324(0x604)))); } return _0x5f0d64; } function _0x1bf7f4(_0x441734) { const _0x19b5a3 = _0x2ad71a; if (_0x441734[_0x19b5a3(0x318)] === 'group') return _0x19b5a3(0xa60) + (_0x441734['name'] || _0x19b5a3(0x47a)) + '」'; const _0x5b68e2 = _0x1296c0(_0x441734[_0x19b5a3(0x6a3)][0x0]); return '与\x20' + (_0x5b68e2?.[_0x19b5a3(0x499)] || _0x19b5a3(0x67e)) + _0x19b5a3(0xa82); } function _0xce240b(_0x3dab2c) { const _0x1bf894 = _0x2ad71a; try { const _0x21188f = localStorage[_0x1bf894(0x54d)](_0x1bf894(0xb7a) + _0x3dab2c), _0x50cae7 = JSON[_0x1bf894(0x57f)](_0x21188f || '[]'); return Array['isArray'](_0x50cae7) ? _0x50cae7 : []; } catch { if (_0x1bf894(0x224) === _0x1bf894(0x224)) return []; else { if (_0x46aba5) _0x31c2c7[_0x1bf894(0x1cd)] = '▶'; } } } function _0x888912(_0x4322b9) { const _0x1dd73f = _0x2ad71a, _0x37eba4 = Math[_0x1dd73f(0x68e)](0x1, Number(_0x2de116['preferences']?.[_0x1dd73f(0x6cd)] ?? 0x64)), _0x54b118 = _0x2de116[_0x1dd73f(0x6b7)][_0x1dd73f(0x3cf)](_0x3749f8 => _0x3749f8[_0x1dd73f(0x6a3)][_0x1dd73f(0x8db)](_0x4322b9)), _0x3cfd82 = _0x54b118[_0x1dd73f(0x7c6)](_0xaeb04a => { const _0x177d57 = _0x1dd73f, _0x11d15b = _0xce240b(_0xaeb04a['id']), _0x2f4cd1 = _0x11d15b[_0x177d57(0xaa7)] > 0x0 ? _0x11d15b[_0x11d15b['length'] - 0x1] : null; return { 'chat': _0xaeb04a, 'history': _0x11d15b, 'lastTimestamp': _0x2f4cd1 ? _0x2f4cd1[_0x177d57(0xa71)] : 0x0 }; })[_0x1dd73f(0x3cf)](_0x249f5b => _0x249f5b[_0x1dd73f(0x5fc)][_0x1dd73f(0xaa7)] > 0x0); _0x3cfd82[_0x1dd73f(0xb71)]((_0x31ffc2, _0x545b2a) => _0x545b2a[_0x1dd73f(0x95f)] - _0x31ffc2[_0x1dd73f(0x95f)]); const _0x55eec8 = [], _0x41b81b = {}; return _0x3cfd82['forEach']((_0x185470, _0x37b216) => { const _0x1ee33a = _0x1dd73f, _0x4bb89e = _0x21a8ec(_0x185470[_0x1ee33a(0x780)], _0x185470[_0x1ee33a(0x5fc)], _0x37eba4); if (_0x4bb89e[_0x1ee33a(0xaa7)] === 0x0) return; const _0x5abed2 = _0x37b216 === 0x0 ? '来源：[最活跃]' : _0x1ee33a(0x6c7); _0x55eec8[_0x1ee33a(0x8d9)]('##\x20' + _0x5abed2 + _0x1bf7f4(_0x185470['chat']) + '\x0a' + _0x4bb89e['join']('\x0a')), _0x41b81b[_0x185470['chat']['id']] = _0x4bb89e['length']; }), { 'omniText': _0x55eec8[_0x1dd73f(0x6cf)]('\x0a\x0a'), 'usedCounts': _0x41b81b }; } function _0x5d182c(_0x4443a1) { const _0x49d82f = _0x2ad71a; let _0x56595b = null; const _0x3601dc = _0x2de116[_0x49d82f(0x6b7)][_0x49d82f(0x3cf)](_0x7690f3 => _0x7690f3[_0x49d82f(0x6a3)][_0x49d82f(0x8db)](_0x4443a1)); for (const _0x5ce7c8 of _0x3601dc) { if ('BJmCU' === _0x49d82f(0xa9e)) { const _0x1b91c8 = _0xce240b(_0x5ce7c8['id']); if (_0x1b91c8 && _0x1b91c8[_0x49d82f(0xaa7)] > 0x0) { if (_0x49d82f(0x1b3) !== _0x49d82f(0x1b3)) { const _0x11562e = _0x3b7054(_0x417407[_0x49d82f(0x5e2)]); _0x51a3ec['assign'](_0x5a7f93, { 'content': _0x11562e[_0x49d82f(0x5e2)], 'quotedMessage': _0x11562e[_0x49d82f(0x9bd)] }); } else { const _0x2bc429 = _0x1b91c8[_0x1b91c8[_0x49d82f(0xaa7)] - 0x1]; (!_0x56595b || _0x2bc429['timestamp'] > _0x56595b['timestamp']) && (_0x56595b = _0x2bc429); } } } else _0x18ee43(_0x49d82f(0xa14) + _0x202c60[_0x49d82f(0x722)]); } return _0x56595b; } function _0x1cc06f(_0x23ed22) { const _0x5e809a = _0x2ad71a; if (!_0x23ed22 || !_0x23ed22[_0x5e809a(0x8db)](',')) return _0x23ed22; const _0x17ea98 = _0x23ed22[_0x5e809a(0x500)](',')[_0x5e809a(0x7c6)](_0x26638c => _0x26638c['trim']()); return _0x17ea98[Math[_0x5e809a(0x1e2)](Math[_0x5e809a(0x77b)]() * _0x17ea98[_0x5e809a(0xaa7)])]; } function _0x2244b3(_0x119cbc) { return new Promise(_0x372b57 => { const _0x18ca1e = _0x4d19, _0x3f038e = document[_0x18ca1e(0x8f3)](_0x18ca1e(0xa86)), _0x42d20a = document[_0x18ca1e(0x8f3)]('modal-text'), _0x4d5684 = document[_0x18ca1e(0x8f3)](_0x18ca1e(0x7e9)), _0x236ca4 = document[_0x18ca1e(0x8f3)](_0x18ca1e(0x333)), _0x529cf0 = document['getElementById']('modal-mask'); _0x42d20a[_0x18ca1e(0x1cd)] = _0x119cbc, _0x3f038e[_0x18ca1e(0x3e0)][_0x18ca1e(0xab9)] = _0x18ca1e(0x47f); const _0x5efa7e = _0xdca4a1 => { const _0x20fc57 = _0x18ca1e; _0x3f038e[_0x20fc57(0x3e0)][_0x20fc57(0xab9)] = 'none', _0x4d5684['onclick'] = _0x236ca4[_0x20fc57(0x7a5)] = _0x529cf0['onclick'] = null, document[_0x20fc57(0x2f8)](_0x20fc57(0xa0e), _0x356cce), _0x372b57(_0xdca4a1); }, _0x356cce = _0x5c31fe => { const _0xef2d3a = _0x18ca1e; if (_0xef2d3a(0xae2) === 'EhQOJ') { const _0x40b6f4 = _0x47131c['getElementById'](_0xef2d3a(0x8ee)); _0x40b6f4['innerHTML'] = ''; if (_0x1f6324[_0xef2d3a(0x432)][_0xef2d3a(0xaa7)] === 0x0) { _0x40b6f4[_0xef2d3a(0x82c)] = _0xef2d3a(0x99f); return; } _0x420457[_0xef2d3a(0x432)][_0xef2d3a(0x201)](_0x15649d => { const _0x51c7fb = _0xef2d3a, _0x64b327 = _0x197f33[_0x51c7fb(0xb35)](_0x51c7fb(0x4e8)); _0x64b327[_0x51c7fb(0xaff)] = _0x51c7fb(0x4f2), _0x64b327['dataset']['id'] = _0x15649d['id'], _0x64b327[_0x51c7fb(0x82c)] = _0x51c7fb(0xb8c) + _0x15649d['name'] + _0x51c7fb(0x91c) + _0x15649d[_0x51c7fb(0x5e2)][_0x51c7fb(0x8c6)](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20', _0x64b327[_0x51c7fb(0x85f)](_0x51c7fb(0xbba), () => _0x2b8509(_0x15649d['id'])), _0x40b6f4[_0x51c7fb(0x3bf)](_0x64b327); }); } else { if (_0x5c31fe['key'] === _0xef2d3a(0x756)) _0x5efa7e(![]); if (_0x5c31fe['key'] === 'Enter') _0x5efa7e(!![]); } }; _0x4d5684[_0x18ca1e(0x7a5)] = () => _0x5efa7e(!![]), _0x236ca4[_0x18ca1e(0x7a5)] = () => _0x5efa7e(![]), _0x529cf0[_0x18ca1e(0x7a5)] = () => _0x5efa7e(![]), document['addEventListener'](_0x18ca1e(0xa0e), _0x356cce); }); } function _0x15e83d(_0x1ff847) { const _0xb78111 = _0x2ad71a, _0x25d7c5 = document[_0xb78111(0x8f3)](_0xb78111(0x7e5)); _0x25d7c5[_0xb78111(0x1cd)] = _0x1ff847, _0x25d7c5[_0xb78111(0x3e0)][_0xb78111(0xab9)] = _0xb78111(0x5ac); if (_0x15e83d['_t']) clearTimeout(_0x15e83d['_t']); _0x15e83d['_t'] = setTimeout(() => { const _0x25b5ad = _0xb78111; if ('yGocE' === _0x25b5ad(0x68c)) { _0x597ccb(_0x25b5ad(0x551)); return; } else _0x25d7c5[_0x25b5ad(0x3e0)]['display'] = _0x25b5ad(0x1bf); }, 0x640); } function _0x453cab() { const _0x37f781 = _0x2ad71a, _0x188df6 = document['getElementById'](_0x37f781(0xa08)), _0x412349 = document[_0x37f781(0x8f3)]('app-pages-slider'), _0x553ba7 = document[_0x37f781(0x672)](_0x37f781(0x6f4)), _0x217608 = document[_0x37f781(0x8f3)]('home-dock'); let _0x1b73e1 = 0x0; _0x412349[_0x37f781(0x3e0)]['width'] = _0x37f781(0xace); const _0x2c5147 = 0x3; function _0x3b510f(_0xae1dfb) { const _0x38ddca = _0x37f781; if (_0x38ddca(0x513) !== _0x38ddca(0x513)) _0x4f12e4(), _0x32a73e(![]); else { if (_0xae1dfb < 0x0 || _0xae1dfb >= _0x2c5147) return; _0x412349[_0x38ddca(0x3e0)][_0x38ddca(0x8f2)] = 'translateX(-' + _0xae1dfb * (0x64 / _0x2c5147) + '%)', _0x553ba7[_0x38ddca(0x201)](_0x40e2b6 => _0x40e2b6[_0x38ddca(0x51c)][_0x38ddca(0x2e4)](_0x38ddca(0x8e0))), _0x553ba7[_0xae1dfb][_0x38ddca(0x51c)]['add'](_0x38ddca(0x8e0)), _0x1b73e1 = _0xae1dfb, _0xae1dfb === 0x0 ? _0x217608[_0x38ddca(0x3e0)][_0x38ddca(0xab9)] = _0x38ddca(0x1bf) : _0x38ddca(0x7c0) !== 'YbtzV' ? _0x217608[_0x38ddca(0x3e0)]['display'] = _0x38ddca(0x47f) : _0x377ea9[_0x38ddca(0x3e0)][_0x38ddca(0xab9)] = 'none'; } } _0x3b510f(0x0), _0x553ba7['forEach'](_0x4b4415 => { const _0x5b8e88 = _0x37f781; _0x4b4415[_0x5b8e88(0x85f)](_0x5b8e88(0xbba), () => { const _0xa28651 = _0x5b8e88; if ('pQDpH' !== 'efJKQ') { const _0x2525e1 = parseInt(_0x4b4415[_0xa28651(0xb40)][_0xa28651(0x2cb)], 0xa); _0x3b510f(_0x2525e1); } else { _0xce0846(_0xa28651(0xa31)); return; } }); }); let _0x1d22ef = 0x0, _0x57b451 = 0x0, _0x254b06 = 0x0, _0x556437 = ![], _0x11d188 = ''; _0x188df6['addEventListener']('touchstart', _0x2fb614 => { const _0x4dd3c7 = _0x37f781; _0x1d22ef = _0x2fb614[_0x4dd3c7(0xa99)][0x0]['clientX'], _0x57b451 = _0x2fb614['touches'][0x0][_0x4dd3c7(0x778)], _0x556437 = !![], _0x11d188 = ''; }, { 'passive': !![] }), _0x188df6[_0x37f781(0x85f)](_0x37f781(0x33b), _0x2fecd5 => { const _0x5ac0ab = _0x37f781; if (!_0x556437) return; if (_0x11d188 === '') { const _0x284b63 = _0x2fecd5[_0x5ac0ab(0xa99)][0x0][_0x5ac0ab(0xb3e)] - _0x1d22ef, _0xd27a54 = _0x2fecd5[_0x5ac0ab(0xa99)][0x0][_0x5ac0ab(0x778)] - _0x57b451; Math[_0x5ac0ab(0x5a1)](_0x284b63) > Math[_0x5ac0ab(0x5a1)](_0xd27a54) ? _0x11d188 = _0x5ac0ab(0x4e9) : 'DdFfj' !== _0x5ac0ab(0x6ad) ? _0x11d188 = 'vertical' : _0x3d6a30[_0x5ac0ab(0x82c)] = '<span\x20style=\x22opacity:\x200.6;\x22>无</span>'; } if (_0x11d188 === _0x5ac0ab(0x4e9)) { if ('clFwX' !== 'ISaLJ') _0x2fecd5[_0x5ac0ab(0xb16)](); else { const _0x5e1834 = _0x28629e['likes'][_0x5ac0ab(0x7c6)](_0x5b282b => _0x5b4bfa(_0x5b282b)?.[_0x5ac0ab(0x499)] || '未知')[_0x5ac0ab(0x6cf)]('、'), _0x5edc0f = _0x5ac0ab(0x96b); _0x4a5205 = '<div\x20class=\x22post-likes\x22>' + _0x5edc0f + '\x20' + _0x5e1834 + '</div>'; } } }, { 'passive': ![] }), _0x188df6[_0x37f781(0x85f)]('touchend', _0x107f8e => { const _0x270ca0 = _0x37f781; if ('ddybj' !== _0x270ca0(0x4cd)) { const _0x3a71d4 = _0x3b2a42[_0x270ca0(0xae1)]?.[_0x270ca0(0x8db)](_0x348d50['id']), _0x19f7dc = _0x77a404[_0x270ca0(0xb35)](_0x270ca0(0x4eb)); _0x19f7dc[_0x270ca0(0x82c)] = _0x270ca0(0x5f2) + _0x2451a7['id'] + '\x22\x20' + (_0x3a71d4 ? _0x270ca0(0x875) : '') + '>\x20' + _0x581bfc['name'], _0xa49ae9[_0x270ca0(0x3bf)](_0x19f7dc); } else { if (!_0x556437) return; _0x254b06 = _0x107f8e['changedTouches'][0x0][_0x270ca0(0x35a)], _0x11d188 === _0x270ca0(0x4e9) && (_0x270ca0(0x798) === 'eZUsV' ? _0x590839() : (_0x170770[_0x270ca0(0x3e0)]['color'] = _0x270ca0(0x743), _0x5c0d66[_0x270ca0(0x3e0)][_0x270ca0(0x28a)] = _0x270ca0(0x43a))), _0x556437 = ![]; } }); function _0x590839() { const _0x710ad8 = _0x37f781, _0x325a23 = 0x32; if (_0x254b06 < _0x1d22ef - _0x325a23) _0x710ad8(0x465) !== _0x710ad8(0x465) ? (_0x4abc5f[_0x710ad8(0x27b)](_0x710ad8(0x204), _0x5ea1d8), _0x5adbc6[_0x710ad8(0xa9c)] = '') : _0x3b510f(_0x1b73e1 + 0x1); else _0x254b06 > _0x1d22ef + _0x325a23 && (_0x710ad8(0xa5a) !== 'Oacbc' ? _0x3b510f(_0x1b73e1 - 0x1) : (_0x4ea85d = '0x' + _0x567065[0x1] + _0x1297cd[0x2], _0x3f1f99 = '0x' + _0x4493a2[0x3] + _0x4f4034[0x4], _0x197565 = '0x' + _0x227efa[0x5] + _0x195dea[0x6])); } } function _0x29ff8f() { return new Promise(_0x1974a4 => { const _0x591e7f = _0x4d19, _0x295726 = document[_0x591e7f(0x8f3)](_0x591e7f(0x923)), _0x100caa = document[_0x591e7f(0x8f3)](_0x591e7f(0x8fd)), _0x2fb4ef = document[_0x591e7f(0x8f3)]('music-input-artist'), _0x552e43 = document[_0x591e7f(0x8f3)](_0x591e7f(0x5ff)), _0x524c31 = document['getElementById'](_0x591e7f(0xa6b)), _0x1c006e = document[_0x591e7f(0x8f3)](_0x591e7f(0x7b9)); _0x100caa[_0x591e7f(0xa35)] = '', _0x2fb4ef[_0x591e7f(0xa35)] = '', _0x295726[_0x591e7f(0x51c)][_0x591e7f(0x6dd)](_0x591e7f(0x530)), _0x100caa[_0x591e7f(0x2e0)](); const _0x17aa59 = _0x492755 => { const _0x138afd = _0x591e7f; if ('bISKA' === 'IBsHw') { if (_0x122b56['name'] === 'AbortError') return _0x3fea27['log'](_0x138afd(0x2fe)), ''; throw _0x3a1116; } else _0x295726['classList'][_0x138afd(0x2e4)](_0x138afd(0x530)), _0x552e43['onclick'] = null, _0x524c31[_0x138afd(0x7a5)] = null, _0x1c006e['onclick'] = null, document[_0x138afd(0x2f8)](_0x138afd(0xa0e), _0x262561), _0x1974a4(_0x492755); }, _0x18d151 = () => { const _0xc6abf6 = _0x591e7f, _0x3fa24c = _0x100caa[_0xc6abf6(0xa35)]['trim'](), _0xf6f774 = _0x2fb4ef[_0xc6abf6(0xa35)][_0xc6abf6(0x44c)](); if (!_0x3fa24c || !_0xf6f774) { if (_0xc6abf6(0xa16) !== 'PhFSs') _0x276faf(), _0x16c07c('musicLibrary', _0xc6abf6(0x4ab)); else { _0x15e83d('歌名和歌手都不能为空！'); return; } } _0x17aa59({ 'songName': _0x3fa24c, 'artist': _0xf6f774 }); }, _0x262561 = _0x90b67f => { const _0x518cc9 = _0x591e7f; if (_0x518cc9(0x54b) !== _0x518cc9(0x3e8)) { if (_0x90b67f[_0x518cc9(0x64a)] === _0x518cc9(0x756)) _0x17aa59(null); _0x90b67f['key'] === _0x518cc9(0xb56) && ('wrFFI' === _0x518cc9(0x66a) ? _0x3809a5[_0x518cc9(0x38d)] === _0x266785 && (_0x329350[_0x518cc9(0x38d)] = _0x12289b[_0x518cc9(0xabe)]) : (_0x90b67f[_0x518cc9(0xb16)](), _0x18d151())); } else _0x3fec74 = _0x4673b5[_0x518cc9(0x41d)] || _0x17f30e, _0x2da54c = _0x46b865[_0x518cc9(0x499)] || _0x518cc9(0x1e5), _0x1c486d = _0x29c854[_0x518cc9(0x9ff)] || '私聊'; }; _0x552e43['onclick'] = _0x18d151, _0x524c31['onclick'] = () => _0x17aa59(null), _0x1c006e[_0x591e7f(0x7a5)] = () => _0x17aa59(null), document[_0x591e7f(0x85f)](_0x591e7f(0xa0e), _0x262561); }); } function _0x4af2aa(_0x360910) { const _0x2a43ff = _0x2ad71a; if (!_0x360910) return []; const _0x4f32fd = _0x360910[_0x2a43ff(0x44c)](); if (_0x4f32fd['startsWith']('<div') && _0x4f32fd[_0x2a43ff(0x8c0)](_0x2a43ff(0x806))) return [_0x4f32fd]; const _0x386591 = /(\[sticker:[^\]]+\]|\[music:[^\]]+\]|\[transfer:[^\]]+\]|\[create_event:[^\]]+\])/g, _0x315ad1 = '|||CMD|||', _0x951ae7 = [], _0x23274c = _0x360910['replace'](_0x386591, _0x31910b => { const _0x215d51 = _0x2a43ff; if ('OvSdp' === _0x215d51(0x93b)) _0x15f3bd[_0x215d51(0x82c)] = '', _0x387963[_0x215d51(0x201)](_0x38f5fa => { const _0x202829 = _0x215d51, _0x323a0a = _0x105ca5['createElement']('img'); _0x323a0a[_0x202829(0xa9c)] = _0x38f5fa[_0x202829(0xb77)], _0x323a0a['loading'] = _0x202829(0x1eb), _0x323a0a[_0x202829(0x773)] = _0x38f5fa[_0x202829(0x499)], _0x323a0a[_0x202829(0x51c)][_0x202829(0x6dd)](_0x202829(0x7f5)), _0x323a0a[_0x202829(0x85f)](_0x202829(0xbba), () => _0x177c7e(_0x38f5fa)), _0x204ada['appendChild'](_0x323a0a); }); else return _0x951ae7['push'](_0x31910b), _0x315ad1; }), _0x373d1 = _0x23274c[_0x2a43ff(0x500)](_0x315ad1), _0x255169 = []; let _0x3a2285 = 0x0; return _0x373d1['forEach']((_0x26c248, _0x1db181) => { const _0x364838 = _0x2a43ff; if (_0x364838(0x739) !== _0x364838(0x21f)) { const _0x26605e = _0x26c248[_0x364838(0x44c)](); if (_0x26605e) { if (_0x364838(0x7b6) !== _0x364838(0x86c)) _0x255169['push'](..._0xb65dc1(_0x26605e)); else { const _0x4f3bc6 = _0x7421e ?? _0x2337de['value']['trim'](); if (_0x4f3bc6 === '' || !_0x475b77[_0x364838(0xb7c)]) return; const _0x3d7034 = _0x4492aa[_0x364838(0xac8)](_0x364838(0x20d)), _0x3abb31 = _0x3d7034['id'] === _0x364838(0x5d0), _0x13592d = { 'role': 'user', 'content': _0x4f3bc6, 'timestamp': _0x52f892[_0x364838(0x83b)](), 'isOffline': _0x3abb31 }; _0x3794f8[_0x364838(0xa9b)] && (_0x13592d[_0x364838(0x9bd)] = { ..._0x5163ef[_0x364838(0xa9b)] }), _0xb4b86a['conversationHistory'][_0x364838(0x8d9)](_0x13592d), _0x56e790(), _0x46d028(), !_0xeac37 && (_0x54e8e6[_0x364838(0xa35)] = ''), _0x2bbe47(); } } _0x3a2285 < _0x951ae7[_0x364838(0xaa7)] && (_0x364838(0x510) === _0x364838(0x446) ? _0xfc065f[_0x364838(0x8d9)]('[' + _0x9ccc82(_0x296884) + ']\x20[sticker:' + (_0xfb878e[_0x364838(0x5e2)]?.[_0x364838(0x435)](/：(.+?)]/)?.[0x1] || '表情') + ']') : (_0x255169[_0x364838(0x8d9)](_0x951ae7[_0x3a2285][_0x364838(0x44c)]()), _0x3a2285++)); } else _0xedb81c['error'](_0x364838(0x572), _0x32db28), _0x4bdada[_0x364838(0x652)] = _0x364838(0xa57); }), _0x255169; } function _0xb548c3(_0x5abfc4, _0xb1d864, _0x1ca090 = '') { const _0x4cfc97 = _0x2ad71a, _0x70c50d = document[_0x4cfc97(0xb35)](_0x4cfc97(0x4e8)); _0x70c50d['className'] = _0x4cfc97(0x384) + _0x1ca090; const _0x24f401 = document[_0x4cfc97(0xb35)](_0x4cfc97(0x365)); _0x24f401[_0x4cfc97(0xa9c)] = _0x5abfc4, _0x24f401[_0x4cfc97(0xaff)] = _0x4cfc97(0x41d); const _0x3c52f3 = document[_0x4cfc97(0xb35)](_0x4cfc97(0x4e8)); return _0x3c52f3['className'] = 'avatar-frame', _0xb1d864 && (_0x4cfc97(0xa3d) !== 'Oasom' ? _0x4097d3[_0x4cfc97(0x59f)] = [] : _0x3c52f3['style'][_0x4cfc97(0xaa3)] = _0x4cfc97(0x4c6) + _0xb1d864 + '\x27)'), _0x70c50d[_0x4cfc97(0x3bf)](_0x24f401), _0x70c50d[_0x4cfc97(0x3bf)](_0x3c52f3), _0x70c50d; } function _0x96a5bd(_0x1cf7bd) { const _0x4a6b9f = _0x2ad71a; if (!_0x1cf7bd) return []; let _0x3470d0 = String(_0x1cf7bd)['trim'](); const _0x56f861 = _0x3470d0['match'](/```(?:json)?([\s\S]*?)```/i); if (_0x56f861) _0x3470d0 = _0x56f861[0x1]['trim'](); try { const _0x3d519f = JSON[_0x4a6b9f(0x57f)](_0x3470d0); if (_0x3d519f && Array[_0x4a6b9f(0x75c)](_0x3d519f[_0x4a6b9f(0xb34)])) return _0x3d519f['reply']['map'](_0x49f3f1 => typeof _0x49f3f1 === _0x4a6b9f(0xa98) ? _0x49f3f1 : _0x49f3f1?.[_0x4a6b9f(0x5e2)])[_0x4a6b9f(0x3cf)](Boolean)[_0x4a6b9f(0x208)](_0xb65dc1); const _0x3f1d6e = ['response', _0x4a6b9f(0x320), _0x4a6b9f(0x722), 'text', _0x4a6b9f(0x5e2), 'line', _0x4a6b9f(0x90f)]; if (_0x3d519f && typeof _0x3d519f === _0x4a6b9f(0x4e4)) { if ('GpUVL' !== _0x4a6b9f(0x421)) { const _0x8b24a5 = []; for (const _0x55a996 of Object[_0x4a6b9f(0xa8f)](_0x3d519f)) { const _0x579e0c = _0x55a996[_0x4a6b9f(0x586)](); if (_0x3f1d6e[_0x4a6b9f(0x342)](_0x3e4fea => _0x579e0c[_0x4a6b9f(0x3df)](_0x3e4fea))) { const _0x3550b4 = _0x3d519f[_0x55a996]; if (typeof _0x3550b4 === _0x4a6b9f(0xa98)) _0x8b24a5['push'](_0x3550b4); if (Array[_0x4a6b9f(0x75c)](_0x3550b4)) _0x3550b4[_0x4a6b9f(0x201)](_0xb69cbe => { const _0x3c55fb = _0x4a6b9f; if ('CKukg' === 'CKukg') { if (typeof _0xb69cbe === _0x3c55fb(0xa98)) _0x8b24a5[_0x3c55fb(0x8d9)](_0xb69cbe); } else _0xe1c829[_0x3c55fb(0x51c)][_0x3c55fb(0x2e4)](_0x3c55fb(0x60a), _0x3c55fb(0xb2d)), _0x4a3111[_0x3c55fb(0x51c)]['remove'](_0x3c55fb(0xa2c)), _0x548b47['diaryCurrentPage'] = _0x2bac45, _0xf00882(), _0x59e93b[_0x3c55fb(0x512)] = ![]; }); } } if (_0x8b24a5['length']) return _0x8b24a5['flatMap'](_0xb65dc1)[_0x4a6b9f(0xa38)](0x0, 0x9); } else _0x5ab4cc = _0x1100fc['value']; } } catch { } if (/[{\[]/[_0x4a6b9f(0x9a3)](_0x3470d0) && /":/['test'](_0x3470d0)) { if (_0x4a6b9f(0xa63) !== _0x4a6b9f(0x37d)) { const _0x559403 = [], _0x216aca = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x1bb3ee; while ((_0x1bb3ee = _0x216aca[_0x4a6b9f(0x97a)](_0x3470d0)) !== null) { if (_0x4a6b9f(0x410) === _0x4a6b9f(0x410)) { const _0x1b4e39 = _0x1bb3ee[0x1][_0x4a6b9f(0x915)](/\\"/g, '\x22')['replace'](/\\n/g, '\x0a')[_0x4a6b9f(0x44c)](); if (_0x1b4e39) _0x559403[_0x4a6b9f(0x8d9)](_0x1b4e39); } else { const _0xb92cfa = _0x1fc83a[_0x4a6b9f(0x24d)](_0x16d349); _0x28fff3 = _0x18c1f1[_0x4a6b9f(0x269)](_0xb92cfa), _0x55aaa9[_0x4a6b9f(0x754)](_0x4a6b9f(0x6bd)); } } if (_0x559403['length']) return _0x559403[_0x4a6b9f(0x208)](_0xb65dc1)[_0x4a6b9f(0xa38)](0x0, 0x9); } else _0x4020a5(_0x4a6b9f(0xaf8)); } return _0xb65dc1(_0x3470d0); } function _0xb65dc1(_0x148f98) { const _0xe56c09 = _0x2ad71a; if (!_0x148f98) return []; const _0x46489c = String(_0x148f98)[_0xe56c09(0x44c)](), _0x5c6d24 = _0x46489c['split'](/(?<=[。！？!?…])\s+|[\r\n]+/)['map'](_0x2931d8 => _0x2931d8[_0xe56c09(0x44c)]())['filter'](Boolean); if (_0x5c6d24['length'] > 0x0) return _0x5c6d24[_0xe56c09(0xa38)](0x0, 0x9); return [_0x46489c][_0xe56c09(0x3cf)](Boolean); } const _0x361ce4 = new Promise((_0x67bc65, _0x204a53) => { const _0x33a70e = _0x2ad71a, _0x271f1d = indexedDB[_0x33a70e(0x6a6)](_0x60c3e, 0x3); _0x271f1d[_0x33a70e(0x611)] = () => _0x204a53('IndexedDB\x20failed\x20to\x20open'), _0x271f1d[_0x33a70e(0x7b4)] = () => _0x67bc65(_0x271f1d[_0x33a70e(0x774)]), _0x271f1d[_0x33a70e(0x6fa)] = _0x2ca70b => { const _0x36cfc7 = _0x33a70e, _0x4c44e3 = _0x2ca70b[_0x36cfc7(0x48e)][_0x36cfc7(0x774)]; console[_0x36cfc7(0x754)](_0x36cfc7(0x39f) + _0x4c44e3[_0x36cfc7(0x76b)] + '...'); !_0x4c44e3['objectStoreNames'][_0x36cfc7(0x56f)](_0x2ecade) && (console[_0x36cfc7(0x754)](_0x36cfc7(0x216) + _0x2ecade), _0x4c44e3[_0x36cfc7(0x775)](_0x2ecade, { 'keyPath': 'id' })); if (!_0x4c44e3['objectStoreNames'][_0x36cfc7(0x56f)](_0x36cfc7(0x8e7))) { if (_0x36cfc7(0x357) === 'TEqPv') console['log']('Creating\x20object\x20store:\x20music_library'), _0x4c44e3[_0x36cfc7(0x775)](_0x36cfc7(0x8e7), { 'keyPath': 'id' }); else { const _0x334dae = _0x2a6d7d['getElementById'](_0x36cfc7(0x882))['value'][_0x36cfc7(0x44c)](), _0x45aa56 = _0x3e959a[_0x36cfc7(0xac8)](_0x36cfc7(0x786))[_0x36cfc7(0xa35)]; if (!_0x334dae) { _0x496808(_0x36cfc7(0xa36)); return; } const _0xeba305 = _0x2360e2[_0x36cfc7(0x613)]['find'](_0x25f378 => _0x25f378['id'] === _0x3f8642[_0x36cfc7(0xabe)]); if (!_0xeba305) { _0xcf2f96(_0x36cfc7(0x551)); return; } _0x455859['calendarEvents']['push']({ 'id': _0x36cfc7(0x66e) + _0x4ba979[_0x36cfc7(0x83b)](), 'date': _0x3d805d[_0x36cfc7(0x7ea)], 'type': _0x45aa56, 'content': _0x334dae, 'userId': _0xeba305['id'] }), _0x2ed445(), _0x5a48f7(), _0x2fc07c(), _0x257cf6(), _0x2c70f1[_0x36cfc7(0x8f3)](_0x36cfc7(0x535))[_0x36cfc7(0x51c)][_0x36cfc7(0x2e4)](_0x36cfc7(0x530)); } } !_0x4c44e3[_0x36cfc7(0x61d)]['contains'](_0x26d9a8) && ('hSHry' !== _0x36cfc7(0xa7f) ? (_0xfae9e['error'](_0x36cfc7(0x8e4), _0x3563d8), _0x2349f4(_0x36cfc7(0x2a6))) : (console[_0x36cfc7(0x754)](_0x36cfc7(0x216) + _0x26d9a8), _0x4c44e3[_0x36cfc7(0x775)](_0x26d9a8, { 'keyPath': 'id' }))); }; }); function _0x4d19(_0x46e05c, _0x13a9da) { const _0x177897 = _0x1778(); return _0x4d19 = function (_0x4d19e2, _0x487385) { _0x4d19e2 = _0x4d19e2 - 0x1b0; let _0x15d067 = _0x177897[_0x4d19e2]; return _0x15d067; }, _0x4d19(_0x46e05c, _0x13a9da); } async function _0x26239c(_0x5ef9c3) { const _0x34c157 = await _0x361ce4; return new Promise((_0x2d3bc5, _0x5556a1) => { const _0x21733d = _0x4d19, _0x2b4b06 = _0x34c157['transaction'](_0x2ecade, _0x21733d(0x72d)), _0x71445b = _0x2b4b06[_0x21733d(0x387)](_0x2ecade), _0x5a551c = _0x71445b[_0x21733d(0xb5d)](_0x5ef9c3); _0x5a551c['onsuccess'] = () => _0x2d3bc5(_0x5a551c[_0x21733d(0x774)] ? _0x5a551c[_0x21733d(0x774)][_0x21733d(0x1d6)] : null), _0x5a551c['onerror'] = () => _0x5556a1(_0x5a551c[_0x21733d(0x27b)]); }); } async function _0x4cfca9(_0x4348a8) { const _0x19d950 = await _0x361ce4; return new Promise((_0x251715, _0x5480aa) => { const _0x1f2f0a = _0x4d19; if ('zELjQ' === _0x1f2f0a(0x49b)) { const _0x514006 = _0x19d950[_0x1f2f0a(0x6c0)](_0x26d9a8, _0x1f2f0a(0x72d)), _0x1927fe = _0x514006[_0x1f2f0a(0x387)](_0x26d9a8), _0x1e08de = _0x1927fe[_0x1f2f0a(0xb5d)](_0x4348a8); _0x1e08de[_0x1f2f0a(0x7b4)] = () => _0x251715(_0x1e08de['result'] ? _0x1e08de['result']['data'] : null), _0x1e08de[_0x1f2f0a(0x611)] = () => _0x5480aa(_0x1e08de[_0x1f2f0a(0x27b)]); } else { _0x179402['id'] === _0x4d33f0[_0x1f2f0a(0xb7c)] && (_0x3bc9a7(), _0x551bb5['conversationHistory'] = [], _0x16952a()); try { _0x3afb93[_0x1f2f0a(0x758)](_0x1f2f0a(0xb7a) + _0x431c0d['id']), _0x4321fa(_0x1f2f0a(0x5ab) + _0x1aab6c[_0x1f2f0a(0x499)] + _0x1f2f0a(0xb8e)); } catch (_0x436a0e) { _0x5070eb[_0x1f2f0a(0x27b)](_0x1f2f0a(0xa97) + _0x476e33['id'], _0x436a0e), _0xc411ea(_0x1f2f0a(0xa48)); } } }); } async function _0x32f743(_0x522ee8, _0x1f1aeb) { const _0x48bcdd = await _0x361ce4; return new Promise((_0x47deef, _0x4d904d) => { const _0x4beb96 = _0x4d19, _0x10a038 = _0x48bcdd[_0x4beb96(0x6c0)](_0x26d9a8, _0x4beb96(0xae4)), _0x2e4968 = _0x10a038[_0x4beb96(0x387)](_0x26d9a8), _0x12fab6 = _0x2e4968[_0x4beb96(0xb30)]({ 'id': _0x522ee8, 'data': _0x1f1aeb }); _0x12fab6[_0x4beb96(0x7b4)] = () => _0x47deef(), _0x12fab6[_0x4beb96(0x611)] = () => _0x4d904d(_0x12fab6[_0x4beb96(0x27b)]); }); } async function _0x155cc5(_0x116ced) { const _0xb4f86a = await _0x361ce4; return new Promise((_0x3864ba, _0x4a316a) => { const _0x181f8b = _0x4d19, _0x27781c = _0xb4f86a[_0x181f8b(0x6c0)](_0x26d9a8, 'readwrite'), _0x356f36 = _0x27781c[_0x181f8b(0x387)](_0x26d9a8), _0x16dff2 = _0x356f36[_0x181f8b(0x583)](_0x116ced); _0x16dff2[_0x181f8b(0x7b4)] = () => _0x3864ba(), _0x16dff2[_0x181f8b(0x611)] = () => _0x4a316a(_0x16dff2[_0x181f8b(0x27b)]); }); } async function _0x1d2a3c(_0x1dc7a0, _0x195707) { const _0x35be5c = await _0x361ce4; return new Promise((_0x535771, _0x4f2d3a) => { const _0xbdadff = _0x4d19, _0x5b1a54 = _0x35be5c[_0xbdadff(0x6c0)](_0x2ecade, _0xbdadff(0xae4)), _0x461153 = _0x5b1a54[_0xbdadff(0x387)](_0x2ecade), _0x3bdf43 = _0x461153[_0xbdadff(0xb30)]({ 'id': _0x1dc7a0, 'blob': _0x195707 }); _0x3bdf43[_0xbdadff(0x7b4)] = () => _0x535771(_0x3bdf43[_0xbdadff(0x774)]), _0x3bdf43[_0xbdadff(0x611)] = () => _0x4f2d3a(_0x3bdf43[_0xbdadff(0x27b)]); }); } async function _0x44b919(_0x4ec44a) { const _0x4f74c6 = await _0x361ce4; return new Promise((_0x5bfb72, _0xcc0c0c) => { const _0x2a9c0e = _0x4d19; if (_0x2a9c0e(0x55d) === 'SGaLc') { const _0xc1d369 = _0x43c4d4(_0x2539e6['getHours']())[_0x2a9c0e(0x6f9)](0x2, '0'), _0xd85efc = _0x2e59d9(_0x579f79[_0x2a9c0e(0x6d3)]())[_0x2a9c0e(0x6f9)](0x2, '0'); _0x222541[_0x2a9c0e(0x1cd)] = _0xc1d369 + ':' + _0xd85efc; const _0x424922 = _0x2f099f['getMonth']() + 0x1, _0x37fd67 = _0x133121[_0x2a9c0e(0x6b8)](), _0x93c809 = [_0x2a9c0e(0x2c8), _0x2a9c0e(0x67a), '星期二', '星期三', _0x2a9c0e(0x3fa), '星期五', '星期六'][_0x264b94[_0x2a9c0e(0x7f3)]()]; _0x4604f6['textContent'] = _0x424922 + '月' + _0x37fd67 + '日\x20' + _0x93c809; } else { const _0x1f78f0 = _0x4f74c6[_0x2a9c0e(0x6c0)](_0x2ecade, _0x2a9c0e(0xae4)), _0x1e6b5e = _0x1f78f0[_0x2a9c0e(0x387)](_0x2ecade), _0x805dc8 = _0x1e6b5e[_0x2a9c0e(0x583)](_0x4ec44a); _0x805dc8[_0x2a9c0e(0x7b4)] = () => _0x5bfb72(), _0x805dc8[_0x2a9c0e(0x611)] = () => _0xcc0c0c(_0x805dc8[_0x2a9c0e(0x27b)]); } }); } function _0x1639b4(_0x777180) { const _0x4fea1c = _0x2ad71a; return fetch(_0x777180)[_0x4fea1c(0xad3)](_0x5964ee => _0x5964ee[_0x4fea1c(0x1d6)]()); }
</script>

  <div id="listen-together-ui" style="display: none;">
    <div class="lt-ui-backdrop"></div>
    <div class="lt-ui-main">
      <div class="lt-ui-header">
        <span id="lt-ui-header-title">正在与 TA 一起听</span>
        <button id="lt-ui-close-btn">×</button>
      </div>
      <div class="lt-ui-content">
        <div class="lt-ui-cover-container">
          <img id="lt-ui-cover-art" src="">
        </div>
        <div class="lt-ui-info">
          <h2 id="lt-ui-song-title">歌曲名称</h2>
          <p id="lt-ui-song-artist">歌手</p>
        </div>
        <div id="lt-ui-lyrics-container">
          <p class="no-lyrics-placeholder">暂无歌词</p>
        </div>
      </div>
    </div>
  </div>
  <div id="summarize-modal" class="choice-modal">
    <div id="summarize-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <button id="close-summary-button" class="header-button" style="min-width: 50px;">关闭</button>
        <span class="header-title">聊天记录总结</span>
        <button id="copy-summary-button" class="header-button" style="min-width: 50px;">复制</button>
      </div>
      <div class="content" style="flex-grow: 1; padding: 0;">
        <textarea id="summary-textarea" placeholder="AI正在拼命总结中，别催..."></textarea>
      </div>
    </div>
  </div>

  <div id="add-event-modal" class="choice-modal">
    <div id="add-event-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 320px;">
      <h3 id="add-event-modal-title" style="margin-top: 0; text-align: center;">为 YYYY-MM-DD 添加...</h3>
      <div class="input-group">
        <label for="event-content-input">内容</label>
        <input type="text" id="event-content-input" placeholder="要做什么或者是什么日子？">
      </div>
      <div class="input-group">
        <label>类型</label>
        <div style="display: flex; gap: 10px; margin-top: 5px;">
          <input type="radio" id="event-type-todo" name="event-type" value="todo" checked>
          <label for="event-type-todo" style="width: auto;">普通日程</label>
          <input type="radio" id="event-type-important" name="event-type" value="important">
          <label for="event-type-important" style="width: auto;">重要纪念日</label>
        </div>
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="save-event-button" class="form-button primary">保存</button>
        <button id="cancel-event-button" class="form-button secondary">取消</button>
      </div>
    </div>
  </div>


</body>

</html>
