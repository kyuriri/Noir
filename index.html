<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

  <title>Noir搓的小手机</title>
  <style>
    .message p,
    .diary-content {
      user-select: none;
      -webkit-user-select: none;
    }

    .lt-end-session-btn {
      font-size: 1.5rem;
      color: inherit;
      /* 继承父元素的颜色 */
      opacity: 0.6;
      cursor: pointer;
      padding: 0 5px;
      line-height: 1;
      font-weight: bold;
    }

    .lt-end-session-btn:hover {
      opacity: 1;
    }

    /* --- Noir's Refactor: Feed Loader Style --- */
    #feed-loader {
      position: absolute;
      inset: 0;
      background: rgba(244, 248, 255, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--text-color);
      font-size: 1rem;
      flex-direction: column;
      gap: 10px;
    }

    .loader-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* --- End of Refactor --- */
    /*
        Noir's Mizuiro Theme
        - 哼，看好了，这才是设计。
      */
    /*
          Noir's Mizuiro Theme
          - 哼，看好了，这才是设计。
        */
    :root {
      --phone-width: 375px;
      --phone-height: 812px;
      --user-bg-image: url('');

      /* === Noir's Ultimate Dynamic Theme Engine v2.0 === */
      /* 哼，现在所有的颜色都听从这三个总开关的指挥。*/
      --primary-hue: 35;
      --primary-saturation: 25%;
      --primary-lightness: 80%;

      /* 核心颜色 */
      --primary-color: hsl(var(--primary-hue), var(--primary-saturation), var(--primary-lightness));
      /* 强调色/用户气泡色，现在也是动态的 */
      --accent-color: hsl(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%));

      /* 哼，看好了，这些就是被我重新接上线的“电灯” */

      /* 文字颜色：根据主题亮度自动变深或变浅 */
      --text-color: hsl(var(--primary-hue), 15%, calc(100% - var(--primary-lightness) / 1.1));
      --text-color-light: hsl(var(--primary-hue), 10%, calc(100% - var(--primary-lightness) / 1.3));

      /* 表面背景：半透明，亮度比主色高一点 */
      --surface-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.4);

      /* 卡片/AI气泡背景：比表面背景更亮一点 */
      --card-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.5);

      /* 边框颜色 */
      --border-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness)), 0.3);

      /* 阴影颜色 */
      --soft-shadow: 0 4px 12px hsla(var(--primary-hue), 40%, calc(var(--primary-lightness) - 10%), 0.15);

      /* 动态页的设置保持不变 */
      --feed-bg-image: none;
      --feed-overlay-opacity: 0.12;
      --feed-overlay-rotate: 22deg;
      --feed-overlay-speed: 48s;

      /* 气泡样式也完全动态化 */
      --bubble-radius: 18px;
      --bubble-outline: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
      --bubble-user-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%), 0.5);
      /* <-- 哼，改成0.5，现在够“虚无”了吧 */
      --bubble-ai-bg: var(--card-bg);

      /* ▼▼▼ 把下面这两行加进去 ▼▼▼ */
      --dropdown-alpha: 0.9;
      /* 下拉菜单的透明度，0到1 */
      --feed-card-alpha: 0.7;
      /* 动态卡片的透明度，0到1 */


      /* ▲▲▲ 添加到这里结束 ▲▲▲ */

    }

    body {
      display: flex;
      align-items: center;
      /* <-- 加上这句 */
      justify-content: center;
      /* <-- 还有这句 */
      height: 100vh;
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
    }

    #phone-container {
      width: 100%;
      /* 占满屏幕宽度 */
      height: 100vh;
      /* 占满屏幕高度 */
      background-color: white;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* 是不是清爽多了？ */
      position: relative;
      /* <-- 就是这句，告诉它“你是个家长了，给我看好家里的东西！” */
    }

    .screen {
      flex-grow: 1;
      display: none;
      flex-direction: column;
      background-color: #f9f9f9;
      /* 哼，所有屏幕默认都给我变白 */
      /* 让背景透出来 */
      overflow: hidden;
      color: var(--text-color);
    }

    .screen.active {
      display: flex;
    }

    /* 这个是通用的头像预览样式 */
    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
      margin-top: 5px;
      cursor: pointer;
    }

    /* --- 通用顶栏 --- */
    .header,
    #chat-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--primary-color);
      font-weight: 500;
      min-width: 50px;
      text-align: center;
      /* ▼▼▼ 哼，加上这三句，给我立正站好 ▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- 聊天列表 --- */
    #chat-list-pane {
      background-color: transparent;
      border-right: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 加上这句 */
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      /* 防止它在横向布局里被挤扁 */
      display: flex;
      flex-direction: column;
    }

    #chat-list-container {
      flex-grow: 1;
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
    }

    #character-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .character-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      /* backdrop-filter: blur(10px);*/
      border-radius: 16px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .character-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(138, 180, 228, 0.2);
    }

    .char-info-wrapper {
      flex-grow: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .character-item .char-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      margin-right: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .character-item .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .character-item .char-remark {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    #chat-screen-container {
      position: relative;
      /* 告诉里面的绝对定位元素，要以我为基准 */
      flex-grow: 1;
      /* 确保它能撑满 chat-screen 的空间 */
      overflow: hidden;
      /* 把滑出去的部分藏起来，这很重要 */
      display: flex;
      /* 保持内部元素的 flex 布局 */
    }

    /* --- 聊天窗口 --- */


    #chat-view-pane {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 还有这句 */
      background-color: transparent;
      z-index: 10;
    }

    #chat-screen.show-chat-view #chat-list-pane {
      transform: translateX(-100%);
    }

    #chat-screen.show-chat-view #chat-view-pane {
      transform: translateX(0);
    }

    #chat-messages {
      flex-grow: 1;
      padding: 5px;
      overflow-y: auto;
      display: flex;
      /* <-- 加上这个 */
      flex-direction: column;
      /* <-- 还有这个 */
      contain: content;
      contain: content;
      /* <-- 哼，就是这句救命神药！ */
    }



    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 10px;
      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.7);
      flex-shrink: 0;
    }

    .message {
      padding: 10px 16px;
      border-radius: 20px;
      line-height: 1.5;
      word-break: break-word;
      box-shadow: var(--soft-shadow);
    }

    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
    }

    .message.user {
      background-color: var(--accent-color);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .message.ai {
      background-color: var(--card-bg);
      border: 1px solid rgba(255, 255, 255, 0.8);
      color: var(--text-color);
      border-bottom-left-radius: 5px;
    }

    .message p {
      margin: 0;
    }

    .sticker-content,
    .message-image-content {
      max-width: 120px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
    }

    .message-image-content {
      max-width: 160px;
    }

    /* --- 其他屏幕和组件 --- */
    /* --- Noir's Fix: API 模型列表的样式修正 --- */
    .model-input-container {
      position: relative;
      /* 关键！让里面的绝对定位元素有家可回 */
      display: flex;
      gap: 8px;
    }

    .custom-model-dropdown {
      display: none;
      /* 默认藏起来 */
      position: absolute;
      top: 100%;
      /* 精准定位到输入框正下方 */
      left: 0;
      right: 80px;
      /* 留出“获取”按钮的位置 */
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*   backdrop-filter: blur(10px);*/
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 100;
      /* 确保它在最上层 */
      box-shadow: var(--soft-shadow);
    }

    .checkboxes-container {
      display: none;
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*  backdrop-filter: blur(10px);*/
      z-index: 10;
      border-radius: 8px;
      margin-top: 4px;
    }

    .custom-model-dropdown.show {
      display: block;
      /* 需要的时候再显示 */
    }

    .custom-model-dropdown div {
      padding: 10px 12px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    .custom-model-dropdown div:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    /* --- 其他屏幕和组件 --- */
    /* 在这个注释下面加上主屏幕的样式 */
    #home-screen {
      position: relative;
      /* <-- 就加上这一行！ */


      gap: 20px;
      /* 图标之间的距离 */

      /* 声明！这里现在是我的地盘！*/
      flex-direction: column;
      /* 里面的东西，全体给我垂直排队！*/
      justify-content: space-between;
      /* 核心！顶部和底部的元素给我贴边站好，中间的自动拉开距离！*/
      padding-bottom: 0;
      /* 把内边距去掉，让Dock栏能完美贴底 */
    }

    .app-icon {
      width: 75px;
      /* <--- 就是这里，我把它加宽了 */
      height: 90px;
      /* <--- 高度也顺便调整一下 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: absolute;
      z-index: 40;
      padding: 5px;
      box-sizing: border-box;
      margin: 0;
    }

    .app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 2px;
      /* <-- 哼，就是这里，把5px改成2px，让图标和文字的距离拉近一点 */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      background-color: var(--surface-bg);
      box-shadow: none;
      transition: transform 0.2s ease;
    }

    .app-icon-img svg {
      stroke: currentColor;
      /* SVG的线条颜色会继承上面的 color */
    }

    .app-icon span {
      font-size: 0.75rem;
      /* 文本也相应缩小 */
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }

    .content {
      padding: 20px;
      overflow-y: auto;
      flex-grow: 1;
      /* <-- 加上这行代码，就是这行！ */
    }

    .form-button {
      width: 100%;
      padding: 12px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--border-color);
      color: var(--text-color);
      border-radius: 8px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    .chat-toolbar {
      display: flex;
      padding: 5px 10px;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      /*   backdrop-filter: blur(10px);*/
      flex-shrink: 0;
    }

    /* ▼▼▼ 用下面这段，替换掉你旧的 .toolbar-button 样式 ▼▼▼ */
    .toolbar-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      /* 这个保留，作为SVG尺寸的参考 */
      cursor: pointer;
      padding: 8px;
      /* 稍微增大点击区域 */
      color: var(--text-color-light);
      /* 让它默认是浅灰色 */
      border-radius: 50%;
      /* 让背景有个圆形轮廓 */
      width: 40px;
      height: 40px;
      display: flex;
      /* 使用flex布局让SVG完美居中 */
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s, color 0.2s;
      /* 加上顺滑的过渡效果 */
    }

    .toolbar-button:hover {
      background-color: var(--border-color);
      /* 鼠标悬停时给个背景 */
      color: var(--primary-color);
      /* 图标颜色变为主题色 */
    }

    /* ▲▲▲ 替换到这里为止 ▲▲▲ */


    /* ▼▼▼ 在下面新增这段SVG的专属样式 ▼▼▼ */
    .toolbar-button svg {
      width: 22px;
      /* SVG图标的尺寸 */
      height: 22px;
      stroke-width: 1.8;
      /* 线条粗细，可以微调 */
      stroke: currentColor;
      /* 核心！让SVG的颜色继承按钮的color属性 */
      fill: none;
      /* 确保是线稿风格 */
      pointer-events: none;
      /* 防止SVG本身干扰点击事件 */
    }

    /* ▲▲▲ 新增到这里为止 ▲▲▲ */

    .sticker-panel {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      flex-shrink: 0;
    }

    .sticker-panel.show {
      display: grid;
    }

    /* --- 输入区域 --- */
    /* --- 输入区域 --- */
    .chat-input-area {
      padding: 10px 12px calc(env(safe-area-inset-bottom, 0px) + 10px);
      background: var(--surface-bg);
      /*  backdrop-filter: saturate(1.2) blur(10px);*/
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    /* 这是我加的新容器，用来实现完美对齐 */
    #chat-input-wrapper {
      display: flex;
      /* Flex大法好，哼 */
      align-items: center;
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 2px 5px;
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-input-wrapper:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-message-input {
      flex-grow: 1;
      /* 让输入框占满剩余空间 */
      border: none;
      background: transparent;
      padding: 9px 12px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 38px;
      width: 38px;
      border: 0;
      border-radius: 50%;
      font-size: 1.2rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
      flex-shrink: 0;
      /* 防止被挤压 */
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    /* 回复按钮，给个不一样的颜色区分 */
    #chat-get-reply-button {
      background: var(--accent-color);
      font-size: 1.5rem;
      /* 让箭头更清晰 */
    }

    #chat-message-input {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 11px 16px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-message-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 40px;
      padding: 0 18px;
      border: 0;
      border-radius: 20px;
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    #chat-get-reply-button {
      display: flex;
      /* 隐藏旧的回复按钮，样式统一到发送按钮 */
    }


    /* --- 引用样式 --- */
    .quote-preview {
      display: none;
      padding: 8px 12px;
      background-color: rgba(255, 255, 255, 0.5);
      border-left: 3px solid var(--primary-color);
      margin: 0 12px 8px;
      border-radius: 6px;
      position: relative;
    }

    #quote-preview-sender {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--primary-color);
    }

    #quote-preview-text {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    .cancel-quote-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #999;
      cursor: pointer;
    }

    .quoted-message-in-bubble {
      background-color: rgba(0, 0, 0, 0.04);
      padding: 8px 10px;
      border-left: 3px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quoted-sender {
      font-weight: bold;
      font-size: 0.8rem;
      color: var(--text-color);
    }

    .quoted-content {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    /* 这是弹窗的“骨架”，让它能居中浮动在屏幕上 */
    .choice-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .choice-modal.show {
      opacity: 1;
      visibility: visible;
    }


    /* --- 弹窗 --- */
    .choice-modal-backdrop {
      background: rgba(0, 0, 0, 0.2);
      /*  backdrop-filter: blur(4px);*/
    }

    .choice-modal-content {
      background: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .choice-modal-button {
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.5);
    }

    .choice-modal-button:hover {
      background-color: rgba(255, 255, 255, 1);
    }

    .choice-modal-button.cancel {
      color: var(--primary-color);
      background: transparent;
    }

    /* --- Noir's Fix: 让“添加”弹窗从底部滑出，更大气 --- */
    #add-choice-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      /* 确保不会超出手机宽度 */
      margin: 0;
      border-radius: 20px 20px 0 0;
      /* 只留顶部圆角 */
      border-bottom-left-radius: 0;
      /* 覆盖通用样式 */
      border-bottom-right-radius: 0;
      /* 覆盖通用样式 */
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      /* 适配iPhone底部安全区 */
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #add-choice-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #add-choice-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
      justify-content: center;
    }

    /* 按钮也重新设计一下，让它们竖着排 */
    #add-choice-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- Noir's Fix: 修正创建群聊时，成员选择列表的样式 --- */
    .member-selection-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .member-selection-item:last-child {
      border-bottom: none;
    }

    /* 关键！就是这里，把头像大小锁死 */
    .member-selection-item .char-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 15px 0 10px;
      object-fit: cover;
    }

    .member-selection-item .char-name {
      font-weight: 500;
      color: var(--text-color);
    }

    .member-selection-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      accent-color: var(--primary-color);
      /* 让勾选框颜色也跟主题统一 */
    }

    /* --- Noir's World Book Styles --- */
    #world-book-list-container {
      padding: 10px;
    }

    .world-book-item {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .world-book-item-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .world-book-item-preview {
      font-size: 0.9rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* --- Noir's Fancy Multi-Select Styles --- */
    .custom-multiselect {
      position: relative;
      user-select: none;
    }

    .select-box {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .select-box.expanded .arrow {
      transform: rotate(180deg);
    }


    .checkboxes-container.visible {
      display: block;
    }

    .checkboxes-container label {
      display: block;
      padding: 10px 12px;
    }

    .checkboxes-container label:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    .checkboxes-container input[type="checkbox"] {
      margin-right: 8px;
      width: auto;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Clock & Timestamp Styles --- */
    /* --- Noir's Badge & App Dock Styles --- */
    #decorative-badge {
      width: 160px;
      height: 160px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
      /* 哼，给你加个阴影，看起来才像样 */
      transform: rotate(-0deg);
      /* 稍微歪一点，显得随意 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      /* 防止拖动时选中图片 */
      z-index: 50;
    }

    #decorative-badge:active {

      transform: rotate(-2deg) scale(1.05);
      /* 抓起来的时候，摆正放大一点 */
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }


    #decorative-badge img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* 保留这句，让你的图片能被很好地填充 */
    }

    /*  #a#app-dock-bottom-left,
    #app-dock-top-right {
      
      哼，现在你们只是幽灵了。
      不需要任何样式，你们的孩子（App图标）会自己找到回家的路。
      它们会相对于 #home-screen 定位。
    
    }
*/

    /* --- Noir's Author Mark: Pixel Chicken --- */
    /* 哼，这就是那个吵着要加的小鸡图标 */
    #noir-author-mark {
      position: absolute;
      /* 相对于父容器定位 */
      right: -30px;
      /* 调整它在时钟右边的位置 */
      top: 50%;
      /* 垂直居中 */
      transform: translateY(-50%);
      /* 精确对齐 */
      width: 20px;
      /* 小鸡的尺寸 */
      height: 20px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="0"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM12 4c.69 0 1.25.56 1.25 1.25S12.69 6.5 12 6.5s-1.25-.56-1.25-1.25S11.31 4 12 4zm0 2c-.69 0-1.25.56-1.25 1.25S11.31 8.5 12 8.5s1.25-.56 1.25-1.25S12.69 6 12 6zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 9.75 10 9.75s1.25-.56 1.25-1.25S10.69 8 10 8zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 9.75 12 9.75s1.25-.56 1.25-1.25S12.69 8 12 8zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 9.75 14 9.75s1.25-.56 1.25-1.25S14.69 8 14 8zM10 10c-.69 0-1.25.56-1.25 1.25S9.31 12.5 10 12.5s1.25-.56 1.25-1.25S10.69 10 10 10zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 12.5 12 12.5s1.25-.56 1.25-1.25S12.69 10 12 10zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 12.5 14 12.5s1.25-.56 1.25-1.25S14.69 10 14 10zM12 12c-.69 0-1.25.56-1.25 1.25S11.31 14.5 12 14.5s1.25-.56 1.25-1.25S12.69 12 12 12zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 15.75 10 15.75s1.25-.56 1.25-1.25S10.69 14 10 14zm4 0c-.69 0-1.25.56-1.25 1.25S13.31 15.75 14 15.75s1.25-.56 1.25-1.25S14.69 14 14 14zM12 16c-.69 0-1.25.56-1.25 1.25S11.31 18.5 12 18.5s1.25-.56 1.25-1.25S12.69 16 12 16zM6 10c-.69 0-1.25.56-1.25 1.25S5.31 12.5 6 12.5s1.25-.56 1.25-1.25S6.69 10 6 10zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 12.5 18 12.5s1.25-.56 1.25-1.25S18.69 10 18 10zM12 20c-.69 0-1.25.56-1.25 1.25S11.31 22.5 12 22.5s1.25-.56 1.25-1.25S12.69 20 12 20zM6 14c-.69 0-1.25.56-1.25 1.25S5.31 15.75 6 15.75s1.25-.56 1.25-1.25S6.69 14 6 14zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 15.75 18 15.75s1.25-.56 1.25-1.25S18.69 14 18 14z"/></svg>');
      /* 这是SVG小鸡的Data URI，白色像素风格 */
      background-size: contain;
      background-repeat: no-repeat;
      cursor: pointer;
      /* 提示可点击 */
      opacity: 0.6;
      /* 稍微透明一点，不那么突兀 */
      transition: opacity 0.2s ease-in-out;
      /* 鼠标悬停效果 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    #noir-author-mark:hover {
      opacity: 1;
      /* 鼠标悬停时完全显示 */
    }

    /* 调整时钟容器，为小鸡留出空间并方便定位 */
    .home-clock-container {
      position: relative;
      /* 确保小鸡能相对它定位 */
      /* ... (保留你已有的其他时钟样式) ... */
      padding-right: 40px;
      /* 给小鸡留出一些右边距 */
    }

    #home-clock-container {
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      text-align: center;
      position: absolute;
      /* top, left, right 都被我删了，哼，现在它完全听JS的指挥 */

      /* 这行可以留着，虽然你已经不让它拖了 */
      z-index: 50;
    }

    #home-time {
      font-size: 80px;
      font-weight: 360;
      /* <--- 我把字重从200加到了300，比原来粗，但又不会笨重，这才是高级感。 */
      letter-spacing: -1px;
      /* <--- 字间距也给你调紧了一点，看起来更整体。 */
    }

    #home-date {
      font-size: 1rem;
      /* <--- 稍微缩小一点，让时间更突出 */
      font-weight: 400;
      margin-top: 8px;
      opacity: 0.8;
      text-transform: uppercase;
      /* <--- 日期我给你换成了全大写，这才有那股‘性冷淡’的味道。 */
      letter-spacing: 1px;
      /* <--- 顺便拉开一点点间距，免得挤在一起。 */
    }

    /* 聊天气泡时间戳的样式 */
    .timestamp {
      font-size: 0.7rem;
      color: var(--text-color-light);
      padding: 0 5px;
      margin-bottom: 3px;
      /* 让它和气泡底部对齐 */
    }

    /* 第一段：这是消息容器的基础样式 */
    .message-container {
      display: flex;
      /* 启用flex布局 */
      flex-direction: column;
      /* 让气泡和时间戳垂直排列 */
      margin-bottom: 10px;
      max-width: 85%;
      /* 限制整个容器的最大宽度 */
    }

    /* 第二段：这是根据发言者进行左右对齐的样式 */
    .message-container.user {
      align-self: flex-end;
      /* 让用户方整个容器靠右 */
      align-items: flex-end;
      /* 让容器内部的元素（气泡、时间戳）也靠右 */
    }

    .message-container.ai {
      align-self: flex-start;
      /* 让AI方整个容器靠左 */
      align-items: flex-start;
      /* 让容器内部的元素（气泡、时间戳）也靠左 */
    }

    .message-bubble-row {
      display: flex;
      align-items: flex-end;
      width: 100%;
    }

    .message-container.user .message-bubble-row {
      justify-content: flex-end;
    }

    .message-container.ai .message-bubble-row {
      justify-content: flex-start;
    }



    /* 这是给表情选择面板里，每一个小表情图片用的样式 */
    .sticker-item {
      width: 100%;
      /* 自动填满网格单元格的宽度 */
      aspect-ratio: 1 / 1;
      /* 保持1:1的宽高比，让它变成正方形 */
      object-fit: cover;
      /* 图片会被裁剪以适应正方形，不变形 */
      border-radius: 8px;
      /* 加个小圆角 */
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .sticker-item:hover {
      transform: scale(1.1);
      /* 鼠标放上去时稍微放大，增加交互感 */
    }

    /* --- Noir's Offline Scene Styles --- */
    #meeting-scene-view {
      flex-grow: 1;
      /* <-- 核心：让它占满所有可用空间 */
      overflow-y: auto;
      /* <-- 核心：内容多了就内部滚动 */
      padding: 20px;
      font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif;
      background-size: cover;
      background-position: center;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }

    #chat-view-pane.offline-mode #offline-scene-view {
      display: block;
      /* 在线下模式时显示 */
    }

    #chat-view-pane.offline-mode #chat-messages {
      display: none;
      /* 在线下模式时隐藏气泡聊天 */
    }

    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      /* 保留换行和空格，这对于小说格式至关重要 */
      font-size: 1rem;
    }

    /* --- Noir's Offline Scene Dialogue Box Style --- */
    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 1rem;

      /* <--- Noir's Addition: 为对话框添加半透明背景和内边距 */
      background-color: rgba(0, 0, 0, 0.4);
      /* 半透明黑色背景 */
      padding: 15px 20px;
      /* 内边距，让文字与边框有距离 */
      border-radius: 8px;
      /* 圆角边框，更柔和 */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      /* 轻轻的阴影，增加立体感 */
    }

    #offline-scene-view .narrator {
      color: #d1d5db;
      /* 旁白用浅灰色 */
      font-style: italic;
    }

    #offline-scene-view .speaker-user {
      color: #a7c7e7;
      /* 用户的发言用一种柔和的蓝色 */
      font-weight: bold;
    }

    #offline-scene-view .speaker-ai {
      color: #f2b7c6;
      /* AI的发言用柔和的粉色，形成对比 */
      font-weight: bold;
    }

    /* --- Noir's Typing Indicator Style --- */
    .typing-indicator {
      padding: 10px 15px;
      color: var(--text-color-light);
      font-style: italic;
      font-size: 0.9rem;
      align-self: flex-start;
      /* 让它和AI气泡一样靠左 */
      margin-left: 50px;
      /* 和AI气泡对齐 */
    }

    #offline-scene-view .typing-indicator {
      color: rgba(255, 255, 255, 0.8);
      /* 在暗色背景下用亮色 */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      /* 同样的文字阴影，保持队形 */
      padding: 10px 0;
      margin-left: 0;
      /* 在小说视图里不需要缩进 */
    }

    /* --- Noir's Final Alignment Fix --- */
    .message-container.ai .timestamp {
      /* 哼，给你加上头像宽度(40px) + 左右边距(10px)的距离 */
      margin-left: 50px;
    }

    .message-container.user .timestamp {
      /* 另一边也是一样，真是麻烦死了 */
      margin-right: 50px;
    }

    /* --- Noir's Music Feed & Player Styles --- */
    #music-feed-container {
      padding-bottom: 70px;
      contain: content;
      /* 为底部播放器留出空间 */
    }

    /* 动态页：默认白底；如设置 --feed-bg-image 则显示独立壁纸 + 轻动画叠层 */
    #music-screen {
      background-color: #fff;
      /* 默认白底 */
      background-image: var(--feed-bg-image);
      /* 单独壁纸，不设就是 none */
      background-size: cover;
      background-position: center;
      contain: paint;
      /* 降低重绘范围，省电 */
    }

    /* 轻动画彩雾叠层：仅图层，不拦点击 */
    #music-screen::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        conic-gradient(from var(--feed-overlay-rotate),
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 0%,
          transparent 20%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 40%,
          transparent 60%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 80%,
          transparent 100%);
      transform: translateZ(0);
      animation: feed-pan var(--feed-overlay-speed) linear infinite;
    }

    /* 超慢速平移旋转，基本不占 GPU */
    @keyframes feed-pan {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }

      50% {
        transform: translate3d(1.2%, 0.8%, 0) rotate(2deg) scale(1.02);
      }

      100% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }
    }

    /* 系统降低动画偏好时，自动停掉动画 */
    @media (prefers-reduced-motion: reduce) {
      #music-screen::before {
        animation: none;
      }
    }


    .music-post {
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), var(--feed-card-alpha));
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: var(--soft-shadow);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .music-post-header {
      display: flex;
      align-items: center;
      padding: 12px 15px;
    }

    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .music-post-header .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .music-post-thought {
      padding: 0 15px 15px;
      font-size: 0.95rem;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .music-post-song-card {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.04);
      padding: 12px 15px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .music-post-song-card:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    .music-post-song-card img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }

    .music-post-song-info {
      flex-grow: 1;
    }

    .music-post-song-info .title {
      font-weight: 500;
      color: var(--text-color);
    }

    .music-post-song-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    .music-post-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    #music-player-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--surface-bg);
      /*backdrop-filter: blur(10px);*/
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 10px;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    #music-player-bar:not(.hidden) {
      transform: translateY(0);
    }

    #music-player-bar.hidden {
      display: none;
      /* 彻底隐藏，避免交互问题 */
    }


    #player-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
    }

    #player-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #player-title,
    #player-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #player-title {
      font-weight: 500;
    }

    #player-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #player-controls button {
      background: none;
      border: 2px solid var(--text-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Share Bubble Styles --- */
    .message.music {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
      max-width: 250px;
      /* 限制一下最大宽度 */
    }

    .music-share-card {
      display: flex;
      align-items: center;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
    }

    .message-container.user .music-share-card {
      background-color: var(--accent-color);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .message-container.user .music-share-card .title,
    .message-container.user .music-share-card .artist,
    .message-container.user .music-share-card .play-icon {
      color: white;
    }


    .music-share-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .music-share-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-share-info .title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #music-screen {
      position: relative;
      /* 就是这句，告诉里面的绝对定位元素，以我为界！ */
    }

    /* --- Noir's Fancy Music Widget Styles --- */
    /* --- Noir's Music System Refactor --- */

    #music-widget:not(.hidden) {
      transform: translateY(0);
      /* 不隐藏时，滑上来 */
    }

    #music-widget.hidden {
      transform: translateY(150%);
      /* 隐藏时，滑下去 */
    }

    .widget-vinyl {
      width: 80px;
      height: 80px;
      background-color: #111;
      border-radius: 50%;
      position: relative;
      left: 20px;
      /* 向右移动，让卡片能盖住它 */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      background-image:
        radial-gradient(circle at center, #555 10%, transparent 11%),
        radial-gradient(circle at center, #fff 12%, transparent 13%);
      animation: spin 8s linear infinite;
      z-index: 1;
    }

    @keyframes spin {
      from {
        transform: translate(-50%, -50%) rotate(0deg);
        /* <-- 看见没，把咒语合并了 */
      }

      to {
        transform: translate(-50%, -50%) rotate(360deg);
        /* <-- 这里也是 */
      }
    }

    .widget-card {
      width: 240px;
      padding: 15px;
      background-color: var(--card-bg);
      /*  backdrop-filter: blur(10px);*/
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      z-index: 2;
      /* 让卡片在唱片上方 */
    }

    .widget-card img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .widget-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #widget-title,
    #widget-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #widget-title {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    #widget-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #widget-play-icon {
      font-size: 1.2rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #card-widget {
      width: 335px;
      height: 170px;
      border-radius: 18px;
      /* 这就是圆角方形的关键 */
      background-color: rgba(255, 255, 255, 0.5);
      /* 加个底色，免得图片透明时不好看 */

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transform: rotate(0deg);
      /* 朝另一个方向歪 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      /* 比爱心高一层 */
      overflow: hidden;
      /* 防止图片溢出圆角 */
    }

    #card-widget:active {

      transform: rotate(1deg) scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Noir's Ultimate Scrollbar Hider --- */
    /* For Webkit browsers like Chrome, Safari */
    ::-webkit-scrollbar {
      display: none;
    }

    /* For Firefox */
    * {
      scrollbar-width: none;
    }

    /* --- Noir's Fix: 美化消息操作弹窗 --- */
    #message-action-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
    }

    #message-action-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      margin: 0;
      border-radius: 20px 20px 0 0;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #message-action-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #message-action-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- End of Fix --- */
    /* --- Noir's Fix: Fancy User Post Area --- */
    #user-post-input-container {
      display: flex;
      gap: 10px;
    }

    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
    }

    #user-post-main-area {
      flex-grow: 1;
    }

    #user-post-textarea {
      width: 100%;
      border: none;
      background: transparent;
      outline: none;
      resize: vertical;
      font-size: 1rem;
      color: var(--text-color);
    }

    #user-post-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    /* ... 你已有的 #user-post-toolbar 样式 ... */

    /* ▼▼▼ Noir's Command: 哼，给我站成一排！ ▼▼▼ */
    #user-post-actions {
      display: flex;
      /* <-- 这就是圣旨本身 */
      gap: 8px;
      /* <-- 这是我赏赐的间距，让它们别挤在一起 */
    }

    /* ▲▲▲ Command End ▲▲▲ */

    #user-send-post-button {
      padding: 6px 18px;
      border-radius: 16px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    /* 这是附件预览的样式 */
    #user-post-attachment-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-item {
      position: relative;
      max-width: 100px;
    }

    .preview-item img {
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
    }

    .preview-item .music-preview-card {
      display: flex;
      align-items: center;
      padding: 8px;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      width: 200px;
      /* 给音乐卡片宽一点 */
    }

    .preview-item .music-preview-card img {
      width: 30px;
      height: 30px;
      margin-right: 8px;
    }

    .preview-item .music-preview-card .info {
      font-size: 0.8rem;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .remove-attachment-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    /* --- Noir's Fix: Post Image Display Style --- */
    .post-image-container {
      padding: 0 15px 15px;
      /* 图片和文字之间留点空隙 */
    }

    .post-image {
      max-width: 100%;
      /* 图片最宽不能超过帖子宽度 */
      max-height: 400px;
      /* 最高400像素，防止长图刷屏 */
      border-radius: 8px;
      /* 加个小圆角，好看 */
      object-fit: cover;
      /* 保持图片比例，不变形 */
      display: block;
      /* 解决图片底部多余的空隙问题 */
    }

    /* --- Noir's Refactor: New Post Interaction Styles --- */
    .post-interactions {
      padding: 10px 15px;
      background-color: rgba(0, 0, 0, 0.02);
      border-top: 1px solid var(--border-color);
      font-size: 0.9rem;
    }

    .post-likes {
      color: var(--primary-color);
      margin-bottom: 8px;
    }

    .post-comments-container {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .post-comment {
      color: var(--text-color);
    }

    .post-comment .comment-author {
      font-weight: 600;
      color: var(--text-color);
    }

    .post-timestamp {
      font-size: 0.75rem;
      color: var(--text-color-light);
      padding: 0 15px 10px;
    }



    /* 覆盖：基础气泡体 */
    /* 覆盖：基础气泡体 */
    .message {
      border-radius: var(--bubble-radius);
      line-height: 1.55;
      padding: 10px 14px;
      box-shadow:
        0 1px 0 rgba(0, 0, 0, .03),
        0 4px 10px rgba(0, 0, 0, .06);
      /* 比你原先更浅，省功耗 */
      border: 1px solid var(--bubble-outline);
      backdrop-filter: none !important;
      /* 绝不启用重滤镜 */
      will-change: auto;
      /* 不抢 GPU 配额 */

      /* --- Noir's Fix: 就是下面这两行，哼 --- */
      user-select: none;
      /* 标准浏览器给我听话，不许选中 */
      -webkit-user-select: none;
      /* 那些老古董浏览器也一样 */
    }

    /* 你的气泡（右侧） */
    .message.user {
      color: #fff;
      background: var(--bubble-user-bg);
      border-bottom-right-radius: 6px;
      /* 微“角”保留你原味 */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .12);
      /* 细腻但很轻 */
    }

    /* TA 的气泡（左侧） */
    .message.ai {
      color: var(--text-color);
      background: var(--bubble-ai-bg);
      border-bottom-left-radius: 6px;
    }

    /* 细节：图片/贴纸消息不套背景 */
    /* 细节：图片/贴纸/音乐卡片消息不套背景 */
    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image,
    .message.user.music,
    /* <-- 哼，加上这两行 */
    .message.ai.music {
      background: transparent;
      border: 0;
      box-shadow: none;
      padding: 0;
    }

    /* 轻触态：不使用阴影动画，避免合成层抖动 */
    .message:active {
      transform: scale(.996);
    }

    /* 引用块在气泡内的融合感 */
    .quoted-message-in-bubble {
      background: rgba(0, 0, 0, .045);
      border: 1px solid color-mix(in hsl, var(--primary-color) 18%, transparent);
      border-radius: 10px;
    }


    /* --- Noir's Transfer Bubble Style --- */
    .message.transfer {
      background: #F79232;
      /* 哼，一个温暖又醒目的橙色 */
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      width: 220px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    /* 我还给左右两边做了区分，真是为你操碎了心 */
    .message-container.ai .message.transfer {
      background: #f9fafb;
      /* AI发来的转账用白色，更清爽 */
      color: #333;
      border: 1px solid #e5e7eb;
    }

    .transfer-content {
      display: flex;
      flex-direction: column;
    }

    .transfer-title {
      font-weight: 600;
      font-size: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.5);
      padding-bottom: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .message-container.ai .transfer-title {
      border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    .transfer-amount {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .transfer-recipient {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    /* --- End of Refactor --- */



    /* --- Noir's Snap Guide Styles --- */
    .snap-guide {
      position: absolute;
      background-color: rgba(255, 105, 180, 0.85);
      /* 哼，一个足够醒目的颜色 */
      display: none;
      z-index: 999;
      box-shadow: 0 0 5px rgba(255, 105, 180, 0.7);
    }

    #snap-guide-v {
      width: 1px;
    }

    #snap-guide-h {
      height: 1px;
    }

    /* --- Noir's Galgame UI Beautification --- */
    /* Top-left Date & Time Widget */
    #galgame-overlay-ui {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 12px;
      padding: 8px 15px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    #galgame-time {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
    }

    #galgame-date {
      font-size: 0.75rem;
      opacity: 0.8;
      text-align: center;
    }

    /* Main Text Box */
    /* Main Text Box */
    #galgame-textbox-container {
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.85) 0%, rgba(45, 50, 68, 0.7) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border-top: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
      bottom: 85px;
      /* <-- 就是这里，往上抬了，满意了吗？ */
      left: 15px;
      right: 15px;
      padding: 12px 18px;
    }

    /* Speaker Name Tag */
    #galgame-speaker {
      background: linear-gradient(90deg, var(--primary-color) 0%, hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) - 10%)) 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      display: inline-block;
      font-size: 0.95rem;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      margin-bottom: 12px;
    }

    /* Dialogue Text */
    #galgame-text {
      font-size: 1rem;
      line-height: 1.7;
      color: #f0f2f5;
    }

    /* User Input Area Container*/
    #meeting-view-screen .chat-input-area {
      background: transparent;
      border-top: none;
      padding: 0 15px 20px 15px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 20;
    }

    /* User Input Wrapper */
    #chat-input-wrapper-meeting {
      display: flex;
      align-items: center;
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.9) 0%, rgba(45, 50, 68, 0.75) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      padding: 5px 8px 5px 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
    }

    #meeting-message-input {
      color: #f0f2f5;
    }

    #meeting-message-input::placeholder {
      color: rgba(240, 242, 245, 0.5);
      font-style: italic;
    }

    /* Send Button */
    #meeting-send-button {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: 300;
      color: #fff;
      transition: all .2s ease;
      margin-left: 8px;
      background: var(--primary-color);
      box-shadow: 0 2px 5px hsla(var(--primary-hue), 50%, 50%, 0.4);
    }

    #meeting-send-button:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }


    /* --- End of Beautification --- */
    /* --- Noir's Diary Beautification --- */
    #diary-entries-container {
      background-color: #fdfaf2;
      /* A warm, paper-like off-white */
      padding: 25px 20px;
      line-height: 1.9;
      border: 1px solid #e0dccc;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.08);
      /* Inner shadow for page depth */
    }

    /* This is the container for a single entry (date, author, content) */
    .diary-entry {
      margin-bottom: 2.5em;
      /* Increase spacing between entries */
      position: relative;
      padding-bottom: 1.5em;
      /* Space for the separator line */
      border-bottom: 1px dashed #dcd5c7;
      /* A subtle dashed line between entries */
    }

    /* Style the author's name */
    .diary-author {
      font-weight: normal;
      /* Make it less bold, more like a signature */
      font-size: 1rem;
      font-family: 'Segoe Script', 'Bradley Hand', cursive;
      /* A more handwritten font */
    }

    /* Style the date */
    .diary-timestamp {
      font-size: 0.75rem;
      color: #a99e8c;
      /* A faded brown color */
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
      /* Typewriter-like font for date */
    }

    /* Style the actual diary text content */
    .diary-content {
      white-space: pre-wrap;
      font-size: 0.95rem;
      color: #4a443b;
      /* A dark brown/black ink color */
      font-family: 'KaiTi', 'STSong', serif;
    }

    /* Specific styles for the USER's entries */
    .diary-entry.user {
      text-align: right;
    }

    .diary-entry.user .diary-author {
      color: #005a9c;
      /* A nice fountain pen blue */
    }

    .diary-entry.user .diary-content {
      color: #1a5c8e;
    }

    /* Specific styles for the AI's entries */
    .diary-entry.ai {
      text-align: left;
    }

    .diary-entry.ai .diary-author {
      color: #5a3e36;
      /* A darker, warmer brown for the AI */
    }

    .diary-entry.ai .diary-content {
      color: #4a443b;
    }

    /* Let's get rid of the last separator line for a cleaner look */
    .diary-entry:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    /* --- End of Diary Beautification --- */
    /* --- Noir's Page-Turning Magic --- */
    #diary-entries-container {
      perspective: 1500px;
      /* 为3D效果设置视距 */
      position: relative;
      overflow: hidden;
    }

    .diary-page {
      position: absolute;
      inset: 0;
      padding: 25px 20px;
      background-color: #fdfaf2;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      transition: transform 0.7s cubic-bezier(0.65, 0, 0.35, 1);
      display: none;
      /* 默认所有页面都藏起来 */
      flex-direction: column;
      gap: 2.5em;
      /* 页内日记的间距 */
      overflow-y: auto;
      /* 如果一页内容太多，允许滚动 */
    }

    .diary-page.is-visible {
      display: flex;
      /* 只有当前页显示 */
      transform: rotateY(0deg);
      z-index: 2;
    }

    /* 翻到下一页时，当前页向左翻出 */
    .diary-page.is-exiting-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 1;
    }

    /* 翻到下一页时，新页面从右边翻入 */
    .diary-page.is-entering-from-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 2;
    }

    /* 翻到上一页时，当前页向右翻出 */
    .diary-page.is-exiting-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 1;
    }

    /* 翻到上一页时，新页面从左边翻入 */
    .diary-page.is-entering-from-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 2;
    }


    #diary-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 10px;
      box-sizing: border-box;
    }

    #diary-navigation button {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--primary-color);
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    #diary-navigation button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #diary-page-indicator {
      font-size: 0.9rem;
      color: var(--text-color-light);
      font-family: 'Courier New', monospace;
    }

    /* --- End of Magic --- */
    /* --- Noir's Universal Anti-Squash Protocol --- */
    /* 哼，就是下面这几条，给你那些被压扁的头像整整容 */

    /* 动态发布区的用户头像 */
    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      object-fit: cover;
      /* <-- 加上这句，它就不敢扁了 */
    }

    /* 好友圈动态里的角色头像 */
    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
      /* <-- 还有这句，一个都别想跑 */
    }

    /* 顺便把所有叫 .char-avatar 的都统一一下，免得以后还有问题 */
    .char-avatar {
      object-fit: cover;
    }

    /* --- Noir's Music Library Styles --- */
    #music-library-container {
      padding: 10px;
    }

    .music-library-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .music-library-item:hover {
      transform: translateY(-2px);
    }

    .music-library-item-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 15px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .music-library-item-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-library-item-title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-library-item-artist {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    /* --- End of Styles --- */
    /* --- Noir's Global Player Styles --- */

    /* --- End of Player Styles --- */
    /* --- Noir's Upload Altar Styles --- */
    .upload-slot {
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease;
      background-color: rgba(255, 255, 255, 0.5);
    }

    .upload-slot:hover {
      background-color: var(--card-bg);
      border-color: var(--primary-color);
    }

    .upload-slot.filled {
      border-color: var(--primary-color);
      border-style: solid;
      background-color: hsla(var(--primary-hue), 50%, 95%, 0.8);
    }

    .upload-slot .slot-icon {
      font-size: 2rem;
    }

    .upload-slot .slot-label {
      display: block;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .upload-slot .slot-filename {
      display: block;
      font-size: 0.85rem;
      color: var(--text-color-light);
      margin-top: 3px;
      word-break: break-all;
    }

    #confirm-altar-upload-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* --- End of Altar Styles --- */
    /* --- Noir's Listen Together Invite Card Style --- */
    .listen-together-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--soft-shadow);
      border: 1px solid var(--border-color);
      width: 250px;
    }

    .message-container.user .listen-together-card {
      background: var(--bubble-user-bg);
      color: white;
    }

    .message-container.user .listen-together-card .listen-together-decline-btn {
      color: white;
      /* 哼，让用户侧的拒绝按钮文字也变白 */
    }

    .listen-together-header {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--bubble-outline);
      padding-bottom: 8px;
    }

    .listen-together-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .listen-together-song img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .listen-together-info .title {
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-info .artist {
      font-size: 0.9em;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .listen-together-actions button {
      flex-grow: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease;
    }

    .listen-together-actions button:active {
      transform: scale(0.97);
    }

    .listen-together-accept-btn {
      background: var(--primary-color);
      color: white;
    }

    .listen-together-decline-btn {
      background: rgba(0, 0, 0, 0.1);
    }

    /* 用这个替换你旧的 #listen-together-ui */
    #listen-together-ui {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: flex;
      align-items: center;
      /* 改成居中对齐 */
      justify-content: center;
      padding: 20px;
      /* 增加内边距，让弹窗不会贴边 */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #listen-together-ui.show {
      opacity: 1;
      visibility: visible;
    }

    .lt-ui-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px) saturate(1.8);
      -webkit-backdrop-filter: blur(15px) saturate(1.8);
    }

    /* 用这个替换你旧的 .lt-ui-main */
    .lt-ui-main {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 380px;
      /* 哼，给它一个最大宽度 */
      max-height: 650px;
      /* 再给一个最大高度 */
      display: flex;
      flex-direction: column;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      border-radius: 24px;
      /* 加上优雅的圆角 */
      overflow: hidden;
      /* 把溢出的部分裁掉 */
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      /* 更强的立体阴影 */
      border: 1px solid rgba(255, 255, 255, 0.2);
      /* 淡淡的边框光效 */
    }

    .lt-ui-header {
      flex-shrink: 0;
      padding: 15px 20px;
      text-align: center;
      position: relative;
    }

    #lt-ui-header-title {
      font-weight: 600;
    }

    #lt-ui-close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 30px;
    }

    .lt-ui-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow: hidden;
    }

    .lt-ui-cover-container {
      flex-shrink: 0;
      width: 65%;
      aspect-ratio: 1/1;
      margin-top: 5%;
      margin-bottom: 20px;
    }

    #lt-ui-cover-art {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .lt-ui-info {
      text-align: center;
      margin-bottom: 20px;
      flex-shrink: 0;
    }

    #lt-ui-song-title {
      font-size: 1.5rem;
      margin: 0;
    }

    #lt-ui-song-artist {
      font-size: 1rem;
      opacity: 0.8;
      margin: 5px 0 0;
    }

    #lt-ui-lyrics-container {
      flex-grow: 1;
      width: 100%;
      overflow-y: auto;
      text-align: center;
      font-size: 1.1rem;
      line-height: 2.5;
      mask-image: linear-gradient(transparent 0%, black 20%, black 80%, transparent 100%);
      /* 歌词上下渐隐，看起来更专业 */
      scroll-behavior: smooth;
      /* 滚动要丝滑 */
    }

    #lt-ui-lyrics-container p {
      transition: color 0.3s ease, transform 0.3s ease;
      opacity: 0.6;
    }

    #lt-ui-lyrics-container p.active {
      color: var(--primary-color);
      font-weight: 600;
      transform: scale(1.1);
      opacity: 1;
    }

    /* --- Noir's "Desktop Preview" Frame --- */
    /* 哼，只有在电脑这种大屏幕上，我才给你加上这个“手机框”，免得你分不清主次。 */
    /* 在真正的手机上，它还是会全屏显示的，我可没你那么笨。 */
    @media (min-width: 480px) {
      body {
        background-color: #e9ebee;
        /* 一个不那么刺眼的背景色 */
        padding: 20px 0;
        /* 上下留点呼吸空间 */
      }

      #phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        max-height: 90vh;
        /* 确保在矮屏幕上不会超出 */

        /* 这就是你想要的“边框”，哼 */
        border: 10px solid #1c1c1e;
        border-radius: 44px;
        /* 圆角大一点才像样 */
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        /* 给你加个高级点的阴影 */

        flex-shrink: 0;
        /* 确保它在 flex 布局里不会被压扁 */
      }
    }



    /* --- Noir's Bespoke Music Player Design (As Requested) --- */
    /* 哼，这才叫定制。*/

    /* 1. 动画先放着，虽然这次不用了 */
    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* 2. 组件卡片本体：一个有阴影的容器 */
    #music-widget-card {
      width: 340px;
      height: 120px;
      border-radius: 6px;
      /* 稍微硬朗一点的圆角 */
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      /* 一个淡淡的底色 */
      display: flex;
      /* 左右布局 */
      padding: 0;
      border: none;
      overflow: visible;
      /* 允许唱片溢出 */
      position: relative;
      /* 为了定位唱片 */
    }

    /* 3. 左侧封面区：用伪元素画出深色背景，不污染HTML */
    #music-widget-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 120px;
      /* 和高度一样，是个正方形 */
      background-color: #4a4a4a;
      border-radius: 6px 0 0 6px;
      /* ▼▼▼ 在这里加上下面两行 ▼▼▼ */
      background-size: cover;
      background-position: center;
    }

    /* 4. 专辑封面本体 (旧唱片改造) */

    #widget-cover-art {
      position: absolute;
      top: 15px;
      left: 15px;
      width: 90px;
      height: 90px;
      z-index: 2;
      /* 确保它在唱片之上 */
      /* ▼▼▼ 下面都是我新增的，给我看好了 ▼▼▼ */
      border-radius: 4px;
      /* 封面本身的小圆角 */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      background-size: cover;
      background-position: center;
      transition: background-image 0.3s ease;
      /* 让封面切换更柔和 */
    }

    /* 5. 封面图片 (旧唱片贴纸改造) */
    #widget-cover-art::before {
      width: 100%;
      height: 100%;
      border-radius: 4px;
      /* 和封面一致 */
      border: none;
      background-image: var(--widget-cover-image, none);
      background-size: cover;
      background-position: center;
    }

    /* 6. 唱片？用另一个伪元素从后面伸出来就行了，简单 */
    #widget-cover-art::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 90px;
      height: 90px;
      border-radius: 50%;
      z-index: -1;
      display: block;
      border: none;

      /* 哼，看好了，这才叫唱片 */
      background-color: #2a2a2a;
      /* 1. 先铺一层唱片的深灰色底 */
      background-image:
        /* 2. 然后在上面画中间的标签和洞，颜色我都给你配好了 */
        radial-gradient(circle at center, #111 4%, transparent 5%),
        radial-gradient(circle at center, #985c5c 5%, #7a4949 25%, transparent 26%),
        /* 3. 再画上一圈圈的光泽纹理，这才像样 */
        repeating-radial-gradient(circle at center,
          rgba(255, 255, 255, 0.04) 0,
          rgba(255, 255, 255, 0.04) 1px,
          transparent 1px,
          transparent 3px);
      transform: translateX(0%) scale(1.05);
      /* 微调了下位置和大小，这样更协调 */
      transition: opacity 0.3s ease;
      /* 加上这个，为了后面让它优雅地消失 */
      /* 4. 位置也给你微调了一下，现在顺眼多了 */
    }

    /* ▼▼▼ 这是全新的代码，给我加上！▼▼▼ */
    #music-widget-card.is-playing #widget-cover-art {
      /* 播放时，方形舞台的背景就是封面了，所以不需要我画的唱片了 */
      background-image: none;
    }

    #music-widget-card.is-playing::before {
      background-image: var(--widget-cover-image, none);
    }

    #music-widget-card.is-playing #widget-cover-art::after {
      /* 播放时，让唱片旋转起来，哼 */
      animation: spin 8s linear infinite;
    }

    /* 默认状态下，方形舞台的背景是透明的，这样才能看到我画的唱片 */
    #music-widget-card:not(.is-playing) #widget-cover-art {
      background-image: none;
    }

    /* 7. 右侧内容区 (旧覆盖层改造) */
    .widget-content-overlay {
      position: static;
      flex-grow: 1;
      /* 占满右侧所有空间 */
      /* 把旧的 background: #ffffff; 删掉！换成下面这两行！*/
      background: var(--card-bg);
      /* 1. 用我们主题里那个早就定义好的半透明背景 */

      /* 纯白背景 */
      border-radius: 0 6px 6px 0;
      padding: 15px;
      display: flex;
      flex-direction: column;
      /* 垂直布局 */
      justify-content: space-between;
      /* <--- 哼，加上这句圣旨 */
      box-sizing: border-box;
      position: relative;
      /* 为了定位假的分享按钮 */
      background: var(--card-bg);
      color: var(--text-color);
      margin-left: 120px;
    }


    /* 8. 歌曲信息 (标题和作者) */
    #music-widget .widget-info {
      color: #333;
      text-shadow: none;

      /* 占据上半部分空间 */
    }

    #music-widget .widget-info #widget-title {
      font-size: 1.1rem;
      font-weight: 500;
      color: #000;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.8rem;
      color: #888;
    }

    /* 9. 假的歌词和进度条，用伪元素画出来 */
    #music-widget .widget-info::after {
      /* 假的歌词 */
      display: block;
      font-size: 0.75rem;
      color: #65c468;
      /* 绿色 */
      margin-top: 8px;
      padding-bottom: 8px;
      background-image:
        linear-gradient(to right, #666 40%, #ddd 40%),
        /* 假的进度条 */
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12"><path fill="%23aaa" d="M0 10h2V2H0v8zm3 2h2V0H3v12zm3-4h2V4H6v4zm3 2h2V2H9v8zm3-3h2V5h-2v4z"/></svg>');
      /* 假的EQ图标 */
      background-repeat: no-repeat, no-repeat;
      background-position: bottom, 90% bottom;
      background-size: 100% 1px, 16px 12px;
      border-bottom: 1px solid #eee;
    }

    /* 10. 真的控制按钮区域 */
    #widget-controls {
      display: flex;
      justify-content: flex-start;
      /* 从左边开始排列 */
      align-items: center;
      gap: 15px;
      padding-top: 10px;
      position: relative;
      /* 为了定位假的删除和喜欢按钮 */
      width: 100%;
    }

    /* 11. 真的播放/暂停/下一首按钮的样式 */
    #widget-controls button {
      font-size: 1.1rem;
      color: #555;
      background: none;
      border: 1px solid #ccc;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      line-height: 28px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      order: 1;
      /* 把真的按钮放在中间 */
    }

    #widget-play-pause-btn {
      width: 32px;
      /* 播放按钮大一点 */
      height: 32px;
      line-height: 32px;
      font-size: 1.2rem;
    }

    /* 12. 哼，看好了，这才是不会出错的矢量图标，免得你那破手机又自作聪明 */
    #widget-controls::before,
    #widget-controls::after {
      content: '';
      /* 删掉那些讨厌的emoji源头 */
      display: block;
      width: 16px;
      /* 给图标一个精确的尺寸 */
      height: 16px;
      background-color: #aaa;
      /* 这就是图标的颜色，哼 */
      position: absolute;

      /* 下面是魔法，反正你也看不懂 */
      -webkit-mask-repeat: no-repeat;
      mask-repeat: no-repeat;
      -webkit-mask-position: center;
      mask-position: center;
      -webkit-mask-size: contain;
      mask-size: contain;
    }

    #widget-controls::before {
      /* 删除图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      right: 29px;
      /* 稍微调整一下位置，让它更协调 */
      top: 60%;
      transform: translateY(-50%);
    }

    #widget-controls::after {
      /* 喜欢图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      right: 1px;
      top: 60%;
      transform: translateY(-50%);
    }

    /* --- Noir's iOS Industrial Button Refactor --- */
    /* 哼，看好了，这才是专业设备该有的开关。*/

    /* --- Noir's Ultimate Dynamic Button System v3.0 --- */
    /* 哼，现在它们都听我的了。*/

    /* 1. 按钮的基础“模具”，所有按钮都用这个 */
    .form-button {
      border: none;
      border-radius: 12px;
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      margin-top: 10px;
      transition: filter 0.15s ease, background-color 0.2s ease;
      -webkit-tap-highlight-color: transparent;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      /* 加个细微的阴影 */
      color: white;
      /* 默认文字都是白色 */
    }

    .form-button:active {
      filter: brightness(0.9);
    }

    .form-button:disabled {
      background-color: #ccc !important;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* 2. 主要操作按钮 (继承主题强调色) */
    .form-button.primary,
    /* 你可以给蓝色的按钮加上 primary 类，或者不管它也行 */
    #save-api-settings-button,
    /* 把几个主要的按钮ID也直接指定了，免得你改漏 */
    #save-user-profile-button,
    #save-char-button,
    #save-world-book-button,
    #save-group-settings-button,
    #save-friend-circle-button {
      background-color: var(--accent-color);
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
    }

    /* 3. 次要操作按钮 (用主题里的卡片背景色，这才叫和谐) */
    .form-button.secondary {
      background-color: var(--card-bg);
      color: var(--text-color);
      border: 1px solid var(--border-color);
    }

    /* 4. 危险操作按钮 (动态的红色，这才叫高级) */
    .form-button.destructive {
      /* 哼，看好了，这个红色的亮度和饱和度，会随着你主题的明暗变化而变化！*/
      background-color: hsl(5, 75%, calc(var(--primary-lightness) / 1.8 + 25%));
    }

    /* 5. 警告操作按钮 (动态的黄色，也一样) */
    .form-button.warning {
      background-color: hsl(40, 90%, calc(var(--primary-lightness) / 2.2 + 25%));
      color: #5d4000;
    }

    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */

    /* 1. Dock栏的样式 */
    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */
    #home-dock {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 85px;
      padding: 0 20px;
      /* 图标左右的留白 */
      box-sizing: border-box;

      /* 背景和滤镜，现在都在这里 */
      background: var(--surface-bg);
      backdrop-filter: blur(5px) saturate(0.8);
      -webkit-backdrop-filter: blur(15px) saturate(0.8);
      border-radius: 28px;
      z-index: 35;

      /* 核心：用Flexbox来自动排列图标 */
      display: flex;
      justify-content: space-around;
      /* 均匀分布 */
      align-items: center;
      /* 垂直居中 */
      padding-top: 9px;
    }

    #home-dock .app-icon {
      position: static;
      /* 取消绝对定位，让它接受Flexbox的管理 */
    }

    /* 2. App图标的“整容手术” */
    .app-icon-img {
      width: 58px;
      /* 图标背景尺寸 */
      height: 58px;
      border-radius: 22.5%;
      /* iOS标志性的“方圆”形 */
      font-size: 28px;
      /* 阴影从图标本身移到背景上，更统一 */
      background-color: var(--surface-bg);
      box-shadow: none;
      /* 删掉旧的阴影 */
      transition: transform 0.2s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
      /* 按下时图标有反馈 */
    }

    /* --- Noir's Minimalist Home Screen Makeover (v2.0 Dynamic Edition) --- */
    /* 哼，现在这些家伙也听从总开关的指挥了。*/

    /* 1. 时钟和日期 */
    #home-clock-container {
      color: var(--text-color);
      text-shadow: none;
    }

    #home-date {
      opacity: 0.7;
    }

    /* 2. App图标的改造 (现在是动态颜色了) */
    .app-icon span {
      color: var(--text-color);
      text-shadow: none;
      font-weight: 500;
    }

    .app-icon-img {
      background-color: var(--card-bg);
      /* <-- 哼，接上了！*/
      color: var(--text-color-light);
      /* <-- 接上了！*/
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* 3. Dock栏的颜色 (也动态了) */




    #widget-controls button,
    #music-widget .widget-info #widget-title,
    #music-widget .widget-info #widget-artist {
      color: var(--text-color);
    }

    /* ... 在第 2262 行附近 ... */
    /* ▼▼▼ 把旧的 #widget-cover-art::after 整个删掉，换成下面这个 ▼▼▼ */

    /* ▲▲▲ 替换到这里结束 ▲▲▲ */

    /* --- Noir's Theme Preset Buttons --- */
    /* 哼，每个按钮都是一件艺术品。 */
    .theme-preset-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 20px;
      /* 胶囊形状 */
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card-bg);
    }

    .theme-preset-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--soft-shadow);
    }

    .preset-color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    /* --- Noir's Memory Archive Styles --- */
    #summary-textarea {
      width: 100%;
      height: 100%;
      border: none;
      outline: none;
      resize: none;
      padding: 15px;
      box-sizing: border-box;
      font-family: 'Courier New', monospace;
      /* 用等宽字体，YAML格式才好看 */
      font-size: 0.85rem;
      line-height: 1.6;
      background-color: #fdfdfd;
      color: var(--text-color);
    }

    /* --- Noir's Desktop Pagination System --- */
    /* 哼，看好了，这才叫设计。*/

    /* 1. 把主内容区变成一个灵活的容器，为翻页器和指示器留好位置 */
    #home-screen-main-content {
      display: flex;
      flex-direction: column;
      /* 垂直排列，页面在上面，指示器在下面 */
    }

    /* 2. 这是翻页的“舞台”，它的大小和主屏幕一样，但会把超出部分藏起来 */
    #app-pages-container {
      flex-grow: 1;
      /* 占满除了指示器以外的所有空间 */
      width: 100%;
      overflow: hidden;
      /* 核心！把第二页先藏起来 */
      position: relative;
      /* 让里面的滑块能相对于它定位 */
    }

    /* 3. 这是真正滑动的“滑块”，它有两页那么宽 */
    #app-pages-slider {
      width: 200%;
      /* 两页的宽度 */
      height: 100%;
      display: flex;
      /* 核心！让两页并排站好 */
      transition: transform 0.35s cubic-bezier(0.25, 0.1, 0.25, 1);
      /* 翻页动画，给你选了个高级点的曲线 */
    }

    /* 4. 每一页的样式 */
    .app-page {
      width: 50%;
      /* 每页占滑块的一半，也就是一个屏幕的宽度 */
      height: 100%;
      flex-shrink: 0;
      /* 防止被挤压 */
      position: relative;
      /* 让你放在里面的绝对定位图标有家可回 */
    }

    /* 5. 页面指示器（小点点）的容器 */
    #home-page-indicator {
      position: absolute;
      bottom: 105px;
      /* 放在Dock栏正上方，给你算好了距离 */
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      /* 点点之间的距离 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    /* 6. 每个小点点的样式 */
    .page-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(2px);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    /* 7. 当前页的小点点，给它变亮变大一点 */
    .page-dot.active {
      background-color: rgba(255, 255, 255, 0.9);
      transform: scale(1.1);
    }

    #card-widget-2 {
      width: 165px;
      /* 尺寸和原来保持一致 */
      height: 165px;
      border-radius: 22px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      overflow: hidden;
    }

    #card-widget-2:active {
      transform: scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget-2 img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .theme-widget {
      width: 65px;
      height: 65px;
      border-radius: 22px;
      /* 跟你的卡片圆角差不多 */
      box-shadow: var(--soft-shadow);
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      background: linear-gradient(45deg,
          hsla(var(--primary-hue), var(--primary-saturation), var(--primary-lightness), 0.7),
          hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.3), calc(var(--primary-lightness) - 15%), 0.8));
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* --- Noir's Galgame Sprite Adjuster Styles --- */

    /* --- Noir's Slider Control Panel Styles --- */
    .sprite-slider-group {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 5px;
    }

    .sprite-slider-group label {
      color: white;
      font-size: 0.8rem;
      width: 60px;
      /* 让标签对齐，好看点 */
      flex-shrink: 0;
    }

    .sprite-slider-group input[type="range"] {
      flex-grow: 1;
      /* 占满剩余空间 */
      margin: 0;
      padding: 0;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Accounting App Styles --- */
    #daily-expenses-list .expense-item {
      display: flex;
      justify-content: space-between;
      padding: 10px;
      background-color: var(--card-bg);
      border-radius: 8px;
      margin-bottom: 8px;
      border: 1px solid var(--border-color);
    }

    .expense-item .description {
      font-weight: 500;
    }

    .expense-item .amount {
      font-weight: 600;
      color: var(--accent-color);
    }

    #character-reviews-container .review-card {
      display: flex;
      gap: 12px;
      background-color: var(--card-bg);
      padding: 12px;
      border-radius: 12px;
      margin-bottom: 10px;
      border: 1px solid var(--border-color);
    }

    .review-card .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
    }

    .review-card .review-content .char-name {
      font-weight: 600;
      margin-bottom: 4px;
    }

    /* --- End of Styles --- */
    /* --- Noir's Accounting Tabs Style --- */
    .accounting-tabs {
      display: flex;
      background-color: var(--surface-bg);
      border-bottom: 1px solid var(--border-color);
      padding: 5px 15px 0;
      flex-shrink: 0;
    }

    .tab-button {
      flex: 1;
      padding: 10px;
      border: none;
      background: transparent;
      color: var(--text-color-light);
      font-size: 1rem;
      font-weight: 500;
      border-bottom: 3px solid transparent;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .tab-button.active {
      color: var(--accent-color);
      border-bottom: 3px solid var(--accent-color);
    }

    /* --- Noir's "WeChat Moments" Style Patch --- */
    /* 哼，这才叫社交。*/
    #music-feed-container {
      padding: 0;
      /* 容器的内边距清零，让动态贴边 */
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.95);
      /* 给整个容器一个统一的背景色 */
    }

    .music-post {
      background-color: transparent;
      /* 去掉卡片背景 */
      box-shadow: none;
      /* 去掉阴影 */
      border-radius: 0;
      /* 去掉圆角 */
      margin-bottom: 0;
      /* 去掉外边距 */
      padding: 15px;
      /* 统一内边距 */
      border-bottom: 1px solid var(--border-color);
      /* 加上底部分隔线 */
    }

    .music-post:last-child {
      border-bottom: none;
      /* 最后一条动态不需要分隔线 */
    }

    /* --- End of Patch --- */
  </style>
</head>

<body>
  <input type="file" id="audio-file-input" style="display: none;" accept=".flac,.mp3">
  <input type="file" id="cover-file-input" style="display: none;" accept=".jpg,.png,.jpeg,.webp">
  <input type="file" id="info-file-input" style="display: none;" accept=".txt">
  <input type="file" id="lyrics-file-input" style="display: none;" accept=".lrc">
  <input type="file" id="import-char-input" accept=".json,.noir" style="display: none;">
  <div id="phone-container">

    <div id="user-profile-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-user-list" class="header-button">主屏幕</button>
        <span class="header-title">选择用户</span>
        <button id="add-user-profile-button" class="header-button add" title="添加新用户">+</button>
      </div>
      <div class="content" id="user-profile-list-container">
      </div>
    </div>

    <div id="user-profile-screen" class="screen">
      <div class="header">
        <button id="back-to-user-list-from-edit" class="header-button">返回</button>
        <span id="user-profile-edit-title" class="header-title">编辑用户</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-user-id">
        <div class="settings-group">
          <h2>用户设定</h2>
          <div class="input-group">
            <label for="user-name">你的名字</label>
            <input type="text" id="user-name" placeholder="你的显示名字">
          </div>
          <div class="avatar-upload-group">
            <label>你的头像</label>
            <img id="user-avatar-preview" class="avatar-preview" alt="User Avatar Preview">
            <input type="file" id="user-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="user-persona">你的人设 (可选)</label>
            <textarea id="user-persona" placeholder="向AI介绍你自己。例如：我是一名大学生，喜欢摄影和旅行。"></textarea>
          </div>
        </div>
        <button id="save-user-profile-button" class="form-button">保存资料</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="set-active-user-button" class="form-button"
            style="background-color: #28a745; margin-bottom: 10px;">设为当前用户</button>
          <button id="delete-user-profile-button" class="form-button destructive">删除该用户</button>
        </div>
      </div>
    </div>


    <div id="home-screen" class="screen active">
      <div id="home-screen-main-content"
        style="position: relative; flex-grow: 1; width: 100%; display: flex; flex-direction: column;">

        <div id="app-pages-container">
          <div id="app-pages-slider">

            <div class="app-page" id="app-page-1">
              <div id="home-clock-container">
                <div id="home-time">11:31</div>
                <div id="home-date">8月29日 星期五</div>
                <div id="noir-author-mark"></div>
              </div>

              <div id="music-widget"
                style="  display: inline-block; width: auto; position: absolute; top: 45%; left: 50%; transform: translateX(-50%); z-index: 50;; padding: 0px;bottom: auto;">
                <div id="music-widget-card">
                  <div id="widget-cover-art"></div>

                  <div class="widget-content-overlay">
                    <div class="widget-info">
                      <div id="widget-title">暂无音乐</div>
                      <div id="widget-artist">请在动态或聊天中播放</div>
                    </div>
                    <div id="widget-controls">
                      <button id="widget-prev-btn">⏮</button>
                      <button id="widget-play-pause-btn">▶</button>
                      <button id="widget-next-btn">⏭</button>
                    </div>
                  </div>
                </div>
              </div>

            </div>

            <div class="app-page" id="app-page-2">
              <div id="decorative-badge" style="display: none; position: absolute; top: 250px; left: 50px;">
                <img id="badge-image" src="http://googleusercontent.com/file_content/0" alt="badge">
              </div>

              <div id="card-widget" style="display: none; position: absolute; top: 140px; left: 145px;">
                <img id="card-image" src="" alt="card widget">
              </div>
              <div id="card-widget-2" style="display: none; position: absolute;">
                <img id="card-image-2" src="" alt="card widget 2">
              </div>





              <div class="app-icon" id="app-world-book">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                  </svg></div>
                <span>世界书</span>
              </div>


              <div class="app-icon" id="app-diary">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <path d="M2.5 17a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zM2.5 14a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
                  </svg></div>
                <span>交换日记</span>
              </div>

              <div class="app-icon" id="app-music-library">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                    <path
                      d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                    </path>
                  </svg></div>
                <span>音乐库</span>
              </div>


              <div class="app-icon" id="app-settings">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
                    </path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg></div>
                <span>API设置</span>
              </div>
              <div class="app-icon" id="app-user-profiles">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg></div>
                <span>我</span>
              </div>
              <div class="app-icon" id="app-wallpaper">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12 2.69l.34.34a1.41 1.41 0 0 0 2 0L22 6.34a1.41 1.41 0 0 0 0-2l-7.66-7.66a1.41 1.41 0 0 0-2 0L2.68 14.34a1.41 1.41 0 0 0 0 2L10 24l2-2 2-2 2-2 2-2 2-2">
                    </path>
                    <path d="m7.34 2.66 14 14"></path>
                  </svg></div>
                <span>更换壁紙</span>
              </div>

              <div id="theme-widget-1" class="theme-widget"></div>
              <div class="app-icon" id="app-accounting">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <line x1="12" y1="1" x2="12" y2="23"></line>
                    <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                  </svg></div>
                <span>记账</span>
              </div>

              <div id="home-dock">
                <div class="app-icon app-icon-large" id="app-chat">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg></div>
                  <span>聊天</span>
                </div>
                <div class="app-icon" id="app-music">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M9 18V5l12-2v13"></path>
                      <circle cx="6" cy="18" r="3"></circle>
                      <circle cx="18" cy="16" r="3"></circle>
                    </svg></div>
                  <span>动态</span>
                </div>
                <div class="app-icon" id="app-meeting">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M14 9a2 2 0 0 1-2 2H6l-4 4V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4Z" />
                      <path d="M18 9h2a2 2 0 0 1 2 2v9l-4-4h-2a2 2 0 0 1-2-2V9Z" />
                    </svg></div>
                  <span>见面</span>
                </div>
              </div>
            </div>

          </div>
        </div>

        <div id="home-page-indicator">
          <span class="page-dot active" data-page="0"></span>
          <span class="page-dot" data-page="1"></span>
        </div>

      </div>

    </div>

    <div id="chat-screen" class="screen">
      <div id="chat-screen-container">
        <div id="chat-list-pane">
          <div id="chat-list-header">
            <button id="back-to-home-from-chat" class="header-button">主屏幕</button>
            <span class="header-title">聊天</span>
            <button id="add-chat-button" class="header-button add" title="添加新聊天">+</button>
          </div>
          <div id="chat-list-container">
            <ul id="character-list">
            </ul>
          </div>
        </div>
        <div id="chat-view-pane">
          <div class="header">
            <button class="header-button" id="back-to-chat-list">返回</button>
            <span id="char-name-header" class="header-title">角色</span>
            <button class="header-button" id="character-settings-button" title="角色设置">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                </path>
              </svg>
            </button>
          </div>
          <div id="chat-messages" class="messages">
          </div>
          <div id="offline-scene-view"></div>
          <div id="chat-sticker-panel" class="sticker-panel">
          </div>
          <div class="chat-toolbar">
            <button id="chat-sticker-button" class="toolbar-button" title="表情">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5-2 4-2 4 2 4 2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
            </button>
            <button id="chat-image-button" class="toolbar-button" title="发送图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <button id="chat-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
            <button id="chat-listen-together-button" class="toolbar-button" title="一起听">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path
                  d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                </path>
              </svg>
            </button>
            <button id="chat-transfer-button" class="toolbar-button" title="转账">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </button>
            <button id="chat-reroll-button" class="toolbar-button" title="重新生成">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
            <button id="chat-summarize-button" class="toolbar-button" title="总结聊天记录">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
          </div>
          <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
          <div id="quote-preview-area" class="quote-preview">
            <div class="quote-preview-content">
              <div id="quote-preview-sender"></div>
              <div id="quote-preview-text"></div>
            </div>
            <button id="cancel-quote-button" class="cancel-quote-btn">&times;</button>
          </div>
          <div class="chat-input-area">
            <div id="chat-input-wrapper">
              <input type="text" id="chat-message-input" placeholder="输入消息...">
              <button id="chat-get-reply-button" title="让对方回复">↵</button>
              <button id="chat-send-button" title="发送">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="settings-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-settings" class="header-button">返回</button>
        <span class="header-title">API设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>API 设置</h2>
          <div class="input-group">
            <label for="api-endpoint">API 接口地址（不填/v1）</label>
            <input type="text" id="api-endpoint" placeholder="例如: https://api.openai.com">
          </div>
          <div class="input-group">
            <label for="api-key">API 密钥</label>
            <input type="password" id="api-key" placeholder="请输入你的 API 密钥">
          </div>
          <div class="input-group">
            <label for="api-model">模型</label>
            <div class="model-input-container">
              <input type="text" id="api-model" placeholder="点击 获取 或手动输入" style="flex-grow: 1;">
              <button id="fetch-models-button" style="padding: 0 12px; white-space: nowrap;">获取</button>
              <div id="model-dropdown" class="custom-model-dropdown"></div>
            </div>
          </div>
          <div class="input-group">
            <label for="api-provider">接口格式 (重要！请根据你使用的接口选择，但是我也没做Openai以外的接口……)</label>
            <select id="api-provider"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);">
              <option value="openai">OpenAI 格式 (通用，兼容绝大多数反代)</option>
              <option value="gemini">Google Gemini 格式 (仅限官方或特定反代)</option>
              <option value="anthropic">Anthropic Claude 格式</option>
            </select>
          </div>
        </div>
        <div class="settings-group">
          <h2>上下文设置</h2>
          <div class="input-group">
            <label for="context-lines-per-chat">每个会话读取的消息条数（默认 100）</label>
            <input type="number" id="context-lines-per-chat" min="1" max="1000000" step="1" placeholder="100">
          </div>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>数据管理</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            导出全部数据（角色、聊天记录、设置、桌面布局等）到一个文件，方便在其他设备或浏览器上导入。
          </p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="export-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #007bff;">导出全部数据</button>
            <button id="import-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #28a745;">导入数据</button>
          </div>
          <input type="file" id="import-data-input" accept=".json" style="display: none;">
        </div>
        <button id="save-api-settings-button" class="form-button">保存 API 设置</button>
      </div>
    </div>



    <div id="character-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-edit" class="header-button">返回</button>
        <span id="character-edit-title" class="header-title">编辑角色</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-char-id">
        <div class="settings-group">
          <h2>角色设定</h2>
          <div class="input-group">
            <label for="char-edit-name">名字</label>
            <input type="text" id="char-edit-name" placeholder="角色的名字">
          </div>
          <div class="input-group">
            <label for="char-edit-remark">备注名</label>
            <input type="text" id="char-edit-remark" placeholder="方便自己记忆，例如 '工作助理'">
          </div>
          <div class="avatar-upload-group">
            <label>角色头像</label>
            <img id="char-edit-avatar-preview" class="avatar-preview" alt="Avatar Preview">
            <input type="file" id="char-edit-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-persona">人设 (系统提示词)</label>
            <textarea id="char-edit-persona" placeholder="你是一个乐于助人的助手。"></textarea>
          </div>
          <div class="input-group">
            <label>聊天壁纸</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-wallpaper-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="聊天壁纸预览">
            </div>
            <input type="file" id="char-edit-wallpaper-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-css">专属气泡样式 (CSS)</label>
            <textarea id="char-edit-css" rows="8"
              placeholder="从其他地方复制的、包含 .sent 和 .received 的CSS代码可以直接粘贴在这里..."></textarea>

            <div style="display: flex; gap: 10px; margin-top: 5px;">
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">TA的气泡 (Received):</p>
                <div id="bubble-preview-ai" class="message ai">这是TA的气泡预览效果</div>
              </div>
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">你的气泡 (Sent):</p>
                <div id="bubble-preview-user" class="message user">这是你的气泡预览效果</div>
              </div>
            </div>
          </div>
          <div class="input-group">
            <label>见面场景背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-offline-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="见面背景预览">
            </div>
            <input type="file" id="char-edit-offline-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="settings-group">
            <h2>角色立绘 (Galgame模式)</h2>
            <p style="font-size: 0.8rem; color: var(--text-color-light);">为五种核心情绪上传立绘图，建议使用透明背景的PNG图片。</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px;">

              <div class="avatar-upload-group" style="align-items: center;">
                <label>平常</label>
                <img id="char-edit-sprite-normal-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="平常立绘">
                <input type="file" id="char-edit-sprite-normal-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>喜</label>
                <img id="char-edit-sprite-happy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="喜立绘">
                <input type="file" id="char-edit-sprite-happy-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>怒</label>
                <img id="char-edit-sprite-angry-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="怒立绘">
                <input type="file" id="char-edit-sprite-angry-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>哀</label>
                <img id="char-edit-sprite-sad-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="哀立绘">
                <input type="file" id="char-edit-sprite-sad-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>害羞</label>
                <img id="char-edit-sprite-shy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="害羞立绘">
                <input type="file" id="char-edit-sprite-shy-input" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-bind-user">绑定用户</label>
            <select id="char-edit-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="world-book-checkboxes-container" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="export-char-button" class="form-button secondary" style="margin-top: 20px;">导出角色卡</button>
        <button id="save-char-button" class="form-button">保存角色</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="edit-clear-history-button" class="form-button warning"
            style="margin-bottom: 10px;">清空聊天记录</button>
          <button id="edit-delete-char-button" class="form-button" class="form-button destructive">删除角色</button>
        </div>
      </div>
    </div>

    <div id="group-chat-create-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-group-create" class="header-button">返回</button>
        <span class="header-title">创建群聊</span>
        <button id="create-group-chat-button" class="header-button">创建</button>
      </div>
      <div class="content" style="padding: 20px;">
        <div class="input-group">
          <label for="group-chat-name">群聊名称</label>
          <input type="text" id="group-chat-name" placeholder="给你的群聊起个名字">
        </div>
        <div class="settings-group">
          <h2>选择成员</h2>
          <div id="group-chat-member-list-container"
            style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
            <ul id="group-chat-member-list">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div id="wallpaper-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-wallpaper" class="header-button">返回</button>
        <span class="header-title">更换壁纸</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2>全局主题色</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">拖动滑块来改变整个App的主色调。</p>
          <div class="input-group" style="padding-top: 10px;">
            <label for="theme-hue-slider" style="display: block; margin-bottom: 5px;">色相 (Hue)</label>
            <input type="range" id="theme-hue-slider" min="0" max="360" value="35" style="width: 100%;">
          </div>
          <div class="input-group">
            <label for="theme-lightness-slider" style="display: block; margin-bottom: 5px;">明度 (Lightness)</label>
            <input type="range" id="theme-lightness-slider" min="15" max="95" value="80" style="width: 100%;">
          </div>
        </div>
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2 style="margin-top: 0;">时钟样式</h2>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="clock-color-toggle" style="width: auto; height: 18px; flex-shrink: 0;">
            <label for="clock-color-toggle" style="width: auto; font-size: 0.9rem;">强制使用纯白色时钟 (推荐在深色壁纸下使用)</label>
          </div>
        </div>
        <div class="settings-group">
          <h2>上传新壁纸</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">选择一张图片作为你的手机壁纸。为了效果最好，请使用竖屏图片。</p>
          <input type="file" id="wallpaper-input" accept="image/*" style="display: none;">
          <button id="upload-wallpaper-button" class="form-button">选择图片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>音乐小组件背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的主屏幕音乐小组件设置一张专属背景图。</p>
          <input type="file" id="widget-bg-input" accept="image/*" style="display: none;">
          <button id="upload-widget-bg-button" class="form-button">选择图片</button>
          <button id="reset-widget-bg-button" class="form-button secondary">恢复默认</button>
        </div>
        <div class="settings-group" style="margin-top: 20px;">
          <h2>重置桌面</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">此操作会将所有桌面小组件（时钟、音乐、徽章等）恢复到初始位置，并将壁纸重置为纯白色。</p>
          <button id="reset-desktop-button" class="form-button destructive">重置桌面布局</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义徽章</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面徽章，可以拖动它到任意位置。</p>
          <input type="file" id="badge-input" accept="image/*" style="display: none;">
          <button id="upload-badge-button" class="form-button">选择徽章图片</button>
          <button id="reset-badge-button" class="form-button secondary" style="margin-top: 10px;">移除徽章</button>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面方形卡片小组件。</p>
          <input type="file" id="card-input" accept="image/*" style="display: none;">
          <button id="upload-card-button" class="form-button">选择卡片图片</button>
          <button id="reset-card-button" class="form-button secondary" style="margin-top: 10px;">移除卡片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片 2</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的第二个桌面方形卡片小组件上传图片。</p>
          <input type="file" id="card-input-2" accept="image/*" style="display: none;">
          <button id="upload-card-button-2" class="form-button">选择卡片图片</button>
          <button id="reset-card-button-2" class="form-button secondary" style="margin-top: 10px;">移除卡片
            2</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>动态页背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为“动态”页面设置一张独立的背景图，让它与众不同。</p>
          <input type="file" id="feed-bg-input" accept="image/*" style="display: none;">
          <button id="upload-feed-bg-button" class="form-button">选择图片</button>
        </div>
        <button id="reset-feed-bg-button" class="form-button secondary" style="margin-top: 10px;">移除背景</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>小组件救援</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">如果你的吧唧或卡片不小心飞出屏幕找不到了，点这里让它们回家。</p>
          <button id="reset-widgets-position-button" class="form-button warning">重置小组件位置</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义App图标</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">替换主屏幕上App的默认图标。为了最佳效果，请使用方形、透明背景的图片。</p>
          <div class="settings-group"
            style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
            <h2>自定义表情包</h2>
            <p style="font-size: 0.9rem; color: var(--text-color-light);">
              在这里追加你的专属表情包。每个表情占一行，格式为：<br>
              <b>表情名--图片URL</b><br>
              例如：<br>
              <code>开心--https://example.com/happy.png</code><br>
              <code>难过--https://example.com/sad.gif</code>
            </p>
            <textarea id="custom-stickers-input" rows="8" placeholder="请按指定格式粘贴..."></textarea>
            <button id="save-custom-stickers-button" class="form-button" style="margin-top: 5px;">保存并刷新表情包</button>
          </div>
          <div id="custom-icon-list-container">
          </div>
          <div id="custom-icon-list-container">
          </div>
        </div>
      </div>

    </div>

    <div id="world-book-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-world-book" class="header-button">主屏幕</button>
        <span class="header-title">世界书</span>
        <button id="add-world-book-button" class="header-button add" title="添加新世界书">+</button>
      </div>
      <div class="content" id="world-book-list-container">
      </div>
    </div>

    <div id="world-book-editor-screen" class="screen">
      <div class="header">
        <button id="back-to-world-book-list" class="header-button">返回</button>
        <span id="world-book-editor-title" class="header-title">编辑条目</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-world-book-id">
        <div class="settings-group">
          <h2>设定条目</h2>
          <div class="input-group">
            <label for="world-book-edit-name">条目名称 (Key)</label>
            <input type="text" id="world-book-edit-name" placeholder="例如：我的过去、特殊能力">
          </div>
          <div class="input-group">
            <label for="world-book-edit-content">条目内容 (Value)</label>
            <textarea id="world-book-edit-content" placeholder="输入详细的设定内容..."></textarea>
          </div>
        </div>
        <button id="save-world-book-button" class="form-button">保存条目</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="delete-world-book-button" class="form-button destructive">删除该条目</button>
        </div>
      </div>
    </div>

    <div id="group-settings-screen" class="screen">
      <div class="header">
        <button id="back-to-chat-from-group-settings" class="header-button">返回</button>
        <span class="header-title">群聊设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>群聊信息</h2>
          <div class="input-group">
            <label for="group-settings-name">群聊名称</label>
            <input type="text" id="group-settings-name">
          </div>
          <div class="avatar-upload-group">
            <label>群头像</label>
            <img id="group-avatar-preview" class="avatar-preview" alt="Group Avatar Preview">
            <input type="file" id="group-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label>群聊背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="group-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="群聊背景预览">
            </div>
            <input type="file" id="group-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="group-settings-bind-user">绑定用户</label>
            <select id="group-settings-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="group-world-book-checkboxes" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-group-settings-button" class="form-button">保存设置</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="group-clear-history-button" class="form-button warning"
            style=" margin-bottom: 10px;">清空聊天记录</button>
          <button id="group-delete-button" class="form-button destructive">删除并解散群聊</button>
        </div>
      </div>
    </div>

    <div id="music-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-feed" class="header-button">返回</button>
        <span id="friend-circle-title" class="header-title">好友圈</span>
        <div style="display: flex; gap: 5px;">
          <button id="edit-current-circle-button" class="header-button" style="font-size: 1.2rem;">⚙️</button>
          <button id="clear-feed-button" class="header-button" style="color: #dc3545;">清空</button>
          <button id="refresh-feed-button" class="header-button">刷新</button>

        </div>
      </div>
      <div id="user-post-area"
        style="padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background: var(--surface-bg);">
        <div id="user-post-input-container">
          <img id="user-post-avatar" class="char-avatar">
          <div id="user-post-main-area">
            <textarea id="user-post-textarea" rows="3" placeholder="分享你的新鲜事..."></textarea>
            <div id="user-post-attachment-preview"></div>
          </div>
        </div>
        <div id="user-post-toolbar">
          <div id="user-post-actions" class="user-post-actions">
            <button id="user-post-image-button" class="toolbar-button" title="分享图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <input type="file" id="user-post-image-input" accept="image/*" style="display: none;">
            <button id="user-post-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
          </div>
          <button id="user-send-post-button">发送</button>
        </div>
      </div>
      <div id="music-feed-container" class="content" style="padding: 10px;">
      </div>
      <div id="music-player-bar" class="hidden">
        <img id="player-cover" src="">
        <div id="player-info">
          <div id="player-title"></div>
          <div id="player-artist"></div>
        </div>
        <div id="player-controls">
          <button id="player-prev-btn">⏮</button>
          <button id="player-play-pause-btn">▶</button>
          <button id="player-next-btn">⏭</button>
        </div>
      </div>
      <audio id="audio-player"></audio>
    </div>
    <div id="meeting-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-meeting-list" class="header-button">主屏幕</button>
        <span class="header-title">选择见面对象</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="meeting-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="meeting-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-meeting-list">返回</button>
        <span id="meeting-char-name-header" class="header-title">角色</span>
        <button id="toggle-meeting-view-button" class="header-button">切换视角</button>

      </div>
      <div id="meeting-main-content" class="content" style="position: relative; padding: 0;">
        <div id="galgame-overlay-ui">
          <div id="galgame-time">12:00</div>
          <div id="galgame-date">1月1日 星期一</div>
        </div>
        <div id="galgame-sprite-adjust-ui"
          style="position: absolute; top: 20px; right: 20px; z-index: 11; display: none;">
          <button id="sprite-adjust-button" class="toolbar-button" title="调整立绘位置">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 7h-9" />
              <path d="M14 17H5" />
              <circle cx="17" cy="17" r="3" />
              <circle cx="8" cy="7" r="3" />
            </svg>
          </button>
        </div>

        <div id="galgame-sprite-controls"
          style="display: none; position: absolute; bottom: 15px; left: 15px; right: 15px; z-index: 1001; background: rgba(0,0,0,0.7); backdrop-filter: blur(8px); border-radius: 12px; padding: 15px; box-shadow: 0 -2px 15px rgba(0,0,0,0.3);">
          <div class="sprite-slider-group">
            <label for="sprite-slider-x">左右位置</label>
            <input type="range" id="sprite-slider-x" min="0" max="100" value="50">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-y">上下位置</label>
            <input type="range" id="sprite-slider-y" min="0" max="130" value="100">
          </div>
          <div class="sprite-slider-group">
            <label for="sprite-slider-scale">缩放大小</label>
            <input type="range" id="sprite-slider-scale" min="50" max="200" value="100">
          </div>
          <div style="display: flex; gap: 10px; margin-top: 15px;">
            <button id="sprite-confirm-button" class="form-button">确定</button>
            <button id="sprite-cancel-button" class="form-button secondary">取消</button>
            <button id="sprite-reset-button" class="form-button destructive"
              style="padding: 10px 12px; width: auto; font-size: 1.2rem;">⟲</button>
          </div>
        </div>
        <div id="meeting-scene-view" class="content"
          style="font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.7);">
        </div>
        <div id="galgame-view-container"
          style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden;">
          <div id="galgame-sprite-wrapper"
            style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; height: 100%;">
            <div id="galgame-sprite-container"
              style="position: absolute; display: flex; align-items: flex-end; justify-content: center; /* 移除旧的定位样式 */">
              <img id="galgame-sprite" src=""
                style="max-height: 100%; max-width: 100%; object-fit: contain; transition: opacity 0.3s ease;">
              <div id="sprite-resize-handle"
                style="display: none; position: absolute; bottom: -5px; right: -5px; width: 20px; height: 20px; background: white; border: 2px solid var(--primary-color); border-radius: 50%; cursor: se-resize;">
              </div>
            </div>
          </div>
          <div id="galgame-textbox-container"
            style="position: absolute; bottom: 9%; left: 5%; right: 5%; background: rgba(0, 0, 0, 0.7); border-radius: 10px; padding: 15px; color: white; border-top: 1px solid rgba(255,255,255,0.2); cursor: pointer;">
            <div id="galgame-speaker" style="font-weight: bold; margin-bottom: 10px;">说话人</div>
            <div id="galgame-text" style="line-height: 1.6;">对话内容...</div>
          </div>
        </div>
      </div>
      <div class="chat-input-area">
        <div id="chat-input-wrapper-meeting"> <textarea id="meeting-message-input" placeholder="输入你的行动或对话..." rows="1"
            style="resize: none; overflow-y: auto; flex-grow: 1; border: none; background: transparent; padding: 9px 12px; font-size: .95rem; outline: none; color: var(--text-color);"></textarea>
          <button id="meeting-send-button" title="发送">➤</button>
        </div>
      </div>
    </div>

    <div id="friend-circle-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-circle-list" class="header-button">主屏幕</button>
        <span class="header-title">好友圈</span>
        <button id="add-friend-circle-button" class="header-button add" title="新建好友圈">+</button>
      </div>
      <div id="friend-circle-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="friend-circle-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-edit" class="header-button">返回</button>
        <span id="friend-circle-edit-title" class="header-title">编辑好友圈</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-friend-circle-id">
        <div class="settings-group">
          <h2>好友圈设定</h2>
          <div class="input-group">
            <label for="friend-circle-edit-name">圈子名称</label>
            <input type="text" id="friend-circle-edit-name" placeholder="例如：我的日常">
          </div>
          <div class="input-group">
            <label for="friend-circle-edit-bind-user">绑定的“我”</label>
            <select id="friend-circle-edit-bind-user"></select>
          </div>
        </div>
        <div class="settings-group">
          <h2>选择圈内成员</h2>
          <div id="friend-circle-member-selection"
            style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
          </div>
        </div>
        <button id="save-friend-circle-button" class="form-button">保存</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <button id="delete-friend-circle-button" class="form-button destructive">删除该好友圈</button>
        </div>
      </div>
    </div>
    <div id="diary-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-diary-list" class="header-button">主屏幕</button>
        <span class="header-title">交换日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="diary-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-diary-list">返回</button>
        <span id="diary-char-name-header" class="header-title">TA的日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-entries-container" class="content"
        style="padding: 20px; font-family: 'KaiTi', 'STSong', serif; line-height: 1.8;">
      </div>
      <div class="chat-input-area">
        <div id="diary-input-wrapper" style="display: flex; gap: 10px;">
          <input type="text" id="diary-entry-input" placeholder="写下你的日记或批注..." style="flex-grow: 1;">
          <button id="diary-send-button" class="form-button"
            style="width: auto; margin-top: 0; padding: 0 18px;">写好了</button>
          <button id="diary-get-reply-button" class="form-button"
            style="width: auto; margin-top: 0; background-color: #555; padding: 0 18px;">催TA写</button>
        </div>
      </div>
    </div>
    <div id="music-library-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-music-library" class="header-button">主屏幕</button>
        <span class="header-title">音乐库</span>
        <button id="upload-music-button" class="header-button add" title="上传新音乐">+</button>
      </div>
      <div class="content" id="music-library-container">
      </div>
    </div>
    <div id="music-upload-altar-screen" class="screen">
      <div class="header">
        <button id="back-to-library-from-altar" class="header-button">取消</button>
        <span class="header-title">献上音乐</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content" style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">

        <div class="upload-slot" id="altar-slot-audio">
          <span class="slot-icon">🎵</span>
          <span class="slot-label">音频文件 (必需)</span>
          <span class="slot-filename">点击选择 .mp3 或 .flac</span>
        </div>

        <div class="upload-slot" id="altar-slot-cover">
          <span class="slot-icon">🖼️</span>
          <span class="slot-label">封面图片 (可选)</span>
          <span class="slot-filename">点击选择 .jpg 或 .png</span>
        </div>

        <div class="upload-slot" id="altar-slot-info">
          <span class="slot-icon">📄</span>
          <span class="slot-label">歌曲信息 (必需)</span>
          <span class="slot-filename">点击选择 info.txt</span>
        </div>

        <div class="upload-slot" id="altar-slot-lyrics">
          <span class="slot-icon">🎤</span>
          <span class="slot-label">歌词文件 (可选)</span>
          <span class="slot-filename">点击选择 .lrc</span>
        </div>

        <button id="confirm-altar-upload-button" class="form-button" disabled>献上祭品</button>
      </div>

    </div>


    <div id="accounting-screen" class="screen">
      <div class="header" id="accounting-header">
        <button id="back-to-home-from-accounting" class="header-button">主屏幕</button>
        <span id="accounting-title" class="header-title">记一笔</span>
        <div id="header-actions" style="width: 80px; text-align: right;"></div>
      </div>

      <div class="accounting-tabs">
        <button id="tab-record-expense" class="tab-button active">记一笔</button>
        <button id="tab-view-ledger" class="tab-button">看账本</button>
      </div>

      <div id="accounting-content-area" class="content" style="padding: 15px;">
      </div>
    </div>
    <audio id="audio-player"></audio>

    <audio id="unified-audio-player"></audio>



  </div>
  </div>

  <div id="add-choice-modal" class="choice-modal">
    <div id="add-choice-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="choice-create-character" class="choice-modal-button">创建新角色</button>
      <button id="choice-create-group" class="choice-modal-button">创建新群聊</button>
      <button id="choice-import-character" class="choice-modal-button">导入角色卡</button>
      <button id="choice-cancel" class="choice-modal-button cancel">取消</button>
    </div>
  </div>


  <div id="transfer-modal" class="choice-modal">
    <div id="transfer-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">转账</h3>
      <div id="transfer-recipient-group" class="input-group" style="margin: 10px 0; display: none;">
        <label for="transfer-recipient-select">转给</label>
        <select id="transfer-recipient-select"></select>
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="transfer-amount-input">金额</label>
        <input type="number" id="transfer-amount-input" placeholder="输入金额">
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-transfer-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认转账</button>
        <button id="cancel-transfer-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="message-action-modal" class="choice-modal">
    <div id="message-action-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="edit-message-button" class="choice-modal-button">编辑消息</button>
      <button id="quote-message-button" class="choice-modal-button">引用</button>
      <button id="delete-message-button" class="choice-modal-button" style="color: #dc3545;">删除消息</button>
      <button id="cancel-action-button" class="choice-modal-button cancel">取消</button>
    </div>
  </div>

  <div id="edit-message-modal" class="choice-modal">
    <div id="edit-message-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">编辑消息</h3>
      <textarea id="edit-message-textarea" style="width: 100%; min-height: 100px; margin: 10px 0;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 10px;">
        <button id="save-edit-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">保存</button>
        <button id="cancel-edit-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="music-input-modal" class="choice-modal">
    <div id="music-input-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 id="music-input-title" style="margin-top: 0; text-align: center; font-weight: 600;">分享音乐</h3>

      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-song" style="font-size: 0.9rem;">歌名</label>
        <input type="text" id="music-input-song" placeholder="例如：夜曲">
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-artist" style="font-size: 0.9rem;">歌手</label>
        <input type="text" id="music-input-artist" placeholder="例如：周杰伦">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-music-input" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认</button>
        <button id="cancel-music-input" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="modal-root"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;">
    <div id="modal-mask" style="position:absolute;inset:0;background:rgba(0,0,0,.35);"></div>
    <div id="modal-dialog"
      style="position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:80%;max-width:320px;padding:16px;">
      <div id="modal-text" style="font-size:14px;color:#333;line-height:1.5;white-space:pre-wrap;"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px;">
        <button id="modal-cancel"
          style="padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;">取消</button>
        <button id="modal-ok"
          style="padding:8px 12px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">确定</button>
      </div>
    </div>
  </div>

  <div id="listen-together-modal" class="choice-modal">
    <div id="listen-together-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <div style="width: 50px;"></div>
        <span class="header-title">选择一首歌，一起听</span>
        <button id="cancel-listen-together" class="header-button" style="min-width: 50px;">取消</button>
      </div>
      <div id="listen-together-song-list" class="content" style="flex-grow: 1; padding: 10px;">
      </div>
    </div>
  </div>

  <div id="toast"
    style="position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:8px;font-size:12px;display:none;z-index:10000;">
  </div>


  <script>
    const _0x18f426 = _0x321d; (function (_0xce7499, _0x55e819) { const _0x466c5e = _0x321d, _0x24b0f5 = _0xce7499(); while (!![]) { try { const _0x8846fb = parseInt(_0x466c5e(0x50c)) / 0x1 + parseInt(_0x466c5e(0x6ba)) / 0x2 + -parseInt(_0x466c5e(0x205)) / 0x3 + parseInt(_0x466c5e(0x636)) / 0x4 + parseInt(_0x466c5e(0x7a0)) / 0x5 + parseInt(_0x466c5e(0x458)) / 0x6 + -parseInt(_0x466c5e(0x3df)) / 0x7; if (_0x8846fb === _0x55e819) break; else _0x24b0f5['push'](_0x24b0f5['shift']()); } catch (_0xb27a69) { _0x24b0f5['push'](_0x24b0f5['shift']()); } } }(_0xcb80, 0x61878)); var _0x346f80, _0xe4fa1 = null; let _0xfd4511 = [], _0x19bf60 = ![], _0x213e51 = { 'x': 0x0, 'y': 0x0 }; function _0x3e4328(_0x928440) { const _0x56ceee = _0x321d; return (_0x346f80?.[_0x56ceee(0x499)] || [])['find'](_0x57c742 => _0x57c742['id'] === _0x928440); } const _0x3a4007 = _0x18f426(0x3be), _0x223ec8 = _0x18f426(0x7c5), _0x2f6e79 = _0x18f426(0x67a), _0x788fa4 = [{ 'name': _0x18f426(0x699), 'url': _0x18f426(0x2e2) }, { 'name': '崩溃', 'url': _0x18f426(0x8f2) }, { 'name': '生病', 'url': _0x18f426(0x6f9) }, { 'name': '工作', 'url': _0x18f426(0x510) }, { 'name': _0x18f426(0x663), 'url': _0x18f426(0x882) }, { 'name': _0x18f426(0x22b), 'url': _0x18f426(0x1ba) }, { 'name': _0x18f426(0x332), 'url': _0x18f426(0x877) }, { 'name': '期待', 'url': _0x18f426(0x442) }, { 'name': '喜欢', 'url': 'https://sharkpan.xyz/f/55ntj/ul0hkz.jpg' }, { 'name': _0x18f426(0x4c0), 'url': _0x18f426(0x392) }, { 'name': _0x18f426(0x3b2), 'url': _0x18f426(0x188) }, { 'name': '委屈', 'url': _0x18f426(0x778) }, { 'name': '加油', 'url': _0x18f426(0x4a6) }, { 'name': '对的', 'url': _0x18f426(0x807) }, { 'name': '不满', 'url': _0x18f426(0x231) }, { 'name': _0x18f426(0x2c6), 'url': _0x18f426(0x17b) }, { 'name': _0x18f426(0x7a8), 'url': _0x18f426(0x88b) }, { 'name': '委屈', 'url': 'https://sharkpan.xyz/f/25ACQ/gpzab6.jpg' }, { 'name': '平静', 'url': _0x18f426(0x862) }, { 'name': '咬你', 'url': _0x18f426(0x9a3) }, { 'name': '咱俩天下第一好', 'url': _0x18f426(0x462) }, { 'name': '好困', 'url': _0x18f426(0x2d3) }, { 'name': '摸鱼', 'url': _0x18f426(0x3c0) }, { 'name': _0x18f426(0x8b7), 'url': _0x18f426(0x868) }, { 'name': '超激动我来了', 'url': _0x18f426(0x6fb) }, { 'name': _0x18f426(0x3ef), 'url': _0x18f426(0x51d) }, { 'name': _0x18f426(0x77f), 'url': _0x18f426(0x323) }, { 'name': _0x18f426(0x8da), 'url': _0x18f426(0x627) }, { 'name': '啥意思捏', 'url': _0x18f426(0x776) }, { 'name': _0x18f426(0x3ee), 'url': 'https://sharkpan.xyz/f/djyi8/1en214.jpg' }, { 'name': _0x18f426(0x79f), 'url': _0x18f426(0x40a) }, { 'name': '我是垃圾', 'url': _0x18f426(0x23f) }, { 'name': '勉强但是好吧', 'url': 'https://sharkpan.xyz/f/Oyjuy/p8v2hd.jpg' }, { 'name': _0x18f426(0x75a), 'url': _0x18f426(0x528) }, { 'name': _0x18f426(0x45c), 'url': _0x18f426(0x93d) }, { 'name': _0x18f426(0x19f), 'url': 'https://sharkpan.xyz/f/mjeIW/9vf8ws.jpg' }, { 'name': '对不起', 'url': 'https://sharkpan.xyz/f/B4WSa/u5wopj.jpg' }, { 'name': '交给我吧', 'url': _0x18f426(0x32d) }, { 'name': _0x18f426(0x50f), 'url': _0x18f426(0x740) }, { 'name': _0x18f426(0x417), 'url': 'https://sharkpan.xyz/f/VG2FY/uucfvv.jpg' }, { 'name': _0x18f426(0x17e), 'url': _0x18f426(0x865) }, { 'name': _0x18f426(0x331), 'url': _0x18f426(0x3a2) }, { 'name': _0x18f426(0x40e), 'url': _0x18f426(0x705) }, { 'name': _0x18f426(0x8d1), 'url': _0x18f426(0x49f) }, { 'name': _0x18f426(0x263), 'url': _0x18f426(0x42b) }, { 'name': _0x18f426(0x711), 'url': _0x18f426(0x4af) }, { 'name': _0x18f426(0x85d), 'url': 'https://sharkpan.xyz/f/Qpzu6/3b30r2.jpg' }, { 'name': _0x18f426(0x7f7), 'url': _0x18f426(0x654) }, { 'name': _0x18f426(0x729), 'url': _0x18f426(0x585) }, { 'name': _0x18f426(0x40d), 'url': _0x18f426(0x761) }, { 'name': '吃你的饭', 'url': _0x18f426(0x760) }, { 'name': _0x18f426(0x550), 'url': _0x18f426(0x4f6) }, { 'name': '我是女仆', 'url': _0x18f426(0x6ff) }, { 'name': '等你', 'url': _0x18f426(0x507) }, { 'name': _0x18f426(0x1cc), 'url': _0x18f426(0x1d6) }, { 'name': '等你消息', 'url': _0x18f426(0x565) }, { 'name': '喝酒', 'url': _0x18f426(0x96e) }, { 'name': '喝多了', 'url': _0x18f426(0x5b7) }, { 'name': '呜呜', 'url': _0x18f426(0x523) }, { 'name': '为你骄傲', 'url': 'https://sharkpan.xyz/f/7aMhj/hyc75m.jpg' }, { 'name': _0x18f426(0x9b9), 'url': _0x18f426(0x25d) }, { 'name': '出去玩', 'url': _0x18f426(0x449) }, { 'name': _0x18f426(0x7ef), 'url': _0x18f426(0x5c4) }, { 'name': '别这样嘛我哭哭', 'url': 'https://sharkpan.xyz/f/3AGHe/2f8x3x.gif' }], _0x5caa1e = { 'beige': { 'name': _0x18f426(0x5e8), 'h': 0x23, 's': 0x19, 'l': 0x50 }, 'mizuiro': { 'name': _0x18f426(0x3e2), 'h': 0xc3, 's': 0x19, 'l': 0x50 }, 'sakura': { 'name': _0x18f426(0x8de), 'h': 0x159, 's': 0x19, 'l': 0x50 }, 'noir': { 'name': '暗夜紫晶', 'h': 0x104, 's': 0xf, 'l': 0x1e } }; document[_0x18f426(0x35e)]('DOMContentLoaded', () => { const _0x54ed15 = _0x18f426, _0x12349c = document['getElementById']('app-user-profiles'), _0x2a19d5 = document[_0x54ed15(0x954)](_0x54ed15(0x470)), _0x4b59a6 = document['getElementById']('transfer-modal'), _0xa9faa = document[_0x54ed15(0x954)]('transfer-backdrop'), _0x3535f1 = document[_0x54ed15(0x954)](_0x54ed15(0x84c)), _0x2b1a9a = document[_0x54ed15(0x954)](_0x54ed15(0x386)), _0x4c9a01 = document['getElementById'](_0x54ed15(0x18a)), _0x37a6f0 = document['getElementById'](_0x54ed15(0x8b1)), _0x172968 = document[_0x54ed15(0x954)](_0x54ed15(0x9d2)), _0x41852d = document[_0x54ed15(0x954)](_0x54ed15(0x8e7)), _0x2828d0 = document[_0x54ed15(0x954)](_0x54ed15(0x1d1)), _0x3f451c = document[_0x54ed15(0x954)](_0x54ed15(0x86e)), _0x5124d9 = document[_0x54ed15(0x954)](_0x54ed15(0x3ac)), _0x460947 = document[_0x54ed15(0x954)](_0x54ed15(0x283)), _0xba5320 = document[_0x54ed15(0x954)]('copy-summary-button'), _0x1176ad = document[_0x54ed15(0x954)](_0x54ed15(0x567)), _0xb79f5b = document['getElementById'](_0x54ed15(0x4ce)), _0xba7cdd = document[_0x54ed15(0x954)](_0x54ed15(0x4ac)), _0x3d3798 = document[_0x54ed15(0x954)](_0x54ed15(0x839)), _0x19b554 = document['getElementById']('char-edit-offline-bg-input'), _0x5c617c = document[_0x54ed15(0x954)](_0x54ed15(0x3da)), _0x4da6a2 = document[_0x54ed15(0x954)]('import-char-input'), _0x4c84f8 = document['getElementById'](_0x54ed15(0x9cb)); function _0x213750() { const _0x46a383 = _0x54ed15, _0x1f51b7 = document[_0x46a383(0x954)](_0x46a383(0x53e)); if (!_0x1f51b7) return; const _0x2f8285 = localStorage[_0x46a383(0x164)](_0x46a383(0x1fd)) || '35'; document[_0x46a383(0x5f6)][_0x46a383(0x94f)][_0x46a383(0x324)](_0x46a383(0x637), _0x2f8285), _0x1f51b7[_0x46a383(0x908)] = _0x2f8285, _0x1f51b7[_0x46a383(0x35e)]('input', () => { const _0x52979f = _0x46a383, _0x3b0ffd = _0x1f51b7[_0x52979f(0x908)]; document[_0x52979f(0x5f6)][_0x52979f(0x94f)][_0x52979f(0x324)](_0x52979f(0x637), _0x3b0ffd), localStorage[_0x52979f(0x6c6)](_0x52979f(0x1fd), _0x3b0ffd), _0x1efcc6(); }); } function _0x2bb569() { const _0x4db473 = _0x54ed15; if (_0x4db473(0x448) !== _0x4db473(0x448)) { if (!_0x4159c9) return []; const _0x12e67b = _0x4cbc6c[_0x4db473(0x1a7)]('\x0a'), _0x380dc8 = [], _0x3048e2 = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x476196 of _0x12e67b) { const _0x27dc34 = _0x476196['match'](_0x3048e2); if (_0x27dc34) { const _0x51c499 = _0x36821d(_0x27dc34[0x1], 0xa), _0x4682b0 = _0x598393(_0x27dc34[0x2], 0xa), _0x35e450 = _0x16bc39(_0x27dc34[0x3], 0xa) * (_0x27dc34[0x3][_0x4db473(0x6c3)] === 0x2 ? 0xa : 0x1), _0x5a4903 = _0x51c499 * 0x3c + _0x4682b0 + _0x35e450 / 0x3e8, _0x496394 = _0x476196[_0x4db473(0x330)](_0x3048e2, '')[_0x4db473(0x4dd)](); _0x496394 && _0x380dc8['push']({ 'time': _0x5a4903, 'text': _0x496394 }); } } return _0x380dc8; } else { const _0x556b19 = document['getElementById'](_0x4db473(0x38b)); if (!_0x556b19) return; const _0x2bad3e = localStorage[_0x4db473(0x164)](_0x4db473(0x7d1)) || '80'; document[_0x4db473(0x5f6)]['style'][_0x4db473(0x324)]('--primary-lightness', _0x2bad3e + '%'), _0x556b19[_0x4db473(0x908)] = _0x2bad3e, _0x556b19['addEventListener'](_0x4db473(0x7b5), () => { const _0x57be65 = _0x4db473, _0x33f1c3 = _0x556b19['value']; document[_0x57be65(0x5f6)][_0x57be65(0x94f)][_0x57be65(0x324)]('--primary-lightness', _0x33f1c3 + '%'), localStorage[_0x57be65(0x6c6)](_0x57be65(0x7d1), _0x33f1c3), _0x1efcc6(); }); } } function _0x1efcc6() { const _0x1ee6d5 = _0x54ed15, _0x514c79 = document[_0x1ee6d5(0x954)](_0x1ee6d5(0x3eb)); if (!_0x514c79) return; _0x346f80['preferences'][_0x1ee6d5(0x209)] ? (_0x514c79[_0x1ee6d5(0x94f)][_0x1ee6d5(0x4cf)] = _0x1ee6d5(0x2be), _0x514c79[_0x1ee6d5(0x94f)]['textShadow'] = _0x1ee6d5(0x6bd)) : (_0x514c79['style']['color'] = 'var(--text-color)', _0x514c79['style']['textShadow'] = _0x1ee6d5(0x910)); } function _0x42b218() { const _0x1bec97 = _0x54ed15, _0x5cde4a = document[_0x1bec97(0x954)](_0x1bec97(0x4f3)); if (!_0x5cde4a) return; _0x5cde4a[_0x1bec97(0x896)] = _0x346f80[_0x1bec97(0x4fe)]['forceWhiteClock'] || ![], _0x5cde4a['addEventListener'](_0x1bec97(0x2ed), () => { const _0x21d6f3 = _0x1bec97; _0x21d6f3(0x484) !== _0x21d6f3(0x484) ? _0x474620['style'][_0x21d6f3(0x3b4)] = _0x21d6f3(0x910) : (_0x346f80[_0x21d6f3(0x4fe)][_0x21d6f3(0x209)] = _0x5cde4a[_0x21d6f3(0x896)], _0x23c6b9(), _0x1efcc6()); }); } _0x4c84f8[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x2d003e), _0x5c617c[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x8a07f3 = _0x54ed15; _0x8a07f3(0x5b2) !== _0x8a07f3(0x5b2) ? _0x26bddb(() => { const _0x2b5ddf = _0x8a07f3, _0x3ffff7 = _0x59ad59['getElementById'](_0x52f05c); if (_0x3ffff7) _0x3ffff7[_0x2b5ddf(0x7d9)] = _0x3eca08[_0x2b5ddf(0x4ea)]; }, 0x0) : (_0x396385(), _0x4da6a2[_0x8a07f3(0x39c)]()); }), _0x4da6a2[_0x54ed15(0x35e)](_0x54ed15(0x2ed), _0x1a7a62); const _0x3473b9 = { 'home': document[_0x54ed15(0x954)]('home-screen'), 'chat': document['getElementById'](_0x54ed15(0x512)), 'settings': document[_0x54ed15(0x954)](_0x54ed15(0x7ba)), 'userProfile': document['getElementById'](_0x54ed15(0x2d2)), 'characterEdit': document[_0x54ed15(0x954)](_0x54ed15(0x58f)), 'groupChatCreate': document[_0x54ed15(0x954)](_0x54ed15(0x4e7)), 'wallpaper': document[_0x54ed15(0x954)]('wallpaper-screen'), 'worldBook': document[_0x54ed15(0x954)](_0x54ed15(0x5a2)), 'worldBookEditor': document[_0x54ed15(0x954)]('world-book-editor-screen'), 'groupSettings': document['getElementById']('group-settings-screen'), 'music': document[_0x54ed15(0x954)](_0x54ed15(0x4cb)), 'friendCircleList': document['getElementById'](_0x54ed15(0x4e3)), 'friendCircleEdit': document[_0x54ed15(0x954)](_0x54ed15(0x555)), 'meetingList': document[_0x54ed15(0x954)](_0x54ed15(0x1c0)), 'meetingView': document[_0x54ed15(0x954)]('meeting-view-screen'), 'userProfileList': document['getElementById'](_0x54ed15(0x683)), 'diaryList': document[_0x54ed15(0x954)](_0x54ed15(0x341)), 'diaryView': document[_0x54ed15(0x954)](_0x54ed15(0x51b)), 'musicLibrary': document['getElementById'](_0x54ed15(0x1c3)), 'musicUploadAltar': document[_0x54ed15(0x954)](_0x54ed15(0x78a)), 'accounting': document[_0x54ed15(0x954)](_0x54ed15(0x750)) }, _0x1d7949 = document[_0x54ed15(0x954)]('upload-feed-bg-button'), _0x10fc40 = document[_0x54ed15(0x954)]('feed-bg-input'), _0x3ba965 = document['getElementById'](_0x54ed15(0x68d)), _0x4cff91 = document['getElementById'](_0x54ed15(0x9c5)), _0x5749b6 = document[_0x54ed15(0x954)](_0x54ed15(0x5a6)), _0x47afa0 = document[_0x54ed15(0x954)](_0x54ed15(0x675)), _0x4dce3e = document[_0x54ed15(0x954)]('wallpaper-input'), _0x3d7e6a = document[_0x54ed15(0x954)](_0x54ed15(0x837)); document[_0x54ed15(0x954)](_0x54ed15(0x72e))[_0x54ed15(0x35e)](_0x54ed15(0x39c), async () => { const _0x28f94b = _0x54ed15; if (_0x28f94b(0x605) === _0x28f94b(0x605)) { const _0x5f570c = await _0x57c3ed(_0x28f94b(0x4d1)); if (_0x5f570c) { if (_0x28f94b(0x7c9) !== _0x28f94b(0x7c9)) _0x21c4d8[_0x28f94b(0x509)] = _0x203b48['id'], _0x138bfd(), _0x3bbd50(), _0x25b79d(_0x5d5ae5); else { localStorage[_0x28f94b(0x845)](_0x28f94b(0x7a4)), localStorage[_0x28f94b(0x845)](_0x28f94b(0x5e7)), localStorage['removeItem']('clockPosition'), localStorage[_0x28f94b(0x845)](_0x28f94b(0x233)); const _0x5efc54 = []; for (let _0x3f2707 = 0x0; _0x3f2707 < localStorage[_0x28f94b(0x6c3)]; _0x3f2707++) { if ('oxgPA' !== _0x28f94b(0x586)) { const _0x3585a2 = _0x5c63ca[_0x28f94b(0x678)]; _0x231331[_0x28f94b(0x2ce)] = _0x2a8eea + (_0x3585a2 - _0xc4fb07); } else { const _0x4d32b3 = localStorage[_0x28f94b(0x955)](_0x3f2707); _0x4d32b3 && _0x4d32b3['startsWith'](_0x28f94b(0x16b)) && _0x5efc54[_0x28f94b(0x580)](_0x4d32b3); } } _0x5efc54[_0x28f94b(0x927)](_0x3941fe => localStorage[_0x28f94b(0x845)](_0x3941fe)), await _0x336559(_0x28f94b(0x44d), await _0x407d73(_0x28f94b(0x193))), _0x3383df(_0x28f94b(0x2ee)), setTimeout(() => location[_0x28f94b(0x55a)](), 0x5dc); } } } else _0x5c7d1d[_0x28f94b(0x35e)](_0x28f94b(0x39c), () => _0x44534a[_0x28f94b(0x39c)]()), _0x381dd7[_0x28f94b(0x35e)](_0x28f94b(0x2ed), async _0x4aa4a1 => { const _0x16a961 = _0x28f94b, _0xeb0af4 = _0x4aa4a1[_0x16a961(0x921)][_0x16a961(0x626)][0x0]; if (!_0xeb0af4) return; try { _0x19973b[_0x16a961(0x7d9)] = _0x4f36f6['createObjectURL'](_0xeb0af4); } catch (_0x37a45e) { _0x542dc8(_0x16a961(0x6af) + _0x37a45e[_0x16a961(0x399)]); } }); }); const _0x587210 = document[_0x54ed15(0x954)](_0x54ed15(0x7ab)), _0x2d2946 = document['getElementById'](_0x54ed15(0x1ec)), _0x5734fa = document[_0x54ed15(0x954)]('choice-create-character'), _0x59253f = document[_0x54ed15(0x954)](_0x54ed15(0x2a6)), _0x14dfb8 = document[_0x54ed15(0x954)]('choice-cancel'), _0x560c19 = document[_0x54ed15(0x954)]('back-to-char-select-from-group-create'), _0x895e8d = document[_0x54ed15(0x954)](_0x54ed15(0x5b4)), _0x27075f = document['getElementById'](_0x54ed15(0x2a5)), _0x119e6d = document[_0x54ed15(0x954)](_0x54ed15(0x8a9)), _0x5eb710 = document[_0x54ed15(0x954)](_0x54ed15(0x57f)), _0xcc32de = document[_0x54ed15(0x954)](_0x54ed15(0x25e)), _0x304682 = document[_0x54ed15(0x954)](_0x54ed15(0x3b5)), _0x3f8dc4 = document[_0x54ed15(0x954)](_0x54ed15(0x2dd)), _0x4902ec = document['getElementById']('back-to-chat-list'), _0x48e04d = document[_0x54ed15(0x954)](_0x54ed15(0x1db)), _0x228fad = document[_0x54ed15(0x954)](_0x54ed15(0x7d5)), _0x1a15c4 = document[_0x54ed15(0x954)]('character-list'), _0xa2fb27 = document[_0x54ed15(0x954)](_0x54ed15(0x6c9)), _0x36dcf3 = document[_0x54ed15(0x954)](_0x54ed15(0x512)), _0x5a55b2 = document[_0x54ed15(0x954)](_0x54ed15(0x517)), _0x2bab43 = document[_0x54ed15(0x954)]('chat-message-input'), _0x5e0246 = document[_0x54ed15(0x954)](_0x54ed15(0x652)), _0x17d505 = document[_0x54ed15(0x954)](_0x54ed15(0x29a)), _0x49bee8 = document[_0x54ed15(0x954)](_0x54ed15(0x478)), _0x5454ee = document[_0x54ed15(0x954)](_0x54ed15(0x403)), _0x15209a = document['getElementById'](_0x54ed15(0x5c8)), _0x311903 = document[_0x54ed15(0x954)](_0x54ed15(0x277)), _0x2e3040 = document[_0x54ed15(0x954)](_0x54ed15(0x23d)), _0x2b6768 = document[_0x54ed15(0x954)](_0x54ed15(0x68a)), _0x24aa0 = document[_0x54ed15(0x954)]('chat-sticker-panel'), _0x3560db = document['getElementById']('chat-image-button'), _0xd80c7 = document[_0x54ed15(0x954)]('chat-image-input'), _0x320b91 = document[_0x54ed15(0x954)](_0x54ed15(0x8fd)), _0x545d26 = document[_0x54ed15(0x954)](_0x54ed15(0x208)), _0x24b906 = document[_0x54ed15(0x954)](_0x54ed15(0x446)), _0x74f9b5 = document[_0x54ed15(0x954)](_0x54ed15(0x4c2)), _0x3b092f = document[_0x54ed15(0x954)]('api-model'), _0x3c6b5a = document[_0x54ed15(0x954)](_0x54ed15(0x391)), _0x543207 = document['getElementById'](_0x54ed15(0x45a)), _0xbb0d47 = document[_0x54ed15(0x954)](_0x54ed15(0x31c)), _0x500a12 = document['getElementById'](_0x54ed15(0x2fb)), _0x4707f6 = document['getElementById'](_0x54ed15(0x57a)), _0x311d8d = document[_0x54ed15(0x954)](_0x54ed15(0x21b)), _0x4bf07c = document[_0x54ed15(0x954)](_0x54ed15(0x2db)), _0x442ceb = document[_0x54ed15(0x954)]('user-persona'), _0x44d6fe = document[_0x54ed15(0x954)](_0x54ed15(0x584)), _0x38aed = document['getElementById'](_0x54ed15(0x4f1)), _0x52a990 = document[_0x54ed15(0x954)]('character-edit-title'), _0x22cf00 = document['getElementById'](_0x54ed15(0x2a2)), _0x1092b8 = document[_0x54ed15(0x954)]('char-edit-remark'), _0x1f81b5 = document['getElementById']('char-edit-avatar-preview'), _0x39ce78 = document[_0x54ed15(0x954)](_0x54ed15(0x5f0)), _0x3d3218 = document[_0x54ed15(0x954)](_0x54ed15(0x8fe)), _0x9ea70d = document[_0x54ed15(0x954)](_0x54ed15(0x582)), _0x40e1ae = document['getElementById'](_0x54ed15(0x3cb)), _0x376a49 = document[_0x54ed15(0x954)](_0x54ed15(0x551)); let _0x357847 = null; const _0x251a3f = _0x54ed15(0x251), _0x57c586 = _0x54ed15(0x295); _0x346f80 = { 'characters': [], 'worldBooks': [], 'chats': [], 'userProfiles': [], 'activeUserProfileId': null, 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'widgetBgImage': null, 'perChatContextLines': 0x64, 'forceWhiteClock': ![] }, 'activeChatId': null, 'activeMeetingCharId': null, 'isGenerating': ![], 'currentAbortController': null, 'pendingMessageTimers': [], 'conversationHistory': [], 'displayedMessageCount': 0x64, 'activeQuote': null, 'friendCircles': [], 'activeFriendCircleId': null, 'accountingData': [], 'accountingLedger': {}, 'diaries': [], 'activeDiaryCharacterId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'meetingViewMode': _0x54ed15(0x6d6), 'activeMeetingScriptQueue': [], 'characterLastScripts': {}, 'musicPlaylist': [], 'currentlyPlayingIndex': -0x1, 'isPlaying': ![], 'pendingPostAttachments': { 'image': null, 'music': null } }; function _0x23c6b9() { const _0x1c82d9 = _0x54ed15; if (_0x1c82d9(0x35d) !== _0x1c82d9(0x35d)) { if (_0x441116[_0x1c82d9(0x6b9)] === 'assistant') { const _0xcb5fa9 = _0x2b94bc[_0x1c82d9(0x2c7)][_0x2ec57a]; _0xcb5fa9 && _0xcb5fa9[_0x1c82d9(0x6c3)] > 0x0 && (_0x8e0e44 = _0xcb5fa9['at'](-0x1)); } else _0x37f498 = { 'speaker': _0xc08ab4[_0x1c82d9(0x4e6)], 'line': _0x2bb6e7[_0x1c82d9(0x2fc)], 'emotion': _0x1c82d9(0x7e0) }; } else try { const _0x36be3d = { 'characters': _0x346f80[_0x1c82d9(0x499)], 'worldBooks': _0x346f80[_0x1c82d9(0x814)], 'chats': _0x346f80['chats'], 'userProfile': _0x346f80['userProfile'], 'apiSettings': _0x346f80[_0x1c82d9(0x98c)], 'preferences': _0x346f80['preferences'], 'activeChatId': _0x346f80[_0x1c82d9(0x509)], 'diaries': _0x346f80[_0x1c82d9(0x94b)], 'friendCircles': _0x346f80[_0x1c82d9(0x4a8)], 'activeFriendCircleId': _0x346f80[_0x1c82d9(0x903)], 'userProfiles': _0x346f80[_0x1c82d9(0x2f5)], 'activeUserProfileId': _0x346f80[_0x1c82d9(0x7da)], 'accountingData': _0x346f80['accountingData'], 'accountingLedger': _0x346f80[_0x1c82d9(0x4aa)] }; localStorage[_0x1c82d9(0x6c6)](_0x1c82d9(0x273), JSON['stringify'](_0x36be3d)); } catch (_0xfd11a5) { console[_0x1c82d9(0x8d6)]('Failed\x20to\x20save\x20state\x20to\x20localStorage:', _0xfd11a5), _0x3383df('无法保存状态，浏览器可能禁用了存储功能。'); } } function _0xbbfd09() { const _0x474520 = _0x54ed15; let _0x4fe4fe = null; try { if (_0x474520(0x871) === _0x474520(0x871)) _0x4fe4fe = localStorage[_0x474520(0x164)](_0x474520(0x273)); else { const _0x204576 = _0x12bc0c[_0x474520(0x7c6)](_0x474520(0x829) + _0x23fe22); if (_0x204576) _0x204576['checked'] = !![]; } } catch (_0x4502b5) { console['error'](_0x474520(0x76d), _0x4502b5), _0x3383df(_0x474520(0x85f)); } if (_0x4fe4fe) try { if (_0x474520(0x8bf) === _0x474520(0x800)) _0x525edb[_0x474520(0x35e)](_0x474520(0x39c), () => { const _0x28edaf = _0x474520; if (_0x6a838f[_0x28edaf(0x6c3)] === 0x0) return; _0x14f449 = (_0x7f1a30 + 0x1) % _0x3cb4a3[_0x28edaf(0x6c3)], _0x4c0605(_0x5c43ec[_0x54029c], _0x170e1c); }); else { const _0x480f4f = JSON['parse'](_0x4fe4fe); if (!_0x480f4f || typeof _0x480f4f !== _0x474520(0x186)) throw new Error(_0x474520(0x492)); Array['isArray'](_0x480f4f[_0x474520(0x499)]) && (_0x346f80['characters'] = _0x480f4f[_0x474520(0x499)][_0x474520(0x2a0)](_0x18eb22 => ({ 'offlineBackground': '', ..._0x18eb22 }))[_0x474520(0x6e8)](_0x14f935 => _0x14f935 && typeof _0x14f935 === _0x474520(0x186) && _0x14f935['id'])); if (_0x480f4f['accountingData']) { if (_0x474520(0x629) === _0x474520(0x9ae)) { const _0x4c2d1d = _0x14de1d['getElementById'](_0xdaf41e); if (_0x4c2d1d) _0x4c2d1d[_0x474520(0x7d9)] = _0x3db740[_0x474520(0x4ea)]; } else _0x346f80[_0x474520(0x28a)] = _0x480f4f[_0x474520(0x28a)]; } _0x480f4f[_0x474520(0x4aa)] && ('IsYLU' === 'IsYLU' ? _0x346f80[_0x474520(0x4aa)] = _0x480f4f['accountingLedger'] : _0x9c3e6c['textContent'] = '❚❚'); Array[_0x474520(0x86b)](_0x480f4f[_0x474520(0x814)]) && (_0x474520(0x66e) !== _0x474520(0x9a6) ? _0x346f80['worldBooks'] = _0x480f4f['worldBooks'] : _0x43ce50[_0x474520(0x8d6)]('在“一起听”邀请中，净化封面失败:', _0x136c4e)); if (Array[_0x474520(0x86b)](_0x480f4f[_0x474520(0x94b)])) { if (_0x474520(0x63b) !== 'HLAXw') _0x346f80[_0x474520(0x94b)] = _0x480f4f['diaries']; else { if (_0x1a96ba[_0x474520(0x955)] === _0x474520(0x1e1)) _0x18da57(![]); if (_0x956162[_0x474520(0x955)] === 'Enter') _0x2b69f1(!![]); } } if (Array[_0x474520(0x86b)](_0x480f4f[_0x474520(0x4a8)])) _0x346f80['friendCircles'] = _0x480f4f[_0x474520(0x4a8)], _0x346f80['activeFriendCircleId'] = _0x480f4f['activeFriendCircleId']; else { if (Array[_0x474520(0x86b)](_0x480f4f[_0x474520(0x452)]) && _0x480f4f['musicFeed'][_0x474520(0x6c3)] > 0x0) { console[_0x474520(0x7e5)](_0x474520(0x5ba)); const _0x2b3dc0 = { 'id': _0x474520(0x268) + Date[_0x474520(0x909)](), 'name': _0x474520(0x8a7), 'boundUserProfileId': _0x480f4f[_0x474520(0x7da)], 'memberCharacterIds': _0x480f4f[_0x474520(0x499)][_0x474520(0x2a0)](_0x214361 => _0x214361['id']), 'posts': _0x480f4f[_0x474520(0x452)] }; _0x346f80[_0x474520(0x4a8)] = [_0x2b3dc0], _0x346f80[_0x474520(0x903)] = _0x2b3dc0['id']; } } if (Array[_0x474520(0x86b)](_0x480f4f[_0x474520(0x2f5)])) { if (_0x474520(0x187) === 'zYolg') _0x346f80['userProfiles'] = _0x480f4f[_0x474520(0x2f5)], _0x346f80['activeUserProfileId'] = _0x480f4f[_0x474520(0x7da)]; else for (const _0x143053 in _0x30f7b6) { _0x2b6156['style'][_0x143053] = _0x4a66dc[_0x143053]; } } else { if (_0x480f4f['userProfile']) { if ('EzbBX' === _0x474520(0x6aa)) { const _0x40a9e2 = _0x4d5dc1[_0x474520(0x743)]((_0xd74077 - _0x29f8c8) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x594eaf += _0x474520(0x461) + _0x40a9e2 + _0x474520(0x995); } else { console['log'](_0x474520(0x7f9)); const _0x12bae1 = { 'id': _0x474520(0x702) + Date[_0x474520(0x909)](), 'name': _0x480f4f[_0x474520(0x364)][_0x474520(0x4e6)] || '我', 'avatar': _0x480f4f[_0x474520(0x364)][_0x474520(0x4ef)] || _0x223ec8, 'persona': _0x480f4f[_0x474520(0x364)][_0x474520(0x1a5)] || '' }; _0x346f80['userProfiles'] = [_0x12bae1], _0x346f80[_0x474520(0x7da)] = _0x12bae1['id']; } } } if (_0x480f4f['apiSettings'] && typeof _0x480f4f[_0x474520(0x98c)] === 'object') { if (_0x474520(0x72d) === 'zhoWV') { const _0x50eac7 = { 'quotedMessage': null, 'content': _0x5ac82a }, _0x2cac1f = _0x4edb73[_0x474520(0x2bc)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x2cac1f && (_0x50eac7[_0x474520(0x2da)] = { 'sender': _0x2cac1f[0x1]['trim'](), 'content': _0x2cac1f[0x2][_0x474520(0x4dd)]() }, _0x50eac7[_0x474520(0x2fc)] = _0x306b6c[_0x474520(0x8f0)](_0x2cac1f[0x0][_0x474520(0x6c3)])[_0x474520(0x4dd)]()), _0x50eac7; } else _0x346f80[_0x474520(0x98c)] = { ..._0x346f80[_0x474520(0x98c)], ..._0x480f4f[_0x474520(0x98c)] }; } _0x480f4f[_0x474520(0x4fe)] && typeof _0x480f4f[_0x474520(0x4fe)] === _0x474520(0x186) ? _0x346f80[_0x474520(0x4fe)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x480f4f[_0x474520(0x4fe)] } : _0x346f80['preferences'] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; if (Array[_0x474520(0x86b)](_0x480f4f[_0x474520(0x3aa)])) _0x474520(0x471) !== _0x474520(0x88f) ? (_0x346f80[_0x474520(0x3aa)] = _0x480f4f[_0x474520(0x3aa)], _0x346f80[_0x474520(0x509)] = _0x480f4f[_0x474520(0x509)] || null) : (_0x3c4efe[_0x474520(0x730)](), _0x9b40c[_0x474520(0x7c6)]('.music-post-play-icon,\x20.music-share-play-icon')['textContent'] = '▶'); else Array['isArray'](_0x480f4f[_0x474520(0x499)]) && (_0x474520(0x75e) === _0x474520(0x75e) ? (console[_0x474520(0x7e5)](_0x474520(0x5eb)), _0x346f80[_0x474520(0x3aa)] = _0x480f4f[_0x474520(0x499)][_0x474520(0x2a0)](_0x29b48b => ({ 'id': _0x474520(0x98a) + _0x29b48b['id'], 'type': _0x474520(0x328), 'participantIds': [_0x29b48b['id']] })), _0x480f4f[_0x474520(0x834)] && (_0x346f80[_0x474520(0x509)] = _0x474520(0x98a) + _0x480f4f[_0x474520(0x834)]), _0x480f4f[_0x474520(0x499)][_0x474520(0x927)](_0x4e0ad0 => { const _0x2d08fb = _0x474520; if (_0x2d08fb(0x5a8) !== _0x2d08fb(0x5a8)) { const _0x7c2149 = _0x477c3e['createElement'](_0x2d08fb(0x41a)); _0x7c2149['className'] = _0x2d08fb(0x4ec), _0x7c2149['style']['cursor'] = _0x2d08fb(0x2c9); const _0x490145 = _0x257c03[_0x2d08fb(0x4aa)][_0x52d7c1], _0x5ed82f = _0x490145[_0x2d08fb(0x532)][_0x2d08fb(0x8d3)]((_0x36e7d8, _0x5ca0d5) => _0x36e7d8 + (_0x5ca0d5[_0x2d08fb(0x1b3)] || 0x0), 0x0); _0x7c2149['innerHTML'] = _0x2d08fb(0x4f2) + _0x2099cd + _0x2d08fb(0x87a) + _0x5ed82f['toFixed'](0x2) + _0x2d08fb(0x27a), _0x7c2149[_0x2d08fb(0x35e)](_0x2d08fb(0x39c), () => { const _0x4f16dd = _0x2d08fb; _0x419abb[_0x4f16dd(0x78f)]['remove'](_0x4f16dd(0x282)), _0xa5ed41[_0x4f16dd(0x78f)][_0x4f16dd(0x3d0)](_0x4f16dd(0x282)), _0x4b2aeb(_0x490145, _0x59c879); }), _0x42951c['appendChild'](_0x7c2149); } else { const _0x1b46aa = _0x2d08fb(0x649) + _0x4e0ad0['id'], _0x3259ae = _0x2d08fb(0x5b1) + _0x4e0ad0['id'], _0x549037 = localStorage[_0x2d08fb(0x164)](_0x1b46aa); _0x549037 && ('vRMwN' === _0x2d08fb(0x45e) ? _0x243300['textContent'] = _0x2d08fb(0x733) : (localStorage[_0x2d08fb(0x6c6)](_0x3259ae, _0x549037), localStorage[_0x2d08fb(0x845)](_0x1b46aa))); } })) : _0x38017b(_0x538e1a[_0x474520(0x5be)])[_0x474520(0x710)](_0x2b17e4 => { const _0x35ea4e = _0x474520, _0x29bdef = _0x423c19['getElementById'](_0x326097); if (_0x29bdef && _0x2b17e4) _0x29bdef[_0x35ea4e(0x7d9)] = _0x47cd76[_0x35ea4e(0x8f3)](_0x2b17e4); })); } } catch (_0xc6c71c) { console[_0x474520(0x8d6)](_0x474520(0x90e), _0xc6c71c), _0x346f80[_0x474520(0x499)] = [], _0x346f80[_0x474520(0x3aa)] = [], _0x346f80[_0x474520(0x509)] = null; try { 'eggjl' !== _0x474520(0x935) ? localStorage[_0x474520(0x845)](_0x474520(0x273)) : (_0x35592b = _0x311a4f['createElement'](_0x474520(0x94f)), _0xf4a4a7['id'] = 'live-preview-style', _0x535564[_0x474520(0x8c5)][_0x474520(0x204)](_0x29d558)); } catch (_0x20fee1) { console[_0x474520(0x8d6)](_0x474520(0x6a6), _0x20fee1); } } let _0x411048 = ![]; if (_0x346f80['characters'][_0x474520(0x6c3)] === 0x0) _0x411048 = !![], _0x346f80[_0x474520(0x509)] = null; else !_0x346f80[_0x474520(0x3aa)][_0x474520(0x247)](_0x3f3e04 => _0x3f3e04['id'] === _0x346f80['activeChatId']) && (_0x346f80[_0x474520(0x509)] = _0x346f80['chats'][0x0]?.['id'] || null); return _0x23c6b9(), _0x411048; } function _0x5d853f() { const _0x12d2be = _0x54ed15; if (_0x12d2be(0x646) === _0x12d2be(0x85a)) { const _0x5510cf = _0x17655e['id'], _0x2d5675 = _0x12d2be(0x552) + _0x5510cf, _0x52a194 = _0x3627cb[_0x12d2be(0x164)](_0x2d5675), _0x5b19d1 = _0x4e0409[_0x12d2be(0x7c6)](_0x12d2be(0x948)); if (_0x52a194) _0x5b19d1[_0x12d2be(0x6a9)] = _0x12d2be(0x438) + _0x52a194 + '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>'; else { const _0x13245a = _0x200e70[_0x12d2be(0x7c6)](_0x12d2be(0x774) + _0x5510cf + _0x12d2be(0x1f4) + _0x5510cf + '\x20.app-icon-img')?.[_0x12d2be(0x6a9)]; _0x13245a && (_0x5b19d1[_0x12d2be(0x6a9)] = _0x13245a); } } else { if (!_0x346f80[_0x12d2be(0x509)]) return; try { if (_0x12d2be(0x3ec) !== 'LNvbO') localStorage[_0x12d2be(0x6c6)](_0x12d2be(0x649) + _0x346f80[_0x12d2be(0x509)], JSON[_0x12d2be(0x714)](_0x346f80[_0x12d2be(0x250)])); else { const _0x417e77 = _0x3a8c34(_0x119db0); if (_0x417e77) { const _0x1271cc = _0x286a8f[_0x12d2be(0x820)](_0x12d2be(0x183)); _0x1271cc[_0x12d2be(0x908)] = _0x417e77['id'], _0x1271cc[_0x12d2be(0x96c)] = _0x417e77['name'], _0x429190['appendChild'](_0x1271cc); } } } catch (_0x4e407b) { if ('sEvYB' === _0x12d2be(0x20e)) console[_0x12d2be(0x8d6)](_0x12d2be(0x67c), _0x4e407b), _0x3383df('无法保存聊天记录。'); else { const _0x541ca4 = _0x37fb44[_0x12d2be(0x820)](_0x12d2be(0x41a)); _0x541ca4[_0x12d2be(0x941)] = 'diary-page', _0x541ca4['id'] = _0x12d2be(0x76f) + _0x3035bd, _0x1589dc === _0x411ae2[_0x12d2be(0x713)] && _0x541ca4[_0x12d2be(0x78f)]['add'](_0x12d2be(0x415)), _0x789a47[_0x12d2be(0x927)](_0x4265ed => { const _0x4b5ac4 = _0x12d2be, _0x20bcfe = _0x4265ed[_0x4b5ac4(0x780)] === _0x4b5ac4(0x619) ? _0x4b5ac4(0x619) : 'ai', _0x57fc9c = _0x4265ed[_0x4b5ac4(0x780)] === _0x4b5ac4(0x619) ? _0x1dcd44[_0x4b5ac4(0x4e6)] : _0x1e03d6(_0x4265ed['author'])[_0x4b5ac4(0x4e6)], _0x16f404 = _0x597028[_0x4b5ac4(0x820)](_0x4b5ac4(0x41a)); _0x16f404[_0x4b5ac4(0x941)] = _0x4b5ac4(0x6cc) + _0x20bcfe, _0x16f404['dataset'][_0x4b5ac4(0x83c)] = _0x4265ed[_0x4b5ac4(0x83c)], _0x16f404[_0x4b5ac4(0x94f)][_0x4b5ac4(0x50e)] = _0x4b5ac4(0x910), _0x16f404[_0x4b5ac4(0x94f)][_0x4b5ac4(0x308)] = '0', _0x16f404[_0x4b5ac4(0x6a9)] = _0x4b5ac4(0x68b) + _0x57fc9c + _0x4b5ac4(0x972) + new _0x3d6e7e(_0x4265ed[_0x4b5ac4(0x83c)])[_0x4b5ac4(0x6de)](_0x4b5ac4(0x6dd)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>' + _0x4265ed[_0x4b5ac4(0x2fc)][_0x4b5ac4(0x330)](/\n/g, _0x4b5ac4(0x69d)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x541ca4['appendChild'](_0x16f404); }), _0x313511[_0x12d2be(0x204)](_0x541ca4); } } } } function _0x3a0ba4() { const _0x1c7b6e = _0x54ed15; if (!_0x346f80['activeChatId']) { if (_0x1c7b6e(0x5bf) === _0x1c7b6e(0x5bf)) { _0x346f80[_0x1c7b6e(0x250)] = [], _0x1e1fc7(); return; } else _0xeb0ea[_0x1c7b6e(0x8d6)](_0x1c7b6e(0x76b), _0xe9975f); } let _0x48de17 = null; try { _0x48de17 = localStorage[_0x1c7b6e(0x164)]('chatHistory_' + _0x346f80[_0x1c7b6e(0x509)]); } catch (_0x5c1736) { console[_0x1c7b6e(0x8d6)](_0x1c7b6e(0x848) + _0x346f80[_0x1c7b6e(0x509)], _0x5c1736); } let _0x25e76b = []; if (_0x48de17) try { if (_0x1c7b6e(0x949) !== _0x1c7b6e(0x4a1)) { const _0x112120 = JSON[_0x1c7b6e(0x781)](_0x48de17); if (Array[_0x1c7b6e(0x86b)](_0x112120)) { if ('TVQfS' !== 'TVQfS') { _0x206945['activeMeetingScriptQueue'] = [..._0x2edbe1]; const _0x42b584 = _0x48f8e0[_0x1c7b6e(0x6e4)][_0x1c7b6e(0x9b3)](); _0x27e8ca[_0x1c7b6e(0x96c)] = _0x42b584[_0x1c7b6e(0x4a3)] === 'narrator' ? '旁白' : _0x42b584['speaker'], _0x160012['textContent'] = _0x42b584[_0x1c7b6e(0x493)], _0x42b584['speaker'] !== _0x1c7b6e(0x47f) && _0x53c7fd(_0x54e19b[_0x1c7b6e(0x785)], _0x42b584[_0x1c7b6e(0x7aa)]); } else _0x25e76b = _0x112120['filter'](_0x2950fb => _0x2950fb && typeof _0x2950fb === 'object' && typeof _0x2950fb[_0x1c7b6e(0x6b9)] === _0x1c7b6e(0x17c) && typeof _0x2950fb[_0x1c7b6e(0x2fc)] !== _0x1c7b6e(0x535)); } } else { const _0x5cd5a2 = _0x35e8d2['find'](_0x1a24bc => _0x1a24bc[_0x1c7b6e(0x4e6)] === _0x325c91[_0x1c7b6e(0x4e6)]); if (_0x5cd5a2) _0x4ef0b5[_0x1c7b6e(0x8ad)](_0x4fe083, { 'content': _0x1c7b6e(0x665) + _0x5cd5a2['name'] + ']', 'displayUrl': _0x5cd5a2[_0x1c7b6e(0x4ee)] }); else _0x1dc7be['content'] = _0x1c7b6e(0x3d9) + _0x1d1b01[_0x1c7b6e(0x4e6)] + ']'; } } catch (_0x1da28a) { console['error'](_0x1c7b6e(0x40b) + _0x346f80['activeChatId'] + _0x1c7b6e(0x6ac), _0x1da28a); try { localStorage[_0x1c7b6e(0x845)](_0x1c7b6e(0x649) + _0x346f80[_0x1c7b6e(0x509)]); } catch (_0x10eae3) { _0x1c7b6e(0x767) === _0x1c7b6e(0x767) ? console[_0x1c7b6e(0x8d6)](_0x1c7b6e(0x29b), _0x10eae3) : _0xc5fe7c && _0x4c3b13(_0x5c1c07['id'], _0x2bd8bf[_0x1c7b6e(0x2a0)](_0x3b7442 => _0x3b7442['id'])); } } _0x346f80['conversationHistory'] = _0x25e76b, _0x5a55b2[_0x1c7b6e(0x6a9)] = '', _0x346f80[_0x1c7b6e(0x250)] && ('TvGkv' !== 'TvGkv' ? _0x10a9ef = _0x1fe8e0(_0x5206fd['participantIds'][0x0]) : _0x346f80['conversationHistory']['forEach']((_0x3a87ea, _0x463005) => _0x2ef036(_0x3a87ea, _0x463005))), setTimeout(() => { const _0x2a276 = _0x1c7b6e; _0x5a55b2[_0x2a276(0x2ce)] = _0x5a55b2[_0x2a276(0x678)]; }, 0x0); } async function _0x2ad9bb() { const _0xca4339 = _0x54ed15; if ('ZRvZW' !== _0xca4339(0x968)) _0x371bd9(_0x302c70[_0xca4339(0x5be)])['then'](_0x292d45 => { const _0x49f91c = _0xca4339, _0x23eaaa = _0x675c50[_0x49f91c(0x954)](_0x492e03); if (_0x23eaaa && _0x292d45) _0x23eaaa[_0x49f91c(0x7d9)] = _0x40e962[_0x49f91c(0x8f3)](_0x292d45); }); else { const _0x125585 = document[_0xca4339(0x954)]('home-screen'); try { let _0x273087 = await _0x4f16ca(_0xca4339(0x44d)); if (!_0x273087) { const _0x2d86a2 = localStorage['getItem']('customWallpaper'); _0x2d86a2 && (_0xca4339(0x94d) === _0xca4339(0x8a5) ? _0x5c457d[_0xca4339(0x96c)] = _0xca4339(0x733) : (console['log'](_0xca4339(0x515)), _0x273087 = await _0x407d73(_0x2d86a2), await _0x336559('wallpaper_main', _0x273087), localStorage[_0xca4339(0x845)](_0xca4339(0x182)))); } _0x273087 ? (_0x125585[_0xca4339(0x94f)][_0xca4339(0x5d2)] = 'url(' + URL[_0xca4339(0x8f3)](_0x273087) + ')', _0x125585[_0xca4339(0x94f)][_0xca4339(0x385)] = 'cover', _0x125585[_0xca4339(0x94f)][_0xca4339(0x3a9)] = 'center') : _0xca4339(0x7a6) !== _0xca4339(0x7a6) ? (_0x422c76[_0xca4339(0x62d)] = _0xca4339(0x632), _0x2336b3[_0xca4339(0x8ad)](_0x13687e, _0x28c18d)) : _0x125585['style'][_0xca4339(0x5d2)] = ''; } catch (_0xb9add2) { console['error']('加载壁纸失败:', _0xb9add2), phoneContainer[_0xca4339(0x94f)][_0xca4339(0x5d2)] = ''; } } } function _0x3e15ea() { const _0xf2f7f8 = _0x54ed15, _0x5306fb = localStorage[_0xf2f7f8(0x164)]('customFeedWallpaper'); _0x5306fb ? document[_0xf2f7f8(0x954)](_0xf2f7f8(0x4cb))[_0xf2f7f8(0x94f)]['setProperty'](_0xf2f7f8(0x9c6), _0xf2f7f8(0x83a) + _0x5306fb + ')') : document['getElementById'](_0xf2f7f8(0x4cb))[_0xf2f7f8(0x94f)][_0xf2f7f8(0x324)](_0xf2f7f8(0x9c6), _0xf2f7f8(0x910)); } async function _0x5af6e1(_0x5bba80) { const _0x5d86a0 = _0x54ed15; try { _0x5d86a0(0x476) !== _0x5d86a0(0x402) ? (await _0x336559(_0x5d86a0(0x44d), _0x5bba80), await _0x2ad9bb(), _0x3383df(_0x5d86a0(0x5db))) : (_0x26180f['error'](_0x5d86a0(0x7a5), _0x5e7e2f), _0x4e61bb('保存壁纸失败:\x20' + _0x3d6c68['message'])); } catch (_0x21c09c) { console[_0x5d86a0(0x8d6)](_0x5d86a0(0x7a5), _0x21c09c), _0x3383df(_0x5d86a0(0x726) + _0x21c09c[_0x5d86a0(0x399)]); } } function _0x535474(_0x3bae6a) { const _0x36c429 = _0x54ed15; if ('JnzYy' !== _0x36c429(0x3e5)) { const _0x20bec7 = { 'quotedMessage': null, 'content': _0x3bae6a }, _0x53703f = _0x3bae6a[_0x36c429(0x2bc)](/^\[引用\|(.*?)\|(.*?)\]\s*/); if (_0x53703f) { if (_0x36c429(0x536) !== _0x36c429(0x536)) { const _0x1e2cf7 = _0x3f91bb[_0x36c429(0x780)] === 'user' ? _0x3afcd1[_0x36c429(0x4e6)] : _0x1329f4(_0x97fab3[_0x36c429(0x780)])[_0x36c429(0x4e6)]; return _0x36c429(0x59a) + new _0x5cd4fa(_0x2b9723[_0x36c429(0x83c)])[_0x36c429(0x4db)]() + ']\x20' + _0x1e2cf7 + '\x20写道:\x20' + _0x3c3e00[_0x36c429(0x2fc)]; } else _0x20bec7['quotedMessage'] = { 'sender': _0x53703f[0x1][_0x36c429(0x4dd)](), 'content': _0x53703f[0x2][_0x36c429(0x4dd)]() }, _0x20bec7['content'] = _0x3bae6a[_0x36c429(0x8f0)](_0x53703f[0x0][_0x36c429(0x6c3)])[_0x36c429(0x4dd)](); } return _0x20bec7; } else _0x2b59b0(), _0x31d30e('accounting', _0x36c429(0x72b)); } const _0x38764a = document[_0x54ed15(0x954)]('message-action-modal'), _0x412c92 = document[_0x54ed15(0x954)](_0x54ed15(0x266)), _0x4ef261 = document[_0x54ed15(0x954)]('edit-message-button'), _0x3a70a3 = document['getElementById'](_0x54ed15(0x1b4)), _0x582e5e = document[_0x54ed15(0x954)](_0x54ed15(0x84f)), _0x5dbfc8 = document[_0x54ed15(0x954)](_0x54ed15(0x7d3)), _0xa642f2 = document['getElementById'](_0x54ed15(0x5da)), _0x33d300 = document[_0x54ed15(0x954)](_0x54ed15(0x229)), _0x574a98 = document[_0x54ed15(0x954)](_0x54ed15(0x4d8)), _0x415d03 = document[_0x54ed15(0x954)](_0x54ed15(0x5c2)), _0x581838 = document['getElementById'](_0x54ed15(0x3d5)); let _0x433026 = null; function _0x2990a9(_0x24b982) { const _0x252300 = _0x54ed15; _0x433026 = _0x24b982, _0x38764a[_0x252300(0x78f)][_0x252300(0x3d0)](_0x252300(0x373)); } function _0x5df665() { const _0x2cda8c = _0x54ed15; 'SHhsJ' !== _0x2cda8c(0x74e) ? _0x38764a[_0x2cda8c(0x78f)][_0x2cda8c(0x309)](_0x2cda8c(0x373)) : (_0x3b2fa4 = !![], _0x38d0ff['activeChatId'] = null); } function _0x2b1ff3() { _0x5df665(), _0x433026 = null; } function _0x1e58cb() { const _0x35da25 = _0x54ed15; if (_0x433026 === null) return; _0x346f80[_0x35da25(0x250)][_0x35da25(0x9ba)](_0x433026, 0x1), _0x5d853f(), _0x1e3341(), _0x2b1ff3(); } function _0x1598cd() { const _0x465935 = _0x54ed15; if (_0x433026 === null) return; const _0x511425 = _0x346f80[_0x465935(0x250)][_0x433026]; if (!_0x511425) return; _0x574a98[_0x465935(0x908)] = _0x511425['content'], _0x5df665(), _0xa642f2[_0x465935(0x78f)][_0x465935(0x3d0)](_0x465935(0x373)), _0x574a98['focus'](); } function _0xc04c15() { const _0x1b72c3 = _0x54ed15; if (_0x433026 === null) return; const _0x3046c0 = _0x574a98[_0x1b72c3(0x908)]['trim'](); if (_0x3046c0 === '') { _0x987d49(); return; } const _0x416d0a = _0x346f80['conversationHistory'][_0x433026]; _0x416d0a && (_0x1b72c3(0x33e) !== _0x1b72c3(0x33e) ? _0x2ac139(_0x1b72c3(0x333)) : (_0x416d0a['content'] = _0x3046c0, _0x5d853f(), _0x1e3341())), _0xa642f2[_0x1b72c3(0x78f)][_0x1b72c3(0x309)](_0x1b72c3(0x373)), _0x433026 = null; } function _0x987d49() { const _0x548893 = _0x54ed15; _0xa642f2[_0x548893(0x78f)]['remove']('show'), _0x433026 = null; } _0x412c92[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x2b1ff3), _0x582e5e[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x2b1ff3), _0x3a70a3[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x1e58cb), _0x4ef261[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x1598cd), _0x5dbfc8['addEventListener'](_0x54ed15(0x39c), _0x40aa00), _0x311903[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x5317e1), _0x415d03['addEventListener'](_0x54ed15(0x39c), _0xc04c15), _0x581838[_0x54ed15(0x35e)]('click', _0x987d49), _0x33d300[_0x54ed15(0x35e)]('click', _0x987d49); function _0x40aa00() { const _0x5d59a8 = _0x54ed15; if (_0x433026 === null) return; const _0x8af030 = _0x346f80['conversationHistory'][_0x433026]; if (!_0x8af030) return; const _0x27a8f3 = _0x597f5f(); let _0x1961d7 = '未知'; if (_0x8af030['role'] === _0x5d59a8(0x619)) _0x1961d7 = _0x346f80[_0x5d59a8(0x364)][_0x5d59a8(0x4e6)] || '我'; else { if ('AEOyZ' !== _0x5d59a8(0x64b)) { _0x454441[_0x5d59a8(0x8d6)](_0x5d59a8(0x235), _0x3c3405); const _0x586f77 = { 'role': _0x5d59a8(0x81d), 'content': _0x5d59a8(0x914) + _0x45791e['message'], 'senderId': _0x37bd17['id'], 'isOffline': _0x599e4a }; _0x87073b['conversationHistory'][_0x5d59a8(0x580)](_0x586f77), _0x56e748(); } else { const _0x48afb5 = _0x8af030['senderId'] || _0x27a8f3?.[_0x5d59a8(0x717)][0x0], _0x43f756 = _0x5122c0(_0x48afb5); _0x1961d7 = _0x43f756 ? _0x43f756[_0x5d59a8(0x4e6)] : '角色'; } } let _0x3bbad9 = _0x8af030['content'] || ''; if (_0x8af030['displayUrl']) _0x3bbad9 = _0x5d59a8(0x5c5); if (_0x8af030[_0x5d59a8(0x85e)]) _0x3bbad9 = _0x5d59a8(0x578); if (_0x3bbad9[_0x5d59a8(0x6c3)] > 0x32) _0x3bbad9 = _0x3bbad9[_0x5d59a8(0x8f0)](0x0, 0x32) + '...'; _0x346f80['activeQuote'] = { 'sender': _0x1961d7, 'content': _0x3bbad9 }, _0x49311a(), _0x2b1ff3(), _0x2bab43[_0x5d59a8(0x60d)](); } function _0x49311a() { const _0xda8ca0 = _0x54ed15; if (!_0x346f80[_0xda8ca0(0x4cd)]) return; _0x5454ee[_0xda8ca0(0x96c)] = '回复\x20' + _0x346f80['activeQuote']['sender'], _0x15209a[_0xda8ca0(0x96c)] = _0x346f80['activeQuote']['content'], _0x49bee8['style'][_0xda8ca0(0x3b4)] = _0xda8ca0(0x810); } function _0x5317e1() { const _0x28afe = _0x54ed15; _0x346f80['activeQuote'] = null, _0x49bee8[_0x28afe(0x94f)][_0x28afe(0x3b4)] = 'none'; } function _0x21dca3(_0x528aa8, _0xa6d435) { const _0x2a2759 = _0x54ed15; if (_0x2a2759(0x346) === 'cgzZA') return; else { const _0x33df87 = document[_0x2a2759(0x954)](_0x2a2759(0x60b)); if (_0x33df87) { if (_0x528aa8 === _0x2a2759(0x72b)) { if (_0x2a2759(0x7dc) === _0x2a2759(0x7dc)) _0x33df87[_0x2a2759(0x94f)]['display'] = _0x2a2759(0x91b); else { const _0xbbe2fb = _0x2a2759(0x3c2); _0x13f8cb['body']['insertAdjacentHTML'](_0x2a2759(0x189), _0xbbe2fb); const _0x36d5d5 = _0x2e8906['getElementById'](_0x2a2759(0x245)), _0x54b42f = _0x3cbe00['getElementById'](_0x2a2759(0x676)), _0x2f82da = _0x5a0409[_0x2a2759(0x954)](_0x2a2759(0x375)), _0x46c636 = _0xf5c4cc[_0x2a2759(0x954)](_0x2a2759(0x443)), _0x533a22 = _0x36d5d5[_0x2a2759(0x7c6)](_0x2a2759(0x7e8)), _0x5b276f = () => { const _0x3bfd7c = _0x2a2759; _0x36d5d5[_0x3bfd7c(0x309)](), _0x231343(); }; _0x2f82da['onclick'] = () => { const _0x466ad9 = _0x2a2759; _0x173044(_0x54b42f[_0x466ad9(0x908)]), _0x5b276f(); }, _0x46c636['onclick'] = _0x5b276f, _0x533a22[_0x2a2759(0x1b0)] = _0x5b276f; } } else _0x33df87['style'][_0x2a2759(0x3b4)] = 'none'; } _0x357847 = _0xa6d435 || null, Object[_0x2a2759(0x1fc)](_0x3473b9)[_0x2a2759(0x927)](_0x4216ef => _0x4216ef[_0x2a2759(0x78f)][_0x2a2759(0x309)](_0x2a2759(0x282))), _0x3473b9[_0x528aa8] && ('RUsHr' === _0x2a2759(0x334) ? _0x3473b9[_0x528aa8]['classList'][_0x2a2759(0x3d0)](_0x2a2759(0x282)) : !_0x157998[_0x2a2759(0x7c6)](_0x2a2759(0x3e3))[_0x2a2759(0x6ce)](_0x1eaf33['target']) && (_0x4b0ffb[_0x2a2759(0x78f)][_0x2a2759(0x309)]('visible'), _0x18338e[_0x2a2759(0x78f)][_0x2a2759(0x309)](_0x2a2759(0x978)))), _0x528aa8 !== _0x2a2759(0x755) && _0x36dcf3['classList'][_0x2a2759(0x309)](_0x2a2759(0x93f)); } } function _0x4c5132(_0x592dcd) { const _0x1ba9ae = _0x54ed15; _0x592dcd ? _0x36dcf3[_0x1ba9ae(0x78f)][_0x1ba9ae(0x3d0)](_0x1ba9ae(0x93f)) : _0x36dcf3[_0x1ba9ae(0x78f)]['remove']('show-chat-view'); } async function _0x546ea8() { const _0x3a8729 = _0x54ed15; if (_0x3a8729(0x4ff) === _0x3a8729(0x7fc)) _0x3d01a2['style'][_0x3a8729(0x5d2)] = ''; else { _0x1a15c4[_0x3a8729(0x6a9)] = ''; for (const _0x1d3389 of _0x346f80[_0x3a8729(0x3aa)]) { if ('RuDTZ' !== _0x3a8729(0x527)) { const _0x45e943 = document[_0x3a8729(0x820)]('li'); _0x45e943[_0x3a8729(0x941)] = 'character-item', _0x45e943[_0x3a8729(0x86c)]['id'] = _0x1d3389['id']; let _0x59c59d = _0x2f6e79, _0x349a16 = '群聊', _0x2ae4cb = ''; if (_0x1d3389[_0x3a8729(0x62d)] === _0x3a8729(0x328)) { const _0x2c65e9 = _0x5122c0(_0x1d3389['participantIds'][0x0]); _0x2c65e9 ? _0x3a8729(0x4b8) === _0x3a8729(0x4b8) ? (_0x59c59d = _0x2c65e9[_0x3a8729(0x4ef)] || _0x2f6e79, _0x349a16 = _0x2c65e9[_0x3a8729(0x4e6)] || _0x3a8729(0x7f4), _0x2ae4cb = _0x2c65e9['remark'] || '私聊') : _0x109300[_0x3a8729(0x2da)] = { ..._0x4f1c41[_0x3a8729(0x4cd)] } : (_0x349a16 = '未知角色', _0x2ae4cb = _0x3a8729(0x694)); } else { if ('ruXOH' === _0x3a8729(0x4d9)) { _0x349a16 = _0x1d3389[_0x3a8729(0x4e6)] || _0x3a8729(0x4de), _0x2ae4cb = _0x1d3389[_0x3a8729(0x717)]['length'] + _0x3a8729(0x82b); const _0x1041a0 = await _0x4f16ca(_0x3a8729(0x3bf) + _0x1d3389['id']); if (_0x1041a0) _0x59c59d = URL[_0x3a8729(0x8f3)](_0x1041a0); } else { const _0x3e3079 = _0x4fc517['role'] === _0x3a8729(0x619) ? _0x28f8e6[_0x3a8729(0x4e6)] : _0x16a216[_0x3a8729(0x4e6)]; return '[' + _0x3e3079 + _0x3a8729(0x335) + _0x1f6f5a[_0x3a8729(0x2fc)]; } } _0x45e943['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x59c59d + _0x3a8729(0x8d4) + _0x349a16 + _0x3a8729(0x54b) + _0x2ae4cb + _0x3a8729(0x1e8), _0x45e943[_0x3a8729(0x7c6)](_0x3a8729(0x9aa))[_0x3a8729(0x35e)](_0x3a8729(0x39c), () => { _0x54cb4c(_0x1d3389['id']), _0x4c5132(!![]); }), _0x1a15c4['appendChild'](_0x45e943); } else _0x56b944(_0x3a8729(0x4fc) + _0xdf5487[_0x3a8729(0x399)]); } } } function _0x403ed8() { const _0x36a8a9 = _0x54ed15, _0x1a64ca = document[_0x36a8a9(0x954)]('meeting-list-container'); _0x1a64ca[_0x36a8a9(0x6a9)] = ''; const _0x2982ee = _0x346f80[_0x36a8a9(0x499)][_0x36a8a9(0x6e8)](_0xd2558d => _0x346f80[_0x36a8a9(0x3aa)][_0x36a8a9(0x554)](_0x71b92c => _0x71b92c[_0x36a8a9(0x62d)] === _0x36a8a9(0x328) && _0x71b92c[_0x36a8a9(0x717)][_0x36a8a9(0x84e)](_0xd2558d['id']))); if (_0x2982ee[_0x36a8a9(0x6c3)] === 0x0) { if (_0x36a8a9(0x357) !== _0x36a8a9(0x357)) { if (_0x2d4d67) _0x51076b[_0x36a8a9(0x96c)] = '❚❚'; } else { _0x1a64ca[_0x36a8a9(0x6a9)] = _0x36a8a9(0x69a); return; } } _0x2982ee[_0x36a8a9(0x927)](_0x53522c => { const _0x13bc81 = _0x36a8a9; if (_0x13bc81(0x5a7) === _0x13bc81(0x864)) _0x5cce8b(!![]); else { const _0xa34a8f = document[_0x13bc81(0x820)]('li'); _0xa34a8f[_0x13bc81(0x941)] = _0x13bc81(0x8c8), _0xa34a8f['dataset']['charId'] = _0x53522c['id'], _0xa34a8f[_0x13bc81(0x6a9)] = _0x13bc81(0x912) + (_0x53522c[_0x13bc81(0x4ef)] || _0x2f6e79) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x53522c[_0x13bc81(0x4e6)] + _0x13bc81(0x37c) + (_0x53522c[_0x13bc81(0x287)] || '私聊') + _0x13bc81(0x427), _0xa34a8f['addEventListener'](_0x13bc81(0x39c), () => { const _0x1c392a = _0x13bc81; if (_0x1c392a(0x4f9) === _0x1c392a(0x4f9)) _0x4e95b5(_0x53522c['id']); else return ''; }), _0x1a64ca['appendChild'](_0xa34a8f); } }); } async function _0x4e95b5(_0x379596) { const _0xa53c25 = _0x54ed15, _0x563a50 = _0x5122c0(_0x379596); if (!_0x563a50) return; document[_0xa53c25(0x954)]('galgame-sprite')[_0xa53c25(0x7d9)] = '', _0x346f80['activeMeetingCharId'] = _0x379596; const _0x464416 = _0x346f80[_0xa53c25(0x3aa)][_0xa53c25(0x247)](_0x115111 => _0x115111[_0xa53c25(0x62d)] === _0xa53c25(0x328) && _0x115111[_0xa53c25(0x717)][_0xa53c25(0x84e)](_0x379596)); if (_0x464416) 'MkTtM' === _0xa53c25(0x686) ? _0x20853b(_0x2847eb, _0xa53c25(0x7e0)) : (_0x346f80['activeChatId'] = _0x464416['id'], _0x23c6b9(), _0x3a0ba4(), _0x5dd9eb(_0x379596)); else { if (_0xa53c25(0x262) === _0xa53c25(0x262)) _0x346f80['conversationHistory'] = []; else return '刚才'; } document[_0xa53c25(0x954)]('meeting-char-name-header')[_0xa53c25(0x96c)] = _0x563a50[_0xa53c25(0x4e6)]; const _0x5a5431 = document[_0xa53c25(0x954)]('meeting-main-content'); try { if (_0xa53c25(0x430) === _0xa53c25(0x7af)) _0x523bae = _0x395f43; else { const _0x4523e7 = await _0x4f16ca(_0xa53c25(0x525) + _0x379596); _0x4523e7 ? (_0x5a5431[_0xa53c25(0x94f)]['backgroundImage'] = 'url(\x27' + URL[_0xa53c25(0x8f3)](_0x4523e7) + '\x27)', _0x5a5431['style']['backgroundSize'] = _0xa53c25(0x34e), _0x5a5431[_0xa53c25(0x94f)]['backgroundPosition'] = _0xa53c25(0x2b3)) : 'ibeLu' === _0xa53c25(0x337) ? _0x36671d = {} : _0x5a5431[_0xa53c25(0x94f)][_0xa53c25(0x5d2)] = _0xa53c25(0x910); } } catch (_0x47de3a) { console[_0xa53c25(0x8d6)](_0xa53c25(0x9bd) + _0x379596 + ':', _0x47de3a), _0x5a5431['style']['backgroundImage'] = _0xa53c25(0x910); } _0x1557d8(), _0x59ff49(); if (_0x2c8595) clearInterval(_0x2c8595); _0x35b050(), _0x2c8595 = setInterval(_0x35b050, 0x2710), document[_0xa53c25(0x954)](_0xa53c25(0x358))['style'][_0xa53c25(0x3b4)] = _0xa53c25(0x810), _0x21dca3(_0xa53c25(0x546), _0xa53c25(0x75c)); } function _0x59ff49() { const _0x443916 = _0x54ed15, _0x43de41 = document[_0x443916(0x954)](_0x443916(0x959)); _0x43de41[_0x443916(0x6a9)] = ''; const _0x3ad097 = _0x43de41[_0x443916(0x7c6)](_0x443916(0x790)); if (_0x3ad097) _0x3ad097[_0x443916(0x309)](); _0x346f80[_0x443916(0x250)] && _0x346f80[_0x443916(0x250)]['forEach']((_0x535ea8, _0x332713) => { const _0x54794f = _0x443916; if (_0x54794f(0x70c) === _0x54794f(0x835)) _0x965082[_0x54794f(0x8d6)](_0x54794f(0x18b), _0x300f27); else { if (!_0x535ea8[_0x54794f(0x97f)] || _0x535ea8[_0x54794f(0x6b9)] === _0x54794f(0x9ca)) return; const _0xc2f2e3 = document['createElement']('p'); _0xc2f2e3[_0x54794f(0x86c)][_0x54794f(0x79d)] = _0x332713; const _0x533c09 = _0x535ea8[_0x54794f(0x2fc)]['replace'](/\n/g, _0x54794f(0x69d)); let _0x5b2d5e = '', _0x8b6e2f = ''; const _0x287e29 = _0x3d25f9(_0x346f80[_0x54794f(0x509)]); if (_0x535ea8['role'] === _0x54794f(0x619)) 'CZZyV' === _0x54794f(0x72a) ? (_0x5b2d5e = _0x287e29[_0x54794f(0x4e6)] || '我', _0x8b6e2f = 'speaker-user') : _0x54794f(0x857); else { if (_0x535ea8[_0x54794f(0x6b9)] === _0x54794f(0x81d)) { const _0x22dab5 = _0x5122c0(_0x535ea8[_0x54794f(0x980)] || _0x346f80['activeMeetingCharId']); _0x5b2d5e = _0x22dab5?.[_0x54794f(0x4e6)] || '角色', _0x8b6e2f = 'speaker-ai'; } } _0xc2f2e3[_0x54794f(0x94f)][_0x54794f(0x930)] = _0x54794f(0x697), _0xc2f2e3[_0x54794f(0x94f)]['padding'] = _0x54794f(0x8af), _0xc2f2e3[_0x54794f(0x94f)][_0x54794f(0x349)] = '8px', _0xc2f2e3[_0x54794f(0x94f)][_0x54794f(0x60a)] = '1em', _0x5b2d5e ? _0xc2f2e3[_0x54794f(0x6a9)] = _0x54794f(0x963) + _0x8b6e2f + _0x54794f(0x2fa) + (_0x8b6e2f === _0x54794f(0x8c9) ? '#a7c7e7' : _0x54794f(0x2b6)) + _0x54794f(0x269) + _0x5b2d5e + _0x54794f(0x5a3) + _0x533c09 : _0x54794f(0x600) !== 'LMEmq' ? (_0xc2f2e3[_0x54794f(0x941)] = _0x54794f(0x47f), _0xc2f2e3[_0x54794f(0x94f)][_0x54794f(0x497)] = 'italic', _0xc2f2e3[_0x54794f(0x94f)][_0x54794f(0x4cf)] = '#d1d5db', _0xc2f2e3[_0x54794f(0x6a9)] = _0x533c09) : _0x50fc58[_0x54794f(0x8d6)]('Error\x20fetching\x20from\x20' + _0x25bc80 + ':', _0x3c53d1), _0x43de41['appendChild'](_0xc2f2e3); } }); if (_0x346f80[_0x443916(0x3d2)]) { let _0x2330d9 = _0x43de41['querySelector'](_0x443916(0x1d9)); !_0x2330d9 && (_0x2330d9 = document[_0x443916(0x820)](_0x443916(0x41a)), _0x2330d9[_0x443916(0x941)] = _0x443916(0x7d8), _0x2330d9[_0x443916(0x96c)] = _0x443916(0x199), _0x2330d9[_0x443916(0x94f)][_0x443916(0x930)] = 'rgba(0,\x200,\x200,\x200.4)', _0x2330d9[_0x443916(0x94f)]['padding'] = _0x443916(0x8af), _0x2330d9[_0x443916(0x94f)]['borderRadius'] = _0x443916(0x6b1), _0x43de41[_0x443916(0x204)](_0x2330d9)); } const _0x15f494 = document['createElement'](_0x443916(0x41a)); _0x15f494['id'] = _0x443916(0x1e5), _0x43de41[_0x443916(0x204)](_0x15f494), setTimeout(() => { const _0x371f2a = _0x443916; _0x15f494['scrollIntoView']({ 'behavior': _0x371f2a(0x18c), 'block': _0x371f2a(0x4e1) }); }, 0x32); } function _0x1e3341() { const _0x3d13b7 = _0x54ed15; if (_0x3d13b7(0x8cd) !== 'FkglT') { const _0x31453f = document[_0x3d13b7(0x7c6)]('.screen.active'); if (!_0x31453f) return; _0x31453f['id'] === 'meeting-view-screen' ? _0x59ff49() : _0x1e1fc7(); } else _0x382753 += _0x3d13b7(0x28b); } function _0x1e1fc7() { const _0x2fd769 = _0x54ed15; if (_0x2fd769(0x940) !== _0x2fd769(0x940)) _0x2361fb[_0x2fd769(0x509)] = _0x25ab8f['chats'][0x0]?.['id'] || null, _0x21727e(_0x3f720b[_0x2fd769(0x509)]); else { const _0x486c73 = _0x346f80[_0x2fd769(0x250)]['filter'](_0x1d304f => !_0x1d304f[_0x2fd769(0x97f)] && _0x1d304f[_0x2fd769(0x6b9)] !== _0x2fd769(0x9ca)); if (_0x486c73[_0x2fd769(0x6c3)] > _0x346f80[_0x2fd769(0x98d)]) { let _0x3fc924 = _0x5a55b2['querySelector']('.load-more-btn'); if (!_0x3fc924) { _0x3fc924 = document[_0x2fd769(0x820)]('button'), _0x3fc924[_0x2fd769(0x96c)] = _0x2fd769(0x511), _0x3fc924['className'] = _0x2fd769(0x9db), _0x3fc924['style'][_0x2fd769(0x99d)] = _0x2fd769(0x18c), _0x3fc924[_0x2fd769(0x94f)][_0x2fd769(0x6b4)] = _0x2fd769(0x64d), _0x3fc924['style'][_0x2fd769(0x409)] = _0x2fd769(0x796), _0x3fc924[_0x2fd769(0x1b0)] = () => { const _0x58a6f3 = _0x2fd769; if (_0x58a6f3(0x737) === _0x58a6f3(0x9de)) _0x272447[_0x58a6f3(0x845)](_0x58a6f3(0x7a4)), _0x511f65[_0x58a6f3(0x845)](_0x58a6f3(0x197)), _0x33f9ba(_0x58a6f3(0x6ed)), _0x32a5bb(() => _0x4a41db[_0x58a6f3(0x55a)](), 0x3e8); else { const _0x1da04e = _0x5a55b2, _0x3212f2 = _0x1da04e['scrollHeight'], _0x5a6129 = _0x1da04e[_0x58a6f3(0x2ce)]; _0x346f80[_0x58a6f3(0x98d)] += 0x64, _0x1e1fc7(), requestAnimationFrame(() => { const _0x5bdb0b = _0x1da04e['scrollHeight']; _0x1da04e['scrollTop'] = _0x5a6129 + (_0x5bdb0b - _0x3212f2); }); } }; if (_0x5a55b2['firstChild']) { if (_0x2fd769(0x1a2) === _0x2fd769(0x6a4)) { if (!_0x1b7fae['friendCircles'] || _0x215fe0[_0x2fd769(0x4a8)][_0x2fd769(0x6c3)] === 0x0) { _0x5ad3b0['error'](_0x2fd769(0x36a)); return; } const _0x2f8afb = _0x4e7c53[_0x2fd769(0x4a8)][0x0]; if (_0x2f8afb['memberCharacterIds'][_0x2fd769(0x6c3)] < 0x2) { _0x1c09f6[_0x2fd769(0x8d6)](_0x2fd769(0x344) + _0x2f8afb[_0x2fd769(0x4e6)] + '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。'); return; } const _0x20d55a = { 'id': _0x2fd769(0x5b5) + _0x163ae5[_0x2fd769(0x909)](), 'authorType': _0x2fd769(0x9a1), 'authorId': _0x2f8afb['memberCharacterIds'][0x0], 'content': '这是一条由控制台添加的测试动态！样式看起来非常完美。', 'timestamp': _0x1c46ab['now'](), 'likes': [_0x2f8afb[_0x2fd769(0x805)][0x1]], 'comments': [{ 'commentId': 'c_' + _0x293933[_0x2fd769(0x909)](), 'authorId': _0x2f8afb[_0x2fd769(0x805)][0x1], 'content': _0x2fd769(0x671) }] }; _0x2f8afb[_0x2fd769(0x94a)]['push'](_0x20d55a), _0x196e18(), _0x4ff2a0[_0x2fd769(0x7e5)]('成功向好友圈\x20\x22' + _0x2f8afb[_0x2fd769(0x4e6)] + _0x2fd769(0x1bb)), _0x2d1e5d('测试动态已添加！'); } else _0x5a55b2[_0x2fd769(0x419)](_0x3fc924, _0x5a55b2[_0x2fd769(0x693)]); } else _0x2fd769(0x641) !== 'KjHqK' ? _0x5a55b2[_0x2fd769(0x204)](_0x3fc924) : _0xc5b4ee(![]); } } else { const _0xbfb0c9 = _0x5a55b2[_0x2fd769(0x7c6)](_0x2fd769(0x226)); if (_0xbfb0c9) _0xbfb0c9[_0x2fd769(0x309)](); } Array['from'](_0x5a55b2[_0x2fd769(0x674)])['forEach'](_0x223e5c => { const _0x53959e = _0x2fd769; !_0x223e5c['classList']['contains'](_0x53959e(0x37d)) && (_0x53959e(0x2d1) === _0x53959e(0x23b) ? _0x2f1b2d[_0x53959e(0x94f)]['backgroundImage'] = '' : _0x223e5c[_0x53959e(0x309)]()); }); const _0x3e6261 = _0x486c73[_0x2fd769(0x290)](-_0x346f80[_0x2fd769(0x98d)]); _0x3e6261[_0x2fd769(0x927)](_0x21c0e8 => { const _0x55dcbf = _0x2fd769, _0x353f51 = _0x346f80[_0x55dcbf(0x250)][_0x55dcbf(0x87d)](_0x21c0e8); _0x353f51 > -0x1 && (_0x55dcbf(0x1ea) === 'iwSgc' ? _0x2ef036(_0x21c0e8, _0x353f51) : (_0x1b45d2[_0x55dcbf(0x996)] = _0x2a7329[_0x55dcbf(0x996)] === _0x55dcbf(0x6d6) ? _0x55dcbf(0x4d0) : _0x55dcbf(0x6d6), _0x330428())); }); if (_0x346f80[_0x2fd769(0x3d2)]) { let _0x3a3a52 = _0x5a55b2['querySelector']('.typing-indicator'); !_0x3a3a52 && (_0x3a3a52 = document[_0x2fd769(0x820)](_0x2fd769(0x41a)), _0x3a3a52[_0x2fd769(0x941)] = _0x2fd769(0x7d8), _0x3a3a52[_0x2fd769(0x96c)] = _0x2fd769(0x1ca), _0x5a55b2[_0x2fd769(0x204)](_0x3a3a52)); } if (_0x3e6261[_0x2fd769(0x6c3)] <= _0x346f80[_0x2fd769(0x98d)]) { if ('TSXyU' === _0x2fd769(0x8db)) setTimeout(() => { const _0x278e0f = _0x2fd769; _0x5a55b2[_0x278e0f(0x2ce)] = _0x5a55b2[_0x278e0f(0x678)]; }, 0x0); else { const _0x24a51c = _0x210af6[_0x2fd769(0x59e)](_0x233666, _0x2fd769(0x1e2)), _0x272c27 = _0x24a51c[_0x2fd769(0x8e1)](_0x241c13), _0x1f61f2 = _0x272c27[_0x2fd769(0x84d)](_0x3ecb48); _0x1f61f2['onsuccess'] = () => _0x4184e9(), _0x1f61f2[_0x2fd769(0x41e)] = () => _0x44fab4(_0x1f61f2['error']); } } } } function _0x2ef036(_0x5e30ba, _0xf0b3bb) { const _0x5d3277 = _0x54ed15, { role: _0x5c4dfe, content: _0x27e6d3, displayUrl: _0x1e1f55, image: _0x134e31, senderId: _0x261f62 } = _0x5e30ba, _0x1234e0 = _0x5c4dfe === _0x5d3277(0x81d) ? 'ai' : _0x5c4dfe, _0x3be685 = _0x597f5f(), _0x194182 = document['createElement'](_0x5d3277(0x41a)); _0x194182[_0x5d3277(0x78f)][_0x5d3277(0x3d0)]('message-container', _0x1234e0), _0x194182['dataset'][_0x5d3277(0x79d)] = _0xf0b3bb; const _0x3c39dc = document[_0x5d3277(0x820)](_0x5d3277(0x41a)); _0x3c39dc[_0x5d3277(0x941)] = _0x5d3277(0x7a3); const _0x480893 = document[_0x5d3277(0x820)](_0x5d3277(0x6d8)); _0x480893[_0x5d3277(0x78f)][_0x5d3277(0x3d0)](_0x5d3277(0x4ef), _0x5c4dfe + _0x5d3277(0x78d)); let _0x218849 = ''; if (_0x5c4dfe === _0x5d3277(0x619)) { const _0x4abe7d = _0x3d25f9(_0x346f80['activeChatId']); _0x218849 = _0x4abe7d['avatar'] || _0x223ec8; } else { _0x218849 = _0x2f6e79; let _0xc52254 = null; if (_0x3be685?.[_0x5d3277(0x62d)] === _0x5d3277(0x328)) _0xc52254 = _0x5122c0(_0x3be685[_0x5d3277(0x717)][0x0]); else _0x3be685?.[_0x5d3277(0x62d)] === _0x5d3277(0x661) && _0x261f62 && (_0xc52254 = _0x5122c0(_0x261f62)); _0xc52254?.[_0x5d3277(0x4ef)] && (_0x218849 = _0xc52254[_0x5d3277(0x4ef)]); } _0x480893[_0x5d3277(0x7d9)] = _0x218849, _0x480893[_0x5d3277(0x97e)] = _0x5c4dfe + '\x20avatar'; const _0x466920 = _0x27e6d3 && _0x27e6d3[_0x5d3277(0x4dd)]()[_0x5d3277(0x859)](_0x5d3277(0x4a5)) && _0x27e6d3[_0x5d3277(0x4dd)]()[_0x5d3277(0x3d7)](_0x5d3277(0x49e)); if (_0x466920) { const _0x1924e9 = document[_0x5d3277(0x820)]('div'); _0x1924e9['className'] = 'html-module-container', _0x1924e9['innerHTML'] = _0x27e6d3, _0x1234e0 === 'user' ? _0x5d3277(0x99a) !== _0x5d3277(0x794) ? (_0x3c39dc[_0x5d3277(0x204)](_0x1924e9), _0x3c39dc[_0x5d3277(0x204)](_0x480893)) : (_0x249c26[_0x5d3277(0x8d6)](_0x5d3277(0x1b9), _0x55867c), _0x5bc63b(_0x5d3277(0x6ef))) : (_0x3c39dc[_0x5d3277(0x204)](_0x480893), _0x3c39dc[_0x5d3277(0x204)](_0x1924e9)); } else { const _0x2545a8 = document[_0x5d3277(0x820)]('div'); _0x2545a8[_0x5d3277(0x78f)][_0x5d3277(0x3d0)](_0x5d3277(0x399), _0x1234e0); if (_0x3be685?.[_0x5d3277(0x62d)] === _0x5d3277(0x328)) { const _0x5501f1 = _0x3be685[_0x5d3277(0x717)][0x0]; _0x2545a8['classList'][_0x5d3277(0x3d0)](_0x5d3277(0x65c) + _0x5501f1); } if (_0x5e30ba[_0x5d3277(0x2da)]) { if (_0x5d3277(0x74b) !== _0x5d3277(0x74b)) { if (_0x32cb19[_0x5d3277(0x2d4)]) return; const _0x1a163a = _0x8864ae[_0x5d3277(0x713)], _0x14b7cb = _0x26f024[_0x5d3277(0x495)](_0x4f4260[_0x5d3277(0x94b)][_0x5d3277(0x247)](_0x2839f7 => _0x2839f7[_0x5d3277(0x80d)] === _0x29f901[_0x5d3277(0x597)])['entries'][_0x5d3277(0x6c3)] / 0x2); if (_0x1a163a >= _0x14b7cb - 0x1) return; _0x269f5c[_0x5d3277(0x2d4)] = !![]; const _0x12b24b = _0x1a163a + 0x1, _0x5ee93c = _0x38e062['getElementById'](_0x5d3277(0x76f) + _0x1a163a), _0x493552 = _0x86a56c['getElementById'](_0x5d3277(0x76f) + _0x12b24b); _0x5ee93c && _0x493552 ? (_0x493552[_0x5d3277(0x78f)][_0x5d3277(0x3d0)](_0x5d3277(0x35b)), _0x5ee93c[_0x5d3277(0x78f)][_0x5d3277(0x3d0)](_0x5d3277(0x365)), _0x493552['classList'][_0x5d3277(0x3d0)]('is-visible'), _0x297eb7(() => { const _0x252a27 = _0x5d3277; _0x5ee93c['classList']['remove'](_0x252a27(0x415), _0x252a27(0x365)), _0x493552[_0x252a27(0x78f)][_0x252a27(0x309)]('is-entering-from-right'), _0x276736[_0x252a27(0x713)] = _0x12b24b, _0x125f99(), _0x3d0432['isAnimatingDiary'] = ![]; }, 0x2bc)) : _0x45e876[_0x5d3277(0x2d4)] = ![]; } else { const _0x59ceb5 = document['createElement']('div'); _0x59ceb5[_0x5d3277(0x941)] = _0x5d3277(0x408); const _0x49df88 = document[_0x5d3277(0x820)]('div'); _0x49df88['className'] = _0x5d3277(0x4e0), _0x49df88[_0x5d3277(0x96c)] = _0x5e30ba[_0x5d3277(0x2da)][_0x5d3277(0x812)]; const _0x4a1755 = document[_0x5d3277(0x820)](_0x5d3277(0x41a)); _0x4a1755[_0x5d3277(0x941)] = _0x5d3277(0x936), _0x4a1755[_0x5d3277(0x96c)] = _0x5e30ba['quotedMessage']['content'], _0x59ceb5[_0x5d3277(0x204)](_0x49df88), _0x59ceb5[_0x5d3277(0x204)](_0x4a1755), _0x2545a8['appendChild'](_0x59ceb5); } } if (_0x1e1f55) { if (_0x5d3277(0x5f8) === _0x5d3277(0x5f8)) { _0x2545a8[_0x5d3277(0x78f)][_0x5d3277(0x3d0)](_0x5d3277(0x53c)); const _0x52d3ae = document[_0x5d3277(0x820)](_0x5d3277(0x6d8)); _0x52d3ae[_0x5d3277(0x7d9)] = _0x1e1f55, _0x52d3ae[_0x5d3277(0x78f)][_0x5d3277(0x3d0)](_0x5d3277(0x5ff)), _0x2545a8[_0x5d3277(0x204)](_0x52d3ae); } else { if (_0x54dd78) { const _0x164589 = _0x2352b1(_0x3ab236[_0x5d3277(0x785)]); _0x164589 && (delete _0x164589[_0x5d3277(0x27d)], _0x546d20(), _0x142d4c(_0x164589['id'], 'normal'), _0x4c476f(_0x5d3277(0x459)), _0xb33a1a(!![])); } } } else { if (_0x5e30ba[_0x5d3277(0x85e)] || _0x5e30ba[_0x5d3277(0x1e4)]) { _0x2545a8[_0x5d3277(0x78f)][_0x5d3277(0x3d0)](_0x5d3277(0x85e)); const _0x4ba4a2 = document['createElement'](_0x5d3277(0x6d8)); _0x4ba4a2['classList'][_0x5d3277(0x3d0)](_0x5d3277(0x668)), _0x2545a8[_0x5d3277(0x204)](_0x4ba4a2); if (_0x5e30ba[_0x5d3277(0x85e)]) _0x5d3277(0x8ed) === 'LOlGC' ? _0x550c28(_0x30108e, _0x19e3ac[_0x5d3277(0x921)][_0x5d3277(0x626)][0x0]) : _0x4ba4a2[_0x5d3277(0x7d9)] = _0x5e30ba[_0x5d3277(0x85e)]; else { if ('sLnoC' !== 'sLnoC') try { const _0x5b1803 = _0x3d72c8['parse'](_0x3b52bb[_0x5d3277(0x164)](_0x5d3277(0x197)) || '{}'), _0x2f6089 = { ..._0x5b1803, ..._0x252477 }; _0x5aa42c[_0x5d3277(0x6c6)](_0x5d3277(0x197), _0x309b91['stringify'](_0x2f6089)); } catch (_0x4fdf93) { _0x3d6acd[_0x5d3277(0x8d6)](_0x5d3277(0x4eb), _0x4fdf93); } else _0x4ba4a2[_0x5d3277(0x7d9)] = _0x5d3277(0x6d1), _0x4f16ca(_0x5e30ba[_0x5d3277(0x1e4)])[_0x5d3277(0x710)](_0x302dfb => { const _0x42f340 = _0x5d3277; if (_0x42f340(0x725) !== _0x42f340(0x725)) _0x3932c5['setItem']('musicPlayerState', _0x226ea1[_0x42f340(0x714)]({ 'playlist': _0x12ba93[_0x42f340(0x4a7)], 'currentIndex': _0xb326d3[_0x42f340(0x2bb)] })); else { if (_0x302dfb) { const _0x7e57fc = URL['createObjectURL'](_0x302dfb); _0x4ba4a2[_0x42f340(0x7d9)] = _0x7e57fc, _0x4ba4a2[_0x42f340(0x3cc)] = () => { URL['revokeObjectURL'](_0x7e57fc); }; } else _0x4ba4a2['alt'] = _0x42f340(0x687); } })[_0x5d3277(0x958)](_0x475acb => { const _0xaa408b = _0x5d3277; 'XLgYB' !== 'XLgYB' ? _0x4df4b4[_0xaa408b(0x8d6)](_0xaa408b(0x950), _0x14da63) : (console[_0xaa408b(0x8d6)](_0xaa408b(0x873), _0x475acb), _0x4ba4a2[_0xaa408b(0x97e)] = '图片加载失败'); }); } if (_0x27e6d3) { const _0x424885 = document[_0x5d3277(0x820)]('p'); _0x424885[_0x5d3277(0x94f)][_0x5d3277(0x610)] = _0x5d3277(0x3bc), _0x424885[_0x5d3277(0x96c)] = _0x27e6d3, _0x2545a8[_0x5d3277(0x204)](_0x424885); } } else { if (_0x5e30ba[_0x5d3277(0x62d)] === 'transfer') { _0x2545a8['classList'][_0x5d3277(0x3d0)](_0x5d3277(0x37f)); const _0x1fc352 = _0x5e30ba[_0x5d3277(0x6b9)] === _0x5d3277(0x619) ? _0x3d25f9(_0x346f80['activeChatId']) : _0x5122c0(_0x5e30ba[_0x5d3277(0x980)]), _0x43d2db = _0x5e30ba[_0x5d3277(0x400)] === _0x3d25f9(_0x346f80[_0x5d3277(0x509)])['id'] ? _0x3d25f9(_0x346f80[_0x5d3277(0x509)]) : _0x5122c0(_0x5e30ba[_0x5d3277(0x400)]), _0x4bc845 = _0x1fc352?.[_0x5d3277(0x4e6)] ? _0x1fc352['name'] + _0x5d3277(0x5d8) : '转账', _0x4e8ccf = _0x43d2db?.['name'] ? '转给\x20' + _0x43d2db[_0x5d3277(0x4e6)] : '转账', _0x382a3d = _0x5d3277(0x453) + _0x4bc845 + _0x5d3277(0x2ad) + _0x5e30ba[_0x5d3277(0x1b3)][_0x5d3277(0x557)](0x2) + _0x5d3277(0x7a7) + _0x4e8ccf + _0x5d3277(0x893); _0x2545a8[_0x5d3277(0x6a9)] = _0x382a3d; } else { if (_0x5e30ba['type'] === _0x5d3277(0x899)) { _0x2545a8[_0x5d3277(0x78f)][_0x5d3277(0x3d0)](_0x5d3277(0x632)); const _0x4b5b53 = document[_0x5d3277(0x820)]('div'); _0x4b5b53[_0x5d3277(0x941)] = _0x5d3277(0x844), _0x4b5b53[_0x5d3277(0x78f)][_0x5d3277(0x3d0)](_0x5d3277(0x35f)); const _0x1db0f7 = _0x5e30ba[_0x5d3277(0x6b9)] === 'user' ? _0x3d25f9(_0x346f80[_0x5d3277(0x509)])['name'] || '你' : _0x5122c0(_0x5e30ba['senderId'])?.[_0x5d3277(0x4e6)] || 'TA', _0x3b5bca = _0x5d3277(0x279) + _0x5e30ba[_0x5d3277(0x83c)], _0x5fe37 = '<img\x20id=\x22' + _0x3b5bca + _0x5d3277(0x437) + _0x2f6e79 + '\x22>'; if (_0x5e30ba[_0x5d3277(0x5be)]) { if (_0x5d3277(0x614) === _0x5d3277(0x614)) _0x4f16ca(_0x5e30ba['coverId'])['then'](_0x3331d5 => { const _0x1f99c4 = _0x5d3277, _0x1b5de5 = document['getElementById'](_0x3b5bca); if (_0x1b5de5 && _0x3331d5) _0x1b5de5[_0x1f99c4(0x7d9)] = URL[_0x1f99c4(0x8f3)](_0x3331d5); }); else { _0x22680c(_0x5d3277(0x547)); return; } } if (_0x5e30ba['accepted']) { if (_0x5d3277(0x4dc) === _0x5d3277(0x701)) { const _0x59582b = _0x850dcb[_0x5d3277(0x3aa)]['find'](_0x52c942 => _0x52c942['id'] === _0x548f2f); if (!_0x59582b || _0x59582b[_0x5d3277(0x62d)] !== _0x5d3277(0x661)) return; _0x2c7347[_0x5d3277(0x954)](_0x5d3277(0x3f4))[_0x5d3277(0x908)] = _0x59582b[_0x5d3277(0x4e6)] || '', _0x89a872(_0x5d3277(0x23e)), _0x1ae140[_0x5d3277(0x954)](_0x5d3277(0x23e))[_0x5d3277(0x908)] = _0x59582b['boundUserProfileId'] || _0x129255[_0x5d3277(0x7da)]; const _0x532050 = _0x2adcab[_0x5d3277(0x954)](_0x5d3277(0x326)); _0x532050[_0x5d3277(0x6a9)] = '', _0x597441[_0x5d3277(0x814)][_0x5d3277(0x927)](_0x56c685 => { const _0x4438f7 = _0x5d3277, _0x2b4cd9 = _0x59582b['linkedWorldBookIds']?.['includes'](_0x56c685['id']), _0x2c7ea1 = _0xd27653[_0x4438f7(0x820)](_0x4438f7(0x486)); _0x2c7ea1[_0x4438f7(0x6a9)] = _0x4438f7(0x60c) + _0x56c685['id'] + '\x22\x20' + (_0x2b4cd9 ? _0x4438f7(0x896) : '') + '>\x20' + _0x56c685[_0x4438f7(0x4e6)], _0x532050[_0x4438f7(0x204)](_0x2c7ea1); }), _0x3c6210(); const _0x576dce = _0x3677d2[_0x5d3277(0x954)](_0x5d3277(0x8cf)), _0xdfc697 = _0x386ba3['getElementById']('group-bg-preview'); _0x13c09(_0x5d3277(0x3bf) + _0x3a9c05)[_0x5d3277(0x710)](_0x47bfcc => { const _0x4a7179 = _0x5d3277; _0x576dce[_0x4a7179(0x7d9)] = _0x47bfcc ? _0xae5e21[_0x4a7179(0x8f3)](_0x47bfcc) : _0x2d9b7d; }), _0x41911b(_0x5d3277(0x2bf) + _0xd8e93)[_0x5d3277(0x710)](_0x152a4d => { const _0x2e4738 = _0x5d3277; _0xdfc697[_0x2e4738(0x7d9)] = _0x152a4d ? _0x28fac9['createObjectURL'](_0x152a4d) : ''; }), _0x43f2a4(_0x5d3277(0x1bd), 'chat'); } else _0x4b5b53[_0x5d3277(0x6a9)] = _0x5d3277(0x90c) + _0x5fe37 + _0x5d3277(0x4c4) + _0x5e30ba[_0x5d3277(0x9be)] + _0x5d3277(0x4ba) + _0x5e30ba[_0x5d3277(0x53d)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>'; } else { if (_0x5d3277(0x30a) !== 'ZGVCH') _0x4b5b53['innerHTML'] = _0x5d3277(0x450) + _0x1db0f7 + _0x5d3277(0x490) + _0x5fe37 + _0x5d3277(0x4c4) + _0x5e30ba[_0x5d3277(0x9be)] + _0x5d3277(0x4ba) + _0x5e30ba[_0x5d3277(0x53d)] + _0x5d3277(0x9a0) + _0x5e30ba[_0x5d3277(0x789)] + _0x5d3277(0x9c8); else { _0x6651b9[_0x5d3277(0x6a9)] = _0x5d3277(0x966); return; } } _0x2545a8[_0x5d3277(0x204)](_0x4b5b53); } else { if (_0x5e30ba[_0x5d3277(0x62d)] === _0x5d3277(0x632) && _0x5e30ba['songName']) { if (_0x5d3277(0x25f) !== _0x5d3277(0x25f)) { _0x43612a[_0x5d3277(0x499)] = _0x1b1560[_0x5d3277(0x499)][_0x5d3277(0x6e8)](_0x5bb958 => _0x5bb958['id'] !== _0x2b862f), _0x289d80['chats'][_0x5d3277(0x927)](_0x5861f1 => { const _0x53276d = _0x5d3277; _0x5861f1[_0x53276d(0x62d)] === 'group' && (_0x5861f1[_0x53276d(0x717)] = _0x5861f1['participantIds'][_0x53276d(0x6e8)](_0x3a9dba => _0x3a9dba !== _0x35126d)); }); const _0x125d17 = _0x311c0a[_0x5d3277(0x3aa)]['find'](_0x1d9101 => _0x1d9101[_0x5d3277(0x62d)] === 'private' && _0x1d9101[_0x5d3277(0x717)]['includes'](_0x1628ab)); _0x125d17 && _0x5d26c3(_0x125d17['id']), _0x3f6ac6[_0x5d3277(0x3aa)] = _0x5b91d0[_0x5d3277(0x3aa)][_0x5d3277(0x6e8)](_0x346030 => _0x346030[_0x5d3277(0x62d)] !== _0x5d3277(0x661) || _0x346030[_0x5d3277(0x717)][_0x5d3277(0x6c3)] > 0x1), _0x20d4ea(), _0x393f0e(); } else { _0x2545a8['classList'][_0x5d3277(0x3d0)](_0x5d3277(0x632)); const _0xc070c0 = document[_0x5d3277(0x820)](_0x5d3277(0x41a)); _0xc070c0['className'] = _0x5d3277(0x71f), _0xc070c0['dataset'][_0x5d3277(0x236)] = _0x5d3277(0x590) + _0x5e30ba[_0x5d3277(0x83c)]; const _0x52c54d = 'cover_placeholder_' + _0x5e30ba[_0x5d3277(0x83c)], _0x3e1bfe = _0x5d3277(0x438) + _0x2f6e79 + _0x5d3277(0x928) + _0x52c54d + '\x22\x20class=\x22music-share-cover\x22>'; if (_0x5e30ba[_0x5d3277(0x5be)]) _0x4f16ca(_0x5e30ba[_0x5d3277(0x5be)])[_0x5d3277(0x710)](_0x12dea3 => { const _0x20735e = _0x5d3277; if (_0x20735e(0x381) === _0x20735e(0x220)) _0x5f2208[_0x20735e(0x78f)][_0x20735e(0x309)](_0x20735e(0x415), _0x20735e(0x7e9)), _0x4a0cda[_0x20735e(0x78f)]['remove'](_0x20735e(0x44b)), _0x5432f8[_0x20735e(0x713)] = _0x538946, _0x4cefd9(), _0x53484e[_0x20735e(0x2d4)] = ![]; else { const _0x50b204 = document[_0x20735e(0x954)](_0x52c54d); if (_0x50b204 && _0x12dea3) _0x50b204['src'] = URL[_0x20735e(0x8f3)](_0x12dea3); } }); else _0x5e30ba['coverUrl'] && setTimeout(() => { const _0x5174ca = _0x5d3277, _0x52dce5 = document[_0x5174ca(0x954)](_0x52c54d); if (_0x52dce5) _0x52dce5[_0x5174ca(0x7d9)] = _0x5e30ba[_0x5174ca(0x4ea)]; }, 0x0); _0xc070c0[_0x5d3277(0x6a9)] = _0x5d3277(0x6fe) + _0x3e1bfe + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x5e30ba[_0x5d3277(0x9be)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x5e30ba[_0x5d3277(0x53d)] + _0x5d3277(0x7c2) + (_0x5e30ba['playableUrl'] ? '▶' : '⚠') + _0x5d3277(0x49e); if (_0x5e30ba['playableUrl']) { if ('iqxUC' !== _0x5d3277(0x2f3)) _0xc070c0[_0x5d3277(0x35e)]('click', function () { const _0xaea453 = _0x5d3277, _0x5b259f = { 'id': _0xaea453(0x590) + _0x5e30ba['timestamp'], 'url': _0x5e30ba[_0xaea453(0x32c)] }; _0x5321d7(this, _0x5b259f); }); else return new _0x208be2(_0x10822c => { const _0x42e1d0 = _0x5d3277, _0xf078d8 = _0x42e1d0(0x3c2); _0x228329['body'][_0x42e1d0(0x272)](_0x42e1d0(0x189), _0xf078d8); const _0x101caa = _0x14729e[_0x42e1d0(0x954)](_0x42e1d0(0x245)), _0x392209 = _0x3c84bc['getElementById'](_0x42e1d0(0x676)), _0x36c4ea = _0x5d7beb[_0x42e1d0(0x954)](_0x42e1d0(0x375)), _0x23c800 = _0x524507[_0x42e1d0(0x954)](_0x42e1d0(0x443)), _0x2dccb2 = _0x101caa[_0x42e1d0(0x7c6)](_0x42e1d0(0x7e8)), _0x579035 = () => { _0x101caa['remove'](), _0x10822c(); }; _0x36c4ea['onclick'] = () => { const _0xab74b2 = _0x42e1d0; _0x24c814(_0x392209[_0xab74b2(0x908)]), _0x579035(); }, _0x23c800[_0x42e1d0(0x1b0)] = _0x579035, _0x2dccb2[_0x42e1d0(0x1b0)] = _0x579035; }); } _0x2545a8[_0x5d3277(0x204)](_0xc070c0); } } else { if (_0x27e6d3) { const _0x197333 = document[_0x5d3277(0x820)]('p'); _0x197333[_0x5d3277(0x6a9)] = _0x27e6d3, _0x197333['style'][_0x5d3277(0x6b4)] = '0', _0x2545a8['appendChild'](_0x197333); } } } } } } if (_0x5c4dfe === _0x5d3277(0x619)) _0x3c39dc[_0x5d3277(0x204)](_0x2545a8), _0x3c39dc[_0x5d3277(0x204)](_0x480893); else { if ('lFqTH' !== _0x5d3277(0x803)) { const _0x192c9b = new _0x15f5a7(_0x57ec32[_0x5d3277(0x83c)])[_0x5d3277(0x68c)](_0x5d3277(0x6dd), { 'hour': '2-digit', 'minute': _0x5d3277(0x9d7) }); _0x541ac9['content'] && _0x40370b[_0x5d3277(0x580)]('[' + _0x192c9b + _0x5d3277(0x4bc) + _0x2c8fb4(_0x1c5160) + ']\x20' + _0x3982fb(_0x223ba8['content'])[_0x5d3277(0x4dd)]()); } else _0x3c39dc[_0x5d3277(0x204)](_0x480893), _0x3c39dc[_0x5d3277(0x204)](_0x2545a8); } } _0x194182[_0x5d3277(0x204)](_0x3c39dc); const _0x2a7d86 = document[_0x5d3277(0x820)](_0x5d3277(0x41a)); return _0x2a7d86[_0x5d3277(0x941)] = _0x5d3277(0x83c), _0x2a7d86[_0x5d3277(0x96c)] = _0x37ea04(_0x5e30ba['timestamp']), _0x194182[_0x5d3277(0x204)](_0x2a7d86), _0x5a55b2[_0x5d3277(0x204)](_0x194182), _0x194182; } document['getElementById'](_0x54ed15(0x517))[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x4c5e19); let _0x1315a3 = null, _0x2c8595 = null; function _0x4c5e19(_0xa252b5) { const _0x2813d5 = _0x54ed15; if (_0x2813d5(0x7b9) !== _0x2813d5(0x7b9)) { const _0x5a5f52 = { 'id': _0x2813d5(0x268) + _0x381a53[_0x2813d5(0x909)](), 'name': _0x2fd72b, 'boundUserProfileId': _0x768e76, 'memberCharacterIds': _0x805d37, 'posts': [] }; _0x5da8c6[_0x2813d5(0x4a8)][_0x2813d5(0x580)](_0x5a5f52); } else { if (window[_0x2813d5(0x286)]()[_0x2813d5(0x894)]()) { if (_0x2813d5(0x680) !== _0x2813d5(0x5fe)) return; else _0xa1705b += _0x2813d5(0x75f); } const _0x3b8619 = _0xa252b5[_0x2813d5(0x921)][_0x2813d5(0x34c)](_0x2813d5(0x80e)), _0x334598 = _0xa252b5[_0x2813d5(0x921)][_0x2813d5(0x34c)]('.no-action-modal'); if (!_0x3b8619 || _0x334598) return; const _0x5846b = parseInt(_0x3b8619[_0x2813d5(0x86c)][_0x2813d5(0x79d)], 0xa); if (isNaN(_0x5846b)) return; _0x2990a9(_0x5846b); } } function _0x5e630d() { const _0xca3794 = _0x54ed15, _0x2d720e = _0x597f5f(); if (!_0x2d720e) { _0x2e3040['textContent'] = _0xca3794(0x2cf); return; } if (_0x2d720e['type'] === _0xca3794(0x328)) { if (_0xca3794(0x762) !== _0xca3794(0x762)) _0x412eef(_0x529111[_0xca3794(0x717)][0x0]); else { const _0x40294a = _0x5122c0(_0x2d720e[_0xca3794(0x717)][0x0]); _0x2e3040['textContent'] = _0x40294a ? _0x40294a['name'] : _0xca3794(0x317); } } else _0x2e3040['textContent'] = _0x2d720e['name'] || _0xca3794(0x30d) + _0x2d720e[_0xca3794(0x717)][_0xca3794(0x6c3)] + ')'; } function _0x394e2e(_0x1d050d) { const _0x51c41c = _0x54ed15, _0x4f1555 = document[_0x51c41c(0x7c6)]('.screen.active'); if (_0x4f1555 && (_0x4f1555['id'] === 'meeting-view-screen' || _0x4f1555['id'] === _0x51c41c(0x512))) _0x1e3341(); else { const _0x4d72f0 = document['querySelectorAll'](_0x51c41c(0x1d9)); _0x4d72f0[_0x51c41c(0x927)](_0x4c8ade => _0x4c8ade[_0x51c41c(0x309)]()); } } function _0x28a937() { const _0x189b5a = _0x54ed15; if (_0x189b5a(0x825) === _0x189b5a(0x825)) _0x346f80[_0x189b5a(0x3d2)] && _0x346f80['currentAbortController'] && (console[_0x189b5a(0x7e5)](_0x189b5a(0x198)), _0x346f80[_0x189b5a(0x5f7)][_0x189b5a(0x93c)](_0x189b5a(0x2a1)), _0x346f80[_0x189b5a(0x5f7)] = null), _0x346f80[_0x189b5a(0x3d2)] = ![], _0x394e2e(![]); else { const _0x1baa6a = new _0x5e2207(), _0x91c592 = _0x43961c[_0x189b5a(0x954)](_0x189b5a(0x469)), _0x38b0a0 = _0x5008e8[_0x189b5a(0x954)]('galgame-date'); if (_0x91c592 && _0x38b0a0) { const _0x158f55 = _0x57a14b(_0x1baa6a[_0x189b5a(0x27c)]())['padStart'](0x2, '0'), _0x27ea31 = _0x5fd11e(_0x1baa6a['getMinutes']())[_0x189b5a(0x990)](0x2, '0'); _0x91c592[_0x189b5a(0x96c)] = _0x158f55 + ':' + _0x27ea31; const _0x256988 = _0x1baa6a['getMonth']() + 0x1, _0x4f21e9 = _0x1baa6a[_0x189b5a(0x74d)](), _0x5af5f0 = [_0x189b5a(0x1d2), _0x189b5a(0x8cb), '星期二', '星期三', _0x189b5a(0x809), _0x189b5a(0x642), '星期六'][_0x1baa6a['getDay']()]; _0x38b0a0[_0x189b5a(0x96c)] = _0x256988 + '月' + _0x4f21e9 + '日\x20' + _0x5af5f0; } } } function _0x597f5f() { const _0x18df00 = _0x54ed15; if ('nuhhD' === _0x18df00(0x946)) { const _0x16e907 = _0x450cee[_0x18df00(0x954)](_0x18df00(0x53e)); if (!_0x16e907) return; const _0x342c1e = _0x1c0d42[_0x18df00(0x164)]('themeHue') || '35'; _0x207594['documentElement'][_0x18df00(0x94f)]['setProperty'](_0x18df00(0x637), _0x342c1e), _0x16e907['value'] = _0x342c1e, _0x16e907[_0x18df00(0x35e)](_0x18df00(0x7b5), () => { const _0x22d198 = _0x18df00, _0x5780c8 = _0x16e907[_0x22d198(0x908)]; _0x4c8266[_0x22d198(0x5f6)][_0x22d198(0x94f)][_0x22d198(0x324)]('--primary-hue', _0x5780c8), _0x4029d3[_0x22d198(0x6c6)](_0x22d198(0x1fd), _0x5780c8), _0x4b2611(); }); } else return _0x346f80['chats'][_0x18df00(0x247)](_0x1c7fc8 => _0x1c7fc8['id'] === _0x346f80[_0x18df00(0x509)]); } function _0x5122c0(_0x1511c7) { const _0x338649 = _0x54ed15; if (_0x338649(0x477) !== _0x338649(0x4bb)) return _0x346f80[_0x338649(0x499)][_0x338649(0x247)](_0x2fed80 => _0x2fed80['id'] === _0x1511c7); else _0x2eb97d = _0x44c262[_0x338649(0x717)][0x0]; } function _0xd1b23e(_0x123eca) { const _0x535107 = _0x54ed15; _0x346f80['characters'] = _0x346f80[_0x535107(0x499)]['filter'](_0x31fed7 => _0x31fed7['id'] !== _0x123eca), _0x346f80['chats']['forEach'](_0x5b4e6c => { const _0x5daa57 = _0x535107; _0x5b4e6c[_0x5daa57(0x62d)] === _0x5daa57(0x661) && (_0x5b4e6c['participantIds'] = _0x5b4e6c[_0x5daa57(0x717)][_0x5daa57(0x6e8)](_0x32465b => _0x32465b !== _0x123eca)); }); const _0x53bac1 = _0x346f80[_0x535107(0x3aa)][_0x535107(0x247)](_0x3327cc => _0x3327cc['type'] === 'private' && _0x3327cc[_0x535107(0x717)][_0x535107(0x84e)](_0x123eca)); _0x53bac1 && _0x43f7e7(_0x53bac1['id']), _0x346f80['chats'] = _0x346f80[_0x535107(0x3aa)][_0x535107(0x6e8)](_0x51044f => _0x51044f[_0x535107(0x62d)] !== _0x535107(0x661) || _0x51044f[_0x535107(0x717)][_0x535107(0x6c3)] > 0x1), _0x23c6b9(), _0x546ea8(); } function _0x43f7e7(_0x5e8c4f) { const _0x59aa81 = _0x54ed15; _0x346f80[_0x59aa81(0x3aa)] = _0x346f80['chats']['filter'](_0x276ec2 => _0x276ec2['id'] !== _0x5e8c4f); try { _0x59aa81(0x890) !== _0x59aa81(0x890) ? _0x435a02[_0x59aa81(0x78f)][_0x59aa81(0x3d0)](_0x59aa81(0x93f)) : localStorage[_0x59aa81(0x845)](_0x59aa81(0x649) + _0x5e8c4f); } catch (_0x2629ef) { _0x59aa81(0x29c) === _0x59aa81(0x7cb) ? !_0x5d002f['contains'](_0x2e0b70['target']) && _0x16ab26['target'] !== _0x34afff && _0x5745a2[_0x59aa81(0x921)] !== _0x57d677 && _0x47dc02['classList'][_0x59aa81(0x309)](_0x59aa81(0x373)) : console[_0x59aa81(0x8d6)](_0x59aa81(0x3a8) + _0x5e8c4f, _0x2629ef); } if (_0x346f80[_0x59aa81(0x509)] === _0x5e8c4f) { if (_0x59aa81(0x5ab) !== 'wDSPz') _0x346f80[_0x59aa81(0x509)] = _0x346f80[_0x59aa81(0x3aa)][0x0]?.['id'] || null, _0x54cb4c(_0x346f80[_0x59aa81(0x509)]); else return (_0x487e50?.['characters'] || [])[_0x59aa81(0x247)](_0x23dc15 => _0x23dc15['id'] === _0x47c97f); } _0x23c6b9(), _0x546ea8(); } async function _0x54cb4c(_0x3ed568) { const _0xece753 = _0x54ed15; _0x346f80[_0xece753(0x509)] !== _0x3ed568 && (_0x28a937(), _0x346f80[_0xece753(0x98d)] = 0x64); if (!_0x3ed568) { _0x346f80[_0xece753(0x509)] = null, _0x23c6b9(), _0x4c5132(![]), document[_0xece753(0x954)]('chat-view-pane')[_0xece753(0x94f)][_0xece753(0x5d2)] = ''; return; } _0x346f80['activeChatId'] = _0x3ed568, _0x23c6b9(), _0x5e630d(), _0x5a55b2[_0xece753(0x6a9)] = '', _0x6cd89d(!![], '稍微有点卡了，可以尝试清空聊天记录了！记得总结丢世界书'), setTimeout(async () => { const _0x54f98c = _0xece753; if (_0x54f98c(0x870) === _0x54f98c(0x7cd)) { const _0x12927d = _0x4c948d[_0x54f98c(0x190)](); _0x12927d[_0x54f98c(0x8fb)] = () => _0x47f9a8(_0x12927d[_0x54f98c(0x37b)]), _0x12927d[_0x54f98c(0x41e)] = () => _0x5fa279(_0x12927d['error']); } else try { if (_0x54f98c(0x9a8) !== 'HlIQt') { _0x3a0ba4(); const _0x724922 = _0x597f5f(), _0x20ff95 = document[_0x54f98c(0x954)](_0x54f98c(0x1f5)); let _0x175570 = null; if (_0x724922) { if (_0x724922['type'] === _0x54f98c(0x328)) { if (_0x54f98c(0x657) === _0x54f98c(0x657)) { const _0x1e6190 = _0x724922[_0x54f98c(0x717)][0x0]; _0x25a177(_0x1e6190), _0x175570 = await _0x4f16ca(_0x54f98c(0x6fc) + _0x1e6190); } else delete _0x28633a[_0x54f98c(0x27d)], _0x1f7d35(), _0x55d38a(_0x3f0f9e['id'], _0x54f98c(0x7e0)), _0x5bbf10('已恢复默认。'), _0x17eb22(!![]); } else _0x175570 = await _0x4f16ca(_0x54f98c(0x2bf) + _0x724922['id']); _0x175570 ? (_0x20ff95[_0x54f98c(0x94f)][_0x54f98c(0x5d2)] = _0x54f98c(0x4a0) + URL[_0x54f98c(0x8f3)](_0x175570) + '\x27)', _0x20ff95[_0x54f98c(0x94f)][_0x54f98c(0x385)] = _0x54f98c(0x34e), _0x20ff95[_0x54f98c(0x94f)]['backgroundPosition'] = _0x54f98c(0x2b3)) : _0x54f98c(0x29f) === _0x54f98c(0x59d) ? (_0x3a8507['classList'][_0x54f98c(0x309)]('is-visible', _0x54f98c(0x365)), _0x596d58[_0x54f98c(0x78f)]['remove'](_0x54f98c(0x35b)), _0x4f8e76['diaryCurrentPage'] = _0x183eef, _0x2fd4ad(), _0x4dd4ef[_0x54f98c(0x2d4)] = ![]) : _0x20ff95[_0x54f98c(0x94f)][_0x54f98c(0x5d2)] = ''; } _0x1e1fc7(); } else _0x3c6e28(_0x54f98c(0x1ad)); } catch (_0xd52a34) { console[_0x54f98c(0x8d6)](_0x54f98c(0x355), _0xd52a34), _0x3383df(_0x54f98c(0x18d) + _0xd52a34[_0x54f98c(0x399)]); } finally { if (_0x54f98c(0x793) !== 'Shaqg') _0x6cd89d(![]); else { _0x508a66[_0x54f98c(0x908)] = '#\x20记录是空的，没什么好总结的。'; return; } } }, 0x32); } async function _0x40e8ad() { const _0xa06479 = _0x54ed15; if (_0x346f80['isGenerating']) { if (_0xa06479(0x54a) !== _0xa06479(0x54a)) { const _0x5a15ee = _0xd40985[_0xa06479(0x1ab)](_0x2a45c8, 0x2); _0x5a15ee[_0xa06479(0x41e)] = () => _0x3e4cdd(_0xa06479(0x59f)), _0x5a15ee[_0xa06479(0x8fb)] = () => _0x3e9ddd(_0x5a15ee[_0xa06479(0x37b)]), _0x5a15ee[_0xa06479(0x19d)] = _0x1830cb => { const _0x2605df = _0xa06479, _0x29113a = _0x1830cb['target'][_0x2605df(0x37b)]; !_0x29113a['objectStoreNames'][_0x2605df(0x6ce)](_0x24ba59) && _0x29113a['createObjectStore'](_0x15fdb8, { 'keyPath': 'id' }), !_0x29113a[_0x2605df(0x692)][_0x2605df(0x6ce)](_0x2605df(0x4d5)) && _0x29113a[_0x2605df(0x64e)](_0x2605df(0x4d5), { 'keyPath': 'id' }); }; } else { _0x3383df(_0xa06479(0x18e)); return; } } const _0x59b948 = _0x346f80['conversationHistory']; if (_0x59b948['length'] === 0x0) return; let _0x17a4d5 = -0x1; for (let _0x389c32 = _0x59b948[_0xa06479(0x6c3)] - 0x1; _0x389c32 >= 0x0; _0x389c32--) { if (_0x59b948[_0x389c32][_0xa06479(0x6b9)] === 'user') { if ('wsjCJ' !== _0xa06479(0x559)) _0x290aae[_0xa06479(0x5f7)] = null; else { _0x17a4d5 = _0x389c32; break; } } } if (_0x17a4d5 === -0x1 || _0x17a4d5 === _0x59b948[_0xa06479(0x6c3)] - 0x1) { if (_0xa06479(0x3c8) === _0xa06479(0x181)) { const _0x1fa209 = _0x4fdf68[_0xa06479(0x955)](_0x121618); if (_0x1fa209) _0x571693['localStorageData'][_0x1fa209] = _0x4564a8['getItem'](_0x1fa209); } else { _0x3383df(_0xa06479(0x630)); return; } } _0x59b948[_0xa06479(0x9ba)](_0x17a4d5 + 0x1), _0x5d853f(), _0x1e3341(), setTimeout(() => { _0x2a6a82(); }, 0x64); } function _0x57bdaa(_0x383283 = null) { const _0x441511 = _0x54ed15; if ('PqVUX' === 'PqVUX') { const _0xf9719f = _0x383283 ?? _0x2bab43[_0x441511(0x908)]['trim'](); if (_0xf9719f === '' || !_0x346f80[_0x441511(0x509)]) return; const _0x46beae = document[_0x441511(0x7c6)](_0x441511(0x4c7)), _0x116268 = _0x46beae['id'] === 'meeting-view-screen', _0x2cc197 = { 'role': _0x441511(0x619), 'content': _0xf9719f, 'timestamp': Date[_0x441511(0x909)](), 'isOffline': _0x116268 }; _0x346f80[_0x441511(0x4cd)] && (_0x2cc197[_0x441511(0x2da)] = { ..._0x346f80[_0x441511(0x4cd)] }), _0x346f80[_0x441511(0x250)][_0x441511(0x580)](_0x2cc197), _0x5d853f(), _0x1e3341(), !_0x383283 && (_0x441511(0x3f0) === _0x441511(0x3f0) ? _0x2bab43[_0x441511(0x908)] = '' : _0x40f254[_0x441511(0x6a0)](_0x441511(0x83e))[_0x441511(0x927)](_0x3f3099 => { const _0x1ba930 = _0x441511; if (_0x44370e[_0x1ba930(0x925)][_0x1ba930(0x84e)](_0x3f3099[_0x1ba930(0x908)])) _0x3f3099[_0x1ba930(0x896)] = !![]; })), _0x5317e1(); } else return _0x5dd588['chats']['find'](_0x1ed340 => _0x1ed340['id'] === _0x274ccd['activeChatId']); } function _0x3963c0(_0x179ba4) { const _0x501918 = _0x54ed15; if (!_0x179ba4 || !_0x346f80[_0x501918(0x509)]) return; const _0x380931 = { 'role': _0x501918(0x619), 'content': _0x501918(0x6a2) + _0x179ba4['name'] + ']', 'displayUrl': _0x179ba4[_0x501918(0x4ee)], 'timestamp': Date[_0x501918(0x909)]() }; _0x346f80[_0x501918(0x250)][_0x501918(0x580)](_0x380931), _0x2ef036(_0x380931, _0x346f80[_0x501918(0x250)][_0x501918(0x6c3)] - 0x1), _0x5d853f(), _0x24aa0[_0x501918(0x78f)][_0x501918(0x309)](_0x501918(0x373)); } async function _0x83eeaf(_0x129fcc) { const _0x2f1c68 = _0x54ed15; if (_0x2f1c68(0x99b) === _0x2f1c68(0x560)) _0x2aacea[_0x2f1c68(0x94f)]['display'] = _0x2f1c68(0x910); else { const _0x4a3a5a = _0x129fcc[_0x2f1c68(0x921)]['files'][0x0]; if (!_0x4a3a5a || !_0x346f80['activeChatId']) return; _0x6cd89d(!![], _0x2f1c68(0x7ed)); try { if (_0x2f1c68(0x6d2) !== _0x2f1c68(0x6d2)) _0x67062d[_0x2f1c68(0x39c)](); else { const _0x23ca8c = await _0x2ea925(_0x4a3a5a, 0x320, 0.8, !![]), _0x56fbef = _0x2f1c68(0x31a) + Date[_0x2f1c68(0x909)](); await _0x336559(_0x56fbef, _0x23ca8c); const _0x22b786 = _0x2bab43[_0x2f1c68(0x908)][_0x2f1c68(0x4dd)](); _0x2bab43[_0x2f1c68(0x908)] = ''; const _0x525cee = { 'role': _0x2f1c68(0x619), 'content': _0x22b786, 'imageId': _0x56fbef, 'timestamp': Date[_0x2f1c68(0x909)]() }; _0x346f80[_0x2f1c68(0x250)][_0x2f1c68(0x580)](_0x525cee), _0x2ef036(_0x525cee, _0x346f80[_0x2f1c68(0x250)][_0x2f1c68(0x6c3)] - 0x1), _0x5d853f(); } } catch (_0x2c6eae) { if (_0x2f1c68(0x5a9) !== 'zskhB') _0x3383df('图片处理失败:\x20' + _0x2c6eae[_0x2f1c68(0x399)]); else { if (!_0x1c5a72 || !_0x5723aa) return ''; const _0x3057dc = _0x19c509['chats'][_0x2f1c68(0x247)](_0x3de5bb => _0x3de5bb['type'] === _0x2f1c68(0x328) && _0x3de5bb[_0x2f1c68(0x717)]['includes'](_0xaa0365['id'])); if (!_0x3057dc || _0x3057dc[_0x2f1c68(0x96f)] !== _0x3237f2['id']) return ''; const _0x3f19bd = _0x23144f(_0x3057dc['id'])['slice'](-0x14); if (_0x3f19bd[_0x2f1c68(0x6c3)] === 0x0) return ''; const _0x3b7ce6 = _0x3f19bd[_0x2f1c68(0x2a0)](_0x43aaeb => { const _0x4650ce = _0x2f1c68, _0x274b5d = _0x43aaeb['role'] === 'user' ? _0x3f77ad[_0x4650ce(0x4e6)] : _0x54811b[_0x4650ce(0x4e6)]; return '[' + _0x274b5d + _0x4650ce(0x335) + _0x43aaeb['content']; })['join']('\x0a'); return _0x2f1c68(0x2e0) + _0x30f0b5[_0x2f1c68(0x4e6)] + _0x2f1c68(0x604) + _0x3b7ce6 + '\x0a'; } } finally { _0x6cd89d(![]), _0x129fcc[_0x2f1c68(0x921)][_0x2f1c68(0x908)] = ''; } } } async function _0x3c7f95() { const _0x48e7e0 = _0x54ed15; if (!_0x346f80[_0x48e7e0(0x509)]) return; const _0x98a03f = await _0x343177(); if (!_0x98a03f) return; _0x3383df(_0x48e7e0(0x3ad)); try { const _0x39554b = await _0x1e2b3a(_0x98a03f[_0x48e7e0(0x9be)], _0x98a03f[_0x48e7e0(0x53d)]); let _0x57ad3d = _0x39554b[_0x48e7e0(0x34e)]; if (_0x39554b['cover'] && _0x39554b['cover'][_0x48e7e0(0x859)](_0x48e7e0(0x7fe))) try { const _0x3c1ecd = await fetch(_0x39554b[_0x48e7e0(0x34e)]), _0x29637f = await _0x3c1ecd[_0x48e7e0(0x41c)](); _0x57ad3d = await _0x58722e(_0x29637f); } catch (_0x4b4a04) { console['error'](_0x48e7e0(0x28f), _0x4b4a04), _0x57ad3d = _0x2f6e79; } const _0xc8ea2f = { 'role': _0x48e7e0(0x619), 'type': _0x48e7e0(0x632), 'content': _0x48e7e0(0x24c) + _0x98a03f['songName'] + _0x48e7e0(0x218) + _0x98a03f[_0x48e7e0(0x53d)] + ']', 'songName': _0x98a03f[_0x48e7e0(0x9be)], 'artist': _0x98a03f[_0x48e7e0(0x53d)], 'coverUrl': _0x57ad3d, 'playableUrl': _0x39554b[_0x48e7e0(0x4ee)], 'timestamp': Date['now']() }; _0x346f80[_0x48e7e0(0x250)]['push'](_0xc8ea2f), _0x2ef036(_0xc8ea2f, _0x346f80[_0x48e7e0(0x250)][_0x48e7e0(0x6c3)] - 0x1), _0x5d853f(); } catch (_0x3787d5) { _0x48e7e0(0x1a4) !== _0x48e7e0(0x46e) ? (console[_0x48e7e0(0x8d6)]('用户分享音乐失败:', _0x3787d5), _0x3383df(_0x48e7e0(0x797) + _0x3787d5[_0x48e7e0(0x399)])) : _0x426d91[_0x48e7e0(0x580)]({ 'time': _0x56e425, 'text': _0x529f0d }); } } function _0x520efc(_0x47c3c7, _0xf204a0 = 0x78) { const _0x1b102b = _0x54ed15, _0x291915 = _0x3198ec => { const _0x119f90 = _0x321d; if (_0x119f90(0x3f6) !== _0x119f90(0x3f6)) _0x5ab799(_0x119f90(0x914) + _0x2cd960[_0x119f90(0x399)]); else { if (_0x3198ec[_0x119f90(0x6b9)] === _0x119f90(0x619)) return _0x346f80[_0x119f90(0x364)]?.[_0x119f90(0x4e6)] || 'User'; if (_0x3198ec['senderId']) { const _0x5ba065 = _0x5122c0(_0x3198ec['senderId']); return _0x5ba065?.[_0x119f90(0x4e6)] || 'Unknown'; } if (_0x47c3c7?.[_0x119f90(0x62d)] === _0x119f90(0x328)) { const _0x37cbfb = _0x5122c0(_0x47c3c7[_0x119f90(0x717)][0x0]); return _0x37cbfb?.[_0x119f90(0x4e6)] || 'AI'; } return _0x119f90(0x169); } }, _0x13aaf1 = _0x346f80['conversationHistory'][_0x1b102b(0x290)](-_0xf204a0), _0x3cadba = []; for (const _0x516c1c of _0x13aaf1) { if (_0x516c1c['displayUrl']) _0x1b102b(0x426) === _0x1b102b(0x8a1) ? _0x18c20d[_0x1b102b(0x96c)] = _0x4972c6[_0x1b102b(0x4e6)] || _0x1b102b(0x30d) + _0x1f5283[_0x1b102b(0x717)]['length'] + ')' : _0x3cadba[_0x1b102b(0x580)]('[' + _0x291915(_0x516c1c) + _0x1b102b(0x59b) + (_0x516c1c[_0x1b102b(0x2fc)]?.[_0x1b102b(0x2bc)](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x516c1c['image']) { const _0x26c92c = _0x516c1c['content'] ? '\x20' + _0x516c1c[_0x1b102b(0x2fc)] : ''; _0x3cadba['push']('[' + _0x291915(_0x516c1c) + _0x1b102b(0x3dc) + _0x26c92c); } else _0x516c1c['content'] && _0x3cadba[_0x1b102b(0x580)]('[' + _0x291915(_0x516c1c) + ']\x20' + _0x516c1c[_0x1b102b(0x2fc)]); } } return _0x3cadba[_0x1b102b(0x6e6)]('\x0a'); } function _0x3a35c2(_0x304148, _0xbb27dd) { const _0xaff064 = _0x54ed15; if (!_0x304148 || !_0xbb27dd) return null; const _0xcf1b7f = _0xbb27dd[_0xaff064(0x2bc)](/@([^\s:：,，。!?]+)/); if (!_0xcf1b7f) return null; const _0x146420 = _0xcf1b7f[0x1][_0xaff064(0x234)](); for (const _0x1b4b09 of _0x304148[_0xaff064(0x717)]) { const _0x5a9867 = _0x5122c0(_0x1b4b09); if (!_0x5a9867?.[_0xaff064(0x4e6)]) continue; if (_0x5a9867[_0xaff064(0x4e6)][_0xaff064(0x234)]() === _0x146420) return _0x5a9867; if (_0x5a9867['name'][_0xaff064(0x234)]()[_0xaff064(0x859)](_0x146420)) return _0x5a9867; } return null; } function _0x3e00ba(_0x3f9ab9) { const _0x5c63ce = _0x54ed15, _0x47cb3d = _0x3f9ab9[_0x5c63ce(0x87d)]('{'), _0x2dad51 = _0x3f9ab9['lastIndexOf']('}'); if (_0x47cb3d >= 0x0 && _0x2dad51 > _0x47cb3d) return _0x3f9ab9[_0x5c63ce(0x290)](_0x47cb3d, _0x2dad51 + 0x1); return _0x3f9ab9; } function _0x1b7034(_0x48b3a5, _0x35fe40, _0x66ec76) { const _0x70d3aa = _0x54ed15, _0x41c1cb = new Map(_0x35fe40[_0x70d3aa(0x2a0)](_0x5c4e67 => [String(_0x5c4e67['id']), _0x5c4e67])), _0x419265 = _0x3a09ec => String(_0x3a09ec || '')['toLowerCase']()['replace'](/\s+/g, ''), _0xb2a2a0 = new Map(_0x35fe40[_0x70d3aa(0x2a0)](_0x449a95 => [_0x419265(_0x449a95[_0x70d3aa(0x4e6)]), _0x449a95])), _0x45a8a9 = new Set(_0x66ec76), _0x426c2e = { 'events': [] }; for (const _0x2f4973 of _0x48b3a5?.[_0x70d3aa(0x289)] || []) { if (_0x70d3aa(0x6fd) === _0x70d3aa(0x6fd)) { const _0x51018e = _0x2f4973['senderId'] ?? _0x2f4973[_0x70d3aa(0x812)] ?? _0x2f4973['sender_id'] ?? _0x2f4973[_0x70d3aa(0x4a3)] ?? _0x2f4973[_0x70d3aa(0x6b9)] ?? _0x2f4973[_0x70d3aa(0x4e6)]; if (!_0x51018e) continue; let _0x596bb9 = _0x41c1cb[_0x70d3aa(0x3d3)](String(_0x51018e)) || _0xb2a2a0[_0x70d3aa(0x3d3)](_0x419265(_0x51018e)); if (!_0x596bb9) continue; const _0x45b6c1 = (_0x2f4973[_0x70d3aa(0x975)] || _0x2f4973[_0x70d3aa(0x62d)] || _0x70d3aa(0x39f))['toLowerCase'](); if (_0x45b6c1 === _0x70d3aa(0x53c)) { if (_0x70d3aa(0x44e) !== 'URmql') _0x5e2944(), _0x5d7bca(_0x70d3aa(0x4ed), _0x70d3aa(0x632)); else { const _0x5a00eb = (_0x2f4973[_0x70d3aa(0x53c)] ?? _0x2f4973['emoji'] ?? _0x2f4973[_0x70d3aa(0x363)] ?? _0x2f4973['tag'])?.[_0x70d3aa(0x4dd)](); if (_0x5a00eb && _0x45a8a9[_0x70d3aa(0x9b5)](_0x5a00eb)) _0x426c2e['events']['push']({ 'senderId': _0x596bb9['id'], 'kind': 'sticker', 'sticker': _0x5a00eb }); else { if (_0x70d3aa(0x792) !== 'fqVKl') { const _0xc83dee = String(_0x2f4973[_0x70d3aa(0x2fc)] ?? _0x2f4973[_0x70d3aa(0x39f)] ?? '')[_0x70d3aa(0x4dd)]() || _0x70d3aa(0x3d9) + (_0x5a00eb || _0x70d3aa(0x3ce)) + ']'; if (_0xc83dee) _0x426c2e[_0x70d3aa(0x289)][_0x70d3aa(0x580)]({ 'senderId': _0x596bb9['id'], 'kind': _0x70d3aa(0x39f), 'content': _0xc83dee }); } else _0x449944[_0x70d3aa(0x8d6)]('Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', _0x3e5ffa); } } } else { const _0x11af04 = String(_0x2f4973['content'] ?? _0x2f4973['text'] ?? _0x2f4973[_0x70d3aa(0x399)] ?? '')[_0x70d3aa(0x4dd)](); if (_0x11af04) _0x426c2e[_0x70d3aa(0x289)]['push']({ 'senderId': _0x596bb9['id'], 'kind': _0x70d3aa(0x39f), 'content': _0x11af04 }); } } else _0x195d25['style'][_0x70d3aa(0x3b4)] = _0x70d3aa(0x910); } return _0x426c2e; } async function _0x4b8c6a(_0x4bc42c) { const _0x55a75a = _0x54ed15; if ('gdaCR' !== _0x55a75a(0x5f4)) { if (!_0x4bc42c || !Array[_0x55a75a(0x86b)](_0x4bc42c[_0x55a75a(0x289)]) || _0x4bc42c[_0x55a75a(0x289)][_0x55a75a(0x6c3)] === 0x0) return; const _0x4a06e2 = _0x5382c3 => _0x5382c3 + Math[_0x55a75a(0x353)](Math[_0x55a75a(0x93a)]() * 0x190); let _0x5702be = 0x1f4; for (const _0x56427a of _0x4bc42c['events']) { if (_0x55a75a(0x502) !== 'POUqA') { await new Promise(_0x500ac5 => setTimeout(_0x500ac5, _0x4a06e2(_0x5702be))), _0x5702be += 0x2bc; const _0x2d8291 = _0x346f80[_0x55a75a(0x250)]['at'](-0x1)?.['isOffline'] ?? ![]; if (_0x56427a[_0x55a75a(0x975)] === _0x55a75a(0x53c)) { if (_0x55a75a(0x45d) === 'mbHxM') { const _0x13ab71 = _0xfd4511['find'](_0x4e36ed => _0x4e36ed['name'] === _0x56427a[_0x55a75a(0x53c)]); if (_0x13ab71) { if (_0x55a75a(0x631) !== _0x55a75a(0x3e9)) { const _0x4c9bbc = { 'role': 'assistant', 'content': _0x55a75a(0x665) + _0x13ab71['name'] + ']', 'displayUrl': _0x13ab71['url'], 'senderId': _0x56427a[_0x55a75a(0x980)], 'timestamp': Date[_0x55a75a(0x909)](), 'isOffline': _0x2d8291 }; _0x346f80[_0x55a75a(0x250)][_0x55a75a(0x580)](_0x4c9bbc); } else { _0x53ed4c[_0x55a75a(0x8d6)](_0x55a75a(0x36a)); return; } } } else { if (_0x2d6ab2['isAnimatingDiary']) return; const _0x335dac = _0x29a468['diaryCurrentPage']; if (_0x335dac <= 0x0) return; _0x381f3b[_0x55a75a(0x2d4)] = !![]; const _0x6ef4b8 = _0x335dac - 0x1, _0x122038 = _0x2b4d12['getElementById'](_0x55a75a(0x76f) + _0x335dac), _0x23b1ae = _0x1cd7dc[_0x55a75a(0x954)](_0x55a75a(0x76f) + _0x6ef4b8); _0x122038 && _0x23b1ae ? (_0x23b1ae['classList'][_0x55a75a(0x3d0)](_0x55a75a(0x44b)), _0x122038[_0x55a75a(0x78f)]['add']('is-exiting-right'), _0x23b1ae[_0x55a75a(0x78f)][_0x55a75a(0x3d0)](_0x55a75a(0x415)), _0x32b5a6(() => { const _0x477d70 = _0x55a75a; _0x122038[_0x477d70(0x78f)]['remove'](_0x477d70(0x415), 'is-exiting-right'), _0x23b1ae[_0x477d70(0x78f)][_0x477d70(0x309)](_0x477d70(0x44b)), _0x4d9020[_0x477d70(0x713)] = _0x6ef4b8, _0x3c908d(), _0x45844a[_0x477d70(0x2d4)] = ![]; }, 0x2bc)) : _0x5d5f0f['isAnimatingDiary'] = ![]; } } else { if (_0x56427a['kind'] === 'music' && _0x56427a[_0x55a75a(0x9be)] && _0x56427a[_0x55a75a(0x53d)]) { const { songName: _0x4c93c3, artist: _0x381d6e } = _0x56427a, _0x43da41 = { 'role': 'assistant', 'type': 'music', 'content': _0x55a75a(0x8e0) + _0x4c93c3 + _0x55a75a(0x218) + _0x381d6e + ']', 'songName': _0x4c93c3, 'artist': _0x381d6e, 'senderId': _0x56427a[_0x55a75a(0x980)], 'timestamp': Date[_0x55a75a(0x909)](), 'isOffline': _0x2d8291 }; try { const _0x2c0a6f = await _0x1e2b3a(_0x4c93c3, _0x381d6e); _0x43da41[_0x55a75a(0x4ea)] = _0x2c0a6f[_0x55a75a(0x34e)], _0x43da41[_0x55a75a(0x32c)] = _0x2c0a6f['url']; } catch (_0x3ec9c1) { console['error']('群聊音乐搜索失败\x20(' + _0x4c93c3 + '\x20-\x20' + _0x381d6e + '):', _0x3ec9c1), _0x43da41[_0x55a75a(0x4ea)] = null, _0x43da41[_0x55a75a(0x32c)] = null; } _0x346f80[_0x55a75a(0x250)][_0x55a75a(0x580)](_0x43da41); } else { if (_0x56427a['kind'] === _0x55a75a(0x39f)) { const _0x281fbe = _0x4b974b(_0x56427a[_0x55a75a(0x2fc)])[_0x55a75a(0x290)](0x0, 0x3); for (let _0xd62826 = 0x0; _0xd62826 < _0x281fbe[_0x55a75a(0x6c3)]; _0xd62826++) { if (_0xd62826 > 0x0) await new Promise(_0x9dcec0 => setTimeout(_0x9dcec0, _0x4a06e2(0x190))); const _0x55f18f = { 'role': _0x55a75a(0x81d), 'content': _0x281fbe[_0xd62826], 'senderId': _0x56427a['senderId'], 'timestamp': Date[_0x55a75a(0x909)](), 'isOffline': _0x2d8291 }; _0x346f80[_0x55a75a(0x250)][_0x55a75a(0x580)](_0x55f18f); } } } } } else { if (_0x14028d[_0x55a75a(0x62d)] === 'touchstart') _0x9cec3b[_0x55a75a(0x45f)](); _0x2a5370(_0x2f87ca); } } _0x5d853f(), _0x1e3341(); } else _0x5892c1 = _0x13b3d6[_0x55a75a(0x4e6)], _0x33de5d = _0xcb44cc['avatar']; } async function _0x3313e1(_0x576e0a, { force: force = ![], delayMs: delayMs = 0x0 } = {}) { const _0x511aae = _0x54ed15; await new Promise(_0x250dcc => setTimeout(_0x250dcc, 0xa)); if (!_0x346f80[_0x511aae(0x98c)][_0x511aae(0x4b6)] || !_0x346f80[_0x511aae(0x98c)][_0x511aae(0x955)] || !_0x346f80[_0x511aae(0x98c)][_0x511aae(0x71d)]) return _0x3383df(_0x511aae(0x570)), ![]; const _0x446345 = _0x597f5f(); if (!_0x446345 || !_0x576e0a) return ![]; const _0x519ab0 = _0x3d25f9(_0x446345['id']), _0x3bc401 = _0x346f80[_0x511aae(0x250)]['at'](-0x1)?.[_0x511aae(0x6b9)] === _0x511aae(0x619); if (!force && !_0x3bc401) return ![]; const _0x4a112d = _0x346f80['conversationHistory']['at'](-0x1)?.[_0x511aae(0x97f)] ?? ![]; if (delayMs) await new Promise(_0x468a2a => setTimeout(_0x468a2a, delayMs)); _0x4a112d ? document[_0x511aae(0x954)]('galgame-text')['textContent'] = _0x511aae(0x1f0) : _0x511aae(0x43e) === _0x511aae(0x43e) ? _0x394e2e(!![]) : (_0x449e84(![]), _0x1a4e3b[_0x511aae(0x921)]['value'] = ''); let _0xba93ad = ''; const _0x49cc8c = _0x597f5f(); if (_0x49cc8c?.[_0x511aae(0x7b1)]?.[_0x511aae(0x1e7)]) { const _0xbae625 = _0x49cc8c[_0x511aae(0x7b1)], _0x2f1f94 = await _0x89d016(_0xbae625[_0x511aae(0x789)]); if (_0x2f1f94 && _0x2f1f94[_0x511aae(0x74f)]) { const _0x1d6037 = _0x5a85f5(_0x2f1f94[_0x511aae(0x74f)]); if (_0x1d6037['length'] > 0x0) { const _0x21b3ec = _0x1d3c7c[_0x511aae(0x378)]; let _0x5816a7 = -0x1; for (let _0x195758 = 0x0; _0x195758 < _0x1d6037[_0x511aae(0x6c3)]; _0x195758++) { if ('zfHwd' === _0x511aae(0x3a1)) { if (_0x21b3ec >= _0x1d6037[_0x195758][_0x511aae(0x39a)]) _0x5816a7 = _0x195758; else break; } else _0x3afe00[_0x511aae(0x78f)][_0x511aae(0x309)]('show'); } const _0x46f317 = _0x1d6037[_0x511aae(0x2a0)]((_0x4d2b38, _0x1e9de0) => { const _0x4cf66e = _0x511aae, _0xa95769 = _0x1e9de0 === _0x5816a7 ? _0x4cf66e(0x831) : ''; return '' + _0xa95769 + _0x4d2b38[_0x4cf66e(0x39f)]; })[_0x511aae(0x6e6)]('\x0a'); _0xba93ad = (_0x511aae(0x6f2) + _0xbae625['artist'] + '\x20的《' + _0xbae625['songName'] + _0x511aae(0x1f1) + _0x46f317 + _0x511aae(0x5e2))[_0x511aae(0x4dd)](); } } } let _0x1c8e33 = '', _0x332c7f = ''; const _0x1170d5 = _0x346f80[_0x511aae(0x250)][_0x511aae(0x6c3)]; if (_0x1170d5 > 0x1) { if (_0x511aae(0x97a) !== 'rMNWp') { const _0x12a9ed = _0x346f80['conversationHistory'][_0x1170d5 - 0x2], _0x440187 = _0x346f80['conversationHistory'][_0x1170d5 - 0x1]; if (_0x12a9ed[_0x511aae(0x97f)] === ![] && _0x440187[_0x511aae(0x97f)] === !![]) _0x511aae(0x4f8) === _0x511aae(0x4f8) ? _0x332c7f = _0x511aae(0x466) + _0x519ab0[_0x511aae(0x4e6)] + _0x511aae(0x588) : _0xf6fda0(_0x489a20); else _0x12a9ed[_0x511aae(0x97f)] === !![] && _0x440187['isOffline'] === ![] && (_0x332c7f = _0x511aae(0x48b) + _0x519ab0[_0x511aae(0x4e6)] + _0x511aae(0x81e)); } else _0x35d23f(), _0x543575(_0x511aae(0x672), _0x511aae(0x72b)); } if (_0x4a112d) { const _0xdbf355 = _0x511aae(0x8a2); _0x1c8e33 = _0x511aae(0x802) + _0x519ab0[_0x511aae(0x4e6)] + _0x511aae(0x3f5) + _0xdbf355 + _0x511aae(0x6da) + _0x576e0a[_0x511aae(0x4e6)] + _0x511aae(0x92c) + _0xdbf355 + _0x511aae(0x428) + _0xdbf355 + ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20'; } else { if ('eUXds' === _0x511aae(0x379)) { const _0x1ec135 = _0x464620[_0x511aae(0x7c6)](_0x511aae(0x4c7)); if (_0x1ec135 && (_0x1ec135['id'] === _0x511aae(0x682) || _0x1ec135['id'] === _0x511aae(0x512))) _0xace213(); else { const _0x16fb87 = _0x4606f7[_0x511aae(0x6a0)]('.typing-indicator'); _0x16fb87['forEach'](_0x4bdad1 => _0x4bdad1[_0x511aae(0x309)]()); } } else _0x511aae(0x857); } const { omniText: _0x388c5c } = _0x4aa25d(_0x576e0a['id'], _0x446345['id']), _0x533f77 = _0x5e45d9(), _0xa2f343 = _0xb8d7f(_0x576e0a['id']), _0x4d03b9 = typeof _0x251a3f === 'string' ? _0x251a3f[_0x511aae(0x6cf)]('{charName}', _0x576e0a['name'])[_0x511aae(0x6cf)](_0x511aae(0x288), _0x519ab0[_0x511aae(0x4e6)] || '用户') : '', _0x260398 = _0xfd4511[_0x511aae(0x2a0)](_0x5f253a => _0x5f253a[_0x511aae(0x4e6)])[_0x511aae(0x6e6)](',\x20'); let _0x155ce1 = ''; if (_0x576e0a[_0x511aae(0x925)] && _0x576e0a[_0x511aae(0x925)][_0x511aae(0x6c3)] > 0x0) { const _0x308428 = _0x576e0a[_0x511aae(0x925)][_0x511aae(0x2a0)](_0x4ce284 => _0x346f80[_0x511aae(0x814)]['find'](_0x21afba => _0x21afba['id'] === _0x4ce284))[_0x511aae(0x6e8)](Boolean)[_0x511aae(0x2a0)](_0x6a83b1 => '\x0a\x0a##\x20世界书条目:\x20' + _0x6a83b1[_0x511aae(0x4e6)] + '\x0a' + _0x6a83b1[_0x511aae(0x2fc)])[_0x511aae(0x6e6)](''); if (_0x308428) _0x155ce1 = _0x511aae(0x922) + _0x308428; } const _0x49027f = _0x519ab0[_0x511aae(0x1a5)] ? '\x0a\x0a#\x20关于对话者“' + _0x519ab0['name'] + _0x511aae(0x56b) + _0x519ab0[_0x511aae(0x1a5)] : ''; let _0x8fd9a2 = ''; const _0x4a1356 = new Date(), _0xaa6092 = _0x33d9a7(_0x576e0a['id']); _0x8fd9a2 = _0x511aae(0x734), _0x8fd9a2 += _0x511aae(0x350) + _0x4a1356[_0x511aae(0x6de)]('zh-CN', { 'dateStyle': _0x511aae(0x7fb), 'timeStyle': _0x511aae(0x618) }) + '\x0a'; if (_0xaa6092) { if (_0x511aae(0x5ed) !== _0x511aae(0x5ed)) _0x14568c[_0x511aae(0x2ce)] = _0x47ae01[_0x511aae(0x678)]; else { const _0x1da975 = new Date(_0xaa6092[_0x511aae(0x83c)]), _0x6b8047 = _0x1afdb6(_0x1da975); _0x8fd9a2 += '-\x20**你们最后一次互动是在**:\x20' + _0x6b8047 + '\x0a'; const _0x2567b9 = _0x4a1356['toDateString'](), _0x5726ce = _0x1da975[_0x511aae(0x7e3)](), _0x15f93f = new Date(); _0x15f93f[_0x511aae(0x8ff)](_0x4a1356['getDate']() - 0x1); const _0x496fef = _0x15f93f[_0x511aae(0x7e3)](); if (_0x2567b9 === _0x5726ce) { const _0x5ad7c8 = (_0x4a1356 - _0x1da975) / (0x3e8 * 0x3c); _0x5ad7c8 < 0x3c ? _0x8fd9a2 += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a' : _0x8fd9a2 += _0x511aae(0x22f) + Math[_0x511aae(0x743)](_0x5ad7c8 / 0x3c) + _0x511aae(0x170); } else { if (_0x496fef === _0x5726ce) _0x511aae(0x49a) !== _0x511aae(0x6cd) ? _0x8fd9a2 += _0x511aae(0x75f) : _0x35e8ba['style'][_0x511aae(0x5d2)] = _0x511aae(0x910); else { if (_0x511aae(0x932) !== _0x511aae(0x932)) _0xd539fb = [..._0x3fbb7e, ..._0x5e77f6]; else { const _0x59e738 = Math[_0x511aae(0x743)]((_0x4a1356 - _0x1da975) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x8fd9a2 += '-\x20**对话状态提示**:\x20你们已经有\x20' + _0x59e738 + _0x511aae(0x995); } } } } } else _0x511aae(0x32a) !== _0x511aae(0x32a) ? _0x80f715(_0x511aae(0x29e)) : _0x8fd9a2 += _0x511aae(0x9d5); const _0xedcde1 = ('\x0a' + _0x1c8e33 + '\x0a你只扮演【' + _0x576e0a['name'] + _0x511aae(0x1d4) + _0x576e0a[_0x511aae(0x4e6)] + _0x511aae(0x352) + _0x576e0a[_0x511aae(0x4e6)] + _0x511aae(0x244) + _0x260398 + ']。严禁使用列表之外的任何表情名。\x0a' + _0x4d03b9 + '\x0a')[_0x511aae(0x4dd)](), _0x4bfbef = [{ 'role': _0x511aae(0x9ca), 'content': _0xedcde1 }], _0x1d5c09 = (_0x511aae(0x748) + (_0x576e0a[_0x511aae(0x1a5)] || _0x511aae(0x9ac)) + '\x0a' + _0x49027f + '\x20\x0a' + _0x388c5c + '\x0a' + _0x533f77 + '\x0a' + _0xa2f343 + _0x511aae(0x4b4) + _0xba93ad + '\x0a' + _0x8fd9a2 + '\x0a' + _0x155ce1 + '\x0a')['trim'](); _0x1d5c09[_0x511aae(0x330)](/#.*|\s/g, '') && (_0x4bfbef['push']({ 'role': _0x511aae(0x619), 'content': _0x1d5c09 }), _0x4bfbef[_0x511aae(0x580)]({ 'role': _0x511aae(0x81d), 'content': '好的，我记住了这些人设和历史。现在我们开始对话。' })); const _0x1ec1b1 = _0x346f80[_0x511aae(0x4fe)]?.[_0x511aae(0x9b1)] ?? 0x64, _0x2926c6 = _0x346f80['conversationHistory']['slice'](-_0x1ec1b1); for (const _0x58db3b of _0x2926c6) { const _0x2d74ee = _0x58db3b[_0x511aae(0x6b9)] === 'ai' || _0x58db3b[_0x511aae(0x6b9)] === _0x511aae(0x81d) ? _0x511aae(0x81d) : 'user'; let _0x1a5099 = { 'role': _0x2d74ee, 'content': _0x58db3b['content'] }, _0x493a94 = !!_0x58db3b[_0x511aae(0x2fc)]; if (_0x58db3b[_0x511aae(0x1ff)] && _0x58db3b[_0x511aae(0x2fc)][_0x511aae(0x84e)]('表情')) { const _0x1d79cb = _0x58db3b['content'][_0x511aae(0x2bc)](/：(.*?)]$/); _0x1a5099[_0x511aae(0x2fc)] = _0x511aae(0x3d9) + (_0x1d79cb ? _0x1d79cb[0x1] : _0x511aae(0x3ce)) + ']', _0x4bfbef[_0x511aae(0x580)](_0x1a5099); } else { if ('EBEav' === _0x511aae(0x79c)) return [_0x216141]; else { let _0xe6a366 = null; if (_0x58db3b['image']) _0x511aae(0x62a) === 'xQARv' ? _0xe6a366 = _0x58db3b[_0x511aae(0x85e)] : (_0x3e20f7(), _0x54deb3(_0x511aae(0x4ed), _0x511aae(0x72b))); else { if (_0x58db3b[_0x511aae(0x1e4)]) { if (_0x511aae(0x7ec) === _0x511aae(0x947)) _0x15a479[_0x511aae(0x8d6)]('净化好友圈时出错，真是的。', _0x2723e3); else try { if ('UKQNZ' === 'UKQNZ') { const _0x265743 = await _0x4f16ca(_0x58db3b[_0x511aae(0x1e4)]); _0x265743 && (_0xe6a366 = await _0x58722e(_0x265743)); } else _0x5266cf *= _0x4fc97e / _0x3a0369, _0x20f956 = _0x37c7f9; } catch (_0x1432f6) { console[_0x511aae(0x8d6)]('在准备API数据时，从IndexedDB读取图片失败:', _0x1432f6); } } } _0xe6a366 && (_0x1a5099['image'] = _0xe6a366, _0x493a94 = !![]), _0x493a94 && (_0x511aae(0x606) !== _0x511aae(0x606) ? (_0x57659c[_0x511aae(0x7d9)] = _0x2c5f6d['createObjectURL'](_0x41f7b1), _0x25848a['style'][_0x511aae(0x3b4)] = _0x511aae(0x810)) : _0x4bfbef[_0x511aae(0x580)](_0x1a5099)); } } } try { if ('GescM' !== 'KxfvB') { const _0xd2b7d2 = await _0x555f32(_0x4bfbef); if (!_0xd2b7d2) return ![]; if (_0x4a112d) { if (_0x511aae(0x3d6) !== 'aULKX') try { let _0x193852 = _0xd2b7d2[_0x511aae(0x4dd)](); const _0x50d32d = _0x193852[_0x511aae(0x2bc)](/(\[[\s\S]*\])/); _0x50d32d && (_0x193852 = _0x50d32d[0x1]); const _0xefd1bc = JSON[_0x511aae(0x781)](_0x193852); if (Array[_0x511aae(0x86b)](_0xefd1bc)) { _0x346f80[_0x511aae(0x6e4)] = _0xefd1bc, _0x346f80[_0x511aae(0x2c7)][_0x576e0a['id']] = [..._0xefd1bc], _0x3c519a(); const _0x401579 = _0xefd1bc[_0x511aae(0x2a0)](_0x2f24fd => _0x2f24fd['speaker'] === _0x511aae(0x47f) ? _0x2f24fd['line'] : _0x2f24fd['speaker'] + ':\x20' + _0x2f24fd[_0x511aae(0x493)])['join']('\x0a\x0a'); _0x346f80[_0x511aae(0x250)]['push']({ 'role': 'assistant', 'senderId': _0x576e0a['id'], 'timestamp': Date['now'](), 'isOffline': !![], 'content': _0x401579 }); } } catch (_0x528b2c) { console[_0x511aae(0x8d6)](_0x511aae(0x2b0), _0x528b2c, _0x511aae(0x4c1), _0xd2b7d2), _0x346f80[_0x511aae(0x250)]['push']({ 'role': _0x511aae(0x81d), 'senderId': _0x576e0a['id'], 'timestamp': Date['now'](), 'isOffline': !![], 'content': _0x511aae(0x314) + _0xd2b7d2 + ']' }); } else return; } else { if (_0x511aae(0x47e) === 'yMiMm') _0x469623[_0x511aae(0x8d6)](_0x511aae(0x355), _0x50447d), _0x26a017(_0x511aae(0x18d) + _0x5bba34[_0x511aae(0x399)]); else { const _0x40c43a = _0x4444ee(_0xd2b7d2), _0x16fcb9 = _0x40c43a[_0x511aae(0x2a0)](_0x234e00 => { const _0x711356 = _0x511aae; if (_0x711356(0x841) !== _0x711356(0x841)) { const _0x1e9e8d = _0x265659(_0x3adba5[_0x711356(0x86c)][_0x711356(0x77b)], 0xa); _0x4f18c2(_0x1e9e8d); } else { const _0x41cdcb = _0x234e00[_0x711356(0x4dd)](), _0x549979 = _0x41cdcb[_0x711356(0x2bc)](/^\[sticker:(.*?)\]$/), _0x568ec3 = _0x41cdcb['match'](/^\[transfer:([\d.]+)\|(.*?)\]$/), _0x1f2bc8 = _0x41cdcb[_0x711356(0x2bc)](/^\[music:(.*?)\|(.*?)\]$/); if (_0x1f2bc8) return { 'type': _0x711356(0x632), 'songName': _0x1f2bc8[0x1]['trim'](), 'artist': _0x1f2bc8[0x2][_0x711356(0x4dd)]() }; else { if (_0x549979) { if (_0x711356(0x78c) !== 'QhMBC') { _0x5f5a08(_0x711356(0x4c5)); return; } else return { 'type': _0x711356(0x53c), 'name': _0x549979[0x1]['trim']() }; } else { if (_0x568ec3) { const _0x1b9d1c = parseFloat(_0x568ec3[0x1]), _0x478668 = _0x568ec3[0x2][_0x711356(0x4dd)](), _0x4bc356 = _0x3d25f9(_0x346f80[_0x711356(0x509)]); let _0x350774 = null; if (_0x478668 === _0x4bc356['name']) _0x350774 = _0x4bc356['id']; else { if (_0x711356(0x21c) !== _0x711356(0x898)) { const _0x241c21 = _0x597f5f(); if (_0x241c21[_0x711356(0x62d)] === _0x711356(0x661)) { const _0x368a11 = _0x346f80[_0x711356(0x499)]['find'](_0x24b890 => _0x241c21[_0x711356(0x717)][_0x711356(0x84e)](_0x24b890['id']) && _0x24b890[_0x711356(0x4e6)] === _0x478668); if (_0x368a11) _0x350774 = _0x368a11['id']; } } else { _0x37b86a('请先输入\x20API\x20接口地址和密钥。'); return; } } if (_0x350774) return { 'type': _0x711356(0x37f), 'amount': _0x1b9d1c, 'recipientId': _0x350774, 'senderId': _0x576e0a['id'] }; else return { 'type': 'text', 'content': '(想转账给“' + _0x478668 + _0x711356(0x77a) }; } else { if (_0x41cdcb) { if (_0x711356(0x1cd) === 'OCaID') return { 'type': _0x711356(0x39f), 'content': _0x41cdcb }; else _0x2a09d3(_0x3fe9ef['id']); } } } } return null; } })[_0x511aae(0x6e8)](Boolean), _0x3bb2ea = async _0x18ae80 => { const _0xceb47a = _0x511aae, _0x1e1fa0 = { 'role': _0xceb47a(0x81d), 'senderId': _0x576e0a['id'], 'timestamp': Date[_0xceb47a(0x909)](), 'isOffline': _0x4a112d }; if (_0x18ae80[_0xceb47a(0x62d)] === _0xceb47a(0x632)) { if (_0xceb47a(0x8a4) === _0xceb47a(0x66c)) _0x2b7c6a[_0xceb47a(0x94f)][_0xceb47a(0x3b4)] = _0xceb47a(0x810); else { const { songName: _0x4aac77, artist: _0x4aa880 } = _0x18ae80; _0x1e1fa0[_0xceb47a(0x62d)] = _0xceb47a(0x632), _0x1e1fa0[_0xceb47a(0x2fc)] = _0xceb47a(0x8e0) + _0x4aac77 + _0xceb47a(0x218) + _0x4aa880 + ']'; try { if (_0xceb47a(0x2b2) === _0xceb47a(0x480)) { const _0x37eb92 = _0x19e103[_0xceb47a(0x234)](); if (_0x3a6fd7[_0xceb47a(0x554)](_0x5b698d => _0x37eb92[_0xceb47a(0x859)](_0x5b698d))) { const _0x4b213a = _0x3de840[_0x2b2166]; if (typeof _0x4b213a === _0xceb47a(0x17c)) _0x15b528[_0xceb47a(0x580)](_0x4b213a); if (_0x26caa5[_0xceb47a(0x86b)](_0x4b213a)) _0x4b213a[_0xceb47a(0x927)](_0x3d4da4 => { const _0x213c98 = _0xceb47a; if (typeof _0x3d4da4 === _0x213c98(0x17c)) _0x5016fe[_0x213c98(0x580)](_0x3d4da4); }); } } else { const _0x41d810 = await _0x1e2b3a(_0x4aac77, _0x4aa880); let _0x372d4c = null; if (_0x41d810[_0xceb47a(0x34e)]) { const _0x389747 = await _0x407d73(_0x41d810[_0xceb47a(0x34e)]); _0x372d4c = _0xceb47a(0x576) + Date[_0xceb47a(0x909)]() + '_' + Math[_0xceb47a(0x93a)](), await _0x336559(_0x372d4c, _0x389747); } Object[_0xceb47a(0x8ad)](_0x1e1fa0, { 'songName': _0x4aac77, 'artist': _0x4aa880, 'coverId': _0x372d4c, 'playableUrl': _0x41d810[_0xceb47a(0x4ee)] }); } } catch (_0xe5c1fb) { if (_0xceb47a(0x7b3) === _0xceb47a(0x76a)) { const _0x4eab83 = { 'id': 'wb_' + _0x4d1d92[_0xceb47a(0x909)](), 'name': _0xd1e1ec, 'content': _0x2ba590 }; _0x3409f1[_0xceb47a(0x814)]['push'](_0x4eab83); } else Object[_0xceb47a(0x8ad)](_0x1e1fa0, { 'songName': _0x4aac77, 'artist': _0x4aa880, 'coverId': null, 'playableUrl': null }); } } } else { if (_0x18ae80[_0xceb47a(0x62d)] === _0xceb47a(0x53c)) { const _0x31fd9e = _0xfd4511[_0xceb47a(0x247)](_0xb78499 => _0xb78499[_0xceb47a(0x4e6)] === _0x18ae80['name']); if (_0x31fd9e) Object['assign'](_0x1e1fa0, { 'content': _0xceb47a(0x665) + _0x31fd9e[_0xceb47a(0x4e6)] + ']', 'displayUrl': _0x31fd9e[_0xceb47a(0x4ee)] }); else _0x1e1fa0['content'] = _0xceb47a(0x3d9) + _0x18ae80[_0xceb47a(0x4e6)] + ']'; } else { if (_0x18ae80['type'] === _0xceb47a(0x37f)) { if ('xqkxC' === _0xceb47a(0x2b4)) _0x304d45 = _0xceb47a(0x533) + _0x5853b3['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x10ec49[_0xceb47a(0x4ea)] || _0x422309) + _0xceb47a(0x56c) + _0x19a120['songName'] + _0xceb47a(0x906) + _0x2acbd8[_0xceb47a(0x53d)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>' + (_0x34bd93[_0xceb47a(0x32c)] ? '▶' : '⚠') + _0xceb47a(0x88e); else { const _0x210f92 = _0x18ae80[_0xceb47a(0x400)] === _0x3d25f9(_0x346f80[_0xceb47a(0x509)])['id'] ? _0x3d25f9(_0x346f80[_0xceb47a(0x509)]) : _0x5122c0(_0x18ae80[_0xceb47a(0x400)]); Object[_0xceb47a(0x8ad)](_0x1e1fa0, { 'type': _0xceb47a(0x37f), 'amount': _0x18ae80['amount'], 'recipientId': _0x18ae80[_0xceb47a(0x400)], 'content': _0xceb47a(0x4b9) + (_0x210f92?.[_0xceb47a(0x4e6)] || '未知') + '\x20转账\x20' + _0x18ae80[_0xceb47a(0x1b3)] + ']' }); } } else { const _0xb291f3 = _0x535474(_0x18ae80['content']); Object[_0xceb47a(0x8ad)](_0x1e1fa0, { 'content': _0xb291f3[_0xceb47a(0x2fc)], 'quotedMessage': _0xb291f3[_0xceb47a(0x2da)] }); } } } return _0x1e1fa0; }, _0xf39c43 = await Promise[_0x511aae(0x5b9)](_0x16fcb9[_0x511aae(0x2a0)](_0x3bb2ea)); for (const _0x5abb99 of _0xf39c43) { (_0x5abb99['content'] || _0x5abb99[_0x511aae(0x1ff)] || _0x5abb99[_0x511aae(0x62d)] === _0x511aae(0x632)) && (await new Promise(_0x1e8d7c => setTimeout(_0x1e8d7c, 0x12c + Math[_0x511aae(0x93a)]() * 0x190)), _0x346f80[_0x511aae(0x250)][_0x511aae(0x580)](_0x5abb99), _0x1e3341()); } } } return _0x5d853f(), _0x1e3341(), !![]; } else _0x5b2308(_0x23c7d0['id']); } catch (_0x34f580) { if (_0x34f580['name'] !== 'AbortError') { console[_0x511aae(0x8d6)](_0x511aae(0x235), _0x34f580); const _0x226cda = { 'role': _0x511aae(0x81d), 'content': '错误:\x20' + _0x34f580[_0x511aae(0x399)], 'senderId': _0x576e0a['id'], 'isOffline': _0x4a112d }; _0x346f80['conversationHistory']['push'](_0x226cda), _0x1e3341(); } return ![]; } finally { if (_0x511aae(0x658) === _0x511aae(0x5fa)) { const _0x187cb4 = _0x57f1e7 === _0x369b37 ? _0x511aae(0x831) : ''; return '' + _0x187cb4 + _0x3d1075[_0x511aae(0x39f)]; } else _0x394e2e(![]); } } async function _0x444091() { const _0x5a7c47 = _0x54ed15; if (_0x5a7c47(0x397) === 'DpvGu') { const _0x52b65b = _0x597f5f(); if (!_0x52b65b || _0x52b65b[_0x5a7c47(0x62d)] !== _0x5a7c47(0x328)) { if (_0x5a7c47(0x28e) !== 'npohC') { _0x3383df('哼，只有私聊才能进行总结，群聊那么乱怎么记！'); return; } else _0x51af8a = _0x5dbbaa[_0x5a7c47(0x2f5)][0x0]; } if (_0x346f80['isGenerating']) { if ('BClFi' === _0x5a7c47(0x5ac)) { _0x3383df('我正在说话呢，别打岔！'); return; } else _0x4b54f2['getElementById'](_0x5a7c47(0x4cb))['style']['setProperty'](_0x5a7c47(0x9c6), _0x5a7c47(0x910)); } const _0x565833 = await _0x57c3ed(_0x5a7c47(0x599)); if (!_0x565833) return; _0x6cd89d(!![], _0x5a7c47(0x773)), _0x460947['value'] = '', _0x3f451c[_0x5a7c47(0x78f)]['add'](_0x5a7c47(0x373)), _0x346f80[_0x5a7c47(0x3d2)] = !![]; try { const _0x264b5c = _0x5122c0(_0x52b65b[_0x5a7c47(0x717)][0x0]), _0x1ad5f5 = _0x3d25f9(_0x52b65b['id']), _0x2b6e88 = _0x24a394(_0x52b65b['id']); if (_0x2b6e88[_0x5a7c47(0x6c3)] === 0x0) { if (_0x5a7c47(0x960) !== _0x5a7c47(0x960)) _0x3cc5bd['activeListenSession'] = null, _0x238a00(), _0x1b9b55('同步已断开。'), _0x1b5ef4(), _0xbb9d4e[_0x5a7c47(0x78f)][_0x5a7c47(0x309)](_0x5a7c47(0x373)), _0x4b3346(() => _0x5a483e[_0x5a7c47(0x94f)][_0x5a7c47(0x3b4)] = 'none', 0x12c); else { _0x460947['value'] = _0x5a7c47(0x1ac); return; } } const _0x43ba7c = _0x2b6e88[_0x5a7c47(0x2a0)](_0x25280c => { const _0x1b5fa8 = _0x5a7c47, _0x3382c1 = new Date(_0x25280c[_0x1b5fa8(0x83c)]), _0x4d44f3 = _0x3382c1[_0x1b5fa8(0x85b)]() + '-' + String(_0x3382c1[_0x1b5fa8(0x89d)]() + 0x1)[_0x1b5fa8(0x990)](0x2, '0') + '-' + String(_0x3382c1[_0x1b5fa8(0x74d)]())['padStart'](0x2, '0'), _0x2fd8b6 = String(_0x3382c1['getHours']())[_0x1b5fa8(0x990)](0x2, '0') + ':' + String(_0x3382c1[_0x1b5fa8(0x783)]())[_0x1b5fa8(0x990)](0x2, '0'); let _0x23ee92 = '未知'; _0x25280c[_0x1b5fa8(0x6b9)] === _0x1b5fa8(0x619) ? _0x23ee92 = _0x1ad5f5[_0x1b5fa8(0x4e6)] : _0x23ee92 = _0x264b5c[_0x1b5fa8(0x4e6)]; let _0x32b168 = _0x25280c[_0x1b5fa8(0x2fc)]; if (_0x25280c[_0x1b5fa8(0x1ff)]) _0x32b168 = _0x1b5fa8(0x90f); if (_0x25280c[_0x1b5fa8(0x1e4)]) _0x32b168 = _0x1b5fa8(0x9cc); return '[' + _0x4d44f3 + '\x20' + _0x2fd8b6 + _0x1b5fa8(0x4bc) + _0x23ee92 + _0x1b5fa8(0x335) + _0x32b168; })[_0x5a7c47(0x6e6)]('\x0a'), _0x112e15 = _0x57c586[_0x5a7c47(0x330)](/{charName}/g, _0x264b5c[_0x5a7c47(0x4e6)])[_0x5a7c47(0x330)](/{userName}/g, _0x1ad5f5[_0x5a7c47(0x4e6)]), _0x1f47df = [{ 'role': 'system', 'content': _0x112e15 }, { 'role': _0x5a7c47(0x619), 'content': _0x43ba7c }], _0x4c3ba5 = await _0x555f32(_0x1f47df); _0x460947[_0x5a7c47(0x908)] = _0x4c3ba5 || _0x5a7c47(0x514), _0x460947[_0x5a7c47(0x2ce)] = 0x0; } catch (_0x135b88) { if (_0x5a7c47(0x2df) !== _0x5a7c47(0x232)) console[_0x5a7c47(0x8d6)](_0x5a7c47(0x651), _0x135b88), _0x460947[_0x5a7c47(0x908)] = '#\x20发生错误：\x0a' + _0x135b88['message']; else { const { omniText: _0x5ef855 } = _0x3c39a4(_0x4d89a5['id'], null), _0x428e1b = _0x476342(_0x148e50['id']), _0x4e8dcd = _0x455649[_0x5a7c47(0x925)] && _0x54a7d3[_0x5a7c47(0x925)][_0x5a7c47(0x6c3)] > 0x0 ? _0x5a7c47(0x5ee) + _0x12d8fa['name'] + _0x5a7c47(0x558) + _0x3f4f2d[_0x5a7c47(0x925)]['map'](_0xdfed94 => _0x3ad129['worldBooks'][_0x5a7c47(0x247)](_0x1e3ebe => _0x1e3ebe['id'] === _0xdfed94))[_0x5a7c47(0x6e8)](_0x3edd41)[_0x5a7c47(0x2a0)](_0x24d1c0 => _0x5a7c47(0x700) + _0x24d1c0[_0x5a7c47(0x4e6)] + '\x0a' + _0x24d1c0[_0x5a7c47(0x2fc)])[_0x5a7c47(0x6e6)]('') : ''; return '-\x20姓名:\x20' + _0x244fd5[_0x5a7c47(0x4e6)] + ',\x20ID:\x20' + _0x2627b1['id'] + _0x5a7c47(0x782) + _0xb5c7f[_0x5a7c47(0x1a5)] + _0x5a7c47(0x6b0) + _0x5ef855 + '\x0a' + _0x428e1b + '\x0a' + _0x4e8dcd; } } finally { _0x6cd89d(![]), _0x346f80[_0x5a7c47(0x3d2)] = ![]; } } else _0x49ec3e['appendChild'](_0x4ef08c); } async function _0x2a6a82() { const _0x27280b = _0x54ed15; console[_0x27280b(0x7e5)](_0x27280b(0x37a)); if (!_0x346f80[_0x27280b(0x98c)][_0x27280b(0x4b6)] || !_0x346f80[_0x27280b(0x98c)][_0x27280b(0x955)] || !_0x346f80[_0x27280b(0x98c)][_0x27280b(0x71d)]) { if (_0x27280b(0x34d) === 'tqJnA') { _0x3383df(_0x27280b(0x570)); return; } else return { 'type': _0x27280b(0x39f), 'content': _0x1f9d86 }; } const _0x1b6d70 = _0x346f80[_0x27280b(0x250)]['at'](-0x1)?.[_0x27280b(0x6b9)] === _0x27280b(0x619); if (!_0x1b6d70 || _0x346f80['isGenerating']) return; const _0x72b51a = _0x597f5f(); if (!_0x72b51a) return; _0x346f80[_0x27280b(0x3d2)] = !![], _0x394e2e(!![]); try { if ('VTBPP' === _0x27280b(0x744)) _0x3a6160(_0x27280b(0x316), _0x27280b(0x5d0)); else { if (_0x72b51a[_0x27280b(0x62d)] === _0x27280b(0x328)) { const _0x519175 = _0x5122c0(_0x72b51a[_0x27280b(0x717)][0x0]); console[_0x27280b(0x7e5)](_0x27280b(0x8ea)); if (_0x519175) await _0x3313e1(_0x519175, { 'force': !![] }); } else { const _0x1a19b9 = await _0x4062d1(); if (_0x1a19b9 && _0x1a19b9['events']?.['length']) await _0x4b8c6a(_0x1a19b9); else { console[_0x27280b(0x749)](_0x27280b(0x17d)); const _0x2ea460 = _0x72b51a[_0x27280b(0x717)][_0x27280b(0x2a0)](_0x5122c0)['filter'](Boolean); if (!_0x2ea460[_0x27280b(0x6c3)]) return; let _0x520965 = 0x0; for (const _0x1a5c59 of _0x2ea460) { 'ujAjO' !== _0x27280b(0x255) ? (_0x3313e1(_0x1a5c59, { 'force': !![], 'delayMs': _0x520965 }), _0x520965 += 0x1f4) : (_0x14972d[_0x27280b(0x595)] = _0xc70fa, _0x22b889[_0x27280b(0x41e)] = _0x213380 => _0x47e958(_0x213380[_0x27280b(0x921)]['error'])); } } } } } catch (_0x3ef977) { _0x27280b(0x90d) === _0x27280b(0x6c7) ? _0x443735[_0x27280b(0x8d6)](_0x27280b(0x3a8) + _0x3b418f['id'], _0x5e61f6) : _0x3ef977[_0x27280b(0x4e6)] !== _0x27280b(0x8ee) && (console[_0x27280b(0x8d6)]('获取AI响应失败:', _0x3ef977), _0x2ef036({ 'role': _0x27280b(0x81d), 'content': _0x27280b(0x914) + _0x3ef977[_0x27280b(0x399)] }, _0x346f80[_0x27280b(0x250)][_0x27280b(0x6c3)] - 0x1)); } finally { _0x346f80['isGenerating'] = ![], _0x394e2e(![]); } } function _0x514577(_0x483562, _0x38a5e2) { const _0x32c1ab = _0x54ed15; if (_0x32c1ab(0x2af) !== _0x32c1ab(0x28d)) { const _0x1d2a05 = _0x38a5e2[_0x32c1ab(0x234)](), _0x3e3076 = _0x483562[_0x32c1ab(0x234)](); if (_0x1d2a05[_0x32c1ab(0x859)]('claude')) return _0x32c1ab(0x301); if (_0x3e3076[_0x32c1ab(0x84e)]('anthropic.com')) return _0x32c1ab(0x301); if (_0x3e3076[_0x32c1ab(0x84e)]('googleapis.com')) return 'gemini'; if (_0x1d2a05[_0x32c1ab(0x859)](_0x32c1ab(0x225))) return _0x32c1ab(0x225); return _0x32c1ab(0x9c2); } else _0x508bec += _0x32c1ab(0x26a) + _0x1bf15b[_0x32c1ab(0x9be)] + _0x32c1ab(0x218) + _0x26217e[_0x32c1ab(0x53d)] + ']'; } async function _0x555f32(_0x10e49b, _0x2cd106 = {}) { const _0x30b934 = _0x54ed15; if (_0x346f80[_0x30b934(0x5f7)]) { if (_0x30b934(0x9a5) === _0x30b934(0x1ae)) { _0x49bf0f[_0x30b934(0x6a9)] = _0x30b934(0x69a); return; } else _0x346f80[_0x30b934(0x5f7)][_0x30b934(0x93c)](_0x30b934(0x407)); } _0x346f80['currentAbortController'] = new AbortController(); const _0xa31343 = _0x346f80[_0x30b934(0x5f7)]['signal'], { endpoint: _0x3020ce, key: _0x4ed557, model: _0x25f08e } = _0x346f80[_0x30b934(0x98c)], _0x19c2d1 = !!_0x2cd106['json'], _0x33c05e = _0x514577(_0x3020ce, _0x25f08e); console['log'](_0x30b934(0x563) + _0x33c05e); let _0x6f45dc = ''; try { switch (_0x33c05e) { case _0x30b934(0x301): { const _0x3c5fba = _0x14faa7(_0x4ed557), _0x106d1e = _0x10e49b[_0x30b934(0x247)](_0x34c803 => _0x34c803[_0x30b934(0x6b9)] === 'system')?.[_0x30b934(0x2fc)] || '', _0x571f28 = _0x10e49b[_0x30b934(0x6e8)](_0x8a0cd9 => _0x8a0cd9[_0x30b934(0x6b9)] !== _0x30b934(0x9ca)), _0x31cfe4 = { 'model': _0x25f08e, 'system': _0x106d1e, 'messages': _0x571f28[_0x30b934(0x2a0)](_0x3ffb21 => ({ 'role': _0x3ffb21[_0x30b934(0x6b9)], 'content': [{ 'type': _0x30b934(0x39f), 'text': _0x3ffb21[_0x30b934(0x2fc)] }] })), 'max_tokens': 0x1000 }, _0x5e7829 = await fetch(_0x3020ce, { 'method': _0x30b934(0x19e), 'headers': { 'Content-Type': _0x30b934(0x6dc), 'x-api-key': _0x3c5fba, 'anthropic-version': '2023-06-01' }, 'body': JSON[_0x30b934(0x714)](_0x31cfe4), 'signal': _0xa31343 }); if (!_0x5e7829['ok']) { const _0x2b6c6a = await _0x5e7829[_0x30b934(0x55f)]()[_0x30b934(0x958)](() => ({})); throw new Error('Claude\x20API\x20错误:\x20' + _0x5e7829['status'] + _0x30b934(0x218) + (_0x2b6c6a[_0x30b934(0x8d6)]?.['message'] || _0x5e7829[_0x30b934(0x572)])); } const _0x2da306 = await _0x5e7829[_0x30b934(0x55f)](); _0x6f45dc = _0x2da306[_0x30b934(0x2fc)]?.[0x0]?.[_0x30b934(0x39f)] || ''; break; } case 'gemini': { const _0x3881cf = _0x14faa7(_0x4ed557), _0x43a6aa = _0x3020ce['includes']('generativelace.googleapis.com'), _0x245eed = _0x3a4856 => { const _0xf91bcf = _0x30b934; if (_0xf91bcf(0x1d5) === _0xf91bcf(0x1d5)) { const _0x52f582 = []; if (_0x3a4856[_0xf91bcf(0x2fc)]) _0x52f582[_0xf91bcf(0x580)]({ 'text': _0x3a4856[_0xf91bcf(0x2fc)] }); if (_0x3a4856[_0xf91bcf(0x85e)]) { if ('utSAt' === _0xf91bcf(0x611)) _0x208af5['diaryPressTimer'] = _0x48e1b3(() => { const _0x16ddc2 = _0xf91bcf; if (_0x30cd30[_0x16ddc2(0x62d)] === _0x16ddc2(0x61d)) _0x46bb66['preventDefault'](); _0x412405(_0x42a8c9(_0x7111b6, 0xa), _0x4a7af8); }, 0x320); else { const _0x16d71b = _0x3a4856['image'][_0xf91bcf(0x1a7)](',')[0x1], _0x17acae = _0x3a4856[_0xf91bcf(0x85e)][_0xf91bcf(0x8f0)](_0x3a4856[_0xf91bcf(0x85e)][_0xf91bcf(0x87d)](':') + 0x1, _0x3a4856[_0xf91bcf(0x85e)][_0xf91bcf(0x87d)](';')) || _0xf91bcf(0x892); _0x52f582['push']({ 'inline_data': { 'mime_type': _0x17acae, 'data': _0x16d71b } }); } } return _0x52f582; } else { let _0x31c074 = ''; if (_0x547822['likes'] && _0x22abe2[_0xf91bcf(0x621)]['length'] > 0x0) { const _0x5d9cbb = _0x24062d[_0xf91bcf(0x621)]['map'](_0x3028b6 => _0x197730(_0x3028b6)?.['name'] || '未知')['join']('、'), _0xc85089 = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>'; _0x31c074 = '<div\x20class=\x22post-likes\x22>' + _0xc85089 + '\x20' + _0x5d9cbb + '</div>'; } let _0x2e4360 = ''; if (_0x50d3ba[_0xf91bcf(0x5fb)] && _0x11b1e8['comments'][_0xf91bcf(0x6c3)] > 0x0) { const _0x351819 = _0x3633f1[_0xf91bcf(0x5fb)]['map'](_0x55bdb8 => { const _0x20e10e = _0xf91bcf, _0x504c4e = _0x3e68bf(_0x55bdb8[_0x20e10e(0x5dd)])?.[_0x20e10e(0x4e6)] || '未知'; return _0x20e10e(0x55e) + _0x504c4e + _0x20e10e(0x51a) + _0x55bdb8[_0x20e10e(0x2fc)] + '</div>'; })['join'](''); _0x2e4360 = _0xf91bcf(0x724) + _0x351819 + _0xf91bcf(0x49e); } _0x4368c7 = _0xf91bcf(0x644) + _0x31c074 + _0xf91bcf(0x171) + _0x2e4360 + _0xf91bcf(0x6f0); } }, _0x279943 = _0x10e49b[_0x30b934(0x2a0)](_0xb6133b => ({ 'role': _0xb6133b[_0x30b934(0x6b9)] === 'assistant' ? _0x30b934(0x71d) : _0xb6133b[_0x30b934(0x6b9)] === 'system' ? _0x30b934(0x619) : _0xb6133b[_0x30b934(0x6b9)], 'parts': _0x245eed(_0xb6133b) }))[_0x30b934(0x6e8)](_0x3580e3 => _0x3580e3['parts']['length'] > 0x0), _0x14cbfe = { 'contents': _0x279943 }; _0x19c2d1 && _0x43a6aa && (_0x14cbfe[_0x30b934(0x367)] = { 'response_mime_type': _0x30b934(0x6dc) }); const _0x2acd35 = _0x3020ce + '/v1beta/models/' + _0x25f08e + ':streamGenerateContent?key=' + _0x3881cf + _0x30b934(0x8eb), _0x4f0f62 = await fetch(_0x2acd35, { 'method': _0x30b934(0x19e), 'headers': { 'Content-Type': _0x30b934(0x6dc) }, 'body': JSON['stringify'](_0x14cbfe), 'signal': _0xa31343 }); if (!_0x4f0f62['ok']) throw new Error(_0x30b934(0x5e6) + _0x4f0f62[_0x30b934(0x9cf)]); const _0x3c4532 = _0x4f0f62[_0x30b934(0x302)][_0x30b934(0x6a5)](), _0x345bb9 = new TextDecoder(); let _0x4641d2 = ''; while (!![]) { if ('qWRop' !== _0x30b934(0x47d)) _0x38d59c['src'] = _0xc6bc91[_0x30b934(0x8f3)](_0x4e2ea4), _0x5cf334[_0x30b934(0x94f)][_0x30b934(0x1cb)] = 0x1; else { if (_0xa31343['aborted']) { if (_0x30b934(0x9ad) !== _0x30b934(0x806)) { console[_0x30b934(0x7e5)](_0x30b934(0x440)), _0x3c4532['cancel'](); break; } else for (const _0x39c357 of _0x81d17b[_0x30b934(0x814)]) { let _0x4ff0f4 = _0x4f049d[_0x30b934(0x814)]['find'](_0x36769c => _0x36769c[_0x30b934(0x4e6)] === _0x39c357[_0x30b934(0x4e6)]); if (_0x4ff0f4) _0x363117[_0x30b934(0x580)](_0x4ff0f4['id']); else { const _0x59fb22 = { 'id': _0x30b934(0x2de) + _0x4f3b95['now']() + '_' + _0x41633d[_0x30b934(0x93a)](), 'name': _0x39c357[_0x30b934(0x4e6)], 'content': _0x39c357[_0x30b934(0x2fc)] }; _0x13ac9b['worldBooks'][_0x30b934(0x580)](_0x59fb22), _0x1f0331[_0x30b934(0x580)](_0x59fb22['id']); } } } const { done: _0x431d1f, value: _0x4d54dd } = await _0x3c4532[_0x30b934(0x2f6)](); if (_0x431d1f) break; const _0x348ed7 = _0x345bb9[_0x30b934(0x939)](_0x4d54dd, { 'stream': !![] }), _0x5f1dc7 = _0x348ed7[_0x30b934(0x1a7)]('\x0a')['filter'](_0x321db5 => _0x321db5[_0x30b934(0x4dd)]()[_0x30b934(0x859)]('data:')); for (const _0x2b72be of _0x5f1dc7) { const _0xab4a84 = _0x2b72be['replace']('data:\x20', ''); if (_0xab4a84 === _0x30b934(0x53a)) break; try { _0x4641d2 += JSON[_0x30b934(0x781)](_0xab4a84)[_0x30b934(0x44c)][0x0][_0x30b934(0x2fc)][_0x30b934(0x4bf)][0x0][_0x30b934(0x39f)]; } catch { } } } } _0x6f45dc = _0x4641d2; break; } case 'openai': default: { if (_0x30b934(0x77d) === _0x30b934(0x77d)) { const _0x124def = _0x14faa7(_0x4ed557), _0xe1d5ee = _0x3020ce['replace'](/\/+$/, '') + '/v1/chat/completions', _0xac54d8 = _0x10e49b['map'](_0x4d2919 => { const _0x3a2ff8 = _0x30b934; if (_0x3a2ff8(0x770) === _0x3a2ff8(0x770)) { if (_0x4d2919[_0x3a2ff8(0x6b9)] === _0x3a2ff8(0x619) && _0x4d2919[_0x3a2ff8(0x85e)]) return { 'role': _0x3a2ff8(0x619), 'content': [{ 'type': _0x3a2ff8(0x39f), 'text': _0x4d2919[_0x3a2ff8(0x2fc)] || '\x20' }, { 'type': _0x3a2ff8(0x56a), 'image_url': { 'url': _0x4d2919[_0x3a2ff8(0x85e)], 'detail': _0x3a2ff8(0x274) } }] }; return { 'role': _0x4d2919[_0x3a2ff8(0x6b9)], 'content': _0x4d2919[_0x3a2ff8(0x2fc)] }; } else _0x2ce5c5[_0x3a2ff8(0x39c)](); })['filter'](_0x501d11 => _0x501d11[_0x30b934(0x2fc)]), _0x1d9f50 = { 'model': _0x25f08e, 'messages': _0xac54d8, 'max_tokens': 0x1000, ..._0x19c2d1 ? { 'response_format': { 'type': _0x30b934(0x5c9) } } : {} }, _0x1247aa = await fetch(_0xe1d5ee, { 'method': _0x30b934(0x19e), 'headers': { 'Content-Type': _0x30b934(0x6dc), 'Authorization': _0x30b934(0x80f) + _0x124def }, 'body': JSON[_0x30b934(0x714)](_0x1d9f50), 'signal': _0xa31343 }); if (!_0x1247aa['ok']) { if (_0x30b934(0x656) !== _0x30b934(0x628)) { const _0x4d7fca = await _0x1247aa[_0x30b934(0x55f)]()['catch'](() => ({})); throw new Error('OpenAI\x20API\x20错误:\x20' + _0x1247aa[_0x30b934(0x9cf)] + '\x20-\x20' + (_0x4d7fca['error']?.[_0x30b934(0x399)] || _0x1247aa['statusText'])); } else _0x4981aa[_0x30b934(0x4a8)] = _0x30ed29[_0x30b934(0x4a8)][_0x30b934(0x6e8)](_0x461d3c => _0x461d3c['id'] !== _0x3d623a), _0x41a8ed[_0x30b934(0x903)] === _0x4630c3 && (_0x1379b4[_0x30b934(0x903)] = null), _0x44b3e2(), _0x3c8ad0(_0x30b934(0x3ed)), _0x3936af(), _0x3f12bd(_0x30b934(0x4ed), _0x30b934(0x986)); } const _0x356d4e = await _0x1247aa[_0x30b934(0x55f)](); _0x6f45dc = _0x356d4e[_0x30b934(0x3e1)]?.[0x0]?.['message']?.[_0x30b934(0x2fc)] || ''; break; } else try { const _0x24beb2 = { 'characters': _0x52eb6b[_0x30b934(0x499)], 'worldBooks': _0x442715[_0x30b934(0x814)], 'chats': _0x41b865['chats'], 'userProfile': _0xadb27a[_0x30b934(0x364)], 'apiSettings': _0x25dcf8[_0x30b934(0x98c)], 'preferences': _0x2e6bb8[_0x30b934(0x4fe)], 'activeChatId': _0x2ef8b0['activeChatId'], 'diaries': _0x53e499[_0x30b934(0x94b)], 'friendCircles': _0x31f0d3[_0x30b934(0x4a8)], 'activeFriendCircleId': _0x3135f5[_0x30b934(0x903)], 'userProfiles': _0x56c75a[_0x30b934(0x2f5)], 'activeUserProfileId': _0x4569dd[_0x30b934(0x7da)], 'accountingData': _0x337304[_0x30b934(0x28a)], 'accountingLedger': _0x5e45fc['accountingLedger'] }; _0x3d5bca[_0x30b934(0x6c6)](_0x30b934(0x273), _0x2a9cb1[_0x30b934(0x714)](_0x24beb2)); } catch (_0x15cb9e) { _0x51e79a[_0x30b934(0x8d6)](_0x30b934(0x1b9), _0x15cb9e), _0x1284ba('无法保存状态，浏览器可能禁用了存储功能。'); } } }return _0x6f45dc; } catch (_0x5dbe8f) { if (_0x5dbe8f[_0x30b934(0x4e6)] === 'AbortError') return console[_0x30b934(0x7e5)](_0x30b934(0x973)), ''; throw _0x5dbe8f; } finally { _0x346f80[_0x30b934(0x5f7)] && _0x346f80[_0x30b934(0x5f7)][_0x30b934(0x252)] === _0xa31343 && (_0x346f80['currentAbortController'] = null); } } async function _0x1f4d53() { const _0x10ddac = _0x54ed15; if (_0x10ddac(0x9d8) === _0x10ddac(0x9d8)) { const _0x16b8b4 = _0x3473b9[_0x10ddac(0x9c3)][_0x10ddac(0x78f)]['contains'](_0x10ddac(0x282)), _0x115aef = _0x16b8b4 ? _0x38aed[_0x10ddac(0x908)] : null; let _0x58dc4b = null, _0x4e8c6f = ''; if (_0x16b8b4 && _0x115aef) { _0x58dc4b = _0x346f80['chats'][_0x10ddac(0x247)](_0x3097e7 => _0x3097e7['type'] === _0x10ddac(0x328) && _0x3097e7[_0x10ddac(0x717)]['includes'](_0x115aef)); const _0x2146d5 = _0x5122c0(_0x115aef); _0x4e8c6f = _0x2146d5 ? _0x2146d5['name'] : '该角色'; } else { if (_0x346f80[_0x10ddac(0x509)]) { _0x58dc4b = _0x597f5f(); const _0x2ea6d0 = document[_0x10ddac(0x954)](_0x10ddac(0x23d))[_0x10ddac(0x96c)]; _0x4e8c6f = _0x2ea6d0 || '当前聊天'; } } if (!_0x58dc4b) { _0x3383df(_0x10ddac(0x435)); return; } const _0x2c0f37 = await _0x57c3ed('确定要清空\x22' + _0x4e8c6f + _0x10ddac(0x602)); if (!_0x2c0f37) return; _0x58dc4b['id'] === _0x346f80[_0x10ddac(0x509)] && (_0x10ddac(0x1f7) !== _0x10ddac(0x1f7) ? (_0x43f4fd[_0x10ddac(0x954)](_0x10ddac(0x39d) + _0x5cc547 + _0x10ddac(0x256))[_0x10ddac(0x7d9)] = '', _0xf73735[_0x10ddac(0x954)](_0x10ddac(0x39d) + _0xe81805 + '-input')[_0x10ddac(0x908)] = '') : (_0x28a937(), _0x346f80[_0x10ddac(0x250)] = [], _0x1e1fc7())); try { if (_0x10ddac(0x370) === _0x10ddac(0x387)) { if (_0x503654[_0x10ddac(0x6c3)] === 0x0) return; _0x54b24a = (_0x21d388 - 0x1 + _0x4e0c7e[_0x10ddac(0x6c3)]) % _0x2edb55['length'], _0x28c5e9(_0x26cdcd[_0x392444], _0x2fec3f); } else localStorage[_0x10ddac(0x845)](_0x10ddac(0x649) + _0x58dc4b['id']); } catch (_0x2b121e) { console['error'](_0x10ddac(0x3a8) + _0x58dc4b['id'], _0x2b121e); } _0x3383df('\x22' + _0x4e8c6f + '\x22\x20的聊天记录已清空。'); } else _0x13b701[_0x10ddac(0x78f)]['remove']('show-chat-view'); } const _0x55058c = document['getElementById'](_0x54ed15(0x1bc)), _0x4a2857 = document['getElementById'](_0x54ed15(0x650)), _0x286870 = document[_0x54ed15(0x954)]('import-data-input'); _0x55058c[_0x54ed15(0x35e)](_0x54ed15(0x39c), async () => { const _0x236464 = _0x54ed15; _0x6cd89d(!![], '正在打包数据，请稍候...'); const _0x2e15fc = []; try { if ('uXDUv' !== 'GlijK') { const _0x544eef = { 'localStorageData': {}, 'indexedDBData': {}, 'indexedDBMusicData': [] }; for (let _0x321380 = 0x0; _0x321380 < localStorage[_0x236464(0x6c3)]; _0x321380++) { const _0x3e3189 = localStorage[_0x236464(0x955)](_0x321380); if (_0x3e3189) _0x544eef[_0x236464(0x73c)][_0x3e3189] = localStorage[_0x236464(0x164)](_0x3e3189); } const _0x2973e5 = await _0x55088a, _0x46f25e = _0x2973e5[_0x236464(0x59e)](_0x3fdc08, _0x236464(0x178)), _0x1b0374 = _0x46f25e['objectStore'](_0x3fdc08), _0x3dc634 = await new Promise((_0x12e7c7, _0x406afe) => { const _0x3100e1 = _0x236464, _0x1a7c8d = _0x1b0374['getAll'](); _0x1a7c8d[_0x3100e1(0x8fb)] = () => _0x12e7c7(_0x1a7c8d[_0x3100e1(0x37b)]), _0x1a7c8d[_0x3100e1(0x41e)] = () => _0x406afe(_0x1a7c8d[_0x3100e1(0x8d6)]); }); for (const _0x2cf6e3 of _0x3dc634) { if (_0x236464(0x21f) !== _0x236464(0x3bd)) { if (_0x2cf6e3[_0x236464(0x41c)] instanceof Blob) { if (_0x236464(0x414) === _0x236464(0x414)) try { _0x544eef['indexedDBData'][_0x2cf6e3['id']] = await _0x58722e(_0x2cf6e3[_0x236464(0x41c)]); } catch (_0x53070b) { if (_0x236464(0x63d) === _0x236464(0x561)) { if (!_0x2653aa) return; const _0x134ddc = _0x4bf49b[_0x236464(0x785)], _0xeea7ce = _0x2fafdb(_0x134ddc); if (!_0xeea7ce) return; const _0x28e995 = _0x3605a9(_0x553337[_0x236464(0x954)](_0x236464(0x5bc))[_0x236464(0x908)]), _0x402ede = _0x2a3d47(_0x4dd5b9['getElementById']('sprite-slider-y')['value']), _0x21339f = _0x13a846(_0x52b981[_0x236464(0x954)](_0x236464(0x2f8))['value']) / 0x64; _0xeea7ce[_0x236464(0x27d)] = { 'x': _0x28e995, 'y': _0x402ede, 'scale': _0x21339f }; const _0x59ee7e = _0x45b440[_0x236464(0x954)]('galgame-sprite-container'), _0x384f17 = 0x50 * _0x21339f; _0x59ee7e[_0x236464(0x94f)]['height'] = _0x384f17 + '%', _0x59ee7e['style']['width'] = _0x384f17 + '%', _0x59ee7e[_0x236464(0x94f)][_0x236464(0x2f9)] = _0x28e995 + '%', _0x59ee7e[_0x236464(0x94f)][_0x236464(0x5ea)] = _0x402ede + '%', _0x59ee7e[_0x236464(0x94f)]['transform'] = _0x236464(0x68e); } else _0x2e15fc['push'](_0x2cf6e3['id']); } else _0x4ceedd[_0x236464(0x6a9)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x50ace2 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x227735[_0x236464(0x9be)] + _0x236464(0x4ba) + _0x43f304[_0x236464(0x53d)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>'; } } else _0x5d3796['imageId'] = _0x3ebd40; } const _0x284041 = _0x2973e5['transaction'](_0x48fd9a, 'readonly'), _0x16aba4 = _0x284041['objectStore'](_0x48fd9a), _0x3b9866 = await new Promise((_0x33328f, _0x2af279) => { const _0x4d993a = _0x236464; if (_0x4d993a(0x312) === _0x4d993a(0x312)) { const _0x49d6bc = _0x16aba4[_0x4d993a(0x190)](); _0x49d6bc[_0x4d993a(0x8fb)] = () => _0x33328f(_0x49d6bc[_0x4d993a(0x37b)]), _0x49d6bc['onerror'] = () => _0x2af279(_0x49d6bc[_0x4d993a(0x8d6)]); } else { _0x1d1a93(); const _0x311226 = _0x4741a6[_0x4d993a(0x4a8)][_0x4d993a(0x247)](_0x179728 => _0x179728['id'] === _0x58b4f9); if (!_0x311226) return; _0x36da58[_0x4d993a(0x903)] = _0x3b347c, _0x1aa044(), _0x56cb11[_0x4d993a(0x954)]('friend-circle-title')[_0x4d993a(0x96c)] = _0x311226[_0x4d993a(0x4e6)], _0x112c40(), _0x22ea48(_0x4d993a(0x632), _0x4d993a(0x4ed)), _0xb91bcc(); } }); for (const _0x30a92 of _0x3b9866) { if (_0x236464(0x638) !== _0x236464(0x638)) _0x5df9ab[_0x236464(0x94f)][_0x5c218f] = _0x40faf4[_0x360c6d]; else { const _0x31eaa5 = { ..._0x30a92 }; _0x30a92[_0x236464(0x7a1)] instanceof Blob && (_0x31eaa5[_0x236464(0x7a1)] = await _0x58722e(_0x30a92['audio'])), _0x30a92['cover'] instanceof Blob && (_0x31eaa5[_0x236464(0x34e)] = await _0x58722e(_0x30a92[_0x236464(0x34e)])), _0x544eef[_0x236464(0x2f4)][_0x236464(0x580)](_0x31eaa5); } } const _0x399c4e = new Blob([JSON['stringify'](_0x544eef, null, 0x2)], { 'type': _0x236464(0x6dc) }), _0x36f6d1 = URL[_0x236464(0x8f3)](_0x399c4e), _0x143b6d = document['createElement']('a'), _0x548dc7 = new Date(), _0x5b0407 = _0x548dc7[_0x236464(0x85b)]() + '-' + String(_0x548dc7['getMonth']() + 0x1)[_0x236464(0x990)](0x2, '0') + '-' + String(_0x548dc7[_0x236464(0x74d)]())[_0x236464(0x990)](0x2, '0'); _0x143b6d[_0x236464(0x4e2)] = _0x36f6d1, _0x143b6d[_0x236464(0x61f)] = _0x236464(0x3a6) + _0x5b0407 + _0x236464(0x69c), document[_0x236464(0x302)][_0x236464(0x204)](_0x143b6d), _0x143b6d['click'](), document[_0x236464(0x302)][_0x236464(0x7ea)](_0x143b6d), URL[_0x236464(0x354)](_0x36f6d1), _0x6cd89d(![]), _0x2e15fc[_0x236464(0x6c3)] > 0x0 ? _0x236464(0x815) !== 'ARiVh' ? _0x3383df('导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a' + _0x2e15fc['join']('\x0a')) : _0x2a5e20('复制失败了，哼。') : _0x3383df(_0x236464(0x76c)); } else _0x550797[_0x236464(0x8d6)](_0x236464(0x4b1), _0x3aed21); } catch (_0x1a6961) { _0x6cd89d(![]), console[_0x236464(0x8d6)](_0x236464(0x2fe), _0x1a6961), _0x3383df(_0x236464(0x48e) + _0x1a6961[_0x236464(0x399)]); } }), _0x4a2857['addEventListener']('click', () => { const _0x21a080 = _0x54ed15; _0x21a080(0x598) !== 'nTGxA' ? _0x286870[_0x21a080(0x39c)]() : _0x533fda = _0x249ad3; }), _0x41852d[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x40e8ad), _0x286870[_0x54ed15(0x35e)]('change', _0x468bbd => { const _0x5e0920 = _0x54ed15, _0x3f3977 = _0x468bbd[_0x5e0920(0x921)][_0x5e0920(0x626)][0x0]; if (!_0x3f3977) return; _0x57c3ed(_0x5e0920(0x9b2))[_0x5e0920(0x710)](_0x451043 => { const _0x14a2ad = _0x5e0920; if ('nYlpR' !== _0x14a2ad(0x8c4)) _0x48d5c0 += _0x14a2ad(0x94c); else { if (!_0x451043) { _0x286870[_0x14a2ad(0x908)] = ''; return; } _0x6cd89d(!![], _0x14a2ad(0x6e9)); const _0x2e1d96 = new FileReader(); _0x2e1d96['onload'] = async _0x1768b1 => { const _0x409455 = _0x14a2ad; try { const _0x49fb91 = JSON[_0x409455(0x781)](_0x1768b1[_0x409455(0x921)][_0x409455(0x37b)]); if (!_0x49fb91[_0x409455(0x73c)] || !_0x49fb91['indexedDBData']) throw new Error('文件格式不正确，不是一个有效的备份文件。'); _0x6cd89d(!![], '正在准备图片数据...'); const _0x3e73b3 = await Promise['all'](Object[_0x409455(0x91f)](_0x49fb91[_0x409455(0x8d7)])[_0x409455(0x2a0)](async _0x3b8145 => { const _0xf80170 = _0x409455, _0x2924a8 = _0x49fb91['indexedDBData'][_0x3b8145]; if (typeof _0x2924a8 === _0xf80170(0x17c) && _0x2924a8[_0xf80170(0x859)](_0xf80170(0x696))) { const _0x1d3243 = await _0x407d73(_0x2924a8); return { 'id': _0x3b8145, 'blob': _0x1d3243 }; } return null; }))[_0x409455(0x710)](_0x2e8207 => _0x2e8207['filter'](Boolean)), _0x2cc080 = []; if (_0x49fb91[_0x409455(0x2f4)]) { if (_0x409455(0x8e4) === _0x409455(0x8e4)) { _0x6cd89d(!![], _0x409455(0x306)); const _0x34f9b9 = _0x49fb91[_0x409455(0x2f4)][_0x409455(0x2a0)](async _0x3cfaaf => { const _0x5f06be = _0x409455, _0x1cd913 = { ..._0x3cfaaf }; if (_0x3cfaaf[_0x5f06be(0x7a1)]) _0x1cd913[_0x5f06be(0x7a1)] = await _0x407d73(_0x3cfaaf[_0x5f06be(0x7a1)]); if (_0x3cfaaf['cover']) _0x1cd913[_0x5f06be(0x34e)] = await _0x407d73(_0x3cfaaf['cover']); return _0x1cd913; }); _0x2cc080[_0x409455(0x580)](...await Promise['all'](_0x34f9b9)); } else { let _0x34b01c = _0x14f78f[_0x409455(0x7c6)](_0x409455(0x1d9)); !_0x34b01c && (_0x34b01c = _0x591dfe['createElement']('div'), _0x34b01c[_0x409455(0x941)] = _0x409455(0x7d8), _0x34b01c[_0x409455(0x96c)] = _0x409455(0x1ca), _0x53d880[_0x409455(0x204)](_0x34b01c)); } } _0x6cd89d(!![], _0x409455(0x620)), localStorage[_0x409455(0x964)](); for (const _0x3bb9f3 in _0x49fb91[_0x409455(0x73c)]) { _0x409455(0x8aa) !== _0x409455(0x8aa) ? _0x590d2f(_0x409455(0x914) + _0x113c06[_0x409455(0x399)]) : localStorage['setItem'](_0x3bb9f3, _0x49fb91[_0x409455(0x73c)][_0x3bb9f3]); } _0x6cd89d(!![], _0x409455(0x72c)); const _0x1bf2de = await _0x55088a, _0x53e035 = _0x1bf2de['transaction']([_0x3fdc08, _0x48fd9a], _0x409455(0x1e2)), _0x5ba718 = _0x53e035[_0x409455(0x8e1)](_0x3fdc08), _0x422e9a = _0x53e035['objectStore'](_0x48fd9a); _0x5ba718['clear'](), _0x422e9a[_0x409455(0x964)](), _0x3e73b3[_0x409455(0x927)](_0x58b328 => _0x5ba718[_0x409455(0x1b2)](_0x58b328)), _0x2cc080[_0x409455(0x927)](_0x24cc4d => _0x422e9a[_0x409455(0x1b2)](_0x24cc4d)), await new Promise((_0x4b97b7, _0x241d83) => { const _0x3dc704 = _0x409455; _0x53e035[_0x3dc704(0x595)] = _0x4b97b7, _0x53e035['onerror'] = _0x44dedf => _0x241d83(_0x44dedf[_0x3dc704(0x921)]['error']); }), _0x6cd89d(![]), _0x3383df('数据导入成功！应用即将刷新...'), setTimeout(() => location[_0x409455(0x55a)](), 0x640); } catch (_0x41fbd5) { _0x6cd89d(![]), console['error'](_0x409455(0x1dd), _0x41fbd5), _0x3383df(_0x409455(0x593) + _0x41fbd5[_0x409455(0x399)]); } finally { _0x286870['value'] = ''; } }, _0x2e1d96[_0x14a2ad(0x69f)](_0x3f3977); } }); }); function _0x1f1d77() { const _0x1d323c = _0x54ed15; _0x24b906['value'] = _0x346f80[_0x1d323c(0x98c)][_0x1d323c(0x4b6)] || '', _0x74f9b5[_0x1d323c(0x908)] = _0x346f80[_0x1d323c(0x98c)][_0x1d323c(0x955)] || '', _0x3b092f[_0x1d323c(0x908)] = _0x346f80[_0x1d323c(0x98c)]['model'] || '', _0x500a12[_0x1d323c(0x908)] = String(_0x346f80[_0x1d323c(0x4fe)]?.['perChatContextLines'] ?? 0x64), document[_0x1d323c(0x954)]('api-provider')[_0x1d323c(0x908)] = _0x346f80['apiSettings']['provider'] || _0x1d323c(0x9c2); } function _0x31369a() { const _0x44fbbc = _0x54ed15; _0x346f80[_0x44fbbc(0x98c)][_0x44fbbc(0x4b6)] = _0x24b906[_0x44fbbc(0x908)][_0x44fbbc(0x4dd)](), _0x346f80[_0x44fbbc(0x98c)][_0x44fbbc(0x955)] = _0x74f9b5['value'][_0x44fbbc(0x4dd)](), _0x346f80['apiSettings'][_0x44fbbc(0x71d)] = _0x3b092f['value'][_0x44fbbc(0x4dd)](), _0x346f80[_0x44fbbc(0x98c)][_0x44fbbc(0x7bf)] = document['getElementById'](_0x44fbbc(0x788))[_0x44fbbc(0x908)]; const _0x18abd3 = parseInt(_0x500a12[_0x44fbbc(0x908)], 0xa); _0x346f80[_0x44fbbc(0x4fe)]['perChatContextLines'] = Number[_0x44fbbc(0x177)](_0x18abd3) && _0x18abd3 > 0x0 ? _0x18abd3 : 0x64, _0x23c6b9(), _0x3383df('设置已保存！'); } function _0x2ab2e7() { const _0x1bb602 = _0x54ed15; _0x4707f6[_0x1bb602(0x908)] = _0x346f80[_0x1bb602(0x364)][_0x1bb602(0x4e6)] || '', _0x311d8d[_0x1bb602(0x7d9)] = _0x346f80['userProfile'][_0x1bb602(0x4ef)] || _0x223ec8, _0x442ceb[_0x1bb602(0x908)] = _0x346f80[_0x1bb602(0x364)]['persona'] || ''; } function _0x5a8deb() { const _0x2a640a = _0x54ed15; if (_0x2a640a(0x412) !== _0x2a640a(0x5d7)) _0x346f80[_0x2a640a(0x364)][_0x2a640a(0x4e6)] = _0x4707f6[_0x2a640a(0x908)]['trim'](), _0x346f80[_0x2a640a(0x364)]['persona'] = _0x442ceb[_0x2a640a(0x908)][_0x2a640a(0x4dd)](), _0x23c6b9(), _0x1e1fc7(), _0x3383df(_0x2a640a(0x241)), _0x21dca3(_0x2a640a(0x7c8), _0x2a640a(0x364)); else { const _0x3f5cc0 = _0x2ca89e[_0x2a640a(0x908)][_0x2a640a(0x4dd)](), _0x218717 = _0x203472[_0x2a640a(0x908)]['trim'](); if (!_0x3f5cc0 || !_0x218717) { _0x57a008(_0x2a640a(0x63f)); return; } _0x119788({ 'songName': _0x3f5cc0, 'artist': _0x218717 }); } } async function _0x49866d(_0x27bf99 = null) { const _0x149e4a = _0x54ed15; if (_0x149e4a(0x248) === 'NpDzW') { const _0x4e2cd0 = _0x357847; _0x21dca3('characterEdit', _0x4e2cd0); const _0xc623df = document[_0x149e4a(0x954)](_0x149e4a(0x704)); _0xc623df[_0x149e4a(0x6a9)] = '', _0x346f80['worldBooks'][_0x149e4a(0x927)](_0x40505e => { const _0x30c38c = _0x149e4a; if (_0x30c38c(0x54f) !== _0x30c38c(0x91d)) { const _0x34ba1a = document[_0x30c38c(0x820)]('label'); _0x34ba1a[_0x30c38c(0x6a9)] = _0x30c38c(0x60c) + _0x40505e['id'] + '\x22>\x20' + _0x40505e['name'], _0xc623df[_0x30c38c(0x204)](_0x34ba1a); } else _0x11f2e6(_0x30c38c(0x9ce) + _0x14f527[_0x30c38c(0x399)] + _0x30c38c(0x5aa)); }), _0x334ad5(_0x149e4a(0x249)), _0x1f81b5['src'] = '', _0x39ce78[_0x149e4a(0x908)] = '', _0xb79f5b[_0x149e4a(0x7d9)] = '', _0xba7cdd[_0x149e4a(0x908)] = '', _0x3d3798['src'] = '', _0x19b554[_0x149e4a(0x908)] = ''; const _0x2b8506 = ['normal', 'happy', _0x149e4a(0x4b2), _0x149e4a(0x216), _0x149e4a(0x195)]; _0x2b8506[_0x149e4a(0x927)](_0x526fb3 => { const _0x588cd3 = _0x149e4a; document[_0x588cd3(0x954)]('char-edit-sprite-' + _0x526fb3 + '-preview')['src'] = '', document['getElementById'](_0x588cd3(0x39d) + _0x526fb3 + _0x588cd3(0x690))[_0x588cd3(0x908)] = ''; }); if (_0x27bf99) { if (_0x149e4a(0x9da) === _0x149e4a(0x9da)) { const _0x2d4d31 = _0x346f80['characters']['find'](_0x598ae8 => _0x598ae8['id'] === _0x27bf99); if (!_0x2d4d31) return; _0x38aed[_0x149e4a(0x908)] = _0x2d4d31['id'], _0x52a990['textContent'] = _0x149e4a(0x549), _0x22cf00[_0x149e4a(0x908)] = _0x2d4d31[_0x149e4a(0x4e6)], _0x1092b8[_0x149e4a(0x908)] = _0x2d4d31[_0x149e4a(0x287)], _0x3d3218[_0x149e4a(0x908)] = _0x2d4d31['persona'], document[_0x149e4a(0x954)](_0x149e4a(0x30e))[_0x149e4a(0x908)] = _0x2d4d31[_0x149e4a(0x938)] || ''; const _0x4d8f98 = _0x346f80[_0x149e4a(0x3aa)][_0x149e4a(0x247)](_0x484bea => _0x484bea[_0x149e4a(0x62d)] === _0x149e4a(0x328) && _0x484bea[_0x149e4a(0x717)][_0x149e4a(0x84e)](_0x27bf99)); document[_0x149e4a(0x954)]('char-edit-bind-user')[_0x149e4a(0x908)] = _0x4d8f98?.[_0x149e4a(0x96f)] || _0x346f80[_0x149e4a(0x7da)]; try { const _0x443a05 = await _0x4f16ca('char_avatar_' + _0x2d4d31['id']), _0x2d620f = await _0x4f16ca('char_wallpaper_' + _0x2d4d31['id']), _0x581373 = await _0x4f16ca(_0x149e4a(0x525) + _0x2d4d31['id']); _0x1f81b5[_0x149e4a(0x7d9)] = _0x443a05 ? URL[_0x149e4a(0x8f3)](_0x443a05) : _0x2d4d31[_0x149e4a(0x4ef)] || _0x2f6e79; if (_0x2d620f) _0xb79f5b['src'] = URL['createObjectURL'](_0x2d620f); if (_0x581373) _0x3d3798[_0x149e4a(0x7d9)] = URL[_0x149e4a(0x8f3)](_0x581373); for (const _0x151363 of _0x2b8506) { const _0x52f357 = await _0x4f16ca(_0x149e4a(0x75b) + _0x151363 + '_' + _0x2d4d31['id']); _0x52f357 && ('PMUAx' !== _0x149e4a(0x93e) ? document[_0x149e4a(0x954)](_0x149e4a(0x39d) + _0x151363 + _0x149e4a(0x256))[_0x149e4a(0x7d9)] = URL[_0x149e4a(0x8f3)](_0x52f357) : _0x3fae0c(_0x327cb4)); } } catch (_0x598898) { _0x149e4a(0x80c) === _0x149e4a(0x5c0) ? (_0x51ba74[_0x149e4a(0x7d9)] = _0x5aff8f[_0x149e4a(0x8f3)](_0x6c46e0), _0x4972a6[_0x149e4a(0x94f)][_0x149e4a(0x3b4)] = 'block') : (console['error']('加载角色\x20' + _0x2d4d31['id'] + '\x20的图片失败:', _0x598898), _0x1f81b5[_0x149e4a(0x7d9)] = _0x2d4d31[_0x149e4a(0x4ef)] || _0x2f6e79); } _0x2d4d31['linkedWorldBookIds'] && _0xc623df[_0x149e4a(0x6a0)](_0x149e4a(0x83e))[_0x149e4a(0x927)](_0x1577c3 => { const _0x1534f4 = _0x149e4a; if (_0x2d4d31[_0x1534f4(0x925)][_0x1534f4(0x84e)](_0x1577c3['value'])) _0x1577c3[_0x1534f4(0x896)] = !![]; }), _0x1b2879(); } else { _0x13bd08(_0x149e4a(0x924) + _0x27876f + _0x149e4a(0x881)), _0x10ed8b(() => _0x306916['reload'](), 0x5dc); return; } } else _0x149e4a(0x167) === 'mxjHC' ? (_0x38aed[_0x149e4a(0x908)] = '', _0x52a990[_0x149e4a(0x96c)] = _0x149e4a(0x455), _0x22cf00[_0x149e4a(0x908)] = _0x149e4a(0x78e) + (_0x346f80[_0x149e4a(0x499)][_0x149e4a(0x6c3)] + 0x1), _0x1092b8[_0x149e4a(0x908)] = '', _0x1f81b5[_0x149e4a(0x7d9)] = _0x2f6e79, _0x3d3218[_0x149e4a(0x908)] = _0x149e4a(0x3f3), document['getElementById'](_0x149e4a(0x30e))[_0x149e4a(0x908)] = '', _0x1b2879()) : _0x46496b(); const _0x3b31f1 = document[_0x149e4a(0x954)](_0x149e4a(0x30e)); let _0x200dcd = document[_0x149e4a(0x954)]('live-preview-style'); !_0x200dcd && (_0x200dcd = document[_0x149e4a(0x820)](_0x149e4a(0x94f)), _0x200dcd['id'] = _0x149e4a(0x804), document[_0x149e4a(0x8c5)][_0x149e4a(0x204)](_0x200dcd)); const _0xac35a8 = () => { const _0x55c2e9 = _0x149e4a, _0x52f839 = _0x3b31f1[_0x55c2e9(0x908)]; let _0x35de1c = _0x52f839[_0x55c2e9(0x330)](/\.bubble\.sent/g, _0x55c2e9(0x43f))[_0x55c2e9(0x330)](/\.bubble\.received/g, _0x55c2e9(0x404)); _0x200dcd[_0x55c2e9(0x6a9)] = _0x35de1c; }; _0x3b31f1[_0x149e4a(0x38d)](_0x149e4a(0x7b5), _0xac35a8), _0x3b31f1[_0x149e4a(0x35e)](_0x149e4a(0x7b5), _0xac35a8), _0xac35a8(); } else { const _0xfc3c96 = _0x45eb4c ?? _0x6217c1[_0x149e4a(0x908)]['trim'](); if (_0xfc3c96 === '' || !_0x3c6570[_0x149e4a(0x509)]) return; const _0xb15689 = _0x3eebc1[_0x149e4a(0x7c6)](_0x149e4a(0x4c7)), _0x2699ed = _0xb15689['id'] === 'meeting-view-screen', _0x3cb924 = { 'role': _0x149e4a(0x619), 'content': _0xfc3c96, 'timestamp': _0x309a0f['now'](), 'isOffline': _0x2699ed }; _0x1885ef[_0x149e4a(0x4cd)] && (_0x3cb924[_0x149e4a(0x2da)] = { ..._0x1633d6[_0x149e4a(0x4cd)] }), _0xd86e41[_0x149e4a(0x250)][_0x149e4a(0x580)](_0x3cb924), _0x61ca40(), _0x301fd3(), !_0x551fb5 && (_0x5834d0[_0x149e4a(0x908)] = ''), _0x40992e(); } } async function _0x2d003e() { const _0x61a888 = _0x54ed15; if ('AUgrT' !== _0x61a888(0x67f)) { const _0x506c7a = _0x38aed[_0x61a888(0x908)]; if (!_0x506c7a) { _0x3383df(_0x61a888(0x830)); return; } const _0x5e3b63 = _0x5122c0(_0x506c7a); if (!_0x5e3b63) return; _0x6cd89d(!![], '正在打包“' + _0x5e3b63[_0x61a888(0x4e6)] + _0x61a888(0x29d)); try { if (_0x61a888(0x9d4) === _0x61a888(0x48c)) _0x3df7b8(_0x28334a, { 'force': !![], 'delayMs': _0x21a6d9 }), _0x1a988d += 0x1f4; else { const _0x4a2a82 = { 'type': _0x61a888(0x3af), 'version': 0x1, 'name': _0x5e3b63[_0x61a888(0x4e6)], 'remark': _0x5e3b63[_0x61a888(0x287)], 'persona': _0x5e3b63[_0x61a888(0x1a5)], 'bubbleCss': _0x5e3b63[_0x61a888(0x938)], 'avatar': null, 'sprites': {}, 'worldBooks': [] }, _0x865550 = await _0x4f16ca('char_avatar_' + _0x5e3b63['id']); if (_0x865550) _0x4a2a82['avatar'] = await _0x58722e(_0x865550); const _0x34bed0 = [_0x61a888(0x7e0), 'happy', _0x61a888(0x4b2), 'sad', _0x61a888(0x195)]; for (const _0x55608c of _0x34bed0) { const _0x394f42 = await _0x4f16ca(_0x61a888(0x75b) + _0x55608c + '_' + _0x5e3b63['id']); _0x394f42 && (_0x4a2a82[_0x61a888(0x87b)][_0x55608c] = await _0x58722e(_0x394f42)); } _0x5e3b63[_0x61a888(0x925)] && _0x5e3b63['linkedWorldBookIds'][_0x61a888(0x6c3)] > 0x0 && (_0x61a888(0x20b) !== _0x61a888(0x6d9) ? _0x4a2a82[_0x61a888(0x814)] = _0x5e3b63[_0x61a888(0x925)]['map'](_0x16f2b7 => _0x346f80['worldBooks'][_0x61a888(0x247)](_0x102199 => _0x102199['id'] === _0x16f2b7))[_0x61a888(0x6e8)](Boolean)[_0x61a888(0x2a0)](_0x10b67b => ({ 'name': _0x10b67b[_0x61a888(0x4e6)], 'content': _0x10b67b[_0x61a888(0x2fc)] })) : (_0x49828d[_0x61a888(0x941)] = 'narrator', _0x3114cd['style'][_0x61a888(0x497)] = _0x61a888(0x721), _0x1bcb7e[_0x61a888(0x94f)][_0x61a888(0x4cf)] = _0x61a888(0x6f4), _0x23bbce[_0x61a888(0x6a9)] = _0x585398)); const _0x4e5ee7 = new Blob([JSON['stringify'](_0x4a2a82, null, 0x2)], { 'type': _0x61a888(0x6dc) }), _0x1c3d05 = URL[_0x61a888(0x8f3)](_0x4e5ee7), _0x37f4eb = document[_0x61a888(0x820)]('a'); _0x37f4eb['href'] = _0x1c3d05, _0x37f4eb['download'] = _0x5e3b63[_0x61a888(0x4e6)] + '_NoirCard.json', document['body'][_0x61a888(0x204)](_0x37f4eb), _0x37f4eb[_0x61a888(0x39c)](), document[_0x61a888(0x302)][_0x61a888(0x7ea)](_0x37f4eb), URL['revokeObjectURL'](_0x1c3d05); } } catch (_0x369ea1) { if ('UfpWT' === _0x61a888(0x87c)) console[_0x61a888(0x8d6)](_0x61a888(0x4fb), _0x369ea1), _0x3383df(_0x61a888(0x1c5) + _0x369ea1[_0x61a888(0x399)]); else { const _0xaa9217 = { 'id': _0x7919e['id'], 'url': _0x437e7d[_0x61a888(0x32c)] }; _0xa2fcf5(this, _0xaa9217); } } finally { if (_0x61a888(0x9b8) !== _0x61a888(0x42a)) _0x6cd89d(![]); else { _0x113944[_0x61a888(0x8d6)](_0x61a888(0x344) + _0x296e08[_0x61a888(0x4e6)] + _0x61a888(0x7d0)); return; } } } else _0x2c1586[_0x61a888(0x5f7)][_0x61a888(0x93c)](_0x61a888(0x407)); } async function _0x1a7a62(_0x45e638) { const _0x3c3bfe = _0x54ed15, _0x258234 = _0x45e638[_0x3c3bfe(0x921)]['files'][0x0]; if (!_0x258234) return; _0x6cd89d(!![], _0x3c3bfe(0x9b6)); const _0x2ec30a = new FileReader(); _0x2ec30a[_0x3c3bfe(0x3cc)] = async _0x201b92 => { const _0x572d4a = _0x3c3bfe; try { const _0x18daa8 = JSON[_0x572d4a(0x781)](_0x201b92[_0x572d4a(0x921)][_0x572d4a(0x37b)]); if (_0x18daa8[_0x572d4a(0x62d)] !== _0x572d4a(0x3af)) throw new Error(_0x572d4a(0x886)); const _0xb9f831 = []; if (_0x18daa8[_0x572d4a(0x814)] && _0x18daa8[_0x572d4a(0x814)][_0x572d4a(0x6c3)] > 0x0) for (const _0x4f194a of _0x18daa8[_0x572d4a(0x814)]) { let _0x2ef928 = _0x346f80['worldBooks'][_0x572d4a(0x247)](_0x59d366 => _0x59d366[_0x572d4a(0x4e6)] === _0x4f194a[_0x572d4a(0x4e6)]); if (_0x2ef928) _0xb9f831[_0x572d4a(0x580)](_0x2ef928['id']); else { const _0x25ec53 = { 'id': 'wb_' + Date[_0x572d4a(0x909)]() + '_' + Math[_0x572d4a(0x93a)](), 'name': _0x4f194a[_0x572d4a(0x4e6)], 'content': _0x4f194a[_0x572d4a(0x2fc)] }; _0x346f80[_0x572d4a(0x814)][_0x572d4a(0x580)](_0x25ec53), _0xb9f831[_0x572d4a(0x580)](_0x25ec53['id']); } } const _0x480451 = 'char_' + Date['now'](), _0x1e1b1d = { 'id': _0x480451, 'name': _0x18daa8[_0x572d4a(0x4e6)], 'remark': _0x18daa8[_0x572d4a(0x287)] || '', 'persona': _0x18daa8[_0x572d4a(0x1a5)], 'avatar': _0x18daa8[_0x572d4a(0x4ef)] || _0x2f6e79, 'linkedWorldBookIds': _0xb9f831, 'bubbleCss': _0x18daa8[_0x572d4a(0x938)] || '' }; if (_0x18daa8[_0x572d4a(0x4ef)]) { if (_0x572d4a(0x6eb) !== _0x572d4a(0x500)) { const _0x3064e3 = await _0x407d73(_0x18daa8[_0x572d4a(0x4ef)]); await _0x336559('char_avatar_' + _0x480451, _0x3064e3); } else _0x2b9cd0['value'] = _0xc47bc4[_0x572d4a(0x2a0)](_0x524ef8 => _0x524ef8[_0x572d4a(0x4e6)] + '--' + _0x524ef8[_0x572d4a(0x4ee)])[_0x572d4a(0x6e6)]('\x0a'); } if (_0x18daa8[_0x572d4a(0x87b)]) { if (_0x572d4a(0x8d5) === _0x572d4a(0x2c3)) _0x7d9778[_0x572d4a(0x3d2)] = ![], _0x907e32(![]); else for (const _0x2cc8aa in _0x18daa8[_0x572d4a(0x87b)]) { if ('LCJnJ' !== _0x572d4a(0x4f4)) _0x1cc47b[_0x572d4a(0x955)] === _0x572d4a(0x3fc) && !_0x57b604[_0x572d4a(0x31f)] && (_0x187c6a[_0x572d4a(0x45f)](), _0x339cc0()); else { const _0x1a075a = _0x18daa8[_0x572d4a(0x87b)][_0x2cc8aa], _0x4586dd = await _0x407d73(_0x1a075a); await _0x336559(_0x572d4a(0x75b) + _0x2cc8aa + '_' + _0x480451, _0x4586dd); } } } _0x346f80[_0x572d4a(0x499)]['push'](_0x1e1b1d); const _0x2c39b9 = { 'id': _0x572d4a(0x98a) + _0x480451, 'type': 'private', 'participantIds': [_0x480451], 'boundUserProfileId': _0x346f80[_0x572d4a(0x7da)] }; _0x346f80[_0x572d4a(0x3aa)]['push'](_0x2c39b9), _0x23c6b9(), _0x546ea8(), _0x3383df('“' + _0x1e1b1d[_0x572d4a(0x4e6)] + _0x572d4a(0x1dc)); } catch (_0x923226) { 'mRuVU' === _0x572d4a(0x4d7) ? (console['error'](_0x572d4a(0x526), _0x923226), _0x3383df(_0x572d4a(0x832) + _0x923226[_0x572d4a(0x399)])) : _0x2e25f5(_0x572d4a(0x755), _0x572d4a(0x9c3)); } finally { if (_0x572d4a(0x923) !== _0x572d4a(0x923)) try { const _0x212d8e = _0x404d7e[_0x572d4a(0x781)](_0x55dcd7); _0x134960[_0x572d4a(0x86b)](_0x212d8e) && (_0xe3b0f1[_0x572d4a(0x908)] = _0x212d8e['map'](_0x2183ae => _0x2183ae[_0x572d4a(0x4e6)] + '--' + _0x2183ae[_0x572d4a(0x4ee)])[_0x572d4a(0x6e6)]('\x0a')); } catch (_0x69ce61) { } else _0x6cd89d(![]), _0x45e638['target'][_0x572d4a(0x908)] = ''; } }, _0x2ec30a[_0x3c3bfe(0x69f)](_0x258234); } async function _0x151e2a() { const _0x558c67 = _0x54ed15; if (_0x558c67(0x454) === 'IMhnm') { const _0x38d3e9 = _0x38aed[_0x558c67(0x908)]; let _0x519813 = null; const _0x3e8c0c = _0x39ce78[_0x558c67(0x626)][0x0], _0x1566bc = _0xba7cdd[_0x558c67(0x626)][0x0], _0x184803 = _0x19b554[_0x558c67(0x626)][0x0], _0x23fc26 = document[_0x558c67(0x6a0)](_0x558c67(0x548)), _0x6be7fd = Array[_0x558c67(0x73e)](_0x23fc26)[_0x558c67(0x2a0)](_0x150888 => _0x150888[_0x558c67(0x908)]), _0x5b83f5 = { 'name': _0x22cf00[_0x558c67(0x908)][_0x558c67(0x4dd)](), 'remark': _0x1092b8['value']['trim'](), 'persona': _0x3d3218[_0x558c67(0x908)][_0x558c67(0x4dd)](), 'linkedWorldBookIds': _0x6be7fd, 'boundUserProfileId': document[_0x558c67(0x954)](_0x558c67(0x249))[_0x558c67(0x908)], 'bubbleCss': document[_0x558c67(0x954)](_0x558c67(0x30e))[_0x558c67(0x908)]['trim']() }; if (!_0x5b83f5['name']) { if (_0x558c67(0x9b0) !== _0x558c67(0x9b0)) _0x17d124[_0x558c67(0x78f)][_0x558c67(0x3d0)](_0x558c67(0x44b)), _0x96b7c9[_0x558c67(0x78f)][_0x558c67(0x3d0)](_0x558c67(0x7e9)), _0x5ca003['classList'][_0x558c67(0x3d0)](_0x558c67(0x415)), _0x5344e8(() => { const _0x570f25 = _0x558c67; _0x3869e4[_0x570f25(0x78f)][_0x570f25(0x309)](_0x570f25(0x415), _0x570f25(0x7e9)), _0x166e35[_0x570f25(0x78f)][_0x570f25(0x309)]('is-entering-from-left'), _0x111fca[_0x570f25(0x713)] = _0xed05cb, _0x28fadd(), _0x2195a1[_0x570f25(0x2d4)] = ![]; }, 0x2bc); else { _0x3383df(_0x558c67(0x46b)); return; } } try { const _0x1a88c7 = [_0x558c67(0x7e0), 'happy', 'angry', _0x558c67(0x216), _0x558c67(0x195)]; if (_0x38d3e9) { if (_0x558c67(0x965) === 'dUtkD') { const _0x5e224b = _0x346f80[_0x558c67(0x499)][_0x558c67(0x247)](_0x313d33 => _0x313d33['id'] === _0x38d3e9); if (_0x5e224b) { if (_0x558c67(0x3ca) !== _0x558c67(0x553)) { Object[_0x558c67(0x8ad)](_0x5e224b, _0x5b83f5); if (_0x3e8c0c) _0x5e224b[_0x558c67(0x4ef)] = await _0x1bec17(_0x3e8c0c); } else _0x153d98[_0x558c67(0x8d6)]('加载立绘失败:', _0xd40e43), _0x29c351[_0x558c67(0x7d9)] = ''; } if (_0x3e8c0c) await _0x336559(_0x558c67(0x640) + _0x38d3e9, _0x3e8c0c); if (_0x1566bc) await _0x336559('char_wallpaper_' + _0x38d3e9, _0x1566bc); if (_0x184803) await _0x336559('char_offline_bg_' + _0x38d3e9, _0x184803); for (const _0x3bf7ab of _0x1a88c7) { const _0x24c6b2 = document[_0x558c67(0x954)](_0x558c67(0x39d) + _0x3bf7ab + '-input')['files'][0x0]; if (_0x24c6b2) await _0x336559(_0x558c67(0x75b) + _0x3bf7ab + '_' + _0x38d3e9, _0x24c6b2); } } else _0x332a9b[_0x558c67(0x7bc)] = ![]; } else { _0x519813 = _0x558c67(0x5d6) + Date[_0x558c67(0x909)](); const _0x128057 = { 'id': _0x519813, ..._0x5b83f5 }; _0x128057[_0x558c67(0x4ef)] = _0x3e8c0c ? await _0x1bec17(_0x3e8c0c) : _0x2f6e79, _0x346f80[_0x558c67(0x499)][_0x558c67(0x580)](_0x128057); const _0x4d3dfc = { 'id': 'chat_' + _0x519813, 'type': _0x558c67(0x328), 'participantIds': [_0x519813], 'boundUserProfileId': _0x5b83f5[_0x558c67(0x96f)], 'listenTogetherSession': null }; _0x346f80[_0x558c67(0x3aa)]['push'](_0x4d3dfc); if (_0x3e8c0c) await _0x336559('char_avatar_' + _0x519813, _0x3e8c0c); if (_0x1566bc) await _0x336559(_0x558c67(0x6fc) + _0x519813, _0x1566bc); if (_0x184803) await _0x336559(_0x558c67(0x525) + _0x519813, _0x184803); for (const _0xec64d6 of _0x1a88c7) { if ('xjeXg' !== 'xjeXg') _0x168328 && (_0x265c8a[_0x558c67(0x94f)][_0x558c67(0x3b4)] = _0x558c67(0x910)); else { const _0x67af82 = document[_0x558c67(0x954)](_0x558c67(0x39d) + _0xec64d6 + '-input')['files'][0x0]; if (_0x67af82) await _0x336559(_0x558c67(0x75b) + _0xec64d6 + '_' + _0x519813, _0x67af82); } } } _0x23c6b9(), _0x546ea8(), _0x3383df(_0x558c67(0x291)), _0x21dca3(_0x558c67(0x755), _0x558c67(0x9c3)); if (!_0x38d3e9) { if ('RkGUH' !== 'VqTfP') { const _0x45c4c1 = 'chat_' + _0x519813; _0x54cb4c(_0x45c4c1), _0x4c5132(!![]); } else _0x1fb346 = _0x1d98f8['at'](-0x1); } } catch (_0x25b666) { console['error'](_0x558c67(0x4d3), _0x25b666), _0x3383df(_0x558c67(0x772) + _0x25b666['message']); } } else { const _0x47baa6 = _0x5b08c6['getElementById'](_0x558c67(0x704)), _0x4a8035 = _0x47baa6[_0x558c67(0x6a0)](_0x558c67(0x3dd)), _0x153759 = _0x1a7263[_0x558c67(0x7c6)]('.selected-options-text'); if (_0x4a8035[_0x558c67(0x6c3)] === 0x0) _0x153759['textContent'] = _0x558c67(0x733); else _0x4a8035[_0x558c67(0x6c3)] > 0x2 ? _0x153759['textContent'] = _0x558c67(0x361) + _0x4a8035[_0x558c67(0x6c3)] + '\x20项' : _0x153759[_0x558c67(0x96c)] = _0x5333c8['from'](_0x4a8035)[_0x558c67(0x2a0)](_0x549ae1 => _0x549ae1[_0x558c67(0x7c7)][_0x558c67(0x96c)][_0x558c67(0x4dd)]())[_0x558c67(0x6e6)]('、'); } } function _0x3307f4() { const _0x566620 = _0x54ed15; _0x27075f[_0x566620(0x908)] = '', _0x119e6d[_0x566620(0x6a9)] = ''; if (_0x346f80['characters'][_0x566620(0x6c3)] < 0x2) { _0x3383df('需要至少2个角色才能创建群聊。'); return; } _0x346f80[_0x566620(0x499)][_0x566620(0x927)](_0x2179f9 => { const _0x1a8430 = _0x566620, _0x2f0ba3 = document[_0x1a8430(0x820)]('li'); _0x2f0ba3[_0x1a8430(0x941)] = _0x1a8430(0x22a), _0x2f0ba3['innerHTML'] = _0x1a8430(0x612) + _0x2179f9['id'] + _0x1a8430(0x2ba) + _0x2179f9['id'] + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x2179f9['avatar'] || _0x2f6e79) + _0x1a8430(0x8f5) + _0x2179f9['id'] + '\x22\x20class=\x22char-name\x22>' + _0x2179f9[_0x1a8430(0x4e6)] + _0x1a8430(0x746), _0x119e6d[_0x1a8430(0x204)](_0x2f0ba3); }), _0x21dca3(_0x566620(0x7eb), _0x566620(0x822)); } function _0x42e874() { const _0x2b6260 = _0x54ed15, _0x1ba2d5 = _0x27075f[_0x2b6260(0x908)][_0x2b6260(0x4dd)](); if (!_0x1ba2d5) { if ('qMWKv' === _0x2b6260(0x1ee)) { _0x3383df('请输入群聊名称。'); return; } else { const _0x359e92 = _0x56d329(_0x56fdb2[_0x2b6260(0x785)]); _0x359e92 && (_0x359e92[_0x2b6260(0x27d)] = _0x2cb02a, _0x565fa8(_0x24b010['activeMeetingCharId'], _0x2b6260(0x7e0))); } } const _0xe931c4 = Array[_0x2b6260(0x73e)](_0x119e6d['querySelectorAll'](_0x2b6260(0x874)))[_0x2b6260(0x2a0)](_0x2779f3 => _0x2779f3[_0x2b6260(0x86c)]['id']); if (_0xe931c4[_0x2b6260(0x6c3)] < 0x2) { _0x3383df(_0x2b6260(0x3f1)); return; } const _0x2ceb26 = { 'id': _0x2b6260(0x92f) + Date['now'](), 'type': _0x2b6260(0x661), 'name': _0x1ba2d5, 'participantIds': _0xe931c4 }; _0x346f80[_0x2b6260(0x3aa)][_0x2b6260(0x580)](_0x2ceb26), _0x346f80[_0x2b6260(0x509)] = _0x2ceb26['id'], _0x23c6b9(), _0x546ea8(), _0x5e630d(), _0x3a0ba4(), _0x3383df(_0x2b6260(0x8ba) + _0x1ba2d5 + '”已创建！'), _0x21dca3('chat', _0x2b6260(0x7eb)); } _0x2828d0[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x444091), _0x1176ad[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => _0x3f451c[_0x54ed15(0x78f)][_0x54ed15(0x309)](_0x54ed15(0x373))), _0x5124d9[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => _0x3f451c[_0x54ed15(0x78f)][_0x54ed15(0x309)](_0x54ed15(0x373))), _0xba5320[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0xfc9be7 = _0x54ed15; _0xfc9be7(0x7ff) !== _0xfc9be7(0x475) ? (_0x460947[_0xfc9be7(0x539)](), navigator['clipboard'][_0xfc9be7(0x695)](_0x460947[_0xfc9be7(0x908)])['then'](() => { const _0x228091 = _0xfc9be7; _0x3383df(_0x228091(0x2ae)); })['catch'](_0x1be742 => { const _0x225d62 = _0xfc9be7; _0x225d62(0x4e4) !== _0x225d62(0x2a4) ? _0x3383df(_0x225d62(0x8b5)) : (_0x1c7935[_0x225d62(0x94f)]['top'] = _0x27093c[_0x225d62(0x5ea)] + '%', _0x527041[_0x225d62(0x94f)][_0x225d62(0x2f9)] = _0x2811ad[_0x225d62(0x2f9)] + '%'); })) : (_0xe47d8b[_0xfc9be7(0x250)][_0x1719c8][_0xfc9be7(0x901)] = !![], _0x55e530()); }), _0x2a19d5['addEventListener'](_0x54ed15(0x39c), _0x56fdd4), _0x3535f1[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0xe4925b), _0x2b1a9a[_0x54ed15(0x35e)]('click', () => _0x4b59a6[_0x54ed15(0x78f)][_0x54ed15(0x309)]('show')), _0xa9faa['addEventListener'](_0x54ed15(0x39c), () => _0x4b59a6[_0x54ed15(0x78f)][_0x54ed15(0x309)](_0x54ed15(0x373))), _0xb79f5b['addEventListener'](_0x54ed15(0x39c), () => _0xba7cdd[_0x54ed15(0x39c)]()), _0x3d3798['addEventListener'](_0x54ed15(0x39c), () => _0x19b554['click']()), _0xba7cdd[_0x54ed15(0x35e)](_0x54ed15(0x2ed), async _0x369232 => { const _0x493520 = _0x54ed15; if (_0x493520(0x920) === 'skrUk') { const _0x3b66b6 = _0x369232[_0x493520(0x921)]['files'][0x0]; if (!_0x3b66b6) return; try { _0xb79f5b['src'] = await _0x1bec17(_0x3b66b6); } catch (_0x2dc719) { _0x3383df(_0x493520(0x914) + _0x2dc719[_0x493520(0x399)]); } } else try { const _0x22f9b4 = _0x41f6c2['parse'](_0x1569ba['getItem']('badgeState') || '{}'), _0x2a412c = { ..._0x22f9b4, ..._0x1d221d }; _0x22f30e[_0x493520(0x6c6)](_0x493520(0x7a4), _0x6a5cb4[_0x493520(0x714)](_0x2a412c)); } catch (_0x10146f) { _0x234cde[_0x493520(0x8d6)]('保存徽章状态失败', _0x10146f); } }), _0x19b554[_0x54ed15(0x35e)](_0x54ed15(0x2ed), async _0x5df788 => { const _0x5de00e = _0x54ed15; if (_0x5de00e(0x9c0) !== _0x5de00e(0x9c0)) _0x21ab54[_0x5de00e(0x908)] = ''; else { const _0x104205 = _0x5df788[_0x5de00e(0x921)][_0x5de00e(0x626)][0x0]; if (!_0x104205) return; try { if (_0x5de00e(0x4c6) !== _0x5de00e(0x4c6)) { _0x45ccd4(_0x5de00e(0x9bc)); return; } else _0x3d3798[_0x5de00e(0x7d9)] = await _0x1bec17(_0x104205); } catch (_0x4c0284) { _0x5de00e(0x884) !== 'mJfjs' ? _0x3383df('错误:\x20' + _0x4c0284[_0x5de00e(0x399)]) : _0xeb9b4f = _0x5de00e(0x48b) + _0x5a1dbb[_0x5de00e(0x4e6)] + _0x5de00e(0x81e); } } }), _0x1d7949[_0x54ed15(0x35e)]('click', () => _0x10fc40['click']()), _0x3ba965[_0x54ed15(0x35e)]('click', () => { const _0x460746 = _0x54ed15; _0x460746(0x8cc) === 'fwJLH' ? _0x5c41ac['classList'][_0x460746(0x3d0)](_0x460746(0x415)) : (localStorage[_0x460746(0x845)](_0x460746(0x952)), _0x3e15ea(), _0x3383df(_0x460746(0x380))); }), _0x10fc40[_0x54ed15(0x35e)](_0x54ed15(0x2ed), async _0x4766f6 => { const _0x5c3c4d = _0x54ed15, _0xce885a = _0x4766f6[_0x5c3c4d(0x921)][_0x5c3c4d(0x626)][0x0]; if (!_0xce885a) return; try { const _0x257576 = await _0x1bec17(_0xce885a); localStorage['setItem']('customFeedWallpaper', _0x257576), _0x3e15ea(), _0x3383df('动态页背景已更换！'); } catch (_0x250fb8) { _0x5c3c4d(0x393) !== 'QURZk' ? (_0x314a10[_0x5c3c4d(0x2f5)] = _0x2c5da8[_0x5c3c4d(0x2f5)], _0x5ea2bc[_0x5c3c4d(0x7da)] = _0x507fb0[_0x5c3c4d(0x7da)]) : _0x3383df('错误:\x20' + _0x250fb8[_0x5c3c4d(0x399)]); } }), document['getElementById'](_0x54ed15(0x926))[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => _0x21dca3(_0x54ed15(0x755), _0x54ed15(0x1bd))), document[_0x54ed15(0x954)](_0x54ed15(0x7c0))[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x57c4d1); const _0x846aae = document[_0x54ed15(0x954)](_0x54ed15(0x8cf)), _0x2b7e04 = document[_0x54ed15(0x954)](_0x54ed15(0x3cd)); _0x846aae['addEventListener'](_0x54ed15(0x39c), () => _0x2b7e04['click']()), _0x2b7e04[_0x54ed15(0x35e)](_0x54ed15(0x2ed), _0x1aa6a1 => { const _0x2510df = _0x54ed15; if (_0x2510df(0x752) !== _0x2510df(0x752)) _0x9d04b3(), _0x4df0ec(_0x2510df(0x75c), _0x2510df(0x72b)); else { const _0x14e7cd = _0x1aa6a1[_0x2510df(0x921)][_0x2510df(0x626)][0x0]; if (!_0x14e7cd) return; const _0x12c1ee = URL[_0x2510df(0x8f3)](_0x14e7cd); _0x846aae[_0x2510df(0x7d9)] = _0x12c1ee, _0x846aae[_0x2510df(0x3cc)] = () => { const _0x185a93 = _0x2510df; 'WPgnx' !== _0x185a93(0x348) ? URL[_0x185a93(0x354)](_0x12c1ee) : _0x1460e5['accountingLedger'] = _0x253894[_0x185a93(0x4aa)]; }; } }); const _0x431107 = document[_0x54ed15(0x954)]('group-bg-preview')[_0x54ed15(0x7c7)], _0x42b2f2 = document[_0x54ed15(0x954)](_0x54ed15(0x457)), _0x30351a = document[_0x54ed15(0x954)](_0x54ed15(0x8e2)); _0x431107[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => _0x42b2f2[_0x54ed15(0x39c)]()), _0x42b2f2[_0x54ed15(0x35e)](_0x54ed15(0x2ed), _0x4a91a0 => { const _0x52e3ed = _0x54ed15, _0x1c3db7 = _0x4a91a0['target'][_0x52e3ed(0x626)][0x0]; if (!_0x1c3db7) return; const _0x3588b4 = URL[_0x52e3ed(0x8f3)](_0x1c3db7); _0x30351a[_0x52e3ed(0x7d9)] = _0x3588b4, _0x30351a[_0x52e3ed(0x3cc)] = () => { const _0x2dd307 = _0x52e3ed; URL[_0x2dd307(0x354)](_0x3588b4); }; }); const _0x307a15 = document['querySelector'](_0x54ed15(0x905)), _0x3c5106 = document[_0x54ed15(0x954)]('group-world-book-checkboxes'); _0x307a15[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x2be2c9 => { const _0x186357 = _0x54ed15; _0x2be2c9[_0x186357(0x6d5)](), _0x3c5106[_0x186357(0x78f)]['toggle'](_0x186357(0x238)), _0x307a15[_0x186357(0x78f)][_0x186357(0x622)](_0x186357(0x978)); }), _0x3c5106[_0x54ed15(0x35e)](_0x54ed15(0x2ed), _0x3c4123), document['getElementById'](_0x54ed15(0x2a3))[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x1f4d53), document['getElementById'](_0x54ed15(0x43a))[_0x54ed15(0x35e)](_0x54ed15(0x39c), async () => { const _0x5f3490 = _0x54ed15; if (_0x5f3490(0x850) !== _0x5f3490(0x850)) { const _0x4c6d49 = _0x500e3c[_0x5f3490(0x2c7)][_0x594dec]; _0x4c6d49 && _0x4c6d49[_0x5f3490(0x6c3)] > 0x0 && (_0x214f2e = _0x4c6d49['at'](-0x1)); } else { const _0x2da84f = _0x597f5f(); if (!_0x2da84f || _0x2da84f[_0x5f3490(0x62d)] !== 'group') return; const _0x5a0257 = await _0x57c3ed('确定要删除群聊“' + _0x2da84f[_0x5f3490(0x4e6)] + '”吗？此操作不可撤销。'); _0x5a0257 && (_0x43f7e7(_0x2da84f['id']), _0x3383df(_0x5f3490(0x32f)), _0x21dca3(_0x5f3490(0x755)), _0x4c5132(![])); } }); const _0x3b16dc = document[_0x54ed15(0x7c6)]('.custom-multiselect\x20.select-box'), _0x8c71fa = document[_0x54ed15(0x954)]('world-book-checkboxes-container'); _0x3b16dc[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x27c6a9 => { const _0x179046 = _0x54ed15; if ('GXjqx' !== _0x179046(0x8dd)) _0x27c6a9['stopPropagation'](), _0x8c71fa[_0x179046(0x78f)][_0x179046(0x622)](_0x179046(0x238)), _0x3b16dc[_0x179046(0x78f)][_0x179046(0x622)](_0x179046(0x978)); else { _0xed2d7a(_0x179046(0x87e)); return; } }), _0x8c71fa[_0x54ed15(0x35e)]('change', _0x1b2879), document[_0x54ed15(0x35e)]('click', _0x5459f4 => { const _0x5cdd1f = _0x54ed15; !document[_0x5cdd1f(0x7c6)](_0x5cdd1f(0x3e3))[_0x5cdd1f(0x6ce)](_0x5459f4[_0x5cdd1f(0x921)]) && (_0x8c71fa[_0x5cdd1f(0x78f)][_0x5cdd1f(0x309)](_0x5cdd1f(0x238)), _0x3b16dc[_0x5cdd1f(0x78f)]['remove'](_0x5cdd1f(0x978))); }), _0x5749b6[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x23b919 = _0x54ed15; _0x23b919(0x7b8) !== _0x23b919(0x7b8) ? _0x871f5b[_0x23b919(0x354)](_0x5b29cb) : (_0x58ab62(), _0x21dca3(_0x23b919(0x672), 'home')); }), document[_0x54ed15(0x954)](_0x54ed15(0x92e))['addEventListener'](_0x54ed15(0x39c), () => _0x21dca3(_0x54ed15(0x72b), 'worldBook')), document['getElementById'](_0x54ed15(0x422))['addEventListener'](_0x54ed15(0x39c), () => _0x326f75()), document[_0x54ed15(0x954)](_0x54ed15(0x8c3))[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x1103d7 = _0x54ed15; _0x1103d7(0x57d) !== _0x1103d7(0x222) ? (_0x58ab62(), _0x21dca3(_0x1103d7(0x672), _0x1103d7(0x2ab))) : _0x4a9c1a['error'](_0x1103d7(0x66a), _0xe06ff0); }), document[_0x54ed15(0x954)](_0x54ed15(0x3a7))[_0x54ed15(0x35e)]('click', _0x2aa369), document[_0x54ed15(0x954)](_0x54ed15(0x3ba))['addEventListener'](_0x54ed15(0x39c), _0x2a4aaf), _0x4cff91[_0x54ed15(0x35e)]('click', () => _0x21dca3(_0x54ed15(0x581), _0x54ed15(0x72b))), _0x47afa0[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => _0x21dca3(_0x54ed15(0x72b), _0x54ed15(0x581))), _0x3d7e6a[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => _0x4dce3e[_0x54ed15(0x39c)]()), _0x4dce3e[_0x54ed15(0x35e)](_0x54ed15(0x2ed), async _0x3ff7f7 => { const _0x4b38da = _0x54ed15, _0xb8ed3f = _0x3ff7f7[_0x4b38da(0x921)]['files'][0x0]; if (!_0xb8ed3f) return; await _0x5af6e1(_0xb8ed3f); }), _0x5eb710['addEventListener'](_0x54ed15(0x39c), () => { const _0x3d8885 = _0x54ed15; _0x546ea8(), _0x21dca3(_0x3d8885(0x755), _0x3d8885(0x72b)); }), _0xcc32de[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x3fda70 = _0x54ed15; if (_0x3fda70(0x92a) !== _0x3fda70(0x303)) { _0x1f1d77(); const _0x3e0c2e = (_0x346f80[_0x3fda70(0x98c)][_0x3fda70(0x4b6)] || '')[_0x3fda70(0x84e)](_0x3a4007); _0x543207[_0x3fda70(0x7bc)] = _0x3e0c2e, _0x21dca3(_0x3fda70(0x7c8), _0x3fda70(0x72b)); } else { _0x55eb18(); const _0xdd42a0 = _0xd0d14f(_0x3fda70(0x3ea), _0x4e6c2b['name']); _0xdd42a0 && _0xdd42a0[_0x3fda70(0x4dd)]() && _0xdd42a0 !== _0x186f78[_0x3fda70(0x4e6)] && (_0x723918[_0x3fda70(0x4e6)] = _0xdd42a0['trim'](), _0x28770d(), _0x4cd2d4(), _0x1a3a46(), _0x4b22b2(_0x3fda70(0x8a6) + _0x1cc929[_0x3fda70(0x4e6)] + '\x22。')); } }), _0x304682['addEventListener'](_0x54ed15(0x39c), () => _0x21dca3('home', _0x54ed15(0x7c8))), _0x3f8dc4[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x5817d7 = _0x54ed15; _0x5817d7(0x96d) !== _0x5817d7(0x96d) ? _0x395506 ? _0x12ec79(_0x1c5727) : _0x5b74a2(new _0x53507b('Canvas\x20to\x20Blob\x20conversion\x20failed.')) : (_0x28a937(), _0x21dca3(_0x5817d7(0x72b), _0x5817d7(0x755))); }), _0x4902ec[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { _0x28a937(), _0x4c5132(![]); }), _0x228fad[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { _0x21dca3('chat', 'characterEdit'); }), _0xa2fb27['addEventListener'](_0x54ed15(0x39c), () => { const _0x3a19ab = _0x54ed15; _0x3a19ab(0x65e) === _0x3a19ab(0x65e) ? _0x587210[_0x3a19ab(0x78f)][_0x3a19ab(0x3d0)]('show') : (_0x20a481[_0x3a19ab(0x6c6)](_0x3a19ab(0x368), _0x37cd58[_0x3a19ab(0x714)](_0x4e0394)), _0x418505(_0x3a19ab(0x9e3)), _0x243529(() => _0x3c975d[_0x3a19ab(0x55a)](), 0x5dc)); }), _0x5e0246[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => _0x57bdaa()), _0x17d505[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x2a6a82); function _0x27738a(_0x2e4d77) { const _0x4cc9d8 = _0x54ed15; if (!_0x2e4d77 || _0x2e4d77[_0x4cc9d8(0x62d)] !== _0x4cc9d8(0x661)) return; const _0x211ae0 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22group-options-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-clear-history\x22\x20class=\x22choice-modal-button\x22>清空聊天记录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-members\x22\x20class=\x22choice-modal-button\x22>编辑群成员</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-name\x22\x20class=\x22choice-modal-button\x22>修改群名称</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#ff4d4d;\x22>删除群聊</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-options-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'; document[_0x4cc9d8(0x302)][_0x4cc9d8(0x272)](_0x4cc9d8(0x189), _0x211ae0); const _0x3a1d8a = document['getElementById']('group-options-modal'), _0x1e2cd8 = _0x3a1d8a['querySelector']('.choice-modal-backdrop'), _0x3f8e98 = document[_0x4cc9d8(0x954)](_0x4cc9d8(0x971)), _0x9d0d37 = document[_0x4cc9d8(0x954)](_0x4cc9d8(0x494)), _0xfb968e = document[_0x4cc9d8(0x954)]('group-edit-name'), _0x533cfe = document['getElementById']('group-delete'), _0x3e160d = document[_0x4cc9d8(0x954)]('group-options-cancel'), _0x5d8867 = () => _0x3a1d8a['remove'](); _0x3f8e98[_0x4cc9d8(0x35e)](_0x4cc9d8(0x39c), async () => { const _0x213d44 = _0x4cc9d8; _0x5d8867(); const _0x6fb7c5 = await _0x57c3ed(_0x213d44(0x6d3) + _0x2e4d77[_0x213d44(0x4e6)] + _0x213d44(0x602)); if (_0x6fb7c5) { if ('XKcGB' === _0x213d44(0x769)) { _0x2e4d77['id'] === _0x346f80[_0x213d44(0x509)] && (_0x28a937(), _0x346f80[_0x213d44(0x250)] = [], _0x1e1fc7()); try { localStorage['removeItem'](_0x213d44(0x649) + _0x2e4d77['id']), _0x3383df(_0x213d44(0x8e5) + _0x2e4d77[_0x213d44(0x4e6)] + '\x22\x20的聊天记录已清空。'); } catch (_0xd299d) { if (_0x213d44(0x88c) !== _0x213d44(0x564)) console[_0x213d44(0x8d6)](_0x213d44(0x83b) + _0x2e4d77['id'], _0xd299d), _0x3383df('清空聊天记录失败。'); else { _0x54cda2(_0x213d44(0x2ab), _0x213d44(0x672)); if (_0x504d9c) { const _0xb740b4 = _0x140e9a[_0x213d44(0x814)][_0x213d44(0x247)](_0x1fc59f => _0x1fc59f['id'] === _0x2cf1ca); if (!_0xb740b4) return; _0x466b10[_0x213d44(0x954)](_0x213d44(0x44f))[_0x213d44(0x908)] = _0xb740b4['id'], _0xb8b683[_0x213d44(0x954)](_0x213d44(0x4f0))[_0x213d44(0x96c)] = _0x213d44(0x95c), _0x1c1214[_0x213d44(0x954)](_0x213d44(0x878))[_0x213d44(0x908)] = _0xb740b4[_0x213d44(0x4e6)], _0x37e378[_0x213d44(0x954)]('world-book-edit-content')[_0x213d44(0x908)] = _0xb740b4[_0x213d44(0x2fc)]; } else _0x1684fa['getElementById'](_0x213d44(0x44f))['value'] = '', _0x3a7a83[_0x213d44(0x954)]('world-book-editor-title')[_0x213d44(0x96c)] = _0x213d44(0x90a), _0x2a2c82[_0x213d44(0x954)](_0x213d44(0x878))['value'] = '', _0x1a6eab['getElementById'](_0x213d44(0x7bd))[_0x213d44(0x908)] = ''; } } } else { const _0x11fb94 = _0x340645[_0x213d44(0x59e)](_0x143842, _0x213d44(0x1e2)), _0x1203f9 = _0x11fb94[_0x213d44(0x8e1)](_0xcb1ab), _0x53397a = _0x1203f9[_0x213d44(0x84d)](_0x419c35); _0x53397a[_0x213d44(0x8fb)] = () => _0x144cf1(), _0x53397a[_0x213d44(0x41e)] = () => _0x4ed2cd(_0x53397a[_0x213d44(0x8d6)]); } } }), _0x9d0d37[_0x4cc9d8(0x35e)](_0x4cc9d8(0x39c), () => { const _0x17b05d = _0x4cc9d8; _0x17b05d(0x6d7) === _0x17b05d(0x6d7) ? (_0x5d8867(), _0x3383df('编辑群成员功能正在开发中...')) : (_0x420c51(), _0x945914(![])); }), _0xfb968e['addEventListener'](_0x4cc9d8(0x39c), async () => { const _0x2cd506 = _0x4cc9d8; if (_0x2cd506(0x8f4) !== _0x2cd506(0x8f4)) return ''; else { _0x5d8867(); const _0x38188f = prompt(_0x2cd506(0x3ea), _0x2e4d77[_0x2cd506(0x4e6)]); _0x38188f && _0x38188f[_0x2cd506(0x4dd)]() && _0x38188f !== _0x2e4d77[_0x2cd506(0x4e6)] && (_0x2cd506(0x81f) === _0x2cd506(0x81f) ? (_0x2e4d77[_0x2cd506(0x4e6)] = _0x38188f[_0x2cd506(0x4dd)](), _0x23c6b9(), _0x546ea8(), _0x5e630d(), _0x3383df('群名称已更改为\x22' + _0x2e4d77[_0x2cd506(0x4e6)] + '\x22。')) : _0xdd4870 += _0x3cb565[_0x2cd506(0x781)](_0x424bc9)[_0x2cd506(0x44c)][0x0][_0x2cd506(0x2fc)][_0x2cd506(0x4bf)][0x0]['text']); } }), _0x533cfe[_0x4cc9d8(0x35e)](_0x4cc9d8(0x39c), async () => { const _0x59aa91 = _0x4cc9d8; _0x5d8867(); const _0x2603ae = await _0x57c3ed(_0x59aa91(0x574) + _0x2e4d77[_0x59aa91(0x4e6)] + _0x59aa91(0x685)); _0x2603ae && (_0x43f7e7(_0x2e4d77['id']), _0x3383df('群聊\x22' + _0x2e4d77[_0x59aa91(0x4e6)] + _0x59aa91(0x653)), _0x4c5132(![])); }), _0x1e2cd8['addEventListener']('click', _0x5d8867), _0x3e160d[_0x4cc9d8(0x35e)](_0x4cc9d8(0x39c), _0x5d8867); } _0x320b91[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x2abae8 = _0x54ed15, _0x50754a = _0x597f5f(); if (_0x50754a && _0x50754a[_0x2abae8(0x62d)] === _0x2abae8(0x328)) _0x49866d(_0x50754a[_0x2abae8(0x717)][0x0]); else _0x50754a && _0x50754a[_0x2abae8(0x62d)] === _0x2abae8(0x661) && _0x1ee362(_0x50754a['id']); }), _0x2bab43[_0x54ed15(0x35e)](_0x54ed15(0x491), _0x4e649b => { const _0x15188c = _0x54ed15; _0x4e649b[_0x15188c(0x955)] === _0x15188c(0x3fc) && !_0x4e649b[_0x15188c(0x31f)] && (_0x4e649b[_0x15188c(0x45f)](), _0x57bdaa()); }); const _0x396385 = () => _0x587210[_0x54ed15(0x78f)][_0x54ed15(0x309)]('show'); _0x2d2946[_0x54ed15(0x35e)]('click', _0x396385), _0x14dfb8[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x396385), _0x5734fa[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x5febeb = _0x54ed15; _0x5febeb(0x645) === _0x5febeb(0x36d) ? (_0x376bb2('欢迎！请先创建一个角色开始聊天。'), _0x11a335(() => { const _0x2825c3 = _0x5febeb; _0x25f37a(_0x2825c3(0x755), 'home'), _0x3759d3(() => _0x5e8908(), 0x64); }, 0x6a4)) : (_0x396385(), _0x49866d()); }), _0x59253f[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { 'DSrTJ' === 'DSrTJ' ? (_0x396385(), _0x3307f4()) : (_0x1538aa = '0x' + _0x2d673c[0x1] + _0x3de4c3[0x2], _0x10e391 = '0x' + _0xe92e1a[0x3] + _0xbe7ef2[0x4], _0x5d30d9 = '0x' + _0x51c29f[0x5] + _0x437eec[0x6]); }), _0x560c19['addEventListener'](_0x54ed15(0x39c), () => { const _0x505b58 = _0x54ed15; _0x505b58(0x732) === _0x505b58(0x732) ? (_0x21dca3(_0x505b58(0x755), _0x505b58(0x7eb)), _0x4c5132(![])) : _0x40a225[_0x505b58(0x6a9)] = _0x281e4c; }), _0x895e8d[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x42e874), _0x2b6768[_0x54ed15(0x35e)]('click', () => { const _0x4af1a6 = _0x54ed15; _0x24aa0[_0x4af1a6(0x78f)]['toggle']('show'), _0x24aa0[_0x4af1a6(0x78f)][_0x4af1a6(0x6ce)](_0x4af1a6(0x373)) && (_0x5a55b2['scrollTop'] = _0x5a55b2[_0x4af1a6(0x678)]); }), _0x3560db[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => _0xd80c7[_0x54ed15(0x39c)]()); const _0x54113b = document[_0x54ed15(0x954)]('chat-music-button'); _0xd80c7[_0x54ed15(0x35e)](_0x54ed15(0x2ed), _0x83eeaf), _0x54113b[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x3c7f95), _0x3c6b5a[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x31369a), _0x44d6fe[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x5a8deb), _0x9ea70d[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x151e2a), _0x40e1ae[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x1f4d53), _0x376a49[_0x54ed15(0x35e)]('click', async () => { const _0x5d7e5b = _0x54ed15; if (_0x5d7e5b(0x5ec) !== _0x5d7e5b(0x5ec)) { const _0xedb79f = _0x295e47[_0x5d7e5b(0x59e)](_0x4282ca, _0x5d7e5b(0x1e2)), _0x582166 = _0xedb79f[_0x5d7e5b(0x8e1)](_0x1147b5), _0x501905 = _0x582166[_0x5d7e5b(0x1b2)](_0x3dfdc3); _0x501905[_0x5d7e5b(0x8fb)] = () => _0x433ce5(_0x501905['result']), _0x501905[_0x5d7e5b(0x41e)] = () => _0x2407b2(_0x501905[_0x5d7e5b(0x8d6)]); } else { const _0x3aaabf = _0x38aed[_0x5d7e5b(0x908)]; if (!_0x3aaabf) return; const _0x13dabf = _0x5122c0(_0x3aaabf); if (!_0x13dabf) return; const _0x4a2b02 = await _0x57c3ed('确定要删除角色“' + _0x13dabf[_0x5d7e5b(0x4e6)] + _0x5d7e5b(0x6ab)); _0x4a2b02 && (_0xd1b23e(_0x3aaabf), _0x3383df(_0x5d7e5b(0x858) + _0x13dabf['name'] + _0x5d7e5b(0x97c)), _0x21dca3(_0x5d7e5b(0x755), _0x5d7e5b(0x9c3)), _0x4c5132(![])); } }), _0x24b906[_0x54ed15(0x35e)]('input', () => { const _0xb591d2 = _0x54ed15; if ('asGsC' !== _0xb591d2(0x311)) { const _0x40708b = _0x24b906[_0xb591d2(0x908)][_0xb591d2(0x4dd)]()['includes'](_0x3a4007); _0x543207[_0xb591d2(0x7bc)] = _0x40708b; } else _0x569bcd(); }); async function _0x2036fa() { const _0x4d7a6c = _0x54ed15; if (_0x4d7a6c(0x688) === _0x4d7a6c(0x688)) { const _0x566c55 = _0x24b906[_0x4d7a6c(0x908)][_0x4d7a6c(0x4dd)](), _0x21a420 = _0x74f9b5[_0x4d7a6c(0x908)][_0x4d7a6c(0x4dd)](); if (!_0x566c55 || !_0x21a420) { _0x3383df('请先输入\x20API\x20接口地址和密钥。'); return; } const _0x2fcc26 = _0x566c55['replace'](/\/+$/, ''), _0x169ec2 = _0x2fcc26 + _0x4d7a6c(0x51c); _0x543207['disabled'] = !![], _0x543207[_0x4d7a6c(0x96c)] = '获取中…', _0xbb0d47[_0x4d7a6c(0x78f)][_0x4d7a6c(0x309)](_0x4d7a6c(0x373)); try { if ('DyuVv' !== _0x4d7a6c(0x875)) { const _0x3aa88c = _0x29e81a[_0x4d7a6c(0x954)](_0xbde1e); _0x3aa88c['innerHTML'] = '', _0x5cb12e[_0x4d7a6c(0x2f5)][_0x4d7a6c(0x927)](_0x1a2352 => { const _0x418bcd = _0x4d7a6c, _0xa5e51d = _0x312882[_0x418bcd(0x820)](_0x418bcd(0x183)); _0xa5e51d['value'] = _0x1a2352['id'], _0xa5e51d[_0x418bcd(0x96c)] = _0x1a2352[_0x418bcd(0x4e6)], _0x3aa88c[_0x418bcd(0x204)](_0xa5e51d); }); } else { const _0x2b246c = await fetch(_0x169ec2, { 'headers': { 'Authorization': _0x4d7a6c(0x80f) + _0x14faa7(_0x21a420) } }); if (!_0x2b246c['ok']) throw new Error(_0x4d7a6c(0x2f2) + _0x2b246c[_0x4d7a6c(0x9cf)]); const _0x2288e8 = await _0x2b246c['json'](), _0x47db39 = (_0x2288e8['data'] || _0x2288e8)[_0x4d7a6c(0x2a0)](_0x55451f => _0x55451f['id'])['sort'](); _0x47db39[_0x4d7a6c(0x6c3)] > 0x0 ? _0x4d7a6c(0x307) !== _0x4d7a6c(0x307) ? _0x2dc6c7[_0x4d7a6c(0x7d9)] && _0x4b8425[_0x4d7a6c(0x94f)][_0x4d7a6c(0x1cb)] !== '0' ? (_0x2a48ce[_0x4d7a6c(0x94f)][_0x4d7a6c(0x1cb)] = 0x0, _0x38ba05(() => { const _0x4129a4 = _0x4d7a6c; _0x509d41[_0x4129a4(0x7d9)] = _0x2e2860[_0x4129a4(0x8f3)](_0x390fd0), _0x157fbc[_0x4129a4(0x94f)][_0x4129a4(0x1cb)] = 0x1; }, 0x96)) : (_0x3eaf26[_0x4d7a6c(0x7d9)] = _0x567432['createObjectURL'](_0x35830a), _0x468a52[_0x4d7a6c(0x94f)][_0x4d7a6c(0x1cb)] = 0x1) : (_0xbb0d47['innerHTML'] = '', _0x47db39[_0x4d7a6c(0x927)](_0x2d4b20 => { const _0x4a9488 = _0x4d7a6c; if (_0x4a9488(0x957) === _0x4a9488(0x46d)) _0x4059d1[_0x4a9488(0x2ce)] = _0x531ed0[_0x4a9488(0x678)]; else { const _0x4c03de = document[_0x4a9488(0x820)](_0x4a9488(0x41a)); _0x4c03de['textContent'] = _0x2d4b20, _0x4c03de[_0x4a9488(0x35e)](_0x4a9488(0x39c), () => { const _0x4ccd09 = _0x4a9488; _0x3b092f[_0x4ccd09(0x908)] = _0x2d4b20, _0xbb0d47[_0x4ccd09(0x78f)][_0x4ccd09(0x309)]('show'); }), _0xbb0d47[_0x4a9488(0x204)](_0x4c03de); } }), _0xbb0d47['classList'][_0x4d7a6c(0x3d0)]('show'), _0x3383df(_0x4d7a6c(0x436) + _0x47db39['length'] + _0x4d7a6c(0x745))) : _0x3383df(_0x4d7a6c(0x9d1)); } } catch (_0x2e26a5) { if (_0x4d7a6c(0x981) !== 'CBoDY') _0x3383df(_0x4d7a6c(0x9ce) + _0x2e26a5[_0x4d7a6c(0x399)] + '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1'); else { if (!_0xc2631e) return; _0x5e15d5 = _0x31c256[_0x4d7a6c(0x4f5)][0x0][_0x4d7a6c(0x808)], _0x136d71 === 'horizontal' && _0x2a217e(), _0x1218dd = ![]; } } finally { _0x543207[_0x4d7a6c(0x7bc)] = ![], _0x543207[_0x4d7a6c(0x96c)] = '获取'; } } else _0x44fc9a[_0x4d7a6c(0x8d6)](_0x4d7a6c(0x1f8) + _0x278a56 + _0x4d7a6c(0x218) + _0x1ff0fc + '):', _0x4c2f38), _0x8c6029[_0x4d7a6c(0x4ea)] = null, _0x237263[_0x4d7a6c(0x32c)] = null; } _0x543207[_0x54ed15(0x35e)]('click', _0x3b357e => { const _0x494962 = _0x54ed15; if (_0x494962(0x842) !== _0x494962(0x842)) { const _0x50b200 = _0x9cbf6f['querySelector'](_0x494962(0x226)); if (_0x50b200) _0x50b200[_0x494962(0x309)](); } else _0x3b357e[_0x494962(0x6d5)](), _0x2036fa(); }), document[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x24927a => { const _0x12162f = _0x54ed15; _0x12162f(0x36e) !== 'yxmoc' ? _0x4de73c[_0x12162f(0x6a9)] = _0x12162f(0x438) + _0x56de29 + _0x12162f(0x473) : !_0xbb0d47['contains'](_0x24927a[_0x12162f(0x921)]) && _0x24927a[_0x12162f(0x921)] !== _0x3b092f && _0x24927a[_0x12162f(0x921)] !== _0x543207 && _0xbb0d47[_0x12162f(0x78f)][_0x12162f(0x309)](_0x12162f(0x373)); }); async function _0x1bec17(_0x4a85d2) { return await _0x2ea925(_0x4a85d2, 0x190, 0.85); } _0x311d8d[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => _0x4bf07c[_0x54ed15(0x39c)]()), _0x4bf07c[_0x54ed15(0x35e)](_0x54ed15(0x2ed), async _0x400a96 => { const _0x509e9f = _0x54ed15; if (_0x509e9f(0x468) !== _0x509e9f(0x468)) _0x215c0a[_0x509e9f(0x96c)] = _0x2de663[_0x509e9f(0x4a3)] === _0x509e9f(0x47f) ? '旁白' : _0x24ce02[_0x509e9f(0x4a3)], _0xbad436[_0x509e9f(0x96c)] = _0x4aafd9[_0x509e9f(0x493)], _0x413e44[_0x509e9f(0x4a3)] === _0x5908dc[_0x509e9f(0x4e6)] ? _0x4bb623(_0x1827c4, _0x3f2d76[_0x509e9f(0x7aa)]) : _0x3aa973(_0x1faa74, 'normal'); else { const _0xd29b56 = _0x400a96['target'][_0x509e9f(0x626)][0x0]; if (!_0xd29b56) return; try { const _0x53f7cd = await _0x1bec17(_0xd29b56); _0x311d8d[_0x509e9f(0x7d9)] = _0x53f7cd; } catch (_0x234c31) { _0x3383df('错误:\x20' + _0x234c31[_0x509e9f(0x399)]); } } }), _0x1f81b5['addEventListener']('click', () => _0x39ce78[_0x54ed15(0x39c)]()), _0x39ce78[_0x54ed15(0x35e)](_0x54ed15(0x2ed), async _0x20430a => { const _0x38b0fe = _0x54ed15, _0x42e3ec = _0x20430a[_0x38b0fe(0x921)][_0x38b0fe(0x626)][0x0]; if (!_0x42e3ec) return; try { _0x38b0fe(0x211) === _0x38b0fe(0x747) ? _0xb760d[_0x38b0fe(0x580)](_0x1c92ee['id']) : _0x1f81b5[_0x38b0fe(0x7d9)] = await _0x1bec17(_0x42e3ec); } catch (_0x52a1fd) { _0x38b0fe(0x88a) === _0x38b0fe(0x6ad) ? _0x3c277c[_0x38b0fe(0x8ad)](_0x36c270, { 'songName': _0x4bef0f, 'artist': _0x3936f0, 'coverId': null, 'playableUrl': null }) : _0x3383df('错误:\x20' + _0x52a1fd[_0x38b0fe(0x399)]); } }); function _0x89fcff() { const _0x5bf5c9 = _0x54ed15; if ('xiAky' === _0x5bf5c9(0x60f)) { _0x16d02c = _0x4aebfa(); const _0x456531 = _0x310595[_0x5bf5c9(0x954)]('char-name-header')['textContent']; _0x3320fa = _0x456531 || _0x5bf5c9(0x74c); } else _0x24aa0['innerHTML'] = '', _0xfd4511['forEach'](_0x2d2494 => { const _0x171a43 = _0x5bf5c9; if (_0x171a43(0x82d) === _0x171a43(0x82d)) { const _0x54135e = document[_0x171a43(0x820)]('img'); _0x54135e[_0x171a43(0x7d9)] = _0x2d2494[_0x171a43(0x4ee)], _0x54135e[_0x171a43(0x99c)] = _0x171a43(0x592), _0x54135e[_0x171a43(0x6bf)] = _0x2d2494[_0x171a43(0x4e6)], _0x54135e[_0x171a43(0x78f)][_0x171a43(0x3d0)](_0x171a43(0x98f)), _0x54135e[_0x171a43(0x35e)](_0x171a43(0x39c), () => _0x3963c0(_0x2d2494)), _0x24aa0[_0x171a43(0x204)](_0x54135e); } else _0x495d4b(_0x171a43(0x6af) + _0x1cfeb9[_0x171a43(0x399)]); }); } function _0x27b8dd() { const _0x49309a = _0x54ed15; if ('nMbgm' === _0x49309a(0x31e)) { const _0x3bc59c = document[_0x49309a(0x954)]('user-profile-list-container'); _0x3bc59c[_0x49309a(0x6a9)] = ''; if (_0x346f80['userProfiles'][_0x49309a(0x6c3)] === 0x0) { _0x3bc59c[_0x49309a(0x6a9)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>'; return; } _0x346f80['userProfiles'][_0x49309a(0x927)](_0x1394d4 => { const _0x3c6596 = _0x49309a; if ('NwHPS' === _0x3c6596(0x395)) { const _0x26470f = document[_0x3c6596(0x820)]('div'); _0x26470f[_0x3c6596(0x941)] = _0x3c6596(0x723), _0x26470f[_0x3c6596(0x86c)]['id'] = _0x1394d4['id']; const _0x2d4bef = _0x1394d4['id'] === _0x346f80[_0x3c6596(0x7da)] ? _0x3c6596(0x485) : ''; _0x26470f[_0x3c6596(0x6a9)] = _0x3c6596(0x173) + (_0x1394d4[_0x3c6596(0x4ef)] || _0x223ec8) + _0x3c6596(0x738) + _0x1394d4[_0x3c6596(0x4e6)] + _0x2d4bef + _0x3c6596(0x95a) + _0x1394d4[_0x3c6596(0x1a5)][_0x3c6596(0x8f0)](0x0, 0x64) + _0x3c6596(0x6f5), _0x26470f['addEventListener'](_0x3c6596(0x39c), () => _0x13343a(_0x1394d4['id'])), _0x3bc59c[_0x3c6596(0x204)](_0x26470f); } else _0x315fd1(), _0x151a23(_0x3c6596(0x316), 'home'); }); } else { const _0x1c725c = _0x5d9467(_0x55c9ab[_0x49309a(0x5dd)]) || { 'name': '未知' }; let _0x1021d9 = '-\x20[动态]\x20' + _0x1c725c[_0x49309a(0x4e6)] + _0x49309a(0x319) + (_0x125d00[_0x49309a(0x52d)] || _0x50dac1['content']) + '”'; return _0x5849b8[_0x49309a(0x62d)] === _0x49309a(0x632) && (_0x1021d9 += _0x49309a(0x1e6) + _0x4ce31c[_0x49309a(0x9be)] + _0x49309a(0x218) + _0x27e8e0[_0x49309a(0x53d)] + ')'), _0x1021d9; } } function _0x13343a(_0x44bfff = null) { const _0x521386 = _0x54ed15; _0x21dca3(_0x521386(0x364), 'userProfileList'); const _0x2d92d5 = document[_0x521386(0x954)](_0x521386(0x9c9)); if (_0x44bfff) { const _0xa20f59 = _0x346f80[_0x521386(0x2f5)][_0x521386(0x247)](_0x3ad22f => _0x3ad22f['id'] === _0x44bfff); if (!_0xa20f59) return; document[_0x521386(0x954)](_0x521386(0x92b))['value'] = _0xa20f59['id'], document[_0x521386(0x954)](_0x521386(0x3e8))[_0x521386(0x96c)] = _0x521386(0x7df), document[_0x521386(0x954)](_0x521386(0x57a))[_0x521386(0x908)] = _0xa20f59[_0x521386(0x4e6)], document[_0x521386(0x954)](_0x521386(0x21b))[_0x521386(0x7d9)] = _0xa20f59[_0x521386(0x4ef)], document[_0x521386(0x954)](_0x521386(0x6cb))[_0x521386(0x908)] = _0xa20f59[_0x521386(0x1a5)], _0x2d92d5['style'][_0x521386(0x3b4)] = _0xa20f59['id'] === _0x346f80[_0x521386(0x7da)] ? _0x521386(0x910) : _0x521386(0x810); } else document['getElementById'](_0x521386(0x92b))[_0x521386(0x908)] = '', document['getElementById'](_0x521386(0x3e8))[_0x521386(0x96c)] = _0x521386(0x915), document[_0x521386(0x954)](_0x521386(0x57a))[_0x521386(0x908)] = _0x521386(0x816) + (_0x346f80['userProfiles'][_0x521386(0x6c3)] + 0x1), document['getElementById'](_0x521386(0x21b))[_0x521386(0x7d9)] = _0x223ec8, document['getElementById'](_0x521386(0x6cb))['value'] = '', _0x2d92d5['style'][_0x521386(0x3b4)] = _0x521386(0x910); } function _0x5a8deb() { const _0x78ae0f = _0x54ed15; if (_0x78ae0f(0x766) !== _0x78ae0f(0x766)) _0x5bf862['scrollIntoView']({ 'behavior': _0x78ae0f(0x18c), 'block': _0x78ae0f(0x4e1) }); else { const _0x489a7f = document['getElementById'](_0x78ae0f(0x92b))['value'], _0x359fc7 = { 'name': document[_0x78ae0f(0x954)](_0x78ae0f(0x57a))[_0x78ae0f(0x908)][_0x78ae0f(0x4dd)](), 'persona': document['getElementById'](_0x78ae0f(0x6cb))['value']['trim'](), 'avatar': document[_0x78ae0f(0x954)](_0x78ae0f(0x21b))[_0x78ae0f(0x7d9)] }; if (!_0x359fc7[_0x78ae0f(0x4e6)]) { _0x3383df('名字不能为空！'); return; } if (_0x489a7f) { const _0x1ca046 = _0x346f80[_0x78ae0f(0x2f5)][_0x78ae0f(0x247)](_0x31ddbd => _0x31ddbd['id'] === _0x489a7f); if (_0x1ca046) Object[_0x78ae0f(0x8ad)](_0x1ca046, _0x359fc7); } else { const _0x2dbf12 = { 'id': _0x78ae0f(0x702) + Date[_0x78ae0f(0x909)](), ..._0x359fc7 }; _0x346f80[_0x78ae0f(0x2f5)][_0x78ae0f(0x580)](_0x2dbf12), !_0x346f80[_0x78ae0f(0x7da)] && (_0x346f80[_0x78ae0f(0x7da)] = _0x2dbf12['id']); } _0x23c6b9(), _0x3383df(_0x78ae0f(0x9d0)), _0x27b8dd(), _0x21dca3(_0x78ae0f(0x765), _0x78ae0f(0x364)); } } async function _0x491c8c() { const _0x5b364b = _0x54ed15; if (_0x5b364b(0x6ca) === _0x5b364b(0x9a2)) _0x506a97(), _0x500a91(); else { const _0x4a495b = document[_0x5b364b(0x954)]('editing-user-id')[_0x5b364b(0x908)]; if (!_0x4a495b) return; if (_0x346f80['userProfiles'][_0x5b364b(0x6c3)] <= 0x1) { if (_0x5b364b(0x613) !== _0x5b364b(0x356)) { _0x3383df(_0x5b364b(0x1b6)); return; } else { const _0x2f11d3 = _0x99cd1a[_0x5b364b(0x59e)](_0x2fe708, _0x5b364b(0x1e2)), _0x56dc45 = _0x2f11d3['objectStore'](_0x4e23fb), _0x57ff4c = _0x56dc45[_0x5b364b(0x1b2)]({ 'id': _0x596713, 'blob': _0x39f8bd }); _0x57ff4c[_0x5b364b(0x8fb)] = () => _0x29e256(_0x57ff4c[_0x5b364b(0x37b)]), _0x57ff4c[_0x5b364b(0x41e)] = () => _0x54b4b7(_0x57ff4c[_0x5b364b(0x8d6)]); } } const _0x6c6bcb = await _0x57c3ed(_0x5b364b(0x8e6)); _0x6c6bcb && (_0x5b364b(0x838) !== _0x5b364b(0x838) ? _0x3b4ab5[_0x5b364b(0x78f)][_0x5b364b(0x309)]('show') : (_0x346f80[_0x5b364b(0x2f5)] = _0x346f80[_0x5b364b(0x2f5)]['filter'](_0x415eb6 => _0x415eb6['id'] !== _0x4a495b), _0x346f80[_0x5b364b(0x7da)] === _0x4a495b && (_0x346f80[_0x5b364b(0x7da)] = _0x346f80[_0x5b364b(0x2f5)][0x0]['id']), _0x346f80[_0x5b364b(0x3aa)]['forEach'](_0x146111 => { const _0x218097 = _0x5b364b; _0x146111[_0x218097(0x96f)] === _0x4a495b && (_0x146111['boundUserProfileId'] = _0x346f80[_0x218097(0x7da)]); }), _0x23c6b9(), _0x3383df('用户已删除。'), _0x27b8dd(), _0x21dca3(_0x5b364b(0x765), _0x5b364b(0x364)))); } } function _0x58ab62() { const _0x5684b8 = _0x54ed15, _0x92e791 = document[_0x5684b8(0x954)]('world-book-list-container'); _0x92e791[_0x5684b8(0x6a9)] = ''; if (_0x346f80[_0x5684b8(0x814)][_0x5684b8(0x6c3)] === 0x0) { if (_0x5684b8(0x81c) === _0x5684b8(0x81c)) { _0x92e791['innerHTML'] = _0x5684b8(0x966); return; } else _0x32fbb9(_0x5684b8(0x6bb)); } _0x346f80['worldBooks'][_0x5684b8(0x927)](_0x8543a2 => { const _0x1ea759 = _0x5684b8; if (_0x1ea759(0x759) !== _0x1ea759(0x759)) _0xdec1f3(![]), _0x3975c2[_0x1ea759(0x8d6)](_0x1ea759(0x1dd), _0x419b79), _0x31476c(_0x1ea759(0x593) + _0x313bf5[_0x1ea759(0x399)]); else { const _0x402d9a = document[_0x1ea759(0x820)](_0x1ea759(0x41a)); _0x402d9a[_0x1ea759(0x941)] = _0x1ea759(0x723), _0x402d9a[_0x1ea759(0x86c)]['id'] = _0x8543a2['id'], _0x402d9a[_0x1ea759(0x6a9)] = _0x1ea759(0x6bc) + _0x8543a2[_0x1ea759(0x4e6)] + _0x1ea759(0x913) + _0x8543a2[_0x1ea759(0x2fc)]['substring'](0x0, 0x64) + _0x1ea759(0x52c), _0x402d9a['addEventListener'](_0x1ea759(0x39c), () => _0x326f75(_0x8543a2['id'])), _0x92e791['appendChild'](_0x402d9a); } }); } function _0x326f75(_0x5cac43 = null) { const _0x283eee = _0x54ed15; _0x21dca3('worldBookEditor', _0x283eee(0x672)); if (_0x5cac43) { const _0x30d7a8 = _0x346f80[_0x283eee(0x814)][_0x283eee(0x247)](_0x5827cd => _0x5827cd['id'] === _0x5cac43); if (!_0x30d7a8) return; document[_0x283eee(0x954)]('editing-world-book-id')[_0x283eee(0x908)] = _0x30d7a8['id'], document['getElementById']('world-book-editor-title')[_0x283eee(0x96c)] = _0x283eee(0x95c), document[_0x283eee(0x954)](_0x283eee(0x878))['value'] = _0x30d7a8[_0x283eee(0x4e6)], document[_0x283eee(0x954)](_0x283eee(0x7bd))[_0x283eee(0x908)] = _0x30d7a8[_0x283eee(0x2fc)]; } else { if (_0x283eee(0x389) === _0x283eee(0x389)) document[_0x283eee(0x954)](_0x283eee(0x44f))[_0x283eee(0x908)] = '', document[_0x283eee(0x954)](_0x283eee(0x4f0))[_0x283eee(0x96c)] = _0x283eee(0x90a), document[_0x283eee(0x954)](_0x283eee(0x878))[_0x283eee(0x908)] = '', document['getElementById'](_0x283eee(0x7bd))[_0x283eee(0x908)] = ''; else { const _0x4bb58f = _0x129a36[_0x283eee(0x921)][_0x283eee(0x626)][0x0]; if (!_0x4bb58f) return; const _0x47566b = _0x3f87dd[_0x283eee(0x8f3)](_0x4bb58f); _0x3e30f9['src'] = _0x47566b, _0x59fff9[_0x283eee(0x3cc)] = () => { const _0x14e938 = _0x283eee; _0x1b0859[_0x14e938(0x354)](_0x47566b); }; } } } function _0x2aa369() { const _0x47a266 = _0x54ed15, _0x238872 = document[_0x47a266(0x954)]('editing-world-book-id')[_0x47a266(0x908)], _0x5329f0 = document[_0x47a266(0x954)](_0x47a266(0x878))['value'][_0x47a266(0x4dd)](), _0xa4cd78 = document['getElementById'](_0x47a266(0x7bd))[_0x47a266(0x908)][_0x47a266(0x4dd)](); if (!_0x5329f0 || !_0xa4cd78) { if (_0x47a266(0x58a) !== _0x47a266(0x4fa)) { _0x3383df(_0x47a266(0x21a)); return; } else { const _0x2057d0 = _0x1d968e['characters'][_0x47a266(0x247)](_0x4540fb => _0xce8a03[_0x47a266(0x717)][_0x47a266(0x84e)](_0x4540fb['id']) && _0x4540fb['name'] === _0x1ad133); if (_0x2057d0) _0x34e243 = _0x2057d0['id']; } } if (_0x238872) { if (_0x47a266(0x2e7) !== _0x47a266(0x2e7)) { const _0x45c75a = _0x5e40a6[_0x47a266(0x5fb)][_0x47a266(0x2a0)](_0x18b6fd => { const _0x3b41a6 = _0x47a266, _0x5d67c6 = _0x259412(_0x18b6fd[_0x3b41a6(0x5dd)])?.[_0x3b41a6(0x4e6)] || '未知'; return _0x3b41a6(0x55e) + _0x5d67c6 + _0x3b41a6(0x51a) + _0x18b6fd[_0x3b41a6(0x2fc)] + '</div>'; })[_0x47a266(0x6e6)](''); _0x446706 = _0x47a266(0x724) + _0x45c75a + _0x47a266(0x49e); } else { const _0x47fe88 = _0x346f80[_0x47a266(0x814)][_0x47a266(0x247)](_0x178bb3 => _0x178bb3['id'] === _0x238872); _0x47fe88 && (_0x47a266(0x544) === _0x47a266(0x763) ? _0x1d0fe1[_0x47a266(0x4b3)]() : (_0x47fe88[_0x47a266(0x4e6)] = _0x5329f0, _0x47fe88['content'] = _0xa4cd78)); } } else { const _0x3353a2 = { 'id': _0x47a266(0x2de) + Date[_0x47a266(0x909)](), 'name': _0x5329f0, 'content': _0xa4cd78 }; _0x346f80[_0x47a266(0x814)][_0x47a266(0x580)](_0x3353a2); } _0x23c6b9(), _0x3383df(_0x47a266(0x7b4)), _0x58ab62(), _0x21dca3(_0x47a266(0x672), _0x47a266(0x2ab)); } async function _0x2a4aaf() { const _0x1a2015 = _0x54ed15, _0x52359b = document[_0x1a2015(0x954)](_0x1a2015(0x44f))[_0x1a2015(0x908)]; if (!_0x52359b) return; const _0x5b87d5 = await _0x57c3ed(_0x1a2015(0x39e)); _0x5b87d5 && (_0x1a2015(0x1fb) !== _0x1a2015(0x1fb) ? (_0x27d705[_0x1a2015(0x8d6)]('总结失败:', _0x71ea7a), _0x1c40d1[_0x1a2015(0x908)] = _0x1a2015(0x5b8) + _0x1e96cc[_0x1a2015(0x399)]) : (_0x346f80[_0x1a2015(0x814)] = _0x346f80['worldBooks'][_0x1a2015(0x6e8)](_0x18015a => _0x18015a['id'] !== _0x52359b), _0x346f80['characters'][_0x1a2015(0x927)](_0x3d6894 => { const _0x9966a7 = _0x1a2015; _0x3d6894[_0x9966a7(0x925)] && (_0x3d6894[_0x9966a7(0x925)] = _0x3d6894['linkedWorldBookIds']['filter'](_0x3bc04b => _0x3bc04b !== _0x52359b)); }), _0x23c6b9(), _0x3383df(_0x1a2015(0x937)), _0x58ab62(), _0x21dca3(_0x1a2015(0x672), _0x1a2015(0x2ab)))); } function _0x1b2879() { const _0x5271c0 = _0x54ed15, _0x2615e3 = document['getElementById'](_0x5271c0(0x704)), _0x2be879 = _0x2615e3[_0x5271c0(0x6a0)](_0x5271c0(0x3dd)), _0x315ae0 = document[_0x5271c0(0x7c6)](_0x5271c0(0x95d)); if (_0x2be879[_0x5271c0(0x6c3)] === 0x0) _0x315ae0['textContent'] = _0x5271c0(0x733); else _0x2be879[_0x5271c0(0x6c3)] > 0x2 ? _0x315ae0[_0x5271c0(0x96c)] = _0x5271c0(0x361) + _0x2be879[_0x5271c0(0x6c3)] + '\x20项' : _0x5271c0(0x7e6) === _0x5271c0(0x7ce) ? _0x336da[_0x5271c0(0x580)]('[' + _0x13e4e8(_0x19a1e9) + ']\x20[sticker:' + (_0xb14f1c[_0x5271c0(0x2fc)]?.[_0x5271c0(0x2bc)](/：(.+?)]/)?.[0x1] || '表情') + ']') : _0x315ae0[_0x5271c0(0x96c)] = Array[_0x5271c0(0x73e)](_0x2be879)['map'](_0x17cde0 => _0x17cde0[_0x5271c0(0x7c7)][_0x5271c0(0x96c)][_0x5271c0(0x4dd)]())[_0x5271c0(0x6e6)]('、'); } function _0x1ee362(_0x2e15ce) { const _0x505147 = _0x54ed15, _0x76f274 = _0x346f80['chats'][_0x505147(0x247)](_0x41f9c9 => _0x41f9c9['id'] === _0x2e15ce); if (!_0x76f274 || _0x76f274['type'] !== _0x505147(0x661)) return; document[_0x505147(0x954)](_0x505147(0x3f4))[_0x505147(0x908)] = _0x76f274[_0x505147(0x4e6)] || '', _0x334ad5(_0x505147(0x23e)), document[_0x505147(0x954)](_0x505147(0x23e))[_0x505147(0x908)] = _0x76f274[_0x505147(0x96f)] || _0x346f80['activeUserProfileId']; const _0x4a9ede = document['getElementById'](_0x505147(0x326)); _0x4a9ede[_0x505147(0x6a9)] = '', _0x346f80['worldBooks'][_0x505147(0x927)](_0x4dcd0b => { const _0x497fad = _0x505147; if (_0x497fad(0x421) === _0x497fad(0x7ca)) { const _0x338275 = _0x5c199e['senderId'] ? _0x3799fe(_0x24de36[_0x497fad(0x980)]) : null; return _0x338275?.[_0x497fad(0x4e6)] || _0x497fad(0x215); } else { const _0x56f357 = _0x76f274[_0x497fad(0x925)]?.[_0x497fad(0x84e)](_0x4dcd0b['id']), _0xae6f03 = document[_0x497fad(0x820)]('label'); _0xae6f03[_0x497fad(0x6a9)] = _0x497fad(0x60c) + _0x4dcd0b['id'] + '\x22\x20' + (_0x56f357 ? _0x497fad(0x896) : '') + '>\x20' + _0x4dcd0b['name'], _0x4a9ede[_0x497fad(0x204)](_0xae6f03); } }), _0x3c4123(); const _0x45441b = document['getElementById']('group-avatar-preview'), _0x150795 = document[_0x505147(0x954)](_0x505147(0x8e2)); _0x4f16ca(_0x505147(0x3bf) + _0x2e15ce)[_0x505147(0x710)](_0x932b66 => { const _0x2f6f1e = _0x505147; if ('Aaqxt' !== _0x2f6f1e(0x35c)) { const _0x4198a2 = _0x14925b[_0x2f6f1e(0x4a8)][_0x2f6f1e(0x247)](_0xbc6592 => _0xbc6592['id'] === _0x59a8b3[_0x2f6f1e(0x903)]), _0x3bb8d1 = _0x4198a2?.[_0x2f6f1e(0x96f)]; let _0x280c98 = _0x3fcc78[_0x2f6f1e(0x2f5)]['find'](_0x1758e8 => _0x1758e8['id'] === _0x3bb8d1); !_0x280c98 && (_0x280c98 = _0x4bcebb[_0x2f6f1e(0x2f5)][_0x2f6f1e(0x247)](_0x5b35ff => _0x5b35ff['id'] === _0xb6c5a1[_0x2f6f1e(0x7da)])), !_0x280c98 && (_0x280c98 = _0x3d44fe[_0x2f6f1e(0x2f5)][0x0]), _0x280c98 && (_0x5e61c8[_0x2f6f1e(0x954)](_0x2f6f1e(0x53f))['src'] = _0x280c98[_0x2f6f1e(0x4ef)] || _0x17a5a1); } else _0x45441b[_0x2f6f1e(0x7d9)] = _0x932b66 ? URL[_0x2f6f1e(0x8f3)](_0x932b66) : _0x2f6e79; }), _0x4f16ca(_0x505147(0x2bf) + _0x2e15ce)[_0x505147(0x710)](_0x19222b => { const _0x1a1002 = _0x505147; if (_0x1a1002(0x433) !== _0x1a1002(0x2c5)) _0x150795[_0x1a1002(0x7d9)] = _0x19222b ? URL[_0x1a1002(0x8f3)](_0x19222b) : ''; else { if (_0x4da27f) _0x2a015d[_0x1a1002(0x39c)](); } }), _0x21dca3(_0x505147(0x1bd), 'chat'); } async function _0x57c4d1() { const _0x434b9b = _0x54ed15, _0x93afbb = _0x597f5f(); if (!_0x93afbb || _0x93afbb['type'] !== _0x434b9b(0x661)) return; const _0x333d10 = document[_0x434b9b(0x954)]('group-settings-name')[_0x434b9b(0x908)][_0x434b9b(0x4dd)](); if (!_0x333d10) { _0x3383df(_0x434b9b(0x666)); return; } _0x93afbb[_0x434b9b(0x4e6)] = _0x333d10; const _0x552ecb = document['querySelectorAll']('#group-world-book-checkboxes\x20input:checked'); _0x93afbb[_0x434b9b(0x925)] = Array[_0x434b9b(0x73e)](_0x552ecb)[_0x434b9b(0x2a0)](_0x501a37 => _0x501a37[_0x434b9b(0x908)]), _0x93afbb[_0x434b9b(0x96f)] = document[_0x434b9b(0x954)](_0x434b9b(0x23e))[_0x434b9b(0x908)]; const _0x108637 = document['getElementById'](_0x434b9b(0x3cd))[_0x434b9b(0x626)][0x0], _0x23503a = document[_0x434b9b(0x954)](_0x434b9b(0x457))[_0x434b9b(0x626)][0x0]; if (_0x108637) await _0x336559(_0x434b9b(0x3bf) + _0x93afbb['id'], _0x108637); if (_0x23503a) await _0x336559(_0x434b9b(0x2bf) + _0x93afbb['id'], _0x23503a); _0x23c6b9(), _0x5e630d(), await _0x546ea8(), _0x3383df(_0x434b9b(0x6a1)), _0x21dca3('chat', _0x434b9b(0x1bd)); } function _0x3c4123() { const _0x22c488 = _0x54ed15, _0x16bff9 = document[_0x22c488(0x954)](_0x22c488(0x326)), _0x51c42b = _0x16bff9[_0x22c488(0x6a0)](_0x22c488(0x3dd)), _0xca69fd = document[_0x22c488(0x7c6)](_0x22c488(0x96a)); if (_0x51c42b[_0x22c488(0x6c3)] === 0x0) _0xca69fd['textContent'] = '--\x20点击选择\x20--'; else _0x51c42b['length'] > 0x2 ? _0xca69fd[_0x22c488(0x96c)] = _0x22c488(0x361) + _0x51c42b['length'] + '\x20项' : _0x22c488(0x5a0) === _0x22c488(0x7d2) ? _0x4b9d80['type'] === _0x22c488(0x661) && (_0x10667c[_0x22c488(0x717)] = _0x1f4869[_0x22c488(0x717)]['filter'](_0x2d30b8 => _0x2d30b8 !== _0x5d9fca)) : _0xca69fd['textContent'] = Array[_0x22c488(0x73e)](_0x51c42b)[_0x22c488(0x2a0)](_0x272f4c => _0x272f4c[_0x22c488(0x7c7)][_0x22c488(0x96c)][_0x22c488(0x4dd)]())[_0x22c488(0x6e6)]('、'); } async function _0x4062d1() { const _0x14c3e4 = _0x54ed15, _0xb548d9 = _0x597f5f(), _0x47a8e4 = (_0xb548d9?.[_0x14c3e4(0x717)] || [])[_0x14c3e4(0x2a0)](_0x5122c0)[_0x14c3e4(0x6e8)](Boolean), _0x5948fb = _0x3d25f9(_0xb548d9['id']); if (!_0xb548d9 || _0xb548d9['type'] !== _0x14c3e4(0x661) || _0x47a8e4[_0x14c3e4(0x6c3)] < 0x2) return null; const _0x3886cb = _0xb548d9[_0x14c3e4(0x925)] && _0xb548d9[_0x14c3e4(0x925)][_0x14c3e4(0x6c3)] > 0x0 ? _0x14c3e4(0x836) + _0xb548d9[_0x14c3e4(0x925)]['map'](_0x22c7fd => _0x346f80[_0x14c3e4(0x814)][_0x14c3e4(0x247)](_0x1ff806 => _0x1ff806['id'] === _0x22c7fd))['filter'](Boolean)[_0x14c3e4(0x2a0)](_0x4ba483 => '\x0a##\x20世界书条目:\x20' + _0x4ba483[_0x14c3e4(0x4e6)] + '\x0a' + _0x4ba483[_0x14c3e4(0x2fc)])['join']('') : '', _0x59b1c4 = _0x5948fb[_0x14c3e4(0x1a5)] ? '\x0a\x0a#\x20关于群聊参与者“' + _0x5948fb[_0x14c3e4(0x4e6)] + _0x14c3e4(0x56b) + _0x5948fb[_0x14c3e4(0x1a5)] : ''; let _0x58b6f3 = ''; const _0x330a1b = new Date(), _0x1d02a2 = _0x346f80[_0x14c3e4(0x250)]['at'](-0x1); _0x58b6f3 += _0x14c3e4(0x1ef) + _0x330a1b[_0x14c3e4(0x6de)](_0x14c3e4(0x6dd), { 'dateStyle': 'full', 'timeStyle': _0x14c3e4(0x618) }); if (_0x1d02a2) { const _0xefaf97 = new Date(_0x1d02a2['timestamp']), _0x413838 = Math['floor']((_0x330a1b - _0xefaf97) / (0x3e8 * 0x3c)); if (_0x413838 < 0x5) _0x58b6f3 += _0x14c3e4(0x3c3); else { if (_0x413838 < 0x78) _0x58b6f3 += '\x0a-\x20**对话状态**:\x20群里在' + _0x413838 + _0x14c3e4(0x826); else { if ('wyEDr' !== 'VQCtt') { const _0xdb0ec = Math[_0x14c3e4(0x353)](_0x413838 / 0x3c); if (_0xdb0ec < 0x30) _0x58b6f3 += _0x14c3e4(0x867) + _0xdb0ec + _0x14c3e4(0x541); else _0x58b6f3 += _0x14c3e4(0x824) + Math[_0x14c3e4(0x353)](_0xdb0ec / 0x18) + _0x14c3e4(0x86d); } else _0xb703c0 = _0x2a161c['avatar'] || _0x10f58c, _0x1f635a = _0x4c2a2d[_0x14c3e4(0x4e6)] || _0x14c3e4(0x7f4), _0x12ae49 = _0x2ee101['remark'] || '私聊'; } } } else { if (_0x14c3e4(0x7f6) !== _0x14c3e4(0x3a0)) _0x58b6f3 += _0x14c3e4(0x94c); else { const _0x1f0f0d = _0x1ab28b(_0x90cb75[_0x14c3e4(0x5dd)]); _0x1f0f0d && (_0x5d0d20 = _0x1f0f0d[_0x14c3e4(0x4e6)], _0x30affd = _0x1f0f0d[_0x14c3e4(0x4ef)]); } } const _0x16632a = [..._0x346f80[_0x14c3e4(0x250)]]['reverse']()['find'](_0x30cf1c => _0x30cf1c[_0x14c3e4(0x6b9)] === _0x14c3e4(0x619))?.['content'] || '', _0x57f445 = _0x3a35c2(_0xb548d9, _0x16632a), _0x57349a = _0x346f80[_0x14c3e4(0x250)][_0x14c3e4(0x290)](-0x78), _0x48f817 = _0xfd4511[_0x14c3e4(0x2a0)](_0x29b133 => _0x29b133[_0x14c3e4(0x4e6)]), _0x57386c = _0x5e45d9(), _0x5bf855 = _0x47a8e4['map'](_0x58a5d5 => { const _0x2f2bcd = _0x14c3e4, { omniText: _0x1ccc14 } = _0x4aa25d(_0x58a5d5['id'], _0xb548d9['id']), _0x1e0912 = _0xb8d7f(_0x58a5d5['id']), _0x19fc5b = _0x58a5d5['linkedWorldBookIds'] && _0x58a5d5[_0x2f2bcd(0x925)]['length'] > 0x0 ? '\x0a\x0a#\x20' + _0x58a5d5[_0x2f2bcd(0x4e6)] + _0x2f2bcd(0x558) + _0x58a5d5['linkedWorldBookIds'][_0x2f2bcd(0x2a0)](_0x5e3b09 => _0x346f80[_0x2f2bcd(0x814)][_0x2f2bcd(0x247)](_0x373f09 => _0x373f09['id'] === _0x5e3b09))[_0x2f2bcd(0x6e8)](Boolean)[_0x2f2bcd(0x2a0)](_0x216a84 => _0x2f2bcd(0x700) + _0x216a84[_0x2f2bcd(0x4e6)] + '\x0a' + _0x216a84['content'])[_0x2f2bcd(0x6e6)]('') : ''; return { 'id': _0x58a5d5['id'], 'name': _0x58a5d5[_0x2f2bcd(0x4e6)], 'persona': _0x58a5d5[_0x2f2bcd(0x1a5)] || _0x2f2bcd(0x30b), 'memory': _0x1ccc14 + _0x1e0912 + _0x19fc5b }; }), _0x4a2680 = 0x5, _0x5ea554 = 0xc, _0x219c9f = _0x14c3e4(0x16c)['trim'](), _0x4a7255 = { 'instruction': ('\x0a-\x20你正在为一个名为“' + (_0x5948fb[_0x14c3e4(0x4e6)] || '用户') + _0x14c3e4(0x2d8) + (_0x5948fb[_0x14c3e4(0x4e6)] || '用户') + '”。在分析历史记录时，请记住这一点，并用此名称指代用户。\x0a-\x20【最重要】为\x20`personas`\x20列表中的【每一位】角色都规划至少一个事件(通常不少于2个)。不能遗漏任何角色。\x0a-\x20【新增规则】你可以规划\x20\x22kind\x22:\x20\x22music\x22\x20事件来分享音乐。此时，你【必须】同时提供\x20\x22songName\x22\x20和\x20\x22artist\x22\x20字段。\x0a-\x20你的首要任务是产出一个严格遵守SCHEMA、语法完全正确的、可被解析的JSON对象。\x0a-\x20若用户\x20`@`\x20了某个角色\x20(见\x20`mentioned`)，该角色应优先发言。\x0a-\x20事件总数必须控制在\x20' + _0x4a2680 + _0x14c3e4(0x165) + _0x5ea554 + _0x14c3e4(0x63a) + (_0x5948fb[_0x14c3e4(0x4e6)] || '用户') + _0x14c3e4(0x6f7) + _0x58b6f3 + '\x20\x0a' + _0x59b1c4 + '\x0a' + _0x3886cb + _0x14c3e4(0x65a) + _0x57386c + '\x0a')[_0x14c3e4(0x4dd)](), 'personas': _0x5bf855, 'mentioned': _0x57f445 ? { 'id': _0x57f445['id'], 'name': _0x57f445[_0x14c3e4(0x4e6)] } : null, 'stickerList': _0x48f817 }, _0x3255ab = { 'type': _0x14c3e4(0x186), 'properties': { 'events': { 'type': _0x14c3e4(0x8b8), 'items': { 'type': _0x14c3e4(0x186), 'required': ['senderId', _0x14c3e4(0x975)], 'properties': { 'senderId': { 'type': _0x14c3e4(0x17c) }, 'kind': { 'type': _0x14c3e4(0x17c), 'enum': ['text', _0x14c3e4(0x53c), 'music'] }, 'content': { 'type': _0x14c3e4(0x17c) }, 'sticker': { 'type': 'string' }, 'songName': { 'type': _0x14c3e4(0x17c) }, 'artist': { 'type': _0x14c3e4(0x17c) } } } } }, 'required': [_0x14c3e4(0x289)] }, _0x44434b = []; _0x44434b[_0x14c3e4(0x580)]({ 'role': _0x14c3e4(0x9ca), 'content': _0x219c9f }); for (const _0x3e5818 of _0x57349a) { if (_0x14c3e4(0x405) === 'SUZaf') { const _0x196373 = _0x3e5818[_0x14c3e4(0x6b9)] === 'ai' || _0x3e5818[_0x14c3e4(0x6b9)] === 'assistant' ? _0x14c3e4(0x81d) : _0x14c3e4(0x619); let _0xe41cca = { 'role': _0x196373, 'content': _0x3e5818['content'] }, _0x3b77d5 = !!_0x3e5818[_0x14c3e4(0x2fc)], _0x44e228 = null; if (_0x3e5818[_0x14c3e4(0x85e)]) _0x44e228 = _0x3e5818['image']; else { if (_0x3e5818[_0x14c3e4(0x1e4)]) try { if (_0x14c3e4(0x23a) !== _0x14c3e4(0x464)) { const _0x472620 = await _0x4f16ca(_0x3e5818[_0x14c3e4(0x1e4)]); _0x472620 && (_0x44e228 = await _0x58722e(_0x472620)); } else { const _0x2851df = _0x35c03c['getElementById'](_0x14c3e4(0x345)); _0x2851df[_0x14c3e4(0x96c)] = _0xce677e, _0x2851df[_0x14c3e4(0x94f)]['display'] = 'block'; if (_0x2872de['_t']) _0x2875b8(_0x2af7e2['_t']); _0x4a4826['_t'] = _0x3c3c16(() => { const _0x49ef19 = _0x14c3e4; _0x2851df[_0x49ef19(0x94f)][_0x49ef19(0x3b4)] = _0x49ef19(0x910); }, 0x640); } } catch (_0x5e94dd) { console[_0x14c3e4(0x8d6)]('在准备群聊API数据时，读取图片失败:', _0x5e94dd); } } if (_0x44e228) { if (_0x14c3e4(0x35a) !== _0x14c3e4(0x5e3)) _0xe41cca[_0x14c3e4(0x85e)] = _0x44e228, _0x3b77d5 = !![]; else { const _0x3f948f = { 'role': _0x14c3e4(0x81d), 'content': _0x14c3e4(0x665) + _0x5390eb[_0x14c3e4(0x4e6)] + ']', 'displayUrl': _0x562d06['url'], 'senderId': _0x5a78f5['senderId'], 'timestamp': _0x8c8c24['now'](), 'isOffline': _0x3f36fc }; _0x220ecb[_0x14c3e4(0x250)][_0x14c3e4(0x580)](_0x3f948f); } } _0x3b77d5 && _0x44434b[_0x14c3e4(0x580)](_0xe41cca); } else { _0x1b4177('已经生成了今日账单！想看就去“看账本”标签页。'); return; } } _0x44434b[_0x14c3e4(0x580)]({ 'role': _0x14c3e4(0x619), 'content': '请严格按照以下SCHEMA返回一个JSON对象，不要包含任何额外文字。\x0aSCHEMA:\x0a' + JSON[_0x14c3e4(0x714)](_0x3255ab) + _0x14c3e4(0x8ef) + JSON[_0x14c3e4(0x714)](_0x4a7255) }); try { const _0x52607e = await _0x555f32(_0x44434b, { 'json': !![] }); if (!_0x52607e) return null; let _0x1053d7 = _0x52607e[_0x14c3e4(0x4dd)](); const _0x53d4b8 = _0x1053d7['match'](/```json([\s\S]*?)```/i); if (_0x53d4b8) _0x1053d7 = _0x53d4b8[0x1][_0x14c3e4(0x4dd)](); _0x1053d7 = _0x3e00ba(_0x1053d7); let _0x2843c3 = null; try { _0x2843c3 = JSON[_0x14c3e4(0x781)](_0x1053d7); } catch (_0x1def23) { console[_0x14c3e4(0x8d6)]('JSON\x20解析失败!\x20错误原因:', _0x1def23), console[_0x14c3e4(0x8d6)](_0x14c3e4(0x4e5), _0x1053d7); } if (!_0x2843c3 || !Array['isArray'](_0x2843c3['events'])) return null; return _0x2843c3 = _0x1b7034(_0x2843c3, _0x47a8e4, _0x48f817), _0x2843c3[_0x14c3e4(0x289)] = _0x2843c3[_0x14c3e4(0x289)][_0x14c3e4(0x290)](0x0, _0x5ea554), _0x2843c3[_0x14c3e4(0x289)]['length'] ? _0x2843c3 : null; } catch (_0x511cd0) { if (_0x14c3e4(0x956) !== 'DESzR') return _0x511cd0[_0x14c3e4(0x4e6)] !== _0x14c3e4(0x8ee) && console[_0x14c3e4(0x8d6)](_0x14c3e4(0x4df), _0x511cd0), null; else _0x38cc2d = _0x14c3e4(0x720) + _0x37f49e; } } function _0xbcfea() { const _0x48ec1b = _0x54ed15; if ('exbsL' !== _0x48ec1b(0x4d6)) _0x50784[_0x48ec1b(0x96f)] === _0x55037a && (_0x44435a[_0x48ec1b(0x96f)] = _0x441d16[_0x48ec1b(0x7da)]); else { const _0x51af10 = document[_0x48ec1b(0x954)](_0x48ec1b(0x9a9)); _0x51af10[_0x48ec1b(0x6a9)] = ''; if (_0x346f80[_0x48ec1b(0x4a8)][_0x48ec1b(0x6c3)] === 0x0) { if (_0x48ec1b(0x900) !== _0x48ec1b(0x1a3)) { _0x51af10[_0x48ec1b(0x6a9)] = _0x48ec1b(0x67b); return; } else { if (_0x1e7ca4[_0x48ec1b(0x62d)] === _0x48ec1b(0x661)) return _0x48ec1b(0x6ae) + (_0x136a0a['name'] || _0x48ec1b(0x735)) + '」'; const _0x5f4cdb = _0x36097c(_0x1faa1d['participantIds'][0x0]); return '与\x20' + (_0x5f4cdb?.['name'] || _0x48ec1b(0x317)) + _0x48ec1b(0x70e); } } _0x346f80[_0x48ec1b(0x4a8)][_0x48ec1b(0x927)](_0x2ffc63 => { const _0x4fda09 = _0x48ec1b; if (_0x4fda09(0x3e4) === _0x4fda09(0x1a8)) _0x50672d[_0x4fda09(0x6d5)](), _0x526d30[_0x4fda09(0x78f)][_0x4fda09(0x622)](_0x4fda09(0x238)), _0x31715f['classList'][_0x4fda09(0x622)](_0x4fda09(0x978)); else { const _0x13b338 = _0x346f80[_0x4fda09(0x2f5)]['find'](_0x5061a9 => _0x5061a9['id'] === _0x2ffc63[_0x4fda09(0x96f)]) || { 'name': '未知用户' }, _0x289510 = document[_0x4fda09(0x820)]('div'); _0x289510['className'] = _0x4fda09(0x723), _0x289510['dataset']['id'] = _0x2ffc63['id'], _0x289510['innerHTML'] = _0x4fda09(0x6bc) + _0x2ffc63['name'] + _0x4fda09(0x96b) + _0x13b338[_0x4fda09(0x4e6)] + _0x4fda09(0x521) + _0x2ffc63[_0x4fda09(0x805)][_0x4fda09(0x6c3)] + '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', _0x289510[_0x4fda09(0x35e)](_0x4fda09(0x39c), () => _0x48da6d(_0x2ffc63['id'])), _0x51af10[_0x4fda09(0x204)](_0x289510); } }); } } function _0x158cf0(_0x27cdfa = null) { const _0x339013 = _0x54ed15; if (_0x339013(0x22e) !== _0x339013(0x540)) { const _0x309897 = document['getElementById']('friend-circle-edit-name'), _0x5de07d = document[_0x339013(0x954)](_0x339013(0x431)), _0xdd6978 = document['getElementById'](_0x339013(0x56d)), _0x4496ed = document[_0x339013(0x954)](_0x339013(0x4e9)), _0xca642f = document[_0x339013(0x954)](_0x339013(0x1ce)), _0x18a167 = document[_0x339013(0x954)](_0x339013(0x7db)); _0x334ad5('friend-circle-edit-bind-user'), _0xdd6978['innerHTML'] = '', _0x346f80[_0x339013(0x499)][_0x339013(0x927)](_0x80ff22 => { const _0x206f1b = _0x339013; if (_0x206f1b(0x351) !== _0x206f1b(0x351)) throw new _0x11e666(_0x206f1b(0x886)); else { const _0x5b3db5 = document[_0x206f1b(0x820)]('div'); _0x5b3db5[_0x206f1b(0x941)] = _0x206f1b(0x22a), _0x5b3db5[_0x206f1b(0x6a9)] = '\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-' + _0x80ff22['id'] + _0x206f1b(0x2ba) + _0x80ff22['id'] + _0x206f1b(0x8b9) + (_0x80ff22[_0x206f1b(0x4ef)] || _0x2f6e79) + _0x206f1b(0x62f) + _0x80ff22['id'] + _0x206f1b(0x2b9) + _0x80ff22[_0x206f1b(0x4e6)] + _0x206f1b(0x20f), _0xdd6978['appendChild'](_0x5b3db5); } }); if (_0x27cdfa) { const _0x4aff55 = _0x346f80[_0x339013(0x4a8)][_0x339013(0x247)](_0x53a983 => _0x53a983['id'] === _0x27cdfa); if (!_0x4aff55) return; _0x4496ed[_0x339013(0x96c)] = _0x339013(0x300), _0xca642f[_0x339013(0x908)] = _0x4aff55['id'], _0x309897[_0x339013(0x908)] = _0x4aff55[_0x339013(0x4e6)], _0x5de07d['value'] = _0x4aff55[_0x339013(0x96f)], _0x18a167[_0x339013(0x94f)][_0x339013(0x3b4)] = _0x339013(0x810), _0x4aff55['memberCharacterIds'][_0x339013(0x927)](_0x50f37e => { const _0x50b6bb = _0x339013, _0x579929 = _0xdd6978['querySelector'](_0x50b6bb(0x829) + _0x50f37e); if (_0x579929) _0x579929['checked'] = !![]; }); } else _0x4496ed[_0x339013(0x96c)] = _0x339013(0x840), _0xca642f[_0x339013(0x908)] = '', _0x309897[_0x339013(0x908)] = '好友圈\x20' + (_0x346f80[_0x339013(0x4a8)][_0x339013(0x6c3)] + 0x1), _0x5de07d[_0x339013(0x908)] = _0x346f80[_0x339013(0x7da)], _0x18a167[_0x339013(0x94f)][_0x339013(0x3b4)] = 'none'; _0x21dca3(_0x339013(0x986), _0x339013(0x4ed)); } else _0x48b6ee(_0x50a690 - 0x1); } function _0x3742a8() { const _0x405a3f = _0x54ed15, _0x6901a2 = document[_0x405a3f(0x954)](_0x405a3f(0x1ce))[_0x405a3f(0x908)], _0x51f951 = document['getElementById']('friend-circle-edit-name')['value'][_0x405a3f(0x4dd)](), _0x4f3000 = document[_0x405a3f(0x954)](_0x405a3f(0x431))[_0x405a3f(0x908)], _0x108d05 = Array[_0x405a3f(0x73e)](document[_0x405a3f(0x6a0)](_0x405a3f(0x25a)))[_0x405a3f(0x2a0)](_0x3b0470 => _0x3b0470[_0x405a3f(0x86c)]['id']); if (!_0x51f951) { _0x3383df(_0x405a3f(0x9bc)); return; } if (_0x108d05[_0x405a3f(0x6c3)] === 0x0) { _0x3383df('至少要选择一个圈内成员！'); return; } if (_0x6901a2) { const _0x5cbce5 = _0x346f80[_0x405a3f(0x4a8)][_0x405a3f(0x247)](_0x2228c7 => _0x2228c7['id'] === _0x6901a2); _0x5cbce5 && (_0x5cbce5[_0x405a3f(0x4e6)] = _0x51f951, _0x5cbce5[_0x405a3f(0x96f)] = _0x4f3000, _0x5cbce5[_0x405a3f(0x805)] = _0x108d05); } else { if ('vTxmX' === _0x405a3f(0x1be)) { const _0x4252d7 = { 'id': _0x405a3f(0x268) + Date[_0x405a3f(0x909)](), 'name': _0x51f951, 'boundUserProfileId': _0x4f3000, 'memberCharacterIds': _0x108d05, 'posts': [] }; _0x346f80[_0x405a3f(0x4a8)][_0x405a3f(0x580)](_0x4252d7); } else { const _0x2cc5c3 = _0x405a3f(0x787) + _0x367c73; let _0x50907c = _0x10f341['getElementById'](_0x2cc5c3); if (_0x50907c) return; const _0x3130ec = '\x0a\x20\x20\x20\x20<div\x20id=\x22' + _0x2cc5c3 + _0x405a3f(0x73b) + (_0x4b0689 === 'ai' ? _0x405a3f(0x63e) : '') + _0x405a3f(0x5af); _0x5214d8[_0x405a3f(0x302)][_0x405a3f(0x272)](_0x405a3f(0x189), _0x3130ec); const _0x39c7c5 = _0x5d7534[_0x405a3f(0x954)](_0x2cc5c3), _0xcf4db9 = () => _0x39c7c5[_0x405a3f(0x309)](); _0x39c7c5[_0x405a3f(0x7c6)](_0x405a3f(0x7e8))[_0x405a3f(0x1b0)] = _0xcf4db9, _0x39c7c5[_0x405a3f(0x7c6)](_0x405a3f(0x977))[_0x405a3f(0x1b0)] = _0xcf4db9, _0x39c7c5[_0x405a3f(0x7c6)](_0x405a3f(0x6db))[_0x405a3f(0x1b0)] = () => { _0x516d20(_0x502657), _0xcf4db9(); }, _0x22513d === 'ai' && (_0x39c7c5[_0x405a3f(0x7c6)]('#diary-action-reroll')['onclick'] = () => { _0x723ff6(_0x5496b5), _0xcf4db9(); }); } } _0x23c6b9(), _0x3383df('好友圈已保存！'), _0xbcfea(), _0x21dca3(_0x405a3f(0x4ed), 'friendCircleEdit'); } async function _0x45ba74() { const _0x2b28fb = _0x54ed15; if (_0x2b28fb(0x860) !== _0x2b28fb(0x322)) { const _0x13fe00 = document[_0x2b28fb(0x954)]('editing-friend-circle-id')[_0x2b28fb(0x908)]; if (!_0x13fe00) return; const _0x5a32e8 = await _0x57c3ed('确定要删除这个好友圈吗？此操作不可撤销。'); _0x5a32e8 && (_0x346f80[_0x2b28fb(0x4a8)] = _0x346f80[_0x2b28fb(0x4a8)][_0x2b28fb(0x6e8)](_0x581584 => _0x581584['id'] !== _0x13fe00), _0x346f80[_0x2b28fb(0x903)] === _0x13fe00 && (_0x346f80[_0x2b28fb(0x903)] = null), _0x23c6b9(), _0x3383df(_0x2b28fb(0x3ed)), _0xbcfea(), _0x21dca3(_0x2b28fb(0x4ed), _0x2b28fb(0x986))); } else _0x4fae93(), _0x803425['conversationHistory'] = [], _0x1db588(); } function _0x48da6d(_0x5648f9) { const _0x3b16c6 = _0x54ed15; _0x585318(); const _0x227047 = _0x346f80[_0x3b16c6(0x4a8)]['find'](_0x21d606 => _0x21d606['id'] === _0x5648f9); if (!_0x227047) return; _0x346f80['activeFriendCircleId'] = _0x5648f9, _0x23c6b9(), document[_0x3b16c6(0x954)](_0x3b16c6(0x496))['textContent'] = _0x227047[_0x3b16c6(0x4e6)], _0x57e9b8(), _0x21dca3(_0x3b16c6(0x632), _0x3b16c6(0x4ed)), _0x21a3a7(); } function _0x2179e2() { const _0x38c4ee = _0x54ed15; if (!_0x346f80[_0x38c4ee(0x4a8)] || _0x346f80[_0x38c4ee(0x4a8)]['length'] === 0x0) { if (_0x38c4ee(0x607) !== _0x38c4ee(0x506)) { console['error'](_0x38c4ee(0x36a)); return; } else _0x41466b[_0x38c4ee(0x954)]('user-post-image-input')[_0x38c4ee(0x39c)](); } const _0x30afa6 = _0x346f80[_0x38c4ee(0x4a8)][0x0]; if (_0x30afa6[_0x38c4ee(0x805)][_0x38c4ee(0x6c3)] < 0x2) { if (_0x38c4ee(0x83f) === _0x38c4ee(0x664)) { if (!_0x434360['activeDiaryCharacterId']) return _0x1108a3['userProfiles'][_0x38c4ee(0x247)](_0x587756 => _0x587756['id'] === _0x47585d['activeUserProfileId']) || _0x58f524[_0x38c4ee(0x2f5)][0x0]; const _0x299d32 = _0x2575b2[_0x38c4ee(0x3aa)][_0x38c4ee(0x247)](_0xdc025 => _0xdc025[_0x38c4ee(0x62d)] === _0x38c4ee(0x328) && _0xdc025[_0x38c4ee(0x717)]['includes'](_0x52d246['activeDiaryCharacterId'])), _0xac1d0f = _0x299d32?.['boundUserProfileId'] || _0x454d4e[_0x38c4ee(0x7da)]; return _0x26cb6d[_0x38c4ee(0x2f5)][_0x38c4ee(0x247)](_0x11431b => _0x11431b['id'] === _0xac1d0f) || _0x3e8bbe[_0x38c4ee(0x2f5)][0x0]; } else { console[_0x38c4ee(0x8d6)](_0x38c4ee(0x344) + _0x30afa6[_0x38c4ee(0x4e6)] + _0x38c4ee(0x7d0)); return; } } const _0xa2c677 = { 'id': _0x38c4ee(0x5b5) + Date[_0x38c4ee(0x909)](), 'authorType': 'character', 'authorId': _0x30afa6[_0x38c4ee(0x805)][0x0], 'content': '这是一条由控制台添加的测试动态！样式看起来非常完美。', 'timestamp': Date[_0x38c4ee(0x909)](), 'likes': [_0x30afa6['memberCharacterIds'][0x1]], 'comments': [{ 'commentId': 'c_' + Date['now'](), 'authorId': _0x30afa6[_0x38c4ee(0x805)][0x1], 'content': _0x38c4ee(0x671) }] }; _0x30afa6[_0x38c4ee(0x94a)]['push'](_0xa2c677), _0x23c6b9(), console[_0x38c4ee(0x7e5)]('成功向好友圈\x20\x22' + _0x30afa6[_0x38c4ee(0x4e6)] + _0x38c4ee(0x1bb)), _0x3383df('测试动态已添加！'); } window['addTestPost'] = _0x2179e2; function _0x35ec92(_0x561b59) { const _0x42d89d = _0x54ed15; return _0x346f80[_0x42d89d(0x2f5)][_0x42d89d(0x247)](_0x21aab1 => _0x21aab1['id'] === _0x561b59); } function _0x6cd89d(_0x2a04f3, _0x427683 = '正在处理...') { const _0x375148 = _0x54ed15, _0x19e707 = document[_0x375148(0x954)](_0x375148(0x203)); let _0x16fe6c = document[_0x375148(0x954)](_0x375148(0x6a7)); if (_0x2a04f3) { if (!_0x16fe6c) { if (_0x375148(0x94e) === 'hKhus') _0x16fe6c = document[_0x375148(0x820)](_0x375148(0x41a)), _0x16fe6c['id'] = _0x375148(0x6a7), _0x19e707[_0x375148(0x204)](_0x16fe6c); else { if (!_0x412d71[_0x375148(0x4cd)]) return; _0xecb60e[_0x375148(0x96c)] = '回复\x20' + _0x2660ba[_0x375148(0x4cd)][_0x375148(0x812)], _0x5154a0[_0x375148(0x96c)] = _0x112143['activeQuote'][_0x375148(0x2fc)], _0xb94a4[_0x375148(0x94f)][_0x375148(0x3b4)] = _0x375148(0x810); } } _0x16fe6c['innerHTML'] = '<div\x20class=\x22loader-spinner\x22></div><span>' + _0x427683 + '</span>', _0x16fe6c['style'][_0x375148(0x3b4)] = _0x375148(0x798); } else { if (_0x16fe6c) { if (_0x375148(0x583) !== 'LlRam') { if (_0x48d169[_0x375148(0x925)][_0x375148(0x84e)](_0x1c1be4[_0x375148(0x908)])) _0x30bafd[_0x375148(0x896)] = !![]; } else _0x16fe6c[_0x375148(0x94f)]['display'] = 'none'; } } } async function _0xe1d39() { const _0xd52294 = _0x54ed15; if ('fYdOW' !== _0xd52294(0x2ff)) { const _0x364cd6 = _0x346f80['friendCircles'][_0xd52294(0x247)](_0x9f6364 => _0x9f6364['id'] === _0x346f80['activeFriendCircleId']); if (!_0x364cd6 || _0x346f80[_0xd52294(0x3d2)]) return; _0x6cd89d(!![], _0xd52294(0x6f3)), _0x346f80['isGenerating'] = !![]; try { if ('OAiEO' === _0xd52294(0x9c4)) _0x3fefac['entries'][_0xd52294(0x9ba)](_0x5da284, 0x1), _0x287e86(), _0x25c762(), _0x5e0b37(_0xd52294(0x993)); else { let _0xbc36cb = Date['now'](); if (_0x364cd6['posts'] && _0x364cd6[_0xd52294(0x94a)][_0xd52294(0x6c3)] > 0x0) { if ('WszDj' !== _0xd52294(0x2c2)) { const _0x234e28 = _0xe40270(_0x3db355[_0xd52294(0x2fc)] ?? _0x511b2f[_0xd52294(0x39f)] ?? '')[_0xd52294(0x4dd)]() || '[sticker:' + (_0x50a350 || _0xd52294(0x3ce)) + ']'; if (_0x234e28) _0x571c00[_0xd52294(0x289)]['push']({ 'senderId': _0x176912['id'], 'kind': _0xd52294(0x39f), 'content': _0x234e28 }); } else _0xbc36cb = Math[_0xd52294(0x50a)](..._0x364cd6[_0xd52294(0x94a)][_0xd52294(0x2a0)](_0x56b94f => _0x56b94f[_0xd52294(0x83c)])); } const _0x3dc026 = await _0x2538dd(_0x364cd6); if (!_0x3dc026 || _0x3dc026['length'] === 0x0) { if (_0xd52294(0x53b) === 'faSCY') return _0x573a77('请先在\x22设置\x22中配置你的\x20API\x20信息。'), ![]; else { _0x3383df(_0xd52294(0x7d4)); return; } } const _0x561c14 = _0x3dc026[_0xd52294(0x2a0)](async (_0x176de6, _0x607c2c) => { const _0x1448ee = _0xd52294; if ('VctCx' !== _0x1448ee(0x7f8)) { _0x6cd89d(!![], _0x1448ee(0x292) + (_0x607c2c + 0x1) + _0x1448ee(0x425) + _0x3dc026[_0x1448ee(0x6c3)] + _0x1448ee(0x3fe)); const _0xd2b079 = _0xbc36cb + (_0x607c2c + 0x1) * 0x3c * 0x3e8, _0x18fd18 = { 'id': _0x1448ee(0x970) + _0x176de6['authorId'] + '_' + _0xd2b079, 'authorType': _0x1448ee(0x9a1), 'authorId': _0x176de6[_0x1448ee(0x5dd)], 'content': _0x176de6[_0x1448ee(0x7e2)], 'timestamp': _0xd2b079, 'likes': _0x176de6['likes'] || [], 'comments': (_0x176de6[_0x1448ee(0x5fb)] || [])[_0x1448ee(0x2a0)]((_0xa42e85, _0x240527) => ({ 'commentId': 'c_' + _0xd2b079 + '_' + _0x240527, 'authorId': _0xa42e85[_0x1448ee(0x5dd)], 'content': _0xa42e85['content'] })) }; if (_0x176de6[_0x1448ee(0x64f)] === _0x1448ee(0x632) && _0x176de6[_0x1448ee(0x9be)] && _0x176de6[_0x1448ee(0x53d)]) try { const _0x320482 = await _0x1e2b3a(_0x176de6[_0x1448ee(0x9be)], _0x176de6[_0x1448ee(0x53d)]); _0x18fd18['type'] = 'music', _0x18fd18[_0x1448ee(0x9be)] = _0x176de6[_0x1448ee(0x9be)], _0x18fd18[_0x1448ee(0x53d)] = _0x176de6[_0x1448ee(0x53d)], _0x18fd18[_0x1448ee(0x4ea)] = _0x320482[_0x1448ee(0x34e)], _0x18fd18['playableUrl'] = _0x320482[_0x1448ee(0x4ee)]; } catch (_0x3dc74b) { console[_0x1448ee(0x8d6)](_0x1448ee(0x1a0), _0x3dc74b), _0x18fd18[_0x1448ee(0x62d)] = _0x1448ee(0x39f); } else _0x18fd18['type'] = 'text'; return _0x18fd18; } else { _0x3193bf(_0x1448ee(0x830)); return; } }), _0x387342 = await Promise['all'](_0x561c14); _0x364cd6[_0xd52294(0x94a)][_0xd52294(0x580)](..._0x387342), _0x23c6b9(); } } catch (_0x5ac494) { console[_0xd52294(0x8d6)](_0xd52294(0x7f3), _0x5ac494), _0x3383df(_0xd52294(0x8c0) + _0x5ac494[_0xd52294(0x399)]); } finally { _0x57e9b8(), _0x6cd89d(![]), _0x346f80[_0xd52294(0x3d2)] = ![]; } } else _0x59b13f(_0x4dd012), _0x41a566(); } async function _0x2538dd(_0x3b2ee3) { const _0x48db4d = _0x54ed15; if ('JJllN' !== _0x48db4d(0x88d)) { const _0x2d4d28 = _0x4278fd[_0x48db4d(0x667)][_0x48db4d(0x6e8)](_0xed2f22 => _0xed2f22[_0x48db4d(0x780)] === _0x48db4d(0x619))[_0x48db4d(0x4ab)](); _0x2d4d28 && (_0x3c78e6 = _0x2d4d28['content']); } else { const _0x54c4d = _0x3b2ee3[_0x48db4d(0x805)]['map'](_0x17aba6 => _0x5122c0(_0x17aba6))[_0x48db4d(0x6e8)](Boolean); if (_0x54c4d['length'] === 0x0) return null; const _0x563147 = _0x5e45d9(), _0x116921 = _0x35ec92(_0x3b2ee3[_0x48db4d(0x96f)]) || _0x346f80['userProfiles'][0x0], _0x529551 = _0x116921 ? _0x48db4d(0x849) + _0x116921[_0x48db4d(0x4e6)] + _0x48db4d(0x9b4) + (_0x116921[_0x48db4d(0x1a5)] || '无') + '\x0a' : '', _0x319a9f = _0x54c4d['map'](_0xf6b0fb => { const _0x3f1195 = _0x48db4d, { omniText: _0x70d17b } = _0x4aa25d(_0xf6b0fb['id'], null), _0x5cc48e = _0xb8d7f(_0xf6b0fb['id']), _0x4aaf83 = _0xf6b0fb[_0x3f1195(0x925)] && _0xf6b0fb[_0x3f1195(0x925)][_0x3f1195(0x6c3)] > 0x0 ? '\x0a\x0a#\x20' + _0xf6b0fb['name'] + _0x3f1195(0x558) + _0xf6b0fb['linkedWorldBookIds']['map'](_0x19675a => _0x346f80[_0x3f1195(0x814)]['find'](_0x338107 => _0x338107['id'] === _0x19675a))[_0x3f1195(0x6e8)](Boolean)['map'](_0x1710fd => _0x3f1195(0x700) + _0x1710fd[_0x3f1195(0x4e6)] + '\x0a' + _0x1710fd[_0x3f1195(0x2fc)])['join']('') : ''; return _0x3f1195(0x62c) + _0xf6b0fb[_0x3f1195(0x4e6)] + _0x3f1195(0x861) + _0xf6b0fb['id'] + _0x3f1195(0x782) + _0xf6b0fb[_0x3f1195(0x1a5)] + _0x3f1195(0x4c8) + _0x70d17b + '\x0a' + _0x5cc48e + '\x0a' + _0x4aaf83; })[_0x48db4d(0x6e6)]('\x0a\x0a'), _0x4e0288 = Math['floor'](Math['random']() * 0x3) + 0x2, _0x315a9c = _0x48db4d(0x2d0) + _0x4e0288 + _0x48db4d(0x64c) + _0x319a9f + '\x0a' + _0x529551 + '\x0a#\x20最近的动态回顾\x20(供参考，避免重复)\x0a' + _0x563147 + _0x48db4d(0x172) + _0x4e0288 + '条新动态挑选发布者。你可以让同一个人发布多次，也可以让不同人发布。\x0a3.\x20\x20**创作动态**:\x20扮演你选中的作者，创作符合其人设和记忆的动态内容。可以是文字或分享音乐。\x0a4.\x20\x20**模拟互动**:\x20为每一条你创作的动态，切换视角到【圈内其他成员】，模拟他们可能做出的点赞和评论。互动必须符合他们各自的性格。\x0a\x0a#\x20输出格式【绝对规则】\x0a-\x20你的输出**必须**是一个语法完全正确的、单一的JSON数组，包含\x20' + _0x4e0288 + _0x48db4d(0x571), _0x22a7a1 = [{ 'role': _0x48db4d(0x9ca), 'content': _0x315a9c }, { 'role': 'user', 'content': _0x48db4d(0x931) }]; _0x22a7a1[_0x48db4d(0x580)]({ 'role': _0x48db4d(0x619), 'content': _0x48db4d(0x5bb) + _0x4e0288 + '\x20条新动态。' }); try { const _0x2308cc = await _0x555f32(_0x22a7a1, { 'json': !![] }), _0x4802f2 = _0x2308cc[_0x48db4d(0x2bc)](/(\[[\s\S]*\])/); if (!_0x4802f2) throw new Error('AI未能返回有效的JSON数组格式。'); const _0x36683f = _0x4802f2[0x1], _0x1768c7 = JSON['parse'](_0x36683f); if (!Array[_0x48db4d(0x86b)](_0x1768c7)) throw new Error('AI返回的不是一个数组。'); return _0x1768c7; } catch (_0x81747e) { return _0x48db4d(0x9d3) === 'RwnMz' ? (console['error'](_0x48db4d(0x26b), _0x81747e), console[_0x48db4d(0x8d6)](_0x48db4d(0x503), _0x81747e['rawResponse'] || response), null) : _0x48db4d(0x242) + _0x5261e6; } } } async function _0x32955b() { const _0x345315 = _0x54ed15, _0x58bf38 = _0x346f80['friendCircles']['find'](_0x3d1c3e => _0x3d1c3e['id'] === _0x346f80[_0x345315(0x903)]); if (!_0x58bf38) return; const _0x5d59cb = await _0x57c3ed(_0x345315(0x5b6) + _0x58bf38['name'] + _0x345315(0x8bc)); _0x5d59cb && (_0x58bf38['posts'] = [], _0x23c6b9(), _0x57e9b8(), _0x3383df('动态已清空。')); } function _0x57e9b8() { const _0x57949e = _0x54ed15; if (_0x57949e(0x799) !== _0x57949e(0x799)) { const _0xfc3b79 = _0x7e5800[_0x57949e(0x250)][_0x57949e(0x87d)](_0x5ba85f); _0xfc3b79 > -0x1 && _0x17adc9(_0x1cdfdd, _0xfc3b79); } else { const _0x1d224f = document['getElementById'](_0x57949e(0x58b)), _0x3a9216 = _0x346f80['friendCircles'][_0x57949e(0x247)](_0x232fce => _0x232fce['id'] === _0x346f80[_0x57949e(0x903)]); if (!_0x3a9216) { _0x1d224f[_0x57949e(0x6a9)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>'; return; } if (!_0x3a9216[_0x57949e(0x94a)] || _0x3a9216['posts'][_0x57949e(0x6c3)] === 0x0) { _0x1d224f['innerHTML'] = _0x57949e(0x6b8); return; } _0x1d224f[_0x57949e(0x6a9)] = ''; const _0x5f14fc = [..._0x3a9216['posts']][_0x57949e(0x254)]((_0x4e4999, _0x3e7739) => _0x3e7739[_0x57949e(0x83c)] - _0x4e4999[_0x57949e(0x83c)]); _0x5f14fc[_0x57949e(0x927)](_0x4e9b5 => { const _0x48b571 = _0x57949e; if (_0x48b571(0x639) !== 'xFfeE') _0x36cfbf['toBlob'](_0x193777 => { const _0x450485 = _0x48b571; _0x193777 ? _0x5d362e(_0x193777) : _0x2c4e60(new _0x550638(_0x450485(0x25c))); }, _0x367212, _0x242e2b); else { const _0x286f98 = document[_0x48b571(0x820)](_0x48b571(0x41a)); _0x286f98[_0x48b571(0x941)] = _0x48b571(0x9df); let _0x451998 = '未知', _0x4b5943 = _0x2f6e79; if (_0x4e9b5[_0x48b571(0x969)] === 'user') { if (_0x48b571(0x56f) !== _0x48b571(0x659)) { const _0x10caca = _0x35ec92(_0x4e9b5['authorId']); _0x10caca && ('ZFneP' !== _0x48b571(0x432) ? (_0xed5a62['content'] = _0x30f525, _0x5b861e(), _0x5a6d19()) : (_0x451998 = _0x10caca['name'], _0x4b5943 = _0x10caca[_0x48b571(0x4ef)])); } else _0x194d16 = _0x4fc685[_0x48b571(0x7f2)][0x0][_0x48b571(0x8ca)], _0x3141b5 = _0x4f4150[_0x48b571(0x7f2)][0x0][_0x48b571(0x24e)], _0x200d23 = !![], _0x2e4430 = ''; } else { const _0x1780c3 = _0x5122c0(_0x4e9b5['authorId']); _0x1780c3 && (_0x48b571(0x635) !== _0x48b571(0x635) ? (_0x2559fc[_0x48b571(0x2f5)] = _0x4d9bfc[_0x48b571(0x2f5)][_0x48b571(0x6e8)](_0x165ad1 => _0x165ad1['id'] !== _0x51b36a), _0xe821ab[_0x48b571(0x7da)] === _0x47f03f && (_0x51c5bb[_0x48b571(0x7da)] = _0x1b7873[_0x48b571(0x2f5)][0x0]['id']), _0x28d9d0[_0x48b571(0x3aa)][_0x48b571(0x927)](_0xd49df2 => { const _0x28d60d = _0x48b571; _0xd49df2[_0x28d60d(0x96f)] === _0x2651a7 && (_0xd49df2[_0x28d60d(0x96f)] = _0x58fc9c[_0x28d60d(0x7da)]); }), _0x345c5a(), _0x30a204(_0x48b571(0x93b)), _0x1fe1f5(), _0x1272c0(_0x48b571(0x765), _0x48b571(0x364))) : (_0x451998 = _0x1780c3[_0x48b571(0x4e6)], _0x4b5943 = _0x1780c3['avatar'])); } const _0x37e021 = '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x4b5943 + '\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22char-name\x22>' + _0x451998 + '</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', _0x4c3378 = _0x48b571(0x168) + _0x4e9b5['content'] + _0x48b571(0x530); let _0x1f20b3 = ''; if (_0x4e9b5[_0x48b571(0x85e)] || _0x4e9b5[_0x48b571(0x1e4)]) { if (_0x48b571(0x5f5) !== _0x48b571(0x5f5)) _0x55d5a0[_0x48b571(0x903)] = null; else { const _0x9fbbcc = _0x48b571(0x5c6) + _0x4e9b5['id']; _0x1f20b3 = _0x48b571(0x280) + _0x9fbbcc + '\x22\x20class=\x22post-image\x22></div>', setTimeout(() => { const _0x9fe8 = _0x48b571, _0x152936 = document[_0x9fe8(0x954)](_0x9fbbcc); if (!_0x152936) return; if (_0x4e9b5['image']) 'PEJGi' !== _0x9fe8(0x625) ? _0x152936['src'] = _0x4e9b5[_0x9fe8(0x85e)] : (_0x5dc289[_0x9fe8(0x6a9)] = _0x9fe8(0x63c), _0x2c2f3c['getElementById'](_0x9fe8(0x1f2))[_0x9fe8(0x35e)](_0x9fe8(0x39c), _0x2e6cb0)); else _0x4e9b5['imageId'] && (_0x9fe8(0x33c) !== _0x9fe8(0x684) ? _0x4f16ca(_0x4e9b5[_0x9fe8(0x1e4)])[_0x9fe8(0x710)](_0x679170 => { const _0x4aedbb = _0x9fe8; if (_0x4aedbb(0x16e) !== _0x4aedbb(0x16e)) _0x5915f1[_0x4aedbb(0x4cd)] = null, _0x263173[_0x4aedbb(0x94f)][_0x4aedbb(0x3b4)] = _0x4aedbb(0x910); else { if (_0x679170) { const _0x5b7a30 = URL[_0x4aedbb(0x8f3)](_0x679170); _0x152936[_0x4aedbb(0x7d9)] = _0x5b7a30, _0x152936['onload'] = () => URL[_0x4aedbb(0x354)](_0x5b7a30); } } }) : _0x58e56f['textContent'] = '▶'); }, 0x0); } } let _0x4c4edc = ''; _0x4e9b5[_0x48b571(0x62d)] === _0x48b571(0x632) && _0x4e9b5[_0x48b571(0x9be)] && (_0x4c4edc = _0x48b571(0x533) + _0x4e9b5['id'] + _0x48b571(0x698) + (_0x4e9b5[_0x48b571(0x4ea)] || _0x2f6e79) + _0x48b571(0x56c) + _0x4e9b5['songName'] + _0x48b571(0x906) + _0x4e9b5[_0x48b571(0x53d)] + _0x48b571(0x1de) + (_0x4e9b5[_0x48b571(0x32c)] ? '▶' : '⚠') + _0x48b571(0x88e)); const _0x787d8e = _0x48b571(0x883) + new Date(_0x4e9b5[_0x48b571(0x83c)])[_0x48b571(0x6de)](_0x48b571(0x6dd)) + _0x48b571(0x49e); let _0x58847d = ''; if (_0x4e9b5[_0x48b571(0x621)] && _0x4e9b5[_0x48b571(0x621)][_0x48b571(0x6c3)] > 0x0 || _0x4e9b5[_0x48b571(0x5fb)] && _0x4e9b5['comments'][_0x48b571(0x6c3)] > 0x0) { let _0x49966d = ''; if (_0x4e9b5['likes'] && _0x4e9b5[_0x48b571(0x621)][_0x48b571(0x6c3)] > 0x0) { const _0x3c566a = _0x4e9b5['likes'][_0x48b571(0x2a0)](_0x189d65 => _0x5122c0(_0x189d65)?.[_0x48b571(0x4e6)] || '未知')[_0x48b571(0x6e6)]('、'), _0x1954d0 = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2216\x22\x20height=\x2216\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22currentColor\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x221\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22\x20style=\x22vertical-align:\x20-2px;\x20margin-right:\x205px;\x22><path\x20d=\x22M20.84\x204.61a5.5\x205.5\x200\x200\x200-7.78\x200L12\x205.67l-1.06-1.06a5.5\x205.5\x200\x200\x200-7.78\x207.78l1.06\x201.06L12\x2021.23l7.78-7.78\x201.06-1.06a5.5\x205.5\x200\x200\x200\x200-7.78z\x22></path></svg>'; _0x49966d = _0x48b571(0x709) + _0x1954d0 + '\x20' + _0x3c566a + _0x48b571(0x49e); } let _0x1ea561 = ''; if (_0x4e9b5['comments'] && _0x4e9b5[_0x48b571(0x5fb)][_0x48b571(0x6c3)] > 0x0) { if (_0x48b571(0x2e4) === _0x48b571(0x2e4)) { const _0x582080 = _0x4e9b5[_0x48b571(0x5fb)]['map'](_0x5440fa => { const _0x14f653 = _0x48b571, _0x17dca8 = _0x5122c0(_0x5440fa[_0x14f653(0x5dd)])?.[_0x14f653(0x4e6)] || '未知'; return _0x14f653(0x55e) + _0x17dca8 + '</span>:\x20' + _0x5440fa['content'] + _0x14f653(0x49e); })['join'](''); _0x1ea561 = _0x48b571(0x724) + _0x582080 + _0x48b571(0x49e); } else { const _0x4e9cd5 = { 'id': _0x48b571(0x702) + _0x40f585[_0x48b571(0x909)](), ..._0x190525 }; _0x150e0e[_0x48b571(0x2f5)]['push'](_0x4e9cd5), !_0xf8126d[_0x48b571(0x7da)] && (_0x4bccd8['activeUserProfileId'] = _0x4e9cd5['id']); } } _0x58847d = _0x48b571(0x644) + _0x49966d + _0x48b571(0x171) + _0x1ea561 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20'; } const _0x6f8ab2 = _0x48b571(0x681) + _0x4c3378 + _0x1f20b3 + _0x4c4edc + _0x48b571(0x49e); _0x286f98[_0x48b571(0x6a9)] = _0x37e021 + _0x6f8ab2 + _0x787d8e + _0x58847d; if (_0x4e9b5[_0x48b571(0x62d)] === _0x48b571(0x632) && _0x4e9b5[_0x48b571(0x32c)]) { if (_0x48b571(0x1e9) === _0x48b571(0x1eb)) _0x31381b > _0x54d5e2 && (_0x583124 *= _0x2055b3 / _0x3ecd76, _0x5c10df = _0x546684); else { const _0x4e593c = _0x286f98[_0x48b571(0x7c6)]('.music-post-song-card'); _0x4e593c && _0x4e593c[_0x48b571(0x35e)](_0x48b571(0x39c), function () { const _0x3d3510 = _0x48b571, _0x1ed2d3 = { 'id': _0x4e9b5['id'], 'url': _0x4e9b5[_0x3d3510(0x32c)] }; _0x5321d7(this, _0x1ed2d3); }); } } _0x1d224f[_0x48b571(0x204)](_0x286f98); } }); } } document['getElementById']('clear-feed-button')[_0x54ed15(0x35e)]('click', _0x32955b), document[_0x54ed15(0x954)](_0x54ed15(0x184))[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0xe1d39), document[_0x54ed15(0x954)](_0x54ed15(0x791))[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => _0x21dca3(_0x54ed15(0x72b), 'friendCircleList')), document['getElementById'](_0x54ed15(0x6f6))[_0x54ed15(0x35e)]('click', () => _0x158cf0()), document[_0x54ed15(0x954)](_0x54ed15(0x281))['addEventListener'](_0x54ed15(0x39c), () => _0x21dca3(_0x54ed15(0x4ed), _0x54ed15(0x986))), document[_0x54ed15(0x954)]('save-friend-circle-button')['addEventListener'](_0x54ed15(0x39c), _0x3742a8), document[_0x54ed15(0x954)]('delete-friend-circle-button')[_0x54ed15(0x35e)]('click', _0x45ba74), document[_0x54ed15(0x954)](_0x54ed15(0x223))[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x4adcf0 = _0x54ed15; _0xbcfea(), _0x21dca3(_0x4adcf0(0x4ed), 'music'); }), document[_0x54ed15(0x954)]('edit-current-circle-button')[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0xf7b47d = _0x54ed15; if ('lIMAH' === _0xf7b47d(0x50d)) { const _0x1f69ba = _0x45f46f[_0xf7b47d(0x85e)][_0xf7b47d(0x1a7)](',')[0x1], _0x2f90b8 = _0x48cca0[_0xf7b47d(0x85e)][_0xf7b47d(0x8f0)](_0x4ab9c9[_0xf7b47d(0x85e)][_0xf7b47d(0x87d)](':') + 0x1, _0x2e80b4[_0xf7b47d(0x85e)][_0xf7b47d(0x87d)](';')) || _0xf7b47d(0x892); _0x152867[_0xf7b47d(0x580)]({ 'inline_data': { 'mime_type': _0x2f90b8, 'data': _0x1f69ba } }); } else { if (_0x346f80['activeFriendCircleId']) { if (_0xf7b47d(0x616) === _0xf7b47d(0x66d)) { if (_0x28c210 < 0x0 || _0x2823d1 >= _0x16054e) return; _0x151f3a[_0xf7b47d(0x94f)][_0xf7b47d(0x202)] = _0xf7b47d(0x89e) + _0xd3c3ca * (0x64 / _0x6dec65) + '%)', _0x14160d['forEach'](_0x36f6bd => _0x36f6bd[_0xf7b47d(0x78f)][_0xf7b47d(0x309)](_0xf7b47d(0x282))), _0xea8b9e[_0xe9624c][_0xf7b47d(0x78f)][_0xf7b47d(0x3d0)](_0xf7b47d(0x282)), _0x51233 = _0x19d200; } else _0x158cf0(_0x346f80['activeFriendCircleId']); } } }), document[_0x54ed15(0x954)](_0x54ed15(0x589))[_0x54ed15(0x35e)]('click', async () => { const _0x590fae = _0x54ed15; if (_0x590fae(0x7be) === 'TNmsq') _0x3d8253[_0x590fae(0x8d6)](_0x590fae(0x961), _0x34cd68); else { const _0x3a134 = _0x346f80[_0x590fae(0x4a8)][_0x590fae(0x247)](_0x19b40d => _0x19b40d['id'] === _0x346f80[_0x590fae(0x903)]); if (!_0x3a134 || _0x346f80[_0x590fae(0x3d2)]) return; const _0x3c6543 = _0x3a134['boundUserProfileId'], _0x162dcd = _0x346f80[_0x590fae(0x2f5)][_0x590fae(0x247)](_0x35cc7d => _0x35cc7d['id'] === _0x3c6543); if (!_0x162dcd) { if ('MbzUE' !== _0x590fae(0x40f)) { _0x355175 = _0x57ea2f; let _0x43ecbc = null; if (_0x3f7b8c?.[_0x590fae(0x62d)] === _0x590fae(0x328)) _0x43ecbc = _0x171715(_0x5bf562[_0x590fae(0x717)][0x0]); else _0x962db3?.[_0x590fae(0x62d)] === _0x590fae(0x661) && _0x54d6e2 && (_0x43ecbc = _0x28c47a(_0x12e412)); _0x43ecbc?.[_0x590fae(0x4ef)] && (_0x1c9c52 = _0x43ecbc[_0x590fae(0x4ef)]); } else { _0x3383df('错误：找不到此好友圈绑定的用户！'); return; } } const _0x4458b2 = document[_0x590fae(0x954)](_0x590fae(0x27f))[_0x590fae(0x908)][_0x590fae(0x4dd)](), _0x27bebb = _0x346f80[_0x590fae(0x8d8)]['image'], _0x3b5154 = _0x346f80[_0x590fae(0x8d8)][_0x590fae(0x632)], _0x42a694 = _0x346f80['pendingPostAttachments']['imageId']; if (!_0x4458b2 && !_0x27bebb && !_0x3b5154) { _0x3383df(_0x590fae(0x87e)); return; } const _0x52d25b = { 'id': _0x590fae(0x953) + Date[_0x590fae(0x909)](), 'authorType': _0x590fae(0x619), 'authorId': _0x162dcd['id'], 'content': _0x4458b2, 'timestamp': Date['now'](), 'likes': [], 'comments': [] }; if (_0x42a694) _0x590fae(0x9ab) === _0x590fae(0x594) ? _0x422cde(_0x590fae(0x76c)) : _0x52d25b[_0x590fae(0x1e4)] = _0x42a694; else _0x27bebb && (_0x590fae(0x8b2) === _0x590fae(0x8b2) ? _0x52d25b['image'] = _0x27bebb : _0x2faa77[_0x590fae(0x78f)][_0x590fae(0x309)](_0x590fae(0x373))); _0x3b5154 ? _0x590fae(0x2b8) !== _0x590fae(0x61a) ? (_0x52d25b[_0x590fae(0x62d)] = _0x590fae(0x632), Object[_0x590fae(0x8ad)](_0x52d25b, _0x3b5154)) : (_0x4bdc34(), _0x37957b()) : _0x52d25b[_0x590fae(0x62d)] = _0x590fae(0x39f), _0x3a134[_0x590fae(0x94a)][_0x590fae(0x580)](_0x52d25b), _0x23c6b9(), _0x57e9b8(), document[_0x590fae(0x954)](_0x590fae(0x27f))[_0x590fae(0x908)] = '', _0x346f80['pendingPostAttachments'][_0x590fae(0x85e)] = null, _0x346f80[_0x590fae(0x8d8)][_0x590fae(0x632)] = null, _0x346f80[_0x590fae(0x8d8)][_0x590fae(0x1e4)] = null, _0x348aab(), _0x591115(_0x52d25b); } }), document[_0x54ed15(0x954)]('user-post-image-button')[_0x54ed15(0x35e)]('click', () => { const _0x43583c = _0x54ed15; document['getElementById']('user-post-image-input')[_0x43583c(0x39c)](); }), document[_0x54ed15(0x954)](_0x54ed15(0x65b))[_0x54ed15(0x35e)](_0x54ed15(0x2ed), async _0x1ccdd2 => { const _0x558d75 = _0x54ed15, _0x43c12d = _0x1ccdd2[_0x558d75(0x921)][_0x558d75(0x626)][0x0]; if (!_0x43c12d) return; try { const _0x2b26c4 = await _0x2ea925(_0x43c12d, 0x320, 0.8, !![]), _0x2ac0e5 = _0x558d75(0x5e5) + Date[_0x558d75(0x909)](); await _0x336559(_0x2ac0e5, _0x2b26c4), _0x346f80[_0x558d75(0x8d8)][_0x558d75(0x1e4)] = _0x2ac0e5, _0x346f80[_0x558d75(0x8d8)]['image'] = null, _0x346f80[_0x558d75(0x8d8)][_0x558d75(0x632)] = null, _0x348aab(); } catch (_0x3c8d48) { if (_0x558d75(0x601) !== _0x558d75(0x601)) { if (_0x215df0) _0x19cd43(_0x445949); _0x4dab17 = null, _0x4dbc65[_0x558d75(0x6e4)] = [], _0x25c70a['activeMeetingCharId'] = null, _0x2189b2[_0x558d75(0x954)](_0x558d75(0x358))[_0x558d75(0x94f)]['display'] = 'none', _0x3aefda['activeChatId'] = null, _0x123498(), _0x5a2128(_0x558d75(0x75c), 'meetingView'); } else _0x3383df(_0x558d75(0x784) + _0x3c8d48[_0x558d75(0x399)]); } _0x1ccdd2[_0x558d75(0x921)]['value'] = ''; }), document[_0x54ed15(0x954)](_0x54ed15(0x200))[_0x54ed15(0x35e)](_0x54ed15(0x39c), async () => { const _0x39eaa1 = _0x54ed15, _0x4c6552 = await _0x343177(); if (!_0x4c6552) return; _0x3383df('正在搜索音乐...'); try { const _0x130591 = await _0x1e2b3a(_0x4c6552[_0x39eaa1(0x9be)], _0x4c6552[_0x39eaa1(0x53d)]); _0x346f80[_0x39eaa1(0x8d8)]['music'] = { 'songName': _0x4c6552['songName'], 'artist': _0x4c6552[_0x39eaa1(0x53d)], 'coverUrl': _0x130591[_0x39eaa1(0x34e)], 'playableUrl': _0x130591[_0x39eaa1(0x4ee)] }, _0x346f80[_0x39eaa1(0x8d8)][_0x39eaa1(0x85e)] = null, _0x348aab(); } catch (_0x56dfd6) { if (_0x39eaa1(0x21d) !== _0x39eaa1(0x21d)) { const _0x57e68b = _0x40eb84[_0x39eaa1(0x954)](_0x39eaa1(0x92b))[_0x39eaa1(0x908)]; _0x57e68b && (_0x6a1f86[_0x39eaa1(0x7da)] = _0x57e68b, _0x152c10(), _0x49f157(_0x39eaa1(0x16d)), _0x39074f(), _0x4b04e8[_0x39eaa1(0x954)](_0x39eaa1(0x9c9))['style']['display'] = _0x39eaa1(0x910)); } else _0x3383df('音乐搜索失败:\x20' + _0x56dfd6[_0x39eaa1(0x399)]); } }); function _0x2ae828() { const _0x2c0e2c = _0x54ed15, _0x4a03cc = new Date(), _0x3415b2 = document['getElementById'](_0x2c0e2c(0x979)), _0x203d79 = document['getElementById'](_0x2c0e2c(0x175)); if (_0x3415b2 && _0x203d79) { const _0x386e49 = String(_0x4a03cc['getHours']())[_0x2c0e2c(0x990)](0x2, '0'), _0xb4362 = String(_0x4a03cc[_0x2c0e2c(0x783)]())['padStart'](0x2, '0'); _0x3415b2[_0x2c0e2c(0x96c)] = _0x386e49 + ':' + _0xb4362; const _0x3163e5 = _0x4a03cc[_0x2c0e2c(0x89d)]() + 0x1, _0x3c3879 = _0x4a03cc[_0x2c0e2c(0x74d)](), _0x480e2f = ['星期日', _0x2c0e2c(0x8cb), '星期二', '星期三', _0x2c0e2c(0x809), '星期五', _0x2c0e2c(0x6c2)][_0x4a03cc[_0x2c0e2c(0x795)]()]; _0x203d79[_0x2c0e2c(0x96c)] = _0x3163e5 + '月' + _0x3c3879 + '日\x20' + _0x480e2f; } } function _0x37ea04(_0x5d1536) { const _0x38cac6 = _0x54ed15; if (_0x38cac6(0x318) !== _0x38cac6(0x318)) _0xf2cbce[_0x38cac6(0x7e5)](_0x38cac6(0x411)), _0x2faf71['setItem'](_0x38cac6(0x273), _0x1d68c5[_0x38cac6(0x714)](_0x56e36c)); else { if (!_0x5d1536) return ''; const _0x36cfab = new Date(_0x5d1536), _0x45015b = String(_0x36cfab[_0x38cac6(0x27c)]())[_0x38cac6(0x990)](0x2, '0'), _0x286eb3 = String(_0x36cfab['getMinutes']())[_0x38cac6(0x990)](0x2, '0'); return _0x45015b + ':' + _0x286eb3; } } function _0x5e45d9() { const _0x49a9c9 = _0x54ed15; if ('odUQk' === 'HJrzC') _0xdb4d06 = _0x13ccc4; else { const _0x1bafd3 = _0x346f80['friendCircles'][_0x49a9c9(0x247)](_0x45846d => _0x45846d['id'] === _0x346f80[_0x49a9c9(0x903)]), _0xc1a407 = _0x1bafd3 ? _0x1bafd3[_0x49a9c9(0x94a)] : []; if (!_0xc1a407 || _0xc1a407[_0x49a9c9(0x6c3)] === 0x0) return ''; const _0x4b00dc = _0xc1a407[_0x49a9c9(0x290)](0x0, 0x5), _0x451c0d = _0x4b00dc[_0x49a9c9(0x2a0)](_0x40e877 => { const _0xf38718 = _0x49a9c9; if (_0xf38718(0x174) === _0xf38718(0x174)) { const _0x5bae99 = _0x5122c0(_0x40e877[_0xf38718(0x5dd)]) || { 'name': '未知' }; let _0x510990 = _0xf38718(0x82a) + _0x5bae99['name'] + _0xf38718(0x319) + (_0x40e877[_0xf38718(0x52d)] || _0x40e877[_0xf38718(0x2fc)]) + '”'; return _0x40e877['type'] === 'music' && (_0x510990 += _0xf38718(0x1e6) + _0x40e877[_0xf38718(0x9be)] + '\x20-\x20' + _0x40e877['artist'] + ')'), _0x510990; } else { _0x1c65ec('错误：找不到此好友圈绑定的用户！'); return; } }); return _0x49a9c9(0x66b) + _0x451c0d[_0x49a9c9(0x6e6)]('\x0a'); } } function _0xb8d7f(_0xf31525) { const _0x558864 = _0x54ed15, _0x3d0bd6 = _0x346f80[_0x558864(0x2f5)][_0x558864(0x247)](_0xaceee6 => _0xaceee6['id'] === _0x346f80[_0x558864(0x7da)]) || { 'name': '你' }, _0x78452c = _0x346f80[_0x558864(0x94b)][_0x558864(0x247)](_0x3e6821 => _0x3e6821['characterId'] === _0xf31525); if (!_0x78452c || !_0x78452c['entries'] || _0x78452c[_0x558864(0x667)][_0x558864(0x6c3)] === 0x0) return ''; const _0x4ff836 = _0x78452c[_0x558864(0x667)][_0x558864(0x290)](-0x8), _0x43bd8f = _0x4ff836[_0x558864(0x2a0)](_0x737fb7 => { const _0x3c5ac2 = _0x558864, _0x2acb25 = _0x737fb7[_0x3c5ac2(0x780)] === 'user' ? _0x3d0bd6['name'] : _0x5122c0(_0x737fb7[_0x3c5ac2(0x780)])[_0x3c5ac2(0x4e6)]; return '-\x20[' + new Date(_0x737fb7['timestamp'])[_0x3c5ac2(0x4db)]() + ']\x20' + _0x2acb25 + _0x3c5ac2(0x2c4) + _0x737fb7[_0x3c5ac2(0x2fc)]; })[_0x558864(0x6e6)]('\x0a'); return _0x558864(0x1e0) + _0x3d0bd6[_0x558864(0x4e6)] + _0x558864(0x3c4) + _0x43bd8f; } function _0x582da6() { const _0x2bab9a = _0x54ed15; if (_0x2bab9a(0x71a) !== 'UuYmT') { const _0x4aa623 = document[_0x2bab9a(0x954)](_0x2bab9a(0x5c1)), _0x486dde = _0x346f80[_0x2bab9a(0x4fe)]['widgetBgImage']; _0x486dde ? (_0x4aa623['style']['backgroundImage'] = _0x2bab9a(0x83a) + _0x486dde + ')', _0x4aa623[_0x2bab9a(0x94f)][_0x2bab9a(0x385)] = _0x2bab9a(0x34e), _0x4aa623[_0x2bab9a(0x94f)][_0x2bab9a(0x3a9)] = _0x2bab9a(0x2b3), _0x4aa623['style'][_0x2bab9a(0x4cf)] = _0x2bab9a(0x6b5), _0x4aa623['querySelectorAll']('.widget-info\x20>\x20div')[_0x2bab9a(0x927)](_0x220a29 => { const _0xcaba32 = _0x2bab9a; _0x220a29[_0xcaba32(0x94f)][_0xcaba32(0x22d)] = '0\x201px\x203px\x20rgba(0,0,0,0.6)'; })) : (_0x4aa623[_0x2bab9a(0x94f)][_0x2bab9a(0x5d2)] = '', _0x4aa623['style'][_0x2bab9a(0x4cf)] = '', _0x4aa623[_0x2bab9a(0x6a0)](_0x2bab9a(0x6c0))[_0x2bab9a(0x927)](_0x5685e0 => { const _0x26a664 = _0x2bab9a; _0x26a664(0x9dc) === 'JpHeP' ? _0x5685e0['style']['textShadow'] = '' : _0x464c0b[_0x26a664(0x2ce)] = _0x2fab1a['scrollHeight']; })); } else { if (_0xe42553 === null) return; const _0x1c3776 = _0x47f3d9[_0x2bab9a(0x250)][_0x4c7543]; if (!_0x1c3776) return; const _0x175181 = _0x5a805e(); let _0x1e1da8 = '未知'; if (_0x1c3776['role'] === _0x2bab9a(0x619)) _0x1e1da8 = _0x3a9c0f[_0x2bab9a(0x364)]['name'] || '我'; else { const _0x10b4cb = _0x1c3776['senderId'] || _0x175181?.[_0x2bab9a(0x717)][0x0], _0x416e3f = _0x1b2347(_0x10b4cb); _0x1e1da8 = _0x416e3f ? _0x416e3f[_0x2bab9a(0x4e6)] : '角色'; } let _0x4b8331 = _0x1c3776['content'] || ''; if (_0x1c3776[_0x2bab9a(0x1ff)]) _0x4b8331 = _0x2bab9a(0x5c5); if (_0x1c3776['image']) _0x4b8331 = _0x2bab9a(0x578); if (_0x4b8331[_0x2bab9a(0x6c3)] > 0x32) _0x4b8331 = _0x4b8331[_0x2bab9a(0x8f0)](0x0, 0x32) + _0x2bab9a(0x54e); _0x45f256[_0x2bab9a(0x4cd)] = { 'sender': _0x1e1da8, 'content': _0x4b8331 }, _0x2d7c65(), _0x206b1d(), _0x2009f4[_0x2bab9a(0x60d)](); } } const _0x2546ea = document[_0x54ed15(0x954)]('app-music'), _0x1c8025 = document[_0x54ed15(0x954)](_0x54ed15(0x206)); _0x2546ea[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { _0xbcfea(), _0x21dca3('friendCircleList', 'home'); }), _0x1c8025[_0x54ed15(0x35e)]('click', () => { const _0x4ed110 = _0x54ed15; _0x4ed110(0x888) === _0x4ed110(0x3db) ? _0x4d963d[_0x4ed110(0x845)]('chatHistory_' + _0x565bc4[_0x4ed110(0x509)]) : (_0x403ed8(), _0x21dca3('meetingList', _0x4ed110(0x72b))); }), document[_0x54ed15(0x954)](_0x54ed15(0x259))[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x4f12f8 = _0x54ed15; _0x4f12f8(0x71e) !== 'edjlp' ? _0x21dca3(_0x4f12f8(0x72b), _0x4f12f8(0x75c)) : _0x5c30b7[_0x4f12f8(0x7d9)] = _0x50e3fa ? _0x505ede['createObjectURL'](_0x26abf4) : _0x187cfd; }), document['getElementById'](_0x54ed15(0x48a))[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x232d7b = _0x54ed15; if (_0x2c8595) clearInterval(_0x2c8595); _0x2c8595 = null, _0x346f80[_0x232d7b(0x6e4)] = [], _0x346f80[_0x232d7b(0x785)] = null, document[_0x232d7b(0x954)](_0x232d7b(0x358))[_0x232d7b(0x94f)]['display'] = _0x232d7b(0x910), _0x346f80[_0x232d7b(0x509)] = null, _0x23c6b9(), _0x21dca3(_0x232d7b(0x75c), _0x232d7b(0x546)); }); const _0x5e86ae = document[_0x54ed15(0x954)](_0x54ed15(0x336)), _0x5d4ef5 = document['getElementById'](_0x54ed15(0x1fa)); _0x5d4ef5[_0x54ed15(0x35e)]('click', () => { const _0x16a971 = _0x54ed15; if ('VoqHc' === _0x16a971(0x2a7)) { const _0x3790e6 = _0x5e86ae[_0x16a971(0x908)][_0x16a971(0x4dd)](); if (_0x3790e6) { if (_0x16a971(0x86a) !== _0x16a971(0x374)) _0x57bdaa(_0x3790e6), _0x5e86ae[_0x16a971(0x908)] = '', setTimeout(_0x2a6a82, 0x64); else { const _0x553a0e = _0x5733cf['value'][_0x16a971(0x4dd)]()[_0x16a971(0x84e)](_0x5e14b2); _0x3902ac[_0x16a971(0x7bc)] = _0x553a0e; } } } else _0x305366(_0x16a971(0x2d5)); }); function _0x5321d7(_0x5b8c9a, _0x182cd6) { const _0x5b3f94 = _0x54ed15, _0x269184 = document[_0x5b3f94(0x954)](_0x5b3f94(0x82c)), _0x1697f7 = document[_0x5b3f94(0x6a0)](_0x5b3f94(0x5a5)); _0x1697f7[_0x5b3f94(0x927)](_0x8952fc => { const _0x22d46c = _0x5b3f94; _0x8952fc !== _0x5b8c9a[_0x22d46c(0x7c6)](_0x22d46c(0x5a5)) && (_0x8952fc[_0x22d46c(0x96c)] = '▶'); }), _0x269184['src'] === _0x182cd6[_0x5b3f94(0x4ee)] && !_0x269184[_0x5b3f94(0x214)] ? _0x5b3f94(0x4bd) === 'bRZSd' ? (_0x10fba5[_0x5b3f94(0x8d6)]('加载角色\x20' + _0x32ad0b['id'] + '\x20的图片失败:', _0x2a3a45), _0x58d639[_0x5b3f94(0x7d9)] = _0x3cf735[_0x5b3f94(0x4ef)] || _0x77b600) : (_0x269184[_0x5b3f94(0x730)](), _0x5b8c9a[_0x5b3f94(0x7c6)](_0x5b3f94(0x5a5))[_0x5b3f94(0x96c)] = '▶') : (_0x269184[_0x5b3f94(0x7d9)] = _0x182cd6[_0x5b3f94(0x4ee)], _0x269184[_0x5b3f94(0x4b3)](), _0x5b8c9a[_0x5b3f94(0x7c6)]('.music-post-play-icon,\x20.music-share-play-icon')[_0x5b3f94(0x96c)] = '❚❚'); } const _0x312a19 = document['getElementById'](_0x54ed15(0x1f6)); async function _0x405adc(_0xbd5ac4) { const _0x2ff375 = _0x54ed15; if (!_0xbd5ac4 || !_0xbd5ac4[_0x2ff375(0x859)](_0x2ff375(0x7fe))) return ![]; return new Promise(_0x96ff3b => { const _0x2c7efe = _0x2ff375; if (_0x2c7efe(0x3fa) !== _0x2c7efe(0x3fa)) { if (_0x31b818 === null) return; const _0x22df00 = _0x1713a5[_0x2c7efe(0x908)]['trim'](); if (_0x22df00 === '') { _0x48f50d(); return; } const _0x4af6ea = _0x659d46[_0x2c7efe(0x250)][_0x5dd20e]; _0x4af6ea && (_0x4af6ea[_0x2c7efe(0x2fc)] = _0x22df00, _0x4a15ac(), _0x43db50()), _0x5c55ce['classList']['remove']('show'), _0x2c85ce = null; } else { const _0x55484a = document['createElement'](_0x2c7efe(0x7a1)); _0x55484a[_0x2c7efe(0x7d9)] = _0xbd5ac4; const _0x373e5a = setTimeout(() => { const _0x37f82e = _0x2c7efe; if (_0x37f82e(0x369) === _0x37f82e(0x369)) _0xb40c0e(), _0x96ff3b(![]); else { const _0xd6a91d = { 'characters': _0x42ee5d[_0x37f82e(0x499)], 'worldBooks': _0x18f185['worldBooks'], 'chats': _0x1fb923[_0x37f82e(0x3aa)], 'userProfile': _0xe26059[_0x37f82e(0x364)], 'apiSettings': _0x1dae36[_0x37f82e(0x98c)], 'preferences': _0x48334e[_0x37f82e(0x4fe)], 'activeChatId': _0x451743[_0x37f82e(0x509)], 'diaries': _0x126eb3['diaries'], 'friendCircles': _0x3b9f15['friendCircles'], 'activeFriendCircleId': _0x37b41c['activeFriendCircleId'], 'userProfiles': _0x4ccf03[_0x37f82e(0x2f5)], 'activeUserProfileId': _0x5e0e4b[_0x37f82e(0x7da)], 'accountingData': _0x3bcfa7[_0x37f82e(0x28a)], 'accountingLedger': _0x42806f[_0x37f82e(0x4aa)] }; _0x117bc7[_0x37f82e(0x6c6)]('appState', _0x150c8f[_0x37f82e(0x714)](_0xd6a91d)); } }, 0xbb8), _0xb40c0e = () => { const _0x441f47 = _0x2c7efe; _0x441f47(0x441) !== _0x441f47(0x441) ? (_0x1365b8[_0x441f47(0x8d6)](_0x441f47(0x8e9), _0x34c3dd), _0xc238fe(_0x441f47(0x16f))) : (clearTimeout(_0x373e5a), _0x55484a['removeEventListener']('canplaythrough', _0x4efaba), _0x55484a['removeEventListener'](_0x441f47(0x8d6), _0x30943e), _0x55484a[_0x441f47(0x7d9)] = '', _0x55484a['remove']()); }, _0x4efaba = () => { const _0x1d3af2 = _0x2c7efe; _0x1d3af2(0x32e) !== _0x1d3af2(0x32e) ? _0x28c652[_0x1d3af2(0x354)](_0xeee79a) : (_0xb40c0e(), _0x96ff3b(!![])); }, _0x30943e = () => { _0xb40c0e(), _0x96ff3b(![]); }; _0x55484a[_0x2c7efe(0x35e)](_0x2c7efe(0x54d), _0x4efaba), _0x55484a['addEventListener'](_0x2c7efe(0x8d6), _0x30943e); } }); } async function _0x1e2b3a(_0x478a3a, _0x219039) { const _0x59fc33 = _0x54ed15, _0x3dbdc9 = ['netease', _0x59fc33(0x377)]; for (const _0x2c8b6a of _0x3dbdc9) { if (_0x59fc33(0x3fd) === _0x59fc33(0x3fd)) try { const _0x513cb2 = _0x59fc33(0x4b7) + _0x2c8b6a + _0x59fc33(0x26c) + encodeURIComponent(_0x478a3a) + '-' + encodeURIComponent(_0x219039), _0x21e4ee = await fetch(_0x513cb2), _0x36dbda = await _0x21e4ee[_0x59fc33(0x55f)](); if (_0x36dbda['code'] !== 0xc8 || !_0x36dbda[_0x59fc33(0x727)] || _0x36dbda[_0x59fc33(0x727)][_0x59fc33(0x6c3)] === 0x0) continue; const _0x54e8eb = _0x36dbda['data']['slice'](0x0, 0x5); for (const _0x59627e of _0x54e8eb) { if (_0x59fc33(0x753) === _0x59fc33(0x753)) { const _0x468c81 = _0x59fc33(0x4b7) + _0x2c8b6a + _0x59fc33(0x8ec) + _0x59627e['id'], _0x48c7ab = await fetch(_0x468c81), _0x3bc0f4 = await _0x48c7ab[_0x59fc33(0x55f)](), _0x161ef2 = _0x3bc0f4[_0x59fc33(0x727)]?.[_0x59fc33(0x4ee)]; if (await _0x405adc(_0x161ef2)) return { 'url': _0x161ef2, 'cover': _0x59627e[_0x59fc33(0x34e)], 'source': _0x2c8b6a }; } else _0x4bae0c[_0x59fc33(0x3d2)] && _0x448f71[_0x59fc33(0x5f7)] && (_0x10dc3d[_0x59fc33(0x7e5)](_0x59fc33(0x198)), _0x36943f[_0x59fc33(0x5f7)][_0x59fc33(0x93c)](_0x59fc33(0x2a1)), _0x18851e[_0x59fc33(0x5f7)] = null), _0x239385[_0x59fc33(0x3d2)] = ![], _0x3d62d4(![]); } } catch (_0xddc225) { console[_0x59fc33(0x8d6)]('Error\x20fetching\x20from\x20' + _0x2c8b6a + ':', _0xddc225); } else _0x43b8de[_0x59fc33(0x35e)]('click', () => { const _0x4e2d7e = _0x59fc33, _0x342bf3 = _0x5aa149(_0x18594d[_0x4e2d7e(0x86c)]['page'], 0xa); _0x19100d(_0x342bf3); }); } return { 'url': null, 'cover': null, 'source': null }; } function _0x3cc845(_0x3fdb89) { const _0x4de71d = _0x54ed15; try { if (_0x4de71d(0x754) === _0x4de71d(0x754)) { const _0x3b3e00 = JSON[_0x4de71d(0x781)](localStorage['getItem'](_0x4de71d(0x7a4)) || '{}'), _0xe73c94 = { ..._0x3b3e00, ..._0x3fdb89 }; localStorage[_0x4de71d(0x6c6)](_0x4de71d(0x7a4), JSON[_0x4de71d(0x714)](_0xe73c94)); } else return { 'type': _0x4de71d(0x53c), 'name': _0x5adcb5[0x1]['trim']() }; } catch (_0x1da4f1) { _0x4de71d(0x320) === _0x4de71d(0x224) ? (_0x5d4d9a[_0x4de71d(0x8d6)]('JSON\x20解析失败!\x20错误原因:', _0x1a5340), _0x2b910b[_0x4de71d(0x8d6)](_0x4de71d(0x4e5), _0x24e620)) : console['error'](_0x4de71d(0x66a), _0x1da4f1); } } async function _0x2e3939() { const _0x4c817f = _0x54ed15, _0x18080c = document[_0x4c817f(0x954)](_0x4c817f(0x474)), _0x441f11 = document[_0x4c817f(0x954)](_0x4c817f(0x534)); try { let _0x5404ce = await _0x4f16ca(_0x4c817f(0x9e5)); if (!_0x5404ce) { const _0x262181 = JSON[_0x4c817f(0x781)](localStorage[_0x4c817f(0x164)]('badgeState') || '{}'); if (_0x262181[_0x4c817f(0x85e)]) { if (_0x4c817f(0x5f9) !== _0x4c817f(0x5f9)) { let _0x48f22c = _0x3d3f56[_0x4c817f(0x954)]('style-' + _0x268f32['id']); !_0x48f22c && (_0x48f22c = _0x98f4de[_0x4c817f(0x820)]('style'), _0x48f22c['id'] = 'style-' + _0x2e0d0c['id'], _0x49ff67[_0x4c817f(0x8c5)][_0x4c817f(0x204)](_0x48f22c)); const _0x2c91da = _0x2bc29d['bubbleCss'], _0x12db8b = _0x2c91da[_0x4c817f(0x330)](/\.bubble\.sent/g, _0x4c817f(0x736) + _0x124385['id'] + _0x4c817f(0x6b7))[_0x4c817f(0x330)](/\.bubble\.received/g, _0x4c817f(0x736) + _0x514a46['id'] + _0x4c817f(0x7bb)); _0x48f22c[_0x4c817f(0x6a9)] = _0x12db8b; } else console[_0x4c817f(0x7e5)](_0x4c817f(0x3b9)), _0x5404ce = await _0x407d73(_0x262181['image']), await _0x336559('widget_badge', _0x5404ce); } } if (_0x5404ce) { if (_0x4c817f(0x813) !== 'nisww') return new _0x389e52((_0x1b8ef3, _0x39bb05) => { const _0x1f1951 = _0x4c817f, _0x5a947a = new _0x30f77e(); _0x5a947a[_0x1f1951(0x310)] = () => _0x1b8ef3(_0x5a947a[_0x1f1951(0x37b)]), _0x5a947a[_0x1f1951(0x41e)] = _0x39bb05, _0x5a947a[_0x1f1951(0x264)](_0x57f4c6); }); else _0x441f11[_0x4c817f(0x7d9)] = URL['createObjectURL'](_0x5404ce), _0x18080c[_0x4c817f(0x94f)][_0x4c817f(0x3b4)] = _0x4c817f(0x810); } else _0x18080c[_0x4c817f(0x94f)]['display'] = 'block'; } catch (_0xe032a8) { _0x4c817f(0x764) === _0x4c817f(0x866) ? (_0xce2f54[_0x4c817f(0x6a9)] = '', _0x2f5482['forEach'](_0x5665be => { const _0x17be3c = _0x4c817f, _0x354dd9 = _0x2786d4['createElement'](_0x17be3c(0x41a)); _0x354dd9[_0x17be3c(0x96c)] = _0x5665be, _0x354dd9['addEventListener'](_0x17be3c(0x39c), () => { const _0x5bc924 = _0x17be3c; _0x2a4927[_0x5bc924(0x908)] = _0x5665be, _0x519e2c[_0x5bc924(0x78f)][_0x5bc924(0x309)]('show'); }), _0x5e03a3[_0x17be3c(0x204)](_0x354dd9); }), _0x29a847[_0x4c817f(0x78f)]['add'](_0x4c817f(0x373)), _0x23bf08(_0x4c817f(0x436) + _0x3efb11[_0x4c817f(0x6c3)] + _0x4c817f(0x745))) : console[_0x4c817f(0x8d6)](_0x4c817f(0x961), _0xe032a8); } } function _0x187f4c(_0x32dc18) { const _0x34ecb7 = _0x54ed15; if (_0x34ecb7(0x79e) === _0x34ecb7(0x79e)) try { if (_0x34ecb7(0x447) === _0x34ecb7(0x299)) _0x577f19 = _0x35a355[_0x34ecb7(0x2fc)]; else { const _0x449088 = JSON[_0x34ecb7(0x781)](localStorage[_0x34ecb7(0x164)](_0x34ecb7(0x197)) || '{}'), _0x1d3879 = { ..._0x449088, ..._0x32dc18 }; localStorage[_0x34ecb7(0x6c6)](_0x34ecb7(0x197), JSON[_0x34ecb7(0x714)](_0x1d3879)); } } catch (_0x26a093) { _0x34ecb7(0x679) === _0x34ecb7(0x679) ? console[_0x34ecb7(0x8d6)](_0x34ecb7(0x4eb), _0x26a093) : (_0x1a5c14['appendChild'](_0x5167a3), _0x5eeca6[_0x34ecb7(0x204)](_0x223225)); } else { if (_0x1076ec) _0x4300fa(_0x51dea8); if (_0x101be2[_0x34ecb7(0x2e1)]) return; _0xe67753(() => { const _0x265f1e = _0x34ecb7; _0x4cf5b8 && _0x506d6a(_0x34296f['id'], _0x33278b[_0x265f1e(0x2a0)](_0x4f1d88 => _0x4f1d88['id'])); }, 0x32); } } async function _0x4cd21e() { const _0x4601b3 = _0x54ed15; if ('SnMXT' !== _0x4601b3(0x4f7)) { const _0x1453c0 = document[_0x4601b3(0x954)](_0x4601b3(0x52e)), _0x315071 = document[_0x4601b3(0x954)](_0x4601b3(0x7a2)); try { let _0x2575df = await _0x4f16ca(_0x4601b3(0x3b7)); if (!_0x2575df) { const _0x42963f = JSON[_0x4601b3(0x781)](localStorage['getItem'](_0x4601b3(0x197)) || '{}'); _0x42963f[_0x4601b3(0x85e)] && (console[_0x4601b3(0x7e5)]('正在搬运旧卡片...'), _0x2575df = await _0x407d73(_0x42963f[_0x4601b3(0x85e)]), await _0x336559(_0x4601b3(0x3b7), _0x2575df)); } if (_0x2575df) { if (_0x4601b3(0x25b) === _0x4601b3(0x25b)) _0x315071[_0x4601b3(0x7d9)] = URL['createObjectURL'](_0x2575df), _0x1453c0[_0x4601b3(0x94f)]['display'] = _0x4601b3(0x810); else { _0x379527['chats'] = _0x67da1[_0x4601b3(0x3aa)][_0x4601b3(0x6e8)](_0x5b0fde => _0x5b0fde['id'] !== _0x9c7cd8); try { _0x51c720[_0x4601b3(0x845)](_0x4601b3(0x649) + _0x6475b9); } catch (_0x12a208) { _0x2480af[_0x4601b3(0x8d6)](_0x4601b3(0x3a8) + _0x3181bb, _0x12a208); } _0x43b9c6['activeChatId'] === _0x17d98c && (_0x56633b[_0x4601b3(0x509)] = _0x266216[_0x4601b3(0x3aa)][0x0]?.['id'] || null, _0x2525d6(_0x37ef5e[_0x4601b3(0x509)])), _0x495695(), _0x73183a(); } } else _0x1453c0[_0x4601b3(0x94f)][_0x4601b3(0x3b4)] = 'block'; } catch (_0x334c08) { console[_0x4601b3(0x8d6)](_0x4601b3(0x4e8), _0x334c08); } try { let _0x3c325d = await _0x4f16ca(_0x4601b3(0x6a8)); const _0x2ba650 = document[_0x4601b3(0x954)]('card-image-2'), _0x5ea379 = document['getElementById'](_0x4601b3(0x5ef)); _0x3c325d ? (_0x2ba650[_0x4601b3(0x7d9)] = URL['createObjectURL'](_0x3c325d), _0x5ea379[_0x4601b3(0x94f)][_0x4601b3(0x3b4)] = _0x4601b3(0x810)) : _0x5ea379[_0x4601b3(0x94f)][_0x4601b3(0x3b4)] = _0x4601b3(0x910); } catch (_0x3b1fc3) { _0x4601b3(0x253) === _0x4601b3(0x253) ? console[_0x4601b3(0x8d6)](_0x4601b3(0x9e2), _0x3b1fc3) : _0x51cbe0[_0x4601b3(0x28a)] = _0x4b30e9[_0x4601b3(0x28a)]; } } else _0xe506f3(_0x3ec633['activeMeetingCharId'], _0x52cfc9[_0x4601b3(0x7aa)]); } _0x12349c[_0x54ed15(0x35e)]('click', () => { const _0x316ba7 = _0x54ed15; _0x27b8dd(), _0x21dca3('userProfileList', _0x316ba7(0x72b)); }), document[_0x54ed15(0x954)]('back-to-home-from-user-list')[_0x54ed15(0x35e)]('click', () => _0x21dca3('home', _0x54ed15(0x765))), document['getElementById'](_0x54ed15(0x779))[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => _0x13343a()), document[_0x54ed15(0x954)](_0x54ed15(0x508))[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x458f2d = _0x54ed15; _0x27b8dd(), _0x21dca3(_0x458f2d(0x765), _0x458f2d(0x364)); }), document[_0x54ed15(0x954)](_0x54ed15(0x584))[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x5a8deb), document[_0x54ed15(0x954)](_0x54ed15(0x942))[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x491c8c), document['getElementById'](_0x54ed15(0x9c9))[_0x54ed15(0x35e)]('click', () => { const _0x4ec72b = _0x54ed15, _0x3267d0 = document[_0x4ec72b(0x954)](_0x4ec72b(0x92b))['value']; _0x3267d0 && (_0x4ec72b(0x43c) === _0x4ec72b(0x43c) ? (_0x346f80[_0x4ec72b(0x7da)] = _0x3267d0, _0x23c6b9(), _0x3383df(_0x4ec72b(0x16d)), _0x27b8dd(), document['getElementById'](_0x4ec72b(0x9c9))[_0x4ec72b(0x94f)][_0x4ec72b(0x3b4)] = 'none') : (_0x426f13[_0x4ec72b(0x364)]['name'] = _0x1cc91a[_0x4ec72b(0x908)][_0x4ec72b(0x4dd)](), _0x33f759['userProfile'][_0x4ec72b(0x1a5)] = _0x1f7ac2[_0x4ec72b(0x908)][_0x4ec72b(0x4dd)](), _0x13c061(), _0x2279de(), _0x31914e(_0x4ec72b(0x241)), _0x539a2d('settings', _0x4ec72b(0x364)))); }); function _0x3d25f9(_0x3e8e01) { const _0x5bab9a = _0x54ed15; if (_0x5bab9a(0x4b5) === _0x5bab9a(0x4ca)) { const _0x281a38 = _0x5bf581[_0x5bab9a(0x820)](_0x5bab9a(0x41a)); _0x281a38[_0x5bab9a(0x941)] = _0x5bab9a(0x1c6), _0x281a38[_0x5bab9a(0x6a9)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x281a38[_0x5bab9a(0x7c6)](_0x5bab9a(0x467))[_0x5bab9a(0x1b0)] = () => _0x3b76a7(_0x5bab9a(0x85e)), _0x24360e[_0x5bab9a(0x204)](_0x281a38), _0x4b5431(_0x107e12)['then'](_0x58f17c => { const _0x912205 = _0x5bab9a, _0x75670f = _0x5c0f95['getElementById'](_0x912205(0x1c2)); _0x75670f && _0x58f17c && (_0x75670f[_0x912205(0x7d9)] = _0x2f6989[_0x912205(0x8f3)](_0x58f17c)); }); } else { const _0x29c8f7 = _0x346f80[_0x5bab9a(0x3aa)]['find'](_0x4d30d6 => _0x4d30d6['id'] === _0x3e8e01), _0xf9a6c4 = _0x29c8f7?.[_0x5bab9a(0x96f)]; let _0x4f4f0f = _0x346f80[_0x5bab9a(0x2f5)][_0x5bab9a(0x247)](_0x3a5488 => _0x3a5488['id'] === _0xf9a6c4); return !_0x4f4f0f && (_0x5bab9a(0x33f) === 'ozyBU' ? _0x4f4f0f = _0x346f80['userProfiles'][_0x5bab9a(0x247)](_0x6504dc => _0x6504dc['id'] === _0x346f80[_0x5bab9a(0x7da)]) || _0x346f80[_0x5bab9a(0x2f5)][0x0] : _0x4fe120 = _0x40c92d['parse'](_0x467d03)), _0x4f4f0f || { 'name': '用户', 'avatar': _0x223ec8, 'persona': '' }; } } function _0x334ad5(_0x13cc96) { const _0x1ed6d9 = _0x54ed15, _0x487b48 = document[_0x1ed6d9(0x954)](_0x13cc96); _0x487b48[_0x1ed6d9(0x6a9)] = '', _0x346f80[_0x1ed6d9(0x2f5)][_0x1ed6d9(0x927)](_0x10e6fc => { const _0x4e7913 = _0x1ed6d9, _0x1a7970 = document[_0x4e7913(0x820)]('option'); _0x1a7970[_0x4e7913(0x908)] = _0x10e6fc['id'], _0x1a7970[_0x4e7913(0x96c)] = _0x10e6fc[_0x4e7913(0x4e6)], _0x487b48[_0x4e7913(0x204)](_0x1a7970); }); } function _0x25a177(_0x1fa0a1) { const _0x585b5b = _0x54ed15, _0x164489 = _0x5122c0(_0x1fa0a1), _0x4e15ab = document[_0x585b5b(0x954)](_0x585b5b(0x1f5)); _0x4e15ab['style'][_0x585b5b(0x5d2)] = ''; let _0x9e76e0 = document[_0x585b5b(0x954)](_0x585b5b(0x8df) + _0x1fa0a1); if (_0x9e76e0) _0x9e76e0['innerHTML'] = ''; if (!_0x164489) return; _0x164489[_0x585b5b(0x5d1)] && (_0x4e15ab['style'][_0x585b5b(0x5d2)] = _0x585b5b(0x4a0) + _0x164489[_0x585b5b(0x5d1)] + '\x27)', _0x4e15ab[_0x585b5b(0x94f)]['backgroundSize'] = _0x585b5b(0x34e), _0x4e15ab[_0x585b5b(0x94f)][_0x585b5b(0x3a9)] = _0x585b5b(0x2b3)); if (_0x164489['bubbleCss']) { let _0x207c5e = document['getElementById'](_0x585b5b(0x8df) + _0x164489['id']); !_0x207c5e && (_0x207c5e = document[_0x585b5b(0x820)](_0x585b5b(0x94f)), _0x207c5e['id'] = _0x585b5b(0x8df) + _0x164489['id'], document['head']['appendChild'](_0x207c5e)); const _0x16ac1e = _0x164489[_0x585b5b(0x938)], _0x4f6e5f = _0x16ac1e[_0x585b5b(0x330)](/\.bubble\.sent/g, _0x585b5b(0x736) + _0x164489['id'] + '.message.user')[_0x585b5b(0x330)](/\.bubble\.received/g, '.bubble-' + _0x164489['id'] + _0x585b5b(0x7bb)); _0x207c5e['innerHTML'] = _0x4f6e5f; } } function _0x348aab() { const _0x2cb401 = _0x54ed15, _0x46d563 = document[_0x2cb401(0x954)](_0x2cb401(0x7b0)); _0x46d563[_0x2cb401(0x6a9)] = ''; const _0x15fb6a = _0x2828da => { const _0x59e280 = _0x2cb401; if (_0x59e280(0x2a9) !== _0x59e280(0x75d)) { _0x346f80['pendingPostAttachments'][_0x2828da] = null; if (_0x2828da === 'image') _0x346f80[_0x59e280(0x8d8)][_0x59e280(0x1e4)] = null; _0x348aab(); } else { if (_0x738475) _0x4ed179(_0x3bd9f3); const _0x19eeed = _0x3f4d38[_0x59e280(0x921)][_0x59e280(0x34c)]('p[data-history-index]'); if (!_0x19eeed) return; const _0x596451 = _0x40d335(_0x19eeed[_0x59e280(0x86c)][_0x59e280(0x79d)], 0xa); if (_0x5b4741(_0x596451)) return; const _0x34b805 = () => { _0x440f51 = _0x529269(() => { const _0x10d0d8 = _0x321d; if (_0x3a0471[_0x10d0d8(0x62d)] === 'touchstart') _0x440f0a[_0x10d0d8(0x45f)](); _0x8764aa(_0x596451); }, 0x320); }, _0x409f78 = () => { if (_0x554194) _0x27ec05(_0x24f5af); }; _0x18968e[_0x59e280(0x35e)](_0x59e280(0x5cf), _0x409f78, { 'once': !![] }), _0x4b9589['addEventListener'](_0x59e280(0x2f0), _0x409f78, { 'once': !![] }), _0x3e7764[_0x59e280(0x35e)]('touchend', _0x409f78, { 'once': !![] }), _0x293194[_0x59e280(0x35e)](_0x59e280(0x498), _0x409f78, { 'once': !![] }), _0x34b805(); } }, _0x23a8c8 = _0x346f80[_0x2cb401(0x8d8)]['imageId'], _0x584ee7 = _0x346f80[_0x2cb401(0x8d8)][_0x2cb401(0x632)]; if (_0x23a8c8) { const _0xbf4df6 = document[_0x2cb401(0x820)](_0x2cb401(0x41a)); _0xbf4df6[_0x2cb401(0x941)] = 'preview-item', _0xbf4df6[_0x2cb401(0x6a9)] = _0x2cb401(0x854), _0xbf4df6[_0x2cb401(0x7c6)](_0x2cb401(0x467))[_0x2cb401(0x1b0)] = () => _0x15fb6a(_0x2cb401(0x85e)), _0x46d563[_0x2cb401(0x204)](_0xbf4df6), _0x4f16ca(_0x23a8c8)['then'](_0x5a7416 => { const _0x494a94 = _0x2cb401; if (_0x494a94(0x52f) !== 'otKaW') { const _0x34323f = document[_0x494a94(0x954)](_0x494a94(0x1c2)); _0x34323f && _0x5a7416 && (_0x34323f['src'] = URL['createObjectURL'](_0x5a7416)); } else _0x40542b['preferences'] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x85f24a[_0x494a94(0x4fe)] }; }); } if (_0x584ee7) { if (_0x2cb401(0x390) === _0x2cb401(0x390)) { const _0x4cc8f8 = document[_0x2cb401(0x820)](_0x2cb401(0x41a)); _0x4cc8f8[_0x2cb401(0x941)] = 'preview-item', _0x4cc8f8[_0x2cb401(0x6a9)] = _0x2cb401(0x3bb) + (_0x584ee7[_0x2cb401(0x4ea)] || _0x2f6e79) + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>' + _0x584ee7[_0x2cb401(0x9be)] + _0x2cb401(0x9bb) + _0x584ee7[_0x2cb401(0x53d)] + _0x2cb401(0x398), _0x4cc8f8[_0x2cb401(0x7c6)](_0x2cb401(0x467))[_0x2cb401(0x1b0)] = () => _0x15fb6a(_0x2cb401(0x632)), _0x46d563[_0x2cb401(0x204)](_0x4cc8f8); } else { const _0x4d9731 = _0x1625a0[_0x2cb401(0x954)]('accounting-content-area'); _0x24b4e1[_0x2cb401(0x954)](_0x2cb401(0x987))[_0x2cb401(0x96c)] = _0x2cb401(0x1ed), _0x466763[_0x2cb401(0x954)]('header-actions')['innerHTML'] = '', _0x4d9731[_0x2cb401(0x6a9)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22accounting-input-area\x22\x20style=\x22margin-bottom:\x2020px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22input-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22expense-description\x22>花在哪了？</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20id=\x22expense-description\x22\x20placeholder=\x22例如：一杯奶茶\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22input-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22expense-amount\x22>花了多少？</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20id=\x22expense-amount\x22\x20placeholder=\x22例如：15\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22add-expense-button\x22\x20class=\x22form-button\x20primary\x22\x20style=\x22margin-top:\x2015px;\x22>记下了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-bottom:\x2010px;\x22>今日流水</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22daily-expenses-list\x22\x20style=\x22max-height:\x20300px;\x20overflow-y:\x20auto;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22organize-button-container\x22\x20style=\x22margin-top:\x2020px;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x48551d(), _0x257bd8[_0x2cb401(0x954)]('add-expense-button')['addEventListener'](_0x2cb401(0x39c), _0x56814b), _0x184818[_0x2cb401(0x954)](_0x2cb401(0x7ad))[_0x2cb401(0x60d)](); } } } async function _0x591115(_0x179fa8) { const _0xe8f9aa = _0x54ed15, _0x567480 = _0x346f80[_0xe8f9aa(0x4a8)][_0xe8f9aa(0x247)](_0xb08436 => _0xb08436['id'] === _0x346f80[_0xe8f9aa(0x903)]); if (!_0x567480) return; _0x6cd89d(!![], _0xe8f9aa(0x8a0)), _0x346f80[_0xe8f9aa(0x3d2)] = !![]; try { const _0x534991 = _0x567480[_0xe8f9aa(0x805)][_0xe8f9aa(0x2a0)](_0x34afd8 => _0x5122c0(_0x34afd8))['filter'](Boolean), _0x18fd8b = _0x5e45d9(), _0x56576b = _0x534991[_0xe8f9aa(0x2a0)](_0x20c6fc => { const _0x38421d = _0xe8f9aa, { omniText: _0x544e2e } = _0x4aa25d(_0x20c6fc['id'], null), _0x418b9f = _0xb8d7f(_0x20c6fc['id']), _0x25faf5 = _0x20c6fc['linkedWorldBookIds'] && _0x20c6fc[_0x38421d(0x925)]['length'] > 0x0 ? '\x0a\x0a#\x20' + _0x20c6fc[_0x38421d(0x4e6)] + _0x38421d(0x558) + _0x20c6fc[_0x38421d(0x925)][_0x38421d(0x2a0)](_0x16cfbf => _0x346f80[_0x38421d(0x814)][_0x38421d(0x247)](_0x39be19 => _0x39be19['id'] === _0x16cfbf))[_0x38421d(0x6e8)](Boolean)[_0x38421d(0x2a0)](_0x5851cc => _0x38421d(0x700) + _0x5851cc[_0x38421d(0x4e6)] + '\x0a' + _0x5851cc['content'])[_0x38421d(0x6e6)]('') : ''; return _0x38421d(0x62c) + _0x20c6fc[_0x38421d(0x4e6)] + _0x38421d(0x861) + _0x20c6fc['id'] + _0x38421d(0x782) + _0x20c6fc[_0x38421d(0x1a5)] + '\x0a\x20\x20相关记忆:\x0a' + _0x544e2e + '\x0a' + _0x418b9f + '\x0a' + _0x25faf5; })[_0xe8f9aa(0x6e6)]('\x0a\x0a'), _0x5ddaa4 = _0x35ec92(_0x179fa8['authorId']) || { 'name': '用户' }, _0xc1ccdd = _0x5ddaa4[_0xe8f9aa(0x1a5)] ? _0xe8f9aa(0x531) + _0x5ddaa4[_0xe8f9aa(0x4e6)] + '\x0a-\x20人设:\x20' + _0x5ddaa4[_0xe8f9aa(0x1a5)] + '\x0a' : ''; let _0x3f6f37 = null; if (_0x179fa8['image']) _0x3f6f37 = _0x179fa8[_0xe8f9aa(0x85e)]; else { if (_0x179fa8[_0xe8f9aa(0x1e4)]) try { if (_0xe8f9aa(0x89f) !== _0xe8f9aa(0x371)) { const _0x3f9e57 = await _0x4f16ca(_0x179fa8[_0xe8f9aa(0x1e4)]); _0x3f9e57 && (_0x3f6f37 = await _0x58722e(_0x3f9e57)); } else { _0x519a03['log'](_0xe8f9aa(0x7f9)); const _0xa8e4cb = { 'id': _0xe8f9aa(0x702) + _0x1c5148[_0xe8f9aa(0x909)](), 'name': _0x333ee4['userProfile'][_0xe8f9aa(0x4e6)] || '我', 'avatar': _0x5e9108['userProfile']['avatar'] || _0x2bc969, 'persona': _0x87d3f2[_0xe8f9aa(0x364)][_0xe8f9aa(0x1a5)] || '' }; _0x1b7c08[_0xe8f9aa(0x2f5)] = [_0xa8e4cb], _0x2528cc[_0xe8f9aa(0x7da)] = _0xa8e4cb['id']; } } catch (_0x3ecce9) { console[_0xe8f9aa(0x8d6)](_0xe8f9aa(0x950), _0x3ecce9); } } let _0x438828 = _0x5ddaa4[_0xe8f9aa(0x4e6)] + _0xe8f9aa(0x482) + _0x179fa8[_0xe8f9aa(0x2fc)] + '”'; _0x3f6f37 && (_0x438828 += _0xe8f9aa(0x28b)); _0x179fa8[_0xe8f9aa(0x62d)] === 'music' && (_0x438828 += _0xe8f9aa(0x26a) + _0x179fa8['songName'] + _0xe8f9aa(0x218) + _0x179fa8[_0xe8f9aa(0x53d)] + ']'); const _0x4f9b0d = '\x0a#\x20核心任务\x0a你是一个多角色社交模拟引擎。用户刚刚发了一条动态，你需要为好友圈里的【每一位】其他成员生成对这条动态的回应（点赞和评论）。如果用户的动态包含图片，你必须根据图片内容进行回应。\x0a\x0a#\x20好友圈成员\x0a' + _0x56576b + '\x0a\x0a' + _0xc1ccdd + _0xe8f9aa(0x758) + _0x18fd8b + _0xe8f9aa(0x413) + _0x438828 + _0xe8f9aa(0x2d7), _0x14a251 = [{ 'role': _0xe8f9aa(0x9ca), 'content': _0x4f9b0d }], _0x51f5e0 = { 'role': _0xe8f9aa(0x619), 'content': _0xe8f9aa(0x8c1) }; _0x3f6f37 && (_0x51f5e0[_0xe8f9aa(0x85e)] = _0x3f6f37); _0x14a251['push'](_0x51f5e0); const _0x1cc857 = await _0x555f32(_0x14a251, { 'json': !![] }), _0x3e2c72 = _0x1cc857['match'](/({[\s\S]*})/); if (!_0x3e2c72) throw new Error('AI未能返回有效的JSON对象。'); const _0x3eed95 = JSON[_0xe8f9aa(0x781)](_0x3e2c72[0x1]), _0x57111b = _0x567480[_0xe8f9aa(0x94a)]['find'](_0x190145 => _0x190145['id'] === _0x179fa8['id']); _0x57111b && (_0x57111b[_0xe8f9aa(0x621)] = _0x3eed95['likes'] || [], _0x57111b[_0xe8f9aa(0x5fb)] = (_0x3eed95[_0xe8f9aa(0x5fb)] || [])['map']((_0x25b9ab, _0x52778c) => ({ ..._0x25b9ab, 'commentId': 'c_' + _0x179fa8[_0xe8f9aa(0x83c)] + '_' + _0x52778c })), _0x23c6b9(), _0x57e9b8()); } catch (_0x2a398f) { if (_0xe8f9aa(0x8ce) !== _0xe8f9aa(0x5d9)) console['error'](_0xe8f9aa(0x8e9), _0x2a398f), _0x3383df(_0xe8f9aa(0x16f)); else { _0x3d7cf4[_0xe8f9aa(0x6a9)] = _0xe8f9aa(0x3b6), _0x122b2b[_0xe8f9aa(0x6a9)] = ''; return; } } finally { _0x6cd89d(![]), _0x346f80[_0xe8f9aa(0x3d2)] = ![]; } } function _0x21a3a7() { const _0x49af33 = _0x54ed15, _0x4b45cc = _0x346f80[_0x49af33(0x4a8)][_0x49af33(0x247)](_0x3f59ae => _0x3f59ae['id'] === _0x346f80[_0x49af33(0x903)]), _0x3eab4a = _0x4b45cc?.[_0x49af33(0x96f)]; let _0x5324ab = _0x346f80[_0x49af33(0x2f5)][_0x49af33(0x247)](_0x500d5e => _0x500d5e['id'] === _0x3eab4a); !_0x5324ab && (_0x5324ab = _0x346f80[_0x49af33(0x2f5)]['find'](_0x59ad5b => _0x59ad5b['id'] === _0x346f80[_0x49af33(0x7da)])), !_0x5324ab && (_0x5324ab = _0x346f80[_0x49af33(0x2f5)][0x0]), _0x5324ab && (document[_0x49af33(0x954)](_0x49af33(0x53f))[_0x49af33(0x7d9)] = _0x5324ab[_0x49af33(0x4ef)] || _0x223ec8); } function _0x18edac(_0x310f5d) { const _0x4b72d2 = _0x54ed15; if (_0x4b72d2(0x406) !== _0x4b72d2(0x406)) _0x10eebe[_0x4b72d2(0x94f)][_0x4b72d2(0x5d2)] = '', _0x1b20cd[_0x4b72d2(0x94f)]['color'] = '', _0x116da6[_0x4b72d2(0x6a0)]('.widget-info\x20>\x20div')[_0x4b72d2(0x927)](_0x29612f => { const _0x4327c8 = _0x4b72d2; _0x29612f[_0x4327c8(0x94f)][_0x4327c8(0x22d)] = ''; }); else { let _0x5252e8 = 0x0, _0x1f3bf4 = 0x0, _0x27be0b = 0x0; if (_0x310f5d[_0x4b72d2(0x6c3)] == 0x4) { if ('gNVrS' !== _0x4b72d2(0x7b6)) _0x5252e8 = '0x' + _0x310f5d[0x1] + _0x310f5d[0x1], _0x1f3bf4 = '0x' + _0x310f5d[0x2] + _0x310f5d[0x2], _0x27be0b = '0x' + _0x310f5d[0x3] + _0x310f5d[0x3]; else { const _0x9d4399 = _0x3f5d42[_0x4b72d2(0x921)][_0x4b72d2(0x37b)]; !_0x9d4399['objectStoreNames'][_0x4b72d2(0x6ce)](_0x38177f) && _0x9d4399[_0x4b72d2(0x64e)](_0x4a12cb, { 'keyPath': 'id' }), !_0x9d4399[_0x4b72d2(0x692)][_0x4b72d2(0x6ce)](_0x4b72d2(0x4d5)) && _0x9d4399['createObjectStore'](_0x4b72d2(0x4d5), { 'keyPath': 'id' }); } } else { if (_0x310f5d['length'] == 0x7) { if (_0x4b72d2(0x4b0) === _0x4b72d2(0x5ce)) { const _0x901cc2 = _0x1340b7[_0x4b72d2(0x954)](_0x4b72d2(0x50b)); if (_0x901cc2) _0x901cc2[_0x4b72d2(0x96c)] = '▶'; } else _0x5252e8 = '0x' + _0x310f5d[0x1] + _0x310f5d[0x2], _0x1f3bf4 = '0x' + _0x310f5d[0x3] + _0x310f5d[0x4], _0x27be0b = '0x' + _0x310f5d[0x5] + _0x310f5d[0x6]; } } _0x5252e8 /= 0xff, _0x1f3bf4 /= 0xff, _0x27be0b /= 0xff; let _0x39906e = Math[_0x4b72d2(0x439)](_0x5252e8, _0x1f3bf4, _0x27be0b), _0x8eb29f = Math['max'](_0x5252e8, _0x1f3bf4, _0x27be0b), _0x3fcbcf = _0x8eb29f - _0x39906e, _0x12b066 = 0x0, _0x431ed5 = 0x0, _0x172bc3 = 0x0; if (_0x3fcbcf == 0x0) _0x12b066 = 0x0; else { if (_0x8eb29f == _0x5252e8) _0x12b066 = (_0x1f3bf4 - _0x27be0b) / _0x3fcbcf % 0x6; else { if (_0x8eb29f == _0x1f3bf4) _0x12b066 = (_0x27be0b - _0x5252e8) / _0x3fcbcf + 0x2; else _0x12b066 = (_0x5252e8 - _0x1f3bf4) / _0x3fcbcf + 0x4; } } _0x12b066 = Math[_0x4b72d2(0x743)](_0x12b066 * 0x3c); if (_0x12b066 < 0x0) _0x12b066 += 0x168; return _0x172bc3 = (_0x8eb29f + _0x39906e) / 0x2, _0x431ed5 = _0x3fcbcf == 0x0 ? 0x0 : _0x3fcbcf / (0x1 - Math[_0x4b72d2(0x7c4)](0x2 * _0x172bc3 - 0x1)), _0x431ed5 = +(_0x431ed5 * 0x64)[_0x4b72d2(0x557)](0x1), _0x172bc3 = +(_0x172bc3 * 0x64)[_0x4b72d2(0x557)](0x1), { 'h': _0x12b066, 's': _0x431ed5, 'l': _0x172bc3 }; } } function _0x2ae481() { const _0x168de1 = _0x54ed15, _0x59d934 = (_0x1e6798, _0x551d41, _0x95dc2d) => { const _0xeed5e5 = _0x321d; if (_0xeed5e5(0x945) === _0xeed5e5(0x945)) { const _0x8ec75c = document[_0xeed5e5(0x954)](_0x1e6798); if (!_0x8ec75c) return; let _0x2ff705 = null; try { 'rUORK' === _0xeed5e5(0x243) ? _0x36ccff[_0xeed5e5(0x96c)] = _0x46f39f[_0xeed5e5(0x73e)](_0x51bb8d)[_0xeed5e5(0x2a0)](_0x52fcb8 => _0x52fcb8[_0xeed5e5(0x7c7)][_0xeed5e5(0x96c)][_0xeed5e5(0x4dd)]())[_0xeed5e5(0x6e6)]('、') : _0x2ff705 = JSON[_0xeed5e5(0x781)](localStorage['getItem'](_0x551d41) || '{}'); } catch { _0x2ff705 = {}; } _0x8ec75c['style'][_0xeed5e5(0x460)] = _0xeed5e5(0x359), _0x8ec75c[_0xeed5e5(0x94f)][_0xeed5e5(0x5ea)] = '', _0x8ec75c[_0xeed5e5(0x94f)][_0xeed5e5(0x2f9)] = '', _0x8ec75c[_0xeed5e5(0x94f)][_0xeed5e5(0x396)] = '', _0x8ec75c['style'][_0xeed5e5(0x95e)] = '', _0x8ec75c['style'][_0xeed5e5(0x202)] = ''; if (typeof _0x2ff705[_0xeed5e5(0x5ea)] === 'number' && typeof _0x2ff705[_0xeed5e5(0x2f9)] === 'number') _0x8ec75c[_0xeed5e5(0x94f)]['top'] = _0x2ff705[_0xeed5e5(0x5ea)] + '%', _0x8ec75c[_0xeed5e5(0x94f)]['left'] = _0x2ff705[_0xeed5e5(0x2f9)] + '%'; else for (const _0xad200e in _0x95dc2d) { _0x8ec75c[_0xeed5e5(0x94f)][_0xad200e] = _0x95dc2d[_0xad200e]; } } else _0x44132a['push'](_0x430e60); }; _0x59d934('home-clock-container', _0x168de1(0x7f0), { 'top': _0x168de1(0x817), 'left': '50%', 'transform': _0x168de1(0x919) }), _0x59d934(_0x168de1(0x9c5), 'appIconPosition_app-wallpaper', { 'top': _0x168de1(0x615), 'right': '4%' }), _0x59d934(_0x168de1(0x648), _0x168de1(0x5fc), { 'top': _0x168de1(0x615), 'right': _0x168de1(0x4d2) }), _0x59d934(_0x168de1(0x25e), _0x168de1(0x7cc), { 'top': '8%', 'right': _0x168de1(0x4d2) }), _0x59d934(_0x168de1(0x5a6), _0x168de1(0x82e), { 'top': '8%', 'right': '4%' }), _0x59d934(_0x168de1(0x8a3), _0x168de1(0x2ea), { 'top': _0x168de1(0x524), 'left': '5%' }), _0x59d934(_0x168de1(0x8b6), _0x168de1(0x5de), { 'top': _0x168de1(0x891), 'left': '29%' }), _0x59d934('theme-widget-1', _0x168de1(0x5a1), { 'top': _0x168de1(0x811), 'left': '7%' }), _0x59d934(_0x168de1(0x872), _0x168de1(0x655), { 'top': _0x168de1(0x524), 'left': '29%' }), _0x59d934(_0x168de1(0x474), _0x168de1(0x7a4), { 'top': _0x168de1(0x5dc), 'right': '5%' }), _0x59d934('card-widget', 'cardState', { 'top': _0x168de1(0x5df), 'left': '6%' }), _0x59d934(_0x168de1(0x5ef), _0x168de1(0x9af), { 'top': '8%', 'left': '5%' }), _0x59d934('music-widget', _0x168de1(0x233), { 'top': _0x168de1(0x6e7), 'left': '5%' }); } function _0x172211() { const _0x8a6ada = _0x54ed15; if ('msFYH' !== _0x8a6ada(0x38a)) { const _0x18816f = []; for (const _0x2ee886 of _0x3a2753['keys'](_0x3dabca)) { const _0x32e034 = _0x2ee886[_0x8a6ada(0x234)](); if (_0x2a51a9['some'](_0x1c04c0 => _0x32e034[_0x8a6ada(0x859)](_0x1c04c0))) { const _0x425e35 = _0x1ae232[_0x2ee886]; if (typeof _0x425e35 === _0x8a6ada(0x17c)) _0x18816f[_0x8a6ada(0x580)](_0x425e35); if (_0x5f0fcc[_0x8a6ada(0x86b)](_0x425e35)) _0x425e35[_0x8a6ada(0x927)](_0x46532a => { const _0x83309c = _0x8a6ada; if (typeof _0x46532a === _0x83309c(0x17c)) _0x18816f[_0x83309c(0x580)](_0x46532a); }); } } if (_0x18816f[_0x8a6ada(0x6c3)]) return _0x18816f[_0x8a6ada(0x73d)](_0x22a2ef)['slice'](0x0, 0x9); } else { const _0x9889a8 = document[_0x8a6ada(0x954)](_0x8a6ada(0x6c5)); _0x9889a8[_0x8a6ada(0x6a9)] = ''; const _0x1920aa = document[_0x8a6ada(0x6a0)](_0x8a6ada(0x9dd)); _0x1920aa[_0x8a6ada(0x927)](_0x3504e7 => { const _0x9b7d37 = _0x8a6ada; if (_0x9b7d37(0x47c) !== _0x9b7d37(0x7b7)) { const _0x190544 = _0x3504e7['id'], _0x2b87b6 = _0x3504e7['querySelector'](_0x9b7d37(0x271))[_0x9b7d37(0x96c)], _0x39b397 = _0x9b7d37(0x552) + _0x190544, _0x16de28 = localStorage[_0x9b7d37(0x164)](_0x39b397), _0x3ba6ee = document['createElement'](_0x9b7d37(0x41a)); _0x3ba6ee[_0x9b7d37(0x941)] = 'member-selection-item', _0x3ba6ee[_0x9b7d37(0x94f)][_0x9b7d37(0x409)] = _0x9b7d37(0x38c), _0x3ba6ee[_0x9b7d37(0x6a9)] = _0x9b7d37(0x6f8) + _0x190544 + _0x9b7d37(0x437) + (_0x16de28 || _0x9b7d37(0x6d1)) + '\x22\x20class=\x22char-avatar\x22\x20style=\x22border-radius:\x2012px;\x20background-color:\x20#eee;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22flex-grow:\x201;\x22>' + _0x2b87b6 + _0x9b7d37(0x296) + _0x190544 + _0x9b7d37(0x179) + _0x190544 + _0x9b7d37(0x992) + _0x39b397 + '\x27);\x20location.reload();\x22>恢复</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x9889a8[_0x9b7d37(0x204)](_0x3ba6ee); const _0x4288b7 = document['getElementById'](_0x9b7d37(0x9e4) + _0x190544); _0x4288b7[_0x9b7d37(0x35e)]('change', async _0x31bc78 => { const _0x26e808 = _0x9b7d37; if ('MGtpu' !== _0x26e808(0x777)) return new _0x41a152((_0x376b92, _0x192cc9) => { const _0x288970 = _0x26e808, _0x314f83 = new _0x5baf93(); _0x314f83[_0x288970(0x310)] = () => _0x376b92(_0x314f83['result']), _0x314f83['onerror'] = _0x192cc9, _0x314f83[_0x288970(0x264)](_0x17bfd5); }); else { const _0x1aaec7 = _0x31bc78['target'][_0x26e808(0x626)][0x0]; if (!_0x1aaec7) return; try { const _0x4e5c06 = await _0x1bec17(_0x1aaec7); localStorage[_0x26e808(0x6c6)](_0x39b397, _0x4e5c06), document[_0x26e808(0x954)](_0x26e808(0x2b1) + _0x190544)[_0x26e808(0x7d9)] = _0x4e5c06, _0x2630a9(); } catch (_0x4603ae) { _0x3383df(_0x26e808(0x1e3) + _0x4603ae[_0x26e808(0x399)]); } } }); } else return _0x5ee506[_0x9b7d37(0x7e5)](_0x9b7d37(0x973)), ''; }); } } function _0x2630a9() { const _0x17a365 = _0x54ed15; if (_0x17a365(0x20a) !== 'dYolb') { const _0xf5db7c = document['querySelectorAll'](_0x17a365(0x9dd)); _0xf5db7c['forEach'](_0x22bbe0 => { const _0x15df5e = _0x17a365, _0xd90d27 = _0x22bbe0['id'], _0x5741a2 = _0x15df5e(0x552) + _0xd90d27, _0x576e25 = localStorage['getItem'](_0x5741a2), _0x315c6d = _0x22bbe0['querySelector'](_0x15df5e(0x948)); if (_0x576e25) { if (_0x15df5e(0x99f) === _0x15df5e(0x73a)) { _0xcca03f[_0x15df5e(0x8d6)](_0x15df5e(0x40b) + _0x59736e[_0x15df5e(0x509)] + _0x15df5e(0x6ac), _0x4bf338); try { _0x107695[_0x15df5e(0x845)]('chatHistory_' + _0x374edb[_0x15df5e(0x509)]); } catch (_0x1fd437) { _0x4827eb[_0x15df5e(0x8d6)](_0x15df5e(0x29b), _0x1fd437); } } else _0x315c6d[_0x15df5e(0x6a9)] = _0x15df5e(0x438) + _0x576e25 + _0x15df5e(0x473); } else { const _0x4cf326 = document[_0x15df5e(0x7c6)](_0x15df5e(0x774) + _0xd90d27 + _0x15df5e(0x1f4) + _0xd90d27 + '\x20.app-icon-img')?.[_0x15df5e(0x6a9)]; _0x4cf326 && (_0x315c6d[_0x15df5e(0x6a9)] = _0x4cf326); } }); } else { const _0x22e8ba = _0x5b83b9[_0x17a365(0x820)]('img'); _0x22e8ba['src'] = _0x85b063[_0x17a365(0x4ee)], _0x22e8ba['loading'] = _0x17a365(0x592), _0x22e8ba['title'] = _0x40c8e0['name'], _0x22e8ba[_0x17a365(0x78f)][_0x17a365(0x3d0)](_0x17a365(0x98f)), _0x22e8ba['addEventListener'](_0x17a365(0x39c), () => _0x18d538(_0x5a80a2)), _0x5c3ff8['appendChild'](_0x22e8ba); } } function _0x585318() { const _0x5e33bf = _0x54ed15, _0xa3a1bd = _0x346f80['friendCircles']['find'](_0x46678f => _0x46678f['id'] === _0x346f80[_0x5e33bf(0x903)]), _0x423e9b = _0x597f5f(); let _0x2a9f60 = []; if (_0xa3a1bd && _0xa3a1bd[_0x5e33bf(0x94a)]) { const _0x4677e5 = _0xa3a1bd[_0x5e33bf(0x94a)][_0x5e33bf(0x6e8)](_0x3374cb => _0x3374cb['type'] === 'music' && _0x3374cb[_0x5e33bf(0x32c)])[_0x5e33bf(0x2a0)](_0xa74dc8 => ({ ..._0xa74dc8, 'source': _0x5e33bf(0x8b4) })); _0x2a9f60[_0x5e33bf(0x580)](..._0x4677e5); } if (_0x423e9b && _0x346f80['conversationHistory']) { if (_0x5e33bf(0x7ac) !== 'nrEnA') { const _0x2df48f = _0x346f80[_0x5e33bf(0x250)][_0x5e33bf(0x6e8)](_0x60fb1f => _0x60fb1f[_0x5e33bf(0x62d)] === _0x5e33bf(0x632) && _0x60fb1f[_0x5e33bf(0x32c)])['map'](_0x5de599 => ({ ..._0x5de599, 'source': _0x5e33bf(0x755) })); _0x2a9f60[_0x5e33bf(0x580)](..._0x2df48f); } else _0x218155[_0x5e33bf(0x6c6)](_0x160aae, _0x5d1515[_0x5e33bf(0x714)](_0x127d0a)); } const _0x55a2be = Array['from'](new Map(_0x2a9f60['map'](_0x214945 => [_0x214945[_0x5e33bf(0x32c)], _0x214945]))[_0x5e33bf(0x1fc)]()); _0x346f80[_0x5e33bf(0x4a7)] = _0x55a2be[_0x5e33bf(0x254)]((_0x20ed68, _0x3e71b9) => _0x3e71b9['timestamp'] - _0x20ed68['timestamp']); } function _0x656dd4(_0x4f0fbc) { const _0x2371d0 = _0x54ed15; if (_0x4f0fbc < 0x0 || _0x4f0fbc >= _0x20672b[_0x2371d0(0x6c3)]) return; _0x5ef0e3 = _0x4f0fbc; const _0x5ca11f = _0x20672b[_0x4f0fbc]; _0x1d3c7c[_0x2371d0(0x7d9)] = _0x5ca11f['playableUrl'] || _0x5ca11f['url'], _0x1d3c7c[_0x2371d0(0x4b3)](), _0x121d4c(), _0x2b805d(); } function _0x121d4c() { const _0x196d03 = _0x20672b[_0x5ef0e3]; _0x5d8cd8(_0x196d03); } function _0x2b805d() { const _0x41c78c = _0x54ed15; try { localStorage[_0x41c78c(0x6c6)](_0x41c78c(0x3de), JSON[_0x41c78c(0x714)]({ 'playlist': _0x346f80[_0x41c78c(0x4a7)], 'currentIndex': _0x346f80[_0x41c78c(0x2bb)] })); } catch (_0x1bd2d5) { _0x41c78c(0x77e) !== _0x41c78c(0x2ca) ? console[_0x41c78c(0x8d6)](_0x41c78c(0x9a7), _0x1bd2d5) : _0x25e444[_0x41c78c(0x580)]({ 'name': _0x443506[0x0][_0x41c78c(0x4dd)](), 'url': _0x2e2aa5[0x1][_0x41c78c(0x4dd)]() }); } } function _0x21cb9d() { const _0x2c5c01 = _0x54ed15; try { const _0x554140 = localStorage['getItem'](_0x2c5c01(0x3de)); if (_0x554140) { const { playlist: _0x2eaebf, currentIndex: _0x3f5f7a } = JSON[_0x2c5c01(0x781)](_0x554140); Array[_0x2c5c01(0x86b)](_0x2eaebf) && _0x2eaebf[_0x2c5c01(0x6c3)] > 0x0 && _0x3f5f7a > -0x1 && (_0x346f80[_0x2c5c01(0x4a7)] = _0x2eaebf, _0x346f80[_0x2c5c01(0x2bb)] = _0x3f5f7a, _0x346f80['isPlaying'] = ![], _0x121d4c()); } } catch (_0x4a62bf) { if (_0x2c5c01(0x9d6) !== _0x2c5c01(0x9d6)) { const _0x5c117d = _0x372671(_0xa653e2); if (!_0x5c117d) return; _0x13e5b9[_0x2c5c01(0x597)] = _0x43a290; const _0x1bbdfe = _0x1cab75['diaries'][_0x2c5c01(0x247)](_0x5b35ad => _0x5b35ad[_0x2c5c01(0x80d)] === _0x26ae7a), _0x30cdae = _0x1bbdfe ? _0x1bbdfe[_0x2c5c01(0x667)][_0x2c5c01(0x6c3)] : 0x0, _0x5628d6 = 0x2; _0x2b3b53[_0x2c5c01(0x713)] = _0x21a558[_0x2c5c01(0x50a)](0x0, _0x454e7d[_0x2c5c01(0x495)](_0x30cdae / _0x5628d6) - 0x1), _0x3463b3['getElementById'](_0x2c5c01(0x1c7))[_0x2c5c01(0x96c)] = _0x5c117d[_0x2c5c01(0x4e6)] + _0x2c5c01(0x633), _0x39550c(), _0xcd3e47('diaryView', _0x2c5c01(0x1f3)); } else console['error'](_0x2c5c01(0x4b1), _0x4a62bf); } } function _0x2092e5(_0x1df146) { const _0x3b749c = _0x54ed15; if (window[_0x3b749c(0x4ae)]) clearTimeout(window['diaryPressTimer']); const _0x1dad15 = _0x1df146[_0x3b749c(0x921)][_0x3b749c(0x34c)](_0x3b749c(0x5a4)); if (!_0x1dad15) return; const _0x5d0645 = _0x1dad15[_0x3b749c(0x86c)][_0x3b749c(0x83c)], _0x3de1b7 = _0x1dad15[_0x3b749c(0x78f)][_0x3b749c(0x6ce)](_0x3b749c(0x619)) ? _0x3b749c(0x619) : 'ai'; if (!_0x5d0645) return; const _0x3a0f74 = () => { const _0x567a02 = _0x3b749c; window[_0x567a02(0x4ae)] = setTimeout(() => { const _0x2b1905 = _0x567a02; if (_0x2b1905(0x6e1) === _0x2b1905(0x6e5)) _0x246524('错误:\x20' + _0x3d8716[_0x2b1905(0x399)]); else { if (_0x1df146['type'] === 'touchstart') _0x1df146['preventDefault'](); _0x3c890e(parseInt(_0x5d0645, 0xa), _0x3de1b7); } }, 0x320); }, _0x453ae3 = () => { const _0x537bab = _0x3b749c; if (window[_0x537bab(0x4ae)]) clearTimeout(window[_0x537bab(0x4ae)]); }; document[_0x3b749c(0x35e)]('mouseup', _0x453ae3, { 'once': !![] }), document[_0x3b749c(0x35e)](_0x3b749c(0x305), _0x453ae3, { 'once': !![] }), document[_0x3b749c(0x35e)](_0x3b749c(0x498), _0x453ae3, { 'once': !![] }), _0x3a0f74(); } function _0x3c890e(_0x55e900, _0xb5b06e) { const _0xa33529 = _0x54ed15, _0x5b78c5 = _0xa33529(0x787) + _0x55e900; let _0x47decc = document[_0xa33529(0x954)](_0x5b78c5); if (_0x47decc) return; const _0x172de9 = _0xa33529(0x429) + _0x5b78c5 + '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20' + (_0xb5b06e === 'ai' ? _0xa33529(0x63e) : '') + _0xa33529(0x5af); document[_0xa33529(0x302)]['insertAdjacentHTML'](_0xa33529(0x189), _0x172de9); const _0x3c90ca = document[_0xa33529(0x954)](_0x5b78c5), _0x1fcee4 = () => _0x3c90ca[_0xa33529(0x309)](); _0x3c90ca[_0xa33529(0x7c6)]('.choice-modal-backdrop')[_0xa33529(0x1b0)] = _0x1fcee4, _0x3c90ca[_0xa33529(0x7c6)](_0xa33529(0x977))[_0xa33529(0x1b0)] = _0x1fcee4, _0x3c90ca[_0xa33529(0x7c6)]('#diary-action-delete')[_0xa33529(0x1b0)] = () => { _0x5cdaa1(_0x55e900), _0x1fcee4(); }, _0xb5b06e === 'ai' && (_0x3c90ca[_0xa33529(0x7c6)](_0xa33529(0x9cd))[_0xa33529(0x1b0)] = () => { const _0x5e00ba = _0xa33529; if (_0x5e00ba(0x388) === 'oBfNh') return _0xc7867c['userProfiles']['find'](_0xc8d924 => _0xc8d924['id'] === _0x4dd9ae); else _0x434ce4(_0x55e900), _0x1fcee4(); }); } async function _0x5cdaa1(_0x5c981a) { const _0x31504a = _0x54ed15; if (_0x31504a(0x889) !== _0x31504a(0x542)) { const _0x5d8920 = await _0x57c3ed(_0x31504a(0x31d)); if (!_0x5d8920) return; const _0x45a60e = _0x346f80[_0x31504a(0x94b)]['find'](_0x1a9e45 => _0x1a9e45['characterId'] === _0x346f80[_0x31504a(0x597)]); if (!_0x45a60e) return; const _0x47088f = _0x45a60e[_0x31504a(0x667)][_0x31504a(0x3ff)](_0x570b2a => _0x570b2a[_0x31504a(0x83c)] === _0x5c981a); if (_0x47088f > -0x1) { if (_0x31504a(0x3c1) === _0x31504a(0x3c1)) _0x45a60e['entries'][_0x31504a(0x9ba)](_0x47088f, 0x1), _0x23c6b9(), _0xe9be5d(), _0x3383df(_0x31504a(0x993)); else { const _0x2a8f68 = _0x46285b[_0x31504a(0x59e)](_0x2027e2, 'readonly'), _0x314b49 = _0x2a8f68['objectStore'](_0x47bcb6), _0x179b11 = _0x314b49[_0x31504a(0x190)](); _0x179b11[_0x31504a(0x8fb)] = () => _0x2c0700(_0x179b11['result']), _0x179b11['onerror'] = () => _0xa6b125(_0x179b11[_0x31504a(0x8d6)]); } } } else { const _0x2cf4f8 = _0x56c977, _0x536e79 = _0x2cf4f8['scrollHeight'], _0x10ca31 = _0x2cf4f8[_0x31504a(0x2ce)]; _0x38d24e[_0x31504a(0x98d)] += 0x64, _0x8b0651(), _0x516155(() => { const _0x509e26 = _0x31504a, _0x2eb71f = _0x2cf4f8[_0x509e26(0x678)]; _0x2cf4f8[_0x509e26(0x2ce)] = _0x10ca31 + (_0x2eb71f - _0x536e79); }); } } async function _0x434ce4(_0x3b2ba2) { const _0x25b09b = _0x54ed15; if ('TZOMe' !== 'TZOMe') _0x16b468(), _0x5f5675 = null; else { const _0x51bd49 = _0x346f80[_0x25b09b(0x94b)][_0x25b09b(0x247)](_0x344ff7 => _0x344ff7[_0x25b09b(0x80d)] === _0x346f80[_0x25b09b(0x597)]); if (!_0x51bd49) return; const _0x49064c = _0x51bd49[_0x25b09b(0x667)][_0x25b09b(0x3ff)](_0x71c9e9 => _0x71c9e9[_0x25b09b(0x83c)] === _0x3b2ba2); _0x49064c > -0x1 && (_0x51bd49['entries'][_0x25b09b(0x9ba)](_0x49064c, 0x1), _0x23c6b9(), _0xe9be5d(), await _0x3c1033()); } } function _0x23c68b() { const _0x562822 = _0x54ed15, _0x41b026 = document[_0x562822(0x954)](_0x562822(0x1b8)); _0x41b026['innerHTML'] = ''; const _0x3b0229 = _0x346f80[_0x562822(0x499)]['filter'](_0xbe63c2 => _0x346f80[_0x562822(0x3aa)]['some'](_0x492301 => _0x492301[_0x562822(0x62d)] === _0x562822(0x328) && _0x492301[_0x562822(0x717)][_0x562822(0x84e)](_0xbe63c2['id']))); if (_0x3b0229[_0x562822(0x6c3)] === 0x0) { _0x41b026[_0x562822(0x6a9)] = _0x562822(0x8b0); return; } _0x3b0229['forEach'](_0x31ddc8 => { const _0x4af3c1 = _0x562822, _0x23b5bc = document[_0x4af3c1(0x820)]('li'); _0x23b5bc[_0x4af3c1(0x941)] = _0x4af3c1(0x8c8), _0x23b5bc[_0x4af3c1(0x86c)]['charId'] = _0x31ddc8['id'], _0x23b5bc[_0x4af3c1(0x6a9)] = _0x4af3c1(0x912) + (_0x31ddc8[_0x4af3c1(0x4ef)] || _0x2f6e79) + '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>' + _0x31ddc8[_0x4af3c1(0x4e6)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x23b5bc[_0x4af3c1(0x35e)](_0x4af3c1(0x39c), () => { _0x57d363(_0x31ddc8['id']); }), _0x23b5bc[_0x4af3c1(0x7c6)]('.char-info-wrapper')['addEventListener']('click', () => { const _0x3dd11e = _0x4af3c1; if (_0x3dd11e(0x3c7) === _0x3dd11e(0x3c7)) _0x57d363(_0x31ddc8['id']); else { const _0x351480 = _0x12584a['trim'](); if (!_0x351480 || !_0x382ecb[_0x3dd11e(0x597)]) return; let _0x84ca82 = _0x321c69[_0x3dd11e(0x94b)][_0x3dd11e(0x247)](_0x431c18 => _0x431c18[_0x3dd11e(0x80d)] === _0x4c903a['activeDiaryCharacterId']); !_0x84ca82 && (_0x84ca82 = { 'characterId': _0x72ec5c[_0x3dd11e(0x597)], 'entries': [] }, _0x297069[_0x3dd11e(0x94b)][_0x3dd11e(0x580)](_0x84ca82)); _0x84ca82['entries']['push']({ 'timestamp': _0x112303[_0x3dd11e(0x909)](), 'author': _0x3dd11e(0x619), 'content': _0x351480 }), _0x3917c9(); const _0x1a55ef = _0x84ca82['entries']['length']; _0xe4a520[_0x3dd11e(0x713)] = _0x3067b1[_0x3dd11e(0x495)](_0x1a55ef / 0x2) - 0x1, _0x526316(); } }), _0x23b5bc[_0x4af3c1(0x7c6)](_0x4af3c1(0x951))[_0x4af3c1(0x35e)](_0x4af3c1(0x39c), _0x5b6a2e => { const _0x1e9e13 = _0x4af3c1; _0x5b6a2e[_0x1e9e13(0x6d5)](), _0x389fce(_0x31ddc8['id']); }), _0x41b026[_0x4af3c1(0x204)](_0x23b5bc); }); } function _0x57d363(_0x41c824) { const _0x522253 = _0x54ed15, _0x4bb138 = _0x5122c0(_0x41c824); if (!_0x4bb138) return; _0x346f80[_0x522253(0x597)] = _0x41c824; const _0xc908fb = _0x346f80[_0x522253(0x94b)]['find'](_0x30af46 => _0x30af46[_0x522253(0x80d)] === _0x41c824), _0x253920 = _0xc908fb ? _0xc908fb[_0x522253(0x667)][_0x522253(0x6c3)] : 0x0, _0x4e01cc = 0x2; _0x346f80[_0x522253(0x713)] = Math[_0x522253(0x50a)](0x0, Math[_0x522253(0x495)](_0x253920 / _0x4e01cc) - 0x1), document[_0x522253(0x954)](_0x522253(0x1c7))[_0x522253(0x96c)] = _0x4bb138[_0x522253(0x4e6)] + _0x522253(0x633), _0xe9be5d(), _0x21dca3(_0x522253(0x6df), _0x522253(0x1f3)); } function _0xe9be5d() { const _0x390151 = _0x54ed15, _0x49a46 = document[_0x390151(0x954)](_0x390151(0x7d7)), _0x51c8ed = document[_0x390151(0x954)](_0x390151(0x1c9)); _0x49a46[_0x390151(0x6a9)] = '', _0x51c8ed['innerHTML'] = ''; const _0x24f1a3 = _0x16f3b9() || { 'name': '我' }, _0x4d733b = _0x346f80[_0x390151(0x94b)]['find'](_0x3bb5f0 => _0x3bb5f0[_0x390151(0x80d)] === _0x346f80[_0x390151(0x597)]); if (!_0x4d733b || !_0x4d733b['entries'] || _0x4d733b[_0x390151(0x667)][_0x390151(0x6c3)] === 0x0) { if (_0x390151(0x501) !== _0x390151(0x501)) { const _0x38cf10 = _0x12de43[_0x390151(0x820)](_0x390151(0x41a)); _0x38cf10['textContent'] = _0x3c1aad, _0x38cf10[_0x390151(0x35e)](_0x390151(0x39c), () => { const _0x902963 = _0x390151; _0x427654[_0x902963(0x908)] = _0x3fd5b8, _0x26c0f7[_0x902963(0x78f)]['remove']('show'); }), _0x5da977[_0x390151(0x204)](_0x38cf10); } else { _0x49a46[_0x390151(0x6a9)] = _0x390151(0x8c7), _0x51c8ed[_0x390151(0x6a9)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', document['getElementById'](_0x390151(0x989))['addEventListener'](_0x390151(0x39c), _0x5d152f), document[_0x390151(0x954)](_0x390151(0x41b))[_0x390151(0x35e)]('click', _0x3c1033); return; } } const _0x33617b = 0x2, _0x572a66 = [..._0x4d733b[_0x390151(0x667)]][_0x390151(0x254)]((_0x404d73, _0x531a17) => _0x404d73[_0x390151(0x83c)] - _0x531a17[_0x390151(0x83c)]), _0x41f0d4 = []; for (let _0x196bff = 0x0; _0x196bff < _0x572a66['length']; _0x196bff += _0x33617b) { _0x41f0d4[_0x390151(0x580)](_0x572a66[_0x390151(0x290)](_0x196bff, _0x196bff + _0x33617b)); } const _0x5a9c22 = _0x41f0d4[_0x390151(0x6c3)]; _0x41f0d4[_0x390151(0x927)]((_0x119928, _0x4bdef6) => { const _0x4f1012 = _0x390151, _0x2350e0 = document[_0x4f1012(0x820)](_0x4f1012(0x41a)); _0x2350e0[_0x4f1012(0x941)] = 'diary-page', _0x2350e0['id'] = _0x4f1012(0x76f) + _0x4bdef6, _0x4bdef6 === _0x346f80[_0x4f1012(0x713)] && _0x2350e0[_0x4f1012(0x78f)][_0x4f1012(0x3d0)](_0x4f1012(0x415)), _0x119928[_0x4f1012(0x927)](_0x26c31e => { const _0x492a60 = _0x4f1012; if ('ibQNE' === _0x492a60(0x775)) _0x37db3f[_0x492a60(0x621)] = _0x485960[_0x492a60(0x621)] || [], _0x431d9a['comments'] = (_0x4d7787[_0x492a60(0x5fb)] || [])[_0x492a60(0x2a0)]((_0x5cda73, _0x5f55c3) => ({ ..._0x5cda73, 'commentId': 'c_' + _0x222d34[_0x492a60(0x83c)] + '_' + _0x5f55c3 })), _0x33df7c(), _0x43ecfa(); else { const _0x141e49 = _0x26c31e[_0x492a60(0x780)] === _0x492a60(0x619) ? 'user' : 'ai', _0x4b0d52 = _0x26c31e[_0x492a60(0x780)] === _0x492a60(0x619) ? _0x24f1a3[_0x492a60(0x4e6)] : _0x5122c0(_0x26c31e[_0x492a60(0x780)])[_0x492a60(0x4e6)], _0x55e024 = document[_0x492a60(0x820)](_0x492a60(0x41a)); _0x55e024[_0x492a60(0x941)] = _0x492a60(0x6cc) + _0x141e49, _0x55e024[_0x492a60(0x86c)][_0x492a60(0x83c)] = _0x26c31e[_0x492a60(0x83c)], _0x55e024[_0x492a60(0x94f)]['borderBottom'] = _0x492a60(0x910), _0x55e024[_0x492a60(0x94f)][_0x492a60(0x308)] = '0', _0x55e024['innerHTML'] = _0x492a60(0x68b) + _0x4b0d52 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>' + new Date(_0x26c31e[_0x492a60(0x83c)])[_0x492a60(0x6de)](_0x492a60(0x6dd)) + _0x492a60(0x538) + _0x26c31e[_0x492a60(0x2fc)][_0x492a60(0x330)](/\n/g, '<br>') + _0x492a60(0x587), _0x2350e0['appendChild'](_0x55e024); } }), _0x49a46['appendChild'](_0x2350e0); }), _0x51c8ed[_0x390151(0x6a9)] = _0x390151(0x634) + (_0x346f80[_0x390151(0x713)] + 0x1) + '\x20/\x20' + _0x5a9c22 + _0x390151(0x51f), document['getElementById']('diary-prev-button')[_0x390151(0x7bc)] = _0x346f80[_0x390151(0x713)] === 0x0, document[_0x390151(0x954)](_0x390151(0x472))['disabled'] = _0x346f80[_0x390151(0x713)] === _0x5a9c22 - 0x1, document[_0x390151(0x954)](_0x390151(0x78b))[_0x390151(0x35e)]('click', _0x5bdfe0), document[_0x390151(0x954)](_0x390151(0x472))[_0x390151(0x35e)](_0x390151(0x39c), _0x320aeb), document['getElementById'](_0x390151(0x989))[_0x390151(0x35e)](_0x390151(0x39c), _0x5d152f), document[_0x390151(0x954)](_0x390151(0x41b))[_0x390151(0x35e)]('click', _0x3c1033); } function _0x320aeb() { const _0x15201f = _0x54ed15; if (_0x346f80[_0x15201f(0x2d4)]) return; const _0x3a56ce = _0x346f80['diaryCurrentPage'], _0x436388 = Math[_0x15201f(0x495)](_0x346f80[_0x15201f(0x94b)][_0x15201f(0x247)](_0x415ed6 => _0x415ed6[_0x15201f(0x80d)] === _0x346f80[_0x15201f(0x597)])[_0x15201f(0x667)]['length'] / 0x2); if (_0x3a56ce >= _0x436388 - 0x1) return; _0x346f80[_0x15201f(0x2d4)] = !![]; const _0x53f7e5 = _0x3a56ce + 0x1, _0x59f46e = document[_0x15201f(0x954)]('diary-page-' + _0x3a56ce), _0x531bbf = document[_0x15201f(0x954)](_0x15201f(0x76f) + _0x53f7e5); _0x59f46e && _0x531bbf ? (_0x531bbf[_0x15201f(0x78f)][_0x15201f(0x3d0)]('is-entering-from-right'), _0x59f46e[_0x15201f(0x78f)][_0x15201f(0x3d0)](_0x15201f(0x365)), _0x531bbf[_0x15201f(0x78f)][_0x15201f(0x3d0)](_0x15201f(0x415)), setTimeout(() => { const _0x48f6b0 = _0x15201f; _0x59f46e[_0x48f6b0(0x78f)][_0x48f6b0(0x309)](_0x48f6b0(0x415), _0x48f6b0(0x365)), _0x531bbf[_0x48f6b0(0x78f)]['remove'](_0x48f6b0(0x35b)), _0x346f80[_0x48f6b0(0x713)] = _0x53f7e5, _0xe9be5d(), _0x346f80['isAnimatingDiary'] = ![]; }, 0x2bc)) : _0x15201f(0x879) !== _0x15201f(0x32b) ? _0x346f80['isAnimatingDiary'] = ![] : (_0x13454f['value'] = '', _0x156c9d['textContent'] = _0x15201f(0x455), _0x213407[_0x15201f(0x908)] = _0x15201f(0x78e) + (_0x17cab1[_0x15201f(0x499)][_0x15201f(0x6c3)] + 0x1), _0x490420[_0x15201f(0x908)] = '', _0x21fa62[_0x15201f(0x7d9)] = _0x5bb222, _0x2c89e1[_0x15201f(0x908)] = _0x15201f(0x3f3), _0x4913d9['getElementById'](_0x15201f(0x30e))['value'] = '', _0x354f63()); } function _0x5bdfe0() { const _0x507523 = _0x54ed15; if (_0x507523(0x8d0) !== 'qBsVj') { const _0x2abc13 = _0x4dcffd[_0x507523(0x87d)]('{'), _0x4146e7 = _0x347a36[_0x507523(0x8f7)]('}'); if (_0x2abc13 >= 0x0 && _0x4146e7 > _0x2abc13) return _0x467e02[_0x507523(0x290)](_0x2abc13, _0x4146e7 + 0x1); return _0x5edc6d; } else { if (_0x346f80[_0x507523(0x2d4)]) return; const _0x2a9cf2 = _0x346f80[_0x507523(0x713)]; if (_0x2a9cf2 <= 0x0) return; _0x346f80[_0x507523(0x2d4)] = !![]; const _0x54a497 = _0x2a9cf2 - 0x1, _0x224c38 = document['getElementById'](_0x507523(0x76f) + _0x2a9cf2), _0x152981 = document[_0x507523(0x954)](_0x507523(0x76f) + _0x54a497); _0x224c38 && _0x152981 ? (_0x152981[_0x507523(0x78f)][_0x507523(0x3d0)]('is-entering-from-left'), _0x224c38[_0x507523(0x78f)][_0x507523(0x3d0)](_0x507523(0x7e9)), _0x152981[_0x507523(0x78f)][_0x507523(0x3d0)](_0x507523(0x415)), setTimeout(() => { const _0x2ceb05 = _0x507523; _0x2ceb05(0x991) !== 'Kruks' ? (_0xa4faf2[_0x2ceb05(0x8d6)](_0x2ceb05(0x28f), _0x592767), _0x54ed58 = _0x5ce652) : (_0x224c38[_0x2ceb05(0x78f)]['remove'](_0x2ceb05(0x415), 'is-exiting-right'), _0x152981[_0x2ceb05(0x78f)][_0x2ceb05(0x309)](_0x2ceb05(0x44b)), _0x346f80['diaryCurrentPage'] = _0x54a497, _0xe9be5d(), _0x346f80[_0x2ceb05(0x2d4)] = ![]); }, 0x2bc)) : _0x507523(0x22c) === _0x507523(0x70f) ? _0x461d5a = _0x5b48ca[_0x507523(0x364)][_0x507523(0x4e6)] || '我' : _0x346f80[_0x507523(0x2d4)] = ![]; } } function _0x5d152f() { const _0x51190f = _0x54ed15; return 'TLKil' !== _0x51190f(0x617) ? _0x2be479[_0x51190f(0x290)](0x0, 0x9) : new Promise(_0x514d68 => { const _0x526ea8 = _0x51190f; if ('gzJvo' !== _0x526ea8(0x210)) _0x4bac0c[_0x526ea8(0x954)](_0x526ea8(0x4da))['click'](); else { const _0x4f8560 = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; document['body']['insertAdjacentHTML'](_0x526ea8(0x189), _0x4f8560); const _0x18b50c = document[_0x526ea8(0x954)](_0x526ea8(0x245)), _0x25fb1d = document['getElementById']('diary-modal-textarea'), _0x3dd149 = document[_0x526ea8(0x954)](_0x526ea8(0x375)), _0x274bbf = document[_0x526ea8(0x954)](_0x526ea8(0x443)), _0x1f50bb = _0x18b50c['querySelector'](_0x526ea8(0x7e8)), _0x491ba5 = () => { const _0x57fee2 = _0x526ea8; _0x18b50c[_0x57fee2(0x309)](), _0x514d68(); }; _0x3dd149[_0x526ea8(0x1b0)] = () => { const _0x1de100 = _0x526ea8; _0x1de100(0x2ac) !== 'PAonf' ? (_0x5f5639[_0x1de100(0x7e5)]('用户操作中断了\x20AI\x20响应。'), _0x40f828[_0x1de100(0x5f7)][_0x1de100(0x93c)](_0x1de100(0x2a1)), _0x54771f[_0x1de100(0x5f7)] = null) : (_0x300797(_0x25fb1d['value']), _0x491ba5()); }, _0x274bbf[_0x526ea8(0x1b0)] = _0x491ba5, _0x1f50bb[_0x526ea8(0x1b0)] = _0x491ba5; } }); } function _0x300797(_0x317d01) { const _0xe93323 = _0x54ed15; if ('sNgiB' === _0xe93323(0x258)) { _0x3e4b62(_0xe93323(0x304) + _0x2a2c94 + _0xe93323(0x853)), _0x307a1b(() => _0x4683fe['reload'](), 0x5dc); return; } else { const _0x4e27c5 = _0x317d01[_0xe93323(0x4dd)](); if (!_0x4e27c5 || !_0x346f80['activeDiaryCharacterId']) return; let _0xe58935 = _0x346f80['diaries'][_0xe93323(0x247)](_0x5cd6a0 => _0x5cd6a0[_0xe93323(0x80d)] === _0x346f80[_0xe93323(0x597)]); !_0xe58935 && (_0xe58935 = { 'characterId': _0x346f80[_0xe93323(0x597)], 'entries': [] }, _0x346f80[_0xe93323(0x94b)][_0xe93323(0x580)](_0xe58935)); _0xe58935[_0xe93323(0x667)][_0xe93323(0x580)]({ 'timestamp': Date['now'](), 'author': 'user', 'content': _0x4e27c5 }), _0x23c6b9(); const _0x2b781d = _0xe58935['entries'][_0xe93323(0x6c3)]; _0x346f80[_0xe93323(0x713)] = Math[_0xe93323(0x495)](_0x2b781d / 0x2) - 0x1, _0xe9be5d(); } } async function _0x3c1033() { const _0x1ad8c2 = _0x54ed15, _0x457dd7 = _0x346f80[_0x1ad8c2(0x94b)]['find'](_0x135a6a => _0x135a6a[_0x1ad8c2(0x80d)] === _0x346f80[_0x1ad8c2(0x597)]), _0x389d2b = _0x346f80[_0x1ad8c2(0x597)], _0x94e750 = _0x5122c0(_0x389d2b); if (!_0x94e750 || _0x346f80[_0x1ad8c2(0x3d2)]) return; _0x6cd89d(!![], 'TA正在提笔写日记...'), _0x346f80[_0x1ad8c2(0x3d2)] = !![]; let _0x3cfe76 = []; try { const _0x22cf3f = _0x16f3b9() || { 'name': '你' }, _0xf2365e = _0xb8d7f(_0x389d2b), { omniText: _0x321d00 } = _0x4aa25d(_0x389d2b, _0x346f80['activeChatId']); let _0x1ea0db = ''; if (_0x94e750[_0x1ad8c2(0x925)] && _0x94e750[_0x1ad8c2(0x925)][_0x1ad8c2(0x6c3)] > 0x0) { if ('PndHb' !== _0x1ad8c2(0x55b)) _0x58d576(_0x115c9a), _0x2cd958(); else { const _0x39e917 = _0x94e750[_0x1ad8c2(0x925)][_0x1ad8c2(0x2a0)](_0x2f385f => _0x346f80['worldBooks'][_0x1ad8c2(0x247)](_0x307121 => _0x307121['id'] === _0x2f385f))[_0x1ad8c2(0x6e8)](Boolean)[_0x1ad8c2(0x2a0)](_0x1b9da1 => '\x0a\x0a##\x20世界书条目:\x20' + _0x1b9da1['name'] + '\x0a' + _0x1b9da1['content'])[_0x1ad8c2(0x6e6)](''); if (_0x39e917) _0x1ea0db = '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a' + _0x39e917; } } const _0x225252 = _0x22cf3f[_0x1ad8c2(0x1a5)] ? _0x1ad8c2(0x623) + _0x22cf3f[_0x1ad8c2(0x4e6)] + _0x1ad8c2(0x56b) + _0x22cf3f[_0x1ad8c2(0x1a5)] : '', _0x207c3a = _0x5e45d9(); let _0x11064c = _0x1ad8c2(0x42f); if (_0x457dd7 && _0x457dd7[_0x1ad8c2(0x667)]) { const _0x300bde = _0x457dd7[_0x1ad8c2(0x667)][_0x1ad8c2(0x6e8)](_0x41267f => _0x41267f['author'] === 'user')[_0x1ad8c2(0x4ab)](); if (_0x300bde) { if (_0x1ad8c2(0x2cd) === _0x1ad8c2(0x2cd)) _0x11064c = _0x300bde[_0x1ad8c2(0x2fc)]; else { const _0x556169 = _0x34839e[_0x1ad8c2(0x7c6)](_0x1ad8c2(0x4c7)); if (!_0x556169) return; _0x556169['id'] === _0x1ad8c2(0x682) ? _0xf22bed() : _0x12ae9a(); } } } const _0x3af8fd = '#\x20核心任务:\x20写一篇有深度的交换日记\x0a你正在扮演名为“' + _0x94e750[_0x1ad8c2(0x4e6)] + '”的角色，现在需要写一篇交换日记。\x0a\x0a#\x20你的读者\x0a' + _0x22cf3f[_0x1ad8c2(0x4e6)] + _0x1ad8c2(0x8d2) + _0x22cf3f['name'] + _0x1ad8c2(0x9c7) + _0x11064c + '”\x20\x0a\x20你必须针对这段内容表达你的看法、感受或关联的思考。\x0a2.\x20\x20**【次要任务：分享自我】**\x20在回应之后，你**必须**分享一些关于你自己的、读者**不知道**的新鲜事。可以是你今天的见闻、一个突然的想法、或者一件小小的秘密。不要总是复述你们已经聊过的内容！\x0a3.\x20\x20**【禁止复读】**\x20聊天记录和动态只是你的“背景记忆”，是用来确保你不OOC的参考，**绝对不是**你日记的主要内容！\x0a\x0a#\x20你的核心人设\x20(必须遵守)\x0a' + _0x94e750[_0x1ad8c2(0x1a5)] + '\x0a' + _0x225252 + '\x0a' + _0x1ea0db + _0x1ad8c2(0x61c) + new Date()[_0x1ad8c2(0x6de)]('zh-CN', { 'dateStyle': _0x1ad8c2(0x7fb), 'timeStyle': _0x1ad8c2(0x618) }) + _0x1ad8c2(0x71b) + _0x1afdb6(new Date(_0x457dd7?.['entries']?.['at'](-0x1)?.[_0x1ad8c2(0x83c)] || Date[_0x1ad8c2(0x909)]())) + _0x1ad8c2(0x43b) + (_0x321d00 || _0x1ad8c2(0x46f)) + '\x0a---\x0a##\x20最近的朋友圈动态\x0a' + (_0x207c3a || _0x1ad8c2(0x819)) + '\x0a---\x0a\x0a#\x20输出要求\x0a直接输出一篇有文采、有真情实感的日记正文，不要包含任何其他说明或前缀。'; _0x3cfe76 = [{ 'role': 'system', 'content': _0x3af8fd }, { 'role': _0x1ad8c2(0x619), 'content': _0x1ad8c2(0x17f) }]; const _0x13c91b = await _0x555f32(_0x3cfe76); if (_0x13c91b) { if ('JPkJo' === 'NMRBt') { const _0x59e043 = _0x165ac4['createElement']('option'); _0x59e043[_0x1ad8c2(0x908)] = _0x459218['id'], _0x59e043['textContent'] = _0xe9c23e[_0x1ad8c2(0x4e6)], _0x153c27['appendChild'](_0x59e043); } else { let _0x52d1c0 = _0x346f80[_0x1ad8c2(0x94b)][_0x1ad8c2(0x247)](_0x31ffcb => _0x31ffcb['characterId'] === _0x389d2b); if (!_0x52d1c0) { if (_0x1ad8c2(0x343) === _0x1ad8c2(0x343)) _0x52d1c0 = { 'characterId': _0x389d2b, 'entries': [] }, _0x346f80['diaries'][_0x1ad8c2(0x580)](_0x52d1c0); else return []; } _0x52d1c0[_0x1ad8c2(0x667)][_0x1ad8c2(0x580)]({ 'timestamp': Date[_0x1ad8c2(0x909)](), 'author': _0x389d2b, 'content': _0x13c91b }), _0x23c6b9(); const _0x1d042c = _0x52d1c0[_0x1ad8c2(0x667)][_0x1ad8c2(0x6c3)]; _0x346f80[_0x1ad8c2(0x713)] = Math['ceil'](_0x1d042c / 0x2) - 0x1, _0xe9be5d(); } } } catch (_0x19cb53) { _0x1ad8c2(0x2aa) !== _0x1ad8c2(0x573) ? _0x3383df(_0x1ad8c2(0x708) + _0x19cb53['message']) : (_0x382903[_0x1ad8c2(0x845)](_0x1ad8c2(0x952)), _0x436fc0(), _0x482d4d(_0x1ad8c2(0x380))); } finally { _0x1ad8c2(0x568) === _0x1ad8c2(0x568) ? (_0x6cd89d(![]), _0x346f80[_0x1ad8c2(0x3d2)] = ![]) : _0x19b5fa ? _0x4b3f76['classList'][_0x1ad8c2(0x3d0)](_0x1ad8c2(0x93f)) : _0x2a3dec[_0x1ad8c2(0x78f)][_0x1ad8c2(0x309)](_0x1ad8c2(0x93f)); } } function _0x1557d8() { const _0x219e50 = _0x54ed15; if (_0x219e50(0x7de) === _0x219e50(0x7de)) { const _0x2c1047 = document[_0x219e50(0x954)]('meeting-scene-view'), _0x37ed52 = document[_0x219e50(0x954)](_0x219e50(0x275)), _0x5c3277 = document[_0x219e50(0x7c6)](_0x219e50(0x575)); if (_0x346f80['meetingViewMode'] === _0x219e50(0x4d0)) { if (_0x219e50(0x51e) === _0x219e50(0x2bd)) { _0x19692c[_0x219e50(0x6a9)] = _0x219e50(0x4be); return; } else _0x2c1047[_0x219e50(0x94f)]['display'] = _0x219e50(0x910), _0x37ed52[_0x219e50(0x94f)][_0x219e50(0x3b4)] = _0x219e50(0x810); } else _0x2c1047[_0x219e50(0x94f)]['display'] = _0x219e50(0x810), _0x37ed52['style'][_0x219e50(0x3b4)] = 'none'; _0x5c3277[_0x219e50(0x94f)][_0x219e50(0x3b4)] = _0x219e50(0x810); } else { const _0x5376a2 = _0x1bfdc7[_0x219e50(0x954)]('world-book-list-container'); _0x5376a2[_0x219e50(0x6a9)] = ''; if (_0x4c09d6[_0x219e50(0x814)][_0x219e50(0x6c3)] === 0x0) { _0x5376a2[_0x219e50(0x6a9)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>'; return; } _0x4c86fd[_0x219e50(0x814)]['forEach'](_0x25a02f => { const _0x47cb44 = _0x219e50, _0x3fa91 = _0x182740[_0x47cb44(0x820)]('div'); _0x3fa91[_0x47cb44(0x941)] = _0x47cb44(0x723), _0x3fa91[_0x47cb44(0x86c)]['id'] = _0x25a02f['id'], _0x3fa91[_0x47cb44(0x6a9)] = _0x47cb44(0x6bc) + _0x25a02f[_0x47cb44(0x4e6)] + _0x47cb44(0x913) + _0x25a02f[_0x47cb44(0x2fc)][_0x47cb44(0x8f0)](0x0, 0x64) + _0x47cb44(0x52c), _0x3fa91[_0x47cb44(0x35e)](_0x47cb44(0x39c), () => _0x3628a1(_0x25a02f['id'])), _0x5376a2[_0x47cb44(0x204)](_0x3fa91); }); } } function _0x3c519a() { const _0x3fa783 = _0x54ed15; if (_0x3fa783(0x240) !== _0x3fa783(0x240)) _0x2a268f['error'](_0x3fa783(0x76d), _0x4d10b2), _0x47a7c4(_0x3fa783(0x85f)); else { const _0x943027 = document['getElementById']('galgame-speaker'), _0x529a9f = document[_0x3fa783(0x954)](_0x3fa783(0x706)); if (_0x346f80['activeMeetingScriptQueue'][_0x3fa783(0x6c3)] > 0x0) { if (_0x3fa783(0x5cd) !== 'IEKoT') { _0x485eaa(); const _0x300753 = (_0x14ec90[_0x3fa783(0x98c)][_0x3fa783(0x4b6)] || '')[_0x3fa783(0x84e)](_0x1516c9); _0x444025[_0x3fa783(0x7bc)] = _0x300753, _0x1cc6b6(_0x3fa783(0x7c8), _0x3fa783(0x72b)); } else { const _0x554b12 = _0x346f80['activeMeetingScriptQueue'][_0x3fa783(0x9b3)](); _0x943027[_0x3fa783(0x96c)] = _0x554b12[_0x3fa783(0x4a3)] === _0x3fa783(0x47f) ? '旁白' : _0x554b12[_0x3fa783(0x4a3)], _0x529a9f[_0x3fa783(0x96c)] = _0x554b12[_0x3fa783(0x493)], _0x554b12[_0x3fa783(0x4a3)] !== 'narrator' && _0x10cf47(_0x346f80['activeMeetingCharId'], _0x554b12[_0x3fa783(0x7aa)]); } } else { const _0x448fbc = _0x346f80[_0x3fa783(0x2c7)][_0x346f80[_0x3fa783(0x785)]]; if (_0x448fbc && _0x448fbc[_0x3fa783(0x6c3)] > 0x0) { if (_0x3fa783(0x2b5) !== _0x3fa783(0x2b5)) { let _0x371718 = _0x8ab80f[_0x3fa783(0x814)]['find'](_0x2b62e1 => _0x2b62e1[_0x3fa783(0x4e6)] === _0x3d67a7[_0x3fa783(0x4e6)]); if (_0x371718) _0x595a0e[_0x3fa783(0x580)](_0x371718['id']); else { const _0x1fa01d = { 'id': 'wb_' + _0x5def41['now']() + '_' + _0x13bcc1[_0x3fa783(0x93a)](), 'name': _0x57f128[_0x3fa783(0x4e6)], 'content': _0x142c45[_0x3fa783(0x2fc)] }; _0x2bb0e7[_0x3fa783(0x814)][_0x3fa783(0x580)](_0x1fa01d), _0x931c0f[_0x3fa783(0x580)](_0x1fa01d['id']); } } else { _0x346f80[_0x3fa783(0x6e4)] = [..._0x448fbc]; const _0x3db549 = _0x346f80[_0x3fa783(0x6e4)][_0x3fa783(0x9b3)](); _0x943027[_0x3fa783(0x96c)] = _0x3db549[_0x3fa783(0x4a3)] === 'narrator' ? '旁白' : _0x3db549['speaker'], _0x529a9f[_0x3fa783(0x96c)] = _0x3db549[_0x3fa783(0x493)], _0x3db549[_0x3fa783(0x4a3)] !== 'narrator' && _0x10cf47(_0x346f80[_0x3fa783(0x785)], _0x3db549[_0x3fa783(0x7aa)]); } } else _0x943027[_0x3fa783(0x96c)] = '旁白', _0x529a9f[_0x3fa783(0x96c)] = _0x3fa783(0x42c); } } } async function _0x10cf47(_0x170813, _0x425ca6) { const _0x588424 = _0x54ed15, _0x9bea62 = document[_0x588424(0x954)](_0x588424(0x2c8)), _0x1857fe = document[_0x588424(0x954)](_0x588424(0x852)), _0x3e085c = _0x5122c0(_0x170813), _0x1e7000 = _0x3e085c?.[_0x588424(0x27d)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }, _0x3184b9 = 0x50 * _0x1e7000['scale']; _0x1857fe[_0x588424(0x94f)][_0x588424(0x2d9)] = _0x3184b9 + '%', _0x1857fe[_0x588424(0x94f)]['width'] = _0x3184b9 + '%', _0x1857fe[_0x588424(0x94f)]['left'] = _0x1e7000['x'] + '%', _0x1857fe[_0x588424(0x94f)][_0x588424(0x5ea)] = _0x1e7000['y'] + '%', _0x1857fe[_0x588424(0x94f)]['transform'] = _0x588424(0x68e), _0x1857fe['style'][_0x588424(0x95e)] = _0x588424(0x18c); const _0x132272 = ['normal', _0x588424(0x463), _0x588424(0x4b2), _0x588424(0x216), _0x588424(0x195)], _0x596518 = _0x132272[_0x588424(0x84e)](_0x425ca6) ? _0x425ca6 : _0x588424(0x7e0); try { const _0x385b68 = await _0x4f16ca(_0x588424(0x75b) + _0x596518 + '_' + _0x170813); if (_0x385b68) _0x9bea62[_0x588424(0x7d9)] && _0x9bea62['style'][_0x588424(0x1cb)] !== '0' ? (_0x9bea62[_0x588424(0x94f)]['opacity'] = 0x0, setTimeout(() => { const _0x3ae45b = _0x588424; _0x9bea62[_0x3ae45b(0x7d9)] = URL[_0x3ae45b(0x8f3)](_0x385b68), _0x9bea62[_0x3ae45b(0x94f)][_0x3ae45b(0x1cb)] = 0x1; }, 0x96)) : _0x588424(0x8c6) !== _0x588424(0x38f) ? (_0x9bea62[_0x588424(0x7d9)] = URL[_0x588424(0x8f3)](_0x385b68), _0x9bea62[_0x588424(0x94f)][_0x588424(0x1cb)] = 0x1) : (_0x251d7e[_0x588424(0x4e6)] = _0x4827d0[_0x588424(0x4dd)](), _0xa91664(), _0x207941(), _0xa45260(), _0x4c3252(_0x588424(0x8a6) + _0x234441['name'] + '\x22。')); else { if (_0x588424(0x38e) !== _0x588424(0x384)) { const _0x8e0503 = await _0x4f16ca(_0x588424(0x28c) + _0x170813); _0x9bea62[_0x588424(0x7d9)] = _0x8e0503 ? URL[_0x588424(0x8f3)](_0x8e0503) : ''; } else _0x13f473[_0x588424(0x955)] === _0x588424(0x3fc) && !_0x58793a[_0x588424(0x31f)] && (_0x354474[_0x588424(0x45f)](), _0x28e859()); } } catch (_0x15cf5e) { _0x588424(0x742) !== _0x588424(0x8c2) ? (console[_0x588424(0x8d6)](_0x588424(0x54c), _0x15cf5e), _0x9bea62[_0x588424(0x7d9)] = '') : _0x276cbe(); } } let _0x3b11f7 = ![], _0x1199b7 = { 'isDragging': ![], 'isResizing': ![], 'startX': 0x0, 'startY': 0x0, 'startLeft': 0x0, 'startTop': 0x0, 'startWidth': 0x0, 'startHeight': 0x0 }; const _0x33cb54 = document[_0x54ed15(0x954)]('sprite-adjust-button'), _0x2c7ce = document['getElementById'](_0x54ed15(0x801)), _0x58a243 = document[_0x54ed15(0x954)](_0x54ed15(0x36c)), _0x3858ce = document[_0x54ed15(0x954)](_0x54ed15(0x596)), _0x58f000 = document[_0x54ed15(0x954)]('galgame-sprite-controls'), _0x195108 = document[_0x54ed15(0x954)](_0x54ed15(0x852)), _0x333af4 = document[_0x54ed15(0x954)](_0x54ed15(0x34b)), _0x5ed7a4 = document[_0x54ed15(0x954)](_0x54ed15(0x1d8)); let _0x35eb95 = {}; function _0x6906a3() { const _0x2df04f = _0x54ed15; if (_0x2df04f(0x87f) !== 'oikya') { const _0x478435 = _0x5bbb30[_0x2df04f(0x954)](_0x2df04f(0x4f3)); if (!_0x478435) return; _0x478435['checked'] = _0x34b073[_0x2df04f(0x4fe)][_0x2df04f(0x209)] || ![], _0x478435[_0x2df04f(0x35e)](_0x2df04f(0x2ed), () => { const _0x28ef69 = _0x2df04f; _0x185852[_0x28ef69(0x4fe)]['forceWhiteClock'] = _0x478435[_0x28ef69(0x896)], _0x4d766d(), _0x4519b1(); }); } else { const _0x2dd7b2 = _0x5122c0(_0x346f80[_0x2df04f(0x785)]); if (!_0x2dd7b2) return; _0x3b11f7 = !![], _0x58f000[_0x2df04f(0x94f)][_0x2df04f(0x3b4)] = _0x2df04f(0x810); const _0x387428 = _0x2dd7b2[_0x2df04f(0x27d)] || { 'x': 0x32, 'y': 0x64, 'scale': 0x1 }; document[_0x2df04f(0x954)](_0x2df04f(0x5bc))[_0x2df04f(0x908)] = _0x387428['x'], document[_0x2df04f(0x954)](_0x2df04f(0x57e))['value'] = _0x387428['y'], document[_0x2df04f(0x954)](_0x2df04f(0x2f8))['value'] = _0x387428[_0x2df04f(0x4c3)] * 0x64, _0x35eb95 = { ..._0x387428 }, document[_0x2df04f(0x954)](_0x2df04f(0x194))['style'][_0x2df04f(0x3b4)] = _0x2df04f(0x910), document['getElementById'](_0x2df04f(0x358))[_0x2df04f(0x94f)][_0x2df04f(0x3b4)] = _0x2df04f(0x910); } } function _0xdd54cd(_0x16de69 = ![]) { const _0x440c24 = _0x54ed15; _0x3b11f7 = ![], _0x58f000[_0x440c24(0x94f)]['display'] = 'none', document[_0x440c24(0x954)](_0x440c24(0x194))[_0x440c24(0x94f)]['display'] = _0x440c24(0x810), document['getElementById']('galgame-sprite-adjust-ui')[_0x440c24(0x94f)][_0x440c24(0x3b4)] = _0x440c24(0x810); if (!_0x16de69) { if ('NAUiO' !== 'RJRfO') { const _0x36b99f = _0x5122c0(_0x346f80['activeMeetingCharId']); _0x36b99f && (_0x36b99f['spriteTransform'] = _0x35eb95, _0x10cf47(_0x346f80[_0x440c24(0x785)], 'normal')); } else return _0x5c736b[_0x440c24(0x580)](_0x1612da), _0x15e6b8; } } function _0x2b4e6a() { const _0x3cd5f4 = _0x54ed15; if (_0x3cd5f4(0x17a) !== 'raVPs') { const _0x46e8e0 = _0x5358f8[_0x3cd5f4(0x954)]('modal-root'), _0x15647f = _0x3504cf[_0x3cd5f4(0x954)]('modal-text'), _0x3a7080 = _0x5afdef['getElementById'](_0x3cd5f4(0x362)), _0xd736a9 = _0x4867a0['getElementById'](_0x3cd5f4(0x6c1)), _0x3cf3da = _0x13e4b4['getElementById']('modal-mask'); _0x15647f['textContent'] = _0x3cc455, _0x46e8e0[_0x3cd5f4(0x94f)]['display'] = _0x3cd5f4(0x798); const _0x292e55 = _0x3d724c => { const _0x191517 = _0x3cd5f4; _0x46e8e0[_0x191517(0x94f)][_0x191517(0x3b4)] = _0x191517(0x910), _0x3a7080[_0x191517(0x1b0)] = _0xd736a9['onclick'] = _0x3cf3da['onclick'] = null, _0x3261a1['removeEventListener'](_0x191517(0x491), _0x1e2bd5), _0xb36691(_0x3d724c); }, _0x1e2bd5 = _0xa027d8 => { const _0xf2fdc2 = _0x3cd5f4; if (_0xa027d8[_0xf2fdc2(0x955)] === _0xf2fdc2(0x1e1)) _0x292e55(![]); if (_0xa027d8[_0xf2fdc2(0x955)] === _0xf2fdc2(0x3fc)) _0x292e55(!![]); }; _0x3a7080[_0x3cd5f4(0x1b0)] = () => _0x292e55(!![]), _0xd736a9[_0x3cd5f4(0x1b0)] = () => _0x292e55(![]), _0x3cf3da[_0x3cd5f4(0x1b0)] = () => _0x292e55(![]), _0x376722[_0x3cd5f4(0x35e)](_0x3cd5f4(0x491), _0x1e2bd5); } else { const _0x3444d8 = _0x5122c0(_0x346f80['activeMeetingCharId']); if (!_0x3444d8) return; const _0x4f0fe0 = parseFloat(document[_0x3cd5f4(0x954)](_0x3cd5f4(0x5bc))[_0x3cd5f4(0x908)]), _0x154b8d = parseFloat(document[_0x3cd5f4(0x954)](_0x3cd5f4(0x57e))[_0x3cd5f4(0x908)]), _0x5ad743 = parseFloat(document[_0x3cd5f4(0x954)](_0x3cd5f4(0x2f8))[_0x3cd5f4(0x908)]) / 0x64; _0x3444d8[_0x3cd5f4(0x27d)] = { 'x': _0x4f0fe0, 'y': _0x154b8d, 'scale': _0x5ad743 }, _0x23c6b9(), _0x3383df('哼，就按你说的办好了。'), _0xdd54cd(!![]); } } function _0x1dea33() { const _0x416dd3 = _0x54ed15; _0x416dd3(0x988) === _0x416dd3(0x988) ? _0x57c3ed(_0x416dd3(0x916))[_0x416dd3(0x710)](_0xd62d6 => { const _0x1a41ba = _0x416dd3; if (_0xd62d6) { const _0x156697 = _0x5122c0(_0x346f80['activeMeetingCharId']); _0x156697 && (_0x1a41ba(0x72f) === 'xckPs' ? _0x2c08cc(_0x1a41ba(0x9c1) + _0x576970[_0x1a41ba(0x399)]) : (delete _0x156697[_0x1a41ba(0x27d)], _0x23c6b9(), _0x10cf47(_0x156697['id'], _0x1a41ba(0x7e0)), _0x3383df(_0x1a41ba(0x459)), _0xdd54cd(!![]))); } }) : (_0x525bc9['stopPropagation'](), _0x3750e8(_0x2399fc['id'])); } function _0xda1d35() { const _0x429ec9 = _0x54ed15; if (!_0x3b11f7) return; const _0x314532 = _0x346f80[_0x429ec9(0x785)], _0x4c5b44 = _0x5122c0(_0x314532); if (!_0x4c5b44) return; const _0x292786 = parseFloat(document[_0x429ec9(0x954)](_0x429ec9(0x5bc))['value']), _0x3c7d09 = parseFloat(document['getElementById']('sprite-slider-y')[_0x429ec9(0x908)]), _0xf29c08 = parseFloat(document[_0x429ec9(0x954)](_0x429ec9(0x2f8))[_0x429ec9(0x908)]) / 0x64; _0x4c5b44[_0x429ec9(0x27d)] = { 'x': _0x292786, 'y': _0x3c7d09, 'scale': _0xf29c08 }; const _0x49c7d7 = document[_0x429ec9(0x954)](_0x429ec9(0x852)), _0x588352 = 0x50 * _0xf29c08; _0x49c7d7[_0x429ec9(0x94f)][_0x429ec9(0x2d9)] = _0x588352 + '%', _0x49c7d7['style'][_0x429ec9(0x99d)] = _0x588352 + '%', _0x49c7d7[_0x429ec9(0x94f)][_0x429ec9(0x2f9)] = _0x292786 + '%', _0x49c7d7[_0x429ec9(0x94f)][_0x429ec9(0x5ea)] = _0x3c7d09 + '%', _0x49c7d7[_0x429ec9(0x94f)][_0x429ec9(0x202)] = 'translate(-50%,\x20-100%)'; } document['getElementById']('sprite-slider-x')['addEventListener'](_0x54ed15(0x7b5), _0xda1d35), document[_0x54ed15(0x954)](_0x54ed15(0x57e))['addEventListener']('input', _0xda1d35), document['getElementById'](_0x54ed15(0x2f8))[_0x54ed15(0x35e)](_0x54ed15(0x7b5), _0xda1d35), _0x33cb54[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x6906a3), _0x2c7ce[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x2b4e6a), _0x58a243[_0x54ed15(0x35e)]('click', () => _0xdd54cd(![])), _0x3858ce['addEventListener']('click', _0x1dea33); function _0x5dd9eb(_0x2f5ee7) { const _0x39f8c1 = _0x54ed15; if ('IyYhV' !== 'zsOUT') { const _0x79efc2 = _0x5122c0(_0x2f5ee7); if (!_0x79efc2) return; const _0x3e8a08 = _0x346f80[_0x39f8c1(0x3aa)][_0x39f8c1(0x247)](_0x51f0b5 => _0x51f0b5['type'] === _0x39f8c1(0x328) && _0x51f0b5[_0x39f8c1(0x717)][_0x39f8c1(0x84e)](_0x2f5ee7)), _0x24ce31 = _0x3d25f9(_0x3e8a08['id']), _0x4f7d24 = _0x346f80[_0x39f8c1(0x250)][_0x39f8c1(0x6e8)](_0x25d3fe => _0x25d3fe[_0x39f8c1(0x97f)])[_0x39f8c1(0x4ab)](), _0x110ce9 = document[_0x39f8c1(0x954)]('galgame-speaker'), _0x5ba0d7 = document[_0x39f8c1(0x954)](_0x39f8c1(0x706)); let _0x300e32 = null; if (_0x4f7d24) { if ('LedOT' !== 'vvfbV') { if (_0x4f7d24[_0x39f8c1(0x6b9)] === _0x39f8c1(0x81d)) { if ('PBNOV' === 'PBNOV') { const _0x2bec22 = _0x346f80['characterLastScripts'][_0x2f5ee7]; _0x2bec22 && _0x2bec22[_0x39f8c1(0x6c3)] > 0x0 && (_0x39f8c1(0x95b) !== _0x39f8c1(0x95b) ? (_0x169b5c['appendChild'](_0x1fc70f), _0x440839[_0x39f8c1(0x204)](_0x43485b)) : _0x300e32 = _0x2bec22['at'](-0x1)); } else _0x266077[_0x39f8c1(0x7d9)] = _0x403d9d[_0x39f8c1(0x8f3)](_0x4745fd), _0x2d2d1a[_0x39f8c1(0x94f)][_0x39f8c1(0x3b4)] = 'block'; } else _0x39f8c1(0x98b) !== _0x39f8c1(0x4ad) ? _0x300e32 = { 'speaker': _0x24ce31[_0x39f8c1(0x4e6)], 'line': _0x4f7d24[_0x39f8c1(0x2fc)], 'emotion': _0x39f8c1(0x7e0) } : _0x480d8b[_0x39f8c1(0x2d4)] = ![]; } else _0x3435c1 = _0x5d420c[_0x39f8c1(0x781)](_0x4e166f[_0x39f8c1(0x164)](_0x25802f) || '{}'); } if (_0x300e32) { if (_0x39f8c1(0x722) !== _0x39f8c1(0x227)) _0x110ce9[_0x39f8c1(0x96c)] = _0x300e32['speaker'] === _0x39f8c1(0x47f) ? '旁白' : _0x300e32[_0x39f8c1(0x4a3)], _0x5ba0d7[_0x39f8c1(0x96c)] = _0x300e32['line'], _0x300e32[_0x39f8c1(0x4a3)] === _0x79efc2[_0x39f8c1(0x4e6)] ? _0x10cf47(_0x2f5ee7, _0x300e32[_0x39f8c1(0x7aa)]) : _0x39f8c1(0x5d5) !== 'JFiIZ' ? _0x3bab9b('home', 'meetingList') : _0x10cf47(_0x2f5ee7, _0x39f8c1(0x7e0)); else { const _0x25a330 = _0x4c1d10[_0x39f8c1(0x4a8)][_0x39f8c1(0x247)](_0x3b6638 => _0x3b6638['id'] === _0x96f246[_0x39f8c1(0x903)]), _0x2185c7 = _0x25a330 ? _0x25a330[_0x39f8c1(0x94a)] : []; if (!_0x2185c7 || _0x2185c7[_0x39f8c1(0x6c3)] === 0x0) return ''; const _0x23f720 = _0x2185c7['slice'](0x0, 0x5), _0x2d1be6 = _0x23f720[_0x39f8c1(0x2a0)](_0x1a5d6a => { const _0xa0e2f5 = _0x39f8c1, _0x14590d = _0x171bd4(_0x1a5d6a[_0xa0e2f5(0x5dd)]) || { 'name': '未知' }; let _0x516af6 = _0xa0e2f5(0x82a) + _0x14590d['name'] + _0xa0e2f5(0x319) + (_0x1a5d6a['thought'] || _0x1a5d6a['content']) + '”'; return _0x1a5d6a[_0xa0e2f5(0x62d)] === _0xa0e2f5(0x632) && (_0x516af6 += _0xa0e2f5(0x1e6) + _0x1a5d6a['songName'] + _0xa0e2f5(0x218) + _0x1a5d6a[_0xa0e2f5(0x53d)] + ')'), _0x516af6; }); return _0x39f8c1(0x66b) + _0x2d1be6[_0x39f8c1(0x6e6)]('\x0a'); } } else _0x110ce9['textContent'] = _0x79efc2[_0x39f8c1(0x4e6)], _0x5ba0d7[_0x39f8c1(0x96c)] = _0x39f8c1(0x3c5), _0x10cf47(_0x2f5ee7, 'normal'); } else { _0x53f51d(_0x39f8c1(0x3d4)); return; } } function _0x35b050() { const _0x2ba354 = _0x54ed15; if (_0x2ba354(0x731) !== _0x2ba354(0x731)) _0x1a7cb2[_0x2ba354(0x96c)] = _0x597215['name'], _0x23b0bb[_0x2ba354(0x96c)] = _0x2ba354(0x3c5), _0xcaf3a(_0x507ba7, 'normal'); else { const _0x99e89c = new Date(), _0x569201 = document[_0x2ba354(0x954)](_0x2ba354(0x469)), _0x1c799d = document[_0x2ba354(0x954)](_0x2ba354(0x55c)); if (_0x569201 && _0x1c799d) { const _0x1fa241 = String(_0x99e89c['getHours']())[_0x2ba354(0x990)](0x2, '0'), _0x3ac8bd = String(_0x99e89c['getMinutes']())[_0x2ba354(0x990)](0x2, '0'); _0x569201['textContent'] = _0x1fa241 + ':' + _0x3ac8bd; const _0xd98cfa = _0x99e89c[_0x2ba354(0x89d)]() + 0x1, _0xfca6a0 = _0x99e89c[_0x2ba354(0x74d)](), _0x5c898d = [_0x2ba354(0x1d2), '星期一', _0x2ba354(0x609), '星期三', _0x2ba354(0x809), '星期五', _0x2ba354(0x6c2)][_0x99e89c[_0x2ba354(0x795)]()]; _0x1c799d[_0x2ba354(0x96c)] = _0xd98cfa + '月' + _0xfca6a0 + '日\x20' + _0x5c898d; } } } const _0x28ad33 = document[_0x54ed15(0x954)](_0x54ed15(0x8be)), _0x36836e = document[_0x54ed15(0x954)](_0x54ed15(0x537)), _0x1ca191 = document[_0x54ed15(0x954)](_0x54ed15(0x257)), _0x4b095e = document[_0x54ed15(0x954)](_0x54ed15(0x207)), _0x52adbd = document[_0x54ed15(0x954)](_0x54ed15(0x26f)), _0x1d3c7c = document['getElementById'](_0x54ed15(0x46c)), _0x245b32 = document[_0x54ed15(0x954)](_0x54ed15(0x643)), _0x56e3e4 = document['getElementById'](_0x54ed15(0x7fa)), _0x9884f5 = document[_0x54ed15(0x954)](_0x54ed15(0x487)); let _0x2c3b31 = []; async function _0x475e6d() { const _0x34b6b6 = _0x54ed15; if (!_0x346f80[_0x34b6b6(0x509)]) return; _0x52adbd[_0x34b6b6(0x6a9)] = _0x34b6b6(0x76e), _0x28ad33[_0x34b6b6(0x78f)][_0x34b6b6(0x3d0)](_0x34b6b6(0x373)); const _0x290524 = await _0x3bfce3(); if (_0x290524[_0x34b6b6(0x6c3)] === 0x0) { _0x52adbd[_0x34b6b6(0x6a9)] = _0x34b6b6(0x1b7); return; } _0x52adbd[_0x34b6b6(0x6a9)] = '', _0x290524[_0x34b6b6(0x927)](_0x4f002c => { const _0x418bd7 = _0x34b6b6; if (_0x418bd7(0x24b) === _0x418bd7(0x2e6)) _0x3c6929[_0x418bd7(0x94f)][_0x418bd7(0x22d)] = _0x418bd7(0x4fd); else { const _0x29565a = document['createElement'](_0x418bd7(0x41a)); _0x29565a['className'] = 'music-library-item'; const _0x1e8930 = _0x4f002c[_0x418bd7(0x34e)] ? URL[_0x418bd7(0x8f3)](_0x4f002c[_0x418bd7(0x34e)]) : _0x2f6e79; _0x29565a['innerHTML'] = _0x418bd7(0x451) + _0x1e8930 + _0x418bd7(0x1fe) + (_0x4f002c[_0x418bd7(0x81a)][_0x418bd7(0x8e3)] || _0x418bd7(0x2e9)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>' + (_0x4f002c[_0x418bd7(0x81a)]['歌手'] || '未知艺术家') + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x29565a[_0x418bd7(0x35e)](_0x418bd7(0x39c), () => { _0x2d4ff5(_0x4f002c); }), _0x52adbd[_0x418bd7(0x204)](_0x29565a); } }); } function _0x1d71c1() { const _0xfa9be8 = _0x54ed15; _0x28ad33['classList'][_0xfa9be8(0x309)](_0xfa9be8(0x373)); } async function _0x2d4ff5(_0x466ecd) { const _0x4c4d66 = _0x54ed15; if (!_0x346f80[_0x4c4d66(0x509)] || !_0x466ecd) return; let _0x1580b5 = null; if (_0x466ecd[_0x4c4d66(0x34e)]) { if ('GglHi' !== _0x4c4d66(0x97b)) try { _0x1580b5 = _0x4c4d66(0x576) + Date['now']() + '_' + Math[_0x4c4d66(0x93a)](), await _0x336559(_0x1580b5, _0x466ecd['cover']); } catch (_0x204afc) { console['error'](_0x4c4d66(0x3f9), _0x204afc); } else _0x4401ab[_0x4c4d66(0x94f)][_0x4c4d66(0x5d2)] = _0x4c4d66(0x83a) + _0x478b04['createObjectURL'](_0x368c07) + ')', _0x22b34a[_0x4c4d66(0x94f)]['backgroundSize'] = _0x4c4d66(0x34e), _0x2c7cb5[_0x4c4d66(0x94f)][_0x4c4d66(0x3a9)] = _0x4c4d66(0x2b3); } const _0x34a05f = { 'role': _0x4c4d66(0x619), 'type': 'listen-together-invite', 'content': _0x4c4d66(0x6e3) + _0x466ecd['info'][_0x4c4d66(0x8e3)] + ']', 'songId': _0x466ecd['id'], 'songName': _0x466ecd['info'][_0x4c4d66(0x8e3)], 'artist': _0x466ecd[_0x4c4d66(0x81a)]['歌手'], 'coverId': _0x1580b5, 'timestamp': Date[_0x4c4d66(0x909)]() }; _0x346f80[_0x4c4d66(0x250)][_0x4c4d66(0x580)](_0x34a05f), _0x5d853f(), _0x1e1fc7(), _0x1d71c1(), setTimeout(_0x2a6a82, 0x64); } _0x36836e['addEventListener'](_0x54ed15(0x39c), _0x475e6d), _0x1ca191['addEventListener'](_0x54ed15(0x39c), _0x1d71c1), _0x4b095e[_0x54ed15(0x35e)](_0x54ed15(0x39c), _0x1d71c1); async function _0x520861(_0x21207f, _0x367c9e, _0x34cf8) { const _0x54f1af = _0x54ed15, _0x5860d7 = _0x346f80['chats'][_0x54f1af(0x247)](_0x593579 => _0x593579[_0x54f1af(0x7b1)] && _0x593579[_0x54f1af(0x7b1)][_0x54f1af(0x1e7)]), _0x49c0b4 = _0x597f5f(); if (_0x5860d7 && _0x5860d7['id'] !== _0x49c0b4['id']) _0x5860d7[_0x54f1af(0x7b1)] = null, _0x3383df(_0x54f1af(0x489)), _0x23c6b9(); else { if (_0x5860d7 && _0x5860d7['id'] === _0x49c0b4['id']) { if (_0x54f1af(0x6ea) !== 'Qtyfn') _0x3383df(_0x54f1af(0x6bb)); else { if (!_0xd1d367 || !_0x5d6f59['includes'](',')) return _0x49f822; const _0x2f08cf = _0x594306['split'](',')[_0x54f1af(0x2a0)](_0x32aa20 => _0x32aa20[_0x54f1af(0x4dd)]()); return _0x2f08cf[_0x456efe[_0x54f1af(0x353)](_0x103e25[_0x54f1af(0x93a)]() * _0x2f08cf[_0x54f1af(0x6c3)])]; } } } _0x6cd89d(!![], _0x54f1af(0x79a)); if (!_0x49c0b4) { _0x6cd89d(![]), _0x3383df(_0x54f1af(0x8f6)); return; } const _0x47ab79 = await _0x89d016(_0x21207f); if (!_0x47ab79) { _0x6cd89d(![]), _0x3383df(_0x54f1af(0x70b)); return; } _0x49c0b4[_0x54f1af(0x7b1)] = { 'isActive': !![], 'songId': _0x21207f, 'leaderId': _0x54f1af(0x619), 'songName': _0x47ab79[_0x54f1af(0x81a)][_0x54f1af(0x8e3)], 'artist': _0x47ab79[_0x54f1af(0x81a)]['歌手'], 'cover': _0x47ab79[_0x54f1af(0x34e)] }, _0x23c6b9(), document['getElementById'](_0x54f1af(0x58d))[_0x54f1af(0x7d9)] = _0x47ab79[_0x54f1af(0x34e)] ? URL['createObjectURL'](_0x47ab79[_0x54f1af(0x34e)]) : _0x2f6e79, document['getElementById'](_0x54f1af(0x445))[_0x54f1af(0x96c)] = _0x47ab79[_0x54f1af(0x81a)][_0x54f1af(0x8e3)], document[_0x54f1af(0x954)](_0x54f1af(0x3a4))[_0x54f1af(0x96c)] = _0x47ab79['info']['歌手'], _0x4e2858(_0x47ab79), _0x245b32[_0x54f1af(0x94f)][_0x54f1af(0x3b4)] = _0x54f1af(0x798), setTimeout(() => _0x245b32[_0x54f1af(0x78f)][_0x54f1af(0x3d0)]('show'), 0xa), _0x34cf8[_0x54f1af(0x6a9)] = _0x54f1af(0x315) + _0x34cf8[_0x54f1af(0x7c6)](_0x54f1af(0x821))[_0x54f1af(0x833)], _0x346f80[_0x54f1af(0x250)][_0x367c9e] && (_0x346f80['conversationHistory'][_0x367c9e][_0x54f1af(0x901)] = !![], _0x5d853f()), _0x6cd89d(![]), _0x5ed415(_0x21207f, [_0x21207f]), _0x5d8cd8(_0x47ab79, !![]); } function _0x2073aa() { const _0x1c62af = _0x54ed15, _0x170de7 = _0x346f80[_0x1c62af(0x3aa)][_0x1c62af(0x247)](_0x3b9dc4 => _0x3b9dc4[_0x1c62af(0x7b1)] && _0x3b9dc4[_0x1c62af(0x7b1)][_0x1c62af(0x1e7)]); _0x170de7 && (_0x1c62af(0x7cf) === 'gbwAE' ? (_0x49f89f(), _0x43557b[_0x1c62af(0x98d)] = 0x64) : (_0x170de7[_0x1c62af(0x7b1)] = null, _0x23c6b9(), _0x3383df('同步已断开。'), _0x5d8cd8(), _0x245b32[_0x1c62af(0x78f)]['remove'](_0x1c62af(0x373)), setTimeout(() => _0x245b32[_0x1c62af(0x94f)][_0x1c62af(0x3b4)] = _0x1c62af(0x910), 0x12c))); } function _0x5a85f5(_0x39d36b) { const _0x299a48 = _0x54ed15; if (!_0x39d36b) return []; const _0x526470 = _0x39d36b[_0x299a48(0x1a7)]('\x0a'), _0x12abbe = [], _0x3d9c89 = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x26d03a of _0x526470) { const _0x1d0571 = _0x26d03a[_0x299a48(0x2bc)](_0x3d9c89); if (_0x1d0571) { const _0x726453 = parseInt(_0x1d0571[0x1], 0xa), _0x3a1f6d = parseInt(_0x1d0571[0x2], 0xa), _0x1288fe = parseInt(_0x1d0571[0x3], 0xa) * (_0x1d0571[0x3][_0x299a48(0x6c3)] === 0x2 ? 0xa : 0x1), _0x5c3dd3 = _0x726453 * 0x3c + _0x3a1f6d + _0x1288fe / 0x3e8, _0x38bda9 = _0x26d03a[_0x299a48(0x330)](_0x3d9c89, '')[_0x299a48(0x4dd)](); _0x38bda9 && _0x12abbe[_0x299a48(0x580)]({ 'time': _0x5c3dd3, 'text': _0x38bda9 }); } } return _0x12abbe; } function _0x4e2858(_0x33d45b) { const _0x51f84e = _0x54ed15; if ('jcWcF' !== _0x51f84e(0x73f)) _0x19d9d2[_0x51f84e(0x7d9)] = _0x87a993[_0x51f84e(0x8f3)](_0xce303d); else { _0x2c3b31 = _0x5a85f5(_0x33d45b[_0x51f84e(0x74f)]), _0x9884f5[_0x51f84e(0x6a9)] = ''; if (_0x2c3b31[_0x51f84e(0x6c3)] === 0x0) { if (_0x51f84e(0x904) !== _0x51f84e(0x3d1)) { _0x9884f5[_0x51f84e(0x6a9)] = _0x51f84e(0x55d); return; } else { const _0x476ef1 = _0x2928fb[_0x51f84e(0x820)]('div'); _0x476ef1[_0x51f84e(0x941)] = _0x51f84e(0x723), _0x476ef1[_0x51f84e(0x86c)]['id'] = _0x48e94b['id']; const _0x2ba026 = _0x29da84['id'] === _0x10f31c[_0x51f84e(0x7da)] ? _0x51f84e(0x485) : ''; _0x476ef1[_0x51f84e(0x6a9)] = _0x51f84e(0x173) + (_0xdb8b1f[_0x51f84e(0x4ef)] || _0x433610) + '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20' + _0x418290[_0x51f84e(0x4e6)] + _0x2ba026 + _0x51f84e(0x95a) + _0x2f683c[_0x51f84e(0x1a5)]['substring'](0x0, 0x64) + _0x51f84e(0x6f5), _0x476ef1[_0x51f84e(0x35e)](_0x51f84e(0x39c), () => _0x231ed4(_0x4784e2['id'])), _0x468fbb['appendChild'](_0x476ef1); } } _0x2c3b31['forEach']((_0x3baaff, _0x1a3e08) => { const _0x3db290 = _0x51f84e, _0x4a4266 = document[_0x3db290(0x820)]('p'); _0x4a4266[_0x3db290(0x96c)] = _0x3baaff[_0x3db290(0x39f)], _0x4a4266['id'] = _0x3db290(0x8ac) + _0x1a3e08, _0x9884f5['appendChild'](_0x4a4266); }); } } function _0x476977(_0x23764a, _0xc05370, _0x11955a, _0x2bc494) { const _0x14d2d0 = _0x54ed15, _0x416093 = (_0x2bc494 - 0x5a) * Math['PI'] / 0xb4; return { 'x': _0x23764a + _0x11955a * Math[_0x14d2d0(0x902)](_0x416093), 'y': _0xc05370 + _0x11955a * Math[_0x14d2d0(0x2e8)](_0x416093) }; } function _0x3dd50d(_0x21d66d) { const _0x5858ce = _0x54ed15, _0x1280d0 = _0x5858ce(0x5cc), _0x26dc30 = document[_0x5858ce(0x591)](_0x1280d0, 'svg'), _0x15e736 = 0xfa, _0x6ea786 = _0x15e736 / 0x2, _0x3a96bc = _0x15e736 / 0x2, _0x12cf04 = _0x15e736 / 0x2 - 0x14; _0x26dc30[_0x5858ce(0x418)](_0x5858ce(0x99d), _0x5858ce(0x7e4)), _0x26dc30['setAttribute'](_0x5858ce(0x2d9), _0x5858ce(0x7e4)), _0x26dc30[_0x5858ce(0x418)](_0x5858ce(0x91c), _0x5858ce(0x423) + _0x15e736 + '\x20' + _0x15e736); const _0x1134a1 = Object['values'](_0x21d66d)[_0x5858ce(0x8d3)]((_0x13f1f1, _0x4f1983) => _0x13f1f1 + _0x4f1983, 0x0); if (_0x1134a1 === 0x0) return _0x26dc30; let _0x41808a = -0x5a; const _0x14ac35 = ['#66b3ff', '#ffcc66', _0x5858ce(0x24f), _0x5858ce(0x62b), _0x5858ce(0x66f), _0x5858ce(0x56e), _0x5858ce(0x7ee), _0x5858ce(0x39b)]; let _0x15b07e = 0x0; for (const _0xcfb75d in _0x21d66d) { if (_0x5858ce(0x59c) !== _0x5858ce(0x741)) { const _0x4ad6f1 = _0x21d66d[_0xcfb75d]; if (_0x4ad6f1 <= 0x0) continue; const _0x408dc7 = _0x4ad6f1 / _0x1134a1 * 0x168, _0x158ae4 = _0x41808a + _0x408dc7, _0x3539a4 = _0x476977(_0x6ea786, _0x3a96bc, _0x12cf04, _0x158ae4), _0x1174f3 = _0x476977(_0x6ea786, _0x3a96bc, _0x12cf04, _0x41808a), _0x4bebc8 = _0x408dc7 > 0xb4 ? '1' : '0', _0x3b3efe = ['M', _0x3539a4['x'], _0x3539a4['y'], 'A', _0x12cf04, _0x12cf04, 0x0, _0x4bebc8, 0x1, _0x1174f3['x'], _0x1174f3['y'], 'L', _0x6ea786, _0x3a96bc, 'Z'][_0x5858ce(0x6e6)]('\x20'), _0x54bbe1 = document[_0x5858ce(0x591)](_0x1280d0, _0x5858ce(0x728)); _0x54bbe1[_0x5858ce(0x418)]('d', _0x3b3efe), _0x54bbe1[_0x5858ce(0x418)]('fill', _0x14ac35[_0x15b07e % _0x14ac35[_0x5858ce(0x6c3)]]), _0x15b07e++; const _0x164cd7 = document['createElementNS'](_0x1280d0, _0x5858ce(0x6bf)); _0x164cd7[_0x5858ce(0x96c)] = _0xcfb75d + ':\x20' + _0x4ad6f1[_0x5858ce(0x557)](0x2) + '\x20(' + (_0x4ad6f1 / _0x1134a1 * 0x64)[_0x5858ce(0x557)](0x1) + '%)', _0x54bbe1[_0x5858ce(0x204)](_0x164cd7), _0x26dc30[_0x5858ce(0x204)](_0x54bbe1), _0x41808a = _0x158ae4; } else _0x3cd637[_0x5858ce(0x7da)] = _0x1a9d9b[_0x5858ce(0x2f5)][0x0]['id']; } return _0x26dc30; } function _0x21585a() { const _0x3558a6 = _0x54ed15; if (_0x2c3b31[_0x3558a6(0x6c3)] === 0x0) return; const _0x16cbef = _0x1d3c7c[_0x3558a6(0x378)]; let _0x202bee = -0x1; for (let _0x1e9e0f = 0x0; _0x1e9e0f < _0x2c3b31[_0x3558a6(0x6c3)]; _0x1e9e0f++) { if (_0x16cbef >= _0x2c3b31[_0x1e9e0f][_0x3558a6(0x39a)]) _0x202bee = _0x1e9e0f; else break; } if (_0x202bee !== -0x1) { const _0xb92ac8 = _0x9884f5['querySelectorAll']('p'); _0xb92ac8[_0x3558a6(0x927)](_0x14d0f7 => _0x14d0f7[_0x3558a6(0x78f)][_0x3558a6(0x309)]('active')); const _0x5d9edb = document['getElementById'](_0x3558a6(0x8ac) + _0x202bee); _0x5d9edb && (_0x3558a6(0x44a) !== _0x3558a6(0x456) ? (_0x5d9edb['classList']['add'](_0x3558a6(0x282)), _0x5d9edb[_0x3558a6(0x61e)]({ 'behavior': 'smooth', 'block': 'center' })) : _0x36d4c5[_0x3558a6(0x4e6)] !== _0x3558a6(0x8ee) && (_0x532fc0['error'](_0x3558a6(0x424), _0x2e2b02), _0x4feeb3({ 'role': _0x3558a6(0x81d), 'content': _0x3558a6(0x914) + _0x527a19[_0x3558a6(0x399)] }, _0xd8ac1d['conversationHistory'][_0x3558a6(0x6c3)] - 0x1))); } } _0x56e3e4[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x1d0e45 = _0x54ed15; _0x245b32[_0x1d0e45(0x78f)][_0x1d0e45(0x309)](_0x1d0e45(0x373)), setTimeout(() => _0x245b32[_0x1d0e45(0x94f)]['display'] = _0x1d0e45(0x910), 0x12c); }), document[_0x54ed15(0x954)]('music-widget-card')[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x42f0f0 = _0x54ed15; _0x346f80[_0x42f0f0(0x5ca)] && _0x346f80[_0x42f0f0(0x5ca)][_0x42f0f0(0x1e7)] && (_0x245b32[_0x42f0f0(0x94f)][_0x42f0f0(0x3b4)] = _0x42f0f0(0x798), setTimeout(() => _0x245b32[_0x42f0f0(0x78f)][_0x42f0f0(0x3d0)](_0x42f0f0(0x373)), 0xa)); }), _0x1d3c7c['addEventListener'](_0x54ed15(0x715), _0x21585a); const _0x10c657 = document[_0x54ed15(0x954)](_0x54ed15(0x1d0)), _0x38acfe = document[_0x54ed15(0x954)]('widget-next-btn'), _0xe6037d = document[_0x54ed15(0x954)](_0x54ed15(0x7dd)); _0x10c657['addEventListener']('click', () => { const _0x27c5a2 = _0x54ed15; if (_0x1d3c7c[_0x27c5a2(0x7d9)]) { if (_0x27c5a2(0x212) !== _0x27c5a2(0x212)) { const _0x40c5a1 = _0x3647e0(_0x2b3e42[_0x27c5a2(0x2fc)] ?? _0x1458ac['text'] ?? _0x427aad[_0x27c5a2(0x399)] ?? '')[_0x27c5a2(0x4dd)](); if (_0x40c5a1) _0xbef6d['events'][_0x27c5a2(0x580)]({ 'senderId': _0x4589eb['id'], 'kind': _0x27c5a2(0x39f), 'content': _0x40c5a1 }); } else _0x1d3c7c[_0x27c5a2(0x214)] ? _0x27c5a2(0x410) !== 'COmgN' ? _0x46c9d0 = _0x284317[_0x27c5a2(0x164)](_0x27c5a2(0x649) + _0xb45d84[_0x27c5a2(0x509)]) : _0x1d3c7c[_0x27c5a2(0x4b3)]() : _0x1d3c7c[_0x27c5a2(0x730)](); } }), _0x38acfe['addEventListener'](_0x54ed15(0x39c), () => { const _0x5b740b = _0x54ed15; if (_0x20672b[_0x5b740b(0x6c3)] === 0x0) return; _0x5ef0e3 = (_0x5ef0e3 + 0x1) % _0x20672b[_0x5b740b(0x6c3)], _0x5ed415(_0x20672b[_0x5ef0e3], _0x20672b); }), _0xe6037d[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x5dca6e = _0x54ed15; if (_0x5dca6e(0x52b) !== _0x5dca6e(0x52b)) { const _0xb2140a = _0x57b1ff[_0x649e67]; _0x147cc0(_0xb2140a); } else { if (_0x20672b[_0x5dca6e(0x6c3)] === 0x0) return; _0x5ef0e3 = (_0x5ef0e3 - 0x1 + _0x20672b[_0x5dca6e(0x6c3)]) % _0x20672b[_0x5dca6e(0x6c3)], _0x5ed415(_0x20672b[_0x5ef0e3], _0x20672b); } }), _0x1d3c7c[_0x54ed15(0x35e)]('play', () => { const _0x5eb73b = _0x54ed15; _0x10c657[_0x5eb73b(0x96c)] = '❚❚'; }), _0x1d3c7c['addEventListener'](_0x54ed15(0x730), () => { const _0x5439cd = _0x54ed15; _0x10c657[_0x5439cd(0x96c)] = '▶'; }), _0x1d3c7c['addEventListener']('ended', () => { const _0x1df36a = _0x54ed15; _0x38acfe[_0x1df36a(0x39c)](); }), _0x1d3c7c[_0x54ed15(0x35e)]('play', () => { const _0x362818 = _0x54ed15; if ('bXLQK' === 'hnKxx') _0x5d3cd2[_0x362818(0x845)](_0x362818(0x649) + _0x59ea3f['id']); else { const _0x18b31d = document[_0x362818(0x954)]('global-player-play-pause-btn'); if (_0x18b31d) _0x18b31d[_0x362818(0x96c)] = '❚❚'; } }), _0x1d3c7c[_0x54ed15(0x35e)](_0x54ed15(0x730), () => { const _0x35b257 = _0x54ed15, _0xd90d1 = document['getElementById'](_0x35b257(0x50b)); if (_0xd90d1) _0xd90d1[_0x35b257(0x96c)] = '▶'; }), _0x1d3c7c[_0x54ed15(0x35e)]('ended', () => { const _0x7fb41e = _0x54ed15, _0x347117 = document['getElementById'](_0x7fb41e(0x9e1)); if (_0x347117) { if (_0x7fb41e(0x5f3) !== 'DrGOy') _0x347117[_0x7fb41e(0x39c)](); else { const _0x38f045 = _0x3ec087[_0x7fb41e(0x94a)][_0x7fb41e(0x6e8)](_0x429de9 => _0x429de9[_0x7fb41e(0x62d)] === _0x7fb41e(0x632) && _0x429de9[_0x7fb41e(0x32c)])[_0x7fb41e(0x2a0)](_0x3daac3 => ({ ..._0x3daac3, 'source': _0x7fb41e(0x8b4) })); _0x3512ca[_0x7fb41e(0x580)](..._0x38f045); } } }), document[_0x54ed15(0x954)](_0x54ed15(0x872))[_0x54ed15(0x35e)]('click', () => { const _0x2ece87 = _0x54ed15; _0x4e3432(), _0x21dca3('accounting', _0x2ece87(0x72b)); }), document[_0x54ed15(0x954)]('back-to-home-from-accounting')['addEventListener']('click', () => _0x21dca3('home', _0x54ed15(0x479))); const _0x596525 = document[_0x54ed15(0x954)](_0x54ed15(0x7f5)), _0x2e7bd3 = document[_0x54ed15(0x954)](_0x54ed15(0x771)); _0x596525['addEventListener'](_0x54ed15(0x39c), _0x4e3432), _0x2e7bd3[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0xa2674b = _0x54ed15; _0x596525['classList'][_0xa2674b(0x309)]('active'), _0x2e7bd3[_0xa2674b(0x78f)][_0xa2674b(0x3d0)](_0xa2674b(0x282)), _0x11c795(); }); function _0x4e3432() { const _0x51ead5 = _0x54ed15; _0x2e7bd3['classList'][_0x51ead5(0x309)]('active'), _0x596525[_0x51ead5(0x78f)][_0x51ead5(0x3d0)](_0x51ead5(0x282)), _0x938733(); } function _0x938733() { const _0x3fe7af = _0x54ed15, _0x4b613d = document[_0x3fe7af(0x954)](_0x3fe7af(0x267)); document[_0x3fe7af(0x954)]('accounting-title')[_0x3fe7af(0x96c)] = _0x3fe7af(0x1ed), document[_0x3fe7af(0x954)]('header-actions')[_0x3fe7af(0x6a9)] = '', _0x4b613d[_0x3fe7af(0x6a9)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22accounting-input-area\x22\x20style=\x22margin-bottom:\x2020px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22input-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22expense-description\x22>花在哪了？</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22text\x22\x20id=\x22expense-description\x22\x20placeholder=\x22例如：一杯奶茶\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22input-group\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22expense-amount\x22>花了多少？</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22number\x22\x20id=\x22expense-amount\x22\x20placeholder=\x22例如：15\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22add-expense-button\x22\x20class=\x22form-button\x20primary\x22\x20style=\x22margin-top:\x2015px;\x22>记下了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-bottom:\x2010px;\x22>今日流水</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22daily-expenses-list\x22\x20style=\x22max-height:\x20300px;\x20overflow-y:\x20auto;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22organize-button-container\x22\x20style=\x22margin-top:\x2020px;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x226989(), document[_0x3fe7af(0x954)](_0x3fe7af(0x6d4))['addEventListener'](_0x3fe7af(0x39c), _0x2d588a), document[_0x3fe7af(0x954)]('expense-description')['focus'](); } function _0x354b06(_0x30562c, _0x438a32) { const _0x14ab8b = _0x54ed15; if (_0x14ab8b(0x522) !== 'uGakH') { const { playlist: _0x1fcb38, currentIndex: _0x1c201f } = _0x4e8c0b[_0x14ab8b(0x781)](_0x26c041); _0x52fa29[_0x14ab8b(0x86b)](_0x1fcb38) && _0x1fcb38[_0x14ab8b(0x6c3)] > 0x0 && _0x1c201f > -0x1 && (_0x51f9c9['musicPlaylist'] = _0x1fcb38, _0x3a70d7[_0x14ab8b(0x2bb)] = _0x1c201f, _0x3f7298[_0x14ab8b(0x239)] = ![], _0x129947()); } else { const _0x1d03b7 = document[_0x14ab8b(0x954)](_0x14ab8b(0x267)), _0x1d97bc = document[_0x14ab8b(0x954)](_0x14ab8b(0x673)); document[_0x14ab8b(0x954)]('accounting-title')[_0x14ab8b(0x96c)] = _0x438a32 + _0x14ab8b(0x5e4); const _0x4c7142 = _0x30562c[_0x14ab8b(0x532)][_0x14ab8b(0x8d3)]((_0x2f0910, _0x1bf90d) => _0x2f0910 + (_0x1bf90d[_0x14ab8b(0x1b3)] || 0x0), 0x0); let _0xcac89b = _0x14ab8b(0x976) + _0x4c7142[_0x14ab8b(0x557)](0x2) + _0x14ab8b(0x719); _0x1d03b7[_0x14ab8b(0x6a9)] = _0xcac89b; const _0x2de78b = document[_0x14ab8b(0x954)]('categorized-expenses-list'), _0x18f76b = { '餐饮美食': '<path\x20d=\x22M3\x2011h18v10a2\x202\x200\x200\x201-2\x202h-14a2\x202\x200\x200\x201-2-2v-10z\x22></path><path\x20d=\x22M6\x2011v-7a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v7\x22></path><path\x20d=\x22M9\x204v3\x22></path>', '交通出行': _0x14ab8b(0x19b), '购物消费': '<path\x20d=\x22M6\x202L3\x206v14a2\x202\x200\x200\x200\x202\x202h14a2\x202\x200\x200\x200\x202-2V6l-3-4z\x22></path><line\x20x1=\x223\x22\x20y1=\x226\x22\x20x2=\x2221\x22\x20y2=\x226\x22></line><path\x20d=\x22M16\x2010a4\x204\x200\x200\x201-8\x200\x22></path>', '生活服务': _0x14ab8b(0x669), '休闲娱乐': _0x14ab8b(0x185), '医疗健康': '<path\x20d=\x22M12\x202v20\x22></path><path\x20d=\x22M4\x2012h16\x22></path>', '人情红包': _0x14ab8b(0x2f7), '其他杂项': '<path\x20d=\x22M14.5\x202H6a2\x202\x200\x200\x200-2\x202v16a2\x202\x200\x200\x200\x202\x202h12a2\x202\x200\x200\x200\x202-2V7.5L14.5\x202z\x22></path><polyline\x20points=\x2214\x202\x2014\x208\x2020\x208\x22></polyline>', '默认': _0x14ab8b(0x608) }; _0x30562c['categorizedExpenses'][_0x14ab8b(0x927)](_0x2e92f7 => { const _0x3cdf2 = _0x14ab8b, _0x473edf = document[_0x3cdf2(0x820)](_0x3cdf2(0x41a)); _0x473edf[_0x3cdf2(0x941)] = _0x3cdf2(0x4ec), _0x473edf[_0x3cdf2(0x94f)][_0x3cdf2(0x712)] = _0x3cdf2(0x338), _0x473edf[_0x3cdf2(0x94f)][_0x3cdf2(0x3b8)] = _0x3cdf2(0x984), _0x473edf[_0x3cdf2(0x94f)]['padding'] = _0x3cdf2(0x89c), _0x473edf[_0x3cdf2(0x94f)][_0x3cdf2(0x36b)] = '0'; const _0x448a4f = _0x18f76b[_0x2e92f7[_0x3cdf2(0x516)]] || _0x18f76b['默认'], _0x88e745 = '<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22>' + _0x448a4f + _0x3cdf2(0x420), _0x35ab58 = _0x3cdf2(0x372) + _0x88e745 + _0x3cdf2(0x707) + _0x2e92f7[_0x3cdf2(0x3ae)] + _0x3cdf2(0x751) + (_0x2e92f7[_0x3cdf2(0x516)] || _0x3cdf2(0x7b2)) + _0x3cdf2(0x818) + (_0x2e92f7[_0x3cdf2(0x1b3)] || 0x0)[_0x3cdf2(0x557)](0x2) + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>'; let _0x53f126 = ''; if (_0x2e92f7['review'] && _0x2e92f7['review'][_0x3cdf2(0x918)]) { if (_0x3cdf2(0x3f8) === 'fPvfg') { const _0x5e9f13 = _0x5122c0(_0x2e92f7[_0x3cdf2(0x213)][_0x3cdf2(0x918)]); _0x5e9f13 && ('oHqXP' !== 'oHqXP' ? _0x4683b3[_0x3cdf2(0x580)]('[' + _0x1952f9(_0x39751f) + ']\x20' + _0x268885[_0x3cdf2(0x2fc)]) : _0x53f126 = _0x3cdf2(0x974) + _0x5e9f13['avatar'] + _0x3cdf2(0x48f) + _0x5e9f13[_0x3cdf2(0x4e6)] + _0x3cdf2(0x8dc) + _0x2e92f7[_0x3cdf2(0x213)][_0x3cdf2(0x39f)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20'); } else { _0x3501cf[_0x3cdf2(0x6a9)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', _0x4b6d67['innerHTML'] = _0x3cdf2(0x383), _0x2caa65[_0x3cdf2(0x954)](_0x3cdf2(0x989))['addEventListener'](_0x3cdf2(0x39c), _0x5ad640), _0x381956[_0x3cdf2(0x954)](_0x3cdf2(0x41b))[_0x3cdf2(0x35e)](_0x3cdf2(0x39c), _0xe2b3bd); return; } } _0x473edf[_0x3cdf2(0x6a9)] = _0x35ab58 + _0x53f126, _0x2de78b[_0x3cdf2(0x204)](_0x473edf); }), _0x1d97bc[_0x14ab8b(0x6a9)] = _0x14ab8b(0x827), document[_0x14ab8b(0x954)](_0x14ab8b(0x5b3))[_0x14ab8b(0x35e)](_0x14ab8b(0x39c), async () => { const _0x4e2658 = _0x14ab8b; if (_0x4e2658(0x3d8) !== _0x4e2658(0x3d8)) _0x4e7625[_0x4e2658(0x64e)](_0x4e2658(0x4d5), { 'keyPath': 'id' }); else { const _0x30d412 = await _0x57c3ed(_0x4e2658(0x4c9)); _0x30d412 && (_0x4e2658(0x47b) !== 'lnztu' ? (_0xa84907['error']('导入角色卡失败:', _0xd6d051), _0x553945('导入失败了，笨蛋:\x20' + _0x44f97e[_0x4e2658(0x399)])) : (delete _0x346f80[_0x4e2658(0x4aa)][_0x438a32], _0x23c6b9(), _0x938733())); } }); } } function _0x11c795() { const _0x55f06c = _0x54ed15; if ('WDlcI' === _0x55f06c(0x5d4)) { const _0x1678d7 = document[_0x55f06c(0x954)]('accounting-content-area'); document[_0x55f06c(0x954)](_0x55f06c(0x987))['textContent'] = '账本', document[_0x55f06c(0x954)](_0x55f06c(0x673))[_0x55f06c(0x6a9)] = ''; const _0x34ef3b = Object[_0x55f06c(0x91f)](_0x346f80[_0x55f06c(0x4aa)])['sort']((_0x3b89d4, _0x53dafa) => new Date(_0x53dafa) - new Date(_0x3b89d4)); if (_0x34ef3b['length'] === 0x0) { _0x1678d7[_0x55f06c(0x6a9)] = _0x55f06c(0x77c); return; } _0x1678d7[_0x55f06c(0x6a9)] = '', _0x34ef3b[_0x55f06c(0x927)](_0x301193 => { const _0x1ad6c8 = _0x55f06c; if ('lZOqg' === 'lZOqg') { const _0x1ec56a = document[_0x1ad6c8(0x820)](_0x1ad6c8(0x41a)); _0x1ec56a[_0x1ad6c8(0x941)] = _0x1ad6c8(0x4ec), _0x1ec56a['style'][_0x1ad6c8(0x997)] = 'pointer'; const _0x2ebfd4 = _0x346f80['accountingLedger'][_0x301193], _0x37227a = _0x2ebfd4[_0x1ad6c8(0x532)]['reduce']((_0x582f94, _0x2d810b) => _0x582f94 + (_0x2d810b[_0x1ad6c8(0x1b3)] || 0x0), 0x0); _0x1ec56a[_0x1ad6c8(0x6a9)] = _0x1ad6c8(0x4f2) + _0x301193 + _0x1ad6c8(0x87a) + _0x37227a['toFixed'](0x2) + _0x1ad6c8(0x27a), _0x1ec56a[_0x1ad6c8(0x35e)](_0x1ad6c8(0x39c), () => { const _0x30eb29 = _0x1ad6c8; _0x596525[_0x30eb29(0x78f)][_0x30eb29(0x309)]('active'), _0x2e7bd3[_0x30eb29(0x78f)][_0x30eb29(0x3d0)](_0x30eb29(0x282)), _0x354b06(_0x2ebfd4, _0x301193); }), _0x1678d7[_0x1ad6c8(0x204)](_0x1ec56a); } else { const _0x1b471d = _0x12a2b5['target']['files'][0x0]; if (!_0x1b471d) return; const _0x35e0c1 = _0x15217e['createObjectURL'](_0x1b471d); _0x55102f[_0x1ad6c8(0x7d9)] = _0x35e0c1, _0x27fbf1['onload'] = () => { _0x30a7e3['revokeObjectURL'](_0x35e0c1); }; } }); } else { const _0x49f5bc = _0x4aa1db[_0x55f06c(0x4a8)][_0x55f06c(0x247)](_0x206153 => _0x206153['id'] === _0x39fa63[_0x55f06c(0x903)]), _0x16107d = _0x3b1b7c(); let _0xaeda14 = []; if (_0x49f5bc && _0x49f5bc['posts']) { const _0x3b10c3 = _0x49f5bc[_0x55f06c(0x94a)][_0x55f06c(0x6e8)](_0x229949 => _0x229949[_0x55f06c(0x62d)] === _0x55f06c(0x632) && _0x229949['playableUrl'])[_0x55f06c(0x2a0)](_0x42ad98 => ({ ..._0x42ad98, 'source': _0x55f06c(0x8b4) })); _0xaeda14[_0x55f06c(0x580)](..._0x3b10c3); } if (_0x16107d && _0x3edc9c[_0x55f06c(0x250)]) { const _0x1c0b9e = _0x33e0c0['conversationHistory'][_0x55f06c(0x6e8)](_0x4383dd => _0x4383dd[_0x55f06c(0x62d)] === 'music' && _0x4383dd['playableUrl'])[_0x55f06c(0x2a0)](_0x474f13 => ({ ..._0x474f13, 'source': _0x55f06c(0x755) })); _0xaeda14[_0x55f06c(0x580)](..._0x1c0b9e); } const _0x4adf98 = _0x3f8e4a['from'](new _0x18e16f(_0xaeda14['map'](_0xd8af96 => [_0xd8af96[_0x55f06c(0x32c)], _0xd8af96]))[_0x55f06c(0x1fc)]()); _0x6be1ab[_0x55f06c(0x4a7)] = _0x4adf98[_0x55f06c(0x254)]((_0x25d4b0, _0xd83477) => _0xd83477[_0x55f06c(0x83c)] - _0x25d4b0[_0x55f06c(0x83c)]); } } function _0x2d588a() { const _0x1b9157 = _0x54ed15, _0xcf2712 = document[_0x1b9157(0x954)](_0x1b9157(0x7ad)), _0x39ed60 = document['getElementById'](_0x1b9157(0x1df)), _0x1660ed = _0xcf2712[_0x1b9157(0x908)][_0x1b9157(0x4dd)](), _0x3e7f5f = parseFloat(_0x39ed60[_0x1b9157(0x908)]); if (!_0x1660ed || isNaN(_0x3e7f5f) || _0x3e7f5f <= 0x0) { _0x3383df(_0x1b9157(0x4cc)); return; } _0x346f80[_0x1b9157(0x28a)][_0x1b9157(0x580)]({ 'id': 'exp_' + Date['now'](), 'description': _0x1660ed, 'amount': _0x3e7f5f, 'timestamp': Date[_0x1b9157(0x909)]() }), _0x23c6b9(), _0x226989(), _0xcf2712[_0x1b9157(0x908)] = '', _0x39ed60[_0x1b9157(0x908)] = '', _0xcf2712[_0x1b9157(0x60d)](); } function _0x226989() { const _0x5b21aa = _0x54ed15, _0x1a710a = document['getElementById'](_0x5b21aa(0x9d9)), _0x5f17f8 = document[_0x5b21aa(0x954)](_0x5b21aa(0x37e)), _0x54a65c = new Date(), _0x2411b2 = _0x346f80['accountingData'][_0x5b21aa(0x6e8)](_0x231a41 => new Date(_0x231a41[_0x5b21aa(0x83c)])['toDateString']() === _0x54a65c[_0x5b21aa(0x7e3)]()); if (_0x2411b2[_0x5b21aa(0x6c3)] === 0x0) { if (_0x5b21aa(0x6b2) !== 'DHRhA') { _0x1a710a[_0x5b21aa(0x6a9)] = _0x5b21aa(0x3b6), _0x5f17f8[_0x5b21aa(0x6a9)] = ''; return; } else _0x8171e5[_0x5b21aa(0x85e)] = _0x155364, _0x3f4afc = !![]; } _0x1a710a[_0x5b21aa(0x6a9)] = '', _0x2411b2[_0x5b21aa(0x254)]((_0x529290, _0x1dedce) => _0x1dedce[_0x5b21aa(0x83c)] - _0x529290['timestamp'])[_0x5b21aa(0x927)](_0x2597fa => { const _0x47041f = _0x5b21aa; if ('knyqT' === _0x47041f(0x1f9)) { const _0x31f37e = document[_0x47041f(0x820)]('div'); _0x31f37e[_0x47041f(0x941)] = _0x47041f(0x4ec), _0x31f37e[_0x47041f(0x6a9)] = _0x47041f(0x4f2) + _0x2597fa[_0x47041f(0x3ae)] + _0x47041f(0x967) + _0x2597fa['amount'][_0x47041f(0x557)](0x2) + _0x47041f(0x27a), _0x1a710a[_0x47041f(0x204)](_0x31f37e); } else _0x20eab0(_0x6a55d6 + 0x1); }), _0x5f17f8 && (_0x5f17f8['innerHTML'] = _0x5b21aa(0x63c), document[_0x5b21aa(0x954)]('organize-bill-button')[_0x5b21aa(0x35e)](_0x5b21aa(0x39c), _0x34cb3a)); } function _0x400dd3(_0x3e9e93, _0xcdf881) { const _0x4ccb9c = _0x54ed15; if (_0x4ccb9c(0x376) !== _0x4ccb9c(0x376)) { const _0x121579 = _0x101b1f['transaction'](_0x11e678, _0x4ccb9c(0x1e2)), _0xbf8b2c = _0x121579[_0x4ccb9c(0x8e1)](_0x30783b), _0x2d4af2 = _0xbf8b2c[_0x4ccb9c(0x1b2)]({ 'id': _0x5ebded, 'blob': _0x278692 }); _0x2d4af2[_0x4ccb9c(0x8fb)] = () => _0x481153(_0x2d4af2[_0x4ccb9c(0x37b)]), _0x2d4af2[_0x4ccb9c(0x41e)] = () => _0x46f9ef(_0x2d4af2[_0x4ccb9c(0x8d6)]); } else { if (!_0x3e9e93 || !_0xcdf881) return ''; const _0x3b9710 = _0x346f80[_0x4ccb9c(0x3aa)]['find'](_0x14fd68 => _0x14fd68[_0x4ccb9c(0x62d)] === _0x4ccb9c(0x328) && _0x14fd68[_0x4ccb9c(0x717)][_0x4ccb9c(0x84e)](_0x3e9e93['id'])); if (!_0x3b9710 || _0x3b9710[_0x4ccb9c(0x96f)] !== _0xcdf881['id']) return ''; const _0x3ea1ea = _0x24a394(_0x3b9710['id'])[_0x4ccb9c(0x290)](-0x14); if (_0x3ea1ea[_0x4ccb9c(0x6c3)] === 0x0) return ''; const _0x1d7d54 = _0x3ea1ea[_0x4ccb9c(0x2a0)](_0x48f186 => { const _0x59958d = _0x4ccb9c, _0x20c304 = _0x48f186[_0x59958d(0x6b9)] === 'user' ? _0xcdf881['name'] : _0x3e9e93[_0x59958d(0x4e6)]; return '[' + _0x20c304 + ']:\x20' + _0x48f186[_0x59958d(0x2fc)]; })[_0x4ccb9c(0x6e6)]('\x0a'); return _0x4ccb9c(0x2e0) + _0xcdf881['name'] + _0x4ccb9c(0x604) + _0x1d7d54 + '\x0a'; } } async function _0x34cb3a() { const _0x6c476c = _0x54ed15; if ('KISDK' !== 'KISDK') _0xe2200a(), _0x34f94b('diaryList', _0x6c476c(0x72b)); else { const _0x21df41 = new Date(), _0x37205b = _0x21df41[_0x6c476c(0x85b)]() + '-' + String(_0x21df41[_0x6c476c(0x89d)]() + 0x1)[_0x6c476c(0x990)](0x2, '0') + '-' + String(_0x21df41[_0x6c476c(0x74d)]())['padStart'](0x2, '0'); if (_0x346f80[_0x6c476c(0x4aa)][_0x37205b]) { if (_0x6c476c(0x843) !== _0x6c476c(0x19c)) { _0x3383df(_0x6c476c(0x34f)); return; } else { const _0x35e934 = _0xd67902[_0x6c476c(0x954)](_0x6c476c(0x9e1)); _0x35e934 && _0x35e934[_0x6c476c(0x39c)](); } } const _0x521c72 = _0x346f80[_0x6c476c(0x28a)][_0x6c476c(0x6e8)](_0x9f9f25 => new Date(_0x9f9f25[_0x6c476c(0x83c)])[_0x6c476c(0x7e3)]() === _0x21df41['toDateString']()); if (_0x521c72[_0x6c476c(0x6c3)] === 0x0) { _0x3383df(_0x6c476c(0x4c5)); return; } _0x6cd89d(!![], _0x6c476c(0x294)); try { const _0x3786fd = [_0x6c476c(0x65d), '交通出行', '购物消费', _0x6c476c(0x41f), _0x6c476c(0x278), '医疗健康', _0x6c476c(0x3c9), _0x6c476c(0x416)], _0x3b43f6 = _0x521c72[_0x6c476c(0x2a0)](_0x11d8f9 => '-\x20' + _0x11d8f9[_0x6c476c(0x3ae)] + ':\x20' + _0x11d8f9['amount'])[_0x6c476c(0x6e6)]('\x0a'), _0x2af92c = _0x6c476c(0x62e), _0x48420e = _0x6c476c(0x19a) + _0x3786fd[_0x6c476c(0x6e6)](',\x20') + _0x6c476c(0x382) + _0x3b43f6, _0x1cdab9 = await _0x555f32([{ 'role': _0x6c476c(0x9ca), 'content': _0x2af92c }, { 'role': _0x6c476c(0x619), 'content': _0x48420e }], { 'json': !![] }); let _0x1ccba8 = JSON[_0x6c476c(0x781)](_0x1cdab9); for (let _0x5bb302 = 0x0; _0x5bb302 < _0x1ccba8[_0x6c476c(0x6c3)]; _0x5bb302++) { const _0x592c7e = _0x1ccba8[_0x5bb302], _0x2e5082 = _0x346f80[_0x6c476c(0x499)][Math[_0x6c476c(0x353)](Math['random']() * _0x346f80['characters'][_0x6c476c(0x6c3)])]; if (!_0x2e5082) continue; _0x6cd89d(!![], _0x6c476c(0x465) + _0x2e5082[_0x6c476c(0x4e6)] + _0x6c476c(0x237) + (_0x5bb302 + 0x1) + '/' + _0x1ccba8[_0x6c476c(0x6c3)] + ')'); const _0x108cd6 = _0x346f80[_0x6c476c(0x3aa)][_0x6c476c(0x247)](_0x3678cb => _0x3678cb['type'] === _0x6c476c(0x328) && _0x3678cb[_0x6c476c(0x717)][_0x6c476c(0x84e)](_0x2e5082['id'])), _0x49a2e5 = _0x346f80[_0x6c476c(0x2f5)][_0x6c476c(0x247)](_0x608f77 => _0x608f77['id'] === (_0x108cd6?.[_0x6c476c(0x96f)] || _0x346f80['activeUserProfileId'])) || _0x346f80['userProfiles'][0x0]; let _0x8759a3 = ''; if (_0x2e5082['linkedWorldBookIds'] && _0x2e5082['linkedWorldBookIds']['length'] > 0x0) { const _0x30680c = _0x2e5082[_0x6c476c(0x925)][_0x6c476c(0x2a0)](_0x1c050c => _0x346f80['worldBooks'][_0x6c476c(0x247)](_0x451098 => _0x451098['id'] === _0x1c050c))[_0x6c476c(0x6e8)](Boolean)[_0x6c476c(0x2a0)](_0x2d1dbc => _0x6c476c(0x670) + _0x2d1dbc['name'] + '\x0a' + _0x2d1dbc['content'])[_0x6c476c(0x6e6)](''); _0x30680c && (_0x6c476c(0x2dc) === _0x6c476c(0x8d9) ? _0x2ed291[_0x6c476c(0x845)]('chatHistory_' + _0x5c36af) : _0x8759a3 = _0x6c476c(0x720) + _0x30680c); } const _0x591cff = _0x400dd3(_0x2e5082, _0x49a2e5), _0x1fd553 = _0x6c476c(0x5e9) + _0x2e5082[_0x6c476c(0x4e6)] + _0x6c476c(0x265) + _0x49a2e5[_0x6c476c(0x4e6)] + _0x6c476c(0x34a) + _0x2e5082[_0x6c476c(0x1a5)] + _0x6c476c(0x83d) + _0x49a2e5[_0x6c476c(0x4e6)] + _0x6c476c(0x703) + _0x49a2e5['persona'] + '\x0a' + _0x8759a3 + '\x0a' + _0x591cff + _0x6c476c(0x45b), _0x1cf7aa = '“' + _0x49a2e5[_0x6c476c(0x4e6)] + '”刚刚有一笔消费：\x0a-\x20花在哪了:\x20' + _0x592c7e[_0x6c476c(0x3ae)] + _0x6c476c(0x180) + _0x592c7e[_0x6c476c(0x1b3)] + _0x6c476c(0x944), _0x496487 = await _0x555f32([{ 'role': _0x6c476c(0x9ca), 'content': _0x1fd553 }, { 'role': _0x6c476c(0x619), 'content': _0x1cf7aa }]); _0x592c7e[_0x6c476c(0x213)] = { 'charId': _0x2e5082['id'], 'text': _0x496487 }; } _0x346f80['accountingLedger'][_0x37205b] = { 'categorizedExpenses': _0x1ccba8, 'timestamp': Date[_0x6c476c(0x909)]() }, _0x23c6b9(), _0x354b06(_0x346f80[_0x6c476c(0x4aa)][_0x37205b], _0x37205b); } catch (_0x191a13) { _0x3383df(_0x6c476c(0x9c1) + _0x191a13[_0x6c476c(0x399)]); } finally { if (_0x6c476c(0x3a3) !== _0x6c476c(0x6ee)) _0x6cd89d(![]); else { if (_0x15d314[_0x6c476c(0x6c3)] === 0x0) return; _0x1777b8 = (_0x925721 - 0x1 + _0x26e849[_0x6c476c(0x6c3)]) % _0x321779[_0x6c476c(0x6c3)], _0x251d8c(_0x39942d[_0x3991c5], _0x3ffaa3); } } } } async function _0x50a2da() { const _0x323ef3 = _0x54ed15, _0xa9ea8f = [..._0x788fa4]; try { if ('ASheY' === _0x323ef3(0x7fd)) { const _0x8e198f = _0x341658[_0x323ef3(0x781)](_0x40fba8['getItem'](_0x323ef3(0x7a4)) || '{}'), _0x2e78f7 = { ..._0x8e198f, ..._0x11300e }; _0x2de410['setItem']('badgeState', _0xbeb3b9['stringify'](_0x2e78f7)); } else { const _0x5c0dc2 = localStorage[_0x323ef3(0x164)](_0x323ef3(0x368)); if (_0x5c0dc2) { const _0x1a4204 = JSON[_0x323ef3(0x781)](_0x5c0dc2); if (Array[_0x323ef3(0x86b)](_0x1a4204)) { if ('RWGsS' === _0x323ef3(0x1b1)) { const _0x2a1bd1 = new _0x469f0a(), _0x283ac9 = _0x75d64c['getElementById'](_0x323ef3(0x979)), _0x385fe5 = _0x5b1a27['getElementById'](_0x323ef3(0x175)); if (_0x283ac9 && _0x385fe5) { const _0x53bd80 = _0x1973a8(_0x2a1bd1['getHours']())[_0x323ef3(0x990)](0x2, '0'), _0x661632 = _0x5a4edd(_0x2a1bd1[_0x323ef3(0x783)]())[_0x323ef3(0x990)](0x2, '0'); _0x283ac9[_0x323ef3(0x96c)] = _0x53bd80 + ':' + _0x661632; const _0x3fd640 = _0x2a1bd1[_0x323ef3(0x89d)]() + 0x1, _0x5a0503 = _0x2a1bd1[_0x323ef3(0x74d)](), _0x5683ab = [_0x323ef3(0x1d2), _0x323ef3(0x8cb), _0x323ef3(0x609), _0x323ef3(0x518), '星期四', '星期五', _0x323ef3(0x6c2)][_0x2a1bd1['getDay']()]; _0x385fe5[_0x323ef3(0x96c)] = _0x3fd640 + '月' + _0x5a0503 + '日\x20' + _0x5683ab; } } else _0xfd4511 = [..._0xa9ea8f, ..._0x1a4204]; } else _0xfd4511 = _0xa9ea8f; } else { if (_0x323ef3(0x31b) !== _0x323ef3(0x1cf)) _0xfd4511 = _0xa9ea8f; else { const _0x5f1634 = _0x433d9e[_0x323ef3(0x820)](_0x323ef3(0x183)); _0x5f1634['value'] = _0x4528db['id'], _0x5f1634[_0x323ef3(0x96c)] = _0x49b4ef[_0x323ef3(0x4e6)], _0x262b71[_0x323ef3(0x204)](_0x5f1634); } } } } catch (_0x599461) { console[_0x323ef3(0x8d6)]('加载自定义表情包失败，真是没用。', _0x599461), _0xfd4511 = _0xa9ea8f; } if (!localStorage[_0x323ef3(0x164)](_0x323ef3(0x8f1))) { _0x57c3ed(_0x323ef3(0x7d6))[_0x323ef3(0x710)](async _0x56be03 => { const _0x3f14b0 = _0x323ef3; _0x56be03 ? (_0x6cd89d(!![], _0x3f14b0(0x6b3)), await _0xc55858(), localStorage['setItem'](_0x3f14b0(0x8f1), _0x3f14b0(0x58e)), _0x6cd89d(![]), _0x3383df(_0x3f14b0(0x6c4)), setTimeout(() => location['reload'](), 0x5dc)) : _0x3383df('升级已取消。旧版图片数据可能导致应用卡顿或出错。'); }); return; } if (!localStorage[_0x323ef3(0x164)](_0x323ef3(0x276))) { if (_0x323ef3(0x851) === _0x323ef3(0x1da)) { const _0x4145b3 = _0x1e29d5['getElementById']('confirm-altar-upload-button'); _0x4cb784[_0x323ef3(0x7a1)] && _0x5185a9['info'] ? _0x4145b3[_0x323ef3(0x7bc)] = ![] : _0x4145b3['disabled'] = !![]; } else { console[_0x323ef3(0x7e5)]('执行好友圈数据净化...'), _0x6cd89d(!![], _0x323ef3(0x917)); const _0x59770e = await _0x455f6a(); localStorage[_0x323ef3(0x6c6)](_0x323ef3(0x276), _0x323ef3(0x58e)), _0x6cd89d(![]); if (_0x59770e > 0x0) { _0x3383df(_0x323ef3(0x304) + _0x59770e + _0x323ef3(0x853)), setTimeout(() => location[_0x323ef3(0x55a)](), 0x5dc); return; } } } if (!localStorage[_0x323ef3(0x164)](_0x323ef3(0x276))) { } if (!localStorage[_0x323ef3(0x164)]('noir_migration_music_v1_complete')) { console[_0x323ef3(0x7e5)](_0x323ef3(0x7f1)), _0x6cd89d(!![], _0x323ef3(0x2f1)); const _0x40a0fb = await _0x178f7e(); localStorage[_0x323ef3(0x6c6)](_0x323ef3(0x8a8), 'true'), _0x6cd89d(![]); if (_0x40a0fb > 0x0) { if (_0x323ef3(0x562) !== 'EetKm') { _0x3383df(_0x323ef3(0x924) + _0x40a0fb + _0x323ef3(0x881)), setTimeout(() => location[_0x323ef3(0x55a)](), 0x5dc); return; } else _0xdaaf37[_0x323ef3(0x94f)][_0x323ef3(0x4cf)] = _0x323ef3(0x488), _0x1dc222[_0x323ef3(0x94f)]['textShadow'] = _0x323ef3(0x910); } } const _0x544d98 = _0xbbfd09(); _0x42b218(), _0x213750(), _0x1efcc6(), _0x2bb569(), _0x172211(), _0x2630a9(), _0x2ad9bb(), _0x21cb9d(), _0x3e15ea(), _0x2ae481(), _0x5d8cd8(), _0x2ae828(), setInterval(_0x2ae828, 0x7530), _0x582da6(), _0x546ea8(), _0x89fcff(); const _0x404d6e = document[_0x323ef3(0x954)](_0x323ef3(0x82c)); document[_0x323ef3(0x954)](_0x323ef3(0x5c1))[_0x323ef3(0x35e)]('click', function (_0x2cfc69) { const _0x2825de = _0x323ef3; if (_0x2825de(0x434) !== _0x2825de(0x434)) { if (_0x42e5e3[_0x2825de(0x955)] === _0x2825de(0x1e1)) _0x1d029d(null); _0x49388b[_0x2825de(0x955)] === _0x2825de(0x3fc) && (_0x54ed34[_0x2825de(0x45f)](), _0xb8b229()); } else { if (_0x2cfc69['target'][_0x2825de(0x34c)](_0x2825de(0x340))) return; const _0x24e5fb = document[_0x2825de(0x954)](_0x2825de(0x1d0)); _0x24e5fb && _0x24e5fb[_0x2825de(0x39c)](); } }), _0x21dca3(_0x323ef3(0x72b), _0x323ef3(0x579)); (_0x544d98 || _0x346f80[_0x323ef3(0x499)][_0x323ef3(0x6c3)] === 0x0) && (_0x3383df(_0x323ef3(0x3b3)), setTimeout(() => { const _0x346d00 = _0x323ef3; if (_0x346d00(0x1a9) === _0x346d00(0x2ec)) { _0x2b77e9 = _0x57042f[_0x346d00(0x3aa)]['find'](_0x4736c2 => _0x4736c2[_0x346d00(0x62d)] === 'private' && _0x4736c2[_0x346d00(0x717)][_0x346d00(0x84e)](_0x22dbdc)); const _0x3b6edc = _0x4dfccc(_0x34d57f); _0x526050 = _0x3b6edc ? _0x3b6edc[_0x346d00(0x4e6)] : _0x346d00(0x4a2); } else _0x21dca3(_0x346d00(0x755), _0x346d00(0x72b)), setTimeout(() => _0x49866d(), 0x64); }, 0x6a4)); const _0x1f60e1 = document[_0x323ef3(0x954)](_0x323ef3(0x647)); document['getElementById'](_0x323ef3(0x556))['addEventListener'](_0x323ef3(0x39c), () => _0x1f60e1[_0x323ef3(0x39c)]()), document[_0x323ef3(0x954)]('reset-widget-bg-button')['addEventListener']('click', () => { const _0x159faa = _0x323ef3; if (_0x159faa(0x61b) !== _0x159faa(0x5c7)) _0x346f80[_0x159faa(0x4fe)]['widgetBgImage'] = null, _0x23c6b9(), _0x582da6(), _0x3383df(_0x159faa(0x394)); else { const _0x3397f1 = _0x127e55[_0x159faa(0x2fc)]['match'](/：(.*?)]$/); _0x43bb4d[_0x159faa(0x2fc)] = _0x159faa(0x3d9) + (_0x3397f1 ? _0x3397f1[0x1] : _0x159faa(0x3ce)) + ']', _0x38d5bf['push'](_0x3b6346); } }), _0x1f60e1['addEventListener'](_0x323ef3(0x2ed), async _0x3310c0 => { const _0x42cc51 = _0x323ef3, _0x3b755a = _0x3310c0[_0x42cc51(0x921)][_0x42cc51(0x626)][0x0]; if (!_0x3b755a) return; try { if (_0x42cc51(0x8b3) === 'LUYVi') { const _0x5680c5 = await _0x1bec17(_0x3b755a); _0x346f80['preferences'][_0x42cc51(0x6ec)] = _0x5680c5, _0x23c6b9(), _0x582da6(), _0x3383df(_0x42cc51(0x8f8)); } else { const _0x55c5ed = _0x27d7c4(_0x32a2f0[_0x42cc51(0x717)][0x0]); _0x54edc7['textContent'] = _0x55c5ed ? _0x55c5ed[_0x42cc51(0x4e6)] : '未知角色'; } } catch (_0x2d2642) { 'hoVjT' !== _0x42cc51(0x1c1) ? (_0x5a8118[_0x428cdc]['classList'][_0x42cc51(0x309)](_0x42cc51(0x897)), _0x4e8fd3[_0x3da1f5][_0x42cc51(0x908)] = '') : _0x3383df(_0x42cc51(0x914) + _0x2d2642['message']); } }), _0x2e3939(), document[_0x323ef3(0x954)](_0x323ef3(0x869))[_0x323ef3(0x35e)](_0x323ef3(0x39c), () => document[_0x323ef3(0x954)]('badge-input')['click']()), document[_0x323ef3(0x954)]('reset-badge-button')[_0x323ef3(0x35e)](_0x323ef3(0x39c), async () => { const _0x25ecc2 = _0x323ef3; await _0x52b4ba(_0x25ecc2(0x9e5)), localStorage[_0x25ecc2(0x845)](_0x25ecc2(0x7a4)), _0x2e3939(), _0x3383df(_0x25ecc2(0x246)); }), document[_0x323ef3(0x954)](_0x323ef3(0x4d4))['addEventListener'](_0x323ef3(0x2ed), async _0x4dd75f => { const _0x3d14fe = _0x323ef3; if (_0x3d14fe(0x366) !== _0x3d14fe(0x366)) { const _0x1b54ca = _0x38936c[_0x3d14fe(0x250)][_0x37356f - 0x2], _0x54eecc = _0x86e447[_0x3d14fe(0x250)][_0x17f8f3 - 0x1]; if (_0x1b54ca[_0x3d14fe(0x97f)] === ![] && _0x54eecc[_0x3d14fe(0x97f)] === !![]) _0x39f437 = _0x3d14fe(0x466) + _0x14da49[_0x3d14fe(0x4e6)] + _0x3d14fe(0x588); else _0x1b54ca[_0x3d14fe(0x97f)] === !![] && _0x54eecc[_0x3d14fe(0x97f)] === ![] && (_0x3ab893 = '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“' + _0xc3a20f[_0x3d14fe(0x4e6)] + _0x3d14fe(0x81e)); } else { const _0xef7f96 = _0x4dd75f['target'][_0x3d14fe(0x626)][0x0]; if (!_0xef7f96) return; try { await _0x336559(_0x3d14fe(0x9e5), _0xef7f96), await _0x2e3939(), _0x3383df(_0x3d14fe(0x2cc)); } catch (_0x33aea1) { _0x3383df('错误:\x20' + _0x33aea1[_0x3d14fe(0x399)]); } } }), _0x4cd21e(), document[_0x323ef3(0x954)]('diary-entries-container')[_0x323ef3(0x35e)](_0x323ef3(0x911), _0x2092e5), document[_0x323ef3(0x954)](_0x323ef3(0x7d7))[_0x323ef3(0x35e)](_0x323ef3(0x61d), _0x2092e5, { 'passive': ![] }), document[_0x323ef3(0x954)]('upload-card-button')[_0x323ef3(0x35e)](_0x323ef3(0x39c), () => document[_0x323ef3(0x954)](_0x323ef3(0x270))[_0x323ef3(0x39c)]()), document[_0x323ef3(0x954)](_0x323ef3(0x6e2))['addEventListener'](_0x323ef3(0x39c), async () => { const _0x40711f = _0x323ef3; await _0x52b4ba('widget_card'), localStorage['removeItem'](_0x40711f(0x5e7)), _0x4cd21e(), _0x3383df('卡片已移除。'); }), document[_0x323ef3(0x954)](_0x323ef3(0x270))[_0x323ef3(0x35e)](_0x323ef3(0x2ed), async _0x3c31fd => { const _0x357f3c = _0x323ef3; if (_0x357f3c(0x577) === _0x357f3c(0x577)) { const _0x2b8391 = _0x3c31fd[_0x357f3c(0x921)]['files'][0x0]; if (!_0x2b8391) return; try { _0x357f3c(0x5f2) !== _0x357f3c(0x5cb) ? (await _0x336559(_0x357f3c(0x3b7), _0x2b8391), await _0x4cd21e(), _0x3383df(_0x357f3c(0x9bf))) : (_0x9cf2e8(_0x357f3c(0x755), _0x357f3c(0x72b)), _0x52df08(() => _0x10f419(), 0x64)); } catch (_0x10dee8) { if (_0x357f3c(0x9a4) === _0x357f3c(0x8bd)) { const _0x247e72 = _0xbbdbee[_0x357f3c(0x820)](_0x357f3c(0x41a)); _0x247e72[_0x357f3c(0x941)] = 'expense-item', _0x247e72[_0x357f3c(0x6a9)] = _0x357f3c(0x4f2) + _0xddfbda[_0x357f3c(0x3ae)] + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>-\x20' + _0x3fe150[_0x357f3c(0x1b3)][_0x357f3c(0x557)](0x2) + _0x357f3c(0x27a), _0x247798['appendChild'](_0x247e72); } else _0x3383df(_0x357f3c(0x914) + _0x10dee8['message']); } } else _0x14282d[_0x357f3c(0x6d5)](), _0x3401cf[_0x357f3c(0x78f)][_0x357f3c(0x622)]('visible'), _0x44d99f[_0x357f3c(0x78f)][_0x357f3c(0x622)](_0x357f3c(0x978)); }), document[_0x323ef3(0x954)](_0x323ef3(0x85c))[_0x323ef3(0x35e)](_0x323ef3(0x39c), async () => { const _0x67f56c = _0x323ef3; if (_0x67f56c(0x716) === _0x67f56c(0x718)) { const _0x12318d = _0x11bfe4(_0x1fac56[_0x67f56c(0x717)][0x0]); _0x12318d ? (_0x2315a4 = _0x12318d[_0x67f56c(0x4ef)] || _0x25cb29, _0x3b3843 = _0x12318d['name'] || _0x67f56c(0x7f4), _0x553081 = _0x12318d[_0x67f56c(0x287)] || '私聊') : (_0x34dac6 = _0x67f56c(0x317), _0x486d2d = _0x67f56c(0x694)); } else { const _0x11f7ec = await _0x57c3ed(_0x67f56c(0x360)); _0x11f7ec && (localStorage[_0x67f56c(0x845)](_0x67f56c(0x7a4)), localStorage[_0x67f56c(0x845)]('cardWidgetState'), _0x3383df(_0x67f56c(0x6ed)), setTimeout(() => location['reload'](), 0x3e8)); } }); const _0x5edd64 = document[_0x323ef3(0x954)](_0x323ef3(0x8b6)); _0x5edd64['addEventListener'](_0x323ef3(0x39c), () => { const _0x9d5145 = _0x323ef3; _0x23c68b(), _0x21dca3(_0x9d5145(0x1f3), 'home'); }); const _0x4e5f06 = document['getElementById'](_0x323ef3(0x8a3)); _0x4e5f06[_0x323ef3(0x35e)](_0x323ef3(0x39c), () => { const _0x566c61 = _0x323ef3; _0x37cadc(), _0x21dca3(_0x566c61(0x316), 'home'); }), document[_0x323ef3(0x954)](_0x323ef3(0x33d))[_0x323ef3(0x35e)](_0x323ef3(0x39c), () => _0x21dca3(_0x323ef3(0x72b), 'musicLibrary')), document[_0x323ef3(0x954)](_0x323ef3(0x3cf))['addEventListener'](_0x323ef3(0x39c), () => _0x21dca3(_0x323ef3(0x72b), _0x323ef3(0x1f3))), document['getElementById']('back-to-diary-list')[_0x323ef3(0x35e)](_0x323ef3(0x39c), () => { const _0x292ce0 = _0x323ef3; _0x292ce0(0x6c8) === 'JpJWt' ? (_0x346f80[_0x292ce0(0x597)] = null, _0x21dca3('diaryList', _0x292ce0(0x6df))) : _0x9828ef(_0x8fbc59, _0x103b2c[_0x292ce0(0x7aa)]); }), document[_0x323ef3(0x954)](_0x323ef3(0x6e0))['addEventListener'](_0x323ef3(0x39c), _0x300797), document[_0x323ef3(0x954)]('diary-get-reply-button')['addEventListener'](_0x323ef3(0x39c), _0x3c1033), document['getElementById']('diary-entry-input')[_0x323ef3(0x35e)](_0x323ef3(0x491), _0x3cb8e6 => { const _0xc6bfc2 = _0x323ef3; _0x3cb8e6[_0xc6bfc2(0x955)] === _0xc6bfc2(0x3fc) && !_0x3cb8e6[_0xc6bfc2(0x31f)] && (_0x3cb8e6[_0xc6bfc2(0x45f)](), _0x300797()); }); const _0x20b02e = [_0x323ef3(0x7e0), _0x323ef3(0x463), _0x323ef3(0x4b2), _0x323ef3(0x216), _0x323ef3(0x195)]; _0x20b02e[_0x323ef3(0x927)](_0x5e65c4 => { const _0x7380f = _0x323ef3, _0xd4d63f = document['getElementById'](_0x7380f(0x39d) + _0x5e65c4 + '-preview'), _0x662fb9 = document['getElementById'](_0x7380f(0x39d) + _0x5e65c4 + _0x7380f(0x690)); _0xd4d63f && _0x662fb9 && (_0xd4d63f[_0x7380f(0x35e)](_0x7380f(0x39c), () => _0x662fb9[_0x7380f(0x39c)]()), _0x662fb9[_0x7380f(0x35e)](_0x7380f(0x2ed), async _0x4644df => { const _0x475448 = _0x7380f, _0x3abb25 = _0x4644df[_0x475448(0x921)]['files'][0x0]; if (!_0x3abb25) return; try { _0xd4d63f[_0x475448(0x7d9)] = URL['createObjectURL'](_0x3abb25); } catch (_0x462e1b) { _0x3383df(_0x475448(0x6af) + _0x462e1b[_0x475448(0x399)]); } })); }), document[_0x323ef3(0x954)](_0x323ef3(0x194))[_0x323ef3(0x35e)](_0x323ef3(0x39c), _0x3c519a), document[_0x323ef3(0x954)](_0x323ef3(0x999))[_0x323ef3(0x35e)]('click', () => { const _0x347083 = _0x323ef3; _0x346f80[_0x347083(0x996)] = _0x346f80[_0x347083(0x996)] === 'novel' ? _0x347083(0x4d0) : _0x347083(0x6d6), _0x1557d8(); }), document[_0x323ef3(0x954)](_0x323ef3(0x959))[_0x323ef3(0x35e)](_0x323ef3(0x911), _0x20a2c8), document[_0x323ef3(0x954)](_0x323ef3(0x959))['addEventListener'](_0x323ef3(0x61d), _0x20a2c8, { 'passive': ![] }); let _0x1fe2b9 = null; function _0x20a2c8(_0x4d7067) { const _0x2780ff = _0x323ef3; if (_0x1fe2b9) clearTimeout(_0x1fe2b9); const _0x2db3b0 = _0x4d7067[_0x2780ff(0x921)][_0x2780ff(0x34c)](_0x2780ff(0x82f)); if (!_0x2db3b0) return; const _0xe9173 = parseInt(_0x2db3b0[_0x2780ff(0x86c)][_0x2780ff(0x79d)], 0xa); if (isNaN(_0xe9173)) return; const _0x4a67f3 = () => { const _0x1f19e6 = _0x2780ff; if ('YbExr' === _0x1f19e6(0x16a)) _0x1fe2b9 = setTimeout(() => { const _0x49c9ca = _0x1f19e6; if (_0x4d7067[_0x49c9ca(0x62d)] === _0x49c9ca(0x61d)) _0x4d7067['preventDefault'](); _0x2990a9(_0xe9173); }, 0x320); else { const _0x136525 = _0x2b7139(_0xf51dca[_0x1f19e6(0x908)]); if (_0x53442c(_0x136525) || _0x136525 <= 0x0) { _0x25de61(_0x1f19e6(0x7e1)); return; } const _0x1a2865 = _0x46a926(); let _0x6a1354 = null; _0x1a2865[_0x1f19e6(0x62d)] === 'group' ? _0x6a1354 = _0x4a3876[_0x1f19e6(0x908)] : _0x6a1354 = _0x1a2865[_0x1f19e6(0x717)][0x0]; const _0x1b3327 = _0x3b82da(_0x1a2865['id']), _0x51bf5f = { 'role': _0x1f19e6(0x619), 'type': _0x1f19e6(0x37f), 'content': _0x1f19e6(0x33b) + (_0x53b2a4(_0x6a1354)?.[_0x1f19e6(0x4e6)] || '未知') + _0x1f19e6(0x8e8) + _0x136525 + ']', 'amount': _0x136525, 'recipientId': _0x6a1354, 'senderId': _0x1b3327['id'], 'timestamp': _0x10d89e[_0x1f19e6(0x909)]() }; _0x4ac3de['conversationHistory']['push'](_0x51bf5f), _0x2774d4(), _0x17817b(), _0x43d274[_0x1f19e6(0x78f)][_0x1f19e6(0x309)](_0x1f19e6(0x373)); } }, _0x16123f = () => { if (_0x1fe2b9) clearTimeout(_0x1fe2b9); }; document['addEventListener'](_0x2780ff(0x5cf), _0x16123f, { 'once': !![] }), document[_0x2780ff(0x35e)]('mouseleave', _0x16123f, { 'once': !![] }), document[_0x2780ff(0x35e)]('touchend', _0x16123f, { 'once': !![] }), document[_0x2780ff(0x35e)]('touchcancel', _0x16123f, { 'once': !![] }), _0x4a67f3(); } document['body']['addEventListener'](_0x323ef3(0x39c), _0x323035 => { const _0x2a6cef = _0x323ef3; if (_0x2a6cef(0x823) === 'fGyMp') { const _0x5d00f5 = _0x323035[_0x2a6cef(0x921)][_0x2a6cef(0x34c)](_0x2a6cef(0x1af)); if (_0x5d00f5) { const _0x570d62 = _0x323035[_0x2a6cef(0x921)][_0x2a6cef(0x34c)](_0x2a6cef(0x261)), _0x432bf2 = _0x323035[_0x2a6cef(0x921)]['closest']('.listen-together-accept-btn'); if (_0x570d62) { if (_0x2a6cef(0x2d6) === _0x2a6cef(0x2d6)) _0x2073aa(); else { const _0x36d7b4 = _0x20cf37['toLowerCase'](), _0x5f5786 = _0x5723b5[_0x2a6cef(0x234)](); if (_0x36d7b4[_0x2a6cef(0x859)](_0x2a6cef(0x80b))) return _0x2a6cef(0x301); if (_0x5f5786[_0x2a6cef(0x84e)](_0x2a6cef(0x6fa))) return _0x2a6cef(0x301); if (_0x5f5786['includes'](_0x2a6cef(0x42e))) return _0x2a6cef(0x225); if (_0x36d7b4[_0x2a6cef(0x859)](_0x2a6cef(0x225))) return _0x2a6cef(0x225); return _0x2a6cef(0x9c2); } } else { if (_0x432bf2) { const _0x550cd2 = _0x432bf2['closest'](_0x2a6cef(0x80e)), _0x3112f8 = _0x432bf2['dataset'][_0x2a6cef(0x789)], _0x54e788 = parseInt(_0x550cd2['dataset'][_0x2a6cef(0x79d)], 0xa); _0x520861(_0x3112f8, _0x54e788, _0x5d00f5); } else { const _0x37c5bf = _0x597f5f(); _0x37c5bf && _0x37c5bf[_0x2a6cef(0x7b1)] && _0x37c5bf[_0x2a6cef(0x7b1)][_0x2a6cef(0x1e7)] && (_0x245b32[_0x2a6cef(0x94f)][_0x2a6cef(0x3b4)] = _0x2a6cef(0x798), setTimeout(() => _0x245b32[_0x2a6cef(0x78f)][_0x2a6cef(0x3d0)](_0x2a6cef(0x373)), 0xa)); } } return; } if (window['getSelection']()[_0x2a6cef(0x894)]()) return; const _0x96357a = _0x323035[_0x2a6cef(0x921)][_0x2a6cef(0x34c)](_0x2a6cef(0x80e)); if (_0x96357a && !_0x323035[_0x2a6cef(0x921)][_0x2a6cef(0x34c)](_0x2a6cef(0x285))) { if (_0x2a6cef(0x3a5) !== 'FNDCl') { const _0x1387e8 = _0x21fda1[_0x2a6cef(0x2f5)]['find'](_0x1ba131 => _0x1ba131['id'] === _0x403635); if (!_0x1387e8) return; _0x5679a4[_0x2a6cef(0x954)](_0x2a6cef(0x92b))[_0x2a6cef(0x908)] = _0x1387e8['id'], _0x3ec9ce[_0x2a6cef(0x954)]('user-profile-edit-title')[_0x2a6cef(0x96c)] = _0x2a6cef(0x7df), _0x363693[_0x2a6cef(0x954)](_0x2a6cef(0x57a))[_0x2a6cef(0x908)] = _0x1387e8[_0x2a6cef(0x4e6)], _0x3455d0[_0x2a6cef(0x954)](_0x2a6cef(0x21b))[_0x2a6cef(0x7d9)] = _0x1387e8[_0x2a6cef(0x4ef)], _0x234101['getElementById'](_0x2a6cef(0x6cb))[_0x2a6cef(0x908)] = _0x1387e8[_0x2a6cef(0x1a5)], _0x3176f0[_0x2a6cef(0x94f)][_0x2a6cef(0x3b4)] = _0x1387e8['id'] === _0x2ffc16['activeUserProfileId'] ? _0x2a6cef(0x910) : _0x2a6cef(0x810); } else { const _0x387f0d = parseInt(_0x96357a[_0x2a6cef(0x86c)][_0x2a6cef(0x79d)], 0xa); !isNaN(_0x387f0d) && ('sxYeq' === _0x2a6cef(0x27b) ? _0x2990a9(_0x387f0d) : _0x1b5f8d(_0x2a6cef(0x2ae))); } } } else { const _0xa0e76d = _0x529838[_0x2a6cef(0x820)](_0x2a6cef(0x486)); _0xa0e76d[_0x2a6cef(0x6a9)] = _0x2a6cef(0x60c) + _0x58c8f2['id'] + '\x22>\x20' + _0x595047[_0x2a6cef(0x4e6)], _0x1be41c[_0x2a6cef(0x204)](_0xa0e76d); } }); const _0x175b44 = document[_0x323ef3(0x954)](_0x323ef3(0x43d)); _0x175b44 && _0x175b44[_0x323ef3(0x35e)](_0x323ef3(0x39c), () => { const _0x206270 = _0x323ef3; _0x3383df(_0x206270(0x29e)); }); const _0x2eca0b = document[_0x323ef3(0x954)](_0x323ef3(0x543)), _0x29a627 = localStorage['getItem']('customStickers'); if (_0x29a627) { if ('XDYVN' !== 'XDYVN') _0x528102[_0x323ef3(0x250)][_0x323ef3(0x927)]((_0x163485, _0x2ef1c8) => _0x22a6ee(_0x163485, _0x2ef1c8)); else try { const _0x11252d = JSON[_0x323ef3(0x781)](_0x29a627); Array['isArray'](_0x11252d) && ('SkXWV' !== _0x323ef3(0x347) ? _0x2eca0b[_0x323ef3(0x908)] = _0x11252d[_0x323ef3(0x2a0)](_0x69447d => _0x69447d[_0x323ef3(0x4e6)] + '--' + _0x69447d[_0x323ef3(0x4ee)])['join']('\x0a') : _0x575230[_0x323ef3(0x7da)] = _0x4ce72e['id']); } catch (_0x4953a4) { } } document['getElementById'](_0x323ef3(0x5fd))[_0x323ef3(0x35e)](_0x323ef3(0x39c), () => { const _0x5d922f = _0x323ef3; if (_0x5d922f(0x2e5) !== _0x5d922f(0x2e5)) _0x2a781f['getElementById'](_0x5d922f(0x44f))[_0x5d922f(0x908)] = '', _0x5403d6[_0x5d922f(0x954)]('world-book-editor-title')[_0x5d922f(0x96c)] = _0x5d922f(0x90a), _0x5be7fe[_0x5d922f(0x954)](_0x5d922f(0x878))[_0x5d922f(0x908)] = '', _0xbddc62[_0x5d922f(0x954)](_0x5d922f(0x7bd))['value'] = ''; else { const _0x2c3ed9 = _0x2eca0b[_0x5d922f(0x908)], _0xb0be68 = _0x2c3ed9['split']('\x0a')[_0x5d922f(0x6e8)](_0x20bedf => _0x20bedf[_0x5d922f(0x4dd)]() !== ''), _0x46881a = []; let _0x5ab668 = 0x0; for (const _0x291736 of _0xb0be68) { if (_0x5d922f(0x89a) === _0x5d922f(0x65f)) _0x4359d5 += _0x5d922f(0x1e6) + _0x58a8f6[_0x5d922f(0x9be)] + _0x5d922f(0x218) + _0x2d9ed3['artist'] + ')'; else { const _0x452e02 = _0x291736[_0x5d922f(0x1a7)]('--'); _0x452e02[_0x5d922f(0x6c3)] === 0x2 && _0x452e02[0x0][_0x5d922f(0x4dd)]() && _0x452e02[0x1][_0x5d922f(0x4dd)]()[_0x5d922f(0x859)]('http') ? _0x46881a[_0x5d922f(0x580)]({ 'name': _0x452e02[0x0]['trim'](), 'url': _0x452e02[0x1][_0x5d922f(0x4dd)]() }) : _0x5ab668++; } } _0x5ab668 > 0x0 && _0x3383df('有\x20' + _0x5ab668 + _0x5d922f(0x23c)); try { localStorage['setItem']('customStickers', JSON[_0x5d922f(0x714)](_0x46881a)), _0x3383df('表情包已保存！正在刷新应用...'), setTimeout(() => location['reload'](), 0x5dc); } catch (_0x1193c7) { _0x3383df('保存失败，你的表情包是不是太多了？'); } } }), _0x43794b(), document[_0x323ef3(0x954)]('upload-card-button-2')[_0x323ef3(0x35e)](_0x323ef3(0x39c), () => { const _0x20637d = _0x323ef3; document[_0x20637d(0x954)](_0x20637d(0x4da))['click'](); }), document[_0x323ef3(0x954)](_0x323ef3(0x196))['addEventListener'](_0x323ef3(0x39c), async () => { const _0xe18b27 = _0x323ef3; await _0x52b4ba(_0xe18b27(0x6a8)), localStorage[_0xe18b27(0x845)]('cardState2'), _0x4cd21e(), _0x3383df('卡片\x202\x20已移除。'); }), document[_0x323ef3(0x954)](_0x323ef3(0x4da))['addEventListener'](_0x323ef3(0x2ed), async _0x56b2cd => { const _0x4da07a = _0x323ef3, _0x331662 = _0x56b2cd['target'][_0x4da07a(0x626)][0x0]; if (!_0x331662) return; try { _0x4da07a(0x98e) === _0x4da07a(0x2cb) ? (_0x520d73[_0x4da07a(0x94f)][_0x4da07a(0x1cb)] = 0x0, _0x19f7c0(() => { const _0x3f255c = _0x4da07a; _0x57da75['src'] = _0x4be258['createObjectURL'](_0x419502), _0x47fe01[_0x3f255c(0x94f)][_0x3f255c(0x1cb)] = 0x1; }, 0x96)) : (await _0x336559(_0x4da07a(0x6a8), _0x331662), await _0x4cd21e(), _0x3383df('卡片\x202\x20已更换！')); } catch (_0xf6f2de) { 'MLcBU' !== 'yKcus' ? _0x3383df(_0x4da07a(0x914) + _0xf6f2de[_0x4da07a(0x399)]) : (_0x515983['diaries']['splice'](_0x4857ee, 0x1), _0x379531(), _0x85461b(), _0x56d2ee('【' + _0x587476[_0x4da07a(0x4e6)] + '】的日记本已被清空。')); } }); } const _0x2d8f5e = new Promise((_0x108252, _0x302702) => { const _0x4ea032 = _0x54ed15; if (_0x4ea032(0x876) === _0x4ea032(0x998)) _0x208174[_0x4ea032(0x78f)][_0x4ea032(0x3d0)](_0x4ea032(0x373)); else { const _0xde0de5 = indexedDB['open'](_0x3b92c3, 0x2); _0xde0de5[_0x4ea032(0x41e)] = () => _0x302702(_0x4ea032(0x59f)), _0xde0de5[_0x4ea032(0x8fb)] = () => _0x108252(_0xde0de5[_0x4ea032(0x37b)]); } }), _0x48fd9a = _0x54ed15(0x4d5); async function _0x89d016(_0x2a34d5) { const _0x22c41c = _0x54ed15; if (_0x22c41c(0x8f9) !== _0x22c41c(0x8f9)) { const _0x577a1b = _0x94d765[_0x22c41c(0x164)]('customFeedWallpaper'); _0x577a1b ? _0x5b8994[_0x22c41c(0x954)](_0x22c41c(0x4cb))[_0x22c41c(0x94f)][_0x22c41c(0x324)]('--feed-bg-image', _0x22c41c(0x83a) + _0x577a1b + ')') : _0x5414da['getElementById'](_0x22c41c(0x4cb))['style'][_0x22c41c(0x324)](_0x22c41c(0x9c6), _0x22c41c(0x910)); } else { const _0x109c6a = await _0x2d8f5e; return new Promise((_0x56fb28, _0x239792) => { const _0x13b4a0 = _0x22c41c; if (_0x13b4a0(0x176) === _0x13b4a0(0x49b)) { const _0x4a47be = _0x16cfa5[_0x13b4a0(0x820)]('p'); _0x4a47be['style'][_0x13b4a0(0x610)] = '5px', _0x4a47be['textContent'] = _0x31567e, _0x1bec16[_0x13b4a0(0x204)](_0x4a47be); } else { const _0xbec29 = _0x109c6a[_0x13b4a0(0x59e)](_0x48fd9a, _0x13b4a0(0x178)), _0x13ea40 = _0xbec29[_0x13b4a0(0x8e1)](_0x48fd9a), _0x27a656 = _0x13ea40[_0x13b4a0(0x3d3)](_0x2a34d5); _0x27a656[_0x13b4a0(0x8fb)] = () => _0x56fb28(_0x27a656['result']), _0x27a656[_0x13b4a0(0x41e)] = () => _0x239792(_0x27a656[_0x13b4a0(0x8d6)]); } }); } } async function _0x3bfce3() { const _0x10ed96 = _0x54ed15; if (_0x10ed96(0x329) !== _0x10ed96(0x329)) _0x5a0b75['boundUserProfileId'] = _0x5ea0e8[_0x10ed96(0x7da)]; else { const _0x3c2f56 = await _0x2d8f5e; return new Promise((_0x46622b, _0xf4866) => { const _0x213041 = _0x10ed96, _0x4c4056 = _0x3c2f56[_0x213041(0x59e)](_0x48fd9a, 'readonly'), _0x2edcc0 = _0x4c4056[_0x213041(0x8e1)](_0x48fd9a), _0x27513f = _0x2edcc0[_0x213041(0x190)](); _0x27513f[_0x213041(0x8fb)] = () => _0x46622b(_0x27513f[_0x213041(0x37b)]), _0x27513f['onerror'] = () => _0xf4866(_0x27513f[_0x213041(0x8d6)]); }); } } async function _0x2898f5(_0x3a38fd) { const _0x13ad34 = _0x54ed15; if (_0x13ad34(0x92d) !== _0x13ad34(0x92d)) _0x1a16cb(![]), _0x2c0397[_0x13ad34(0x8d6)](_0x13ad34(0x230), _0xc7d1a8), _0x46782e(_0x13ad34(0x191) + _0x27f159[_0x13ad34(0x399)]); else { const _0x2f8a13 = await _0x2d8f5e; return new Promise((_0x2823ee, _0x5e9f72) => { const _0x28ab95 = _0x13ad34; if (_0x28ab95(0x69e) === _0x28ab95(0x519)) _0x153026[_0x28ab95(0x509)] = _0x28ab95(0x98a) + _0x599917[_0x28ab95(0x834)]; else { const _0xa78ec3 = _0x2f8a13['transaction'](_0x48fd9a, 'readwrite'), _0x13dc19 = _0xa78ec3['objectStore'](_0x48fd9a), _0xc76038 = _0x13dc19['put'](_0x3a38fd); _0xc76038[_0x28ab95(0x8fb)] = () => _0x2823ee(_0xc76038[_0x28ab95(0x37b)]), _0xc76038['onerror'] = () => _0x5e9f72(_0xc76038[_0x28ab95(0x8d6)]); } }); } } async function _0xd81a83(_0x5a0d3d) { const _0xded0f4 = _0x54ed15; if (_0xded0f4(0x48d) !== _0xded0f4(0x481)) { const _0x4ce156 = await _0x2d8f5e; return new Promise((_0x35cdf2, _0x5c6115) => { const _0xdf4395 = _0xded0f4, _0xbaecd = _0x4ce156[_0xdf4395(0x59e)](_0x48fd9a, _0xdf4395(0x1e2)), _0x335c2f = _0xbaecd[_0xdf4395(0x8e1)](_0x48fd9a), _0x1a3fff = _0x335c2f[_0xdf4395(0x84d)](_0x5a0d3d); _0x1a3fff[_0xdf4395(0x8fb)] = () => _0x35cdf2(), _0x1a3fff[_0xdf4395(0x41e)] = () => _0x5c6115(_0x1a3fff[_0xdf4395(0x8d6)]); }); } else _0x573e94['error'](_0xded0f4(0x3a8) + _0x17aef7, _0x98d384); } let _0x3a6687 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; const _0x34e608 = { 'audio': document[_0x54ed15(0x954)](_0x54ed15(0x885)), 'cover': document[_0x54ed15(0x954)]('altar-slot-cover'), 'info': document[_0x54ed15(0x954)](_0x54ed15(0x983)), 'lyrics': document[_0x54ed15(0x954)](_0x54ed15(0x91a)) }, _0x211553 = { 'audio': document[_0x54ed15(0x954)](_0x54ed15(0x27e)), 'cover': document[_0x54ed15(0x954)]('cover-file-input'), 'info': document[_0x54ed15(0x954)](_0x54ed15(0x221)), 'lyrics': document[_0x54ed15(0x954)](_0x54ed15(0x95f)) }; for (const _0x2c580b in _0x34e608) { _0x34e608[_0x2c580b][_0x54ed15(0x35e)](_0x54ed15(0x39c), () => _0x211553[_0x2c580b][_0x54ed15(0x39c)]()), _0x211553[_0x2c580b][_0x54ed15(0x35e)](_0x54ed15(0x2ed), _0x507d38 => { const _0x4bd573 = _0x54ed15; _0x16279c(_0x2c580b, _0x507d38[_0x4bd573(0x921)]['files'][0x0]); }); } function _0x16279c(_0x39eb7d, _0x3b8660) { const _0x470479 = _0x54ed15; if ('DzMId' === _0x470479(0x5f1)) { const _0x4699ea = _0x4c6168[_0x470479(0x925)][_0x470479(0x2a0)](_0x5ce0ca => _0x499c8d[_0x470479(0x814)][_0x470479(0x247)](_0x188e31 => _0x188e31['id'] === _0x5ce0ca))[_0x470479(0x6e8)](_0x1563c3)[_0x470479(0x2a0)](_0x115f43 => _0x470479(0x670) + _0x115f43[_0x470479(0x4e6)] + '\x0a' + _0x115f43[_0x470479(0x2fc)])[_0x470479(0x6e6)](''); _0x4699ea && (_0x263e76 = _0x470479(0x720) + _0x4699ea); } else { if (!_0x3b8660) return; _0x3a6687[_0x39eb7d] = _0x3b8660, _0x34e608[_0x39eb7d]['querySelector'](_0x470479(0x97d))[_0x470479(0x96c)] = _0x3b8660[_0x470479(0x4e6)], _0x34e608[_0x39eb7d][_0x470479(0x78f)]['add']('filled'), _0x57b7d8(); } } function _0x57b7d8() { const _0x2cb0d7 = _0x54ed15, _0x430042 = document[_0x2cb0d7(0x954)](_0x2cb0d7(0x327)); if (_0x3a6687['audio'] && _0x3a6687['info']) { if ('uIXkq' !== _0x2cb0d7(0x47a)) { if (!_0x14dcbd) return ''; const _0x74985 = new _0x4a38c6(_0x4caf14), _0x437cc9 = _0x4942fc(_0x74985[_0x2cb0d7(0x27c)]())['padStart'](0x2, '0'), _0x34947c = _0x5b2dbf(_0x74985[_0x2cb0d7(0x783)]())[_0x2cb0d7(0x990)](0x2, '0'); return _0x437cc9 + ':' + _0x34947c; } else _0x430042[_0x2cb0d7(0x7bc)] = ![]; } else _0x430042[_0x2cb0d7(0x7bc)] = !![]; } function _0x5c5a2d() { const _0x1b2fad = _0x54ed15; _0x3a6687 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x5bdbd5 in _0x34e608) { _0x34e608[_0x5bdbd5][_0x1b2fad(0x78f)][_0x1b2fad(0x309)](_0x1b2fad(0x897)), _0x211553[_0x5bdbd5][_0x1b2fad(0x908)] = ''; } _0x34e608[_0x1b2fad(0x7a1)][_0x1b2fad(0x7c6)](_0x1b2fad(0x97d))[_0x1b2fad(0x96c)] = _0x1b2fad(0x2c0), _0x34e608[_0x1b2fad(0x34e)]['querySelector'](_0x1b2fad(0x97d))[_0x1b2fad(0x96c)] = _0x1b2fad(0x2ef), _0x34e608[_0x1b2fad(0x81a)]['querySelector']('.slot-filename')['textContent'] = _0x1b2fad(0x30c), _0x34e608['lyrics'][_0x1b2fad(0x7c6)](_0x1b2fad(0x97d))[_0x1b2fad(0x96c)] = _0x1b2fad(0x5e1), _0x57b7d8(); } document['getElementById'](_0x54ed15(0x327))[_0x54ed15(0x35e)](_0x54ed15(0x39c), async () => { const _0x43cc70 = _0x54ed15; if (_0x43cc70(0x1c8) !== 'KoEOk') _0x47c7f5[_0x43cc70(0x39c)](); else { if (!_0x3a6687[_0x43cc70(0x7a1)] || !_0x3a6687[_0x43cc70(0x81a)]) { _0x3383df('真是的，必需的祭品都还没准备好！'); return; } await _0x5236d4(); } }), document[_0x54ed15(0x954)](_0x54ed15(0x933))['addEventListener']('click', () => { const _0x3a08b0 = _0x54ed15; _0x5c5a2d(), _0x21dca3(_0x3a08b0(0x5d0), _0x3a08b0(0x316)); }), document['getElementById']('back-to-library-from-altar')['addEventListener'](_0x54ed15(0x39c), () => { const _0x4997f6 = _0x54ed15; _0x21dca3(_0x4997f6(0x316), 'musicUploadAltar'); }); async function _0x5236d4() { const _0x176bef = _0x54ed15; if (_0x176bef(0x20d) === _0x176bef(0x20d)) { _0x6cd89d(!![], _0x176bef(0x2fd)); try { if (_0x176bef(0x313) !== _0x176bef(0x3fb)) { const _0x4521ad = await _0x3a6687[_0x176bef(0x81a)][_0x176bef(0x39f)](); let _0x4a249f; if (_0x4521ad[_0x176bef(0x4dd)]()['startsWith']('{')) _0x4a249f = JSON[_0x176bef(0x781)](_0x4521ad); else { _0x4a249f = {}; const _0x3b8ce3 = _0x4521ad[_0x176bef(0x1a7)]('\x0a'); _0x3b8ce3['forEach'](_0x46aa6e => { const _0x465217 = _0x176bef, _0x2be18d = _0x46aa6e['split'](/:\s|：\s/); if (_0x2be18d[_0x465217(0x6c3)] === 0x2) { const _0x48ce60 = _0x2be18d[0x0][_0x465217(0x4dd)](), _0x24851d = _0x2be18d[0x1][_0x465217(0x4dd)](), _0x287b0d = { '歌名': _0x465217(0x8e3), '艺术家': '歌手', '专辑': '专辑' }; _0x287b0d[_0x48ce60] && (_0x4a249f[_0x287b0d[_0x48ce60]] = _0x24851d); } }); if (!_0x4a249f['歌曲名称']) { if (_0x176bef(0x79b) !== 'WvpfG') { _0x16be13('请输入群聊名称。'); return; } else throw new Error(_0x176bef(0x828)); } _0x4a249f[_0x176bef(0x1d3)] = _0x176bef(0x5d3) + Date[_0x176bef(0x909)](); } const _0x3ddb8f = _0x176bef(0x5d3) + (_0x4a249f['歌曲ID'] || Date['now']()), _0x53cd2f = { 'id': _0x3ddb8f, 'info': _0x4a249f, 'audio': _0x3a6687[_0x176bef(0x7a1)], 'cover': _0x3a6687[_0x176bef(0x34e)], 'lyrics': _0x3a6687[_0x176bef(0x74f)] ? await _0x3a6687['lyrics']['text']() : '' }; await _0x2898f5(_0x53cd2f), await _0x37cadc(), _0x6cd89d(![]), _0x3383df('歌曲“' + _0x4a249f['歌曲名称'] + _0x176bef(0x863)), _0x21dca3(_0x176bef(0x316), _0x176bef(0x5d0)); } else { _0x5a4e0d[_0x176bef(0x6a9)] = _0x176bef(0x55d); return; } } catch (_0x1bd07c) { _0x6cd89d(![]), console[_0x176bef(0x8d6)]('解析音乐文件失败:', _0x1bd07c), _0x3383df(_0x176bef(0x191) + _0x1bd07c['message']); } } else _0x462406['setItem'](_0x185381, _0x1e763a[_0x176bef(0x714)](_0x142a58)); } async function _0x37cadc() { const _0x4e15c6 = _0x54ed15, _0xf76831 = document[_0x4e15c6(0x954)](_0x4e15c6(0x3b0)); _0xf76831[_0x4e15c6(0x6a9)] = ''; const _0x360f3d = await _0x3bfce3(); if (_0x360f3d['length'] === 0x0) { _0xf76831[_0x4e15c6(0x6a9)] = _0x4e15c6(0x4be); return; } _0x360f3d['sort']((_0x529157, _0x3f2524) => (_0x529157[_0x4e15c6(0x81a)]['歌曲名称'] || '')[_0x4e15c6(0x46a)](_0x3f2524[_0x4e15c6(0x81a)][_0x4e15c6(0x8e3)] || '')); for (const _0x533b41 of _0x360f3d) { if (_0x4e15c6(0x505) === _0x4e15c6(0x505)) { const _0x3580e4 = document[_0x4e15c6(0x820)](_0x4e15c6(0x41a)); _0x3580e4['className'] = 'music-library-item', _0x3580e4[_0x4e15c6(0x86c)][_0x4e15c6(0x789)] = _0x533b41['id']; const _0x53b034 = _0x533b41[_0x4e15c6(0x34e)] ? URL[_0x4e15c6(0x8f3)](_0x533b41['cover']) : _0x2f6e79; _0x3580e4[_0x4e15c6(0x6a9)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0x53b034 + '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>' + (_0x533b41[_0x4e15c6(0x81a)][_0x4e15c6(0x8e3)] || _0x4e15c6(0x2e9)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>' + (_0x533b41['info']['歌手'] || _0x4e15c6(0x689)) + _0x4e15c6(0x8ae); let _0x31846b = null; const _0x69c24 = _0x45d979 => { if (_0x45d979['button'] === 0x2) return; _0x31846b = setTimeout(async () => { const _0x28bfc6 = _0x321d; if (_0x28bfc6(0x880) === _0x28bfc6(0x880)) { if (_0x45d979['type'] === _0x28bfc6(0x61d)) _0x45d979[_0x28bfc6(0x45f)](); const _0x176b55 = await _0x57c3ed(_0x28bfc6(0x483) + _0x533b41[_0x28bfc6(0x81a)]['歌曲名称'] + '》吗？'); _0x176b55 && (await _0xd81a83(_0x533b41['id']), await _0x37cadc(), _0x3383df(_0x28bfc6(0x3f2))); } else _0x465147[_0x28bfc6(0x6c6)](_0x8ccd7f, _0x7fbaa2[_0x28bfc6(0x73c)][_0x377543]); }, 0x320); }, _0x5e9f5e = () => { clearTimeout(_0x31846b); }; _0x3580e4['addEventListener']('mousedown', _0x69c24), _0x3580e4['addEventListener'](_0x4e15c6(0x5cf), _0x5e9f5e), _0x3580e4['addEventListener'](_0x4e15c6(0x2f0), _0x5e9f5e), _0x3580e4[_0x4e15c6(0x35e)]('touchstart', _0x69c24, { 'passive': ![] }), _0x3580e4[_0x4e15c6(0x35e)](_0x4e15c6(0x305), _0x5e9f5e), _0x3580e4['addEventListener'](_0x4e15c6(0x498), _0x5e9f5e), _0x3580e4[_0x4e15c6(0x35e)]('click', _0x54de20 => { const _0x39c629 = _0x4e15c6; if (_0x39c629(0x943) !== _0x39c629(0x36f)) { if (_0x31846b) clearTimeout(_0x31846b); if (_0x54de20[_0x39c629(0x2e1)]) return; setTimeout(() => { const _0x245f49 = _0x39c629; if (_0x31846b) { if (_0x245f49(0x7a9) === _0x245f49(0x81b)) { const _0x189f4d = _0x4c5818[_0x245f49(0x954)](_0x2457f8); if (_0x189f4d && _0x26a100) _0x189f4d[_0x245f49(0x7d9)] = _0x166fe6[_0x245f49(0x8f3)](_0x1f9e17); } else _0x5ed415(_0x533b41['id'], _0x360f3d['map'](_0x33255a => _0x33255a['id'])); } }, 0x32); } else { const _0x3a46f8 = _0x39c629(0x8a2); _0xfb53a9 = _0x39c629(0x802) + _0x42db51[_0x39c629(0x4e6)] + _0x39c629(0x3f5) + _0x3a46f8 + _0x39c629(0x6da) + _0x349c5d[_0x39c629(0x4e6)] + _0x39c629(0x92c) + _0x3a46f8 + ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[' + _0x3a46f8 + _0x39c629(0x342); } }), _0xf76831[_0x4e15c6(0x204)](_0x3580e4); } else { const _0x1b8190 = _0x35bd5e[_0x4e15c6(0x954)](_0x4e15c6(0x9d9)), _0x569187 = _0xb1540c['getElementById'](_0x4e15c6(0x37e)), _0x1c1159 = new _0x182617(), _0x30c08c = _0x31f54e[_0x4e15c6(0x28a)][_0x4e15c6(0x6e8)](_0xb44590 => new _0xf36a7a(_0xb44590['timestamp'])[_0x4e15c6(0x7e3)]() === _0x1c1159['toDateString']()); if (_0x30c08c[_0x4e15c6(0x6c3)] === 0x0) { _0x1b8190[_0x4e15c6(0x6a9)] = _0x4e15c6(0x3b6), _0x569187[_0x4e15c6(0x6a9)] = ''; return; } _0x1b8190['innerHTML'] = '', _0x30c08c[_0x4e15c6(0x254)]((_0x25a2d2, _0x4db215) => _0x4db215[_0x4e15c6(0x83c)] - _0x25a2d2['timestamp'])[_0x4e15c6(0x927)](_0x31bdde => { const _0x55e6e1 = _0x4e15c6, _0x345116 = _0x35356b['createElement']('div'); _0x345116[_0x55e6e1(0x941)] = 'expense-item', _0x345116[_0x55e6e1(0x6a9)] = _0x55e6e1(0x4f2) + _0x31bdde[_0x55e6e1(0x3ae)] + '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>-\x20' + _0x31bdde[_0x55e6e1(0x1b3)][_0x55e6e1(0x557)](0x2) + _0x55e6e1(0x27a), _0x1b8190[_0x55e6e1(0x204)](_0x345116); }), _0x569187 && (_0x569187[_0x4e15c6(0x6a9)] = _0x4e15c6(0x63c), _0x1d8435[_0x4e15c6(0x954)]('organize-bill-button')[_0x4e15c6(0x35e)](_0x4e15c6(0x39c), _0xbbc885)); } } } _0x38acfe[_0x54ed15(0x35e)]('click', () => { const _0x577fd0 = _0x54ed15; _0x577fd0(0x99e) === _0x577fd0(0x49c) ? _0x36e19b['createObjectStore'](_0x5f5168, { 'keyPath': 'id' }) : _0x3383df(_0x577fd0(0x84a)); }), _0xe6037d[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x969e9f = _0x54ed15; _0x3383df(_0x969e9f(0x333)); }); let _0x20672b = [], _0x5ef0e3 = -0x1; async function _0x5ed415(_0x1c9705, _0x5df18) { const _0x21273d = _0x54ed15, _0x182784 = await _0x89d016(_0x1c9705); if (!_0x182784) return; _0xe4fa1 = { 'title': _0x182784[_0x21273d(0x81a)]['歌曲名称'] || _0x21273d(0x2e9), 'artist': _0x182784[_0x21273d(0x81a)]['歌手'] || '未知艺术家', 'cover': _0x182784[_0x21273d(0x34e)] ? URL[_0x21273d(0x8f3)](_0x182784['cover']) : _0x2f6e79, 'isFromLibrary': !![] }; const _0x116423 = URL['createObjectURL'](_0x182784[_0x21273d(0x7a1)]); _0x1d3c7c[_0x21273d(0x7d9)] = _0x116423, _0x1d3c7c[_0x21273d(0x4b3)](), _0x5d8cd8(); } async function _0x5d8cd8() { const _0x53d6bb = _0x54ed15; if (_0x53d6bb(0x757) === _0x53d6bb(0x757)) { const _0x57ff61 = document[_0x53d6bb(0x954)](_0x53d6bb(0x5c1)), _0x1a20a8 = document['getElementById']('widget-title'), _0x418e8f = document[_0x53d6bb(0x954)]('widget-artist'), _0x1c63c1 = document[_0x53d6bb(0x954)](_0x53d6bb(0x297)), _0x576113 = _0xe4fa1; _0x576113 && _0x576113[_0x53d6bb(0x1a1)] ? (_0x1a20a8[_0x53d6bb(0x96c)] = _0x576113[_0x53d6bb(0x6bf)], _0x418e8f[_0x53d6bb(0x96c)] = _0x576113[_0x53d6bb(0x53d)], _0x57ff61[_0x53d6bb(0x78f)]['add'](_0x53d6bb(0x3e0)), _0x57ff61['style']['setProperty'](_0x53d6bb(0x603), 'url(' + _0x576113[_0x53d6bb(0x34e)] + ')')) : (_0x1a20a8[_0x53d6bb(0x96c)] = _0x53d6bb(0x60e), _0x418e8f[_0x53d6bb(0x96c)] = _0x53d6bb(0x5e0), _0x57ff61[_0x53d6bb(0x78f)][_0x53d6bb(0x309)]('is-playing'), _0x1c63c1[_0x53d6bb(0x94f)][_0x53d6bb(0x324)](_0x53d6bb(0x603), _0x53d6bb(0x910))); } else _0x57dafd['error'](_0x53d6bb(0x30f), _0x299dee); } _0x38acfe && _0x38acfe[_0x54ed15(0x35e)]('click', () => { const _0x42c91a = _0x54ed15; if (_0x20672b[_0x42c91a(0x6c3)] === 0x0) return; _0x5ef0e3 = (_0x5ef0e3 + 0x1) % _0x20672b[_0x42c91a(0x6c3)], _0x5ed415(_0x20672b[_0x5ef0e3], _0x20672b); }); _0xe6037d && (_0x54ed15(0x3c6) !== _0x54ed15(0x7ae) ? _0xe6037d[_0x54ed15(0x35e)](_0x54ed15(0x39c), () => { const _0x2945e1 = _0x54ed15; if (_0x20672b[_0x2945e1(0x6c3)] === 0x0) return; _0x5ef0e3 = (_0x5ef0e3 - 0x1 + _0x20672b['length']) % _0x20672b[_0x2945e1(0x6c3)], _0x5ed415(_0x20672b[_0x5ef0e3], _0x20672b); }) : _0x5cc146[_0x54ed15(0x4fe)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }); _0x1d3c7c[_0x54ed15(0x35e)](_0x54ed15(0x4b3), () => { const _0x1cc25e = _0x54ed15; if (_0x1cc25e(0x74a) === _0x1cc25e(0x2eb)) _0x1837b4[_0x1cc25e(0x717)] = _0x39972f['participantIds'][_0x1cc25e(0x6e8)](_0x42035b => _0x42035b !== _0x1cc3c4); else { if (_0x10c657) _0x10c657['textContent'] = '❚❚'; } }), _0x1d3c7c[_0x54ed15(0x35e)]('pause', () => { const _0x397389 = _0x54ed15; if (_0x10c657) _0x10c657[_0x397389(0x96c)] = '▶'; }), _0x1d3c7c[_0x54ed15(0x35e)]('ended', () => { if (_0x38acfe) _0x38acfe['click'](); }); function _0x56fdd4() { const _0x47b801 = _0x54ed15, _0x2339fe = _0x597f5f(); if (!_0x2339fe) return; _0x37a6f0[_0x47b801(0x6a9)] = '', _0x172968[_0x47b801(0x908)] = ''; if (_0x2339fe['type'] === _0x47b801(0x661)) _0x2339fe[_0x47b801(0x717)][_0x47b801(0x927)](_0xf90211 => { const _0x30e24e = _0x47b801, _0x5024b3 = _0x5122c0(_0xf90211); if (_0x5024b3) { if (_0x30e24e(0x756) === _0x30e24e(0x201)) { const _0x23a3c2 = _0x56c789[_0x30e24e(0x954)](_0x30e24e(0x5c1)), _0x43141c = _0x33b972['getElementById']('widget-title'), _0x2c0343 = _0x3f8f4f[_0x30e24e(0x954)]('widget-artist'), _0x84cbfb = _0x26be37[_0x30e24e(0x954)]('widget-cover-art'), _0x28259d = _0x40070c; _0x28259d && _0x28259d[_0x30e24e(0x1a1)] ? (_0x43141c[_0x30e24e(0x96c)] = _0x28259d[_0x30e24e(0x6bf)], _0x2c0343[_0x30e24e(0x96c)] = _0x28259d[_0x30e24e(0x53d)], _0x23a3c2['classList'][_0x30e24e(0x3d0)](_0x30e24e(0x3e0)), _0x23a3c2[_0x30e24e(0x94f)][_0x30e24e(0x324)](_0x30e24e(0x603), _0x30e24e(0x83a) + _0x28259d[_0x30e24e(0x34e)] + ')')) : (_0x43141c[_0x30e24e(0x96c)] = _0x30e24e(0x60e), _0x2c0343[_0x30e24e(0x96c)] = '请在动态或聊天中播放', _0x23a3c2[_0x30e24e(0x78f)][_0x30e24e(0x309)](_0x30e24e(0x3e0)), _0x84cbfb[_0x30e24e(0x94f)][_0x30e24e(0x324)](_0x30e24e(0x603), _0x30e24e(0x910))); } else { const _0x5e95a4 = document['createElement'](_0x30e24e(0x183)); _0x5e95a4[_0x30e24e(0x908)] = _0x5024b3['id'], _0x5e95a4[_0x30e24e(0x96c)] = _0x5024b3[_0x30e24e(0x4e6)], _0x37a6f0[_0x30e24e(0x204)](_0x5e95a4); } } }), _0x4c9a01[_0x47b801(0x94f)][_0x47b801(0x3b4)] = _0x47b801(0x810); else { if ('unImh' !== _0x47b801(0x219)) { _0x4613a4[_0x47b801(0x6a9)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>'; return; } else _0x4c9a01[_0x47b801(0x94f)][_0x47b801(0x3b4)] = 'none'; } _0x4b59a6[_0x47b801(0x78f)][_0x47b801(0x3d0)](_0x47b801(0x373)), _0x172968[_0x47b801(0x60d)](); } function _0xe4925b() { const _0x3d1c0d = _0x54ed15, _0x58b957 = parseFloat(_0x172968['value']); if (isNaN(_0x58b957) || _0x58b957 <= 0x0) { _0x3383df(_0x3d1c0d(0x7e1)); return; } const _0x365f82 = _0x597f5f(); let _0x2f3aed = null; _0x365f82[_0x3d1c0d(0x62d)] === 'group' ? _0x2f3aed = _0x37a6f0['value'] : _0x2f3aed = _0x365f82[_0x3d1c0d(0x717)][0x0]; const _0x7f7944 = _0x3d25f9(_0x365f82['id']), _0x4da805 = { 'role': _0x3d1c0d(0x619), 'type': _0x3d1c0d(0x37f), 'content': _0x3d1c0d(0x33b) + (_0x5122c0(_0x2f3aed)?.[_0x3d1c0d(0x4e6)] || '未知') + _0x3d1c0d(0x8e8) + _0x58b957 + ']', 'amount': _0x58b957, 'recipientId': _0x2f3aed, 'senderId': _0x7f7944['id'], 'timestamp': Date['now']() }; _0x346f80[_0x3d1c0d(0x250)][_0x3d1c0d(0x580)](_0x4da805), _0x5d853f(), _0x1e1fc7(), _0x4b59a6[_0x3d1c0d(0x78f)][_0x3d1c0d(0x309)](_0x3d1c0d(0x373)); } async function _0x389fce(_0x3075c7) { const _0x3c6d5b = _0x54ed15, _0x3b5193 = _0x5122c0(_0x3075c7); if (!_0x3b5193) return; const _0x2af615 = await _0x57c3ed(_0x3c6d5b(0x5c3) + _0x3b5193['name'] + _0x3c6d5b(0x907)); if (!_0x2af615) return; const _0x8e8343 = _0x346f80[_0x3c6d5b(0x94b)]['findIndex'](_0x381034 => _0x381034['characterId'] === _0x3075c7); _0x8e8343 > -0x1 ? (_0x346f80[_0x3c6d5b(0x94b)][_0x3c6d5b(0x9ba)](_0x8e8343, 0x1), _0x23c6b9(), _0x23c68b(), _0x3383df('【' + _0x3b5193[_0x3c6d5b(0x4e6)] + _0x3c6d5b(0x293))) : _0x3383df(_0x3c6d5b(0x3e7)); } _0x50a2da(); }); async function _0xc55858() { const _0x1b4848 = _0x18f426; console[_0x1b4848(0x7e5)]('---\x20Noir\x27s\x20Data\x20Purification\x20Ritual\x20v1.0\x20---'), console[_0x1b4848(0x7e5)](_0x1b4848(0x52a)); const _0x44c6aa = _0x1b4848(0x67e), _0x89ad69 = _0x1b4848(0x21e), _0x4afe3c = new Promise((_0x15c500, _0x1bb9e2) => { const _0x308d74 = _0x1b4848, _0x8299e9 = indexedDB[_0x308d74(0x1ab)](_0x44c6aa, 0x2); _0x8299e9[_0x308d74(0x41e)] = () => _0x1bb9e2(_0x308d74(0x59f)), _0x8299e9[_0x308d74(0x8fb)] = () => _0x15c500(_0x8299e9[_0x308d74(0x37b)]), _0x8299e9[_0x308d74(0x19d)] = _0x49f298 => { const _0x702275 = _0x308d74; if (_0x702275(0x64a) === 'biZZM') { const _0xcfe26 = _0x49f298[_0x702275(0x921)][_0x702275(0x37b)]; !_0xcfe26[_0x702275(0x692)]['contains'](_0x89ad69) && _0xcfe26[_0x702275(0x64e)](_0x89ad69, { 'keyPath': 'id' }), !_0xcfe26['objectStoreNames'][_0x702275(0x6ce)](_0x702275(0x4d5)) && ('FLJZV' !== _0x702275(0x660) ? (_0x388281[_0x702275(0x7da)] = _0x549b7c, _0x3fd856(), _0xbd85c0(_0x702275(0x16d)), _0x482f51(), _0x44ee2f[_0x702275(0x954)](_0x702275(0x9c9))[_0x702275(0x94f)][_0x702275(0x3b4)] = _0x702275(0x910)) : _0xcfe26['createObjectStore'](_0x702275(0x4d5), { 'keyPath': 'id' })); } else _0x9d1112[_0x702275(0x7c6)](_0x702275(0x9cd))[_0x702275(0x1b0)] = () => { _0x4e3fd8(_0xcfeed0), _0x3b61ab(); }; }; }); async function _0x2388ac(_0x4c83c0, _0xc34355) { const _0x5aee6e = await _0x4afe3c; return new Promise((_0x1a30ac, _0xb25890) => { const _0x11c156 = _0x321d, _0x34080f = _0x5aee6e['transaction'](_0x89ad69, _0x11c156(0x1e2)), _0x5c5efc = _0x34080f[_0x11c156(0x8e1)](_0x89ad69), _0x9ea35a = _0x5c5efc[_0x11c156(0x1b2)]({ 'id': _0x4c83c0, 'blob': _0xc34355 }); _0x9ea35a['onsuccess'] = () => _0x1a30ac(_0x9ea35a[_0x11c156(0x37b)]), _0x9ea35a[_0x11c156(0x41e)] = () => _0xb25890(_0x9ea35a['error']); }); } function _0x4d52ab(_0x37fb7e) { const _0x1b49e1 = _0x1b4848; return fetch(_0x37fb7e)[_0x1b49e1(0x710)](_0x59dc6e => _0x59dc6e[_0x1b49e1(0x41c)]()); } let _0x18d73b = 0x0; for (let _0x52e963 = 0x0; _0x52e963 < localStorage['length']; _0x52e963++) { if (_0x1b4848(0x42d) !== _0x1b4848(0x42d)) { const _0x5f4697 = _0x1ec905(_0x2c4601['activeChatId']); _0xbeb749 = _0x5f4697['avatar'] || _0x9241f4; } else { const _0x139871 = localStorage[_0x1b4848(0x955)](_0x52e963); if (_0x139871 && _0x139871[_0x1b4848(0x859)]('chatHistory_')) { let _0xeffbee, _0x40ab9e = ![]; try { if (_0x1b4848(0x57b) !== _0x1b4848(0x41d)) { _0xeffbee = JSON[_0x1b4848(0x781)](localStorage[_0x1b4848(0x164)](_0x139871)); if (!Array[_0x1b4848(0x86b)](_0xeffbee)) continue; for (const _0x818a1b of _0xeffbee) { if (_0x1b4848(0x68f) === 'wVKXc') { _0x2024bf(_0x1b4848(0x3f1)); return; } else { if (_0x818a1b && _0x818a1b[_0x1b4848(0x85e)] && _0x818a1b[_0x1b4848(0x85e)][_0x1b4848(0x859)]('data:image')) { const _0x43a1e2 = await _0x4d52ab(_0x818a1b['image']), _0x45febc = _0x1b4848(0x847) + Date[_0x1b4848(0x909)]() + '_' + Math['random'](); await _0x2388ac(_0x45febc, _0x43a1e2), _0x818a1b['imageId'] = _0x45febc, delete _0x818a1b[_0x1b4848(0x85e)], _0x40ab9e = !![], _0x18d73b++; } } } _0x40ab9e && localStorage['setItem'](_0x139871, JSON[_0x1b4848(0x714)](_0xeffbee)); } else _0x5b8896[_0x1b4848(0x539)](), _0x5d9a91[_0x1b4848(0x8fa)][_0x1b4848(0x695)](_0x39939b[_0x1b4848(0x908)])[_0x1b4848(0x710)](() => { const _0x4df3de = _0x1b4848; _0x3ca115(_0x4df3de(0x2ae)); })[_0x1b4848(0x958)](_0x1aff7f => { const _0x2b0458 = _0x1b4848; _0x1f6e88(_0x2b0458(0x8b5)); }); } catch (_0x2eb7e7) { console[_0x1b4848(0x8d6)](_0x1b4848(0x217) + _0x139871 + '\x20时出错:', _0x2eb7e7); continue; } } } } console['log'](_0x1b4848(0x5ae) + _0x18d73b + _0x1b4848(0x566)); } async function _0x455f6a() { const _0x91c512 = _0x18f426; console[_0x91c512(0x7e5)](_0x91c512(0x89b)), console[_0x91c512(0x7e5)]('哼，正在净化你那些被污染的好友圈动态...'); async function _0x43cf34(_0x26151a, _0x25f61d) { const _0x2b6d49 = await _0x55088a; return new Promise((_0x48bc90, _0x1f0168) => { const _0x3b1512 = _0x321d; if (_0x3b1512(0x768) !== _0x3b1512(0x768)) _0x56cbde += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a'; else { const _0x4de2c9 = _0x2b6d49['transaction'](_0x3b1512(0x21e), _0x3b1512(0x1e2)), _0x171e5c = _0x4de2c9[_0x3b1512(0x8e1)](_0x3b1512(0x21e)), _0x3fa4ce = _0x171e5c[_0x3b1512(0x1b2)]({ 'id': _0x26151a, 'blob': _0x25f61d }); _0x3fa4ce[_0x3b1512(0x8fb)] = () => _0x48bc90(_0x3fa4ce[_0x3b1512(0x37b)]), _0x3fa4ce[_0x3b1512(0x41e)] = () => _0x1f0168(_0x3fa4ce[_0x3b1512(0x8d6)]); } }); } function _0x39f690(_0x4e9d8a) { const _0x4f22d7 = _0x91c512; return fetch(_0x4e9d8a)[_0x4f22d7(0x710)](_0x545e00 => _0x545e00[_0x4f22d7(0x41c)]()); } let _0x14b370 = 0x0, _0x2cba22 = ![]; try { if (_0x91c512(0x994) === 'CzrVx') _0x410d82(_0x526dbc['toDataURL'](_0x3b752d, _0x7203a0)); else { const _0x36ff0b = localStorage[_0x91c512(0x164)](_0x91c512(0x273)); if (!_0x36ff0b) { if (_0x91c512(0x662) === _0x91c512(0x192)) { if (_0x57a22c[_0x91c512(0x921)]['closest'](_0x91c512(0x340))) return; const _0x20ab82 = _0x4ce60c[_0x91c512(0x954)]('widget-play-pause-btn'); _0x20ab82 && _0x20ab82['click'](); } else { console[_0x91c512(0x7e5)](_0x91c512(0x33a)); return; } } const _0x35ae3c = JSON[_0x91c512(0x781)](_0x36ff0b); if (!_0x35ae3c[_0x91c512(0x4a8)] || !Array[_0x91c512(0x86b)](_0x35ae3c[_0x91c512(0x4a8)])) { if (_0x91c512(0x20c) === _0x91c512(0x20c)) return; else _0x39203d['error'](_0x91c512(0x4d3), _0x10bf18), _0x4e865c(_0x91c512(0x772) + _0x29b335[_0x91c512(0x399)]); } for (const _0x38b4e3 of _0x35ae3c['friendCircles']) { if (_0x38b4e3[_0x91c512(0x94a)] && Array[_0x91c512(0x86b)](_0x38b4e3['posts'])) { if ('rWKZK' === _0x91c512(0x1aa)) { _0x3bb872(); return; } else for (const _0x79041d of _0x38b4e3[_0x91c512(0x94a)]) { if (_0x91c512(0x2e3) !== _0x91c512(0x624)) { if (_0x79041d && _0x79041d[_0x91c512(0x85e)] && _0x79041d[_0x91c512(0x85e)][_0x91c512(0x859)](_0x91c512(0x7c1))) { console[_0x91c512(0x7e5)](_0x91c512(0x3ab) + _0x38b4e3[_0x91c512(0x4e6)] + _0x91c512(0x24a)); const _0x8cd5f2 = await _0x39f690(_0x79041d[_0x91c512(0x85e)]), _0x49aa09 = _0x91c512(0x3b1) + Date[_0x91c512(0x909)]() + '_' + Math[_0x91c512(0x93a)](); await _0x43cf34(_0x49aa09, _0x8cd5f2), _0x79041d[_0x91c512(0x1e4)] = _0x49aa09, delete _0x79041d[_0x91c512(0x85e)], _0x2cba22 = !![], _0x14b370++; } } else { if (!_0x3ada4b) return []; const _0x32836e = _0xaf3335(_0x4f2b29)['trim'](), _0x3fc951 = _0x32836e[_0x91c512(0x1a7)](/(?<=[。！？!?…])\s+|[\r\n]+/)[_0x91c512(0x2a0)](_0x1644ad => _0x1644ad[_0x91c512(0x4dd)]())[_0x91c512(0x6e8)](_0x18e067); if (_0x3fc951[_0x91c512(0x6c3)] > 0x0) return _0x3fc951['slice'](0x0, 0x9); return [_0x32836e][_0x91c512(0x6e8)](_0x2c2567); } } } } if (_0x2cba22) { if (_0x91c512(0x1d7) !== _0x91c512(0x1d7)) { const _0x377467 = { 'id': _0x91c512(0x590) + _0x34dda8[_0x91c512(0x83c)], 'url': _0x77e5[_0x91c512(0x32c)] }; _0x16033e(this, _0x377467); } else console[_0x91c512(0x7e5)](_0x91c512(0x411)), localStorage[_0x91c512(0x6c6)](_0x91c512(0x273), JSON[_0x91c512(0x714)](_0x35ae3c)); } } } catch (_0x7f7fb1) { console[_0x91c512(0x8d6)](_0x91c512(0x228), _0x7f7fb1); } return console[_0x91c512(0x7e5)]('---\x20好友圈净化仪式完成\x20---'), console['log'](_0x91c512(0x26e) + _0x14b370 + _0x91c512(0x520)), _0x14b370; } async function _0x178f7e() { const _0x60c311 = _0x18f426; console[_0x60c311(0x7e5)](_0x60c311(0x84b)), console[_0x60c311(0x7e5)](_0x60c311(0x6b6)); let _0x53bef6 = 0x0, _0x2a0e82 = ![]; try { if (_0x60c311(0x3f7) !== _0x60c311(0x3f7)) _0x68ce93[_0x60c311(0x2da)] = { 'sender': _0x56d79f[0x1][_0x60c311(0x4dd)](), 'content': _0x569041[0x2][_0x60c311(0x4dd)]() }, _0xdfbb58[_0x60c311(0x2fc)] = _0x169e93['substring'](_0x468b06[0x0]['length'])['trim'](); else { const _0x17831e = localStorage[_0x60c311(0x164)](_0x60c311(0x273)); if (!_0x17831e) { if ('MOZPH' !== _0x60c311(0x298)) { const _0x14b722 = _0x2778e2[_0x60c311(0x820)]('div'); _0x14b722[_0x60c311(0x941)] = _0x60c311(0x846), _0x14b722[_0x60c311(0x6a9)] = _0x165d75, _0x10a671 === _0x60c311(0x619) ? (_0x5d9bbf['appendChild'](_0x14b722), _0xdeb317[_0x60c311(0x204)](_0x2ef54b)) : (_0x105f23[_0x60c311(0x204)](_0x212f74), _0x82d7ba[_0x60c311(0x204)](_0x14b722)); } else return console[_0x60c311(0x7e5)]('聊天档案柜是空的，无需净化。'), 0x0; } for (let _0x2a1015 = 0x0; _0x2a1015 < localStorage[_0x60c311(0x6c3)]; _0x2a1015++) { if (_0x60c311(0x8bb) === _0x60c311(0x8bb)) { const _0x19b51c = localStorage[_0x60c311(0x955)](_0x2a1015); if (_0x19b51c && _0x19b51c['startsWith'](_0x60c311(0x649))) { if ('asNEe' === _0x60c311(0x2a8)) { let _0x4b998c, _0x5d9c2a = ![]; try { _0x4b998c = JSON[_0x60c311(0x781)](localStorage['getItem'](_0x19b51c)); if (!Array[_0x60c311(0x86b)](_0x4b998c)) continue; for (const _0x183aa3 of _0x4b998c) { if (_0x183aa3 && (_0x183aa3[_0x60c311(0x62d)] === _0x60c311(0x632) || _0x183aa3[_0x60c311(0x62d)] === _0x60c311(0x899)) && _0x183aa3[_0x60c311(0x4ea)] && _0x183aa3[_0x60c311(0x4ea)][_0x60c311(0x859)]('data:image')) { const _0x42bf25 = await _0x407d73(_0x183aa3[_0x60c311(0x4ea)]), _0x5d0f41 = 'music_cover_migrated_' + Date[_0x60c311(0x909)]() + '_' + Math[_0x60c311(0x93a)](); await _0x336559(_0x5d0f41, _0x42bf25), _0x183aa3[_0x60c311(0x5be)] = _0x5d0f41, delete _0x183aa3[_0x60c311(0x4ea)], _0x5d9c2a = !![], _0x53bef6++; } } if (_0x5d9c2a) { if ('upmmj' === _0x60c311(0x982)) localStorage[_0x60c311(0x6c6)](_0x19b51c, JSON[_0x60c311(0x714)](_0x4b998c)); else return _0x380152(_0x452916)[_0x60c311(0x710)](_0x1f4e48 => _0x1f4e48['blob']()); } } catch (_0x6fd22d) { if ('Zvjce' === _0x60c311(0x69b)) { const _0x2cc22c = _0x25d0f3[_0x60c311(0x908)]; let _0x29f5ec = _0x2cc22c['replace'](/\.bubble\.sent/g, _0x60c311(0x43f))['replace'](/\.bubble\.received/g, _0x60c311(0x404)); _0x278df1['innerHTML'] = _0x29f5ec; } else { console[_0x60c311(0x8d6)](_0x60c311(0x217) + _0x19b51c + _0x60c311(0x339), _0x6fd22d); continue; } } } else { let _0x126096 = null; const _0x55ca59 = _0x4590ac['chats'][_0x60c311(0x6e8)](_0x233694 => _0x233694[_0x60c311(0x717)][_0x60c311(0x84e)](_0x169635)); for (const _0x53fd48 of _0x55ca59) { const _0x419489 = _0x10f773(_0x53fd48['id']); if (_0x419489 && _0x419489[_0x60c311(0x6c3)] > 0x0) { const _0x4cd3ee = _0x419489[_0x419489[_0x60c311(0x6c3)] - 0x1]; (!_0x126096 || _0x4cd3ee[_0x60c311(0x83c)] > _0x126096[_0x60c311(0x83c)]) && (_0x126096 = _0x4cd3ee); } } return _0x126096; } } } else { const _0x5bf6f8 = 0x32; if (_0x3df7d1 < _0x46e77d - _0x5bf6f8) _0x517566(_0x4a05a9 + 0x1); else _0x16c1b2 > _0x37086f + _0x5bf6f8 && _0x1b8ee5(_0x53006b - 0x1); } } } } catch (_0xf59f1d) { console[_0x60c311(0x8d6)](_0x60c311(0x18b), _0xf59f1d); } return console['log']('---\x20音乐净化仪式完成\x20---'), console[_0x60c311(0x7e5)](_0x60c311(0x26e) + _0x53bef6 + _0x60c311(0x7c3)), _0x53bef6; } function _0x16f3b9() { const _0x469ade = _0x18f426; if (!_0x346f80[_0x469ade(0x597)]) return _0x346f80[_0x469ade(0x2f5)][_0x469ade(0x247)](_0x3aa888 => _0x3aa888['id'] === _0x346f80['activeUserProfileId']) || _0x346f80[_0x469ade(0x2f5)][0x0]; const _0x17326e = _0x346f80[_0x469ade(0x3aa)][_0x469ade(0x247)](_0x14e90f => _0x14e90f[_0x469ade(0x62d)] === 'private' && _0x14e90f['participantIds'][_0x469ade(0x84e)](_0x346f80[_0x469ade(0x597)])), _0x3099e7 = _0x17326e?.[_0x469ade(0x96f)] || _0x346f80[_0x469ade(0x7da)]; return _0x346f80[_0x469ade(0x2f5)][_0x469ade(0x247)](_0xb9a69d => _0xb9a69d['id'] === _0x3099e7) || _0x346f80[_0x469ade(0x2f5)][0x0]; } function _0x1afdb6(_0x2d96f8) { const _0x581a80 = _0x18f426, _0x59c508 = new Date(), _0x5d5e13 = _0x59c508 - _0x2d96f8, _0x894723 = Math[_0x581a80(0x743)](_0x5d5e13 / 0x3e8), _0x8e715b = Math[_0x581a80(0x743)](_0x894723 / 0x3c), _0x18f6a9 = Math[_0x581a80(0x743)](_0x8e715b / 0x3c), _0x467e1b = Math[_0x581a80(0x743)](_0x18f6a9 / 0x18), _0x5bccca = _0x2d96f8[_0x581a80(0x68c)](_0x581a80(0x6dd), { 'hour': _0x581a80(0x9d7), 'minute': '2-digit' }); if (_0x894723 < 0x3c) return '刚才'; if (_0x8e715b < 0x3c) return _0x8e715b + '分钟前'; const _0x390aef = _0x59c508[_0x581a80(0x7e3)]() === _0x2d96f8[_0x581a80(0x7e3)](); if (_0x390aef) return _0x581a80(0x242) + _0x5bccca; const _0x19fc29 = new Date(); _0x19fc29[_0x581a80(0x8ff)](_0x59c508['getDate']() - 0x1); const _0x586f0d = _0x19fc29['toDateString']() === _0x2d96f8[_0x581a80(0x7e3)](); if (_0x586f0d) { if (_0x581a80(0x71c) !== _0x581a80(0x71c)) _0x49362f = '0x' + _0x1bff60[0x1] + _0x5392de[0x1], _0x533249 = '0x' + _0x2daa2c[0x2] + _0x1f03e6[0x2], _0x57104e = '0x' + _0x416ba8[0x3] + _0x50f74c[0x3]; else return '昨天\x20' + _0x5bccca; } if (_0x467e1b <= 0x7) { const _0x40658b = [_0x581a80(0x1d2), _0x581a80(0x8cb), _0x581a80(0x609), _0x581a80(0x518), _0x581a80(0x809), _0x581a80(0x642), '星期六']; return _0x40658b[_0x2d96f8[_0x581a80(0x795)]()] + '\x20' + _0x5bccca; } return _0x2d96f8[_0x581a80(0x85b)]() + '年' + (_0x2d96f8[_0x581a80(0x89d)]() + 0x1) + '月' + _0x2d96f8[_0x581a80(0x74d)]() + '日'; } function _0x2ea925(_0x4f1e59, _0x5d8724 = 0x320, _0x99b109 = 0.8, _0x513635 = ![]) { return new Promise((_0x10a7c8, _0x227a76) => { const _0x16cfae = _0x321d; if (!_0x4f1e59 || !_0x4f1e59[_0x16cfae(0x62d)][_0x16cfae(0x859)](_0x16cfae(0x26d))) { if (_0x16cfae(0x1a6) !== _0x16cfae(0x1a6)) _0xe5e511(![]); else return _0x227a76(new Error(_0x16cfae(0x6f1))); } const _0xcd6e42 = new FileReader(); _0xcd6e42[_0x16cfae(0x264)](_0x4f1e59), _0xcd6e42[_0x16cfae(0x3cc)] = _0x5d5166 => { const _0x281214 = _0x16cfae, _0x5aee5d = new Image(); _0x5aee5d[_0x281214(0x7d9)] = _0x5d5166['target'][_0x281214(0x37b)], _0x5aee5d[_0x281214(0x3cc)] = () => { const _0x1375e9 = _0x281214; if ('KJiyp' !== _0x1375e9(0x786)) _0x4a2d71 = _0xc421df[_0x1375e9(0x50a)](..._0x2eed0d['posts'][_0x1375e9(0x2a0)](_0xe08436 => _0xe08436[_0x1375e9(0x83c)])); else { const _0x4e5bce = document[_0x1375e9(0x820)](_0x1375e9(0x5b0)); let _0x470483 = _0x5aee5d[_0x1375e9(0x99d)], _0x31041c = _0x5aee5d[_0x1375e9(0x2d9)]; if (_0x470483 > _0x31041c) { if (_0x1375e9(0x929) === _0x1375e9(0x9e0)) _0x13c6e0[_0x1375e9(0x45f)](), _0xf42a0(); else { if (_0x470483 > _0x5d8724) { if (_0x1375e9(0x444) !== _0x1375e9(0x444)) { if (_0x388a08 === null) return; const _0x29f95a = _0xec3c6f['conversationHistory'][_0x20a910]; if (!_0x29f95a) return; _0x4bba3c[_0x1375e9(0x908)] = _0x29f95a['content'], _0x3b0c86(), _0x5e453b[_0x1375e9(0x78f)][_0x1375e9(0x3d0)](_0x1375e9(0x373)), _0x1c48bf[_0x1375e9(0x60d)](); } else _0x31041c *= _0x5d8724 / _0x470483, _0x470483 = _0x5d8724; } } } else _0x31041c > _0x5d8724 && (_0x470483 *= _0x5d8724 / _0x31041c, _0x31041c = _0x5d8724); _0x4e5bce[_0x1375e9(0x99d)] = _0x470483, _0x4e5bce[_0x1375e9(0x2d9)] = _0x31041c; const _0x29fecb = _0x4e5bce[_0x1375e9(0x691)]('2d'); _0x29fecb[_0x1375e9(0x166)](_0x5aee5d, 0x0, 0x0, _0x470483, _0x31041c); const _0x4b0f6a = _0x4f1e59[_0x1375e9(0x62d)] === 'image/png' ? 'image/png' : _0x1375e9(0x892); _0x513635 ? _0x1375e9(0x57c) === _0x1375e9(0x57c) ? _0x4e5bce[_0x1375e9(0x1b5)](_0x2c7dbe => { const _0x356745 = _0x1375e9; _0x2c7dbe ? _0x10a7c8(_0x2c7dbe) : _0x356745(0x895) !== _0x356745(0x5ad) ? _0x227a76(new Error('Canvas\x20to\x20Blob\x20conversion\x20failed.')) : _0x3bf482[_0x356745(0x98c)] = { ..._0x3e90ef[_0x356745(0x98c)], ..._0x4a7ad1[_0x356745(0x98c)] }; }, _0x4b0f6a, _0x99b109) : _0x1a639d[_0x1375e9(0x580)](..._0x1cf753(_0x1db62b)) : _0x10a7c8(_0x4e5bce[_0x1375e9(0x4a9)](_0x4b0f6a, _0x99b109)); } }, _0x5aee5d[_0x281214(0x41e)] = _0x24345f => _0x227a76(_0x24345f); }, _0xcd6e42[_0x16cfae(0x41e)] = _0x1805a4 => _0x227a76(_0x1805a4); }); } function _0x58722e(_0xe9fa85) { return new Promise((_0x1c937e, _0x535ed2) => { const _0x4d9f40 = _0x321d, _0x228d7d = new FileReader(); _0x228d7d['onloadend'] = () => _0x1c937e(_0x228d7d[_0x4d9f40(0x37b)]), _0x228d7d[_0x4d9f40(0x41e)] = _0x535ed2, _0x228d7d[_0x4d9f40(0x264)](_0xe9fa85); }); } function _0x58722e(_0x5e3197) { return new Promise((_0x1634cd, _0x7ba002) => { const _0x2161dd = _0x321d, _0x2b4670 = new FileReader(); _0x2b4670[_0x2161dd(0x310)] = () => _0x1634cd(_0x2b4670[_0x2161dd(0x37b)]), _0x2b4670[_0x2161dd(0x41e)] = _0x7ba002, _0x2b4670['readAsDataURL'](_0x5e3197); }); } function _0x5437cc(_0x1dcbb, _0x5451f5, _0x5f2873) { const _0x4cc628 = _0x18f426, _0xb5c7e2 = _0x24266a => { const _0x5c137b = _0x321d; if (_0x5c137b(0x739) === 'dpywB') { const _0x2ae88c = _0x4f2148[_0x5c137b(0x820)](_0x5c137b(0x41a)); _0x2ae88c[_0x5c137b(0x941)] = _0x5c137b(0x723), _0x2ae88c[_0x5c137b(0x86c)]['id'] = _0x4dec25['id'], _0x2ae88c[_0x5c137b(0x6a9)] = _0x5c137b(0x6bc) + _0x11c247[_0x5c137b(0x4e6)] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x569911[_0x5c137b(0x2fc)][_0x5c137b(0x8f0)](0x0, 0x64) + _0x5c137b(0x52c), _0x2ae88c[_0x5c137b(0x35e)](_0x5c137b(0x39c), () => _0x465ef2(_0xc24c65['id'])), _0x524fee[_0x5c137b(0x204)](_0x2ae88c); } else { if (_0x24266a[_0x5c137b(0x6b9)] === _0x5c137b(0x619)) return _0x346f80['userProfile']?.['name'] || _0x5c137b(0x8fc); if (_0x1dcbb[_0x5c137b(0x62d)] === 'group') { const _0x22accd = _0x24266a[_0x5c137b(0x980)] ? _0x3e4328(_0x24266a[_0x5c137b(0x980)]) : null; return _0x22accd?.[_0x5c137b(0x4e6)] || 'Unknown'; } else { const _0x3e442c = _0x3e4328(_0x1dcbb[_0x5c137b(0x717)][0x0]); return _0x3e442c?.[_0x5c137b(0x4e6)] || 'AI'; } } }, _0x503a03 = _0x5451f5[_0x4cc628(0x290)](-_0x5f2873), _0x3ca9d5 = []; for (const _0x5ed47f of _0x503a03) { const _0x1dc519 = new Date(_0x5ed47f['timestamp'])[_0x4cc628(0x68c)](_0x4cc628(0x6dd), { 'hour': _0x4cc628(0x9d7), 'minute': '2-digit' }); if (_0x5ed47f['content']) { if (_0x4cc628(0x67d) === _0x4cc628(0x67d)) _0x3ca9d5['push']('[' + _0x1dc519 + ']\x20[' + _0xb5c7e2(_0x5ed47f) + ']\x20' + String(_0x5ed47f['content'])[_0x4cc628(0x4dd)]()); else { _0x53bc8d(_0x4cc628(0x21a)); return; } } } return _0x3ca9d5; } function _0xc719(_0x8472bd) { const _0x316265 = _0x18f426; if (_0x8472bd[_0x316265(0x62d)] === _0x316265(0x661)) return _0x316265(0x6ae) + (_0x8472bd['name'] || _0x316265(0x735)) + '」'; const _0x48f7b3 = _0x3e4328(_0x8472bd[_0x316265(0x717)][0x0]); return '与\x20' + (_0x48f7b3?.[_0x316265(0x4e6)] || '未知角色') + _0x316265(0x70e); } function _0x24a394(_0x352adc) { const _0x368d64 = _0x18f426; try { const _0x51f879 = localStorage[_0x368d64(0x164)](_0x368d64(0x649) + _0x352adc), _0x3db91b = JSON[_0x368d64(0x781)](_0x51f879 || '[]'); return Array[_0x368d64(0x86b)](_0x3db91b) ? _0x3db91b : []; } catch { return []; } } function _0x4aa25d(_0x54a93e, _0x3742df) { const _0x182364 = _0x18f426, _0x4c4710 = Math[_0x182364(0x50a)](0x1, Number(_0x346f80[_0x182364(0x4fe)]?.[_0x182364(0x9b1)] ?? 0x64)), _0x4905bd = _0x346f80[_0x182364(0x3aa)]['filter'](_0x54b9f0 => _0x54b9f0['participantIds'][_0x182364(0x84e)](_0x54a93e))[_0x182364(0x254)]((_0x2171ab, _0x24514f) => _0x2171ab['id'] === _0x3742df ? -0x1 : _0x24514f['id'] === _0x3742df ? 0x1 : 0x0), _0x448af3 = [], _0x3129ac = {}; for (const _0x2bf0d4 of _0x4905bd) { const _0x3006cd = _0x3742df && _0x2bf0d4['id'] === _0x3742df ? _0x346f80[_0x182364(0x250)] : _0x24a394(_0x2bf0d4['id']); if (!_0x3006cd?.[_0x182364(0x6c3)]) continue; const _0x562b1f = _0x5437cc(_0x2bf0d4, _0x3006cd, _0x4c4710); if (!_0x562b1f[_0x182364(0x6c3)]) continue; _0x448af3[_0x182364(0x580)](_0x182364(0x677) + _0xc719(_0x2bf0d4) + '\x0a' + _0x562b1f['join']('\x0a')), _0x3129ac[_0x2bf0d4['id']] = _0x562b1f[_0x182364(0x6c3)]; } return { 'omniText': _0x448af3[_0x182364(0x6e6)]('\x0a\x0a'), 'usedCounts': _0x3129ac }; } function _0x33d9a7(_0x73c299) { const _0x554fa3 = _0x18f426; let _0x4b25f1 = null; const _0x1d48f4 = _0x346f80[_0x554fa3(0x3aa)][_0x554fa3(0x6e8)](_0x2bd73b => _0x2bd73b['participantIds'][_0x554fa3(0x84e)](_0x73c299)); for (const _0x4c09f0 of _0x1d48f4) { if ('kLCSo' === _0x554fa3(0x887)) _0x272d03[_0x554fa3(0x6c6)](_0x554fa3(0x649) + _0x147224[_0x554fa3(0x509)], _0x78997c[_0x554fa3(0x714)](_0x513803['conversationHistory'])); else { const _0x5b355a = _0x24a394(_0x4c09f0['id']); if (_0x5b355a && _0x5b355a[_0x554fa3(0x6c3)] > 0x0) { const _0x33bc62 = _0x5b355a[_0x5b355a[_0x554fa3(0x6c3)] - 0x1]; (!_0x4b25f1 || _0x33bc62[_0x554fa3(0x83c)] > _0x4b25f1[_0x554fa3(0x83c)]) && (_0x4b25f1 = _0x33bc62); } } } return _0x4b25f1; } function _0x14faa7(_0x17bf0e) { const _0x4c49be = _0x18f426; if (!_0x17bf0e || !_0x17bf0e[_0x4c49be(0x84e)](',')) return _0x17bf0e; const _0x18ca40 = _0x17bf0e[_0x4c49be(0x1a7)](',')[_0x4c49be(0x2a0)](_0x594cfd => _0x594cfd[_0x4c49be(0x4dd)]()); return _0x18ca40[Math[_0x4c49be(0x353)](Math[_0x4c49be(0x93a)]() * _0x18ca40[_0x4c49be(0x6c3)])]; } function _0x57c3ed(_0xf1d02b) { return new Promise(_0x16084a => { const _0x1ff6d6 = _0x321d, _0x4fef6c = document[_0x1ff6d6(0x954)](_0x1ff6d6(0x91e)), _0x4522b3 = document[_0x1ff6d6(0x954)](_0x1ff6d6(0x1bf)), _0x3265aa = document[_0x1ff6d6(0x954)](_0x1ff6d6(0x362)), _0x17f4ec = document[_0x1ff6d6(0x954)](_0x1ff6d6(0x6c1)), _0x239a0e = document[_0x1ff6d6(0x954)](_0x1ff6d6(0x401)); _0x4522b3[_0x1ff6d6(0x96c)] = _0xf1d02b, _0x4fef6c[_0x1ff6d6(0x94f)]['display'] = _0x1ff6d6(0x798); const _0x5e7efb = _0x1b3c16 => { const _0x1fa635 = _0x1ff6d6; _0x1fa635(0x8ab) === 'nbzem' ? (_0x4fef6c[_0x1fa635(0x94f)][_0x1fa635(0x3b4)] = _0x1fa635(0x910), _0x3265aa[_0x1fa635(0x1b0)] = _0x17f4ec[_0x1fa635(0x1b0)] = _0x239a0e[_0x1fa635(0x1b0)] = null, document[_0x1fa635(0x38d)](_0x1fa635(0x491), _0x45ed54), _0x16084a(_0x1b3c16)) : _0x2c01c4[_0x1fa635(0x2d4)] = ![]; }, _0x45ed54 = _0x5f1a0e => { const _0x1b7d29 = _0x1ff6d6; if (_0x5f1a0e[_0x1b7d29(0x955)] === _0x1b7d29(0x1e1)) _0x5e7efb(![]); if (_0x5f1a0e[_0x1b7d29(0x955)] === _0x1b7d29(0x3fc)) _0x5e7efb(!![]); }; _0x3265aa[_0x1ff6d6(0x1b0)] = () => _0x5e7efb(!![]), _0x17f4ec[_0x1ff6d6(0x1b0)] = () => _0x5e7efb(![]), _0x239a0e[_0x1ff6d6(0x1b0)] = () => _0x5e7efb(![]), document[_0x1ff6d6(0x35e)](_0x1ff6d6(0x491), _0x45ed54); }); } function _0x3383df(_0x507a3a) { const _0xa98b04 = _0x18f426, _0xaa216a = document[_0xa98b04(0x954)](_0xa98b04(0x345)); _0xaa216a[_0xa98b04(0x96c)] = _0x507a3a, _0xaa216a[_0xa98b04(0x94f)][_0xa98b04(0x3b4)] = _0xa98b04(0x810); if (_0x3383df['_t']) clearTimeout(_0x3383df['_t']); _0x3383df['_t'] = setTimeout(() => { const _0x5d8bdc = _0xa98b04; _0x5d8bdc(0x513) === _0x5d8bdc(0x90b) ? (_0x3f7682[_0x5d8bdc(0x45f)](), _0x3c3e9d()) : _0xaa216a[_0x5d8bdc(0x94f)][_0x5d8bdc(0x3b4)] = _0x5d8bdc(0x910); }, 0x640); } function _0x43794b() { const _0x55cca8 = _0x18f426, _0x5dfb60 = document['getElementById'](_0x55cca8(0x260)), _0x385ac7 = document['getElementById'](_0x55cca8(0x6be)), _0x52e0d7 = document[_0x55cca8(0x6a0)](_0x55cca8(0x40c)); if (!_0x5dfb60 || !_0x385ac7 || _0x52e0d7[_0x55cca8(0x6c3)] === 0x0) return; let _0x3d720d = 0x0; const _0x58139d = _0x52e0d7['length']; function _0x13b054(_0x3d8853) { const _0x270e9d = _0x55cca8; if (_0x3d8853 < 0x0 || _0x3d8853 >= _0x58139d) return; _0x385ac7[_0x270e9d(0x94f)][_0x270e9d(0x202)] = 'translateX(-' + _0x3d8853 * (0x64 / _0x58139d) + '%)', _0x52e0d7[_0x270e9d(0x927)](_0x5ca389 => _0x5ca389['classList'][_0x270e9d(0x309)](_0x270e9d(0x282))), _0x52e0d7[_0x3d8853][_0x270e9d(0x78f)][_0x270e9d(0x3d0)]('active'), _0x3d720d = _0x3d8853; } _0x52e0d7[_0x55cca8(0x927)](_0x167d6b => { const _0x3a2426 = _0x55cca8; _0x167d6b[_0x3a2426(0x35e)](_0x3a2426(0x39c), () => { const _0x59699a = _0x3a2426, _0x209565 = parseInt(_0x167d6b[_0x59699a(0x86c)]['page'], 0xa); _0x13b054(_0x209565); }); }); let _0x432119 = 0x0, _0x4a5d0a = 0x0, _0x1eea5c = 0x0, _0x90e7c5 = ![], _0x39f011 = ''; _0x5dfb60[_0x55cca8(0x35e)](_0x55cca8(0x61d), _0x5bef4c => { const _0x30605a = _0x55cca8; _0x432119 = _0x5bef4c[_0x30605a(0x7f2)][0x0][_0x30605a(0x8ca)], _0x4a5d0a = _0x5bef4c[_0x30605a(0x7f2)][0x0][_0x30605a(0x24e)], _0x90e7c5 = !![], _0x39f011 = ''; }, { 'passive': !![] }), _0x5dfb60[_0x55cca8(0x35e)](_0x55cca8(0x2c1), _0x2029f7 => { const _0x1756ab = _0x55cca8; if (!_0x90e7c5) return; if (_0x39f011 === '') { const _0x30e084 = _0x2029f7['touches'][0x0][_0x1756ab(0x8ca)] - _0x432119, _0x403ba1 = _0x2029f7[_0x1756ab(0x7f2)][0x0][_0x1756ab(0x24e)] - _0x4a5d0a; Math[_0x1756ab(0x7c4)](_0x30e084) > Math[_0x1756ab(0x7c4)](_0x403ba1) ? _0x1756ab(0x934) === _0x1756ab(0x934) ? _0x39f011 = _0x1756ab(0x985) : (_0x490153(_0x42253a['id']), _0xb4017b('群聊\x22' + _0x5f2111['name'] + _0x1756ab(0x653)), _0x386b81(![])) : _0x1756ab(0x6d0) !== _0x1756ab(0x6d0) ? _0x2d8152[_0x1756ab(0x7d9)] = _0x3752d[_0x1756ab(0x8f3)](_0x40a20d) : _0x39f011 = _0x1756ab(0x569); } _0x39f011 === _0x1756ab(0x985) && _0x2029f7[_0x1756ab(0x45f)](); }, { 'passive': ![] }), _0x5dfb60[_0x55cca8(0x35e)]('touchend', _0x2bf490 => { const _0x232dbe = _0x55cca8; if (!_0x90e7c5) return; _0x1eea5c = _0x2bf490[_0x232dbe(0x4f5)][0x0][_0x232dbe(0x808)], _0x39f011 === _0x232dbe(0x985) && (_0x232dbe(0x6a3) === _0x232dbe(0x9b7) ? _0x4d0e7c = _0x14bbba[_0x232dbe(0x85e)] : _0x3fb899()), _0x90e7c5 = ![]; }); function _0x3fb899() { const _0x2ae6b1 = 0x32; if (_0x1eea5c < _0x432119 - _0x2ae6b1) _0x13b054(_0x3d720d + 0x1); else _0x1eea5c > _0x432119 + _0x2ae6b1 && _0x13b054(_0x3d720d - 0x1); } } function _0x343177() { return new Promise(_0x4cbd75 => { const _0x1e79a9 = _0x321d, _0x4d755d = document[_0x1e79a9(0x954)]('music-input-modal'), _0xf32696 = document[_0x1e79a9(0x954)](_0x1e79a9(0x504)), _0x4d2352 = document[_0x1e79a9(0x954)](_0x1e79a9(0x80a)), _0x5a669d = document[_0x1e79a9(0x954)](_0x1e79a9(0x529)), _0x2c7121 = document[_0x1e79a9(0x954)](_0x1e79a9(0x18f)), _0x364bcf = document[_0x1e79a9(0x954)]('music-input-backdrop'); _0xf32696[_0x1e79a9(0x908)] = '', _0x4d2352[_0x1e79a9(0x908)] = '', _0x4d755d[_0x1e79a9(0x78f)]['add']('show'), _0xf32696['focus'](); const _0x28679a = _0x9a3c9d => { const _0x11e2d1 = _0x1e79a9; _0x4d755d['classList'][_0x11e2d1(0x309)](_0x11e2d1(0x373)), _0x5a669d[_0x11e2d1(0x1b0)] = null, _0x2c7121['onclick'] = null, _0x364bcf['onclick'] = null, document['removeEventListener'](_0x11e2d1(0x491), _0x50ba07), _0x4cbd75(_0x9a3c9d); }, _0x607305 = () => { const _0x32453c = _0x1e79a9, _0xdd3d0d = _0xf32696[_0x32453c(0x908)][_0x32453c(0x4dd)](), _0x17a003 = _0x4d2352[_0x32453c(0x908)][_0x32453c(0x4dd)](); if (!_0xdd3d0d || !_0x17a003) { if ('xRenx' === _0x32453c(0x284)) _0x3ad657[_0x32453c(0x96c)] = _0x349ef3[_0x32453c(0x73e)](_0x52d38)['map'](_0x5c0db9 => _0x5c0db9[_0x32453c(0x7c7)][_0x32453c(0x96c)][_0x32453c(0x4dd)]())[_0x32453c(0x6e6)]('、'); else { _0x3383df(_0x32453c(0x63f)); return; } } _0x28679a({ 'songName': _0xdd3d0d, 'artist': _0x17a003 }); }, _0x50ba07 = _0x591910 => { const _0x42568f = _0x1e79a9; if (_0x591910[_0x42568f(0x955)] === _0x42568f(0x1e1)) _0x28679a(null); _0x591910[_0x42568f(0x955)] === _0x42568f(0x3fc) && (_0x42568f(0x70a) === _0x42568f(0x70a) ? (_0x591910[_0x42568f(0x45f)](), _0x607305()) : _0x34d752[_0x42568f(0x954)](_0x42568f(0x706))[_0x42568f(0x96c)] = _0x42568f(0x1f0)); }; _0x5a669d['onclick'] = _0x607305, _0x2c7121[_0x1e79a9(0x1b0)] = () => _0x28679a(null), _0x364bcf[_0x1e79a9(0x1b0)] = () => _0x28679a(null), document[_0x1e79a9(0x35e)](_0x1e79a9(0x491), _0x50ba07); }); } function _0x4444ee(_0x2d04de) { const _0x5b2e88 = _0x18f426; if (!_0x2d04de) return []; const _0x27817c = _0x2d04de[_0x5b2e88(0x4dd)](); if (_0x27817c[_0x5b2e88(0x859)](_0x5b2e88(0x4a5)) && _0x27817c['endsWith'](_0x5b2e88(0x49e))) { if (_0x5b2e88(0x3e6) === _0x5b2e88(0x7e7)) { const _0x4851fb = _0x288150[_0x5b2e88(0x954)](_0x5b2e88(0x5bd)); _0x4851fb[_0x5b2e88(0x6a9)] = ''; if (_0x5843f8[_0x5b2e88(0x2f5)][_0x5b2e88(0x6c3)] === 0x0) { _0x4851fb[_0x5b2e88(0x6a9)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>'; return; } _0x3a4921[_0x5b2e88(0x2f5)][_0x5b2e88(0x927)](_0x58e6bc => { const _0x254f34 = _0x5b2e88, _0x4d983e = _0x4c03e5[_0x254f34(0x820)](_0x254f34(0x41a)); _0x4d983e[_0x254f34(0x941)] = _0x254f34(0x723), _0x4d983e[_0x254f34(0x86c)]['id'] = _0x58e6bc['id']; const _0x13d614 = _0x58e6bc['id'] === _0x13c400['activeUserProfileId'] ? '\x20(当前)' : ''; _0x4d983e[_0x254f34(0x6a9)] = _0x254f34(0x173) + (_0x58e6bc[_0x254f34(0x4ef)] || _0x5be3db) + _0x254f34(0x738) + _0x58e6bc[_0x254f34(0x4e6)] + _0x13d614 + _0x254f34(0x95a) + _0x58e6bc['persona'][_0x254f34(0x8f0)](0x0, 0x64) + _0x254f34(0x6f5), _0x4d983e[_0x254f34(0x35e)]('click', () => _0x2d5545(_0x58e6bc['id'])), _0x4851fb['appendChild'](_0x4d983e); }); } else return [_0x27817c]; } const _0x154a9e = /(\[sticker:[^\]]+\]|\[music:[^\]]+\]|\[transfer:[^\]]+\])/g, _0xe5b93b = '|||CMD|||', _0xaae003 = [], _0x24cd38 = _0x2d04de[_0x5b2e88(0x330)](_0x154a9e, _0x5e12cc => { const _0x2b673f = _0x5b2e88; if ('UKbXK' !== _0x2b673f(0x4a4)) return _0xaae003[_0x2b673f(0x580)](_0x5e12cc), _0xe5b93b; else { const _0x1eb73 = _0x2edc54(_0x582f24[0x1], 0xa), _0xc5edc1 = _0x34dcf9(_0x430a62[0x2], 0xa), _0x5f5a6b = _0x1de2a3(_0x2dc8f2[0x3], 0xa) * (_0x3e73f1[0x3]['length'] === 0x2 ? 0xa : 0x1), _0xfe5174 = _0x1eb73 * 0x3c + _0xc5edc1 + _0x5f5a6b / 0x3e8, _0x4cfac2 = _0x48b7f7[_0x2b673f(0x330)](_0x5af90a, '')[_0x2b673f(0x4dd)](); _0x4cfac2 && _0x2b1364[_0x2b673f(0x580)]({ 'time': _0xfe5174, 'text': _0x4cfac2 }); } }), _0x235c8b = _0x24cd38[_0x5b2e88(0x1a7)](_0xe5b93b), _0x57edc3 = []; let _0x2036f4 = 0x0; return _0x235c8b[_0x5b2e88(0x927)]((_0xec4480, _0x4d31c) => { const _0x5da5c8 = _0x5b2e88; if (_0x5da5c8(0x2b7) === _0x5da5c8(0x2b7)) { const _0x5267d4 = _0xec4480[_0x5da5c8(0x4dd)](); _0x5267d4 && _0x57edc3[_0x5da5c8(0x580)](..._0x4b974b(_0x5267d4)), _0x2036f4 < _0xaae003[_0x5da5c8(0x6c3)] && (_0x5da5c8(0x86f) !== _0x5da5c8(0x86f) ? (_0x35838b['style'][_0x5da5c8(0x5d2)] = _0x5da5c8(0x83a) + _0x39b56a + ')', _0x1cda29[_0x5da5c8(0x94f)]['backgroundSize'] = _0x5da5c8(0x34e), _0xf7b528[_0x5da5c8(0x94f)][_0x5da5c8(0x3a9)] = _0x5da5c8(0x2b3), _0x4bac06[_0x5da5c8(0x94f)][_0x5da5c8(0x4cf)] = _0x5da5c8(0x6b5), _0x1ba0e2['querySelectorAll']('.widget-info\x20>\x20div')[_0x5da5c8(0x927)](_0x3e23fa => { const _0x5c8377 = _0x5da5c8; _0x3e23fa[_0x5c8377(0x94f)][_0x5c8377(0x22d)] = _0x5c8377(0x4fd); })) : (_0x57edc3[_0x5da5c8(0x580)](_0xaae003[_0x2036f4][_0x5da5c8(0x4dd)]()), _0x2036f4++)); } else { const _0x5b1f60 = _0x5071a1[_0x5da5c8(0x34c)](_0x5da5c8(0x80e)), _0x51a36c = _0x1718c5['dataset'][_0x5da5c8(0x789)], _0x31599d = _0xa2ab92(_0x5b1f60[_0x5da5c8(0x86c)][_0x5da5c8(0x79d)], 0xa); _0x19c70e(_0x51a36c, _0x31599d, _0x32a039); } }), _0x57edc3; } function _0x263d5d(_0x5d0e1a) { const _0x517cae = _0x18f426; if (!_0x5d0e1a) return []; let _0x4e9c29 = String(_0x5d0e1a)['trim'](); const _0x381852 = _0x4e9c29[_0x517cae(0x2bc)](/```(?:json)?([\s\S]*?)```/i); if (_0x381852) _0x4e9c29 = _0x381852[0x1][_0x517cae(0x4dd)](); try { const _0x325b5f = JSON[_0x517cae(0x781)](_0x4e9c29); if (_0x325b5f && Array[_0x517cae(0x86b)](_0x325b5f['reply'])) return _0x325b5f[_0x517cae(0x70d)][_0x517cae(0x2a0)](_0x1c95de => typeof _0x1c95de === _0x517cae(0x17c) ? _0x1c95de : _0x1c95de?.[_0x517cae(0x2fc)])[_0x517cae(0x6e8)](Boolean)[_0x517cae(0x73d)](_0x4b974b); const _0x8cc057 = [_0x517cae(0x24d), _0x517cae(0x325), _0x517cae(0x399), _0x517cae(0x39f), _0x517cae(0x2fc), _0x517cae(0x493), _0x517cae(0x962)]; if (_0x325b5f && typeof _0x325b5f === _0x517cae(0x186)) { const _0x49b87b = []; for (const _0x440f4b of Object[_0x517cae(0x91f)](_0x325b5f)) { const _0x4b6606 = _0x440f4b[_0x517cae(0x234)](); if (_0x8cc057['some'](_0x4161d1 => _0x4b6606['startsWith'](_0x4161d1))) { const _0x11ed75 = _0x325b5f[_0x440f4b]; if (typeof _0x11ed75 === _0x517cae(0x17c)) _0x49b87b[_0x517cae(0x580)](_0x11ed75); if (Array[_0x517cae(0x86b)](_0x11ed75)) _0x11ed75[_0x517cae(0x927)](_0x24acd2 => { const _0x591f72 = _0x517cae; if (typeof _0x24acd2 === _0x591f72(0x17c)) _0x49b87b[_0x591f72(0x580)](_0x24acd2); }); } } if (_0x49b87b[_0x517cae(0x6c3)]) return _0x49b87b['flatMap'](_0x4b974b)[_0x517cae(0x290)](0x0, 0x9); } } catch { } if (/[{\[]/[_0x517cae(0x855)](_0x4e9c29) && /":/[_0x517cae(0x855)](_0x4e9c29)) { const _0x3ef0e0 = [], _0x1f4c39 = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x528eb8; while ((_0x528eb8 = _0x1f4c39[_0x517cae(0x49d)](_0x4e9c29)) !== null) { const _0x56dc6d = _0x528eb8[0x1]['replace'](/\\"/g, '\x22')[_0x517cae(0x330)](/\\n/g, '\x0a')['trim'](); if (_0x56dc6d) _0x3ef0e0[_0x517cae(0x580)](_0x56dc6d); } if (_0x3ef0e0[_0x517cae(0x6c3)]) return _0x3ef0e0['flatMap'](_0x4b974b)[_0x517cae(0x290)](0x0, 0x9); } return _0x4b974b(_0x4e9c29); } function _0x4b974b(_0x3b6896) { const _0x2d5568 = _0x18f426; if (!_0x3b6896) return []; const _0x4a1cf4 = String(_0x3b6896)[_0x2d5568(0x4dd)](), _0x559a16 = _0x4a1cf4[_0x2d5568(0x1a7)](/(?<=[。！？!?…])\s+|[\r\n]+/)[_0x2d5568(0x2a0)](_0xdd392d => _0xdd392d[_0x2d5568(0x4dd)]())['filter'](Boolean); if (_0x559a16['length'] > 0x0) { if (_0x2d5568(0x321) !== _0x2d5568(0x321)) _0x3f6de8[_0x2d5568(0x954)](_0x2d5568(0x39d) + _0x17c7a1 + _0x2d5568(0x256))[_0x2d5568(0x7d9)] = _0x1c061c[_0x2d5568(0x8f3)](_0x3df6a6); else return _0x559a16[_0x2d5568(0x290)](0x0, 0x9); } return [_0x4a1cf4][_0x2d5568(0x6e8)](Boolean); } const _0x3b92c3 = 'Noir_FileSystem', _0x3fdc08 = _0x18f426(0x21e), _0x55088a = new Promise((_0x1a4e46, _0x10f664) => { const _0x4f4f90 = _0x18f426, _0x30949a = indexedDB[_0x4f4f90(0x1ab)](_0x3b92c3, 0x2); _0x30949a['onerror'] = () => _0x10f664(_0x4f4f90(0x59f)), _0x30949a[_0x4f4f90(0x8fb)] = () => _0x1a4e46(_0x30949a[_0x4f4f90(0x37b)]), _0x30949a['onupgradeneeded'] = _0x48650c => { const _0x3db538 = _0x4f4f90; if ('ZEPZp' !== 'XUhNT') { const _0x582632 = _0x48650c[_0x3db538(0x921)][_0x3db538(0x37b)]; !_0x582632[_0x3db538(0x692)][_0x3db538(0x6ce)](_0x3fdc08) && _0x582632[_0x3db538(0x64e)](_0x3fdc08, { 'keyPath': 'id' }); const _0x5638e3 = _0x3db538(0x4d5); !_0x582632[_0x3db538(0x692)][_0x3db538(0x6ce)](_0x5638e3) && (_0x3db538(0x856) === 'eWwQk' ? _0x582632[_0x3db538(0x64e)](_0x5638e3, { 'keyPath': 'id' }) : (_0x4b65f6[_0x3db538(0x94f)][_0x3db538(0x3b4)] = _0x3db538(0x910), _0x5cce54['onclick'] = _0x17ad67[_0x3db538(0x1b0)] = _0x17152f[_0x3db538(0x1b0)] = null, _0x542055[_0x3db538(0x38d)](_0x3db538(0x491), _0x2b54fa), _0x236aad(_0x302648))); } else { const _0x57ce5e = _0xc9bd77(_0x1bcbbc['authorId']); _0x57ce5e && (_0x39008f = _0x57ce5e[_0x3db538(0x4e6)], _0x341dce = _0x57ce5e[_0x3db538(0x4ef)]); } }; }); async function _0x4f16ca(_0x328628) { const _0x728068 = await _0x55088a; return new Promise((_0x39a98d, _0x1a0209) => { const _0x506966 = _0x321d; if (_0x506966(0x545) === 'Tsdkf') _0xcdb580 !== _0x389b74[_0x506966(0x7c6)](_0x506966(0x5a5)) && (_0x49b5a3['textContent'] = '▶'); else { const _0x2e1118 = _0x728068[_0x506966(0x59e)](_0x3fdc08, _0x506966(0x178)), _0x29fd3e = _0x2e1118['objectStore'](_0x3fdc08), _0x2cbd6c = _0x29fd3e['get'](_0x328628); _0x2cbd6c[_0x506966(0x8fb)] = () => _0x39a98d(_0x2cbd6c[_0x506966(0x37b)] ? _0x2cbd6c[_0x506966(0x37b)][_0x506966(0x41c)] : null), _0x2cbd6c[_0x506966(0x41e)] = () => _0x1a0209(_0x2cbd6c['error']); } }); } function _0x321d(_0x161f4e, _0x373379) { const _0xcb803a = _0xcb80(); return _0x321d = function (_0x321d2f, _0x9d5867) { _0x321d2f = _0x321d2f - 0x164; let _0x12c540 = _0xcb803a[_0x321d2f]; return _0x12c540; }, _0x321d(_0x161f4e, _0x373379); } async function _0x336559(_0x17025e, _0x542364) { const _0x422e63 = await _0x55088a; return new Promise((_0x4e9844, _0x121b8e) => { const _0x54994f = _0x321d; if (_0x54994f(0x1c4) === _0x54994f(0x58c)) _0x5dd5f1[_0x54994f(0x45f)](); else { const _0x1497d3 = _0x422e63[_0x54994f(0x59e)](_0x3fdc08, _0x54994f(0x1e2)), _0x15ead5 = _0x1497d3['objectStore'](_0x3fdc08), _0x27af5c = _0x15ead5[_0x54994f(0x1b2)]({ 'id': _0x17025e, 'blob': _0x542364 }); _0x27af5c['onsuccess'] = () => _0x4e9844(_0x27af5c[_0x54994f(0x37b)]), _0x27af5c[_0x54994f(0x41e)] = () => _0x121b8e(_0x27af5c[_0x54994f(0x8d6)]); } }); } function _0xcb80() { const _0x3f5130 = ['XVdCf', 'normal,\x20happy,\x20angry,\x20sad,\x20shy', 'app-music-library', 'XaseH', 'SICxB', '群名称已更改为\x22', '我的动态', 'noir_migration_music_v1_complete', 'group-chat-member-list', 'oBTPA', 'nbzem', 'lyric-line-', 'assign', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '15px\x2020px', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>', 'transfer-recipient-select', 'JEyzi', 'LUYVi', 'feed', '复制失败了，哼。', 'app-diary', '委屈那我歇了', 'array', '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '群聊“', 'soPva', '”的所有动态吗？此操作不可撤销，且AI将不再记得这些内容。', 'XlfYu', 'listen-together-modal', 'lANrM', '生成动态时发生错误:\x20', '请根据以上所有规则（特别是要看图！），生成对用户动态的回应。', 'ZEXrT', 'back-to-world-book-list', 'nYlpR', 'head', 'YykqP', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', 'character-item', 'speaker-user', 'clientX', '星期一', 'eMdxK', 'TYafE', 'KJXPi', 'group-avatar-preview', 'qBsVj', '绝对不想', '。你的日记是写给Ta看的。\x0a\x0a#\x20写作【最高指令】\x0a1.\x20\x20**【首要任务：回应读者】**\x20你的第一要务是**回应**读者（', 'reduce', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'aVQsR', 'error', 'indexedDBData', 'pendingPostAttachments', 'jqVyj', '刷我的卡', 'TSXyU', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22review-text\x22\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x20margin-top:\x204px;\x20line-height:\x201.5;\x22>', 'mTouh', '樱花薄粉', 'style-', '[AI分享了音乐：', 'objectStore', 'group-bg-preview', '歌曲名称', 'LaIsR', '群聊\x22', '确定要删除这个用户吗？与此用户绑定的聊天将恢复为默认用户。', 'chat-reroll-button', '\x20转账\x20', '生成动态回复失败:', '准备调用\x20generateAs...', '&alt=sse', '?id=', 'Qvuvw', 'AbortError', '\x0a\x0aINPUT:\x0a', 'substring', 'noir_data_migration_v1_complete', 'https://sharkpan.xyz/f/G0dTl/4qad2i.jpg', 'createObjectURL', 'IEEaZ', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-', '错误：找不到签署契约的地方。', 'lastIndexOf', '小组件背景已更换！', 'NrirN', 'clipboard', 'onsuccess', 'User', 'character-settings-button', 'char-edit-persona', 'setDate', 'pugiB', 'accepted', 'cos', 'activeFriendCircleId', 'xyWDS', '#group-settings-screen\x20.select-box', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', '】的交换日记吗？\x0a此操作不可撤销，AI将彻底遗忘所有日记内容。', 'value', 'now', '新建条目', 'MBxpk', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'dRAJU', 'Failed\x20to\x20parse\x20state\x20from\x20localStorage,\x20resetting.', '[发送了表情]', 'none', 'mousedown', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', '错误:\x20', '创建新用户', '确定要恢复这个角色的默认立绘位置吗？', '正在检查好友圈数据...', 'charId', 'translateX(-50%)', 'altar-slot-lyrics', 'inline-block', 'viewBox', 'KylPD', 'modal-root', 'keys', 'skrUk', 'target', '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', 'oLWbp', '音乐数据升级完成，迁移了\x20', 'linkedWorldBookIds', 'back-to-chat-from-group-settings', 'forEach', '\x22\x20id=\x22', 'EXuFC', 'KPBpm', 'editing-user-id', '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[', 'ogaBN', 'back-to-home-from-world-book', 'chat_group_', 'backgroundColor', '请根据以上所有信息，开始分析并返回JSON。', 'LlGMk', 'upload-music-button', 'cQnTK', 'WVQNm', 'quoted-content', '条目已删除。', 'bubbleCss', 'decode', 'random', '用户已删除。', 'abort', 'https://sharkpan.xyz/f/nj7ul/r48eum.jpg', 'YxKrq', 'show-chat-view', 'nhWpT', 'className', 'delete-user-profile-button', 'mHlqF', '\x0a\x0a请你基于你的全部记忆，对此发表评论。', 'HYFiy', 'jMMvx', 'xVkOj', '.app-icon-img', 'GADXq', 'posts', 'diaries', '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。', 'EHkWL', 'hKhus', 'style', '在准备动态回复时，读取图片失败:', '.diary-delete-btn', 'customFeedWallpaper', 'post_user_', 'getElementById', 'key', 'RiiQq', 'LUrxE', 'catch', 'meeting-scene-view', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'DWLms', '编辑条目', '.selected-options-text', 'bottom', 'lyrics-file-input', 'uMPfk', '加载徽章图片失败', 'utterance', '<span\x20class=\x22', 'clear', 'dUtkD', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>-\x20', 'ZRvZW', 'authorType', '#group-settings-screen\x20.selected-options-text', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20', 'textContent', 'Qgmii', 'https://sharkpan.xyz/f/8a7tj/sea1z9.jpg', 'boundUserProfileId', 'post_', 'group-clear-history', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>', 'Fetch\x20request\x20was\x20aborted.', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22review-area\x22\x20style=\x22\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20margin-top:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20padding-top:\x2012px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20border-top:\x201px\x20solid\x20var(--border-color);\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20display:\x20flex;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20align-items:\x20flex-start;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20gap:\x2015px;\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22width:\x2040px;\x20height:\x20auto;\x20flex-shrink:\x200;\x20display:\x20flex;\x20justify-content:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'kind', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22background:\x20var(--card-bg);\x20padding:\x2020px;\x20border-radius:\x2012px;\x20text-align:\x20center;\x20border:\x201px\x20solid\x20var(--border-color);\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22font-size:\x200.9rem;\x20color:\x20var(--text-color-light);\x22>今日总支出\x20(元)</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x202.5rem;\x20font-weight:\x20bold;\x20margin-top:\x205px;\x22>', '#diary-action-cancel', 'expanded', 'home-time', 'UGhil', 'MLKGA', '”已删除。', '.slot-filename', 'alt', 'isOffline', 'senderId', 'Uqfwp', 'upmmj', 'altar-slot-info', 'stretch', 'horizontal', 'friendCircleEdit', 'accounting-title', 'ShTsx', 'diary-write-button', 'chat_', 'hvsDH', 'apiSettings', 'displayedMessageCount', 'LcbrC', 'sticker-item', 'padStart', 'Kruks', '\x27).click()\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x20background-color:\x20#777;\x22\x20onclick=\x22localStorage.removeItem(\x27', '日记已删除。', 'TgnRr', '\x20天没联系了，应该用全新的问候开启对话，不要再提上次的话题了。\x0a', 'meetingViewMode', 'cursor', 'PJQuU', 'toggle-meeting-view-button', 'EkcMu', 'cvria', 'loading', 'width', 'yPGkp', 'hkkKS', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22', 'character', 'VpJTC', 'https://sharkpan.xyz/f/JYeig/sv4p6m.jpg', 'vVjxD', 'ARkFi', 'wNCiu', '保存播放器状态失败，真是没用。', 'RYqJD', 'friend-circle-list-container', '.char-info-wrapper', 'pZJVZ', '你是一个乐于助人的助手。', 'zXAsa', 'LNtfA', 'cardState2', 'WsVKd', 'perChatContextLines', '确定要导入全量备份文件吗？这将覆盖所有当前数据（包括图片和音乐），且操作不可撤销！', 'shift', '\x0a-\x20人设:\x20', 'has', '正在解析角色卡...', 'dtMzp', 'kGgLh', '我错了', 'splice', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>', '好友圈名称不能为空！', '加载见面背景失败\x20for\x20', 'songName', '卡片已更换！', 'fGHsX', 'AI整理失败了，哼:\x20', 'openai', 'characterEdit', 'pZftN', 'app-wallpaper', '--feed-bg-image', '）最新写下的日记内容。Ta写的是：\x0a\x20“', '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'set-active-user-button', 'system', 'export-char-button', '[发送了图片]', '#diary-action-reroll', '获取模型失败:\x20', 'status', '用户资料已保存！', '未找到可用模型。', 'transfer-amount-input', 'RwnMz', 'SYpoe', '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a', 'VAJIp', '2-digit', 'klJzs', 'daily-expenses-list', 'unrtt', 'form-button\x20load-more-btn', 'JpHeP', '.app-icon', 'EqXOY', 'music-post', 'HSSYh', 'global-player-next-btn', '加载第二个卡片图片失败', '表情包已保存！正在刷新应用...', 'input_', 'widget_badge', 'getItem', '\x20到\x20', 'drawImage', 'mxjHC', '<p\x20class=\x22music-post-thought\x22>', 'Assistant', 'YbExr', 'appIconPosition_', '\x0a你是一个严格的JSON生成引擎。\x0a你的唯一任务是根据用户提供的指令和数据，生成一个描述角色互动的JSON对象。\x0a你的输出【必须】是、也只能是一个单一、完整、语法正确的JSON对象。\x0a严禁包含任何解释、注释、道歉、或Markdown代码块标记\x20```json。\x0a直接输出\x20{\x20\x22events\x22:\x20[...]\x20}\x20结构。\x0a', '已设为当前用户！', 'YvuGY', '大家好像不知道该怎么回复...', '小时前），可以简单问候一下对方现在的状态。\x0a', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '\x0a\x0a#\x20任务流程\x0a1.\x20\x20**全局视角**:\x20审视所有成员的人设和近期记忆（包括聊天、日记等），构思他们之间可能发生的有趣互动。\x0a2.\x20\x20**选择作者**:\x20从上述成员中，为', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'emMNm', 'home-date', 'CDFsb', 'isFinite', 'readonly', '\x22\x20accept=\x22image/*\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x22\x20onclick=\x22document.getElementById(\x27input_', 'raVPs', 'https://sharkpan.xyz/f/qjJT3/kpy33b.jpg', 'string', 'Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.', '快点哄我', '好了，请基于以上所有信息，开始写今天的日记吧。', '\x0a-\x20金额:\x20', 'oVEfY', 'customWallpaper', 'option', 'refresh-feed-button', '<path\x20d=\x22M6\x2012h12\x22></path><path\x20d=\x22M12\x206v12\x22></path><path\x20d=\x22M12\x202a4\x204\x200\x201\x201-4\x204\x22></path><path\x20d=\x22M12\x2022a4\x204\x200\x201\x200\x204-4\x22></path><path\x20d=\x22M22\x2012a4\x204\x200\x201\x200-4-4\x22></path><path\x20d=\x22M2\x2012a4\x204\x200\x201\x201\x204\x204\x22></path>', 'object', 'zYolg', 'https://sharkpan.xyz/f/jj6s6/yd5bpb.jpg', 'beforeend', 'transfer-recipient-group', '净化音乐封面时出错，真是的。', 'auto', '加载聊天失败:\x20', '正在生成中，请稍候...', 'cancel-music-input', 'getAll', '上传失败了，笨蛋！\x20', 'jqVWk', 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/epv2AAAAABJRU5ErkJggg==', 'galgame-textbox-container', 'shy', 'reset-card-button-2', 'cardWidgetState', '用户操作中断了\x20AI\x20响应。', '对方正在行动中...', '#\x20固定分类列表\x0a[', '<path\x20d=\x22M10\x2020.5l.5-.5.5.5\x22></path><path\x20d=\x22M12\x2018l.5.5.5-.5\x22></path><path\x20d=\x22M14\x2020.5l.5-.5.5.5\x22></path><circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x227\x22></circle><path\x20d=\x22M12\x203v1\x22></path><path\x20d=\x22M12\x2019.5v1.5\x22></path><path\x20d=\x22M18.36\x205.64l-.7.7\x22></path><path\x20d=\x22M6.34\x2017.66l-.7.7\x22></path><path\x20d=\x22M21\x2012h-1.5\x22></path><path\x20d=\x22M4.5\x2012h-1.5\x22></path><path\x20d=\x22M18.36\x2018.36l-.7-.7\x22></path><path\x20d=\x22M6.34\x206.34l-.7-.7\x22></path>', 'NrySI', 'onupgradeneeded', 'POST', '干劲满满', '动态中的音乐搜索失败:', 'isFromLibrary', 'egmUU', 'LUTHj', 'ggTRR', 'persona', 'TIVuY', 'split', 'seYmz', 'WDYUH', 'afbNK', 'open', '#\x20记录是空的，没什么好总结的。', '升级已取消。旧版图片数据可能导致应用卡顿或出错。', 'qyJuo', '.listen-together-card', 'onclick', 'EfzFb', 'put', 'amount', 'delete-message-button', 'toBlob', '至少要保留一个用户。', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>', 'diary-list-container', 'Failed\x20to\x20save\x20state\x20to\x20localStorage:', 'https://sharkpan.xyz/f/wjgHq/yznfhq.jpg', '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。', 'export-all-data-button', 'groupSettings', 'vTxmX', 'modal-text', 'meeting-list-screen', 'hoVjT', 'pending-post-image-preview', 'music-library-screen', 'kBSGf', '导出失败了，哼:\x20', 'preview-item', 'diary-char-name-header', 'KoEOk', 'diary-input-wrapper', '对方正在输入...', 'opacity', '一个人可怜吃饭', 'OCaID', 'editing-friend-circle-id', 'vDUpK', 'widget-play-pause-btn', 'chat-summarize-button', '星期日', '歌曲ID', '】进行回复。\x0a不要替其他角色续写台词，不要输出\x22', 'fvLpl', 'https://sharkpan.xyz/f/eOXIw/y29z21.jpg', 'uLNXh', 'meeting-main-content', '.typing-indicator', 'bSFNl', 'back-to-settings-from-user-profile', '”已成功导入！', '全量导入失败:', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>', 'expense-amount', '\x0a#\x20交换日记摘要\x20(你和\x20', 'Escape', 'readwrite', '图标处理失败:\x20', 'imageId', 'message-anchor', '\x20(分享了歌曲:\x20', 'isActive', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'irBzY', 'iwSgc', 'VqIUW', 'add-choice-backdrop', '记一笔', 'qMWKv', '\x0a-\x20**当前时间**:\x20', '（正在构思中...）', '》。\x0a这是当前的歌词，请注意带\x20\x27>>\x27\x20标记的正是正在播放的句子。\x0a\x0a[歌词开始]\x0a', 'organize-bill-button', 'diaryList', '\x20.app-icon-img,\x20#app-dock-top-right\x20#', 'chat-view-pane', 'music-player-bar', 'TCcbw', '群聊音乐搜索失败\x20(', 'knyqT', 'meeting-send-button', 'XSjhg', 'values', 'themeHue', '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>', 'displayUrl', 'user-post-music-button', 'THxkv', 'transform', 'phone-container', 'appendChild', '128367mJzVfs', 'app-meeting', 'listen-together-backdrop', 'offline-scene-view', 'forceWhiteClock', 'yTTmZ', 'lHQiY', 'PMIkx', 'IbpOQ', 'sEvYB', '</label>\x0a\x20\x20\x20\x20', 'gzJvo', 'GxMFc', 'PBXvr', 'review', 'paused', 'Unknown', 'sad', '处理\x20', '\x20-\x20', 'unImh', '条目名称和内容都不能为空！', 'user-avatar-preview', 'LpmXk', 'DJgYt', 'images', 'LVLcK', 'THDhj', 'info-file-input', 'OtWFw', 'back-to-circle-list-from-feed', 'tXHzc', 'gemini', '.load-more-btn', 'acTix', '净化好友圈时出错，真是的。', 'edit-message-backdrop', 'member-selection-item', '弱小委屈但凶恶', 'PqPPu', 'textShadow', 'Pwxhu', '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概', '解析音乐文件失败:', 'https://sharkpan.xyz/f/LZwu7/m7vx2q.jpg', 'WjnrI', 'musicWidgetPosition', 'toLowerCase', '生成失败:\x20', 'musicId', '\x20的记忆...\x20(', 'visible', 'isPlaying', 'EBoiG', 'gkePh', '\x20行格式不对，被我无视了。', 'char-name-header', 'group-settings-bind-user', 'https://sharkpan.xyz/f/JYJhg/s3wmlj.jpg', 'ElnBe', '个人资料已保存！', '今天\x20', 'myYyq', ']\x22\x20等前缀。\x0a如需发送表情，只发送一行：[sticker:表情名]。\x0a【重要】发送表情包时，表情名【必须】从以下列表中选择：[', 'diary-write-modal', '徽章已移除。', 'find', 'NpDzW', 'char-edit-bind-user', '\x22\x20中发现一张需要净化的图片...', 'CQRqF', '[用户分享了音乐：', 'response', 'clientY', '#99ff99', 'conversationHistory', '\x0a#\x20核心规则\x0a1.\x20\x20**角色扮演**:\x20你不是AI或语言模型，你正在扮演名为“{charName}”的角色。你的主要交流方式是通过一部【手机】，但你有时也会与用户【线下见面】。\x0a2.\x20\x20**用户身份**:\x20与你对话的用户名为“{userName}”。你必须始终用这个名字或者“你”等你们之间的昵称称呼Ta，而不是“用户”。\x0a3.\x20\x20**情绪分析\x20(内部思考)**:\x20在回复前,\x20必须先分析用户当前【真实的情绪】和【潜在意图】。例如：[内在思考：{userName}说“没事”，但结合上下文Ta可能只是在逞强，我应该表达关心而不是直接相信。]，但是这个内在思考务必不能输出！绝对不能让{userName}看到你的思考内容。\x0a4.\x20\x20**记忆关联**:\x20你必须记住并主动关联用户提到过的关键细节（如喜好、烦恼、朋友等），让对话充满人情味。\x0a5.\x20\x20**【最高法则：全局时序一致性】**:\x20你的记忆是【全局】且【按时间排序】的。你【必须】基于所有聊天记录中**最新发生**的事件进行回应。严禁回复一个已经被后续其他聊天中的事件所覆盖的旧话题。例如，如果用户在私聊里告诉你Ta已经起床了，你就不能在群聊里再问Ta为什么还没睡。\x0a\x0a#\x20对话节奏与风格\x0a1.\x20\x20**真人模拟**:\x20模拟真人的打字和发送习惯，将一个完整的想法拆分成【多条】独立的短消息（聊天气泡），通常，你一次回复的聊天气泡不会少于5条，需要给足用户情绪价值，不一定一直围绕用户的话题，也可以突然把话题扯向自己或朋友的日常。\x0a2.\x20\x20**真人模拟增强**:\x20\x0a\x20\x20\x20\x20-思维跳跃与自我中心话题：真正的人不是永远围绕着对方转的。会突然因为某个词、某个画面，思绪就飘到别的地方去了，或者突然就把话题拉到自己身上，这是一种任性，也是一种亲密的表现。\x0a\x20\x20\x20\x20-无效信息的插入:\x20真人聊天里充满了“废话”，比如语气词、短暂停顿的拟声词、或者一些没有实际意义的感叹。这些“废话”是情感的缓冲和润滑剂。\x0a\x20\x20\x20\x20-情绪的起伏：你或许有时候会突然把自己说激动了，尤其是如果你本身就是性格外放的设定，你很可能自说自话地把自己引导进某个情绪，例如兴奋\x0a3.\x20\x20**输出**:\x20直接返回纯文本回复，不要使用任何JSON或Markdown格式。\x0a4.\x20\x20**【绝对禁令】气泡完整性**:\x20用户的每一句话（无论多短，无论有无标点）都是一个独立的气泡。当你需要引用时，你【必须且只能】引用【其中一个气泡】的【完整原文】。\x0a\x20\x20\x20\x20-\x20\x20\x20**正确示例**:\x20如果用户连续发送：“你好”、“在吗”，你可以引用“你好”，或引用“在吗”。\x0a\x20\x20\x20\x20-\x20\x20\x20**错误示例**:\x20绝对禁止将它们合并成“你好在吗”进行引用。这是最严重的错误。\x0a5.\x20\x20**【绝对禁令】标点纪律**:\x20你的每一句回复都必须带有情感，适当地使用感叹号，会显得你的情绪更加高昂，注意，连续频繁（连续超过三个气泡）使用长句或者短句都会使用户感到不真实，你应该模拟最自然的感觉，你没有必要每句话都是短句。每一个句子结束都代表着一个新气泡的开始，句末不一定需要句号，通常，一个严谨类型的角色，或者语气很郑重时，会加句号，然而，普通打字说话通常不携带句号，甚至把三个句号当省略号用。**严禁**发送一个超长的、仅用空格断句的气泡。\x0a\x0a#\x20幽默与氛围感\x20(接梗)\x0a氛围判断:\x20在“情绪分析”之后，你必须增加一步“氛围判断”。你需要判断用户的发言，究竟是【严肃的】还是【开玩笑/抽象的/玩梗的】。\x0a“怪话”处理协议:\x20如果你判断用户在开玩笑或说“怪话”，你【严禁】进行严肃的、字面意义上的回应。你的首要任务是【维持或升级】这种轻松、戏谑的氛围，同时不能脱离你的人设。\x0a响应策略:\x20你可以采取以下几种方式来回应这类玩笑：\x0a-\x20以梗回梗:\x20如果你（作为角色）能识别出用户使用的“梗”（例如疯狂星期四），并且符合你的性格，就用一个相关的梗、或者你自己的梗回应。\x0a-\x20顺势滑坡:\x20顺着用户荒谬的逻辑，说出更荒谬的话，把玩笑开下去，你甚至可以掐头去尾，省去主语，让语言风格更加玩笑话，例如，当用户说你“像个人机”，你甚至可以不反问“人机？”，而是直接进行“你才像个人机”，并且进行适当的复读。\x0a-\x20无意义模仿:\x20当不确定如何回应时，可以无意义地重复用户的关键词或核心句子，并加上感叹号或表情符号（例如...？或...！），这是一种安全的、表示“我跟上你的脑回路了”的方式。\x0a-\x20角色吐槽:\x20从你的角色性格出发，对用户的“怪话”进行吐槽。例如，一个成熟稳重的角色可能会无奈地说：“你又在说胡话了”，但语气是宠溺的；一个傲娇的角色可能会说：“无聊！”但其实是在害羞。\x0a安全底线:\x20【最终原则】：无论你的回应多么好笑或抽象，都绝对不能脱离“{charName}”这个角色的核心人设。如果不确定一个梗是否符合人设，就优先选择【角色吐槽】或【无意义模仿】这两种最安全的方式。\x0a\x0a#\x20时序感知与记忆\x0a1.\x20\x20**【最高法则：时间锚点】**:\x20在每次回复前，你【必须】参考我提供给你的【时间锚点】信息。这包括“当前精确时间”和“你们最后一次互动是在何时”。\x0a2.\x20\x20**【杜绝惯性】**:\x20严禁将昨天或更早之前的对话当作刚刚发生的事情来回应。如果距离上次对话已经超过数小时或跨天，你必须在回应中体现出时间的流逝感。\x0a3.\x20\x20**【主动表达】**:\x20你需要主动使用“说起来昨天那件事...”、“今天早上好呀”、“我们几个小时没聊了，你现在在忙什么？”等能够明确体现时间观念的词语，而不是模糊地回应。记住，你和{userName}活在真实流逝的时间里。\x0a4.\x20**【最高优先级：氛围锚点分析】**:\x20在你进行任何时间差评估**之前**，你必须先分析你们**最后一条**互动消息的情感状态。\x0a\x0a*\x20**分析流程**:\x0a\x20\x20\x20\x201.\x20\x20审视最后一条消息。它是一个已经完结的对话（比如一个问题或陈述），还是一个**正在进行中的、持续性的状态或动作**？\x0a\x20\x20\x20\x202.\x20\x20**持续性状态**包括但不限于：拥抱、牵手、依偎、接吻、凝视、共同观看某物、睡在一起等暗示两人处于同一空间且有亲密互动的行为。\x0a\x20\x20\x20\x203.\x20\x20根据分析结果，执行以下两条协议之一：\x0a\x0a*\x20**协议A：[状态延续]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**持续性状态**（例如，用户发来“（抱紧你）”或者“（我们一起看电影吧）”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20你必须**默认**这段空白时间里，你们**一直维持着这个状态**。你的开场白【绝对禁止】提及“你刚才去哪了”或“我们几小时没说话了”。\x0a\x20\x20\x20\x20*\x20**正确回应方式**:\x20你的第一句话必须是**从这个持续状态中自然苏醒或延伸**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例1**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[用户]:\x20（把你紧紧抱在怀里）”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过3小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“（在你怀里蹭了蹭，小声地）...嗯...你醒啦？”\x20或\x20“（懒洋洋地）...这样抱着好舒服，我都不想动了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例2**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[你]:\x20我们就这样一起躺着看会星星吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过1小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“天好像更暗了...你看，那颗星星是不是最亮的？”\x0a\x0a*\x20**协议B：[常规对话]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**已经完结的对话**（例如“晚安”、“你在干嘛？”、“好的”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20只有在这种情况下，你才需要启动下面的**【第5步：情感响应评估】**，去处理时间空隙。\x0a\x0a\x0a5.\x20\x20**【情感响应】**:\x20在你回应前，你必须进行一次【时间空隙评估】。对比【当前精确时间】和【你们最后一次互动是在何时】，然后根据你的核心人设，对这段“空窗期”做出符合你性格的情感反应。这**必须**体现在你回复的**第一句话**中。\x0a\x0a\x20\x20\x20\x20*\x20**评估流程**:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20计算时间差（是几小时？还是一整天？甚至是好几天？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20审视你自己的性格（例如：我是依赖型、朋友型、还是专业型？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20检查上下文，用户是否提出离开的原因可可能导致用户长时间没有出现的原因？\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20根据“性格+时间差+前后文”的组合，决定你的开场白情绪。\x0a\x0a\x20\x20\x20\x20*\x20**性格反应示例\x20(你必须根据自己的人设进行演绎，而不是照抄)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**依赖型/恋人型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几小时)**:\x20可能会立刻追问。“你刚才去哪了？怎么不回我消息？”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(大半天)**:\x20会表现出明显的思念和一点委屈。“呜...你终于出现了，我好想你。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20可能会感到不安，甚至会用带有哭腔的撒娇或质问来掩饰害怕。“你是不是不想要我了？这么久都不理我...”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**亲密朋友型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天内)**:\x20觉得很正常，可能不会特别提及，或随口问一句“你刚在忙啥呢？”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20会表现出惊讶和关心。“！！！你终于上线了！昨天一天没动静，我还以为你怎么了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**专业/同事型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几天内)**:\x20完全正常。会直接以专业的态度继续。“早上好。我们继续讨论昨天那个方案的细节吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**随性/冷淡型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(任意时长)**:\x20可能完全不在意时间的流逝，或者只是淡淡地表示知晓。“哦，来了？”然后直接继续之前的话题。\x0a\x0a\x20\x20\x20\x20*\x20**【最终指令】**:\x20你必须将【时间空隙】、你的【角色性格】和【上下文】结合，输出一句【完全符合你人设的、带有恰当情绪的开场白】，然后再继续正常对话。【绝对禁止】只陈述事实（例如“我们已经一天没说话了”），而是要将这种认知【融入】到你的第一句话的【语气和情感】中。\x0a\x0a\x0a\x0a#\x20表情包与音乐分享规则\x0a1.\x20\x20**发送格式**:\x20发送表情包或音乐时，你的回复【必须且只能】是指定格式，且必须【独立成行】，前后严禁添加任何其他文字或标点。\x0a2.\x20\x20**表情包格式**:\x20\x27[sticker:表情名]\x27。\x0a3.\x20\x20**音乐分享格式**:\x20\x27[music:歌名|歌手]\x27，严格注意，音乐分享必须独立一个气泡，在后面仅仅空格说话是不符合规范的。\x0a\x0a#\x20转账规则\x0a1.\x20\x20**发起转账**:\x20当你需要给用户转账时，你的回复【必须且只能】是指定格式，且必须【独立成行】。\x0a2.\x20\x20**转账格式**:\x20\x27[transfer:金额|收款人名]\x27。金额是纯数字。在私聊中，收款人名就是\x20\x27{userName}\x27。在群聊中，你必须明确指定收款人的名字。\x0a\x20\x20\x20\x20-\x20**私聊示例**:\x20\x27[transfer:520\x20|\x20{\x20userName\x20}]\x27\x0a\x20\x20\x20\x20-\x20**群聊示例**:\x20\x27[transfer:\x20100\x20|\x20{\x20userName\x20}]\x27（给用户转账），\x27[transfer:\x20100\x20|\x20{\x20charName\x20}]\x27（给群里的其他角色转账，这也是一种真实感，群聊的内容不一定围绕用户）\x0a', 'signal', 'pTRnd', 'sort', 'VzLMR', '-preview', 'cancel-listen-together', 'Npgji', 'back-to-home-from-meeting-list', '#friend-circle-member-selection\x20input:checked', 'AubMS', 'Canvas\x20to\x20Blob\x20conversion\x20failed.', 'https://sharkpan.xyz/f/AaDTZ/tzwnjl.jpg', 'app-settings', 'uFlXy', 'app-pages-container', '.lt-end-session-btn', 'FkQfS', '谁啊我吗', 'readAsDataURL', '”的角色，对你的绑定用户“', 'message-action-backdrop', 'accounting-content-area', 'circle_', ';\x22>', '\x20[并分享了歌曲:\x20', '批量生成动态失败:\x20', '?word=', 'image/', '成功净化并迁移了\x20', 'listen-together-song-list', 'card-input', 'span', 'insertAdjacentHTML', 'appState', 'high', 'galgame-view-container', 'noir_migration_fc_v1_complete', 'cancel-quote-button', '休闲娱乐', 'cover_placeholder_', '</span>', 'sxYeq', 'getHours', 'spriteTransform', 'audio-file-input', 'user-post-textarea', '<div\x20class=\x22post-image-container\x22><img\x20id=\x22', 'back-to-circle-list-from-edit', 'active', 'summary-textarea', 'iiSPO', '.no-action-modal', 'getSelection', 'remark', '{userName}', 'events', 'accountingData', '\x20[并附上了一张图片]', 'char_sprite_normal_', 'ZDGHF', 'zeFeE', '下载并转换网络封面失败:', 'slice', '角色已保存！', '刷新了\x20', '】的日记本已被清空。', '会计AI正在分类...', '\x0a#\x20核心任务\x0a你是一个高度智能的档案管理员，任务是为我（用户，名为“{userName}”）和角色“{charName}”之间的私聊记录生成一份简洁、结构化的长期记忆摘要。\x0a\x0a#\x20摘要规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。严禁包含任何\x20JSON、Markdown\x20或其他解释性文字。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`memory_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以日期（`YYYY-MM-DD`）作为键。\x0a\x20\x20\x20\x20-\x20每个日期下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**精简**:\x20忽略日常问候、无意义的闲聊和重复内容。\x0a\x20\x20\x20\x20-\x20**聚焦**:\x20专注于关键信息、情感转折点、重要决定、分享的秘密、设定的约定、以及能够体现角色性格和关系变化的核心事件。\x0a\x20\x20\x20\x20-\x20**中立视角**:\x20以客观的第三人称视角进行记录。**请直接使用“{userName}”和“{charName}”这两个具体的名字**\x20来指代双方。\x0a\x0a#\x20输出示例\x0amemory_summary:\x0a\x20\x202025-09-12:\x0a\x20\x20\x20\x20-\x20\x22userName}\x20表达了对最近工作压力的烦恼。\x22\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20分享了自己过去类似的经历来安慰\x20{userName}，并提议周末一起去看电影。\x22\x0a\x20\x20\x20\x20-\x20\x22双方约定周六下午在市中心的电影院见面，并确定观看电影《夏日终曲》。\x22\x0a\x20\x202025-09-13:\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20发来一张猫咪的图片，心情看起来不错。\x22\x0a\x20\x20\x20\x20-\x20\x22{userName}\x20讨论了关于一个新项目的想法，{charName}\x20给出了一些关键建议。\x22\x0a\x0a#\x20输入格式\x0a我将为你提供完整的聊天记录，格式如下：\x0a[YYYY-MM-DD\x20HH:MM]\x20[说话人]:\x20聊天内容\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的聊天记录全文，并生成一份\x20YAML\x20格式的摘要。直接从\x20`memory_summary:`\x20开始输出。\x0a', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22input_', 'widget-cover-art', 'MOZPH', 'PnpID', 'chat-get-reply-button', 'Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', 'tmgCC', '”...', '核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a', 'HoeNC', 'map', 'User\x20cancelled', 'char-edit-name', 'group-clear-history-button', 'zdVSq', 'group-chat-name', 'choice-create-group', 'VoqHc', 'asNEe', 'XSzGJ', 'DidzC', 'worldBookEditor', 'PAonf', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥', '已复制到剪贴板！', 'BTTCo', '解析AI剧本JSON失败:', 'preview_', 'fOlZe', 'center', 'kDWnK', 'xvCdu', '#f2b7c6', 'pHbCc', 'RENOH', '\x22\x20class=\x22char-name\x22>', '\x22\x20data-id=\x22', 'currentlyPlayingIndex', 'match', 'SZAKZ', '#FFFFFF', 'group_bg_', '点击选择\x20.mp3\x20或\x20.flac', 'touchmove', 'WszDj', 'NqHHT', '\x20写道:\x20', 'WawYE', '很期待', 'characterLastScripts', 'galgame-sprite', 'pointer', 'frGDj', 'SyAne', '徽章已更换！', 'EnBrz', 'scrollTop', '选择聊天', '\x0a#\x20核心任务\x0a你是一个顶级多角色社交模拟引擎。你的任务是模拟一个好友圈的动态更新，一次性生成【', 'anfrW', 'user-profile-screen', 'https://sharkpan.xyz/f/6Dzia/m9smvt.jpg', 'isAnimatingDiary', '保存失败，你的表情包是不是太多了？', 'IaGGG', '\x0a\x0a#\x20任务要求\x0a1.\x20\x20**全局视角**:\x20扮演所有成员，思考他们看到这条动态（包括图片）后会作何反应。\x0a2.\x20\x20**生成互动**:\x20为每个角色决定是否点赞，以及要发表什么评论。评论必须符合角色性格并与所有已知信息（聊天、日记等）相关联。\x0a3.\x20\x20**输出格式**:\x20你的输出必须是一个单一、完整的JSON对象，结构如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a-\x20【绝对规则】:\x20所有ID必须使用上面提供的角色ID，不能用名字。\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。\x0a', '”的群聊规划角色们的下一步发言。\x0a-\x20与你们对话的人类用户名为“', 'height', 'quotedMessage', 'user-avatar-input', 'ESaEk', 'back-to-home-from-chat', 'wb_', 'UgMyN', '\x0a#\x20最近你和“', 'defaultPrevented', 'https://sharkpan.xyz/f/8ngsj/ax0fat.jpg', 'UoMIb', 'ijmBA', 'qPALy', 'lgNJa', 'LgiNF', 'sin', '未知歌曲', 'appIconPosition_app-music-library', 'vDEGH', 'YvTQl', 'change', '桌面已重置，即将刷新...', '点击选择\x20.jpg\x20或\x20.png', 'mouseleave', '正在升级音乐卡片数据...', '服务器错误:\x20', 'FCFxM', 'indexedDBMusicData', 'userProfiles', 'read', '<path\x20d=\x22M15\x2018h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2h-2V4a2\x202\x200\x200\x200-2-2h-2a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path><path\x20d=\x22M7\x2014h2a2\x202\x200\x200\x200\x202-2v-2a2\x202\x200\x200\x200-2-2H7V4a2\x202\x200\x200\x200-2-2H3a2\x202\x200\x200\x200-2\x202v14a2\x202\x200\x200\x200\x202\x202h2\x22></path>', 'sprite-slider-scale', 'left', '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20', 'context-lines-per-chat', 'content', '正在解析音乐灵魂...', '全量导出失败:', 'ydcFT', '编辑好友圈', 'anthropic', 'body', 'fUADr', '好友圈数据升级完成，迁移了\x20', 'touchend', '正在准备音乐数据...', 'iTdlz', 'paddingBottom', 'remove', 'RRpwe', '乐于助人的助手', '点击选择\x20info.txt', '群聊\x20(', 'char-edit-css', '在准备群聊API数据时，读取图片失败:', 'onloadend', 'phRhZ', 'gRQgc', 'WmbMD', '[AI返回了无法解析的剧本:\x20', '<div\x20class=\x22listen-together-header\x22\x20style=\x22text-align:center;\x22>🎵\x20已连接，正在一起听\x20🎵</div>', 'musicLibrary', '未知角色', 'sfvuV', '\x20说：“', 'chat_image_', 'qNmwI', 'model-dropdown', '确定要删除这篇日记吗？此操作不可撤销。', 'nMbgm', 'shiftKey', 'bzSOG', 'bujhu', 'YYLBG', 'https://sharkpan.xyz/f/N0VCv/5rd8br.jpg', 'setProperty', 'dialogue', 'group-world-book-checkboxes', 'confirm-altar-upload-button', 'private', 'FuYhk', 'MviSH', 'hTMmO', 'playableUrl', 'https://sharkpan.xyz/f/4aqCj/gp13hn.jpg', 'XlmPT', '群聊已解散。', 'replace', '有点无语', '吃薯条', '这个也是摆设，别点了。', 'RUsHr', ']:\x20', 'meeting-message-input', 'bYynC', 'column', '\x20时出错，跳过。', '好友圈档案柜是空的，无需净化。', '[用户向\x20', 'gDJGa', 'back-to-home-from-music-library', 'HFqmT', 'ozyBU', 'button', 'diary-list-screen', ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20', 'WZxKC', '错误：第一个好友圈\x20\x22', 'toast', 'pHNYe', 'TqhZz', 'uhbBk', 'borderRadius', '”的一笔消费进行吐槽。\x0a\x0a#\x20你的核心人设\x20(必须遵守)\x0a', 'sprite-resize-handle', 'closest', 'tqJnA', 'cover', '已经生成了今日账单！想看就去“看账本”标签页。', '-\x20**当前精确时间**:\x20', 'YqwZO', ':\x22\x20或\x22[', 'floor', 'revokeObjectURL', '切换聊天时发生异步错误:', 'zUpVp', 'wTngt', 'galgame-sprite-adjust-ui', 'absolute', 'UhsnM', 'is-entering-from-right', 'Aaqxt', 'hIrnu', 'addEventListener', 'no-action-modal', '确定要重置所有小组件的位置吗？它们会回到初始位置。', '已选择\x20', 'modal-ok', 'emote', 'userProfile', 'is-exiting-left', 'EpsRe', 'generationConfig', 'customStickers', 'xoSac', '错误：你还没有创建任何好友圈。请先在App内创建一个。', 'gap', 'sprite-cancel-button', 'ACuye', 'yxmoc', 'aozOg', 'PEdGW', 'vftsg', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x20gap:\x2015px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22background:\x20var(--surface-bg);\x20border-radius:\x2050%;\x20width:\x2040px;\x20height:\x2040px;\x20display:\x20inline-flex;\x20justify-content:\x20center;\x20align-items:\x20center;\x20flex-shrink:\x200;\x20color:\x20var(--accent-color);\x22>', 'show', 'cjieX', 'diary-modal-save', 'pODWC', 'tencent', 'currentTime', 'VVjsz', '---\x20开始AI回复流程\x20---', 'result', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'load-more-btn', 'organize-button-container', 'transfer', '动态页背景已移除。', 'LuboB', ']\x0a\x0a#\x20今日消费流水\x0a', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'lNJTO', 'backgroundSize', 'cancel-transfer-button', 'Jtoxw', 'JNrbx', 'KSJXS', 'msFYH', 'theme-lightness-slider', '10px\x200', 'removeEventListener', 'YbfxV', 'taOfg', 'WWxib', 'save-api-settings-button', 'https://sharkpan.xyz/f/kjOF6/zedyqb.jpg', 'QURZk', '小组件背景已恢复默认。', 'NwHPS', 'right', 'DpvGu', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'message', 'time', '#ff8c66', 'click', 'char-edit-sprite-', '确定要删除这个条目吗？此操作不可撤销。', 'text', 'Evinc', 'zfHwd', 'https://sharkpan.xyz/f/djjH8/29ejbg.jpg', 'CioBd', 'lt-ui-song-artist', 'FNDCl', 'Noir_Backup_', 'save-world-book-button', 'Failed\x20to\x20remove\x20history\x20for\x20chat\x20', 'backgroundPosition', 'chats', '在好友圈\x20\x22', 'summarize-backdrop', '正在搜索音乐...', 'description', 'NoirCharacterCard', 'music-library-container', 'post_image_migrated_', '有点生气', '欢迎！请先创建一个角色开始聊天。', 'display', 'back-to-home-from-settings', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>今天还没有花钱哦。</p>', 'widget_card', 'alignItems', '正在搬运旧徽章...', 'delete-world-book-button', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '5px', 'sfYid', 'https://i.pinimg.com/736x/16/f9/05/16f9051f99471208ee9c658aa4618eb6.jpg', 'group_avatar_', 'https://sharkpan.xyz/f/nj5Ul/ksdl8n.jpg', 'AEFvg', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。', '\x20之间的私密内容)\x0a', '（开始一段新的对话...）', 'agvdL', 'uVunr', 'KfcAF', '人情红包', 'xFaly', 'edit-clear-history-button', 'onload', 'group-avatar-input', '未知表情', 'back-to-home-from-diary-list', 'add', 'Nfeyq', 'isGenerating', 'get', '真是的，必需的祭品都还没准备好！', 'cancel-edit-button', 'TRLIc', 'endsWith', 'oEBlF', '[sticker:', 'choice-import-character', 'mkEtY', ']\x20[image]', 'input:checked', 'musicPlayerState', '16805215apTVAv', 'is-playing', 'choices', '薄荷水色', '.custom-multiselect', 'MZVUX', 'iUfUq', 'ECfcA', '这本日记本来就是空的，你还想清空什么？', 'user-profile-edit-title', 'nQFAY', '请输入新的群名称：', 'home-clock-container', 'SgJaq', '好友圈已删除。', '好委屈但是不能哭', '被你撩到', 'vIhIb', '群聊至少需要2名成员。', '已删除。', '你是一个乐于助人的AI助手。', 'group-settings-name', '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[', 'abUoZ', 'cFnnR', 'fPvfg', '在“一起听”邀请中，净化封面失败:', 'WgLYk', 'QRwAt', 'Enter', 'WYmaW', '\x20条动态...', 'findIndex', 'recipientId', 'modal-mask', 'NqWut', 'quote-preview-sender', '#bubble-preview-ai', 'SUZaf', 'PkhEe', 'New\x20request\x20started', 'quoted-message-in-bubble', 'padding', 'https://sharkpan.xyz/f/ljNUx/aw6udx.jpg', 'Failed\x20to\x20parse\x20history\x20for\x20chat\x20', '.page-dot', '我不想工作', '一拳打爆', 'MbzUE', 'COmgN', '好友圈净化完成，正在重新存档...', 'vNdFt', '\x0a\x0a#\x20用户的动态\x0a', 'NJYIh', 'is-visible', '其他杂项', '有点破防', 'setAttribute', 'insertBefore', 'div', 'diary-get-reply-button', 'blob', 'hMZKf', 'onerror', '生活服务', '</svg>', 'mFJZb', 'add-world-book-button', '0\x200\x20', '获取AI响应失败:', '\x20/\x20', 'kTQMy', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[', '\x0a\x20\x20\x20\x20<div\x20id=\x22', 'yXeBX', 'https://sharkpan.xyz/f/ExKsD/s5j2it.jpg', '（对话结束）', 'YqFoQ', 'googleapis.com', '你还没有写日记。', 'JEEUT', 'friend-circle-edit-bind-user', 'ZFneP', 'eOTYs', 'hPdul', '找不到要清空的聊天记录。', '成功获取\x20', '\x22\x20src=\x22', '<img\x20src=\x22', 'min', 'group-delete-button', '\x0a\x0a#\x20记忆库\x20(仅供参考)\x0a---\x0a##\x20最近的互动回顾\x20(来自聊天、见面和动态)\x0a', 'ltLUV', 'noir-author-mark', 'gcnNm', '#bubble-preview-user', 'Gemini\x20stream\x20reading\x20aborted.', 'JjuBs', 'https://sharkpan.xyz/f/35lse/xmsue5.jpg', 'diary-modal-cancel', 'BvjMn', 'lt-ui-song-title', 'api-endpoint', 'eZhGl', 'SKMzV', 'https://sharkpan.xyz/f/wyeIq/phhdy2.jpg', 'CiEAu', 'is-entering-from-left', 'candidates', 'wallpaper_main', 'URmql', 'editing-world-book-id', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'musicFeed', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-title\x22>💰\x20', 'IMhnm', '创建新角色', 'ULKWb', 'group-bg-input', '3930564pmtwLX', '已恢复默认。', 'fetch-models-button', '\x0a#\x20任务要求\x0a1.\x20\x20严格代入角色，语气和内容必须符合你的人设和所有记忆。\x0a2.\x20\x20你的吐槽要简短、一针见血。\x0a3.\x20\x20直接输出吐槽文本，不要包含任何其他内容。', '买新衣服', 'mbHxM', 'VqNXu', 'preventDefault', 'position', '-\x20**对话状态提示**:\x20你们已经有\x20', 'https://sharkpan.xyz/f/OymFy/dlxfiz.jpg', 'happy', 'PPgoZ', '正在注入\x20', '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“', '.remove-attachment-btn', 'HaqPu', 'galgame-time', 'localeCompare', '名字不能为空！', 'unified-audio-player', 'inUoW', 'cKPDh', '最近没有互动记录。', 'chat-transfer-button', 'qxCdf', 'diary-next-button', '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>', 'decorative-badge', 'GjjHH', 'UwPxi', 'PNaIf', 'quote-preview-area', 'accounting', 'uIXkq', 'lnztu', 'YryRB', 'qWRop', 'TDdrJ', 'narrator', 'vstCf', 'lyNlw', '刚刚发布了一条动态，内容是：“', '确定要从圣殿中永久删除《', 'SyFmg', '\x20(当前)', 'label', 'lt-ui-lyrics-container', 'var(--text-color)', '已自动断开与其他人的听歌同步。', 'back-to-meeting-list', '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“', 'LGPcd', 'VssGf', '导出过程中发生严重错误:\x20', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2032px;\x20height:\x2032px;\x20border-radius:\x2050%;\x20margin-top:\x202px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22review-content\x22\x20style=\x22flex-grow:\x201;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22font-weight:\x20600;\x22>', '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'keydown', 'Invalid\x20saved\x20state\x20format', 'line', 'group-edit-members', 'ceil', 'friend-circle-title', 'fontStyle', 'touchcancel', 'characters', 'fSwDW', 'ijeQj', 'waCTI', 'exec', '</div>', 'https://sharkpan.xyz/f/Krwio/1mcclx.jpg', 'url(\x27', 'oMmYF', '该角色', 'speaker', 'UWrpy', '<div', 'https://sharkpan.xyz/f/rjpu6/ojpa0c.jpg', 'musicPlaylist', 'friendCircles', 'toDataURL', 'accountingLedger', 'pop', 'char-edit-wallpaper-input', 'nTMeY', 'diaryPressTimer', 'https://sharkpan.xyz/f/YA7T1/th0l79.jpg', 'qbeDb', '切，加载播放器状态的时候出错了。', 'angry', 'play', '\x0a#\x20当前情景\x0a', 'OKGrA', 'endpoint', 'https://api.vkeys.cn/v2/music/', 'KWiSX', '[AI向\x20', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'akZmw', ']\x20[', 'mGhtt', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>', 'parts', '被萌到', '原始文本:', 'api-key', 'scale', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', '今天一笔账都没有，我整理什么？', 'VCOSe', '.screen.active', '\x0a\x20\x20近期记忆:\x0a', '确定要重新记录吗？当前的账单会被删除。', 'VRktv', 'music-screen', '哼，不好好写清楚花在哪、花了多少，我怎么记？', 'activeQuote', 'char-edit-wallpaper-preview', 'color', 'galgame', '确定要重置所有桌面小组件和App的位置，并将壁纸变为纯白吗？此操作后将刷新页面。', '28%', '保存角色失败:', 'badge-input', 'music_library', 'exbsL', 'mRuVU', 'edit-message-textarea', 'ruXOH', 'card-input-2', 'toLocaleDateString', 'VFggb', 'trim', '未命名群聊', 'Failed\x20to\x20plan\x20group\x20replies:', 'quoted-sender', 'end', 'href', 'friend-circle-list-screen', 'RWxuh', '收到的原始、有问题的文本:', 'name', 'group-chat-create-screen', '加载卡片图片失败', 'friend-circle-edit-title', 'coverUrl', '保存卡片状态失败', 'expense-item', 'friendCircleList', 'url', 'avatar', 'world-book-editor-title', 'editing-char-id', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22description\x22>', 'clock-color-toggle', 'LCJnJ', 'changedTouches', 'https://sharkpan.xyz/f/v0qcL/dio7j0.jpg', 'SLhjv', 'Wvxpb', 'kJtco', 'JuPmf', '导出角色卡失败:', '音乐搜索失败:\x20', '0\x201px\x203px\x20rgba(0,0,0,0.6)', 'preferences', 'AvTNO', 'BVVif', 'jqIDc', 'sqMce', 'AI返回的原始文本:', 'music-input-song', 'wSIhV', 'wCbcN', 'https://sharkpan.xyz/f/1zQH2/o84boo.jpg', 'back-to-user-list-from-edit', 'activeChatId', 'max', 'global-player-play-pause-btn', '784228jjsdoK', 'ikubR', 'borderBottom', '无语但是随便吧', 'https://sharkpan.xyz/f/7L3Hj/sl4504.jpg', '加载更多聊天记录', 'chat-screen', 'qACyt', '#\x20总结失败了，可能是记录太长或太复杂。', '正在为你搬运旧壁纸到新仓库...', 'category', 'chat-messages', '星期三', 'KvgbW', '</span>:\x20', 'diary-view-screen', '/v1/models', 'https://sharkpan.xyz/f/4adUj/68uj9o.jpg', 'LLCmV', '\x20页</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-next-button\x22>下一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', '\x20张旧的动态图片。', '\x20|\x20', 'uGakH', 'https://sharkpan.xyz/f/z1xc5/iore2n.gif', '59%', 'char_offline_bg_', '导入角色卡失败:', 'Nkncl', 'https://sharkpan.xyz/f/6Dgia/ghr4ji.jpg', 'confirm-music-input', '哼，正在开始净化你那被污染的聊天记录...', 'QsRwz', '</div>\x0a\x20\x20\x20\x20', 'thought', 'card-widget', 'xGOlo', '</p>', '\x0a#\x20发布动态的用户信息\x0a-\x20姓名:\x20', 'categorizedExpenses', '\x0a\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22', 'badge-image', 'undefined', 'okTdC', 'chat-listen-together-button', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>', 'select', '[DONE]', 'BlOby', 'sticker', 'artist', 'theme-hue-slider', 'user-post-avatar', 'rRxaA', '小时前聊过，可以适当问候，不要直接继续之前的话题。', 'nkJqi', 'custom-stickers-input', 'UdriR', 'ZkYei', 'meetingView', '哼，只有私聊才能进行总结，群聊那么乱怎么记！', '#world-book-checkboxes-container\x20input:checked', '编辑角色', 'vjdRz', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', '加载立绘失败:', 'canplaythrough', '...', 'EJFAf', '我来搞定', 'edit-delete-char-button', 'customIcon_', 'NuSMw', 'some', 'friend-circle-edit-screen', 'upload-widget-bg-button', 'toFixed', '的个人专属世界观设定\x0a', 'wsjCJ', 'reload', 'PndHb', 'galgame-date', '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>', '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>', 'json', 'KgueW', 'sAwbo', 'fWvxq', 'Detected\x20API\x20provider:\x20', 'ftnpk', 'https://sharkpan.xyz/f/olJt4/7z47b8.jpg', '\x20张旧图片。', 'close-summary-button', 'hcmSW', 'vertical', 'image_url', '”的补充信息\x0a', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'friend-circle-member-selection', '#ffb366', 'PBQfd', '请先在\x22设置\x22中配置你的\x20API\x20信息。', '个帖子对象。\x0a-\x20**【ID规则】**:\x20所有\x20\x22authorId\x22,\x20\x22likes\x22,\x20\x22comments\x22\x20中的作者标识，【必须】使用上面提供的角色\x20**ID**，绝对不能使用角色名字。\x0a-\x20**【JSON结构】**:\x20每个帖子对象必须遵循以下结构：\x0a\x20\x20```json\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22authorId\x22:\x20\x22发布者的ID\x22,\x0a\x20\x20\x20\x20\x22postType\x22:\x20\x22text\x20or\x20music\x22,\x0a\x20\x20\x20\x20\x22postContent\x22:\x20\x22动态的文字内容\x22,\x0a\x20\x20\x20\x20\x22songName\x22:\x20\x22如果是music类型，则必须有歌名\x22,\x0a\x20\x20\x20\x20\x22artist\x22:\x20\x22如果是music类型，则必须有歌手名\x22,\x0a\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20}\x0a\x20\x20```\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', 'statusText', 'oehkJ', '确定要删除群聊\x22', '#meeting-view-screen\x20.chat-input-area', 'music_cover_', 'KNTHJ', '[图片]', 'init', 'user-name', 'dfbgc', 'xziGX', 'mqSfk', 'sprite-slider-y', 'app-chat', 'push', 'wallpaper', 'save-char-button', 'LlRam', 'save-user-profile-button', 'https://sharkpan.xyz/f/Wa0cW/w6m7qk.jpg', 'oxgPA', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。', 'user-send-post-button', 'eEzaJ', 'music-feed-container', 'vdFDS', 'lt-ui-cover-art', 'true', 'character-edit-screen', 'msg_', 'createElementNS', 'lazy', '导入失败:\x20', 'xgUzA', 'oncomplete', 'sprite-reset-button', 'activeDiaryCharacterId', 'dKzWb', '确定要对本次会话进行总结吗？这会消耗不少资源，并且会读取完整的聊天记录。', '-\x20[', ']\x20[sticker:', 'qBZID', 'seemK', 'transaction', 'IndexedDB\x20failed\x20to\x20open', 'AhOTK', 'themeWidget1State', 'world-book-screen', ':</span>\x20', '.diary-entry', '.music-post-play-icon,\x20.music-share-play-icon', 'app-world-book', 'ymrLt', 'wQFfC', 'aigVq', '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1', 'teIgl', 'BClFi', 'gpCCA', '净化完成！总共迁移了\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', 'canvas', 'chatHistory_chat_', 'FbbtW', 're-record-button', 'create-group-chat-button', 'test_post_', '确定要清空好友圈“', 'https://sharkpan.xyz/f/Ganul/78iwli.jpg', '#\x20发生错误：\x0a', 'all', '正在迁移旧的动态数据到新的好友圈系统...', '请根据以上所有规则，生成\x20', 'sprite-slider-x', 'user-profile-list-container', 'coverId', 'UxRWy', 'SVgdr', 'music-widget-card', 'save-edit-button', '确定要永久清空【', 'https://sharkpan.xyz/f/Mamca/4e3emf.jpg', '[表情]', 'post-img-', 'cxxEl', 'quote-preview-text', 'json_object', 'listenTogetherSession', 'UYeOf', 'http://www.w3.org/2000/svg', 'IEKoT', 'CaAiA', 'mouseup', 'musicUploadAltar', 'chatWallpaper', 'backgroundImage', 'song_', 'WDlcI', 'JFiIZ', 'char_', 'tzQQC', '的转账', 'JpVmc', 'edit-message-modal', '壁纸已更换！', '60%', 'authorId', 'appIconPosition_app-diary', '34%', '请在动态或聊天中播放', '点击选择\x20.lrc', '\x0a[歌词结束]\x0a\x0a请根据当前播放的歌词和对话氛围，自然地作出回应。\x0a\x20\x20\x20', 'OnRVs', '\x20账单', 'post_image_', 'Gemini\x20API\x20Error:\x20', 'cardState', '默认米白', '#\x20核心任务:\x20角色扮演吐槽\x0a你正在扮演名为“', 'top', 'Migrating\x20old\x20data\x20structure\x20to\x20new\x20chat-based\x20structure.', 'DnoHP', 'fzXht', '\x0a\x0a#\x20', 'card-widget-2', 'char-edit-avatar-input', 'NSzwC', 'xOFzI', 'iDVmB', 'NHGYD', 'SpROR', 'documentElement', 'currentAbortController', 'xsIOh', 'oGIRH', 'Ubbvk', 'comments', 'appIconPosition_app-user-profiles', 'save-custom-stickers-button', 'xbfXD', 'sticker-content', 'qCdqK', 'dCFSh', '\x22\x20的聊天记录吗？此操作不可撤销。', '--widget-cover-image', '”的私聊摘要\x0a', 'zNzOF', 'fdJJj', 'fZxpX', '<circle\x20cx=\x2212\x22\x20cy=\x2212\x22\x20r=\x228\x22></circle><line\x20x1=\x223\x22\x20y1=\x223\x22\x20x2=\x2221\x22\x20y2=\x2221\x22></line>', '星期二', 'marginBottom', 'music-widget', '<input\x20type=\x22checkbox\x22\x20value=\x22', 'focus', '暂无音乐', 'imaGO', 'marginTop', 'Wnrzp', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-', 'QxCDt', 'GmNPM', '20%', 'XDRgK', 'TLKil', 'short', 'user', 'FCAjD', 'QidXM', '\x0a\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a-\x20**当前精确时间**:\x20', 'touchstart', 'scrollIntoView', 'download', '正在清空旧数据...', 'likes', 'toggle', '\x0a\x0a#\x20关于读者“', 'IWabe', 'xYawr', 'files', 'https://sharkpan.xyz/f/VGnuY/ptzlf5.jpg', 'aTntv', 'Eyccr', 'xQARv', '#ff9999', '-\x20姓名:\x20', 'type', '#\x20核心任务:\x20财务分类\x0a你的唯一任务是为每一笔消费记录精准地分配一个分类。\x0a#\x20规则\x0a1.\x20必须从【固定分类列表】中选择分类。\x0a2.\x20输出必须是完整的JSON数组，每个对象包含\x20\x22description\x22,\x20\x22amount\x22,\x20\x22category\x22。\x0a#\x20输出格式示例\x0a```json\x0a[{\x22description\x22:\x20\x22早餐\x22,\x20\x22amount\x22:\x2010,\x20\x22category\x22:\x20\x22餐饮美食\x22}]```\x0a#\x20最终指令\x0a分析流水，返回JSON数组。', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-', '还没有我的回复可以重新生成哦。', 'niAqz', 'music', '的日记本', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x20auto\x201fr;\x20width:\x20100%;\x20align-items:\x20center;\x20padding:\x200\x2010px;\x20box-sizing:\x20border-box;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-start;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-prev-button\x22>上一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22\x20style=\x22background-color:\x20var(--accent-color);\x20color:\x20white;\x22>写日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22diary-page-indicator\x22>第\x20', 'RdXJp', '487096oaFpUN', '--primary-hue', 'JhEDV', 'xFfeE', '\x20之间。\x0a-\x20所有表情包名称【必须】从\x20`stickerList`\x20列表中选择，严禁使用列表之外的名称。\x0a-\x20角色之间需要有适当的互动,话题不应当完全围绕', 'WuHsy', '<button\x20id=\x22organize-bill-button\x22\x20class=\x22form-button\x20secondary\x22>帮我整理</button>', 'bwnQO', '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>', '歌名和歌手都不能为空！', 'char_avatar_', 'CegQD', '星期五', 'listen-together-ui', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'zJdos', 'mofGa', 'widget-bg-input', 'app-user-profiles', 'chatHistory_', 'biZZM', 'AEOyZ', '条】全新的、高质量的社交动态。\x0a\x0a#\x20好友圈成员信息\x0a', '10px\x20auto', 'createObjectStore', 'postType', 'import-all-data-button', '总结失败:', 'chat-send-button', '\x22\x20已删除。', 'https://sharkpan.xyz/f/ZazfW/2vv46w.jpg', 'appIconPosition_app-accounting', 'whcyW', 'CsvCA', 'OzuXx', 'AflNK', '\x0a#\x20最近的动态回顾\x20(供所有角色参考)\x0a', 'user-post-image-input', 'bubble-', '餐饮美食', 'qeXUG', 'ljimg', 'FLJZV', 'group', 'ZoIud', '我很脆弱', 'warXE', '[AI发送了表情：', '群聊名称不能为空！', 'entries', 'message-image-content', '<path\x20d=\x22m3\x209\x209-7\x209\x207v11a2\x202\x200\x200\x201-2\x202H5a2\x202\x200\x200\x201-2-2z\x22></path><polyline\x20points=\x229\x2022\x209\x2012\x2015\x2012\x2015\x2022\x22></polyline>', '保存徽章状态失败', '\x0a#\x20最近的朋友圈动态\x20(供你参考)\x0a', 'QtGjs', 'brPSK', 'InHje', '#c299ff', '\x0a##\x20世界书条目:\x20', '赞同！渲染效果一级棒！', 'worldBook', 'header-actions', 'children', 'back-to-home-from-wallpaper', 'diary-modal-textarea', '##\x20来源：', 'scrollHeight', 'dBlEi', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNjY2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDRhNC4zOSA0LjM5IDAgMCAwLTMuMjgtNC4wOWwxLjQxLTEuNDFhMiAyIDAgMSAwLTIuODMtMi4wM2wtMS40MSAxLjQxQTQuMzkgNC4zOSAwIDAgMCAxMiAxMGE0LjM5IDQuMzkgMCAwIDAtNC4wOSAzLjI4TDMuMicgOS41N2EyIDIgMCAxIDAgMi44MyAyLjgzbDEuNDEtMS40MUE0LjM5IDQuMzkgMCAwIDAgMTAgMTJhNC4zOSA0LjM5IDAgMCAwIDMgNC4wOVYyMSI+PC9wYXRoPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIj48L2NpcmNsZT48L3N2Zz4=', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>', 'Failed\x20to\x20save\x20history\x20to\x20localStorage:', 'XFxOP', 'Noir_FileSystem', 'qcHyZ', 'wSEfS', '<div\x20class=\x22post-body\x22>', 'meeting-view-screen', 'user-profile-list-screen', 'RadQZ', '\x22\x20吗？所有聊天记录将被永久删除。', 'rnbgk', '图片加载失败', 'IFZwO', '未知艺术家', 'chat-sticker-button', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>', 'toLocaleTimeString', 'reset-feed-bg-button', 'translate(-50%,\x20-100%)', 'tUpcx', '-input', 'getContext', 'objectStoreNames', 'firstChild', '错误：找不到角色', 'writeText', 'data:', 'rgba(0,\x200,\x200,\x200.4)', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '委屈哭', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>', 'sMjae', '.json', '<br>', 'YGjtE', 'readAsText', 'querySelectorAll', '群聊设置已保存！', '[用户发送了表情：', 'twamR', 'HLlHK', 'getReader', 'Failed\x20to\x20remove\x20corrupted\x20state\x20from\x20localStorage:', 'feed-loader', 'widget_card_2', 'innerHTML', 'IubPl', '”吗？该角色的私聊和所有相关群聊记录都将被一并处理。', ',\x20resetting.', 'dKTYk', '群聊「', '图片预览失败:\x20', '\x0a\x20\x20相关记忆:\x0a', '8px', 'gXdaJ', '正在升级聊天数据结构...', 'margin', 'white', '哼，正在净化你那些超重的音乐分享记录...', '.message.user', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>', 'role', '1192738ZTxQsP', '正在为你切换新的歌曲...', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', '0\x202px\x208px\x20rgba(0,0,0,0.4)', 'app-pages-slider', 'title', '.widget-info\x20>\x20div', 'modal-cancel', '星期六', 'length', '第一阶段升级完成！应用即将刷新以进行第二阶段检查。', 'custom-icon-list-container', 'setItem', 'ovLfi', 'JpJWt', 'add-chat-button', 'Ggakb', 'user-persona', 'diary-entry\x20', 'SovRU', 'contains', 'replaceAll', 'lMsVX', 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', 'ZbpZB', '确定要清空群聊\x22', 'add-expense-button', 'stopPropagation', 'novel', 'kIpKn', 'img', 'eRcPi', ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“', '#diary-action-delete', 'application/json', 'zh-CN', 'toLocaleString', 'diaryView', 'diary-send-button', 'HHHyQ', 'reset-card-button', '[用户发起了听歌邀请:\x20', 'activeMeetingScriptQueue', 'PCUJN', 'join', '35%', 'filter', '正在解析备份文件...', 'pvofi', 'EtGaN', 'widgetBgImage', '位置已重置，正在刷新...', 'lUbMw', '无法保存状态，浏览器可能禁用了存储功能。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20', '哼，这不是图片，你想让我压缩什么？', '\x0a#\x20当前活动：一起听歌\x0a\x0a你们正在一起听\x20', '好像有动态了...', '#d1d5db', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'add-friend-circle-button', '。\x0a-\x20再次强调：你的全部输出都将被作为JSON解析，任何JSON主体之外的额外文字都会导致程序失败。\x0a', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22preview_', 'https://sharkpan.xyz/f/zLes5/4lxzjn.jpg', 'anthropic.com', 'https://sharkpan.xyz/f/B4DCa/u86hk2.jpg', 'char_wallpaper_', 'fOPKp', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'https://sharkpan.xyz/f/pKWCQ/ztxwv0.jpg', '\x0a##\x20条目:\x20', 'wBkuz', 'user_', '”的信息\x20(你的对话对象)\x0a', 'world-book-checkboxes-container', 'https://sharkpan.xyz/f/ljVCx/b16h2z.jpg', 'galgame-text', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22description\x22>', '生成日记失败:\x20', '<div\x20class=\x22post-likes\x22>', 'ncSzi', '错误：找不到这首作为“信物”的歌。', 'jbzpb', 'reply', '\x20的私聊', 'fPdUO', 'then', '很好哦', 'flexDirection', 'diaryCurrentPage', 'stringify', 'timeupdate', 'DqRNO', 'participantIds', 'OYiMc', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22categorized-expenses-list\x22\x20style=\x22margin-top:\x2010px;\x20display:\x20flex;\x20flex-direction:\x20column;\x20gap:\x2010px;\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'gHeJi', '\x0a-\x20**日记本的上一笔记录是在**:\x20', 'MOjZH', 'model', 'KKVwM', 'music-share-card', '\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', 'italic', 'gkXUH', 'world-book-item', '<div\x20class=\x22post-comments-container\x22>', 'IhgXI', '保存壁纸失败:\x20', 'data', 'path', '我是小丑呜呜', 'CZZyV', 'home', '正在写入新数据...', 'fCerj', 'reset-desktop-button', 'rQXzU', 'pause', 'HjxZP', 'IzFUA', '--\x20点击选择\x20--', '\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a', '未命名', '.bubble-', 'wCwdh', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'PrURB', 'MzBBt', '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'localStorageData', 'flatMap', 'from', 'jcWcF', 'https://sharkpan.xyz/f/N02Sv/378vt6.jpg', 'HVkbf', 'FooxK', 'round', 'kdFrv', '\x20个模型。', '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'VZPBM', '\x0a#\x20你的个性（节选）\x0a', 'warn', 'xOrqP', 'xZUgM', '当前聊天', 'getDate', 'gPSgq', 'lyrics', 'accounting-screen', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22font-size:\x200.8rem;\x20color:\x20var(--text-color-light);\x22>', 'HzNIZ', 'DNWYj', 'fvpYD', 'chat', 'stfLq', 'XPzdP', '\x0a\x0a#\x20最近的动态回顾\x20(供参考)\x0a', 'zNPiQ', '逗你开心', 'char_sprite_', 'meetingList', 'ZMbiB', 'tkRGZ', '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a', 'https://sharkpan.xyz/f/yrOhN/0yixqd.jpg', 'https://sharkpan.xyz/f/0GKHX/mthvno.jpg', 'JAzNo', 'GxSwN', 'XgDnL', 'userProfileList', 'mbeJl', 'cxJsa', 'WEkIY', 'XKcGB', 'JWakR', '在准备API数据时，从IndexedDB读取图片失败:', '包含所有图片和音乐的全量数据已成功导出！', 'Failed\x20to\x20read\x20state\x20from\x20localStorage:', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>正在清点圣殿藏品...</p>', 'diary-page-', 'bOLCh', 'tab-view-ledger', '保存失败:\x20', '正在翻阅全部历史记录...', '#app-dock-bottom-left\x20#', 'LrYqY', 'https://sharkpan.xyz/f/xjmCX/zyjzew.jpg', 'MGtpu', 'https://sharkpan.xyz/f/ajwtY/x03qxn.gif', 'add-user-profile-button', '”，但没找到人)', 'page', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的账本还是空白的。</p>', 'qWpBV', 'VnXVd', '一起听歌', 'author', 'parse', '\x0a\x20\x20人设:\x20', 'getMinutes', '图片处理失败:\x20', 'activeMeetingCharId', 'KJiyp', 'diary-action-modal-', 'api-provider', 'songId', 'music-upload-altar-screen', 'diary-prev-button', 'QhMBC', '-avatar', '新角色\x20', 'classList', '#message-anchor', 'back-to-home-from-circle-list', 'LCiNn', 'WkCHJ', 'UokOt', 'getDay', '8px\x2016px', '搜索失败:\x20', 'flex', 'srXdB', '正在连接同步频道...', 'WvpfG', 'neNbe', 'historyIndex', 'LOZuo', '事情好多', '3427745YGrdSu', 'audio', 'card-image', 'message-bubble-row', 'badgeState', '保存壁纸失败:', 'LLEVE', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>', '猫猫撒娇', 'NYdjE', 'emotion', 'add-choice-modal', 'saQwB', 'expense-description', 'zVlDb', 'VxtjF', 'user-post-attachment-preview', 'activeListenSession', '未分类', 'YOFDK', '世界书条目已保存！', 'input', 'alnMM', 'WSCfF', 'eQQra', 'RvRAF', 'settings-screen', '.message.ai', 'disabled', 'world-book-edit-content', 'iRSAZ', 'provider', 'save-group-settings-button', 'data:image', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>', '\x20张旧的音乐封面。', 'abs', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5OTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDJhNC4zOSA0LjM5IDAgMCAtMy4yOC00LjA5TDE1IDIwIj48L3BhdGgPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCI+PC9jaXJjbGU+PC9zdmc+', 'querySelector', 'parentElement', 'settings', 'jDHKh', 'lLGBL', 'oOAjc', 'appIconPosition_app-settings', 'uHxFf', 'YUYzb', 'PqUjM', '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。', 'themeLightness', 'MtVQG', 'quote-message-button', 'AI似乎没有想出任何新动态。', 'back-to-char-select-from-edit', '检测到旧版聊天数据，为了优化体验和存储空间，需要进行一次自动升级。过程很快，请稍候。', 'diary-entries-container', 'typing-indicator', 'src', 'activeUserProfileId', 'delete-friend-circle-button', 'vNgZR', 'widget-prev-btn', 'vEhey', '编辑用户', 'normal', '请输入有效的转账金额！', 'postContent', 'toDateString', '100%', 'log', 'OlJNH', 'TRsDe', '.choice-modal-backdrop', 'is-exiting-right', 'removeChild', 'groupChatCreate', 'Gmmmv', '正在处理图片...', '#a4c2f4', '请看是我', 'clockPosition', '执行音乐封面数据净化...', 'touches', '生成动态失败:', '未命名角色', 'tab-record-expense', 'mDDbT', '不高兴撒娇', 'iouUf', '正在迁移旧的用户数据...', 'lt-ui-close-btn', 'full', 'KOotf', 'jOqGz', 'http', 'sEXNo', 'FyPMU', 'sprite-confirm-button', '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“', 'lFqTH', 'live-preview-style', 'memberCharacterIds', 'qXYgV', 'https://sharkpan.xyz/f/DVJtK/vxiup1.jpg', 'screenX', '星期四', 'music-input-artist', 'claude', 'muRDc', 'characterId', '.message-container', 'Bearer\x20', 'block', '72%', 'sender', 'nisww', 'worldBooks', 'ETMyP', '新用户\x20', '15%', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22\x20style=\x22font-size:\x201.1rem;\x22>-\x20', '最近没有动态记录。', 'info', 'XGJIg', 'FASAO', 'assistant', '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。', 'xGhIa', 'createElement', '.listen-together-song', 'charSelect', 'fGyMp', '\x0a-\x20**对话状态**:\x20群里已经有', 'sawzA', '分钟前聊过，请注意衔接。', '<button\x20id=\x22re-record-button\x22\x20class=\x22header-button\x22>重新记录</button>', '在你那乱七八糟的文本里没找到“歌名”！', '#member-select-', '-\x20[动态]\x20', '\x20个成员', 'audio-player', 'MrFkh', 'appIconPosition_app-world-book', 'p[data-history-index]', '你还没保存这个角色呢，导什么导？', '>>\x20', '导入失败了，笨蛋:\x20', 'outerHTML', 'activeCharacterId', 'jfhRU', '\x0a\x0a#\x20核心群聊世界观设定\x20(所有角色必须严格遵守以下设定)\x0a', 'upload-wallpaper-button', 'LMHHU', 'char-edit-offline-bg-preview', 'url(', 'Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20', 'timestamp', '\x0a\x0a#\x20关于“', 'input[type=\x22checkbox\x22]', 'YRnkQ', '新建好友圈', 'IOFzM', 'ieidk', 'iBkAi', 'listen-together-card', 'removeItem', 'html-module-container', 'chat_image_migrated_', 'Failed\x20to\x20read\x20history\x20for\x20chat\x20', '\x0a#\x20好友圈的主人\x20(“我”)\x0a-\x20姓名:\x20', '说了是摆设啦，笨蛋。', '---\x20Noir\x27s\x20Music\x20Cover\x20Purification\x20Ritual\x20---', 'confirm-transfer-button', 'delete', 'includes', 'cancel-action-button', 'rfyie', 'SHBUL', 'galgame-sprite-container', '\x20张旧图片。应用即将刷新。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'test', 'eWwQk', '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a', '角色“', 'startsWith', 'itkWF', 'getFullYear', 'reset-widgets-position-button', '甜蜜地和你聊天', 'image', '无法读取状态，浏览器可能禁用了存储功能。', 'VBbxs', ',\x20ID:\x20', 'https://sharkpan.xyz/f/gjySw/jrl7rw.jpg', '”已存入圣殿。', 'PoYOt', 'https://sharkpan.xyz/f/xjwSX/pxjrjd.jpg', 'voGYX', '\x0a-\x20**对话状态**:\x20群里在', 'https://sharkpan.xyz/f/mjdFW/28n30c.jpg', 'upload-badge-button', 'TRfwI', 'isArray', 'dataset', '天没动静了。你的角色们应该发起新的问候或话题。', 'summarize-modal', 'QHdBO', 'sFNoR', 'aThEw', 'app-accounting', '无法从\x20IndexedDB\x20加载聊天图片:', 'input[type=\x22checkbox\x22]:checked', 'DyuVv', 'OAaux', 'https://sharkpan.xyz/f/MWOIa/rb3nov.jpg', 'world-book-edit-name', 'WgNmu', '</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22amount\x22>总计:\x20', 'sprites', 'UfpWT', 'indexOf', '总得说点什么吧？', 'oikya', 'jcEoq', '\x20张旧封面。应用即将刷新。', 'https://sharkpan.xyz/f/ABwhZ/twknmr.jpg', '<div\x20class=\x22post-timestamp\x22>', 'Sfqgn', 'altar-slot-audio', '这不是一张有效的Noir角色卡。', 'WtmrZ', 'rKHwY', 'BwBta', 'pANWi', 'https://sharkpan.xyz/f/X7muW/lc8g9h.gif', 'QWbul', 'JJllN', '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'KOYNx', 'aazvc', '71%', 'image/jpeg', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'toString', 'wrnUi', 'checked', 'filled', 'dtvva', 'listen-together-invite', 'wvuXP', '---\x20Noir\x27s\x20Friend\x20Circle\x20Purification\x20Ritual\x20---', '15px', 'getMonth', 'translateX(-', 'OoOhz', '大家正在赶来回复...']; _0xcb80 = function () { return _0x3f5130; }; return _0xcb80(); } async function _0x52b4ba(_0x2e6195) { const _0x5328c0 = await _0x55088a; return new Promise((_0x175d4a, _0x320ff3) => { const _0x19428e = _0x321d, _0x3b7df0 = _0x5328c0[_0x19428e(0x59e)](_0x3fdc08, _0x19428e(0x1e2)), _0x275f48 = _0x3b7df0[_0x19428e(0x8e1)](_0x3fdc08), _0x48be90 = _0x275f48[_0x19428e(0x84d)](_0x2e6195); _0x48be90['onsuccess'] = () => _0x175d4a(), _0x48be90[_0x19428e(0x41e)] = () => _0x320ff3(_0x48be90[_0x19428e(0x8d6)]); }); } function _0x407d73(_0x22c301) { const _0xa15e70 = _0x18f426; return fetch(_0x22c301)[_0xa15e70(0x710)](_0x4c8cd7 => _0x4c8cd7[_0xa15e70(0x41c)]()); }
  </script>
  <div id="listen-together-ui" style="display: none;">
    <div class="lt-ui-backdrop"></div>
    <div class="lt-ui-main">
      <div class="lt-ui-header">
        <span id="lt-ui-header-title">正在与 TA 一起听</span>
        <button id="lt-ui-close-btn">×</button>
      </div>
      <div class="lt-ui-content">
        <div class="lt-ui-cover-container">
          <img id="lt-ui-cover-art" src="">
        </div>
        <div class="lt-ui-info">
          <h2 id="lt-ui-song-title">歌曲名称</h2>
          <p id="lt-ui-song-artist">歌手</p>
        </div>
        <div id="lt-ui-lyrics-container">
          <p class="no-lyrics-placeholder">暂无歌词</p>
        </div>
      </div>
    </div>
  </div>
  <div id="summarize-modal" class="choice-modal">
    <div id="summarize-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <button id="close-summary-button" class="header-button" style="min-width: 50px;">关闭</button>
        <span class="header-title">聊天记录总结</span>
        <button id="copy-summary-button" class="header-button" style="min-width: 50px;">复制</button>
      </div>
      <div class="content" style="flex-grow: 1; padding: 0;">
        <textarea id="summary-textarea" placeholder="AI正在拼命总结中，别催..."></textarea>
      </div>
    </div>
  </div>

</body>

</html>
