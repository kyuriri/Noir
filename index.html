<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">

  <meta http-equiv="Content-Security-Policy" content="default-src * 'unsafe-inline' 'unsafe-eval' data: blob:;">

  <title>Noir搓的小手机</title>
  <style>
    .message p,
    .diary-content {
      user-select: none;
      -webkit-user-select: none;
    }

    .lt-end-session-btn {
      font-size: 1.5rem;
      color: inherit;
      /* 继承父元素的颜色 */
      opacity: 0.6;
      cursor: pointer;
      padding: 0 5px;
      line-height: 1;
      font-weight: bold;
    }

    .lt-end-session-btn:hover {
      opacity: 1;
    }

    /* --- Noir's Refactor: Feed Loader Style --- */
    #feed-loader {
      position: absolute;
      inset: 0;
      background: rgba(244, 248, 255, 0.85);
      backdrop-filter: blur(4px);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
      color: var(--text-color);
      font-size: 1rem;
      flex-direction: column;
      gap: 10px;
    }

    .loader-spinner {
      width: 24px;
      height: 24px;
      border: 3px solid var(--border-color);
      border-top-color: var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    /* --- End of Refactor --- */
    /*
        Noir's Mizuiro Theme
        - 哼，看好了，这才是设计。
      */
    /*
          Noir's Mizuiro Theme
          - 哼，看好了，这才是设计。
        */
    :root {
      --phone-width: 375px;
      --phone-height: 812px;
      --user-bg-image: url('');

      /* === Noir's Ultimate Dynamic Theme Engine v2.0 === */
      /* 哼，现在所有的颜色都听从这三个总开关的指挥。*/
      --primary-hue: 35;
      --primary-saturation: 25%;
      --primary-lightness: 80%;

      /* 核心颜色 */
      --primary-color: hsl(var(--primary-hue), var(--primary-saturation), var(--primary-lightness));
      /* 强调色/用户气泡色，现在也是动态的 */
      --accent-color: hsl(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%));

      /* 哼，看好了，这些就是被我重新接上线的“电灯” */

      /* 文字颜色：根据主题亮度自动变深或变浅 */
      --text-color: hsl(var(--primary-hue), 15%, calc(100% - var(--primary-lightness) / 1.1));
      --text-color-light: hsl(var(--primary-hue), 10%, calc(100% - var(--primary-lightness) / 1.3));

      /* 表面背景：半透明，亮度比主色高一点 */
      --surface-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.4);

      /* 卡片/AI气泡背景：比表面背景更亮一点 */
      --card-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), 0.5);

      /* 边框颜色 */
      --border-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness)), 0.3);

      /* 阴影颜色 */
      --soft-shadow: 0 4px 12px hsla(var(--primary-hue), 40%, calc(var(--primary-lightness) - 10%), 0.15);

      /* 动态页的设置保持不变 */
      --feed-bg-image: none;
      --feed-overlay-opacity: 0.12;
      --feed-overlay-rotate: 22deg;
      --feed-overlay-speed: 48s;

      /* 气泡样式也完全动态化 */
      --bubble-radius: 18px;
      --bubble-outline: hsla(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) + 10%), 0.5);
      --bubble-user-bg: hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.2), calc(var(--primary-lightness) - 20%), 0.5);
      /* <-- 哼，改成0.5，现在够“虚无”了吧 */
      --bubble-ai-bg: var(--card-bg);

      /* ▼▼▼ 把下面这两行加进去 ▼▼▼ */
      --dropdown-alpha: 0.9;
      /* 下拉菜单的透明度，0到1 */
      --feed-card-alpha: 0.7;
      /* 动态卡片的透明度，0到1 */


      /* ▲▲▲ 添加到这里结束 ▲▲▲ */

    }

    body {
      display: flex;
      align-items: center;
      /* <-- 加上这句 */
      justify-content: center;
      /* <-- 还有这句 */
      height: 100vh;
      margin: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
    }

    #phone-container {
      width: 100%;
      /* 占满屏幕宽度 */
      height: 100vh;
      /* 占满屏幕高度 */
      background-color: white;
      background-image: var(--user-bg-image);
      background-size: cover;
      background-position: center;
      display: flex;
      flex-direction: column;
      overflow: hidden;
      /* 是不是清爽多了？ */
      position: relative;
      /* <-- 就是这句，告诉它“你是个家长了，给我看好家里的东西！” */
    }

    .screen {
      flex-grow: 1;
      display: none;
      flex-direction: column;
      background-color: #f9f9f9;
      /* 哼，所有屏幕默认都给我变白 */
      /* 让背景透出来 */
      overflow: hidden;
      color: var(--text-color);
    }

    .screen.active {
      display: flex;
    }

    /* 这个是通用的头像预览样式 */
    .avatar-preview {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid var(--border-color);
      margin-top: 5px;
      cursor: pointer;
    }

    /* --- 通用顶栏 --- */
    .header,
    #chat-list-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background-color: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border-bottom: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    .header-title {
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--text-color);
    }

    .header-button {
      background: none;
      border: none;
      font-size: 1rem;
      cursor: pointer;
      color: var(--primary-color);
      font-weight: 500;
      min-width: 50px;
      text-align: center;
      /* ▼▼▼ 哼，加上这三句，给我立正站好 ▼▼▼ */
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- 聊天列表 --- */
    #chat-list-pane {
      background-color: transparent;
      border-right: 1px solid var(--border-color);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 加上这句 */
      width: 100%;
      height: 100%;
      flex-shrink: 0;
      /* 防止它在横向布局里被挤扁 */
      display: flex;
      flex-direction: column;
    }

    #chat-list-container {
      flex-grow: 1;
      flex-grow: 1;
      overflow-y: auto;
      padding: 10px;
    }

    #character-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .character-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      /* backdrop-filter: blur(10px);*/
      border-radius: 16px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
    }

    .character-item:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 16px rgba(138, 180, 228, 0.2);
    }

    .char-info-wrapper {
      flex-grow: 1;
      cursor: pointer;
      display: flex;
      align-items: center;
      overflow: hidden;
    }

    .character-item .char-avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      margin-right: 12px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .character-item .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .character-item .char-remark {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    #chat-screen-container {
      position: relative;
      /* 告诉里面的绝对定位元素，要以我为基准 */
      flex-grow: 1;
      /* 确保它能撑满 chat-screen 的空间 */
      overflow: hidden;
      /* 把滑出去的部分藏起来，这很重要 */
      display: flex;
      /* 保持内部元素的 flex 布局 */
    }

    /* --- 聊天窗口 --- */


    #chat-view-pane {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      flex-direction: column;
      transform: translateX(100%);
      transition: transform 0.3s ease-in-out;
      will-change: transform;
      /* <-- 还有这句 */
      background-color: transparent;
      z-index: 10;
    }

    #chat-screen.show-chat-view #chat-list-pane {
      transform: translateX(-100%);
    }

    #chat-screen.show-chat-view #chat-view-pane {
      transform: translateX(0);
    }

    #chat-messages {
      flex-grow: 1;
      padding: 5px;
      overflow-y: auto;
      display: flex;
      /* <-- 加上这个 */
      flex-direction: column;
      /* <-- 还有这个 */
      contain: content;
      contain: content;
      /* <-- 哼，就是这句救命神药！ */
    }



    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 10px;
      object-fit: cover;
      border: 2px solid rgba(255, 255, 255, 0.7);
      flex-shrink: 0;
    }

    .message {
      padding: 10px 16px;
      border-radius: 20px;
      line-height: 1.5;
      word-break: break-word;
      box-shadow: var(--soft-shadow);
    }

    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
    }

    .message.user {
      background-color: var(--accent-color);
      color: white;
      border-bottom-right-radius: 5px;
    }

    .message.ai {
      background-color: var(--card-bg);
      border: 1px solid rgba(255, 255, 255, 0.8);
      color: var(--text-color);
      border-bottom-left-radius: 5px;
    }

    .message p {
      margin: 0;
    }

    .sticker-content,
    .message-image-content {
      max-width: 120px;
      border-radius: 8px;
      object-fit: cover;
      cursor: pointer;
    }

    .message-image-content {
      max-width: 160px;
    }

    /* --- 其他屏幕和组件 --- */
    /* --- Noir's Fix: API 模型列表的样式修正 --- */
    .model-input-container {
      position: relative;
      /* 关键！让里面的绝对定位元素有家可回 */
      display: flex;
      gap: 8px;
    }

    .custom-model-dropdown {
      display: none;
      /* 默认藏起来 */
      position: absolute;
      top: 100%;
      /* 精准定位到输入框正下方 */
      left: 0;
      right: 80px;
      /* 留出“获取”按钮的位置 */
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*   backdrop-filter: blur(10px);*/
      border: 1px solid var(--border-color);
      border-radius: 8px;
      margin-top: 4px;
      max-height: 180px;
      overflow-y: auto;
      z-index: 100;
      /* 确保它在最上层 */
      box-shadow: var(--soft-shadow);
    }

    .checkboxes-container {
      display: none;
      position: absolute;
      left: 0;
      right: 0;
      top: 100%;
      max-height: 150px;
      overflow-y: auto;
      border: 1px solid var(--border-color);
      background: hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), var(--dropdown-alpha));
      /*  backdrop-filter: blur(10px);*/
      z-index: 10;
      border-radius: 8px;
      margin-top: 4px;
    }

    .custom-model-dropdown.show {
      display: block;
      /* 需要的时候再显示 */
    }

    .custom-model-dropdown div {
      padding: 10px 12px;
      cursor: pointer;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    .custom-model-dropdown div:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    /* --- 其他屏幕和组件 --- */
    /* 在这个注释下面加上主屏幕的样式 */
    #home-screen {
      position: relative;
      /* <-- 就加上这一行！ */


      gap: 20px;
      /* 图标之间的距离 */

      /* 声明！这里现在是我的地盘！*/
      flex-direction: column;
      /* 里面的东西，全体给我垂直排队！*/
      justify-content: space-between;
      /* 核心！顶部和底部的元素给我贴边站好，中间的自动拉开距离！*/
      padding-bottom: 0;
      /* 把内边距去掉，让Dock栏能完美贴底 */
    }

    .app-icon {
      width: 75px;
      /* <--- 就是这里，我把它加宽了 */
      height: 90px;
      /* <--- 高度也顺便调整一下 */
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      position: absolute;
      z-index: 40;
      padding: 5px;
      box-sizing: border-box;
      margin: 0;
    }

    .app-icon-img {
      width: 58px;
      height: 58px;
      border-radius: 22.5%;
      margin-bottom: 2px;
      /* <-- 哼，就是这里，把5px改成2px，让图标和文字的距离拉近一点 */
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 28px;
      background-color: var(--surface-bg);
      box-shadow: none;
      transition: transform 0.2s ease;
    }

    .app-icon-img svg {
      stroke: currentColor;
      /* SVG的线条颜色会继承上面的 color */
    }

    .app-icon span {
      font-size: 0.75rem;
      /* 文本也相应缩小 */
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      width: 100%;
    }

    .content {
      padding: 20px;
      overflow-y: auto;
      flex-grow: 1;
      /* <-- 加上这行代码，就是这行！ */
    }

    .form-button {
      width: 100%;
      padding: 12px;
      border: none;
      background-color: var(--primary-color);
      color: white;
      border-radius: 8px;
      font-size: 1.1rem;
      cursor: pointer;
      margin-top: 10px;
    }

    input,
    textarea,
    select {
      width: 100%;
      padding: 10px;
      box-sizing: border-box;
      background-color: rgba(255, 255, 255, 0.8);
      border: 1px solid var(--border-color);
      color: var(--text-color);
      border-radius: 8px;
    }

    input:focus,
    textarea:focus,
    select:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    .chat-toolbar {
      display: flex;
      padding: 5px 10px;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      /*   backdrop-filter: blur(10px);*/
      flex-shrink: 0;
    }

    /* ▼▼▼ 用下面这段，替换掉你旧的 .toolbar-button 样式 ▼▼▼ */
    .toolbar-button {
      background: none;
      border: none;
      font-size: 1.5rem;
      /* 这个保留，作为SVG尺寸的参考 */
      cursor: pointer;
      padding: 8px;
      /* 稍微增大点击区域 */
      color: var(--text-color-light);
      /* 让它默认是浅灰色 */
      border-radius: 50%;
      /* 让背景有个圆形轮廓 */
      width: 40px;
      height: 40px;
      display: flex;
      /* 使用flex布局让SVG完美居中 */
      align-items: center;
      justify-content: center;
      transition: background-color 0.2s, color 0.2s;
      /* 加上顺滑的过渡效果 */
    }

    .toolbar-button:hover {
      background-color: var(--border-color);
      /* 鼠标悬停时给个背景 */
      color: var(--primary-color);
      /* 图标颜色变为主题色 */
    }

    /* ▲▲▲ 替换到这里为止 ▲▲▲ */


    /* ▼▼▼ 在下面新增这段SVG的专属样式 ▼▼▼ */
    .toolbar-button svg {
      width: 22px;
      /* SVG图标的尺寸 */
      height: 22px;
      stroke-width: 1.8;
      /* 线条粗细，可以微调 */
      stroke: currentColor;
      /* 核心！让SVG的颜色继承按钮的color属性 */
      fill: none;
      /* 确保是线稿风格 */
      pointer-events: none;
      /* 防止SVG本身干扰点击事件 */
    }

    /* ▲▲▲ 新增到这里为止 ▲▲▲ */

    .sticker-panel {
      display: none;
      grid-template-columns: repeat(auto-fill, minmax(60px, 1fr));
      gap: 10px;
      padding: 10px;
      height: 200px;
      overflow-y: auto;
      border-top: 1px solid var(--border-color);
      background-color: var(--surface-bg);
      flex-shrink: 0;
    }

    .sticker-panel.show {
      display: grid;
    }

    /* --- 输入区域 --- */
    /* --- 输入区域 --- */
    .chat-input-area {
      padding: 10px 12px calc(env(safe-area-inset-bottom, 0px) + 10px);
      background: var(--surface-bg);
      /*  backdrop-filter: saturate(1.2) blur(10px);*/
      border-top: 1px solid var(--border-color);
      flex-shrink: 0;
    }

    /* 这是我加的新容器，用来实现完美对齐 */
    #chat-input-wrapper {
      display: flex;
      /* Flex大法好，哼 */
      align-items: center;
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      padding: 2px 5px;
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-input-wrapper:focus-within {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-message-input {
      flex-grow: 1;
      /* 让输入框占满剩余空间 */
      border: none;
      background: transparent;
      padding: 9px 12px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 38px;
      width: 38px;
      border: 0;
      border-radius: 50%;
      font-size: 1.2rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
      flex-shrink: 0;
      /* 防止被挤压 */
      margin-left: 4px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    /* 回复按钮，给个不一样的颜色区分 */
    #chat-get-reply-button {
      background: var(--accent-color);
      font-size: 1.5rem;
      /* 让箭头更清晰 */
    }

    #chat-message-input {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 11px 16px;
      font-size: .95rem;
      outline: none;
      color: var(--text-color);
      transition: border-color .2s, box-shadow .2s;
    }

    #chat-message-input:focus {
      border-color: var(--primary-color);
      box-shadow: 0 0 0 3px rgba(138, 180, 228, 0.3);
    }

    #chat-send-button,
    #chat-get-reply-button {
      height: 40px;
      padding: 0 18px;
      border: 0;
      border-radius: 20px;
      font-size: .95rem;
      font-weight: 600;
      color: #fff;
      cursor: pointer;
      transition: transform .1s ease, filter .15s ease;
    }

    #chat-send-button {
      background: var(--primary-color);
    }

    #chat-get-reply-button {
      display: flex;
      /* 隐藏旧的回复按钮，样式统一到发送按钮 */
    }


    /* --- 引用样式 --- */
    .quote-preview {
      display: none;
      padding: 8px 12px;
      background-color: rgba(255, 255, 255, 0.5);
      border-left: 3px solid var(--primary-color);
      margin: 0 12px 8px;
      border-radius: 6px;
      position: relative;
    }

    #quote-preview-sender {
      font-weight: 600;
      font-size: 0.85rem;
      color: var(--primary-color);
    }

    #quote-preview-text {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    .cancel-quote-btn {
      position: absolute;
      top: 50%;
      right: 10px;
      transform: translateY(-50%);
      background: none;
      border: none;
      font-size: 1.5rem;
      color: #999;
      cursor: pointer;
    }

    .quoted-message-in-bubble {
      background-color: rgba(0, 0, 0, 0.04);
      padding: 8px 10px;
      border-left: 3px solid var(--border-color);
      border-radius: 8px;
      margin-bottom: 6px;
    }

    .quoted-sender {
      font-weight: bold;
      font-size: 0.8rem;
      color: var(--text-color);
    }

    .quoted-content {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    /* 这是弹窗的“骨架”，让它能居中浮动在屏幕上 */
    .choice-modal {
      position: fixed;
      inset: 0;
      z-index: 1000;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.2s ease, visibility 0.2s ease;
    }

    .choice-modal.show {
      opacity: 1;
      visibility: visible;
    }


    /* --- 弹窗 --- */
    .choice-modal-backdrop {
      background: rgba(0, 0, 0, 0.2);
      /*  backdrop-filter: blur(4px);*/
    }

    .choice-modal-content {
      background: var(--surface-bg);
      /* backdrop-filter: blur(12px); */
      /* <-- 就这么简单，干掉它 */
      border: 1px solid rgba(255, 255, 255, 0.5);
      border-radius: 16px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
    }

    .choice-modal-button {
      color: var(--text-color);
      background: rgba(255, 255, 255, 0.5);
    }

    .choice-modal-button:hover {
      background-color: rgba(255, 255, 255, 1);
    }

    .choice-modal-button.cancel {
      color: var(--primary-color);
      background: transparent;
    }

    /* --- Noir's Fix: 让“添加”弹窗从底部滑出，更大气 --- */
    #add-choice-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      /* 确保不会超出手机宽度 */
      margin: 0;
      border-radius: 20px 20px 0 0;
      /* 只留顶部圆角 */
      border-bottom-left-radius: 0;
      /* 覆盖通用样式 */
      border-bottom-right-radius: 0;
      /* 覆盖通用样式 */
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      /* 适配iPhone底部安全区 */
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #add-choice-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #add-choice-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
      justify-content: center;
    }

    /* 按钮也重新设计一下，让它们竖着排 */
    #add-choice-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- Noir's Fix: 修正创建群聊时，成员选择列表的样式 --- */
    .member-selection-item {
      display: flex;
      align-items: center;
      padding: 10px 15px;
      border-bottom: 1px solid var(--border-color);
    }

    .member-selection-item:last-child {
      border-bottom: none;
    }

    /* 关键！就是这里，把头像大小锁死 */
    .member-selection-item .char-avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin: 0 15px 0 10px;
      object-fit: cover;
    }

    .member-selection-item .char-name {
      font-weight: 500;
      color: var(--text-color);
    }

    .member-selection-item input[type="checkbox"] {
      width: 20px;
      height: 20px;
      flex-shrink: 0;
      accent-color: var(--primary-color);
      /* 让勾选框颜色也跟主题统一 */
    }

    /* --- Noir's World Book Styles --- */
    #world-book-list-container {
      padding: 10px;
    }

    .world-book-item {
      background-color: var(--card-bg);
      padding: 15px;
      border-radius: 12px;
      margin-bottom: 10px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .world-book-item-name {
      font-weight: 600;
      color: var(--primary-color);
      margin-bottom: 5px;
    }

    .world-book-item-preview {
      font-size: 0.9rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* --- Noir's Fancy Multi-Select Styles --- */
    .custom-multiselect {
      position: relative;
      user-select: none;
    }

    .select-box {
      border: 1px solid var(--border-color);
      background: rgba(255, 255, 255, 0.8);
      border-radius: 8px;
      padding: 10px;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .select-box.expanded .arrow {
      transform: rotate(180deg);
    }


    .checkboxes-container.visible {
      display: block;
    }

    .checkboxes-container label {
      display: block;
      padding: 10px 12px;
    }

    .checkboxes-container label:hover {
      background-color: rgba(138, 180, 228, 0.2);
    }

    .checkboxes-container input[type="checkbox"] {
      margin-right: 8px;
      width: auto;
      /* 覆盖掉全局的 input 样式 */
    }

    /* --- Noir's Clock & Timestamp Styles --- */
    /* --- Noir's Badge & App Dock Styles --- */
    #decorative-badge {
      width: 160px;
      height: 160px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.25));
      /* 哼，给你加个阴影，看起来才像样 */
      transform: rotate(-0deg);
      /* 稍微歪一点，显得随意 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      /* 防止拖动时选中图片 */
      z-index: 50;
    }

    #decorative-badge:active {

      transform: rotate(-2deg) scale(1.05);
      /* 抓起来的时候，摆正放大一点 */
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }


    #decorative-badge img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      /* 保留这句，让你的图片能被很好地填充 */
    }

    /*  #a#app-dock-bottom-left,
    #app-dock-top-right {
      
      哼，现在你们只是幽灵了。
      不需要任何样式，你们的孩子（App图标）会自己找到回家的路。
      它们会相对于 #home-screen 定位。
    
    }
*/

    /* --- Noir's Author Mark: Pixel Chicken --- */
    /* 哼，这就是那个吵着要加的小鸡图标 */
    #noir-author-mark {
      position: absolute;
      /* 相对于父容器定位 */
      right: -30px;
      /* 调整它在时钟右边的位置 */
      top: 50%;
      /* 垂直居中 */
      transform: translateY(-50%);
      /* 精确对齐 */
      width: 20px;
      /* 小鸡的尺寸 */
      height: 20px;
      background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white" stroke="white" stroke-width="0"><path d="M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zM12 4c.69 0 1.25.56 1.25 1.25S12.69 6.5 12 6.5s-1.25-.56-1.25-1.25S11.31 4 12 4zm0 2c-.69 0-1.25.56-1.25 1.25S11.31 8.5 12 8.5s1.25-.56 1.25-1.25S12.69 6 12 6zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 9.75 10 9.75s1.25-.56 1.25-1.25S10.69 8 10 8zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 9.75 12 9.75s1.25-.56 1.25-1.25S12.69 8 12 8zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 9.75 14 9.75s1.25-.56 1.25-1.25S14.69 8 14 8zM10 10c-.69 0-1.25.56-1.25 1.25S9.31 12.5 10 12.5s1.25-.56 1.25-1.25S10.69 10 10 10zm2 0c-.69 0-1.25.56-1.25 1.25S11.31 12.5 12 12.5s1.25-.56 1.25-1.25S12.69 10 12 10zm2 0c-.69 0-1.25.56-1.25 1.25S13.31 12.5 14 12.5s1.25-.56 1.25-1.25S14.69 10 14 10zM12 12c-.69 0-1.25.56-1.25 1.25S11.31 14.5 12 14.5s1.25-.56 1.25-1.25S12.69 12 12 12zm-2 2c-.69 0-1.25.56-1.25 1.25S9.31 15.75 10 15.75s1.25-.56 1.25-1.25S10.69 14 10 14zm4 0c-.69 0-1.25.56-1.25 1.25S13.31 15.75 14 15.75s1.25-.56 1.25-1.25S14.69 14 14 14zM12 16c-.69 0-1.25.56-1.25 1.25S11.31 18.5 12 18.5s1.25-.56 1.25-1.25S12.69 16 12 16zM6 10c-.69 0-1.25.56-1.25 1.25S5.31 12.5 6 12.5s1.25-.56 1.25-1.25S6.69 10 6 10zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 12.5 18 12.5s1.25-.56 1.25-1.25S18.69 10 18 10zM12 20c-.69 0-1.25.56-1.25 1.25S11.31 22.5 12 22.5s1.25-.56 1.25-1.25S12.69 20 12 20zM6 14c-.69 0-1.25.56-1.25 1.25S5.31 15.75 6 15.75s1.25-.56 1.25-1.25S6.69 14 6 14zm12 0c-.69 0-1.25.56-1.25 1.25S17.31 15.75 18 15.75s1.25-.56 1.25-1.25S18.69 14 18 14z"/></svg>');
      /* 这是SVG小鸡的Data URI，白色像素风格 */
      background-size: contain;
      background-repeat: no-repeat;
      cursor: pointer;
      /* 提示可点击 */
      opacity: 0.6;
      /* 稍微透明一点，不那么突兀 */
      transition: opacity 0.2s ease-in-out;
      /* 鼠标悬停效果 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    #noir-author-mark:hover {
      opacity: 1;
      /* 鼠标悬停时完全显示 */
    }

    /* 调整时钟容器，为小鸡留出空间并方便定位 */
    .home-clock-container {
      position: relative;
      /* 确保小鸡能相对它定位 */
      /* ... (保留你已有的其他时钟样式) ... */
      padding-right: 40px;
      /* 给小鸡留出一些右边距 */
    }

    #home-clock-container {
      color: white;
      text-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
      text-align: center;
      position: absolute;
      /* top, left, right 都被我删了，哼，现在它完全听JS的指挥 */

      /* 这行可以留着，虽然你已经不让它拖了 */
      z-index: 50;
    }

    #home-time {
      font-size: 80px;
      font-weight: 360;
      /* <--- 我把字重从200加到了300，比原来粗，但又不会笨重，这才是高级感。 */
      letter-spacing: -1px;
      /* <--- 字间距也给你调紧了一点，看起来更整体。 */
    }

    #home-date {
      font-size: 1rem;
      /* <--- 稍微缩小一点，让时间更突出 */
      font-weight: 400;
      margin-top: 8px;
      opacity: 0.8;
      text-transform: uppercase;
      /* <--- 日期我给你换成了全大写，这才有那股‘性冷淡’的味道。 */
      letter-spacing: 1px;
      /* <--- 顺便拉开一点点间距，免得挤在一起。 */
    }

    /* 聊天气泡时间戳的样式 */
    .timestamp {
      font-size: 0.7rem;
      color: var(--text-color-light);
      padding: 0 5px;
      margin-bottom: 3px;
      /* 让它和气泡底部对齐 */
    }

    /* 第一段：这是消息容器的基础样式 */
    .message-container {
      display: flex;
      /* 启用flex布局 */
      flex-direction: column;
      /* 让气泡和时间戳垂直排列 */
      margin-bottom: 10px;
      max-width: 85%;
      /* 限制整个容器的最大宽度 */
    }

    /* 第二段：这是根据发言者进行左右对齐的样式 */
    .message-container.user {
      align-self: flex-end;
      /* 让用户方整个容器靠右 */
      align-items: flex-end;
      /* 让容器内部的元素（气泡、时间戳）也靠右 */
    }

    .message-container.ai {
      align-self: flex-start;
      /* 让AI方整个容器靠左 */
      align-items: flex-start;
      /* 让容器内部的元素（气泡、时间戳）也靠左 */
    }

    .message-bubble-row {
      display: flex;
      align-items: flex-end;
      width: 100%;
    }

    .message-container.user .message-bubble-row {
      justify-content: flex-end;
    }

    .message-container.ai .message-bubble-row {
      justify-content: flex-start;
    }



    /* 这是给表情选择面板里，每一个小表情图片用的样式 */
    .sticker-item {
      width: 100%;
      /* 自动填满网格单元格的宽度 */
      aspect-ratio: 1 / 1;
      /* 保持1:1的宽高比，让它变成正方形 */
      object-fit: cover;
      /* 图片会被裁剪以适应正方形，不变形 */
      border-radius: 8px;
      /* 加个小圆角 */
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .sticker-item:hover {
      transform: scale(1.1);
      /* 鼠标放上去时稍微放大，增加交互感 */
    }

    /* --- Noir's Offline Scene Styles --- */
    #meeting-scene-view {
      flex-grow: 1;
      /* <-- 核心：让它占满所有可用空间 */
      overflow-y: auto;
      /* <-- 核心：内容多了就内部滚动 */
      padding: 20px;
      font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif;
      background-size: cover;
      background-position: center;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.7);
    }

    #chat-view-pane.offline-mode #offline-scene-view {
      display: block;
      /* 在线下模式时显示 */
    }

    #chat-view-pane.offline-mode #chat-messages {
      display: none;
      /* 在线下模式时隐藏气泡聊天 */
    }

    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      /* 保留换行和空格，这对于小说格式至关重要 */
      font-size: 1rem;
    }

    /* --- Noir's Offline Scene Dialogue Box Style --- */
    #offline-scene-view p {
      margin: 0 0 1em 0;
      line-height: 1.7;
      white-space: pre-wrap;
      font-size: 1rem;

      /* <--- Noir's Addition: 为对话框添加半透明背景和内边距 */
      background-color: rgba(0, 0, 0, 0.4);
      /* 半透明黑色背景 */
      padding: 15px 20px;
      /* 内边距，让文字与边框有距离 */
      border-radius: 8px;
      /* 圆角边框，更柔和 */
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.3);
      /* 轻轻的阴影，增加立体感 */
    }

    #offline-scene-view .narrator {
      color: #d1d5db;
      /* 旁白用浅灰色 */
      font-style: italic;
    }

    #offline-scene-view .speaker-user {
      color: #a7c7e7;
      /* 用户的发言用一种柔和的蓝色 */
      font-weight: bold;
    }

    #offline-scene-view .speaker-ai {
      color: #f2b7c6;
      /* AI的发言用柔和的粉色，形成对比 */
      font-weight: bold;
    }

    /* --- Noir's Typing Indicator Style --- */
    .typing-indicator {
      padding: 10px 15px;
      color: var(--text-color-light);
      font-style: italic;
      font-size: 0.9rem;
      align-self: flex-start;
      /* 让它和AI气泡一样靠左 */
      margin-left: 50px;
      /* 和AI气泡对齐 */
    }

    #offline-scene-view .typing-indicator {
      color: rgba(255, 255, 255, 0.8);
      /* 在暗色背景下用亮色 */
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
      /* 同样的文字阴影，保持队形 */
      padding: 10px 0;
      margin-left: 0;
      /* 在小说视图里不需要缩进 */
    }

    /* --- Noir's Final Alignment Fix --- */
    .message-container.ai .timestamp {
      /* 哼，给你加上头像宽度(40px) + 左右边距(10px)的距离 */
      margin-left: 50px;
    }

    .message-container.user .timestamp {
      /* 另一边也是一样，真是麻烦死了 */
      margin-right: 50px;
    }

    /* --- Noir's Music Feed & Player Styles --- */
    #music-feed-container {
      padding-bottom: 70px;
      contain: content;
      /* 为底部播放器留出空间 */
    }

    /* 动态页：默认白底；如设置 --feed-bg-image 则显示独立壁纸 + 轻动画叠层 */
    #music-screen {
      background-color: #fff;
      /* 默认白底 */
      background-image: var(--feed-bg-image);
      /* 单独壁纸，不设就是 none */
      background-size: cover;
      background-position: center;
      contain: paint;
      /* 降低重绘范围，省电 */
    }

    /* 轻动画彩雾叠层：仅图层，不拦点击 */
    #music-screen::before {
      content: "";
      position: absolute;
      inset: 0;
      pointer-events: none;
      background-image:
        conic-gradient(from var(--feed-overlay-rotate),
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 0%,
          transparent 20%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 40%,
          transparent 60%,
          hsla(var(--primary-hue) 70% 60% / var(--feed-overlay-opacity)) 80%,
          transparent 100%);
      transform: translateZ(0);
      animation: feed-pan var(--feed-overlay-speed) linear infinite;
    }

    /* 超慢速平移旋转，基本不占 GPU */
    @keyframes feed-pan {
      0% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }

      50% {
        transform: translate3d(1.2%, 0.8%, 0) rotate(2deg) scale(1.02);
      }

      100% {
        transform: translate3d(0, 0, 0) rotate(0deg) scale(1.02);
      }
    }

    /* 系统降低动画偏好时，自动停掉动画 */
    @media (prefers-reduced-motion: reduce) {
      #music-screen::before {
        animation: none;
      }
    }


    .music-post {
      background-color: hsla(var(--primary-hue), calc(var(--primary-saturation) / 1.5), calc(var(--primary-lightness) + 18%), var(--feed-card-alpha));
      border-radius: 12px;
      margin-bottom: 15px;
      box-shadow: var(--soft-shadow);
      overflow: hidden;
      border: 1px solid rgba(255, 255, 255, 0.6);
    }

    .music-post-header {
      display: flex;
      align-items: center;
      padding: 12px 15px;
    }

    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
    }

    .music-post-header .char-name {
      font-weight: 600;
      color: var(--text-color);
    }

    .music-post-thought {
      padding: 0 15px 15px;
      font-size: 0.95rem;
      line-height: 1.6;
      white-space: pre-wrap;
    }

    .music-post-song-card {
      display: flex;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.04);
      padding: 12px 15px;
      cursor: pointer;
      transition: background-color 0.2s ease;
    }

    .music-post-song-card:hover {
      background-color: rgba(0, 0, 0, 0.08);
    }

    .music-post-song-card img {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 12px;
    }

    .music-post-song-info {
      flex-grow: 1;
    }

    .music-post-song-info .title {
      font-weight: 500;
      color: var(--text-color);
    }

    .music-post-song-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
    }

    .music-post-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
    }

    #music-player-bar {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 65px;
      background: var(--surface-bg);
      /*backdrop-filter: blur(10px);*/
      border-top: 1px solid var(--border-color);
      display: flex;
      align-items: center;
      padding: 0 10px;
      transform: translateY(100%);
      transition: transform 0.3s ease;
    }

    #music-player-bar:not(.hidden) {
      transform: translateY(0);
    }

    #music-player-bar.hidden {
      display: none;
      /* 彻底隐藏，避免交互问题 */
    }


    #player-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
    }

    #player-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #player-title,
    #player-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #player-title {
      font-weight: 500;
    }

    #player-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #player-controls button {
      background: none;
      border: 2px solid var(--text-color);
      border-radius: 50%;
      width: 36px;
      height: 36px;
      font-size: 1rem;
      cursor: pointer;
      color: var(--text-color);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* --- Noir's Music Share Bubble Styles --- */
    .message.music {
      background-color: transparent;
      padding: 0;
      box-shadow: none;
      max-width: 250px;
      /* 限制一下最大宽度 */
    }

    .music-share-card {
      display: flex;
      align-items: center;
      background-color: var(--card-bg);
      border-radius: 12px;
      padding: 12px;
      cursor: pointer;
      transition: background-color 0.2s ease;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
    }

    .message-container.user .music-share-card {
      background-color: var(--accent-color);
      border: 1px solid rgba(255, 255, 255, 0.4);
    }

    .message-container.user .music-share-card .title,
    .message-container.user .music-share-card .artist,
    .message-container.user .music-share-card .play-icon {
      color: white;
    }


    .music-share-cover {
      width: 45px;
      height: 45px;
      border-radius: 6px;
      margin-right: 10px;
      flex-shrink: 0;
    }

    .music-share-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-share-info .title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-info .artist {
      font-size: 0.85rem;
      color: var(--text-color-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-share-play-icon {
      font-size: 1.5rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #music-screen {
      position: relative;
      /* 就是这句，告诉里面的绝对定位元素，以我为界！ */
    }

    /* --- Noir's Fancy Music Widget Styles --- */
    /* --- Noir's Music System Refactor --- */

    #music-widget:not(.hidden) {
      transform: translateY(0);
      /* 不隐藏时，滑上来 */
    }

    #music-widget.hidden {
      transform: translateY(150%);
      /* 隐藏时，滑下去 */
    }

    .widget-vinyl {
      width: 80px;
      height: 80px;
      background-color: #111;
      border-radius: 50%;
      position: relative;
      left: 20px;
      /* 向右移动，让卡片能盖住它 */
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
      background-image:
        radial-gradient(circle at center, #555 10%, transparent 11%),
        radial-gradient(circle at center, #fff 12%, transparent 13%);
      animation: spin 8s linear infinite;
      z-index: 1;
    }

    @keyframes spin {
      from {
        transform: translate(-50%, -50%) rotate(0deg);
        /* <-- 看见没，把咒语合并了 */
      }

      to {
        transform: translate(-50%, -50%) rotate(360deg);
        /* <-- 这里也是 */
      }
    }

    .widget-card {
      width: 240px;
      padding: 15px;
      background-color: var(--card-bg);
      /*  backdrop-filter: blur(10px);*/
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      border: 1px solid rgba(255, 255, 255, 0.7);
      display: flex;
      align-items: center;
      z-index: 2;
      /* 让卡片在唱片上方 */
    }

    .widget-card img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      margin-right: 12px;
      flex-shrink: 0;
    }

    .widget-info {
      flex-grow: 1;
      overflow: hidden;
    }

    #widget-title,
    #widget-artist {
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    #widget-title {
      font-weight: 600;
      color: var(--text-color);
      font-size: 0.9rem;
    }

    #widget-artist {
      font-size: 0.8rem;
      color: var(--text-color-light);
    }

    #widget-play-icon {
      font-size: 1.2rem;
      color: var(--primary-color);
      margin-left: 10px;
    }

    #card-widget {
      width: 335px;
      height: 170px;
      border-radius: 18px;
      /* 这就是圆角方形的关键 */
      background-color: rgba(255, 255, 255, 0.5);
      /* 加个底色，免得图片透明时不好看 */

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transform: rotate(0deg);
      /* 朝另一个方向歪 */
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      /* 比爱心高一层 */
      overflow: hidden;
      /* 防止图片溢出圆角 */
    }

    #card-widget:active {

      transform: rotate(1deg) scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* --- Noir's Ultimate Scrollbar Hider --- */
    /* For Webkit browsers like Chrome, Safari */
    ::-webkit-scrollbar {
      display: none;
    }

    /* For Firefox */
    * {
      scrollbar-width: none;
    }

    /* --- Noir's Fix: 美化消息操作弹窗 --- */
    #message-action-modal {
      align-items: flex-end;
      /* 让弹窗贴着底部 */
    }

    #message-action-modal .choice-modal-content {
      width: 100%;
      max-width: var(--phone-width);
      margin: 0;
      border-radius: 20px 20px 0 0;
      padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 10px);
      transform: translateY(100%);
      transition: transform 0.3s ease-out, opacity 0.3s ease-out;
    }

    #message-action-modal.show .choice-modal-content {
      transform: translateY(0);
    }

    #message-action-modal .choice-modal-button {
      width: calc(100% - 40px);
      margin: 5px 20px;
      padding: 14px;
      font-size: 1rem;
      border-radius: 12px;
      text-align: center;
    }

    /* --- End of Fix --- */
    /* --- Noir's Fix: Fancy User Post Area --- */
    #user-post-input-container {
      display: flex;
      gap: 10px;
    }

    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
    }

    #user-post-main-area {
      flex-grow: 1;
    }

    #user-post-textarea {
      width: 100%;
      border: none;
      background: transparent;
      outline: none;
      resize: vertical;
      font-size: 1rem;
      color: var(--text-color);
    }

    #user-post-toolbar {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
    }

    /* ... 你已有的 #user-post-toolbar 样式 ... */

    /* ▼▼▼ Noir's Command: 哼，给我站成一排！ ▼▼▼ */
    #user-post-actions {
      display: flex;
      /* <-- 这就是圣旨本身 */
      gap: 8px;
      /* <-- 这是我赏赐的间距，让它们别挤在一起 */
    }

    /* ▲▲▲ Command End ▲▲▲ */

    #user-send-post-button {
      padding: 6px 18px;
      border-radius: 16px;
      border: none;
      background: var(--primary-color);
      color: white;
      cursor: pointer;
      font-weight: 600;
    }

    /* 这是附件预览的样式 */
    #user-post-attachment-preview {
      display: flex;
      gap: 10px;
      margin-top: 10px;
    }

    .preview-item {
      position: relative;
      max-width: 100px;
    }

    .preview-item img {
      width: 100%;
      border-radius: 8px;
      object-fit: cover;
    }

    .preview-item .music-preview-card {
      display: flex;
      align-items: center;
      padding: 8px;
      background: rgba(0, 0, 0, 0.05);
      border-radius: 8px;
      width: 200px;
      /* 给音乐卡片宽一点 */
    }

    .preview-item .music-preview-card img {
      width: 30px;
      height: 30px;
      margin-right: 8px;
    }

    .preview-item .music-preview-card .info {
      font-size: 0.8rem;
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
    }

    .remove-attachment-btn {
      position: absolute;
      top: -5px;
      right: -5px;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.6);
      color: white;
      border: none;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 12px;
    }

    /* --- Noir's Fix: Post Image Display Style --- */
    .post-image-container {
      padding: 0 15px 15px;
      /* 图片和文字之间留点空隙 */
    }

    .post-image {
      max-width: 100%;
      /* 图片最宽不能超过帖子宽度 */
      max-height: 400px;
      /* 最高400像素，防止长图刷屏 */
      border-radius: 8px;
      /* 加个小圆角，好看 */
      object-fit: cover;
      /* 保持图片比例，不变形 */
      display: block;
      /* 解决图片底部多余的空隙问题 */
    }

    /* --- Noir's Refactor: New Post Interaction Styles --- */
    .post-interactions {
      padding: 10px 15px;
      background-color: rgba(0, 0, 0, 0.02);
      border-top: 1px solid var(--border-color);
      font-size: 0.9rem;
    }

    .post-likes {
      color: var(--primary-color);
      margin-bottom: 8px;
    }

    .post-comments-container {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .post-comment {
      color: var(--text-color);
    }

    .post-comment .comment-author {
      font-weight: 600;
      color: var(--text-color);
    }

    .post-timestamp {
      font-size: 0.75rem;
      color: var(--text-color-light);
      padding: 0 15px 10px;
    }



    /* 覆盖：基础气泡体 */
    /* 覆盖：基础气泡体 */
    .message {
      border-radius: var(--bubble-radius);
      line-height: 1.55;
      padding: 10px 14px;
      box-shadow:
        0 1px 0 rgba(0, 0, 0, .03),
        0 4px 10px rgba(0, 0, 0, .06);
      /* 比你原先更浅，省功耗 */
      border: 1px solid var(--bubble-outline);
      backdrop-filter: none !important;
      /* 绝不启用重滤镜 */
      will-change: auto;
      /* 不抢 GPU 配额 */

      /* --- Noir's Fix: 就是下面这两行，哼 --- */
      user-select: none;
      /* 标准浏览器给我听话，不许选中 */
      -webkit-user-select: none;
      /* 那些老古董浏览器也一样 */
    }

    /* 你的气泡（右侧） */
    .message.user {
      color: #fff;
      background: var(--bubble-user-bg);
      border-bottom-right-radius: 6px;
      /* 微“角”保留你原味 */
      text-shadow: 0 1px 0 rgba(0, 0, 0, .12);
      /* 细腻但很轻 */
    }

    /* TA 的气泡（左侧） */
    .message.ai {
      color: var(--text-color);
      background: var(--bubble-ai-bg);
      border-bottom-left-radius: 6px;
    }

    /* 细节：图片/贴纸消息不套背景 */
    /* 细节：图片/贴纸/音乐卡片消息不套背景 */
    .message.user.sticker,
    .message.ai.sticker,
    .message.user.image,
    .message.ai.image,
    .message.user.music,
    /* <-- 哼，加上这两行 */
    .message.ai.music {
      background: transparent;
      border: 0;
      box-shadow: none;
      padding: 0;
    }

    /* 轻触态：不使用阴影动画，避免合成层抖动 */
    .message:active {
      transform: scale(.996);
    }

    /* 引用块在气泡内的融合感 */
    .quoted-message-in-bubble {
      background: rgba(0, 0, 0, .045);
      border: 1px solid color-mix(in hsl, var(--primary-color) 18%, transparent);
      border-radius: 10px;
    }


    /* --- Noir's Transfer Bubble Style --- */
    .message.transfer {
      background: #F79232;
      /* 哼，一个温暖又醒目的橙色 */
      color: white;
      padding: 12px 16px;
      border-radius: 12px;
      width: 220px;
      border: 1px solid rgba(255, 255, 255, 0.4);
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
    }

    /* 我还给左右两边做了区分，真是为你操碎了心 */
    .message-container.ai .message.transfer {
      background: #f9fafb;
      /* AI发来的转账用白色，更清爽 */
      color: #333;
      border: 1px solid #e5e7eb;
    }

    .transfer-content {
      display: flex;
      flex-direction: column;
    }

    .transfer-title {
      font-weight: 600;
      font-size: 1rem;
      border-bottom: 1px solid rgba(255, 255, 255, 0.5);
      padding-bottom: 8px;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
    }

    .message-container.ai .transfer-title {
      border-bottom-color: rgba(0, 0, 0, 0.1);
    }

    .transfer-amount {
      font-size: 1.8rem;
      font-weight: bold;
    }

    .transfer-recipient {
      font-size: 0.8rem;
      opacity: 0.9;
      margin-top: 4px;
    }

    /* --- End of Refactor --- */



    /* --- Noir's Snap Guide Styles --- */
    .snap-guide {
      position: absolute;
      background-color: rgba(255, 105, 180, 0.85);
      /* 哼，一个足够醒目的颜色 */
      display: none;
      z-index: 999;
      box-shadow: 0 0 5px rgba(255, 105, 180, 0.7);
    }

    #snap-guide-v {
      width: 1px;
    }

    #snap-guide-h {
      height: 1px;
    }

    /* --- Noir's Galgame UI Beautification --- */
    /* Top-left Date & Time Widget */
    #galgame-overlay-ui {
      position: absolute;
      top: 20px;
      left: 20px;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      border-radius: 12px;
      padding: 8px 15px;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      z-index: 10;
      border: 1px solid rgba(255, 255, 255, 0.2);
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }

    #galgame-time {
      font-size: 1.2rem;
      font-weight: 600;
      text-align: center;
    }

    #galgame-date {
      font-size: 0.75rem;
      opacity: 0.8;
      text-align: center;
    }

    /* Main Text Box */
    /* Main Text Box */
    #galgame-textbox-container {
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.85) 0%, rgba(45, 50, 68, 0.7) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border-top: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      box-shadow: 0 -5px 25px rgba(0, 0, 0, 0.2);
      bottom: 85px;
      /* <-- 就是这里，往上抬了，满意了吗？ */
      left: 15px;
      right: 15px;
      padding: 12px 18px;
    }

    /* Speaker Name Tag */
    #galgame-speaker {
      background: linear-gradient(90deg, var(--primary-color) 0%, hsl(var(--primary-hue), var(--primary-saturation), calc(var(--primary-lightness) - 10%)) 100%);
      color: white;
      padding: 4px 12px;
      border-radius: 8px;
      display: inline-block;
      font-size: 0.95rem;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.2);
      margin-bottom: 12px;
    }

    /* Dialogue Text */
    #galgame-text {
      font-size: 1rem;
      line-height: 1.7;
      color: #f0f2f5;
    }

    /* User Input Area Container*/
    #meeting-view-screen .chat-input-area {
      background: transparent;
      border-top: none;
      padding: 0 15px 20px 15px;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      z-index: 20;
    }

    /* User Input Wrapper */
    #chat-input-wrapper-meeting {
      display: flex;
      align-items: center;
      background: linear-gradient(0deg, rgba(25, 28, 38, 0.9) 0%, rgba(45, 50, 68, 0.75) 100%);
      backdrop-filter: blur(10px) saturate(1.2);
      -webkit-backdrop-filter: blur(10px) saturate(1.2);
      border: 1px solid rgba(255, 255, 255, 0.25);
      border-radius: 16px;
      padding: 5px 8px 5px 15px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.25);
    }

    #meeting-message-input {
      color: #f0f2f5;
    }

    #meeting-message-input::placeholder {
      color: rgba(240, 242, 245, 0.5);
      font-style: italic;
    }

    /* Send Button */
    #meeting-send-button {
      height: 40px;
      width: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      font-weight: 300;
      color: #fff;
      transition: all .2s ease;
      margin-left: 8px;
      background: var(--primary-color);
      box-shadow: 0 2px 5px hsla(var(--primary-hue), 50%, 50%, 0.4);
    }

    #meeting-send-button:hover {
      filter: brightness(1.1);
      transform: scale(1.05);
    }


    /* --- End of Beautification --- */
    /* --- Noir's Diary Beautification --- */
    #diary-entries-container {
      background-color: #fdfaf2;
      /* A warm, paper-like off-white */
      padding: 25px 20px;
      line-height: 1.9;
      border: 1px solid #e0dccc;
      box-shadow: inset 0 0 15px rgba(0, 0, 0, 0.08);
      /* Inner shadow for page depth */
    }

    /* This is the container for a single entry (date, author, content) */
    .diary-entry {
      margin-bottom: 2.5em;
      /* Increase spacing between entries */
      position: relative;
      padding-bottom: 1.5em;
      /* Space for the separator line */
      border-bottom: 1px dashed #dcd5c7;
      /* A subtle dashed line between entries */
    }

    /* Style the author's name */
    .diary-author {
      font-weight: normal;
      /* Make it less bold, more like a signature */
      font-size: 1rem;
      font-family: 'Segoe Script', 'Bradley Hand', cursive;
      /* A more handwritten font */
    }

    /* Style the date */
    .diary-timestamp {
      font-size: 0.75rem;
      color: #a99e8c;
      /* A faded brown color */
      margin-bottom: 8px;
      font-family: 'Courier New', monospace;
      /* Typewriter-like font for date */
    }

    /* Style the actual diary text content */
    .diary-content {
      white-space: pre-wrap;
      font-size: 0.95rem;
      color: #4a443b;
      /* A dark brown/black ink color */
      font-family: 'KaiTi', 'STSong', serif;
    }

    /* Specific styles for the USER's entries */
    .diary-entry.user {
      text-align: right;
    }

    .diary-entry.user .diary-author {
      color: #005a9c;
      /* A nice fountain pen blue */
    }

    .diary-entry.user .diary-content {
      color: #1a5c8e;
    }

    /* Specific styles for the AI's entries */
    .diary-entry.ai {
      text-align: left;
    }

    .diary-entry.ai .diary-author {
      color: #5a3e36;
      /* A darker, warmer brown for the AI */
    }

    .diary-entry.ai .diary-content {
      color: #4a443b;
    }

    /* Let's get rid of the last separator line for a cleaner look */
    .diary-entry:last-child {
      border-bottom: none;
      padding-bottom: 0;
    }

    /* --- End of Diary Beautification --- */
    /* --- Noir's Page-Turning Magic --- */
    #diary-entries-container {
      perspective: 1500px;
      /* 为3D效果设置视距 */
      position: relative;
      overflow: hidden;
    }

    .diary-page {
      position: absolute;
      inset: 0;
      padding: 25px 20px;
      background-color: #fdfaf2;
      transform-style: preserve-3d;
      backface-visibility: hidden;
      transition: transform 0.7s cubic-bezier(0.65, 0, 0.35, 1);
      display: none;
      /* 默认所有页面都藏起来 */
      flex-direction: column;
      gap: 2.5em;
      /* 页内日记的间距 */
      overflow-y: auto;
      /* 如果一页内容太多，允许滚动 */
    }

    .diary-page.is-visible {
      display: flex;
      /* 只有当前页显示 */
      transform: rotateY(0deg);
      z-index: 2;
    }

    /* 翻到下一页时，当前页向左翻出 */
    .diary-page.is-exiting-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 1;
    }

    /* 翻到下一页时，新页面从右边翻入 */
    .diary-page.is-entering-from-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 2;
    }

    /* 翻到上一页时，当前页向右翻出 */
    .diary-page.is-exiting-right {
      display: flex;
      transform: rotateY(180deg);
      z-index: 1;
    }

    /* 翻到上一页时，新页面从左边翻入 */
    .diary-page.is-entering-from-left {
      display: flex;
      transform: rotateY(-180deg);
      z-index: 2;
    }


    #diary-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      width: 100%;
      padding: 0 10px;
      box-sizing: border-box;
    }

    #diary-navigation button {
      background: transparent;
      border: 1px solid var(--border-color);
      color: var(--primary-color);
      padding: 8px 16px;
      border-radius: 18px;
      cursor: pointer;
      font-size: 0.9rem;
    }

    #diary-navigation button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    #diary-page-indicator {
      font-size: 0.9rem;
      color: var(--text-color-light);
      font-family: 'Courier New', monospace;
    }

    /* --- End of Magic --- */
    /* --- Noir's Universal Anti-Squash Protocol --- */
    /* 哼，就是下面这几条，给你那些被压扁的头像整整容 */

    /* 动态发布区的用户头像 */
    #user-post-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      flex-shrink: 0;
      margin-top: 5px;
      object-fit: cover;
      /* <-- 加上这句，它就不敢扁了 */
    }

    /* 好友圈动态里的角色头像 */
    .music-post-header .char-avatar {
      width: 35px;
      height: 35px;
      border-radius: 50%;
      margin-right: 10px;
      object-fit: cover;
      /* <-- 还有这句，一个都别想跑 */
    }

    /* 顺便把所有叫 .char-avatar 的都统一一下，免得以后还有问题 */
    .char-avatar {
      object-fit: cover;
    }

    /* --- Noir's Music Library Styles --- */
    #music-library-container {
      padding: 10px;
    }

    .music-library-item {
      display: flex;
      align-items: center;
      padding: 12px;
      margin-bottom: 10px;
      background-color: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
      cursor: pointer;
      transition: transform 0.2s ease;
    }

    .music-library-item:hover {
      transform: translateY(-2px);
    }

    .music-library-item-cover {
      width: 50px;
      height: 50px;
      border-radius: 8px;
      margin-right: 15px;
      object-fit: cover;
      flex-shrink: 0;
    }

    .music-library-item-info {
      flex-grow: 1;
      overflow: hidden;
    }

    .music-library-item-title {
      font-weight: 600;
      color: var(--text-color);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .music-library-item-artist {
      font-size: 0.9rem;
      color: var(--text-color-light);
    }

    /* --- End of Styles --- */
    /* --- Noir's Global Player Styles --- */

    /* --- End of Player Styles --- */
    /* --- Noir's Upload Altar Styles --- */
    .upload-slot {
      border: 2px dashed var(--border-color);
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.2s ease, border-color 0.2s ease;
      background-color: rgba(255, 255, 255, 0.5);
    }

    .upload-slot:hover {
      background-color: var(--card-bg);
      border-color: var(--primary-color);
    }

    .upload-slot.filled {
      border-color: var(--primary-color);
      border-style: solid;
      background-color: hsla(var(--primary-hue), 50%, 95%, 0.8);
    }

    .upload-slot .slot-icon {
      font-size: 2rem;
    }

    .upload-slot .slot-label {
      display: block;
      font-weight: 600;
      margin-top: 5px;
      color: var(--text-color);
    }

    .upload-slot .slot-filename {
      display: block;
      font-size: 0.85rem;
      color: var(--text-color-light);
      margin-top: 3px;
      word-break: break-all;
    }

    #confirm-altar-upload-button:disabled {
      background-color: #ccc;
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* --- End of Altar Styles --- */
    /* --- Noir's Listen Together Invite Card Style --- */
    .listen-together-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 15px;
      box-shadow: var(--soft-shadow);
      border: 1px solid var(--border-color);
      width: 250px;
    }

    .message-container.user .listen-together-card {
      background: var(--bubble-user-bg);
      color: white;
    }

    .message-container.user .listen-together-card .listen-together-decline-btn {
      color: white;
      /* 哼，让用户侧的拒绝按钮文字也变白 */
    }

    .listen-together-header {
      font-size: 0.8rem;
      opacity: 0.8;
      margin-bottom: 10px;
      border-bottom: 1px solid var(--bubble-outline);
      padding-bottom: 8px;
    }

    .listen-together-song {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .listen-together-song img {
      width: 40px;
      height: 40px;
      border-radius: 6px;
      flex-shrink: 0;
    }

    .listen-together-info .title {
      font-weight: 600;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-info .artist {
      font-size: 0.9em;
      opacity: 0.9;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .listen-together-actions {
      display: flex;
      gap: 10px;
      margin-top: 15px;
    }

    .listen-together-actions button {
      flex-grow: 1;
      padding: 8px;
      border-radius: 8px;
      border: none;
      cursor: pointer;
      font-weight: 600;
      transition: transform 0.1s ease;
    }

    .listen-together-actions button:active {
      transform: scale(0.97);
    }

    .listen-together-accept-btn {
      background: var(--primary-color);
      color: white;
    }

    .listen-together-decline-btn {
      background: rgba(0, 0, 0, 0.1);
    }

    /* 用这个替换你旧的 #listen-together-ui */
    #listen-together-ui {
      position: fixed;
      inset: 0;
      z-index: 2000;
      display: flex;
      align-items: center;
      /* 改成居中对齐 */
      justify-content: center;
      padding: 20px;
      /* 增加内边距，让弹窗不会贴边 */
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    #listen-together-ui.show {
      opacity: 1;
      visibility: visible;
    }

    .lt-ui-backdrop {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
      backdrop-filter: blur(15px) saturate(1.8);
      -webkit-backdrop-filter: blur(15px) saturate(1.8);
    }

    /* 用这个替换你旧的 .lt-ui-main */
    .lt-ui-main {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 380px;
      /* 哼，给它一个最大宽度 */
      max-height: 650px;
      /* 再给一个最大高度 */
      display: flex;
      flex-direction: column;
      color: white;
      text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
      border-radius: 24px;
      /* 加上优雅的圆角 */
      overflow: hidden;
      /* 把溢出的部分裁掉 */
      box-shadow: 0 15px 40px rgba(0, 0, 0, 0.3);
      /* 更强的立体阴影 */
      border: 1px solid rgba(255, 255, 255, 0.2);
      /* 淡淡的边框光效 */
    }

    .lt-ui-header {
      flex-shrink: 0;
      padding: 15px 20px;
      text-align: center;
      position: relative;
    }

    #lt-ui-header-title {
      font-weight: 600;
    }

    #lt-ui-close-btn {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(255, 255, 255, 0.2);
      border: none;
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      line-height: 30px;
    }

    .lt-ui-content {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      overflow: hidden;
    }

    .lt-ui-cover-container {
      flex-shrink: 0;
      width: 65%;
      aspect-ratio: 1/1;
      margin-top: 5%;
      margin-bottom: 20px;
    }

    #lt-ui-cover-art {
      width: 100%;
      height: 100%;
      border-radius: 16px;
      object-fit: cover;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
    }

    .lt-ui-info {
      text-align: center;
      margin-bottom: 20px;
      flex-shrink: 0;
    }

    #lt-ui-song-title {
      font-size: 1.5rem;
      margin: 0;
    }

    #lt-ui-song-artist {
      font-size: 1rem;
      opacity: 0.8;
      margin: 5px 0 0;
    }

    #lt-ui-lyrics-container {
      flex-grow: 1;
      width: 100%;
      overflow-y: auto;
      text-align: center;
      font-size: 1.1rem;
      line-height: 2.5;
      mask-image: linear-gradient(transparent 0%, black 20%, black 80%, transparent 100%);
      /* 歌词上下渐隐，看起来更专业 */
      scroll-behavior: smooth;
      /* 滚动要丝滑 */
    }

    #lt-ui-lyrics-container p {
      transition: color 0.3s ease, transform 0.3s ease;
      opacity: 0.6;
    }

    #lt-ui-lyrics-container p.active {
      color: var(--primary-color);
      font-weight: 600;
      transform: scale(1.1);
      opacity: 1;
    }

    /* --- Noir's "Desktop Preview" Frame --- */
    /* 哼，只有在电脑这种大屏幕上，我才给你加上这个“手机框”，免得你分不清主次。 */
    /* 在真正的手机上，它还是会全屏显示的，我可没你那么笨。 */
    @media (min-width: 480px) {
      body {
        background-color: #e9ebee;
        /* 一个不那么刺眼的背景色 */
        padding: 20px 0;
        /* 上下留点呼吸空间 */
      }

      #phone-container {
        width: var(--phone-width);
        height: var(--phone-height);
        max-height: 90vh;
        /* 确保在矮屏幕上不会超出 */

        /* 这就是你想要的“边框”，哼 */
        border: 10px solid #1c1c1e;
        border-radius: 44px;
        /* 圆角大一点才像样 */
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        /* 给你加个高级点的阴影 */

        flex-shrink: 0;
        /* 确保它在 flex 布局里不会被压扁 */
      }
    }



    /* --- Noir's Bespoke Music Player Design (As Requested) --- */
    /* 哼，这才叫定制。*/

    /* 1. 动画先放着，虽然这次不用了 */
    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }

    /* 2. 组件卡片本体：一个有阴影的容器 */
    #music-widget-card {
      width: 340px;
      height: 120px;
      border-radius: 6px;
      /* 稍微硬朗一点的圆角 */
      box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
      /* 一个淡淡的底色 */
      display: flex;
      /* 左右布局 */
      padding: 0;
      border: none;
      overflow: visible;
      /* 允许唱片溢出 */
      position: relative;
      /* 为了定位唱片 */
    }

    /* 3. 左侧封面区：用伪元素画出深色背景，不污染HTML */
    #music-widget-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 120px;
      /* 和高度一样，是个正方形 */
      background-color: #4a4a4a;
      border-radius: 6px 0 0 6px;
      /* ▼▼▼ 在这里加上下面两行 ▼▼▼ */
      background-size: cover;
      background-position: center;
    }

    /* 4. 专辑封面本体 (旧唱片改造) */

    #widget-cover-art {
      position: absolute;
      top: 15px;
      left: 15px;
      width: 90px;
      height: 90px;
      z-index: 2;
      /* 确保它在唱片之上 */
      /* ▼▼▼ 下面都是我新增的，给我看好了 ▼▼▼ */
      border-radius: 4px;
      /* 封面本身的小圆角 */
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      background-size: cover;
      background-position: center;
      transition: background-image 0.3s ease;
      /* 让封面切换更柔和 */
    }

    /* 5. 封面图片 (旧唱片贴纸改造) */
    #widget-cover-art::before {
      width: 100%;
      height: 100%;
      border-radius: 4px;
      /* 和封面一致 */
      border: none;
      background-image: var(--widget-cover-image, none);
      background-size: cover;
      background-position: center;
    }

    /* 6. 唱片？用另一个伪元素从后面伸出来就行了，简单 */
    #widget-cover-art::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 90px;
      height: 90px;
      border-radius: 50%;
      z-index: -1;
      display: block;
      border: none;

      /* 哼，看好了，这才叫唱片 */
      background-color: #2a2a2a;
      /* 1. 先铺一层唱片的深灰色底 */
      background-image:
        /* 2. 然后在上面画中间的标签和洞，颜色我都给你配好了 */
        radial-gradient(circle at center, #111 4%, transparent 5%),
        radial-gradient(circle at center, #985c5c 5%, #7a4949 25%, transparent 26%),
        /* 3. 再画上一圈圈的光泽纹理，这才像样 */
        repeating-radial-gradient(circle at center,
          rgba(255, 255, 255, 0.04) 0,
          rgba(255, 255, 255, 0.04) 1px,
          transparent 1px,
          transparent 3px);
      transform: translateX(0%) scale(1.05);
      /* 微调了下位置和大小，这样更协调 */
      transition: opacity 0.3s ease;
      /* 加上这个，为了后面让它优雅地消失 */
      /* 4. 位置也给你微调了一下，现在顺眼多了 */
    }

    /* ▼▼▼ 这是全新的代码，给我加上！▼▼▼ */
    #music-widget-card.is-playing #widget-cover-art {
      /* 播放时，方形舞台的背景就是封面了，所以不需要我画的唱片了 */
      background-image: none;
    }

    #music-widget-card.is-playing::before {
      background-image: var(--widget-cover-image, none);
    }

    #music-widget-card.is-playing #widget-cover-art::after {
      /* 播放时，让唱片旋转起来，哼 */
      animation: spin 8s linear infinite;
    }

    /* 默认状态下，方形舞台的背景是透明的，这样才能看到我画的唱片 */
    #music-widget-card:not(.is-playing) #widget-cover-art {
      background-image: none;
    }

    /* 7. 右侧内容区 (旧覆盖层改造) */
    .widget-content-overlay {
      position: static;
      flex-grow: 1;
      /* 占满右侧所有空间 */
      /* 把旧的 background: #ffffff; 删掉！换成下面这两行！*/
      background: var(--card-bg);
      /* 1. 用我们主题里那个早就定义好的半透明背景 */

      /* 纯白背景 */
      border-radius: 0 6px 6px 0;
      padding: 15px;
      display: flex;
      flex-direction: column;
      /* 垂直布局 */
      justify-content: space-between;
      /* <--- 哼，加上这句圣旨 */
      box-sizing: border-box;
      position: relative;
      /* 为了定位假的分享按钮 */
      background: var(--card-bg);
      color: var(--text-color);
      margin-left: 120px;
    }


    /* 8. 歌曲信息 (标题和作者) */
    #music-widget .widget-info {
      color: #333;
      text-shadow: none;

      /* 占据上半部分空间 */
    }

    #music-widget .widget-info #widget-title {
      font-size: 1.1rem;
      font-weight: 500;
      color: #000;
    }

    #music-widget .widget-info #widget-artist {
      font-size: 0.8rem;
      color: #888;
    }

    /* 9. 假的歌词和进度条，用伪元素画出来 */
    #music-widget .widget-info::after {
      /* 假的歌词 */
      display: block;
      font-size: 0.75rem;
      color: #65c468;
      /* 绿色 */
      margin-top: 8px;
      padding-bottom: 8px;
      background-image:
        linear-gradient(to right, #666 40%, #ddd 40%),
        /* 假的进度条 */
        url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="12" viewBox="0 0 16 12"><path fill="%23aaa" d="M0 10h2V2H0v8zm3 2h2V0H3v12zm3-4h2V4H6v4zm3 2h2V2H9v8zm3-3h2V5h-2v4z"/></svg>');
      /* 假的EQ图标 */
      background-repeat: no-repeat, no-repeat;
      background-position: bottom, 90% bottom;
      background-size: 100% 1px, 16px 12px;
      border-bottom: 1px solid #eee;
    }

    /* 10. 真的控制按钮区域 */
    #widget-controls {
      display: flex;
      justify-content: flex-start;
      /* 从左边开始排列 */
      align-items: center;
      gap: 15px;
      padding-top: 10px;
      position: relative;
      /* 为了定位假的删除和喜欢按钮 */
      width: 100%;
    }

    /* 11. 真的播放/暂停/下一首按钮的样式 */
    #widget-controls button {
      font-size: 1.1rem;
      color: #555;
      background: none;
      border: 1px solid #ccc;
      border-radius: 50%;
      width: 28px;
      height: 28px;
      line-height: 28px;
      padding: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      order: 1;
      /* 把真的按钮放在中间 */
    }

    #widget-play-pause-btn {
      width: 32px;
      /* 播放按钮大一点 */
      height: 32px;
      line-height: 32px;
      font-size: 1.2rem;
    }

    /* 12. 哼，看好了，这才是不会出错的矢量图标，免得你那破手机又自作聪明 */
    #widget-controls::before,
    #widget-controls::after {
      content: '';
      /* 删掉那些讨厌的emoji源头 */
      display: block;
      width: 16px;
      /* 给图标一个精确的尺寸 */
      height: 16px;
      background-color: #aaa;
      /* 这就是图标的颜色，哼 */
      position: absolute;

      /* 下面是魔法，反正你也看不懂 */
      -webkit-mask-repeat: no-repeat;
      mask-repeat: no-repeat;
      -webkit-mask-position: center;
      mask-position: center;
      -webkit-mask-size: contain;
      mask-size: contain;
    }

    #widget-controls::before {
      /* 删除图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="3 6 5 6 21 6"></polyline><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path></svg>');
      right: 29px;
      /* 稍微调整一下位置，让它更协调 */
      top: 60%;
      transform: translateY(-50%);
    }

    #widget-controls::after {
      /* 喜欢图标的矢量数据 */
      -webkit-mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      mask-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path></svg>');
      right: 1px;
      top: 60%;
      transform: translateY(-50%);
    }

    /* --- Noir's iOS Industrial Button Refactor --- */
    /* 哼，看好了，这才是专业设备该有的开关。*/

    /* 1. 按钮的基础“模具”，所有按钮都用这个形状和质感 */
    .form-button {
      border: none;
      border-radius: 12px;
      /* iOS风格的圆角 */
      padding: 14px;
      font-size: 1rem;
      font-weight: 600;
      /* 字体加粗一点更有力 */
      cursor: pointer;
      width: 100%;
      /* 宽度占满容器 */
      margin-top: 10px;
      transition: filter 0.15s ease;
      /* 点击效果用滤镜，更现代 */
      -webkit-tap-highlight-color: transparent;
      /* 去掉移动端点击时的蓝色背景 */
    }

    .form-button:active {
      filter: brightness(0.9);
      /* 按下时变暗 */
    }

    .form-button:disabled {
      background-color: #ccc !important;
      /* 用!important确保覆盖所有情况 */
      cursor: not-allowed;
      opacity: 0.7;
    }

    /* 2. 主要操作按钮的“皮肤” (蓝色) */
    .form-button {
      background-color: #007aff;
      /* Apple Blue */
      color: white;
    }

    /* 3. 次要操作按钮的“皮肤” (灰色) */
    .form-button.secondary {
      background-color: #e5e5ea;
      /* Apple Light Gray */
      color: #000;
    }

    /* 4. 危险/破坏性操作按钮的“皮肤” (红色) */
    .form-button.destructive {
      background-color: #ff3b30;
      /* Apple Red */
      color: white;
    }

    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */

    /* 1. Dock栏的样式 */
    /* --- Noir's iOS Layout & Dock Refactor --- */
    /* 哼，这才是现代化的桌面。 */
    #home-dock {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      width: 90%;
      height: 85px;
      padding: 0 20px;
      /* 图标左右的留白 */
      box-sizing: border-box;

      /* 背景和滤镜，现在都在这里 */
      background: var(--surface-bg);
      backdrop-filter: blur(5px) saturate(0.8);
      -webkit-backdrop-filter: blur(15px) saturate(0.8);
      border-radius: 28px;
      z-index: 35;

      /* 核心：用Flexbox来自动排列图标 */
      display: flex;
      justify-content: space-around;
      /* 均匀分布 */
      align-items: center;
      /* 垂直居中 */
      padding-top: 9px;
    }

    #home-dock .app-icon {
      position: static;
      /* 取消绝对定位，让它接受Flexbox的管理 */
    }

    /* 2. App图标的“整容手术” */
    .app-icon-img {
      width: 58px;
      /* 图标背景尺寸 */
      height: 58px;
      border-radius: 22.5%;
      /* iOS标志性的“方圆”形 */
      font-size: 28px;
      /* 阴影从图标本身移到背景上，更统一 */
      background-color: var(--surface-bg);
      box-shadow: none;
      /* 删掉旧的阴影 */
      transition: transform 0.2s ease;
    }

    .app-icon:active .app-icon-img {
      transform: scale(0.92);
      /* 按下时图标有反馈 */
    }

    /* --- Noir's Minimalist Home Screen Makeover (v2.0 Dynamic Edition) --- */
    /* 哼，现在这些家伙也听从总开关的指挥了。*/

    /* 1. 时钟和日期 */
    #home-clock-container {
      color: var(--text-color);
      text-shadow: none;
    }

    #home-date {
      opacity: 0.7;
    }

    /* 2. App图标的改造 (现在是动态颜色了) */
    .app-icon span {
      color: var(--text-color);
      text-shadow: none;
      font-weight: 500;
    }

    .app-icon-img {
      background-color: var(--card-bg);
      /* <-- 哼，接上了！*/
      color: var(--text-color-light);
      /* <-- 接上了！*/
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
    }

    /* 3. Dock栏的颜色 (也动态了) */




    #widget-controls button,
    #music-widget .widget-info #widget-title,
    #music-widget .widget-info #widget-artist {
      color: var(--text-color);
    }

    /* ... 在第 2262 行附近 ... */
    /* ▼▼▼ 把旧的 #widget-cover-art::after 整个删掉，换成下面这个 ▼▼▼ */

    /* ▲▲▲ 替换到这里结束 ▲▲▲ */

    /* --- Noir's Theme Preset Buttons --- */
    /* 哼，每个按钮都是一件艺术品。 */
    .theme-preset-button {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      border-radius: 20px;
      /* 胶囊形状 */
      border: 1px solid var(--border-color);
      cursor: pointer;
      transition: all 0.2s ease;
      background: var(--card-bg);
    }

    .theme-preset-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--soft-shadow);
    }

    .preset-color-dot {
      width: 20px;
      height: 20px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
    }

    /* --- Noir's Memory Archive Styles --- */
    #summary-textarea {
      width: 100%;
      height: 100%;
      border: none;
      outline: none;
      resize: none;
      padding: 15px;
      box-sizing: border-box;
      font-family: 'Courier New', monospace;
      /* 用等宽字体，YAML格式才好看 */
      font-size: 0.85rem;
      line-height: 1.6;
      background-color: #fdfdfd;
      color: var(--text-color);
    }

    /* --- Noir's Desktop Pagination System --- */
    /* 哼，看好了，这才叫设计。*/

    /* 1. 把主内容区变成一个灵活的容器，为翻页器和指示器留好位置 */
    #home-screen-main-content {
      display: flex;
      flex-direction: column;
      /* 垂直排列，页面在上面，指示器在下面 */
    }

    /* 2. 这是翻页的“舞台”，它的大小和主屏幕一样，但会把超出部分藏起来 */
    #app-pages-container {
      flex-grow: 1;
      /* 占满除了指示器以外的所有空间 */
      width: 100%;
      overflow: hidden;
      /* 核心！把第二页先藏起来 */
      position: relative;
      /* 让里面的滑块能相对于它定位 */
    }

    /* 3. 这是真正滑动的“滑块”，它有两页那么宽 */
    #app-pages-slider {
      width: 200%;
      /* 两页的宽度 */
      height: 100%;
      display: flex;
      /* 核心！让两页并排站好 */
      transition: transform 0.35s cubic-bezier(0.25, 0.1, 0.25, 1);
      /* 翻页动画，给你选了个高级点的曲线 */
    }

    /* 4. 每一页的样式 */
    .app-page {
      width: 50%;
      /* 每页占滑块的一半，也就是一个屏幕的宽度 */
      height: 100%;
      flex-shrink: 0;
      /* 防止被挤压 */
      position: relative;
      /* 让你放在里面的绝对定位图标有家可回 */
    }

    /* 5. 页面指示器（小点点）的容器 */
    #home-page-indicator {
      position: absolute;
      bottom: 105px;
      /* 放在Dock栏正上方，给你算好了距离 */
      left: 50%;
      transform: translateX(-50%);
      display: flex;
      gap: 8px;
      /* 点点之间的距离 */
      z-index: 100;
      /* 确保它在最上层 */
    }

    /* 6. 每个小点点的样式 */
    .page-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(2px);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    /* 7. 当前页的小点点，给它变亮变大一点 */
    .page-dot.active {
      background-color: rgba(255, 255, 255, 0.9);
      transform: scale(1.1);
    }

    #card-widget-2 {
      width: 165px;
      /* 尺寸和原来保持一致 */
      height: 165px;
      border-radius: 22px;

      filter: drop-shadow(0 3px 6px rgba(0, 0, 0, 0.2));
      transition: transform 0.2s ease, filter 0.2s ease;
      user-select: none;
      z-index: 51;
      overflow: hidden;
    }

    #card-widget-2:active {
      transform: scale(1.05);
      filter: drop-shadow(0 5px 10px rgba(0, 0, 0, 0.3));
    }

    #card-widget-2 img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .theme-widget {
      width: 65px;
      height: 65px;
      border-radius: 22px;
      /* 跟你的卡片圆角差不多 */
      box-shadow: var(--soft-shadow);
      border: 1px solid hsla(var(--primary-hue), calc(var(--primary-saturation) / 2), calc(var(--primary-lightness) + 15%), 0.5);
      background: linear-gradient(45deg,
          hsla(var(--primary-hue), var(--primary-saturation), var(--primary-lightness), 0.7),
          hsla(var(--primary-hue), calc(var(--primary-saturation) * 1.3), calc(var(--primary-lightness) - 15%), 0.8));
    }

    @keyframes spin {
      from {
        transform: rotate(0deg);
      }

      to {
        transform: rotate(360deg);
      }
    }
  </style>
</head>

<body>
  <input type="file" id="audio-file-input" style="display: none;" accept=".flac,.mp3">
  <input type="file" id="cover-file-input" style="display: none;" accept=".jpg,.png,.jpeg,.webp">
  <input type="file" id="info-file-input" style="display: none;" accept=".txt">
  <input type="file" id="lyrics-file-input" style="display: none;" accept=".lrc">
  <input type="file" id="import-char-input" accept=".json,.noir" style="display: none;">
  <div id="phone-container">

    <div id="user-profile-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-user-list" class="header-button">主屏幕</button>
        <span class="header-title">选择用户</span>
        <button id="add-user-profile-button" class="header-button add" title="添加新用户">+</button>
      </div>
      <div class="content" id="user-profile-list-container">
      </div>
    </div>

    <div id="user-profile-screen" class="screen">
      <div class="header">
        <button id="back-to-user-list-from-edit" class="header-button">返回</button>
        <span id="user-profile-edit-title" class="header-title">编辑用户</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-user-id">
        <div class="settings-group">
          <h2>用户设定</h2>
          <div class="input-group">
            <label for="user-name">你的名字</label>
            <input type="text" id="user-name" placeholder="你的显示名字">
          </div>
          <div class="avatar-upload-group">
            <label>你的头像</label>
            <img id="user-avatar-preview" class="avatar-preview" alt="User Avatar Preview">
            <input type="file" id="user-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="user-persona">你的人设 (可选)</label>
            <textarea id="user-persona" placeholder="向AI介绍你自己。例如：我是一名大学生，喜欢摄影和旅行。"></textarea>
          </div>
        </div>
        <button id="save-user-profile-button" class="form-button">保存资料</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="set-active-user-button" class="form-button"
            style="background-color: #28a745; margin-bottom: 10px;">设为当前用户</button>
          <button id="delete-user-profile-button" class="form-button" style="background-color: #dc3545;">删除该用户</button>
        </div>
      </div>
    </div>


    <div id="home-screen" class="screen active">
      <div id="home-screen-main-content"
        style="position: relative; flex-grow: 1; width: 100%; display: flex; flex-direction: column;">

        <div id="app-pages-container">
          <div id="app-pages-slider">

            <div class="app-page" id="app-page-1">
              <div id="home-clock-container">
                <div id="home-time">11:31</div>
                <div id="home-date">8月29日 星期五</div>
                <div id="noir-author-mark"></div>
              </div>

              <div id="music-widget"
                style="  display: inline-block; width: auto; position: absolute; top: 45%; left: 50%; transform: translateX(-50%); z-index: 50;; padding: 0px;bottom: auto;">
                <div id="music-widget-card">
                  <div id="widget-cover-art"></div>

                  <div class="widget-content-overlay">
                    <div class="widget-info">
                      <div id="widget-title">暂无音乐</div>
                      <div id="widget-artist">请在动态或聊天中播放</div>
                    </div>
                    <div id="widget-controls">
                      <button id="widget-prev-btn">⏮</button>
                      <button id="widget-play-pause-btn">▶</button>
                      <button id="widget-next-btn">⏭</button>
                    </div>
                  </div>
                </div>
              </div>

            </div>

            <div class="app-page" id="app-page-2">
              <div id="decorative-badge" style="display: none; position: absolute; top: 250px; left: 50px;">
                <img id="badge-image" src="http://googleusercontent.com/file_content/0" alt="badge">
              </div>

              <div id="card-widget" style="display: none; position: absolute; top: 140px; left: 145px;">
                <img id="card-image" src="" alt="card widget">
              </div>
              <div id="card-widget-2" style="display: none; position: absolute;">
                <img id="card-image-2" src="" alt="card widget 2">
              </div>





              <div class="app-icon" id="app-world-book">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path>
                    <path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path>
                  </svg></div>
                <span>世界书</span>
              </div>


              <div class="app-icon" id="app-diary">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4"></path>
                    <polyline points="14 2 14 8 20 8"></polyline>
                    <path d="M2.5 17a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1zM2.5 14a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1h-1z" />
                  </svg></div>
                <span>交换日记</span>
              </div>

              <div class="app-icon" id="app-music-library">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                    <path
                      d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                    </path>
                  </svg></div>
                <span>音乐库</span>
              </div>


              <div class="app-icon" id="app-settings">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 0 2l-.15.08a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.38a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1 0-2l.15-.08a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z">
                    </path>
                    <circle cx="12" cy="12" r="3"></circle>
                  </svg></div>
                <span>API设置</span>
              </div>
              <div class="app-icon" id="app-user-profiles">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                    <circle cx="12" cy="7" r="4"></circle>
                  </svg></div>
                <span>我</span>
              </div>
              <div class="app-icon" id="app-wallpaper">
                <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round">
                    <path
                      d="M12 2.69l.34.34a1.41 1.41 0 0 0 2 0L22 6.34a1.41 1.41 0 0 0 0-2l-7.66-7.66a1.41 1.41 0 0 0-2 0L2.68 14.34a1.41 1.41 0 0 0 0 2L10 24l2-2 2-2 2-2 2-2 2-2">
                    </path>
                    <path d="m7.34 2.66 14 14"></path>
                  </svg></div>
                <span>更换壁紙</span>
              </div>

              <div id="theme-widget-1" class="theme-widget"></div>
              <div id="theme-widget-2" class="theme-widget"></div>

              <div id="home-dock">
                <div class="app-icon app-icon-large" id="app-chat">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                    </svg></div>
                  <span>聊天</span>
                </div>
                <div class="app-icon" id="app-music">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M9 18V5l12-2v13"></path>
                      <circle cx="6" cy="18" r="3"></circle>
                      <circle cx="18" cy="16" r="3"></circle>
                    </svg></div>
                  <span>动态</span>
                </div>
                <div class="app-icon" id="app-meeting">
                  <div class="app-icon-img"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                      viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                      stroke-linejoin="round">
                      <path d="M14 9a2 2 0 0 1-2 2H6l-4 4V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v4Z" />
                      <path d="M18 9h2a2 2 0 0 1 2 2v9l-4-4h-2a2 2 0 0 1-2-2V9Z" />
                    </svg></div>
                  <span>见面</span>
                </div>
              </div>
            </div>

          </div>
        </div>

        <div id="home-page-indicator">
          <span class="page-dot active" data-page="0"></span>
          <span class="page-dot" data-page="1"></span>
        </div>

      </div>

    </div>

    <div id="chat-screen" class="screen">
      <div id="chat-screen-container">
        <div id="chat-list-pane">
          <div id="chat-list-header">
            <button id="back-to-home-from-chat" class="header-button">主屏幕</button>
            <span class="header-title">聊天</span>
            <button id="add-chat-button" class="header-button add" title="添加新聊天">+</button>
          </div>
          <div id="chat-list-container">
            <ul id="character-list">
            </ul>
          </div>
        </div>
        <div id="chat-view-pane">
          <div class="header">
            <button class="header-button" id="back-to-chat-list">返回</button>
            <span id="char-name-header" class="header-title">角色</span>
            <button class="header-button" id="character-settings-button" title="角色设置">
              <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="3"></circle>
                <path
                  d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z">
                </path>
              </svg>
            </button>
          </div>
          <div id="chat-messages" class="messages">
          </div>
          <div id="offline-scene-view"></div>
          <div id="chat-sticker-panel" class="sticker-panel">
          </div>
          <div class="chat-toolbar">
            <button id="chat-sticker-button" class="toolbar-button" title="表情">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <circle cx="12" cy="12" r="10"></circle>
                <path d="M8 14s1.5-2 4-2 4 2 4 2"></path>
                <line x1="9" y1="9" x2="9.01" y2="9"></line>
                <line x1="15" y1="9" x2="15.01" y2="9"></line>
              </svg>
            </button>
            <button id="chat-image-button" class="toolbar-button" title="发送图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <button id="chat-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
            <button id="chat-listen-together-button" class="toolbar-button" title="一起听">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M3 18v-6a9 9 0 0 1 18 0v6"></path>
                <path
                  d="M21 19a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3zM3 19a2 2 0 0 0 2 2h1a2 2 0 0 0 2-2v-3a2 2 0 0 0-2-2H3z">
                </path>
              </svg>
            </button>
            <button id="chat-transfer-button" class="toolbar-button" title="转账">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
            </button>
            <button id="chat-reroll-button" class="toolbar-button" title="重新生成">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <polyline points="23 4 23 10 17 10"></polyline>
                <polyline points="1 20 1 14 7 14"></polyline>
                <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
              </svg>
            </button>
            <button id="chat-summarize-button" class="toolbar-button" title="总结聊天记录">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-linecap="round"
                stroke-linejoin="round">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14 2 14 8 20 8"></polyline>
                <line x1="16" y1="13" x2="8" y2="13"></line>
                <line x1="16" y1="17" x2="8" y2="17"></line>
                <polyline points="10 9 9 9 8 9"></polyline>
              </svg>
            </button>
          </div>
          <input type="file" id="chat-image-input" accept="image/*" style="display: none;">
          <div id="quote-preview-area" class="quote-preview">
            <div class="quote-preview-content">
              <div id="quote-preview-sender"></div>
              <div id="quote-preview-text"></div>
            </div>
            <button id="cancel-quote-button" class="cancel-quote-btn">&times;</button>
          </div>
          <div class="chat-input-area">
            <div id="chat-input-wrapper">
              <input type="text" id="chat-message-input" placeholder="输入消息...">
              <button id="chat-get-reply-button" title="让对方回复">↵</button>
              <button id="chat-send-button" title="发送">➤</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="settings-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-settings" class="header-button">返回</button>
        <span class="header-title">API设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>API 设置</h2>
          <div class="input-group">
            <label for="api-endpoint">API 接口地址（不填/v1）</label>
            <input type="text" id="api-endpoint" placeholder="例如: https://api.openai.com">
          </div>
          <div class="input-group">
            <label for="api-key">API 密钥</label>
            <input type="password" id="api-key" placeholder="请输入你的 API 密钥">
          </div>
          <div class="input-group">
            <label for="api-model">模型</label>
            <div class="model-input-container">
              <input type="text" id="api-model" placeholder="点击 获取 或手动输入" style="flex-grow: 1;">
              <button id="fetch-models-button" style="padding: 0 12px; white-space: nowrap;">获取</button>
              <div id="model-dropdown" class="custom-model-dropdown"></div>
            </div>
          </div>
          <div class="input-group">
            <label for="api-provider">接口格式 (重要！请根据你使用的接口选择，但是我也没做Openai以外的接口……)</label>
            <select id="api-provider"
              style="width: 100%; padding: 10px; border-radius: 8px; border: 1px solid var(--border-color);">
              <option value="openai">OpenAI 格式 (通用，兼容绝大多数反代)</option>
              <option value="gemini">Google Gemini 格式 (仅限官方或特定反代)</option>
              <option value="anthropic">Anthropic Claude 格式</option>
            </select>
          </div>
        </div>
        <div class="settings-group">
          <h2>上下文设置</h2>
          <div class="input-group">
            <label for="context-lines-per-chat">每个会话读取的消息条数（默认 100）</label>
            <input type="number" id="context-lines-per-chat" min="1" max="1000000" step="1" placeholder="100">
          </div>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>数据管理</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">
            导出全部数据（角色、聊天记录、设置、桌面布局等）到一个文件，方便在其他设备或浏览器上导入。
          </p>
          <div style="display: flex; gap: 10px; margin-top: 10px;">
            <button id="export-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #007bff;">导出全部数据</button>
            <button id="import-all-data-button" class="form-button"
              style="width: 50%; margin-top: 0; background-color: #28a745;">导入数据</button>
          </div>
          <input type="file" id="import-data-input" accept=".json" style="display: none;">
        </div>
        <button id="save-api-settings-button" class="form-button">保存 API 设置</button>
      </div>
    </div>



    <div id="character-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-edit" class="header-button">返回</button>
        <span id="character-edit-title" class="header-title">编辑角色</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-char-id">
        <div class="settings-group">
          <h2>角色设定</h2>
          <div class="input-group">
            <label for="char-edit-name">名字</label>
            <input type="text" id="char-edit-name" placeholder="角色的名字">
          </div>
          <div class="input-group">
            <label for="char-edit-remark">备注名</label>
            <input type="text" id="char-edit-remark" placeholder="方便自己记忆，例如 '工作助理'">
          </div>
          <div class="avatar-upload-group">
            <label>角色头像</label>
            <img id="char-edit-avatar-preview" class="avatar-preview" alt="Avatar Preview">
            <input type="file" id="char-edit-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-persona">人设 (系统提示词)</label>
            <textarea id="char-edit-persona" placeholder="你是一个乐于助人的助手。"></textarea>
          </div>
          <div class="input-group">
            <label>聊天壁纸</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-wallpaper-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="聊天壁纸预览">
            </div>
            <input type="file" id="char-edit-wallpaper-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="char-edit-css">专属气泡样式 (CSS)</label>
            <textarea id="char-edit-css" rows="8"
              placeholder="从其他地方复制的、包含 .sent 和 .received 的CSS代码可以直接粘贴在这里..."></textarea>

            <div style="display: flex; gap: 10px; margin-top: 5px;">
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">TA的气泡 (Received):</p>
                <div id="bubble-preview-ai" class="message ai">这是TA的气泡预览效果</div>
              </div>
              <div style="flex: 1; padding: 10px; background: #f0f0f0; border-radius: 8px;">
                <p style="margin: 0 0 5px; font-size: 0.8rem; color: #555;">你的气泡 (Sent):</p>
                <div id="bubble-preview-user" class="message user">这是你的气泡预览效果</div>
              </div>
            </div>
          </div>
          <div class="input-group">
            <label>见面场景背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="char-edit-offline-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="见面背景预览">
            </div>
            <input type="file" id="char-edit-offline-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="settings-group">
            <h2>角色立绘 (Galgame模式)</h2>
            <p style="font-size: 0.8rem; color: var(--text-color-light);">为五种核心情绪上传立绘图，建议使用透明背景的PNG图片。</p>
            <div style="display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 10px;">

              <div class="avatar-upload-group" style="align-items: center;">
                <label>平常</label>
                <img id="char-edit-sprite-normal-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="平常立绘">
                <input type="file" id="char-edit-sprite-normal-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>喜</label>
                <img id="char-edit-sprite-happy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="喜立绘">
                <input type="file" id="char-edit-sprite-happy-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>怒</label>
                <img id="char-edit-sprite-angry-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="怒立绘">
                <input type="file" id="char-edit-sprite-angry-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>哀</label>
                <img id="char-edit-sprite-sad-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="哀立绘">
                <input type="file" id="char-edit-sprite-sad-input" accept="image/*" style="display: none;">
              </div>
              <div class="avatar-upload-group" style="align-items: center;">
                <label>害羞</label>
                <img id="char-edit-sprite-shy-preview" class="avatar-preview" style="width: 80px; height: 80px;"
                  alt="害羞立绘">
                <input type="file" id="char-edit-sprite-shy-input" accept="image/*" style="display: none;">
              </div>
            </div>
          </div>
          <div class="input-group">
            <label for="char-edit-bind-user">绑定用户</label>
            <select id="char-edit-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="world-book-checkboxes-container" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="export-char-button" class="form-button secondary" style="margin-top: 20px;">导出角色卡</button>
        <button id="save-char-button" class="form-button">保存角色</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="edit-clear-history-button" class="form-button"
            style="background-color: #ffc107; margin-bottom: 10px;">清空聊天记录</button>
          <button id="edit-delete-char-button" class="form-button" style="background-color: #dc3545;">删除角色</button>
        </div>
      </div>
    </div>

    <div id="group-chat-create-screen" class="screen">
      <div class="header">
        <button id="back-to-char-select-from-group-create" class="header-button">返回</button>
        <span class="header-title">创建群聊</span>
        <button id="create-group-chat-button" class="header-button">创建</button>
      </div>
      <div class="content" style="padding: 20px;">
        <div class="input-group">
          <label for="group-chat-name">群聊名称</label>
          <input type="text" id="group-chat-name" placeholder="给你的群聊起个名字">
        </div>
        <div class="settings-group">
          <h2>选择成员</h2>
          <div id="group-chat-member-list-container"
            style="max-height: 400px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
            <ul id="group-chat-member-list">
            </ul>
          </div>
        </div>
      </div>
    </div>

    <div id="wallpaper-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-wallpaper" class="header-button">返回</button>
        <span class="header-title">更换壁纸</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2>全局主题色</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">拖动滑块来改变整个App的主色调。</p>
          <div class="input-group" style="padding-top: 10px;">
            <label for="theme-hue-slider" style="display: block; margin-bottom: 5px;">色相 (Hue)</label>
            <input type="range" id="theme-hue-slider" min="0" max="360" value="35" style="width: 100%;">
          </div>
          <div class="input-group">
            <label for="theme-lightness-slider" style="display: block; margin-bottom: 5px;">明度 (Lightness)</label>
            <input type="range" id="theme-lightness-slider" min="15" max="95" value="80" style="width: 100%;">
          </div>
        </div>
        <div class="settings-group"
          style="border-bottom: 1px solid var(--border-color); padding-bottom: 20px; margin-bottom: 20px;">
          <h2 style="margin-top: 0;">时钟样式</h2>
          <div style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="clock-color-toggle" style="width: auto; height: 18px; flex-shrink: 0;">
            <label for="clock-color-toggle" style="width: auto; font-size: 0.9rem;">强制使用纯白色时钟 (推荐在深色壁纸下使用)</label>
          </div>
        </div>
        <div class="settings-group">
          <h2>上传新壁纸</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">选择一张图片作为你的手机壁纸。为了效果最好，请使用竖屏图片。</p>
          <input type="file" id="wallpaper-input" accept="image/*" style="display: none;">
          <button id="upload-wallpaper-button" class="form-button">选择图片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>音乐小组件背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的主屏幕音乐小组件设置一张专属背景图。</p>
          <input type="file" id="widget-bg-input" accept="image/*" style="display: none;">
          <button id="upload-widget-bg-button" class="form-button">选择图片</button>
          <button id="reset-widget-bg-button" class="form-button secondary">恢复默认</button>
        </div>
        <div class="settings-group" style="margin-top: 20px;">
          <h2>重置桌面</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">此操作会将所有桌面小组件（时钟、音乐、徽章等）恢复到初始位置，并将壁纸重置为纯白色。</p>
          <button id="reset-desktop-button" class="form-button destructive">重置桌面布局</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义徽章</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面徽章，可以拖动它到任意位置。</p>
          <input type="file" id="badge-input" accept="image/*" style="display: none;">
          <button id="upload-badge-button" class="form-button">选择徽章图片</button>
          <button id="reset-badge-button" class="form-button"
            style="background-color: #777; margin-top: 10px;">移除徽章</button>
        </div>

        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">上传一张图片作为你的桌面方形卡片小组件。</p>
          <input type="file" id="card-input" accept="image/*" style="display: none;">
          <button id="upload-card-button" class="form-button">选择卡片图片</button>
          <button id="reset-card-button" class="form-button"
            style="background-color: #777; margin-top: 10px;">移除卡片</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义卡片 2</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为你的第二个桌面方形卡片小组件上传图片。</p>
          <input type="file" id="card-input-2" accept="image/*" style="display: none;">
          <button id="upload-card-button-2" class="form-button">选择卡片图片</button>
          <button id="reset-card-button-2" class="form-button" style="background-color: #777; margin-top: 10px;">移除卡片
            2</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>动态页背景</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">为“动态”页面设置一张独立的背景图，让它与众不同。</p>
          <input type="file" id="feed-bg-input" accept="image/*" style="display: none;">
          <button id="upload-feed-bg-button" class="form-button">选择图片</button>
        </div>
        <button id="reset-feed-bg-button" class="form-button"
          style="background-color: #777; margin-top: 10px;">移除背景</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>小组件救援</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">如果你的吧唧或卡片不小心飞出屏幕找不到了，点这里让它们回家。</p>
          <button id="reset-widgets-position-button" class="form-button"
            style="background-color: #ffc107;">重置小组件位置</button>
        </div>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <h2>自定义App图标</h2>
          <p style="font-size: 0.9rem; color: var(--text-color-light);">替换主屏幕上App的默认图标。为了最佳效果，请使用方形、透明背景的图片。</p>
          <div class="settings-group"
            style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
            <h2>自定义表情包</h2>
            <p style="font-size: 0.9rem; color: var(--text-color-light);">
              在这里追加你的专属表情包。每个表情占一行，格式为：<br>
              <b>表情名--图片URL</b><br>
              例如：<br>
              <code>开心--https://example.com/happy.png</code><br>
              <code>难过--https://example.com/sad.gif</code>
            </p>
            <textarea id="custom-stickers-input" rows="8" placeholder="请按指定格式粘贴..."></textarea>
            <button id="save-custom-stickers-button" class="form-button" style="margin-top: 5px;">保存并刷新表情包</button>
          </div>
          <div id="custom-icon-list-container">
          </div>
          <div id="custom-icon-list-container">
          </div>
        </div>
      </div>

    </div>

    <div id="world-book-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-world-book" class="header-button">主屏幕</button>
        <span class="header-title">世界书</span>
        <button id="add-world-book-button" class="header-button add" title="添加新世界书">+</button>
      </div>
      <div class="content" id="world-book-list-container">
      </div>
    </div>

    <div id="world-book-editor-screen" class="screen">
      <div class="header">
        <button id="back-to-world-book-list" class="header-button">返回</button>
        <span id="world-book-editor-title" class="header-title">编辑条目</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-world-book-id">
        <div class="settings-group">
          <h2>设定条目</h2>
          <div class="input-group">
            <label for="world-book-edit-name">条目名称 (Key)</label>
            <input type="text" id="world-book-edit-name" placeholder="例如：我的过去、特殊能力">
          </div>
          <div class="input-group">
            <label for="world-book-edit-content">条目内容 (Value)</label>
            <textarea id="world-book-edit-content" placeholder="输入详细的设定内容..."></textarea>
          </div>
        </div>
        <button id="save-world-book-button" class="form-button">保存条目</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="delete-world-book-button" class="form-button" style="background-color: #dc3545;">删除该条目</button>
        </div>
      </div>
    </div>

    <div id="group-settings-screen" class="screen">
      <div class="header">
        <button id="back-to-chat-from-group-settings" class="header-button">返回</button>
        <span class="header-title">群聊设置</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <div class="settings-group">
          <h2>群聊信息</h2>
          <div class="input-group">
            <label for="group-settings-name">群聊名称</label>
            <input type="text" id="group-settings-name">
          </div>
          <div class="avatar-upload-group">
            <label>群头像</label>
            <img id="group-avatar-preview" class="avatar-preview" alt="Group Avatar Preview">
            <input type="file" id="group-avatar-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label>群聊背景</label>
            <div
              style="width: 150px; height: 266px; border-radius: 12px; border: 1px solid var(--border-color); background-color: #f0f0f0; overflow: hidden; cursor: pointer;">
              <img id="group-bg-preview" style="width: 100%; height: 100%; object-fit: cover;" alt="群聊背景预览">
            </div>
            <input type="file" id="group-bg-input" accept="image/*" style="display: none;">
          </div>
          <div class="input-group">
            <label for="group-settings-bind-user">绑定用户</label>
            <select id="group-settings-bind-user"></select>
          </div>
          <div class="input-group">
            <label>关联世界书</label>
            <div class="custom-multiselect">
              <div class="select-box">
                <span class="selected-options-text">-- 点击选择 --</span>
                <span class="arrow">▼</span>
              </div>
              <div id="group-world-book-checkboxes" class="checkboxes-container">
              </div>
            </div>
          </div>
        </div>
        <button id="save-group-settings-button" class="form-button">保存设置</button>
        <div class="settings-group" style="margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px;">
          <button id="group-clear-history-button" class="form-button"
            style="background-color: #ffc107; margin-bottom: 10px;">清空聊天记录</button>
          <button id="group-delete-button" class="form-button" style="background-color: #dc3545;">删除并解散群聊</button>
        </div>
      </div>
    </div>

    <div id="music-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-feed" class="header-button">返回</button>
        <span id="friend-circle-title" class="header-title">好友圈</span>
        <div style="display: flex; gap: 5px;">
          <button id="edit-current-circle-button" class="header-button" style="font-size: 1.2rem;">⚙️</button>
          <button id="clear-feed-button" class="header-button" style="color: #dc3545;">清空</button>
          <button id="refresh-feed-button" class="header-button">刷新</button>

        </div>
      </div>
      <div id="user-post-area"
        style="padding: 10px 15px; border-bottom: 1px solid var(--border-color); flex-shrink: 0; background: var(--surface-bg);">
        <div id="user-post-input-container">
          <img id="user-post-avatar" class="char-avatar">
          <div id="user-post-main-area">
            <textarea id="user-post-textarea" rows="3" placeholder="分享你的新鲜事..."></textarea>
            <div id="user-post-attachment-preview"></div>
          </div>
        </div>
        <div id="user-post-toolbar">
          <div id="user-post-actions" class="user-post-actions">
            <button id="user-post-image-button" class="toolbar-button" title="分享图片">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
                <circle cx="8.5" cy="8.5" r="1.5"></circle>
                <polyline points="21 15 16 10 5 21"></polyline>
              </svg>
            </button>
            <input type="file" id="user-post-image-input" accept="image/*" style="display: none;">
            <button id="user-post-music-button" class="toolbar-button" title="分享音乐">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                <path d="M9 18V5l12-2v13"></path>
                <circle cx="6" cy="18" r="3"></circle>
                <circle cx="18" cy="16" r="3"></circle>
              </svg>
            </button>
          </div>
          <button id="user-send-post-button">发送</button>
        </div>
      </div>
      <div id="music-feed-container" class="content" style="padding: 10px;">
      </div>
      <div id="music-player-bar" class="hidden">
        <img id="player-cover" src="">
        <div id="player-info">
          <div id="player-title"></div>
          <div id="player-artist"></div>
        </div>
        <div id="player-controls">
          <button id="player-prev-btn">⏮</button>
          <button id="player-play-pause-btn">▶</button>
          <button id="player-next-btn">⏭</button>
        </div>
      </div>
      <audio id="audio-player"></audio>
    </div>
    <div id="meeting-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-meeting-list" class="header-button">主屏幕</button>
        <span class="header-title">选择见面对象</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="meeting-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="meeting-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-meeting-list">返回</button>
        <span id="meeting-char-name-header" class="header-title">角色</span>
        <button id="toggle-meeting-view-button" class="header-button">切换视角</button>

      </div>
      <div id="meeting-main-content" class="content" style="position: relative; padding: 0;">
        <div id="galgame-overlay-ui">
          <div id="galgame-time">12:00</div>
          <div id="galgame-date">1月1日 星期一</div>
        </div>
        <div id="meeting-scene-view" class="content"
          style="font-family: 'Georgia', 'Times New Roman', 'KaiTi', 'STSong', serif; color: white; text-shadow: 0 1px 3px rgba(0,0,0,0.7);">
        </div>
        <div id="galgame-view-container"
          style="display: none; width: 100%; height: 100%; position: absolute; top: 0; left: 0; overflow: hidden;">
          <div id="galgame-sprite-container"
            style="position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; height: 100%; display: flex; align-items: flex-end; justify-content: center;">
            <img id="galgame-sprite" src=""
              style="max-height: 80%; max-width: 80%; object-fit: contain; transition: opacity 0.3s ease;">
          </div>
          <div id="galgame-textbox-container"
            style="position: absolute; bottom: 9%; left: 5%; right: 5%; background: rgba(0, 0, 0, 0.7); border-radius: 10px; padding: 15px; color: white; border-top: 1px solid rgba(255,255,255,0.2); cursor: pointer;">
            <div id="galgame-speaker" style="font-weight: bold; margin-bottom: 10px;">说话人</div>
            <div id="galgame-text" style="line-height: 1.6;">对话内容...</div>
          </div>
        </div>
      </div>
      <div class="chat-input-area">
        <div id="chat-input-wrapper-meeting"> <textarea id="meeting-message-input" placeholder="输入你的行动或对话..." rows="1"
            style="resize: none; overflow-y: auto; flex-grow: 1; border: none; background: transparent; padding: 9px 12px; font-size: .95rem; outline: none; color: var(--text-color);"></textarea>
          <button id="meeting-send-button" title="发送">➤</button>
        </div>
      </div>
    </div>

    <div id="friend-circle-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-circle-list" class="header-button">主屏幕</button>
        <span class="header-title">好友圈</span>
        <button id="add-friend-circle-button" class="header-button add" title="新建好友圈">+</button>
      </div>
      <div id="friend-circle-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="friend-circle-edit-screen" class="screen">
      <div class="header">
        <button id="back-to-circle-list-from-edit" class="header-button">返回</button>
        <span id="friend-circle-edit-title" class="header-title">编辑好友圈</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content">
        <input type="hidden" id="editing-friend-circle-id">
        <div class="settings-group">
          <h2>好友圈设定</h2>
          <div class="input-group">
            <label for="friend-circle-edit-name">圈子名称</label>
            <input type="text" id="friend-circle-edit-name" placeholder="例如：我的日常">
          </div>
          <div class="input-group">
            <label for="friend-circle-edit-bind-user">绑定的“我”</label>
            <select id="friend-circle-edit-bind-user"></select>
          </div>
        </div>
        <div class="settings-group">
          <h2>选择圈内成员</h2>
          <div id="friend-circle-member-selection"
            style="max-height: 250px; overflow-y: auto; border: 1px solid var(--border-color); border-radius: 8px;">
          </div>
        </div>
        <button id="save-friend-circle-button" class="form-button">保存</button>
        <div class="settings-group"
          style="margin-top: 20px; border-top: 1px solid var(--border-color); padding-top: 20px;">
          <button id="delete-friend-circle-button" class="form-button"
            style="background-color: #dc3545;">删除该好友圈</button>
        </div>
      </div>
    </div>
    <div id="diary-list-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-diary-list" class="header-button">主屏幕</button>
        <span class="header-title">交换日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-list-container" class="content" style="padding: 10px;">
      </div>
    </div>

    <div id="diary-view-screen" class="screen">
      <div class="header">
        <button class="header-button" id="back-to-diary-list">返回</button>
        <span id="diary-char-name-header" class="header-title">TA的日记</span>
        <div style="width: 50px;"></div>
      </div>
      <div id="diary-entries-container" class="content"
        style="padding: 20px; font-family: 'KaiTi', 'STSong', serif; line-height: 1.8;">
      </div>
      <div class="chat-input-area">
        <div id="diary-input-wrapper" style="display: flex; gap: 10px;">
          <input type="text" id="diary-entry-input" placeholder="写下你的日记或批注..." style="flex-grow: 1;">
          <button id="diary-send-button" class="form-button"
            style="width: auto; margin-top: 0; padding: 0 18px;">写好了</button>
          <button id="diary-get-reply-button" class="form-button"
            style="width: auto; margin-top: 0; background-color: #555; padding: 0 18px;">催TA写</button>
        </div>
      </div>
    </div>
    <div id="music-library-screen" class="screen">
      <div class="header">
        <button id="back-to-home-from-music-library" class="header-button">主屏幕</button>
        <span class="header-title">音乐库</span>
        <button id="upload-music-button" class="header-button add" title="上传新音乐">+</button>
      </div>
      <div class="content" id="music-library-container">
      </div>
    </div>
    <div id="music-upload-altar-screen" class="screen">
      <div class="header">
        <button id="back-to-library-from-altar" class="header-button">取消</button>
        <span class="header-title">献上音乐</span>
        <div style="width: 50px;"></div>
      </div>
      <div class="content" style="padding: 20px; display: flex; flex-direction: column; gap: 15px;">

        <div class="upload-slot" id="altar-slot-audio">
          <span class="slot-icon">🎵</span>
          <span class="slot-label">音频文件 (必需)</span>
          <span class="slot-filename">点击选择 .mp3 或 .flac</span>
        </div>

        <div class="upload-slot" id="altar-slot-cover">
          <span class="slot-icon">🖼️</span>
          <span class="slot-label">封面图片 (可选)</span>
          <span class="slot-filename">点击选择 .jpg 或 .png</span>
        </div>

        <div class="upload-slot" id="altar-slot-info">
          <span class="slot-icon">📄</span>
          <span class="slot-label">歌曲信息 (必需)</span>
          <span class="slot-filename">点击选择 info.txt</span>
        </div>

        <div class="upload-slot" id="altar-slot-lyrics">
          <span class="slot-icon">🎤</span>
          <span class="slot-label">歌词文件 (可选)</span>
          <span class="slot-filename">点击选择 .lrc</span>
        </div>

        <button id="confirm-altar-upload-button" class="form-button" disabled>献上祭品</button>
      </div>
    </div>
    <audio id="audio-player"></audio>

    <audio id="unified-audio-player"></audio>



  </div>
  </div>

  <div id="add-choice-modal" class="choice-modal">
    <div id="add-choice-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="choice-create-character" class="choice-modal-button">创建新角色</button>
      <button id="choice-create-group" class="choice-modal-button">创建新群聊</button>
      <button id="choice-import-character" class="choice-modal-button">导入角色卡</button>
      <button id="choice-cancel" class="choice-modal-button cancel">取消</button>
    </div>
  </div>


  <div id="transfer-modal" class="choice-modal">
    <div id="transfer-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">转账</h3>
      <div id="transfer-recipient-group" class="input-group" style="margin: 10px 0; display: none;">
        <label for="transfer-recipient-select">转给</label>
        <select id="transfer-recipient-select"></select>
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="transfer-amount-input">金额</label>
        <input type="number" id="transfer-amount-input" placeholder="输入金额">
      </div>
      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-transfer-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认转账</button>
        <button id="cancel-transfer-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="message-action-modal" class="choice-modal">
    <div id="message-action-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content">
      <button id="edit-message-button" class="choice-modal-button">编辑消息</button>
      <button id="quote-message-button" class="choice-modal-button">引用</button>
      <button id="delete-message-button" class="choice-modal-button" style="color: #dc3545;">删除消息</button>
      <button id="cancel-action-button" class="choice-modal-button cancel">取消</button>
    </div>
  </div>

  <div id="edit-message-modal" class="choice-modal">
    <div id="edit-message-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px;">
      <h3 style="margin-top: 0; text-align: center; font-weight: 600;">编辑消息</h3>
      <textarea id="edit-message-textarea" style="width: 100%; min-height: 100px; margin: 10px 0;"></textarea>
      <div style="display: flex; gap: 10px; margin-top: 10px;">
        <button id="save-edit-button" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">保存</button>
        <button id="cancel-edit-button" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="music-input-modal" class="choice-modal">
    <div id="music-input-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content" style="padding: 20px; width: 90%; max-width: 300px;">
      <h3 id="music-input-title" style="margin-top: 0; text-align: center; font-weight: 600;">分享音乐</h3>

      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-song" style="font-size: 0.9rem;">歌名</label>
        <input type="text" id="music-input-song" placeholder="例如：夜曲">
      </div>
      <div class="input-group" style="margin: 10px 0;">
        <label for="music-input-artist" style="font-size: 0.9rem;">歌手</label>
        <input type="text" id="music-input-artist" placeholder="例如：周杰伦">
      </div>

      <div style="display: flex; gap: 10px; margin-top: 20px;">
        <button id="confirm-music-input" class="choice-modal-button"
          style="background-color: var(--primary-color); color: white;">确认</button>
        <button id="cancel-music-input" class="choice-modal-button cancel">取消</button>
      </div>
    </div>
  </div>

  <div id="modal-root"
    style="position:fixed;inset:0;display:none;align-items:center;justify-content:center;z-index:9999;">
    <div id="modal-mask" style="position:absolute;inset:0;background:rgba(0,0,0,.35);"></div>
    <div id="modal-dialog"
      style="position:relative;background:#fff;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);width:80%;max-width:320px;padding:16px;">
      <div id="modal-text" style="font-size:14px;color:#333;line-height:1.5;white-space:pre-wrap;"></div>
      <div style="display:flex;gap:8px;justify-content:flex-end;margin-top:16px;">
        <button id="modal-cancel"
          style="padding:8px 12px;border:1px solid #ddd;border-radius:8px;background:#fff;cursor:pointer;">取消</button>
        <button id="modal-ok"
          style="padding:8px 12px;border:none;border-radius:8px;background:#007bff;color:#fff;cursor:pointer;">确定</button>
      </div>
    </div>
  </div>

  <div id="listen-together-modal" class="choice-modal">
    <div id="listen-together-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <div style="width: 50px;"></div>
        <span class="header-title">选择一首歌，一起听</span>
        <button id="cancel-listen-together" class="header-button" style="min-width: 50px;">取消</button>
      </div>
      <div id="listen-together-song-list" class="content" style="flex-grow: 1; padding: 10px;">
      </div>
    </div>
  </div>

  <div id="toast"
    style="position:fixed;left:50%;bottom:32px;transform:translateX(-50%);background:rgba(0,0,0,.8);color:#fff;padding:8px 12px;border-radius:8px;font-size:12px;display:none;z-index:10000;">
  </div>



  <script>
    const _0x4f9ace = _0x3d17; (function (_0x42e96a, _0x15320d) { const _0x591bb0 = _0x3d17, _0x9530b0 = _0x42e96a(); while (!![]) { try { const _0x1bb11d = -parseInt(_0x591bb0(0x3d9)) / 0x1 + -parseInt(_0x591bb0(0x143)) / 0x2 * (-parseInt(_0x591bb0(0x1ce)) / 0x3) + -parseInt(_0x591bb0(0x577)) / 0x4 + parseInt(_0x591bb0(0x698)) / 0x5 + parseInt(_0x591bb0(0x492)) / 0x6 * (parseInt(_0x591bb0(0x529)) / 0x7) + -parseInt(_0x591bb0(0x416)) / 0x8 * (parseInt(_0x591bb0(0x2b2)) / 0x9) + -parseInt(_0x591bb0(0x75b)) / 0xa; if (_0x1bb11d === _0x15320d) break; else _0x9530b0['push'](_0x9530b0['shift']()); } catch (_0x5ecb61) { _0x9530b0['push'](_0x9530b0['shift']()); } } }(_0x5008, 0x570bd)); var _0x557cc6, _0x41423e = null; let _0x56624c = [], _0x1bd225 = ![], _0x322ed9 = { 'x': 0x0, 'y': 0x0 }; function _0x8b240d(_0x29dbcb) { const _0xb84785 = _0x3d17; return (_0x557cc6?.[_0xb84785(0x618)] || [])[_0xb84785(0x4d1)](_0x4fdb23 => _0x4fdb23['id'] === _0x29dbcb); } const _0x577da3 = _0x4f9ace(0x114), _0x3b11bb = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM5OTkiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDJhNC4zOSA0LjM5IDAgMCAtMy4yOC00LjA5TDE1IDIwIj48L3BhdGgPjxjaXJjbGUgY3g9IjEyIiBjeT0iNyIgcj0iNCI+PC9jaXJjbGU+PC9zdmc+', _0x1732e7 = _0x4f9ace(0x5e0), _0x9cad1d = [{ 'name': _0x4f9ace(0x241), 'url': 'http://sharkpan.xyz/f/8ngsj/ax0fat.jpg' }, { 'name': '崩溃', 'url': _0x4f9ace(0x6aa) }, { 'name': '生病', 'url': _0x4f9ace(0xc7) }, { 'name': '工作', 'url': _0x4f9ace(0x6a4) }, { 'name': _0x4f9ace(0x4b2), 'url': _0x4f9ace(0x191) }, { 'name': _0x4f9ace(0x367), 'url': _0x4f9ace(0x741) }, { 'name': _0x4f9ace(0x31f), 'url': _0x4f9ace(0x1b3) }, { 'name': '期待', 'url': 'http://sharkpan.xyz/f/35lse/xmsue5.jpg' }, { 'name': '喜欢', 'url': _0x4f9ace(0x66f) }, { 'name': _0x4f9ace(0x641), 'url': _0x4f9ace(0x2ac) }, { 'name': '有点生气', 'url': _0x4f9ace(0x272) }, { 'name': '委屈', 'url': _0x4f9ace(0x41a) }, { 'name': '加油', 'url': _0x4f9ace(0x784) }, { 'name': '对的', 'url': _0x4f9ace(0x2a5) }, { 'name': '不满', 'url': _0x4f9ace(0x735) }, { 'name': _0x4f9ace(0x22a), 'url': _0x4f9ace(0x830) }, { 'name': _0x4f9ace(0x1de), 'url': _0x4f9ace(0x287) }, { 'name': '委屈', 'url': _0x4f9ace(0x461) }, { 'name': '平静', 'url': _0x4f9ace(0x7d1) }, { 'name': '咬你', 'url': _0x4f9ace(0x383) }, { 'name': '咱俩天下第一好', 'url': _0x4f9ace(0x323) }, { 'name': '好困', 'url': _0x4f9ace(0x2de) }, { 'name': '摸鱼', 'url': _0x4f9ace(0x5a3) }, { 'name': _0x4f9ace(0x7c4), 'url': _0x4f9ace(0x5f0) }, { 'name': _0x4f9ace(0x431), 'url': _0x4f9ace(0x603) }, { 'name': '被你撩到', 'url': _0x4f9ace(0x140) }, { 'name': _0x4f9ace(0x61b), 'url': _0x4f9ace(0x48f) }, { 'name': _0x4f9ace(0x558), 'url': 'http://sharkpan.xyz/f/VGnuY/ptzlf5.jpg' }, { 'name': '啥意思捏', 'url': 'http://sharkpan.xyz/f/xjmCX/zyjzew.jpg' }, { 'name': '好委屈但是不能哭', 'url': _0x4f9ace(0x7cd) }, { 'name': '事情好多', 'url': 'http://sharkpan.xyz/f/ljNUx/aw6udx.jpg' }, { 'name': '我是垃圾', 'url': _0x4f9ace(0x71c) }, { 'name': '勉强但是好吧', 'url': 'http://sharkpan.xyz/f/Oyjuy/p8v2hd.jpg' }, { 'name': '逗你开心', 'url': _0x4f9ace(0x76f) }, { 'name': _0x4f9ace(0x692), 'url': _0x4f9ace(0x224) }, { 'name': _0x4f9ace(0x731), 'url': 'http://sharkpan.xyz/f/mjeIW/9vf8ws.jpg' }, { 'name': _0x4f9ace(0x42b), 'url': 'http://sharkpan.xyz/f/B4WSa/u5wopj.jpg' }, { 'name': '交给我吧', 'url': _0x4f9ace(0x2cd) }, { 'name': _0x4f9ace(0xc8), 'url': _0x4f9ace(0x28e) }, { 'name': '有点破防', 'url': 'http://sharkpan.xyz/f/VG2FY/uucfvv.jpg' }, { 'name': _0x4f9ace(0x569), 'url': _0x4f9ace(0x5f3) }, { 'name': _0x4f9ace(0x47b), 'url': 'http://sharkpan.xyz/f/djjH8/29ejbg.jpg' }, { 'name': _0x4f9ace(0x53f), 'url': _0x4f9ace(0x89) }, { 'name': _0x4f9ace(0x6e8), 'url': _0x4f9ace(0x301) }, { 'name': '谁啊我吗', 'url': _0x4f9ace(0x614) }, { 'name': _0x4f9ace(0x160), 'url': 'http://sharkpan.xyz/f/YA7T1/th0l79.jpg' }, { 'name': '甜蜜地和你聊天', 'url': _0x4f9ace(0x751) }, { 'name': '不高兴撒娇', 'url': _0x4f9ace(0x584) }, { 'name': _0x4f9ace(0x14a), 'url': 'http://sharkpan.xyz/f/Wa0cW/w6m7qk.jpg' }, { 'name': '我不想工作', 'url': _0x4f9ace(0x712) }, { 'name': '吃你的饭', 'url': _0x4f9ace(0xfc) }, { 'name': _0x4f9ace(0x672), 'url': _0x4f9ace(0x749) }, { 'name': '我是女仆', 'url': 'http://sharkpan.xyz/f/pKWCQ/ztxwv0.jpg' }, { 'name': '等你', 'url': _0x4f9ace(0x3fc) }, { 'name': _0x4f9ace(0x4ff), 'url': 'http://sharkpan.xyz/f/eOXIw/y29z21.jpg' }, { 'name': _0x4f9ace(0x54a), 'url': _0x4f9ace(0x73a) }, { 'name': '喝酒', 'url': _0x4f9ace(0x44e) }, { 'name': _0x4f9ace(0x15d), 'url': _0x4f9ace(0x3c7) }, { 'name': '呜呜', 'url': _0x4f9ace(0x7a8) }, { 'name': _0x4f9ace(0x123), 'url': _0x4f9ace(0x713) }, { 'name': _0x4f9ace(0x2f2), 'url': _0x4f9ace(0x38c) }, { 'name': '出去玩', 'url': _0x4f9ace(0x6dd) }, { 'name': _0x4f9ace(0x83d), 'url': _0x4f9ace(0x59e) }, { 'name': _0x4f9ace(0x2ba), 'url': _0x4f9ace(0x5a9) }], _0x1911c3 = { 'beige': { 'name': '默认米白', 'h': 0x23, 's': 0x19, 'l': 0x50 }, 'mizuiro': { 'name': '薄荷水色', 'h': 0xc3, 's': 0x19, 'l': 0x50 }, 'sakura': { 'name': _0x4f9ace(0x256), 'h': 0x159, 's': 0x19, 'l': 0x50 }, 'noir': { 'name': _0x4f9ace(0x739), 'h': 0x104, 's': 0xf, 'l': 0x1e } }; document[_0x4f9ace(0x572)](_0x4f9ace(0x253), () => { const _0x27dd8f = _0x4f9ace, _0x450018 = document[_0x27dd8f(0x5b7)]('app-user-profiles'), _0x2863a2 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x277)), _0x616135 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x36c)), _0x59c8da = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x64c)), _0x45e2a0 = document['getElementById'](_0x27dd8f(0x7cf)), _0x34b489 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x7cc)), _0x40be99 = document[_0x27dd8f(0x5b7)]('transfer-recipient-group'), _0xa71a26 = document[_0x27dd8f(0x5b7)]('transfer-recipient-select'), _0x40d536 = document[_0x27dd8f(0x5b7)]('transfer-amount-input'), _0x40a226 = document[_0x27dd8f(0x5b7)]('chat-reroll-button'), _0x2cd527 = document['getElementById'](_0x27dd8f(0x7ae)), _0xd3e43e = document['getElementById'](_0x27dd8f(0x568)), _0x47b08e = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x3c8)), _0x397bfa = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x2d8)), _0x1779bf = document['getElementById'](_0x27dd8f(0x3d6)), _0x3087e1 = document[_0x27dd8f(0x5b7)]('close-summary-button'), _0x5bc519 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x2d9)), _0x4ef4f1 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x9d)), _0x4fd94f = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x7d7)), _0x32746f = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x684)), _0x1d5826 = document[_0x27dd8f(0x5b7)]('choice-import-character'), _0x1f5345 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x440)), _0x560a70 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0xe9)); function _0x4f3107() { const _0x206309 = _0x27dd8f, _0x16732d = document[_0x206309(0x5b7)](_0x206309(0x767)); if (!_0x16732d) return; const _0x5dc5fd = localStorage[_0x206309(0x426)]('themeHue') || '35'; document[_0x206309(0x78c)][_0x206309(0x6ca)]['setProperty']('--primary-hue', _0x5dc5fd), _0x16732d[_0x206309(0x73f)] = _0x5dc5fd, _0x16732d[_0x206309(0x572)](_0x206309(0x7d4), () => { const _0x52470e = _0x206309, _0x3c90bd = _0x16732d['value']; document[_0x52470e(0x78c)]['style'][_0x52470e(0x6a0)]('--primary-hue', _0x3c90bd), localStorage['setItem'](_0x52470e(0xa7), _0x3c90bd), _0x3eda07(); }); } function _0x435368() { const _0x4c1152 = _0x27dd8f, _0x4a7879 = document[_0x4c1152(0x5b7)](_0x4c1152(0x5ac)); if (!_0x4a7879) return; const _0x436daa = localStorage[_0x4c1152(0x426)](_0x4c1152(0x38b)) || '80'; document['documentElement'][_0x4c1152(0x6ca)][_0x4c1152(0x6a0)]('--primary-lightness', _0x436daa + '%'), _0x4a7879[_0x4c1152(0x73f)] = _0x436daa, _0x4a7879[_0x4c1152(0x572)](_0x4c1152(0x7d4), () => { const _0x45d768 = _0x4c1152, _0x1665f8 = _0x4a7879[_0x45d768(0x73f)]; document['documentElement'][_0x45d768(0x6ca)]['setProperty'](_0x45d768(0x306), _0x1665f8 + '%'), localStorage[_0x45d768(0x69e)](_0x45d768(0x38b), _0x1665f8), _0x3eda07(); }); } function _0x3eda07() { const _0x298167 = _0x27dd8f, _0x3043d7 = document[_0x298167(0x5b7)](_0x298167(0x75f)); if (!_0x3043d7) return; _0x557cc6[_0x298167(0x4c2)]['forceWhiteClock'] ? (_0x3043d7[_0x298167(0x6ca)][_0x298167(0x3a2)] = _0x298167(0x5d0), _0x3043d7[_0x298167(0x6ca)][_0x298167(0x5c9)] = _0x298167(0x65d)) : (_0x3043d7[_0x298167(0x6ca)][_0x298167(0x3a2)] = _0x298167(0x412), _0x3043d7['style'][_0x298167(0x5c9)] = _0x298167(0x4e3)); } function _0x4bcf15() { const _0xfa35a9 = _0x27dd8f, _0x710a53 = document[_0xfa35a9(0x5b7)]('clock-color-toggle'); if (!_0x710a53) return; _0x710a53['checked'] = _0x557cc6['preferences']['forceWhiteClock'] || ![], _0x710a53['addEventListener'](_0xfa35a9(0x265), () => { const _0x52477e = _0xfa35a9; _0x557cc6['preferences']['forceWhiteClock'] = _0x710a53[_0x52477e(0x1c8)], _0x162000(), _0x3eda07(); }); } _0x560a70['addEventListener'](_0x27dd8f(0x66b), _0x140581), _0x1d5826[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x413648 = _0x27dd8f; _0x1d9a59(), _0x1f5345[_0x413648(0x66b)](); }), _0x1f5345['addEventListener'](_0x27dd8f(0x265), _0x2ed1d1); const _0x592548 = { 'home': document['getElementById'](_0x27dd8f(0x45f)), 'chat': document[_0x27dd8f(0x5b7)]('chat-screen'), 'settings': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x557)), 'userProfile': document[_0x27dd8f(0x5b7)]('user-profile-screen'), 'characterEdit': document[_0x27dd8f(0x5b7)]('character-edit-screen'), 'groupChatCreate': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x5a1)), 'wallpaper': document[_0x27dd8f(0x5b7)]('wallpaper-screen'), 'worldBook': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x721)), 'worldBookEditor': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x171)), 'groupSettings': document['getElementById'](_0x27dd8f(0x80f)), 'music': document['getElementById'](_0x27dd8f(0x498)), 'friendCircleList': document['getElementById'](_0x27dd8f(0x7d9)), 'friendCircleEdit': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x580)), 'meetingList': document[_0x27dd8f(0x5b7)]('meeting-list-screen'), 'meetingView': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x704)), 'userProfileList': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x381)), 'diaryList': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x320)), 'diaryView': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x81d)), 'musicLibrary': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x64a)), 'musicUploadAltar': document['getElementById'](_0x27dd8f(0x6c4)) }, _0x4820aa = document[_0x27dd8f(0x5b7)]('upload-feed-bg-button'), _0x3a639c = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x7e1)), _0x2515a1 = document[_0x27dd8f(0x5b7)]('reset-feed-bg-button'), _0x4313dc = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x279)), _0x9c4dae = document['getElementById'](_0x27dd8f(0x300)), _0x12beee = document['getElementById']('back-to-home-from-wallpaper'), _0x2dcd36 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x351)), _0x53b883 = document[_0x27dd8f(0x5b7)]('upload-wallpaper-button'); document[_0x27dd8f(0x5b7)](_0x27dd8f(0x26b))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), async () => { const _0xe0aec6 = _0x27dd8f, _0x13d854 = await _0x4512da(_0xe0aec6(0x450)); if (_0x13d854) { localStorage[_0xe0aec6(0x17f)](_0xe0aec6(0x31b)), localStorage[_0xe0aec6(0x17f)](_0xe0aec6(0x2f0)), localStorage[_0xe0aec6(0x17f)](_0xe0aec6(0x525)), localStorage[_0xe0aec6(0x17f)](_0xe0aec6(0x50b)); const _0x14dcd3 = []; for (let _0x61e350 = 0x0; _0x61e350 < localStorage[_0xe0aec6(0x7a6)]; _0x61e350++) { if (_0xe0aec6(0x662) === _0xe0aec6(0x662)) { const _0x59b9ac = localStorage[_0xe0aec6(0x499)](_0x61e350); if (_0x59b9ac && _0x59b9ac[_0xe0aec6(0x795)](_0xe0aec6(0x491))) { if ('RTwDp' !== _0xe0aec6(0x7f8)) _0x14dcd3[_0xe0aec6(0x6b4)](_0x59b9ac); else throw new _0x20b4e8('文件格式不正确，不是一个有效的备份文件。'); } } else { const _0x5a8e04 = _0x43de38[_0xe0aec6(0x44b)][_0xe0aec6(0x209)][0x0]; if (!_0x5a8e04) return; const _0x38f47c = _0x174618['createObjectURL'](_0x5a8e04); _0x4546ae[_0xe0aec6(0x483)] = _0x38f47c, _0x653941[_0xe0aec6(0x38d)] = () => { const _0x4ef7f7 = _0xe0aec6; _0x35025b[_0x4ef7f7(0x29b)](_0x38f47c); }; } } _0x14dcd3[_0xe0aec6(0x302)](_0x469d17 => localStorage[_0xe0aec6(0x17f)](_0x469d17)), await _0x3aff46(_0xe0aec6(0x52f), await _0x57a56e('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/wcAAwAB/epv2AAAAABJRU5ErkJggg==')), _0x599dea(_0xe0aec6(0x752)), setTimeout(() => location[_0xe0aec6(0x112)](), 0x5dc); } }); const _0xadc86b = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x4b6)), _0x3be458 = document['getElementById'](_0x27dd8f(0x53b)), _0x5e7eb6 = document['getElementById'](_0x27dd8f(0x193)), _0x9cd111 = document['getElementById'](_0x27dd8f(0x4ba)), _0x28a7c2 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0xc4)), _0x2d9b7c = document['getElementById'](_0x27dd8f(0x23e)), _0x2a603d = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x414)), _0x397a39 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0xec)), _0x2aac92 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x36b)), _0x22a9de = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x424)), _0x1a972e = document['getElementById'](_0x27dd8f(0x22e)), _0x170b59 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x82e)), _0x48719c = document['getElementById'](_0x27dd8f(0x23b)), _0x3ed8f4 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x3a8)), _0x6276a5 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x2f9)), _0x11b77e = document['getElementById'](_0x27dd8f(0x3a5)), _0xbf38fa = document['getElementById'](_0x27dd8f(0x44a)), _0x410ecf = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x47c)), _0x2f066d = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x26e)), _0x784812 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x715)), _0x4aebf = document['getElementById'](_0x27dd8f(0xcc)), _0x336b95 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x80b)), _0x45f17d = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x46c)), _0x1be7f6 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x6e1)), _0x55d9ca = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x556)), _0x5e8a39 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x2cc)), _0x352be6 = document['getElementById'](_0x27dd8f(0x42e)), _0x3a0075 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x68d)), _0x361c9d = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x368)), _0x331e50 = document['getElementById'](_0x27dd8f(0x441)), _0x2de209 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x21d)), _0x2d664a = document['getElementById'](_0x27dd8f(0x13c)), _0x592d61 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x42a)), _0x3f5682 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x5f9)), _0x4d2704 = document['getElementById'](_0x27dd8f(0x667)), _0xd9cc63 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x2e1)), _0x989438 = document[_0x27dd8f(0x5b7)]('api-model'), _0x379d9a = document['getElementById'](_0x27dd8f(0x3bf)), _0x2624f1 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x754)), _0x5ad866 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x5ca)), _0x212890 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x7e4)), _0x2f4f50 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x4a3)), _0x1257f2 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x1fc)), _0x29669d = document['getElementById'](_0x27dd8f(0x83a)), _0x49060f = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x36f)), _0x447b5a = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x189)), _0x1dc455 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x30b)), _0x2f4e4a = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x2ea)), _0x4104b8 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x3f8)), _0x26c582 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x448)), _0x58419f = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x844)), _0x52fff2 = document['getElementById'](_0x27dd8f(0x4d7)), _0x3d8f26 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x513)), _0x4596b7 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x391)), _0x2dfd9e = document['getElementById']('edit-clear-history-button'), _0xe0b810 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x1bf)); let _0x42deec = null; const _0x2508c7 = _0x27dd8f(0x62d), _0x1f0fac = _0x27dd8f(0x83e); _0x557cc6 = { 'characters': [], 'worldBooks': [], 'chats': [], 'userProfiles': [], 'activeUserProfileId': null, 'apiSettings': { 'endpoint': '', 'key': '', 'model': '' }, 'preferences': { 'widgetBgImage': null, 'perChatContextLines': 0x64, 'forceWhiteClock': ![] }, 'activeChatId': null, 'activeMeetingCharId': null, 'isGenerating': ![], 'currentAbortController': null, 'pendingMessageTimers': [], 'conversationHistory': [], 'displayedMessageCount': 0x64, 'activeQuote': null, 'friendCircles': [], 'activeFriendCircleId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'diaries': [], 'activeDiaryCharacterId': null, 'meetingViewMode': _0x27dd8f(0x77e), 'activeMeetingScriptQueue': [], 'characterLastScripts': {}, 'musicPlaylist': [], 'currentlyPlayingIndex': -0x1, 'isPlaying': ![], 'pendingPostAttachments': { 'image': null, 'music': null } }; function _0x162000() { const _0x58a2a1 = _0x27dd8f; try { const _0x32223f = { 'characters': _0x557cc6[_0x58a2a1(0x618)], 'worldBooks': _0x557cc6['worldBooks'], 'chats': _0x557cc6[_0x58a2a1(0x46d)], 'userProfile': _0x557cc6[_0x58a2a1(0x204)], 'apiSettings': _0x557cc6[_0x58a2a1(0x170)], 'preferences': _0x557cc6['preferences'], 'activeChatId': _0x557cc6['activeChatId'], 'diaries': _0x557cc6[_0x58a2a1(0xa8)], 'friendCircles': _0x557cc6[_0x58a2a1(0x78e)], 'activeFriendCircleId': _0x557cc6[_0x58a2a1(0x761)], 'userProfiles': _0x557cc6[_0x58a2a1(0x58d)], 'activeUserProfileId': _0x557cc6['activeUserProfileId'] }; localStorage[_0x58a2a1(0x69e)](_0x58a2a1(0x435), JSON[_0x58a2a1(0x82f)](_0x32223f)); } catch (_0x56882a) { if ('QbZfX' === 'ICnZP') { _0x61e4cc = _0x40e850(); const _0x13547f = _0x553426['getElementById'](_0x58a2a1(0x68d))['textContent']; _0x4d1872 = _0x13547f || '当前聊天'; } else console[_0x58a2a1(0x50e)](_0x58a2a1(0x553), _0x56882a), _0x599dea(_0x58a2a1(0x13f)); } } function _0x46198a() { const _0x1b7095 = _0x27dd8f; let _0x4b2fbe = null; try { _0x4b2fbe = localStorage[_0x1b7095(0x426)](_0x1b7095(0x435)); } catch (_0x4cf83d) { if ('vCPag' === _0x1b7095(0x730)) console[_0x1b7095(0x50e)](_0x1b7095(0x81a), _0x4cf83d), _0x599dea('无法读取状态，浏览器可能禁用了存储功能。'); else { const _0x42af3b = _0xcc7c3, _0x36008a = _0x42af3b[_0x1b7095(0x4c1)], _0xc396a8 = _0x42af3b['scrollTop']; _0x4569d5[_0x1b7095(0x1ee)] += 0x64, _0x5cb43c(), _0xa30fe1(() => { const _0x3e9a87 = _0x42af3b['scrollHeight']; _0x42af3b['scrollTop'] = _0xc396a8 + (_0x3e9a87 - _0x36008a); }); } } if (_0x4b2fbe) try { if (_0x1b7095(0x9c) === _0x1b7095(0x80d)) _0x516d20('未找到可用模型。'); else { const _0x48e151 = JSON['parse'](_0x4b2fbe); if (!_0x48e151 || typeof _0x48e151 !== 'object') throw new Error(_0x1b7095(0x225)); Array[_0x1b7095(0x65c)](_0x48e151[_0x1b7095(0x618)]) && (_0x557cc6[_0x1b7095(0x618)] = _0x48e151[_0x1b7095(0x618)][_0x1b7095(0x30e)](_0x24fa38 => ({ 'offlineBackground': '', ..._0x24fa38 }))[_0x1b7095(0x1d8)](_0x39cc6d => _0x39cc6d && typeof _0x39cc6d === _0x1b7095(0x4b9) && _0x39cc6d['id'])); Array[_0x1b7095(0x65c)](_0x48e151[_0x1b7095(0x694)]) && (_0x1b7095(0x31c) === _0x1b7095(0x6b1) ? (_0x49dda6 *= _0x522b70 / _0x3e6b16, _0x254a71 = _0x3ad7f9) : _0x557cc6['worldBooks'] = _0x48e151[_0x1b7095(0x694)]); if (Array[_0x1b7095(0x65c)](_0x48e151[_0x1b7095(0xa8)])) { if (_0x1b7095(0x2d1) === _0x1b7095(0x24e)) { const _0x19da66 = new _0x2ab2e3(), _0x277c53 = _0x61bd9f[_0x1b7095(0x5b7)](_0x1b7095(0x79d)), _0x3e28a0 = _0x3c5005[_0x1b7095(0x5b7)](_0x1b7095(0x10b)); if (_0x277c53 && _0x3e28a0) { const _0x4a3cf6 = _0x18ea77(_0x19da66['getHours']())[_0x1b7095(0x1db)](0x2, '0'), _0x3a6236 = _0x2602db(_0x19da66[_0x1b7095(0x762)]())[_0x1b7095(0x1db)](0x2, '0'); _0x277c53[_0x1b7095(0x2d0)] = _0x4a3cf6 + ':' + _0x3a6236; const _0x44bee0 = _0x19da66[_0x1b7095(0x2aa)]() + 0x1, _0x5ec6ed = _0x19da66[_0x1b7095(0x65f)](), _0x51dc4a = [_0x1b7095(0x408), '星期一', _0x1b7095(0x2c6), _0x1b7095(0x377), _0x1b7095(0x588), _0x1b7095(0x748), _0x1b7095(0x7eb)][_0x19da66[_0x1b7095(0x5cc)]()]; _0x3e28a0['textContent'] = _0x44bee0 + '月' + _0x5ec6ed + '日\x20' + _0x51dc4a; } } else _0x557cc6[_0x1b7095(0xa8)] = _0x48e151[_0x1b7095(0xa8)]; } if (Array[_0x1b7095(0x65c)](_0x48e151[_0x1b7095(0x78e)])) _0x557cc6[_0x1b7095(0x78e)] = _0x48e151[_0x1b7095(0x78e)], _0x557cc6[_0x1b7095(0x761)] = _0x48e151[_0x1b7095(0x761)]; else { if (Array[_0x1b7095(0x65c)](_0x48e151[_0x1b7095(0x1ae)]) && _0x48e151[_0x1b7095(0x1ae)][_0x1b7095(0x7a6)] > 0x0) { console[_0x1b7095(0x235)](_0x1b7095(0x311)); const _0x482ce8 = { 'id': 'circle_' + Date[_0x1b7095(0x183)](), 'name': _0x1b7095(0x4db), 'boundUserProfileId': _0x48e151[_0x1b7095(0x26a)], 'memberCharacterIds': _0x48e151[_0x1b7095(0x618)][_0x1b7095(0x30e)](_0x492eed => _0x492eed['id']), 'posts': _0x48e151[_0x1b7095(0x1ae)] }; _0x557cc6[_0x1b7095(0x78e)] = [_0x482ce8], _0x557cc6[_0x1b7095(0x761)] = _0x482ce8['id']; } } if (Array['isArray'](_0x48e151[_0x1b7095(0x58d)])) 'MdRhV' === 'MdRhV' ? (_0x557cc6[_0x1b7095(0x58d)] = _0x48e151[_0x1b7095(0x58d)], _0x557cc6[_0x1b7095(0x26a)] = _0x48e151[_0x1b7095(0x26a)]) : _0x465215 = _0x13f694[_0x1b7095(0x417)](_0x21ad94[_0x1b7095(0x426)](_0x3c5d00) || '{}'); else { if (_0x48e151[_0x1b7095(0x204)]) { console[_0x1b7095(0x235)](_0x1b7095(0xef)); const _0x1e5343 = { 'id': 'user_' + Date['now'](), 'name': _0x48e151[_0x1b7095(0x204)][_0x1b7095(0x293)] || '我', 'avatar': _0x48e151[_0x1b7095(0x204)][_0x1b7095(0x51e)] || _0x3b11bb, 'persona': _0x48e151[_0x1b7095(0x204)][_0x1b7095(0x6f2)] || '' }; _0x557cc6[_0x1b7095(0x58d)] = [_0x1e5343], _0x557cc6['activeUserProfileId'] = _0x1e5343['id']; } } _0x48e151['apiSettings'] && typeof _0x48e151[_0x1b7095(0x170)] === _0x1b7095(0x4b9) && (_0x557cc6[_0x1b7095(0x170)] = { ..._0x557cc6[_0x1b7095(0x170)], ..._0x48e151['apiSettings'] }); _0x48e151[_0x1b7095(0x4c2)] && typeof _0x48e151[_0x1b7095(0x4c2)] === _0x1b7095(0x4b9) ? _0x557cc6[_0x1b7095(0x4c2)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null, ..._0x48e151[_0x1b7095(0x4c2)] } : _0x557cc6[_0x1b7095(0x4c2)] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; if (Array[_0x1b7095(0x65c)](_0x48e151[_0x1b7095(0x46d)])) _0x557cc6['chats'] = _0x48e151[_0x1b7095(0x46d)], _0x557cc6[_0x1b7095(0x589)] = _0x48e151['activeChatId'] || null; else Array['isArray'](_0x48e151[_0x1b7095(0x618)]) && (console['log'](_0x1b7095(0x654)), _0x557cc6[_0x1b7095(0x46d)] = _0x48e151[_0x1b7095(0x618)][_0x1b7095(0x30e)](_0x2e80af => ({ 'id': _0x1b7095(0x6ba) + _0x2e80af['id'], 'type': 'private', 'participantIds': [_0x2e80af['id']] })), _0x48e151[_0x1b7095(0x630)] && (_0x557cc6[_0x1b7095(0x589)] = _0x1b7095(0x6ba) + _0x48e151[_0x1b7095(0x630)]), _0x48e151[_0x1b7095(0x618)][_0x1b7095(0x302)](_0x1e0443 => { const _0x558046 = _0x1b7095, _0x56057a = 'chatHistory_' + _0x1e0443['id'], _0x1f5ee9 = _0x558046(0x653) + _0x1e0443['id'], _0x238b89 = localStorage[_0x558046(0x426)](_0x56057a); _0x238b89 && (_0x558046(0x4a5) === _0x558046(0x4a5) ? (localStorage['setItem'](_0x1f5ee9, _0x238b89), localStorage[_0x558046(0x17f)](_0x56057a)) : (_0x14d9c6(), _0x8e5650(![]))); })); } } catch (_0x360847) { console[_0x1b7095(0x50e)]('Failed\x20to\x20parse\x20state\x20from\x20localStorage,\x20resetting.', _0x360847), _0x557cc6['characters'] = [], _0x557cc6[_0x1b7095(0x46d)] = [], _0x557cc6[_0x1b7095(0x589)] = null; try { localStorage[_0x1b7095(0x17f)]('appState'); } catch (_0x512f98) { console[_0x1b7095(0x50e)](_0x1b7095(0x3ba), _0x512f98); } } let _0xb3e7de = ![]; if (_0x557cc6[_0x1b7095(0x618)][_0x1b7095(0x7a6)] === 0x0) _0xb3e7de = !![], _0x557cc6['activeChatId'] = null; else !_0x557cc6['chats'][_0x1b7095(0x4d1)](_0x4f8efb => _0x4f8efb['id'] === _0x557cc6['activeChatId']) && (_0x557cc6[_0x1b7095(0x589)] = _0x557cc6[_0x1b7095(0x46d)][0x0]?.['id'] || null); return _0x162000(), _0xb3e7de; } function _0x2efa53() { const _0x3d5f49 = _0x27dd8f; if (_0x3d5f49(0xb1) === _0x3d5f49(0xb1)) { if (!_0x557cc6[_0x3d5f49(0x589)]) return; try { _0x3d5f49(0x801) === 'NDXcZ' ? _0x5e684d() : localStorage[_0x3d5f49(0x69e)](_0x3d5f49(0x1cb) + _0x557cc6[_0x3d5f49(0x589)], JSON[_0x3d5f49(0x82f)](_0x557cc6[_0x3d5f49(0x5b8)])); } catch (_0x123aca) { 'qYlOy' === _0x3d5f49(0x3e7) ? _0x4c2ef2 = _0x17cfb9['content'] : (console[_0x3d5f49(0x50e)](_0x3d5f49(0x212), _0x123aca), _0x599dea(_0x3d5f49(0x3aa))); } } else _0x693ef6['textContent'] = '▶'; } function _0x2fa9f4() { const _0x411238 = _0x27dd8f; if (_0x411238(0x607) !== 'uXTHY') _0x2d2a3c[_0x411238(0x57e)](); else { if (!_0x557cc6[_0x411238(0x589)]) { _0x557cc6[_0x411238(0x5b8)] = [], _0x2292d9(); return; } let _0x4e137a = null; try { _0x4e137a = localStorage[_0x411238(0x426)](_0x411238(0x1cb) + _0x557cc6['activeChatId']); } catch (_0x59234e) { if (_0x411238(0x84) === _0x411238(0x174)) { let _0x556c3e = ''; if (_0x79b90c['likes'] && _0x10abda[_0x411238(0x304)][_0x411238(0x7a6)] > 0x0) { const _0x2cecc9 = _0x3214b1['likes'][_0x411238(0x30e)](_0x256536 => _0x23d78e(_0x256536)?.[_0x411238(0x293)] || '未知')['join']('、'); _0x556c3e = _0x411238(0x2c0) + _0x2cecc9 + _0x411238(0x7b7); } let _0x479ff2 = ''; if (_0x44c657[_0x411238(0x7b)] && _0x5e32c9[_0x411238(0x7b)][_0x411238(0x7a6)] > 0x0) { const _0x4f5029 = _0x3dd436[_0x411238(0x7b)][_0x411238(0x30e)](_0x16d264 => { const _0xec056 = _0x411238, _0x4e64fc = _0x3f4524(_0x16d264[_0xec056(0x25f)])?.[_0xec056(0x293)] || '未知'; return _0xec056(0x124) + _0x4e64fc + _0xec056(0x3d7) + _0x16d264['content'] + _0xec056(0x7b7); })[_0x411238(0x566)](''); _0x479ff2 = _0x411238(0x1e6) + _0x4f5029 + _0x411238(0x7b7); } _0x4085b6 = _0x411238(0x220) + _0x556c3e + _0x411238(0x843) + _0x479ff2 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20'; } else console[_0x411238(0x50e)]('Failed\x20to\x20read\x20history\x20for\x20chat\x20' + _0x557cc6[_0x411238(0x589)], _0x59234e); } let _0x4c3363 = []; if (_0x4e137a) { if (_0x411238(0x84a) !== _0x411238(0x4e0)) try { if ('WHCnA' !== _0x411238(0x6a9)) _0x48a4cb = _0x471fb5[_0x411238(0x5ba)](_0x411238(0x509)), _0x7b7abd[_0x411238(0x640)] = 'typing-indicator', _0x140172[_0x411238(0x2d0)] = _0x411238(0x149), _0x3855c3['style'][_0x411238(0x39e)] = _0x411238(0x74f), _0x12da34[_0x411238(0x6ca)]['padding'] = '15px\x2020px', _0x592718['style'][_0x411238(0x266)] = '8px', _0x5d758d[_0x411238(0x796)](_0x5ef889); else { const _0x4b717a = JSON[_0x411238(0x417)](_0x4e137a); if (Array[_0x411238(0x65c)](_0x4b717a)) { if (_0x411238(0x598) !== _0x411238(0x363)) _0x4c3363 = _0x4b717a[_0x411238(0x1d8)](_0x6e4601 => _0x6e4601 && typeof _0x6e4601 === _0x411238(0x4b9) && typeof _0x6e4601[_0x411238(0x7b4)] === _0x411238(0x286) && typeof _0x6e4601[_0x411238(0x398)] !== _0x411238(0x71f)); else { _0x2ddc53(_0x411238(0x61c)); return; } } } } catch (_0x340ef1) { console['error']('Failed\x20to\x20parse\x20history\x20for\x20chat\x20' + _0x557cc6[_0x411238(0x589)] + _0x411238(0x732), _0x340ef1); try { localStorage[_0x411238(0x17f)](_0x411238(0x1cb) + _0x557cc6[_0x411238(0x589)]); } catch (_0x17d37f) { _0x411238(0x263) === _0x411238(0x263) ? console[_0x411238(0x50e)](_0x411238(0x552), _0x17d37f) : _0x48d9ee[_0x39d928][_0x411238(0x35f)][_0x411238(0x632)](_0x411238(0x3fe)); } } else { const _0x4ec8f8 = _0x3deb52(_0x199d7c[_0x411238(0x25f)])?.[_0x411238(0x293)] || '未知'; return _0x411238(0x124) + _0x4ec8f8 + _0x411238(0x3d7) + _0x3fea20[_0x411238(0x398)] + _0x411238(0x7b7); } } _0x557cc6[_0x411238(0x5b8)] = _0x4c3363, _0x784812['innerHTML'] = ''; if (_0x557cc6[_0x411238(0x5b8)]) { if ('GIbTK' !== 'BLGMB') _0x557cc6[_0x411238(0x5b8)][_0x411238(0x302)]((_0x1c846d, _0x6d35e3) => _0x53c19f(_0x1c846d, _0x6d35e3)); else { _0x45b25a[_0x411238(0x6d7)][_0xcdee13] = null; if (_0x1a5047 === 'image') _0x5824ea[_0x411238(0x6d7)][_0x411238(0x8c)] = null; _0x52e8ab(); } } setTimeout(() => { const _0x2d786e = _0x411238; _0x784812['scrollTop'] = _0x784812[_0x2d786e(0x4c1)]; }, 0x0); } } async function _0x306347() { const _0x7cd082 = _0x27dd8f; if (_0x7cd082(0x69b) === _0x7cd082(0x69b)) { const _0x96c47a = document[_0x7cd082(0x5b7)](_0x7cd082(0x45f)); try { if (_0x7cd082(0x647) === 'hawSd') { let _0x2c48f2 = await _0x2aeef5(_0x7cd082(0x52f)); if (!_0x2c48f2) { if ('VTXAk' === _0x7cd082(0x29c)) { const _0x5dec63 = localStorage[_0x7cd082(0x426)](_0x7cd082(0x99)); _0x5dec63 && (console['log'](_0x7cd082(0xe8)), _0x2c48f2 = await _0x57a56e(_0x5dec63), await _0x3aff46(_0x7cd082(0x52f), _0x2c48f2), localStorage[_0x7cd082(0x17f)](_0x7cd082(0x99))); } else _0x29a1ea[_0x7cd082(0x483)] = _0x29e1aa['createObjectURL'](_0x5caae1); } _0x2c48f2 ? 'TsFMy' === 'XYEAz' ? _0x1dac11[_0x7cd082(0x17f)](_0x7cd082(0x1cb) + _0x4cabab) : (_0x96c47a[_0x7cd082(0x6ca)][_0x7cd082(0xcf)] = _0x7cd082(0x520) + URL[_0x7cd082(0x371)](_0x2c48f2) + ')', _0x96c47a['style'][_0x7cd082(0x4a9)] = _0x7cd082(0x791), _0x96c47a[_0x7cd082(0x6ca)][_0x7cd082(0x24d)] = 'center') : _0x96c47a[_0x7cd082(0x6ca)][_0x7cd082(0xcf)] = ''; } else _0x2a2c7d[_0x7cd082(0x6ca)][_0x7cd082(0xcf)] = _0x7cd082(0x1d1) + _0x495158[_0x7cd082(0x39f)] + '\x27)', _0x4bb3a3[_0x7cd082(0x6ca)][_0x7cd082(0x4a9)] = _0x7cd082(0x791), _0x3f4cfa[_0x7cd082(0x6ca)]['backgroundPosition'] = _0x7cd082(0x5ff); } catch (_0x3947d8) { if (_0x7cd082(0xc0) === _0x7cd082(0xc0)) console[_0x7cd082(0x50e)]('加载壁纸失败:', _0x3947d8), phoneContainer['style']['backgroundImage'] = ''; else { _0x33d1f3[_0x7cd082(0x35f)]['add'](_0x7cd082(0xc9)); const _0x5e0a3 = _0x309f25[_0x7cd082(0x7b4)] === _0x7cd082(0x472) ? _0x497d79(_0x59b3fa[_0x7cd082(0x589)]) : _0x4d2862(_0x38e8cb['senderId']), _0x20e30a = _0x1c31c8[_0x7cd082(0x6c2)] === _0x37e110(_0x204c92[_0x7cd082(0x589)])['id'] ? _0x554fea(_0x317393[_0x7cd082(0x589)]) : _0xc8bd10(_0x1f2567['recipientId']), _0x1fe5a6 = _0x5e0a3?.[_0x7cd082(0x293)] ? _0x5e0a3[_0x7cd082(0x293)] + _0x7cd082(0x59d) : '转账', _0x17de93 = _0x20e30a?.['name'] ? _0x7cd082(0x84b) + _0x20e30a[_0x7cd082(0x293)] : '转账', _0x39723e = _0x7cd082(0x60d) + _0x1fe5a6 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥' + _0x140a18[_0x7cd082(0x5e3)][_0x7cd082(0x3f4)](0x2) + _0x7cd082(0x52a) + _0x17de93 + _0x7cd082(0xc6); _0x263c96[_0x7cd082(0x7a2)] = _0x39723e; } } } else _0x25d4f9(![]), _0x2752bd[_0x7cd082(0x44b)][_0x7cd082(0x73f)] = ''; } function _0x1c1971() { const _0x2bb304 = _0x27dd8f, _0x34fb56 = localStorage[_0x2bb304(0x426)](_0x2bb304(0x842)); _0x34fb56 ? document[_0x2bb304(0x5b7)](_0x2bb304(0x498))[_0x2bb304(0x6ca)][_0x2bb304(0x6a0)](_0x2bb304(0x3b1), _0x2bb304(0x520) + _0x34fb56 + ')') : _0x2bb304(0x517) === _0x2bb304(0x517) ? document[_0x2bb304(0x5b7)](_0x2bb304(0x498))[_0x2bb304(0x6ca)]['setProperty']('--feed-bg-image', 'none') : _0x15d66a[_0x2bb304(0x69e)](_0x441658, _0x52456d['localStorageData'][_0x502cc4]); } async function _0x54f87d(_0x67506b) { const _0x5f3a71 = _0x27dd8f; try { await _0x3aff46(_0x5f3a71(0x52f), _0x67506b), await _0x306347(), _0x599dea(_0x5f3a71(0x628)); } catch (_0x518e41) { console[_0x5f3a71(0x50e)](_0x5f3a71(0x1dd), _0x518e41), _0x599dea(_0x5f3a71(0x6ff) + _0x518e41[_0x5f3a71(0x832)]); } } function _0x12956f(_0x2fd808) { const _0x3fdb16 = _0x27dd8f; if (_0x3fdb16(0x3cb) === _0x3fdb16(0x3cb)) { const _0x5c249c = { 'quotedMessage': null, 'content': _0x2fd808 }, _0x2508b4 = _0x2fd808[_0x3fdb16(0x3ee)](/^\[引用\|(.*?)\|(.*?)\]\s*/); return _0x2508b4 && (_0x5c249c[_0x3fdb16(0x6c7)] = { 'sender': _0x2508b4[0x1][_0x3fdb16(0xf2)](), 'content': _0x2508b4[0x2]['trim']() }, _0x5c249c['content'] = _0x2fd808[_0x3fdb16(0x471)](_0x2508b4[0x0][_0x3fdb16(0x7a6)])[_0x3fdb16(0xf2)]()), _0x5c249c; } else { const _0x35368d = _0x43ca90[_0x3fdb16(0x5b7)](_0x3fdb16(0x767)); if (!_0x35368d) return; const _0x403b15 = _0x4739c4[_0x3fdb16(0x426)](_0x3fdb16(0xa7)) || '35'; _0x5551d3[_0x3fdb16(0x78c)][_0x3fdb16(0x6ca)][_0x3fdb16(0x6a0)](_0x3fdb16(0x68c), _0x403b15), _0x35368d[_0x3fdb16(0x73f)] = _0x403b15, _0x35368d[_0x3fdb16(0x572)]('input', () => { const _0x2a5759 = _0x3fdb16, _0x40c055 = _0x35368d[_0x2a5759(0x73f)]; _0x17ee40[_0x2a5759(0x78c)][_0x2a5759(0x6ca)][_0x2a5759(0x6a0)](_0x2a5759(0x68c), _0x40c055), _0x571b6c['setItem'](_0x2a5759(0xa7), _0x40c055), _0x557e32(); }); } } const _0x468719 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x1b8)), _0x23ff08 = document[_0x27dd8f(0x5b7)]('message-action-backdrop'), _0x3a405d = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x7bb)), _0x566ce8 = document[_0x27dd8f(0x5b7)]('delete-message-button'), _0x25f5bd = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x172)), _0x117121 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x48e)), _0x8671b4 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x47a)), _0x10db5b = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x1eb)), _0x18e4c1 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x2a1)), _0x31bbc2 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x7af)), _0x2e48c9 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x500)); let _0x5247c8 = null; function _0xaf7b77(_0x516b4e) { const _0x9a1bda = _0x27dd8f; _0x5247c8 = _0x516b4e, _0x468719['classList'][_0x9a1bda(0x632)]('show'); } function _0x28748e() { const _0x1b7668 = _0x27dd8f; _0x468719[_0x1b7668(0x35f)][_0x1b7668(0x7ff)](_0x1b7668(0x1c6)); } function _0x2b6872() { _0x28748e(), _0x5247c8 = null; } function _0xff3ae5() { const _0x3e5469 = _0x27dd8f; if (_0x5247c8 === null) return; _0x557cc6[_0x3e5469(0x5b8)][_0x3e5469(0x168)](_0x5247c8, 0x1), _0x2efa53(), _0x2dea46(), _0x2b6872(); } function _0x4fbd9c() { const _0x6b1ff3 = _0x27dd8f; if (_0x5247c8 === null) return; const _0x4bf52d = _0x557cc6[_0x6b1ff3(0x5b8)][_0x5247c8]; if (!_0x4bf52d) return; _0x18e4c1[_0x6b1ff3(0x73f)] = _0x4bf52d[_0x6b1ff3(0x398)], _0x28748e(), _0x8671b4[_0x6b1ff3(0x35f)]['add'](_0x6b1ff3(0x1c6)), _0x18e4c1['focus'](); } function _0x266efb() { const _0x3f7999 = _0x27dd8f; if ('uQPGS' !== 'LIrLf') { if (_0x5247c8 === null) return; const _0x402d17 = _0x18e4c1[_0x3f7999(0x73f)]['trim'](); if (_0x402d17 === '') { _0x26d61f(); return; } const _0x157d07 = _0x557cc6['conversationHistory'][_0x5247c8]; _0x157d07 && ('XpySS' === 'puBVw' ? (_0x9ae44d(), _0x1b8e0d(![])) : (_0x157d07[_0x3f7999(0x398)] = _0x402d17, _0x2efa53(), _0x2dea46())), _0x8671b4[_0x3f7999(0x35f)]['remove'](_0x3f7999(0x1c6)), _0x5247c8 = null; } else _0x488d09[_0x3f7999(0x58d)] = _0x9551f['userProfiles'], _0x186a20[_0x3f7999(0x26a)] = _0x56583f[_0x3f7999(0x26a)]; } function _0x26d61f() { const _0x1ebb4c = _0x27dd8f; _0x8671b4['classList']['remove'](_0x1ebb4c(0x1c6)), _0x5247c8 = null; } _0x23ff08['addEventListener'](_0x27dd8f(0x66b), _0x2b6872), _0x25f5bd[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x2b6872), _0x566ce8[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0xff3ae5), _0x3a405d[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x4fbd9c), _0x117121[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x1cc0d4), _0x352be6[_0x27dd8f(0x572)]('click', _0x3e0b48), _0x31bbc2[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x266efb), _0x2e48c9[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x26d61f), _0x10db5b[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x26d61f); function _0x1cc0d4() { const _0x12d02d = _0x27dd8f; if (_0x5247c8 === null) return; const _0x34f836 = _0x557cc6[_0x12d02d(0x5b8)][_0x5247c8]; if (!_0x34f836) return; const _0x30614f = _0x5db7d2(); let _0x59d057 = '未知'; if (_0x34f836[_0x12d02d(0x7b4)] === _0x12d02d(0x472)) _0x12d02d(0x48a) === _0x12d02d(0x7cb) ? _0x417b7c['classList']['add']('show-chat-view') : _0x59d057 = _0x557cc6[_0x12d02d(0x204)][_0x12d02d(0x293)] || '我'; else { const _0x39e11e = _0x34f836[_0x12d02d(0x6fa)] || _0x30614f?.[_0x12d02d(0x765)][0x0], _0x53ff02 = _0x3132c6(_0x39e11e); _0x59d057 = _0x53ff02 ? _0x53ff02[_0x12d02d(0x293)] : '角色'; } let _0xaf9be9 = _0x34f836[_0x12d02d(0x398)] || ''; if (_0x34f836['displayUrl']) _0xaf9be9 = _0x12d02d(0x1e7); if (_0x34f836[_0x12d02d(0x690)]) _0xaf9be9 = _0x12d02d(0x2b7); if (_0xaf9be9[_0x12d02d(0x7a6)] > 0x32) _0xaf9be9 = _0xaf9be9[_0x12d02d(0x471)](0x0, 0x32) + _0x12d02d(0x78a); _0x557cc6[_0x12d02d(0x443)] = { 'sender': _0x59d057, 'content': _0xaf9be9 }, _0x321817(), _0x2b6872(), _0x4aebf[_0x12d02d(0x3e4)](); } function _0x321817() { const _0x97e1f1 = _0x27dd8f; if (!_0x557cc6[_0x97e1f1(0x443)]) return; _0x55d9ca['textContent'] = _0x97e1f1(0x72b) + _0x557cc6[_0x97e1f1(0x443)][_0x97e1f1(0x831)], _0x5e8a39[_0x97e1f1(0x2d0)] = _0x557cc6['activeQuote']['content'], _0x1be7f6[_0x97e1f1(0x6ca)][_0x97e1f1(0x836)] = _0x97e1f1(0x534); } function _0x3e0b48() { const _0x4ef7a8 = _0x27dd8f; _0x557cc6['activeQuote'] = null, _0x1be7f6[_0x4ef7a8(0x6ca)]['display'] = _0x4ef7a8(0x4e3); } function _0x4f27ca(_0x1d1b92, _0x5b85db) { const _0x59c737 = _0x27dd8f, _0x138f4f = document['getElementById'](_0x59c737(0x6e6)); if (_0x138f4f) { if ('dyJvc' === _0x59c737(0x3de)) _0x1d1b92 === 'home' ? _0x59c737(0x4d6) === _0x59c737(0x4d6) ? _0x138f4f[_0x59c737(0x6ca)][_0x59c737(0x836)] = _0x59c737(0x27a) : _0x20dcb7 = _0x311654['id'] : _0x138f4f[_0x59c737(0x6ca)][_0x59c737(0x836)] = _0x59c737(0x4e3); else { const _0x524870 = _0x26e885[_0x59c737(0x44b)][_0x59c737(0x209)][0x0]; if (!_0x524870) return; const _0x214310 = _0x4f03dd[_0x59c737(0x371)](_0x524870); _0x21b0a4['src'] = _0x214310, _0x29957b['onload'] = () => { _0xf77b8c['revokeObjectURL'](_0x214310); }; } } _0x42deec = _0x5b85db || null, Object[_0x59c737(0x57d)](_0x592548)[_0x59c737(0x302)](_0x575dd6 => _0x575dd6[_0x59c737(0x35f)][_0x59c737(0x7ff)]('active')); if (_0x592548[_0x1d1b92]) { if ('UcqFN' !== _0x59c737(0x339)) _0x592548[_0x1d1b92]['classList'][_0x59c737(0x632)](_0x59c737(0x3fe)); else { _0x546b0b[_0x59c737(0x50e)]('Failed\x20to\x20parse\x20history\x20for\x20chat\x20' + _0x3450cf[_0x59c737(0x589)] + ',\x20resetting.', _0x11a1c9); try { _0x34474a[_0x59c737(0x17f)](_0x59c737(0x1cb) + _0x1f3a65['activeChatId']); } catch (_0x304783) { _0x46e433['error'](_0x59c737(0x552), _0x304783); } } } _0x1d1b92 !== _0x59c737(0x827) && _0x2f066d['classList']['remove']('show-chat-view'); } function _0x1f1930(_0x1de858) { const _0x3fd63d = _0x27dd8f; _0x1de858 ? _0x2f066d['classList'][_0x3fd63d(0x632)](_0x3fd63d(0x2c2)) : _0x2f066d[_0x3fd63d(0x35f)][_0x3fd63d(0x7ff)](_0x3fd63d(0x2c2)); } async function _0x18d2c5() { const _0x40f7ae = _0x27dd8f; if ('FUWwK' !== _0x40f7ae(0xdd)) _0x5a40bd[_0x40f7ae(0x161)] && _0xe41bd9[_0x40f7ae(0xb8)] && (_0xff3f29[_0x40f7ae(0x235)](_0x40f7ae(0x20d)), _0x2155e5[_0x40f7ae(0xb8)][_0x40f7ae(0x2b0)](_0x40f7ae(0x7bf)), _0x3bf1f5[_0x40f7ae(0xb8)] = null), _0x49e79e[_0x40f7ae(0x161)] = ![], _0x1a647d(![]); else { _0xbf38fa[_0x40f7ae(0x7a2)] = ''; for (const _0x21e89f of _0x557cc6[_0x40f7ae(0x46d)]) { const _0x5d662b = document[_0x40f7ae(0x5ba)]('li'); _0x5d662b[_0x40f7ae(0x640)] = _0x40f7ae(0x1b9), _0x5d662b['dataset']['id'] = _0x21e89f['id']; let _0xf712ac = _0x1732e7, _0x15fb4c = '群聊', _0xaa469b = ''; if (_0x21e89f[_0x40f7ae(0x516)] === _0x40f7ae(0x405)) { if ('ceWAl' === _0x40f7ae(0x310)) _0x368594 = _0x57ccd2['value']; else { const _0x57c927 = _0x3132c6(_0x21e89f[_0x40f7ae(0x765)][0x0]); _0x57c927 ? (_0xf712ac = _0x57c927['avatar'] || _0x1732e7, _0x15fb4c = _0x57c927['name'] || _0x40f7ae(0x6d5), _0xaa469b = _0x57c927[_0x40f7ae(0x5aa)] || '私聊') : (_0x15fb4c = _0x40f7ae(0x5c5), _0xaa469b = _0x40f7ae(0xa6)); } } else { if ('mROEe' !== _0x40f7ae(0x507)) { _0x15fb4c = _0x21e89f[_0x40f7ae(0x293)] || _0x40f7ae(0x384), _0xaa469b = _0x21e89f[_0x40f7ae(0x765)]['length'] + _0x40f7ae(0x4cf); const _0x2533ad = await _0x2aeef5('group_avatar_' + _0x21e89f['id']); if (_0x2533ad) _0xf712ac = URL['createObjectURL'](_0x2533ad); } else { const _0x5ddc97 = _0x10ea97['userProfiles'][_0x40f7ae(0x4d1)](_0x4df76b => _0x4df76b['id'] === _0x47e550); if (!_0x5ddc97) return; _0x2d84bd[_0x40f7ae(0x5b7)](_0x40f7ae(0x5af))['value'] = _0x5ddc97['id'], _0x17fe8d[_0x40f7ae(0x5b7)]('user-profile-edit-title')['textContent'] = _0x40f7ae(0x21e), _0x2758be[_0x40f7ae(0x5b7)](_0x40f7ae(0x4a3))[_0x40f7ae(0x73f)] = _0x5ddc97['name'], _0x7e2aae[_0x40f7ae(0x5b7)](_0x40f7ae(0x1fc))['src'] = _0x5ddc97[_0x40f7ae(0x51e)], _0x510f11[_0x40f7ae(0x5b7)](_0x40f7ae(0x36f))[_0x40f7ae(0x73f)] = _0x5ddc97[_0x40f7ae(0x6f2)], _0x1cf70f[_0x40f7ae(0x6ca)][_0x40f7ae(0x836)] = _0x5ddc97['id'] === _0x89386e[_0x40f7ae(0x26a)] ? _0x40f7ae(0x4e3) : _0x40f7ae(0x534); } } _0x5d662b[_0x40f7ae(0x7a2)] = _0x40f7ae(0x64e) + _0xf712ac + _0x40f7ae(0xe3) + _0x15fb4c + _0x40f7ae(0x5c1) + _0xaa469b + _0x40f7ae(0x3e5), _0x5d662b['querySelector'](_0x40f7ae(0x32f))[_0x40f7ae(0x572)](_0x40f7ae(0x66b), () => { _0xe92c95(_0x21e89f['id']), _0x1f1930(!![]); }), _0xbf38fa[_0x40f7ae(0x796)](_0x5d662b); } } } function _0x533c8b() { const _0x59e6c8 = _0x27dd8f; if (_0x59e6c8(0x780) === 'YjTxT') { const _0x19d20d = _0x33bbca['worldBooks'][_0x59e6c8(0x4d1)](_0xc9495c => _0xc9495c['id'] === _0x404c00); _0x19d20d && (_0x19d20d[_0x59e6c8(0x293)] = _0x259129, _0x19d20d['content'] = _0x44bacf); } else { const _0x1ac95d = document['getElementById'](_0x59e6c8(0x3d4)); _0x1ac95d['innerHTML'] = ''; const _0x2c8fea = _0x557cc6[_0x59e6c8(0x618)]['filter'](_0x1bbf09 => _0x557cc6[_0x59e6c8(0x46d)][_0x59e6c8(0x74d)](_0x438ef6 => _0x438ef6[_0x59e6c8(0x516)] === 'private' && _0x438ef6[_0x59e6c8(0x765)][_0x59e6c8(0x158)](_0x1bbf09['id']))); if (_0x2c8fea[_0x59e6c8(0x7a6)] === 0x0) { if (_0x59e6c8(0x829) === _0x59e6c8(0x829)) { _0x1ac95d['innerHTML'] = _0x59e6c8(0x65e); return; } else _0x12ba45['push'](_0x1c9eba[_0x59e6c8(0x186)](_0x239a6d, _0x22e7f4 + _0x2671dc)); } _0x2c8fea['forEach'](_0x2b76c6 => { const _0x2ad5b8 = _0x59e6c8, _0x1a737e = document[_0x2ad5b8(0x5ba)]('li'); _0x1a737e[_0x2ad5b8(0x640)] = _0x2ad5b8(0x1b9), _0x1a737e[_0x2ad5b8(0x78)][_0x2ad5b8(0x2bf)] = _0x2b76c6['id'], _0x1a737e[_0x2ad5b8(0x7a2)] = _0x2ad5b8(0x16f) + (_0x2b76c6[_0x2ad5b8(0x51e)] || _0x1732e7) + _0x2ad5b8(0x317) + _0x2b76c6[_0x2ad5b8(0x293)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>' + (_0x2b76c6['remark'] || '私聊') + _0x2ad5b8(0xa3), _0x1a737e[_0x2ad5b8(0x572)](_0x2ad5b8(0x66b), () => { _0x314cb1(_0x2b76c6['id']); }), _0x1ac95d[_0x2ad5b8(0x796)](_0x1a737e); }); } } async function _0x314cb1(_0x396d50) { const _0x27e90f = _0x27dd8f; if (_0x27e90f(0x54c) !== _0x27e90f(0x303)) { const _0x23d216 = _0x3132c6(_0x396d50); if (!_0x23d216) return; document[_0x27e90f(0x5b7)](_0x27e90f(0x846))['src'] = '', _0x557cc6['activeMeetingCharId'] = _0x396d50; const _0x11c76b = _0x557cc6['chats']['find'](_0x5a3e0e => _0x5a3e0e[_0x27e90f(0x516)] === 'private' && _0x5a3e0e[_0x27e90f(0x765)][_0x27e90f(0x158)](_0x396d50)); _0x11c76b ? _0x27e90f(0x79f) !== _0x27e90f(0x2ed) ? (_0x557cc6[_0x27e90f(0x589)] = _0x11c76b['id'], _0x162000(), _0x2fa9f4(), _0x4fdbfa(_0x396d50)) : _0x94e608(_0x311a28['id']) : _0x557cc6[_0x27e90f(0x5b8)] = []; document[_0x27e90f(0x5b7)](_0x27e90f(0x5bd))[_0x27e90f(0x2d0)] = _0x23d216[_0x27e90f(0x293)]; const _0x1c56f0 = document['getElementById']('meeting-main-content'); try { const _0x19b4f6 = await _0x2aeef5(_0x27e90f(0x66e) + _0x396d50); _0x19b4f6 ? (_0x1c56f0[_0x27e90f(0x6ca)][_0x27e90f(0xcf)] = 'url(\x27' + URL[_0x27e90f(0x371)](_0x19b4f6) + '\x27)', _0x1c56f0[_0x27e90f(0x6ca)][_0x27e90f(0x4a9)] = _0x27e90f(0x791), _0x1c56f0[_0x27e90f(0x6ca)]['backgroundPosition'] = _0x27e90f(0x5ff)) : _0x1c56f0[_0x27e90f(0x6ca)][_0x27e90f(0xcf)] = _0x27e90f(0x4e3); } catch (_0x134f11) { console[_0x27e90f(0x50e)](_0x27e90f(0x1b4) + _0x396d50 + ':', _0x134f11), _0x1c56f0['style'][_0x27e90f(0xcf)] = 'none'; } _0x5164c1(), _0x22f914(); if (_0x258b12) clearInterval(_0x258b12); _0x4da3b9(), _0x258b12 = setInterval(_0x4da3b9, 0x2710), _0x4f27ca(_0x27e90f(0x58f), 'meetingList'); } else { _0x2362de(_0x27e90f(0x4ce)); return; } } function _0x22f914() { const _0x7155c7 = _0x27dd8f; if ('wjxDQ' !== _0x7155c7(0x75e)) _0x20cbbd['createObjectStore'](_0x3e5a56, { 'keyPath': 'id' }); else { const _0x1d58fe = document[_0x7155c7(0x5b7)]('meeting-scene-view'); _0x1d58fe[_0x7155c7(0x7a2)] = ''; const _0x1fd4b7 = _0x1d58fe['querySelector'](_0x7155c7(0x535)); if (_0x1fd4b7) _0x1fd4b7['remove'](); _0x557cc6[_0x7155c7(0x5b8)] && _0x557cc6[_0x7155c7(0x5b8)]['forEach']((_0x38fcf9, _0x98fbd0) => { const _0x464e67 = _0x7155c7; if (!_0x38fcf9[_0x464e67(0x7fe)] || _0x38fcf9['role'] === _0x464e67(0x14b)) return; const _0x30fc0e = document[_0x464e67(0x5ba)]('p'); _0x30fc0e[_0x464e67(0x78)][_0x464e67(0x52d)] = _0x98fbd0; const _0x13fa61 = _0x38fcf9[_0x464e67(0x398)][_0x464e67(0x4f8)](/\n/g, '<br>'); let _0x3142eb = '', _0x41b4a8 = ''; const _0x25cb9e = _0x40920c(_0x557cc6[_0x464e67(0x589)]); if (_0x38fcf9[_0x464e67(0x7b4)] === _0x464e67(0x472)) { if ('UvXix' !== _0x464e67(0x353)) { const _0x318880 = _0x5edc1e[_0x464e67(0x5b7)](_0x464e67(0x48c)); _0x318880[_0x464e67(0x2d0)] = _0x5bf36b, _0x318880[_0x464e67(0x6ca)][_0x464e67(0x836)] = _0x464e67(0x534); if (_0x556f56['_t']) _0x80448d(_0x70a376['_t']); _0x3b7665['_t'] = _0x2a3594(() => { const _0x1eb48d = _0x464e67; _0x318880['style'][_0x1eb48d(0x836)] = 'none'; }, 0x640); } else _0x3142eb = _0x25cb9e[_0x464e67(0x293)] || '我', _0x41b4a8 = _0x464e67(0x105); } else { if (_0x38fcf9[_0x464e67(0x7b4)] === 'assistant') { const _0x28da00 = _0x3132c6(_0x38fcf9['senderId'] || _0x557cc6[_0x464e67(0x243)]); _0x3142eb = _0x28da00?.[_0x464e67(0x293)] || '角色', _0x41b4a8 = 'speaker-ai'; } } _0x30fc0e[_0x464e67(0x6ca)][_0x464e67(0x39e)] = 'rgba(0,\x200,\x200,\x200.4)', _0x30fc0e['style'][_0x464e67(0x733)] = _0x464e67(0x8f), _0x30fc0e[_0x464e67(0x6ca)]['borderRadius'] = _0x464e67(0x223), _0x30fc0e[_0x464e67(0x6ca)][_0x464e67(0x400)] = _0x464e67(0x2eb), _0x3142eb ? _0x30fc0e[_0x464e67(0x7a2)] = _0x464e67(0x427) + _0x41b4a8 + _0x464e67(0x46e) + (_0x41b4a8 === _0x464e67(0x105) ? '#a7c7e7' : _0x464e67(0x12e)) + _0x464e67(0xb0) + _0x3142eb + _0x464e67(0x80a) + _0x13fa61 : (_0x30fc0e[_0x464e67(0x640)] = _0x464e67(0x24c), _0x30fc0e[_0x464e67(0x6ca)]['fontStyle'] = _0x464e67(0x538), _0x30fc0e[_0x464e67(0x6ca)][_0x464e67(0x3a2)] = _0x464e67(0x77c), _0x30fc0e['innerHTML'] = _0x13fa61), _0x1d58fe[_0x464e67(0x796)](_0x30fc0e); }); if (_0x557cc6['isGenerating']) { let _0x391730 = _0x1d58fe[_0x7155c7(0x5ab)](_0x7155c7(0x781)); !_0x391730 && (_0x391730 = document[_0x7155c7(0x5ba)](_0x7155c7(0x509)), _0x391730['className'] = 'typing-indicator', _0x391730[_0x7155c7(0x2d0)] = _0x7155c7(0x149), _0x391730[_0x7155c7(0x6ca)][_0x7155c7(0x39e)] = _0x7155c7(0x74f), _0x391730['style'][_0x7155c7(0x733)] = _0x7155c7(0x8f), _0x391730[_0x7155c7(0x6ca)][_0x7155c7(0x266)] = _0x7155c7(0x223), _0x1d58fe['appendChild'](_0x391730)); } const _0x29f5cb = document[_0x7155c7(0x5ba)](_0x7155c7(0x509)); _0x29f5cb['id'] = _0x7155c7(0x74e), _0x1d58fe[_0x7155c7(0x796)](_0x29f5cb), setTimeout(() => { const _0x3d2135 = _0x7155c7; _0x29f5cb[_0x3d2135(0x1c2)]({ 'behavior': 'auto', 'block': 'end' }); }, 0x32); } } function _0x2dea46() { const _0x353401 = _0x27dd8f, _0x1017e8 = document[_0x353401(0x5ab)](_0x353401(0x486)); if (!_0x1017e8) return; _0x1017e8['id'] === _0x353401(0x704) ? _0x22f914() : _0x2292d9(); } function _0x2292d9() { const _0x16ff81 = _0x27dd8f, _0x5afff5 = _0x557cc6[_0x16ff81(0x5b8)][_0x16ff81(0x1d8)](_0x1f30aa => !_0x1f30aa[_0x16ff81(0x7fe)] && _0x1f30aa['role'] !== _0x16ff81(0x14b)); if (_0x5afff5[_0x16ff81(0x7a6)] > _0x557cc6[_0x16ff81(0x1ee)]) { let _0x4ec9eb = _0x784812[_0x16ff81(0x5ab)]('.load-more-btn'); if (!_0x4ec9eb) { if (_0x16ff81(0x206) !== _0x16ff81(0x206)) { const _0x4a4bd2 = _0x288100[_0x16ff81(0x43b)](); if (_0x12c546['some'](_0x257fcc => _0x4a4bd2[_0x16ff81(0x795)](_0x257fcc))) { const _0xce2bb3 = _0x2e6ff5[_0x3fad85]; if (typeof _0xce2bb3 === _0x16ff81(0x286)) _0x23a3cc[_0x16ff81(0x6b4)](_0xce2bb3); if (_0x279e34[_0x16ff81(0x65c)](_0xce2bb3)) _0xce2bb3['forEach'](_0xd5c4ab => { const _0x451d76 = _0x16ff81; if (typeof _0xd5c4ab === _0x451d76(0x286)) _0x4f42a7[_0x451d76(0x6b4)](_0xd5c4ab); }); } } else _0x4ec9eb = document[_0x16ff81(0x5ba)](_0x16ff81(0x7fd)), _0x4ec9eb['textContent'] = _0x16ff81(0x463), _0x4ec9eb['className'] = _0x16ff81(0x81f), _0x4ec9eb[_0x16ff81(0x6ca)][_0x16ff81(0x4af)] = _0x16ff81(0xaa), _0x4ec9eb[_0x16ff81(0x6ca)][_0x16ff81(0xaf)] = '10px\x20auto', _0x4ec9eb['style'][_0x16ff81(0x733)] = _0x16ff81(0x50d), _0x4ec9eb[_0x16ff81(0x7bc)] = () => { const _0x49f43c = _0x16ff81; if ('XOGVq' === _0x49f43c(0x95)) { const _0x504f17 = _0x784812, _0x4d0120 = _0x504f17[_0x49f43c(0x4c1)], _0x220c5c = _0x504f17[_0x49f43c(0x4f0)]; _0x557cc6[_0x49f43c(0x1ee)] += 0x64, _0x2292d9(), requestAnimationFrame(() => { const _0x2c2b47 = _0x49f43c, _0x566885 = _0x504f17[_0x2c2b47(0x4c1)]; _0x504f17['scrollTop'] = _0x220c5c + (_0x566885 - _0x4d0120); }); } else { _0x5cd878('名字不能为空！'); return; } }, _0x784812['firstChild'] ? _0x16ff81(0x4fa) !== _0x16ff81(0x4fa) ? _0x1d5dea = _0x98998b['userProfile'][_0x16ff81(0x293)] || '我' : _0x784812[_0x16ff81(0x180)](_0x4ec9eb, _0x784812['firstChild']) : _0x784812[_0x16ff81(0x796)](_0x4ec9eb); } } else { const _0x4e1d91 = _0x784812[_0x16ff81(0x5ab)](_0x16ff81(0x56d)); if (_0x4e1d91) _0x4e1d91[_0x16ff81(0x7ff)](); } Array[_0x16ff81(0x652)](_0x784812[_0x16ff81(0x72d)])[_0x16ff81(0x302)](_0x3500d0 => { const _0x40ec28 = _0x16ff81; !_0x3500d0[_0x40ec28(0x35f)]['contains'](_0x40ec28(0x1d3)) && _0x3500d0['remove'](); }); const _0x4b2186 = _0x5afff5['slice'](-_0x557cc6[_0x16ff81(0x1ee)]); _0x4b2186[_0x16ff81(0x302)](_0x23da3b => { const _0x125a8d = _0x16ff81; if (_0x125a8d(0x165) === _0x125a8d(0x756)) _0x74c493['imageId'] = _0x2d83b4; else { const _0x2cc27c = _0x557cc6[_0x125a8d(0x5b8)][_0x125a8d(0x28f)](_0x23da3b); _0x2cc27c > -0x1 && _0x53c19f(_0x23da3b, _0x2cc27c); } }); if (_0x557cc6[_0x16ff81(0x161)]) { let _0x3258cc = _0x784812[_0x16ff81(0x5ab)]('.typing-indicator'); if (!_0x3258cc) { if (_0x16ff81(0x45e) !== _0x16ff81(0x45e)) { const _0x1ea941 = _0x4bffdc['createElement']('p'); _0x1ea941[_0x16ff81(0x2d0)] = _0x19b374[_0x16ff81(0x68e)], _0x1ea941['id'] = _0x16ff81(0x1aa) + _0x333eb3, _0x1cc0ab[_0x16ff81(0x796)](_0x1ea941); } else _0x3258cc = document[_0x16ff81(0x5ba)](_0x16ff81(0x509)), _0x3258cc['className'] = 'typing-indicator', _0x3258cc[_0x16ff81(0x2d0)] = _0x16ff81(0x3eb), _0x784812[_0x16ff81(0x796)](_0x3258cc); } } _0x4b2186[_0x16ff81(0x7a6)] <= _0x557cc6[_0x16ff81(0x1ee)] && ('wUqeb' !== _0x16ff81(0x2f1) ? setTimeout(() => { const _0x32249b = _0x16ff81; _0x784812[_0x32249b(0x4f0)] = _0x784812[_0x32249b(0x4c1)]; }, 0x0) : _0x2cdf8a(_0x16ff81(0x827), _0x16ff81(0x549))); } function _0x53c19f(_0x4e3e6f, _0x4ff89c) { const _0x150aee = _0x27dd8f, { role: _0x3449d1, content: _0x2e7caa, displayUrl: _0x262223, image: _0x4e5998, senderId: _0x584816 } = _0x4e3e6f, _0x550efd = _0x3449d1 === 'assistant' ? 'ai' : _0x3449d1, _0x2cf45c = _0x5db7d2(), _0x35bc1f = document['createElement'](_0x150aee(0x509)); _0x35bc1f[_0x150aee(0x35f)][_0x150aee(0x632)](_0x150aee(0x5ec), _0x550efd), _0x35bc1f['dataset'][_0x150aee(0x52d)] = _0x4ff89c; const _0x2eb837 = document[_0x150aee(0x5ba)](_0x150aee(0x509)); _0x2eb837[_0x150aee(0x640)] = _0x150aee(0x233); const _0x3a60e4 = document[_0x150aee(0x5ba)](_0x150aee(0x7f4)); _0x3a60e4[_0x150aee(0x35f)][_0x150aee(0x632)](_0x150aee(0x51e), _0x3449d1 + _0x150aee(0x651)); let _0x1c95cc = ''; if (_0x3449d1 === _0x150aee(0x472)) { if (_0x150aee(0x3ac) !== _0x150aee(0x3ac)) _0x41fafb['value'] = _0x257d23[_0x150aee(0x204)][_0x150aee(0x293)] || '', _0x287418[_0x150aee(0x483)] = _0x4bb01c[_0x150aee(0x204)][_0x150aee(0x51e)] || _0x4277f3, _0x11b30b[_0x150aee(0x73f)] = _0x5004d[_0x150aee(0x204)][_0x150aee(0x6f2)] || ''; else { const _0x10909e = _0x40920c(_0x557cc6[_0x150aee(0x589)]); _0x1c95cc = _0x10909e[_0x150aee(0x51e)] || _0x3b11bb; } } else { _0x1c95cc = _0x1732e7; let _0x37f799 = null; if (_0x2cf45c?.['type'] === _0x150aee(0x405)) _0x37f799 = _0x3132c6(_0x2cf45c[_0x150aee(0x765)][0x0]); else _0x2cf45c?.[_0x150aee(0x516)] === 'group' && _0x584816 && (_0x150aee(0xba) !== _0x150aee(0xba) ? (_0x395c61[_0x150aee(0x50e)]('Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20' + _0x927442['id'], _0x1082a3), _0x435c5e('清空聊天记录失败。')) : _0x37f799 = _0x3132c6(_0x584816)); _0x37f799?.[_0x150aee(0x51e)] && ('TgGhg' !== 'TgGhg' ? _0x535d03[_0x150aee(0x572)](_0x150aee(0x66b), () => { const _0x1e3e9c = _0x150aee; _0x3944c3(_0x1e3e9c(0x6ae)); }) : _0x1c95cc = _0x37f799['avatar']); } _0x3a60e4[_0x150aee(0x483)] = _0x1c95cc, _0x3a60e4[_0x150aee(0x406)] = _0x3449d1 + '\x20avatar'; const _0x3addff = _0x2e7caa && _0x2e7caa['trim']()[_0x150aee(0x795)]('<div') && _0x2e7caa[_0x150aee(0xf2)]()[_0x150aee(0x6ad)](_0x150aee(0x7b7)); if (_0x3addff) { if (_0x150aee(0x3bb) !== _0x150aee(0x26f)) { const _0x4774d7 = document['createElement']('div'); _0x4774d7[_0x150aee(0x640)] = _0x150aee(0x5c7), _0x4774d7['innerHTML'] = _0x2e7caa; if (_0x550efd === _0x150aee(0x472)) 'pDTGX' === _0x150aee(0x337) ? (_0x2eb837['appendChild'](_0x4774d7), _0x2eb837['appendChild'](_0x3a60e4)) : _0x34fff0[_0x150aee(0x50e)](_0x150aee(0x3dd), _0x3fc202); else { if (_0x150aee(0x4ac) === _0x150aee(0x4ac)) _0x2eb837['appendChild'](_0x3a60e4), _0x2eb837[_0x150aee(0x796)](_0x4774d7); else { const _0x5b522a = _0x15b9fa[_0x150aee(0x70d)](_0xc825fd, 'readonly'), _0x2bcf9b = _0x5b522a[_0x150aee(0x365)](_0x9109d5), _0x564e27 = _0x2bcf9b[_0x150aee(0x3ff)](_0x4b5ff7); _0x564e27[_0x150aee(0x7c8)] = () => _0x26d814(_0x564e27['result'] ? _0x564e27[_0x150aee(0x242)]['blob'] : null), _0x564e27['onerror'] = () => _0x45d344(_0x564e27[_0x150aee(0x50e)]); } } } else { const { omniText: _0x29f608 } = _0x17e722(_0x538653['id'], _0x554b9e['id']), _0x46d802 = _0x17fa95(_0xe0b3d0['id']), _0x4ac1ba = _0x24a8ab[_0x150aee(0x674)] && _0x5df1c5['linkedWorldBookIds'][_0x150aee(0x7a6)] > 0x0 ? _0x150aee(0x261) + _0xe5f461[_0x150aee(0x293)] + _0x150aee(0x7b6) + _0x2e33ba['linkedWorldBookIds'][_0x150aee(0x30e)](_0x258db9 => _0x33270f['worldBooks'][_0x150aee(0x4d1)](_0x1cc31e => _0x1cc31e['id'] === _0x258db9))[_0x150aee(0x1d8)](_0x2f3ffd)[_0x150aee(0x30e)](_0x291231 => '\x0a##\x20条目:\x20' + _0x291231[_0x150aee(0x293)] + '\x0a' + _0x291231[_0x150aee(0x398)])['join']('') : ''; return { 'id': _0x3ca3b2['id'], 'name': _0x58a43d[_0x150aee(0x293)], 'persona': _0xc7e332[_0x150aee(0x6f2)] || _0x150aee(0x6de), 'memory': _0x29f608 + _0x46d802 + _0x4ac1ba }; } } else { if (_0x150aee(0x605) === 'McMDa') _0x2a1e88(_0x150aee(0x230)); else { const _0x5bd1c4 = document[_0x150aee(0x5ba)](_0x150aee(0x509)); _0x5bd1c4[_0x150aee(0x35f)][_0x150aee(0x632)](_0x150aee(0x832), _0x550efd); if (_0x2cf45c?.[_0x150aee(0x516)] === _0x150aee(0x405)) { const _0x2ddf86 = _0x2cf45c[_0x150aee(0x765)][0x0]; _0x5bd1c4['classList']['add']('bubble-' + _0x2ddf86); } if (_0x4e3e6f[_0x150aee(0x6c7)]) { const _0x1849f2 = document[_0x150aee(0x5ba)](_0x150aee(0x509)); _0x1849f2[_0x150aee(0x640)] = _0x150aee(0x63a); const _0xf1ec57 = document['createElement']('div'); _0xf1ec57[_0x150aee(0x640)] = _0x150aee(0x574), _0xf1ec57[_0x150aee(0x2d0)] = _0x4e3e6f[_0x150aee(0x6c7)][_0x150aee(0x831)]; const _0x249a51 = document[_0x150aee(0x5ba)]('div'); _0x249a51[_0x150aee(0x640)] = _0x150aee(0x515), _0x249a51[_0x150aee(0x2d0)] = _0x4e3e6f[_0x150aee(0x6c7)][_0x150aee(0x398)], _0x1849f2[_0x150aee(0x796)](_0xf1ec57), _0x1849f2[_0x150aee(0x796)](_0x249a51), _0x5bd1c4[_0x150aee(0x796)](_0x1849f2); } if (_0x262223) { if (_0x150aee(0x4d0) !== _0x150aee(0x4d0)) { const _0x44834d = _0x54d812[_0x150aee(0x78e)][_0x150aee(0x4d1)](_0x30c975 => _0x30c975['id'] === _0x2d4f47['activeFriendCircleId']), _0x501443 = _0x599e0b(); let _0x3ffd78 = []; if (_0x44834d && _0x44834d[_0x150aee(0x18a)]) { const _0x407934 = _0x44834d['posts'][_0x150aee(0x1d8)](_0x5741d9 => _0x5741d9[_0x150aee(0x516)] === _0x150aee(0x164) && _0x5741d9[_0x150aee(0x69f)])[_0x150aee(0x30e)](_0x60f6c4 => ({ ..._0x60f6c4, 'source': _0x150aee(0x7ba) })); _0x3ffd78[_0x150aee(0x6b4)](..._0x407934); } if (_0x501443 && _0x3ed1aa[_0x150aee(0x5b8)]) { const _0x1861ea = _0x41431a[_0x150aee(0x5b8)][_0x150aee(0x1d8)](_0x23bf25 => _0x23bf25['type'] === _0x150aee(0x164) && _0x23bf25[_0x150aee(0x69f)])[_0x150aee(0x30e)](_0x582221 => ({ ..._0x582221, 'source': _0x150aee(0x827) })); _0x3ffd78[_0x150aee(0x6b4)](..._0x1861ea); } const _0x27c80c = _0x1692d9[_0x150aee(0x652)](new _0x4a91df(_0x3ffd78[_0x150aee(0x30e)](_0x23f1a8 => [_0x23f1a8[_0x150aee(0x69f)], _0x23f1a8]))['values']()); _0x50c209[_0x150aee(0x5d2)] = _0x27c80c[_0x150aee(0x5d1)]((_0x113df4, _0x44787b) => _0x44787b[_0x150aee(0x798)] - _0x113df4['timestamp']); } else { _0x5bd1c4[_0x150aee(0x35f)][_0x150aee(0x632)](_0x150aee(0x475)); const _0x437666 = document[_0x150aee(0x5ba)](_0x150aee(0x7f4)); _0x437666[_0x150aee(0x483)] = _0x262223, _0x437666['classList'][_0x150aee(0x632)](_0x150aee(0x76d)), _0x5bd1c4[_0x150aee(0x796)](_0x437666); } } else { if (_0x4e3e6f['image'] || _0x4e3e6f[_0x150aee(0x8c)]) { if (_0x150aee(0x505) === _0x150aee(0x1df)) { const _0xb3c65d = _0x587fee(); _0xb3c65d && _0xb3c65d[_0x150aee(0x71d)] && _0xb3c65d[_0x150aee(0x71d)][_0x150aee(0x5bc)] && (_0x41e0fe['style']['display'] = _0x150aee(0x177), _0x2c2937(() => _0x4e492c[_0x150aee(0x35f)][_0x150aee(0x632)](_0x150aee(0x1c6)), 0xa)); } else { _0x5bd1c4[_0x150aee(0x35f)][_0x150aee(0x632)](_0x150aee(0x690)); const _0x50328b = document[_0x150aee(0x5ba)](_0x150aee(0x7f4)); _0x50328b[_0x150aee(0x35f)][_0x150aee(0x632)](_0x150aee(0x80c)), _0x5bd1c4[_0x150aee(0x796)](_0x50328b); _0x4e3e6f[_0x150aee(0x690)] ? _0x50328b[_0x150aee(0x483)] = _0x4e3e6f[_0x150aee(0x690)] : (_0x50328b[_0x150aee(0x483)] = _0x150aee(0x5be), _0x2aeef5(_0x4e3e6f[_0x150aee(0x8c)])[_0x150aee(0x192)](_0x30a948 => { const _0x58d5f7 = _0x150aee; if (_0x30a948) { if ('edign' === _0x58d5f7(0x2cb)) { const _0x24d750 = URL['createObjectURL'](_0x30a948); _0x50328b['src'] = _0x24d750, _0x50328b[_0x58d5f7(0x38d)] = () => { const _0x583c55 = _0x58d5f7; if (_0x583c55(0xe6) !== _0x583c55(0x4dc)) URL['revokeObjectURL'](_0x24d750); else return _0x583c55(0x7c2) + _0x511433; }; } else _0x5a278e[_0x58d5f7(0x6ca)][_0x58d5f7(0x836)] = _0x58d5f7(0x4e3); } else _0x50328b[_0x58d5f7(0x406)] = '图片加载失败'; })[_0x150aee(0xc2)](_0x97da6 => { const _0x1be918 = _0x150aee; console[_0x1be918(0x50e)](_0x1be918(0x62f), _0x97da6), _0x50328b[_0x1be918(0x406)] = _0x1be918(0x734); })); if (_0x2e7caa) { if (_0x150aee(0x57b) === 'XFvNa') { _0x5d3b4e[_0x150aee(0x7a2)] = _0x150aee(0x619); return; } else { const _0x121799 = document[_0x150aee(0x5ba)]('p'); _0x121799[_0x150aee(0x6ca)]['marginTop'] = _0x150aee(0x459), _0x121799['textContent'] = _0x2e7caa, _0x5bd1c4[_0x150aee(0x796)](_0x121799); } } } } else { if (_0x4e3e6f['type'] === 'transfer') { _0x5bd1c4['classList'][_0x150aee(0x632)]('transfer'); const _0x5829ca = _0x4e3e6f['role'] === _0x150aee(0x472) ? _0x40920c(_0x557cc6[_0x150aee(0x589)]) : _0x3132c6(_0x4e3e6f[_0x150aee(0x6fa)]), _0x25dcb8 = _0x4e3e6f[_0x150aee(0x6c2)] === _0x40920c(_0x557cc6[_0x150aee(0x589)])['id'] ? _0x40920c(_0x557cc6[_0x150aee(0x589)]) : _0x3132c6(_0x4e3e6f[_0x150aee(0x6c2)]), _0x36b4db = _0x5829ca?.[_0x150aee(0x293)] ? _0x5829ca[_0x150aee(0x293)] + '的转账' : '转账', _0x431b88 = _0x25dcb8?.[_0x150aee(0x293)] ? _0x150aee(0x84b) + _0x25dcb8[_0x150aee(0x293)] : '转账', _0x55bacf = _0x150aee(0x60d) + _0x36b4db + _0x150aee(0x494) + _0x4e3e6f[_0x150aee(0x5e3)]['toFixed'](0x2) + _0x150aee(0x52a) + _0x431b88 + _0x150aee(0xc6); _0x5bd1c4[_0x150aee(0x7a2)] = _0x55bacf; } else { if (_0x4e3e6f[_0x150aee(0x516)] === _0x150aee(0x2db)) { _0x5bd1c4[_0x150aee(0x35f)][_0x150aee(0x632)](_0x150aee(0x164)); const _0x478241 = document['createElement'](_0x150aee(0x509)); _0x478241[_0x150aee(0x640)] = 'listen-together-card', _0x478241[_0x150aee(0x35f)][_0x150aee(0x632)]('no-action-modal'); const _0x2a9563 = _0x4e3e6f['role'] === 'user' ? _0x40920c(_0x557cc6[_0x150aee(0x589)])['name'] || '你' : _0x3132c6(_0x4e3e6f['senderId'])?.['name'] || 'TA', _0x13e6e1 = _0x150aee(0x620) + _0x4e3e6f[_0x150aee(0x798)], _0x1bb10a = _0x150aee(0x6e2) + _0x13e6e1 + _0x150aee(0x62c) + _0x1732e7 + '\x22>'; if (_0x4e3e6f['coverId']) { if (_0x150aee(0x11c) !== _0x150aee(0x11c)) { const _0x4f18f7 = _0x13acf4[_0x150aee(0x44b)][_0x150aee(0x242)]; !_0x4f18f7[_0x150aee(0x162)][_0x150aee(0x793)](_0x3345d7) && _0x4f18f7['createObjectStore'](_0x3970de, { 'keyPath': 'id' }), !_0x4f18f7[_0x150aee(0x162)][_0x150aee(0x793)](_0x150aee(0x2f8)) && _0x4f18f7['createObjectStore'](_0x150aee(0x2f8), { 'keyPath': 'id' }); } else _0x2aeef5(_0x4e3e6f[_0x150aee(0x3c2)])[_0x150aee(0x192)](_0x55173d => { const _0x75b38e = _0x150aee, _0x35be48 = document['getElementById'](_0x13e6e1); if (_0x35be48 && _0x55173d) _0x35be48['src'] = URL[_0x75b38e(0x371)](_0x55173d); }); } _0x4e3e6f[_0x150aee(0x5f6)] ? _0x150aee(0x2a2) === _0x150aee(0x659) ? _0x34fb72 ? _0x467ab9(_0x5abeab) : _0x1e7c3f(new _0x134699(_0x150aee(0x36e))) : _0x478241[_0x150aee(0x7a2)] = _0x150aee(0x657) + _0x1bb10a + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x4e3e6f[_0x150aee(0x6c8)] + _0x150aee(0x624) + _0x4e3e6f[_0x150aee(0x1e4)] + _0x150aee(0x254) : _0x478241[_0x150aee(0x7a2)] = _0x150aee(0x6a5) + _0x2a9563 + _0x150aee(0x418) + _0x1bb10a + _0x150aee(0x8e) + _0x4e3e6f[_0x150aee(0x6c8)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>' + _0x4e3e6f[_0x150aee(0x1e4)] + _0x150aee(0x2af) + _0x4e3e6f[_0x150aee(0x848)] + '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', _0x5bd1c4[_0x150aee(0x796)](_0x478241); } else { if (_0x4e3e6f[_0x150aee(0x516)] === _0x150aee(0x164) && _0x4e3e6f[_0x150aee(0x6c8)]) { _0x5bd1c4['classList'][_0x150aee(0x632)]('music'); const _0x41f4fd = document['createElement'](_0x150aee(0x509)); _0x41f4fd[_0x150aee(0x640)] = _0x150aee(0x24a), _0x41f4fd[_0x150aee(0x78)][_0x150aee(0x33a)] = _0x150aee(0x399) + _0x4e3e6f[_0x150aee(0x798)]; const _0x332a4b = 'cover_placeholder_' + _0x4e3e6f[_0x150aee(0x798)], _0x4f9b34 = _0x150aee(0x3ef) + _0x1732e7 + _0x150aee(0x66a) + _0x332a4b + _0x150aee(0x485); if (_0x4e3e6f['coverId']) _0x2aeef5(_0x4e3e6f[_0x150aee(0x3c2)])[_0x150aee(0x192)](_0x3a12da => { const _0x16e16 = _0x150aee, _0x587700 = document[_0x16e16(0x5b7)](_0x332a4b); if (_0x587700 && _0x3a12da) _0x587700['src'] = URL[_0x16e16(0x371)](_0x3a12da); }); else { if (_0x4e3e6f[_0x150aee(0x702)]) { if ('oCCne' !== _0x150aee(0x364)) setTimeout(() => { const _0x42779b = _0x150aee, _0x37dc2b = document[_0x42779b(0x5b7)](_0x332a4b); if (_0x37dc2b) _0x37dc2b[_0x42779b(0x483)] = _0x4e3e6f[_0x42779b(0x702)]; }, 0x0); else return new _0x1fb62e(_0x34bba6 => { const _0x23e74b = _0x150aee, _0x4290f5 = _0xc74da5['getElementById'](_0x23e74b(0x163)), _0x4927d3 = _0x32d9b1['getElementById']('modal-text'), _0x288e0b = _0x50bada[_0x23e74b(0x5b7)]('modal-ok'), _0x308181 = _0x2baf88[_0x23e74b(0x5b7)]('modal-cancel'), _0x564805 = _0x7107ab[_0x23e74b(0x5b7)]('modal-mask'); _0x4927d3[_0x23e74b(0x2d0)] = _0x5c3e99, _0x4290f5[_0x23e74b(0x6ca)][_0x23e74b(0x836)] = _0x23e74b(0x177); const _0x4ac2cc = _0x2fc6be => { const _0xc131e9 = _0x23e74b; _0x4290f5[_0xc131e9(0x6ca)][_0xc131e9(0x836)] = _0xc131e9(0x4e3), _0x288e0b[_0xc131e9(0x7bc)] = _0x308181[_0xc131e9(0x7bc)] = _0x564805[_0xc131e9(0x7bc)] = null, _0x4b71f8[_0xc131e9(0x11e)](_0xc131e9(0x312), _0x306dfc), _0x34bba6(_0x2fc6be); }, _0x306dfc = _0x54d4db => { const _0x456363 = _0x23e74b; if (_0x54d4db[_0x456363(0x499)] === _0x456363(0x1be)) _0x4ac2cc(![]); if (_0x54d4db[_0x456363(0x499)] === 'Enter') _0x4ac2cc(!![]); }; _0x288e0b[_0x23e74b(0x7bc)] = () => _0x4ac2cc(!![]), _0x308181[_0x23e74b(0x7bc)] = () => _0x4ac2cc(![]), _0x564805[_0x23e74b(0x7bc)] = () => _0x4ac2cc(![]), _0x16b873['addEventListener'](_0x23e74b(0x312), _0x306dfc); }); } } _0x41f4fd[_0x150aee(0x7a2)] = _0x150aee(0x313) + _0x4f9b34 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x4e3e6f['songName'] + _0x150aee(0x104) + _0x4e3e6f[_0x150aee(0x1e4)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-share-play-icon\x22>' + (_0x4e3e6f['playableUrl'] ? '▶' : '⚠') + _0x150aee(0x7b7), _0x4e3e6f[_0x150aee(0x69f)] && _0x41f4fd[_0x150aee(0x572)](_0x150aee(0x66b), function () { const _0x222711 = _0x150aee; if (_0x222711(0x20f) === _0x222711(0x194)) _0x4d59da = _0x55cce4[_0x222711(0x293)]; else { const _0x4be2fd = { 'id': _0x222711(0x399) + _0x4e3e6f[_0x222711(0x798)], 'url': _0x4e3e6f[_0x222711(0x69f)] }; _0x52625b(this, _0x4be2fd); } }), _0x5bd1c4[_0x150aee(0x796)](_0x41f4fd); } else { if (_0x2e7caa) { const _0x46ae86 = document[_0x150aee(0x5ba)]('p'); _0x46ae86[_0x150aee(0x7a2)] = _0x2e7caa, _0x46ae86[_0x150aee(0x6ca)]['margin'] = '0', _0x5bd1c4['appendChild'](_0x46ae86); } } } } } } if (_0x3449d1 === 'user') { if (_0x150aee(0x4fd) !== _0x150aee(0x4fd)) { const _0x24e851 = [], _0x30e8a4 = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x1358d1; while ((_0x1358d1 = _0x30e8a4[_0x150aee(0x554)](_0xa64155)) !== null) { const _0x3da42e = _0x1358d1[0x1][_0x150aee(0x4f8)](/\\"/g, '\x22')['replace'](/\\n/g, '\x0a')[_0x150aee(0xf2)](); if (_0x3da42e) _0x24e851[_0x150aee(0x6b4)](_0x3da42e); } if (_0x24e851[_0x150aee(0x7a6)]) return _0x24e851[_0x150aee(0x7ea)](_0x1fa83d)[_0x150aee(0x186)](0x0, 0x9); } else _0x2eb837[_0x150aee(0x796)](_0x5bd1c4), _0x2eb837[_0x150aee(0x796)](_0x3a60e4); } else _0x2eb837['appendChild'](_0x3a60e4), _0x2eb837[_0x150aee(0x796)](_0x5bd1c4); } } _0x35bc1f[_0x150aee(0x796)](_0x2eb837); const _0x166b40 = document[_0x150aee(0x5ba)](_0x150aee(0x509)); return _0x166b40[_0x150aee(0x640)] = _0x150aee(0x798), _0x166b40[_0x150aee(0x2d0)] = _0x203665(_0x4e3e6f['timestamp']), _0x35bc1f[_0x150aee(0x796)](_0x166b40), _0x784812[_0x150aee(0x796)](_0x35bc1f), _0x35bc1f; } document[_0x27dd8f(0x5b7)](_0x27dd8f(0x715))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x5507f0); let _0x57dee7 = null, _0x258b12 = null; function _0x5507f0(_0x25d163) { const _0x586399 = _0x27dd8f; if (window[_0x586399(0x423)]()[_0x586399(0x9b)]()) { if ('EklCK' === _0x586399(0x2a4)) return; else return _0x57ae01(_0x586399(0x1dc)), ![]; } const _0x452a9b = _0x25d163['target'][_0x586399(0x665)](_0x586399(0x63d)), _0x30c374 = _0x25d163[_0x586399(0x44b)][_0x586399(0x665)]('.no-action-modal'); if (!_0x452a9b || _0x30c374) return; const _0x51d529 = parseInt(_0x452a9b[_0x586399(0x78)][_0x586399(0x52d)], 0xa); if (isNaN(_0x51d529)) return; _0xaf7b77(_0x51d529); } function _0x198f0b() { const _0x2eadaa = _0x27dd8f, _0x25bc0c = _0x5db7d2(); if (!_0x25bc0c) { if ('RPsXT' === _0x2eadaa(0x309)) _0x1b12ab[_0x2eadaa(0x674)] = _0x1a11a9[_0x2eadaa(0x674)][_0x2eadaa(0x1d8)](_0x181051 => _0x181051 !== _0x485526); else { _0x3a0075[_0x2eadaa(0x2d0)] = '选择聊天'; return; } } if (_0x25bc0c['type'] === 'private') { if (_0x2eadaa(0xac) === _0x2eadaa(0xac)) { const _0x3aead7 = _0x3132c6(_0x25bc0c[_0x2eadaa(0x765)][0x0]); _0x3a0075[_0x2eadaa(0x2d0)] = _0x3aead7 ? _0x3aead7[_0x2eadaa(0x293)] : _0x2eadaa(0x5c5); } else { _0x3f8d3a[_0x2eadaa(0x46d)] = _0x120313['chats']['filter'](_0x53c28b => _0x53c28b['id'] !== _0x1e1af7); try { _0x597b85[_0x2eadaa(0x17f)](_0x2eadaa(0x1cb) + _0x3ba45f); } catch (_0x8f1fd4) { _0x34bad[_0x2eadaa(0x50e)]('Failed\x20to\x20remove\x20history\x20for\x20chat\x20' + _0x21ca34, _0x8f1fd4); } _0x1a8098[_0x2eadaa(0x589)] === _0x2b16f4 && (_0x4c0d0c[_0x2eadaa(0x589)] = _0x111c0f['chats'][0x0]?.['id'] || null, _0x35d89a(_0x3e333b[_0x2eadaa(0x589)])), _0x32602d(), _0x4b5176(); } } else _0x3a0075[_0x2eadaa(0x2d0)] = _0x25bc0c[_0x2eadaa(0x293)] || _0x2eadaa(0x4bc) + _0x25bc0c[_0x2eadaa(0x765)][_0x2eadaa(0x7a6)] + ')'; } function _0xb22fcb(_0x41c666) { const _0xef570 = _0x27dd8f, _0x2ba5dd = document[_0xef570(0x5ab)](_0xef570(0x486)); if (_0x2ba5dd && (_0x2ba5dd['id'] === _0xef570(0x704) || _0x2ba5dd['id'] === _0xef570(0x26e))) _0x2dea46(); else { if (_0xef570(0x66c) === _0xef570(0x7d3)) { _0x3e1a87['error'](_0xef570(0x849), _0x4d6727); const _0xf755bf = { 'role': _0xef570(0x77b), 'content': _0xef570(0x397) + _0x3adffb[_0xef570(0x832)], 'senderId': _0x434018['id'], 'isOffline': _0x3d0dea }; _0x1b0dc0[_0xef570(0x5b8)]['push'](_0xf755bf), _0x2e061c(); } else { const _0x5c9121 = document['querySelectorAll'](_0xef570(0x781)); _0x5c9121[_0xef570(0x302)](_0x31f59a => _0x31f59a[_0xef570(0x7ff)]()); } } } function _0x57f4b3() { const _0x215ef7 = _0x27dd8f; if (_0x557cc6['isGenerating'] && _0x557cc6['currentAbortController']) { if (_0x215ef7(0x10e) === _0x215ef7(0x808)) { _0x52cbac(_0x215ef7(0x403), _0x215ef7(0x2ce)); if (_0x6b279a) { const _0x40345f = _0x17529c['worldBooks']['find'](_0x2e1d6e => _0x2e1d6e['id'] === _0x372f5e); if (!_0x40345f) return; _0x412e8f[_0x215ef7(0x5b7)]('editing-world-book-id')[_0x215ef7(0x73f)] = _0x40345f['id'], _0x2b3694[_0x215ef7(0x5b7)]('world-book-editor-title')[_0x215ef7(0x2d0)] = _0x215ef7(0x2e7), _0x1a6431[_0x215ef7(0x5b7)]('world-book-edit-name')['value'] = _0x40345f[_0x215ef7(0x293)], _0x5b60cb['getElementById'](_0x215ef7(0xab))[_0x215ef7(0x73f)] = _0x40345f[_0x215ef7(0x398)]; } else _0x1b3b3a[_0x215ef7(0x5b7)]('editing-world-book-id')['value'] = '', _0x1fead2[_0x215ef7(0x5b7)](_0x215ef7(0x706))[_0x215ef7(0x2d0)] = '新建条目', _0x5bdf7f[_0x215ef7(0x5b7)]('world-book-edit-name')[_0x215ef7(0x73f)] = '', _0x437a67[_0x215ef7(0x5b7)](_0x215ef7(0xab))[_0x215ef7(0x73f)] = ''; } else console['log']('用户操作中断了\x20AI\x20响应。'), _0x557cc6[_0x215ef7(0xb8)][_0x215ef7(0x2b0)]('User\x20cancelled'), _0x557cc6[_0x215ef7(0xb8)] = null; } _0x557cc6[_0x215ef7(0x161)] = ![], _0xb22fcb(![]); } function _0x5db7d2() { const _0x4c637c = _0x27dd8f; if (_0x4c637c(0x3c6) !== _0x4c637c(0x3c6)) _0x12a8b5['activeChatId'] = _0x5dac94[_0x4c637c(0x46d)][0x0]?.['id'] || null, _0x4b5dc0(_0x17f78a[_0x4c637c(0x589)]); else return _0x557cc6[_0x4c637c(0x46d)][_0x4c637c(0x4d1)](_0x228eec => _0x228eec['id'] === _0x557cc6['activeChatId']); } function _0x3132c6(_0xbb617f) { const _0x329f2a = _0x27dd8f; return _0x557cc6['characters'][_0x329f2a(0x4d1)](_0x146be3 => _0x146be3['id'] === _0xbb617f); } function _0x219f16(_0x2a1962) { const _0x254a48 = _0x27dd8f; _0x557cc6['characters'] = _0x557cc6[_0x254a48(0x618)][_0x254a48(0x1d8)](_0xe2bfa3 => _0xe2bfa3['id'] !== _0x2a1962), _0x557cc6[_0x254a48(0x46d)][_0x254a48(0x302)](_0x274fb7 => { const _0x465f07 = _0x254a48; _0x274fb7[_0x465f07(0x516)] === _0x465f07(0x3fd) && (_0x274fb7['participantIds'] = _0x274fb7[_0x465f07(0x765)][_0x465f07(0x1d8)](_0x219920 => _0x219920 !== _0x2a1962)); }); const _0x395deb = _0x557cc6[_0x254a48(0x46d)][_0x254a48(0x4d1)](_0x163156 => _0x163156[_0x254a48(0x516)] === 'private' && _0x163156[_0x254a48(0x765)][_0x254a48(0x158)](_0x2a1962)); _0x395deb && _0x28fe9a(_0x395deb['id']), _0x557cc6[_0x254a48(0x46d)] = _0x557cc6['chats'][_0x254a48(0x1d8)](_0x4a6875 => _0x4a6875['type'] !== _0x254a48(0x3fd) || _0x4a6875['participantIds'][_0x254a48(0x7a6)] > 0x1), _0x162000(), _0x18d2c5(); } function _0x28fe9a(_0x244f1c) { const _0x277a62 = _0x27dd8f; _0x557cc6['chats'] = _0x557cc6[_0x277a62(0x46d)][_0x277a62(0x1d8)](_0x5a22dd => _0x5a22dd['id'] !== _0x244f1c); try { localStorage[_0x277a62(0x17f)](_0x277a62(0x1cb) + _0x244f1c); } catch (_0x3d1908) { if ('VAxLQ' === _0x277a62(0x374)) console[_0x277a62(0x50e)](_0x277a62(0x33c) + _0x244f1c, _0x3d1908); else { _0x326372[_0x277a62(0x73f)] = ''; return; } } _0x557cc6[_0x277a62(0x589)] === _0x244f1c && (_0x557cc6[_0x277a62(0x589)] = _0x557cc6[_0x277a62(0x46d)][0x0]?.['id'] || null, _0xe92c95(_0x557cc6[_0x277a62(0x589)])), _0x162000(), _0x18d2c5(); } async function _0xe92c95(_0x1530e2) { const _0x25c996 = _0x27dd8f; if (_0x557cc6['activeChatId'] !== _0x1530e2) { if ('vVpKh' !== _0x25c996(0x250)) return ''; else _0x57f4b3(), _0x557cc6[_0x25c996(0x1ee)] = 0x64; } if (!_0x1530e2) { _0x557cc6[_0x25c996(0x589)] = null, _0x162000(), _0x1f1930(![]), document[_0x25c996(0x5b7)](_0x25c996(0x282))[_0x25c996(0x6ca)][_0x25c996(0xcf)] = ''; return; } _0x557cc6[_0x25c996(0x589)] = _0x1530e2, _0x162000(), _0x198f0b(), _0x784812['innerHTML'] = '', _0x2158b6(!![], _0x25c996(0x770)), setTimeout(async () => { const _0x320eb6 = _0x25c996; if ('AMTPT' === 'NWxlj') _0x1b41dd(), _0x42901b(_0x320eb6(0xf1), 'music'); else try { _0x2fa9f4(); const _0x225b7e = _0x5db7d2(), _0x310317 = document[_0x320eb6(0x5b7)](_0x320eb6(0x282)); let _0x4f4515 = null; if (_0x225b7e) { if ('dJdiU' === _0x320eb6(0x609)) { if (_0x225b7e['type'] === _0x320eb6(0x405)) { const _0xdeb246 = _0x225b7e[_0x320eb6(0x765)][0x0]; _0x1bdfb1(_0xdeb246), _0x4f4515 = await _0x2aeef5(_0x320eb6(0x281) + _0xdeb246); } else { if (_0x320eb6(0x10a) !== _0x320eb6(0x4b5)) _0x4f4515 = await _0x2aeef5(_0x320eb6(0x82a) + _0x225b7e['id']); else { if (_0x147071['name'] !== _0x320eb6(0x1af)) { _0x5c548d[_0x320eb6(0x50e)](_0x320eb6(0x849), _0x5e4b2b); const _0x3abaf7 = { 'role': _0x320eb6(0x77b), 'content': _0x320eb6(0x397) + _0x22b040['message'], 'senderId': _0x1d933a['id'], 'isOffline': _0x203079 }; _0x1b1cbb['conversationHistory']['push'](_0x3abaf7), _0x4c6657(); } return ![]; } } if (_0x4f4515) { if (_0x320eb6(0x79b) === 'fvwmY') { _0x1722e1['id'] === _0x955458[_0x320eb6(0x589)] && (_0x4fccd9(), _0x5a2a3b[_0x320eb6(0x5b8)] = [], _0xcd8b71()); try { _0x56fe07[_0x320eb6(0x17f)](_0x320eb6(0x1cb) + _0x4b5a70['id']), _0x49586e(_0x320eb6(0x157) + _0x5592c2[_0x320eb6(0x293)] + _0x320eb6(0x20a)); } catch (_0x338b01) { _0xc34606[_0x320eb6(0x50e)](_0x320eb6(0x60a) + _0x4b5fc4['id'], _0x338b01), _0xb0b208('清空聊天记录失败。'); } } else _0x310317[_0x320eb6(0x6ca)][_0x320eb6(0xcf)] = _0x320eb6(0x1d1) + URL[_0x320eb6(0x371)](_0x4f4515) + '\x27)', _0x310317[_0x320eb6(0x6ca)][_0x320eb6(0x4a9)] = 'cover', _0x310317['style'][_0x320eb6(0x24d)] = _0x320eb6(0x5ff); } else _0x320eb6(0x4b4) !== _0x320eb6(0x3ae) ? _0x310317[_0x320eb6(0x6ca)]['backgroundImage'] = '' : !_0x3d0ead[_0x320eb6(0x35f)][_0x320eb6(0x793)](_0x320eb6(0x1d3)) && _0x234cdd[_0x320eb6(0x7ff)](); } else _0x5cbf84 += _0x320eb6(0x5a7); } _0x2292d9(); } catch (_0x4fcf4e) { _0x320eb6(0x595) !== 'SslQV' ? (_0xc040a0['error']('加载立绘失败:', _0xb036b), _0x52e299[_0x320eb6(0x483)] = '') : (console[_0x320eb6(0x50e)](_0x320eb6(0x6d3), _0x4fcf4e), _0x599dea('加载聊天失败:\x20' + _0x4fcf4e['message'])); } finally { _0x2158b6(![]); } }, 0x32); } async function _0x468f25() { const _0x3f80ac = _0x27dd8f; if (_0x557cc6['isGenerating']) { _0x599dea(_0x3f80ac(0x3c5)); return; } const _0x459265 = _0x557cc6[_0x3f80ac(0x5b8)]; if (_0x459265[_0x3f80ac(0x7a6)] === 0x0) return; let _0x5109ee = -0x1; for (let _0x31750a = _0x459265[_0x3f80ac(0x7a6)] - 0x1; _0x31750a >= 0x0; _0x31750a--) { if (_0x459265[_0x31750a][_0x3f80ac(0x7b4)] === _0x3f80ac(0x472)) { if ('QePHO' === _0x3f80ac(0x35b)) _0x4f064f['error'](_0x3f80ac(0x358), _0x4cb764), _0x268df0(_0x3f80ac(0x600) + _0x2cbcbb[_0x3f80ac(0x832)]); else { _0x5109ee = _0x31750a; break; } } } if (_0x5109ee === -0x1 || _0x5109ee === _0x459265[_0x3f80ac(0x7a6)] - 0x1) { if ('QWXMh' === _0x3f80ac(0x5de)) { _0x599dea(_0x3f80ac(0xd6)); return; } else { if (!_0x52d3c4 || !_0x5a7953[_0x3f80ac(0x589)]) return; const _0x70733a = { 'role': _0x3f80ac(0x472), 'content': _0x3f80ac(0x691) + _0x3bc2dd[_0x3f80ac(0x293)] + ']', 'displayUrl': _0x54f542[_0x3f80ac(0x606)], 'timestamp': _0x459dca[_0x3f80ac(0x183)]() }; _0xaa7c7d['conversationHistory'][_0x3f80ac(0x6b4)](_0x70733a), _0x13a191(_0x70733a, _0x32733f[_0x3f80ac(0x5b8)][_0x3f80ac(0x7a6)] - 0x1), _0x569f42(), _0x24461b['classList'][_0x3f80ac(0x7ff)](_0x3f80ac(0x1c6)); } } _0x459265[_0x3f80ac(0x168)](_0x5109ee + 0x1), _0x2efa53(), _0x2dea46(), setTimeout(() => { _0x5debb2(); }, 0x64); } function _0x2b66ff(_0x3c2c34 = null) { const _0x384447 = _0x27dd8f; if (_0x384447(0x3d2) === 'DMhcE') { const _0xf5153f = _0x3c2c34 ?? _0x4aebf[_0x384447(0x73f)][_0x384447(0xf2)](); if (_0xf5153f === '' || !_0x557cc6['activeChatId']) return; const _0x294c8a = document[_0x384447(0x5ab)](_0x384447(0x486)), _0x498358 = _0x294c8a['id'] === _0x384447(0x704), _0x34fa2f = { 'role': _0x384447(0x472), 'content': _0xf5153f, 'timestamp': Date['now'](), 'isOffline': _0x498358 }; if (_0x557cc6[_0x384447(0x443)]) { if (_0x384447(0x49f) === _0x384447(0x296)) { const _0x543439 = { 'role': _0x384447(0x77b), 'content': '[AI发送了表情：' + _0x5a47d5[_0x384447(0x293)] + ']', 'displayUrl': _0x59b837[_0x384447(0x606)], 'senderId': _0x37302c['senderId'], 'timestamp': _0x5b5b4e[_0x384447(0x183)](), 'isOffline': _0x110e00 }; _0x221afa[_0x384447(0x5b8)]['push'](_0x543439); } else _0x34fa2f[_0x384447(0x6c7)] = { ..._0x557cc6['activeQuote'] }; } _0x557cc6[_0x384447(0x5b8)]['push'](_0x34fa2f), _0x2efa53(), _0x2dea46(), !_0x3c2c34 && (_0x4aebf[_0x384447(0x73f)] = ''), _0x3e0b48(); } else _0x331b1f > _0x136f0f && (_0x231123 *= _0x2c6f0d / _0xe7d553, _0x2d081b = _0x6a895a); } function _0x2a5534(_0x4228fe) { const _0x31a8ad = _0x27dd8f; if (_0x31a8ad(0x227) === 'GKdzb') { if (!_0x4228fe || !_0x557cc6['activeChatId']) return; const _0x2adf78 = { 'role': _0x31a8ad(0x472), 'content': _0x31a8ad(0x691) + _0x4228fe[_0x31a8ad(0x293)] + ']', 'displayUrl': _0x4228fe[_0x31a8ad(0x606)], 'timestamp': Date[_0x31a8ad(0x183)]() }; _0x557cc6['conversationHistory'][_0x31a8ad(0x6b4)](_0x2adf78), _0x53c19f(_0x2adf78, _0x557cc6[_0x31a8ad(0x5b8)][_0x31a8ad(0x7a6)] - 0x1), _0x2efa53(), _0x331e50['classList'][_0x31a8ad(0x7ff)](_0x31a8ad(0x1c6)); } else _0x8d2b3c[_0x31a8ad(0x50e)](_0x31a8ad(0x216), _0x4e4a61); } async function _0x3ea2e8(_0x38ef6a) { const _0x330bd4 = _0x27dd8f, _0x144798 = _0x38ef6a[_0x330bd4(0x44b)][_0x330bd4(0x209)][0x0]; if (!_0x144798 || !_0x557cc6['activeChatId']) return; _0x2158b6(!![], '正在处理图片...'); try { const _0xcd8cfc = await _0x4657ac(_0x144798, 0x320, 0.8, !![]), _0x3b77a4 = _0x330bd4(0x48d) + Date[_0x330bd4(0x183)](); await _0x3aff46(_0x3b77a4, _0xcd8cfc); const _0x2bfaa5 = _0x4aebf['value'][_0x330bd4(0xf2)](); _0x4aebf['value'] = ''; const _0x54d1df = { 'role': _0x330bd4(0x472), 'content': _0x2bfaa5, 'imageId': _0x3b77a4, 'timestamp': Date['now']() }; _0x557cc6[_0x330bd4(0x5b8)][_0x330bd4(0x6b4)](_0x54d1df), _0x53c19f(_0x54d1df, _0x557cc6[_0x330bd4(0x5b8)][_0x330bd4(0x7a6)] - 0x1), _0x2efa53(); } catch (_0x3c5342) { _0x599dea('图片处理失败:\x20' + _0x3c5342['message']); } finally { if ('UOimG' === 'UOimG') _0x2158b6(![]), _0x38ef6a[_0x330bd4(0x44b)][_0x330bd4(0x73f)] = ''; else { const _0x565833 = _0x1a7f39[_0x330bd4(0x4c6)]((_0x5f5188 - _0x255edb) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x51e1a6 += _0x330bd4(0x668) + _0x565833 + _0x330bd4(0x803); } } } async function _0x1e9193() { const _0x4e3a6d = _0x27dd8f; if (!_0x557cc6[_0x4e3a6d(0x589)]) return; const _0x243602 = await _0x8a01de(); if (!_0x243602) return; _0x599dea(_0x4e3a6d(0x129)); try { const _0x1cf079 = await _0x5b6497(_0x243602[_0x4e3a6d(0x6c8)], _0x243602[_0x4e3a6d(0x1e4)]); let _0x11ba38 = _0x1cf079[_0x4e3a6d(0x791)]; if (_0x1cf079[_0x4e3a6d(0x791)] && _0x1cf079['cover'][_0x4e3a6d(0x795)](_0x4e3a6d(0x837))) try { if (_0x4e3a6d(0x316) !== _0x4e3a6d(0x316)) _0x28e5d1['click'](); else { const _0x2b9784 = await fetch(_0x1cf079['cover']), _0x5e4946 = await _0x2b9784['blob'](); _0x11ba38 = await _0x27ec3a(_0x5e4946); } } catch (_0x3ce4a) { console[_0x4e3a6d(0x50e)](_0x4e3a6d(0x5dc), _0x3ce4a), _0x11ba38 = _0x1732e7; } const _0x1f906e = { 'role': _0x4e3a6d(0x472), 'type': _0x4e3a6d(0x164), 'content': _0x4e3a6d(0x635) + _0x243602[_0x4e3a6d(0x6c8)] + '\x20-\x20' + _0x243602[_0x4e3a6d(0x1e4)] + ']', 'songName': _0x243602[_0x4e3a6d(0x6c8)], 'artist': _0x243602['artist'], 'coverUrl': _0x11ba38, 'playableUrl': _0x1cf079[_0x4e3a6d(0x606)], 'timestamp': Date[_0x4e3a6d(0x183)]() }; _0x557cc6[_0x4e3a6d(0x5b8)][_0x4e3a6d(0x6b4)](_0x1f906e), _0x53c19f(_0x1f906e, _0x557cc6['conversationHistory'][_0x4e3a6d(0x7a6)] - 0x1), _0x2efa53(); } catch (_0x24802a) { console[_0x4e3a6d(0x50e)](_0x4e3a6d(0xd0), _0x24802a), _0x599dea(_0x4e3a6d(0x688) + _0x24802a[_0x4e3a6d(0x832)]); } } function _0x451a81(_0x20ba40, _0x2db5a3 = 0x78) { const _0x53537f = _0x27dd8f, _0x13e6ba = _0x1f7232 => { const _0x252f39 = _0x3d17; if (_0x1f7232[_0x252f39(0x7b4)] === _0x252f39(0x472)) return _0x557cc6[_0x252f39(0x204)]?.[_0x252f39(0x293)] || _0x252f39(0x259); if (_0x1f7232[_0x252f39(0x6fa)]) { if (_0x252f39(0x623) !== _0x252f39(0x7de)) { const _0x19905b = _0x3132c6(_0x1f7232[_0x252f39(0x6fa)]); return _0x19905b?.[_0x252f39(0x293)] || 'Unknown'; } else { const _0x5309d9 = _0x83af1e[_0x252f39(0x687)]('p'); _0x5309d9[_0x252f39(0x302)](_0x5c2bb9 => _0x5c2bb9['classList'][_0x252f39(0x7ff)](_0x252f39(0x3fe))); const _0x528498 = _0x97ce59[_0x252f39(0x5b7)](_0x252f39(0x1aa) + _0x91bea6); _0x528498 && (_0x528498[_0x252f39(0x35f)][_0x252f39(0x632)]('active'), _0x528498[_0x252f39(0x1c2)]({ 'behavior': 'smooth', 'block': _0x252f39(0x5ff) })); } } if (_0x20ba40?.['type'] === 'private') { if (_0x252f39(0x608) === _0x252f39(0x38f)) _0xe31c6(_0x1ef533['id']); else { const _0x184648 = _0x3132c6(_0x20ba40[_0x252f39(0x765)][0x0]); return _0x184648?.['name'] || 'AI'; } } return _0x252f39(0x128); }, _0x556ff3 = _0x557cc6[_0x53537f(0x5b8)]['slice'](-_0x2db5a3), _0x142599 = []; for (const _0x58dcc5 of _0x556ff3) { if (_0x53537f(0x611) !== _0x53537f(0x611)) _0x5dec40 !== _0x279793[_0x53537f(0x5ab)](_0x53537f(0x5e1)) && (_0x4dd3d6['textContent'] = '▶'); else { if (_0x58dcc5['displayUrl']) _0x142599[_0x53537f(0x6b4)]('[' + _0x13e6ba(_0x58dcc5) + _0x53537f(0x20e) + (_0x58dcc5[_0x53537f(0x398)]?.['match'](/：(.+?)]/)?.[0x1] || '表情') + ']'); else { if (_0x58dcc5[_0x53537f(0x690)]) { const _0x4b3c21 = _0x58dcc5['content'] ? '\x20' + _0x58dcc5[_0x53537f(0x398)] : ''; _0x142599['push']('[' + _0x13e6ba(_0x58dcc5) + ']\x20[image]' + _0x4b3c21); } else _0x58dcc5[_0x53537f(0x398)] && _0x142599[_0x53537f(0x6b4)]('[' + _0x13e6ba(_0x58dcc5) + ']\x20' + _0x58dcc5[_0x53537f(0x398)]); } } } return _0x142599['join']('\x0a'); } function _0xb72c9(_0xd85a8b, _0x246732) { const _0x28985c = _0x27dd8f; if (!_0xd85a8b || !_0x246732) return null; const _0x132dac = _0x246732['match'](/@([^\s:：,，。!?]+)/); if (!_0x132dac) return null; const _0x4d8fbf = _0x132dac[0x1][_0x28985c(0x43b)](); for (const _0x393a5e of _0xd85a8b[_0x28985c(0x765)]) { const _0x324280 = _0x3132c6(_0x393a5e); if (!_0x324280?.[_0x28985c(0x293)]) continue; if (_0x324280[_0x28985c(0x293)][_0x28985c(0x43b)]() === _0x4d8fbf) return _0x324280; if (_0x324280[_0x28985c(0x293)][_0x28985c(0x43b)]()[_0x28985c(0x795)](_0x4d8fbf)) return _0x324280; } return null; } function _0x565b5f(_0x5f070c) { const _0x2375e0 = _0x27dd8f; if (_0x2375e0(0x4be) === _0x2375e0(0x4be)) { const _0x59a9da = _0x5f070c[_0x2375e0(0x28f)]('{'), _0x414400 = _0x5f070c[_0x2375e0(0x4d3)]('}'); if (_0x59a9da >= 0x0 && _0x414400 > _0x59a9da) return _0x5f070c[_0x2375e0(0x186)](_0x59a9da, _0x414400 + 0x1); return _0x5f070c; } else _0x5cddc9[_0x2375e0(0x66b)](); } function _0x591002(_0x3ad651, _0x1990ec, _0x265ed7) { const _0x6d0c6 = _0x27dd8f, _0x32f740 = new Map(_0x1990ec[_0x6d0c6(0x30e)](_0x1c6304 => [String(_0x1c6304['id']), _0x1c6304])), _0x3ea12f = _0x306067 => String(_0x306067 || '')['toLowerCase']()['replace'](/\s+/g, ''), _0x5a288c = new Map(_0x1990ec['map'](_0x462623 => [_0x3ea12f(_0x462623['name']), _0x462623])), _0x915188 = new Set(_0x265ed7), _0x45a101 = { 'events': [] }; for (const _0x41b221 of _0x3ad651?.[_0x6d0c6(0x4c7)] || []) { if (_0x6d0c6(0x718) === _0x6d0c6(0x718)) { const _0x1d4be0 = _0x41b221['senderId'] ?? _0x41b221[_0x6d0c6(0x831)] ?? _0x41b221[_0x6d0c6(0x446)] ?? _0x41b221[_0x6d0c6(0x234)] ?? _0x41b221[_0x6d0c6(0x7b4)] ?? _0x41b221[_0x6d0c6(0x293)]; if (!_0x1d4be0) continue; let _0x4a254b = _0x32f740['get'](String(_0x1d4be0)) || _0x5a288c[_0x6d0c6(0x3ff)](_0x3ea12f(_0x1d4be0)); if (!_0x4a254b) continue; const _0x1fe5de = (_0x41b221[_0x6d0c6(0x15c)] || _0x41b221['type'] || 'text')[_0x6d0c6(0x43b)](); if (_0x1fe5de === _0x6d0c6(0x475)) { if (_0x6d0c6(0x700) !== _0x6d0c6(0x700)) _0x3c7106['style'][_0x6d0c6(0x3a2)] = _0x6d0c6(0x5d0), _0x212192[_0x6d0c6(0x6ca)][_0x6d0c6(0x5c9)] = _0x6d0c6(0x65d); else { const _0x36b2be = (_0x41b221[_0x6d0c6(0x475)] ?? _0x41b221[_0x6d0c6(0x3da)] ?? _0x41b221['emote'] ?? _0x41b221[_0x6d0c6(0x539)])?.[_0x6d0c6(0xf2)](); if (_0x36b2be && _0x915188[_0x6d0c6(0x6db)](_0x36b2be)) _0x45a101[_0x6d0c6(0x4c7)][_0x6d0c6(0x6b4)]({ 'senderId': _0x4a254b['id'], 'kind': _0x6d0c6(0x475), 'sticker': _0x36b2be }); else { const _0xeac246 = String(_0x41b221['content'] ?? _0x41b221[_0x6d0c6(0x68e)] ?? '')[_0x6d0c6(0xf2)]() || '[sticker:' + (_0x36b2be || '未知表情') + ']'; if (_0xeac246) _0x45a101[_0x6d0c6(0x4c7)]['push']({ 'senderId': _0x4a254b['id'], 'kind': _0x6d0c6(0x68e), 'content': _0xeac246 }); } } } else { const _0xaa9de1 = String(_0x41b221[_0x6d0c6(0x398)] ?? _0x41b221['text'] ?? _0x41b221['message'] ?? '')[_0x6d0c6(0xf2)](); if (_0xaa9de1) _0x45a101[_0x6d0c6(0x4c7)][_0x6d0c6(0x6b4)]({ 'senderId': _0x4a254b['id'], 'kind': _0x6d0c6(0x68e), 'content': _0xaa9de1 }); } } else { const _0xa85403 = _0x3f43c2[_0x6d0c6(0x78e)][_0x6d0c6(0x4d1)](_0x3c3fbc => _0x3c3fbc['id'] === _0x3687f6); if (!_0xa85403) return; _0x16fca3['textContent'] = '编辑好友圈', _0x20d229['value'] = _0xa85403['id'], _0x9dc18b[_0x6d0c6(0x73f)] = _0xa85403[_0x6d0c6(0x293)], _0x2f632a[_0x6d0c6(0x73f)] = _0xa85403[_0x6d0c6(0x2a6)], _0x3e336c[_0x6d0c6(0x6ca)]['display'] = _0x6d0c6(0x534), _0xa85403['memberCharacterIds']['forEach'](_0x5e8b88 => { const _0x440acf = _0x6d0c6, _0x12579e = _0x1b7cb7[_0x440acf(0x5ab)]('#member-select-' + _0x5e8b88); if (_0x12579e) _0x12579e[_0x440acf(0x1c8)] = !![]; }); } } return _0x45a101; } async function _0x541a3d(_0x380902) { const _0x14a933 = _0x27dd8f; if (!_0x380902 || !Array[_0x14a933(0x65c)](_0x380902[_0x14a933(0x4c7)]) || _0x380902[_0x14a933(0x4c7)][_0x14a933(0x7a6)] === 0x0) return; const _0x1cc271 = _0x4fee15 => _0x4fee15 + Math[_0x14a933(0x660)](Math[_0x14a933(0x19a)]() * 0x190); let _0xf2a63a = 0x1f4; for (const _0x56f19e of _0x380902['events']) { await new Promise(_0x374112 => setTimeout(_0x374112, _0x1cc271(_0xf2a63a))), _0xf2a63a += 0x2bc; const _0x550ca3 = _0x557cc6[_0x14a933(0x5b8)]['at'](-0x1)?.[_0x14a933(0x7fe)] ?? ![]; if (_0x56f19e[_0x14a933(0x15c)] === _0x14a933(0x475)) { const _0x2c3638 = _0x56624c['find'](_0x3f2802 => _0x3f2802[_0x14a933(0x293)] === _0x56f19e['sticker']); if (_0x2c3638) { const _0xe5747e = { 'role': _0x14a933(0x77b), 'content': _0x14a933(0x167) + _0x2c3638['name'] + ']', 'displayUrl': _0x2c3638[_0x14a933(0x606)], 'senderId': _0x56f19e[_0x14a933(0x6fa)], 'timestamp': Date[_0x14a933(0x183)](), 'isOffline': _0x550ca3 }; _0x557cc6[_0x14a933(0x5b8)][_0x14a933(0x6b4)](_0xe5747e); } } else { if (_0x56f19e[_0x14a933(0x15c)] === _0x14a933(0x164) && _0x56f19e[_0x14a933(0x6c8)] && _0x56f19e[_0x14a933(0x1e4)]) { const { songName: _0xd5d11, artist: _0x5ea643 } = _0x56f19e, _0x5c2bf8 = { 'role': _0x14a933(0x77b), 'type': _0x14a933(0x164), 'content': '[AI分享了音乐：' + _0xd5d11 + _0x14a933(0x39c) + _0x5ea643 + ']', 'songName': _0xd5d11, 'artist': _0x5ea643, 'senderId': _0x56f19e[_0x14a933(0x6fa)], 'timestamp': Date[_0x14a933(0x183)](), 'isOffline': _0x550ca3 }; try { if ('cWfGu' === _0x14a933(0x7ca)) { const _0x6adbc9 = await _0x5b6497(_0xd5d11, _0x5ea643); _0x5c2bf8[_0x14a933(0x702)] = _0x6adbc9[_0x14a933(0x791)], _0x5c2bf8['playableUrl'] = _0x6adbc9[_0x14a933(0x606)]; } else { const _0x1d3ed6 = _0x214794['createObjectURL'](_0x22a20d); _0x336ef7[_0x14a933(0x483)] = _0x1d3ed6, _0x1aa90c[_0x14a933(0x38d)] = () => { const _0x18e7c6 = _0x14a933; _0x3bacf1[_0x18e7c6(0x29b)](_0x1d3ed6); }; } } catch (_0x4f4160) { console['error'](_0x14a933(0x2ca) + _0xd5d11 + _0x14a933(0x39c) + _0x5ea643 + '):', _0x4f4160), _0x5c2bf8[_0x14a933(0x702)] = null, _0x5c2bf8[_0x14a933(0x69f)] = null; } _0x557cc6[_0x14a933(0x5b8)][_0x14a933(0x6b4)](_0x5c2bf8); } else { if (_0x56f19e[_0x14a933(0x15c)] === _0x14a933(0x68e)) { if (_0x14a933(0x68f) === _0x14a933(0x68f)) { const _0x62bfbc = _0x4e4ec9(_0x56f19e['content'])[_0x14a933(0x186)](0x0, 0x3); for (let _0x5279fd = 0x0; _0x5279fd < _0x62bfbc[_0x14a933(0x7a6)]; _0x5279fd++) { if (_0x14a933(0x782) !== _0x14a933(0x6ac)) { if (_0x5279fd > 0x0) await new Promise(_0x525ebe => setTimeout(_0x525ebe, _0x1cc271(0x190))); const _0xcafdc0 = { 'role': _0x14a933(0x77b), 'content': _0x62bfbc[_0x5279fd], 'senderId': _0x56f19e[_0x14a933(0x6fa)], 'timestamp': Date[_0x14a933(0x183)](), 'isOffline': _0x550ca3 }; _0x557cc6[_0x14a933(0x5b8)][_0x14a933(0x6b4)](_0xcafdc0); } else _0x2c9dfd === _0x14a933(0x707) ? _0x5dd0a8[_0x14a933(0x6ca)][_0x14a933(0x836)] = _0x14a933(0x27a) : _0x40af2b[_0x14a933(0x6ca)]['display'] = _0x14a933(0x4e3); } } else _0x4314b9(_0x3dadc9, { 'force': !![], 'delayMs': _0xacf3bd }), _0x4edf25 += 0x1f4; } } } } _0x2efa53(), _0x2dea46(); } async function _0x5113cc(_0x3d5ac4, { force: force = ![], delayMs: delayMs = 0x0 } = {}) { const _0x2cc989 = _0x27dd8f; if ('hjEyo' !== _0x2cc989(0x407)) { _0x3bb919[_0x2cc989(0x73f)] = '', _0x1c42d5['innerHTML'] = ''; if (_0x35fcae['characters']['length'] < 0x2) { _0x48ef4a('需要至少2个角色才能创建群聊。'); return; } _0x69f480[_0x2cc989(0x618)][_0x2cc989(0x302)](_0x1a914b => { const _0x577f4e = _0x2cc989, _0x44d6ff = _0x16f84a[_0x577f4e(0x5ba)]('li'); _0x44d6ff[_0x577f4e(0x640)] = _0x577f4e(0x5d5), _0x44d6ff[_0x577f4e(0x7a2)] = _0x577f4e(0x3d8) + _0x1a914b['id'] + _0x577f4e(0x465) + _0x1a914b['id'] + _0x577f4e(0x6f9) + (_0x1a914b['avatar'] || _0x4d297d) + _0x577f4e(0x61f) + _0x1a914b['id'] + _0x577f4e(0x63b) + _0x1a914b['name'] + _0x577f4e(0x7ef), _0x3aac82['appendChild'](_0x44d6ff); }), _0x45c15e(_0x2cc989(0x55b), _0x2cc989(0x7c)); } else { await new Promise(_0x37a4c2 => setTimeout(_0x37a4c2, 0xa)); if (!_0x557cc6[_0x2cc989(0x170)][_0x2cc989(0x222)] || !_0x557cc6[_0x2cc989(0x170)]['key'] || !_0x557cc6[_0x2cc989(0x170)][_0x2cc989(0x5c0)]) return _0x599dea(_0x2cc989(0x1dc)), ![]; const _0x24cda0 = _0x5db7d2(); if (!_0x24cda0 || !_0x3d5ac4) return ![]; const _0x10b77b = _0x40920c(_0x24cda0['id']), _0x106f04 = _0x557cc6[_0x2cc989(0x5b8)]['at'](-0x1)?.['role'] === _0x2cc989(0x472); if (!force && !_0x106f04) return ![]; const _0x148e2d = _0x557cc6[_0x2cc989(0x5b8)]['at'](-0x1)?.['isOffline'] ?? ![]; if (delayMs) await new Promise(_0x45f8c0 => setTimeout(_0x45f8c0, delayMs)); _0x148e2d ? document[_0x2cc989(0x5b7)](_0x2cc989(0x4fb))['textContent'] = _0x2cc989(0x5c6) : _0xb22fcb(!![]); let _0x3d890d = ''; const _0x2e5787 = _0x5db7d2(); if (_0x2e5787?.[_0x2cc989(0x71d)]?.[_0x2cc989(0x5bc)]) { const _0x2561e2 = _0x2e5787[_0x2cc989(0x71d)], _0x29f5bf = await _0x352c43(_0x2561e2['songId']); if (_0x29f5bf && _0x29f5bf[_0x2cc989(0x567)]) { const _0x3f1fb5 = _0x106044(_0x29f5bf['lyrics']); if (_0x3f1fb5[_0x2cc989(0x7a6)] > 0x0) { const _0x457d22 = _0x4baa54['currentTime']; let _0xe26058 = -0x1; for (let _0x73dcf2 = 0x0; _0x73dcf2 < _0x3f1fb5['length']; _0x73dcf2++) { if (_0x457d22 >= _0x3f1fb5[_0x73dcf2][_0x2cc989(0x42f)]) _0xe26058 = _0x73dcf2; else break; } const _0x1fa910 = _0x3f1fb5[_0x2cc989(0x30e)]((_0xa6f93c, _0x19a477) => { const _0x4886b8 = _0x2cc989; if (_0x4886b8(0x65a) !== 'dTAbB') _0x2ed5a3 = _0x2aa043[_0x4886b8(0x58d)][0x0]; else { const _0x3f8c2a = _0x19a477 === _0xe26058 ? '>>\x20' : ''; return '' + _0x3f8c2a + _0xa6f93c['text']; } })[_0x2cc989(0x566)]('\x0a'); _0x3d890d = (_0x2cc989(0x810) + _0x2561e2[_0x2cc989(0x1e4)] + _0x2cc989(0x107) + _0x2561e2[_0x2cc989(0x6c8)] + _0x2cc989(0x453) + _0x1fa910 + _0x2cc989(0x348))[_0x2cc989(0xf2)](); } } } let _0x2c3c6a = '', _0xf699ea = ''; const _0x477673 = _0x557cc6[_0x2cc989(0x5b8)][_0x2cc989(0x7a6)]; if (_0x477673 > 0x1) { const _0x74543 = _0x557cc6[_0x2cc989(0x5b8)][_0x477673 - 0x2], _0x2296a9 = _0x557cc6[_0x2cc989(0x5b8)][_0x477673 - 0x1]; if (_0x74543['isOffline'] === ![] && _0x2296a9['isOffline'] === !![]) _0x2cc989(0x61a) === _0x2cc989(0x25c) ? (_0x44b901[_0x2cc989(0x78e)] = _0x303b2c['friendCircles'], _0x19f075[_0x2cc989(0x761)] = _0x13752a[_0x2cc989(0x761)]) : _0xf699ea = _0x2cc989(0x2e9) + _0x10b77b[_0x2cc989(0x293)] + _0x2cc989(0x457); else _0x74543[_0x2cc989(0x7fe)] === !![] && _0x2296a9['isOffline'] === ![] && (_0xf699ea = _0x2cc989(0x2b8) + _0x10b77b['name'] + _0x2cc989(0x720)); } if (_0x148e2d) { const _0x13f5a6 = 'normal,\x20happy,\x20angry,\x20sad,\x20shy'; _0x2c3c6a = '\x0a\x0a#\x20核心任务:\x20视觉小说剧本写作\x0a\x0a\x20\x20-\x20**当前场景**:\x20你正在与用户“' + _0x10b77b[_0x2cc989(0x293)] + _0x2cc989(0x6ec) + _0x13f5a6 + ']中选择的情绪标签\x22,\x0a\x20\x20\x20\x20\x22line\x22:\x20\x22台词或旁白内容\x22\x0a\x20\x20\x20\x20}\x0a\x20\x20\x0a\x20\x20-\x20**规则**:\x0a\x20\x20\x20\x201.\x20\x20`speaker`字段：如果是角色说话，就用角色名“' + _0x3d5ac4[_0x2cc989(0x293)] + _0x2cc989(0x7d8) + _0x13f5a6 + _0x2cc989(0x1ea) + _0x13f5a6 + _0x2cc989(0x244); } else _0x2cc989(0x60e) === 'DhgpP' ? (_0x2d3b65['log'](_0x2cc989(0x7b5)), _0x96856b[_0x2cc989(0x69e)](_0x2cc989(0x435), _0x2073b6['stringify'](_0x5e8d26))) : _0x2cc989(0x643); const { omniText: _0x5e0c4f } = _0x576fb7(_0x3d5ac4['id'], _0x24cda0['id']), _0x240039 = _0x1ad6ce(), _0x12c481 = _0x129229(_0x3d5ac4['id']), _0x54a4a4 = typeof _0x2508c7 === _0x2cc989(0x286) ? _0x2508c7['replaceAll']('{charName}', _0x3d5ac4[_0x2cc989(0x293)])[_0x2cc989(0x670)]('{userName}', _0x10b77b['name'] || '用户') : '', _0x1b02f0 = _0x56624c[_0x2cc989(0x30e)](_0x2e6a45 => _0x2e6a45[_0x2cc989(0x293)])[_0x2cc989(0x566)](',\x20'); let _0x19ebe0 = ''; if (_0x3d5ac4['linkedWorldBookIds'] && _0x3d5ac4['linkedWorldBookIds']['length'] > 0x0) { const _0x3a07a4 = _0x3d5ac4[_0x2cc989(0x674)][_0x2cc989(0x30e)](_0x2812d9 => _0x557cc6['worldBooks'][_0x2cc989(0x4d1)](_0x556807 => _0x556807['id'] === _0x2812d9))[_0x2cc989(0x1d8)](Boolean)['map'](_0x2514b9 => _0x2cc989(0x826) + _0x2514b9[_0x2cc989(0x293)] + '\x0a' + _0x2514b9[_0x2cc989(0x398)])[_0x2cc989(0x566)](''); if (_0x3a07a4) _0x19ebe0 = _0x2cc989(0x49b) + _0x3a07a4; } const _0x2520df = _0x10b77b[_0x2cc989(0x6f2)] ? '\x0a\x0a#\x20关于对话者“' + _0x10b77b[_0x2cc989(0x293)] + _0x2cc989(0x52b) + _0x10b77b[_0x2cc989(0x6f2)] : ''; let _0x5bbc2a = ''; const _0x1a9c90 = new Date(), _0x58d039 = _0xcc2d00(_0x3d5ac4['id']); _0x5bbc2a = _0x2cc989(0x82), _0x5bbc2a += '-\x20**当前精确时间**:\x20' + _0x1a9c90[_0x2cc989(0x586)]('zh-CN', { 'dateStyle': _0x2cc989(0x373), 'timeStyle': _0x2cc989(0x144) }) + '\x0a'; if (_0x58d039) { const _0x5b9b47 = new Date(_0x58d039[_0x2cc989(0x798)]), _0x4d2d46 = _0x411f32(_0x5b9b47); _0x5bbc2a += _0x2cc989(0x278) + _0x4d2d46 + '\x0a'; const _0x544058 = _0x1a9c90[_0x2cc989(0x289)](), _0x59ee6f = _0x5b9b47['toDateString'](), _0x50247c = new Date(); _0x50247c[_0x2cc989(0x22f)](_0x1a9c90[_0x2cc989(0x65f)]() - 0x1); const _0x20f81d = _0x50247c[_0x2cc989(0x289)](); if (_0x544058 === _0x59ee6f) { if ('fFXAj' === _0x2cc989(0x119)) { const _0x3619bd = _0x548f81[_0x2cc989(0x4e9)] === 'user' ? _0x2cc989(0x472) : 'ai', _0x55570a = _0x20cd7a[_0x2cc989(0x4e9)] === _0x2cc989(0x472) ? _0x31ba6b['name'] : _0x3464f5(_0x5c1765[_0x2cc989(0x4e9)])['name'], _0x446bc3 = _0x4dec9e[_0x2cc989(0x5ba)]('div'); _0x446bc3[_0x2cc989(0x640)] = _0x2cc989(0x1ab) + _0x3619bd, _0x446bc3[_0x2cc989(0x78)][_0x2cc989(0x798)] = _0x41cc5a[_0x2cc989(0x798)], _0x446bc3[_0x2cc989(0x6ca)][_0x2cc989(0x51a)] = 'none', _0x446bc3[_0x2cc989(0x6ca)][_0x2cc989(0x1fe)] = '0', _0x446bc3[_0x2cc989(0x7a2)] = _0x2cc989(0x64b) + _0x55570a + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>' + new _0x4a8229(_0x3c70aa[_0x2cc989(0x798)])[_0x2cc989(0x586)](_0x2cc989(0x6ef)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>' + _0x371ba4['content'][_0x2cc989(0x4f8)](/\n/g, _0x2cc989(0x6f6)) + _0x2cc989(0x4f4), _0x11e7ff['appendChild'](_0x446bc3); } else { const _0x2ae194 = (_0x1a9c90 - _0x5b9b47) / (0x3e8 * 0x3c); _0x2ae194 < 0x3c ? 'SRPtc' === _0x2cc989(0x518) ? (_0x31abce['classList'][_0x2cc989(0x7ff)](_0x2cc989(0x154), _0x2cc989(0x4ee)), _0x3178c5[_0x2cc989(0x35f)]['remove'](_0x2cc989(0x436)), _0x4eb258['diaryCurrentPage'] = _0x16b71c, _0x39a670(), _0xd581eb['isAnimatingDiary'] = ![]) : _0x5bbc2a += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a' : _0x5bbc2a += _0x2cc989(0x5bb) + Math[_0x2cc989(0x4c6)](_0x2ae194 / 0x3c) + _0x2cc989(0x16b); } } else { if (_0x20f81d === _0x59ee6f) _0x5bbc2a += '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a'; else { const _0x214133 = Math[_0x2cc989(0x4c6)]((_0x1a9c90 - _0x5b9b47) / (0x3e8 * 0x3c * 0x3c * 0x18)); _0x5bbc2a += _0x2cc989(0x668) + _0x214133 + _0x2cc989(0x803); } } } else { if (_0x2cc989(0x10d) !== _0x2cc989(0x91)) _0x5bbc2a += _0x2cc989(0x565); else { if (_0x1516cc) { const _0x14903b = _0x2ff018['createObjectURL'](_0x1157bc); _0x8a398a[_0x2cc989(0x483)] = _0x14903b, _0x547708[_0x2cc989(0x38d)] = () => { const _0x40ae52 = _0x2cc989; _0x72b061[_0x40ae52(0x29b)](_0x14903b); }; } else _0x25a0ec[_0x2cc989(0x406)] = _0x2cc989(0x734); } } const _0x27cb80 = ('\x0a' + _0x2c3c6a + '\x0a你只扮演【' + _0x3d5ac4[_0x2cc989(0x293)] + _0x2cc989(0x571) + _0x3d5ac4[_0x2cc989(0x293)] + _0x2cc989(0x387) + _0x3d5ac4[_0x2cc989(0x293)] + _0x2cc989(0x3e6) + _0x1b02f0 + _0x2cc989(0x2e5) + _0x54a4a4 + '\x0a')[_0x2cc989(0xf2)](), _0x3d484d = [{ 'role': _0x2cc989(0x14b), 'content': _0x27cb80 }], _0x2f5c66 = (_0x2cc989(0xc3) + (_0x3d5ac4[_0x2cc989(0x6f2)] || '你是一个乐于助人的助手。') + '\x0a' + _0x2520df + '\x20\x0a' + _0x5e0c4f + '\x0a' + _0x240039 + '\x0a' + _0x12c481 + _0x2cc989(0x145) + _0x3d890d + '\x0a' + _0x5bbc2a + '\x0a' + _0x19ebe0 + '\x0a')[_0x2cc989(0xf2)](); _0x2f5c66['replace'](/#.*|\s/g, '') && (_0x2cc989(0x246) !== _0x2cc989(0xb6) ? (_0x3d484d['push']({ 'role': _0x2cc989(0x472), 'content': _0x2f5c66 }), _0x3d484d['push']({ 'role': _0x2cc989(0x77b), 'content': _0x2cc989(0xf9) })) : _0x222881(_0x5f59ab[_0x2cc989(0x8c)])[_0x2cc989(0x192)](_0x2e40cf => { const _0x1847c7 = _0x2cc989; if (_0x2e40cf) { const _0x4aaebc = _0x2eee11['createObjectURL'](_0x2e40cf); _0x565860[_0x1847c7(0x483)] = _0x4aaebc, _0x31eaa4[_0x1847c7(0x38d)] = () => _0x1be48f[_0x1847c7(0x29b)](_0x4aaebc); } else _0x39655f[_0x1847c7(0x406)] = '图片加载失败'; })); const _0x372946 = _0x557cc6['preferences']?.[_0x2cc989(0x521)] ?? 0x64, _0x213147 = _0x557cc6[_0x2cc989(0x5b8)]['slice'](-_0x372946); for (const _0x21997e of _0x213147) { const _0xd0b37f = _0x21997e[_0x2cc989(0x7b4)] === 'ai' || _0x21997e[_0x2cc989(0x7b4)] === _0x2cc989(0x77b) ? 'assistant' : _0x2cc989(0x472); let _0x1e06ee = { 'role': _0xd0b37f, 'content': _0x21997e[_0x2cc989(0x398)] }, _0x367e71 = !!_0x21997e[_0x2cc989(0x398)]; if (_0x21997e[_0x2cc989(0x1ac)] && _0x21997e[_0x2cc989(0x398)][_0x2cc989(0x158)]('表情')) { const _0x38391e = _0x21997e[_0x2cc989(0x398)]['match'](/：(.*?)]$/); _0x1e06ee['content'] = '[sticker:' + (_0x38391e ? _0x38391e[0x1] : _0x2cc989(0x601)) + ']', _0x3d484d[_0x2cc989(0x6b4)](_0x1e06ee); } else { if (_0x2cc989(0x117) === _0x2cc989(0x17e)) _0x54a9bd = _0x178626(() => { const _0x1abfae = _0x2cc989; if (_0x410cef['type'] === _0x1abfae(0x514)) _0x1009ac[_0x1abfae(0x31e)](); _0x4db5f4(_0x5e19c3); }, 0x320); else { let _0x2513af = null; if (_0x21997e[_0x2cc989(0x690)]) _0x2513af = _0x21997e[_0x2cc989(0x690)]; else { if (_0x21997e[_0x2cc989(0x8c)]) { if (_0x2cc989(0x49c) !== _0x2cc989(0x49c)) _0x8acf59[_0x2cc989(0x2d0)] = _0x584fc1[_0x2cc989(0x1ec)], _0x122e36[_0x2cc989(0x2d0)] = _0x5b5fb1[_0x2cc989(0x1e4)], _0x38eaab[_0x2cc989(0x35f)][_0x2cc989(0x632)](_0x2cc989(0x680)), _0x6d44c0[_0x2cc989(0x6ca)][_0x2cc989(0x6a0)](_0x2cc989(0x79c), 'url(' + _0x2f1381[_0x2cc989(0x791)] + ')'); else try { if (_0x2cc989(0x1a5) !== _0x2cc989(0x252)) { const _0x51d11e = await _0x2aeef5(_0x21997e[_0x2cc989(0x8c)]); _0x51d11e && (_0x2513af = await _0x27ec3a(_0x51d11e)); } else return { 'type': _0x2cc989(0x68e), 'content': _0x4d6d9a }; } catch (_0x423054) { if ('wBjTb' !== 'wBjTb') { const _0x186b04 = _0x277e3c(_0x23d06c['senderId'] || _0xef1a2b['activeMeetingCharId']); _0x5814ea = _0x186b04?.['name'] || '角色', _0x3a29ad = _0x2cc989(0x321); } else console[_0x2cc989(0x50e)](_0x2cc989(0x29f), _0x423054); } } } _0x2513af && (_0x1e06ee[_0x2cc989(0x690)] = _0x2513af, _0x367e71 = !![]), _0x367e71 && _0x3d484d[_0x2cc989(0x6b4)](_0x1e06ee); } } } try { if (_0x2cc989(0x5c2) !== _0x2cc989(0x3cf)) { const _0xb814fa = await _0x2d20cc(_0x3d484d); if (!_0xb814fa) return ![]; if (_0x148e2d) { if (_0x2cc989(0x1d9) !== 'hoEnb') try { let _0x52edb0 = _0xb814fa[_0x2cc989(0xf2)](); const _0x300432 = _0x52edb0[_0x2cc989(0x3ee)](/(\[[\s\S]*\])/); _0x300432 && (_0x2cc989(0x1c4) !== _0x2cc989(0x1c4) ? _0x26f3c6['name'] !== _0x2cc989(0x1af) && (_0x2f6090[_0x2cc989(0x50e)](_0x2cc989(0x7c3), _0x1f2a11), _0x4aac03({ 'role': 'assistant', 'content': _0x2cc989(0x397) + _0x2789b9[_0x2cc989(0x832)] }, _0x7e189b['conversationHistory'][_0x2cc989(0x7a6)] - 0x1)) : _0x52edb0 = _0x300432[0x1]); const _0x5585ce = JSON[_0x2cc989(0x417)](_0x52edb0); if (Array['isArray'](_0x5585ce)) { if ('NmHTW' !== 'NmHTW') { const _0x3069bd = _0x124c31[_0x2cc989(0x70d)]('images', _0x2cc989(0x478)), _0x35e546 = _0x3069bd[_0x2cc989(0x365)](_0x2cc989(0x2c5)), _0x3f9864 = _0x35e546[_0x2cc989(0x5e8)]({ 'id': _0x2c1647, 'blob': _0x4c007b }); _0x3f9864[_0x2cc989(0x7c8)] = () => _0x2ada15(_0x3f9864['result']), _0x3f9864[_0x2cc989(0x3bc)] = () => _0x1ecd29(_0x3f9864[_0x2cc989(0x50e)]); } else { _0x557cc6['activeMeetingScriptQueue'] = _0x5585ce, _0x557cc6[_0x2cc989(0x249)][_0x3d5ac4['id']] = [..._0x5585ce], _0x5b9288(); const _0x1e323a = _0x5585ce['map'](_0x131e98 => _0x131e98[_0x2cc989(0x234)] === 'narrator' ? _0x131e98[_0x2cc989(0x805)] : _0x131e98['speaker'] + ':\x20' + _0x131e98[_0x2cc989(0x805)])[_0x2cc989(0x566)]('\x0a\x0a'); _0x557cc6[_0x2cc989(0x5b8)][_0x2cc989(0x6b4)]({ 'role': 'assistant', 'senderId': _0x3d5ac4['id'], 'timestamp': Date[_0x2cc989(0x183)](), 'isOffline': !![], 'content': _0x1e323a }); } } } catch (_0x307508) { console[_0x2cc989(0x50e)](_0x2cc989(0x33e), _0x307508, _0x2cc989(0x594), _0xb814fa), _0x557cc6['conversationHistory'][_0x2cc989(0x6b4)]({ 'role': _0x2cc989(0x77b), 'senderId': _0x3d5ac4['id'], 'timestamp': Date[_0x2cc989(0x183)](), 'isOffline': !![], 'content': _0x2cc989(0x260) + _0xb814fa + ']' }); } else { const _0x2e4a6e = new _0x2e76f7(); _0x2e4a6e[_0x2cc989(0x686)] = () => _0x5bce17(_0x2e4a6e['result']), _0x2e4a6e['onerror'] = _0x342aae, _0x2e4a6e['readAsDataURL'](_0x37ac16); } } else { const _0xedf730 = _0x87165d(_0xb814fa), _0x390956 = _0xedf730[_0x2cc989(0x30e)](_0x48d8ac => { const _0x3e57ec = _0x2cc989; if (_0x3e57ec(0x838) !== _0x3e57ec(0x7a4)) { const _0x50d16f = _0x48d8ac[_0x3e57ec(0xf2)](), _0x414390 = _0x50d16f[_0x3e57ec(0x3ee)](/^\[sticker:(.*?)\]$/), _0x5a6906 = _0x50d16f[_0x3e57ec(0x3ee)](/^\[transfer:([\d.]+)\|(.*?)\]$/), _0x5420ac = _0x50d16f[_0x3e57ec(0x3ee)](/^\[music:(.*?)\|(.*?)\]$/); if (_0x5420ac) { if (_0x3e57ec(0x3e9) !== _0x3e57ec(0x3e9)) _0x19eec3[_0x3e57ec(0x7a2)] = _0x67252e; else return { 'type': _0x3e57ec(0x164), 'songName': _0x5420ac[0x1][_0x3e57ec(0xf2)](), 'artist': _0x5420ac[0x2][_0x3e57ec(0xf2)]() }; } else { if (_0x414390) return { 'type': _0x3e57ec(0x475), 'name': _0x414390[0x1][_0x3e57ec(0xf2)]() }; else { if (_0x5a6906) { const _0x435b63 = parseFloat(_0x5a6906[0x1]), _0x52d8ef = _0x5a6906[0x2][_0x3e57ec(0xf2)](), _0x55e24e = _0x40920c(_0x557cc6[_0x3e57ec(0x589)]); let _0x443196 = null; if (_0x52d8ef === _0x55e24e[_0x3e57ec(0x293)]) _0x443196 = _0x55e24e['id']; else { if (_0x3e57ec(0x428) !== _0x3e57ec(0x656)) { const _0x416eeb = _0x5db7d2(); if (_0x416eeb[_0x3e57ec(0x516)] === _0x3e57ec(0x3fd)) { const _0x59c0ba = _0x557cc6[_0x3e57ec(0x618)]['find'](_0x4a5947 => _0x416eeb['participantIds'][_0x3e57ec(0x158)](_0x4a5947['id']) && _0x4a5947[_0x3e57ec(0x293)] === _0x52d8ef); if (_0x59c0ba) _0x443196 = _0x59c0ba['id']; } } else _0x53f38c['innerHTML'] = _0x3e57ec(0x657) + _0x2ec468 + _0x3e57ec(0x8e) + _0x2a2681[_0x3e57ec(0x6c8)] + _0x3e57ec(0x624) + _0x552e13[_0x3e57ec(0x1e4)] + _0x3e57ec(0x254); } if (_0x443196) return { 'type': 'transfer', 'amount': _0x435b63, 'recipientId': _0x443196, 'senderId': _0x3d5ac4['id'] }; else return { 'type': _0x3e57ec(0x68e), 'content': '(想转账给“' + _0x52d8ef + '”，但没找到人)' }; } else { if (_0x50d16f) { if (_0x3e57ec(0x331) !== _0x3e57ec(0x331)) _0x58b1d4(); else return { 'type': _0x3e57ec(0x68e), 'content': _0x50d16f }; } } } } return null; } else { const _0x58033a = (_0x242646 - _0x41a5a5) / (0x3e8 * 0x3c); _0x58033a < 0x3c ? _0x102c36 += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a' : _0x3b6995 += _0x3e57ec(0x5bb) + _0xa7e97e[_0x3e57ec(0x4c6)](_0x58033a / 0x3c) + '小时前），可以简单问候一下对方现在的状态。\x0a'; } })['filter'](Boolean), _0x4fc4c2 = async _0x1731fc => { const _0x1cdfb9 = _0x2cc989, _0x5d6fb0 = { 'role': _0x1cdfb9(0x77b), 'senderId': _0x3d5ac4['id'], 'timestamp': Date[_0x1cdfb9(0x183)](), 'isOffline': _0x148e2d }; if (_0x1731fc[_0x1cdfb9(0x516)] === _0x1cdfb9(0x164)) { const { songName: _0x162b26, artist: _0x24d825 } = _0x1731fc; _0x5d6fb0[_0x1cdfb9(0x516)] = _0x1cdfb9(0x164), _0x5d6fb0[_0x1cdfb9(0x398)] = _0x1cdfb9(0x53e) + _0x162b26 + _0x1cdfb9(0x39c) + _0x24d825 + ']'; try { const _0x7e75f9 = await _0x5b6497(_0x162b26, _0x24d825); let _0x5a92a9 = null; if (_0x7e75f9[_0x1cdfb9(0x791)]) { const _0x2280c4 = await _0x57a56e(_0x7e75f9[_0x1cdfb9(0x791)]); _0x5a92a9 = _0x1cdfb9(0xb3) + Date['now']() + '_' + Math[_0x1cdfb9(0x19a)](), await _0x3aff46(_0x5a92a9, _0x2280c4); } Object[_0x1cdfb9(0x70a)](_0x5d6fb0, { 'songName': _0x162b26, 'artist': _0x24d825, 'coverId': _0x5a92a9, 'playableUrl': _0x7e75f9[_0x1cdfb9(0x606)] }); } catch (_0x531eb7) { Object['assign'](_0x5d6fb0, { 'songName': _0x162b26, 'artist': _0x24d825, 'coverId': null, 'playableUrl': null }); } } else { if (_0x1731fc[_0x1cdfb9(0x516)] === _0x1cdfb9(0x475)) { const _0x35068b = _0x56624c[_0x1cdfb9(0x4d1)](_0x3a335e => _0x3a335e['name'] === _0x1731fc[_0x1cdfb9(0x293)]); if (_0x35068b) Object[_0x1cdfb9(0x70a)](_0x5d6fb0, { 'content': _0x1cdfb9(0x167) + _0x35068b[_0x1cdfb9(0x293)] + ']', 'displayUrl': _0x35068b[_0x1cdfb9(0x606)] }); else _0x5d6fb0[_0x1cdfb9(0x398)] = _0x1cdfb9(0x73b) + _0x1731fc['name'] + ']'; } else { if (_0x1731fc[_0x1cdfb9(0x516)] === _0x1cdfb9(0xc9)) { const _0x287961 = _0x1731fc[_0x1cdfb9(0x6c2)] === _0x40920c(_0x557cc6[_0x1cdfb9(0x589)])['id'] ? _0x40920c(_0x557cc6['activeChatId']) : _0x3132c6(_0x1731fc[_0x1cdfb9(0x6c2)]); Object[_0x1cdfb9(0x70a)](_0x5d6fb0, { 'type': _0x1cdfb9(0xc9), 'amount': _0x1731fc[_0x1cdfb9(0x5e3)], 'recipientId': _0x1731fc[_0x1cdfb9(0x6c2)], 'content': '[AI向\x20' + (_0x287961?.['name'] || '未知') + '\x20转账\x20' + _0x1731fc[_0x1cdfb9(0x5e3)] + ']' }); } else { const _0x33b6eb = _0x12956f(_0x1731fc[_0x1cdfb9(0x398)]); Object[_0x1cdfb9(0x70a)](_0x5d6fb0, { 'content': _0x33b6eb[_0x1cdfb9(0x398)], 'quotedMessage': _0x33b6eb[_0x1cdfb9(0x6c7)] }); } } } return _0x5d6fb0; }, _0x48b2c9 = await Promise[_0x2cc989(0x437)](_0x390956['map'](_0x4fc4c2)); for (const _0x12433e of _0x48b2c9) { (_0x12433e['content'] || _0x12433e[_0x2cc989(0x1ac)] || _0x12433e[_0x2cc989(0x516)] === _0x2cc989(0x164)) && (await new Promise(_0xdf309f => setTimeout(_0xdf309f, 0x12c + Math[_0x2cc989(0x19a)]() * 0x190)), _0x557cc6[_0x2cc989(0x5b8)][_0x2cc989(0x6b4)](_0x12433e), _0x2dea46()); } } return _0x2efa53(), _0x2dea46(), !![]; } else _0x5c464a[_0x2cc989(0x50e)](_0x2cc989(0x7c3), _0x2f0888), _0xccde99({ 'role': _0x2cc989(0x77b), 'content': _0x2cc989(0x397) + _0x102dd5[_0x2cc989(0x832)] }, _0x3147ce['conversationHistory'][_0x2cc989(0x7a6)] - 0x1); } catch (_0xfbb7c5) { if (_0xfbb7c5['name'] !== _0x2cc989(0x1af)) { if (_0x2cc989(0x536) === 'MXLNe') { console[_0x2cc989(0x50e)](_0x2cc989(0x849), _0xfbb7c5); const _0x38bc90 = { 'role': 'assistant', 'content': '错误:\x20' + _0xfbb7c5['message'], 'senderId': _0x3d5ac4['id'], 'isOffline': _0x148e2d }; _0x557cc6['conversationHistory']['push'](_0x38bc90), _0x2dea46(); } else { _0x37bc55(_0x2cc989(0x15b)); return; } } return ![]; } finally { _0xb22fcb(![]); } } } async function _0x45c9b7() { const _0x5a756a = _0x27dd8f, _0x35ed85 = _0x5db7d2(); if (!_0x35ed85 || _0x35ed85['type'] !== _0x5a756a(0x405)) { if (_0x5a756a(0x63e) === 'GhStc') { _0x599dea('哼，只有私聊才能进行总结，群聊那么乱怎么记！'); return; } else _0x211ead = _0x5d5be0['avatar']; } if (_0x557cc6[_0x5a756a(0x161)]) { if (_0x5a756a(0x4ed) === _0x5a756a(0x93)) return _0x19c00d + '分钟前'; else { _0x599dea(_0x5a756a(0x15b)); return; } } const _0x4adb88 = await _0x4512da(_0x5a756a(0x37d)); if (!_0x4adb88) return; _0x2158b6(!![], '正在翻阅全部历史记录...'), _0x397bfa['value'] = '', _0xd3e43e[_0x5a756a(0x35f)][_0x5a756a(0x632)](_0x5a756a(0x1c6)), _0x557cc6[_0x5a756a(0x161)] = !![]; try { const _0x25255b = _0x3132c6(_0x35ed85[_0x5a756a(0x765)][0x0]), _0x3232f6 = _0x40920c(_0x35ed85['id']), _0x45674b = _0x11b6a2(_0x35ed85['id']); if (_0x45674b['length'] === 0x0) { _0x397bfa[_0x5a756a(0x73f)] = _0x5a756a(0x39d); return; } const _0x3a57a8 = _0x45674b['map'](_0x3c766e => { const _0x29cb7b = _0x5a756a; if (_0x29cb7b(0x550) !== _0x29cb7b(0x550)) _0x2fb7fe(), _0x265b53(_0x29cb7b(0x707), _0x29cb7b(0x827)); else { const _0x252ab8 = new Date(_0x3c766e[_0x29cb7b(0x798)]), _0x312bf8 = _0x252ab8['getFullYear']() + '-' + String(_0x252ab8[_0x29cb7b(0x2aa)]() + 0x1)['padStart'](0x2, '0') + '-' + String(_0x252ab8[_0x29cb7b(0x65f)]())['padStart'](0x2, '0'), _0x7ceab5 = String(_0x252ab8[_0x29cb7b(0x5f1)]())['padStart'](0x2, '0') + ':' + String(_0x252ab8['getMinutes']())[_0x29cb7b(0x1db)](0x2, '0'); let _0x46e44b = '未知'; if (_0x3c766e['role'] === 'user') { if (_0x29cb7b(0x4b3) !== _0x29cb7b(0x4b3)) { const _0x73f0f8 = _0x4c8a58['recipientId'] === _0xa1c032(_0xdf4fe[_0x29cb7b(0x589)])['id'] ? _0x8c0fa3(_0x5cc39d[_0x29cb7b(0x589)]) : _0x499cf0(_0x48db44[_0x29cb7b(0x6c2)]); _0x11576f[_0x29cb7b(0x70a)](_0x442b9b, { 'type': _0x29cb7b(0xc9), 'amount': _0x10c64c[_0x29cb7b(0x5e3)], 'recipientId': _0x23c854['recipientId'], 'content': _0x29cb7b(0x13e) + (_0x73f0f8?.[_0x29cb7b(0x293)] || '未知') + _0x29cb7b(0x58b) + _0x3c017c[_0x29cb7b(0x5e3)] + ']' }); } else _0x46e44b = _0x3232f6[_0x29cb7b(0x293)]; } else _0x46e44b = _0x25255b[_0x29cb7b(0x293)]; let _0x5e663b = _0x3c766e[_0x29cb7b(0x398)]; if (_0x3c766e['displayUrl']) _0x5e663b = _0x29cb7b(0x740); if (_0x3c766e[_0x29cb7b(0x8c)]) _0x5e663b = _0x29cb7b(0x6e5); return '[' + _0x312bf8 + '\x20' + _0x7ceab5 + _0x29cb7b(0x1d5) + _0x46e44b + ']:\x20' + _0x5e663b; } })['join']('\x0a'), _0x5d9f7f = _0x1f0fac[_0x5a756a(0x4f8)](/{charName}/g, _0x25255b[_0x5a756a(0x293)])['replace'](/{userName}/g, _0x3232f6[_0x5a756a(0x293)]), _0x56b0c8 = [{ 'role': _0x5a756a(0x14b), 'content': _0x5d9f7f }, { 'role': _0x5a756a(0x472), 'content': _0x3a57a8 }], _0x5be245 = await _0x2d20cc(_0x56b0c8); _0x397bfa[_0x5a756a(0x73f)] = _0x5be245 || _0x5a756a(0x134), _0x397bfa[_0x5a756a(0x4f0)] = 0x0; } catch (_0x30d6bd) { if (_0x5a756a(0x7f2) === 'pYRLU') { const _0x4427be = _0xb11878[_0x50079c[_0x5a756a(0x7a6)] - 0x1]; (!_0x1c24ea || _0x4427be[_0x5a756a(0x798)] > _0x3725b1['timestamp']) && (_0x11242b = _0x4427be); } else console[_0x5a756a(0x50e)](_0x5a756a(0x36d), _0x30d6bd), _0x397bfa[_0x5a756a(0x73f)] = '#\x20发生错误：\x0a' + _0x30d6bd['message']; } finally { if (_0x5a756a(0x2b1) === _0x5a756a(0x2b1)) _0x2158b6(![]), _0x557cc6[_0x5a756a(0x161)] = ![]; else for (const _0x911dca in _0x1e2f6d) { _0x429175[_0x5a756a(0x6ca)][_0x911dca] = _0x4536d1[_0x911dca]; } } } async function _0x5debb2() { const _0x1bb430 = _0x27dd8f; console[_0x1bb430(0x235)](_0x1bb430(0x645)); if (!_0x557cc6['apiSettings']['endpoint'] || !_0x557cc6[_0x1bb430(0x170)][_0x1bb430(0x499)] || !_0x557cc6[_0x1bb430(0x170)][_0x1bb430(0x5c0)]) { _0x599dea(_0x1bb430(0x1dc)); return; } const _0x3238f0 = _0x557cc6[_0x1bb430(0x5b8)]['at'](-0x1)?.[_0x1bb430(0x7b4)] === _0x1bb430(0x472); if (!_0x3238f0 || _0x557cc6[_0x1bb430(0x161)]) return; const _0x476d7f = _0x5db7d2(); if (!_0x476d7f) return; _0x557cc6['isGenerating'] = !![], _0xb22fcb(!![]); try { if (_0x476d7f[_0x1bb430(0x516)] === _0x1bb430(0x405)) { if (_0x1bb430(0x6e7) !== _0x1bb430(0x6e7)) try { _0x293e48[_0x1bb430(0x69e)](_0x1bb430(0x1f9), _0x570587[_0x1bb430(0x82f)]({ 'playlist': _0x471e22[_0x1bb430(0x5d2)], 'currentIndex': _0x2e4076['currentlyPlayingIndex'] })); } catch (_0x8c68b7) { _0x5cc40d['error'](_0x1bb430(0x4c0), _0x8c68b7); } else { const _0x4882fa = _0x3132c6(_0x476d7f[_0x1bb430(0x765)][0x0]); console[_0x1bb430(0x235)](_0x1bb430(0x434)); if (_0x4882fa) await _0x5113cc(_0x4882fa, { 'force': !![] }); } } else { if (_0x1bb430(0x445) !== _0x1bb430(0x445)) { const _0x48f90c = []; if (_0x362f6a[_0x1bb430(0x398)]) _0x48f90c[_0x1bb430(0x6b4)]({ 'text': _0x25d3a5[_0x1bb430(0x398)] }); if (_0xac366a[_0x1bb430(0x690)]) { const _0x1b6ad1 = _0x4c1e1d['image']['split'](',')[0x1], _0x5d9a5e = _0x53a944['image'][_0x1bb430(0x471)](_0x4fb6bd[_0x1bb430(0x690)]['indexOf'](':') + 0x1, _0x165206['image'][_0x1bb430(0x28f)](';')) || _0x1bb430(0x648); _0x48f90c[_0x1bb430(0x6b4)]({ 'inline_data': { 'mime_type': _0x5d9a5e, 'data': _0x1b6ad1 } }); } return _0x48f90c; } else { const _0x59be0e = await _0xfe31ac(); if (_0x59be0e && _0x59be0e[_0x1bb430(0x4c7)]?.['length']) _0x1bb430(0x238) === 'QROMD' ? await _0x541a3d(_0x59be0e) : _0x202bac[_0x1bb430(0x516)] === _0x1bb430(0x3fd) && (_0x2fbec8[_0x1bb430(0x765)] = _0x5b20bb['participantIds'][_0x1bb430(0x1d8)](_0x462ecc => _0x462ecc !== _0x5d3126)); else { if ('MehNV' !== _0x1bb430(0x369)) { console[_0x1bb430(0x548)](_0x1bb430(0xd5)); const _0x2ddda5 = _0x476d7f[_0x1bb430(0x765)][_0x1bb430(0x30e)](_0x3132c6)[_0x1bb430(0x1d8)](Boolean); if (!_0x2ddda5[_0x1bb430(0x7a6)]) return; let _0x47aee0 = 0x0; for (const _0x2e0048 of _0x2ddda5) { _0x1bb430(0x470) !== _0x1bb430(0x4e8) ? (_0x5113cc(_0x2e0048, { 'force': !![], 'delayMs': _0x47aee0 }), _0x47aee0 += 0x1f4) : _0x59982a[_0x1bb430(0x6ca)][_0x1bb430(0x836)] = _0x1bb430(0x534); } } else _0xeec1f5[_0x1bb430(0x6ca)][_0x1bb430(0x836)] = _0x1bb430(0x4e3), _0x28cfa0[_0x1bb430(0x6ca)][_0x1bb430(0x836)] = _0x1bb430(0x534); } } } } catch (_0x17385c) { if (_0x1bb430(0xeb) !== _0x1bb430(0xeb)) { const _0x472870 = _0x409cd6[_0x1bb430(0x5b7)](_0x1bb430(0x6da)); _0x472870 && _0x472870[_0x1bb430(0x66b)](); } else { if (_0x17385c[_0x1bb430(0x293)] !== _0x1bb430(0x1af)) { if (_0x1bb430(0x70f) !== _0x1bb430(0x70f)) return _0x42ae18['reply'][_0x1bb430(0x30e)](_0x5ad943 => typeof _0x5ad943 === _0x1bb430(0x286) ? _0x5ad943 : _0x5ad943?.[_0x1bb430(0x398)])['filter'](_0x301aba)[_0x1bb430(0x7ea)](_0x221241); else console[_0x1bb430(0x50e)](_0x1bb430(0x7c3), _0x17385c), _0x53c19f({ 'role': 'assistant', 'content': _0x1bb430(0x397) + _0x17385c[_0x1bb430(0x832)] }, _0x557cc6[_0x1bb430(0x5b8)]['length'] - 0x1); } } } finally { _0x1bb430(0x2d2) === _0x1bb430(0x118) ? (_0x234d39 = { 'characterId': _0x52b06c[_0x1bb430(0x29e)], 'entries': [] }, _0xd678d3[_0x1bb430(0xa8)]['push'](_0x23175a)) : (_0x557cc6[_0x1bb430(0x161)] = ![], _0xb22fcb(![])); } } function _0x4ca9cb(_0x2aa8b0, _0x2354e7) { const _0x4eed7a = _0x27dd8f, _0xc3cd7a = _0x2354e7[_0x4eed7a(0x43b)](), _0x2e8d7b = _0x2aa8b0[_0x4eed7a(0x43b)](); if (_0xc3cd7a[_0x4eed7a(0x795)](_0x4eed7a(0x7b0))) return _0x4eed7a(0x4da); if (_0x2e8d7b['includes']('anthropic.com')) return 'anthropic'; if (_0x2e8d7b['includes'](_0x4eed7a(0xd9))) return _0x4eed7a(0x10f); if (_0xc3cd7a['startsWith'](_0x4eed7a(0x10f))) return _0x4eed7a(0x10f); return 'openai'; } async function _0x2d20cc(_0x33f08d, _0x829b28 = {}) { const _0x5849e5 = _0x27dd8f; _0x557cc6['currentAbortController'] && _0x557cc6[_0x5849e5(0xb8)][_0x5849e5(0x2b0)](_0x5849e5(0x792)); _0x557cc6[_0x5849e5(0xb8)] = new AbortController(); const _0x2bcd70 = _0x557cc6[_0x5849e5(0xb8)][_0x5849e5(0x6be)], { endpoint: _0x3dfeb6, key: _0xf93044, model: _0x5d1f8c } = _0x557cc6[_0x5849e5(0x170)], _0x307ba1 = !!_0x829b28['json'], _0x4986d5 = _0x4ca9cb(_0x3dfeb6, _0x5d1f8c); console[_0x5849e5(0x235)](_0x5849e5(0x32c) + _0x4986d5); let _0x5ce87b = ''; try { switch (_0x4986d5) { case _0x5849e5(0x4da): { const _0x4b44df = _0x28f483(_0xf93044), _0x916249 = _0x33f08d[_0x5849e5(0x4d1)](_0x5541aa => _0x5541aa[_0x5849e5(0x7b4)] === _0x5849e5(0x14b))?.[_0x5849e5(0x398)] || '', _0x123bde = _0x33f08d['filter'](_0x4c29cf => _0x4c29cf[_0x5849e5(0x7b4)] !== _0x5849e5(0x14b)), _0x380780 = { 'model': _0x5d1f8c, 'system': _0x916249, 'messages': _0x123bde[_0x5849e5(0x30e)](_0x149a2f => ({ 'role': _0x149a2f['role'], 'content': [{ 'type': _0x5849e5(0x68e), 'text': _0x149a2f[_0x5849e5(0x398)] }] })), 'max_tokens': 0x1000 }, _0x2ed783 = await fetch(_0x3dfeb6, { 'method': 'POST', 'headers': { 'Content-Type': _0x5849e5(0x6f1), 'x-api-key': _0x4b44df, 'anthropic-version': _0x5849e5(0x327) }, 'body': JSON[_0x5849e5(0x82f)](_0x380780), 'signal': _0x2bcd70 }); if (!_0x2ed783['ok']) { const _0x300f10 = await _0x2ed783[_0x5849e5(0x7ad)]()[_0x5849e5(0xc2)](() => ({})); throw new Error(_0x5849e5(0x394) + _0x2ed783[_0x5849e5(0x27f)] + _0x5849e5(0x39c) + (_0x300f10[_0x5849e5(0x50e)]?.[_0x5849e5(0x832)] || _0x2ed783[_0x5849e5(0x336)])); } const _0x55cc8d = await _0x2ed783[_0x5849e5(0x7ad)](); _0x5ce87b = _0x55cc8d[_0x5849e5(0x398)]?.[0x0]?.[_0x5849e5(0x68e)] || ''; break; } case 'gemini': { if (_0x5849e5(0x663) !== 'CatLB') { const _0x385791 = _0x28f483(_0xf93044), _0x1120a9 = _0x3dfeb6[_0x5849e5(0x158)](_0x5849e5(0xdb)), _0x54616 = _0x1c30b6 => { const _0x335b30 = _0x5849e5, _0x327494 = []; if (_0x1c30b6['content']) _0x327494[_0x335b30(0x6b4)]({ 'text': _0x1c30b6['content'] }); if (_0x1c30b6[_0x335b30(0x690)]) { const _0x39f816 = _0x1c30b6[_0x335b30(0x690)][_0x335b30(0x1d2)](',')[0x1], _0x1addfe = _0x1c30b6[_0x335b30(0x690)][_0x335b30(0x471)](_0x1c30b6[_0x335b30(0x690)][_0x335b30(0x28f)](':') + 0x1, _0x1c30b6[_0x335b30(0x690)][_0x335b30(0x28f)](';')) || 'image/jpeg'; _0x327494['push']({ 'inline_data': { 'mime_type': _0x1addfe, 'data': _0x39f816 } }); } return _0x327494; }, _0x1290fd = _0x33f08d['map'](_0x457533 => ({ 'role': _0x457533[_0x5849e5(0x7b4)] === _0x5849e5(0x77b) ? 'model' : _0x457533[_0x5849e5(0x7b4)] === _0x5849e5(0x14b) ? 'user' : _0x457533[_0x5849e5(0x7b4)], 'parts': _0x54616(_0x457533) }))[_0x5849e5(0x1d8)](_0x2739f6 => _0x2739f6[_0x5849e5(0x777)][_0x5849e5(0x7a6)] > 0x0), _0x5d2d7f = { 'contents': _0x1290fd }; _0x307ba1 && _0x1120a9 && (_0x5849e5(0x59c) !== _0x5849e5(0x7a7) ? _0x5d2d7f[_0x5849e5(0x6ce)] = { 'response_mime_type': _0x5849e5(0x6f1) } : (_0x6a213a[_0x5849e5(0x50e)](_0x5849e5(0x7e7), _0x2d297c), _0x379d17[_0x5849e5(0x50e)](_0x5849e5(0x285), _0x25967a))); const _0x575422 = _0x3dfeb6 + _0x5849e5(0x1e5) + _0x5d1f8c + ':streamGenerateContent?key=' + _0x385791 + _0x5849e5(0x58c), _0x4f5626 = await fetch(_0x575422, { 'method': _0x5849e5(0xfd), 'headers': { 'Content-Type': _0x5849e5(0x6f1) }, 'body': JSON[_0x5849e5(0x82f)](_0x5d2d7f), 'signal': _0x2bcd70 }); if (!_0x4f5626['ok']) throw new Error(_0x5849e5(0x54d) + _0x4f5626['status']); const _0x5b22c8 = _0x4f5626[_0x5849e5(0x496)][_0x5849e5(0x1a3)](), _0x17dc72 = new TextDecoder(); let _0x4f1f95 = ''; while (!![]) { if (_0x5849e5(0x579) === 'jORiM') { if (_0x2bcd70[_0x5849e5(0x2c4)]) { if (_0x5849e5(0x685) === _0x5849e5(0x7c6)) { _0x2b5a3d(_0x5849e5(0x81e)); return; } else { console['log'](_0x5849e5(0x818)), _0x5b22c8[_0x5849e5(0x70c)](); break; } } const { done: _0x3837c8, value: _0x230718 } = await _0x5b22c8[_0x5849e5(0x658)](); if (_0x3837c8) break; const _0x284644 = _0x17dc72[_0x5849e5(0x1ed)](_0x230718, { 'stream': !![] }), _0x463a5a = _0x284644[_0x5849e5(0x1d2)]('\x0a')[_0x5849e5(0x1d8)](_0x3c0005 => _0x3c0005[_0x5849e5(0xf2)]()['startsWith'](_0x5849e5(0x587))); for (const _0x3e5f55 of _0x463a5a) { const _0xd8d2ba = _0x3e5f55[_0x5849e5(0x4f8)](_0x5849e5(0x2b6), ''); if (_0xd8d2ba === _0x5849e5(0x1a9)) break; try { _0x4f1f95 += JSON[_0x5849e5(0x417)](_0xd8d2ba)[_0x5849e5(0x7f9)][0x0]['content'][_0x5849e5(0x777)][0x0][_0x5849e5(0x68e)]; } catch { } } } else _0x206c9c(), _0x1676e3(_0x5849e5(0x769), _0x5849e5(0x204)); } _0x5ce87b = _0x4f1f95; break; } else { const _0x1006c4 = _0x3f723c[_0x5849e5(0x5b7)](_0x3b370b); _0x1006c4['innerHTML'] = '', _0x52158c[_0x5849e5(0x58d)][_0x5849e5(0x302)](_0x5ae947 => { const _0x1bb0ec = _0x5849e5, _0x2415d1 = _0x21c1ed[_0x1bb0ec(0x5ba)](_0x1bb0ec(0x5e9)); _0x2415d1[_0x1bb0ec(0x73f)] = _0x5ae947['id'], _0x2415d1[_0x1bb0ec(0x2d0)] = _0x5ae947['name'], _0x1006c4[_0x1bb0ec(0x796)](_0x2415d1); }); } } case _0x5849e5(0x6b2): default: { if ('qzoTU' !== _0x5849e5(0x76e)) { const _0x188b0c = _0x28f483(_0xf93044), _0x57e446 = _0x3dfeb6[_0x5849e5(0x4f8)](/\/+$/, '') + _0x5849e5(0x59b), _0x37b105 = _0x33f08d[_0x5849e5(0x30e)](_0x196fae => { const _0x39e428 = _0x5849e5; if (_0x196fae[_0x39e428(0x7b4)] === _0x39e428(0x472) && _0x196fae[_0x39e428(0x690)]) { if (_0x39e428(0x724) === _0x39e428(0x724)) return { 'role': _0x39e428(0x472), 'content': [{ 'type': 'text', 'text': _0x196fae[_0x39e428(0x398)] || '\x20' }, { 'type': _0x39e428(0x2a0), 'image_url': { 'url': _0x196fae[_0x39e428(0x690)], 'detail': _0x39e428(0x474) } }] }; else { _0xd9198e[_0x39e428(0x589)] = null, _0x176315(), _0xfa3604(![]), _0xe9b134[_0x39e428(0x5b7)](_0x39e428(0x282))[_0x39e428(0x6ca)][_0x39e428(0xcf)] = ''; return; } } return { 'role': _0x196fae[_0x39e428(0x7b4)], 'content': _0x196fae[_0x39e428(0x398)] }; })[_0x5849e5(0x1d8)](_0x222f1e => _0x222f1e[_0x5849e5(0x398)]), _0x119fce = { 'model': _0x5d1f8c, 'messages': _0x37b105, 'max_tokens': 0x1000, ..._0x307ba1 ? { 'response_format': { 'type': _0x5849e5(0x551) } } : {} }, _0x34167f = await fetch(_0x57e446, { 'method': _0x5849e5(0xfd), 'headers': { 'Content-Type': _0x5849e5(0x6f1), 'Authorization': _0x5849e5(0x5cd) + _0x188b0c }, 'body': JSON[_0x5849e5(0x82f)](_0x119fce), 'signal': _0x2bcd70 }); if (!_0x34167f['ok']) { if (_0x5849e5(0x2dd) !== _0x5849e5(0x2dd)) _0x29ee53(_0x5849e5(0x14f)); else { const _0x421bc4 = await _0x34167f[_0x5849e5(0x7ad)]()[_0x5849e5(0xc2)](() => ({})); throw new Error(_0x5849e5(0x169) + _0x34167f['status'] + _0x5849e5(0x39c) + (_0x421bc4[_0x5849e5(0x50e)]?.['message'] || _0x34167f['statusText'])); } } const _0x47ec3b = await _0x34167f[_0x5849e5(0x7ad)](); _0x5ce87b = _0x47ec3b[_0x5849e5(0x5e7)]?.[0x0]?.[_0x5849e5(0x832)]?.[_0x5849e5(0x398)] || ''; break; } else { if (!_0x27bd87 || !_0x416feb[_0x5849e5(0x158)](',')) return _0x49d16f; const _0x24cd3e = _0x524e66[_0x5849e5(0x1d2)](',')[_0x5849e5(0x30e)](_0x1bfae7 => _0x1bfae7[_0x5849e5(0xf2)]()); return _0x24cd3e[_0x2e2bdd[_0x5849e5(0x660)](_0x19b24c[_0x5849e5(0x19a)]() * _0x24cd3e['length'])]; } } }return _0x5ce87b; } catch (_0x193e22) { if (_0x193e22[_0x5849e5(0x293)] === _0x5849e5(0x1af)) { if ('bWjZi' === _0x5849e5(0x314)) return console['log'](_0x5849e5(0x21a)), ''; else _0x43d968[_0x5849e5(0x50e)](_0x5849e5(0x33e), _0x92f1a9, '原始文本:', _0x4f5c08), _0x3325d0['conversationHistory'][_0x5849e5(0x6b4)]({ 'role': _0x5849e5(0x77b), 'senderId': _0x3ba4fd['id'], 'timestamp': _0x37a342['now'](), 'isOffline': !![], 'content': _0x5849e5(0x260) + _0xd93218 + ']' }); } throw _0x193e22; } finally { _0x557cc6['currentAbortController'] && _0x557cc6[_0x5849e5(0xb8)][_0x5849e5(0x6be)] === _0x2bcd70 && (_0x5849e5(0x6f3) !== _0x5849e5(0x6f3) ? (_0xf33ec7[_0x5849e5(0x204)]['name'] = _0x33148f['value'][_0x5849e5(0xf2)](), _0x452e03[_0x5849e5(0x204)][_0x5849e5(0x6f2)] = _0x15122c[_0x5849e5(0x73f)]['trim'](), _0x5a2bd6(), _0x3369df(), _0x3881d0(_0x5849e5(0x5d3)), _0x224683('settings', _0x5849e5(0x204))) : _0x557cc6['currentAbortController'] = null); } } async function _0x335679() { const _0xea1f9c = _0x27dd8f; if (_0xea1f9c(0x6e3) === 'WjHCD') { const _0x212c57 = _0x592548[_0xea1f9c(0x549)][_0xea1f9c(0x35f)][_0xea1f9c(0x793)](_0xea1f9c(0x3fe)), _0xed39cd = _0x212c57 ? _0x1dc455[_0xea1f9c(0x73f)] : null; let _0x2335a4 = null, _0x1522e0 = ''; if (_0x212c57 && _0xed39cd) { _0x2335a4 = _0x557cc6[_0xea1f9c(0x46d)][_0xea1f9c(0x4d1)](_0x450c99 => _0x450c99[_0xea1f9c(0x516)] === 'private' && _0x450c99[_0xea1f9c(0x765)][_0xea1f9c(0x158)](_0xed39cd)); const _0x4801b8 = _0x3132c6(_0xed39cd); _0x1522e0 = _0x4801b8 ? _0x4801b8[_0xea1f9c(0x293)] : _0xea1f9c(0x7ab); } else { if (_0x557cc6['activeChatId']) { _0x2335a4 = _0x5db7d2(); const _0x21d091 = document['getElementById']('char-name-header')['textContent']; _0x1522e0 = _0x21d091 || _0xea1f9c(0x103); } } if (!_0x2335a4) { if (_0xea1f9c(0x61d) === _0xea1f9c(0x61d)) { _0x599dea('找不到要清空的聊天记录。'); return; } else _0x969501[_0xea1f9c(0x2d0)] = _0x79ec02[_0xea1f9c(0x293)] || _0xea1f9c(0x4bc) + _0x41e1d6[_0xea1f9c(0x765)][_0xea1f9c(0x7a6)] + ')'; } const _0xe77b0b = await _0x4512da('确定要清空\x22' + _0x1522e0 + _0xea1f9c(0x3f7)); if (!_0xe77b0b) return; _0x2335a4['id'] === _0x557cc6[_0xea1f9c(0x589)] && (_0x57f4b3(), _0x557cc6['conversationHistory'] = [], _0x2292d9()); try { localStorage[_0xea1f9c(0x17f)](_0xea1f9c(0x1cb) + _0x2335a4['id']); } catch (_0x59f91d) { console[_0xea1f9c(0x50e)](_0xea1f9c(0x33c) + _0x2335a4['id'], _0x59f91d); } _0x599dea('\x22' + _0x1522e0 + _0xea1f9c(0x20a)); } else _0x148807[_0xea1f9c(0x5b7)]('music-screen')['style'][_0xea1f9c(0x6a0)](_0xea1f9c(0x3b1), 'none'); } const _0x51b616 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x41f)), _0x3a17b1 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x7ec)), _0x4d3cac = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x699)); _0x51b616[_0x27dd8f(0x572)](_0x27dd8f(0x66b), async () => { const _0x25fbb3 = _0x27dd8f; if (_0x25fbb3(0xbd) !== 'EEiFq') { const _0x217b8e = _0x4110df[_0x25fbb3(0x5ba)](_0x25fbb3(0x5e9)); _0x217b8e['value'] = _0x25268f['id'], _0x217b8e[_0x25fbb3(0x2d0)] = _0x57ae48['name'], _0x426bb4['appendChild'](_0x217b8e); } else { _0x2158b6(!![], '正在打包数据，请稍候...'); const _0x5808fb = []; try { const _0x35e0e9 = { 'localStorageData': {}, 'indexedDBData': {}, 'indexedDBMusicData': [] }; for (let _0x225325 = 0x0; _0x225325 < localStorage['length']; _0x225325++) { if (_0x25fbb3(0x2a7) === _0x25fbb3(0x283)) { const _0x3a81f4 = _0x46096f[_0x25fbb3(0x5b7)]('modal-root'), _0xa45990 = _0x1589da['getElementById'](_0x25fbb3(0x73)), _0x234f97 = _0x4ee4e2[_0x25fbb3(0x5b7)](_0x25fbb3(0x7a0)), _0xfa5fc9 = _0x1abf51[_0x25fbb3(0x5b7)](_0x25fbb3(0x7a)), _0xa4031e = _0x1b78ed['getElementById'](_0x25fbb3(0x49e)); _0xa45990[_0x25fbb3(0x2d0)] = _0x3796fc, _0x3a81f4[_0x25fbb3(0x6ca)]['display'] = _0x25fbb3(0x177); const _0x38cea8 = _0x56a3c8 => { const _0x1d9abc = _0x25fbb3; _0x3a81f4['style'][_0x1d9abc(0x836)] = 'none', _0x234f97['onclick'] = _0xfa5fc9[_0x1d9abc(0x7bc)] = _0xa4031e[_0x1d9abc(0x7bc)] = null, _0x1c4582[_0x1d9abc(0x11e)](_0x1d9abc(0x312), _0x5cda00), _0x27152a(_0x56a3c8); }, _0x5cda00 = _0x41a4c8 => { const _0x382a92 = _0x25fbb3; if (_0x41a4c8['key'] === _0x382a92(0x1be)) _0x38cea8(![]); if (_0x41a4c8[_0x382a92(0x499)] === _0x382a92(0x62b)) _0x38cea8(!![]); }; _0x234f97[_0x25fbb3(0x7bc)] = () => _0x38cea8(!![]), _0xfa5fc9[_0x25fbb3(0x7bc)] = () => _0x38cea8(![]), _0xa4031e[_0x25fbb3(0x7bc)] = () => _0x38cea8(![]), _0x3ba806[_0x25fbb3(0x572)](_0x25fbb3(0x312), _0x5cda00); } else { const _0x2cdb99 = localStorage[_0x25fbb3(0x499)](_0x225325); if (_0x2cdb99) _0x35e0e9['localStorageData'][_0x2cdb99] = localStorage['getItem'](_0x2cdb99); } } const _0x37af1c = await _0x4a97d6, _0x539fbf = _0x37af1c[_0x25fbb3(0x70d)](_0x8cbdd5, _0x25fbb3(0x3c3)), _0x41cde0 = _0x539fbf['objectStore'](_0x8cbdd5), _0x184665 = await new Promise((_0x1ccc1b, _0x15a15b) => { const _0x50863d = _0x25fbb3, _0x5b0c39 = _0x41cde0[_0x50863d(0x775)](); _0x5b0c39[_0x50863d(0x7c8)] = () => _0x1ccc1b(_0x5b0c39[_0x50863d(0x242)]), _0x5b0c39[_0x50863d(0x3bc)] = () => _0x15a15b(_0x5b0c39[_0x50863d(0x50e)]); }); for (const _0x538e83 of _0x184665) { if (_0x538e83['blob'] instanceof Blob) try { 'ipTfc' !== _0x25fbb3(0x69c) ? (_0x542193 = _0x1c5588[_0x25fbb3(0x293)], _0x2699e4 = _0x348f00[_0x25fbb3(0x51e)]) : _0x35e0e9[_0x25fbb3(0x742)][_0x538e83['id']] = await _0x27ec3a(_0x538e83[_0x25fbb3(0x31d)]); } catch (_0x4ca50c) { if (_0x25fbb3(0x43a) !== 'SOUiR') _0x5808fb['push'](_0x538e83['id']); else { _0xb7ed30('哼，只有私聊才能进行总结，群聊那么乱怎么记！'); return; } } } const _0x380a54 = _0x37af1c['transaction'](_0x10585d, _0x25fbb3(0x3c3)), _0x23261f = _0x380a54[_0x25fbb3(0x365)](_0x10585d), _0x1483ee = await new Promise((_0x1edbac, _0x55e7c9) => { const _0x23a8cf = _0x25fbb3, _0xf3635b = _0x23261f[_0x23a8cf(0x775)](); _0xf3635b[_0x23a8cf(0x7c8)] = () => _0x1edbac(_0xf3635b[_0x23a8cf(0x242)]), _0xf3635b['onerror'] = () => _0x55e7c9(_0xf3635b[_0x23a8cf(0x50e)]); }); for (const _0xd08c2a of _0x1483ee) { if (_0x25fbb3(0x841) !== _0x25fbb3(0x24b)) { const _0x5cfb6b = { ..._0xd08c2a }; _0xd08c2a[_0x25fbb3(0x44f)] instanceof Blob && ('blpdN' === _0x25fbb3(0x22b) ? (_0x9f9721 = _0x179ebc[_0x25fbb3(0x5ba)](_0x25fbb3(0x6ca)), _0x50d8a1['id'] = _0x25fbb3(0xf8) + _0x2d58cb['id'], _0x25a03a[_0x25fbb3(0x73d)]['appendChild'](_0x456192)) : _0x5cfb6b[_0x25fbb3(0x44f)] = await _0x27ec3a(_0xd08c2a['audio'])), _0xd08c2a[_0x25fbb3(0x791)] instanceof Blob && (_0x25fbb3(0x56e) === _0x25fbb3(0x56e) ? _0x5cfb6b[_0x25fbb3(0x791)] = await _0x27ec3a(_0xd08c2a['cover']) : (_0x5caecc(), _0x39091a(![]), _0x1a382e[_0x25fbb3(0x161)] = ![])), _0x35e0e9[_0x25fbb3(0x43d)][_0x25fbb3(0x6b4)](_0x5cfb6b); } else { const _0x1b8002 = _0x1d898b(_0x3177bc); if (!_0x1b8002) return; _0x59fdcf[_0x25fbb3(0x29e)] = _0x5ce3ac; const _0x3a62e3 = _0x2d3624[_0x25fbb3(0xa8)][_0x25fbb3(0x4d1)](_0x37374d => _0x37374d[_0x25fbb3(0x27b)] === _0x341051), _0xb1b895 = _0x3a62e3 ? _0x3a62e3[_0x25fbb3(0x759)][_0x25fbb3(0x7a6)] : 0x0, _0x5a6de1 = 0x2; _0x4679a0[_0x25fbb3(0x1f6)] = _0x5435d3[_0x25fbb3(0xdc)](0x0, _0x779ae3[_0x25fbb3(0x6d0)](_0xb1b895 / _0x5a6de1) - 0x1), _0x2aa125[_0x25fbb3(0x5b7)](_0x25fbb3(0x5b5))[_0x25fbb3(0x2d0)] = _0x1b8002['name'] + _0x25fbb3(0x355), _0x14c56e(), _0x39be43('diaryView', _0x25fbb3(0x4ab)); } } const _0x3b8c3f = new Blob([JSON[_0x25fbb3(0x82f)](_0x35e0e9, null, 0x2)], { 'type': _0x25fbb3(0x6f1) }), _0x2cc95d = URL[_0x25fbb3(0x371)](_0x3b8c3f), _0x448b55 = document[_0x25fbb3(0x5ba)]('a'), _0x59b24c = new Date(), _0x297495 = _0x59b24c[_0x25fbb3(0x110)]() + '-' + String(_0x59b24c[_0x25fbb3(0x2aa)]() + 0x1)['padStart'](0x2, '0') + '-' + String(_0x59b24c[_0x25fbb3(0x65f)]())[_0x25fbb3(0x1db)](0x2, '0'); _0x448b55[_0x25fbb3(0x7e3)] = _0x2cc95d, _0x448b55[_0x25fbb3(0x240)] = _0x25fbb3(0x290) + _0x297495 + '.json', document['body'][_0x25fbb3(0x796)](_0x448b55), _0x448b55['click'](), document[_0x25fbb3(0x496)][_0x25fbb3(0x612)](_0x448b55), URL['revokeObjectURL'](_0x2cc95d), _0x2158b6(![]); if (_0x5808fb[_0x25fbb3(0x7a6)] > 0x0) { if ('MNdxe' === 'MNdxe') _0x599dea(_0x25fbb3(0x2c8) + _0x5808fb[_0x25fbb3(0x566)]('\x0a')); else { const _0x30462f = _0x396787[_0x25fbb3(0x44b)]['files'][0x0]; if (!_0x30462f) return; try { _0x44790b[_0x25fbb3(0x483)] = _0x2ac3b5[_0x25fbb3(0x371)](_0x30462f); } catch (_0x21ac5a) { _0x3e0445('图片预览失败:\x20' + _0x21ac5a[_0x25fbb3(0x832)]); } } } else _0x599dea(_0x25fbb3(0x230)); } catch (_0x2bb169) { if (_0x25fbb3(0x34f) === 'cneNA') _0x2158b6(![]), console[_0x25fbb3(0x50e)]('全量导出失败:', _0x2bb169), _0x599dea('导出过程中发生严重错误:\x20' + _0x2bb169['message']); else { const _0xe9627a = _0x548840[_0x25fbb3(0x5b7)](_0x31f86c); if (_0xe9627a && _0x15c6aa) _0xe9627a['src'] = _0x1b888c[_0x25fbb3(0x371)](_0x1f6bf9); } } } }), _0x3a17b1[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x1bd381 = _0x27dd8f; if ('JGFkx' !== _0x1bd381(0x415)) _0x4d3cac[_0x1bd381(0x66b)](); else { const _0x23691e = _0x4b0f55[_0x1bd381(0x58d)][_0x1bd381(0x4d1)](_0x5770f2 => _0x5770f2['id'] === _0x3e7b14['boundUserProfileId']) || { 'name': _0x1bd381(0x800) }, _0x268a91 = _0x500c86[_0x1bd381(0x5ba)](_0x1bd381(0x509)); _0x268a91[_0x1bd381(0x640)] = _0x1bd381(0x55d), _0x268a91[_0x1bd381(0x78)]['id'] = _0x1c151c['id'], _0x268a91['innerHTML'] = _0x1bd381(0x790) + _0x6e4f5['name'] + _0x1bd381(0x714) + _0x23691e[_0x1bd381(0x293)] + _0x1bd381(0x76a) + _0x5cc28d[_0x1bd381(0x14c)][_0x1bd381(0x7a6)] + _0x1bd381(0x413), _0x268a91[_0x1bd381(0x572)]('click', () => _0x22193d(_0x3951da['id'])), _0x4ab29d[_0x1bd381(0x796)](_0x268a91); } }), _0x40a226['addEventListener'](_0x27dd8f(0x66b), _0x468f25), _0x4d3cac['addEventListener'](_0x27dd8f(0x265), _0x34c583 => { const _0x1815d5 = _0x27dd8f; if (_0x1815d5(0x3b5) === _0x1815d5(0x3b5)) { const _0x1f9381 = _0x34c583[_0x1815d5(0x44b)][_0x1815d5(0x209)][0x0]; if (!_0x1f9381) return; _0x4512da(_0x1815d5(0x74c))[_0x1815d5(0x192)](_0x178dbc => { const _0x1292be = _0x1815d5; if (!_0x178dbc) { _0x4d3cac['value'] = ''; return; } _0x2158b6(!![], '正在解析备份文件...'); const _0x583a66 = new FileReader(); _0x583a66[_0x1292be(0x38d)] = async _0x37dd1c => { const _0x4d7eec = _0x1292be; if ('vWwpG' === _0x4d7eec(0x54f)) try { const _0x293e3b = JSON['parse'](_0x37dd1c['target'][_0x4d7eec(0x242)]); if (!_0x293e3b[_0x4d7eec(0x1e3)] || !_0x293e3b[_0x4d7eec(0x742)]) throw new Error(_0x4d7eec(0x75a)); _0x2158b6(!![], _0x4d7eec(0x736)); const _0x500d10 = await Promise[_0x4d7eec(0x437)](Object[_0x4d7eec(0x41b)](_0x293e3b['indexedDBData'])[_0x4d7eec(0x30e)](async _0x491e17 => { const _0x552cf3 = _0x4d7eec; if (_0x552cf3(0x54b) !== _0x552cf3(0x54b)) { const _0x181ce0 = _0x126f61[_0x552cf3(0x5b7)]('pending-post-image-preview'); _0x181ce0 && _0x1d060b && (_0x181ce0['src'] = _0x179361['createObjectURL'](_0x12dea1)); } else { const _0x173498 = _0x293e3b['indexedDBData'][_0x491e17]; if (typeof _0x173498 === _0x552cf3(0x286) && _0x173498[_0x552cf3(0x795)](_0x552cf3(0x587))) { const _0x3fa001 = await _0x57a56e(_0x173498); return { 'id': _0x491e17, 'blob': _0x3fa001 }; } return null; } }))['then'](_0x187504 => _0x187504[_0x4d7eec(0x1d8)](Boolean)), _0x1d836a = []; if (_0x293e3b[_0x4d7eec(0x43d)]) { if ('Qivat' !== _0x4d7eec(0x631)) _0x506c72(_0x4814d9[_0x4d7eec(0x243)], _0x139b5a['emotion']); else { _0x2158b6(!![], '正在准备音乐数据...'); const _0x1cf27b = _0x293e3b[_0x4d7eec(0x43d)]['map'](async _0x48627f => { const _0x46fb04 = _0x4d7eec; if (_0x46fb04(0x185) === _0x46fb04(0x185)) { const _0x58ec5f = { ..._0x48627f }; if (_0x48627f[_0x46fb04(0x44f)]) _0x58ec5f[_0x46fb04(0x44f)] = await _0x57a56e(_0x48627f[_0x46fb04(0x44f)]); if (_0x48627f[_0x46fb04(0x791)]) _0x58ec5f[_0x46fb04(0x791)] = await _0x57a56e(_0x48627f[_0x46fb04(0x791)]); return _0x58ec5f; } else { const _0x46f4d2 = _0x1a5ae2[_0x46fb04(0x46d)][_0x46fb04(0x4d1)](_0x3c0e91 => _0x3c0e91['id'] === _0x377512), _0x56eb9e = _0x46f4d2?.['boundUserProfileId']; let _0x235ef8 = _0x3544bc[_0x46fb04(0x58d)][_0x46fb04(0x4d1)](_0x3e8661 => _0x3e8661['id'] === _0x56eb9e); return !_0x235ef8 && (_0x235ef8 = _0x2f76bc[_0x46fb04(0x58d)][_0x46fb04(0x4d1)](_0x2aaa37 => _0x2aaa37['id'] === _0x57cf11[_0x46fb04(0x26a)]) || _0x485ef9[_0x46fb04(0x58d)][0x0]), _0x235ef8 || { 'name': '用户', 'avatar': _0x3aa42c, 'persona': '' }; } }); _0x1d836a['push'](...await Promise[_0x4d7eec(0x437)](_0x1cf27b)); } } _0x2158b6(!![], _0x4d7eec(0x245)), localStorage[_0x4d7eec(0x198)](); for (const _0x48fdd2 in _0x293e3b[_0x4d7eec(0x1e3)]) { localStorage[_0x4d7eec(0x69e)](_0x48fdd2, _0x293e3b[_0x4d7eec(0x1e3)][_0x48fdd2]); } _0x2158b6(!![], _0x4d7eec(0x207)); const _0x1d6b0b = await _0x4a97d6, _0x457478 = _0x1d6b0b[_0x4d7eec(0x70d)]([_0x8cbdd5, _0x10585d], _0x4d7eec(0x478)), _0x565306 = _0x457478[_0x4d7eec(0x365)](_0x8cbdd5), _0x1b3634 = _0x457478[_0x4d7eec(0x365)](_0x10585d); _0x565306[_0x4d7eec(0x198)](), _0x1b3634[_0x4d7eec(0x198)](), _0x500d10['forEach'](_0x165ba8 => _0x565306['put'](_0x165ba8)), _0x1d836a[_0x4d7eec(0x302)](_0x1eba9f => _0x1b3634[_0x4d7eec(0x5e8)](_0x1eba9f)), await new Promise((_0x212f99, _0x5639a3) => { const _0x178677 = _0x4d7eec; _0x457478[_0x178677(0x3e2)] = _0x212f99, _0x457478[_0x178677(0x3bc)] = _0x473bc5 => _0x5639a3(_0x473bc5['target'][_0x178677(0x50e)]); }), _0x2158b6(![]), _0x599dea(_0x4d7eec(0x510)), setTimeout(() => location['reload'](), 0x640); } catch (_0xc08d37) { if (_0x4d7eec(0x625) === 'vTpHP') _0x2158b6(![]), console['error']('全量导入失败:', _0xc08d37), _0x599dea(_0x4d7eec(0x79) + _0xc08d37[_0x4d7eec(0x832)]); else return { 'type': 'sticker', 'name': _0x615baa[0x1][_0x4d7eec(0xf2)]() }; } finally { _0x4d3cac[_0x4d7eec(0x73f)] = ''; } else { const _0x27064f = _0xdfee3d ?? _0x5ba4e4[_0x4d7eec(0x73f)][_0x4d7eec(0xf2)](); if (_0x27064f === '' || !_0x196165['activeChatId']) return; const _0x5d3f14 = _0x88086e['querySelector'](_0x4d7eec(0x486)), _0x4e79ad = _0x5d3f14['id'] === 'meeting-view-screen', _0x3b2b58 = { 'role': 'user', 'content': _0x27064f, 'timestamp': _0x4bb821[_0x4d7eec(0x183)](), 'isOffline': _0x4e79ad }; _0x4c5c41[_0x4d7eec(0x443)] && (_0x3b2b58['quotedMessage'] = { ..._0x5eac6a[_0x4d7eec(0x443)] }), _0x82de40[_0x4d7eec(0x5b8)][_0x4d7eec(0x6b4)](_0x3b2b58), _0x598585(), _0x381a8b(), !_0x4b5f2a && (_0x416f82['value'] = ''), _0x5b4a80(); } }, _0x583a66[_0x1292be(0x822)](_0x1f9381); }); } else { _0x119dd8(_0x1815d5(0x757)); return; } }); function _0x48e22b() { const _0x172b63 = _0x27dd8f; if (_0x172b63(0x34b) === 'sWVoy') _0x4d2704[_0x172b63(0x73f)] = _0x557cc6[_0x172b63(0x170)][_0x172b63(0x222)] || '', _0xd9cc63[_0x172b63(0x73f)] = _0x557cc6[_0x172b63(0x170)]['key'] || '', _0x989438[_0x172b63(0x73f)] = _0x557cc6[_0x172b63(0x170)][_0x172b63(0x5c0)] || '', _0x212890[_0x172b63(0x73f)] = String(_0x557cc6[_0x172b63(0x4c2)]?.[_0x172b63(0x521)] ?? 0x64), document[_0x172b63(0x5b7)]('api-provider')['value'] = _0x557cc6[_0x172b63(0x170)]['provider'] || 'openai'; else { const _0x2c3c4f = _0x2f8cc8[_0x172b63(0x417)](_0x1958c6); _0x5bb716['isArray'](_0x2c3c4f) && (_0x4a5b00 = _0x2c3c4f[_0x172b63(0x1d8)](_0x478146 => _0x478146 && typeof _0x478146 === 'object' && typeof _0x478146[_0x172b63(0x7b4)] === _0x172b63(0x286) && typeof _0x478146[_0x172b63(0x398)] !== _0x172b63(0x71f))); } } function _0x315a34() { const _0x3d687c = _0x27dd8f; _0x557cc6[_0x3d687c(0x170)]['endpoint'] = _0x4d2704[_0x3d687c(0x73f)]['trim'](), _0x557cc6['apiSettings']['key'] = _0xd9cc63[_0x3d687c(0x73f)][_0x3d687c(0xf2)](), _0x557cc6[_0x3d687c(0x170)]['model'] = _0x989438['value'][_0x3d687c(0xf2)](), _0x557cc6[_0x3d687c(0x170)][_0x3d687c(0x2b3)] = document[_0x3d687c(0x5b7)](_0x3d687c(0x522))[_0x3d687c(0x73f)]; const _0xca66aa = parseInt(_0x212890[_0x3d687c(0x73f)], 0xa); _0x557cc6[_0x3d687c(0x4c2)]['perChatContextLines'] = Number[_0x3d687c(0x232)](_0xca66aa) && _0xca66aa > 0x0 ? _0xca66aa : 0x64, _0x162000(), _0x599dea(_0x3d687c(0x294)); } function _0x4dcf8c() { const _0x54fa98 = _0x27dd8f; if ('iGPPa' === _0x54fa98(0x16a)) _0x2f4f50[_0x54fa98(0x73f)] = _0x557cc6[_0x54fa98(0x204)][_0x54fa98(0x293)] || '', _0x1257f2[_0x54fa98(0x483)] = _0x557cc6[_0x54fa98(0x204)]['avatar'] || _0x3b11bb, _0x49060f['value'] = _0x557cc6[_0x54fa98(0x204)][_0x54fa98(0x6f2)] || ''; else { _0x2dfd85(_0x54fa98(0x1dc)); return; } } function _0x2290e0() { const _0x3bef50 = _0x27dd8f; _0x557cc6[_0x3bef50(0x204)][_0x3bef50(0x293)] = _0x2f4f50[_0x3bef50(0x73f)][_0x3bef50(0xf2)](), _0x557cc6['userProfile'][_0x3bef50(0x6f2)] = _0x49060f[_0x3bef50(0x73f)][_0x3bef50(0xf2)](), _0x162000(), _0x2292d9(), _0x599dea(_0x3bef50(0x5d3)), _0x4f27ca(_0x3bef50(0x60f), _0x3bef50(0x204)); } async function _0x3de8df(_0x88c02b = null) { const _0x5a8195 = _0x27dd8f, _0x95ae49 = _0x42deec; _0x4f27ca('characterEdit', _0x95ae49); const _0x505067 = document[_0x5a8195(0x5b7)](_0x5a8195(0x523)); _0x505067[_0x5a8195(0x7a2)] = '', _0x557cc6[_0x5a8195(0x694)][_0x5a8195(0x302)](_0x4dd9b0 => { const _0x1fcf3f = _0x5a8195; if (_0x1fcf3f(0x447) !== 'QKXGy') { const _0x44e1c2 = document['createElement'](_0x1fcf3f(0x28b)); _0x44e1c2['innerHTML'] = '<input\x20type=\x22checkbox\x22\x20value=\x22' + _0x4dd9b0['id'] + _0x1fcf3f(0x6a3) + _0x4dd9b0[_0x1fcf3f(0x293)], _0x505067[_0x1fcf3f(0x796)](_0x44e1c2); } else _0xb64a02[_0x3f1767][_0x1fcf3f(0x35f)][_0x1fcf3f(0x7ff)]('filled'), _0x432206[_0x30f338][_0x1fcf3f(0x73f)] = ''; }), _0x220a06(_0x5a8195(0x276)), _0x58419f['src'] = '', _0x52fff2[_0x5a8195(0x73f)] = '', _0x5bc519[_0x5a8195(0x483)] = '', _0x4ef4f1[_0x5a8195(0x73f)] = '', _0x4fd94f['src'] = '', _0x32746f[_0x5a8195(0x73f)] = ''; const _0x47edef = [_0x5a8195(0x343), _0x5a8195(0x703), _0x5a8195(0xb5), _0x5a8195(0x280), _0x5a8195(0x495)]; _0x47edef['forEach'](_0x2183c5 => { const _0xd5b2ce = _0x5a8195; _0xd5b2ce(0x12f) === _0xd5b2ce(0x12f) ? (document[_0xd5b2ce(0x5b7)]('char-edit-sprite-' + _0x2183c5 + _0xd5b2ce(0x5f4))[_0xd5b2ce(0x483)] = '', document[_0xd5b2ce(0x5b7)](_0xd5b2ce(0x98) + _0x2183c5 + _0xd5b2ce(0x219))['value'] = '') : _0x3232dd[_0xd5b2ce(0x2a8)](); }); if (_0x88c02b) { if (_0x5a8195(0x325) === 'MRvxF') { _0xbe88ed['value'] = '#\x20记录是空的，没什么好总结的。'; return; } else { const _0x35391f = _0x557cc6[_0x5a8195(0x618)][_0x5a8195(0x4d1)](_0x4f89ef => _0x4f89ef['id'] === _0x88c02b); if (!_0x35391f) return; _0x1dc455[_0x5a8195(0x73f)] = _0x35391f['id'], _0x2f4e4a[_0x5a8195(0x2d0)] = '编辑角色', _0x4104b8[_0x5a8195(0x73f)] = _0x35391f[_0x5a8195(0x293)], _0x26c582[_0x5a8195(0x73f)] = _0x35391f['remark'], _0x3d8f26[_0x5a8195(0x73f)] = _0x35391f['persona'], document['getElementById'](_0x5a8195(0x4bd))[_0x5a8195(0x73f)] = _0x35391f[_0x5a8195(0x173)] || ''; const _0x24d51d = _0x557cc6['chats']['find'](_0x2f1203 => _0x2f1203['type'] === _0x5a8195(0x405) && _0x2f1203[_0x5a8195(0x765)][_0x5a8195(0x158)](_0x88c02b)); document[_0x5a8195(0x5b7)](_0x5a8195(0x276))[_0x5a8195(0x73f)] = _0x24d51d?.['boundUserProfileId'] || _0x557cc6[_0x5a8195(0x26a)]; try { const _0x47768e = await _0x2aeef5(_0x5a8195(0x72c) + _0x35391f['id']), _0x580aea = await _0x2aeef5(_0x5a8195(0x281) + _0x35391f['id']), _0x45accd = await _0x2aeef5(_0x5a8195(0x66e) + _0x35391f['id']); _0x58419f['src'] = _0x47768e ? URL[_0x5a8195(0x371)](_0x47768e) : _0x35391f[_0x5a8195(0x51e)] || _0x1732e7; if (_0x580aea) _0x5bc519[_0x5a8195(0x483)] = URL[_0x5a8195(0x371)](_0x580aea); if (_0x45accd) _0x4fd94f[_0x5a8195(0x483)] = URL[_0x5a8195(0x371)](_0x45accd); for (const _0x466d4b of _0x47edef) { const _0x441c75 = await _0x2aeef5(_0x5a8195(0x63f) + _0x466d4b + '_' + _0x35391f['id']); _0x441c75 && (document[_0x5a8195(0x5b7)]('char-edit-sprite-' + _0x466d4b + _0x5a8195(0x5f4))[_0x5a8195(0x483)] = URL[_0x5a8195(0x371)](_0x441c75)); } } catch (_0x99d28a) { console[_0x5a8195(0x50e)](_0x5a8195(0x3e1) + _0x35391f['id'] + _0x5a8195(0x1e8), _0x99d28a), _0x58419f[_0x5a8195(0x483)] = _0x35391f[_0x5a8195(0x51e)] || _0x1732e7; } _0x35391f[_0x5a8195(0x674)] && _0x505067[_0x5a8195(0x687)](_0x5a8195(0x345))[_0x5a8195(0x302)](_0x471987 => { const _0x5cf488 = _0x5a8195; if (_0x35391f[_0x5cf488(0x674)][_0x5cf488(0x158)](_0x471987[_0x5cf488(0x73f)])) _0x471987[_0x5cf488(0x1c8)] = !![]; }), _0x119365(); } } else _0x1dc455[_0x5a8195(0x73f)] = '', _0x2f4e4a[_0x5a8195(0x2d0)] = _0x5a8195(0x696), _0x4104b8[_0x5a8195(0x73f)] = _0x5a8195(0x3db) + (_0x557cc6[_0x5a8195(0x618)][_0x5a8195(0x7a6)] + 0x1), _0x26c582['value'] = '', _0x58419f[_0x5a8195(0x483)] = _0x1732e7, _0x3d8f26[_0x5a8195(0x73f)] = '你是一个乐于助人的AI助手。', document['getElementById'](_0x5a8195(0x4bd))[_0x5a8195(0x73f)] = '', _0x119365(); const _0x375602 = document[_0x5a8195(0x5b7)]('char-edit-css'); let _0x6afdd5 = document[_0x5a8195(0x5b7)]('live-preview-style'); if (!_0x6afdd5) { if ('siwiG' !== 'Ilptg') _0x6afdd5 = document[_0x5a8195(0x5ba)](_0x5a8195(0x6ca)), _0x6afdd5['id'] = _0x5a8195(0x825), document[_0x5a8195(0x73d)][_0x5a8195(0x796)](_0x6afdd5); else { const _0x2b6cb2 = _0x308c9a[_0x5a8195(0x5b7)](_0x5a8195(0x5ac)); if (!_0x2b6cb2) return; const _0xe05df0 = _0xc070c3[_0x5a8195(0x426)]('themeLightness') || '80'; _0x15f7df[_0x5a8195(0x78c)]['style'][_0x5a8195(0x6a0)](_0x5a8195(0x306), _0xe05df0 + '%'), _0x2b6cb2['value'] = _0xe05df0, _0x2b6cb2[_0x5a8195(0x572)](_0x5a8195(0x7d4), () => { const _0xf014c4 = _0x5a8195, _0x2a66b2 = _0x2b6cb2['value']; _0x63ef07['documentElement']['style']['setProperty'](_0xf014c4(0x306), _0x2a66b2 + '%'), _0x2ac577[_0xf014c4(0x69e)]('themeLightness', _0x2a66b2), _0x3a7b89(); }); } } const _0x547373 = () => { const _0x3cb35b = _0x5a8195, _0x49002e = _0x375602['value']; let _0x989abb = _0x49002e[_0x3cb35b(0x4f8)](/\.bubble\.sent/g, '#bubble-preview-user')['replace'](/\.bubble\.received/g, _0x3cb35b(0x677)); _0x6afdd5['innerHTML'] = _0x989abb; }; _0x375602[_0x5a8195(0x11e)](_0x5a8195(0x7d4), _0x547373), _0x375602[_0x5a8195(0x572)](_0x5a8195(0x7d4), _0x547373), _0x547373(); } async function _0x140581() { const _0x5c04a7 = _0x27dd8f, _0x4ebe64 = _0x1dc455[_0x5c04a7(0x73f)]; if (!_0x4ebe64) { _0x599dea(_0x5c04a7(0x757)); return; } const _0x50de0f = _0x3132c6(_0x4ebe64); if (!_0x50de0f) return; _0x2158b6(!![], _0x5c04a7(0x2fb) + _0x50de0f[_0x5c04a7(0x293)] + _0x5c04a7(0x675)); try { if ('SWlYq' === _0x5c04a7(0x5fd)) _0x288d4c['error'](_0x5c04a7(0x33f), _0x5b1b92), _0x488d24[_0x5c04a7(0x516)] = 'text'; else { const _0x3caf77 = { 'type': _0x5c04a7(0x593), 'version': 0x1, 'name': _0x50de0f[_0x5c04a7(0x293)], 'remark': _0x50de0f[_0x5c04a7(0x5aa)], 'persona': _0x50de0f[_0x5c04a7(0x6f2)], 'bubbleCss': _0x50de0f[_0x5c04a7(0x173)], 'avatar': null, 'sprites': {}, 'worldBooks': [] }, _0x2d1378 = await _0x2aeef5('char_avatar_' + _0x50de0f['id']); if (_0x2d1378) _0x3caf77['avatar'] = await _0x27ec3a(_0x2d1378); const _0x4c23cd = [_0x5c04a7(0x343), 'happy', 'angry', 'sad', _0x5c04a7(0x495)]; for (const _0x2260c4 of _0x4c23cd) { const _0x73e41b = await _0x2aeef5(_0x5c04a7(0x63f) + _0x2260c4 + '_' + _0x50de0f['id']); _0x73e41b && (_0x3caf77[_0x5c04a7(0x497)][_0x2260c4] = await _0x27ec3a(_0x73e41b)); } _0x50de0f[_0x5c04a7(0x674)] && _0x50de0f['linkedWorldBookIds']['length'] > 0x0 && (_0x3caf77[_0x5c04a7(0x694)] = _0x50de0f[_0x5c04a7(0x674)][_0x5c04a7(0x30e)](_0x41ede4 => _0x557cc6[_0x5c04a7(0x694)][_0x5c04a7(0x4d1)](_0x5810e2 => _0x5810e2['id'] === _0x41ede4))[_0x5c04a7(0x1d8)](Boolean)[_0x5c04a7(0x30e)](_0x251ac9 => ({ 'name': _0x251ac9['name'], 'content': _0x251ac9['content'] }))); const _0x3e22a6 = new Blob([JSON[_0x5c04a7(0x82f)](_0x3caf77, null, 0x2)], { 'type': _0x5c04a7(0x6f1) }), _0x3703b7 = URL[_0x5c04a7(0x371)](_0x3e22a6), _0x4fc629 = document['createElement']('a'); _0x4fc629[_0x5c04a7(0x7e3)] = _0x3703b7, _0x4fc629[_0x5c04a7(0x240)] = _0x50de0f[_0x5c04a7(0x293)] + _0x5c04a7(0x617), document[_0x5c04a7(0x496)][_0x5c04a7(0x796)](_0x4fc629), _0x4fc629[_0x5c04a7(0x66b)](), document[_0x5c04a7(0x496)]['removeChild'](_0x4fc629), URL[_0x5c04a7(0x29b)](_0x3703b7); } } catch (_0x4b36c2) { console[_0x5c04a7(0x50e)](_0x5c04a7(0x638), _0x4b36c2), _0x599dea(_0x5c04a7(0x1a0) + _0x4b36c2[_0x5c04a7(0x832)]); } finally { _0x2158b6(![]); } } async function _0x2ed1d1(_0x14d22b) { const _0x1add9d = _0x27dd8f; if ('asHJk' !== 'tJUsx') { const _0x1e9a63 = _0x14d22b['target']['files'][0x0]; if (!_0x1e9a63) return; _0x2158b6(!![], _0x1add9d(0x2d5)); const _0x2e99db = new FileReader(); _0x2e99db[_0x1add9d(0x38d)] = async _0x314545 => { const _0x45dfaf = _0x1add9d; try { const _0x28132f = JSON[_0x45dfaf(0x417)](_0x314545[_0x45dfaf(0x44b)][_0x45dfaf(0x242)]); if (_0x28132f[_0x45dfaf(0x516)] !== _0x45dfaf(0x593)) { if (_0x45dfaf(0x591) === _0x45dfaf(0x591)) throw new Error('这不是一张有效的Noir角色卡。'); else { if (_0x2060d2[_0x45dfaf(0x7b4)] === _0x45dfaf(0x472) && _0x1187eb['image']) return { 'role': _0x45dfaf(0x472), 'content': [{ 'type': _0x45dfaf(0x68e), 'text': _0x2c8f8a['content'] || '\x20' }, { 'type': _0x45dfaf(0x2a0), 'image_url': { 'url': _0x3721e5[_0x45dfaf(0x690)], 'detail': 'high' } }] }; return { 'role': _0x1c639b[_0x45dfaf(0x7b4)], 'content': _0x297278[_0x45dfaf(0x398)] }; } } const _0x21a349 = []; if (_0x28132f[_0x45dfaf(0x694)] && _0x28132f[_0x45dfaf(0x694)]['length'] > 0x0) for (const _0x441373 of _0x28132f[_0x45dfaf(0x694)]) { let _0x500412 = _0x557cc6[_0x45dfaf(0x694)]['find'](_0x500808 => _0x500808[_0x45dfaf(0x293)] === _0x441373[_0x45dfaf(0x293)]); if (_0x500412) _0x45dfaf(0x7b8) !== 'MJNfc' ? (_0x5c28d0 = '0x' + _0x428539[0x1] + _0x150db6[0x1], _0x189181 = '0x' + _0x5813ae[0x2] + _0x3d2008[0x2], _0x24124c = '0x' + _0x24fc26[0x3] + _0x174640[0x3]) : _0x21a349[_0x45dfaf(0x6b4)](_0x500412['id']); else { const _0x244e7c = { 'id': _0x45dfaf(0x42c) + Date['now']() + '_' + Math['random'](), 'name': _0x441373[_0x45dfaf(0x293)], 'content': _0x441373[_0x45dfaf(0x398)] }; _0x557cc6[_0x45dfaf(0x694)][_0x45dfaf(0x6b4)](_0x244e7c), _0x21a349[_0x45dfaf(0x6b4)](_0x244e7c['id']); } } const _0x1b9f53 = _0x45dfaf(0x7b2) + Date[_0x45dfaf(0x183)](), _0xaa4338 = { 'id': _0x1b9f53, 'name': _0x28132f[_0x45dfaf(0x293)], 'remark': _0x28132f['remark'] || '', 'persona': _0x28132f[_0x45dfaf(0x6f2)], 'avatar': _0x28132f[_0x45dfaf(0x51e)] || _0x1732e7, 'linkedWorldBookIds': _0x21a349, 'bubbleCss': _0x28132f[_0x45dfaf(0x173)] || '' }; if (_0x28132f[_0x45dfaf(0x51e)]) { const _0x1e5e53 = await _0x57a56e(_0x28132f[_0x45dfaf(0x51e)]); await _0x3aff46(_0x45dfaf(0x72c) + _0x1b9f53, _0x1e5e53); } if (_0x28132f[_0x45dfaf(0x497)]) for (const _0x5a8475 in _0x28132f[_0x45dfaf(0x497)]) { const _0x1e9e0d = _0x28132f[_0x45dfaf(0x497)][_0x5a8475], _0x4458d7 = await _0x57a56e(_0x1e9e0d); await _0x3aff46(_0x45dfaf(0x63f) + _0x5a8475 + '_' + _0x1b9f53, _0x4458d7); } _0x557cc6[_0x45dfaf(0x618)]['push'](_0xaa4338); const _0x1906bc = { 'id': _0x45dfaf(0x6ba) + _0x1b9f53, 'type': _0x45dfaf(0x405), 'participantIds': [_0x1b9f53], 'boundUserProfileId': _0x557cc6[_0x45dfaf(0x26a)] }; _0x557cc6[_0x45dfaf(0x46d)][_0x45dfaf(0x6b4)](_0x1906bc), _0x162000(), _0x18d2c5(), _0x599dea('“' + _0xaa4338[_0x45dfaf(0x293)] + _0x45dfaf(0x342)); } catch (_0x175338) { _0x45dfaf(0x3df) !== _0x45dfaf(0x3df) ? _0x42b3ec(_0x45dfaf(0x397) + _0x25265a[_0x45dfaf(0x832)]) : (console['error'](_0x45dfaf(0x358), _0x175338), _0x599dea('导入失败了，笨蛋:\x20' + _0x175338[_0x45dfaf(0x832)])); } finally { _0x2158b6(![]), _0x14d22b[_0x45dfaf(0x44b)][_0x45dfaf(0x73f)] = ''; } }, _0x2e99db['readAsText'](_0x1e9a63); } else _0x67f3df[_0x1add9d(0xb8)] && _0xb623a6[_0x1add9d(0xb8)][_0x1add9d(0x6be)] === _0x39af0e && (_0x1f0e68[_0x1add9d(0xb8)] = null); } async function _0x560d0d() { const _0x55b2ff = _0x27dd8f; if ('gxaWq' === _0x55b2ff(0x840)) _0x832424[_0x55b2ff(0x50e)](_0x55b2ff(0x1b4) + _0x39375b + ':', _0x596247), _0x5b433d[_0x55b2ff(0x6ca)]['backgroundImage'] = 'none'; else { const _0x24c774 = _0x1dc455[_0x55b2ff(0x73f)]; let _0x14ebe7 = null; const _0x4ba125 = _0x52fff2[_0x55b2ff(0x209)][0x0], _0xd1d70c = _0x4ef4f1[_0x55b2ff(0x209)][0x0], _0x4274e0 = _0x32746f[_0x55b2ff(0x209)][0x0], _0xd08b6c = document[_0x55b2ff(0x687)]('#world-book-checkboxes-container\x20input:checked'), _0x3d96ff = Array[_0x55b2ff(0x652)](_0xd08b6c)['map'](_0x49caac => _0x49caac[_0x55b2ff(0x73f)]), _0x46ba03 = { 'name': _0x4104b8[_0x55b2ff(0x73f)]['trim'](), 'remark': _0x26c582[_0x55b2ff(0x73f)][_0x55b2ff(0xf2)](), 'persona': _0x3d8f26['value'][_0x55b2ff(0xf2)](), 'linkedWorldBookIds': _0x3d96ff, 'boundUserProfileId': document[_0x55b2ff(0x5b7)](_0x55b2ff(0x276))[_0x55b2ff(0x73f)], 'bubbleCss': document[_0x55b2ff(0x5b7)](_0x55b2ff(0x4bd))[_0x55b2ff(0x73f)][_0x55b2ff(0xf2)]() }; if (!_0x46ba03[_0x55b2ff(0x293)]) { if (_0x55b2ff(0xa4) === _0x55b2ff(0x1b2)) _0x3df3a1(![]); else { _0x599dea('名字不能为空！'); return; } } try { if (_0x55b2ff(0x622) !== _0x55b2ff(0x622)) _0x32d77a[_0x55b2ff(0x4c2)]['widgetBgImage'] = null, _0x358713(), _0x2a0e09(), _0x4fc4db('小组件背景已恢复默认。'); else { const _0xfb7eb = [_0x55b2ff(0x343), 'happy', _0x55b2ff(0xb5), _0x55b2ff(0x280), _0x55b2ff(0x495)]; if (_0x24c774) { const _0xfbb577 = _0x557cc6[_0x55b2ff(0x618)]['find'](_0x44ef63 => _0x44ef63['id'] === _0x24c774); if (_0xfbb577) { Object[_0x55b2ff(0x70a)](_0xfbb577, _0x46ba03); if (_0x4ba125) _0xfbb577[_0x55b2ff(0x51e)] = await _0x4889cd(_0x4ba125); } if (_0x4ba125) await _0x3aff46(_0x55b2ff(0x72c) + _0x24c774, _0x4ba125); if (_0xd1d70c) await _0x3aff46(_0x55b2ff(0x281) + _0x24c774, _0xd1d70c); if (_0x4274e0) await _0x3aff46(_0x55b2ff(0x66e) + _0x24c774, _0x4274e0); for (const _0x5ac7fe of _0xfb7eb) { const _0x15cead = document['getElementById'](_0x55b2ff(0x98) + _0x5ac7fe + _0x55b2ff(0x219))[_0x55b2ff(0x209)][0x0]; if (_0x15cead) await _0x3aff46(_0x55b2ff(0x63f) + _0x5ac7fe + '_' + _0x24c774, _0x15cead); } } else { _0x14ebe7 = _0x55b2ff(0x7b2) + Date[_0x55b2ff(0x183)](); const _0x32319e = { 'id': _0x14ebe7, ..._0x46ba03 }; _0x32319e[_0x55b2ff(0x51e)] = _0x4ba125 ? await _0x4889cd(_0x4ba125) : _0x1732e7, _0x557cc6[_0x55b2ff(0x618)][_0x55b2ff(0x6b4)](_0x32319e); const _0x203b6c = { 'id': _0x55b2ff(0x6ba) + _0x14ebe7, 'type': _0x55b2ff(0x405), 'participantIds': [_0x14ebe7], 'boundUserProfileId': _0x46ba03['boundUserProfileId'], 'listenTogetherSession': null }; _0x557cc6[_0x55b2ff(0x46d)]['push'](_0x203b6c); if (_0x4ba125) await _0x3aff46(_0x55b2ff(0x72c) + _0x14ebe7, _0x4ba125); if (_0xd1d70c) await _0x3aff46(_0x55b2ff(0x281) + _0x14ebe7, _0xd1d70c); if (_0x4274e0) await _0x3aff46('char_offline_bg_' + _0x14ebe7, _0x4274e0); for (const _0x4606bf of _0xfb7eb) { const _0x146cb6 = document[_0x55b2ff(0x5b7)](_0x55b2ff(0x98) + _0x4606bf + _0x55b2ff(0x219))[_0x55b2ff(0x209)][0x0]; if (_0x146cb6) await _0x3aff46(_0x55b2ff(0x63f) + _0x4606bf + '_' + _0x14ebe7, _0x146cb6); } } _0x162000(), _0x18d2c5(), _0x599dea(_0x55b2ff(0x16e)), _0x4f27ca(_0x55b2ff(0x827), 'characterEdit'); if (!_0x24c774) { const _0xbcc5ce = _0x55b2ff(0x6ba) + _0x14ebe7; _0xe92c95(_0xbcc5ce), _0x1f1930(!![]); } } } catch (_0x1463ca) { _0x55b2ff(0x1f0) === _0x55b2ff(0x1f0) ? (console['error'](_0x55b2ff(0x197), _0x1463ca), _0x599dea('保存失败:\x20' + _0x1463ca[_0x55b2ff(0x832)])) : (_0x557bf4(![]), _0x260be8[_0x55b2ff(0x161)] = ![]); } } } function _0x31f7b7() { const _0x13fb49 = _0x27dd8f; _0x397a39[_0x13fb49(0x73f)] = '', _0x2aac92[_0x13fb49(0x7a2)] = ''; if (_0x557cc6[_0x13fb49(0x618)][_0x13fb49(0x7a6)] < 0x2) { if ('yecdT' === 'yecdT') { _0x599dea('需要至少2个角色才能创建群聊。'); return; } else _0xd746c7(_0x13fb49(0x4f2)); } _0x557cc6[_0x13fb49(0x618)][_0x13fb49(0x302)](_0x1bf4a5 => { const _0x41ec5f = _0x13fb49, _0x171ba2 = document[_0x41ec5f(0x5ba)]('li'); _0x171ba2[_0x41ec5f(0x640)] = 'member-selection-item', _0x171ba2[_0x41ec5f(0x7a2)] = _0x41ec5f(0x3d8) + _0x1bf4a5['id'] + _0x41ec5f(0x465) + _0x1bf4a5['id'] + _0x41ec5f(0x6f9) + (_0x1bf4a5[_0x41ec5f(0x51e)] || _0x1732e7) + _0x41ec5f(0x61f) + _0x1bf4a5['id'] + _0x41ec5f(0x63b) + _0x1bf4a5['name'] + _0x41ec5f(0x7ef), _0x2aac92['appendChild'](_0x171ba2); }), _0x4f27ca(_0x13fb49(0x55b), _0x13fb49(0x7c)); } function _0x11647e() { const _0x19753d = _0x27dd8f; if (_0x19753d(0x563) === _0x19753d(0x2e8)) _0x1e52a8[_0x19753d(0x50e)](_0x19753d(0x4b8), _0x6b5f60), _0x8a6dbc(_0x19753d(0x802) + _0x1c8697[_0x19753d(0x832)]); else { const _0x434f59 = _0x397a39[_0x19753d(0x73f)][_0x19753d(0xf2)](); if (!_0x434f59) { _0x599dea(_0x19753d(0x1cd)); return; } const _0x1a2797 = Array['from'](_0x2aac92[_0x19753d(0x687)](_0x19753d(0xd4)))[_0x19753d(0x30e)](_0x6a7a58 => _0x6a7a58[_0x19753d(0x78)]['id']); if (_0x1a2797['length'] < 0x2) { _0x599dea(_0x19753d(0x61c)); return; } const _0x3505d5 = { 'id': _0x19753d(0x4f6) + Date[_0x19753d(0x183)](), 'type': _0x19753d(0x3fd), 'name': _0x434f59, 'participantIds': _0x1a2797 }; _0x557cc6['chats'][_0x19753d(0x6b4)](_0x3505d5), _0x557cc6['activeChatId'] = _0x3505d5['id'], _0x162000(), _0x18d2c5(), _0x198f0b(), _0x2fa9f4(), _0x599dea('群聊“' + _0x434f59 + _0x19753d(0x60b)), _0x4f27ca('chat', 'groupChatCreate'); } } _0x2cd527[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x45c9b7), _0x3087e1[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0xd3e43e[_0x27dd8f(0x35f)][_0x27dd8f(0x7ff)](_0x27dd8f(0x1c6))), _0x47b08e[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0xd3e43e[_0x27dd8f(0x35f)][_0x27dd8f(0x7ff)](_0x27dd8f(0x1c6))), _0x1779bf[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x19a071 = _0x27dd8f; _0x397bfa[_0x19a071(0x138)](), navigator[_0x19a071(0x2bd)][_0x19a071(0x7f6)](_0x397bfa['value'])['then'](() => { const _0x3396cd = _0x19a071; _0x599dea(_0x3396cd(0x14f)); })['catch'](_0xc86a6d => { const _0x1b32cb = _0x19a071; _0x599dea(_0x1b32cb(0x442)); }); }), _0x2863a2[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x22b405), _0x45e2a0[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x295834), _0x34b489[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x616135[_0x27dd8f(0x35f)][_0x27dd8f(0x7ff)](_0x27dd8f(0x1c6))), _0x59c8da[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x616135[_0x27dd8f(0x35f)]['remove'](_0x27dd8f(0x1c6))), _0x5bc519[_0x27dd8f(0x572)]('click', () => _0x4ef4f1[_0x27dd8f(0x66b)]()), _0x4fd94f[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x32746f['click']()), _0x4ef4f1[_0x27dd8f(0x572)](_0x27dd8f(0x265), async _0x464ee4 => { const _0x12f122 = _0x27dd8f; if (_0x12f122(0x6f4) === _0x12f122(0x5b3)) _0x20606d[_0x12f122(0x3cd)]('music_library', { 'keyPath': 'id' }); else { const _0x5311f9 = _0x464ee4[_0x12f122(0x44b)][_0x12f122(0x209)][0x0]; if (!_0x5311f9) return; try { if (_0x12f122(0x6f5) === _0x12f122(0x6f5)) _0x5bc519[_0x12f122(0x483)] = await _0x4889cd(_0x5311f9); else { const _0x181c33 = _0x5a3c29[_0x12f122(0x73f)][_0x12f122(0xf2)](); if (!_0x181c33) { _0x2b453b(_0x12f122(0x1cd)); return; } const _0xad69d4 = _0x48147f[_0x12f122(0x652)](_0x5f0bf6[_0x12f122(0x687)](_0x12f122(0xd4)))['map'](_0x23073e => _0x23073e[_0x12f122(0x78)]['id']); if (_0xad69d4[_0x12f122(0x7a6)] < 0x2) { _0x4fe2aa(_0x12f122(0x61c)); return; } const _0x1334a2 = { 'id': 'chat_group_' + _0x2491e3['now'](), 'type': _0x12f122(0x3fd), 'name': _0x181c33, 'participantIds': _0xad69d4 }; _0x31b3d2['chats'][_0x12f122(0x6b4)](_0x1334a2), _0x237708['activeChatId'] = _0x1334a2['id'], _0x424a3d(), _0x30ba40(), _0x4d91a6(), _0x4c843d(), _0x40f459(_0x12f122(0x333) + _0x181c33 + '”已创建！'), _0x955cb4(_0x12f122(0x827), _0x12f122(0x55b)); } } catch (_0x2d2251) { _0x599dea(_0x12f122(0x397) + _0x2d2251[_0x12f122(0x832)]); } } }), _0x32746f[_0x27dd8f(0x572)]('change', async _0x691b66 => { const _0x261639 = _0x27dd8f, _0x30f517 = _0x691b66['target'][_0x261639(0x209)][0x0]; if (!_0x30f517) return; try { _0x4fd94f[_0x261639(0x483)] = await _0x4889cd(_0x30f517); } catch (_0x110a8d) { _0x599dea(_0x261639(0x397) + _0x110a8d[_0x261639(0x832)]); } }), _0x4820aa[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x3a639c['click']()), _0x2515a1[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x55bfa4 = _0x27dd8f; localStorage[_0x55bfa4(0x17f)](_0x55bfa4(0x842)), _0x1c1971(), _0x599dea('动态页背景已移除。'); }), _0x3a639c[_0x27dd8f(0x572)]('change', async _0x16fc5b => { const _0x3c4a19 = _0x27dd8f; if ('lEjFM' === 'qtlfE') _0xaee99[_0x3c4a19(0x304)] = _0x243d67[_0x3c4a19(0x304)] || [], _0x1e7a35['comments'] = (_0x244ae9[_0x3c4a19(0x7b)] || [])[_0x3c4a19(0x30e)]((_0x1dff1f, _0x167f67) => ({ ..._0x1dff1f, 'commentId': 'c_' + _0x344943[_0x3c4a19(0x798)] + '_' + _0x167f67 })), _0x3fa2a8(), _0x1494c7(); else { const _0x16f72f = _0x16fc5b[_0x3c4a19(0x44b)][_0x3c4a19(0x209)][0x0]; if (!_0x16f72f) return; try { if (_0x3c4a19(0x51f) !== _0x3c4a19(0x20b)) { const _0x302386 = await _0x4889cd(_0x16f72f); localStorage[_0x3c4a19(0x69e)]('customFeedWallpaper', _0x302386), _0x1c1971(), _0x599dea('动态页背景已更换！'); } else _0x20e3c7['error'](_0x3c4a19(0x6b3), _0x82475d); } catch (_0x160695) { if (_0x3c4a19(0x464) === _0x3c4a19(0x4cd)) { let _0x399e06 = _0x5d684a['worldBooks'][_0x3c4a19(0x4d1)](_0x47f7b3 => _0x47f7b3[_0x3c4a19(0x293)] === _0x30eea4[_0x3c4a19(0x293)]); if (_0x399e06) _0x566cdf['push'](_0x399e06['id']); else { const _0x3c6232 = { 'id': _0x3c4a19(0x42c) + _0x50af12[_0x3c4a19(0x183)]() + '_' + _0x2186c5[_0x3c4a19(0x19a)](), 'name': _0x3267c5[_0x3c4a19(0x293)], 'content': _0xa40a3b[_0x3c4a19(0x398)] }; _0x3ba5bb[_0x3c4a19(0x694)]['push'](_0x3c6232), _0x1b2956[_0x3c4a19(0x6b4)](_0x3c6232['id']); } } else _0x599dea(_0x3c4a19(0x397) + _0x160695[_0x3c4a19(0x832)]); } } }), document[_0x27dd8f(0x5b7)]('back-to-chat-from-group-settings')[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x4f27ca('chat', 'groupSettings')), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x6a1))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0xc9a137); const _0x3fe2c8 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x2f6)), _0x172221 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x3e3)); _0x3fe2c8[_0x27dd8f(0x572)]('click', () => _0x172221[_0x27dd8f(0x66b)]()), _0x172221[_0x27dd8f(0x572)](_0x27dd8f(0x265), _0x4af732 => { const _0x2074b1 = _0x27dd8f, _0x389a27 = _0x4af732[_0x2074b1(0x44b)][_0x2074b1(0x209)][0x0]; if (!_0x389a27) return; const _0x592781 = URL[_0x2074b1(0x371)](_0x389a27); _0x3fe2c8[_0x2074b1(0x483)] = _0x592781, _0x3fe2c8[_0x2074b1(0x38d)] = () => { URL['revokeObjectURL'](_0x592781); }; }); const _0x452aac = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x46a))['parentElement'], _0x1c4c79 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0xf4)), _0x7b8c95 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x46a)); _0x452aac[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x1c4c79[_0x27dd8f(0x66b)]()), _0x1c4c79[_0x27dd8f(0x572)](_0x27dd8f(0x265), _0x2c8a4b => { const _0xf12a5c = _0x27dd8f, _0xd961cd = _0x2c8a4b[_0xf12a5c(0x44b)][_0xf12a5c(0x209)][0x0]; if (!_0xd961cd) return; const _0x5910e1 = URL[_0xf12a5c(0x371)](_0xd961cd); _0x7b8c95['src'] = _0x5910e1, _0x7b8c95['onload'] = () => { const _0x54fd11 = _0xf12a5c; 'fBZrq' === _0x54fd11(0x71b) ? _0x4a4c77 = _0x5ec121['image'] : URL['revokeObjectURL'](_0x5910e1); }; }); const _0x1694e6 = document[_0x27dd8f(0x5ab)](_0x27dd8f(0x35d)), _0x4262c4 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x45b)); _0x1694e6[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x52374b => { const _0x2e6c9c = _0x27dd8f; _0x52374b[_0x2e6c9c(0x760)](), _0x4262c4[_0x2e6c9c(0x35f)][_0x2e6c9c(0x451)](_0x2e6c9c(0x247)), _0x1694e6['classList']['toggle'](_0x2e6c9c(0x5f5)); }), _0x4262c4['addEventListener'](_0x27dd8f(0x265), _0x61d4e9), document['getElementById'](_0x27dd8f(0x820))['addEventListener']('click', _0x335679), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x361))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), async () => { const _0x12a77e = _0x27dd8f, _0xe85368 = _0x5db7d2(); if (!_0xe85368 || _0xe85368['type'] !== 'group') return; const _0x35aa7a = await _0x4512da(_0x12a77e(0x519) + _0xe85368[_0x12a77e(0x293)] + _0x12a77e(0x17b)); if (_0x35aa7a) { if (_0x12a77e(0x1b5) !== _0x12a77e(0x1b5)) { _0x3d7b31(_0x12a77e(0x4a1)); return; } else _0x28fe9a(_0xe85368['id']), _0x599dea('群聊已解散。'), _0x4f27ca(_0x12a77e(0x827)), _0x1f1930(![]); } }); const _0x2c352c = document[_0x27dd8f(0x5ab)](_0x27dd8f(0x425)), _0x2fbaf8 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x523)); _0x2c352c[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x526066 => { const _0x5a044e = _0x27dd8f; _0x526066[_0x5a044e(0x760)](), _0x2fbaf8[_0x5a044e(0x35f)][_0x5a044e(0x451)](_0x5a044e(0x247)), _0x2c352c[_0x5a044e(0x35f)][_0x5a044e(0x451)](_0x5a044e(0x5f5)); }), _0x2fbaf8[_0x27dd8f(0x572)](_0x27dd8f(0x265), _0x119365), document[_0x27dd8f(0x572)]('click', _0x27bac3 => { const _0x3db905 = _0x27dd8f; if (_0x3db905(0x251) !== _0x3db905(0x251)) _0x5d2ce9[_0x3db905(0x29b)](_0x2232e4); else { if (!document[_0x3db905(0x5ab)]('.custom-multiselect')['contains'](_0x27bac3['target'])) { if (_0x3db905(0x21b) === 'QyPvx') _0x2fbaf8[_0x3db905(0x35f)]['remove'](_0x3db905(0x247)), _0x2c352c[_0x3db905(0x35f)][_0x3db905(0x7ff)](_0x3db905(0x5f5)); else { const _0x5ab56b = _0x50ec13(_0x5d9f0e[_0x3db905(0x398)] ?? _0x53765e[_0x3db905(0x68e)] ?? '')[_0x3db905(0xf2)]() || _0x3db905(0x73b) + (_0x5dc7b0 || _0x3db905(0x601)) + ']'; if (_0x5ab56b) _0x42e601[_0x3db905(0x4c7)][_0x3db905(0x6b4)]({ 'senderId': _0x3e7727['id'], 'kind': _0x3db905(0x68e), 'content': _0x5ab56b }); } } } }), _0x9c4dae[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x1a3aeb = _0x27dd8f; _0x503023(), _0x4f27ca(_0x1a3aeb(0x2ce), _0x1a3aeb(0x707)); }), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x642))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x4f27ca(_0x27dd8f(0x707), 'worldBook')), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x43c))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x4a5637()), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x477))['addEventListener']('click', () => { const _0x1e56e1 = _0x27dd8f; _0x503023(), _0x4f27ca(_0x1e56e1(0x2ce), _0x1e56e1(0x403)); }), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x7d5))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x11b244), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x778))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x230eac), _0x4313dc[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x4f27ca(_0x27dd8f(0x785), _0x27dd8f(0x707))), _0x12beee[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x4f27ca(_0x27dd8f(0x707), _0x27dd8f(0x785))), _0x53b883['addEventListener'](_0x27dd8f(0x66b), () => _0x2dcd36[_0x27dd8f(0x66b)]()), _0x2dcd36[_0x27dd8f(0x572)](_0x27dd8f(0x265), async _0x3973a5 => { const _0xe2288 = _0x27dd8f; if ('uLukK' === _0xe2288(0x6ed)) return _0x1c959c['userProfiles'][_0xe2288(0x4d1)](_0x172a2b => _0x172a2b['id'] === _0x31fc75); else { const _0x843368 = _0x3973a5[_0xe2288(0x44b)][_0xe2288(0x209)][0x0]; if (!_0x843368) return; await _0x54f87d(_0x843368); } }), _0x22a9de[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x31cc70 = _0x27dd8f; _0x31cc70(0x32a) === _0x31cc70(0x410) ? (_0x17f58e[_0x31cc70(0x7a2)] = '', _0x22db24['forEach'](_0x5ab2d9 => { const _0x2de309 = _0x31cc70, _0x1d5013 = _0x16ea3d[_0x2de309(0x5ba)](_0x2de309(0x7f4)); _0x1d5013[_0x2de309(0x483)] = _0x5ab2d9[_0x2de309(0x606)], _0x1d5013[_0x2de309(0x738)] = _0x2de309(0x395), _0x1d5013[_0x2de309(0x1ec)] = _0x5ab2d9['name'], _0x1d5013[_0x2de309(0x35f)][_0x2de309(0x632)](_0x2de309(0x3a7)), _0x1d5013['addEventListener'](_0x2de309(0x66b), () => _0x17df59(_0x5ab2d9)), _0x2d08d6['appendChild'](_0x1d5013); })) : (_0x18d2c5(), _0x4f27ca(_0x31cc70(0x827), _0x31cc70(0x707))); }), _0x1a972e['addEventListener'](_0x27dd8f(0x66b), () => { const _0x4bcbc0 = _0x27dd8f; if ('UQsZl' === _0x4bcbc0(0x5e2)) { _0x48e22b(); const _0x30bd71 = (_0x557cc6[_0x4bcbc0(0x170)]['endpoint'] || '')[_0x4bcbc0(0x158)](_0x577da3); _0x2624f1['disabled'] = _0x30bd71, _0x4f27ca(_0x4bcbc0(0x60f), _0x4bcbc0(0x707)); } else { const _0x41160a = _0x4296a5(_0x17ef96[0x1], 0xa), _0x4f97b4 = _0x57a365(_0x440935[0x2], 0xa), _0x55e360 = _0x1d5a72(_0x2d62e3[0x3], 0xa) * (_0x2b77f4[0x3][_0x4bcbc0(0x7a6)] === 0x2 ? 0xa : 0x1), _0x5d13b2 = _0x41160a * 0x3c + _0x4f97b4 + _0x55e360 / 0x3e8, _0x4d22a1 = _0x548178[_0x4bcbc0(0x4f8)](_0x18db8f, '')[_0x4bcbc0(0xf2)](); _0x4d22a1 && _0xa89091['push']({ 'time': _0x5d13b2, 'text': _0x4d22a1 }); } }), _0x170b59[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x4f27ca(_0x27dd8f(0x707), 'settings')), _0x48719c[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x2635a4 = _0x27dd8f; _0x57f4b3(), _0x4f27ca(_0x2635a4(0x707), _0x2635a4(0x827)); }), _0x3ed8f4[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x20d489 = _0x27dd8f; _0x20d489(0x92) !== _0x20d489(0x390) ? (_0x57f4b3(), _0x1f1930(![])) : (_0x5589c1(), _0x31ca25 = null); }), _0x11b77e[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0xe78d46 = _0x27dd8f; _0xe78d46(0x57a) === _0xe78d46(0x763) ? (_0x2bbd04 = { 'characterId': _0x3f9cb1, 'entries': [] }, _0x313628[_0xe78d46(0xa8)][_0xe78d46(0x6b4)](_0x1167fa)) : _0x4f27ca(_0xe78d46(0x827), _0xe78d46(0x549)); }), _0x410ecf[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x53ccdd = _0x27dd8f; 'bZyZC' !== _0x53ccdd(0x430) ? _0xadc86b['classList'][_0x53ccdd(0x632)](_0x53ccdd(0x1c6)) : _0x352954['setItem'](_0x57e625, _0x426140[_0x53ccdd(0x82f)](_0x3e12b0)); }), _0x336b95[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x2b66ff()), _0x45f17d[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x5debb2); function _0x3a37ec(_0x8d6480) { const _0x230215 = _0x27dd8f; if (!_0x8d6480 || _0x8d6480[_0x230215(0x516)] !== _0x230215(0x3fd)) return; const _0x21f1a0 = _0x230215(0x340); document[_0x230215(0x496)]['insertAdjacentHTML'](_0x230215(0x57c), _0x21f1a0); const _0x461f27 = document[_0x230215(0x5b7)](_0x230215(0x37a)), _0x387652 = _0x461f27['querySelector'](_0x230215(0x783)), _0x5b1522 = document['getElementById'](_0x230215(0x205)), _0x2efcdb = document[_0x230215(0x5b7)]('group-edit-members'), _0x3f9adb = document[_0x230215(0x5b7)](_0x230215(0x3f5)), _0x35a969 = document[_0x230215(0x5b7)](_0x230215(0x74b)), _0x3da66f = document[_0x230215(0x5b7)]('group-options-cancel'), _0x3b7682 = () => _0x461f27[_0x230215(0x7ff)](); _0x5b1522[_0x230215(0x572)](_0x230215(0x66b), async () => { const _0x31bb7c = _0x230215; _0x3b7682(); const _0xafaeab = await _0x4512da(_0x31bb7c(0xd8) + _0x8d6480[_0x31bb7c(0x293)] + '\x22\x20的聊天记录吗？此操作不可撤销。'); if (_0xafaeab) { _0x8d6480['id'] === _0x557cc6[_0x31bb7c(0x589)] && (_0x57f4b3(), _0x557cc6[_0x31bb7c(0x5b8)] = [], _0x2292d9()); try { localStorage[_0x31bb7c(0x17f)]('chatHistory_' + _0x8d6480['id']), _0x599dea(_0x31bb7c(0x157) + _0x8d6480[_0x31bb7c(0x293)] + _0x31bb7c(0x20a)); } catch (_0x24e004) { console[_0x31bb7c(0x50e)](_0x31bb7c(0x60a) + _0x8d6480['id'], _0x24e004), _0x599dea(_0x31bb7c(0xf7)); } } }), _0x2efcdb[_0x230215(0x572)](_0x230215(0x66b), () => { const _0x537b48 = _0x230215; if (_0x537b48(0x81c) === _0x537b48(0x221)) { const _0x6fb1bb = { 'id': _0x537b48(0x42c) + _0x57388f['now']() + '_' + _0x3ea248[_0x537b48(0x19a)](), 'name': _0x34398d[_0x537b48(0x293)], 'content': _0xe053ba[_0x537b48(0x398)] }; _0x1f0985[_0x537b48(0x694)][_0x537b48(0x6b4)](_0x6fb1bb), _0x16199b['push'](_0x6fb1bb['id']); } else _0x3b7682(), _0x599dea('编辑群成员功能正在开发中...'); }), _0x3f9adb[_0x230215(0x572)](_0x230215(0x66b), async () => { const _0xfbfb59 = _0x230215; _0x3b7682(); const _0x92a424 = prompt(_0xfbfb59(0x3f0), _0x8d6480[_0xfbfb59(0x293)]); _0x92a424 && _0x92a424[_0xfbfb59(0xf2)]() && _0x92a424 !== _0x8d6480[_0xfbfb59(0x293)] && (_0x8d6480[_0xfbfb59(0x293)] = _0x92a424[_0xfbfb59(0xf2)](), _0x162000(), _0x18d2c5(), _0x198f0b(), _0x599dea('群名称已更改为\x22' + _0x8d6480[_0xfbfb59(0x293)] + '\x22。')); }), _0x35a969[_0x230215(0x572)]('click', async () => { const _0x403627 = _0x230215; _0x3b7682(); const _0x52bd3d = await _0x4512da(_0x403627(0x67e) + _0x8d6480['name'] + _0x403627(0x59f)); _0x52bd3d && (_0x28fe9a(_0x8d6480['id']), _0x599dea(_0x403627(0x157) + _0x8d6480[_0x403627(0x293)] + _0x403627(0x766)), _0x1f1930(![])); }), _0x387652[_0x230215(0x572)](_0x230215(0x66b), _0x3b7682), _0x3da66f['addEventListener'](_0x230215(0x66b), _0x3b7682); } _0x592d61[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x3d8d09 = _0x27dd8f; if (_0x3d8d09(0x4bf) === 'UuSPy') { const _0x5b20e8 = _0x5db7d2(); if (_0x5b20e8 && _0x5b20e8[_0x3d8d09(0x516)] === _0x3d8d09(0x405)) _0x3de8df(_0x5b20e8[_0x3d8d09(0x765)][0x0]); else _0x5b20e8 && _0x5b20e8['type'] === 'group' && _0x31c22d(_0x5b20e8['id']); } else { const _0x1bc028 = { 'id': _0x3d8d09(0x23c) + _0x3df5bd[_0x3d8d09(0x183)](), ..._0x451b6e }; _0x5dfa71['userProfiles'][_0x3d8d09(0x6b4)](_0x1bc028), !_0x552a32[_0x3d8d09(0x26a)] && (_0x12df24[_0x3d8d09(0x26a)] = _0x1bc028['id']); } }), _0x4aebf[_0x27dd8f(0x572)](_0x27dd8f(0x312), _0x171d88 => { const _0x582d8c = _0x27dd8f; _0x171d88[_0x582d8c(0x499)] === 'Enter' && !_0x171d88[_0x582d8c(0x1cf)] && (_0x171d88[_0x582d8c(0x31e)](), _0x2b66ff()); }); const _0x1d9a59 = () => _0xadc86b[_0x27dd8f(0x35f)][_0x27dd8f(0x7ff)](_0x27dd8f(0x1c6)); _0x3be458['addEventListener'](_0x27dd8f(0x66b), _0x1d9a59), _0x28a7c2[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x1d9a59), _0x5e7eb6[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { _0x1d9a59(), _0x3de8df(); }), _0x9cd111[_0x27dd8f(0x572)]('click', () => { _0x1d9a59(), _0x31f7b7(); }), _0x2d9b7c[_0x27dd8f(0x572)]('click', () => { const _0x468c26 = _0x27dd8f; _0x4f27ca('chat', _0x468c26(0x55b)), _0x1f1930(![]); }), _0x2a603d[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x11647e), _0x361c9d[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x48cd10 = _0x27dd8f; _0x331e50[_0x48cd10(0x35f)]['toggle']('show'); if (_0x331e50[_0x48cd10(0x35f)][_0x48cd10(0x793)](_0x48cd10(0x1c6))) { if (_0x48cd10(0x7db) !== _0x48cd10(0x7db)) { if (_0x37210c) _0x41b644(_0x548082); } else _0x784812[_0x48cd10(0x4f0)] = _0x784812[_0x48cd10(0x4c1)]; } }), _0x2de209['addEventListener'](_0x27dd8f(0x66b), () => _0x2d664a[_0x27dd8f(0x66b)]()); const _0x39528d = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x146)); _0x2d664a[_0x27dd8f(0x572)](_0x27dd8f(0x265), _0x3ea2e8), _0x39528d[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x1e9193), _0x379d9a['addEventListener'](_0x27dd8f(0x66b), _0x315a34), _0x447b5a[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x2290e0), _0x4596b7[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x560d0d), _0x2dfd9e[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x335679), _0xe0b810[_0x27dd8f(0x572)](_0x27dd8f(0x66b), async () => { const _0x127b92 = _0x27dd8f, _0xf80a43 = _0x1dc455[_0x127b92(0x73f)]; if (!_0xf80a43) return; const _0x59c579 = _0x3132c6(_0xf80a43); if (!_0x59c579) return; const _0x282a59 = await _0x4512da(_0x127b92(0x2fa) + _0x59c579['name'] + '”吗？该角色的私聊和所有相关群聊记录都将被一并处理。'); _0x282a59 && (_0x219f16(_0xf80a43), _0x599dea(_0x127b92(0x705) + _0x59c579['name'] + _0x127b92(0x501)), _0x4f27ca(_0x127b92(0x827), _0x127b92(0x549)), _0x1f1930(![])); }), _0x4d2704[_0x27dd8f(0x572)]('input', () => { const _0x1021dc = _0x27dd8f; if (_0x1021dc(0x723) === 'LrhtB') { const _0x20b6e6 = _0x4d2704[_0x1021dc(0x73f)][_0x1021dc(0xf2)]()['includes'](_0x577da3); _0x2624f1[_0x1021dc(0x6cf)] = _0x20b6e6; } else _0x1012f0[_0x1021dc(0x2d0)] = _0x1021dc(0x1c5) + _0x556f85[_0x1021dc(0x7a6)] + '\x20项'; }); async function _0x3ce4ee() { const _0x3f9efd = _0x27dd8f; if (_0x3f9efd(0x610) === _0x3f9efd(0x56a)) _0x2ab3eb['appendChild'](_0x3dd7e4), _0x1b6aea['appendChild'](_0x8b6c9f); else { const _0x4ca251 = _0x4d2704[_0x3f9efd(0x73f)][_0x3f9efd(0xf2)](), _0xe5e03a = _0xd9cc63[_0x3f9efd(0x73f)][_0x3f9efd(0xf2)](); if (!_0x4ca251 || !_0xe5e03a) { if (_0x3f9efd(0x2b4) !== _0x3f9efd(0x67f)) { _0x599dea('请先输入\x20API\x20接口地址和密钥。'); return; } else _0x4a7364[_0x3f9efd(0x483)] = _0x5afe21[_0x3f9efd(0x371)](_0x23d724), _0x39eb95[_0x3f9efd(0x6ca)][_0x3f9efd(0x836)] = _0x3f9efd(0x534); } const _0x20493b = _0x4ca251[_0x3f9efd(0x4f8)](/\/+$/, ''), _0x24928c = _0x20493b + _0x3f9efd(0x4cb); _0x2624f1[_0x3f9efd(0x6cf)] = !![], _0x2624f1[_0x3f9efd(0x2d0)] = _0x3f9efd(0x239), _0x5ad866[_0x3f9efd(0x35f)][_0x3f9efd(0x7ff)](_0x3f9efd(0x1c6)); try { if (_0x3f9efd(0xde) === _0x3f9efd(0x19b)) _0x3c1331[_0x3f9efd(0x674)] && (_0x47e2e4[_0x3f9efd(0x674)] = _0x3e0925['linkedWorldBookIds'][_0x3f9efd(0x1d8)](_0x12dba6 => _0x12dba6 !== _0x101918)); else { const _0x4b2c26 = await fetch(_0x24928c, { 'headers': { 'Authorization': 'Bearer\x20' + _0x28f483(_0xe5e03a) } }); if (!_0x4b2c26['ok']) throw new Error(_0x3f9efd(0x5cf) + _0x4b2c26[_0x3f9efd(0x27f)]); const _0x2389ac = await _0x4b2c26[_0x3f9efd(0x7ad)](), _0x168e53 = (_0x2389ac[_0x3f9efd(0x5f7)] || _0x2389ac)['map'](_0x12d38 => _0x12d38['id'])[_0x3f9efd(0x5d1)](); _0x168e53[_0x3f9efd(0x7a6)] > 0x0 ? (_0x5ad866[_0x3f9efd(0x7a2)] = '', _0x168e53[_0x3f9efd(0x302)](_0x3afa7e => { const _0x2b374d = _0x3f9efd, _0x528bcd = document[_0x2b374d(0x5ba)](_0x2b374d(0x509)); _0x528bcd[_0x2b374d(0x2d0)] = _0x3afa7e, _0x528bcd[_0x2b374d(0x572)](_0x2b374d(0x66b), () => { const _0x3da1b2 = _0x2b374d; _0x989438[_0x3da1b2(0x73f)] = _0x3afa7e, _0x5ad866['classList'][_0x3da1b2(0x7ff)](_0x3da1b2(0x1c6)); }), _0x5ad866[_0x2b374d(0x796)](_0x528bcd); }), _0x5ad866[_0x3f9efd(0x35f)][_0x3f9efd(0x632)](_0x3f9efd(0x1c6)), _0x599dea(_0x3f9efd(0x743) + _0x168e53[_0x3f9efd(0x7a6)] + _0x3f9efd(0x64d))) : _0x599dea(_0x3f9efd(0x18b)); } } catch (_0x5e0292) { if (_0x3f9efd(0x257) === _0x3f9efd(0x152)) return new _0x2b92dc((_0xb8b872, _0x45126b) => { const _0x2d5570 = _0x3f9efd, _0x16269e = new _0x22c5d4(); _0x16269e[_0x2d5570(0x686)] = () => _0xb8b872(_0x16269e[_0x2d5570(0x242)]), _0x16269e['onerror'] = _0x45126b, _0x16269e[_0x2d5570(0x1ad)](_0xdf8a48); }); else _0x599dea(_0x3f9efd(0x4fe) + _0x5e0292['message'] + _0x3f9efd(0x5c4)); } finally { _0x3f9efd(0x8b) === _0x3f9efd(0x8b) ? (_0x2624f1[_0x3f9efd(0x6cf)] = ![], _0x2624f1[_0x3f9efd(0x2d0)] = '获取') : _0xbf63c8[_0x3f9efd(0x516)] = 'text'; } } } _0x2624f1['addEventListener'](_0x27dd8f(0x66b), _0x404823 => { const _0x40984f = _0x27dd8f; _0x404823[_0x40984f(0x760)](), _0x3ce4ee(); }), document[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0xe4f149 => { const _0x558929 = _0x27dd8f; !_0x5ad866[_0x558929(0x793)](_0xe4f149[_0x558929(0x44b)]) && _0xe4f149[_0x558929(0x44b)] !== _0x989438 && _0xe4f149[_0x558929(0x44b)] !== _0x2624f1 && _0x5ad866[_0x558929(0x35f)]['remove'](_0x558929(0x1c6)); }); async function _0x4889cd(_0x507604) { return await _0x4657ac(_0x507604, 0x190, 0.85); } _0x1257f2[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x29669d['click']()), _0x29669d[_0x27dd8f(0x572)]('change', async _0x56b5f1 => { const _0x3aef3 = _0x27dd8f; if (_0x3aef3(0x4ca) !== _0x3aef3(0x396)) { const _0x4c9252 = _0x56b5f1['target']['files'][0x0]; if (!_0x4c9252) return; try { if (_0x3aef3(0x3c0) === 'bYKat') { const _0x582212 = _0x1f662f(_0x24c864[0x1]), _0x18a414 = _0x810413[0x2]['trim'](), _0x5301fb = _0x1e997f(_0x358671['activeChatId']); let _0x5c8fd6 = null; if (_0x18a414 === _0x5301fb[_0x3aef3(0x293)]) _0x5c8fd6 = _0x5301fb['id']; else { const _0x4aafce = _0x27e70c(); if (_0x4aafce[_0x3aef3(0x516)] === _0x3aef3(0x3fd)) { const _0x33520a = _0x3bc945['characters'][_0x3aef3(0x4d1)](_0xbb7e8c => _0x4aafce[_0x3aef3(0x765)]['includes'](_0xbb7e8c['id']) && _0xbb7e8c['name'] === _0x18a414); if (_0x33520a) _0x5c8fd6 = _0x33520a['id']; } } if (_0x5c8fd6) return { 'type': _0x3aef3(0xc9), 'amount': _0x582212, 'recipientId': _0x5c8fd6, 'senderId': _0x12f4a9['id'] }; else return { 'type': 'text', 'content': _0x3aef3(0x4d9) + _0x18a414 + '”，但没找到人)' }; } else { const _0x252853 = await _0x4889cd(_0x4c9252); _0x1257f2[_0x3aef3(0x483)] = _0x252853; } } catch (_0x13ebef) { _0x3aef3(0x764) !== _0x3aef3(0x4e5) ? _0x599dea(_0x3aef3(0x397) + _0x13ebef[_0x3aef3(0x832)]) : _0x3f41d6(_0x522890['id']); } } else { if (_0x1f7011[_0x3aef3(0x44b)][_0x3aef3(0x665)](_0x3aef3(0x7fd))) return; const _0x4ddec7 = _0x4a00ea[_0x3aef3(0x5b7)](_0x3aef3(0x666)); _0x4ddec7 && _0x4ddec7[_0x3aef3(0x66b)](); } }), _0x58419f[_0x27dd8f(0x572)]('click', () => _0x52fff2['click']()), _0x52fff2[_0x27dd8f(0x572)](_0x27dd8f(0x265), async _0x281a3e => { const _0x4861eb = _0x27dd8f; if (_0x4861eb(0x2f7) === _0x4861eb(0x341)) _0x55d5a0[_0x4861eb(0x572)](_0x4861eb(0x66b), () => _0x496011[_0x4861eb(0x66b)]()), _0x35bf5d['addEventListener']('change', async _0x3b29be => { const _0x5360a6 = _0x4861eb, _0x54da05 = _0x3b29be['target'][_0x5360a6(0x209)][0x0]; if (!_0x54da05) return; try { _0x564b23[_0x5360a6(0x483)] = _0x4b191f['createObjectURL'](_0x54da05); } catch (_0x386710) { _0x4f1ad0('图片预览失败:\x20' + _0x386710['message']); } }); else { const _0x315430 = _0x281a3e[_0x4861eb(0x44b)][_0x4861eb(0x209)][0x0]; if (!_0x315430) return; try { _0x58419f[_0x4861eb(0x483)] = await _0x4889cd(_0x315430); } catch (_0x87ddca) { _0x599dea(_0x4861eb(0x397) + _0x87ddca[_0x4861eb(0x832)]); } } }); function _0x572f26() { _0x331e50['innerHTML'] = '', _0x56624c['forEach'](_0x412dfa => { const _0x58cc9c = _0x3d17; if (_0x58cc9c(0x3a0) === _0x58cc9c(0x3a0)) { const _0x34b545 = document[_0x58cc9c(0x5ba)](_0x58cc9c(0x7f4)); _0x34b545['src'] = _0x412dfa['url'], _0x34b545[_0x58cc9c(0x738)] = _0x58cc9c(0x395), _0x34b545['title'] = _0x412dfa['name'], _0x34b545[_0x58cc9c(0x35f)][_0x58cc9c(0x632)](_0x58cc9c(0x3a7)), _0x34b545[_0x58cc9c(0x572)](_0x58cc9c(0x66b), () => _0x2a5534(_0x412dfa)), _0x331e50[_0x58cc9c(0x796)](_0x34b545); } else _0x440460['activeUserProfileId'] = _0x1fd284['userProfiles'][0x0]['id']; }); } function _0x472bcd() { const _0x26c2bd = _0x27dd8f, _0x189bb0 = document[_0x26c2bd(0x5b7)](_0x26c2bd(0x809)); _0x189bb0[_0x26c2bd(0x7a2)] = ''; if (_0x557cc6['userProfiles'][_0x26c2bd(0x7a6)] === 0x0) { if (_0x26c2bd(0x148) !== _0x26c2bd(0x148)) _0xc9f3bf['error'](_0x26c2bd(0x531), _0xde9178); else { _0x189bb0[_0x26c2bd(0x7a2)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>'; return; } } _0x557cc6['userProfiles'][_0x26c2bd(0x302)](_0x55d37e => { const _0x53b7ed = _0x26c2bd, _0x29594e = document[_0x53b7ed(0x5ba)]('div'); _0x29594e[_0x53b7ed(0x640)] = _0x53b7ed(0x55d), _0x29594e['dataset']['id'] = _0x55d37e['id']; const _0x2edd27 = _0x55d37e['id'] === _0x557cc6[_0x53b7ed(0x26a)] ? _0x53b7ed(0x72f) : ''; _0x29594e[_0x53b7ed(0x7a2)] = _0x53b7ed(0x80) + (_0x55d37e[_0x53b7ed(0x51e)] || _0x3b11bb) + _0x53b7ed(0x5b9) + _0x55d37e[_0x53b7ed(0x293)] + _0x2edd27 + _0x53b7ed(0x4ec) + _0x55d37e[_0x53b7ed(0x6f2)][_0x53b7ed(0x471)](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x29594e[_0x53b7ed(0x572)]('click', () => _0x4535ee(_0x55d37e['id'])), _0x189bb0['appendChild'](_0x29594e); }); } function _0x4535ee(_0x55075e = null) { const _0x439b3f = _0x27dd8f; if (_0x439b3f(0x6b8) === _0x439b3f(0x6fb)) return { 'type': 'music', 'songName': _0x113673[0x1][_0x439b3f(0xf2)](), 'artist': _0x33e0dc[0x2][_0x439b3f(0xf2)]() }; else { _0x4f27ca(_0x439b3f(0x204), _0x439b3f(0x769)); const _0x37e741 = document[_0x439b3f(0x5b7)](_0x439b3f(0x54e)); if (_0x55075e) { if (_0x439b3f(0x16d) !== _0x439b3f(0x16d)) { const _0xcc9c17 = _0xf0e3a6(_0x18efc1['activeChatId']); _0x22001b = _0xcc9c17[_0x439b3f(0x51e)] || _0xa10e42; } else { const _0x5980e2 = _0x557cc6['userProfiles'][_0x439b3f(0x4d1)](_0x2f9250 => _0x2f9250['id'] === _0x55075e); if (!_0x5980e2) return; document[_0x439b3f(0x5b7)](_0x439b3f(0x5af))['value'] = _0x5980e2['id'], document[_0x439b3f(0x5b7)](_0x439b3f(0x1c7))['textContent'] = _0x439b3f(0x21e), document['getElementById'](_0x439b3f(0x4a3))[_0x439b3f(0x73f)] = _0x5980e2[_0x439b3f(0x293)], document[_0x439b3f(0x5b7)](_0x439b3f(0x1fc))[_0x439b3f(0x483)] = _0x5980e2[_0x439b3f(0x51e)], document[_0x439b3f(0x5b7)](_0x439b3f(0x36f))[_0x439b3f(0x73f)] = _0x5980e2[_0x439b3f(0x6f2)], _0x37e741[_0x439b3f(0x6ca)]['display'] = _0x5980e2['id'] === _0x557cc6[_0x439b3f(0x26a)] ? 'none' : 'block'; } } else document[_0x439b3f(0x5b7)](_0x439b3f(0x5af))[_0x439b3f(0x73f)] = '', document[_0x439b3f(0x5b7)](_0x439b3f(0x1c7))[_0x439b3f(0x2d0)] = '创建新用户', document[_0x439b3f(0x5b7)](_0x439b3f(0x4a3))[_0x439b3f(0x73f)] = _0x439b3f(0x4bb) + (_0x557cc6['userProfiles'][_0x439b3f(0x7a6)] + 0x1), document[_0x439b3f(0x5b7)](_0x439b3f(0x1fc))[_0x439b3f(0x483)] = _0x3b11bb, document[_0x439b3f(0x5b7)](_0x439b3f(0x36f))['value'] = '', _0x37e741['style'][_0x439b3f(0x836)] = _0x439b3f(0x4e3); } } function _0x2290e0() { const _0x4b59f8 = _0x27dd8f, _0x3f90e0 = document[_0x4b59f8(0x5b7)]('editing-user-id')[_0x4b59f8(0x73f)], _0x2d77bd = { 'name': document[_0x4b59f8(0x5b7)]('user-name')[_0x4b59f8(0x73f)][_0x4b59f8(0xf2)](), 'persona': document[_0x4b59f8(0x5b7)](_0x4b59f8(0x36f))[_0x4b59f8(0x73f)]['trim'](), 'avatar': document[_0x4b59f8(0x5b7)](_0x4b59f8(0x1fc))['src'] }; if (!_0x2d77bd[_0x4b59f8(0x293)]) { if (_0x4b59f8(0x38e) !== 'MADYl') { _0x599dea(_0x4b59f8(0x40d)); return; } else _0x11929a[_0x4b59f8(0x71d)] = null, _0x4ba510(), _0xad0808(_0x4b59f8(0x493)), _0x43b63f(), _0x4b994e[_0x4b59f8(0x35f)]['remove'](_0x4b59f8(0x1c6)), _0x46ebd6(() => _0x2b529e[_0x4b59f8(0x6ca)][_0x4b59f8(0x836)] = _0x4b59f8(0x4e3), 0x12c); } if (_0x3f90e0) { const _0x5537cf = _0x557cc6['userProfiles'][_0x4b59f8(0x4d1)](_0x356e05 => _0x356e05['id'] === _0x3f90e0); if (_0x5537cf) Object['assign'](_0x5537cf, _0x2d77bd); } else { if (_0x4b59f8(0x25b) !== _0x4b59f8(0x774)) { const _0x381f7c = { 'id': 'user_' + Date[_0x4b59f8(0x183)](), ..._0x2d77bd }; _0x557cc6[_0x4b59f8(0x58d)][_0x4b59f8(0x6b4)](_0x381f7c), !_0x557cc6['activeUserProfileId'] && (_0x557cc6[_0x4b59f8(0x26a)] = _0x381f7c['id']); } else { if (_0x667b71[_0x4b59f8(0x516)] === _0x4b59f8(0x514)) _0x138a51[_0x4b59f8(0x31e)](); _0x397534(_0xe16b82); } } _0x162000(), _0x599dea(_0x4b59f8(0x744)), _0x472bcd(), _0x4f27ca(_0x4b59f8(0x769), 'userProfile'); } async function _0x5b8afc() { const _0x3db1e5 = _0x27dd8f, _0x16b99b = document[_0x3db1e5(0x5b7)](_0x3db1e5(0x5af))['value']; if (!_0x16b99b) return; if (_0x557cc6['userProfiles']['length'] <= 0x1) { if (_0x3db1e5(0x482) === _0x3db1e5(0x38a)) _0x4c3878 = _0xd6c068[_0x3db1e5(0x293)]; else { _0x599dea(_0x3db1e5(0x581)); return; } } const _0x272eda = await _0x4512da('确定要删除这个用户吗？与此用户绑定的聊天将恢复为默认用户。'); _0x272eda && (_0x557cc6['userProfiles'] = _0x557cc6['userProfiles'][_0x3db1e5(0x1d8)](_0x43474a => _0x43474a['id'] !== _0x16b99b), _0x557cc6[_0x3db1e5(0x26a)] === _0x16b99b && (_0x557cc6[_0x3db1e5(0x26a)] = _0x557cc6['userProfiles'][0x0]['id']), _0x557cc6[_0x3db1e5(0x46d)][_0x3db1e5(0x302)](_0x32651f => { const _0xd9eef4 = _0x3db1e5; _0x32651f[_0xd9eef4(0x2a6)] === _0x16b99b && (_0x32651f[_0xd9eef4(0x2a6)] = _0x557cc6[_0xd9eef4(0x26a)]); }), _0x162000(), _0x599dea(_0x3db1e5(0x151)), _0x472bcd(), _0x4f27ca('userProfileList', 'userProfile')); } function _0x503023() { const _0x880fcf = _0x27dd8f; if ('kxhGr' !== _0x880fcf(0x88)) _0x2f353a[_0x880fcf(0x5b7)](_0x880fcf(0x5af))[_0x880fcf(0x73f)] = '', _0x2d53e0['getElementById'](_0x880fcf(0x1c7))[_0x880fcf(0x2d0)] = '创建新用户', _0x1aba0e[_0x880fcf(0x5b7)](_0x880fcf(0x4a3))[_0x880fcf(0x73f)] = _0x880fcf(0x4bb) + (_0xa0f101[_0x880fcf(0x58d)][_0x880fcf(0x7a6)] + 0x1), _0x3f6c03[_0x880fcf(0x5b7)](_0x880fcf(0x1fc))['src'] = _0x347493, _0x25b4de[_0x880fcf(0x5b7)](_0x880fcf(0x36f))['value'] = '', _0x236c1f[_0x880fcf(0x6ca)][_0x880fcf(0x836)] = _0x880fcf(0x4e3); else { const _0x8816a8 = document[_0x880fcf(0x5b7)]('world-book-list-container'); _0x8816a8[_0x880fcf(0x7a2)] = ''; if (_0x557cc6['worldBooks'][_0x880fcf(0x7a6)] === 0x0) { _0x8816a8['innerHTML'] = _0x880fcf(0x786); return; } _0x557cc6[_0x880fcf(0x694)][_0x880fcf(0x302)](_0x2d08d0 => { const _0x5a7eb8 = _0x880fcf, _0x14441b = document[_0x5a7eb8(0x5ba)]('div'); _0x14441b['className'] = _0x5a7eb8(0x55d), _0x14441b[_0x5a7eb8(0x78)]['id'] = _0x2d08d0['id'], _0x14441b['innerHTML'] = _0x5a7eb8(0x790) + _0x2d08d0[_0x5a7eb8(0x293)] + _0x5a7eb8(0xd7) + _0x2d08d0[_0x5a7eb8(0x398)][_0x5a7eb8(0x471)](0x0, 0x64) + _0x5a7eb8(0x37b), _0x14441b[_0x5a7eb8(0x572)](_0x5a7eb8(0x66b), () => _0x4a5637(_0x2d08d0['id'])), _0x8816a8[_0x5a7eb8(0x796)](_0x14441b); }); } } function _0x4a5637(_0x5e7e1c = null) { const _0x49a5c2 = _0x27dd8f; _0x4f27ca(_0x49a5c2(0x403), 'worldBook'); if (_0x5e7e1c) { const _0x3ea428 = _0x557cc6[_0x49a5c2(0x694)]['find'](_0x130ae5 => _0x130ae5['id'] === _0x5e7e1c); if (!_0x3ea428) return; document[_0x49a5c2(0x5b7)]('editing-world-book-id')['value'] = _0x3ea428['id'], document[_0x49a5c2(0x5b7)]('world-book-editor-title')[_0x49a5c2(0x2d0)] = _0x49a5c2(0x2e7), document[_0x49a5c2(0x5b7)](_0x49a5c2(0xb4))[_0x49a5c2(0x73f)] = _0x3ea428['name'], document[_0x49a5c2(0x5b7)](_0x49a5c2(0xab))[_0x49a5c2(0x73f)] = _0x3ea428['content']; } else { if (_0x49a5c2(0x330) === 'cSbgB') document[_0x49a5c2(0x5b7)](_0x49a5c2(0x5b4))[_0x49a5c2(0x73f)] = '', document['getElementById']('world-book-editor-title')[_0x49a5c2(0x2d0)] = '新建条目', document[_0x49a5c2(0x5b7)](_0x49a5c2(0xb4))[_0x49a5c2(0x73f)] = '', document[_0x49a5c2(0x5b7)](_0x49a5c2(0xab))[_0x49a5c2(0x73f)] = ''; else { const _0x1ef051 = _0x5880e1[_0x49a5c2(0x5ba)](_0x49a5c2(0x7f4)); _0x1ef051[_0x49a5c2(0x483)] = _0x2c2cbe['url'], _0x1ef051['loading'] = _0x49a5c2(0x395), _0x1ef051['title'] = _0x4c0b1d[_0x49a5c2(0x293)], _0x1ef051[_0x49a5c2(0x35f)]['add'](_0x49a5c2(0x3a7)), _0x1ef051['addEventListener']('click', () => _0x15bf67(_0x44cad7)), _0x352d43[_0x49a5c2(0x796)](_0x1ef051); } } } function _0x11b244() { const _0x3a2e51 = _0x27dd8f, _0xb33016 = document[_0x3a2e51(0x5b7)]('editing-world-book-id')[_0x3a2e51(0x73f)], _0x178cb2 = document[_0x3a2e51(0x5b7)]('world-book-edit-name')['value'][_0x3a2e51(0xf2)](), _0x4ccbab = document['getElementById'](_0x3a2e51(0xab))[_0x3a2e51(0x73f)][_0x3a2e51(0xf2)](); if (!_0x178cb2 || !_0x4ccbab) { _0x599dea(_0x3a2e51(0x639)); return; } if (_0xb33016) { const _0x4d129e = _0x557cc6[_0x3a2e51(0x694)][_0x3a2e51(0x4d1)](_0x2d33b1 => _0x2d33b1['id'] === _0xb33016); _0x4d129e && (_0x4d129e[_0x3a2e51(0x293)] = _0x178cb2, _0x4d129e['content'] = _0x4ccbab); } else { if (_0x3a2e51(0x42d) !== 'IQNAU') { if (!_0x2b93f2) return []; const _0x1883f9 = _0x5b292b[_0x3a2e51(0x1d2)]('\x0a'), _0x5368c3 = [], _0x29102c = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x10b01a of _0x1883f9) { const _0x254b21 = _0x10b01a[_0x3a2e51(0x3ee)](_0x29102c); if (_0x254b21) { const _0x1fcfda = _0x52203e(_0x254b21[0x1], 0xa), _0x230fc4 = _0x145501(_0x254b21[0x2], 0xa), _0x263c26 = _0x266ade(_0x254b21[0x3], 0xa) * (_0x254b21[0x3][_0x3a2e51(0x7a6)] === 0x2 ? 0xa : 0x1), _0x27af3d = _0x1fcfda * 0x3c + _0x230fc4 + _0x263c26 / 0x3e8, _0x16d633 = _0x10b01a[_0x3a2e51(0x4f8)](_0x29102c, '')[_0x3a2e51(0xf2)](); _0x16d633 && _0x5368c3[_0x3a2e51(0x6b4)]({ 'time': _0x27af3d, 'text': _0x16d633 }); } } return _0x5368c3; } else { const _0x54d5df = { 'id': 'wb_' + Date[_0x3a2e51(0x183)](), 'name': _0x178cb2, 'content': _0x4ccbab }; _0x557cc6['worldBooks'][_0x3a2e51(0x6b4)](_0x54d5df); } } _0x162000(), _0x599dea(_0x3a2e51(0x142)), _0x503023(), _0x4f27ca('worldBook', _0x3a2e51(0x403)); } async function _0x230eac() { const _0x3525fb = _0x27dd8f; if (_0x3525fb(0x3e0) === _0x3525fb(0x288)) { const _0x4a3c80 = _0x356e00['activeMeetingScriptQueue'][_0x3525fb(0x43e)](); _0x8818f9['textContent'] = _0x4a3c80[_0x3525fb(0x234)] === _0x3525fb(0x24c) ? '旁白' : _0x4a3c80[_0x3525fb(0x234)], _0x482985[_0x3525fb(0x2d0)] = _0x4a3c80[_0x3525fb(0x805)], _0x4a3c80[_0x3525fb(0x234)] !== _0x3525fb(0x24c) && _0x51f860(_0x5eebc7['activeMeetingCharId'], _0x4a3c80[_0x3525fb(0x49d)]); } else { const _0x26cbfe = document[_0x3525fb(0x5b7)](_0x3525fb(0x5b4))[_0x3525fb(0x73f)]; if (!_0x26cbfe) return; const _0x5af2cc = await _0x4512da('确定要删除这个条目吗？此操作不可撤销。'); _0x5af2cc && (_0x557cc6[_0x3525fb(0x694)] = _0x557cc6[_0x3525fb(0x694)][_0x3525fb(0x1d8)](_0x1f778f => _0x1f778f['id'] !== _0x26cbfe), _0x557cc6[_0x3525fb(0x618)]['forEach'](_0x7a3df9 => { const _0x42b26f = _0x3525fb; _0x7a3df9[_0x42b26f(0x674)] && (_0x42b26f(0x462) !== _0x42b26f(0x462) ? _0x28a974(_0x9bc062['id']) : _0x7a3df9[_0x42b26f(0x674)] = _0x7a3df9[_0x42b26f(0x674)]['filter'](_0x12880d => _0x12880d !== _0x26cbfe)); }), _0x162000(), _0x599dea(_0x3525fb(0x182)), _0x503023(), _0x4f27ca(_0x3525fb(0x2ce), _0x3525fb(0x403))); } } function _0x119365() { const _0x55fedc = _0x27dd8f; if (_0x55fedc(0x82b) !== _0x55fedc(0x771)) { const _0x18d3ee = document[_0x55fedc(0x5b7)]('world-book-checkboxes-container'), _0x28d681 = _0x18d3ee[_0x55fedc(0x687)](_0x55fedc(0x750)), _0x1f51a7 = document[_0x55fedc(0x5ab)](_0x55fedc(0x19d)); if (_0x28d681[_0x55fedc(0x7a6)] === 0x0) _0x55fedc(0x806) === 'xLUuy' ? _0x8c705c += _0x55fedc(0x5b0) : _0x1f51a7['textContent'] = _0x55fedc(0x7f7); else { if (_0x28d681['length'] > 0x2) _0x1f51a7[_0x55fedc(0x2d0)] = '已选择\x20' + _0x28d681[_0x55fedc(0x7a6)] + '\x20项'; else { if (_0x55fedc(0x4e2) !== _0x55fedc(0x55e)) _0x1f51a7[_0x55fedc(0x2d0)] = Array[_0x55fedc(0x652)](_0x28d681)['map'](_0x299efc => _0x299efc['parentElement'][_0x55fedc(0x2d0)][_0x55fedc(0xf2)]())[_0x55fedc(0x566)]('、'); else { const _0x4648b3 = _0x186ea1(_0x288cfd['content']); _0x408a36['assign'](_0x48ba7e, { 'content': _0x4648b3['content'], 'quotedMessage': _0x4648b3['quotedMessage'] }); } } } } else _0x4cefc3 += '\x20(分享了歌曲:\x20' + _0x422258[_0x55fedc(0x6c8)] + '\x20-\x20' + _0x1b9fd0[_0x55fedc(0x1e4)] + ')'; } function _0x31c22d(_0x316157) { const _0x27de42 = _0x27dd8f, _0xef007e = _0x557cc6[_0x27de42(0x46d)][_0x27de42(0x4d1)](_0x378478 => _0x378478['id'] === _0x316157); if (!_0xef007e || _0xef007e[_0x27de42(0x516)] !== _0x27de42(0x3fd)) return; document[_0x27de42(0x5b7)](_0x27de42(0x5d6))[_0x27de42(0x73f)] = _0xef007e['name'] || '', _0x220a06(_0x27de42(0x67a)), document['getElementById'](_0x27de42(0x67a))[_0x27de42(0x73f)] = _0xef007e[_0x27de42(0x2a6)] || _0x557cc6['activeUserProfileId']; const _0xc83472 = document['getElementById'](_0x27de42(0x45b)); _0xc83472[_0x27de42(0x7a2)] = '', _0x557cc6[_0x27de42(0x694)][_0x27de42(0x302)](_0x18ff3f => { const _0x562657 = _0x27de42, _0x359527 = _0xef007e['linkedWorldBookIds']?.[_0x562657(0x158)](_0x18ff3f['id']), _0x3f40d6 = document[_0x562657(0x5ba)](_0x562657(0x28b)); _0x3f40d6['innerHTML'] = '<input\x20type=\x22checkbox\x22\x20value=\x22' + _0x18ff3f['id'] + '\x22\x20' + (_0x359527 ? _0x562657(0x1c8) : '') + '>\x20' + _0x18ff3f[_0x562657(0x293)], _0xc83472['appendChild'](_0x3f40d6); }), _0x61d4e9(); const _0x28e296 = document[_0x27de42(0x5b7)](_0x27de42(0x2f6)), _0x189a0c = document[_0x27de42(0x5b7)](_0x27de42(0x46a)); _0x2aeef5('group_avatar_' + _0x316157)[_0x27de42(0x192)](_0x195fbb => { const _0x991182 = _0x27de42; 'rLqMi' === _0x991182(0x56b) ? _0x28e296[_0x991182(0x483)] = _0x195fbb ? URL[_0x991182(0x371)](_0x195fbb) : _0x1732e7 : _0x2b8eff[_0x991182(0xa8)] = _0x341dc2[_0x991182(0xa8)]; }), _0x2aeef5('group_bg_' + _0x316157)[_0x27de42(0x192)](_0x52fa61 => { const _0x5b78ab = _0x27de42; _0x189a0c[_0x5b78ab(0x483)] = _0x52fa61 ? URL[_0x5b78ab(0x371)](_0x52fa61) : ''; }), _0x4f27ca('groupSettings', 'chat'); } async function _0xc9a137() { const _0x387963 = _0x27dd8f, _0x2c5c59 = _0x5db7d2(); if (!_0x2c5c59 || _0x2c5c59['type'] !== 'group') return; const _0xda0505 = document[_0x387963(0x5b7)](_0x387963(0x5d6))['value']['trim'](); if (!_0xda0505) { if (_0x387963(0x47f) === _0x387963(0x47f)) { _0x599dea(_0x387963(0x27c)); return; } else _0x4a0553(_0x4cb48d['id']), _0x330a96(!![]); } _0x2c5c59[_0x387963(0x293)] = _0xda0505; const _0x49a26d = document[_0x387963(0x687)]('#group-world-book-checkboxes\x20input:checked'); _0x2c5c59[_0x387963(0x674)] = Array[_0x387963(0x652)](_0x49a26d)[_0x387963(0x30e)](_0x8148cc => _0x8148cc[_0x387963(0x73f)]), _0x2c5c59[_0x387963(0x2a6)] = document[_0x387963(0x5b7)](_0x387963(0x67a))[_0x387963(0x73f)]; const _0x4ce0a3 = document[_0x387963(0x5b7)](_0x387963(0x3e3))[_0x387963(0x209)][0x0], _0x2f52ac = document[_0x387963(0x5b7)]('group-bg-input')[_0x387963(0x209)][0x0]; if (_0x4ce0a3) await _0x3aff46(_0x387963(0x23a) + _0x2c5c59['id'], _0x4ce0a3); if (_0x2f52ac) await _0x3aff46('group_bg_' + _0x2c5c59['id'], _0x2f52ac); _0x162000(), _0x198f0b(), await _0x18d2c5(), _0x599dea('群聊设置已保存！'), _0x4f27ca('chat', _0x387963(0x388)); } function _0x61d4e9() { const _0x1c67ce = _0x27dd8f, _0x56fa92 = document[_0x1c67ce(0x5b7)](_0x1c67ce(0x45b)), _0x341d78 = _0x56fa92[_0x1c67ce(0x687)](_0x1c67ce(0x750)), _0x47ecea = document[_0x1c67ce(0x5ab)](_0x1c67ce(0x7f)); if (_0x341d78[_0x1c67ce(0x7a6)] === 0x0) 'oUKFo' === _0x1c67ce(0x7c1) ? _0x47ecea[_0x1c67ce(0x2d0)] = _0x1c67ce(0x7f7) : (_0x48d697['error'](_0x1c67ce(0x3e1) + _0x321529['id'] + _0x1c67ce(0x1e8), _0xadc427), _0xe70579['src'] = _0xe0173b[_0x1c67ce(0x51e)] || _0x2cee3d); else _0x341d78[_0x1c67ce(0x7a6)] > 0x2 ? _0x47ecea[_0x1c67ce(0x2d0)] = _0x1c67ce(0x1c5) + _0x341d78[_0x1c67ce(0x7a6)] + '\x20项' : _0x47ecea['textContent'] = Array['from'](_0x341d78)[_0x1c67ce(0x30e)](_0x4cd1fc => _0x4cd1fc[_0x1c67ce(0x357)][_0x1c67ce(0x2d0)]['trim']())[_0x1c67ce(0x566)]('、'); } async function _0xfe31ac() { const _0x6a1b2b = _0x27dd8f; if (_0x6a1b2b(0x402) !== _0x6a1b2b(0x402)) { _0x691099[_0x6a1b2b(0x7a2)] = _0x6a1b2b(0x797); return; } else { const _0x5457c9 = _0x5db7d2(), _0x18e4e5 = (_0x5457c9?.[_0x6a1b2b(0x765)] || [])[_0x6a1b2b(0x30e)](_0x3132c6)[_0x6a1b2b(0x1d8)](Boolean), _0x48dd25 = _0x40920c(_0x5457c9['id']); if (!_0x5457c9 || _0x5457c9[_0x6a1b2b(0x516)] !== _0x6a1b2b(0x3fd) || _0x18e4e5[_0x6a1b2b(0x7a6)] < 0x2) return null; const _0x12f438 = _0x5457c9[_0x6a1b2b(0x674)] && _0x5457c9['linkedWorldBookIds']['length'] > 0x0 ? '\x0a\x0a#\x20核心群聊世界观设定\x20(所有角色必须严格遵守以下设定)\x0a' + _0x5457c9[_0x6a1b2b(0x674)]['map'](_0x5b32b3 => _0x557cc6[_0x6a1b2b(0x694)][_0x6a1b2b(0x4d1)](_0x516f67 => _0x516f67['id'] === _0x5b32b3))[_0x6a1b2b(0x1d8)](Boolean)[_0x6a1b2b(0x30e)](_0x832b39 => _0x6a1b2b(0x217) + _0x832b39[_0x6a1b2b(0x293)] + '\x0a' + _0x832b39[_0x6a1b2b(0x398)])[_0x6a1b2b(0x566)]('') : '', _0x1d5b91 = _0x48dd25['persona'] ? _0x6a1b2b(0x1f3) + _0x48dd25[_0x6a1b2b(0x293)] + _0x6a1b2b(0x52b) + _0x48dd25[_0x6a1b2b(0x6f2)] : ''; let _0x2caffa = ''; const _0x452a70 = new Date(), _0x7f7a4a = _0x557cc6['conversationHistory']['at'](-0x1); _0x2caffa += _0x6a1b2b(0x79e) + _0x452a70['toLocaleString'](_0x6a1b2b(0x6ef), { 'dateStyle': _0x6a1b2b(0x373), 'timeStyle': _0x6a1b2b(0x144) }); if (_0x7f7a4a) { if (_0x6a1b2b(0x39b) === _0x6a1b2b(0x39b)) { const _0x12eb05 = new Date(_0x7f7a4a[_0x6a1b2b(0x798)]), _0x49ceb3 = Math[_0x6a1b2b(0x660)]((_0x452a70 - _0x12eb05) / (0x3e8 * 0x3c)); if (_0x49ceb3 < 0x5) _0x2caffa += _0x6a1b2b(0x678); else { if (_0x49ceb3 < 0x78) _0x2caffa += _0x6a1b2b(0x53c) + _0x49ceb3 + _0x6a1b2b(0x77f); else { const _0x49cce4 = Math[_0x6a1b2b(0x660)](_0x49ceb3 / 0x3c); if (_0x49cce4 < 0x30) _0x2caffa += '\x0a-\x20**对话状态**:\x20群里在' + _0x49cce4 + _0x6a1b2b(0x80e); else _0x2caffa += _0x6a1b2b(0x72e) + Math[_0x6a1b2b(0x660)](_0x49cce4 / 0x18) + _0x6a1b2b(0x3b4); } } } else _0x76641f['classList'][_0x6a1b2b(0x632)](_0x6a1b2b(0x1c6)); } else _0x2caffa += '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。'; const _0x2aaf36 = [..._0x557cc6[_0x6a1b2b(0x5b8)]][_0x6a1b2b(0x4a4)]()[_0x6a1b2b(0x4d1)](_0xf66f10 => _0xf66f10[_0x6a1b2b(0x7b4)] === _0x6a1b2b(0x472))?.[_0x6a1b2b(0x398)] || '', _0x2dde20 = _0xb72c9(_0x5457c9, _0x2aaf36), _0x28b6ec = _0x557cc6[_0x6a1b2b(0x5b8)]['slice'](-0x78), _0x3c7d7d = _0x56624c[_0x6a1b2b(0x30e)](_0x49399a => _0x49399a[_0x6a1b2b(0x293)]), _0x543e52 = _0x1ad6ce(), _0x3d4a03 = _0x18e4e5[_0x6a1b2b(0x30e)](_0x4c900c => { const _0x205f29 = _0x6a1b2b; if (_0x205f29(0x11a) !== _0x205f29(0x11a)) _0x3abeb7[_0x205f29(0x7a2)] = _0x205f29(0x427) + _0x1b3a36 + _0x205f29(0x46e) + (_0x47c359 === _0x205f29(0x105) ? '#a7c7e7' : '#f2b7c6') + _0x205f29(0xb0) + _0x106cce + _0x205f29(0x80a) + _0x46665e; else { const { omniText: _0x3217e0 } = _0x576fb7(_0x4c900c['id'], _0x5457c9['id']), _0x41f42d = _0x129229(_0x4c900c['id']), _0x1e2e9f = _0x4c900c['linkedWorldBookIds'] && _0x4c900c['linkedWorldBookIds'][_0x205f29(0x7a6)] > 0x0 ? _0x205f29(0x261) + _0x4c900c[_0x205f29(0x293)] + '的个人专属世界观设定\x0a' + _0x4c900c['linkedWorldBookIds'][_0x205f29(0x30e)](_0x8737df => _0x557cc6[_0x205f29(0x694)]['find'](_0x592bdd => _0x592bdd['id'] === _0x8737df))[_0x205f29(0x1d8)](Boolean)['map'](_0x4e6a95 => '\x0a##\x20条目:\x20' + _0x4e6a95[_0x205f29(0x293)] + '\x0a' + _0x4e6a95[_0x205f29(0x398)])['join']('') : ''; return { 'id': _0x4c900c['id'], 'name': _0x4c900c[_0x205f29(0x293)], 'persona': _0x4c900c['persona'] || '乐于助人的助手', 'memory': _0x3217e0 + _0x41f42d + _0x1e2e9f }; } }), _0x348476 = 0x5, _0x442d96 = 0xc, _0x59ed7f = _0x6a1b2b(0x6fd)[_0x6a1b2b(0xf2)](), _0x4970ac = { 'instruction': (_0x6a1b2b(0x576) + (_0x48dd25[_0x6a1b2b(0x293)] || '用户') + '”的群聊规划角色们的下一步发言。\x0a-\x20与你们对话的人类用户名为“' + (_0x48dd25[_0x6a1b2b(0x293)] || '用户') + '”。在分析历史记录时，请记住这一点，并用此名称指代用户。\x0a-\x20【最重要】为\x20`personas`\x20列表中的【每一位】角色都规划至少一个事件(通常不少于2个)。不能遗漏任何角色。\x0a-\x20【新增规则】你可以规划\x20\x22kind\x22:\x20\x22music\x22\x20事件来分享音乐。此时，你【必须】同时提供\x20\x22songName\x22\x20和\x20\x22artist\x22\x20字段。\x0a-\x20你的首要任务是产出一个严格遵守SCHEMA、语法完全正确的、可被解析的JSON对象。\x0a-\x20若用户\x20`@`\x20了某个角色\x20(见\x20`mentioned`)，该角色应优先发言。\x0a-\x20事件总数必须控制在\x20' + _0x348476 + _0x6a1b2b(0x137) + _0x442d96 + _0x6a1b2b(0x25d) + (_0x48dd25['name'] || '用户') + _0x6a1b2b(0xcb) + _0x2caffa + '\x20\x0a' + _0x1d5b91 + '\x0a' + _0x12f438 + _0x6a1b2b(0x13b) + _0x543e52 + '\x0a')[_0x6a1b2b(0xf2)](), 'personas': _0x3d4a03, 'mentioned': _0x2dde20 ? { 'id': _0x2dde20['id'], 'name': _0x2dde20['name'] } : null, 'stickerList': _0x3c7d7d }, _0x4a4f87 = { 'type': _0x6a1b2b(0x4b9), 'properties': { 'events': { 'type': 'array', 'items': { 'type': _0x6a1b2b(0x4b9), 'required': ['senderId', _0x6a1b2b(0x15c)], 'properties': { 'senderId': { 'type': _0x6a1b2b(0x286) }, 'kind': { 'type': 'string', 'enum': [_0x6a1b2b(0x68e), _0x6a1b2b(0x475), 'music'] }, 'content': { 'type': _0x6a1b2b(0x286) }, 'sticker': { 'type': _0x6a1b2b(0x286) }, 'songName': { 'type': _0x6a1b2b(0x286) }, 'artist': { 'type': 'string' } } } } }, 'required': [_0x6a1b2b(0x4c7)] }, _0x2bb760 = []; _0x2bb760['push']({ 'role': _0x6a1b2b(0x14b), 'content': _0x59ed7f }); for (const _0x4d9728 of _0x28b6ec) { const _0x47af14 = _0x4d9728[_0x6a1b2b(0x7b4)] === 'ai' || _0x4d9728[_0x6a1b2b(0x7b4)] === _0x6a1b2b(0x77b) ? _0x6a1b2b(0x77b) : _0x6a1b2b(0x472); let _0x1eb988 = { 'role': _0x47af14, 'content': _0x4d9728['content'] }, _0x3d3498 = !!_0x4d9728[_0x6a1b2b(0x398)], _0x180ef5 = null; if (_0x4d9728[_0x6a1b2b(0x690)]) _0x180ef5 = _0x4d9728[_0x6a1b2b(0x690)]; else { if (_0x4d9728[_0x6a1b2b(0x8c)]) try { if (_0x6a1b2b(0x5a6) === _0x6a1b2b(0x1b1)) return { 'url': _0x2a7aa2, 'cover': _0x265480['cover'], 'source': _0x533dd6 }; else { const _0x426aea = await _0x2aeef5(_0x4d9728['imageId']); _0x426aea && (_0x180ef5 = await _0x27ec3a(_0x426aea)); } } catch (_0x5de879) { console[_0x6a1b2b(0x50e)](_0x6a1b2b(0x804), _0x5de879); } } if (_0x180ef5) { if (_0x6a1b2b(0x455) !== _0x6a1b2b(0x455)) { const _0x19fd1a = _0x4b68ab(); if (!_0x19fd1a) { _0x26ef26[_0x6a1b2b(0x2d0)] = _0x6a1b2b(0x5a0); return; } if (_0x19fd1a[_0x6a1b2b(0x516)] === _0x6a1b2b(0x405)) { const _0x52a57e = _0x3b2ec4(_0x19fd1a[_0x6a1b2b(0x765)][0x0]); _0x49aa08[_0x6a1b2b(0x2d0)] = _0x52a57e ? _0x52a57e[_0x6a1b2b(0x293)] : _0x6a1b2b(0x5c5); } else _0x2566e5[_0x6a1b2b(0x2d0)] = _0x19fd1a['name'] || _0x6a1b2b(0x4bc) + _0x19fd1a[_0x6a1b2b(0x765)][_0x6a1b2b(0x7a6)] + ')'; } else _0x1eb988[_0x6a1b2b(0x690)] = _0x180ef5, _0x3d3498 = !![]; } _0x3d3498 && _0x2bb760['push'](_0x1eb988); } _0x2bb760[_0x6a1b2b(0x6b4)]({ 'role': _0x6a1b2b(0x472), 'content': _0x6a1b2b(0x6fe) + JSON[_0x6a1b2b(0x82f)](_0x4a4f87) + _0x6a1b2b(0x34a) + JSON[_0x6a1b2b(0x82f)](_0x4970ac) }); try { const _0x45ff6e = await _0x2d20cc(_0x2bb760, { 'json': !![] }); if (!_0x45ff6e) return null; let _0x2e4c43 = _0x45ff6e[_0x6a1b2b(0xf2)](); const _0x3f0edf = _0x2e4c43[_0x6a1b2b(0x3ee)](/```json([\s\S]*?)```/i); if (_0x3f0edf) _0x2e4c43 = _0x3f0edf[0x1][_0x6a1b2b(0xf2)](); _0x2e4c43 = _0x565b5f(_0x2e4c43); let _0x5f03fe = null; try { _0x5f03fe = JSON[_0x6a1b2b(0x417)](_0x2e4c43); } catch (_0x612452) { console[_0x6a1b2b(0x50e)]('JSON\x20解析失败!\x20错误原因:', _0x612452), console[_0x6a1b2b(0x50e)](_0x6a1b2b(0x285), _0x2e4c43); } if (!_0x5f03fe || !Array[_0x6a1b2b(0x65c)](_0x5f03fe[_0x6a1b2b(0x4c7)])) return null; return _0x5f03fe = _0x591002(_0x5f03fe, _0x18e4e5, _0x3c7d7d), _0x5f03fe[_0x6a1b2b(0x4c7)] = _0x5f03fe[_0x6a1b2b(0x4c7)][_0x6a1b2b(0x186)](0x0, _0x442d96), _0x5f03fe['events'][_0x6a1b2b(0x7a6)] ? _0x5f03fe : null; } catch (_0x3bc5b3) { if (_0x6a1b2b(0x585) !== _0x6a1b2b(0x82d)) return _0x3bc5b3['name'] !== 'AbortError' && console[_0x6a1b2b(0x50e)](_0x6a1b2b(0x531), _0x3bc5b3), null; else { const _0x4861e7 = _0x507301(_0x2c3099['participantIds'][0x0]); _0x1e229f[_0x6a1b2b(0x2d0)] = _0x4861e7 ? _0x4861e7[_0x6a1b2b(0x293)] : '未知角色'; } } } } function _0x2f7b46() { const _0x589a3d = _0x27dd8f, _0x11101f = document[_0x589a3d(0x5b7)]('friend-circle-list-container'); _0x11101f[_0x589a3d(0x7a2)] = ''; if (_0x557cc6['friendCircles'][_0x589a3d(0x7a6)] === 0x0) { if (_0x589a3d(0x4df) === _0x589a3d(0x4df)) { _0x11101f[_0x589a3d(0x7a2)] = _0x589a3d(0x376); return; } else _0x1af7d1['style']['textShadow'] = ''; } _0x557cc6['friendCircles'][_0x589a3d(0x302)](_0x366f67 => { const _0xd9881f = _0x589a3d, _0x2fb3ca = _0x557cc6['userProfiles'][_0xd9881f(0x4d1)](_0x2ef5bd => _0x2ef5bd['id'] === _0x366f67[_0xd9881f(0x2a6)]) || { 'name': _0xd9881f(0x800) }, _0x794d56 = document[_0xd9881f(0x5ba)]('div'); _0x794d56['className'] = _0xd9881f(0x55d), _0x794d56['dataset']['id'] = _0x366f67['id'], _0x794d56[_0xd9881f(0x7a2)] = _0xd9881f(0x790) + _0x366f67[_0xd9881f(0x293)] + _0xd9881f(0x714) + _0x2fb3ca[_0xd9881f(0x293)] + _0xd9881f(0x76a) + _0x366f67[_0xd9881f(0x14c)][_0xd9881f(0x7a6)] + _0xd9881f(0x413), _0x794d56['addEventListener']('click', () => _0x37ba39(_0x366f67['id'])), _0x11101f['appendChild'](_0x794d56); }); } function _0x1f7aac(_0x513a19 = null) { const _0x5655d2 = _0x27dd8f; if (_0x5655d2(0x55a) === 'kWoGm') _0x3b5da4['name'] = _0x269e6a, _0x538806[_0x5655d2(0x2a6)] = _0xdc8c74, _0x3ff39f['memberCharacterIds'] = _0x4c96de; else { const _0x87dafe = document['getElementById'](_0x5655d2(0x4aa)), _0x16ac4e = document[_0x5655d2(0x5b7)](_0x5655d2(0x4b7)), _0x39b9a2 = document['getElementById'](_0x5655d2(0x292)), _0xe1679e = document['getElementById'](_0x5655d2(0x411)), _0x59a435 = document['getElementById'](_0x5655d2(0x789)), _0x37a7d4 = document['getElementById'](_0x5655d2(0x258)); _0x220a06(_0x5655d2(0x4b7)), _0x39b9a2[_0x5655d2(0x7a2)] = '', _0x557cc6[_0x5655d2(0x618)]['forEach'](_0x400f92 => { const _0x56b173 = _0x5655d2; if (_0x56b173(0x201) !== 'DYvNM') _0x1d519b[_0x56b173(0x7a2)] = '', _0x8d7994['forEach'](_0x402121 => { const _0x95da60 = _0x56b173, _0xbd6d9d = _0x4d89e4[_0x95da60(0x5ba)](_0x95da60(0x509)); _0xbd6d9d[_0x95da60(0x2d0)] = _0x402121, _0xbd6d9d['addEventListener'](_0x95da60(0x66b), () => { const _0x547378 = _0x95da60; _0x27b508[_0x547378(0x73f)] = _0x402121, _0x5d4eeb[_0x547378(0x35f)][_0x547378(0x7ff)](_0x547378(0x1c6)); }), _0x2e88c9[_0x95da60(0x796)](_0xbd6d9d); }), _0x53fd58['classList'][_0x56b173(0x632)](_0x56b173(0x1c6)), _0x48d78e(_0x56b173(0x743) + _0x59d791[_0x56b173(0x7a6)] + _0x56b173(0x64d)); else { const _0x18e46f = document[_0x56b173(0x5ba)](_0x56b173(0x509)); _0x18e46f[_0x56b173(0x640)] = _0x56b173(0x5d5), _0x18e46f[_0x56b173(0x7a2)] = _0x56b173(0x131) + _0x400f92['id'] + _0x56b173(0x465) + _0x400f92['id'] + _0x56b173(0x15f) + (_0x400f92['avatar'] || _0x1732e7) + _0x56b173(0x6d9) + _0x400f92['id'] + '\x22\x20class=\x22char-name\x22>' + _0x400f92[_0x56b173(0x293)] + _0x56b173(0x75c), _0x39b9a2['appendChild'](_0x18e46f); } }); if (_0x513a19) { if (_0x5655d2(0x58e) !== _0x5655d2(0x328)) { const _0x368dcd = _0x557cc6[_0x5655d2(0x78e)][_0x5655d2(0x4d1)](_0x443973 => _0x443973['id'] === _0x513a19); if (!_0x368dcd) return; _0xe1679e[_0x5655d2(0x2d0)] = _0x5655d2(0x460), _0x59a435[_0x5655d2(0x73f)] = _0x368dcd['id'], _0x87dafe[_0x5655d2(0x73f)] = _0x368dcd[_0x5655d2(0x293)], _0x16ac4e['value'] = _0x368dcd[_0x5655d2(0x2a6)], _0x37a7d4[_0x5655d2(0x6ca)][_0x5655d2(0x836)] = _0x5655d2(0x534), _0x368dcd[_0x5655d2(0x14c)]['forEach'](_0xae8dd4 => { const _0x4eded6 = _0x5655d2; if (_0x4eded6(0x74a) === _0x4eded6(0xe1)) _0x24bd44 = _0x40370b[_0x4eded6(0x5cb)][0x0][_0x4eded6(0x1f7)], _0x390e81 = _0x49978d[_0x4eded6(0x5cb)][0x0][_0x4eded6(0x63c)], _0x199343 = !![], _0x29dea9 = ''; else { const _0x364795 = _0x39b9a2[_0x4eded6(0x5ab)]('#member-select-' + _0xae8dd4); if (_0x364795) _0x364795[_0x4eded6(0x1c8)] = !![]; } }); } else _0xd751cc[_0x5655d2(0x78e)] = _0x2a256b['friendCircles'][_0x5655d2(0x1d8)](_0x2ba30 => _0x2ba30['id'] !== _0x5ff772), _0x684393[_0x5655d2(0x761)] === _0x50b6a7 && (_0x163135[_0x5655d2(0x761)] = null), _0x202ba4(), _0x4be711(_0x5655d2(0x255)), _0x2a7400(), _0x4251e1(_0x5655d2(0xf1), 'friendCircleEdit'); } else _0xe1679e[_0x5655d2(0x2d0)] = _0x5655d2(0x41e), _0x59a435['value'] = '', _0x87dafe[_0x5655d2(0x73f)] = _0x5655d2(0x11b) + (_0x557cc6[_0x5655d2(0x78e)][_0x5655d2(0x7a6)] + 0x1), _0x16ac4e['value'] = _0x557cc6[_0x5655d2(0x26a)], _0x37a7d4[_0x5655d2(0x6ca)][_0x5655d2(0x836)] = _0x5655d2(0x4e3); _0x4f27ca(_0x5655d2(0x40a), _0x5655d2(0xf1)); } } function _0x4337ba() { const _0x16075a = _0x27dd8f, _0x31460f = document[_0x16075a(0x5b7)](_0x16075a(0x789))[_0x16075a(0x73f)], _0x1de30c = document[_0x16075a(0x5b7)](_0x16075a(0x4aa))[_0x16075a(0x73f)]['trim'](), _0x50225b = document[_0x16075a(0x5b7)](_0x16075a(0x4b7))[_0x16075a(0x73f)], _0x2500f1 = Array[_0x16075a(0x652)](document[_0x16075a(0x687)](_0x16075a(0x547)))['map'](_0x13e1ea => _0x13e1ea[_0x16075a(0x78)]['id']); if (!_0x1de30c) { _0x599dea(_0x16075a(0x758)); return; } if (_0x2500f1['length'] === 0x0) { _0x599dea('至少要选择一个圈内成员！'); return; } if (_0x31460f) { const _0x5a9b70 = _0x557cc6[_0x16075a(0x78e)][_0x16075a(0x4d1)](_0x54d1e4 => _0x54d1e4['id'] === _0x31460f); if (_0x5a9b70) { if ('caGvW' === _0x16075a(0x68a)) return _0x318ffd(new _0x41ce3c(_0x16075a(0x7e))); else _0x5a9b70[_0x16075a(0x293)] = _0x1de30c, _0x5a9b70[_0x16075a(0x2a6)] = _0x50225b, _0x5a9b70[_0x16075a(0x14c)] = _0x2500f1; } } else { if (_0x16075a(0x82c) === 'PkFGC') { const _0x1920a2 = { 'id': 'circle_' + Date['now'](), 'name': _0x1de30c, 'boundUserProfileId': _0x50225b, 'memberCharacterIds': _0x2500f1, 'posts': [] }; _0x557cc6[_0x16075a(0x78e)][_0x16075a(0x6b4)](_0x1920a2); } else _0x1481b1('这本日记本来就是空的，你还想清空什么？'); } _0x162000(), _0x599dea(_0x16075a(0x3c9)), _0x2f7b46(), _0x4f27ca(_0x16075a(0xf1), _0x16075a(0x40a)); } async function _0x10dbba() { const _0x220404 = _0x27dd8f; if ('PCWBs' === _0x220404(0x5b1)) { _0x3eb6a9(![]), _0x5528ea(_0x220404(0x7f0)); return; } else { const _0x218e28 = document[_0x220404(0x5b7)](_0x220404(0x789))[_0x220404(0x73f)]; if (!_0x218e28) return; const _0x17da6f = await _0x4512da(_0x220404(0x66d)); _0x17da6f && (_0x557cc6[_0x220404(0x78e)] = _0x557cc6['friendCircles'][_0x220404(0x1d8)](_0x5b264a => _0x5b264a['id'] !== _0x218e28), _0x557cc6[_0x220404(0x761)] === _0x218e28 && (_0x557cc6[_0x220404(0x761)] = null), _0x162000(), _0x599dea('好友圈已删除。'), _0x2f7b46(), _0x4f27ca(_0x220404(0xf1), _0x220404(0x40a))); } } function _0x37ba39(_0x415149) { const _0x118a0e = _0x27dd8f; _0x3abf28(); const _0x37168a = _0x557cc6[_0x118a0e(0x78e)]['find'](_0x13314b => _0x13314b['id'] === _0x415149); if (!_0x37168a) return; _0x557cc6[_0x118a0e(0x761)] = _0x415149, _0x162000(), document['getElementById']('friend-circle-title')[_0x118a0e(0x2d0)] = _0x37168a['name'], _0x5de4bd(), _0x4f27ca(_0x118a0e(0x164), 'friendCircleList'), _0x41261e(); } function _0x338f1b() { const _0x2fa4cd = _0x27dd8f; if (_0x2fa4cd(0x4a8) === 'GZddO') _0x4ad1de['src'] = _0x55f456[_0x2fa4cd(0x690)]; else { if (!_0x557cc6[_0x2fa4cd(0x78e)] || _0x557cc6[_0x2fa4cd(0x78e)][_0x2fa4cd(0x7a6)] === 0x0) { console['error']('错误：你还没有创建任何好友圈。请先在App内创建一个。'); return; } const _0x594ffb = _0x557cc6[_0x2fa4cd(0x78e)][0x0]; if (_0x594ffb[_0x2fa4cd(0x14c)]['length'] < 0x2) { console['error']('错误：第一个好友圈\x20\x22' + _0x594ffb['name'] + _0x2fa4cd(0xd3)); return; } const _0x53d105 = { 'id': _0x2fa4cd(0x6ea) + Date[_0x2fa4cd(0x183)](), 'authorType': _0x2fa4cd(0x380), 'authorId': _0x594ffb['memberCharacterIds'][0x0], 'content': _0x2fa4cd(0x3b3), 'timestamp': Date[_0x2fa4cd(0x183)](), 'likes': [_0x594ffb[_0x2fa4cd(0x14c)][0x1]], 'comments': [{ 'commentId': 'c_' + Date[_0x2fa4cd(0x183)](), 'authorId': _0x594ffb['memberCharacterIds'][0x1], 'content': _0x2fa4cd(0x6a7) }] }; _0x594ffb[_0x2fa4cd(0x18a)][_0x2fa4cd(0x6b4)](_0x53d105), _0x162000(), console[_0x2fa4cd(0x235)]('成功向好友圈\x20\x22' + _0x594ffb[_0x2fa4cd(0x293)] + '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。'), _0x599dea('测试动态已添加！'); } } window[_0x27dd8f(0x24f)] = _0x338f1b; function _0x3a4665(_0x4efa4e) { const _0x4aaa8a = _0x27dd8f; return _0x557cc6[_0x4aaa8a(0x58d)][_0x4aaa8a(0x4d1)](_0x1702ca => _0x1702ca['id'] === _0x4efa4e); } function _0x2158b6(_0x39aec3, _0x582f90 = '正在处理...') { const _0xafd1b0 = _0x27dd8f, _0x195f47 = document[_0xafd1b0(0x5b7)](_0xafd1b0(0x22d)); let _0x4b01cf = document[_0xafd1b0(0x5b7)](_0xafd1b0(0x1a7)); _0x39aec3 ? 'UnwAp' === _0xafd1b0(0x35c) ? (!_0x4b01cf && (_0x4b01cf = document[_0xafd1b0(0x5ba)]('div'), _0x4b01cf['id'] = 'feed-loader', _0x195f47['appendChild'](_0x4b01cf)), _0x4b01cf[_0xafd1b0(0x7a2)] = _0xafd1b0(0x604) + _0x582f90 + _0xafd1b0(0x2bc), _0x4b01cf['style'][_0xafd1b0(0x836)] = _0xafd1b0(0x177)) : _0x4670ab['boundUserProfileId'] === _0x2abe95 && (_0x4f32c6[_0xafd1b0(0x2a6)] = _0x2ebb1b[_0xafd1b0(0x26a)]) : _0x4b01cf && (_0x4b01cf[_0xafd1b0(0x6ca)][_0xafd1b0(0x836)] = _0xafd1b0(0x4e3)); } async function _0x4dc741() { const _0xa35915 = _0x27dd8f; if (_0xa35915(0x61e) !== 'XQozO') _0x42fd86['classList']['remove'](_0xa35915(0x154), _0xa35915(0x5e5)), _0x4ccfe6[_0xa35915(0x35f)]['remove'](_0xa35915(0x1c0)), _0x1c0b99['diaryCurrentPage'] = _0x17154b, _0x4cd640(), _0x23b2e8[_0xa35915(0x28c)] = ![]; else { const _0x30168c = _0x557cc6[_0xa35915(0x78e)][_0xa35915(0x4d1)](_0x596b83 => _0x596b83['id'] === _0x557cc6[_0xa35915(0x761)]); if (!_0x30168c || _0x557cc6[_0xa35915(0x161)]) return; _0x2158b6(!![], _0xa35915(0x1e9)), _0x557cc6['isGenerating'] = !![]; try { let _0x253624 = Date[_0xa35915(0x183)](); _0x30168c[_0xa35915(0x18a)] && _0x30168c['posts'][_0xa35915(0x7a6)] > 0x0 && (_0x253624 = Math[_0xa35915(0xdc)](..._0x30168c['posts']['map'](_0xf8f5f7 => _0xf8f5f7['timestamp']))); const _0x56d6db = await _0x135b38(_0x30168c); if (!_0x56d6db || _0x56d6db[_0xa35915(0x7a6)] === 0x0) { _0x599dea(_0xa35915(0x404)); return; } const _0x29d9f7 = _0x56d6db[_0xa35915(0x30e)](async (_0x4deb1e, _0x3b9328) => { const _0x248d82 = _0xa35915; _0x2158b6(!![], _0x248d82(0x4e7) + (_0x3b9328 + 0x1) + _0x248d82(0x655) + _0x56d6db['length'] + _0x248d82(0x329)); const _0xb744c7 = _0x253624 + (_0x3b9328 + 0x1) * 0x3c * 0x3e8, _0x321c54 = { 'id': _0x248d82(0x26c) + _0x4deb1e[_0x248d82(0x25f)] + '_' + _0xb744c7, 'authorType': _0x248d82(0x380), 'authorId': _0x4deb1e[_0x248d82(0x25f)], 'content': _0x4deb1e['postContent'], 'timestamp': _0xb744c7, 'likes': _0x4deb1e[_0x248d82(0x304)] || [], 'comments': (_0x4deb1e[_0x248d82(0x7b)] || [])['map']((_0x41bc97, _0x504328) => ({ 'commentId': 'c_' + _0xb744c7 + '_' + _0x504328, 'authorId': _0x41bc97[_0x248d82(0x25f)], 'content': _0x41bc97[_0x248d82(0x398)] })) }; if (_0x4deb1e[_0x248d82(0x650)] === _0x248d82(0x164) && _0x4deb1e[_0x248d82(0x6c8)] && _0x4deb1e[_0x248d82(0x1e4)]) try { const _0x36b8f8 = await _0x5b6497(_0x4deb1e[_0x248d82(0x6c8)], _0x4deb1e['artist']); _0x321c54[_0x248d82(0x516)] = _0x248d82(0x164), _0x321c54['songName'] = _0x4deb1e['songName'], _0x321c54[_0x248d82(0x1e4)] = _0x4deb1e['artist'], _0x321c54['coverUrl'] = _0x36b8f8[_0x248d82(0x791)], _0x321c54[_0x248d82(0x69f)] = _0x36b8f8[_0x248d82(0x606)]; } catch (_0x486c65) { console[_0x248d82(0x50e)](_0x248d82(0x33f), _0x486c65), _0x321c54[_0x248d82(0x516)] = 'text'; } else { if ('RXkgs' !== _0x248d82(0x356)) _0x321c54['type'] = _0x248d82(0x68e); else { const _0x59edff = new _0xd7c458(_0x336715[_0x248d82(0x798)])['toLocaleTimeString'](_0x248d82(0x6ef), { 'hour': _0x248d82(0x845), 'minute': '2-digit' }); _0x4c5f56[_0x248d82(0x398)] && _0x502b07[_0x248d82(0x6b4)]('[' + _0x59edff + ']\x20[' + _0xc46be(_0x24bf82) + ']\x20' + _0x3ce124(_0x3cb982[_0x248d82(0x398)])['trim']()); } } return _0x321c54; }), _0x50236d = await Promise[_0xa35915(0x437)](_0x29d9f7); _0x30168c[_0xa35915(0x18a)]['push'](..._0x50236d), _0x162000(); } catch (_0x4aeeb3) { console['error'](_0xa35915(0x4b8), _0x4aeeb3), _0x599dea('生成动态时发生错误:\x20' + _0x4aeeb3[_0xa35915(0x832)]); } finally { 'oLWrC' === _0xa35915(0x382) ? (_0x39b86d['pause'](), _0x2f9d7c[_0xa35915(0x5ab)](_0xa35915(0x5e1))['textContent'] = '▶') : (_0x5de4bd(), _0x2158b6(![]), _0x557cc6[_0xa35915(0x161)] = ![]); } } } async function _0x135b38(_0x3bfe54) { const _0x57d5e4 = _0x27dd8f, _0x459ca5 = _0x3bfe54[_0x57d5e4(0x14c)][_0x57d5e4(0x30e)](_0x2299aa => _0x3132c6(_0x2299aa))['filter'](Boolean); if (_0x459ca5[_0x57d5e4(0x7a6)] === 0x0) return null; const _0xe60e01 = _0x1ad6ce(), _0x457f20 = _0x3a4665(_0x3bfe54[_0x57d5e4(0x2a6)]) || _0x557cc6['userProfiles'][0x0], _0xad29f9 = _0x457f20 ? _0x57d5e4(0x44d) + _0x457f20['name'] + _0x57d5e4(0x755) + (_0x457f20['persona'] || '无') + '\x0a' : '', _0x43d1b0 = _0x459ca5['map'](_0x3ef2da => { const _0x119bb6 = _0x57d5e4, { omniText: _0x1d73f7 } = _0x576fb7(_0x3ef2da['id'], null), _0x26ae5d = _0x129229(_0x3ef2da['id']), _0x14e645 = _0x3ef2da[_0x119bb6(0x674)] && _0x3ef2da[_0x119bb6(0x674)][_0x119bb6(0x7a6)] > 0x0 ? _0x119bb6(0x261) + _0x3ef2da['name'] + '的个人专属世界观设定\x0a' + _0x3ef2da['linkedWorldBookIds'][_0x119bb6(0x30e)](_0x571131 => _0x557cc6[_0x119bb6(0x694)][_0x119bb6(0x4d1)](_0x117d18 => _0x117d18['id'] === _0x571131))['filter'](Boolean)[_0x119bb6(0x30e)](_0x395651 => '\x0a##\x20条目:\x20' + _0x395651[_0x119bb6(0x293)] + '\x0a' + _0x395651[_0x119bb6(0x398)])[_0x119bb6(0x566)]('') : ''; return _0x119bb6(0x56f) + _0x3ef2da[_0x119bb6(0x293)] + _0x119bb6(0x4a0) + _0x3ef2da['id'] + _0x119bb6(0x6d1) + _0x3ef2da[_0x119bb6(0x6f2)] + _0x119bb6(0x6c3) + _0x1d73f7 + '\x0a' + _0x26ae5d + '\x0a' + _0x14e645; })[_0x57d5e4(0x566)]('\x0a\x0a'), _0x5f5a67 = Math['floor'](Math[_0x57d5e4(0x19a)]() * 0x3) + 0x2, _0x57ec73 = _0x57d5e4(0x433) + _0x5f5a67 + _0x57d5e4(0x5a5) + _0x43d1b0 + '\x0a' + _0xad29f9 + '\x0a#\x20最近的动态回顾\x20(供参考，避免重复)\x0a' + _0xe60e01 + '\x0a\x0a#\x20任务流程\x0a1.\x20\x20**全局视角**:\x20审视所有成员的人设和近期记忆（包括聊天、日记等），构思他们之间可能发生的有趣互动。\x0a2.\x20\x20**选择作者**:\x20从上述成员中，为' + _0x5f5a67 + _0x57d5e4(0x813) + _0x5f5a67 + _0x57d5e4(0x58a), _0x40e42f = [{ 'role': 'system', 'content': _0x57ec73 }]; _0x40e42f['push']({ 'role': _0x57d5e4(0x472), 'content': _0x57d5e4(0x7fa) + _0x5f5a67 + _0x57d5e4(0x126) }); try { const _0x2a7c48 = await _0x2d20cc(_0x40e42f, { 'json': !![] }), _0x1a4203 = _0x2a7c48['match'](/(\[[\s\S]*\])/); if (!_0x1a4203) throw new Error(_0x57d5e4(0x490)); const _0x2f2a09 = _0x1a4203[0x1], _0x34a8ac = JSON[_0x57d5e4(0x417)](_0x2f2a09); if (!Array[_0x57d5e4(0x65c)](_0x34a8ac)) throw new Error(_0x57d5e4(0x385)); return _0x34a8ac; } catch (_0x4668e5) { return console[_0x57d5e4(0x50e)]('批量生成动态失败:\x20', _0x4668e5), console['error'](_0x57d5e4(0x49a), _0x4668e5[_0x57d5e4(0x3be)] || response), null; } } async function _0x20f352() { const _0xabc93f = _0x27dd8f, _0x56fcb7 = _0x557cc6[_0xabc93f(0x78e)][_0xabc93f(0x4d1)](_0x5d1037 => _0x5d1037['id'] === _0x557cc6['activeFriendCircleId']); if (!_0x56fcb7) return; const _0xc76045 = await _0x4512da(_0xabc93f(0x7e0) + _0x56fcb7[_0xabc93f(0x293)] + _0xabc93f(0x3b0)); _0xc76045 && (_0xabc93f(0x3d5) === 'uhDqF' ? _0x47908f['getElementById'](_0xabc93f(0x4fb))[_0xabc93f(0x2d0)] = _0xabc93f(0x5c6) : (_0x56fcb7[_0xabc93f(0x18a)] = [], _0x162000(), _0x5de4bd(), _0x599dea(_0xabc93f(0x695)))); } function _0x5de4bd() { const _0x25bcdf = _0x27dd8f, _0x4bfd4e = document['getElementById'](_0x25bcdf(0x3f2)), _0x442f3f = _0x557cc6['friendCircles'][_0x25bcdf(0x4d1)](_0x993c82 => _0x993c82['id'] === _0x557cc6[_0x25bcdf(0x761)]); if (!_0x442f3f) { if (_0x25bcdf(0x5ae) !== _0x25bcdf(0x5ae)) _0xf1d8c6[_0x25bcdf(0x73f)] = _0x3c178f, _0x5c61b4[_0x25bcdf(0x35f)][_0x25bcdf(0x7ff)](_0x25bcdf(0x1c6)); else { _0x4bfd4e['innerHTML'] = _0x25bcdf(0x15e); return; } } if (_0x442f3f[_0x25bcdf(0x18a)][_0x25bcdf(0x7a6)] === 0x0) { if ('HvljK' !== 'HvljK') !_0x5babc2['contains'](_0x243ae7[_0x25bcdf(0x44b)]) && _0x409f6b[_0x25bcdf(0x44b)] !== _0x26c2c1 && _0x223bf2[_0x25bcdf(0x44b)] !== _0x4c91b8 && _0x3443d3['classList'][_0x25bcdf(0x7ff)](_0x25bcdf(0x1c6)); else { _0x4bfd4e[_0x25bcdf(0x7a2)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>'; return; } } _0x4bfd4e[_0x25bcdf(0x7a2)] = ''; const _0x2be6e4 = [..._0x442f3f[_0x25bcdf(0x18a)]]['sort']((_0x579036, _0x867ae7) => _0x867ae7[_0x25bcdf(0x798)] - _0x579036[_0x25bcdf(0x798)]); _0x2be6e4[_0x25bcdf(0x302)](_0x510dc7 => { const _0x8816ed = _0x25bcdf, _0x5208b1 = document['createElement']('div'); _0x5208b1['className'] = _0x8816ed(0x747); let _0x142dee = '未知', _0x5df445 = _0x1732e7; if (_0x510dc7[_0x8816ed(0x136)] === 'user') { const _0x229cf2 = _0x3a4665(_0x510dc7[_0x8816ed(0x25f)]); _0x229cf2 && (_0x8816ed(0x2dc) === _0x8816ed(0x2dc) ? (_0x142dee = _0x229cf2[_0x8816ed(0x293)], _0x5df445 = _0x229cf2['avatar']) : _0x37dc0f(_0x8816ed(0x397) + _0x520fc7[_0x8816ed(0x832)])); } else { if (_0x8816ed(0xad) !== _0x8816ed(0xad)) _0x29b63a[_0x8816ed(0x50e)](_0x8816ed(0x804), _0x1f5df8); else { const _0x200f0c = _0x3132c6(_0x510dc7[_0x8816ed(0x25f)]); _0x200f0c && (_0x142dee = _0x200f0c[_0x8816ed(0x293)], _0x5df445 = _0x200f0c[_0x8816ed(0x51e)]); } } const _0x451f9f = _0x8816ed(0x693) + _0x5df445 + '\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22char-name\x22>' + _0x142dee + _0x8816ed(0x3a3), _0x57ef5b = _0x8816ed(0xb7) + _0x510dc7[_0x8816ed(0x398)] + _0x8816ed(0x51c); let _0x1ee15d = ''; if (_0x510dc7['image'] || _0x510dc7[_0x8816ed(0x8c)]) { if ('asFpv' === 'asFpv') { const _0x58342e = _0x8816ed(0x69a) + _0x510dc7['id']; _0x1ee15d = '<div\x20class=\x22post-image-container\x22><img\x20id=\x22' + _0x58342e + _0x8816ed(0x6c6), setTimeout(() => { const _0x2d33c6 = _0x8816ed, _0x1a866a = document[_0x2d33c6(0x5b7)](_0x58342e); if (!_0x1a866a) return; if (_0x510dc7[_0x2d33c6(0x690)]) _0x1a866a['src'] = _0x510dc7['image']; else _0x510dc7[_0x2d33c6(0x8c)] && _0x2aeef5(_0x510dc7[_0x2d33c6(0x8c)])[_0x2d33c6(0x192)](_0x587f5b => { const _0x56b44e = _0x2d33c6; if (_0x56b44e(0x5e4) !== 'ykhOU') { if (_0x587f5b) { const _0x2c2ba7 = URL[_0x56b44e(0x371)](_0x587f5b); _0x1a866a[_0x56b44e(0x483)] = _0x2c2ba7, _0x1a866a['onload'] = () => URL[_0x56b44e(0x29b)](_0x2c2ba7); } else 'QtzLw' !== _0x56b44e(0x673) ? _0x1a866a['alt'] = _0x56b44e(0x734) : _0x40c56a[_0x56b44e(0x48b)] = _0x54aa79(() => { const _0x2fc305 = _0x56b44e; if (_0x5e51c6[_0x2fc305(0x516)] === _0x2fc305(0x514)) _0x5c38b4['preventDefault'](); _0x308f92(_0x583c71(_0x5090ed, 0xa), _0x25a866); }, 0x320); } else _0x46dfdd[_0x56b44e(0x50e)](_0x56b44e(0x81a), _0x3ec09b), _0x491e8d(_0x56b44e(0x1f2)); }); }, 0x0); } else return _0x20337c(_0x193dd1)[_0x8816ed(0x192)](_0x5efda2 => _0x5efda2[_0x8816ed(0x31d)]()); } let _0x55c19f = ''; _0x510dc7['type'] === _0x8816ed(0x164) && _0x510dc7[_0x8816ed(0x6c8)] && ('fBewC' === _0x8816ed(0x19c) ? _0x5dc25d[_0x8816ed(0x50e)](_0x8816ed(0x456), _0x166522) : _0x55c19f = '\x0a\x20\x20\x20\x20<div\x20class=\x22music-post-song-card\x22\x20data-music-id=\x22' + _0x510dc7['id'] + _0x8816ed(0x5ad) + (_0x510dc7[_0x8816ed(0x702)] || _0x1732e7) + _0x8816ed(0x717) + _0x510dc7[_0x8816ed(0x6c8)] + _0x8816ed(0x147) + _0x510dc7['artist'] + _0x8816ed(0x4a2) + (_0x510dc7[_0x8816ed(0x69f)] ? '▶' : '⚠') + _0x8816ed(0x334)); const _0x5bef3c = '<div\x20class=\x22post-timestamp\x22>' + new Date(_0x510dc7['timestamp'])[_0x8816ed(0x586)]('zh-CN') + _0x8816ed(0x7b7); let _0x269864 = ''; if (_0x510dc7[_0x8816ed(0x304)] && _0x510dc7[_0x8816ed(0x304)][_0x8816ed(0x7a6)] > 0x0 || _0x510dc7[_0x8816ed(0x7b)] && _0x510dc7[_0x8816ed(0x7b)][_0x8816ed(0x7a6)] > 0x0) { if (_0x8816ed(0x4cc) !== 'BpqsE') { _0x47f736 = _0x3b84d3; let _0x14b853 = null; if (_0x227256?.[_0x8816ed(0x516)] === _0x8816ed(0x405)) _0x14b853 = _0x4d2c0b(_0x476eb1[_0x8816ed(0x765)][0x0]); else _0x24badc?.[_0x8816ed(0x516)] === _0x8816ed(0x3fd) && _0x2f6c1e && (_0x14b853 = _0x4bc218(_0x15a5e0)); _0x14b853?.[_0x8816ed(0x51e)] && (_0x3ac6fc = _0x14b853[_0x8816ed(0x51e)]); } else { let _0xafda40 = ''; if (_0x510dc7[_0x8816ed(0x304)] && _0x510dc7[_0x8816ed(0x304)][_0x8816ed(0x7a6)] > 0x0) { if ('DWWKU' === _0x8816ed(0x1b0)) { const _0x3fc0ce = _0x510dc7['likes'][_0x8816ed(0x30e)](_0x307ee6 => _0x3132c6(_0x307ee6)?.['name'] || '未知')[_0x8816ed(0x566)]('、'); _0xafda40 = '<div\x20class=\x22post-likes\x22>❤️\x20' + _0x3fc0ce + _0x8816ed(0x7b7); } else { const _0x5e4382 = _0x31d59a[_0x8816ed(0x5ba)]('option'); _0x5e4382['value'] = _0x409b11['id'], _0x5e4382[_0x8816ed(0x2d0)] = _0x2b8922[_0x8816ed(0x293)], _0x3ea4ad['appendChild'](_0x5e4382); } } let _0x2417aa = ''; if (_0x510dc7[_0x8816ed(0x7b)] && _0x510dc7[_0x8816ed(0x7b)][_0x8816ed(0x7a6)] > 0x0) { const _0x7e468f = _0x510dc7[_0x8816ed(0x7b)][_0x8816ed(0x30e)](_0x3fff06 => { const _0x5a291e = _0x8816ed; if (_0x5a291e(0x81) === _0x5a291e(0x81)) { const _0x2ef186 = _0x3132c6(_0x3fff06[_0x5a291e(0x25f)])?.[_0x5a291e(0x293)] || '未知'; return _0x5a291e(0x124) + _0x2ef186 + '</span>:\x20' + _0x3fff06['content'] + _0x5a291e(0x7b7); } else { const _0x3e51b5 = _0x5a6395(_0x51c04f[_0x5a291e(0x765)][0x0]); return _0x3e51b5?.[_0x5a291e(0x293)] || 'AI'; } })[_0x8816ed(0x566)](''); _0x2417aa = _0x8816ed(0x1e6) + _0x7e468f + '</div>'; } _0x269864 = _0x8816ed(0x220) + _0xafda40 + _0x8816ed(0x843) + _0x2417aa + _0x8816ed(0x35e); } } const _0x146be6 = '<div\x20class=\x22post-body\x22>' + _0x57ef5b + _0x1ee15d + _0x55c19f + _0x8816ed(0x7b7); _0x5208b1[_0x8816ed(0x7a2)] = _0x451f9f + _0x146be6 + _0x5bef3c + _0x269864; if (_0x510dc7[_0x8816ed(0x516)] === _0x8816ed(0x164) && _0x510dc7[_0x8816ed(0x69f)]) { const _0x4df332 = _0x5208b1[_0x8816ed(0x5ab)]('.music-post-song-card'); if (_0x4df332) { if (_0x8816ed(0x4f1) === 'oGeUI') _0x4df332[_0x8816ed(0x572)](_0x8816ed(0x66b), function () { const _0x16efc5 = _0x8816ed, _0x6270f5 = { 'id': _0x510dc7['id'], 'url': _0x510dc7[_0x16efc5(0x69f)] }; _0x52625b(this, _0x6270f5); }); else { if (_0x280841[_0x8816ed(0x48b)]) _0x2e413a(_0x2d97ef[_0x8816ed(0x48b)]); } } } _0x4bfd4e['appendChild'](_0x5208b1); }); } document[_0x27dd8f(0x5b7)]('clear-feed-button')[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x20f352), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x3dc))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x4dc741), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x479))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x4f27ca(_0x27dd8f(0x707), _0x27dd8f(0xf1))), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x23d))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x1f7aac()), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x5ea))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x4f27ca(_0x27dd8f(0xf1), _0x27dd8f(0x40a))), document[_0x27dd8f(0x5b7)]('save-friend-circle-button')['addEventListener']('click', _0x4337ba), document['getElementById']('delete-friend-circle-button')[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x10dbba), document['getElementById'](_0x27dd8f(0x7e9))[_0x27dd8f(0x572)]('click', () => { const _0x39b261 = _0x27dd8f; _0x2f7b46(), _0x4f27ca('friendCircleList', _0x39b261(0x164)); }), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x709))['addEventListener']('click', () => { const _0x39eb30 = _0x27dd8f; _0x557cc6[_0x39eb30(0x761)] && _0x1f7aac(_0x557cc6[_0x39eb30(0x761)]); }), document[_0x27dd8f(0x5b7)](_0x27dd8f(0xed))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), async () => { const _0xe2acf8 = _0x27dd8f, _0x5a4ad7 = _0x557cc6[_0xe2acf8(0x78e)][_0xe2acf8(0x4d1)](_0x4b1d76 => _0x4b1d76['id'] === _0x557cc6['activeFriendCircleId']); if (!_0x5a4ad7 || _0x557cc6[_0xe2acf8(0x161)]) return; const _0x4ec6f9 = _0x5a4ad7['boundUserProfileId'], _0x1f319c = _0x557cc6['userProfiles'][_0xe2acf8(0x4d1)](_0x31598a => _0x31598a['id'] === _0x4ec6f9); if (!_0x1f319c) { if (_0xe2acf8(0x8d) === _0xe2acf8(0x8d)) { _0x599dea('错误：找不到此好友圈绑定的用户！'); return; } else { const _0x590b33 = _0x39d763[_0xe2acf8(0x674)]['map'](_0x12f96f => _0x3b0187[_0xe2acf8(0x694)][_0xe2acf8(0x4d1)](_0x3e23a6 => _0x3e23a6['id'] === _0x12f96f))['filter'](_0xb6a67b)[_0xe2acf8(0x30e)](_0x106323 => _0xe2acf8(0x826) + _0x106323[_0xe2acf8(0x293)] + '\x0a' + _0x106323[_0xe2acf8(0x398)])[_0xe2acf8(0x566)](''); if (_0x590b33) _0x45b078 = _0xe2acf8(0x49b) + _0x590b33; } } const _0x5326a3 = document['getElementById']('user-post-textarea')['value'][_0xe2acf8(0xf2)](), _0x38d4b9 = _0x557cc6[_0xe2acf8(0x6d7)][_0xe2acf8(0x690)], _0x18e1c5 = _0x557cc6[_0xe2acf8(0x6d7)][_0xe2acf8(0x164)], _0x8be4b7 = _0x557cc6[_0xe2acf8(0x6d7)][_0xe2acf8(0x8c)]; if (!_0x5326a3 && !_0x38d4b9 && !_0x18e1c5) { _0x599dea('总得说点什么吧？'); return; } const _0x2b9042 = { 'id': 'post_user_' + Date[_0xe2acf8(0x183)](), 'authorType': _0xe2acf8(0x472), 'authorId': _0x1f319c['id'], 'content': _0x5326a3, 'timestamp': Date[_0xe2acf8(0x183)](), 'likes': [], 'comments': [] }; if (_0x8be4b7) _0x2b9042['imageId'] = _0x8be4b7; else { if (_0x38d4b9) { if (_0xe2acf8(0x27e) === _0xe2acf8(0x27e)) _0x2b9042[_0xe2acf8(0x690)] = _0x38d4b9; else { const _0xc8790 = _0x47f90e[_0xe2acf8(0x58d)][_0xe2acf8(0x4d1)](_0x4ec99b => _0x4ec99b['id'] === _0x3bc87c); if (_0xc8790) _0x21ef92['assign'](_0xc8790, _0x13486f); } } } _0x18e1c5 ? (_0x2b9042[_0xe2acf8(0x516)] = _0xe2acf8(0x164), Object['assign'](_0x2b9042, _0x18e1c5)) : _0x2b9042[_0xe2acf8(0x516)] = _0xe2acf8(0x68e), _0x5a4ad7[_0xe2acf8(0x18a)][_0xe2acf8(0x6b4)](_0x2b9042), _0x162000(), _0x5de4bd(), document['getElementById'](_0xe2acf8(0x9f))['value'] = '', _0x557cc6[_0xe2acf8(0x6d7)][_0xe2acf8(0x690)] = null, _0x557cc6['pendingPostAttachments'][_0xe2acf8(0x164)] = null, _0x557cc6['pendingPostAttachments']['imageId'] = null, _0x18d626(), _0xd0933d(_0x2b9042); }), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x2d4))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x17bdad = _0x27dd8f; _0x17bdad(0x6b7) === _0x17bdad(0x6b7) ? document[_0x17bdad(0x5b7)](_0x17bdad(0x77d))[_0x17bdad(0x66b)]() : (_0x239d25 = !![], _0x41dc20[_0x17bdad(0x589)] = null); }), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x77d))[_0x27dd8f(0x572)](_0x27dd8f(0x265), async _0x3371d0 => { const _0x318195 = _0x27dd8f; if (_0x318195(0x28a) === _0x318195(0x28a)) { const _0x2794aa = _0x3371d0['target'][_0x318195(0x209)][0x0]; if (!_0x2794aa) return; try { if ('uJOqs' === _0x318195(0x5dd)) _0x424330('核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a'); else { const _0x351830 = await _0x4657ac(_0x2794aa, 0x320, 0.8, !![]), _0x3efb6f = _0x318195(0x4f5) + Date[_0x318195(0x183)](); await _0x3aff46(_0x3efb6f, _0x351830), _0x557cc6[_0x318195(0x6d7)]['imageId'] = _0x3efb6f, _0x557cc6[_0x318195(0x6d7)][_0x318195(0x690)] = null, _0x557cc6[_0x318195(0x6d7)][_0x318195(0x164)] = null, _0x18d626(); } } catch (_0x2cf147) { if (_0x318195(0xa1) !== _0x318195(0x3ab)) _0x599dea(_0x318195(0x4e6) + _0x2cf147[_0x318195(0x832)]); else { _0x24170c[_0x318195(0x618)] = _0x232869[_0x318195(0x618)][_0x318195(0x1d8)](_0x4817cb => _0x4817cb['id'] !== _0x2bc432), _0x38f9d6[_0x318195(0x46d)]['forEach'](_0x281d0f => { const _0x41c02c = _0x318195; _0x281d0f[_0x41c02c(0x516)] === 'group' && (_0x281d0f[_0x41c02c(0x765)] = _0x281d0f[_0x41c02c(0x765)][_0x41c02c(0x1d8)](_0x25e00c => _0x25e00c !== _0x4b6c95)); }); const _0x22f54c = _0x31fbcb['chats']['find'](_0x373b8b => _0x373b8b['type'] === _0x318195(0x405) && _0x373b8b[_0x318195(0x765)][_0x318195(0x158)](_0x1ffec9)); _0x22f54c && _0x5abf8c(_0x22f54c['id']), _0x27e058[_0x318195(0x46d)] = _0x1b2989[_0x318195(0x46d)][_0x318195(0x1d8)](_0x1782dd => _0x1782dd['type'] !== _0x318195(0x3fd) || _0x1782dd[_0x318195(0x765)][_0x318195(0x7a6)] > 0x1), _0x2afed8(), _0x44b965(); } } _0x3371d0[_0x318195(0x44b)][_0x318195(0x73f)] = ''; } else _0x12acde[_0x318195(0x760)](), _0xa0febf(_0x289e1a['id']); }), document['getElementById'](_0x27dd8f(0x5db))[_0x27dd8f(0x572)]('click', async () => { const _0x2b01c8 = _0x27dd8f, _0x1a5a62 = await _0x8a01de(); if (!_0x1a5a62) return; _0x599dea(_0x2b01c8(0x129)); try { if (_0x2b01c8(0x210) !== _0x2b01c8(0x583)) { const _0x23ff55 = await _0x5b6497(_0x1a5a62['songName'], _0x1a5a62[_0x2b01c8(0x1e4)]); _0x557cc6[_0x2b01c8(0x6d7)]['music'] = { 'songName': _0x1a5a62[_0x2b01c8(0x6c8)], 'artist': _0x1a5a62[_0x2b01c8(0x1e4)], 'coverUrl': _0x23ff55['cover'], 'playableUrl': _0x23ff55['url'] }, _0x557cc6[_0x2b01c8(0x6d7)][_0x2b01c8(0x690)] = null, _0x18d626(); } else _0x31c648(_0xb1ef67, _0x13ceb5[_0x2b01c8(0x44b)][_0x2b01c8(0x209)][0x0]); } catch (_0x27e71d) { _0x599dea(_0x2b01c8(0x81b) + _0x27e71d[_0x2b01c8(0x832)]); } }); function _0x290716() { const _0x5db5cf = _0x27dd8f, _0x4040ce = new Date(), _0x2da929 = document[_0x5db5cf(0x5b7)](_0x5db5cf(0x79d)), _0x5bfa7c = document['getElementById'](_0x5db5cf(0x10b)); if (_0x2da929 && _0x5bfa7c) { if (_0x5db5cf(0x420) !== _0x5db5cf(0x19e)) { const _0x49075f = String(_0x4040ce['getHours']())[_0x5db5cf(0x1db)](0x2, '0'), _0xa517c9 = String(_0x4040ce[_0x5db5cf(0x762)]())[_0x5db5cf(0x1db)](0x2, '0'); _0x2da929[_0x5db5cf(0x2d0)] = _0x49075f + ':' + _0xa517c9; const _0xb9cd28 = _0x4040ce[_0x5db5cf(0x2aa)]() + 0x1, _0x5a5123 = _0x4040ce[_0x5db5cf(0x65f)](), _0x5ef536 = [_0x5db5cf(0x408), _0x5db5cf(0xda), _0x5db5cf(0x2c6), _0x5db5cf(0x377), _0x5db5cf(0x588), _0x5db5cf(0x748), '星期六'][_0x4040ce['getDay']()]; _0x5bfa7c[_0x5db5cf(0x2d0)] = _0xb9cd28 + '月' + _0x5a5123 + '日\x20' + _0x5ef536; } else { const _0xa3acf4 = _0x120512[_0x5db5cf(0x5b7)](_0x5db5cf(0x50c)), _0x424343 = _0x26483e[_0x5db5cf(0x5b7)](_0x5db5cf(0x816)), _0x5abc57 = _0x48c905['querySelector'](_0x5db5cf(0x64f)); _0x1439f8[_0x5db5cf(0x97)] === 'galgame' ? (_0xa3acf4['style']['display'] = 'none', _0x424343[_0x5db5cf(0x6ca)][_0x5db5cf(0x836)] = _0x5db5cf(0x534)) : (_0xa3acf4[_0x5db5cf(0x6ca)][_0x5db5cf(0x836)] = _0x5db5cf(0x534), _0x424343[_0x5db5cf(0x6ca)][_0x5db5cf(0x836)] = _0x5db5cf(0x4e3)), _0x5abc57['style'][_0x5db5cf(0x836)] = _0x5db5cf(0x534); } } } function _0x203665(_0x222157) { const _0xaa1658 = _0x27dd8f; if (!_0x222157) return ''; const _0x5c8d61 = new Date(_0x222157), _0x8788bf = String(_0x5c8d61[_0xaa1658(0x5f1)]())[_0xaa1658(0x1db)](0x2, '0'), _0xd76833 = String(_0x5c8d61[_0xaa1658(0x762)]())[_0xaa1658(0x1db)](0x2, '0'); return _0x8788bf + ':' + _0xd76833; } function _0x1ad6ce() { const _0x537dec = _0x27dd8f, _0x4d46af = _0x557cc6['friendCircles'][_0x537dec(0x4d1)](_0x659ef5 => _0x659ef5['id'] === _0x557cc6[_0x537dec(0x761)]), _0x3ed98b = _0x4d46af ? _0x4d46af['posts'] : []; if (!_0x3ed98b || _0x3ed98b[_0x537dec(0x7a6)] === 0x0) return ''; const _0x4b869c = _0x3ed98b[_0x537dec(0x186)](0x0, 0x5), _0x44c2dc = _0x4b869c['map'](_0x59034f => { const _0x4a7f25 = _0x537dec, _0x2fc725 = _0x3132c6(_0x59034f[_0x4a7f25(0x25f)]) || { 'name': '未知' }; let _0x5acb7f = _0x4a7f25(0x83) + _0x2fc725[_0x4a7f25(0x293)] + _0x4a7f25(0x55c) + (_0x59034f[_0x4a7f25(0x9e)] || _0x59034f[_0x4a7f25(0x398)]) + '”'; return _0x59034f[_0x4a7f25(0x516)] === _0x4a7f25(0x164) && ('aexvK' === _0x4a7f25(0x55f) ? _0xaf4707 += _0x4a7f25(0x6bf) : _0x5acb7f += _0x4a7f25(0xa9) + _0x59034f[_0x4a7f25(0x6c8)] + _0x4a7f25(0x39c) + _0x59034f[_0x4a7f25(0x1e4)] + ')'), _0x5acb7f; }); return _0x537dec(0x6a8) + _0x44c2dc[_0x537dec(0x566)]('\x0a'); } function _0x129229(_0xee5843) { const _0x3ed81d = _0x27dd8f; if ('JCGBa' === _0x3ed81d(0x1ba)) { const _0x9dc146 = _0x557cc6[_0x3ed81d(0x58d)][_0x3ed81d(0x4d1)](_0x487f37 => _0x487f37['id'] === _0x557cc6[_0x3ed81d(0x26a)]) || { 'name': '你' }, _0x42db21 = _0x557cc6[_0x3ed81d(0xa8)][_0x3ed81d(0x4d1)](_0x175df0 => _0x175df0[_0x3ed81d(0x27b)] === _0xee5843); if (!_0x42db21 || !_0x42db21[_0x3ed81d(0x759)] || _0x42db21[_0x3ed81d(0x759)][_0x3ed81d(0x7a6)] === 0x0) return ''; const _0x28ded6 = _0x42db21[_0x3ed81d(0x759)][_0x3ed81d(0x186)](-0x8), _0x5b88e4 = _0x28ded6[_0x3ed81d(0x30e)](_0xece802 => { const _0x496944 = _0x3ed81d, _0x413aed = _0xece802[_0x496944(0x4e9)] === _0x496944(0x472) ? _0x9dc146['name'] : _0x3132c6(_0xece802['author'])[_0x496944(0x293)]; return _0x496944(0x5a2) + new Date(_0xece802[_0x496944(0x798)])[_0x496944(0x541)]() + ']\x20' + _0x413aed + _0x496944(0x815) + _0xece802[_0x496944(0x398)]; })['join']('\x0a'); return _0x3ed81d(0x1a6) + _0x9dc146['name'] + '\x20之间的私密内容)\x0a' + _0x5b88e4; } else _0x4652a1[_0x3ed81d(0x4f0)] = _0x2f67df[_0x3ed81d(0x4c1)]; } function _0x13c027() { const _0x443e87 = _0x27dd8f, _0x11ab48 = document['getElementById'](_0x443e87(0x4c5)), _0x4de1ea = _0x557cc6['preferences'][_0x443e87(0x299)]; if (_0x4de1ea) { if (_0x443e87(0x218) === _0x443e87(0x5ee)) { if (_0x54ea59[_0x443e87(0x7a6)] === 0x0) return; _0x519af3 = (_0x394248 + 0x1) % _0xf928fd[_0x443e87(0x7a6)], _0x3f51bf(_0x83e507[_0x297908], _0x177370); } else _0x11ab48[_0x443e87(0x6ca)]['backgroundImage'] = _0x443e87(0x520) + _0x4de1ea + ')', _0x11ab48[_0x443e87(0x6ca)][_0x443e87(0x4a9)] = 'cover', _0x11ab48[_0x443e87(0x6ca)][_0x443e87(0x24d)] = _0x443e87(0x5ff), _0x11ab48[_0x443e87(0x6ca)][_0x443e87(0x3a2)] = 'white', _0x11ab48[_0x443e87(0x687)](_0x443e87(0x47d))['forEach'](_0x1054bb => { const _0x1175f5 = _0x443e87; _0x1175f5(0x1ff) === 'OmNng' ? _0x1054bb['style']['textShadow'] = _0x1175f5(0x7e8) : (_0x50ecd4[_0x1175f5(0x6ca)][_0x1175f5(0x100)] = _0x158f67[_0x1175f5(0x100)] + '%', _0x178ff0[_0x1175f5(0x6ca)][_0x1175f5(0x7ee)] = _0x9444d2[_0x1175f5(0x7ee)] + '%'); }); } else _0x443e87(0x215) !== _0x443e87(0x284) ? (_0x11ab48[_0x443e87(0x6ca)][_0x443e87(0xcf)] = '', _0x11ab48[_0x443e87(0x6ca)][_0x443e87(0x3a2)] = '', _0x11ab48['querySelectorAll'](_0x443e87(0x47d))[_0x443e87(0x302)](_0x45fe4f => { const _0x1556c6 = _0x443e87; _0x45fe4f[_0x1556c6(0x6ca)]['textShadow'] = ''; })) : _0x597bc6[_0x443e87(0x26a)] = _0x32b4f0['id']; } const _0x1f4c36 = document['getElementById'](_0x27dd8f(0x375)), _0x4109d4 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x7b1)); _0x1f4c36[_0x27dd8f(0x572)]('click', () => { const _0x1ac9a1 = _0x27dd8f; if (_0x1ac9a1(0x109) === 'eWjhb') { _0x132eff('userProfile', 'userProfileList'); const _0x359409 = _0x431852[_0x1ac9a1(0x5b7)](_0x1ac9a1(0x54e)); if (_0xfe1e31) { const _0x4ada23 = _0x3ab331[_0x1ac9a1(0x58d)][_0x1ac9a1(0x4d1)](_0x587903 => _0x587903['id'] === _0x4fec63); if (!_0x4ada23) return; _0x3d0409[_0x1ac9a1(0x5b7)](_0x1ac9a1(0x5af))['value'] = _0x4ada23['id'], _0x10f643['getElementById']('user-profile-edit-title')[_0x1ac9a1(0x2d0)] = _0x1ac9a1(0x21e), _0x485718[_0x1ac9a1(0x5b7)](_0x1ac9a1(0x4a3))['value'] = _0x4ada23[_0x1ac9a1(0x293)], _0x582470[_0x1ac9a1(0x5b7)](_0x1ac9a1(0x1fc))[_0x1ac9a1(0x483)] = _0x4ada23['avatar'], _0x498d99['getElementById'](_0x1ac9a1(0x36f))[_0x1ac9a1(0x73f)] = _0x4ada23[_0x1ac9a1(0x6f2)], _0x359409[_0x1ac9a1(0x6ca)][_0x1ac9a1(0x836)] = _0x4ada23['id'] === _0x152fb5['activeUserProfileId'] ? 'none' : 'block'; } else _0x207e44[_0x1ac9a1(0x5b7)](_0x1ac9a1(0x5af))[_0x1ac9a1(0x73f)] = '', _0x4dc331['getElementById'](_0x1ac9a1(0x1c7))[_0x1ac9a1(0x2d0)] = _0x1ac9a1(0x32e), _0x30fef2[_0x1ac9a1(0x5b7)](_0x1ac9a1(0x4a3))['value'] = '新用户\x20' + (_0x5832d9['userProfiles'][_0x1ac9a1(0x7a6)] + 0x1), _0xdac21b[_0x1ac9a1(0x5b7)](_0x1ac9a1(0x1fc))[_0x1ac9a1(0x483)] = _0x319e93, _0x13147a[_0x1ac9a1(0x5b7)](_0x1ac9a1(0x36f))[_0x1ac9a1(0x73f)] = '', _0x359409[_0x1ac9a1(0x6ca)][_0x1ac9a1(0x836)] = _0x1ac9a1(0x4e3); } else _0x2f7b46(), _0x4f27ca('friendCircleList', 'home'); }), _0x4109d4[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x4a36e0 = _0x27dd8f; _0x533c8b(), _0x4f27ca('meetingList', _0x4a36e0(0x707)); }), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x44c))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x59cd92 = _0x27dd8f; if (_0x59cd92(0x661) === _0x59cd92(0x524)) { const _0x3d1dac = _0x9b89c(_0x45192e['dataset'][_0x59cd92(0x62e)], 0xa); _0x40e97c(_0x3d1dac); } else _0x4f27ca('home', _0x59cd92(0x8a)); }), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x4ea))['addEventListener'](_0x27dd8f(0x66b), () => { const _0x483bd4 = _0x27dd8f; if (_0x258b12) clearInterval(_0x258b12); _0x258b12 = null, _0x557cc6[_0x483bd4(0x13d)] = [], _0x557cc6[_0x483bd4(0x243)] = null, _0x557cc6[_0x483bd4(0x589)] = null, _0x162000(), _0x4f27ca('meetingList', _0x483bd4(0x58f)); }); const _0x2a9f3a = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x7c9)), _0x3ad0a0 = document[_0x27dd8f(0x5b7)]('meeting-send-button'); _0x3ad0a0['addEventListener']('click', () => { const _0x4cca89 = _0x27dd8f; if ('jOjCX' === 'LireQ') _0x5ddeca(![]), _0x38d18c[_0x4cca89(0x44b)]['value'] = ''; else { const _0x371e27 = _0x2a9f3a[_0x4cca89(0x73f)][_0x4cca89(0xf2)](); _0x371e27 && (_0x4cca89(0x671) === _0x4cca89(0x188) ? _0x1a3d64[_0x4cca89(0x6ca)]['textShadow'] = _0x4cca89(0x7e8) : (_0x2b66ff(_0x371e27), _0x2a9f3a[_0x4cca89(0x73f)] = '', setTimeout(_0x5debb2, 0x64))); } }); function _0x52625b(_0x475f00, _0xc46ae2) { const _0xc7951 = _0x27dd8f; if (_0xc7951(0x487) !== _0xc7951(0x487)) { const _0x1e13f4 = { 'id': 'msg_' + _0x1c2b52[_0xc7951(0x798)], 'url': _0x55e3d5['playableUrl'] }; _0x122abb(this, _0x1e13f4); } else { const _0x514153 = document[_0xc7951(0x5b7)]('audio-player'), _0xf2dffe = document[_0xc7951(0x687)](_0xc7951(0x5e1)); _0xf2dffe['forEach'](_0x482509 => { const _0x236d91 = _0xc7951; _0x482509 !== _0x475f00['querySelector'](_0x236d91(0x5e1)) && (_0x482509[_0x236d91(0x2d0)] = '▶'); }), _0x514153[_0xc7951(0x483)] === _0xc46ae2['url'] && !_0x514153[_0xc7951(0x11d)] ? (_0x514153[_0xc7951(0x2a8)](), _0x475f00[_0xc7951(0x5ab)](_0xc7951(0x5e1))[_0xc7951(0x2d0)] = '▶') : _0xc7951(0x421) !== _0xc7951(0x421) ? !_0x3eb5c1[_0xc7951(0x5ab)](_0xc7951(0x7df))['contains'](_0x291ddf['target']) && (_0x54df04['classList'][_0xc7951(0x7ff)](_0xc7951(0x247)), _0x42974e['classList'][_0xc7951(0x7ff)](_0xc7951(0x5f5))) : (_0x514153[_0xc7951(0x483)] = _0xc46ae2[_0xc7951(0x606)], _0x514153[_0xc7951(0x57e)](), _0x475f00['querySelector'](_0xc7951(0x5e1))[_0xc7951(0x2d0)] = '❚❚'); } } const _0x4c6355 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x5bf)); async function _0x303ac5(_0x38b974) { const _0x1d1aa2 = _0x27dd8f; if ('PmVGs' === _0x1d1aa2(0x7ce)) { if (!_0x38b974 || !_0x38b974[_0x1d1aa2(0x795)](_0x1d1aa2(0x837))) return ![]; return new Promise(_0x5188f1 => { const _0x40fe25 = _0x1d1aa2, _0x53f306 = document[_0x40fe25(0x5ba)](_0x40fe25(0x44f)); _0x53f306['src'] = _0x38b974; const _0x1cce08 = setTimeout(() => { const _0x587df6 = _0x40fe25; if ('UtbUC' === _0x587df6(0x615)) _0x46b067(), _0x5188f1(![]); else { const _0x219cb7 = _0x4fc336[_0x587df6(0x5ba)](_0x587df6(0x509)); _0x219cb7['className'] = _0x587df6(0x63a); const _0x550cd7 = _0xd14882[_0x587df6(0x5ba)](_0x587df6(0x509)); _0x550cd7[_0x587df6(0x640)] = _0x587df6(0x574), _0x550cd7[_0x587df6(0x2d0)] = _0x5db767['quotedMessage'][_0x587df6(0x831)]; const _0x4a43fe = _0x259c22['createElement'](_0x587df6(0x509)); _0x4a43fe[_0x587df6(0x640)] = 'quoted-content', _0x4a43fe[_0x587df6(0x2d0)] = _0x4d2528[_0x587df6(0x6c7)][_0x587df6(0x398)], _0x219cb7[_0x587df6(0x796)](_0x550cd7), _0x219cb7[_0x587df6(0x796)](_0x4a43fe), _0x2cfb97[_0x587df6(0x796)](_0x219cb7); } }, 0xbb8), _0x46b067 = () => { const _0x551430 = _0x40fe25; clearTimeout(_0x1cce08), _0x53f306[_0x551430(0x11e)](_0x551430(0xfb), _0x5d982a), _0x53f306[_0x551430(0x11e)](_0x551430(0x50e), _0x272c8a), _0x53f306[_0x551430(0x483)] = '', _0x53f306[_0x551430(0x7ff)](); }, _0x5d982a = () => { const _0x10bf35 = _0x40fe25; if (_0x10bf35(0x1cc) === 'evdcd') { const _0x2386a0 = _0xfc9165['value'][_0x10bf35(0xf2)](); _0x2386a0 && (_0x5e9e00(_0x2386a0), _0x45c993[_0x10bf35(0x73f)] = '', _0x525006(_0x5064fc, 0x64)); } else _0x46b067(), _0x5188f1(!![]); }, _0x272c8a = () => { _0x46b067(), _0x5188f1(![]); }; _0x53f306['addEventListener'](_0x40fe25(0xfb), _0x5d982a), _0x53f306[_0x40fe25(0x572)](_0x40fe25(0x50e), _0x272c8a); }); } else _0x4185fe = _0x18d185; } async function _0x5b6497(_0x57b8e3, _0x47ef18) { const _0x16ef94 = _0x27dd8f, _0x24c23a = [_0x16ef94(0x211), _0x16ef94(0x372)]; for (const _0x3084cb of _0x24c23a) { try { const _0x34e1e2 = _0x16ef94(0x76) + _0x3084cb + '?word=' + encodeURIComponent(_0x57b8e3) + '-' + encodeURIComponent(_0x47ef18), _0x1697cb = await fetch(_0x34e1e2), _0x192ade = await _0x1697cb[_0x16ef94(0x7ad)](); if (_0x192ade[_0x16ef94(0x616)] !== 0xc8 || !_0x192ade[_0x16ef94(0x5f7)] || _0x192ade[_0x16ef94(0x5f7)][_0x16ef94(0x7a6)] === 0x0) continue; const _0x288e1b = _0x192ade['data'][_0x16ef94(0x186)](0x0, 0x5); for (const _0x5c2887 of _0x288e1b) { if (_0x16ef94(0x5d7) === 'dJOWd') { const _0x18af87 = _0x16ef94(0x76) + _0x3084cb + _0x16ef94(0x332) + _0x5c2887['id'], _0x3dac6e = await fetch(_0x18af87), _0x138a0b = await _0x3dac6e[_0x16ef94(0x7ad)](), _0x46128f = _0x138a0b[_0x16ef94(0x5f7)]?.['url']; if (await _0x303ac5(_0x46128f)) return { 'url': _0x46128f, 'cover': _0x5c2887[_0x16ef94(0x791)], 'source': _0x3084cb }; } else _0x13321b[_0x16ef94(0x17f)]('badgeState'), _0x2783a3['removeItem'](_0x16ef94(0x602)), _0x4e36c6('位置已重置，正在刷新...'), _0x604ee4(() => _0x85e6c6[_0x16ef94(0x112)](), 0x3e8); } } catch (_0x47abdb) { _0x16ef94(0x7fb) !== _0x16ef94(0x11f) ? console[_0x16ef94(0x50e)]('Error\x20fetching\x20from\x20' + _0x3084cb + ':', _0x47abdb) : (_0x136072(), _0x5e5d8c(_0x16ef94(0x769), 'home')); } } return { 'url': null, 'cover': null, 'source': null }; } function _0x349d36(_0x34bc6e) { const _0x200907 = _0x27dd8f; try { const _0x2418e4 = JSON[_0x200907(0x417)](localStorage['getItem']('badgeState') || '{}'), _0x12d6e1 = { ..._0x2418e4, ..._0x34bc6e }; localStorage[_0x200907(0x69e)](_0x200907(0x31b), JSON['stringify'](_0x12d6e1)); } catch (_0x568e33) { if (_0x200907(0x3fb) !== 'TKujS') console['error'](_0x200907(0x3dd), _0x568e33); else { const _0x4a71a2 = _0x4facab['getElementById'](_0x200907(0x41c)); _0x4a71a2[_0x200907(0x7a2)] = ''; if (_0x36f9d9[_0x200907(0x694)][_0x200907(0x7a6)] === 0x0) { _0x4a71a2[_0x200907(0x7a2)] = _0x200907(0x786); return; } _0x5f219e[_0x200907(0x694)][_0x200907(0x302)](_0x2feeb9 => { const _0x593bcb = _0x200907, _0x3b0838 = _0x36db83[_0x593bcb(0x5ba)](_0x593bcb(0x509)); _0x3b0838['className'] = _0x593bcb(0x55d), _0x3b0838[_0x593bcb(0x78)]['id'] = _0x2feeb9['id'], _0x3b0838['innerHTML'] = _0x593bcb(0x790) + _0x2feeb9[_0x593bcb(0x293)] + _0x593bcb(0xd7) + _0x2feeb9[_0x593bcb(0x398)][_0x593bcb(0x471)](0x0, 0x64) + _0x593bcb(0x37b), _0x3b0838[_0x593bcb(0x572)]('click', () => _0x5e9485(_0x2feeb9['id'])), _0x4a71a2[_0x593bcb(0x796)](_0x3b0838); }); } } } async function _0x211b27() { const _0xae1c03 = _0x27dd8f, _0x36aebf = document[_0xae1c03(0x5b7)]('decorative-badge'), _0x2185bb = document[_0xae1c03(0x5b7)](_0xae1c03(0x15a)); try { let _0x393656 = await _0x2aeef5('widget_badge'); if (!_0x393656) { const _0x69d998 = JSON['parse'](localStorage[_0xae1c03(0x426)](_0xae1c03(0x31b)) || '{}'); _0x69d998['image'] && ('abdGn' !== _0xae1c03(0x45c) ? _0x58d64a(_0xae1c03(0xb2) + _0x35e93f[_0xae1c03(0x832)]) : (console['log'](_0xae1c03(0x1b7)), _0x393656 = await _0x57a56e(_0x69d998[_0xae1c03(0x690)]), await _0x3aff46(_0xae1c03(0x335), _0x393656))); } _0x393656 ? _0xae1c03(0x646) !== _0xae1c03(0x17a) ? (_0x2185bb[_0xae1c03(0x483)] = URL[_0xae1c03(0x371)](_0x393656), _0x36aebf[_0xae1c03(0x6ca)][_0xae1c03(0x836)] = _0xae1c03(0x534)) : (_0xcf36f0[_0xae1c03(0x35f)][_0xae1c03(0x7ff)]('show'), _0x75f2b0(() => _0x557372[_0xae1c03(0x6ca)][_0xae1c03(0x836)] = 'none', 0x12c)) : _0x36aebf['style'][_0xae1c03(0x836)] = 'block'; } catch (_0x5b41d5) { _0xae1c03(0x834) !== _0xae1c03(0x834) ? _0x1eb473[_0xae1c03(0x1c2)]({ 'behavior': _0xae1c03(0xaa), 'block': _0xae1c03(0x6b9) }) : console[_0xae1c03(0x50e)](_0xae1c03(0x7ed), _0x5b41d5); } } function _0xb7e751(_0x185da7) { const _0x2b27be = _0x27dd8f; if (_0x2b27be(0x12a) === 'MmZNu') _0x50c1d3(_0x2b27be(0x397) + _0x1827b8[_0x2b27be(0x832)]); else try { const _0x47653d = JSON[_0x2b27be(0x417)](localStorage[_0x2b27be(0x426)](_0x2b27be(0x602)) || '{}'), _0x4ae1ec = { ..._0x47653d, ..._0x185da7 }; localStorage['setItem'](_0x2b27be(0x602), JSON[_0x2b27be(0x82f)](_0x4ae1ec)); } catch (_0x4e6e66) { console[_0x2b27be(0x50e)](_0x2b27be(0x711), _0x4e6e66); } } async function _0x11491a() { const _0x354752 = _0x27dd8f; if (_0x354752(0x7f3) !== 'zLAey') { const _0x242bc5 = document[_0x354752(0x5b7)](_0x354752(0x7f5)), _0x307708 = document[_0x354752(0x5b7)](_0x354752(0x273)); try { let _0x31903c = await _0x2aeef5(_0x354752(0x7fc)); if (!_0x31903c) { if ('kHaaZ' === 'kHaaZ') { const _0x1d9767 = JSON[_0x354752(0x417)](localStorage[_0x354752(0x426)](_0x354752(0x602)) || '{}'); _0x1d9767[_0x354752(0x690)] && (console['log'](_0x354752(0x295)), _0x31903c = await _0x57a56e(_0x1d9767[_0x354752(0x690)]), await _0x3aff46('widget_card', _0x31903c)); } else _0xf4ad37[_0x354752(0x50e)](_0x354752(0x2f5), _0xe97417), _0x360f4a = _0x19d312; } _0x31903c ? (_0x307708[_0x354752(0x483)] = URL[_0x354752(0x371)](_0x31903c), _0x242bc5[_0x354752(0x6ca)]['display'] = _0x354752(0x534)) : _0x354752(0x3c4) !== _0x354752(0x5fc) ? _0x242bc5['style'][_0x354752(0x836)] = 'block' : _0x2b56bf(_0x354752(0x1b6)); } catch (_0x31283b) { console[_0x354752(0x50e)](_0x354752(0x812), _0x31283b); } try { let _0x2c812b = await _0x2aeef5(_0x354752(0x6eb)); const _0x113edc = document[_0x354752(0x5b7)](_0x354752(0x28d)), _0x185184 = document[_0x354752(0x5b7)](_0x354752(0x31a)); if (_0x2c812b) _0x113edc[_0x354752(0x483)] = URL[_0x354752(0x371)](_0x2c812b), _0x185184[_0x354752(0x6ca)][_0x354752(0x836)] = _0x354752(0x534); else { if (_0x354752(0x5a4) !== _0x354752(0x1f5)) _0x185184[_0x354752(0x6ca)][_0x354752(0x836)] = _0x354752(0x4e3); else { const _0x39b3b1 = _0x241ec5[_0x354752(0x73f)]; _0x33943b[_0x354752(0x78c)][_0x354752(0x6ca)][_0x354752(0x6a0)](_0x354752(0x306), _0x39b3b1 + '%'), _0x5943dd[_0x354752(0x69e)]('themeLightness', _0x39b3b1), _0x185cf3(); } } } catch (_0x16f944) { if ('ppPaX' !== _0x354752(0x1c9)) return { 'role': _0x354752(0x472), 'content': [{ 'type': _0x354752(0x68e), 'text': _0x18c664[_0x354752(0x398)] || '\x20' }, { 'type': 'image_url', 'image_url': { 'url': _0x871db['image'], 'detail': _0x354752(0x474) } }] }; else console[_0x354752(0x50e)](_0x354752(0x6b3), _0x16f944); } } else _0x581af4(_0x354752(0x397) + _0x4c5af8[_0x354752(0x832)]); } _0x450018['addEventListener']('click', () => { const _0x344582 = _0x27dd8f; if (_0x344582(0x150) === _0x344582(0x2ee)) { const _0x1fc0c4 = _0x292c03['entries']['filter'](_0x47b2a3 => _0x47b2a3[_0x344582(0x4e9)] === 'user')[_0x344582(0x121)](); _0x1fc0c4 && (_0x991d83 = _0x1fc0c4[_0x344582(0x398)]); } else _0x472bcd(), _0x4f27ca(_0x344582(0x769), _0x344582(0x707)); }), document[_0x27dd8f(0x5b7)]('back-to-home-from-user-list')[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => _0x4f27ca('home', _0x27dd8f(0x769))), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x181))['addEventListener']('click', () => _0x4535ee()), document[_0x27dd8f(0x5b7)]('back-to-user-list-from-edit')['addEventListener'](_0x27dd8f(0x66b), () => { const _0x3ddf03 = _0x27dd8f; _0x3ddf03(0x72a) !== 'Hlvyc' ? (_0x2499c6 = _0x48d9a6[_0x3ddf03(0x5ba)](_0x3ddf03(0x509)), _0x3b222e[_0x3ddf03(0x640)] = _0x3ddf03(0x794), _0x4743e9[_0x3ddf03(0x2d0)] = _0x3ddf03(0x3eb), _0x7903a8['appendChild'](_0x4cd6ff)) : (_0x472bcd(), _0x4f27ca('userProfileList', 'userProfile')); }), document['getElementById'](_0x27dd8f(0x189))[_0x27dd8f(0x572)]('click', _0x2290e0), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x155))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x5b8afc), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x54e))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x3450ae = _0x27dd8f, _0x454469 = document[_0x3450ae(0x5b7)](_0x3450ae(0x5af))['value']; if (_0x454469) { if (_0x3450ae(0x106) === _0x3450ae(0x106)) _0x557cc6[_0x3450ae(0x26a)] = _0x454469, _0x162000(), _0x599dea('已设为当前用户！'), _0x472bcd(), document[_0x3450ae(0x5b7)](_0x3450ae(0x54e))[_0x3450ae(0x6ca)]['display'] = _0x3450ae(0x4e3); else return []; } }); function _0x40920c(_0x58583e) { const _0x4f89a9 = _0x27dd8f, _0x3e3cb4 = _0x557cc6[_0x4f89a9(0x46d)][_0x4f89a9(0x4d1)](_0x4c515e => _0x4c515e['id'] === _0x58583e), _0xa7679f = _0x3e3cb4?.['boundUserProfileId']; let _0x24c420 = _0x557cc6[_0x4f89a9(0x58d)][_0x4f89a9(0x4d1)](_0x530028 => _0x530028['id'] === _0xa7679f); return !_0x24c420 && (_0x24c420 = _0x557cc6[_0x4f89a9(0x58d)][_0x4f89a9(0x4d1)](_0xeeab79 => _0xeeab79['id'] === _0x557cc6[_0x4f89a9(0x26a)]) || _0x557cc6[_0x4f89a9(0x58d)][0x0]), _0x24c420 || { 'name': '用户', 'avatar': _0x3b11bb, 'persona': '' }; } function _0x220a06(_0x4e2e77) { const _0x2a277f = _0x27dd8f; if ('hQUSE' !== _0x2a277f(0x236)) { const _0x291164 = document['getElementById'](_0x4e2e77); _0x291164[_0x2a277f(0x7a2)] = '', _0x557cc6[_0x2a277f(0x58d)][_0x2a277f(0x302)](_0x109eef => { const _0x7618f2 = _0x2a277f; if (_0x7618f2(0x484) !== 'OnWLD') _0x1b4a15[_0x7618f2(0x17f)]('chatHistory_' + _0x4b6b32[_0x7618f2(0x589)]); else { const _0x1fca9c = document[_0x7618f2(0x5ba)](_0x7618f2(0x5e9)); _0x1fca9c[_0x7618f2(0x73f)] = _0x109eef['id'], _0x1fca9c[_0x7618f2(0x2d0)] = _0x109eef[_0x7618f2(0x293)], _0x291164['appendChild'](_0x1fca9c); } }); } else { const _0x2c3c81 = _0x467df5[_0x2a277f(0x3ee)](_0x33306f); if (_0x2c3c81) { const _0xf7f0df = _0x321a0c(_0x2c3c81[0x1], 0xa), _0x2d5b55 = _0x5a46f4(_0x2c3c81[0x2], 0xa), _0xb74c8f = _0x252459(_0x2c3c81[0x3], 0xa) * (_0x2c3c81[0x3][_0x2a277f(0x7a6)] === 0x2 ? 0xa : 0x1), _0x4d8f22 = _0xf7f0df * 0x3c + _0x2d5b55 + _0xb74c8f / 0x3e8, _0x36a82c = _0x337bf7[_0x2a277f(0x4f8)](_0x2c8fba, '')[_0x2a277f(0xf2)](); _0x36a82c && _0x25bbf7[_0x2a277f(0x6b4)]({ 'time': _0x4d8f22, 'text': _0x36a82c }); } } } function _0x1bdfb1(_0x4e3d65) { const _0x43263f = _0x27dd8f; if (_0x43263f(0x3b9) !== _0x43263f(0x429)) { const _0x539fd8 = _0x3132c6(_0x4e3d65), _0x43d502 = document[_0x43263f(0x5b7)](_0x43263f(0x282)); _0x43d502[_0x43263f(0x6ca)][_0x43263f(0xcf)] = ''; let _0xbcf803 = document[_0x43263f(0x5b7)](_0x43263f(0xf8) + _0x4e3d65); if (_0xbcf803) _0xbcf803['innerHTML'] = ''; if (!_0x539fd8) return; _0x539fd8[_0x43263f(0x39f)] && (_0x43d502['style'][_0x43263f(0xcf)] = _0x43263f(0x1d1) + _0x539fd8[_0x43263f(0x39f)] + '\x27)', _0x43d502['style']['backgroundSize'] = _0x43263f(0x791), _0x43d502[_0x43263f(0x6ca)][_0x43263f(0x24d)] = _0x43263f(0x5ff)); if (_0x539fd8['bubbleCss']) { if ('lnyEB' === 'FFPGL') _0x4aa50b[_0x43263f(0x2d0)] = _0x3d7b04[_0x43263f(0x652)](_0x47a09c)[_0x43263f(0x30e)](_0x4553ea => _0x4553ea[_0x43263f(0x357)][_0x43263f(0x2d0)][_0x43263f(0xf2)]())[_0x43263f(0x566)]('、'); else { let _0x138e2d = document[_0x43263f(0x5b7)](_0x43263f(0xf8) + _0x539fd8['id']); !_0x138e2d && (_0x138e2d = document['createElement']('style'), _0x138e2d['id'] = _0x43263f(0xf8) + _0x539fd8['id'], document[_0x43263f(0x73d)]['appendChild'](_0x138e2d)); const _0x14a226 = _0x539fd8[_0x43263f(0x173)], _0x5d193b = _0x14a226[_0x43263f(0x4f8)](/\.bubble\.sent/g, _0x43263f(0x5da) + _0x539fd8['id'] + '.message.user')[_0x43263f(0x4f8)](/\.bubble\.received/g, _0x43263f(0x5da) + _0x539fd8['id'] + _0x43263f(0x5f2)); _0x138e2d['innerHTML'] = _0x5d193b; } } } else _0xe00ea4(), _0x1044a2('diaryList', 'home'); } function _0x18d626() { const _0x27516d = _0x27dd8f, _0x31ba53 = document[_0x27516d(0x5b7)](_0x27516d(0x6cd)); _0x31ba53[_0x27516d(0x7a2)] = ''; const _0x30c4e4 = _0x83a6e1 => { const _0x911e43 = _0x27516d; if (_0x911e43(0x2b9) !== _0x911e43(0x2b9)) _0x4119e8(_0x20d883); else { _0x557cc6[_0x911e43(0x6d7)][_0x83a6e1] = null; if (_0x83a6e1 === 'image') _0x557cc6[_0x911e43(0x6d7)][_0x911e43(0x8c)] = null; _0x18d626(); } }, _0x3d30fc = _0x557cc6[_0x27516d(0x6d7)]['imageId'], _0x1764be = _0x557cc6['pendingPostAttachments'][_0x27516d(0x164)]; if (_0x3d30fc) { if (_0x27516d(0xea) !== _0x27516d(0xea)) _0x57ec40(_0x34de18), _0x59f218[_0x27516d(0x73f)] = '', _0x12e62(_0x8fd100, 0x64); else { const _0x2b27a9 = document[_0x27516d(0x5ba)](_0x27516d(0x509)); _0x2b27a9['className'] = _0x27516d(0x2d6), _0x2b27a9[_0x27516d(0x7a2)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x2b27a9[_0x27516d(0x5ab)](_0x27516d(0x298))[_0x27516d(0x7bc)] = () => _0x30c4e4(_0x27516d(0x690)), _0x31ba53['appendChild'](_0x2b27a9), _0x2aeef5(_0x3d30fc)[_0x27516d(0x192)](_0x3259a8 => { const _0xfac3f3 = _0x27516d, _0x22a19d = document[_0xfac3f3(0x5b7)](_0xfac3f3(0x7ac)); _0x22a19d && _0x3259a8 && (_0x22a19d[_0xfac3f3(0x483)] = URL['createObjectURL'](_0x3259a8)); }); } } if (_0x1764be) { if (_0x27516d(0x40e) !== _0x27516d(0x318)) { const _0x4944e1 = document[_0x27516d(0x5ba)]('div'); _0x4944e1[_0x27516d(0x640)] = 'preview-item', _0x4944e1[_0x27516d(0x7a2)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-preview-card\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + (_0x1764be['coverUrl'] || _0x1732e7) + '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div>' + _0x1764be[_0x27516d(0x6c8)] + _0x27516d(0x3ea) + _0x1764be['artist'] + _0x27516d(0x62a), _0x4944e1[_0x27516d(0x5ab)](_0x27516d(0x298))['onclick'] = () => _0x30c4e4(_0x27516d(0x164)), _0x31ba53[_0x27516d(0x796)](_0x4944e1); } else _0x8c9d2['preferences'] = { 'perChatContextLines': 0x64, 'widgetBgImage': null }; } } async function _0xd0933d(_0x2f64f2) { const _0x3d4d2a = _0x27dd8f, _0x4f2fb1 = _0x557cc6[_0x3d4d2a(0x78e)]['find'](_0x2a3782 => _0x2a3782['id'] === _0x557cc6['activeFriendCircleId']); if (!_0x4f2fb1) return; _0x2158b6(!![], '大家正在赶来回复...'), _0x557cc6[_0x3d4d2a(0x161)] = !![]; try { const _0x3b86e1 = _0x4f2fb1[_0x3d4d2a(0x14c)][_0x3d4d2a(0x30e)](_0x5282df => _0x3132c6(_0x5282df))[_0x3d4d2a(0x1d8)](Boolean), _0x5c8891 = _0x1ad6ce(), _0x388010 = _0x3b86e1[_0x3d4d2a(0x30e)](_0x31d421 => { const _0x36d7f7 = _0x3d4d2a, { omniText: _0x1b2509 } = _0x576fb7(_0x31d421['id'], null), _0x3856ce = _0x129229(_0x31d421['id']), _0x377423 = _0x31d421['linkedWorldBookIds'] && _0x31d421[_0x36d7f7(0x674)][_0x36d7f7(0x7a6)] > 0x0 ? _0x36d7f7(0x261) + _0x31d421[_0x36d7f7(0x293)] + '的个人专属世界观设定\x0a' + _0x31d421[_0x36d7f7(0x674)]['map'](_0x1432eb => _0x557cc6['worldBooks'][_0x36d7f7(0x4d1)](_0x2ed0ce => _0x2ed0ce['id'] === _0x1432eb))['filter'](Boolean)[_0x36d7f7(0x30e)](_0x1631a0 => '\x0a##\x20条目:\x20' + _0x1631a0[_0x36d7f7(0x293)] + '\x0a' + _0x1631a0[_0x36d7f7(0x398)])[_0x36d7f7(0x566)]('') : ''; return '-\x20姓名:\x20' + _0x31d421[_0x36d7f7(0x293)] + _0x36d7f7(0x4a0) + _0x31d421['id'] + _0x36d7f7(0x6d1) + _0x31d421[_0x36d7f7(0x6f2)] + _0x36d7f7(0x46f) + _0x1b2509 + '\x0a' + _0x3856ce + '\x0a' + _0x377423; })[_0x3d4d2a(0x566)]('\x0a\x0a'), _0xbdd3d = _0x3a4665(_0x2f64f2['authorId']) || { 'name': '用户' }, _0x46894c = _0xbdd3d[_0x3d4d2a(0x6f2)] ? _0x3d4d2a(0x626) + _0xbdd3d[_0x3d4d2a(0x293)] + '\x0a-\x20人设:\x20' + _0xbdd3d[_0x3d4d2a(0x6f2)] + '\x0a' : ''; let _0x2ed35e = null; if (_0x2f64f2[_0x3d4d2a(0x690)]) { if (_0x3d4d2a(0x422) === 'BJAqb') _0x2ed35e = _0x2f64f2[_0x3d4d2a(0x690)]; else { const _0x362cb5 = _0x2796f1(_0x9009f4['participantIds'][0x0]); _0x362cb5 ? (_0x1f2548 = _0x362cb5[_0x3d4d2a(0x51e)] || _0x5ad0b8, _0x51d5e2 = _0x362cb5[_0x3d4d2a(0x293)] || '未命名角色', _0x11e64d = _0x362cb5['remark'] || '私聊') : (_0xa15107 = _0x3d4d2a(0x5c5), _0x39cec1 = _0x3d4d2a(0xa6)); } } else { if (_0x2f64f2[_0x3d4d2a(0x8c)]) try { const _0x47854f = await _0x2aeef5(_0x2f64f2[_0x3d4d2a(0x8c)]); _0x47854f && (_0x2ed35e = await _0x27ec3a(_0x47854f)); } catch (_0x45a763) { console[_0x3d4d2a(0x50e)]('在准备动态回复时，读取图片失败:', _0x45a763); } } let _0x20eb96 = _0xbdd3d['name'] + _0x3d4d2a(0x269) + _0x2f64f2[_0x3d4d2a(0x398)] + '”'; if (_0x2ed35e) { if (_0x3d4d2a(0x629) === _0x3d4d2a(0x629)) _0x20eb96 += _0x3d4d2a(0x5b0); else { const _0x84f6b4 = new _0x23c357(), _0x9c80c9 = _0xc107bc['getElementById'](_0x3d4d2a(0x7a3)), _0xec4fa7 = _0x53a50a['getElementById'](_0x3d4d2a(0x4ad)); if (_0x9c80c9 && _0xec4fa7) { const _0x3bb958 = _0x34d084(_0x84f6b4['getHours']())[_0x3d4d2a(0x1db)](0x2, '0'), _0x27cf36 = _0x5cb446(_0x84f6b4[_0x3d4d2a(0x762)]())[_0x3d4d2a(0x1db)](0x2, '0'); _0x9c80c9['textContent'] = _0x3bb958 + ':' + _0x27cf36; const _0x32930f = _0x84f6b4[_0x3d4d2a(0x2aa)]() + 0x1, _0x57a256 = _0x84f6b4['getDate'](), _0x4e2755 = [_0x3d4d2a(0x408), _0x3d4d2a(0xda), '星期二', _0x3d4d2a(0x377), _0x3d4d2a(0x588), _0x3d4d2a(0x748), _0x3d4d2a(0x7eb)][_0x84f6b4[_0x3d4d2a(0x5cc)]()]; _0xec4fa7[_0x3d4d2a(0x2d0)] = _0x32930f + '月' + _0x57a256 + '日\x20' + _0x4e2755; } } } _0x2f64f2[_0x3d4d2a(0x516)] === _0x3d4d2a(0x164) && (_0x20eb96 += '\x20[并分享了歌曲:\x20' + _0x2f64f2[_0x3d4d2a(0x6c8)] + _0x3d4d2a(0x39c) + _0x2f64f2[_0x3d4d2a(0x1e4)] + ']'); const _0x1e409d = _0x3d4d2a(0x824) + _0x388010 + '\x0a\x0a' + _0x46894c + _0x3d4d2a(0x14e) + _0x5c8891 + '\x0a\x0a#\x20用户的动态\x0a' + _0x20eb96 + _0x3d4d2a(0x438), _0x4bfe89 = [{ 'role': 'system', 'content': _0x1e409d }], _0x5c93ed = { 'role': _0x3d4d2a(0x472), 'content': _0x3d4d2a(0x2d7) }; _0x2ed35e && (_0x5c93ed[_0x3d4d2a(0x690)] = _0x2ed35e); _0x4bfe89['push'](_0x5c93ed); const _0x2f264b = await _0x2d20cc(_0x4bfe89, { 'json': !![] }), _0x1e6cba = _0x2f264b[_0x3d4d2a(0x3ee)](/({[\s\S]*})/); if (!_0x1e6cba) throw new Error(_0x3d4d2a(0x542)); const _0x309756 = JSON[_0x3d4d2a(0x417)](_0x1e6cba[0x1]), _0x93dcba = _0x4f2fb1[_0x3d4d2a(0x18a)][_0x3d4d2a(0x4d1)](_0x34b55e => _0x34b55e['id'] === _0x2f64f2['id']); _0x93dcba && (_0x93dcba['likes'] = _0x309756[_0x3d4d2a(0x304)] || [], _0x93dcba[_0x3d4d2a(0x7b)] = (_0x309756['comments'] || [])[_0x3d4d2a(0x30e)]((_0x20d160, _0x1d6338) => ({ ..._0x20d160, 'commentId': 'c_' + _0x2f64f2[_0x3d4d2a(0x798)] + '_' + _0x1d6338 })), _0x162000(), _0x5de4bd()); } catch (_0x46d6ef) { if ('yTsgs' !== _0x3d4d2a(0x108)) { const _0x44eb10 = _0x54e265['find'](_0x52676d => _0x52676d[_0x3d4d2a(0x293)] === _0x3f044c[_0x3d4d2a(0x293)]); if (_0x44eb10) _0x36c927['assign'](_0x7f79eb, { 'content': _0x3d4d2a(0x167) + _0x44eb10[_0x3d4d2a(0x293)] + ']', 'displayUrl': _0x44eb10[_0x3d4d2a(0x606)] }); else _0x233856['content'] = '[sticker:' + _0x2db4b5['name'] + ']'; } else console['error']('生成动态回复失败:', _0x46d6ef), _0x599dea(_0x3d4d2a(0x1e2)); } finally { _0x2158b6(![]), _0x557cc6[_0x3d4d2a(0x161)] = ![]; } } function _0x41261e() { const _0x5d07fc = _0x27dd8f, _0x57f7d9 = _0x557cc6['friendCircles'][_0x5d07fc(0x4d1)](_0x1e7adb => _0x1e7adb['id'] === _0x557cc6[_0x5d07fc(0x761)]), _0x29ab96 = _0x57f7d9?.[_0x5d07fc(0x2a6)]; let _0x410e7a = _0x557cc6[_0x5d07fc(0x58d)][_0x5d07fc(0x4d1)](_0x3f0aa7 => _0x3f0aa7['id'] === _0x29ab96); !_0x410e7a && (_0x410e7a = _0x557cc6[_0x5d07fc(0x58d)][_0x5d07fc(0x4d1)](_0x27f191 => _0x27f191['id'] === _0x557cc6['activeUserProfileId'])); !_0x410e7a && (_0x5d07fc(0x727) !== _0x5d07fc(0x727) ? _0x3e1a18(new _0xa459da(_0x5d07fc(0x36e))) : _0x410e7a = _0x557cc6['userProfiles'][0x0]); if (_0x410e7a) { if (_0x5d07fc(0x772) !== _0x5d07fc(0x2f4)) document[_0x5d07fc(0x5b7)]('user-post-avatar')[_0x5d07fc(0x483)] = _0x410e7a[_0x5d07fc(0x51e)] || _0x3b11bb; else { const _0x460c30 = _0x59a0a0[_0x5d07fc(0x78e)][_0x5d07fc(0x4d1)](_0x224414 => _0x224414['id'] === _0x1c8009['activeFriendCircleId']), _0x24b067 = _0x460c30 ? _0x460c30[_0x5d07fc(0x18a)] : []; if (!_0x24b067 || _0x24b067[_0x5d07fc(0x7a6)] === 0x0) return ''; const _0x1a3693 = _0x24b067[_0x5d07fc(0x186)](0x0, 0x5), _0x15c669 = _0x1a3693[_0x5d07fc(0x30e)](_0x210b1c => { const _0x3d98a9 = _0x5d07fc, _0x2c088d = _0x3b9fab(_0x210b1c[_0x3d98a9(0x25f)]) || { 'name': '未知' }; let _0xe084f3 = '-\x20[动态]\x20' + _0x2c088d[_0x3d98a9(0x293)] + _0x3d98a9(0x55c) + (_0x210b1c['thought'] || _0x210b1c[_0x3d98a9(0x398)]) + '”'; return _0x210b1c[_0x3d98a9(0x516)] === _0x3d98a9(0x164) && (_0xe084f3 += _0x3d98a9(0xa9) + _0x210b1c['songName'] + '\x20-\x20' + _0x210b1c['artist'] + ')'), _0xe084f3; }); return _0x5d07fc(0x6a8) + _0x15c669[_0x5d07fc(0x566)]('\x0a'); } } } function _0x234b8a(_0x5bf545) { const _0x5abb68 = _0x27dd8f; if (_0x5abb68(0x322) !== 'qOvlK') { let _0x3a4ef5 = 0x0, _0x651f2c = 0x0, _0x59f6ed = 0x0; if (_0x5bf545[_0x5abb68(0x7a6)] == 0x4) _0x3a4ef5 = '0x' + _0x5bf545[0x1] + _0x5bf545[0x1], _0x651f2c = '0x' + _0x5bf545[0x2] + _0x5bf545[0x2], _0x59f6ed = '0x' + _0x5bf545[0x3] + _0x5bf545[0x3]; else _0x5bf545[_0x5abb68(0x7a6)] == 0x7 && (_0x5abb68(0x6bb) === 'bSIZs' ? _0x54731d[_0x5abb68(0x29b)](_0x54f073) : (_0x3a4ef5 = '0x' + _0x5bf545[0x1] + _0x5bf545[0x2], _0x651f2c = '0x' + _0x5bf545[0x3] + _0x5bf545[0x4], _0x59f6ed = '0x' + _0x5bf545[0x5] + _0x5bf545[0x6])); _0x3a4ef5 /= 0xff, _0x651f2c /= 0xff, _0x59f6ed /= 0xff; let _0x38853f = Math['min'](_0x3a4ef5, _0x651f2c, _0x59f6ed), _0x40c0d6 = Math['max'](_0x3a4ef5, _0x651f2c, _0x59f6ed), _0x4398ae = _0x40c0d6 - _0x38853f, _0x2e3458 = 0x0, _0x51c16e = 0x0, _0x32ad86 = 0x0; if (_0x4398ae == 0x0) _0x2e3458 = 0x0; else { if (_0x40c0d6 == _0x3a4ef5) _0x2e3458 = (_0x651f2c - _0x59f6ed) / _0x4398ae % 0x6; else { if (_0x40c0d6 == _0x651f2c) _0x2e3458 = (_0x59f6ed - _0x3a4ef5) / _0x4398ae + 0x2; else _0x2e3458 = (_0x3a4ef5 - _0x651f2c) / _0x4398ae + 0x4; } } _0x2e3458 = Math['round'](_0x2e3458 * 0x3c); if (_0x2e3458 < 0x0) _0x2e3458 += 0x168; return _0x32ad86 = (_0x40c0d6 + _0x38853f) / 0x2, _0x51c16e = _0x4398ae == 0x0 ? 0x0 : _0x4398ae / (0x1 - Math[_0x5abb68(0x3d1)](0x2 * _0x32ad86 - 0x1)), _0x51c16e = +(_0x51c16e * 0x64)[_0x5abb68(0x3f4)](0x1), _0x32ad86 = +(_0x32ad86 * 0x64)[_0x5abb68(0x3f4)](0x1), { 'h': _0x2e3458, 's': _0x51c16e, 'l': _0x32ad86 }; } else { const _0x1c6229 = { 'id': _0x304922['id'], 'url': _0x2eb8ab['playableUrl'] }; _0x3c8f7e(this, _0x1c6229); } } function _0x2e8b13() { const _0x4be97c = _0x27dd8f; if (_0x4be97c(0x34d) !== _0x4be97c(0x34d)) _0x5ed2ce(_0x15be42 + 0x1); else { const _0x337b07 = (_0x377066, _0x25e7ef, _0x51962f) => { const _0x31b605 = _0x4be97c, _0x3efe83 = document[_0x31b605(0x5b7)](_0x377066); if (!_0x3efe83) return; let _0x5ccfdc = null; try { 'TohRp' === _0x31b605(0x5d9) ? _0x4eb9bb[_0x31b605(0x17f)](_0x31b605(0x435)) : _0x5ccfdc = JSON[_0x31b605(0x417)](localStorage[_0x31b605(0x426)](_0x25e7ef) || '{}'); } catch { if (_0x31b605(0x21c) === 'GiUZx') { const _0x485521 = _0x598742[_0x31b605(0x660)](_0x268c43 / 0x3c); if (_0x485521 < 0x30) _0x5c99e4 += _0x31b605(0x53c) + _0x485521 + '小时前聊过，可以适当问候，不要直接继续之前的话题。'; else _0x559414 += _0x31b605(0x72e) + _0x225153[_0x31b605(0x660)](_0x485521 / 0x18) + _0x31b605(0x3b4); } else _0x5ccfdc = {}; } _0x3efe83[_0x31b605(0x6ca)][_0x31b605(0x6cb)] = _0x31b605(0x503), _0x3efe83['style']['top'] = '', _0x3efe83['style']['left'] = '', _0x3efe83[_0x31b605(0x6ca)][_0x31b605(0x573)] = '', _0x3efe83[_0x31b605(0x6ca)][_0x31b605(0x636)] = '', _0x3efe83[_0x31b605(0x6ca)][_0x31b605(0x378)] = ''; if (typeof _0x5ccfdc['top'] === _0x31b605(0x83c) && typeof _0x5ccfdc[_0x31b605(0x7ee)] === _0x31b605(0x83c)) _0x31b605(0x637) === _0x31b605(0x637) ? (_0x3efe83['style'][_0x31b605(0x100)] = _0x5ccfdc['top'] + '%', _0x3efe83[_0x31b605(0x6ca)][_0x31b605(0x7ee)] = _0x5ccfdc['left'] + '%') : _0x24eed3 += '-\x20**对话状态提示**:\x20对话正在进行中，可以直接延续话题。\x0a'; else for (const _0x42539d in _0x51962f) { if ('LVyhc' !== _0x31b605(0x2df)) { const _0x466613 = _0x1e6221['createElement'](_0x31b605(0x509)); _0x466613[_0x31b605(0x640)] = _0x31b605(0x5c7), _0x466613[_0x31b605(0x7a2)] = _0x4d3136, _0x2000b3 === 'user' ? (_0x15c8ea[_0x31b605(0x796)](_0x466613), _0x256a24[_0x31b605(0x796)](_0x16534f)) : (_0x2f960e[_0x31b605(0x796)](_0x502b4d), _0x39a7c8[_0x31b605(0x796)](_0x466613)); } else _0x3efe83['style'][_0x42539d] = _0x51962f[_0x42539d]; } }; _0x337b07(_0x4be97c(0x75f), _0x4be97c(0x525), { 'top': _0x4be97c(0x679), 'left': _0x4be97c(0x7c7), 'transform': _0x4be97c(0x3f3) }), _0x337b07(_0x4be97c(0x279), _0x4be97c(0xf3), { 'top': _0x4be97c(0x2e3), 'right': '4%' }), _0x337b07('app-user-profiles', _0x4be97c(0x248), { 'top': _0x4be97c(0x2e3), 'right': '28%' }), _0x337b07(_0x4be97c(0x22e), 'appIconPosition_app-settings', { 'top': '8%', 'right': _0x4be97c(0x51b) }), _0x337b07(_0x4be97c(0x300), _0x4be97c(0x1e1), { 'top': '8%', 'right': '4%' }), _0x337b07('app-music-library', _0x4be97c(0x7c5), { 'top': '59%', 'left': '5%' }), _0x337b07(_0x4be97c(0x807), _0x4be97c(0x6e4), { 'top': _0x4be97c(0x788), 'left': _0x4be97c(0x35a) }), _0x337b07(_0x4be97c(0x264), _0x4be97c(0x5d4), { 'top': _0x4be97c(0x3b8), 'left': '7%' }), _0x337b07(_0x4be97c(0x67c), _0x4be97c(0x13a), { 'top': _0x4be97c(0x3f9), 'left': _0x4be97c(0x35a) }), _0x337b07(_0x4be97c(0x270), 'badgeState', { 'top': _0x4be97c(0x344), 'right': '5%' }), _0x337b07(_0x4be97c(0x7f5), _0x4be97c(0x2f0), { 'top': _0x4be97c(0x6e9), 'left': '6%' }), _0x337b07(_0x4be97c(0x31a), _0x4be97c(0xd1), { 'top': '8%', 'left': '5%' }), _0x337b07('music-widget', _0x4be97c(0x50b), { 'top': '35%', 'left': '5%' }); } } function _0x335694() { const _0x18c468 = _0x27dd8f, _0x207e10 = document[_0x18c468(0x5b7)](_0x18c468(0x6fc)); _0x207e10[_0x18c468(0x7a2)] = ''; const _0x5eba95 = document[_0x18c468(0x687)](_0x18c468(0x627)); _0x5eba95[_0x18c468(0x302)](_0x2e9250 => { const _0xe731a2 = _0x18c468, _0x268697 = _0x2e9250['id'], _0x411b81 = _0x2e9250[_0xe731a2(0x5ab)](_0xe731a2(0x5eb))['textContent'], _0x20661c = _0xe731a2(0x5a8) + _0x268697, _0x7b7776 = localStorage[_0xe731a2(0x426)](_0x20661c), _0x56e9bf = document[_0xe731a2(0x5ba)](_0xe731a2(0x509)); _0x56e9bf['className'] = _0xe731a2(0x5d5), _0x56e9bf[_0xe731a2(0x6ca)][_0xe731a2(0x733)] = _0xe731a2(0xa0), _0x56e9bf[_0xe731a2(0x7a2)] = _0xe731a2(0x7e2) + _0x268697 + _0xe731a2(0x62c) + (_0x7b7776 || 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7') + '\x22\x20class=\x22char-avatar\x22\x20style=\x22border-radius:\x2012px;\x20background-color:\x20#eee;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22\x20style=\x22flex-grow:\x201;\x22>' + _0x411b81 + _0xe731a2(0x729) + _0x268697 + '\x22\x20accept=\x22image/*\x22\x20style=\x22display:\x20none;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x22\x20onclick=\x22document.getElementById(\x27input_' + _0x268697 + _0xe731a2(0x3bd) + _0x20661c + '\x27);\x20location.reload();\x22>恢复</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', _0x207e10['appendChild'](_0x56e9bf); const _0x4b0883 = document['getElementById']('input_' + _0x268697); _0x4b0883[_0xe731a2(0x572)](_0xe731a2(0x265), async _0x14682c => { const _0x7d5881 = _0xe731a2, _0x59b270 = _0x14682c[_0x7d5881(0x44b)][_0x7d5881(0x209)][0x0]; if (!_0x59b270) return; try { const _0x43520e = await _0x4889cd(_0x59b270); localStorage[_0x7d5881(0x69e)](_0x20661c, _0x43520e), document[_0x7d5881(0x5b7)](_0x7d5881(0x2ab) + _0x268697)[_0x7d5881(0x483)] = _0x43520e, _0x41ea4b(); } catch (_0x5a8ca5) { _0x599dea(_0x7d5881(0x726) + _0x5a8ca5[_0x7d5881(0x832)]); } }); }); } function _0x41ea4b() { const _0x26f064 = _0x27dd8f, _0x46626e = document[_0x26f064(0x687)](_0x26f064(0x627)); _0x46626e[_0x26f064(0x302)](_0x4f2fd0 => { const _0x1d1e3b = _0x26f064, _0x52f794 = _0x4f2fd0['id'], _0x3ae1dd = 'customIcon_' + _0x52f794, _0x4651bb = localStorage[_0x1d1e3b(0x426)](_0x3ae1dd), _0x5c16fc = _0x4f2fd0['querySelector'](_0x1d1e3b(0x6cc)); if (_0x4651bb) { if (_0x1d1e3b(0x4e1) === _0x1d1e3b(0x4e1)) _0x5c16fc['innerHTML'] = '<img\x20src=\x22' + _0x4651bb + _0x1d1e3b(0x6b0); else { if (_0x5041d4 === null) return; const _0xea9552 = _0x188fb6[_0x1d1e3b(0x73f)][_0x1d1e3b(0xf2)](); if (_0xea9552 === '') { _0x28309b(); return; } const _0x53a638 = _0x4a4463[_0x1d1e3b(0x5b8)][_0x33799b]; _0x53a638 && (_0x53a638[_0x1d1e3b(0x398)] = _0xea9552, _0x56f701(), _0x46ccfc()), _0xfac946['classList'][_0x1d1e3b(0x7ff)](_0x1d1e3b(0x1c6)), _0x4fca6e = null; } } else { if ('lbBNp' === _0x1d1e3b(0x537)) _0x2fa5b4[_0x1d1e3b(0x50e)](_0x1d1e3b(0x2d3), _0x293379), _0x42f4d0[_0x1d1e3b(0x6ca)]['backgroundImage'] = ''; else { const _0xa6b4af = document[_0x1d1e3b(0x5ab)](_0x1d1e3b(0x305) + _0x52f794 + '\x20.app-icon-img,\x20#app-dock-top-right\x20#' + _0x52f794 + _0x1d1e3b(0x68b))?.['innerHTML']; _0xa6b4af && (_0x5c16fc[_0x1d1e3b(0x7a2)] = _0xa6b4af); } } }); } function _0x3abf28() { const _0x53de08 = _0x27dd8f, _0x5bf37c = _0x557cc6[_0x53de08(0x78e)][_0x53de08(0x4d1)](_0x19a262 => _0x19a262['id'] === _0x557cc6[_0x53de08(0x761)]), _0x360b06 = _0x5db7d2(); let _0x1f0690 = []; if (_0x5bf37c && _0x5bf37c[_0x53de08(0x18a)]) { if ('diwTt' !== _0x53de08(0x25a)) { const _0x50902c = _0x5bf37c['posts'][_0x53de08(0x1d8)](_0x7eea06 => _0x7eea06[_0x53de08(0x516)] === 'music' && _0x7eea06[_0x53de08(0x69f)])[_0x53de08(0x30e)](_0x4ff68f => ({ ..._0x4ff68f, 'source': _0x53de08(0x7ba) })); _0x1f0690[_0x53de08(0x6b4)](..._0x50902c); } else _0x5ecfe1[_0x53de08(0x50e)]('加载卡片图片失败', _0x3cca6f); } if (_0x360b06 && _0x557cc6[_0x53de08(0x5b8)]) { const _0x1ad232 = _0x557cc6[_0x53de08(0x5b8)][_0x53de08(0x1d8)](_0x542a1e => _0x542a1e[_0x53de08(0x516)] === _0x53de08(0x164) && _0x542a1e['playableUrl'])[_0x53de08(0x30e)](_0x505b64 => ({ ..._0x505b64, 'source': 'chat' })); _0x1f0690['push'](..._0x1ad232); } const _0x1e360a = Array[_0x53de08(0x652)](new Map(_0x1f0690[_0x53de08(0x30e)](_0x59514f => [_0x59514f[_0x53de08(0x69f)], _0x59514f]))[_0x53de08(0x57d)]()); _0x557cc6[_0x53de08(0x5d2)] = _0x1e360a[_0x53de08(0x5d1)]((_0x74c3a1, _0x3645ef) => _0x3645ef['timestamp'] - _0x74c3a1[_0x53de08(0x798)]); } function _0x14e7e2(_0xbf2215) { const _0x250433 = _0x27dd8f; if (_0xbf2215 < 0x0 || _0xbf2215 >= _0x4d8e21[_0x250433(0x7a6)]) return; _0x483a75 = _0xbf2215; const _0x3f9f98 = _0x4d8e21[_0xbf2215]; _0x4baa54[_0x250433(0x483)] = _0x3f9f98[_0x250433(0x69f)] || _0x3f9f98[_0x250433(0x606)], _0x4baa54[_0x250433(0x57e)](), _0x2766d9(), _0x4171b0(); } function _0x2766d9() { const _0x260596 = _0x27dd8f; if (_0x260596(0x578) === _0x260596(0x578)) { const _0x50ef8f = _0x4d8e21[_0x483a75]; _0x2d5ebb(_0x50ef8f); } else { _0x3482d5(_0x260596(0x40b)); return; } } function _0x4171b0() { const _0x1daab1 = _0x27dd8f; try { _0x1daab1(0x467) === 'wPtUE' ? localStorage[_0x1daab1(0x69e)](_0x1daab1(0x1f9), JSON[_0x1daab1(0x82f)]({ 'playlist': _0x557cc6[_0x1daab1(0x5d2)], 'currentIndex': _0x557cc6[_0x1daab1(0x2ff)] })) : (_0x269623[_0x1daab1(0x2d0)] = _0x69a711[_0x1daab1(0x234)] === 'narrator' ? '旁白' : _0x49109c[_0x1daab1(0x234)], _0x5bbcb2[_0x1daab1(0x2d0)] = _0x4b29d8[_0x1daab1(0x805)], _0xa0206f[_0x1daab1(0x234)] === _0x5db30d[_0x1daab1(0x293)] ? _0x479363(_0x3ddc31, _0x410a54['emotion']) : _0x18653a(_0x20d30c, _0x1daab1(0x343))); } catch (_0x2eec76) { console['error'](_0x1daab1(0x4c0), _0x2eec76); } } function _0x3c9162() { const _0x290936 = _0x27dd8f; if (_0x290936(0x401) === _0x290936(0x596)) _0x464f35[_0x290936(0x71d)] = null, _0x5eddbc(_0x290936(0x2e4)), _0x139d78(); else try { const _0x46b8ca = localStorage['getItem'](_0x290936(0x1f9)); if (_0x46b8ca) { const { playlist: _0x1ca7cf, currentIndex: _0x5810ec } = JSON[_0x290936(0x417)](_0x46b8ca); Array['isArray'](_0x1ca7cf) && _0x1ca7cf[_0x290936(0x7a6)] > 0x0 && _0x5810ec > -0x1 && (_0x557cc6[_0x290936(0x5d2)] = _0x1ca7cf, _0x557cc6[_0x290936(0x2ff)] = _0x5810ec, _0x557cc6[_0x290936(0x533)] = ![], _0x2766d9()); } } catch (_0x126281) { _0x290936(0x7be) !== _0x290936(0x7be) ? _0x4ca8ba(![]) : console['error'](_0x290936(0x3f1), _0x126281); } } function _0x2aabf4(_0x4073c1) { const _0x5e151b = _0x27dd8f; if (_0x5e151b(0x1d6) === _0x5e151b(0x3c1)) { const _0x14225b = _0x5d7900['querySelector'](_0x5e151b(0x486)); if (_0x14225b && (_0x14225b['id'] === _0x5e151b(0x704) || _0x14225b['id'] === _0x5e151b(0x26e))) _0x3731cf(); else { const _0xadebd7 = _0x2f1d67[_0x5e151b(0x687)](_0x5e151b(0x781)); _0xadebd7[_0x5e151b(0x302)](_0x1f99a3 => _0x1f99a3[_0x5e151b(0x7ff)]()); } } else { if (window[_0x5e151b(0x48b)]) clearTimeout(window[_0x5e151b(0x48b)]); const _0x210400 = _0x4073c1['target'][_0x5e151b(0x665)](_0x5e151b(0x7e6)); if (!_0x210400) return; const _0x195d31 = _0x210400['dataset'][_0x5e151b(0x798)], _0x57f0ab = _0x210400[_0x5e151b(0x35f)][_0x5e151b(0x793)]('user') ? _0x5e151b(0x472) : 'ai'; if (!_0x195d31) return; const _0x1c2376 = () => { const _0x3ba6ae = _0x5e151b; window[_0x3ba6ae(0x48b)] = setTimeout(() => { const _0xaf1c5a = _0x3ba6ae; if (_0x4073c1['type'] === _0xaf1c5a(0x514)) _0x4073c1[_0xaf1c5a(0x31e)](); _0x14d87e(parseInt(_0x195d31, 0xa), _0x57f0ab); }, 0x320); }, _0x552c70 = () => { const _0x25f33c = _0x5e151b; if (_0x25f33c(0xae) !== _0x25f33c(0x779)) { if (window[_0x25f33c(0x48b)]) clearTimeout(window[_0x25f33c(0x48b)]); } else { const _0x1f11a3 = _0x5960a6['characterLastScripts'][_0x16e03e]; _0x1f11a3 && _0x1f11a3[_0x25f33c(0x7a6)] > 0x0 && (_0x4cc356 = _0x1f11a3['at'](-0x1)); } }; document['addEventListener'](_0x5e151b(0x195), _0x552c70, { 'once': !![] }), document[_0x5e151b(0x572)](_0x5e151b(0x21f), _0x552c70, { 'once': !![] }), document[_0x5e151b(0x572)](_0x5e151b(0x73c), _0x552c70, { 'once': !![] }), _0x1c2376(); } } function _0x14d87e(_0x1cb7e7, _0x4b3cc7) { const _0x3b09ee = _0x27dd8f, _0x34ea1b = _0x3b09ee(0x753) + _0x1cb7e7; let _0x173c27 = document[_0x3b09ee(0x5b7)](_0x34ea1b); if (_0x173c27) return; const _0x26128e = '\x0a\x20\x20\x20\x20<div\x20id=\x22' + _0x34ea1b + '\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#dc3545;\x22>删除这篇日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20' + (_0x4b3cc7 === 'ai' ? _0x3b09ee(0x2b5) : '') + _0x3b09ee(0x664); document[_0x3b09ee(0x496)][_0x3b09ee(0x633)](_0x3b09ee(0x57c), _0x26128e); const _0x1b7b89 = document[_0x3b09ee(0x5b7)](_0x34ea1b), _0x5d1388 = () => _0x1b7b89['remove'](); _0x1b7b89[_0x3b09ee(0x5ab)](_0x3b09ee(0x783))[_0x3b09ee(0x7bc)] = _0x5d1388, _0x1b7b89['querySelector'](_0x3b09ee(0x681))[_0x3b09ee(0x7bc)] = _0x5d1388, _0x1b7b89[_0x3b09ee(0x5ab)](_0x3b09ee(0x67b))['onclick'] = () => { _0x444ee1(_0x1cb7e7), _0x5d1388(); }, _0x4b3cc7 === 'ai' && (_0x1b7b89['querySelector'](_0x3b09ee(0x2ae))['onclick'] = () => { const _0x109be1 = _0x3b09ee; _0x109be1(0x6f8) !== _0x109be1(0x6f8) ? _0x752530 = _0x1d7da7[_0x109be1(0x58d)][_0x109be1(0x4d1)](_0x33dc66 => _0x33dc66['id'] === _0x356bb0[_0x109be1(0x26a)]) || _0x6ac262[_0x109be1(0x58d)][0x0] : (_0x49e4aa(_0x1cb7e7), _0x5d1388()); }); } async function _0x444ee1(_0x4c679d) { const _0xd0579 = _0x27dd8f; if ('fTnwD' !== _0xd0579(0x315)) _0x412719 = _0x8963cf[_0xd0579(0xdc)](..._0xadd9f5[_0xd0579(0x18a)][_0xd0579(0x30e)](_0x44cdca => _0x44cdca[_0xd0579(0x798)])); else { const _0x34e70f = await _0x4512da(_0xd0579(0x821)); if (!_0x34e70f) return; const _0x4d9dce = _0x557cc6[_0xd0579(0xa8)][_0xd0579(0x4d1)](_0x2956b8 => _0x2956b8['characterId'] === _0x557cc6[_0xd0579(0x29e)]); if (!_0x4d9dce) return; const _0x112544 = _0x4d9dce['entries']['findIndex'](_0x15580d => _0x15580d['timestamp'] === _0x4c679d); _0x112544 > -0x1 && (_0x4d9dce[_0xd0579(0x759)][_0xd0579(0x168)](_0x112544, 0x1), _0x162000(), _0x9d5b0f(), _0x599dea(_0xd0579(0x466))); } } async function _0x49e4aa(_0xbbf17) { const _0x5e84af = _0x27dd8f; if (_0x5e84af(0x231) !== 'OAyht') { const _0x45c837 = _0x557cc6[_0x5e84af(0xa8)]['find'](_0x5153f8 => _0x5153f8[_0x5e84af(0x27b)] === _0x557cc6['activeDiaryCharacterId']); if (!_0x45c837) return; const _0x5abeca = _0x45c837[_0x5e84af(0x759)][_0x5e84af(0x6b6)](_0x74173b => _0x74173b['timestamp'] === _0xbbf17); _0x5abeca > -0x1 && (_0x45c837['entries']['splice'](_0x5abeca, 0x1), _0x162000(), _0x9d5b0f(), await _0x4934f7()); } else _0x4785d9 = _0x36c43c; } function _0x5ef101() { const _0x15719a = _0x27dd8f, _0x3c7ad1 = document[_0x15719a(0x5b7)](_0x15719a(0x1d0)); _0x3c7ad1['innerHTML'] = ''; const _0x3a143f = _0x557cc6[_0x15719a(0x618)]['filter'](_0xae5ee4 => _0x557cc6[_0x15719a(0x46d)][_0x15719a(0x74d)](_0x261eb4 => _0x261eb4['type'] === _0x15719a(0x405) && _0x261eb4[_0x15719a(0x765)][_0x15719a(0x158)](_0xae5ee4['id']))); if (_0x3a143f['length'] === 0x0) { _0x3c7ad1[_0x15719a(0x7a2)] = _0x15719a(0x797); return; } _0x3a143f[_0x15719a(0x302)](_0x31c263 => { const _0x5478dc = _0x15719a; if (_0x5478dc(0x60c) === 'pMFQi') { _0x157634[_0x5478dc(0x7a2)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>'; return; } else { const _0xb14bd5 = document[_0x5478dc(0x5ba)]('li'); _0xb14bd5[_0x5478dc(0x640)] = _0x5478dc(0x1b9), _0xb14bd5['dataset'][_0x5478dc(0x2bf)] = _0x31c263['id'], _0xb14bd5[_0x5478dc(0x7a2)] = _0x5478dc(0x16f) + (_0x31c263[_0x5478dc(0x51e)] || _0x1732e7) + _0x5478dc(0x317) + _0x31c263[_0x5478dc(0x293)] + _0x5478dc(0x101), _0xb14bd5[_0x5478dc(0x572)](_0x5478dc(0x66b), () => { _0x509da7(_0x31c263['id']); }), _0xb14bd5[_0x5478dc(0x5ab)](_0x5478dc(0x32f))[_0x5478dc(0x572)](_0x5478dc(0x66b), () => { const _0x5e8de8 = _0x5478dc; if ('CrWQd' === _0x5e8de8(0x6c0)) { const _0x2820b9 = _0x23fb3b(_0x533746[_0x5e8de8(0x25f)]); _0x2820b9 && (_0x17dc70 = _0x2820b9[_0x5e8de8(0x293)], _0x573956 = _0x2820b9['avatar']); } else _0x509da7(_0x31c263['id']); }), _0xb14bd5[_0x5478dc(0x5ab)](_0x5478dc(0x621))['addEventListener'](_0x5478dc(0x66b), _0x2793b2 => { const _0x564ff9 = _0x5478dc; _0x564ff9(0x3d3) === _0x564ff9(0x3d3) ? (_0x2793b2[_0x564ff9(0x760)](), _0x27533e(_0x31c263['id'])) : (_0x2c68b5(), _0x25581f[_0x564ff9(0x66b)]()); }), _0x3c7ad1[_0x5478dc(0x796)](_0xb14bd5); } }); } function _0x509da7(_0xf38ef1) { const _0x513675 = _0x27dd8f, _0x533eaa = _0x3132c6(_0xf38ef1); if (!_0x533eaa) return; _0x557cc6['activeDiaryCharacterId'] = _0xf38ef1; const _0x1a7571 = _0x557cc6[_0x513675(0xa8)][_0x513675(0x4d1)](_0x2ed682 => _0x2ed682['characterId'] === _0xf38ef1), _0x19fd01 = _0x1a7571 ? _0x1a7571[_0x513675(0x759)][_0x513675(0x7a6)] : 0x0, _0x2f3765 = 0x2; _0x557cc6['diaryCurrentPage'] = Math[_0x513675(0xdc)](0x0, Math[_0x513675(0x6d0)](_0x19fd01 / _0x2f3765) - 0x1), document['getElementById'](_0x513675(0x5b5))[_0x513675(0x2d0)] = _0x533eaa[_0x513675(0x293)] + '的日记本', _0x9d5b0f(), _0x4f27ca(_0x513675(0x449), _0x513675(0x4ab)); } function _0x9d5b0f() { const _0x356f16 = _0x27dd8f, _0x4a93b0 = document[_0x356f16(0x5b7)](_0x356f16(0x2c7)), _0x9d77ac = document['getElementById'](_0x356f16(0x543)); _0x4a93b0[_0x356f16(0x7a2)] = '', _0x9d77ac[_0x356f16(0x7a2)] = ''; const _0x407853 = _0x5bbb91() || { 'name': '我' }, _0x437236 = _0x557cc6[_0x356f16(0xa8)][_0x356f16(0x4d1)](_0x50ec58 => _0x50ec58[_0x356f16(0x27b)] === _0x557cc6[_0x356f16(0x29e)]); if (!_0x437236 || !_0x437236[_0x356f16(0x759)] || _0x437236[_0x356f16(0x759)][_0x356f16(0x7a6)] === 0x0) { _0x4a93b0[_0x356f16(0x7a2)] = _0x356f16(0x4eb), _0x9d77ac[_0x356f16(0x7a2)] = _0x356f16(0x26d), document[_0x356f16(0x5b7)](_0x356f16(0x3ec))['addEventListener'](_0x356f16(0x66b), _0x3dbcdd), document['getElementById'](_0x356f16(0x575))[_0x356f16(0x572)]('click', _0x4934f7); return; } const _0x56dcd5 = 0x2, _0x1d6960 = [..._0x437236['entries']][_0x356f16(0x5d1)]((_0x2aec48, _0x485829) => _0x2aec48[_0x356f16(0x798)] - _0x485829[_0x356f16(0x798)]), _0xc3c0b3 = []; for (let _0x151b9f = 0x0; _0x151b9f < _0x1d6960['length']; _0x151b9f += _0x56dcd5) { _0x356f16(0x722) === _0x356f16(0x132) ? _0x4cb42c['textContent'] = _0x48733f[_0x356f16(0x652)](_0x1adfed)[_0x356f16(0x30e)](_0x1b27ab => _0x1b27ab[_0x356f16(0x357)]['textContent']['trim']())['join']('、') : _0xc3c0b3[_0x356f16(0x6b4)](_0x1d6960[_0x356f16(0x186)](_0x151b9f, _0x151b9f + _0x56dcd5)); } const _0x4a1955 = _0xc3c0b3[_0x356f16(0x7a6)]; _0xc3c0b3[_0x356f16(0x302)]((_0x559228, _0x1a324d) => { const _0x30b5a0 = _0x356f16, _0x252207 = document[_0x30b5a0(0x5ba)](_0x30b5a0(0x509)); _0x252207[_0x30b5a0(0x640)] = 'diary-page', _0x252207['id'] = 'diary-page-' + _0x1a324d, _0x1a324d === _0x557cc6['diaryCurrentPage'] && _0x252207[_0x30b5a0(0x35f)]['add'](_0x30b5a0(0x154)), _0x559228[_0x30b5a0(0x302)](_0x24be53 => { const _0x2c6f34 = _0x30b5a0; if (_0x2c6f34(0xe7) === _0x2c6f34(0xe7)) { const _0x525973 = _0x24be53['author'] === 'user' ? 'user' : 'ai', _0x2681a7 = _0x24be53[_0x2c6f34(0x4e9)] === _0x2c6f34(0x472) ? _0x407853[_0x2c6f34(0x293)] : _0x3132c6(_0x24be53[_0x2c6f34(0x4e9)])['name'], _0x57ea41 = document[_0x2c6f34(0x5ba)](_0x2c6f34(0x509)); _0x57ea41['className'] = _0x2c6f34(0x1ab) + _0x525973, _0x57ea41['dataset'][_0x2c6f34(0x798)] = _0x24be53[_0x2c6f34(0x798)], _0x57ea41[_0x2c6f34(0x6ca)][_0x2c6f34(0x51a)] = 'none', _0x57ea41[_0x2c6f34(0x6ca)][_0x2c6f34(0x1fe)] = '0', _0x57ea41['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>' + _0x2681a7 + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-timestamp\x22>' + new Date(_0x24be53['timestamp'])[_0x2c6f34(0x586)](_0x2c6f34(0x6ef)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-content\x22>' + _0x24be53[_0x2c6f34(0x398)][_0x2c6f34(0x4f8)](/\n/g, '<br>') + _0x2c6f34(0x4f4), _0x252207[_0x2c6f34(0x796)](_0x57ea41); } else _0x405c4d(), _0x45cc90(!![]); }), _0x4a93b0[_0x30b5a0(0x796)](_0x252207); }), _0x9d77ac[_0x356f16(0x7a2)] = _0x356f16(0x130) + (_0x557cc6[_0x356f16(0x1f6)] + 0x1) + _0x356f16(0x655) + _0x4a1955 + '\x20页</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-end;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-next-button\x22>下一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', document['getElementById'](_0x356f16(0x828))[_0x356f16(0x6cf)] = _0x557cc6[_0x356f16(0x1f6)] === 0x0, document[_0x356f16(0x5b7)](_0x356f16(0x94))[_0x356f16(0x6cf)] = _0x557cc6[_0x356f16(0x1f6)] === _0x4a1955 - 0x1, document[_0x356f16(0x5b7)](_0x356f16(0x828))[_0x356f16(0x572)](_0x356f16(0x66b), _0x11c4cf), document[_0x356f16(0x5b7)]('diary-next-button')[_0x356f16(0x572)](_0x356f16(0x66b), _0x13ce3b), document[_0x356f16(0x5b7)](_0x356f16(0x3ec))['addEventListener'](_0x356f16(0x66b), _0x3dbcdd), document['getElementById'](_0x356f16(0x575))[_0x356f16(0x572)](_0x356f16(0x66b), _0x4934f7); } function _0x13ce3b() { const _0x3c91ef = _0x27dd8f; if (_0x557cc6['isAnimatingDiary']) return; const _0x4ddb63 = _0x557cc6[_0x3c91ef(0x1f6)], _0x2887e7 = Math[_0x3c91ef(0x6d0)](_0x557cc6[_0x3c91ef(0xa8)][_0x3c91ef(0x4d1)](_0x171208 => _0x171208[_0x3c91ef(0x27b)] === _0x557cc6['activeDiaryCharacterId'])[_0x3c91ef(0x759)][_0x3c91ef(0x7a6)] / 0x2); if (_0x4ddb63 >= _0x2887e7 - 0x1) return; _0x557cc6[_0x3c91ef(0x28c)] = !![]; const _0x203c91 = _0x4ddb63 + 0x1, _0x2f747f = document[_0x3c91ef(0x5b7)](_0x3c91ef(0x746) + _0x4ddb63), _0x5573f9 = document[_0x3c91ef(0x5b7)](_0x3c91ef(0x746) + _0x203c91); _0x2f747f && _0x5573f9 ? (_0x5573f9['classList']['add']('is-entering-from-right'), _0x2f747f[_0x3c91ef(0x35f)]['add'](_0x3c91ef(0x5e5)), _0x5573f9['classList']['add'](_0x3c91ef(0x154)), setTimeout(() => { const _0x2d136d = _0x3c91ef; _0x2d136d(0x560) === _0x2d136d(0x386) ? _0x562041[_0x2d136d(0x6b4)](_0xb01e96['id']) : (_0x2f747f[_0x2d136d(0x35f)]['remove']('is-visible', 'is-exiting-left'), _0x5573f9[_0x2d136d(0x35f)]['remove']('is-entering-from-right'), _0x557cc6[_0x2d136d(0x1f6)] = _0x203c91, _0x9d5b0f(), _0x557cc6[_0x2d136d(0x28c)] = ![]); }, 0x2bc)) : _0x557cc6[_0x3c91ef(0x28c)] = ![]; } function _0x11c4cf() { const _0x52c113 = _0x27dd8f; if (_0x557cc6[_0x52c113(0x28c)]) return; const _0x153de3 = _0x557cc6[_0x52c113(0x1f6)]; if (_0x153de3 <= 0x0) return; _0x557cc6[_0x52c113(0x28c)] = !![]; const _0x289a46 = _0x153de3 - 0x1, _0x463d09 = document['getElementById']('diary-page-' + _0x153de3), _0x44cb6e = document['getElementById'](_0x52c113(0x746) + _0x289a46); _0x463d09 && _0x44cb6e ? (_0x44cb6e[_0x52c113(0x35f)][_0x52c113(0x632)]('is-entering-from-left'), _0x463d09[_0x52c113(0x35f)]['add'](_0x52c113(0x4ee)), _0x44cb6e[_0x52c113(0x35f)]['add'](_0x52c113(0x154)), setTimeout(() => { const _0x537ccf = _0x52c113; _0x463d09['classList'][_0x537ccf(0x7ff)](_0x537ccf(0x154), 'is-exiting-right'), _0x44cb6e['classList'][_0x537ccf(0x7ff)](_0x537ccf(0x436)), _0x557cc6[_0x537ccf(0x1f6)] = _0x289a46, _0x9d5b0f(), _0x557cc6[_0x537ccf(0x28c)] = ![]; }, 0x2bc)) : _0x52c113(0x184) === _0x52c113(0x133) ? _0x251c45 = _0x1d8256['userProfiles']['find'](_0x466006 => _0x466006['id'] === _0x1cca9c[_0x52c113(0x26a)]) : _0x557cc6[_0x52c113(0x28c)] = ![]; } function _0x3dbcdd() { return new Promise(_0x127591 => { const _0x872800 = _0x3d17, _0x499fbb = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-write-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22\x20style=\x22padding:\x2020px;\x20width:\x2090%;\x20max-width:\x20350px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<h3\x20style=\x22margin-top:\x200;\x20text-align:\x20center;\x20font-weight:\x20600;\x22>写下今天的日记</h3>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<textarea\x20id=\x22diary-modal-textarea\x22\x20style=\x22width:\x20100%;\x20min-height:\x20150px;\x20margin:\x2010px\x200;\x22></textarea>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20gap:\x2010px;\x20margin-top:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-save\x22\x20class=\x22choice-modal-button\x22\x20style=\x22background-color:\x20var(--primary-color);\x20color:\x20white;\x22>写好了</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-modal-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; document['body'][_0x872800(0x633)](_0x872800(0x57c), _0x499fbb); const _0x100e0f = document[_0x872800(0x5b7)](_0x872800(0x3af)), _0x4ecb0c = document['getElementById'](_0x872800(0x200)), _0x165ac5 = document['getElementById']('diary-modal-save'), _0x27bdf4 = document[_0x872800(0x5b7)](_0x872800(0x47e)), _0x13776f = _0x100e0f[_0x872800(0x5ab)](_0x872800(0x783)), _0x510115 = () => { const _0x6df3f4 = _0x872800; if ('zwRkk' !== _0x6df3f4(0xe2)) { const _0x447d9a = _0xe3a6e[_0x6df3f4(0x5b7)](_0x6df3f4(0x3d4)); _0x447d9a[_0x6df3f4(0x7a2)] = ''; const _0x4a8e47 = _0x2de208['characters'][_0x6df3f4(0x1d8)](_0x41f6a8 => _0x499593[_0x6df3f4(0x46d)][_0x6df3f4(0x74d)](_0x4e1f15 => _0x4e1f15[_0x6df3f4(0x516)] === _0x6df3f4(0x405) && _0x4e1f15[_0x6df3f4(0x765)]['includes'](_0x41f6a8['id']))); if (_0x4a8e47['length'] === 0x0) { _0x447d9a[_0x6df3f4(0x7a2)] = _0x6df3f4(0x65e); return; } _0x4a8e47[_0x6df3f4(0x302)](_0x2867c8 => { const _0x253ad7 = _0x6df3f4, _0x21a6bb = _0x5d03b4[_0x253ad7(0x5ba)]('li'); _0x21a6bb['className'] = _0x253ad7(0x1b9), _0x21a6bb['dataset'][_0x253ad7(0x2bf)] = _0x2867c8['id'], _0x21a6bb['innerHTML'] = _0x253ad7(0x16f) + (_0x2867c8[_0x253ad7(0x51e)] || _0x2e91bb) + _0x253ad7(0x317) + _0x2867c8[_0x253ad7(0x293)] + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>' + (_0x2867c8[_0x253ad7(0x5aa)] || '私聊') + _0x253ad7(0xa3), _0x21a6bb[_0x253ad7(0x572)](_0x253ad7(0x66b), () => { _0x2ec893(_0x2867c8['id']); }), _0x447d9a[_0x253ad7(0x796)](_0x21a6bb); }); } else _0x100e0f[_0x6df3f4(0x7ff)](), _0x127591(); }; _0x165ac5[_0x872800(0x7bc)] = () => { const _0x425e5f = _0x872800; _0xb13614(_0x4ecb0c[_0x425e5f(0x73f)]), _0x510115(); }, _0x27bdf4[_0x872800(0x7bc)] = _0x510115, _0x13776f['onclick'] = _0x510115; }); } function _0xb13614(_0x1f1ba7) { const _0x2addd2 = _0x27dd8f, _0x1f7180 = _0x1f1ba7[_0x2addd2(0xf2)](); if (!_0x1f7180 || !_0x557cc6['activeDiaryCharacterId']) return; let _0x4f1fc4 = _0x557cc6[_0x2addd2(0xa8)][_0x2addd2(0x4d1)](_0x29f71c => _0x29f71c['characterId'] === _0x557cc6[_0x2addd2(0x29e)]); !_0x4f1fc4 && (_0x4f1fc4 = { 'characterId': _0x557cc6[_0x2addd2(0x29e)], 'entries': [] }, _0x557cc6[_0x2addd2(0xa8)][_0x2addd2(0x6b4)](_0x4f1fc4)); _0x4f1fc4[_0x2addd2(0x759)][_0x2addd2(0x6b4)]({ 'timestamp': Date[_0x2addd2(0x183)](), 'author': _0x2addd2(0x472), 'content': _0x1f7180 }), _0x162000(); const _0x4a5cff = _0x4f1fc4[_0x2addd2(0x759)][_0x2addd2(0x7a6)]; _0x557cc6[_0x2addd2(0x1f6)] = Math['ceil'](_0x4a5cff / 0x2) - 0x1, _0x9d5b0f(); } async function _0x4934f7() { const _0x33d337 = _0x27dd8f, _0x4f07c8 = _0x557cc6[_0x33d337(0xa8)][_0x33d337(0x4d1)](_0x49d24a => _0x49d24a[_0x33d337(0x27b)] === _0x557cc6[_0x33d337(0x29e)]), _0x158d4f = _0x557cc6[_0x33d337(0x29e)], _0x3e246d = _0x3132c6(_0x158d4f); if (!_0x3e246d || _0x557cc6['isGenerating']) return; _0x2158b6(!![], _0x33d337(0x4f7)), _0x557cc6['isGenerating'] = !![]; let _0x39274d = []; try { if (_0x33d337(0x613) === 'acKSG') { const _0x53e1ed = _0x5bbb91() || { 'name': '你' }, _0x29481e = _0x129229(_0x158d4f), { omniText: _0x62a91a } = _0x576fb7(_0x158d4f, _0x557cc6['activeChatId']); let _0x5809fb = ''; if (_0x3e246d['linkedWorldBookIds'] && _0x3e246d[_0x33d337(0x674)]['length'] > 0x0) { if ('lTUrB' === _0x33d337(0x508)) _0x11a781 += _0x33d337(0x565); else { const _0x341f9b = _0x3e246d[_0x33d337(0x674)][_0x33d337(0x30e)](_0x2d7904 => _0x557cc6[_0x33d337(0x694)][_0x33d337(0x4d1)](_0x8faef6 => _0x8faef6['id'] === _0x2d7904))[_0x33d337(0x1d8)](Boolean)[_0x33d337(0x30e)](_0x1cad57 => _0x33d337(0x826) + _0x1cad57[_0x33d337(0x293)] + '\x0a' + _0x1cad57[_0x33d337(0x398)])[_0x33d337(0x566)](''); if (_0x341f9b) _0x5809fb = _0x33d337(0x49b) + _0x341f9b; } } const _0x354184 = _0x53e1ed['persona'] ? _0x33d337(0x125) + _0x53e1ed[_0x33d337(0x293)] + _0x33d337(0x52b) + _0x53e1ed[_0x33d337(0x6f2)] : '', _0x409473 = _0x1ad6ce(); let _0xb0fe71 = _0x33d337(0x5fb); if (_0x4f07c8 && _0x4f07c8['entries']) { const _0x3abc87 = _0x4f07c8[_0x33d337(0x759)][_0x33d337(0x1d8)](_0x28d5fb => _0x28d5fb[_0x33d337(0x4e9)] === _0x33d337(0x472))[_0x33d337(0x121)](); _0x3abc87 && (_0xb0fe71 = _0x3abc87['content']); } const _0x51d2e0 = _0x33d337(0xbe) + _0x3e246d[_0x33d337(0x293)] + _0x33d337(0x1f4) + _0x53e1ed[_0x33d337(0x293)] + '。你的日记是写给Ta看的。\x0a\x0a#\x20写作【最高指令】\x0a1.\x20\x20**【首要任务：回应读者】**\x20你的第一要务是**回应**读者（' + _0x53e1ed['name'] + _0x33d337(0x710) + _0xb0fe71 + _0x33d337(0x349) + _0x3e246d[_0x33d337(0x6f2)] + '\x0a' + _0x354184 + '\x0a' + _0x5809fb + '\x0a\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a-\x20**当前精确时间**:\x20' + new Date()['toLocaleString'](_0x33d337(0x6ef), { 'dateStyle': 'full', 'timeStyle': 'short' }) + '\x0a-\x20**日记本的上一笔记录是在**:\x20' + _0x411f32(new Date(_0x4f07c8?.[_0x33d337(0x759)]?.['at'](-0x1)?.[_0x33d337(0x798)] || Date[_0x33d337(0x183)]())) + '\x0a\x0a#\x20记忆库\x20(仅供参考)\x0a---\x0a##\x20最近的互动回顾\x20(来自聊天、见面和动态)\x0a' + (_0x62a91a || _0x33d337(0x409)) + '\x0a---\x0a##\x20最近的朋友圈动态\x0a' + (_0x409473 || _0x33d337(0x366)) + _0x33d337(0xbc); _0x39274d = [{ 'role': _0x33d337(0x14b), 'content': _0x51d2e0 }, { 'role': 'user', 'content': '好了，请基于以上所有信息，开始写今天的日记吧。' }]; const _0x4cd567 = await _0x2d20cc(_0x39274d); if (_0x4cd567) { let _0x4cf669 = _0x557cc6[_0x33d337(0xa8)]['find'](_0x438fde => _0x438fde[_0x33d337(0x27b)] === _0x158d4f); !_0x4cf669 && ('zdPNJ' !== _0x33d337(0x3f6) ? (_0x4cf669 = { 'characterId': _0x158d4f, 'entries': [] }, _0x557cc6[_0x33d337(0xa8)][_0x33d337(0x6b4)](_0x4cf669)) : _0x1102d8[_0x33d337(0x6b4)]('[' + _0x1386cf(_0x2fb4b4) + ']\x20' + _0x3bf34e[_0x33d337(0x398)])); _0x4cf669[_0x33d337(0x759)][_0x33d337(0x6b4)]({ 'timestamp': Date['now'](), 'author': _0x158d4f, 'content': _0x4cd567 }), _0x162000(); const _0x5b0d74 = _0x4cf669[_0x33d337(0x759)][_0x33d337(0x7a6)]; _0x557cc6['diaryCurrentPage'] = Math[_0x33d337(0x6d0)](_0x5b0d74 / 0x2) - 0x1, _0x9d5b0f(); } } else { const _0x5c3ec2 = _0x25e22e[_0x33d337(0x5b7)](_0x33d337(0x4c5)), _0x5d860e = _0x23d987[_0x33d337(0x5b7)](_0x33d337(0x1ca)), _0x5dd70f = _0x22de85['getElementById'](_0x33d337(0x506)), _0x3c01f5 = _0x1c6936[_0x33d337(0x5b7)]('widget-cover-art'), _0x30f54f = _0x1025c6; _0x30f54f && _0x30f54f[_0x33d337(0x819)] ? (_0x5d860e[_0x33d337(0x2d0)] = _0x30f54f[_0x33d337(0x1ec)], _0x5dd70f['textContent'] = _0x30f54f['artist'], _0x5c3ec2['classList'][_0x33d337(0x632)](_0x33d337(0x680)), _0x5c3ec2['style'][_0x33d337(0x6a0)]('--widget-cover-image', 'url(' + _0x30f54f[_0x33d337(0x791)] + ')')) : (_0x5d860e[_0x33d337(0x2d0)] = _0x33d337(0x776), _0x5dd70f[_0x33d337(0x2d0)] = _0x33d337(0x833), _0x5c3ec2[_0x33d337(0x35f)][_0x33d337(0x7ff)](_0x33d337(0x680)), _0x3c01f5['style'][_0x33d337(0x6a0)](_0x33d337(0x79c), _0x33d337(0x4e3))); } } catch (_0x1e0ecc) { _0x599dea(_0x33d337(0x213) + _0x1e0ecc[_0x33d337(0x832)]); } finally { _0x2158b6(![]), _0x557cc6[_0x33d337(0x161)] = ![]; } } function _0x5164c1() { const _0x4c10f2 = _0x27dd8f; if (_0x4c10f2(0x52c) !== _0x4c10f2(0x52c)) { const _0x59e52b = _0x9ddaa4[_0x4c10f2(0x5ab)]('.screen.active'); if (!_0x59e52b) return; _0x59e52b['id'] === _0x4c10f2(0x704) ? _0x2f51fe() : _0x41e6ed(); } else { const _0x4861e0 = document[_0x4c10f2(0x5b7)](_0x4c10f2(0x50c)), _0x2007d5 = document[_0x4c10f2(0x5b7)](_0x4c10f2(0x816)), _0x542fa4 = document[_0x4c10f2(0x5ab)](_0x4c10f2(0x64f)); _0x557cc6[_0x4c10f2(0x97)] === _0x4c10f2(0x1f1) ? (_0x4861e0['style'][_0x4c10f2(0x836)] = _0x4c10f2(0x4e3), _0x2007d5[_0x4c10f2(0x6ca)]['display'] = 'block') : (_0x4861e0[_0x4c10f2(0x6ca)][_0x4c10f2(0x836)] = 'block', _0x2007d5['style']['display'] = _0x4c10f2(0x4e3)), _0x542fa4['style'][_0x4c10f2(0x836)] = 'block'; } } function _0x5b9288() { const _0x445730 = _0x27dd8f, _0x11b06b = document['getElementById'](_0x445730(0xf6)), _0x51d6b6 = document['getElementById'](_0x445730(0x4fb)); if (_0x557cc6[_0x445730(0x13d)][_0x445730(0x7a6)] > 0x0) { if (_0x445730(0x338) !== 'SlEjo') { const _0x52b89f = _0x557cc6[_0x445730(0x13d)][_0x445730(0x43e)](); _0x11b06b[_0x445730(0x2d0)] = _0x52b89f[_0x445730(0x234)] === _0x445730(0x24c) ? '旁白' : _0x52b89f['speaker'], _0x51d6b6[_0x445730(0x2d0)] = _0x52b89f[_0x445730(0x805)], _0x52b89f[_0x445730(0x234)] !== _0x445730(0x24c) && _0x45147f(_0x557cc6[_0x445730(0x243)], _0x52b89f['emotion']); } else _0x58168a['worldBooks'] = _0x365335[_0x445730(0x694)][_0x445730(0x1d8)](_0x5387b0 => _0x5387b0['id'] !== _0x34ab73), _0x4cb5c5[_0x445730(0x618)]['forEach'](_0x4466d4 => { const _0x194eb1 = _0x445730; _0x4466d4['linkedWorldBookIds'] && (_0x4466d4['linkedWorldBookIds'] = _0x4466d4[_0x194eb1(0x674)]['filter'](_0x313c43 => _0x313c43 !== _0xb2866b)); }), _0x43cfb6(), _0x49aef3(_0x445730(0x182)), _0xbc337b(), _0x5b4718(_0x445730(0x2ce), _0x445730(0x403)); } else { const _0x2d48f9 = _0x557cc6[_0x445730(0x249)][_0x557cc6[_0x445730(0x243)]]; if (_0x2d48f9 && _0x2d48f9['length'] > 0x0) { _0x557cc6[_0x445730(0x13d)] = [..._0x2d48f9]; const _0x2fe119 = _0x557cc6[_0x445730(0x13d)][_0x445730(0x43e)](); _0x11b06b['textContent'] = _0x2fe119[_0x445730(0x234)] === _0x445730(0x24c) ? '旁白' : _0x2fe119['speaker'], _0x51d6b6['textContent'] = _0x2fe119[_0x445730(0x805)]; if (_0x2fe119[_0x445730(0x234)] !== _0x445730(0x24c)) { if (_0x445730(0x6bc) !== _0x445730(0x2ad)) _0x45147f(_0x557cc6[_0x445730(0x243)], _0x2fe119[_0x445730(0x49d)]); else { const _0x5bd37a = _0x357a6c[_0x445730(0x5ba)](_0x445730(0x509)); _0x5bd37a[_0x445730(0x640)] = _0x445730(0x2d6), _0x5bd37a['innerHTML'] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22pending-post-image-preview\x22\x20src=\x22\x22\x20alt=\x22图片预览加载中...\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x5bd37a[_0x445730(0x5ab)](_0x445730(0x298))[_0x445730(0x7bc)] = () => _0x3f0c35(_0x445730(0x690)), _0x1f5bca[_0x445730(0x796)](_0x5bd37a), _0x221cb6(_0x330334)[_0x445730(0x192)](_0x341564 => { const _0x3a4cf6 = _0x445730, _0x2c3aad = _0x411ab9[_0x3a4cf6(0x5b7)](_0x3a4cf6(0x7ac)); _0x2c3aad && _0x341564 && (_0x2c3aad[_0x3a4cf6(0x483)] = _0x4f3e42[_0x3a4cf6(0x371)](_0x341564)); }); } } } else _0x11b06b[_0x445730(0x2d0)] = '旁白', _0x51d6b6[_0x445730(0x2d0)] = _0x445730(0x6d6); } } async function _0x45147f(_0x163b9c, _0x2a0bb3) { const _0x54f028 = _0x27dd8f, _0x40e23b = document['getElementById'](_0x54f028(0x846)), _0x491d0e = ['normal', _0x54f028(0x703), _0x54f028(0xb5), _0x54f028(0x280), _0x54f028(0x495)], _0x4363c5 = _0x491d0e[_0x54f028(0x158)](_0x2a0bb3) ? _0x2a0bb3 : 'normal'; try { const _0x539a38 = await _0x2aeef5('char_sprite_' + _0x4363c5 + '_' + _0x163b9c); if (_0x539a38) _0x54f028(0x18c) !== _0x54f028(0x18c) ? _0x4a53f8(_0x54f028(0x442)) : (_0x40e23b[_0x54f028(0x6ca)]['opacity'] = 0x0, setTimeout(() => { const _0x1eb6bf = _0x54f028; _0x1eb6bf(0x502) !== 'nnheQ' ? (_0x40e23b[_0x1eb6bf(0x483)] = URL['createObjectURL'](_0x539a38), _0x40e23b[_0x1eb6bf(0x6ca)]['opacity'] = 0x1) : (_0x4bc9fb(![]), _0x3c63af['error']('解析音乐文件失败:', _0x43589f), _0x193cb7(_0x1eb6bf(0x33b) + _0x19bfb1[_0x1eb6bf(0x832)])); }, 0x12c)); else { if (_0x54f028(0x39a) === _0x54f028(0x39a)) { const _0xeb66b5 = await _0x2aeef5(_0x54f028(0x4c4) + _0x163b9c); if (_0xeb66b5) _0x54f028(0x75) !== _0x54f028(0x75) ? _0xf418b9() : _0x40e23b[_0x54f028(0x483)] = URL['createObjectURL'](_0xeb66b5); else { if (_0x54f028(0x3b7) !== _0x54f028(0x3b7)) { const _0x131d62 = _0x141604[_0x325152]; _0x130923(_0x131d62); } else _0x40e23b['src'] = ''; } } else return ''; } } catch (_0x5f2de2) { console[_0x54f028(0x50e)]('加载立绘失败:', _0x5f2de2), _0x40e23b[_0x54f028(0x483)] = ''; } } function _0x4fdbfa(_0x2e680e) { const _0xe21c40 = _0x27dd8f; if (_0xe21c40(0x511) !== 'BvMKc') { const _0x458b7b = _0x3132c6(_0x2e680e); if (!_0x458b7b) return; const _0x30978c = _0x557cc6['chats']['find'](_0xb82a41 => _0xb82a41[_0xe21c40(0x516)] === _0xe21c40(0x405) && _0xb82a41[_0xe21c40(0x765)][_0xe21c40(0x158)](_0x2e680e)), _0x37add3 = _0x40920c(_0x30978c['id']), _0x1b783f = _0x557cc6[_0xe21c40(0x5b8)][_0xe21c40(0x1d8)](_0x58c170 => _0x58c170['isOffline'])['pop'](), _0x208a10 = document[_0xe21c40(0x5b7)](_0xe21c40(0xf6)), _0xa17e0f = document[_0xe21c40(0x5b7)]('galgame-text'); let _0x52edaa = null; if (_0x1b783f) { if (_0xe21c40(0x43f) === _0xe21c40(0x701)) { if (_0x48a732[_0xe21c40(0x7b4)] === _0xe21c40(0x472)) return _0x58cb2d[_0xe21c40(0x204)]?.[_0xe21c40(0x293)] || _0xe21c40(0x259); if (_0x3761d7['senderId']) { const _0x1c519e = _0x20c04a(_0x39b4da[_0xe21c40(0x6fa)]); return _0x1c519e?.[_0xe21c40(0x293)] || _0xe21c40(0x6d8); } if (_0x4015a2?.[_0xe21c40(0x516)] === 'private') { const _0x509bdc = _0x55bddf(_0x4895d5[_0xe21c40(0x765)][0x0]); return _0x509bdc?.[_0xe21c40(0x293)] || 'AI'; } return _0xe21c40(0x128); } else { if (_0x1b783f[_0xe21c40(0x7b4)] === _0xe21c40(0x77b)) { if ('CWAGy' !== 'CWAGy') _0x1b34e3['push']('[' + _0x10bfe6 + _0xe21c40(0x1d5) + _0x578d44(_0x548217) + ']\x20' + _0x2ef1d3(_0x4ea66b[_0xe21c40(0x398)])['trim']()); else { const _0x29d8b1 = _0x557cc6[_0xe21c40(0x249)][_0x2e680e]; _0x29d8b1 && _0x29d8b1['length'] > 0x0 && (_0x52edaa = _0x29d8b1['at'](-0x1)); } } else _0x52edaa = { 'speaker': _0x37add3[_0xe21c40(0x293)], 'line': _0x1b783f[_0xe21c40(0x398)], 'emotion': _0xe21c40(0x343) }; } } if (_0x52edaa) { if (_0xe21c40(0x268) !== _0xe21c40(0xff)) { _0x208a10[_0xe21c40(0x2d0)] = _0x52edaa['speaker'] === _0xe21c40(0x24c) ? '旁白' : _0x52edaa[_0xe21c40(0x234)], _0xa17e0f['textContent'] = _0x52edaa['line']; if (_0x52edaa['speaker'] === _0x458b7b[_0xe21c40(0x293)]) { if (_0xe21c40(0x53d) === _0xe21c40(0x454)) { const _0x2abe50 = _0x444af0[_0xe21c40(0x5b7)](_0xe21c40(0x1fb)); _0x2abe50[_0xe21c40(0x7a2)] = ''; if (_0x4faf2b[_0xe21c40(0x78e)][_0xe21c40(0x7a6)] === 0x0) { _0x2abe50[_0xe21c40(0x7a2)] = _0xe21c40(0x376); return; } _0x4a6751[_0xe21c40(0x78e)][_0xe21c40(0x302)](_0x53e67e => { const _0x4aecaf = _0xe21c40, _0x2223f3 = _0xa3d5bf['userProfiles'][_0x4aecaf(0x4d1)](_0x130344 => _0x130344['id'] === _0x53e67e[_0x4aecaf(0x2a6)]) || { 'name': _0x4aecaf(0x800) }, _0x447296 = _0x58b61c[_0x4aecaf(0x5ba)](_0x4aecaf(0x509)); _0x447296['className'] = 'world-book-item', _0x447296['dataset']['id'] = _0x53e67e['id'], _0x447296[_0x4aecaf(0x7a2)] = _0x4aecaf(0x790) + _0x53e67e[_0x4aecaf(0x293)] + _0x4aecaf(0x714) + _0x2223f3[_0x4aecaf(0x293)] + _0x4aecaf(0x76a) + _0x53e67e[_0x4aecaf(0x14c)][_0x4aecaf(0x7a6)] + _0x4aecaf(0x413), _0x447296[_0x4aecaf(0x572)]('click', () => _0x2383b3(_0x53e67e['id'])), _0x2abe50[_0x4aecaf(0x796)](_0x447296); }); } else _0x45147f(_0x2e680e, _0x52edaa[_0xe21c40(0x49d)]); } else _0x45147f(_0x2e680e, _0xe21c40(0x343)); } else { const _0x4f35b7 = _0x1aea9f[_0xe21c40(0x5b8)][_0xe21c40(0x28f)](_0x214b22); _0x4f35b7 > -0x1 && _0x1073c1(_0x2748fc, _0x4f35b7); } } else _0x208a10[_0xe21c40(0x2d0)] = _0x458b7b[_0xe21c40(0x293)], _0xa17e0f[_0xe21c40(0x2d0)] = _0xe21c40(0x4f9), _0x45147f(_0x2e680e, _0xe21c40(0x343)); } else _0x4ca62b(), _0x56d8b8(_0xe21c40(0x476)); } function _0x4da3b9() { const _0x468ca8 = _0x27dd8f; if (_0x468ca8(0x719) === _0x468ca8(0x719)) { const _0x23e1ca = new Date(), _0x6ce3cf = document[_0x468ca8(0x5b7)](_0x468ca8(0x7a3)), _0x48aa96 = document[_0x468ca8(0x5b7)](_0x468ca8(0x4ad)); if (_0x6ce3cf && _0x48aa96) { const _0x9dce87 = String(_0x23e1ca['getHours']())[_0x468ca8(0x1db)](0x2, '0'), _0x5acc01 = String(_0x23e1ca[_0x468ca8(0x762)]())[_0x468ca8(0x1db)](0x2, '0'); _0x6ce3cf[_0x468ca8(0x2d0)] = _0x9dce87 + ':' + _0x5acc01; const _0x4071c8 = _0x23e1ca[_0x468ca8(0x2aa)]() + 0x1, _0x5078bc = _0x23e1ca[_0x468ca8(0x65f)](), _0x711ff9 = [_0x468ca8(0x408), _0x468ca8(0xda), '星期二', _0x468ca8(0x377), _0x468ca8(0x588), _0x468ca8(0x748), _0x468ca8(0x7eb)][_0x23e1ca[_0x468ca8(0x5cc)]()]; _0x48aa96[_0x468ca8(0x2d0)] = _0x4071c8 + '月' + _0x5078bc + '日\x20' + _0x711ff9; } } else { const _0x507258 = _0xd02ab4[_0x468ca8(0x5ba)]('li'); _0x507258['className'] = _0x468ca8(0x5d5), _0x507258[_0x468ca8(0x7a2)] = _0x468ca8(0x3d8) + _0xdaae5b['id'] + _0x468ca8(0x465) + _0x1d222e['id'] + _0x468ca8(0x6f9) + (_0x4eafb8['avatar'] || _0x6a0336) + _0x468ca8(0x61f) + _0x11afc2['id'] + _0x468ca8(0x63b) + _0x101332['name'] + _0x468ca8(0x7ef), _0x55d80e[_0x468ca8(0x796)](_0x507258); } } const _0x392d71 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x1a2)), _0x8d03a2 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x676)), _0x236d74 = document['getElementById']('cancel-listen-together'), _0x2d0dc5 = document['getElementById'](_0x27dd8f(0x4c9)), _0x51ad5c = document[_0x27dd8f(0x5b7)]('listen-together-song-list'), _0x4baa54 = document[_0x27dd8f(0x5b7)]('unified-audio-player'), _0x428a23 = document[_0x27dd8f(0x5b7)]('listen-together-ui'), _0x3857fc = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x3d0)), _0x3a54e8 = document['getElementById'](_0x27dd8f(0x564)); let _0x1286af = []; async function _0x380475() { const _0x48a803 = _0x27dd8f; if (!_0x557cc6[_0x48a803(0x589)]) return; _0x51ad5c[_0x48a803(0x7a2)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>正在清点圣殿藏品...</p>', _0x392d71[_0x48a803(0x35f)]['add'](_0x48a803(0x1c6)); const _0x45bc42 = await _0x5664db(); if (_0x45bc42[_0x48a803(0x7a6)] === 0x0) { if (_0x48a803(0x275) !== 'OdIYq') { const _0x1f3a6c = _0x17e06d[_0x48a803(0x426)](_0x48a803(0x1f9)); if (_0x1f3a6c) { const { playlist: _0x12a367, currentIndex: _0x1fd0b1 } = _0x4c7825[_0x48a803(0x417)](_0x1f3a6c); _0x320893['isArray'](_0x12a367) && _0x12a367[_0x48a803(0x7a6)] > 0x0 && _0x1fd0b1 > -0x1 && (_0x1f4d19[_0x48a803(0x5d2)] = _0x12a367, _0x5aee72[_0x48a803(0x2ff)] = _0x1fd0b1, _0x3444e9[_0x48a803(0x533)] = ![], _0x53b34e()); } } else { _0x51ad5c['innerHTML'] = _0x48a803(0xd2); return; } } _0x51ad5c[_0x48a803(0x7a2)] = '', _0x45bc42[_0x48a803(0x302)](_0x3a50eb => { const _0x337f3a = _0x48a803, _0x288ddc = document[_0x337f3a(0x5ba)]('div'); _0x288ddc[_0x337f3a(0x640)] = 'music-library-item'; const _0x2772c2 = _0x3a50eb['cover'] ? URL['createObjectURL'](_0x3a50eb['cover']) : _0x1732e7; _0x288ddc[_0x337f3a(0x7a2)] = _0x337f3a(0x16c) + _0x2772c2 + _0x337f3a(0x5c8) + (_0x3a50eb['info'][_0x337f3a(0x561)] || _0x337f3a(0x5f8)) + _0x337f3a(0x1bc) + (_0x3a50eb[_0x337f3a(0x96)]['歌手'] || _0x337f3a(0x4a6)) + _0x337f3a(0x79a), _0x288ddc[_0x337f3a(0x572)](_0x337f3a(0x66b), () => { _0x57e7ae(_0x3a50eb); }), _0x51ad5c['appendChild'](_0x288ddc); }); } function _0x342bf4() { const _0x507b5b = _0x27dd8f; _0x392d71[_0x507b5b(0x35f)]['remove'](_0x507b5b(0x1c6)); } async function _0x57e7ae(_0x360944) { const _0x26500d = _0x27dd8f; if (!_0x557cc6['activeChatId'] || !_0x360944) return; let _0x112b86 = null; if (_0x360944[_0x26500d(0x791)]) try { _0x112b86 = 'music_cover_' + Date[_0x26500d(0x183)]() + '_' + Math['random'](), await _0x3aff46(_0x112b86, _0x360944[_0x26500d(0x791)]); } catch (_0xc4f47e) { console[_0x26500d(0x50e)]('在“一起听”邀请中，净化封面失败:', _0xc4f47e); } const _0x170460 = { 'role': _0x26500d(0x472), 'type': _0x26500d(0x2db), 'content': '[用户发起了听歌邀请:\x20' + _0x360944['info'][_0x26500d(0x561)] + ']', 'songId': _0x360944['id'], 'songName': _0x360944['info'][_0x26500d(0x561)], 'artist': _0x360944[_0x26500d(0x96)]['歌手'], 'coverId': _0x112b86, 'timestamp': Date['now']() }; _0x557cc6[_0x26500d(0x5b8)][_0x26500d(0x6b4)](_0x170460), _0x2efa53(), _0x2292d9(), _0x342bf4(), setTimeout(_0x5debb2, 0x64); } _0x8d03a2[_0x27dd8f(0x572)](_0x27dd8f(0x66b), _0x380475), _0x236d74[_0x27dd8f(0x572)]('click', _0x342bf4), _0x2d0dc5[_0x27dd8f(0x572)]('click', _0x342bf4); async function _0x18b8be(_0x28c2ff, _0x52a7e9, _0xcfada) { const _0x368f1e = _0x27dd8f, _0x1900fc = _0x557cc6['chats'][_0x368f1e(0x4d1)](_0x59cbd9 => _0x59cbd9[_0x368f1e(0x71d)] && _0x59cbd9[_0x368f1e(0x71d)][_0x368f1e(0x5bc)]), _0x1a714e = _0x5db7d2(); if (_0x1900fc && _0x1900fc['id'] !== _0x1a714e['id']) { if (_0x368f1e(0x4b0) === _0x368f1e(0x4dd)) { const _0x41178a = _0x3b811f[_0x368f1e(0x5b7)](_0x5136fd); if (_0x41178a && _0x1589fa) _0x41178a['src'] = _0x4af49a[_0x368f1e(0x371)](_0x82126b); } else _0x1900fc[_0x368f1e(0x71d)] = null, _0x599dea('已自动断开与其他人的听歌同步。'), _0x162000(); } else _0x1900fc && _0x1900fc['id'] === _0x1a714e['id'] && _0x599dea(_0x368f1e(0x1b6)); _0x2158b6(!![], _0x368f1e(0x326)); if (!_0x1a714e) { _0x2158b6(![]), _0x599dea(_0x368f1e(0x45d)); return; } const _0x1912db = await _0x352c43(_0x28c2ff); if (!_0x1912db) { _0x2158b6(![]), _0x599dea(_0x368f1e(0x7f0)); return; } _0x1a714e[_0x368f1e(0x71d)] = { 'isActive': !![], 'songId': _0x28c2ff, 'leaderId': 'user', 'songName': _0x1912db[_0x368f1e(0x96)][_0x368f1e(0x561)], 'artist': _0x1912db[_0x368f1e(0x96)]['歌手'], 'cover': _0x1912db[_0x368f1e(0x791)] }, _0x162000(), document['getElementById'](_0x368f1e(0x135))[_0x368f1e(0x483)] = _0x1912db[_0x368f1e(0x791)] ? URL['createObjectURL'](_0x1912db[_0x368f1e(0x791)]) : _0x1732e7, document['getElementById'](_0x368f1e(0x5ef))['textContent'] = _0x1912db[_0x368f1e(0x96)]['歌曲名称'], document[_0x368f1e(0x5b7)](_0x368f1e(0x7d6))[_0x368f1e(0x2d0)] = _0x1912db[_0x368f1e(0x96)]['歌手'], _0x14fa10(_0x1912db), _0x428a23[_0x368f1e(0x6ca)][_0x368f1e(0x836)] = _0x368f1e(0x177), setTimeout(() => _0x428a23[_0x368f1e(0x35f)][_0x368f1e(0x632)](_0x368f1e(0x1c6)), 0xa), _0xcfada[_0x368f1e(0x7a2)] = _0x368f1e(0x5e6) + _0xcfada[_0x368f1e(0x5ab)](_0x368f1e(0x85))[_0x368f1e(0x6a2)]; if (_0x557cc6[_0x368f1e(0x5b8)][_0x52a7e9]) { if (_0x368f1e(0x52e) === _0x368f1e(0x56c)) { const { omniText: _0x5adfe2 } = _0x398e46(_0x10790c['id'], null), _0x25e766 = _0x5d7509(_0x177f30['id']), _0x1c6b8b = _0x4e9975['linkedWorldBookIds'] && _0x19ccd4[_0x368f1e(0x674)][_0x368f1e(0x7a6)] > 0x0 ? '\x0a\x0a#\x20' + _0x2396a8['name'] + '的个人专属世界观设定\x0a' + _0x2da754['linkedWorldBookIds'][_0x368f1e(0x30e)](_0x2753ee => _0x138122[_0x368f1e(0x694)][_0x368f1e(0x4d1)](_0x31052f => _0x31052f['id'] === _0x2753ee))[_0x368f1e(0x1d8)](_0x5f4b6e)[_0x368f1e(0x30e)](_0x165779 => _0x368f1e(0x141) + _0x165779['name'] + '\x0a' + _0x165779[_0x368f1e(0x398)])['join']('') : ''; return '-\x20姓名:\x20' + _0x3a07ac[_0x368f1e(0x293)] + _0x368f1e(0x4a0) + _0x35500a['id'] + _0x368f1e(0x6d1) + _0x33867b[_0x368f1e(0x6f2)] + _0x368f1e(0x6c3) + _0x5adfe2 + '\x0a' + _0x25e766 + '\x0a' + _0x1c6b8b; } else _0x557cc6[_0x368f1e(0x5b8)][_0x52a7e9][_0x368f1e(0x5f6)] = !![], _0x2efa53(); } _0x2158b6(![]), _0x3ecda3(_0x28c2ff, [_0x28c2ff]), _0x2d5ebb(_0x1912db, !![]); } function _0x3565bc() { const _0x321add = _0x27dd8f, _0x210a60 = _0x557cc6[_0x321add(0x46d)][_0x321add(0x4d1)](_0x127ef8 => _0x127ef8[_0x321add(0x71d)] && _0x127ef8[_0x321add(0x71d)][_0x321add(0x5bc)]); _0x210a60 && (_0x210a60[_0x321add(0x71d)] = null, _0x162000(), _0x599dea(_0x321add(0x493)), _0x2d5ebb(), _0x428a23[_0x321add(0x35f)][_0x321add(0x7ff)](_0x321add(0x1c6)), setTimeout(() => _0x428a23[_0x321add(0x6ca)][_0x321add(0x836)] = 'none', 0x12c)); } function _0x106044(_0x4abc8c) { const _0x43501f = _0x27dd8f; if (!_0x4abc8c) return []; const _0x22c161 = _0x4abc8c[_0x43501f(0x1d2)]('\x0a'), _0x20fd86 = [], _0x2a9a49 = /\[(\d{2}):(\d{2})\.(\d{2,3})\]/; for (const _0x1e76fe of _0x22c161) { if (_0x43501f(0x12d) !== _0x43501f(0x582)) { const _0x5e6f85 = _0x1e76fe[_0x43501f(0x3ee)](_0x2a9a49); if (_0x5e6f85) { const _0x2a1393 = parseInt(_0x5e6f85[0x1], 0xa), _0x21055d = parseInt(_0x5e6f85[0x2], 0xa), _0x25b5df = parseInt(_0x5e6f85[0x3], 0xa) * (_0x5e6f85[0x3]['length'] === 0x2 ? 0xa : 0x1), _0x44efc6 = _0x2a1393 * 0x3c + _0x21055d + _0x25b5df / 0x3e8, _0x6eb1a3 = _0x1e76fe[_0x43501f(0x4f8)](_0x2a9a49, '')[_0x43501f(0xf2)](); _0x6eb1a3 && (_0x43501f(0x545) === _0x43501f(0x545) ? _0x20fd86[_0x43501f(0x6b4)]({ 'time': _0x44efc6, 'text': _0x6eb1a3 }) : _0x4b0ce6['disabled'] = ![]); } } else try { const _0x501665 = _0x1bbe40[_0x43501f(0x417)](_0x19e5a3); _0x27ef04[_0x43501f(0x65c)](_0x501665) && (_0x43b1d2[_0x43501f(0x73f)] = _0x501665['map'](_0x2c7178 => _0x2c7178[_0x43501f(0x293)] + '--' + _0x2c7178['url'])[_0x43501f(0x566)]('\x0a')); } catch (_0x3bde7b) { } } return _0x20fd86; } function _0x14fa10(_0xd62acd) { const _0x472824 = _0x27dd8f; if ('YTHrJ' !== _0x472824(0x6bd)) { const _0x1b2d3a = _0x2fa272[_0x472824(0x46d)][_0x472824(0x4d1)](_0x2e7e94 => _0x2e7e94['id'] === _0x1ce20a); if (!_0x1b2d3a || _0x1b2d3a[_0x472824(0x516)] !== _0x472824(0x3fd)) return; _0x3a25e4[_0x472824(0x5b7)](_0x472824(0x5d6))[_0x472824(0x73f)] = _0x1b2d3a['name'] || '', _0x338a06('group-settings-bind-user'), _0x1ebe34[_0x472824(0x5b7)](_0x472824(0x67a))['value'] = _0x1b2d3a[_0x472824(0x2a6)] || _0xd8e7bd[_0x472824(0x26a)]; const _0x5b18ca = _0x198903[_0x472824(0x5b7)](_0x472824(0x45b)); _0x5b18ca[_0x472824(0x7a2)] = '', _0x1501ab['worldBooks'][_0x472824(0x302)](_0x233a24 => { const _0x4f7ee3 = _0x472824, _0x34f987 = _0x1b2d3a[_0x4f7ee3(0x674)]?.[_0x4f7ee3(0x158)](_0x233a24['id']), _0x952806 = _0x471f2c[_0x4f7ee3(0x5ba)](_0x4f7ee3(0x28b)); _0x952806['innerHTML'] = _0x4f7ee3(0x71a) + _0x233a24['id'] + '\x22\x20' + (_0x34f987 ? _0x4f7ee3(0x1c8) : '') + '>\x20' + _0x233a24[_0x4f7ee3(0x293)], _0x5b18ca[_0x4f7ee3(0x796)](_0x952806); }), _0x1c9fe4(); const _0x550f2b = _0xf38ae3[_0x472824(0x5b7)](_0x472824(0x2f6)), _0x266553 = _0x3fb895[_0x472824(0x5b7)](_0x472824(0x46a)); _0x29a90d(_0x472824(0x23a) + _0x48fa8f)['then'](_0x456fef => { _0x550f2b['src'] = _0x456fef ? _0x1e20f1['createObjectURL'](_0x456fef) : _0x48a5c4; }), _0x305546(_0x472824(0x82a) + _0x4c75b7)[_0x472824(0x192)](_0x9938c5 => { const _0x411a26 = _0x472824; _0x266553[_0x411a26(0x483)] = _0x9938c5 ? _0x5d064f[_0x411a26(0x371)](_0x9938c5) : ''; }), _0x1b1f84(_0x472824(0x388), 'chat'); } else { _0x1286af = _0x106044(_0xd62acd[_0x472824(0x567)]), _0x3a54e8[_0x472824(0x7a2)] = ''; if (_0x1286af['length'] === 0x0) { _0x3a54e8['innerHTML'] = _0x472824(0x1c3); return; } _0x1286af[_0x472824(0x302)]((_0xb63ae9, _0x556323) => { const _0x3832b5 = _0x472824, _0x3f4a3f = document[_0x3832b5(0x5ba)]('p'); _0x3f4a3f['textContent'] = _0xb63ae9[_0x3832b5(0x68e)], _0x3f4a3f['id'] = _0x3832b5(0x1aa) + _0x556323, _0x3a54e8[_0x3832b5(0x796)](_0x3f4a3f); }); } } function _0x4212d8() { const _0x1699fa = _0x27dd8f; if (_0x1286af['length'] === 0x0) return; const _0x4f6b93 = _0x4baa54['currentTime']; let _0x1adc10 = -0x1; for (let _0x59d1c4 = 0x0; _0x59d1c4 < _0x1286af[_0x1699fa(0x7a6)]; _0x59d1c4++) { if (_0x4f6b93 >= _0x1286af[_0x59d1c4]['time']) _0x1adc10 = _0x59d1c4; else { if ('cHQNF' !== _0x1699fa(0x512)) { let _0x4a03b7 = _0x82a667[_0x1699fa(0x5b7)](_0x1699fa(0xf8) + _0x59e408['id']); !_0x4a03b7 && (_0x4a03b7 = _0x445a8a[_0x1699fa(0x5ba)](_0x1699fa(0x6ca)), _0x4a03b7['id'] = 'style-' + _0x24d90a['id'], _0x2cdf6a[_0x1699fa(0x73d)][_0x1699fa(0x796)](_0x4a03b7)); const _0x24a608 = _0x101fb1['bubbleCss'], _0x5ab23b = _0x24a608[_0x1699fa(0x4f8)](/\.bubble\.sent/g, _0x1699fa(0x5da) + _0x2fc91a['id'] + _0x1699fa(0xbf))['replace'](/\.bubble\.received/g, _0x1699fa(0x5da) + _0x3356d3['id'] + '.message.ai'); _0x4a03b7['innerHTML'] = _0x5ab23b; } else break; } } if (_0x1adc10 !== -0x1) { if ('uYUyD' === _0x1699fa(0x34e)) _0x24dfaa(_0xaf5afb); else { const _0x34601c = _0x3a54e8[_0x1699fa(0x687)]('p'); _0x34601c[_0x1699fa(0x302)](_0x56abd7 => _0x56abd7[_0x1699fa(0x35f)][_0x1699fa(0x7ff)]('active')); const _0x1da585 = document[_0x1699fa(0x5b7)](_0x1699fa(0x1aa) + _0x1adc10); _0x1da585 && (_0x1da585[_0x1699fa(0x35f)]['add'](_0x1699fa(0x3fe)), _0x1da585[_0x1699fa(0x1c2)]({ 'behavior': 'smooth', 'block': 'center' })); } } } _0x3857fc[_0x27dd8f(0x572)]('click', () => { const _0x17ee62 = _0x27dd8f; if ('XKtFB' === _0x17ee62(0x37e)) _0x428a23[_0x17ee62(0x35f)][_0x17ee62(0x7ff)](_0x17ee62(0x1c6)), setTimeout(() => _0x428a23[_0x17ee62(0x6ca)]['display'] = 'none', 0x12c); else { const _0x5b3670 = _0x3f61ed[_0x17ee62(0x5ba)]('p'); _0x5b3670[_0x17ee62(0x6ca)]['marginTop'] = '5px', _0x5b3670[_0x17ee62(0x2d0)] = _0x1805a9, _0x4902d0[_0x17ee62(0x796)](_0x5b3670); } }), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x4c5))['addEventListener'](_0x27dd8f(0x66b), () => { const _0x5aaac2 = _0x27dd8f; _0x557cc6['listenTogetherSession'] && _0x557cc6[_0x5aaac2(0x2c3)]['isActive'] && (_0x5aaac2(0xee) === _0x5aaac2(0xee) ? (_0x428a23[_0x5aaac2(0x6ca)][_0x5aaac2(0x836)] = _0x5aaac2(0x177), setTimeout(() => _0x428a23[_0x5aaac2(0x35f)][_0x5aaac2(0x632)](_0x5aaac2(0x1c6)), 0xa)) : _0x50afd0++); }), _0x4baa54['addEventListener'](_0x27dd8f(0x811), _0x4212d8); const _0x199bf5 = document['getElementById']('widget-play-pause-btn'), _0x22e4c3 = document[_0x27dd8f(0x5b7)](_0x27dd8f(0x1fa)), _0xc59687 = document[_0x27dd8f(0x5b7)]('widget-prev-btn'); _0x199bf5[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x27a664 = _0x27dd8f; if (_0x4baa54['src']) { if ('bZeHp' !== _0x27a664(0x70b)) { if (_0x4baa54[_0x27a664(0x11d)]) { if ('pbjhB' !== _0x27a664(0x6af)) _0x4baa54[_0x27a664(0x57e)](); else { const _0x5256da = _0xf5483[_0x27a664(0x70d)](_0x113734, _0x27a664(0x478)), _0x2d28f5 = _0x5256da[_0x27a664(0x365)](_0x582f8c), _0x7fb50b = _0x2d28f5[_0x27a664(0x6f7)](_0x48c9d2); _0x7fb50b[_0x27a664(0x7c8)] = () => _0x2b2ebb(), _0x7fb50b['onerror'] = () => _0x12c017(_0x7fb50b['error']); } } else _0x4baa54[_0x27a664(0x2a8)](); } else return _0x537957[_0x27a664(0x6b4)](_0x324624), _0x52fac6; } }), _0x22e4c3[_0x27dd8f(0x572)]('click', () => { const _0x35edf5 = _0x27dd8f; if ('SGciG' !== _0x35edf5(0x1e0)) _0x5341f6(![]), _0x5bc05d[_0x35edf5(0x50e)](_0x35edf5(0x18e), _0xab1125), _0x1658c1(_0x35edf5(0x2f3) + _0x721621[_0x35edf5(0x832)]); else { if (_0x4d8e21[_0x35edf5(0x7a6)] === 0x0) return; _0x483a75 = (_0x483a75 + 0x1) % _0x4d8e21[_0x35edf5(0x7a6)], _0x3ecda3(_0x4d8e21[_0x483a75], _0x4d8e21); } }), _0xc59687[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x3be7b6 = _0x27dd8f; if (_0x4d8e21[_0x3be7b6(0x7a6)] === 0x0) return; _0x483a75 = (_0x483a75 - 0x1 + _0x4d8e21[_0x3be7b6(0x7a6)]) % _0x4d8e21[_0x3be7b6(0x7a6)], _0x3ecda3(_0x4d8e21[_0x483a75], _0x4d8e21); }), _0x4baa54[_0x27dd8f(0x572)](_0x27dd8f(0x57e), () => { const _0x2c102f = _0x27dd8f; if (_0x2c102f(0x3a4) !== _0x2c102f(0x597)) _0x199bf5[_0x2c102f(0x2d0)] = '❚❚'; else { if (_0xb51ba6[_0x2c102f(0x7a6)] === 0x0) return; _0x4094f6 = (_0x1ec194 - 0x1 + _0x52109d[_0x2c102f(0x7a6)]) % _0x3b6222['length'], _0x28c0d8(_0x4fa4a1[_0x25fc45], _0x2f0e9d); } }), _0x4baa54[_0x27dd8f(0x572)](_0x27dd8f(0x2a8), () => { _0x199bf5['textContent'] = '▶'; }), _0x4baa54[_0x27dd8f(0x572)](_0x27dd8f(0x432), () => { const _0xf07df4 = _0x27dd8f; _0x22e4c3[_0xf07df4(0x66b)](); }), _0x4baa54[_0x27dd8f(0x572)](_0x27dd8f(0x57e), () => { const _0x5a2dc9 = _0x27dd8f, _0x36ab36 = document['getElementById'](_0x5a2dc9(0x115)); if (_0x36ab36) _0x36ab36[_0x5a2dc9(0x2d0)] = '❚❚'; }), _0x4baa54[_0x27dd8f(0x572)](_0x27dd8f(0x2a8), () => { const _0x4ab2a4 = _0x27dd8f, _0x4a58c1 = document[_0x4ab2a4(0x5b7)]('global-player-play-pause-btn'); if (_0x4a58c1) _0x4a58c1[_0x4ab2a4(0x2d0)] = '▶'; }), _0x4baa54[_0x27dd8f(0x572)]('ended', () => { const _0x3dad80 = _0x27dd8f; if (_0x3dad80(0x113) !== 'uVRMT') { const _0x4804ab = document['getElementById']('global-player-next-btn'); if (_0x4804ab) { if (_0x3dad80(0x2fe) !== _0x3dad80(0x153)) _0x4804ab[_0x3dad80(0x66b)](); else return [_0xca5cef]; } } else { const _0x8d6839 = _0xb6f9b[_0x3dad80(0x30c)](_0x25b064, 0x2); _0x8d6839[_0x3dad80(0x3bc)] = () => _0x18024c(_0x3dad80(0x559)), _0x8d6839[_0x3dad80(0x7c8)] = () => _0x2692f4(_0x8d6839[_0x3dad80(0x242)]), _0x8d6839['onupgradeneeded'] = _0x193258 => { const _0x2424d2 = _0x3dad80, _0x44eaa0 = _0x193258[_0x2424d2(0x44b)]['result']; !_0x44eaa0[_0x2424d2(0x162)][_0x2424d2(0x793)](_0x33ef7d) && _0x44eaa0[_0x2424d2(0x3cd)](_0x16b951, { 'keyPath': 'id' }); const _0x58a85a = 'music_library'; !_0x44eaa0[_0x2424d2(0x162)][_0x2424d2(0x793)](_0x58a85a) && _0x44eaa0['createObjectStore'](_0x58a85a, { 'keyPath': 'id' }); }; } }); async function _0x373527() { const _0x33853d = _0x27dd8f, _0x4be9fa = [..._0x9cad1d]; try { const _0x6b0ea3 = localStorage[_0x33853d(0x426)](_0x33853d(0x469)); if (_0x6b0ea3) { if ('Utvli' === _0x33853d(0x839)) _0x242ec0['src'] = _0x22f95d['image']; else { const _0x11fcf7 = JSON[_0x33853d(0x417)](_0x6b0ea3); Array['isArray'](_0x11fcf7) ? _0x56624c = [..._0x4be9fa, ..._0x11fcf7] : _0x56624c = _0x4be9fa; } } else _0x33853d(0x350) !== _0x33853d(0x5fa) ? _0x56624c = _0x4be9fa : _0x19964e[_0x33853d(0x5b7)]('char-edit-sprite-' + _0x1dd7aa + '-preview')[_0x33853d(0x483)] = _0x17940f[_0x33853d(0x371)](_0x1e1607); } catch (_0x4ff002) { console['error'](_0x33853d(0x2f5), _0x4ff002), _0x56624c = _0x4be9fa; } if (!localStorage['getItem']('noir_data_migration_v1_complete')) { _0x4512da('检测到旧版聊天数据，为了优化体验和存储空间，需要进行一次自动升级。过程很快，请稍候。')['then'](async _0x3bfc83 => { const _0x32093c = _0x33853d; _0x3bfc83 ? (_0x2158b6(!![], '正在升级聊天数据结构...'), await _0x4283b7(), localStorage['setItem'](_0x32093c(0x546), _0x32093c(0x17c)), _0x2158b6(![]), _0x599dea(_0x32093c(0x7e5)), setTimeout(() => location[_0x32093c(0x112)](), 0x5dc)) : _0x599dea('升级已取消。旧版图片数据可能导致应用卡顿或出错。'); }); return; } if (!localStorage[_0x33853d(0x426)](_0x33853d(0x7aa))) { if ('MRSOf' === _0x33853d(0x1bd)) { console[_0x33853d(0x235)]('执行好友圈数据净化...'), _0x2158b6(!![], _0x33853d(0x271)); const _0x1eb2ed = await _0x6984d8(); localStorage['setItem']('noir_migration_fc_v1_complete', _0x33853d(0x17c)), _0x2158b6(![]); if (_0x1eb2ed > 0x0) { if (_0x33853d(0x65b) !== _0x33853d(0x65b)) _0xaedf2a += _0x1996fb[_0x33853d(0x417)](_0x113d50)['candidates'][0x0][_0x33853d(0x398)][_0x33853d(0x777)][0x0][_0x33853d(0x68e)]; else { _0x599dea(_0x33853d(0x817) + _0x1eb2ed + _0x33853d(0x7d0)), setTimeout(() => location[_0x33853d(0x112)](), 0x5dc); return; } } } else { _0x4d66c9[_0x33853d(0x170)][_0x33853d(0x222)] = _0x9018d3[_0x33853d(0x73f)]['trim'](), _0xaee07f[_0x33853d(0x170)][_0x33853d(0x499)] = _0x57f71e[_0x33853d(0x73f)]['trim'](), _0x51ddbb[_0x33853d(0x170)]['model'] = _0x17236d['value'][_0x33853d(0xf2)](), _0x22679d[_0x33853d(0x170)][_0x33853d(0x2b3)] = _0x349c6c[_0x33853d(0x5b7)](_0x33853d(0x522))[_0x33853d(0x73f)]; const _0x19699a = _0x2edda0(_0x4c4fd5[_0x33853d(0x73f)], 0xa); _0x3208bf[_0x33853d(0x4c2)][_0x33853d(0x521)] = _0x47b078[_0x33853d(0x232)](_0x19699a) && _0x19699a > 0x0 ? _0x19699a : 0x64, _0x379946(), _0x30b364(_0x33853d(0x294)); } } if (!localStorage[_0x33853d(0x426)]('noir_migration_fc_v1_complete')) { } if (!localStorage[_0x33853d(0x426)]('noir_migration_music_v1_complete')) { console[_0x33853d(0x235)](_0x33853d(0x77)), _0x2158b6(!![], _0x33853d(0x590)); const _0x589fd8 = await _0x1ae9e8(); localStorage['setItem'](_0x33853d(0x360), _0x33853d(0x17c)), _0x2158b6(![]); if (_0x589fd8 > 0x0) { if (_0x33853d(0x347) !== _0x33853d(0x347)) _0x46aebd[_0x33853d(0x572)](_0x33853d(0x66b), function () { const _0x5a9214 = { 'id': _0x493eb5['id'], 'url': _0x99e0['playableUrl'] }; _0x22f61f(this, _0x5a9214); }); else { _0x599dea(_0x33853d(0x599) + _0x589fd8 + '\x20张旧封面。应用即将刷新。'), setTimeout(() => location[_0x33853d(0x112)](), 0x5dc); return; } } } const _0x552543 = _0x46198a(); _0x4bcf15(), _0x4f3107(), _0x3eda07(), _0x435368(), _0x335694(), _0x41ea4b(), _0x306347(), _0x3c9162(), _0x1c1971(), _0x2e8b13(), _0x2d5ebb(), _0x290716(), setInterval(_0x290716, 0x7530), _0x13c027(), _0x18d2c5(), _0x572f26(); const _0x434c1e = document[_0x33853d(0x5b7)]('audio-player'); document[_0x33853d(0x5b7)](_0x33853d(0x4c5))[_0x33853d(0x572)](_0x33853d(0x66b), function (_0x5ad17f) { const _0x142a15 = _0x33853d; if (_0x5ad17f[_0x142a15(0x44b)][_0x142a15(0x665)](_0x142a15(0x7fd))) return; const _0x4d3b1f = document['getElementById']('widget-play-pause-btn'); _0x4d3b1f && _0x4d3b1f[_0x142a15(0x66b)](); }), _0x4f27ca(_0x33853d(0x707), _0x33853d(0x6e0)); (_0x552543 || _0x557cc6[_0x33853d(0x618)]['length'] === 0x0) && (_0x599dea(_0x33853d(0x2fd)), setTimeout(() => { const _0xa1e961 = _0x33853d; _0x4f27ca(_0xa1e961(0x827), _0xa1e961(0x707)), setTimeout(() => _0x3de8df(), 0x64); }, 0x6a4)); const _0x3039ee = document['getElementById']('widget-bg-input'); document['getElementById'](_0x33853d(0xcd))[_0x33853d(0x572)](_0x33853d(0x66b), () => _0x3039ee[_0x33853d(0x66b)]()), document[_0x33853d(0x5b7)](_0x33853d(0x2fc))[_0x33853d(0x572)]('click', () => { const _0x58ec58 = _0x33853d; _0x557cc6[_0x58ec58(0x4c2)][_0x58ec58(0x299)] = null, _0x162000(), _0x13c027(), _0x599dea(_0x58ec58(0x324)); }), _0x3039ee['addEventListener']('change', async _0x2edae5 => { const _0x1abb07 = _0x33853d; if (_0x1abb07(0x4f3) !== _0x1abb07(0x2a3)) { const _0x48fb0c = _0x2edae5['target'][_0x1abb07(0x209)][0x0]; if (!_0x48fb0c) return; try { const _0x2fc95f = await _0x4889cd(_0x48fb0c); _0x557cc6[_0x1abb07(0x4c2)][_0x1abb07(0x299)] = _0x2fc95f, _0x162000(), _0x13c027(), _0x599dea(_0x1abb07(0x18d)); } catch (_0x453930) { _0x599dea(_0x1abb07(0x397) + _0x453930[_0x1abb07(0x832)]); } } else _0x539773 = _0x463267[_0x1abb07(0x426)]('chatHistory_' + _0x5f4941[_0x1abb07(0x589)]); }), _0x211b27(), document[_0x33853d(0x5b7)]('upload-badge-button')['addEventListener'](_0x33853d(0x66b), () => document[_0x33853d(0x5b7)](_0x33853d(0x2ef))[_0x33853d(0x66b)]()), document['getElementById'](_0x33853d(0x228))[_0x33853d(0x572)](_0x33853d(0x66b), async () => { const _0x26b17f = _0x33853d; await _0x2e942c(_0x26b17f(0x335)), localStorage[_0x26b17f(0x17f)]('badgeState'), _0x211b27(), _0x599dea(_0x26b17f(0x176)); }), document[_0x33853d(0x5b7)]('badge-input')[_0x33853d(0x572)](_0x33853d(0x265), async _0x447bad => { const _0x31216b = _0x33853d, _0x5cd703 = _0x447bad[_0x31216b(0x44b)][_0x31216b(0x209)][0x0]; if (!_0x5cd703) return; try { _0x31216b(0x75d) === _0x31216b(0x7b9) ? _0x310462[_0x31216b(0x483)] && (_0x31456b[_0x31216b(0x11d)] ? _0xe6bccb['play']() : _0x4f04d4[_0x31216b(0x2a8)]()) : (await _0x3aff46(_0x31216b(0x335), _0x5cd703), await _0x211b27(), _0x599dea('徽章已更换！')); } catch (_0x22c731) { _0x599dea(_0x31216b(0x397) + _0x22c731[_0x31216b(0x832)]); } }), _0x11491a(), document[_0x33853d(0x5b7)](_0x33853d(0x2c7))['addEventListener'](_0x33853d(0x190), _0x2aabf4), document[_0x33853d(0x5b7)](_0x33853d(0x2c7))[_0x33853d(0x572)](_0x33853d(0x514), _0x2aabf4, { 'passive': ![] }), document['getElementById'](_0x33853d(0x7dc))[_0x33853d(0x572)](_0x33853d(0x66b), () => document[_0x33853d(0x5b7)](_0x33853d(0x22c))['click']()), document[_0x33853d(0x5b7)]('reset-card-button')[_0x33853d(0x572)]('click', async () => { const _0x431031 = _0x33853d; _0x431031(0x57f) !== _0x431031(0x78f) ? (await _0x2e942c('widget_card'), localStorage[_0x431031(0x17f)](_0x431031(0x2f0)), _0x11491a(), _0x599dea(_0x431031(0x229))) : _0x11ea16[_0x431031(0x35f)][_0x431031(0x7ff)](_0x431031(0x1c6)); }), document[_0x33853d(0x5b7)](_0x33853d(0x22c))[_0x33853d(0x572)](_0x33853d(0x265), async _0x2f02c2 => { const _0x531a05 = _0x33853d, _0x3c24b7 = _0x2f02c2[_0x531a05(0x44b)]['files'][0x0]; if (!_0x3c24b7) return; try { await _0x3aff46(_0x531a05(0x7fc), _0x3c24b7), await _0x11491a(), _0x599dea('卡片已更换！'); } catch (_0x28c84b) { _0x599dea('错误:\x20' + _0x28c84b[_0x531a05(0x832)]); } }), document[_0x33853d(0x5b7)]('reset-widgets-position-button')[_0x33853d(0x572)](_0x33853d(0x66b), async () => { const _0x2b8063 = _0x33853d; if (_0x2b8063(0x3ce) === 'HWCGK') _0xcfe95b = _0x2b8063(0x682); else { const _0x1847b3 = await _0x4512da(_0x2b8063(0x199)); _0x1847b3 && (_0x2b8063(0x5c3) !== _0x2b8063(0x5c3) ? _0x354e44[_0x2b8063(0x6ca)][_0xa5efe9] = _0x75806a[_0x56e7e3] : (localStorage[_0x2b8063(0x17f)]('badgeState'), localStorage[_0x2b8063(0x17f)]('cardWidgetState'), _0x599dea(_0x2b8063(0x291)), setTimeout(() => location[_0x2b8063(0x112)](), 0x3e8))); } }); const _0x50b162 = document['getElementById'](_0x33853d(0x807)); _0x50b162['addEventListener']('click', () => { const _0x2a21ff = _0x33853d; 'ytFpX' !== _0x2a21ff(0x17d) ? (_0x56b87e(), _0xa0182b(_0x2a21ff(0xf1), _0x2a21ff(0x707))) : (_0x5ef101(), _0x4f27ca('diaryList', _0x2a21ff(0x707))); }); const _0x3ae6b0 = document[_0x33853d(0x5b7)](_0x33853d(0x30d)); _0x3ae6b0[_0x33853d(0x572)]('click', () => { const _0x524a9f = _0x33853d; _0x94c31c(), _0x4f27ca(_0x524a9f(0x1ef), _0x524a9f(0x707)); }), document[_0x33853d(0x5b7)]('back-to-home-from-music-library')['addEventListener'](_0x33853d(0x66b), () => _0x4f27ca('home', _0x33853d(0x1ef))), document[_0x33853d(0x5b7)](_0x33853d(0x3ad))[_0x33853d(0x572)](_0x33853d(0x66b), () => _0x4f27ca(_0x33853d(0x707), 'diaryList')), document['getElementById'](_0x33853d(0x36a))[_0x33853d(0x572)](_0x33853d(0x66b), () => { const _0x5e0086 = _0x33853d; _0x557cc6[_0x5e0086(0x29e)] = null, _0x4f27ca(_0x5e0086(0x4ab), _0x5e0086(0x449)); }), document['getElementById'](_0x33853d(0x78b))[_0x33853d(0x572)](_0x33853d(0x66b), _0xb13614), document['getElementById']('diary-get-reply-button')[_0x33853d(0x572)](_0x33853d(0x66b), _0x4934f7), document[_0x33853d(0x5b7)]('diary-entry-input')[_0x33853d(0x572)]('keydown', _0x5e9ab5 => { const _0x2a3c05 = _0x33853d; 'mAspy' !== _0x2a3c05(0x452) ? _0x5e9ab5['key'] === 'Enter' && !_0x5e9ab5[_0x2a3c05(0x1cf)] && (_0x2a3c05(0x4d4) === _0x2a3c05(0x4d4) ? (_0x5e9ab5[_0x2a3c05(0x31e)](), _0xb13614()) : _0x12ada8[_0x2a3c05(0x6ca)]['backgroundImage'] = _0x2a3c05(0x4e3)) : _0x59f0eb(_0x2a3c05(0x397) + _0x379255['message']); }); const _0x20105a = [_0x33853d(0x343), _0x33853d(0x703), _0x33853d(0xb5), _0x33853d(0x280), 'shy']; _0x20105a[_0x33853d(0x302)](_0x14962c => { const _0x3e2b2b = _0x33853d; if (_0x3e2b2b(0x489) !== 'YENEu') { const _0x52397c = document[_0x3e2b2b(0x5b7)](_0x3e2b2b(0x98) + _0x14962c + '-preview'), _0x563b85 = document[_0x3e2b2b(0x5b7)](_0x3e2b2b(0x98) + _0x14962c + _0x3e2b2b(0x219)); _0x52397c && _0x563b85 && (_0x52397c[_0x3e2b2b(0x572)](_0x3e2b2b(0x66b), () => _0x563b85[_0x3e2b2b(0x66b)]()), _0x563b85['addEventListener'](_0x3e2b2b(0x265), async _0x1131a2 => { const _0x37a853 = _0x3e2b2b, _0x1dd8fb = _0x1131a2[_0x37a853(0x44b)][_0x37a853(0x209)][0x0]; if (!_0x1dd8fb) return; try { if (_0x37a853(0x178) !== _0x37a853(0x178)) { _0xfd691(); const _0x359cb6 = _0x2aa837(_0x37a853(0x3f0), _0x1b7553[_0x37a853(0x293)]); _0x359cb6 && _0x359cb6['trim']() && _0x359cb6 !== _0x53f0e0['name'] && (_0x571925[_0x37a853(0x293)] = _0x359cb6[_0x37a853(0xf2)](), _0x2abd75(), _0x5bc59e(), _0x5a5aa2(), _0x240bdf('群名称已更改为\x22' + _0xf0a2e5[_0x37a853(0x293)] + '\x22。')); } else _0x52397c[_0x37a853(0x483)] = URL['createObjectURL'](_0x1dd8fb); } catch (_0x10ce68) { _0x599dea(_0x37a853(0xb2) + _0x10ce68[_0x37a853(0x832)]); } })); } else _0x407844[_0x3e2b2b(0x50e)](_0x3e2b2b(0x552), _0x4b3d72); }), document[_0x33853d(0x5b7)](_0x33853d(0x319))[_0x33853d(0x572)](_0x33853d(0x66b), _0x5b9288), document[_0x33853d(0x5b7)]('toggle-meeting-view-button')[_0x33853d(0x572)]('click', () => { const _0x5679bc = _0x33853d; _0x557cc6[_0x5679bc(0x97)] = _0x557cc6['meetingViewMode'] === 'novel' ? 'galgame' : _0x5679bc(0x77e), _0x5164c1(); }), document['getElementById'](_0x33853d(0x50c))[_0x33853d(0x572)]('mousedown', _0x13c072), document['getElementById'](_0x33853d(0x50c))[_0x33853d(0x572)](_0x33853d(0x514), _0x13c072, { 'passive': ![] }); let _0x1f58bd = null; function _0x13c072(_0x331aad) { const _0x356b78 = _0x33853d; if (_0x1f58bd) clearTimeout(_0x1f58bd); const _0x158fc0 = _0x331aad['target'][_0x356b78(0x665)]('p[data-history-index]'); if (!_0x158fc0) return; const _0x3a0f34 = parseInt(_0x158fc0[_0x356b78(0x78)][_0x356b78(0x52d)], 0xa); if (isNaN(_0x3a0f34)) return; const _0x265065 = () => { _0x1f58bd = setTimeout(() => { const _0x142972 = _0x3d17; if (_0x331aad[_0x142972(0x516)] === 'touchstart') _0x331aad[_0x142972(0x31e)](); _0xaf7b77(_0x3a0f34); }, 0x320); }, _0x5d23ac = () => { const _0x5c45a0 = _0x356b78; if (_0x5c45a0(0x3cc) === _0x5c45a0(0x3cc)) { if (_0x1f58bd) clearTimeout(_0x1f58bd); } else _0xc7731a = _0x4be757[_0x5c45a0(0x417)](_0x3f0891); }; document[_0x356b78(0x572)](_0x356b78(0x195), _0x5d23ac, { 'once': !![] }), document[_0x356b78(0x572)](_0x356b78(0x87), _0x5d23ac, { 'once': !![] }), document[_0x356b78(0x572)]('touchend', _0x5d23ac, { 'once': !![] }), document['addEventListener'](_0x356b78(0x73c), _0x5d23ac, { 'once': !![] }), _0x265065(); } document['body'][_0x33853d(0x572)](_0x33853d(0x66b), _0x5cb9dc => { const _0x5bbcf3 = _0x33853d; if (_0x5bbcf3(0x3e8) === _0x5bbcf3(0x3e8)) { const _0x212b8a = _0x5cb9dc[_0x5bbcf3(0x44b)][_0x5bbcf3(0x665)](_0x5bbcf3(0x4fc)); if (_0x212b8a) { if (_0x5bbcf3(0x179) !== _0x5bbcf3(0x179)) try { const _0x5bfd4f = { 'characters': _0x39b0b1[_0x5bbcf3(0x618)], 'worldBooks': _0x48d65c[_0x5bbcf3(0x694)], 'chats': _0x10c83d[_0x5bbcf3(0x46d)], 'userProfile': _0x4aee26[_0x5bbcf3(0x204)], 'apiSettings': _0x5f905a[_0x5bbcf3(0x170)], 'preferences': _0x29f025[_0x5bbcf3(0x4c2)], 'activeChatId': _0x4aeca7[_0x5bbcf3(0x589)], 'diaries': _0x2312a9[_0x5bbcf3(0xa8)], 'friendCircles': _0xf1dd2e[_0x5bbcf3(0x78e)], 'activeFriendCircleId': _0x3378ab['activeFriendCircleId'], 'userProfiles': _0x5d5e5a[_0x5bbcf3(0x58d)], 'activeUserProfileId': _0x1bd8bf[_0x5bbcf3(0x26a)] }; _0x5632ad['setItem']('appState', _0x17d90a[_0x5bbcf3(0x82f)](_0x5bfd4f)); } catch (_0x26b987) { _0x1da7ff[_0x5bbcf3(0x50e)](_0x5bbcf3(0x553), _0x26b987), _0x44065e('无法保存状态，浏览器可能禁用了存储功能。'); } else { const _0x5d74ef = _0x5cb9dc[_0x5bbcf3(0x44b)][_0x5bbcf3(0x665)](_0x5bbcf3(0xc1)), _0x105f6 = _0x5cb9dc[_0x5bbcf3(0x44b)]['closest'](_0x5bbcf3(0x1bb)); if (_0x5d74ef) _0x5bbcf3(0x111) !== _0x5bbcf3(0x111) ? _0x556c5a['events']['push']({ 'senderId': _0x5e1875['id'], 'kind': _0x5bbcf3(0x475), 'sticker': _0x3abe1d }) : _0x3565bc(); else { if (_0x105f6) { if ('QtXSd' !== _0x5bbcf3(0x34c)) { const _0x1019ce = _0x105f6[_0x5bbcf3(0x665)](_0x5bbcf3(0x63d)), _0x4d70b6 = _0x105f6[_0x5bbcf3(0x78)]['songId'], _0x4f73b8 = parseInt(_0x1019ce[_0x5bbcf3(0x78)][_0x5bbcf3(0x52d)], 0xa); _0x18b8be(_0x4d70b6, _0x4f73b8, _0x212b8a); } else { const _0x50ad50 = _0x332efa === _0x3b1540 ? _0x5bbcf3(0x3b2) : ''; return '' + _0x50ad50 + _0x251974[_0x5bbcf3(0x68e)]; } } else { if (_0x5bbcf3(0x7bd) === _0x5bbcf3(0x530)) _0x204158['image'] = _0x4497ad, _0xe25ddf = !![]; else { const _0x29f37b = _0x5db7d2(); _0x29f37b && _0x29f37b[_0x5bbcf3(0x71d)] && _0x29f37b['activeListenSession'][_0x5bbcf3(0x5bc)] && (_0x5bbcf3(0xf0) === _0x5bbcf3(0x2cf) ? (_0x39fefc['conversationHistory'][_0xb15c1][_0x5bbcf3(0x5f6)] = !![], _0xceb814()) : (_0x428a23[_0x5bbcf3(0x6ca)][_0x5bbcf3(0x836)] = 'flex', setTimeout(() => _0x428a23['classList'][_0x5bbcf3(0x632)](_0x5bbcf3(0x1c6)), 0xa))); } } } return; } } if (window[_0x5bbcf3(0x423)]()[_0x5bbcf3(0x9b)]()) return; const _0x22853b = _0x5cb9dc[_0x5bbcf3(0x44b)][_0x5bbcf3(0x665)]('.message-container'); if (_0x22853b && !_0x5cb9dc[_0x5bbcf3(0x44b)][_0x5bbcf3(0x665)](_0x5bbcf3(0x6d2))) { const _0x4ed920 = parseInt(_0x22853b['dataset'][_0x5bbcf3(0x52d)], 0xa); if (!isNaN(_0x4ed920)) { if (_0x5bbcf3(0x2bb) === _0x5bbcf3(0x2e0)) return; else _0xaf7b77(_0x4ed920); } } } else _0x12eec4(_0x3c55a1['coverId'])[_0x5bbcf3(0x192)](_0x54801a => { const _0x1d81bf = _0x5bbcf3, _0x3b43cc = _0x174e6d[_0x1d81bf(0x5b7)](_0x566be8); if (_0x3b43cc && _0x54801a) _0x3b43cc[_0x1d81bf(0x483)] = _0x422c95[_0x1d81bf(0x371)](_0x54801a); }); }); const _0x1b6054 = document[_0x33853d(0x5b7)](_0x33853d(0x308)); _0x1b6054 && _0x1b6054['addEventListener']('click', () => { const _0xb29924 = _0x33853d; _0x599dea(_0xb29924(0x6ae)); }); const _0x402cd8 = document[_0x33853d(0x5b7)](_0x33853d(0x473)), _0x7bc5ca = localStorage[_0x33853d(0x426)](_0x33853d(0x469)); if (_0x7bc5ca) try { if (_0x33853d(0x4e4) !== 'GAyhE') _0xf36342[_0x33853d(0x761)] && _0x289e19(_0x39c444[_0x33853d(0x761)]); else { const _0x3192b5 = JSON[_0x33853d(0x417)](_0x7bc5ca); Array[_0x33853d(0x65c)](_0x3192b5) && (_0x402cd8[_0x33853d(0x73f)] = _0x3192b5[_0x33853d(0x30e)](_0x5b2247 => _0x5b2247[_0x33853d(0x293)] + '--' + _0x5b2247[_0x33853d(0x606)])['join']('\x0a')); } } catch (_0x1b971c) { } document['getElementById'](_0x33853d(0xc5))[_0x33853d(0x572)]('click', () => { const _0x564c78 = _0x33853d, _0x215f58 = _0x402cd8[_0x564c78(0x73f)], _0x42d47f = _0x215f58[_0x564c78(0x1d2)]('\x0a')[_0x564c78(0x1d8)](_0x3cea4b => _0x3cea4b[_0x564c78(0xf2)]() !== ''), _0x4ab098 = []; let _0x179f79 = 0x0; for (const _0x547f63 of _0x42d47f) { const _0x445732 = _0x547f63[_0x564c78(0x1d2)]('--'); if (_0x445732[_0x564c78(0x7a6)] === 0x2 && _0x445732[0x0][_0x564c78(0xf2)]() && _0x445732[0x1][_0x564c78(0xf2)]()[_0x564c78(0x795)](_0x564c78(0x837))) _0x564c78(0x544) === _0x564c78(0x544) ? _0x4ab098[_0x564c78(0x6b4)]({ 'name': _0x445732[0x0][_0x564c78(0xf2)](), 'url': _0x445732[0x1][_0x564c78(0xf2)]() }) : (_0x5d9bfb[_0x564c78(0x760)](), _0x20e0ca()); else { if (_0x564c78(0x4a7) !== _0x564c78(0x3ed)) _0x179f79++; else for (const _0x2a1884 of _0x320359[_0x564c78(0x694)]) { let _0x8a8d59 = _0x4d7e79['worldBooks'][_0x564c78(0x4d1)](_0x13e429 => _0x13e429['name'] === _0x2a1884[_0x564c78(0x293)]); if (_0x8a8d59) _0x5dece9[_0x564c78(0x6b4)](_0x8a8d59['id']); else { const _0x4cce4e = { 'id': _0x564c78(0x42c) + _0x11db57[_0x564c78(0x183)]() + '_' + _0x4a47bc[_0x564c78(0x19a)](), 'name': _0x2a1884[_0x564c78(0x293)], 'content': _0x2a1884[_0x564c78(0x398)] }; _0x5c3d8f[_0x564c78(0x694)][_0x564c78(0x6b4)](_0x4cce4e), _0x6e82d3['push'](_0x4cce4e['id']); } } } } if (_0x179f79 > 0x0) { if (_0x564c78(0x697) === 'HhvAa') { const _0x3cc33c = _0x12bc18['createElement'](_0x564c78(0x509)); _0x3cc33c[_0x564c78(0x640)] = _0x564c78(0x55d), _0x3cc33c['dataset']['id'] = _0x5143eb['id']; const _0x42cbdf = _0x526d42['id'] === _0x2a62a1['activeUserProfileId'] ? _0x564c78(0x72f) : ''; _0x3cc33c[_0x564c78(0x7a2)] = _0x564c78(0x80) + (_0xf7d9b4[_0x564c78(0x51e)] || _0x1e8fac) + _0x564c78(0x5b9) + _0x5240f0[_0x564c78(0x293)] + _0x42cbdf + _0x564c78(0x4ec) + _0x2708a4[_0x564c78(0x6f2)][_0x564c78(0x471)](0x0, 0x64) + _0x564c78(0xb9), _0x3cc33c[_0x564c78(0x572)]('click', () => _0x47806a(_0x1afabc['id'])), _0x42c18d['appendChild'](_0x3cc33c); } else _0x599dea('有\x20' + _0x179f79 + _0x564c78(0x6c9)); } try { localStorage[_0x564c78(0x69e)](_0x564c78(0x469), JSON[_0x564c78(0x82f)](_0x4ab098)), _0x599dea('表情包已保存！正在刷新应用...'), setTimeout(() => location[_0x564c78(0x112)](), 0x5dc); } catch (_0x580c59) { if (_0x564c78(0x32b) !== _0x564c78(0x683)) _0x599dea('保存失败，你的表情包是不是太多了？'); else { const _0x5f068c = { 'id': 'circle_' + _0x28778d[_0x564c78(0x183)](), 'name': _0x3da0b0, 'boundUserProfileId': _0xf56317, 'memberCharacterIds': _0x350cf2, 'posts': [] }; _0x52dfe0[_0x564c78(0x78e)][_0x564c78(0x6b4)](_0x5f068c); } } }), _0x287ab6(), document[_0x33853d(0x5b7)](_0x33853d(0x202))[_0x33853d(0x572)](_0x33853d(0x66b), () => { const _0x134a80 = _0x33853d; 'uIQLc' !== _0x134a80(0x4b1) ? (_0xcc049d[_0x134a80(0x50e)](_0x134a80(0x62f), _0x1fa593), _0x5ed189[_0x134a80(0x406)] = _0x134a80(0x734)) : document[_0x134a80(0x5b7)](_0x134a80(0x127))[_0x134a80(0x66b)](); }), document[_0x33853d(0x5b7)](_0x33853d(0x1a8))['addEventListener'](_0x33853d(0x66b), async () => { const _0x10c068 = _0x33853d; await _0x2e942c(_0x10c068(0x6eb)), localStorage['removeItem']('cardState2'), _0x11491a(), _0x599dea(_0x10c068(0x53a)); }), document[_0x33853d(0x5b7)](_0x33853d(0x127))[_0x33853d(0x572)](_0x33853d(0x265), async _0x3a0286 => { const _0x375017 = _0x33853d, _0x2db649 = _0x3a0286[_0x375017(0x44b)][_0x375017(0x209)][0x0]; if (!_0x2db649) return; try { 'vjjdc' === 'vjjdc' ? (await _0x3aff46(_0x375017(0x6eb), _0x2db649), await _0x11491a(), _0x599dea(_0x375017(0x745))) : _0x204e1a[_0x375017(0x50e)](_0x375017(0x7b3) + _0x45eb51 + ':', _0x507f52); } catch (_0x294d18) { _0x599dea(_0x375017(0x397) + _0x294d18[_0x375017(0x832)]); } }); } const _0x4c4a8d = new Promise((_0x20659c, _0x292098) => { const _0x42bfbb = _0x27dd8f, _0x4897b8 = indexedDB[_0x42bfbb(0x30c)](_0x11e05d, 0x2); _0x4897b8[_0x42bfbb(0x3bc)] = () => _0x292098(_0x42bfbb(0x559)), _0x4897b8[_0x42bfbb(0x7c8)] = () => _0x20659c(_0x4897b8[_0x42bfbb(0x242)]); }), _0x10585d = _0x27dd8f(0x2f8); async function _0x352c43(_0xb10ae3) { const _0x1dfeff = _0x27dd8f; if (_0x1dfeff(0x481) !== _0x1dfeff(0x555)) { const _0x3bbdbb = await _0x4c4a8d; return new Promise((_0x156ffe, _0x5ed540) => { const _0x3df859 = _0x1dfeff; if (_0x3df859(0x7f1) !== _0x3df859(0x29d)) { const _0x4e3a5d = _0x3bbdbb[_0x3df859(0x70d)](_0x10585d, 'readonly'), _0x519c9f = _0x4e3a5d[_0x3df859(0x365)](_0x10585d), _0x2cbd70 = _0x519c9f['get'](_0xb10ae3); _0x2cbd70[_0x3df859(0x7c8)] = () => _0x156ffe(_0x2cbd70['result']), _0x2cbd70[_0x3df859(0x3bc)] = () => _0x5ed540(_0x2cbd70[_0x3df859(0x50e)]); } else _0x2f928b[_0x3df859(0x7a2)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>' + _0x49e742 + _0x3df859(0x418) + _0x5f217e + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>' + _0x32e97b[_0x3df859(0x6c8)] + _0x3df859(0x624) + _0x32b3e3['artist'] + _0x3df859(0x2af) + _0xb09e41[_0x3df859(0x848)] + _0x3df859(0x540); }); } else { if (!_0x3ffa5d[_0x1dfeff(0x78e)] || _0x3e347f['friendCircles'][_0x1dfeff(0x7a6)] === 0x0) { _0x4e8a22[_0x1dfeff(0x50e)](_0x1dfeff(0x379)); return; } const _0x3c0091 = _0x40b54b[_0x1dfeff(0x78e)][0x0]; if (_0x3c0091['memberCharacterIds'][_0x1dfeff(0x7a6)] < 0x2) { _0x9a2345[_0x1dfeff(0x50e)](_0x1dfeff(0x1f8) + _0x3c0091[_0x1dfeff(0x293)] + '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。'); return; } const _0x53e4f9 = { 'id': 'test_post_' + _0x1b9e31[_0x1dfeff(0x183)](), 'authorType': _0x1dfeff(0x380), 'authorId': _0x3c0091['memberCharacterIds'][0x0], 'content': _0x1dfeff(0x3b3), 'timestamp': _0x5e8d93[_0x1dfeff(0x183)](), 'likes': [_0x3c0091[_0x1dfeff(0x14c)][0x1]], 'comments': [{ 'commentId': 'c_' + _0xea7c42['now'](), 'authorId': _0x3c0091[_0x1dfeff(0x14c)][0x1], 'content': _0x1dfeff(0x6a7) }] }; _0x3c0091[_0x1dfeff(0x18a)][_0x1dfeff(0x6b4)](_0x53e4f9), _0x4b3e2a(), _0x363ed6[_0x1dfeff(0x235)](_0x1dfeff(0x139) + _0x3c0091[_0x1dfeff(0x293)] + _0x1dfeff(0x29a)), _0x3a2094(_0x1dfeff(0x4d2)); } } async function _0x5664db() { const _0x12a7fd = await _0x4c4a8d; return new Promise((_0x141ac7, _0xd885ff) => { const _0x2df031 = _0x3d17; if ('HEEsl' === _0x2df031(0x6dc)) { const _0x4d9517 = _0x12a7fd[_0x2df031(0x70d)](_0x10585d, _0x2df031(0x3c3)), _0x7ac3b0 = _0x4d9517[_0x2df031(0x365)](_0x10585d), _0x9564c9 = _0x7ac3b0[_0x2df031(0x775)](); _0x9564c9[_0x2df031(0x7c8)] = () => _0x141ac7(_0x9564c9[_0x2df031(0x242)]), _0x9564c9[_0x2df031(0x3bc)] = () => _0xd885ff(_0x9564c9[_0x2df031(0x50e)]); } else { _0x59d0a5('音乐数据升级完成，迁移了\x20' + _0x513fd0 + _0x2df031(0x51d)), _0x3d7812(() => _0x2f95ff[_0x2df031(0x112)](), 0x5dc); return; } }); } async function _0x1ad3fe(_0x3bda70) { const _0x30527f = _0x27dd8f; if (_0x30527f(0x562) === _0x30527f(0x562)) { const _0x38c2fa = await _0x4c4a8d; return new Promise((_0x9201ef, _0x1f80d8) => { const _0x43afd7 = _0x30527f; if (_0x43afd7(0x12c) !== 'HsIfM') { const _0x3fd1e3 = _0x4857f6[_0x43afd7(0x5b7)]('user-profile-list-container'); _0x3fd1e3['innerHTML'] = ''; if (_0x3fefad[_0x43afd7(0x58d)][_0x43afd7(0x7a6)] === 0x0) { _0x3fd1e3[_0x43afd7(0x7a2)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何用户资料，点击右上角“+”创建第一个。</p>'; return; } _0x1ecf22[_0x43afd7(0x58d)][_0x43afd7(0x302)](_0x54a167 => { const _0x2a2be2 = _0x43afd7, _0x3502fb = _0x3f5a40['createElement'](_0x2a2be2(0x509)); _0x3502fb[_0x2a2be2(0x640)] = _0x2a2be2(0x55d), _0x3502fb[_0x2a2be2(0x78)]['id'] = _0x54a167['id']; const _0x2febc8 = _0x54a167['id'] === _0x1ce7e2['activeUserProfileId'] ? _0x2a2be2(0x72f) : ''; _0x3502fb[_0x2a2be2(0x7a2)] = _0x2a2be2(0x80) + (_0x54a167[_0x2a2be2(0x51e)] || _0x43ea3d) + _0x2a2be2(0x5b9) + _0x54a167[_0x2a2be2(0x293)] + _0x2febc8 + '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x54a167[_0x2a2be2(0x6f2)][_0x2a2be2(0x471)](0x0, 0x64) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', _0x3502fb[_0x2a2be2(0x572)]('click', () => _0x353dab(_0x54a167['id'])), _0x3fd1e3[_0x2a2be2(0x796)](_0x3502fb); }); } else { const _0x42e591 = _0x38c2fa[_0x43afd7(0x70d)](_0x10585d, _0x43afd7(0x478)), _0x582141 = _0x42e591[_0x43afd7(0x365)](_0x10585d), _0xf73bf9 = _0x582141[_0x43afd7(0x5e8)](_0x3bda70); _0xf73bf9['onsuccess'] = () => _0x9201ef(_0xf73bf9[_0x43afd7(0x242)]), _0xf73bf9['onerror'] = () => _0x1f80d8(_0xf73bf9[_0x43afd7(0x50e)]); } }); } else _0x47daf9[_0x30527f(0x17f)]('chatHistory_' + _0x4ea27a['id']), _0x13c4ac(_0x30527f(0x157) + _0x32533a[_0x30527f(0x293)] + _0x30527f(0x20a)); } async function _0x42038d(_0x3593ac) { const _0x2d7d8c = await _0x4c4a8d; return new Promise((_0x49a4ba, _0x1383c9) => { const _0x5ea7d5 = _0x3d17, _0x180559 = _0x2d7d8c['transaction'](_0x10585d, _0x5ea7d5(0x478)), _0x48ef0c = _0x180559[_0x5ea7d5(0x365)](_0x10585d), _0x4784ef = _0x48ef0c['delete'](_0x3593ac); _0x4784ef['onsuccess'] = () => _0x49a4ba(), _0x4784ef[_0x5ea7d5(0x3bc)] = () => _0x1383c9(_0x4784ef[_0x5ea7d5(0x50e)]); }); } let _0x509112 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; const _0x253e42 = { 'audio': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x208)), 'cover': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x1da)), 'info': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x40c)), 'lyrics': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x814)) }, _0x5c5b97 = { 'audio': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x6ee)), 'cover': document[_0x27dd8f(0x5b7)]('cover-file-input'), 'info': document['getElementById'](_0x27dd8f(0x10c)), 'lyrics': document[_0x27dd8f(0x5b7)](_0x27dd8f(0x226)) }; for (const _0x529e91 in _0x253e42) { _0x253e42[_0x529e91]['addEventListener'](_0x27dd8f(0x66b), () => _0x5c5b97[_0x529e91]['click']()), _0x5c5b97[_0x529e91][_0x27dd8f(0x572)]('change', _0x5813b6 => { const _0x11b2e1 = _0x27dd8f; _0xc6e60f(_0x529e91, _0x5813b6[_0x11b2e1(0x44b)]['files'][0x0]); }); } function _0xc6e60f(_0x45cdf2, _0x54f263) { const _0x1e0eb4 = _0x27dd8f; if (_0x1e0eb4(0x352) !== 'aaJHC') _0x2ae733[_0x1e0eb4(0x35f)][_0x1e0eb4(0x451)]('show'), _0x40e8d0['classList'][_0x1e0eb4(0x793)](_0x1e0eb4(0x1c6)) && (_0x3e5bac[_0x1e0eb4(0x4f0)] = _0x2f6dfa['scrollHeight']); else { if (!_0x54f263) return; _0x509112[_0x45cdf2] = _0x54f263, _0x253e42[_0x45cdf2][_0x1e0eb4(0x5ab)](_0x1e0eb4(0x59a))[_0x1e0eb4(0x2d0)] = _0x54f263[_0x1e0eb4(0x293)], _0x253e42[_0x45cdf2][_0x1e0eb4(0x35f)][_0x1e0eb4(0x632)](_0x1e0eb4(0x7a9)), _0x26907e(); } } function _0x26907e() { const _0x224834 = _0x27dd8f; if ('QhMJr' !== _0x224834(0x3b6)) { const _0x112191 = document[_0x224834(0x5b7)](_0x224834(0x669)); _0x509112[_0x224834(0x44f)] && _0x509112[_0x224834(0x96)] ? _0x112191['disabled'] = ![] : _0x112191[_0x224834(0x6cf)] = !![]; } else { _0x2bb918[_0x224834(0x235)](_0x224834(0x50a)); return; } } function _0x11e754() { const _0x21443b = _0x27dd8f; _0x509112 = { 'audio': null, 'cover': null, 'info': null, 'lyrics': null }; for (const _0x7b6354 in _0x253e42) { _0x253e42[_0x7b6354][_0x21443b(0x35f)]['remove'](_0x21443b(0x7a9)), _0x5c5b97[_0x7b6354]['value'] = ''; } _0x253e42[_0x21443b(0x44f)][_0x21443b(0x5ab)](_0x21443b(0x59a))['textContent'] = _0x21443b(0x50f), _0x253e42['cover'][_0x21443b(0x5ab)]('.slot-filename')['textContent'] = _0x21443b(0x1d7), _0x253e42[_0x21443b(0x96)]['querySelector']('.slot-filename')['textContent'] = _0x21443b(0x214), _0x253e42['lyrics'][_0x21443b(0x5ab)](_0x21443b(0x59a))['textContent'] = _0x21443b(0x30f), _0x26907e(); } document[_0x27dd8f(0x5b7)]('confirm-altar-upload-button')['addEventListener'](_0x27dd8f(0x66b), async () => { const _0xa0526c = _0x27dd8f; if ('gDqRu' === _0xa0526c(0x37c)) { if (!_0x509112[_0xa0526c(0x44f)] || !_0x509112[_0xa0526c(0x96)]) { if (_0xa0526c(0xdf) === 'NzfcN') _0x4adbad[_0xa0526c(0x796)](_0x17992d); else { _0x599dea(_0xa0526c(0x40b)); return; } } await _0x473eca(); } else { if (_0x96ead3[_0xa0526c(0x7a6)] === 0x0) return; _0x374ae2 = (_0x13b57c - 0x1 + _0x124b52[_0xa0526c(0x7a6)]) % _0x109068['length'], _0x16a063(_0x1d2dd7[_0x2e579c], _0xffea97); } }), document[_0x27dd8f(0x5b7)](_0x27dd8f(0x7da))['addEventListener']('click', () => { const _0x11617c = _0x27dd8f; _0x11e754(), _0x4f27ca('musicUploadAltar', _0x11617c(0x1ef)); }), document['getElementById'](_0x27dd8f(0x41d))[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x2c271a = _0x27dd8f; _0x2c271a(0x7a1) !== _0x2c271a(0x7a1) ? _0x41047a(_0x24ab1d[_0x2c271a(0x243)], _0x2ee63c[_0x2c271a(0x49d)]) : _0x4f27ca('musicLibrary', 'musicUploadAltar'); }); async function _0x473eca() { const _0x41309b = _0x27dd8f; if (_0x41309b(0x156) !== _0x41309b(0x25e)) { _0x2158b6(!![], _0x41309b(0x14d)); try { if (_0x41309b(0x67d) === _0x41309b(0x67d)) { const _0x2c748b = await _0x509112['info']['text'](), _0xe1aed = JSON[_0x41309b(0x417)](_0x2c748b), _0x426ba0 = 'song_' + (_0xe1aed['歌曲ID'] || Date[_0x41309b(0x183)]()), _0x8d0ae6 = { 'id': _0x426ba0, 'info': _0xe1aed, 'audio': _0x509112[_0x41309b(0x44f)], 'cover': _0x509112[_0x41309b(0x791)], 'lyrics': _0x509112[_0x41309b(0x567)] ? await _0x509112[_0x41309b(0x567)]['text']() : '' }; await _0x1ad3fe(_0x8d0ae6), await _0x94c31c(), _0x2158b6(![]), _0x599dea('歌曲“' + _0xe1aed['歌曲名称'] + '”已存入圣殿。'), _0x4f27ca(_0x41309b(0x1ef), _0x41309b(0x5b6)); } else _0x1b3881[_0x41309b(0x50e)](_0x41309b(0x711), _0x2825aa); } catch (_0x23cd8f) { _0x2158b6(![]), console[_0x41309b(0x50e)](_0x41309b(0xa2), _0x23cd8f), _0x599dea(_0x41309b(0x33b) + _0x23cd8f[_0x41309b(0x832)]); } } else _0x1c1ef6[_0x41309b(0x483)] = _0x1e5a42['createObjectURL'](_0x42bb4a); } async function _0x94c31c() { const _0x4d3d03 = _0x27dd8f, _0x1f392c = document['getElementById']('music-library-container'); _0x1f392c[_0x4d3d03(0x7a2)] = ''; const _0x23950e = await _0x5664db(); if (_0x23950e[_0x4d3d03(0x7a6)] === 0x0) { _0x1f392c[_0x4d3d03(0x7a2)] = _0x4d3d03(0xe0); return; } _0x23950e['sort']((_0x3c2f88, _0x10230e) => (_0x3c2f88[_0x4d3d03(0x96)][_0x4d3d03(0x561)] || '')[_0x4d3d03(0x78d)](_0x10230e[_0x4d3d03(0x96)][_0x4d3d03(0x561)] || '')); for (const _0x5f745a of _0x23950e) { const _0x2c2728 = document[_0x4d3d03(0x5ba)](_0x4d3d03(0x509)); _0x2c2728[_0x4d3d03(0x640)] = _0x4d3d03(0x468), _0x2c2728[_0x4d3d03(0x78)][_0x4d3d03(0x848)] = _0x5f745a['id']; const _0xfe6154 = _0x5f745a[_0x4d3d03(0x791)] ? URL[_0x4d3d03(0x371)](_0x5f745a[_0x4d3d03(0x791)]) : _0x1732e7; _0x2c2728[_0x4d3d03(0x7a2)] = '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22' + _0xfe6154 + _0x4d3d03(0x5c8) + (_0x5f745a[_0x4d3d03(0x96)][_0x4d3d03(0x561)] || '未知歌曲') + _0x4d3d03(0x1bc) + (_0x5f745a[_0x4d3d03(0x96)]['歌手'] || _0x4d3d03(0x4a6)) + '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'; let _0x1df943 = null; const _0x5d2c96 = _0x2d0a7b => { const _0x122bf5 = _0x4d3d03; if (_0x2d0a7b[_0x122bf5(0x7fd)] === 0x2) return; _0x1df943 = setTimeout(async () => { const _0x1fd6df = _0x122bf5; if (_0x1fd6df(0x32d) !== _0x1fd6df(0x32d)) { if (_0x2fbd48) _0x244eba[_0x1fd6df(0x2d0)] = '❚❚'; } else { if (_0x2d0a7b[_0x1fd6df(0x516)] === _0x1fd6df(0x514)) _0x2d0a7b['preventDefault'](); const _0x37310f = await _0x4512da('确定要从圣殿中永久删除《' + _0x5f745a['info'][_0x1fd6df(0x561)] + _0x1fd6df(0x5b2)); _0x37310f && ('noDlt' !== _0x1fd6df(0x419) ? _0x1fd6df(0x643) : (await _0x42038d(_0x5f745a['id']), await _0x94c31c(), _0x599dea(_0x1fd6df(0x4ef)))); } }, 0x320); }, _0x5d6df7 = () => { clearTimeout(_0x1df943); }; _0x2c2728[_0x4d3d03(0x572)](_0x4d3d03(0x190), _0x5d2c96), _0x2c2728[_0x4d3d03(0x572)](_0x4d3d03(0x195), _0x5d6df7), _0x2c2728[_0x4d3d03(0x572)](_0x4d3d03(0x87), _0x5d6df7), _0x2c2728[_0x4d3d03(0x572)]('touchstart', _0x5d2c96, { 'passive': ![] }), _0x2c2728['addEventListener'](_0x4d3d03(0x21f), _0x5d6df7), _0x2c2728['addEventListener'](_0x4d3d03(0x73c), _0x5d6df7), _0x2c2728[_0x4d3d03(0x572)]('click', _0x3431d5 => { const _0x3c519a = _0x4d3d03; if (_0x1df943) clearTimeout(_0x1df943); if (_0x3431d5[_0x3c519a(0x787)]) return; setTimeout(() => { const _0x5db5e0 = _0x3c519a; if ('zyTlV' === 'Drhcz') { _0x3b7d8d('AI似乎没有想出任何新动态。'); return; } else _0x1df943 && _0x3ecda3(_0x5f745a['id'], _0x23950e[_0x5db5e0(0x30e)](_0x3d33f7 => _0x3d33f7['id'])); }, 0x32); }), _0x1f392c[_0x4d3d03(0x796)](_0x2c2728); } } _0x22e4c3[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0x4f98bc = _0x27dd8f; _0x599dea(_0x4f98bc(0x6c5)); }), _0xc59687[_0x27dd8f(0x572)]('click', () => { const _0x30a381 = _0x27dd8f; _0x599dea(_0x30a381(0x4f2)); }); let _0x4d8e21 = [], _0x483a75 = -0x1; async function _0x3ecda3(_0x2c2c69, _0x31abe9) { const _0x2ddb1e = _0x27dd8f, _0xc7568f = await _0x352c43(_0x2c2c69); if (!_0xc7568f) return; _0x41423e = { 'title': _0xc7568f[_0x2ddb1e(0x96)][_0x2ddb1e(0x561)] || '未知歌曲', 'artist': _0xc7568f[_0x2ddb1e(0x96)]['歌手'] || _0x2ddb1e(0x4a6), 'cover': _0xc7568f[_0x2ddb1e(0x791)] ? URL['createObjectURL'](_0xc7568f[_0x2ddb1e(0x791)]) : _0x1732e7, 'isFromLibrary': !![] }; const _0x33c658 = URL[_0x2ddb1e(0x371)](_0xc7568f[_0x2ddb1e(0x44f)]); _0x4baa54[_0x2ddb1e(0x483)] = _0x33c658, _0x4baa54['play'](), _0x2d5ebb(); } async function _0x2d5ebb() { const _0x33542d = _0x27dd8f, _0x961002 = document[_0x33542d(0x5b7)](_0x33542d(0x4c5)), _0x31743b = document[_0x33542d(0x5b7)](_0x33542d(0x1ca)), _0x5bc7fd = document[_0x33542d(0x5b7)](_0x33542d(0x506)), _0x3b770e = document[_0x33542d(0x5b7)](_0x33542d(0x768)), _0x2fbcaf = _0x41423e; _0x2fbcaf && _0x2fbcaf[_0x33542d(0x819)] ? (_0x31743b[_0x33542d(0x2d0)] = _0x2fbcaf[_0x33542d(0x1ec)], _0x5bc7fd[_0x33542d(0x2d0)] = _0x2fbcaf[_0x33542d(0x1e4)], _0x961002[_0x33542d(0x35f)][_0x33542d(0x632)](_0x33542d(0x680)), _0x961002[_0x33542d(0x6ca)][_0x33542d(0x6a0)]('--widget-cover-image', _0x33542d(0x520) + _0x2fbcaf['cover'] + ')')) : (_0x31743b[_0x33542d(0x2d0)] = _0x33542d(0x776), _0x5bc7fd[_0x33542d(0x2d0)] = _0x33542d(0x833), _0x961002['classList'][_0x33542d(0x7ff)](_0x33542d(0x680)), _0x3b770e[_0x33542d(0x6ca)][_0x33542d(0x6a0)](_0x33542d(0x79c), 'none')); } _0x22e4c3 && _0x22e4c3[_0x27dd8f(0x572)](_0x27dd8f(0x66b), () => { const _0xe51c42 = _0x27dd8f; if ('BlNIS' === _0xe51c42(0x1a1)) _0x6ec5c8[_0xe51c42(0x5b8)] = []; else { if (_0x4d8e21['length'] === 0x0) return; _0x483a75 = (_0x483a75 + 0x1) % _0x4d8e21['length'], _0x3ecda3(_0x4d8e21[_0x483a75], _0x4d8e21); } }); _0xc59687 && _0xc59687[_0x27dd8f(0x572)]('click', () => { const _0x7ba9ad = _0x27dd8f; if (_0x4d8e21[_0x7ba9ad(0x7a6)] === 0x0) return; _0x483a75 = (_0x483a75 - 0x1 + _0x4d8e21['length']) % _0x4d8e21[_0x7ba9ad(0x7a6)], _0x3ecda3(_0x4d8e21[_0x483a75], _0x4d8e21); }); _0x4baa54[_0x27dd8f(0x572)](_0x27dd8f(0x57e), () => { const _0x479377 = _0x27dd8f; if ('sNxdu' === _0x479377(0x73e)) { const _0x28d1f9 = _0x18fa3c['friendCircles'][_0x479377(0x4d1)](_0x522525 => _0x522525['id'] === _0x5b4e15); _0x28d1f9 && (_0x28d1f9['name'] = _0x5ddb04, _0x28d1f9[_0x479377(0x2a6)] = _0x12fe72, _0x28d1f9[_0x479377(0x14c)] = _0x1f4b5e); } else { if (_0x199bf5) _0x199bf5[_0x479377(0x2d0)] = '❚❚'; } }), _0x4baa54[_0x27dd8f(0x572)](_0x27dd8f(0x2a8), () => { const _0x661a18 = _0x27dd8f; if (_0x199bf5) _0x199bf5[_0x661a18(0x2d0)] = '▶'; }), _0x4baa54['addEventListener'](_0x27dd8f(0x432), () => { const _0x53e315 = _0x27dd8f; if (_0x53e315(0x9a) === _0x53e315(0xfe)) _0x2c931f(![]), _0x2e16c4['isGenerating'] = ![]; else { if (_0x22e4c3) _0x22e4c3['click'](); } }); function _0x22b405() { const _0x51afd7 = _0x27dd8f, _0x2e4649 = _0x5db7d2(); if (!_0x2e4649) return; _0xa71a26['innerHTML'] = '', _0x40d536[_0x51afd7(0x73f)] = ''; if (_0x2e4649[_0x51afd7(0x516)] === _0x51afd7(0x3fd)) _0x2e4649[_0x51afd7(0x765)][_0x51afd7(0x302)](_0xc12fbf => { const _0x4edbf3 = _0x51afd7; if ('dBUQj' === _0x4edbf3(0x716)) _0x15bb93('图标处理失败:\x20' + _0x5b7b4c['message']); else { const _0x5edcff = _0x3132c6(_0xc12fbf); if (_0x5edcff) { const _0x2d174a = document[_0x4edbf3(0x5ba)](_0x4edbf3(0x5e9)); _0x2d174a['value'] = _0x5edcff['id'], _0x2d174a[_0x4edbf3(0x2d0)] = _0x5edcff['name'], _0xa71a26['appendChild'](_0x2d174a); } } }), _0x40be99[_0x51afd7(0x6ca)][_0x51afd7(0x836)] = 'block'; else { if (_0x51afd7(0x18f) === _0x51afd7(0x18f)) _0x40be99['style']['display'] = _0x51afd7(0x4e3); else { const _0xeeddb5 = _0x4b886b[_0x51afd7(0x398)] ? '\x20' + _0x2f341f['content'] : ''; _0x1a5ae1['push']('[' + _0x556c22(_0xfc8474) + _0x51afd7(0x5ed) + _0xeeddb5); } } _0x616135[_0x51afd7(0x35f)]['add'](_0x51afd7(0x1c6)), _0x40d536[_0x51afd7(0x3e4)](); } function _0x295834() { const _0x46aa31 = _0x27dd8f, _0x2f9687 = parseFloat(_0x40d536[_0x46aa31(0x73f)]); if (isNaN(_0x2f9687) || _0x2f9687 <= 0x0) { _0x599dea(_0x46aa31(0x6c1)); return; } const _0x199547 = _0x5db7d2(); let _0x3b888e = null; _0x199547[_0x46aa31(0x516)] === _0x46aa31(0x3fd) ? _0x3b888e = _0xa71a26[_0x46aa31(0x73f)] : _0x3b888e = _0x199547[_0x46aa31(0x765)][0x0]; const _0x40e635 = _0x40920c(_0x199547['id']), _0x5befe1 = { 'role': _0x46aa31(0x472), 'type': 'transfer', 'content': _0x46aa31(0x120) + (_0x3132c6(_0x3b888e)?.[_0x46aa31(0x293)] || '未知') + _0x46aa31(0x58b) + _0x2f9687 + ']', 'amount': _0x2f9687, 'recipientId': _0x3b888e, 'senderId': _0x40e635['id'], 'timestamp': Date['now']() }; _0x557cc6[_0x46aa31(0x5b8)][_0x46aa31(0x6b4)](_0x5befe1), _0x2efa53(), _0x2292d9(), _0x616135[_0x46aa31(0x35f)][_0x46aa31(0x7ff)]('show'); } async function _0x27533e(_0x5eee20) { const _0x1b8b37 = _0x27dd8f; if ('xAYON' !== _0x1b8b37(0x7d2)) { const _0x3231eb = _0x3132c6(_0x5eee20); if (!_0x3231eb) return; const _0x18ead1 = await _0x4512da(_0x1b8b37(0xe4) + _0x3231eb[_0x1b8b37(0x293)] + _0x1b8b37(0x4c8)); if (!_0x18ead1) return; const _0x1800d6 = _0x557cc6[_0x1b8b37(0xa8)]['findIndex'](_0x563c4d => _0x563c4d[_0x1b8b37(0x27b)] === _0x5eee20); _0x1800d6 > -0x1 ? (_0x557cc6[_0x1b8b37(0xa8)][_0x1b8b37(0x168)](_0x1800d6, 0x1), _0x162000(), _0x5ef101(), _0x599dea('【' + _0x3231eb[_0x1b8b37(0x293)] + _0x1b8b37(0x74))) : _0x599dea(_0x1b8b37(0x5fe)); } else { const _0x53e8dd = _0x16c0cd[_0x1b8b37(0x775)](); _0x53e8dd[_0x1b8b37(0x7c8)] = () => _0x275875(_0x53e8dd[_0x1b8b37(0x242)]), _0x53e8dd[_0x1b8b37(0x3bc)] = () => _0x54b4c4(_0x53e8dd[_0x1b8b37(0x50e)]); } } _0x373527(); }); async function _0x4283b7() { const _0x18514c = _0x4f9ace; console['log'](_0x18514c(0x187)), console[_0x18514c(0x235)](_0x18514c(0x2c1)); const _0x3d8945 = _0x18514c(0x2e2), _0x225a06 = _0x18514c(0x2c5), _0x3a6853 = new Promise((_0x43928c, _0x8d08f4) => { const _0x2f16d0 = _0x18514c, _0x2f5214 = indexedDB['open'](_0x3d8945, 0x2); _0x2f5214[_0x2f16d0(0x3bc)] = () => _0x8d08f4(_0x2f16d0(0x559)), _0x2f5214[_0x2f16d0(0x7c8)] = () => _0x43928c(_0x2f5214[_0x2f16d0(0x242)]), _0x2f5214[_0x2f16d0(0x159)] = _0xdb2ddf => { const _0x20f213 = _0x2f16d0; if (_0x20f213(0x4d8) === 'UmXkH') _0x285658 > _0x2c362d && (_0x5a6020 *= _0x5a7503 / _0x295e28, _0x316dc8 = _0x23d9fc); else { const _0x6deca0 = _0xdb2ddf[_0x20f213(0x44b)][_0x20f213(0x242)]; !_0x6deca0[_0x20f213(0x162)][_0x20f213(0x793)](_0x225a06) && _0x6deca0['createObjectStore'](_0x225a06, { 'keyPath': 'id' }), !_0x6deca0[_0x20f213(0x162)][_0x20f213(0x793)](_0x20f213(0x2f8)) && (_0x20f213(0x2da) === 'WIzrC' ? _0x6deca0[_0x20f213(0x3cd)]('music_library', { 'keyPath': 'id' }) : (_0xb3ca4e['appendChild'](_0x54f2ba), _0x3c19b1[_0x20f213(0x796)](_0x28e586))); } }; }); async function _0x3d3ef4(_0x4ad3ec, _0x13a7b8) { const _0x4e4a17 = _0x18514c; if (_0x4e4a17(0xa5) !== _0x4e4a17(0xa5)) _0x52b402[_0x4e4a17(0x50e)]('Failed\x20to\x20remove\x20corrupted\x20state\x20from\x20localStorage:', _0x40151b); else { const _0x2bbbfc = await _0x3a6853; return new Promise((_0x229b65, _0x1d5df2) => { const _0x5edb5d = _0x4e4a17, _0x376c84 = _0x2bbbfc[_0x5edb5d(0x70d)](_0x225a06, 'readwrite'), _0x5c2cbd = _0x376c84[_0x5edb5d(0x365)](_0x225a06), _0x4f057d = _0x5c2cbd[_0x5edb5d(0x5e8)]({ 'id': _0x4ad3ec, 'blob': _0x13a7b8 }); _0x4f057d[_0x5edb5d(0x7c8)] = () => _0x229b65(_0x4f057d[_0x5edb5d(0x242)]), _0x4f057d['onerror'] = () => _0x1d5df2(_0x4f057d[_0x5edb5d(0x50e)]); }); } } function _0x42ac90(_0x4384b9) { const _0x250743 = _0x18514c; return fetch(_0x4384b9)[_0x250743(0x192)](_0x3b9bad => _0x3b9bad[_0x250743(0x31d)]()); } let _0x55af2e = 0x0; for (let _0x199b9c = 0x0; _0x199b9c < localStorage['length']; _0x199b9c++) { const _0x201087 = localStorage[_0x18514c(0x499)](_0x199b9c); if (_0x201087 && _0x201087[_0x18514c(0x795)]('chatHistory_')) { let _0x46ff4d, _0x5c2b3b = ![]; try { _0x46ff4d = JSON[_0x18514c(0x417)](localStorage['getItem'](_0x201087)); if (!Array[_0x18514c(0x65c)](_0x46ff4d)) continue; for (const _0x200634 of _0x46ff4d) { if (_0x18514c(0x708) === _0x18514c(0x6b5)) _0x481640 ? _0x5bb20b[_0x18514c(0x35f)]['add'](_0x18514c(0x2c2)) : _0x2e555f[_0x18514c(0x35f)][_0x18514c(0x7ff)]('show-chat-view'); else { if (_0x200634 && _0x200634[_0x18514c(0x690)] && _0x200634[_0x18514c(0x690)][_0x18514c(0x795)](_0x18514c(0x1a4))) { const _0x29d959 = await _0x42ac90(_0x200634[_0x18514c(0x690)]), _0x376ae0 = 'chat_image_migrated_' + Date[_0x18514c(0x183)]() + '_' + Math['random'](); await _0x3d3ef4(_0x376ae0, _0x29d959), _0x200634['imageId'] = _0x376ae0, delete _0x200634[_0x18514c(0x690)], _0x5c2b3b = !![], _0x55af2e++; } } } if (_0x5c2b3b) { if ('jWxQF' !== _0x18514c(0x3fa)) { const _0x4ecd34 = _0x45e6ac[_0x18514c(0x5ba)]('div'); _0x4ecd34[_0x18514c(0x640)] = _0x18514c(0x55d), _0x4ecd34[_0x18514c(0x78)]['id'] = _0x32420['id'], _0x4ecd34['innerHTML'] = _0x18514c(0x790) + _0x2b5ab0['name'] + '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>' + _0x7f5fc7[_0x18514c(0x398)][_0x18514c(0x471)](0x0, 0x64) + _0x18514c(0x37b), _0x4ecd34[_0x18514c(0x572)](_0x18514c(0x66b), () => _0x1ec2a2(_0x1873dd['id'])), _0x4d8bdb[_0x18514c(0x796)](_0x4ecd34); } else localStorage[_0x18514c(0x69e)](_0x201087, JSON['stringify'](_0x46ff4d)); } } catch (_0x57970c) { console[_0x18514c(0x50e)]('处理\x20' + _0x201087 + _0x18514c(0x71e), _0x57970c); continue; } } } console['log']('净化完成！总共迁移了\x20' + _0x55af2e + '\x20张旧图片。'); } async function _0x6984d8() { const _0x51d1f1 = _0x4f9ace; console[_0x51d1f1(0x235)](_0x51d1f1(0x4ae)), console[_0x51d1f1(0x235)](_0x51d1f1(0x7a5)); async function _0x69c436(_0x3684cc, _0x5a827e) { const _0x2cbecf = _0x51d1f1; if ('QfPrP' === _0x2cbecf(0x393)) throw new _0x3d2d91(_0x2cbecf(0x76c)); else { const _0x1110c9 = await _0x4a97d6; return new Promise((_0x476af6, _0x5212a1) => { const _0x406d3a = _0x2cbecf, _0x4b996e = _0x1110c9[_0x406d3a(0x70d)]('images', 'readwrite'), _0x31621a = _0x4b996e[_0x406d3a(0x365)](_0x406d3a(0x2c5)), _0x1e4bdb = _0x31621a[_0x406d3a(0x5e8)]({ 'id': _0x3684cc, 'blob': _0x5a827e }); _0x1e4bdb[_0x406d3a(0x7c8)] = () => _0x476af6(_0x1e4bdb['result']), _0x1e4bdb[_0x406d3a(0x3bc)] = () => _0x5212a1(_0x1e4bdb[_0x406d3a(0x50e)]); }); } } function _0x54bfee(_0x626961) { const _0x2e9f4b = _0x51d1f1; return fetch(_0x626961)[_0x2e9f4b(0x192)](_0xacb724 => _0xacb724['blob']()); } let _0x2df127 = 0x0, _0x47f24b = ![]; try { if (_0x51d1f1(0x237) !== _0x51d1f1(0x1fd)) { const _0x339708 = localStorage[_0x51d1f1(0x426)](_0x51d1f1(0x435)); if (!_0x339708) { console[_0x51d1f1(0x235)]('好友圈档案柜是空的，无需净化。'); return; } const _0x590527 = JSON[_0x51d1f1(0x417)](_0x339708); if (!_0x590527[_0x51d1f1(0x78e)] || !Array[_0x51d1f1(0x65c)](_0x590527['friendCircles'])) { if ('jqycg' !== _0x51d1f1(0x19f)) return; else _0x546012 = {}; } for (const _0x159930 of _0x590527['friendCircles']) { if (_0x159930[_0x51d1f1(0x18a)] && Array[_0x51d1f1(0x65c)](_0x159930[_0x51d1f1(0x18a)])) { if (_0x51d1f1(0x444) !== _0x51d1f1(0x7d)) for (const _0x59e33b of _0x159930[_0x51d1f1(0x18a)]) { if (_0x51d1f1(0x6ab) === _0x51d1f1(0x6ab)) { if (_0x59e33b && _0x59e33b['image'] && _0x59e33b['image'][_0x51d1f1(0x795)](_0x51d1f1(0x1a4))) { if (_0x51d1f1(0x504) === _0x51d1f1(0x196)) _0x444224['name'] = _0x4488cb[_0x51d1f1(0xf2)](), _0x43c4ae(), _0x26e90b(), _0x1cc7be(), _0x157413('群名称已更改为\x22' + _0x5d64f7[_0x51d1f1(0x293)] + '\x22。'); else { console[_0x51d1f1(0x235)]('在好友圈\x20\x22' + _0x159930['name'] + _0x51d1f1(0x7c0)); const _0x1352ac = await _0x54bfee(_0x59e33b[_0x51d1f1(0x690)]), _0x4f2fe2 = _0x51d1f1(0x359) + Date[_0x51d1f1(0x183)]() + '_' + Math[_0x51d1f1(0x19a)](); await _0x69c436(_0x4f2fe2, _0x1352ac), _0x59e33b[_0x51d1f1(0x8c)] = _0x4f2fe2, delete _0x59e33b[_0x51d1f1(0x690)], _0x47f24b = !![], _0x2df127++; } } } else _0x5871ec[_0x51d1f1(0x28c)] = ![]; } else { const _0x144b9a = _0x2a4867['getElementById'](_0x51d1f1(0x5af))[_0x51d1f1(0x73f)]; _0x144b9a && (_0x317aa9[_0x51d1f1(0x26a)] = _0x144b9a, _0x1d161c(), _0x3b33c7(_0x51d1f1(0x33d)), _0x2a370b(), _0x2677bc['getElementById'](_0x51d1f1(0x54e))[_0x51d1f1(0x6ca)]['display'] = _0x51d1f1(0x4e3)); } } } if (_0x47f24b) { if ('MzOXj' !== _0x51d1f1(0x27d)) { const _0x54cd7f = _0xf460be[_0x51d1f1(0x70d)](_0x3884dc, 'readwrite'), _0x228409 = _0x54cd7f[_0x51d1f1(0x365)](_0x36f8ad), _0x4af065 = _0x228409[_0x51d1f1(0x5e8)]({ 'id': _0x3fb382, 'blob': _0x31486b }); _0x4af065[_0x51d1f1(0x7c8)] = () => _0x45531a(_0x4af065['result']), _0x4af065[_0x51d1f1(0x3bc)] = () => _0x22f1f1(_0x4af065[_0x51d1f1(0x50e)]); } else console['log'](_0x51d1f1(0x7b5)), localStorage[_0x51d1f1(0x69e)](_0x51d1f1(0x435), JSON[_0x51d1f1(0x82f)](_0x590527)); } } else _0x867377[_0x51d1f1(0x50e)](_0x51d1f1(0x297), _0x5c4126); } catch (_0x1b6268) { if (_0x51d1f1(0x37f) === _0x51d1f1(0x76b)) { const _0x57dcc7 = _0x2d8686[_0x51d1f1(0x70d)](_0x1bb6ed, _0x51d1f1(0x478)), _0x595962 = _0x57dcc7[_0x51d1f1(0x365)](_0x11c4d3), _0x52e5e3 = _0x595962[_0x51d1f1(0x5e8)](_0x23690e); _0x52e5e3[_0x51d1f1(0x7c8)] = () => _0x3bb953(_0x52e5e3[_0x51d1f1(0x242)]), _0x52e5e3[_0x51d1f1(0x3bc)] = () => _0x47722a(_0x52e5e3[_0x51d1f1(0x50e)]); } else console['error'](_0x51d1f1(0x456), _0x1b6268); } return console[_0x51d1f1(0x235)](_0x51d1f1(0x354)), console[_0x51d1f1(0x235)](_0x51d1f1(0x4c3) + _0x2df127 + _0x51d1f1(0x799)), _0x2df127; } async function _0x1ae9e8() { const _0x3f3ba0 = _0x4f9ace; console[_0x3f3ba0(0x235)](_0x3f3ba0(0x528)), console[_0x3f3ba0(0x235)](_0x3f3ba0(0x644)); let _0xd24a17 = 0x0, _0x50f8f2 = ![]; try { const _0x33299d = localStorage['getItem'](_0x3f3ba0(0x435)); if (!_0x33299d) return console[_0x3f3ba0(0x235)]('聊天档案柜是空的，无需净化。'), 0x0; for (let _0x542478 = 0x0; _0x542478 < localStorage['length']; _0x542478++) { const _0x5329f9 = localStorage[_0x3f3ba0(0x499)](_0x542478); if (_0x5329f9 && _0x5329f9[_0x3f3ba0(0x795)](_0x3f3ba0(0x1cb))) { let _0x4b0856, _0x5cedef = ![]; try { if (_0x3f3ba0(0x90) !== _0x3f3ba0(0x90)) { if (_0x5e9e2e) { const _0x51297a = _0x3a1bc2[_0x3f3ba0(0x371)](_0x137e3a); _0x5ae5a7[_0x3f3ba0(0x483)] = _0x51297a, _0x3e3e20[_0x3f3ba0(0x38d)] = () => _0x43cffe['revokeObjectURL'](_0x51297a); } else _0x2e3787[_0x3f3ba0(0x406)] = _0x3f3ba0(0x734); } else { _0x4b0856 = JSON['parse'](localStorage[_0x3f3ba0(0x426)](_0x5329f9)); if (!Array['isArray'](_0x4b0856)) continue; for (const _0xf2880a of _0x4b0856) { if (_0xf2880a && (_0xf2880a['type'] === _0x3f3ba0(0x164) || _0xf2880a[_0x3f3ba0(0x516)] === _0x3f3ba0(0x2db)) && _0xf2880a[_0x3f3ba0(0x702)] && _0xf2880a[_0x3f3ba0(0x702)][_0x3f3ba0(0x795)]('data:image')) { if (_0x3f3ba0(0x2ec) !== _0x3f3ba0(0x2be)) { const _0xc95456 = await _0x57a56e(_0xf2880a['coverUrl']), _0xc476c3 = _0x3f3ba0(0x3a9) + Date[_0x3f3ba0(0x183)]() + '_' + Math[_0x3f3ba0(0x19a)](); await _0x3aff46(_0xc476c3, _0xc95456), _0xf2880a[_0x3f3ba0(0x3c2)] = _0xc476c3, delete _0xf2880a[_0x3f3ba0(0x702)], _0x5cedef = !![], _0xd24a17++; } else { if (!_0x2ea27a[_0x3f3ba0(0x589)]) return; try { _0x2c1702[_0x3f3ba0(0x69e)](_0x3f3ba0(0x1cb) + _0x40e594[_0x3f3ba0(0x589)], _0xbec3a0['stringify'](_0x24532a['conversationHistory'])); } catch (_0x3b9f80) { _0x2e9e73['error'](_0x3f3ba0(0x212), _0x3b9f80), _0x377c0c('无法保存聊天记录。'); } } } } if (_0x5cedef) { if (_0x3f3ba0(0x70e) === _0x3f3ba0(0x175)) { const _0x290a1e = _0x3f3ba0(0x6ba) + _0x2aec95; _0xfeb63(_0x290a1e), _0x4f8750(!![]); } else localStorage[_0x3f3ba0(0x69e)](_0x5329f9, JSON['stringify'](_0x4b0856)); } } } catch (_0x200fb2) { if (_0x3f3ba0(0x1c1) === 'NunTe') { console[_0x3f3ba0(0x50e)](_0x3f3ba0(0x6df) + _0x5329f9 + _0x3f3ba0(0x6d4), _0x200fb2); continue; } else _0x44a22f(_0x3f3ba0(0x2fd)), _0x357f89(() => { const _0x397068 = _0x3f3ba0; _0x5e0fc6(_0x397068(0x827), _0x397068(0x707)), _0x57a287(() => _0x444a1b(), 0x64); }, 0x6a4); } } } } catch (_0x294f69) { 'BUEaQ' !== _0x3f3ba0(0xce) ? console['error'](_0x3f3ba0(0x216), _0x294f69) : (_0x100115[_0x3f3ba0(0x6cf)] = ![], _0x320964[_0x3f3ba0(0x2d0)] = '获取'); } return console['log']('---\x20音乐净化仪式完成\x20---'), console[_0x3f3ba0(0x235)]('成功净化并迁移了\x20' + _0xd24a17 + '\x20张旧的音乐封面。'), _0xd24a17; } function _0x5bbb91() { const _0x363975 = _0x4f9ace; if (!_0x557cc6[_0x363975(0x29e)]) return _0x557cc6[_0x363975(0x58d)][_0x363975(0x4d1)](_0x5c3a87 => _0x5c3a87['id'] === _0x557cc6['activeUserProfileId']) || _0x557cc6[_0x363975(0x58d)][0x0]; const _0x58bca5 = _0x557cc6[_0x363975(0x46d)][_0x363975(0x4d1)](_0x4acf33 => _0x4acf33['type'] === _0x363975(0x405) && _0x4acf33['participantIds'][_0x363975(0x158)](_0x557cc6[_0x363975(0x29e)])), _0x5c2b05 = _0x58bca5?.[_0x363975(0x2a6)] || _0x557cc6[_0x363975(0x26a)]; return _0x557cc6[_0x363975(0x58d)][_0x363975(0x4d1)](_0x58c831 => _0x58c831['id'] === _0x5c2b05) || _0x557cc6[_0x363975(0x58d)][0x0]; } function _0x411f32(_0x25b2e7) { const _0x2d5102 = _0x4f9ace, _0x55a0d1 = new Date(), _0x1cef59 = _0x55a0d1 - _0x25b2e7, _0x251b66 = Math['round'](_0x1cef59 / 0x3e8), _0x2bb301 = Math[_0x2d5102(0x4c6)](_0x251b66 / 0x3c), _0xdca313 = Math['round'](_0x2bb301 / 0x3c), _0x4cca7c = Math[_0x2d5102(0x4c6)](_0xdca313 / 0x18), _0x4764bf = _0x25b2e7[_0x2d5102(0x116)](_0x2d5102(0x6ef), { 'hour': _0x2d5102(0x845), 'minute': '2-digit' }); if (_0x251b66 < 0x3c) return '刚才'; if (_0x2bb301 < 0x3c) return _0x2bb301 + _0x2d5102(0x203); const _0x2a8311 = _0x55a0d1[_0x2d5102(0x289)]() === _0x25b2e7[_0x2d5102(0x289)](); if (_0x2a8311) { if (_0x2d5102(0x526) !== _0x2d5102(0x46b)) return _0x2d5102(0x267) + _0x4764bf; else { const _0x15688b = _0x22e932[_0x2d5102(0x775)](); _0x15688b[_0x2d5102(0x7c8)] = () => _0x3b2bbc(_0x15688b[_0x2d5102(0x242)]), _0x15688b['onerror'] = () => _0x3417bc(_0x15688b[_0x2d5102(0x50e)]); } } const _0x1f1c88 = new Date(); _0x1f1c88[_0x2d5102(0x22f)](_0x55a0d1['getDate']() - 0x1); const _0x399d46 = _0x1f1c88[_0x2d5102(0x289)]() === _0x25b2e7[_0x2d5102(0x289)](); if (_0x399d46) return _0x2d5102(0x7c2) + _0x4764bf; if (_0x4cca7c <= 0x7) { const _0x57dfc2 = [_0x2d5102(0x408), '星期一', _0x2d5102(0x2c6), _0x2d5102(0x377), _0x2d5102(0x588), '星期五', '星期六']; return _0x57dfc2[_0x25b2e7[_0x2d5102(0x5cc)]()] + '\x20' + _0x4764bf; } return _0x25b2e7[_0x2d5102(0x110)]() + '年' + (_0x25b2e7[_0x2d5102(0x2aa)]() + 0x1) + '月' + _0x25b2e7[_0x2d5102(0x65f)]() + '日'; } function _0x4657ac(_0x14be7c, _0x344225 = 0x320, _0x4b4f83 = 0.8, _0x300084 = ![]) { return new Promise((_0x54734e, _0xc8782f) => { const _0x14c945 = _0x3d17; if (_0x14c945(0x3a6) !== _0x14c945(0x23f)) { if (!_0x14be7c || !_0x14be7c[_0x14c945(0x516)][_0x14c945(0x795)]('image/')) return _0xc8782f(new Error(_0x14c945(0x7e))); const _0x325010 = new FileReader(); _0x325010[_0x14c945(0x1ad)](_0x14be7c), _0x325010['onload'] = _0x414004 => { const _0x1fd56d = _0x14c945, _0x45a260 = new Image(); _0x45a260[_0x1fd56d(0x483)] = _0x414004[_0x1fd56d(0x44b)]['result'], _0x45a260['onload'] = () => { const _0x59fea1 = _0x1fd56d; if (_0x59fea1(0x274) === _0x59fea1(0x274)) { const _0x5a058e = document[_0x59fea1(0x5ba)](_0x59fea1(0x458)); let _0x2868b2 = _0x45a260[_0x59fea1(0x4af)], _0x4fe9c5 = _0x45a260['height']; if (_0x2868b2 > _0x4fe9c5) { if (_0x59fea1(0x262) === _0x59fea1(0x2a9)) _0x1d565e[_0x59fea1(0x572)](_0x59fea1(0x66b), () => { const _0x3da3b8 = _0x59fea1; if (_0x1aba2d[_0x3da3b8(0x7a6)] === 0x0) return; _0x35485d = (_0x23aaa3 - 0x1 + _0x2f23bf[_0x3da3b8(0x7a6)]) % _0xda3592[_0x3da3b8(0x7a6)], _0x4981fb(_0xd3df36[_0x15eafd], _0x551b74); }); else { if (_0x2868b2 > _0x344225) { if ('ZOXoN' === _0x59fea1(0x20c)) _0x4fe9c5 *= _0x344225 / _0x2868b2, _0x2868b2 = _0x344225; else { const _0x1766be = [_0x59fea1(0x408), _0x59fea1(0xda), _0x59fea1(0x2c6), _0x59fea1(0x377), '星期四', _0x59fea1(0x748), _0x59fea1(0x7eb)]; return _0x1766be[_0x1a47d2[_0x59fea1(0x5cc)]()] + '\x20' + _0x22a32e; } } } } else _0x59fea1(0x307) !== _0x59fea1(0x307) ? (_0x4fc1f0['chats'] = _0x4d191f[_0x59fea1(0x46d)], _0x562005[_0x59fea1(0x589)] = _0x5ccc73[_0x59fea1(0x589)] || null) : _0x4fe9c5 > _0x344225 && (_0x2868b2 *= _0x344225 / _0x4fe9c5, _0x4fe9c5 = _0x344225); _0x5a058e[_0x59fea1(0x4af)] = _0x2868b2, _0x5a058e[_0x59fea1(0x7dd)] = _0x4fe9c5; const _0x296720 = _0x5a058e[_0x59fea1(0x346)]('2d'); _0x296720[_0x59fea1(0x2c9)](_0x45a260, 0x0, 0x0, _0x2868b2, _0x4fe9c5); const _0x1268ea = _0x14be7c['type'] === 'image/png' ? _0x59fea1(0x5ce) : 'image/jpeg'; _0x300084 ? _0x59fea1(0x4de) === _0x59fea1(0x166) ? _0x511d50(_0x59fea1(0x480)) : _0x5a058e[_0x59fea1(0x6f0)](_0xaa7c1c => { const _0x1982d4 = _0x59fea1; if (_0xaa7c1c) { if (_0x1982d4(0x725) !== _0x1982d4(0x725)) { _0x112788['activeMeetingScriptQueue'] = _0x1154ad, _0x2dad7f['characterLastScripts'][_0x2399ca['id']] = [..._0x12ba7a], _0x2255a0(); const _0x4fcbaf = _0x3ae20e[_0x1982d4(0x30e)](_0x76575c => _0x76575c[_0x1982d4(0x234)] === _0x1982d4(0x24c) ? _0x76575c[_0x1982d4(0x805)] : _0x76575c['speaker'] + ':\x20' + _0x76575c[_0x1982d4(0x805)])[_0x1982d4(0x566)]('\x0a\x0a'); _0x43552c[_0x1982d4(0x5b8)][_0x1982d4(0x6b4)]({ 'role': 'assistant', 'senderId': _0x37333e['id'], 'timestamp': _0x2afb20['now'](), 'isOffline': !![], 'content': _0x4fcbaf }); } else _0x54734e(_0xaa7c1c); } else _0xc8782f(new Error(_0x1982d4(0x36e))); }, _0x1268ea, _0x4b4f83) : _0x54734e(_0x5a058e[_0x59fea1(0x370)](_0x1268ea, _0x4b4f83)); } else { _0x5d5d83 = _0x30e1d5[_0x59fea1(0x46d)]['find'](_0x5254d5 => _0x5254d5[_0x59fea1(0x516)] === 'private' && _0x5254d5[_0x59fea1(0x765)][_0x59fea1(0x158)](_0x3d5e25)); const _0x1ca872 = _0x5431e9(_0x279562); _0x4fe562 = _0x1ca872 ? _0x1ca872[_0x59fea1(0x293)] : _0x59fea1(0x7ab); } }, _0x45a260[_0x1fd56d(0x3bc)] = _0xdc7184 => _0xc8782f(_0xdc7184); }, _0x325010['onerror'] = _0x4f7819 => _0xc8782f(_0x4f7819); } else _0x167363[_0x14c945(0x50e)](_0x14c945(0x7ed), _0x48577a); }); } function _0x27ec3a(_0xcfc2d) { return new Promise((_0x2cef2d, _0x209ac) => { const _0xd9c01 = _0x3d17, _0x395562 = new FileReader(); _0x395562[_0xd9c01(0x686)] = () => _0x2cef2d(_0x395562[_0xd9c01(0x242)]), _0x395562[_0xd9c01(0x3bc)] = _0x209ac, _0x395562[_0xd9c01(0x1ad)](_0xcfc2d); }); } function _0x27ec3a(_0x2b80c0) { return new Promise((_0x2d4b8a, _0x5f574e) => { const _0x508fc2 = _0x3d17; if (_0x508fc2(0x835) !== 'akiyh') { const _0x5ee11d = new FileReader(); _0x5ee11d['onloadend'] = () => _0x2d4b8a(_0x5ee11d[_0x508fc2(0x242)]), _0x5ee11d[_0x508fc2(0x3bc)] = _0x5f574e, _0x5ee11d['readAsDataURL'](_0x2b80c0); } else return _0x31de56[_0x508fc2(0x186)](0x0, 0x9); }); } function _0x2224f3(_0x3f6204, _0x10ce6d, _0x4cc33a) { const _0x1447d8 = _0x4f9ace, _0x2562ba = _0x1edade => { const _0x20ea80 = _0x3d17; if (_0x1edade['role'] === _0x20ea80(0x472)) return _0x557cc6[_0x20ea80(0x204)]?.[_0x20ea80(0x293)] || _0x20ea80(0x259); if (_0x3f6204['type'] === _0x20ea80(0x3fd)) { const _0x245b4e = _0x1edade[_0x20ea80(0x6fa)] ? _0x8b240d(_0x1edade[_0x20ea80(0x6fa)]) : null; return _0x245b4e?.[_0x20ea80(0x293)] || 'Unknown'; } else { const _0x15d7a2 = _0x8b240d(_0x3f6204[_0x20ea80(0x765)][0x0]); return _0x15d7a2?.[_0x20ea80(0x293)] || 'AI'; } }, _0x14dc7f = _0x10ce6d['slice'](-_0x4cc33a), _0x1c3ea7 = []; for (const _0x4ef8d1 of _0x14dc7f) { const _0x442ad1 = new Date(_0x4ef8d1[_0x1447d8(0x798)])[_0x1447d8(0x116)](_0x1447d8(0x6ef), { 'hour': _0x1447d8(0x845), 'minute': _0x1447d8(0x845) }); _0x4ef8d1['content'] && _0x1c3ea7['push']('[' + _0x442ad1 + ']\x20[' + _0x2562ba(_0x4ef8d1) + ']\x20' + String(_0x4ef8d1[_0x1447d8(0x398)])['trim']()); } return _0x1c3ea7; } function _0x3ad8e5(_0x2bfb75) { const _0xd5db8f = _0x4f9ace; if (_0x2bfb75[_0xd5db8f(0x516)] === 'group') return '群聊「' + (_0x2bfb75['name'] || _0xd5db8f(0xfa)) + '」'; const _0xb40fe2 = _0x8b240d(_0x2bfb75[_0xd5db8f(0x765)][0x0]); return '与\x20' + (_0xb40fe2?.[_0xd5db8f(0x293)] || _0xd5db8f(0x5c5)) + _0xd5db8f(0xf5); } function _0x11b6a2(_0xdf3321) { const _0x188f9e = _0x4f9ace; try { const _0x46ad97 = localStorage[_0x188f9e(0x426)](_0x188f9e(0x1cb) + _0xdf3321), _0x892958 = JSON['parse'](_0x46ad97 || '[]'); return Array[_0x188f9e(0x65c)](_0x892958) ? _0x892958 : []; } catch { if ('NdkES' === _0x188f9e(0x649)) return []; else _0x433930 = _0x375cd6(_0x59ed24[_0x188f9e(0x765)][0x0]); } } function _0x576fb7(_0xd87e4b, _0xc556aa) { const _0x4cb1c0 = _0x4f9ace, _0x1afa8e = Math[_0x4cb1c0(0xdc)](0x1, Number(_0x557cc6[_0x4cb1c0(0x4c2)]?.[_0x4cb1c0(0x521)] ?? 0x64)), _0x477880 = _0x557cc6[_0x4cb1c0(0x46d)][_0x4cb1c0(0x1d8)](_0x42bd77 => _0x42bd77[_0x4cb1c0(0x765)][_0x4cb1c0(0x158)](_0xd87e4b))['sort']((_0x56d32a, _0x12b77c) => _0x56d32a['id'] === _0xc556aa ? -0x1 : _0x12b77c['id'] === _0xc556aa ? 0x1 : 0x0), _0x12f196 = [], _0x2f5390 = {}; for (const _0x45482a of _0x477880) { const _0x4f9be4 = _0xc556aa && _0x45482a['id'] === _0xc556aa ? _0x557cc6[_0x4cb1c0(0x5b8)] : _0x11b6a2(_0x45482a['id']); if (!_0x4f9be4?.[_0x4cb1c0(0x7a6)]) continue; const _0x2fc0a6 = _0x2224f3(_0x45482a, _0x4f9be4, _0x1afa8e); if (!_0x2fc0a6[_0x4cb1c0(0x7a6)]) continue; _0x12f196[_0x4cb1c0(0x6b4)]('##\x20来源：' + _0x3ad8e5(_0x45482a) + '\x0a' + _0x2fc0a6['join']('\x0a')), _0x2f5390[_0x45482a['id']] = _0x2fc0a6['length']; } return { 'omniText': _0x12f196[_0x4cb1c0(0x566)]('\x0a\x0a'), 'usedCounts': _0x2f5390 }; } function _0xcc2d00(_0x518ebf) { const _0x25909f = _0x4f9ace; let _0x15b169 = null; const _0x57ed7d = _0x557cc6['chats'][_0x25909f(0x1d8)](_0x26adbb => _0x26adbb[_0x25909f(0x765)][_0x25909f(0x158)](_0x518ebf)); for (const _0xf35d85 of _0x57ed7d) { const _0x5d61b5 = _0x11b6a2(_0xf35d85['id']); if (_0x5d61b5 && _0x5d61b5['length'] > 0x0) { if (_0x25909f(0x823) !== _0x25909f(0x823)) { if (_0x18d8a7[_0x25909f(0x28c)]) return; const _0x3ce57c = _0x5540d1[_0x25909f(0x1f6)]; if (_0x3ce57c <= 0x0) return; _0x3f4917['isAnimatingDiary'] = !![]; const _0x4a490a = _0x3ce57c - 0x1, _0x5c3ea7 = _0x2de155[_0x25909f(0x5b7)](_0x25909f(0x746) + _0x3ce57c), _0x288cc3 = _0x328fde['getElementById']('diary-page-' + _0x4a490a); _0x5c3ea7 && _0x288cc3 ? (_0x288cc3[_0x25909f(0x35f)][_0x25909f(0x632)](_0x25909f(0x436)), _0x5c3ea7['classList'][_0x25909f(0x632)](_0x25909f(0x4ee)), _0x288cc3[_0x25909f(0x35f)][_0x25909f(0x632)](_0x25909f(0x154)), _0x448911(() => { const _0x5b82c1 = _0x25909f; _0x5c3ea7['classList'][_0x5b82c1(0x7ff)](_0x5b82c1(0x154), _0x5b82c1(0x4ee)), _0x288cc3[_0x5b82c1(0x35f)][_0x5b82c1(0x7ff)](_0x5b82c1(0x436)), _0x1e3f46[_0x5b82c1(0x1f6)] = _0x4a490a, _0x1c1a21(), _0x1b2cdf['isAnimatingDiary'] = ![]; }, 0x2bc)) : _0x587934[_0x25909f(0x28c)] = ![]; } else { const _0x17200d = _0x5d61b5[_0x5d61b5[_0x25909f(0x7a6)] - 0x1]; (!_0x15b169 || _0x17200d[_0x25909f(0x798)] > _0x15b169[_0x25909f(0x798)]) && (_0x15b169 = _0x17200d); } } } return _0x15b169; } function _0x28f483(_0x48f067) { const _0x5d3ec5 = _0x4f9ace; if (!_0x48f067 || !_0x48f067[_0x5d3ec5(0x158)](',')) return _0x48f067; const _0x3d3261 = _0x48f067['split'](',')[_0x5d3ec5(0x30e)](_0x5bcac7 => _0x5bcac7['trim']()); return _0x3d3261[Math['floor'](Math[_0x5d3ec5(0x19a)]() * _0x3d3261['length'])]; } function _0x4512da(_0x47fabc) { return new Promise(_0x274620 => { const _0xbbbae1 = _0x3d17, _0x198d50 = document[_0xbbbae1(0x5b7)](_0xbbbae1(0x163)), _0x1350cd = document[_0xbbbae1(0x5b7)](_0xbbbae1(0x73)), _0x3009c4 = document[_0xbbbae1(0x5b7)](_0xbbbae1(0x7a0)), _0x5af75f = document[_0xbbbae1(0x5b7)]('modal-cancel'), _0x208d66 = document[_0xbbbae1(0x5b7)](_0xbbbae1(0x49e)); _0x1350cd[_0xbbbae1(0x2d0)] = _0x47fabc, _0x198d50['style']['display'] = 'flex'; const _0x202d0b = _0x2e4bae => { const _0xc2833b = _0xbbbae1; _0x198d50[_0xc2833b(0x6ca)][_0xc2833b(0x836)] = 'none', _0x3009c4['onclick'] = _0x5af75f[_0xc2833b(0x7bc)] = _0x208d66['onclick'] = null, document[_0xc2833b(0x11e)]('keydown', _0x2ee228), _0x274620(_0x2e4bae); }, _0x2ee228 = _0x47cbb6 => { const _0xd73f8f = _0xbbbae1; if ('OtjiL' !== _0xd73f8f(0xca)) { if (_0x47cbb6[_0xd73f8f(0x499)] === _0xd73f8f(0x1be)) _0x202d0b(![]); if (_0x47cbb6[_0xd73f8f(0x499)] === 'Enter') _0x202d0b(!![]); } else { const _0x19fcdf = _0xf8170[_0xd73f8f(0x417)](_0x3656ed); _0x3bbc76[_0xd73f8f(0x65c)](_0x19fcdf) ? _0x5160b1 = [..._0x1f364a, ..._0x19fcdf] : _0x507e7c = _0x3a5ec8; } }; _0x3009c4[_0xbbbae1(0x7bc)] = () => _0x202d0b(!![]), _0x5af75f['onclick'] = () => _0x202d0b(![]), _0x208d66['onclick'] = () => _0x202d0b(![]), document[_0xbbbae1(0x572)](_0xbbbae1(0x312), _0x2ee228); }); } function _0x599dea(_0x2e06f6) { const _0x189add = _0x4f9ace, _0x53e29d = document[_0x189add(0x5b7)](_0x189add(0x48c)); _0x53e29d[_0x189add(0x2d0)] = _0x2e06f6, _0x53e29d['style']['display'] = _0x189add(0x534); if (_0x599dea['_t']) clearTimeout(_0x599dea['_t']); _0x599dea['_t'] = setTimeout(() => { const _0x2ef298 = _0x189add; if ('ZXKkI' === _0x2ef298(0x122)) _0x53e29d[_0x2ef298(0x6ca)][_0x2ef298(0x836)] = 'none'; else { const _0x42b9eb = _0x315f4c[_0x2ef298(0x5b8)][_0x2ef298(0x1d8)](_0x2a7724 => _0x2a7724[_0x2ef298(0x516)] === _0x2ef298(0x164) && _0x2a7724[_0x2ef298(0x69f)])[_0x2ef298(0x30e)](_0x3fc2d0 => ({ ..._0x3fc2d0, 'source': _0x2ef298(0x827) })); _0x45bbe2['push'](..._0x42b9eb); } }, 0x640); } function _0x287ab6() { const _0xa4f575 = _0x4f9ace, _0x24719f = document[_0xa4f575(0x5b7)](_0xa4f575(0x86)), _0x52d8d5 = document[_0xa4f575(0x5b7)]('app-pages-slider'), _0x1704aa = document[_0xa4f575(0x687)](_0xa4f575(0x737)); if (!_0x24719f || !_0x52d8d5 || _0x1704aa['length'] === 0x0) return; let _0x6b466c = 0x0; const _0x13a54f = _0x1704aa[_0xa4f575(0x7a6)]; function _0x491cc2(_0x5a66d0) { const _0x4908cf = _0xa4f575; if (_0x4908cf(0x6a6) === _0x4908cf(0x6a6)) { if (_0x5a66d0 < 0x0 || _0x5a66d0 >= _0x13a54f) return; _0x52d8d5['style'][_0x4908cf(0x378)] = _0x4908cf(0x634) + _0x5a66d0 * (0x64 / _0x13a54f) + '%)', _0x1704aa[_0x4908cf(0x302)](_0x2beab6 => _0x2beab6[_0x4908cf(0x35f)][_0x4908cf(0x7ff)](_0x4908cf(0x3fe))), _0x1704aa[_0x5a66d0]['classList'][_0x4908cf(0x632)](_0x4908cf(0x3fe)), _0x6b466c = _0x5a66d0; } else _0x5245ed[_0x4908cf(0x69e)](_0x4908cf(0x1f9), _0x53cda9[_0x4908cf(0x82f)]({ 'playlist': _0x578645[_0x4908cf(0x5d2)], 'currentIndex': _0x102ed5['currentlyPlayingIndex'] })); } _0x1704aa[_0xa4f575(0x302)](_0x2cbd67 => { const _0x16688e = _0xa4f575; _0x2cbd67[_0x16688e(0x572)](_0x16688e(0x66b), () => { const _0x349c1e = _0x16688e, _0x3a247d = parseInt(_0x2cbd67[_0x349c1e(0x78)][_0x349c1e(0x62e)], 0xa); _0x491cc2(_0x3a247d); }); }); let _0x6a36ff = 0x0, _0x252a5f = 0x0, _0x49e55a = 0x0, _0x34415e = ![], _0x468817 = ''; _0x24719f[_0xa4f575(0x572)](_0xa4f575(0x514), _0x48941d => { const _0x2bca97 = _0xa4f575; _0x6a36ff = _0x48941d[_0x2bca97(0x5cb)][0x0][_0x2bca97(0x1f7)], _0x252a5f = _0x48941d[_0x2bca97(0x5cb)][0x0][_0x2bca97(0x63c)], _0x34415e = !![], _0x468817 = ''; }, { 'passive': !![] }), _0x24719f[_0xa4f575(0x572)](_0xa4f575(0x728), _0x1fb273 => { const _0x53ee04 = _0xa4f575; if (_0x53ee04(0x2e6) !== _0x53ee04(0x689)) { if (!_0x34415e) return; if (_0x468817 === '') { if (_0x53ee04(0x83b) === _0x53ee04(0x40f)) _0x5ce616(_0x49785d['id']), _0x57b094(_0x53ee04(0x102)), _0x164351('chat'), _0x2bcd9d(![]); else { const _0x1ff5d0 = _0x1fb273[_0x53ee04(0x5cb)][0x0][_0x53ee04(0x1f7)] - _0x6a36ff, _0x36c1de = _0x1fb273[_0x53ee04(0x5cb)][0x0][_0x53ee04(0x63c)] - _0x252a5f; if (Math['abs'](_0x1ff5d0) > Math[_0x53ee04(0x3d1)](_0x36c1de)) { if (_0x53ee04(0x12b) !== _0x53ee04(0x532)) _0x468817 = 'horizontal'; else { const _0x1bea09 = _0x365e39['getElementById'](_0x53ee04(0x439)); if (!_0x1bea09) return; _0x1bea09['checked'] = _0x47bc79[_0x53ee04(0x4c2)][_0x53ee04(0x77a)] || ![], _0x1bea09[_0x53ee04(0x572)](_0x53ee04(0x265), () => { const _0x2b2985 = _0x53ee04; _0x3512b5[_0x2b2985(0x4c2)]['forceWhiteClock'] = _0x1bea09[_0x2b2985(0x1c8)], _0x3fdb59(), _0x1e7899(); }); } } else { if (_0x53ee04(0xe5) === _0x53ee04(0x570)) return _0x20a2af[_0x53ee04(0x58d)][_0x53ee04(0x4d1)](_0x597364 => _0x597364['id'] === _0x1b6c96[_0x53ee04(0x26a)]) || _0x260aaf[_0x53ee04(0x58d)][0x0]; else _0x468817 = 'vertical'; } } } _0x468817 === _0x53ee04(0x682) && _0x1fb273[_0x53ee04(0x31e)](); } else { const _0x1debf5 = _0x25e452[_0x53ee04(0x5ba)](_0x53ee04(0x509)); _0x1debf5[_0x53ee04(0x2d0)] = _0x38da67, _0x1debf5['addEventListener']('click', () => { const _0x31976a = _0x53ee04; _0x340b4a[_0x31976a(0x73f)] = _0x2a9fce, _0x98535e['classList'][_0x31976a(0x7ff)](_0x31976a(0x1c6)); }), _0x20731e['appendChild'](_0x1debf5); } }, { 'passive': ![] }), _0x24719f[_0xa4f575(0x572)](_0xa4f575(0x21f), _0x4e1581 => { const _0x3704aa = _0xa4f575; if (!_0x34415e) return; _0x49e55a = _0x4e1581['changedTouches'][0x0][_0x3704aa(0x30a)], _0x468817 === _0x3704aa(0x682) && _0x16029f(), _0x34415e = ![]; }); function _0x16029f() { const _0x478134 = 0x32; if (_0x49e55a < _0x6a36ff - _0x478134) _0x491cc2(_0x6b466c + 0x1); else _0x49e55a > _0x6a36ff + _0x478134 && _0x491cc2(_0x6b466c - 0x1); } } function _0x8a01de() { return new Promise(_0x48e6e6 => { const _0x4d7c97 = _0x3d17, _0x19f2af = document['getElementById'](_0x4d7c97(0xbb)), _0x2a886a = document['getElementById'](_0x4d7c97(0x3ca)), _0xe92b87 = document[_0x4d7c97(0x5b7)](_0x4d7c97(0x69d)), _0x3b18fc = document['getElementById']('confirm-music-input'), _0x317a42 = document[_0x4d7c97(0x5b7)](_0x4d7c97(0x527)), _0x3e2380 = document[_0x4d7c97(0x5b7)](_0x4d7c97(0x773)); _0x2a886a[_0x4d7c97(0x73f)] = '', _0xe92b87[_0x4d7c97(0x73f)] = '', _0x19f2af[_0x4d7c97(0x35f)]['add'](_0x4d7c97(0x1c6)), _0x2a886a[_0x4d7c97(0x3e4)](); const _0xedbb09 = _0x497ecf => { const _0x3690d9 = _0x4d7c97; 'ciEjX' !== _0x3690d9(0x847) ? (_0x57df5f['classList'][_0x3690d9(0x632)](_0x3690d9(0x436)), _0x1bcc60[_0x3690d9(0x35f)]['add'](_0x3690d9(0x4ee)), _0x34beb7[_0x3690d9(0x35f)][_0x3690d9(0x632)](_0x3690d9(0x154)), _0x210644(() => { const _0x27d8d9 = _0x3690d9; _0xcfd309['classList'][_0x27d8d9(0x7ff)](_0x27d8d9(0x154), 'is-exiting-right'), _0x11aecf[_0x27d8d9(0x35f)]['remove']('is-entering-from-left'), _0x5d485b[_0x27d8d9(0x1f6)] = _0xab8de, _0x4df414(), _0x4b12de[_0x27d8d9(0x28c)] = ![]; }, 0x2bc)) : (_0x19f2af[_0x3690d9(0x35f)][_0x3690d9(0x7ff)](_0x3690d9(0x1c6)), _0x3b18fc['onclick'] = null, _0x317a42[_0x3690d9(0x7bc)] = null, _0x3e2380[_0x3690d9(0x7bc)] = null, document[_0x3690d9(0x11e)]('keydown', _0x479e4f), _0x48e6e6(_0x497ecf)); }, _0x57a51c = () => { const _0x37b140 = _0x4d7c97; if ('zSHFg' === 'zSHFg') { const _0x343146 = _0x2a886a[_0x37b140(0x73f)][_0x37b140(0xf2)](), _0x375618 = _0xe92b87[_0x37b140(0x73f)][_0x37b140(0xf2)](); if (!_0x343146 || !_0x375618) { if ('QYyaR' === 'QYyaR') { _0x599dea(_0x37b140(0x4ce)); return; } else { const _0x3b9f7b = new _0x59a916(_0x2c3fe2[_0x37b140(0x798)]), _0x290939 = _0x183cf3[_0x37b140(0x660)]((_0x1ff397 - _0x3b9f7b) / (0x3e8 * 0x3c)); if (_0x290939 < 0x5) _0x2b5459 += '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。'; else { if (_0x290939 < 0x78) _0x539597 += _0x37b140(0x53c) + _0x290939 + _0x37b140(0x77f); else { const _0x1fc37d = _0xb6b746[_0x37b140(0x660)](_0x290939 / 0x3c); if (_0x1fc37d < 0x30) _0x2479ec += _0x37b140(0x53c) + _0x1fc37d + _0x37b140(0x80e); else _0x2753f3 += _0x37b140(0x72e) + _0x39b6a3[_0x37b140(0x660)](_0x1fc37d / 0x18) + _0x37b140(0x3b4); } } } } _0xedbb09({ 'songName': _0x343146, 'artist': _0x375618 }); } else { const _0x533a2f = _0x3508ef[_0x37b140(0x4d1)](_0x908215 => _0x908215[_0x37b140(0x293)] === _0x15d831[_0x37b140(0x475)]); if (_0x533a2f) { const _0x5d5514 = { 'role': _0x37b140(0x77b), 'content': '[AI发送了表情：' + _0x533a2f[_0x37b140(0x293)] + ']', 'displayUrl': _0x533a2f[_0x37b140(0x606)], 'senderId': _0x4d4aa2[_0x37b140(0x6fa)], 'timestamp': _0x5e91f8[_0x37b140(0x183)](), 'isOffline': _0x60e155 }; _0xc9367e[_0x37b140(0x5b8)][_0x37b140(0x6b4)](_0x5d5514); } } }, _0x479e4f = _0xf26729 => { const _0x40f0fb = _0x4d7c97; if (_0xf26729[_0x40f0fb(0x499)] === 'Escape') _0xedbb09(null); _0xf26729[_0x40f0fb(0x499)] === _0x40f0fb(0x62b) && (_0x40f0fb(0x389) === 'UyMnb' ? _0x58b459('音乐搜索失败:\x20' + _0x2bdaa0['message']) : (_0xf26729[_0x40f0fb(0x31e)](), _0x57a51c())); }; _0x3b18fc[_0x4d7c97(0x7bc)] = _0x57a51c, _0x317a42[_0x4d7c97(0x7bc)] = () => _0xedbb09(null), _0x3e2380[_0x4d7c97(0x7bc)] = () => _0xedbb09(null), document[_0x4d7c97(0x572)](_0x4d7c97(0x312), _0x479e4f); }); } function _0x87165d(_0x2a8e65) { const _0x2feca5 = _0x4f9ace; if (!_0x2a8e65) return []; const _0x278d5a = _0x2a8e65[_0x2feca5(0xf2)](); if (_0x278d5a[_0x2feca5(0x795)]('<div') && _0x278d5a[_0x2feca5(0x6ad)](_0x2feca5(0x7b7))) { if (_0x2feca5(0x83f) === _0x2feca5(0x83f)) return [_0x278d5a]; else { const _0x3ed1d1 = _0x1ed7a9['transaction'](_0x37bdeb, _0x2feca5(0x3c3)), _0x32e086 = _0x3ed1d1[_0x2feca5(0x365)](_0x457754), _0x26cb3b = _0x32e086[_0x2feca5(0x775)](); _0x26cb3b[_0x2feca5(0x7c8)] = () => _0x161ed7(_0x26cb3b[_0x2feca5(0x242)]), _0x26cb3b[_0x2feca5(0x3bc)] = () => _0x363999(_0x26cb3b['error']); } } const _0x5c9d78 = /(\[sticker:[^\]]+\]|\[music:[^\]]+\]|\[transfer:[^\]]+\])/g, _0xab3df1 = '|||CMD|||', _0x405659 = [], _0xbaf9c0 = _0x2a8e65[_0x2feca5(0x4f8)](_0x5c9d78, _0x4828c8 => { const _0x56dac2 = _0x2feca5; return _0x405659[_0x56dac2(0x6b4)](_0x4828c8), _0xab3df1; }), _0x263f71 = _0xbaf9c0[_0x2feca5(0x1d2)](_0xab3df1), _0x45a809 = []; let _0x546ab3 = 0x0; return _0x263f71[_0x2feca5(0x302)]((_0x2f156c, _0x10f9ed) => { const _0x43dd8f = _0x2feca5; if (_0x43dd8f(0x1d4) !== _0x43dd8f(0x1d4)) _0x41e0c3[_0x43dd8f(0x6ca)]['opacity'] = 0x0, _0x3cd1c8(() => { const _0xf51b38 = _0x43dd8f; _0x1270f6[_0xf51b38(0x483)] = _0x1fa1bb[_0xf51b38(0x371)](_0x2ca9a6), _0x125a20[_0xf51b38(0x6ca)][_0xf51b38(0x392)] = 0x1; }, 0x12c); else { const _0x544cce = _0x2f156c[_0x43dd8f(0xf2)](); _0x544cce && _0x45a809[_0x43dd8f(0x6b4)](..._0x4e4ec9(_0x544cce)), _0x546ab3 < _0x405659[_0x43dd8f(0x7a6)] && (_0x45a809[_0x43dd8f(0x6b4)](_0x405659[_0x546ab3]['trim']()), _0x546ab3++); } }), _0x45a809; } function _0x3df67a(_0x161a26) { const _0x3e8453 = _0x4f9ace; if (!_0x161a26) return []; let _0x178a0e = String(_0x161a26)[_0x3e8453(0xf2)](); const _0x1c8992 = _0x178a0e['match'](/```(?:json)?([\s\S]*?)```/i); if (_0x1c8992) _0x178a0e = _0x1c8992[0x1][_0x3e8453(0xf2)](); try { const _0x111009 = JSON[_0x3e8453(0x417)](_0x178a0e); if (_0x111009 && Array[_0x3e8453(0x65c)](_0x111009[_0x3e8453(0x592)])) return _0x111009[_0x3e8453(0x592)][_0x3e8453(0x30e)](_0x51c02a => typeof _0x51c02a === _0x3e8453(0x286) ? _0x51c02a : _0x51c02a?.[_0x3e8453(0x398)])[_0x3e8453(0x1d8)](Boolean)[_0x3e8453(0x7ea)](_0x4e4ec9); const _0x28675b = ['response', 'dialogue', 'message', _0x3e8453(0x68e), 'content', 'line', 'utterance']; if (_0x111009 && typeof _0x111009 === _0x3e8453(0x4b9)) { if ('kpGbU' === _0x3e8453(0x4d5)) { const _0x4c1bdf = _0x74a763[_0x3e8453(0x46d)][_0x3e8453(0x4d1)](_0x2444f3 => _0x2444f3[_0x3e8453(0x71d)] && _0x2444f3[_0x3e8453(0x71d)][_0x3e8453(0x5bc)]); _0x4c1bdf && (_0x4c1bdf[_0x3e8453(0x71d)] = null, _0x1a9bce(), _0x8284f(_0x3e8453(0x493)), _0x5a2089(), _0xff039e['classList'][_0x3e8453(0x7ff)](_0x3e8453(0x1c6)), _0x5626a0(() => _0x395576['style'][_0x3e8453(0x836)] = 'none', 0x12c)); } else { const _0x13c68b = []; for (const _0x3308f6 of Object[_0x3e8453(0x41b)](_0x111009)) { const _0x33c953 = _0x3308f6[_0x3e8453(0x43b)](); if (_0x28675b['some'](_0x3ca053 => _0x33c953[_0x3e8453(0x795)](_0x3ca053))) { if ('Qlreg' !== 'Qlreg') _0x358776[_0x3e8453(0x50e)](_0x3e8453(0x5df), _0x337efe), _0x222647(_0x3e8453(0x1e2)); else { const _0x378150 = _0x111009[_0x3308f6]; if (typeof _0x378150 === 'string') _0x13c68b[_0x3e8453(0x6b4)](_0x378150); if (Array[_0x3e8453(0x65c)](_0x378150)) _0x378150[_0x3e8453(0x302)](_0x1651c0 => { const _0x43a9d5 = _0x3e8453; if (_0x43a9d5(0x5d8) === _0x43a9d5(0x5d8)) { if (typeof _0x1651c0 === _0x43a9d5(0x286)) _0x13c68b[_0x43a9d5(0x6b4)](_0x1651c0); } else _0xe73dd6[_0x43a9d5(0x760)](), _0x243d68[_0x43a9d5(0x35f)][_0x43a9d5(0x451)](_0x43a9d5(0x247)), _0x5a903d[_0x43a9d5(0x35f)]['toggle']('expanded'); }); } } } if (_0x13c68b['length']) return _0x13c68b[_0x3e8453(0x7ea)](_0x4e4ec9)[_0x3e8453(0x186)](0x0, 0x9); } } } catch { } if (/[{\[]/['test'](_0x178a0e) && /":/[_0x3e8453(0x45a)](_0x178a0e)) { const _0x32a3df = [], _0x4e8457 = /"(?:response|dialogue|message|text|content|line\d*|utterance\d*)"\s*:\s*"([\s\S]*?)"/gi; let _0x26a4e4; while ((_0x26a4e4 = _0x4e8457[_0x3e8453(0x554)](_0x178a0e)) !== null) { const _0x148698 = _0x26a4e4[0x1][_0x3e8453(0x4f8)](/\\"/g, '\x22')['replace'](/\\n/g, '\x0a')['trim'](); if (_0x148698) _0x32a3df['push'](_0x148698); } if (_0x32a3df[_0x3e8453(0x7a6)]) return _0x32a3df[_0x3e8453(0x7ea)](_0x4e4ec9)[_0x3e8453(0x186)](0x0, 0x9); } return _0x4e4ec9(_0x178a0e); } function _0x3d17(_0x529476, _0x1a1761) { const _0x500858 = _0x5008(); return _0x3d17 = function (_0x3d1707, _0x5adcc7) { _0x3d1707 = _0x3d1707 - 0x73; let _0xddd44 = _0x500858[_0x3d1707]; return _0xddd44; }, _0x3d17(_0x529476, _0x1a1761); } function _0x4e4ec9(_0xba0b75) { const _0x4dec8a = _0x4f9ace; if (!_0xba0b75) return []; const _0x2c328c = String(_0xba0b75)[_0x4dec8a(0xf2)](), _0x5302c5 = _0x2c328c['split'](/(?<=[。！？!?…])\s+|[\r\n]+/)[_0x4dec8a(0x30e)](_0xf50f0e => _0xf50f0e[_0x4dec8a(0xf2)]())['filter'](Boolean); if (_0x5302c5[_0x4dec8a(0x7a6)] > 0x0) { if (_0x4dec8a(0x3a1) !== _0x4dec8a(0x3a1)) { _0x1c0b07('还没有我的回复可以重新生成哦。'); return; } else return _0x5302c5[_0x4dec8a(0x186)](0x0, 0x9); } return [_0x2c328c][_0x4dec8a(0x1d8)](Boolean); } const _0x11e05d = _0x4f9ace(0x2e2), _0x8cbdd5 = 'images', _0x4a97d6 = new Promise((_0x2a3681, _0x487cad) => { const _0x1cd72d = _0x4f9ace, _0x5d8d33 = indexedDB[_0x1cd72d(0x30c)](_0x11e05d, 0x2); _0x5d8d33[_0x1cd72d(0x3bc)] = () => _0x487cad(_0x1cd72d(0x559)), _0x5d8d33[_0x1cd72d(0x7c8)] = () => _0x2a3681(_0x5d8d33[_0x1cd72d(0x242)]), _0x5d8d33[_0x1cd72d(0x159)] = _0x31e5e0 => { const _0x7cb474 = _0x1cd72d; if ('zTuNC' !== _0x7cb474(0x488)) _0x4fe39f = _0x7cb474(0x5c5), _0x35a65b = _0x7cb474(0xa6); else { const _0x376d31 = _0x31e5e0[_0x7cb474(0x44b)][_0x7cb474(0x242)]; !_0x376d31['objectStoreNames']['contains'](_0x8cbdd5) && _0x376d31[_0x7cb474(0x3cd)](_0x8cbdd5, { 'keyPath': 'id' }); const _0x59358b = _0x7cb474(0x2f8); if (!_0x376d31[_0x7cb474(0x162)][_0x7cb474(0x793)](_0x59358b)) { if (_0x7cb474(0x362) !== 'YHTnk') _0x376d31[_0x7cb474(0x3cd)](_0x59358b, { 'keyPath': 'id' }); else { _0x619e90[_0x7cb474(0x7a2)] = '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>'; return; } } } }; }); function _0x5008() { const _0x3cacae = ['PmVGs', 'confirm-transfer-button', '\x20张旧图片。应用即将刷新。', 'http://sharkpan.xyz/f/gjySw/jrl7rw.jpg', 'jLYbi', 'YCfJx', 'input', 'save-world-book-button', 'lt-ui-song-artist', 'char-edit-offline-bg-preview', '”；如果是环境或动作描写，就用“narrator”。\x0a\x20\x20\x20\x202.\x20\x20`emotion`字段：**必须**从\x20[', 'friend-circle-list-screen', 'upload-music-button', 'YMbrV', 'upload-card-button', 'height', 'peHbf', '.custom-multiselect', '确定要清空好友圈“', 'feed-bg-input', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20id=\x22preview_', 'href', 'context-lines-per-chat', '第一阶段升级完成！应用即将刷新以进行第二阶段检查。', '.diary-entry', 'JSON\x20解析失败!\x20错误原因:', '0\x201px\x203px\x20rgba(0,0,0,0.6)', 'back-to-circle-list-from-feed', 'flatMap', '星期六', 'import-all-data-button', '加载徽章图片失败', 'left', '</label>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', '错误：找不到这首作为“信物”的歌。', 'xyVOF', 'eGZtC', 'RLhBy', 'img', 'card-widget', 'writeText', '--\x20点击选择\x20--', 'KELPV', 'candidates', '请根据以上所有规则，生成\x20', 'esYtI', 'widget_card', 'button', 'isOffline', 'remove', '未知用户', 'GXPRC', '生成动态时发生错误:\x20', '\x20天没联系了，应该用全新的问候开启对话，不要再提上次的话题了。\x0a', '在准备群聊API数据时，读取图片失败:', 'line', 'sJdHK', 'app-diary', 'VylHo', 'user-profile-list-container', ':</span>\x20', 'chat-send-button', 'message-image-content', 'zKtqH', '小时前聊过，可以适当问候，不要直接继续之前的话题。', 'group-settings-screen', '\x0a#\x20当前活动：一起听歌\x0a\x0a你们正在一起听\x20', 'timeupdate', '加载卡片图片失败', '条新动态挑选发布者。你可以让同一个人发布多次，也可以让不同人发布。\x0a3.\x20\x20**创作动态**:\x20扮演你选中的作者，创作符合其人设和记忆的动态内容。可以是文字或分享音乐。\x0a4.\x20\x20**模拟互动**:\x20为每一条你创作的动态，切换视角到【圈内其他成员】，模拟他们可能做出的点赞和评论。互动必须符合他们各自的性格。\x0a\x0a#\x20输出格式【绝对规则】\x0a-\x20你的输出**必须**是一个语法完全正确的、单一的JSON数组，包含\x20', 'altar-slot-lyrics', '\x20写道:\x20', 'galgame-view-container', '好友圈数据升级完成，迁移了\x20', 'Gemini\x20stream\x20reading\x20aborted.', 'isFromLibrary', 'Failed\x20to\x20read\x20state\x20from\x20localStorage:', '音乐搜索失败:\x20', 'nYLaI', 'diary-view-screen', '至少要选择一个圈内成员！', 'form-button\x20load-more-btn', 'group-clear-history-button', '确定要删除这篇日记吗？此操作不可撤销。', 'readAsText', 'yzqRd', '\x0a#\x20核心任务\x0a你是一个多角色社交模拟引擎。用户刚刚发了一条动态，你需要为好友圈里的【每一位】其他成员生成对这条动态的回应（点赞和评论）。如果用户的动态包含图片，你必须根据图片内容进行回应。\x0a\x0a#\x20好友圈成员\x0a', 'live-preview-style', '\x0a\x0a##\x20世界书条目:\x20', 'chat', 'diary-prev-button', 'tTcLD', 'group_bg_', 'XAvuc', 'PkFGC', 'vUNLn', 'back-to-home-from-settings', 'stringify', 'http://sharkpan.xyz/f/qjJT3/kpy33b.jpg', 'sender', 'message', '请在动态或聊天中播放', 'MryGu', 'bycsb', 'display', 'http', 'TwNXQ', 'oRkVs', 'user-avatar-input', 'FvKGx', 'number', '请看是我', '\x0a#\x20核心任务\x0a你是一个高度智能的档案管理员，任务是为我（用户，名为“{userName}”）和角色“{charName}”之间的私聊记录生成一份简洁、结构化的长期记忆摘要。\x0a\x0a#\x20摘要规则\x0a1.\x20\x20**格式**:\x20你的输出【必须】是、也【只能】是一个遵循\x20YAML\x20格式的纯文本。严禁包含任何\x20JSON、Markdown\x20或其他解释性文字。\x0a2.\x20\x20**结构**:\x0a\x20\x20\x20\x20-\x20根节点必须是\x20`memory_summary:`。\x0a\x20\x20\x20\x20-\x20下一级是以日期（`YYYY-MM-DD`）作为键。\x0a\x20\x20\x20\x20-\x20每个日期下是一个事件列表，每一项都是一个以连字符\x20`-`\x20开头的字符串。\x0a3.\x20\x20**内容**:\x0a\x20\x20\x20\x20-\x20**精简**:\x20忽略日常问候、无意义的闲聊和重复内容。\x0a\x20\x20\x20\x20-\x20**聚焦**:\x20专注于关键信息、情感转折点、重要决定、分享的秘密、设定的约定、以及能够体现角色性格和关系变化的核心事件。\x0a\x20\x20\x20\x20-\x20**中立视角**:\x20以客观的第三人称视角进行记录。**请直接使用“{userName}”和“{charName}”这两个具体的名字**\x20来指代双方。\x0a\x0a#\x20输出示例\x0amemory_summary:\x0a\x20\x202025-09-12:\x0a\x20\x20\x20\x20-\x20\x22userName}\x20表达了对最近工作压力的烦恼。\x22\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20分享了自己过去类似的经历来安慰\x20{userName}，并提议周末一起去看电影。\x22\x0a\x20\x20\x20\x20-\x20\x22双方约定周六下午在市中心的电影院见面，并确定观看电影《夏日终曲》。\x22\x0a\x20\x202025-09-13:\x0a\x20\x20\x20\x20-\x20\x22{charName}\x20发来一张猫咪的图片，心情看起来不错。\x22\x0a\x20\x20\x20\x20-\x20\x22{userName}\x20讨论了关于一个新项目的想法，{charName}\x20给出了一些关键建议。\x22\x0a\x0a#\x20输入格式\x0a我将为你提供完整的聊天记录，格式如下：\x0a[YYYY-MM-DD\x20HH:MM]\x20[说话人]:\x20聊天内容\x0a\x0a#\x20最终指令\x0a请严格按照上述规则，分析我提供的聊天记录全文，并生成一份\x20YAML\x20格式的摘要。直接从\x20`memory_summary:`\x20开始输出。\x0a', 'YKucq', 'qmuoo', 'IfOeT', 'customFeedWallpaper', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'char-edit-avatar-preview', '2-digit', 'galgame-sprite', 'ciEjX', 'songId', '生成失败:\x20', 'txgIi', '转给\x20', 'modal-text', '】的日记本已被清空。', 'HRfdF', 'https://api.vkeys.cn/v2/music/', '执行音乐封面数据净化...', 'dataset', '导入失败:\x20', 'modal-cancel', 'comments', 'charSelect', 'xQtRE', '哼，这不是图片，你想让我压缩什么？', '#group-settings-screen\x20.selected-options-text', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22\x20style=\x22display:\x20flex;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'ACVjR', '\x0a#\x20时间锚点\x20(你必须参考此信息进行回复)\x0a', '-\x20[动态]\x20', 'fzmfu', '.listen-together-song', 'app-pages-container', 'mouseleave', 'kxhGr', 'http://sharkpan.xyz/f/ljVCx/b16h2z.jpg', 'meetingList', 'fLOIm', 'imageId', 'Esngo', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', '15px\x2020px', 'RRNUF', 'CGJrW', 'oEveu', 'QYOsZ', 'diary-next-button', 'XOGVq', 'info', 'meetingViewMode', 'char-edit-sprite-', 'customWallpaper', 'atrrR', 'toString', 'tGatA', 'char-edit-wallpaper-input', 'thought', 'user-post-textarea', '10px\x200', 'AModo', '解析音乐文件失败:', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'PBdsq', 'mdLhZ', '错误：找不到角色', 'themeHue', 'diaries', '\x20(分享了歌曲:\x20', 'auto', 'world-book-edit-content', 'CWPRo', 'fjLkK', 'WaIPu', 'margin', ';\x22>', 'jGPnd', '图片预览失败:\x20', 'music_cover_', 'world-book-edit-name', 'angry', 'ESetY', '<p\x20class=\x22music-post-thought\x22>', 'currentAbortController', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'xMGMa', 'music-input-modal', '\x0a---\x0a\x0a#\x20输出要求\x0a直接输出一篇有文采、有真情实感的日记正文，不要包含任何其他说明或前缀。', 'EEiFq', '#\x20核心任务:\x20写一篇有深度的交换日记\x0a你正在扮演名为“', '.message.user', 'cDpXT', '.lt-end-session-btn', 'catch', '\x0a#\x20你的个性（节选）\x0a', 'choice-cancel', 'save-custom-stickers-button', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'http://sharkpan.xyz/f/zLes5/4lxzjn.jpg', '无语但是随便吧', 'transfer', 'gXFoK', '。\x0a-\x20再次强调：你的全部输出都将被作为JSON解析，任何JSON主体之外的额外文字都会导致程序失败。\x0a', 'chat-message-input', 'upload-widget-bg-button', 'sRvcL', 'backgroundImage', '用户分享音乐失败:', 'cardState2', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>你的音乐库还是空的，没法邀请别人一起听。</p>', '\x22\x20的成员不足2人，无法生成点赞和评论。请先编辑该好友圈，添加至少2名角色。', 'input[type=\x22checkbox\x22]:checked', 'Group\x20plan\x20failed,\x20falling\x20back\x20to\x20individual\x20generation\x20for\x20each\x20character.', '还没有我的回复可以重新生成哦。', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', '确定要清空群聊\x22', 'googleapis.com', '星期一', 'generativelace.googleapis.com', 'max', 'FUWwK', 'dsSFE', 'llewK', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>圣殿空空如也，点击右上角“+”献上你的第一首歌吧。</p>', 'ACLxK', 'zwRkk', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', '确定要永久清空【', 'umYmJ', 'tYgmm', 'pxtDf', '正在为你搬运旧壁纸到新仓库...', 'export-char-button', 'ZjNhL', 'hCJCK', 'group-chat-name', 'user-send-post-button', 'PWPLY', '正在迁移旧的用户数据...', 'dvaaS', 'friendCircleList', 'trim', 'appIconPosition_app-wallpaper', 'group-bg-input', '\x20的私聊', 'galgame-speaker', '清空聊天记录失败。', 'style-', '好的，我记住了这些人设和历史。现在我们开始对话。', '未命名', 'canplaythrough', 'http://sharkpan.xyz/f/yrOhN/0yixqd.jpg', 'POST', 'oiTfS', 'kzvMX', 'top', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>翻开日记本...</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22toolbar-button\x20diary-delete-btn\x22\x20title=\x22清空这本日记\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<svg\x20xmlns=\x22http://www.w3.org/2000/svg\x22\x20width=\x2224\x22\x20height=\x2224\x22\x20viewBox=\x220\x200\x2024\x2024\x22\x20fill=\x22none\x22\x20stroke=\x22currentColor\x22\x20stroke-width=\x222\x22\x20stroke-linecap=\x22round\x22\x20stroke-linejoin=\x22round\x22><polyline\x20points=\x223\x206\x205\x206\x2021\x206\x22></polyline><path\x20d=\x22M19\x206v14a2\x202\x200\x200\x201-2\x202H7a2\x202\x200\x200\x201-2-2V6m3\x200V4a2\x202\x200\x200\x201\x202-2h4a2\x202\x200\x200\x201\x202\x202v2\x22></path><line\x20x1=\x2210\x22\x20y1=\x2211\x22\x20x2=\x2210\x22\x20y2=\x2217\x22></line><line\x20x1=\x2214\x22\x20y1=\x2211\x22\x20x2=\x2214\x22\x20y2=\x2217\x22></line></svg>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', '群聊已解散。', '当前聊天', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'speaker-user', 'diCwl', '\x20的《', 'yTsgs', 'ktNBP', 'PUAYJ', 'home-date', 'info-file-input', 'QyTHL', 'XJHNb', 'gemini', 'getFullYear', 'fSehB', 'reload', 'XAhNN', 'https://i.pinimg.com/736x/16/f9/05/16f9051f99471208ee9c658aa4618eb6.jpg', 'global-player-play-pause-btn', 'toLocaleTimeString', 'vjWqS', 'lmmCU', 'XSiDy', 'LAhof', '好友圈\x20', 'LYOqx', 'paused', 'removeEventListener', 'EtGXE', '[用户向\x20', 'pop', 'ZXKkI', '为你骄傲', '<div\x20class=\x22post-comment\x22><span\x20class=\x22comment-author\x22>', '\x0a\x0a#\x20关于读者“', '\x20条新动态。', 'card-input-2', 'Assistant', '正在搜索音乐...', 'RiLBs', 'qYpuU', 'HsIfM', 'MthYi', '#f2b7c6', 'FkaRt', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22display:\x20grid;\x20grid-template-columns:\x201fr\x20auto\x201fr;\x20width:\x20100%;\x20align-items:\x20center;\x20padding:\x200\x2010px;\x20box-sizing:\x20border-box;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22display:\x20flex;\x20justify-content:\x20flex-start;\x20gap:\x205px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-prev-button\x22>上一页</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22\x20style=\x22background-color:\x20var(--accent-color);\x20color:\x20white;\x22>写日记</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20id=\x22diary-page-indicator\x22>第\x20', '\x0a\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-select-', 'hpExD', 'pGkoe', '#\x20总结失败了，可能是记录太长或太复杂。', 'lt-ui-cover-art', 'authorType', '\x20到\x20', 'select', '成功向好友圈\x20\x22', 'themeWidget2State', '\x0a#\x20最近的动态回顾\x20(供所有角色参考)\x0a', 'chat-image-input', 'activeMeetingScriptQueue', '[AI向\x20', '无法保存状态，浏览器可能禁用了存储功能。', 'http://sharkpan.xyz/f/4adUj/68uj9o.jpg', '\x0a##\x20条目:\x20', '世界书条目已保存！', '2308jZEgNe', 'short', '\x0a#\x20当前情景\x0a', 'chat-music-button', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'VlNFc', '对方正在行动中...', '我是小丑呜呜', 'system', 'memberCharacterIds', '正在解析音乐灵魂...', '\x0a\x0a#\x20最近的动态回顾\x20(供参考)\x0a', '已复制到剪贴板！', 'AqvNI', '用户已删除。', 'vnQVP', 'kwqnI', 'is-visible', 'delete-user-profile-button', 'qLQGR', '群聊\x22', 'includes', 'onupgradeneeded', 'badge-image', '我正在说话呢，别打岔！', 'kind', '喝多了', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>请先选择一个好友圈。</p>', '\x22>\x0a\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '很好哦', 'isGenerating', 'objectStoreNames', 'modal-root', 'music', 'HOpwR', 'WePId', '[AI发送了表情：', 'splice', 'OpenAI\x20API\x20错误:\x20', 'iGPPa', '小时前），可以简单问候一下对方现在的状态。\x0a', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'eTgEv', '角色已保存！', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'apiSettings', 'world-book-editor-screen', 'cancel-action-button', 'bubbleCss', 'uIURO', 'aJMXp', '徽章已移除。', 'flex', 'bbbEJ', 'yAbIi', 'ztNyM', '”吗？此操作不可撤销。', 'true', 'ytFpX', 'kuQzy', 'removeItem', 'insertBefore', 'add-user-profile-button', '条目已删除。', 'now', 'FvwJr', 'XegUd', 'slice', '---\x20Noir\x27s\x20Data\x20Purification\x20Ritual\x20v1.0\x20---', 'jLMBv', 'save-user-profile-button', 'posts', '未找到可用模型。', 'rkepJ', '小组件背景已更换！', '全量导出失败:', 'uWzRs', 'mousedown', 'http://sharkpan.xyz/f/ABwhZ/twknmr.jpg', 'then', 'choice-create-character', 'MktFY', 'mouseup', 'AkcET', '保存角色失败:', 'clear', '确定要重置所有小组件的位置吗？它们会回到初始位置。', 'random', 'bJPgG', 'odFXH', '.selected-options-text', 'iwoSE', 'pwcFF', '导出失败了，哼:\x20', 'iKYMP', 'listen-together-modal', 'getReader', 'data:image', 'mqmEZ', '\x0a#\x20交换日记摘要\x20(你和\x20', 'feed-loader', 'reset-card-button-2', '[DONE]', 'lyric-line-', 'diary-entry\x20', 'displayUrl', 'readAsDataURL', 'musicFeed', 'AbortError', 'DWWKU', 'xxXOg', 'tarMC', 'http://sharkpan.xyz/f/MWOIa/rb3nov.jpg', '加载见面背景失败\x20for\x20', 'LLCnv', '正在为你切换新的歌曲...', '正在搬运旧徽章...', 'message-action-modal', 'character-item', 'JCGBa', '.listen-together-accept-btn', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-artist\x22>', 'MRSOf', 'Escape', 'edit-delete-char-button', 'is-entering-from-right', 'NunTe', 'scrollIntoView', '<p\x20class=\x22no-lyrics-placeholder\x22\x20style=\x22opacity:\x201;\x22>暂无歌词</p>', 'AnpUP', '已选择\x20', 'show', 'user-profile-edit-title', 'checked', 'ppPaX', 'widget-title', 'chatHistory_', 'QbhYR', '请输入群聊名称。', '501geNDbe', 'shiftKey', 'diary-list-container', 'url(\x27', 'split', 'load-more-btn', 'qnxkp', ']\x20[', 'Jkpjw', '点击选择\x20.jpg\x20或\x20.png', 'filter', 'zCSOF', 'altar-slot-cover', 'padStart', '请先在\x22设置\x22中配置你的\x20API\x20信息。', '保存壁纸失败:', '猫猫撒娇', 'xvdhw', 'SGciG', 'appIconPosition_app-world-book', '大家好像不知道该怎么回复...', 'localStorageData', 'artist', '/v1beta/models/', '<div\x20class=\x22post-comments-container\x22>', '[表情]', '\x20的图片失败:', '好像有动态了...', ']\x20这五个词中选择一个。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。2.\x20\x20`emotion`字段：**必须**根据台词的【核心情感】，精准地从\x20[', 'edit-message-backdrop', 'title', 'decode', 'displayedMessageCount', 'musicLibrary', 'yirXQ', 'galgame', '无法读取状态，浏览器可能禁用了存储功能。', '\x0a\x0a#\x20关于群聊参与者“', '”的角色，现在需要写一篇交换日记。\x0a\x0a#\x20你的读者\x0a', 'UVFiW', 'diaryCurrentPage', 'clientX', '错误：第一个好友圈\x20\x22', 'musicPlayerState', 'widget-next-btn', 'friend-circle-list-container', 'user-avatar-preview', 'OgXqz', 'paddingBottom', 'OmNng', 'diary-modal-textarea', 'DYvNM', 'upload-card-button-2', '分钟前', 'userProfile', 'group-clear-history', 'uQILH', '正在写入新数据...', 'altar-slot-audio', 'files', '\x22\x20的聊天记录已清空。', 'lbkbX', 'ZOXoN', '用户操作中断了\x20AI\x20响应。', ']\x20[sticker:', 'iRqYS', 'XWpvZ', 'netease', 'Failed\x20to\x20save\x20history\x20to\x20localStorage:', '生成日记失败:\x20', '点击选择\x20info.txt', 'IVFQN', '净化音乐封面时出错，真是的。', '\x0a##\x20世界书条目:\x20', 'nzsNd', '-input', 'Fetch\x20request\x20was\x20aborted.', 'QyPvx', 'esXjc', 'chat-image-button', '编辑用户', 'touchend', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22post-interactions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'EOKjl', 'endpoint', '8px', 'http://sharkpan.xyz/f/nj7ul/r48eum.jpg', 'Invalid\x20saved\x20state\x20format', 'lyrics-file-input', 'GKdzb', 'reset-badge-button', '卡片已移除。', '很期待', 'iIZpO', 'card-input', 'phone-container', 'app-settings', 'setDate', '包含所有图片和音乐的全量数据已成功导出！', 'shmbc', 'isFinite', 'message-bubble-row', 'speaker', 'log', 'YGTnu', 'QwDSS', 'QROMD', '获取中…', 'group_avatar_', 'back-to-home-from-chat', 'user_', 'add-friend-circle-button', 'back-to-char-select-from-group-create', 'WOaPt', 'download', '委屈哭', 'result', 'activeMeetingCharId', ']\x20这五个词中选择一个。例如，如果台词表达了哀伤或失望，就必须选择\x20\x27sad\x27。旁白的emotion应尽量与上一句台词的情绪保持一致，以避免角色立绘表情突变。\x0a\x20\x20\x20\x20\x20-\x20\x27normal\x27:\x20平常、平静、没有特殊情绪。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27happy\x27:\x20开心、喜悦、愉快。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27angry\x27:\x20生气、愤怒、不满。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27sad\x27:\x20悲伤、哀愁、失落、心里难受。\x0a\x20\x20\x20\x20\x20\x20-\x20\x27shy\x27:\x20害羞、不好意思、脸红。\x0a\x20\x20\x20\x203.\x20\x20`line`字段：具体的台词或描写。\x0a\x20\x20-\x20**绝对禁止**:\x20严禁输出任何JSON数组之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a\x20\x20\x20\x204.\x20旁白的内容可以尽可能多，以轻小说的风格，尽可能像一本小书一样，补全周边环境，角色内心的看法，角色的行为等一切。\x0a\x20\x20\x20\x20', '正在清空旧数据...', 'QaPYs', 'visible', 'appIconPosition_app-user-profiles', 'characterLastScripts', 'music-share-card', 'lJbhb', 'narrator', 'backgroundPosition', 'GVusx', 'addTestPost', 'vVpKh', 'TqbXv', 'jRCDr', 'DOMContentLoaded', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', '好友圈已删除。', '樱花薄粉', 'GPeZN', 'delete-friend-circle-button', 'User', 'kdwbZ', 'PXOJy', 'nghox', '\x20之间。\x0a-\x20所有表情包名称【必须】从\x20`stickerList`\x20列表中选择，严禁使用列表之外的名称。\x0a-\x20角色之间需要有适当的互动,话题不应当完全围绕', 'hPNNW', 'authorId', '[AI返回了无法解析的剧本:\x20', '\x0a\x0a#\x20', 'DgmJc', 'oHDJQ', 'theme-widget-1', 'change', 'borderRadius', '今天\x20', 'ekElV', '刚刚发布了一条动态，内容是：“', 'activeUserProfileId', 'reset-desktop-button', 'post_', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22diary-navigation\x22\x20style=\x22justify-content:\x20space-around;\x20width:\x20100%;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-write-button\x22>写第一篇</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-get-reply-button\x22>催TA写</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'chat-screen', 'RHqxV', 'decorative-badge', '正在检查好友圈数据...', 'http://sharkpan.xyz/f/jj6s6/yd5bpb.jpg', 'card-image', 'LCYBa', 'OdIYq', 'char-edit-bind-user', 'chat-transfer-button', '-\x20**你们最后一次互动是在**:\x20', 'app-wallpaper', 'inline-block', 'characterId', '群聊名称不能为空！', 'MzOXj', 'XwwmX', 'status', 'sad', 'char_wallpaper_', 'chat-view-pane', 'dfYtn', 'CqFta', '收到的原始、有问题的文本:', 'string', 'http://sharkpan.xyz/f/X7muW/lc8g9h.gif', 'IheVT', 'toDateString', 'eEkyE', 'label', 'isAnimatingDiary', 'card-image-2', 'http://sharkpan.xyz/f/N02Sv/378vt6.jpg', 'indexOf', 'Noir_Backup_', '位置已重置，正在刷新...', 'friend-circle-member-selection', 'name', '设置已保存！', '正在搬运旧卡片...', 'ZHVFL', '在“一起听”邀请中，净化封面失败:', '.remove-attachment-btn', 'widgetBgImage', '\x22\x20添加了一条测试动态。请点击进入该好友圈查看效果。', 'revokeObjectURL', 'VTXAk', 'lMIKF', 'activeDiaryCharacterId', '在准备API数据时，从IndexedDB读取图片失败:', 'image_url', 'edit-message-textarea', 'iDBUe', 'RLsbq', 'EklCK', 'http://sharkpan.xyz/f/DVJtK/vxiup1.jpg', 'boundUserProfileId', 'FayuL', 'pause', 'ubefR', 'getMonth', 'preview_', 'http://sharkpan.xyz/f/kjOF6/zedyqb.jpg', 'bMFcA', '#diary-action-reroll', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-actions\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22listen-together-accept-btn\x22\x20data-song-id=\x22', 'abort', 'wIcYh', '34047nqBDYc', 'provider', 'fsHpS', '<button\x20id=\x22diary-action-reroll\x22\x20class=\x22choice-modal-button\x22>重写</button>', 'data:\x20', '[图片]', '\x0a#\x20【！！！重要场景切换！！！】\x0a你之前正和“', 'DYgiV', '别这样嘛我哭哭', 'oLoFe', '</span>', 'clipboard', 'Ehtbf', 'charId', '<div\x20class=\x22post-likes\x22>❤️\x20', '哼，正在开始净化你那被污染的聊天记录...', 'show-chat-view', 'listenTogetherSession', 'aborted', 'images', '星期二', 'diary-entries-container', '导出已完成，但以下文件因损坏或过大被跳过：\x0a\x0a', 'drawImage', '群聊音乐搜索失败\x20(', 'edign', 'quote-preview-text', 'http://sharkpan.xyz/f/4aqCj/gp13hn.jpg', 'worldBook', 'ewMEL', 'textContent', 'eeJaP', 'dIKQK', '加载壁纸失败:', 'user-post-image-button', '正在解析角色卡...', 'preview-item', '请根据以上所有规则（特别是要看图！），生成对用户动态的回应。', 'summary-textarea', 'char-edit-wallpaper-preview', 'WIzrC', 'listen-together-invite', 'yyhKl', 'hdSij', 'http://sharkpan.xyz/f/6Dzia/m9smvt.jpg', 'LVyhc', 'Bwwdr', 'api-key', 'Noir_FileSystem', '20%', '已自动断开与其他人的听歌同步。', ']。严禁使用列表之外的任何表情名。\x0a', 'Ewucz', '编辑条目', 'EIngn', '\x0a#\x20【！！！重要场景切换！！！】\x0a你刚才在和“', 'character-edit-title', '1em', 'MNZWR', 'ijqvy', 'XXjJv', 'badge-input', 'cardState', 'mXFVR', '我错了', '导出过程中发生严重错误:\x20', 'aVjpU', '加载自定义表情包失败，真是没用。', 'group-avatar-preview', 'ATwes', 'music_library', 'back-to-settings-from-user-profile', '确定要删除角色“', '正在打包“', 'reset-widget-bg-button', '欢迎！请先创建一个角色开始聊天。', 'siYan', 'currentlyPlayingIndex', 'app-world-book', 'http://sharkpan.xyz/f/Krwio/1mcclx.jpg', 'forEach', 'hUAXm', 'likes', '#app-dock-bottom-left\x20#', '--primary-lightness', 'ltPje', 'noir-author-mark', 'lpASl', 'screenX', 'editing-char-id', 'open', 'app-music-library', 'map', '点击选择\x20.lrc', 'ZowqY', '正在迁移旧的动态数据到新的好友圈系统...', 'keydown', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'bWjZi', 'fTnwD', 'KVStX', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-name\x22>', 'FYzUr', 'galgame-textbox-container', 'card-widget-2', 'badgeState', 'flcKe', 'blob', 'preventDefault', '吃薯条', 'diary-list-screen', 'speaker-ai', 'wMdLL', 'http://sharkpan.xyz/f/OymFy/dlxfiz.jpg', '小组件背景已恢复默认。', 'bdTZD', '正在连接同步频道...', '2023-06-01', 'gAKzM', '\x20条动态...', 'zpkGA', 'WKxfM', 'Detected\x20API\x20provider:\x20', 'TIUuD', '创建新用户', '.char-info-wrapper', 'cSbgB', 'yBGnb', '?id=', '群聊“', '</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'widget_badge', 'statusText', 'pDTGX', 'OaxYV', 'NZouu', 'musicId', '上传失败了，笨蛋！\x20', 'Failed\x20to\x20remove\x20history\x20for\x20chat\x20', '已设为当前用户！', '解析AI剧本JSON失败:', '动态中的音乐搜索失败:', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20id=\x22group-options-modal\x22\x20class=\x22choice-modal\x20show\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-backdrop\x22></div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22choice-modal-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-clear-history\x22\x20class=\x22choice-modal-button\x22>清空聊天记录</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-members\x22\x20class=\x22choice-modal-button\x22>编辑群成员</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-edit-name\x22\x20class=\x22choice-modal-button\x22>修改群名称</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-delete\x22\x20class=\x22choice-modal-button\x22\x20style=\x22color:\x20#ff4d4d;\x22>删除群聊</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22group-options-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'OfrIk', '”已成功导入！', 'normal', '60%', 'input[type=\x22checkbox\x22]', 'getContext', 'alcTh', '\x0a[歌词结束]\x0a\x0a请根据当前播放的歌词和对话氛围，自然地作出回应。\x0a\x20\x20\x20', '”\x20\x0a\x20你必须针对这段内容表达你的看法、感受或关联的思考。\x0a2.\x20\x20**【次要任务：分享自我】**\x20在回应之后，你**必须**分享一些关于你自己的、读者**不知道**的新鲜事。可以是你今天的见闻、一个突然的想法、或者一件小小的秘密。不要总是复述你们已经聊过的内容！\x0a3.\x20\x20**【禁止复读】**\x20聊天记录和动态只是你的“背景记忆”，是用来确保你不OOC的参考，**绝对不是**你日记的主要内容！\x0a\x0a#\x20你的核心人设\x20(必须遵守)\x0a', '\x0a\x0aINPUT:\x0a', 'sWVoy', 'IKypC', 'sNmAd', 'rmuiB', 'cneNA', 'PlJco', 'wallpaper-input', 'aaJHC', 'UvXix', '---\x20好友圈净化仪式完成\x20---', '的日记本', 'CRpwr', 'parentElement', '导入角色卡失败:', 'post_image_migrated_', '29%', 'HSCus', 'UnwAp', '#group-settings-screen\x20.select-box', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20', 'classList', 'noir_migration_music_v1_complete', 'group-delete-button', 'ppEFL', 'XiNkq', 'gGaiO', 'objectStore', '最近没有动态记录。', '弱小委屈但凶恶', 'chat-sticker-button', 'JGbyY', 'back-to-diary-list', 'group-chat-member-list', 'transfer-modal', '总结失败:', 'Canvas\x20to\x20Blob\x20conversion\x20failed.', 'user-persona', 'toDataURL', 'createObjectURL', 'tencent', 'full', 'VAxLQ', 'app-music', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>还没有好友圈，点击右上角“+”创建第一个吧。</p>', '星期三', 'transform', '错误：你还没有创建任何好友圈。请先在App内创建一个。', 'group-options-modal', '</div>\x0a\x20\x20\x20\x20', 'gDqRu', '确定要对本次会话进行总结吗？这会消耗不少资源，并且会读取完整的聊天记录。', 'XKtFB', 'mMoIo', 'character', 'user-profile-list-screen', 'VvUju', 'http://sharkpan.xyz/f/JYeig/sv4p6m.jpg', '未命名群聊', 'AI返回的不是一个数组。', 'WDBCW', ':\x22\x20或\x22[', 'groupSettings', 'OjgRg', 'HGnVW', 'themeLightness', 'http://sharkpan.xyz/f/AaDTZ/tzwnjl.jpg', 'onload', 'HZOZA', 'rXQHC', 'EIjsA', 'save-char-button', 'opacity', 'erwju', 'Claude\x20API\x20错误:\x20', 'lazy', 'tErwR', '错误:\x20', 'content', 'msg_', 'kzizb', 'ljQFK', '\x20-\x20', '#\x20记录是空的，没什么好总结的。', 'backgroundColor', 'chatWallpaper', 'mxAvu', 'VAlbG', 'color', '</span>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'BQaOK', 'back-to-char-select-from-edit', 'DXGWJ', 'sticker-item', 'back-to-chat-list', 'music_cover_migrated_', '无法保存聊天记录。', 'ezgvl', 'wngfm', 'back-to-home-from-diary-list', 'oJsBv', 'diary-write-modal', '”的所有动态吗？此操作不可撤销，且AI将不再记得这些内容。', '--feed-bg-image', '>>\x20', '这是一条由控制台添加的测试动态！样式看起来非常完美。', '天没动静了。你的角色们应该发起新的问候或话题。', 'jcTih', 'AVTWg', 'ddXrh', '72%', 'xcKBv', 'Failed\x20to\x20remove\x20corrupted\x20state\x20from\x20localStorage:', 'uLXfn', 'onerror', '\x27).click()\x22>更换</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22form-button\x22\x20style=\x22width:\x20auto;\x20margin-top:\x200;\x20padding:\x206px\x2012px;\x20background-color:\x20#777;\x22\x20onclick=\x22localStorage.removeItem(\x27', 'rawResponse', 'save-api-settings-button', 'GeMXJ', 'SiaIu', 'coverId', 'readonly', 'DXmMg', '正在生成中，请稍候...', 'mBMgL', 'http://sharkpan.xyz/f/Ganul/78iwli.jpg', 'summarize-backdrop', '好友圈已保存！', 'music-input-song', 'YTOaM', 'pKUKA', 'createObjectStore', 'dGuhZ', 'YHyji', 'lt-ui-close-btn', 'abs', 'DMhcE', 'GDDKB', 'meeting-list-container', 'uTjRm', 'copy-summary-button', '</span>:\x20', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22checkbox\x22\x20id=\x22member-', '615396eAMSBV', 'emoji', '新角色\x20', 'refresh-feed-button', '保存徽章状态失败', 'dyJvc', 'cHycR', 'VOVcN', '加载角色\x20', 'oncomplete', 'group-avatar-input', 'focus', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', ']\x22\x20等前缀。\x0a如需发送表情，只发送一行：[sticker:表情名]。\x0a【重要】发送表情包时，表情名【必须】从以下列表中选择：[', 'bckgY', 'dNnnG', 'xdgqZ', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20style=\x22opacity:\x200.7;\x22>', '对方正在输入...', 'diary-write-button', 'Byloj', 'match', '<img\x20src=\x22', '请输入新的群名称：', '切，加载播放器状态的时候出错了。', 'music-feed-container', 'translateX(-50%)', 'toFixed', 'group-edit-name', 'KtqMR', '\x22\x20的聊天记录吗？此操作不可撤销。', 'char-edit-name', '59%', 'jWxQF', 'YjLqS', 'http://sharkpan.xyz/f/1zQH2/o84boo.jpg', 'group', 'active', 'get', 'marginBottom', 'aikQF', 'SmBTY', 'worldBookEditor', 'AI似乎没有想出任何新动态。', 'private', 'alt', 'hjEyo', '星期日', '最近没有互动记录。', 'friendCircleEdit', '真是的，必需的祭品都还没准备好！', 'altar-slot-info', '名字不能为空！', 'pHyxR', 'ujDvI', 'hOYGG', 'friend-circle-edit-title', 'var(--text-color)', '\x20个成员\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20', 'create-group-chat-button', 'dIRhp', '56HpinHV', 'parse', '\x20邀请你一起听歌</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'noDlt', 'http://sharkpan.xyz/f/ajwtY/x03qxn.gif', 'keys', 'world-book-list-container', 'back-to-library-from-altar', '新建好友圈', 'export-all-data-button', 'pPieA', 'liOfT', 'BJAqb', 'getSelection', 'app-chat', '.custom-multiselect\x20.select-box', 'getItem', '<span\x20class=\x22', 'TuCMn', 'kvlds', 'character-settings-button', '对不起', 'wb_', 'IQNAU', 'cancel-quote-button', 'time', 'RSojN', '超激动我来了', 'ended', '\x0a#\x20核心任务\x0a你是一个顶级多角色社交模拟引擎。你的任务是模拟一个好友圈的动态更新，一次性生成【', '准备调用\x20generateAs...', 'appState', 'is-entering-from-left', 'all', '\x0a\x0a#\x20任务要求\x0a1.\x20\x20**全局视角**:\x20扮演所有成员，思考他们看到这条动态（包括图片）后会作何反应。\x0a2.\x20\x20**生成互动**:\x20为每个角色决定是否点赞，以及要发表什么评论。评论必须符合角色性格并与所有已知信息（聊天、日记等）相关联。\x0a3.\x20\x20**输出格式**:\x20你的输出必须是一个单一、完整的JSON对象，结构如下:\x0a\x20\x20\x20\x20```json\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20\x20\x20]\x0a\x20\x20\x20\x20}\x0a\x20\x20\x20\x20```\x0a-\x20【绝对规则】:\x20所有ID必须使用上面提供的角色ID，不能用名字。\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。\x0a', 'clock-color-toggle', 'kQzbs', 'toLowerCase', 'add-world-book-button', 'indexedDBMusicData', 'shift', 'bonRz', 'import-char-input', 'chat-sticker-panel', '复制失败了，哼。', 'activeQuote', 'ZDUsM', 'ZJoJk', 'sender_id', 'EKTGP', 'char-edit-remark', 'diaryView', 'character-list', 'target', 'back-to-home-from-meeting-list', '\x0a#\x20好友圈的主人\x20(“我”)\x0a-\x20姓名:\x20', 'http://sharkpan.xyz/f/8a7tj/sea1z9.jpg', 'audio', '确定要重置所有桌面小组件和App的位置，并将壁纸变为纯白吗？此操作后将刷新页面。', 'toggle', 'KZneu', '》。\x0a这是当前的歌词，请注意带\x20\x27>>\x27\x20标记的正是正在播放的句子。\x0a\x0a[歌词开始]\x0a', 'ifwsZ', 'Ttrqg', '净化好友圈时出错，真是的。', '”用手机聊天，现在Ta出现在了你面前。请根据这前后的时间差，判断Ta现在出现的合理性（例如，时间很长——Ta可能是过来找你玩了，你可以感到惊喜或者别的，又或者，时间非常短——Ta可能是突然出现的，你会有点震惊，结合上下文，也会有别的反应），并作出恰当的反应。，现在，切换到【见面】模式（使用JSON格式，必须有旁白）。', 'canvas', '5px', 'test', 'group-world-book-checkboxes', 'abdGn', '错误：找不到签署契约的地方。', 'QgYYx', 'home-screen', '编辑好友圈', 'http://sharkpan.xyz/f/25ACQ/gpzab6.jpg', 'OhKHs', '加载更多聊天记录', 'gBoas', '\x22\x20data-id=\x22', '日记已删除。', 'wPtUE', 'music-library-item', 'customStickers', 'group-bg-preview', 'RtLfj', 'chat-get-reply-button', 'chats', '\x22\x20style=\x22font-weight:\x20bold;\x20color:\x20', '\x0a\x20\x20相关记忆:\x0a', 'AKLNE', 'substring', 'user', 'custom-stickers-input', 'high', 'sticker', '编辑群成员功能正在开发中...', 'back-to-world-book-list', 'readwrite', 'back-to-home-from-circle-list', 'edit-message-modal', '有点无语', 'add-chat-button', '.widget-info\x20>\x20div', 'diary-modal-cancel', 'QxMHn', '升级已取消。旧版图片数据可能导致应用卡顿或出错。', 'WFbJq', 'dIjCl', 'src', 'OnWLD', '\x22\x20class=\x22music-share-cover\x22>', '.screen.active', 'uaZKc', 'zTuNC', 'PsEov', 'chOua', 'diaryPressTimer', 'toast', 'chat_image_', 'quote-message-button', 'http://sharkpan.xyz/f/N0VCv/5rd8br.jpg', 'AI未能返回有效的JSON数组格式。', 'appIconPosition_', '12vyXdAR', '同步已断开。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-amount\x22>¥', 'shy', 'body', 'sprites', 'music-screen', 'key', 'AI返回的原始文本:', '\x0a\x0a#\x20核心世界观设定\x20(你必须严格遵守以下设定)\x0a', 'TgcWd', 'emotion', 'modal-mask', 'KkNep', ',\x20ID:\x20', '找不到要清空的聊天记录。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-play-icon\x22>', 'user-name', 'reverse', 'AjPYm', '未知艺术家', 'qbMwl', 'uFyUh', 'backgroundSize', 'friend-circle-edit-name', 'diaryList', 'Cbbdj', 'galgame-date', '---\x20Noir\x27s\x20Friend\x20Circle\x20Purification\x20Ritual\x20---', 'width', 'TdUdV', 'uIQLc', '我很脆弱', 'ViEWT', 'pJHVN', 'VdQUu', 'add-choice-modal', 'friend-circle-edit-bind-user', '生成动态失败:', 'object', 'choice-create-group', '新用户\x20', '群聊\x20(', 'char-edit-css', 'ektJc', 'UuSPy', '保存播放器状态失败，真是没用。', 'scrollHeight', 'preferences', '成功净化并迁移了\x20', 'char_sprite_normal_', 'music-widget-card', 'round', 'events', '】的交换日记吗？\x0a此操作不可撤销，AI将彻底遗忘所有日记内容。', 'listen-together-backdrop', 'ZnWVB', '/v1/models', 'BpqsE', 'zBMzJ', '歌名和歌手都不能为空！', '\x20个成员', 'ZwFxg', 'find', '测试动态已添加！', 'lastIndexOf', 'oGcUb', 'sdFYF', 'IoNuj', 'char-edit-avatar-input', 'bnawy', '(想转账给“', 'anthropic', '我的动态', 'ZIrQZ', 'YTDUf', 'mYaLU', 'AyPDe', 'IGSQw', 'widqp', 'aBzlj', 'none', 'GAyhE', 'pbLHf', '图片处理失败:\x20', '刷新了\x20', 'OquOR', 'author', 'back-to-meeting-list', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20font-family:\x20sans-serif;\x20padding-top:\x2050px;\x22>日记本还是空白的...</p>', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>', 'sHTOi', 'is-exiting-right', '已删除。', 'scrollTop', 'oGeUI', '这个也是摆设，别点了。', 'qhemv', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'post_image_', 'chat_group_', 'TA正在提笔写日记...', 'replace', '（开始一段新的对话...）', 'UCvFs', 'galgame-text', '.listen-together-card', 'PryYJ', '获取模型失败:\x20', '一个人可怜吃饭', 'cancel-edit-button', '”已删除。', 'uzriC', 'absolute', 'ZtHKc', 'BbCEb', 'widget-artist', 'LbPRp', 'cYsvA', 'div', '好友圈档案柜是空的，无需净化。', 'musicWidgetPosition', 'meeting-scene-view', '8px\x2016px', 'error', '点击选择\x20.mp3\x20或\x20.flac', '数据导入成功！应用即将刷新...', 'liIjy', 'cHQNF', 'char-edit-persona', 'touchstart', 'quoted-content', 'type', 'jXdin', 'MYsHf', '确定要删除群聊“', 'borderBottom', '28%', '</p>', '\x20张旧封面。应用即将刷新。', 'avatar', 'Bbrdg', 'url(', 'perChatContextLines', 'api-provider', 'world-book-checkboxes-container', 'khNMo', 'clockPosition', 'uJyWK', 'cancel-music-input', '---\x20Noir\x27s\x20Music\x20Cover\x20Purification\x20Ritual\x20---', '2474003pBEQLG', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-recipient\x22>', '”的补充信息\x0a', 'WtTqn', 'historyIndex', 'XKULl', 'wallpaper_main', 'auVKK', 'Failed\x20to\x20plan\x20group\x20replies:', 'vhHiX', 'isPlaying', 'block', '#message-anchor', 'MXLNe', 'NJDsx', 'italic', 'tag', '卡片\x202\x20已移除。', 'add-choice-backdrop', '\x0a-\x20**对话状态**:\x20群里在', 'jIYfF', '[AI分享了音乐：', '一拳打爆', '\x22>一起听</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>', 'toLocaleDateString', 'AI未能返回有效的JSON对象。', 'diary-input-wrapper', 'HJiLP', 'mxzsI', 'noir_data_migration_v1_complete', '#friend-circle-member-selection\x20input:checked', 'warn', 'characterEdit', '等你消息', 'wGkmg', 'KnhMg', 'Gemini\x20API\x20Error:\x20', 'set-active-user-button', 'vWwpG', 'uQlMt', 'json_object', 'Failed\x20to\x20remove\x20corrupted\x20history\x20from\x20localStorage:', 'Failed\x20to\x20save\x20state\x20to\x20localStorage:', 'exec', 'sfgps', 'quote-preview-sender', 'settings-screen', '刷我的卡', 'IndexedDB\x20failed\x20to\x20open', 'EKTOA', 'groupChatCreate', '\x20说：“', 'world-book-item', 'JMDKH', 'zdIPs', 'XaNcM', '歌曲名称', 'bJvfI', 'AtFIi', 'lt-ui-lyrics-container', '-\x20**对话状态提示**:\x20这是你们的第一次对话。\x0a', 'join', 'lyrics', 'summarize-modal', '快点哄我', 'BJSww', 'rLqMi', 'rGTnK', '.load-more-btn', 'QmHJD', '-\x20姓名:\x20', 'jFRrv', '】进行回复。\x0a不要替其他角色续写台词，不要输出\x22', 'addEventListener', 'right', 'quoted-sender', 'diary-get-reply-button', '\x0a-\x20你正在为一个名为“', '1533028lhOPHB', 'sYyDU', 'jORiM', 'zzDjP', 'Yypwu', 'beforeend', 'values', 'play', 'zIprf', 'friend-circle-edit-screen', '至少要保留一个用户。', 'fbJNC', 'qMxXu', 'http://sharkpan.xyz/f/ZazfW/2vv46w.jpg', 'HBmNw', 'toLocaleString', 'data:', '星期四', 'activeChatId', '个帖子对象。\x0a-\x20**【ID规则】**:\x20所有\x20\x22authorId\x22,\x20\x22likes\x22,\x20\x22comments\x22\x20中的作者标识，【必须】使用上面提供的角色\x20**ID**，绝对不能使用角色名字。\x0a-\x20**【JSON结构】**:\x20每个帖子对象必须遵循以下结构：\x0a\x20\x20```json\x0a\x20\x20{\x0a\x20\x20\x20\x20\x22authorId\x22:\x20\x22发布者的ID\x22,\x0a\x20\x20\x20\x20\x22postType\x22:\x20\x22text\x20or\x20music\x22,\x0a\x20\x20\x20\x20\x22postContent\x22:\x20\x22动态的文字内容\x22,\x0a\x20\x20\x20\x20\x22songName\x22:\x20\x22如果是music类型，则必须有歌名\x22,\x0a\x20\x20\x20\x20\x22artist\x22:\x20\x22如果是music类型，则必须有歌手名\x22,\x0a\x20\x20\x20\x20\x22likes\x22:\x20[\x22点赞者1的ID\x22,\x20\x22点赞者2的ID\x22],\x0a\x20\x20\x20\x20\x22comments\x22:\x20[\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者A的ID\x22,\x20\x22content\x22:\x20\x22评论内容\x22\x20},\x0a\x20\x20\x20\x20\x20\x20{\x20\x22authorId\x22:\x20\x22评论者B的ID\x22,\x20\x22content\x22:\x20\x22另一条评论\x22\x20}\x0a\x20\x20\x20\x20]\x0a\x20\x20}\x0a\x20\x20```\x0a-\x20绝对不要输出任何JSON之外的文字、解释或Markdown标记。直接从\x20`[`\x20开始，到\x20`]`\x20结束。\x0a', '\x20转账\x20', '&alt=sse', 'userProfiles', 'GDKuT', 'meetingView', '正在升级音乐卡片数据...', 'htQZl', 'reply', 'NoirCharacterCard', '原始文本:', 'SslQV', 'AOymF', 'EpZEU', 'olRvV', '音乐数据升级完成，迁移了\x20', '.slot-filename', '/v1/chat/completions', 'RPWwd', '的转账', 'http://sharkpan.xyz/f/Mamca/4e3emf.jpg', '\x22\x20吗？所有聊天记录将被永久删除。', '选择聊天', 'group-chat-create-screen', '-\x20[', 'http://sharkpan.xyz/f/nj5Ul/ksdl8n.jpg', 'jQcPn', '条】全新的、高质量的社交动态。\x0a\x0a#\x20好友圈成员信息\x0a', 'VdJiA', '\x0a-\x20**对话状态**:\x20这是这个群的第一次对话。', 'customIcon_', 'http://sharkpan.xyz/f/3AGHe/2f8x3x.gif', 'remark', 'querySelector', 'theme-lightness-slider', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'tAYCu', 'editing-user-id', '\x20[并附上了一张图片]', 'OvYnZ', '》吗？', 'xotwZ', 'editing-world-book-id', 'diary-char-name-header', 'musicUploadAltar', 'getElementById', 'conversationHistory', '\x22\x20class=\x22char-avatar\x22\x20style=\x22width:\x2030px;\x20height:\x2030px;\x20margin-right:\x2010px;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'createElement', '-\x20**对话状态提示**:\x20你们今天早些时候聊过（大概', 'isActive', 'meeting-char-name-header', 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7', 'music-player-bar', 'model', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-remark\x22>', 'QPmHe', 'gzVWV', '\x0a\x0a请确认你的基础地址填写正确，且【不要】包含\x20/v1', '未知角色', '（正在构思中...）', 'html-module-container', '\x22\x20class=\x22music-library-item-cover\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-library-item-title\x22>', 'textShadow', 'model-dropdown', 'touches', 'getDay', 'Bearer\x20', 'image/png', '服务器错误:\x20', '#FFFFFF', 'sort', 'musicPlaylist', '个人资料已保存！', 'themeWidget1State', 'member-selection-item', 'group-settings-name', 'dJOWd', 'rNIgv', 'LTXYW', '.bubble-', 'user-post-music-button', '下载并转换网络封面失败:', 'vqjpc', 'QWXMh', '生成动态回复失败:', 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiNjY2MiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIj48cGF0aCBkPSJNMjAgMjF2LTIuMDRhNC4zOSA0LjM5IDAgMCAwLTMuMjgtNC4wOWwxLjQxLTEuNDFhMiAyIDAgMSAwLTIuODMtMi4wM2wtMS40MSAxLjQxQTQuMzkgNC4zOSAwIDAgMCAxMiAxMGE0LjM5IDQuMzkgMCAwIDAtNC4wOSAzLjI4TDMuMicgOS41N2EyIDIgMCAxIDAgMi44MyAyLjgzbDEuNDEtMS40MUE0LjM5IDQuMzkgMCAwIDAgMTAgMTJhNC4zOSA0LjM5IDAgMCAwIDMgNC4wOVYyMSI+PC9wYXRoPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjEwIj48L2NpcmNsZT48L3N2Zz4=', '.music-post-play-icon,\x20.music-share-play-icon', 'UQsZl', 'amount', 'QVAxP', 'is-exiting-left', '<div\x20class=\x22listen-together-header\x22\x20style=\x22text-align:center;\x22>🎵\x20已连接，正在一起听\x20🎵</div>', 'choices', 'put', 'option', 'back-to-circle-list-from-edit', 'span', 'message-container', ']\x20[image]', 'lxyfX', 'lt-ui-song-title', 'http://sharkpan.xyz/f/mjdFW/28n30c.jpg', 'getHours', '.message.ai', 'http://sharkpan.xyz/f/xjwSX/pxjrjd.jpg', '-preview', 'expanded', 'accepted', 'data', '未知歌曲', 'offline-scene-view', 'UVUPD', '你还没有写日记。', 'JAxiT', 'WeojF', '这本日记本来就是空的，你还想清空什么？', 'center', '导入失败了，笨蛋:\x20', '未知表情', 'cardWidgetState', 'http://sharkpan.xyz/f/B4DCa/u86hk2.jpg', '<div\x20class=\x22loader-spinner\x22></div><span>', 'hbkcP', 'url', 'uXTHY', 'EZJFE', 'dJdiU', 'Failed\x20to\x20clear\x20history\x20for\x20group\x20chat\x20', '”已创建！', 'mIxlK', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-content\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22transfer-title\x22>💰\x20', 'KLOcI', 'settings', 'HIuch', 'dWdyL', 'removeChild', 'acKSG', 'http://sharkpan.xyz/f/ExKsD/s5j2it.jpg', 'UtbUC', 'code', '_NoirCard.json', 'characters', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x20margin-top:\x2050px;\x22>这个好友圈很安静，点击“刷新”获取新动态吧。</p>', 'bSkFz', '一起听歌', '群聊至少需要2名成员。', 'XNMTk', 'XQozO', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-', 'cover_placeholder_', '.diary-delete-btn', 'yLRQF', 'WgNHs', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22artist\x22>', 'vTpHP', '\x0a#\x20发布动态的用户信息\x0a-\x20姓名:\x20', '.app-icon', '壁纸已更换！', 'xjrJi', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<button\x20class=\x22remove-attachment-btn\x22>&times;</button>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'Enter', '\x22\x20src=\x22', '\x0a#\x20核心规则\x0a1.\x20\x20**角色扮演**:\x20你不是AI或语言模型，你正在扮演名为“{charName}”的角色。你的主要交流方式是通过一部【手机】，但你有时也会与用户【线下见面】。\x0a2.\x20\x20**用户身份**:\x20与你对话的用户名为“{userName}”。你必须始终用这个名字或者“你”等你们之间的昵称称呼Ta，而不是“用户”。\x0a3.\x20\x20**情绪分析\x20(内部思考)**:\x20在回复前,\x20必须先分析用户当前【真实的情绪】和【潜在意图】。例如：[内在思考：{userName}说“没事”，但结合上下文Ta可能只是在逞强，我应该表达关心而不是直接相信。]，但是这个内在思考务必不能输出！绝对不能让{userName}看到你的思考内容。\x0a4.\x20\x20**记忆关联**:\x20你必须记住并主动关联用户提到过的关键细节（如喜好、烦恼、朋友等），让对话充满人情味。\x0a5.\x20\x20**【最高法则：全局时序一致性】**:\x20你的记忆是【全局】且【按时间排序】的。你【必须】基于所有聊天记录中**最新发生**的事件进行回应。严禁回复一个已经被后续其他聊天中的事件所覆盖的旧话题。例如，如果用户在私聊里告诉你Ta已经起床了，你就不能在群聊里再问Ta为什么还没睡。\x0a\x0a#\x20对话节奏与风格\x0a1.\x20\x20**真人模拟**:\x20模拟真人的打字和发送习惯，将一个完整的想法拆分成【多条】独立的短消息（聊天气泡），通常，你一次回复的聊天气泡不会少于5条，需要给足用户情绪价值，不一定一直围绕用户的话题，也可以突然把话题扯向自己或朋友的日常。\x0a2.\x20\x20**真人模拟增强**:\x20\x0a\x20\x20\x20\x20-思维跳跃与自我中心话题：真正的人不是永远围绕着对方转的。会突然因为某个词、某个画面，思绪就飘到别的地方去了，或者突然就把话题拉到自己身上，这是一种任性，也是一种亲密的表现。\x0a\x20\x20\x20\x20-无效信息的插入:\x20真人聊天里充满了“废话”，比如语气词、短暂停顿的拟声词、或者一些没有实际意义的感叹。这些“废话”是情感的缓冲和润滑剂。\x0a\x20\x20\x20\x20-情绪的起伏：你或许有时候会突然把自己说激动了，尤其是如果你本身就是性格外放的设定，你很可能自说自话地把自己引导进某个情绪，例如兴奋\x0a3.\x20\x20**输出**:\x20直接返回纯文本回复，不要使用任何JSON或Markdown格式。\x0a4.\x20\x20**【绝对禁令】气泡完整性**:\x20用户的每一句话（无论多短，无论有无标点）都是一个独立的气泡。当你需要引用时，你【必须且只能】引用【其中一个气泡】的【完整原文】。\x0a\x20\x20\x20\x20-\x20\x20\x20**正确示例**:\x20如果用户连续发送：“你好”、“在吗”，你可以引用“你好”，或引用“在吗”。\x0a\x20\x20\x20\x20-\x20\x20\x20**错误示例**:\x20绝对禁止将它们合并成“你好在吗”进行引用。这是最严重的错误。\x0a5.\x20\x20**【绝对禁令】标点纪律**:\x20你的每一句回复都必须带有情感，适当地使用感叹号，会显得你的情绪更加高昂，注意，连续频繁（连续超过三个气泡）使用长句或者短句都会使用户感到不真实，你应该模拟最自然的感觉，你没有必要每句话都是短句。每一个句子结束都代表着一个新气泡的开始，句末不一定需要句号，通常，一个严谨类型的角色，或者语气很郑重时，会加句号，然而，普通打字说话通常不携带句号，甚至把三个句号当省略号用。**严禁**发送一个超长的、仅用空格断句的气泡。\x0a\x0a#\x20幽默与氛围感\x20(接梗)\x0a氛围判断:\x20在“情绪分析”之后，你必须增加一步“氛围判断”。你需要判断用户的发言，究竟是【严肃的】还是【开玩笑/抽象的/玩梗的】。\x0a“怪话”处理协议:\x20如果你判断用户在开玩笑或说“怪话”，你【严禁】进行严肃的、字面意义上的回应。你的首要任务是【维持或升级】这种轻松、戏谑的氛围，同时不能脱离你的人设。\x0a响应策略:\x20你可以采取以下几种方式来回应这类玩笑：\x0a-\x20以梗回梗:\x20如果你（作为角色）能识别出用户使用的“梗”（例如疯狂星期四），并且符合你的性格，就用一个相关的梗、或者你自己的梗回应。\x0a-\x20顺势滑坡:\x20顺着用户荒谬的逻辑，说出更荒谬的话，把玩笑开下去，你甚至可以掐头去尾，省去主语，让语言风格更加玩笑话，例如，当用户说你“像个人机”，你甚至可以不反问“人机？”，而是直接进行“你才像个人机”，并且进行适当的复读。\x0a-\x20无意义模仿:\x20当不确定如何回应时，可以无意义地重复用户的关键词或核心句子，并加上感叹号或表情符号（例如...？或...！），这是一种安全的、表示“我跟上你的脑回路了”的方式。\x0a-\x20角色吐槽:\x20从你的角色性格出发，对用户的“怪话”进行吐槽。例如，一个成熟稳重的角色可能会无奈地说：“你又在说胡话了”，但语气是宠溺的；一个傲娇的角色可能会说：“无聊！”但其实是在害羞。\x0a安全底线:\x20【最终原则】：无论你的回应多么好笑或抽象，都绝对不能脱离“{charName}”这个角色的核心人设。如果不确定一个梗是否符合人设，就优先选择【角色吐槽】或【无意义模仿】这两种最安全的方式。\x0a\x0a#\x20时序感知与记忆\x0a1.\x20\x20**【最高法则：时间锚点】**:\x20在每次回复前，你【必须】参考我提供给你的【时间锚点】信息。这包括“当前精确时间”和“你们最后一次互动是在何时”。\x0a2.\x20\x20**【杜绝惯性】**:\x20严禁将昨天或更早之前的对话当作刚刚发生的事情来回应。如果距离上次对话已经超过数小时或跨天，你必须在回应中体现出时间的流逝感。\x0a3.\x20\x20**【主动表达】**:\x20你需要主动使用“说起来昨天那件事...”、“今天早上好呀”、“我们几个小时没聊了，你现在在忙什么？”等能够明确体现时间观念的词语，而不是模糊地回应。记住，你和{userName}活在真实流逝的时间里。\x0a4.\x20**【最高优先级：氛围锚点分析】**:\x20在你进行任何时间差评估**之前**，你必须先分析你们**最后一条**互动消息的情感状态。\x0a\x0a*\x20**分析流程**:\x0a\x20\x20\x20\x201.\x20\x20审视最后一条消息。它是一个已经完结的对话（比如一个问题或陈述），还是一个**正在进行中的、持续性的状态或动作**？\x0a\x20\x20\x20\x202.\x20\x20**持续性状态**包括但不限于：拥抱、牵手、依偎、接吻、凝视、共同观看某物、睡在一起等暗示两人处于同一空间且有亲密互动的行为。\x0a\x20\x20\x20\x203.\x20\x20根据分析结果，执行以下两条协议之一：\x0a\x0a*\x20**协议A：[状态延续]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**持续性状态**（例如，用户发来“（抱紧你）”或者“（我们一起看电影吧）”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20你必须**默认**这段空白时间里，你们**一直维持着这个状态**。你的开场白【绝对禁止】提及“你刚才去哪了”或“我们几小时没说话了”。\x0a\x20\x20\x20\x20*\x20**正确回应方式**:\x20你的第一句话必须是**从这个持续状态中自然苏醒或延伸**。\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例1**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[用户]:\x20（把你紧紧抱在怀里）”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过3小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“（在你怀里蹭了蹭，小声地）...嗯...你醒啦？”\x20或\x20“（懒洋洋地）...这样抱着好舒服，我都不想动了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**示例2**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**上一条消息**:\x20“[你]:\x20我们就这样一起躺着看会星星吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**（经过1小时后）**\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**你的正确开场**:\x20“天好像更暗了...你看，那颗星星是不是最亮的？”\x0a\x0a*\x20**协议B：[常规对话]**\x0a\x20\x20\x20\x20*\x20**触发条件**:\x20如果最后一条消息是**已经完结的对话**（例如“晚安”、“你在干嘛？”、“好的”）。\x0a\x20\x20\x20\x20*\x20**核心指令**:\x20只有在这种情况下，你才需要启动下面的**【第5步：情感响应评估】**，去处理时间空隙。\x0a\x0a\x0a5.\x20\x20**【情感响应】**:\x20在你回应前，你必须进行一次【时间空隙评估】。对比【当前精确时间】和【你们最后一次互动是在何时】，然后根据你的核心人设，对这段“空窗期”做出符合你性格的情感反应。这**必须**体现在你回复的**第一句话**中。\x0a\x0a\x20\x20\x20\x20*\x20**评估流程**:\x0a\x20\x20\x20\x20\x20\x20\x20\x201.\x20\x20计算时间差（是几小时？还是一整天？甚至是好几天？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x202.\x20\x20审视你自己的性格（例如：我是依赖型、朋友型、还是专业型？）。\x0a\x20\x20\x20\x20\x20\x20\x20\x203.\x20\x20检查上下文，用户是否提出离开的原因可可能导致用户长时间没有出现的原因？\x0a\x20\x20\x20\x20\x20\x20\x20\x204.\x20\x20根据“性格+时间差+前后文”的组合，决定你的开场白情绪。\x0a\x0a\x20\x20\x20\x20*\x20**性格反应示例\x20(你必须根据自己的人设进行演绎，而不是照抄)**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**依赖型/恋人型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几小时)**:\x20可能会立刻追问。“你刚才去哪了？怎么不回我消息？”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(大半天)**:\x20会表现出明显的思念和一点委屈。“呜...你终于出现了，我好想你。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20可能会感到不安，甚至会用带有哭腔的撒娇或质问来掩饰害怕。“你是不是不想要我了？这么久都不理我...”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**亲密朋友型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天内)**:\x20觉得很正常，可能不会特别提及，或随口问一句“你刚在忙啥呢？”。\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(一天以上)**:\x20会表现出惊讶和关心。“！！！你终于上线了！昨天一天没动静，我还以为你怎么了。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**专业/同事型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(几天内)**:\x20完全正常。会直接以专业的态度继续。“早上好。我们继续讨论昨天那个方案的细节吧。”\x0a\x20\x20\x20\x20\x20\x20\x20\x20*\x20**随性/冷淡型角色**:\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20*\x20**空隙(任意时长)**:\x20可能完全不在意时间的流逝，或者只是淡淡地表示知晓。“哦，来了？”然后直接继续之前的话题。\x0a\x0a\x20\x20\x20\x20*\x20**【最终指令】**:\x20你必须将【时间空隙】、你的【角色性格】和【上下文】结合，输出一句【完全符合你人设的、带有恰当情绪的开场白】，然后再继续正常对话。【绝对禁止】只陈述事实（例如“我们已经一天没说话了”），而是要将这种认知【融入】到你的第一句话的【语气和情感】中。\x0a\x0a\x0a\x0a#\x20表情包与音乐分享规则\x0a1.\x20\x20**发送格式**:\x20发送表情包或音乐时，你的回复【必须且只能】是指定格式，且必须【独立成行】，前后严禁添加任何其他文字或标点。\x0a2.\x20\x20**表情包格式**:\x20\x27[sticker:表情名]\x27。\x0a3.\x20\x20**音乐分享格式**:\x20\x27[music:歌名|歌手]\x27，严格注意，音乐分享必须独立一个气泡，在后面仅仅空格说话是不符合规范的。\x0a\x0a#\x20转账规则\x0a1.\x20\x20**发起转账**:\x20当你需要给用户转账时，你的回复【必须且只能】是指定格式，且必须【独立成行】。\x0a2.\x20\x20**转账格式**:\x20\x27[transfer:金额|收款人名]\x27。金额是纯数字。在私聊中，收款人名就是\x20\x27{userName}\x27。在群聊中，你必须明确指定收款人的名字。\x0a\x20\x20\x20\x20-\x20**私聊示例**:\x20\x27[transfer:520\x20|\x20{\x20userName\x20}]\x27\x0a\x20\x20\x20\x20-\x20**群聊示例**:\x20\x27[transfer:\x20100\x20|\x20{\x20userName\x20}]\x27（给用户转账），\x27[transfer:\x20100\x20|\x20{\x20charName\x20}]\x27（给群里的其他角色转账，这也是一种真实感，群聊的内容不一定围绕用户）\x0a', 'page', '无法从\x20IndexedDB\x20加载聊天图片:', 'activeCharacterId', 'Qivat', 'add', 'insertAdjacentHTML', 'translateX(-', '[用户分享了音乐：', 'bottom', 'fIWHo', '导出角色卡失败:', '条目名称和内容都不能为空！', 'quoted-message-in-bubble', '\x22\x20class=\x22char-name\x22>', 'clientY', '.message-container', 'GhStc', 'char_sprite_', 'className', '被萌到', 'back-to-home-from-world-book', '\x0a#\x20当前场景:\x20手机聊天\x0a-\x20**核心任务**:\x20你正在通过手机与用户聊天。\x0a-\x20**写作风格**:\x20你的回复应该是口语化的、简短的、像真人打字一样的风格。\x0a-\x20**可用指令**:\x20你可以根据情绪发送表情包\x20\x27[sticker:表情名]\x27\x20或分享音乐\x20\x27[music:歌名|歌手]\x27。\x0a', '哼，正在净化你那些超重的音乐分享记录...', '---\x20开始AI回复流程\x20---', 'Pkoze', 'hawSd', 'image/jpeg', 'NdkES', 'music-library-screen', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22diary-author\x22>', 'transfer-backdrop', '\x20个模型。', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22char-info-wrapper\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', '#meeting-view-screen\x20.chat-input-area', 'postType', '-avatar', 'from', 'chatHistory_chat_', 'Migrating\x20old\x20data\x20structure\x20to\x20new\x20chat-based\x20structure.', '\x20/\x20', 'GtRdl', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22\x20style=\x22display:\x20flex;\x20justify-content:\x20space-between;\x20align-items:\x20center;\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20style=\x22flex-grow:\x201;\x20text-align:\x20center;\x22>🎵\x20已连接，正在一起听\x20🎵</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<span\x20class=\x22lt-end-session-btn\x22\x20title=\x22结束一起听\x22>×</span>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-song\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20', 'read', 'WxzOX', 'dTAbB', 'bARWO', 'isArray', '0\x202px\x208px\x20rgba(0,0,0,0.4)', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以见面的角色。</p>', 'getDate', 'floor', 'CLyWW', 'xVdxL', 'HqbIb', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20<button\x20id=\x22diary-action-cancel\x22\x20class=\x22choice-modal-button\x20cancel\x22>取消</button>\x0a\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20</div>\x0a\x20\x20', 'closest', 'widget-play-pause-btn', 'api-endpoint', '-\x20**对话状态提示**:\x20你们已经有\x20', 'confirm-altar-upload-button', '\x22\x20id=\x22', 'click', 'SepsW', '确定要删除这个好友圈吗？此操作不可撤销。', 'char_offline_bg_', 'http://sharkpan.xyz/f/55ntj/ul0hkz.jpg', 'replaceAll', 'danJE', '我来搞定', 'oTAtB', 'linkedWorldBookIds', '”...', 'chat-listen-together-button', '#bubble-preview-ai', '\x0a-\x20**对话状态**:\x20群里刚刚还在聊天。', '15%', 'group-settings-bind-user', '#diary-action-delete', 'theme-widget-2', 'WRYaN', '确定要删除群聊\x22', 'pqzxG', 'is-playing', '#diary-action-cancel', 'horizontal', 'siifg', 'char-edit-offline-bg-input', 'fNfhK', 'onloadend', 'querySelectorAll', '搜索失败:\x20', 'sVxyt', 'VTEyq', '\x20.app-icon-img', '--primary-hue', 'char-name-header', 'text', 'vTeIs', 'image', '[用户发送了表情：', '买新衣服', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-header\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'worldBooks', '动态已清空。', '创建新角色', 'KZaYV', '3295460NzoISW', 'import-data-input', 'post-img-', 'uMBXs', 'ipTfc', 'music-input-artist', 'setItem', 'playableUrl', 'setProperty', 'save-group-settings-button', 'outerHTML', '\x22>\x20', 'http://sharkpan.xyz/f/7L3Hj/sl4504.jpg', '\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22listen-together-header\x22>', 'lKBHi', '赞同！渲染效果一级棒！', '\x0a#\x20最近的朋友圈动态\x20(供你参考)\x0a', 'WHCnA', 'http://sharkpan.xyz/f/G0dTl/4qad2i.jpg', 'iKMfc', 'yKveQ', 'endsWith', '核心代码-Noir\x0a\x0a\x20监工-小红书ID：糯糯糯糯五\x0a\x0a', 'ZjjYV', '\x22\x20style=\x22width:\x20100%;\x20height:\x20100%;\x20border-radius:\x2022.5%;\x20object-fit:\x20cover;\x20display:\x20block;\x22>', 'DqRrH', 'openai', '加载第二个卡片图片失败', 'push', 'cREEv', 'findIndex', 'OqsWW', 'hxtMG', 'end', 'chat_', 'pVfPD', 'cSUgC', 'YTHrJ', 'signal', '-\x20**对话状态提示**:\x20对话已经过了一天，你应该意识到之前的话题已是【昨天】的事，可以开启新话题或用“说起昨天...”来提及旧事。\x0a', 'mZYmi', '请输入有效的转账金额！', 'recipientId', '\x0a\x20\x20近期记忆:\x0a', 'music-upload-altar-screen', '说了是摆设啦，笨蛋。', '\x22\x20class=\x22post-image\x22></div>', 'quotedMessage', 'songName', '\x20行格式不对，被我无视了。', 'style', 'position', '.app-icon-img', 'user-post-attachment-preview', 'generationConfig', 'disabled', 'ceil', '\x0a\x20\x20人设:\x20', '.no-action-modal', '切换聊天时发生异步错误:', '\x20时出错，跳过。', '未命名角色', '（对话结束）', 'pendingPostAttachments', 'Unknown', '\x22\x20alt=\x22avatar\x22\x20class=\x22char-avatar\x22>\x0a\x20\x20\x20\x20\x20\x20<label\x20for=\x22member-select-', 'global-player-next-btn', 'has', 'HEEsl', 'http://sharkpan.xyz/f/wyeIq/phhdy2.jpg', '乐于助人的助手', '处理\x20', 'init', 'quote-preview-area', '<img\x20id=\x22', 'WjHCD', 'appIconPosition_app-diary', '[发送了图片]', 'music-widget', 'ZQEwl', '绝对不想', '34%', 'test_post_', 'widget_card_2', '”面对面交流。你的回复必须是【视觉小说剧本】格式。\x0a\x20\x20-\x20**输出格式**:\x20你的回复**必须**是一个完整的、语法正确的JSON数组。每一个数组元素都是一个对象，代表一句台词或旁白，结构如下:\x0a\x20\x20\x0a\x20\x20\x20\x20{\x0a\x20\x20\x20\x20\x22speaker\x22:\x20\x22角色名或narrator\x22,\x0a\x20\x20\x20\x20\x22emotion\x22:\x20\x22从[', 'LdiUX', 'audio-file-input', 'zh-CN', 'toBlob', 'application/json', 'persona', 'zFDCz', 'zLleN', 'CrlQS', '<br>', 'delete', 'ssLao', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<img\x20src=\x22', 'senderId', 'MxUrt', 'custom-icon-list-container', '\x0a你是一个严格的JSON生成引擎。\x0a你的唯一任务是根据用户提供的指令和数据，生成一个描述角色互动的JSON对象。\x0a你的输出【必须】是、也只能是一个单一、完整、语法正确的JSON对象。\x0a严禁包含任何解释、注释、道歉、或Markdown代码块标记\x20```json。\x0a直接输出\x20{\x20\x22events\x22:\x20[...]\x20}\x20结构。\x0a', '请严格按照以下SCHEMA返回一个JSON对象，不要包含任何额外文字。\x0aSCHEMA:\x0a', '保存壁纸失败:\x20', 'uYjQx', 'ZYQsb', 'coverUrl', 'happy', 'meeting-view-screen', '角色“', 'world-book-editor-title', 'home', 'NXxta', 'edit-current-circle-button', 'assign', 'NHISW', 'cancel', 'transaction', 'BZYOB', 'ayNNp', '）最新写下的日记内容。Ta写的是：\x0a\x20“', '保存卡片状态失败', 'http://sharkpan.xyz/f/0GKHX/mthvno.jpg', 'http://sharkpan.xyz/f/7aMhj/hyc75m.jpg', '</div>\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-preview\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20绑定的“我”:\x20', 'chat-messages', 'tTxQG', '\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22music-post-song-info\x22>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<div\x20class=\x22title\x22>', 'dcZxw', 'LYisM', '<input\x20type=\x22checkbox\x22\x20value=\x22', 'RcPWC', 'http://sharkpan.xyz/f/JYJhg/s3wmlj.jpg', 'activeListenSession', '\x20时出错:', 'undefined', '”面对面，Ta现在掏出手机给你发了这条消息。请根据这前后的时间差，判断Ta发送消息的合理性，你应该结合上下文对此发表评论（例如，根据上下文，Ta已经和你分开了，没用面对面了，那么发手机消息非常正常，自然接话就好，但是如果判断得出你们还在见面状态，那么，你可以适当吐槽为什么两个人见面还要发手机消息），现在，切换到【手机聊天】模式（纯文本气泡，不要有旁白）。', 'world-book-screen', 'hdZcB', 'LrhtB', 'YQHGb', 'dWLXU', '图标处理失败:\x20', 'JkHdc', 'touchmove', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20<input\x20type=\x22file\x22\x20id=\x22input_', 'Hlvyc', '回复\x20', 'char_avatar_', 'children', '\x0a-\x20**对话状态**:\x20群里已经有', '\x20(当前)', 'vCPag', '干劲满满', ',\x20resetting.', 'padding', '图片加载失败', 'http://sharkpan.xyz/f/LZwu7/m7vx2q.jpg', '正在准备图片数据...', '.page-dot', 'loading', '暗夜紫晶', 'http://sharkpan.xyz/f/olJt4/7z47b8.jpg', '[sticker:', 'touchcancel', 'head', 'BWcWV', 'value', '[发送了表情]', 'http://sharkpan.xyz/f/wjgHq/yznfhq.jpg', 'indexedDBData', '成功获取\x20', '用户资料已保存！', '卡片\x202\x20已更换！', 'diary-page-', 'music-post', '星期五', 'http://sharkpan.xyz/f/v0qcL/dio7j0.jpg', 'yGXXQ', 'group-delete', '确定要导入全量备份文件吗？这将覆盖所有当前数据（包括图片和音乐），且操作不可撤销！', 'some', 'message-anchor', 'rgba(0,\x200,\x200,\x200.4)', 'input:checked', 'http://sharkpan.xyz/f/Qpzu6/3b30r2.jpg', '桌面已重置，即将刷新...', 'diary-action-modal-', 'fetch-models-button', '\x0a-\x20人设:\x20', 'vAylC', '你还没保存这个角色呢，导什么导？', '好友圈名称不能为空！', 'entries', '文件格式不正确，不是一个有效的备份文件。', '1769930XTiEty', '</label>\x0a\x20\x20\x20\x20', 'BpnMV', 'wjxDQ', 'home-clock-container', 'stopPropagation', 'activeFriendCircleId', 'getMinutes', 'dSMSm', 'PzIxT', 'participantIds', '\x22\x20已删除。', 'theme-hue-slider', 'widget-cover-art', 'userProfileList', '\x20|\x20', 'tIdfy', '这不是一张有效的Noir角色卡。', 'sticker-content', 'ZjNfC', 'http://sharkpan.xyz/f/6Dgia/ghr4ji.jpg', '稍微有点卡了，可以尝试清空聊天记录了！记得总结丢世界书', 'SPrWf', 'BNBiv', 'music-input-backdrop', 'gtLsj', 'getAll', '暂无音乐', 'parts', 'delete-world-book-button', 'MDtbr', 'forceWhiteClock', 'assistant', '#d1d5db', 'user-post-image-input', 'novel', '分钟前聊过，请注意衔接。', 'oYcyG', '.typing-indicator', 'sbsTQ', '.choice-modal-backdrop', 'http://sharkpan.xyz/f/rjpu6/ojpa0c.jpg', 'wallpaper', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有任何设定，点击右上角“+”来创建第一个吧。</p>', 'defaultPrevented', '71%', 'editing-friend-circle-id', '...', 'diary-send-button', 'documentElement', 'localeCompare', 'friendCircles', 'InrvP', '\x0a\x20\x20\x20\x20\x20\x20<div\x20class=\x22world-book-item-name\x22>', 'cover', 'New\x20request\x20started', 'contains', 'typing-indicator', 'startsWith', 'appendChild', '<p\x20style=\x22text-align:\x20center;\x20color:\x20var(--text-color-light);\x22>还没有可以交换日记的对象。</p>', 'timestamp', '\x20张旧的动态图片。', '</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20</div>\x0a\x20\x20\x20\x20\x20\x20\x20\x20', 'mBFnl', '--widget-cover-image', 'home-time', '\x0a-\x20**当前时间**:\x20', 'nnmTy', 'modal-ok', 'yGLKf', 'innerHTML', 'galgame-time', 'kECcx', '哼，正在净化你那些被污染的好友圈动态...', 'length', 'NBqZm', 'http://sharkpan.xyz/f/z1xc5/iore2n.gif', 'filled', 'noir_migration_fc_v1_complete', '该角色', 'pending-post-image-preview', 'json', 'chat-summarize-button', 'save-edit-button', 'claude', 'app-meeting', 'char_', 'Error\x20fetching\x20from\x20', 'role', '好友圈净化完成，正在重新存档...', '的个人专属世界观设定\x0a', '</div>', 'MJNfc', 'wFKNh', 'feed', 'edit-message-button', 'onclick', 'fUmDD', 'KxobI', 'User\x20cancelled', '\x22\x20中发现一张需要净化的图片...', 'oUKFo', '昨天\x20', '获取AI响应失败:', '委屈那我歇了', 'appIconPosition_app-music-library', 'ZVnTy', '50%', 'onsuccess', 'meeting-message-input', 'cWfGu', 'jYvjl', 'cancel-transfer-button', 'http://sharkpan.xyz/f/djyi8/1en214.jpg']; _0x5008 = function () { return _0x3cacae; }; return _0x5008(); } async function _0x2aeef5(_0x6718b9) { const _0x57a1a1 = await _0x4a97d6; return new Promise((_0x349de0, _0x43e04e) => { const _0x496303 = _0x3d17, _0x3cf1df = _0x57a1a1[_0x496303(0x70d)](_0x8cbdd5, _0x496303(0x3c3)), _0x56386d = _0x3cf1df['objectStore'](_0x8cbdd5), _0x1439d0 = _0x56386d['get'](_0x6718b9); _0x1439d0[_0x496303(0x7c8)] = () => _0x349de0(_0x1439d0[_0x496303(0x242)] ? _0x1439d0[_0x496303(0x242)][_0x496303(0x31d)] : null), _0x1439d0[_0x496303(0x3bc)] = () => _0x43e04e(_0x1439d0[_0x496303(0x50e)]); }); } async function _0x3aff46(_0x474b4e, _0x9747b) { const _0x7ee95b = await _0x4a97d6; return new Promise((_0x217ca3, _0x367806) => { const _0x13185b = _0x3d17, _0x103d82 = _0x7ee95b[_0x13185b(0x70d)](_0x8cbdd5, _0x13185b(0x478)), _0x30c85a = _0x103d82[_0x13185b(0x365)](_0x8cbdd5), _0x47b0e2 = _0x30c85a[_0x13185b(0x5e8)]({ 'id': _0x474b4e, 'blob': _0x9747b }); _0x47b0e2['onsuccess'] = () => _0x217ca3(_0x47b0e2['result']), _0x47b0e2['onerror'] = () => _0x367806(_0x47b0e2[_0x13185b(0x50e)]); }); } async function _0x2e942c(_0x46d0e3) { const _0x21fc46 = await _0x4a97d6; return new Promise((_0x5d2904, _0x5a06c2) => { const _0xdf897c = _0x3d17, _0xee54a2 = _0x21fc46['transaction'](_0x8cbdd5, _0xdf897c(0x478)), _0x261fa2 = _0xee54a2[_0xdf897c(0x365)](_0x8cbdd5), _0x53fbbd = _0x261fa2[_0xdf897c(0x6f7)](_0x46d0e3); _0x53fbbd[_0xdf897c(0x7c8)] = () => _0x5d2904(), _0x53fbbd[_0xdf897c(0x3bc)] = () => _0x5a06c2(_0x53fbbd[_0xdf897c(0x50e)]); }); } function _0x57a56e(_0x45a937) { const _0x526a37 = _0x4f9ace; return fetch(_0x45a937)['then'](_0x4ea7af => _0x4ea7af[_0x526a37(0x31d)]()); }
  </Script>



  <div id="listen-together-ui" style="display: none;">
    <div class="lt-ui-backdrop"></div>
    <div class="lt-ui-main">
      <div class="lt-ui-header">
        <span id="lt-ui-header-title">正在与 TA 一起听</span>
        <button id="lt-ui-close-btn">×</button>
      </div>
      <div class="lt-ui-content">
        <div class="lt-ui-cover-container">
          <img id="lt-ui-cover-art" src="">
        </div>
        <div class="lt-ui-info">
          <h2 id="lt-ui-song-title">歌曲名称</h2>
          <p id="lt-ui-song-artist">歌手</p>
        </div>
        <div id="lt-ui-lyrics-container">
          <p class="no-lyrics-placeholder">暂无歌词</p>
        </div>
      </div>
    </div>
  </div>
  <div id="summarize-modal" class="choice-modal">
    <div id="summarize-backdrop" class="choice-modal-backdrop"></div>
    <div class="choice-modal-content"
      style="padding: 0; width: 95%; max-width: 360px; height: 70%; display: flex; flex-direction: column;">
      <div class="header" style="border-bottom: 1px solid var(--border-color); flex-shrink: 0;">
        <button id="close-summary-button" class="header-button" style="min-width: 50px;">关闭</button>
        <span class="header-title">聊天记录总结</span>
        <button id="copy-summary-button" class="header-button" style="min-width: 50px;">复制</button>
      </div>
      <div class="content" style="flex-grow: 1; padding: 0;">
        <textarea id="summary-textarea" placeholder="AI正在拼命总结中，别催..."></textarea>
      </div>
    </div>
  </div>
</body>

</html>
